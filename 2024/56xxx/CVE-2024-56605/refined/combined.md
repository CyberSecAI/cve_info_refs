=== Content from git.kernel.org_421ae978_20250114_225539.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=daa13175a6dea312a76099066cb4cbd4fc959a84)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=daa13175a6dea312a76099066cb4cbd4fc959a84)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=daa13175a6dea312a76099066cb4cbd4fc959a84)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=daa13175a6dea312a76099066cb4cbd4fc959a84)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ignat Korchagin <ignat@cloudflare.com> | 2024-10-14 16:38:01 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:48:27 +0100 |
| commit | [daa13175a6dea312a76099066cb4cbd4fc959a84](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=daa13175a6dea312a76099066cb4cbd4fc959a84) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=daa13175a6dea312a76099066cb4cbd4fc959a84)) | |
| tree | [187acb248a057aa60eac3a48a3fe4e67f0e03546](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=daa13175a6dea312a76099066cb4cbd4fc959a84) | |
| parent | [1dc1e1db927056cb323296e2294a855cd003dfe7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1dc1e1db927056cb323296e2294a855cd003dfe7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=daa13175a6dea312a76099066cb4cbd4fc959a84&id2=1dc1e1db927056cb323296e2294a855cd003dfe7)) | |
| download | [linux-daa13175a6dea312a76099066cb4cbd4fc959a84.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-daa13175a6dea312a76099066cb4cbd4fc959a84.tar.gz) | |

Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap\_sock\_create()[ Upstream commit 7c4f78cdb8e7501e9f92d291a7d956591bf73be9 ]
bt\_sock\_alloc() allocates the sk object and attaches it to the provided
sock object. On error l2cap\_sock\_alloc() frees the sk object, but the
dangling pointer is still attached to the sock object, which may create
use-after-free in other code.
Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: [https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com](https://patch.msgid.link/20241014153808.51894-3-ignat%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=daa13175a6dea312a76099066cb4cbd4fc959a84)

| -rw-r--r-- | [net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/l2cap_sock.c?id=daa13175a6dea312a76099066cb4cbd4fc959a84) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/bluetooth/l2cap\_sock.c b/net/bluetooth/l2cap\_sock.cindex 93afa52c04660f..cbaefbba6f4dbb 100644--- a/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=1dc1e1db927056cb323296e2294a855cd003dfe7)+++ b/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=daa13175a6dea312a76099066cb4cbd4fc959a84)@@ -1864,6 +1864,7 @@ static struct sock \*l2cap\_sock\_alloc(struct net \*net, struct socket \*sock, chan = l2cap\_chan\_create(); if (!chan) { sk\_free(sk);+ sock->sk = NULL; return NULL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:54:17 +0000



=== Content from git.kernel.org_b7d45218_20250114_225538.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a8677028dd5123e5e525b8195483994d87123de4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a8677028dd5123e5e525b8195483994d87123de4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a8677028dd5123e5e525b8195483994d87123de4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a8677028dd5123e5e525b8195483994d87123de4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ignat Korchagin <ignat@cloudflare.com> | 2024-10-14 16:38:01 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:37 +0100 |
| commit | [a8677028dd5123e5e525b8195483994d87123de4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a8677028dd5123e5e525b8195483994d87123de4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a8677028dd5123e5e525b8195483994d87123de4)) | |
| tree | [966c8dd02ee859f03a8a67e8b330f5ff9f7004a2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a8677028dd5123e5e525b8195483994d87123de4) | |
| parent | [132e615bb1d7cdec2d3cfbdec2efa630e923fd21](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=132e615bb1d7cdec2d3cfbdec2efa630e923fd21) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a8677028dd5123e5e525b8195483994d87123de4&id2=132e615bb1d7cdec2d3cfbdec2efa630e923fd21)) | |
| download | [linux-a8677028dd5123e5e525b8195483994d87123de4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a8677028dd5123e5e525b8195483994d87123de4.tar.gz) | |

Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap\_sock\_create()[ Upstream commit 7c4f78cdb8e7501e9f92d291a7d956591bf73be9 ]
bt\_sock\_alloc() allocates the sk object and attaches it to the provided
sock object. On error l2cap\_sock\_alloc() frees the sk object, but the
dangling pointer is still attached to the sock object, which may create
use-after-free in other code.
Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: [https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com](https://patch.msgid.link/20241014153808.51894-3-ignat%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a8677028dd5123e5e525b8195483994d87123de4)

| -rw-r--r-- | [net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/l2cap_sock.c?id=a8677028dd5123e5e525b8195483994d87123de4) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/bluetooth/l2cap\_sock.c b/net/bluetooth/l2cap\_sock.cindex 3a2be1b4a57433..57035e46f71518 100644--- a/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=132e615bb1d7cdec2d3cfbdec2efa630e923fd21)+++ b/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=a8677028dd5123e5e525b8195483994d87123de4)@@ -1876,6 +1876,7 @@ static struct sock \*l2cap\_sock\_alloc(struct net \*net, struct socket \*sock, chan = l2cap\_chan\_create(); if (!chan) { sk\_free(sk);+ sock->sk = NULL; return NULL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:54:15 +0000



=== Content from git.kernel.org_23628163_20250114_225535.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ignat Korchagin <ignat@cloudflare.com> | 2024-10-14 16:38:01 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 20:03:47 +0100 |
| commit | [61686abc2f3c2c67822aa23ce6f160467ec83d35](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35)) | |
| tree | [f5527c4b79fb1c64961a0be71f2246917c0f054e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35) | |
| parent | [fd09880b16d33aa5a7420578e01cd79148fa9829](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fd09880b16d33aa5a7420578e01cd79148fa9829) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35&id2=fd09880b16d33aa5a7420578e01cd79148fa9829)) | |
| download | [linux-61686abc2f3c2c67822aa23ce6f160467ec83d35.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-61686abc2f3c2c67822aa23ce6f160467ec83d35.tar.gz) | |

Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap\_sock\_create()[ Upstream commit 7c4f78cdb8e7501e9f92d291a7d956591bf73be9 ]
bt\_sock\_alloc() allocates the sk object and attaches it to the provided
sock object. On error l2cap\_sock\_alloc() frees the sk object, but the
dangling pointer is still attached to the sock object, which may create
use-after-free in other code.
Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: [https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com](https://patch.msgid.link/20241014153808.51894-3-ignat%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=61686abc2f3c2c67822aa23ce6f160467ec83d35)

| -rw-r--r-- | [net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/l2cap_sock.c?id=61686abc2f3c2c67822aa23ce6f160467ec83d35) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/bluetooth/l2cap\_sock.c b/net/bluetooth/l2cap\_sock.cindex ba437c6f6ee591..18e89e764f3b42 100644--- a/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=fd09880b16d33aa5a7420578e01cd79148fa9829)+++ b/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=61686abc2f3c2c67822aa23ce6f160467ec83d35)@@ -1886,6 +1886,7 @@ static struct sock \*l2cap\_sock\_alloc(struct net \*net, struct socket \*sock, chan = l2cap\_chan\_create(); if (!chan) { sk\_free(sk);+ sock->sk = NULL; return NULL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:54:12 +0000



=== Content from git.kernel.org_e9ce2cec_20250114_225540.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ignat Korchagin <ignat@cloudflare.com> | 2024-10-14 16:38:01 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:44:51 +0100 |
| commit | [f6ad641646b67f29c7578dcd6c25813c7dcbf51e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e)) | |
| tree | [8c49b267b43d5e24c3106af1fc3793d73c87a75f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e) | |
| parent | [71b22837a5e55ac27d6a14b9cdf2326587405c4f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=71b22837a5e55ac27d6a14b9cdf2326587405c4f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e&id2=71b22837a5e55ac27d6a14b9cdf2326587405c4f)) | |
| download | [linux-f6ad641646b67f29c7578dcd6c25813c7dcbf51e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f6ad641646b67f29c7578dcd6c25813c7dcbf51e.tar.gz) | |

Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap\_sock\_create()[ Upstream commit 7c4f78cdb8e7501e9f92d291a7d956591bf73be9 ]
bt\_sock\_alloc() allocates the sk object and attaches it to the provided
sock object. On error l2cap\_sock\_alloc() frees the sk object, but the
dangling pointer is still attached to the sock object, which may create
use-after-free in other code.
Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: [https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com](https://patch.msgid.link/20241014153808.51894-3-ignat%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e)

| -rw-r--r-- | [net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/l2cap_sock.c?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/bluetooth/l2cap\_sock.c b/net/bluetooth/l2cap\_sock.cindex 9eea2af9a8e1c7..6ec6f6a06521d4 100644--- a/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=71b22837a5e55ac27d6a14b9cdf2326587405c4f)+++ b/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=f6ad641646b67f29c7578dcd6c25813c7dcbf51e)@@ -1678,6 +1678,7 @@ static struct sock \*l2cap\_sock\_alloc(struct net \*net, struct socket \*sock, chan = l2cap\_chan\_create(); if (!chan) { sk\_free(sk);+ sock->sk = NULL; return NULL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:54:17 +0000



=== Content from git.kernel.org_389231d6_20250114_225536.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ignat Korchagin <ignat@cloudflare.com> | 2024-10-14 16:38:01 +0100 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2024-10-15 18:43:07 -0700 |
| commit | [7c4f78cdb8e7501e9f92d291a7d956591bf73be9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9)) | |
| tree | [c6aac9f8e09f7b0445a1cbaa0704397da0bf217e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9) | |
| parent | [46f2a11cb82b657fd15bab1c47821b635e03838b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=46f2a11cb82b657fd15bab1c47821b635e03838b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9&id2=46f2a11cb82b657fd15bab1c47821b635e03838b)) | |
| download | [linux-7c4f78cdb8e7501e9f92d291a7d956591bf73be9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7c4f78cdb8e7501e9f92d291a7d956591bf73be9.tar.gz) | |

Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap\_sock\_create()bt\_sock\_alloc() allocates the sk object and attaches it to the provided
sock object. On error l2cap\_sock\_alloc() frees the sk object, but the
dangling pointer is still attached to the sock object, which may create
use-after-free in other code.
Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: [https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com](https://patch.msgid.link/20241014153808.51894-3-ignat%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9)

| -rw-r--r-- | [net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/l2cap_sock.c?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/bluetooth/l2cap\_sock.c b/net/bluetooth/l2cap\_sock.cindex ba437c6f6ee591..18e89e764f3b42 100644--- a/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=46f2a11cb82b657fd15bab1c47821b635e03838b)+++ b/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=7c4f78cdb8e7501e9f92d291a7d956591bf73be9)@@ -1886,6 +1886,7 @@ static struct sock \*l2cap\_sock\_alloc(struct net \*net, struct socket \*sock, chan = l2cap\_chan\_create(); if (!chan) { sk\_free(sk);+ sock->sk = NULL; return NULL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:54:13 +0000



=== Content from git.kernel.org_87b71134_20250114_225537.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ignat Korchagin <ignat@cloudflare.com> | 2024-10-14 16:38:01 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 20:00:04 +0100 |
| commit | [8ad09ddc63ace3950ac43db6fbfe25b40f589dd6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6)) | |
| tree | [13872ed8509008311a74b56ad05907ed9840225d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6) | |
| parent | [157f08db94123e2ba56877dd0ac88908b13a5dd0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=157f08db94123e2ba56877dd0ac88908b13a5dd0) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6&id2=157f08db94123e2ba56877dd0ac88908b13a5dd0)) | |
| download | [linux-8ad09ddc63ace3950ac43db6fbfe25b40f589dd6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8ad09ddc63ace3950ac43db6fbfe25b40f589dd6.tar.gz) | |

Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap\_sock\_create()[ Upstream commit 7c4f78cdb8e7501e9f92d291a7d956591bf73be9 ]
bt\_sock\_alloc() allocates the sk object and attaches it to the provided
sock object. On error l2cap\_sock\_alloc() frees the sk object, but the
dangling pointer is still attached to the sock object, which may create
use-after-free in other code.
Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: [https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com](https://patch.msgid.link/20241014153808.51894-3-ignat%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6)

| -rw-r--r-- | [net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/l2cap_sock.c?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/bluetooth/l2cap\_sock.c b/net/bluetooth/l2cap\_sock.cindex f04ce84267988f..379ca86c41cd5b 100644--- a/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=157f08db94123e2ba56877dd0ac88908b13a5dd0)+++ b/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=8ad09ddc63ace3950ac43db6fbfe25b40f589dd6)@@ -1885,6 +1885,7 @@ static struct sock \*l2cap\_sock\_alloc(struct net \*net, struct socket \*sock, chan = l2cap\_chan\_create(); if (!chan) { sk\_free(sk);+ sock->sk = NULL; return NULL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:54:14 +0000



=== Content from git.kernel.org_b8831f77_20250114_225539.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ignat Korchagin <ignat@cloudflare.com> | 2024-10-14 16:38:01 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:54:41 +0100 |
| commit | [bb2f2342a6ddf7c04f9aefbbfe86104cd138e629](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629)) | |
| tree | [1acdf191b709f2135fa31a91653a2ca2ce8b318a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629) | |
| parent | [a6cf750b737374454a4e03a5ed449a3eb0c96414](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a6cf750b737374454a4e03a5ed449a3eb0c96414) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629&id2=a6cf750b737374454a4e03a5ed449a3eb0c96414)) | |
| download | [linux-bb2f2342a6ddf7c04f9aefbbfe86104cd138e629.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bb2f2342a6ddf7c04f9aefbbfe86104cd138e629.tar.gz) | |

Bluetooth: L2CAP: do not leave dangling sk pointer on error in l2cap\_sock\_create()[ Upstream commit 7c4f78cdb8e7501e9f92d291a7d956591bf73be9 ]
bt\_sock\_alloc() allocates the sk object and attaches it to the provided
sock object. On error l2cap\_sock\_alloc() frees the sk object, but the
dangling pointer is still attached to the sock object, which may create
use-after-free in other code.
Signed-off-by: Ignat Korchagin <ignat@cloudflare.com>
Reviewed-by: Kuniyuki Iwashima <kuniyu@amazon.com>
Reviewed-by: Eric Dumazet <edumazet@google.com>
Link: [https://patch.msgid.link/20241014153808.51894-3-ignat@cloudflare.com](https://patch.msgid.link/20241014153808.51894-3-ignat%40cloudflare.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629)

| -rw-r--r-- | [net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/l2cap_sock.c?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629) | 1 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 0 deletions

| diff --git a/net/bluetooth/l2cap\_sock.c b/net/bluetooth/l2cap\_sock.cindex b17782dc513b5a..4e965916c17c14 100644--- a/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=a6cf750b737374454a4e03a5ed449a3eb0c96414)+++ b/[net/bluetooth/l2cap\_sock.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/l2cap_sock.c?id=bb2f2342a6ddf7c04f9aefbbfe86104cd138e629)@@ -1920,6 +1920,7 @@ static struct sock \*l2cap\_sock\_alloc(struct net \*net, struct socket \*sock, chan = l2cap\_chan\_create(); if (!chan) { sk\_free(sk);+ sock->sk = NULL; return NULL; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 22:54:16 +0000


