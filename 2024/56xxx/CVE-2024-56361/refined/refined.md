The provided content is related to CVE-2024-56361.

**Root cause of vulnerability:**
The vulnerability is caused by improper sanitization of user input within the `lgsl_query_40` function in `lgsl_protocol.php`. This function fetches data from a game server (specifically the `/info` endpoint), and the received data is then displayed on the `/lgsl_details.php` page. The data is not properly sanitized before being rendered, which allows for the injection of malicious JavaScript code.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability.
- Lack of proper input sanitization/encoding of user-supplied data.

**Impact of exploitation:**
- An attacker can inject arbitrary JavaScript code into the server information page, which will be executed in the browser of anyone who accesses the affected page. This could lead to various malicious activities such as:
    - Session hijacking
    - Stealing user credentials
    - Redirecting users to malicious websites
    - Performing actions on behalf of the user.

**Attack vectors:**
- The attacker needs to set up a game server of type `eco` with a crafted `/info` endpoint.
- The `/info` endpoint serves a JSON payload containing the malicious javascript code.
- When the `lgsl_query_40` function crawls the game server for information, it retrieves the malicious payload.
- The payload is then rendered on the page via `lgsl_details.php` without being properly sanitized.

**Required attacker capabilities/position:**
- The attacker needs to control the game server and its `/info` endpoint.
- No specific position is required as any user who accesses the vulnerable page via `/s?=` will execute the malicious JavaScript code.

**Additional notes:**
- The vulnerability is in versions of lgsl prior to 7.0.
- The vulnerability was fixed in commit `3fbd3bb581b636f7fd3ea0592c5f8df87d3a2843` by encoding the output using `htmlentities()`.
- The Proof of Concept (PoC) demonstrates how to exploit the vulnerability by setting up a malicious game server and injecting JavaScript code through the `/info` endpoint.