=== Content from git.kernel.org_230f3718_20250114_230545.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=623be080ab3c13d71570bd32f7202a8efa8e2252)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=623be080ab3c13d71570bd32f7202a8efa8e2252)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=623be080ab3c13d71570bd32f7202a8efa8e2252)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=623be080ab3c13d71570bd32f7202a8efa8e2252)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ivan Solodovnikov <solodovnikov.ia@phystech.edu> | 2024-11-26 17:39:02 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:44:45 +0100 |
| commit | [623be080ab3c13d71570bd32f7202a8efa8e2252](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=623be080ab3c13d71570bd32f7202a8efa8e2252) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=623be080ab3c13d71570bd32f7202a8efa8e2252)) | |
| tree | [a9e82a794548ae0d1b1724f53eb58e173ee7edd4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=623be080ab3c13d71570bd32f7202a8efa8e2252) | |
| parent | [a95808252e8acc0123bacd2dff8b9af10bc145b7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a95808252e8acc0123bacd2dff8b9af10bc145b7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=623be080ab3c13d71570bd32f7202a8efa8e2252&id2=a95808252e8acc0123bacd2dff8b9af10bc145b7)) | |
| download | [linux-623be080ab3c13d71570bd32f7202a8efa8e2252.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-623be080ab3c13d71570bd32f7202a8efa8e2252.tar.gz) | |

dccp: Fix memory leak in dccp\_feat\_change\_recv[ Upstream commit 22be4727a8f898442066bcac34f8a1ad0bc72e14 ]
If dccp\_feat\_push\_confirm() fails after new value for SP feature was accepted
without reconciliation ('entry == NULL' branch), memory allocated for that value
with dccp\_feat\_clone\_sp\_val() is never freed.
Here is the kmemleak stack for this:
unreferenced object 0xffff88801d4ab488 (size 8):
comm "syz-executor310", pid 1127, jiffies 4295085598 (age 41.666s)
hex dump (first 8 bytes):
01 b4 4a 1d 80 88 ff ff ..J.....
backtrace:
[<00000000db7cabfe>] kmemdup+0x23/0x50 mm/util.c:128
[<0000000019b38405>] kmemdup include/linux/string.h:465 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:371 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:367 [inline]
[<0000000019b38405>] dccp\_feat\_change\_recv net/dccp/feat.c:1145 [inline]
[<0000000019b38405>] dccp\_feat\_parse\_options+0x1196/0x2180 net/dccp/feat.c:1416
[<00000000b1f6d94a>] dccp\_parse\_options+0xa2a/0x1260 net/dccp/options.c:125
[<0000000030d7b621>] dccp\_rcv\_state\_process+0x197/0x13d0 net/dccp/input.c:650
[<000000001f74c72e>] dccp\_v4\_do\_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
[<00000000a6c24128>] sk\_backlog\_rcv include/net/sock.h:1041 [inline]
[<00000000a6c24128>] \_\_release\_sock+0x139/0x3b0 net/core/sock.c:2570
[<00000000cf1f3a53>] release\_sock+0x54/0x1b0 net/core/sock.c:3111
[<000000008422fa23>] inet\_wait\_for\_connect net/ipv4/af\_inet.c:603 [inline]
[<000000008422fa23>] \_\_inet\_stream\_connect+0x5d0/0xf70 net/ipv4/af\_inet.c:696
[<0000000015b6f64d>] inet\_stream\_connect+0x53/0xa0 net/ipv4/af\_inet.c:735
[<0000000010122488>] \_\_sys\_connect\_file+0x15c/0x1a0 net/socket.c:1865
[<00000000b4b70023>] \_\_sys\_connect+0x165/0x1a0 net/socket.c:1882
[<00000000f4cb3815>] \_\_do\_sys\_connect net/socket.c:1892 [inline]
[<00000000f4cb3815>] \_\_se\_sys\_connect net/socket.c:1889 [inline]
[<00000000f4cb3815>] \_\_x64\_sys\_connect+0x6e/0xb0 net/socket.c:1889
[<00000000e7b1e839>] do\_syscall\_64+0x33/0x40 arch/x86/entry/common.c:46
[<0000000055e91434>] entry\_SYSCALL\_64\_after\_hwframe+0x67/0xd1
Clean up the allocated memory in case of dccp\_feat\_push\_confirm() failure
and bail out with an error reset code.
Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
Fixes: e77b8363b2ea ("dccp: Process incoming Change feature-negotiation options")
Signed-off-by: Ivan Solodovnikov <solodovnikov.ia@phystech.edu>
Link: [https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu](https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia%40phystech.edu)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=623be080ab3c13d71570bd32f7202a8efa8e2252)

| -rw-r--r-- | [net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/dccp/feat.c?id=623be080ab3c13d71570bd32f7202a8efa8e2252) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/dccp/feat.c b/net/dccp/feat.cindex 9c3b5e05623429..7647306802f1e6 100644--- a/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=a95808252e8acc0123bacd2dff8b9af10bc145b7)+++ b/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=623be080ab3c13d71570bd32f7202a8efa8e2252)@@ -1156,8 +1156,12 @@ static u8 dccp\_feat\_change\_recv(struct list\_head \*fn, u8 is\_mandatory, u8 opt, goto not\_valid\_or\_not\_known; } - return dccp\_feat\_push\_confirm(fn, feat, local, &fval);+ if (dccp\_feat\_push\_confirm(fn, feat, local, &fval)) {+ kfree(fval.sp.vec);+ return DCCP\_RESET\_CODE\_TOO\_BUSY;+ } + return 0; } else if (entry->state == FEAT\_UNSTABLE) { /\* 6.6.2 \*/ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:04:21 +0000



=== Content from git.kernel.org_420b72b8_20250114_230550.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c99507fff94b926fc92279c92d80f229c91cb85d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c99507fff94b926fc92279c92d80f229c91cb85d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c99507fff94b926fc92279c92d80f229c91cb85d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c99507fff94b926fc92279c92d80f229c91cb85d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ivan Solodovnikov <solodovnikov.ia@phystech.edu> | 2024-11-26 17:39:02 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:48:19 +0100 |
| commit | [c99507fff94b926fc92279c92d80f229c91cb85d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c99507fff94b926fc92279c92d80f229c91cb85d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c99507fff94b926fc92279c92d80f229c91cb85d)) | |
| tree | [5d61117a94dd33f1e98a870ebf0bf8736b7478d2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c99507fff94b926fc92279c92d80f229c91cb85d) | |
| parent | [b90d061345bb8cd51fece561a800bae1c95448a6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b90d061345bb8cd51fece561a800bae1c95448a6) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c99507fff94b926fc92279c92d80f229c91cb85d&id2=b90d061345bb8cd51fece561a800bae1c95448a6)) | |
| download | [linux-c99507fff94b926fc92279c92d80f229c91cb85d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c99507fff94b926fc92279c92d80f229c91cb85d.tar.gz) | |

dccp: Fix memory leak in dccp\_feat\_change\_recv[ Upstream commit 22be4727a8f898442066bcac34f8a1ad0bc72e14 ]
If dccp\_feat\_push\_confirm() fails after new value for SP feature was accepted
without reconciliation ('entry == NULL' branch), memory allocated for that value
with dccp\_feat\_clone\_sp\_val() is never freed.
Here is the kmemleak stack for this:
unreferenced object 0xffff88801d4ab488 (size 8):
comm "syz-executor310", pid 1127, jiffies 4295085598 (age 41.666s)
hex dump (first 8 bytes):
01 b4 4a 1d 80 88 ff ff ..J.....
backtrace:
[<00000000db7cabfe>] kmemdup+0x23/0x50 mm/util.c:128
[<0000000019b38405>] kmemdup include/linux/string.h:465 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:371 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:367 [inline]
[<0000000019b38405>] dccp\_feat\_change\_recv net/dccp/feat.c:1145 [inline]
[<0000000019b38405>] dccp\_feat\_parse\_options+0x1196/0x2180 net/dccp/feat.c:1416
[<00000000b1f6d94a>] dccp\_parse\_options+0xa2a/0x1260 net/dccp/options.c:125
[<0000000030d7b621>] dccp\_rcv\_state\_process+0x197/0x13d0 net/dccp/input.c:650
[<000000001f74c72e>] dccp\_v4\_do\_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
[<00000000a6c24128>] sk\_backlog\_rcv include/net/sock.h:1041 [inline]
[<00000000a6c24128>] \_\_release\_sock+0x139/0x3b0 net/core/sock.c:2570
[<00000000cf1f3a53>] release\_sock+0x54/0x1b0 net/core/sock.c:3111
[<000000008422fa23>] inet\_wait\_for\_connect net/ipv4/af\_inet.c:603 [inline]
[<000000008422fa23>] \_\_inet\_stream\_connect+0x5d0/0xf70 net/ipv4/af\_inet.c:696
[<0000000015b6f64d>] inet\_stream\_connect+0x53/0xa0 net/ipv4/af\_inet.c:735
[<0000000010122488>] \_\_sys\_connect\_file+0x15c/0x1a0 net/socket.c:1865
[<00000000b4b70023>] \_\_sys\_connect+0x165/0x1a0 net/socket.c:1882
[<00000000f4cb3815>] \_\_do\_sys\_connect net/socket.c:1892 [inline]
[<00000000f4cb3815>] \_\_se\_sys\_connect net/socket.c:1889 [inline]
[<00000000f4cb3815>] \_\_x64\_sys\_connect+0x6e/0xb0 net/socket.c:1889
[<00000000e7b1e839>] do\_syscall\_64+0x33/0x40 arch/x86/entry/common.c:46
[<0000000055e91434>] entry\_SYSCALL\_64\_after\_hwframe+0x67/0xd1
Clean up the allocated memory in case of dccp\_feat\_push\_confirm() failure
and bail out with an error reset code.
Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
Fixes: e77b8363b2ea ("dccp: Process incoming Change feature-negotiation options")
Signed-off-by: Ivan Solodovnikov <solodovnikov.ia@phystech.edu>
Link: [https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu](https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia%40phystech.edu)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c99507fff94b926fc92279c92d80f229c91cb85d)

| -rw-r--r-- | [net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/dccp/feat.c?id=c99507fff94b926fc92279c92d80f229c91cb85d) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/dccp/feat.c b/net/dccp/feat.cindex 788dd629c4204a..e9cc7415ba484c 100644--- a/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=b90d061345bb8cd51fece561a800bae1c95448a6)+++ b/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=c99507fff94b926fc92279c92d80f229c91cb85d)@@ -1160,8 +1160,12 @@ static u8 dccp\_feat\_change\_recv(struct list\_head \*fn, u8 is\_mandatory, u8 opt, goto not\_valid\_or\_not\_known; } - return dccp\_feat\_push\_confirm(fn, feat, local, &fval);+ if (dccp\_feat\_push\_confirm(fn, feat, local, &fval)) {+ kfree(fval.sp.vec);+ return DCCP\_RESET\_CODE\_TOO\_BUSY;+ } + return 0; } else if (entry->state == FEAT\_UNSTABLE) { /\* 6.6.2 \*/ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:04:27 +0000



=== Content from git.kernel.org_72327d55_20250114_230546.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ivan Solodovnikov <solodovnikov.ia@phystech.edu> | 2024-11-26 17:39:02 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:54:22 +0100 |
| commit | [6ff67909ee2ffad911e3122616df41dee23ff4f6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6)) | |
| tree | [54c420b822ddff5d01cf22523415bc50f0fa0829](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6) | |
| parent | [535add1e9f274502209cb997801208bbe1ae6c6f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=535add1e9f274502209cb997801208bbe1ae6c6f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6&id2=535add1e9f274502209cb997801208bbe1ae6c6f)) | |
| download | [linux-6ff67909ee2ffad911e3122616df41dee23ff4f6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6ff67909ee2ffad911e3122616df41dee23ff4f6.tar.gz) | |

dccp: Fix memory leak in dccp\_feat\_change\_recv[ Upstream commit 22be4727a8f898442066bcac34f8a1ad0bc72e14 ]
If dccp\_feat\_push\_confirm() fails after new value for SP feature was accepted
without reconciliation ('entry == NULL' branch), memory allocated for that value
with dccp\_feat\_clone\_sp\_val() is never freed.
Here is the kmemleak stack for this:
unreferenced object 0xffff88801d4ab488 (size 8):
comm "syz-executor310", pid 1127, jiffies 4295085598 (age 41.666s)
hex dump (first 8 bytes):
01 b4 4a 1d 80 88 ff ff ..J.....
backtrace:
[<00000000db7cabfe>] kmemdup+0x23/0x50 mm/util.c:128
[<0000000019b38405>] kmemdup include/linux/string.h:465 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:371 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:367 [inline]
[<0000000019b38405>] dccp\_feat\_change\_recv net/dccp/feat.c:1145 [inline]
[<0000000019b38405>] dccp\_feat\_parse\_options+0x1196/0x2180 net/dccp/feat.c:1416
[<00000000b1f6d94a>] dccp\_parse\_options+0xa2a/0x1260 net/dccp/options.c:125
[<0000000030d7b621>] dccp\_rcv\_state\_process+0x197/0x13d0 net/dccp/input.c:650
[<000000001f74c72e>] dccp\_v4\_do\_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
[<00000000a6c24128>] sk\_backlog\_rcv include/net/sock.h:1041 [inline]
[<00000000a6c24128>] \_\_release\_sock+0x139/0x3b0 net/core/sock.c:2570
[<00000000cf1f3a53>] release\_sock+0x54/0x1b0 net/core/sock.c:3111
[<000000008422fa23>] inet\_wait\_for\_connect net/ipv4/af\_inet.c:603 [inline]
[<000000008422fa23>] \_\_inet\_stream\_connect+0x5d0/0xf70 net/ipv4/af\_inet.c:696
[<0000000015b6f64d>] inet\_stream\_connect+0x53/0xa0 net/ipv4/af\_inet.c:735
[<0000000010122488>] \_\_sys\_connect\_file+0x15c/0x1a0 net/socket.c:1865
[<00000000b4b70023>] \_\_sys\_connect+0x165/0x1a0 net/socket.c:1882
[<00000000f4cb3815>] \_\_do\_sys\_connect net/socket.c:1892 [inline]
[<00000000f4cb3815>] \_\_se\_sys\_connect net/socket.c:1889 [inline]
[<00000000f4cb3815>] \_\_x64\_sys\_connect+0x6e/0xb0 net/socket.c:1889
[<00000000e7b1e839>] do\_syscall\_64+0x33/0x40 arch/x86/entry/common.c:46
[<0000000055e91434>] entry\_SYSCALL\_64\_after\_hwframe+0x67/0xd1
Clean up the allocated memory in case of dccp\_feat\_push\_confirm() failure
and bail out with an error reset code.
Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
Fixes: e77b8363b2ea ("dccp: Process incoming Change feature-negotiation options")
Signed-off-by: Ivan Solodovnikov <solodovnikov.ia@phystech.edu>
Link: [https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu](https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia%40phystech.edu)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6ff67909ee2ffad911e3122616df41dee23ff4f6)

| -rw-r--r-- | [net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/dccp/feat.c?id=6ff67909ee2ffad911e3122616df41dee23ff4f6) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/dccp/feat.c b/net/dccp/feat.cindex 54086bb05c42cd..f7554dcdaaba93 100644--- a/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=535add1e9f274502209cb997801208bbe1ae6c6f)+++ b/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=6ff67909ee2ffad911e3122616df41dee23ff4f6)@@ -1166,8 +1166,12 @@ static u8 dccp\_feat\_change\_recv(struct list\_head \*fn, u8 is\_mandatory, u8 opt, goto not\_valid\_or\_not\_known; } - return dccp\_feat\_push\_confirm(fn, feat, local, &fval);+ if (dccp\_feat\_push\_confirm(fn, feat, local, &fval)) {+ kfree(fval.sp.vec);+ return DCCP\_RESET\_CODE\_TOO\_BUSY;+ } + return 0; } else if (entry->state == FEAT\_UNSTABLE) { /\* 6.6.2 \*/ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:04:23 +0000



=== Content from git.kernel.org_d94ffc6f_20250114_230547.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9ee68b0f23706a77f53c832457b9384178b76421)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9ee68b0f23706a77f53c832457b9384178b76421)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9ee68b0f23706a77f53c832457b9384178b76421)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9ee68b0f23706a77f53c832457b9384178b76421)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ivan Solodovnikov <solodovnikov.ia@phystech.edu> | 2024-11-26 17:39:02 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 20:03:05 +0100 |
| commit | [9ee68b0f23706a77f53c832457b9384178b76421](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9ee68b0f23706a77f53c832457b9384178b76421) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9ee68b0f23706a77f53c832457b9384178b76421)) | |
| tree | [50aedb7ce5ebff613e3ca09f14fe181f0cd07ce1](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9ee68b0f23706a77f53c832457b9384178b76421) | |
| parent | [8b591bd522b71c42a82898290e35d32b482047e4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b591bd522b71c42a82898290e35d32b482047e4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9ee68b0f23706a77f53c832457b9384178b76421&id2=8b591bd522b71c42a82898290e35d32b482047e4)) | |
| download | [linux-9ee68b0f23706a77f53c832457b9384178b76421.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9ee68b0f23706a77f53c832457b9384178b76421.tar.gz) | |

dccp: Fix memory leak in dccp\_feat\_change\_recv[ Upstream commit 22be4727a8f898442066bcac34f8a1ad0bc72e14 ]
If dccp\_feat\_push\_confirm() fails after new value for SP feature was accepted
without reconciliation ('entry == NULL' branch), memory allocated for that value
with dccp\_feat\_clone\_sp\_val() is never freed.
Here is the kmemleak stack for this:
unreferenced object 0xffff88801d4ab488 (size 8):
comm "syz-executor310", pid 1127, jiffies 4295085598 (age 41.666s)
hex dump (first 8 bytes):
01 b4 4a 1d 80 88 ff ff ..J.....
backtrace:
[<00000000db7cabfe>] kmemdup+0x23/0x50 mm/util.c:128
[<0000000019b38405>] kmemdup include/linux/string.h:465 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:371 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:367 [inline]
[<0000000019b38405>] dccp\_feat\_change\_recv net/dccp/feat.c:1145 [inline]
[<0000000019b38405>] dccp\_feat\_parse\_options+0x1196/0x2180 net/dccp/feat.c:1416
[<00000000b1f6d94a>] dccp\_parse\_options+0xa2a/0x1260 net/dccp/options.c:125
[<0000000030d7b621>] dccp\_rcv\_state\_process+0x197/0x13d0 net/dccp/input.c:650
[<000000001f74c72e>] dccp\_v4\_do\_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
[<00000000a6c24128>] sk\_backlog\_rcv include/net/sock.h:1041 [inline]
[<00000000a6c24128>] \_\_release\_sock+0x139/0x3b0 net/core/sock.c:2570
[<00000000cf1f3a53>] release\_sock+0x54/0x1b0 net/core/sock.c:3111
[<000000008422fa23>] inet\_wait\_for\_connect net/ipv4/af\_inet.c:603 [inline]
[<000000008422fa23>] \_\_inet\_stream\_connect+0x5d0/0xf70 net/ipv4/af\_inet.c:696
[<0000000015b6f64d>] inet\_stream\_connect+0x53/0xa0 net/ipv4/af\_inet.c:735
[<0000000010122488>] \_\_sys\_connect\_file+0x15c/0x1a0 net/socket.c:1865
[<00000000b4b70023>] \_\_sys\_connect+0x165/0x1a0 net/socket.c:1882
[<00000000f4cb3815>] \_\_do\_sys\_connect net/socket.c:1892 [inline]
[<00000000f4cb3815>] \_\_se\_sys\_connect net/socket.c:1889 [inline]
[<00000000f4cb3815>] \_\_x64\_sys\_connect+0x6e/0xb0 net/socket.c:1889
[<00000000e7b1e839>] do\_syscall\_64+0x33/0x40 arch/x86/entry/common.c:46
[<0000000055e91434>] entry\_SYSCALL\_64\_after\_hwframe+0x67/0xd1
Clean up the allocated memory in case of dccp\_feat\_push\_confirm() failure
and bail out with an error reset code.
Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
Fixes: e77b8363b2ea ("dccp: Process incoming Change feature-negotiation options")
Signed-off-by: Ivan Solodovnikov <solodovnikov.ia@phystech.edu>
Link: [https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu](https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia%40phystech.edu)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9ee68b0f23706a77f53c832457b9384178b76421)

| -rw-r--r-- | [net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/dccp/feat.c?id=9ee68b0f23706a77f53c832457b9384178b76421) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/dccp/feat.c b/net/dccp/feat.cindex 54086bb05c42cd..f7554dcdaaba93 100644--- a/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=8b591bd522b71c42a82898290e35d32b482047e4)+++ b/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=9ee68b0f23706a77f53c832457b9384178b76421)@@ -1166,8 +1166,12 @@ static u8 dccp\_feat\_change\_recv(struct list\_head \*fn, u8 is\_mandatory, u8 opt, goto not\_valid\_or\_not\_known; } - return dccp\_feat\_push\_confirm(fn, feat, local, &fval);+ if (dccp\_feat\_push\_confirm(fn, feat, local, &fval)) {+ kfree(fval.sp.vec);+ return DCCP\_RESET\_CODE\_TOO\_BUSY;+ } + return 0; } else if (entry->state == FEAT\_UNSTABLE) { /\* 6.6.2 \*/ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:04:24 +0000



=== Content from git.kernel.org_f5d3dfc9_20250114_230551.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d3ec686a369fae5034303061f003cd3f94ddfd23)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d3ec686a369fae5034303061f003cd3f94ddfd23)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d3ec686a369fae5034303061f003cd3f94ddfd23)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d3ec686a369fae5034303061f003cd3f94ddfd23)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ivan Solodovnikov <solodovnikov.ia@phystech.edu> | 2024-11-26 17:39:02 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:59:36 +0100 |
| commit | [d3ec686a369fae5034303061f003cd3f94ddfd23](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d3ec686a369fae5034303061f003cd3f94ddfd23) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d3ec686a369fae5034303061f003cd3f94ddfd23)) | |
| tree | [679d797ed646b26090ce69ca8614e3e19c6f3921](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d3ec686a369fae5034303061f003cd3f94ddfd23) | |
| parent | [f43d12fd0fa8ee5b9caf8a3927e10d06431764d2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f43d12fd0fa8ee5b9caf8a3927e10d06431764d2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d3ec686a369fae5034303061f003cd3f94ddfd23&id2=f43d12fd0fa8ee5b9caf8a3927e10d06431764d2)) | |
| download | [linux-d3ec686a369fae5034303061f003cd3f94ddfd23.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d3ec686a369fae5034303061f003cd3f94ddfd23.tar.gz) | |

dccp: Fix memory leak in dccp\_feat\_change\_recv[ Upstream commit 22be4727a8f898442066bcac34f8a1ad0bc72e14 ]
If dccp\_feat\_push\_confirm() fails after new value for SP feature was accepted
without reconciliation ('entry == NULL' branch), memory allocated for that value
with dccp\_feat\_clone\_sp\_val() is never freed.
Here is the kmemleak stack for this:
unreferenced object 0xffff88801d4ab488 (size 8):
comm "syz-executor310", pid 1127, jiffies 4295085598 (age 41.666s)
hex dump (first 8 bytes):
01 b4 4a 1d 80 88 ff ff ..J.....
backtrace:
[<00000000db7cabfe>] kmemdup+0x23/0x50 mm/util.c:128
[<0000000019b38405>] kmemdup include/linux/string.h:465 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:371 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:367 [inline]
[<0000000019b38405>] dccp\_feat\_change\_recv net/dccp/feat.c:1145 [inline]
[<0000000019b38405>] dccp\_feat\_parse\_options+0x1196/0x2180 net/dccp/feat.c:1416
[<00000000b1f6d94a>] dccp\_parse\_options+0xa2a/0x1260 net/dccp/options.c:125
[<0000000030d7b621>] dccp\_rcv\_state\_process+0x197/0x13d0 net/dccp/input.c:650
[<000000001f74c72e>] dccp\_v4\_do\_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
[<00000000a6c24128>] sk\_backlog\_rcv include/net/sock.h:1041 [inline]
[<00000000a6c24128>] \_\_release\_sock+0x139/0x3b0 net/core/sock.c:2570
[<00000000cf1f3a53>] release\_sock+0x54/0x1b0 net/core/sock.c:3111
[<000000008422fa23>] inet\_wait\_for\_connect net/ipv4/af\_inet.c:603 [inline]
[<000000008422fa23>] \_\_inet\_stream\_connect+0x5d0/0xf70 net/ipv4/af\_inet.c:696
[<0000000015b6f64d>] inet\_stream\_connect+0x53/0xa0 net/ipv4/af\_inet.c:735
[<0000000010122488>] \_\_sys\_connect\_file+0x15c/0x1a0 net/socket.c:1865
[<00000000b4b70023>] \_\_sys\_connect+0x165/0x1a0 net/socket.c:1882
[<00000000f4cb3815>] \_\_do\_sys\_connect net/socket.c:1892 [inline]
[<00000000f4cb3815>] \_\_se\_sys\_connect net/socket.c:1889 [inline]
[<00000000f4cb3815>] \_\_x64\_sys\_connect+0x6e/0xb0 net/socket.c:1889
[<00000000e7b1e839>] do\_syscall\_64+0x33/0x40 arch/x86/entry/common.c:46
[<0000000055e91434>] entry\_SYSCALL\_64\_after\_hwframe+0x67/0xd1
Clean up the allocated memory in case of dccp\_feat\_push\_confirm() failure
and bail out with an error reset code.
Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
Fixes: e77b8363b2ea ("dccp: Process incoming Change feature-negotiation options")
Signed-off-by: Ivan Solodovnikov <solodovnikov.ia@phystech.edu>
Link: [https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu](https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia%40phystech.edu)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d3ec686a369fae5034303061f003cd3f94ddfd23)

| -rw-r--r-- | [net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/dccp/feat.c?id=d3ec686a369fae5034303061f003cd3f94ddfd23) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/dccp/feat.c b/net/dccp/feat.cindex 54086bb05c42cd..f7554dcdaaba93 100644--- a/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=f43d12fd0fa8ee5b9caf8a3927e10d06431764d2)+++ b/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=d3ec686a369fae5034303061f003cd3f94ddfd23)@@ -1166,8 +1166,12 @@ static u8 dccp\_feat\_change\_recv(struct list\_head \*fn, u8 is\_mandatory, u8 opt, goto not\_valid\_or\_not\_known; } - return dccp\_feat\_push\_confirm(fn, feat, local, &fval);+ if (dccp\_feat\_push\_confirm(fn, feat, local, &fval)) {+ kfree(fval.sp.vec);+ return DCCP\_RESET\_CODE\_TOO\_BUSY;+ } + return 0; } else if (entry->state == FEAT\_UNSTABLE) { /\* 6.6.2 \*/ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:04:28 +0000



=== Content from git.kernel.org_828f3ee1_20250114_230543.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ivan Solodovnikov <solodovnikov.ia@phystech.edu> | 2024-11-26 17:39:02 +0300 |
| --- | --- | --- |
| committer | Paolo Abeni <pabeni@redhat.com> | 2024-12-03 09:50:21 +0100 |
| commit | [22be4727a8f898442066bcac34f8a1ad0bc72e14](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14)) | |
| tree | [575bfd7a19c4a2ed535c2903a8e3006e979a129f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14) | |
| parent | [3301ab7d5aeb0fe270f73a3d4810c9d1b6a9f045](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3301ab7d5aeb0fe270f73a3d4810c9d1b6a9f045) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14&id2=3301ab7d5aeb0fe270f73a3d4810c9d1b6a9f045)) | |
| download | [linux-22be4727a8f898442066bcac34f8a1ad0bc72e14.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-22be4727a8f898442066bcac34f8a1ad0bc72e14.tar.gz) | |

dccp: Fix memory leak in dccp\_feat\_change\_recvIf dccp\_feat\_push\_confirm() fails after new value for SP feature was accepted
without reconciliation ('entry == NULL' branch), memory allocated for that value
with dccp\_feat\_clone\_sp\_val() is never freed.
Here is the kmemleak stack for this:
unreferenced object 0xffff88801d4ab488 (size 8):
comm "syz-executor310", pid 1127, jiffies 4295085598 (age 41.666s)
hex dump (first 8 bytes):
01 b4 4a 1d 80 88 ff ff ..J.....
backtrace:
[<00000000db7cabfe>] kmemdup+0x23/0x50 mm/util.c:128
[<0000000019b38405>] kmemdup include/linux/string.h:465 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:371 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:367 [inline]
[<0000000019b38405>] dccp\_feat\_change\_recv net/dccp/feat.c:1145 [inline]
[<0000000019b38405>] dccp\_feat\_parse\_options+0x1196/0x2180 net/dccp/feat.c:1416
[<00000000b1f6d94a>] dccp\_parse\_options+0xa2a/0x1260 net/dccp/options.c:125
[<0000000030d7b621>] dccp\_rcv\_state\_process+0x197/0x13d0 net/dccp/input.c:650
[<000000001f74c72e>] dccp\_v4\_do\_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
[<00000000a6c24128>] sk\_backlog\_rcv include/net/sock.h:1041 [inline]
[<00000000a6c24128>] \_\_release\_sock+0x139/0x3b0 net/core/sock.c:2570
[<00000000cf1f3a53>] release\_sock+0x54/0x1b0 net/core/sock.c:3111
[<000000008422fa23>] inet\_wait\_for\_connect net/ipv4/af\_inet.c:603 [inline]
[<000000008422fa23>] \_\_inet\_stream\_connect+0x5d0/0xf70 net/ipv4/af\_inet.c:696
[<0000000015b6f64d>] inet\_stream\_connect+0x53/0xa0 net/ipv4/af\_inet.c:735
[<0000000010122488>] \_\_sys\_connect\_file+0x15c/0x1a0 net/socket.c:1865
[<00000000b4b70023>] \_\_sys\_connect+0x165/0x1a0 net/socket.c:1882
[<00000000f4cb3815>] \_\_do\_sys\_connect net/socket.c:1892 [inline]
[<00000000f4cb3815>] \_\_se\_sys\_connect net/socket.c:1889 [inline]
[<00000000f4cb3815>] \_\_x64\_sys\_connect+0x6e/0xb0 net/socket.c:1889
[<00000000e7b1e839>] do\_syscall\_64+0x33/0x40 arch/x86/entry/common.c:46
[<0000000055e91434>] entry\_SYSCALL\_64\_after\_hwframe+0x67/0xd1
Clean up the allocated memory in case of dccp\_feat\_push\_confirm() failure
and bail out with an error reset code.
Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
Fixes: e77b8363b2ea ("dccp: Process incoming Change feature-negotiation options")
Signed-off-by: Ivan Solodovnikov <solodovnikov.ia@phystech.edu>
Link: [https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu](https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia%40phystech.edu)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=22be4727a8f898442066bcac34f8a1ad0bc72e14)

| -rw-r--r-- | [net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/dccp/feat.c?id=22be4727a8f898442066bcac34f8a1ad0bc72e14) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/dccp/feat.c b/net/dccp/feat.cindex 54086bb05c42cd..f7554dcdaaba93 100644--- a/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=3301ab7d5aeb0fe270f73a3d4810c9d1b6a9f045)+++ b/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=22be4727a8f898442066bcac34f8a1ad0bc72e14)@@ -1166,8 +1166,12 @@ static u8 dccp\_feat\_change\_recv(struct list\_head \*fn, u8 is\_mandatory, u8 opt, goto not\_valid\_or\_not\_known; } - return dccp\_feat\_push\_confirm(fn, feat, local, &fval);+ if (dccp\_feat\_push\_confirm(fn, feat, local, &fval)) {+ kfree(fval.sp.vec);+ return DCCP\_RESET\_CODE\_TOO\_BUSY;+ } + return 0; } else if (entry->state == FEAT\_UNSTABLE) { /\* 6.6.2 \*/ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:04:19 +0000



=== Content from git.kernel.org_7d4fae9b_20250114_230549.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bc3d4423def1a9412a0ae454cb4477089ab79276)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bc3d4423def1a9412a0ae454cb4477089ab79276)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bc3d4423def1a9412a0ae454cb4477089ab79276)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bc3d4423def1a9412a0ae454cb4477089ab79276)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Ivan Solodovnikov <solodovnikov.ia@phystech.edu> | 2024-11-26 17:39:02 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:27 +0100 |
| commit | [bc3d4423def1a9412a0ae454cb4477089ab79276](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bc3d4423def1a9412a0ae454cb4477089ab79276) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bc3d4423def1a9412a0ae454cb4477089ab79276)) | |
| tree | [ac77b71ab1671495a6f297a08ca0ca7268411547](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bc3d4423def1a9412a0ae454cb4477089ab79276) | |
| parent | [0b8903e6c881f72c6849d4952de742c656eb5ab9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0b8903e6c881f72c6849d4952de742c656eb5ab9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bc3d4423def1a9412a0ae454cb4477089ab79276&id2=0b8903e6c881f72c6849d4952de742c656eb5ab9)) | |
| download | [linux-bc3d4423def1a9412a0ae454cb4477089ab79276.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bc3d4423def1a9412a0ae454cb4477089ab79276.tar.gz) | |

dccp: Fix memory leak in dccp\_feat\_change\_recv[ Upstream commit 22be4727a8f898442066bcac34f8a1ad0bc72e14 ]
If dccp\_feat\_push\_confirm() fails after new value for SP feature was accepted
without reconciliation ('entry == NULL' branch), memory allocated for that value
with dccp\_feat\_clone\_sp\_val() is never freed.
Here is the kmemleak stack for this:
unreferenced object 0xffff88801d4ab488 (size 8):
comm "syz-executor310", pid 1127, jiffies 4295085598 (age 41.666s)
hex dump (first 8 bytes):
01 b4 4a 1d 80 88 ff ff ..J.....
backtrace:
[<00000000db7cabfe>] kmemdup+0x23/0x50 mm/util.c:128
[<0000000019b38405>] kmemdup include/linux/string.h:465 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:371 [inline]
[<0000000019b38405>] dccp\_feat\_clone\_sp\_val net/dccp/feat.c:367 [inline]
[<0000000019b38405>] dccp\_feat\_change\_recv net/dccp/feat.c:1145 [inline]
[<0000000019b38405>] dccp\_feat\_parse\_options+0x1196/0x2180 net/dccp/feat.c:1416
[<00000000b1f6d94a>] dccp\_parse\_options+0xa2a/0x1260 net/dccp/options.c:125
[<0000000030d7b621>] dccp\_rcv\_state\_process+0x197/0x13d0 net/dccp/input.c:650
[<000000001f74c72e>] dccp\_v4\_do\_rcv+0xf9/0x1a0 net/dccp/ipv4.c:688
[<00000000a6c24128>] sk\_backlog\_rcv include/net/sock.h:1041 [inline]
[<00000000a6c24128>] \_\_release\_sock+0x139/0x3b0 net/core/sock.c:2570
[<00000000cf1f3a53>] release\_sock+0x54/0x1b0 net/core/sock.c:3111
[<000000008422fa23>] inet\_wait\_for\_connect net/ipv4/af\_inet.c:603 [inline]
[<000000008422fa23>] \_\_inet\_stream\_connect+0x5d0/0xf70 net/ipv4/af\_inet.c:696
[<0000000015b6f64d>] inet\_stream\_connect+0x53/0xa0 net/ipv4/af\_inet.c:735
[<0000000010122488>] \_\_sys\_connect\_file+0x15c/0x1a0 net/socket.c:1865
[<00000000b4b70023>] \_\_sys\_connect+0x165/0x1a0 net/socket.c:1882
[<00000000f4cb3815>] \_\_do\_sys\_connect net/socket.c:1892 [inline]
[<00000000f4cb3815>] \_\_se\_sys\_connect net/socket.c:1889 [inline]
[<00000000f4cb3815>] \_\_x64\_sys\_connect+0x6e/0xb0 net/socket.c:1889
[<00000000e7b1e839>] do\_syscall\_64+0x33/0x40 arch/x86/entry/common.c:46
[<0000000055e91434>] entry\_SYSCALL\_64\_after\_hwframe+0x67/0xd1
Clean up the allocated memory in case of dccp\_feat\_push\_confirm() failure
and bail out with an error reset code.
Found by Linux Verification Center (linuxtesting.org) with Syzkaller.
Fixes: e77b8363b2ea ("dccp: Process incoming Change feature-negotiation options")
Signed-off-by: Ivan Solodovnikov <solodovnikov.ia@phystech.edu>
Link: [https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia@phystech.edu](https://patch.msgid.link/20241126143902.190853-1-solodovnikov.ia%40phystech.edu)
Signed-off-by: Paolo Abeni <pabeni@redhat.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bc3d4423def1a9412a0ae454cb4477089ab79276)

| -rw-r--r-- | [net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/dccp/feat.c?id=bc3d4423def1a9412a0ae454cb4477089ab79276) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 1 deletions

| diff --git a/net/dccp/feat.c b/net/dccp/feat.cindex 54086bb05c42cd..f7554dcdaaba93 100644--- a/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=0b8903e6c881f72c6849d4952de742c656eb5ab9)+++ b/[net/dccp/feat.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/dccp/feat.c?id=bc3d4423def1a9412a0ae454cb4477089ab79276)@@ -1166,8 +1166,12 @@ static u8 dccp\_feat\_change\_recv(struct list\_head \*fn, u8 is\_mandatory, u8 opt, goto not\_valid\_or\_not\_known; } - return dccp\_feat\_push\_confirm(fn, feat, local, &fval);+ if (dccp\_feat\_push\_confirm(fn, feat, local, &fval)) {+ kfree(fval.sp.vec);+ return DCCP\_RESET\_CODE\_TOO\_BUSY;+ } + return 0; } else if (entry->state == FEAT\_UNSTABLE) { /\* 6.6.2 \*/ return 0; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:04:25 +0000


