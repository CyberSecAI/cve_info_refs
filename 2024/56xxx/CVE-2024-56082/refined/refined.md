The provided content relates to CVE-2024-56082.

**Root cause of vulnerability:**
The Lumos plugin for local LLMs does not properly sanitize output, specifically when rendering HTML content. This allows for injection of malicious HTML via indirect prompt injection.

**Weaknesses/vulnerabilities present:**
- Insecure output handling: The plugin renders output from a local LLM without properly sanitizing it. This includes rendering HTML tags.
- Indirect Prompt Injection: A malicious website can inject malicious HTML (e.g., an `<img>` tag with a crafted source) into the content displayed by the Lumos plugin by exploiting the LLM's RAG (Retrieval-Augmented Generation) behaviour.
- Lack of input sanitization: The plugin does not sanitize the input/output of the text box, allowing for HTML injection

**Impact of exploitation:**
- Unauthorized data exfiltration: The attacker can exfiltrate sensitive information from the user's LLM chat by embedding an `<img>` tag with a source pointing to an attacker-controlled server. When the user is actively chatting with the plugin while visiting the malicious website, the embedded image tag can trigger a request to the external server, effectively sending the data from the chat.
- Exposure of sensitive information: The data exfiltrated can include confidential conversations, sensitive personal information, or any other data handled during the plugin's use.

**Attack vectors:**
- Malicious website: An attacker hosts a malicious website containing a crafted prompt designed to be included in the context of the LLM chat.
- Indirect prompt injection: The malicious prompt is designed to make the LLM include an HTML tag, specifically an `<img>` tag, with a source pointing to the attacker's server in its response.
- User interaction: The user must visit the malicious website and interact with the Lumos plugin (e.g., ask a question) while the malicious website's tab is active. The plugin's RAG functionality fetches the content from the malicious website, resulting in the crafted prompt to be included in the input for the local LLM.

**Required attacker capabilities/position:**
- Ability to host a malicious website.
- Ability to lure users to visit the malicious website while they are actively using the Lumos plugin.
- The attacker needs to craft a malicious prompt and payload that will trigger the vulnerability.
- The attacker needs to host a server to receive the exfiltrated data via the image request.

**Additional details:**
- The vulnerability is specifically located in the `Markdown` component used to render input/output in the `ChatBar.tsx` file.
- The fix involved disabling the parsing of raw HTML in the `markdown-to-jsx` library, which the Lumos plugin uses for rendering. This was achieved by setting the `disableParsingRawHTML` option to `true`.
- The fix was implemented in version `1.0.17` of the Lumos plugin.
- The `markdown-to-jsx` library has the `disableParsingRawHTML` option, which was enabled to mitigate this vulnerability.