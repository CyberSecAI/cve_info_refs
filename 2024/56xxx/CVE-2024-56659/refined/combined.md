=== Content from git.kernel.org_f814f216_20250114_210322.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-12-04 14:10:31 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:07:20 +0100 |
| commit | [c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7)) | |
| tree | [6e075943522848e53a28b874d7bbc54ee5656d30](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7) | |
| parent | [22a94e0530b5e7a2d420f38f46c9a8ea91b89c64](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=22a94e0530b5e7a2d420f38f46c9a8ea91b89c64) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7&id2=22a94e0530b5e7a2d420f38f46c9a8ea91b89c64)) | |
| download | [linux-c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7.tar.gz) | |

net: lapb: increase LAPB\_HEADER\_LEN[ Upstream commit a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4 ]
It is unclear if net/lapb code is supposed to be ready for 8021q.
We can at least avoid crashes like the following :
skbuff: skb\_under\_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
------------[ cut here ]------------
kernel BUG at net/core/skbuff.c:206 !
Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
RIP: 0010:skb\_panic net/core/skbuff.c:206 [inline]
RIP: 0010:skb\_under\_panic+0x14b/0x150 net/core/skbuff.c:216
Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
FS: 00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
<TASK>
skb\_push+0xe5/0x100 net/core/skbuff.c:2636
nr\_header+0x36/0x320 net/netrom/nr\_dev.c:69
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
vlan\_dev\_hard\_header+0x359/0x480 net/8021q/vlan\_dev.c:83
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
lapbeth\_data\_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
lapb\_data\_transmit+0x91/0xb0 net/lapb/lapb\_iface.c:447
lapb\_transmit\_buffer+0x168/0x1f0 net/lapb/lapb\_out.c:149
lapb\_establish\_data\_link+0x84/0xd0
lapb\_device\_event+0x4e0/0x670
notifier\_call\_chain+0x19f/0x3e0 kernel/notifier.c:93
\_\_dev\_notify\_flags+0x207/0x400
dev\_change\_flags+0xf0/0x1a0 net/core/dev.c:8922
devinet\_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
inet\_ioctl+0x3d7/0x4f0 net/ipv4/af\_inet.c:1003
sock\_do\_ioctl+0x158/0x460 net/socket.c:1227
sock\_ioctl+0x626/0x8e0 net/socket.c:1346
vfs\_ioctl fs/ioctl.c:51 [inline]
\_\_do\_sys\_ioctl fs/ioctl.c:907 [inline]
\_\_se\_sys\_ioctl+0xf9/0x170 fs/ioctl.c:893
do\_syscall\_x64 arch/x86/entry/common.c:52 [inline]
do\_syscall\_64+0xf3/0x230 arch/x86/entry/common.c:83
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com](https://patch.msgid.link/20241204141031.4030267-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7)

| -rw-r--r-- | [include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/net/lapb.h?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/include/net/lapb.h b/include/net/lapb.hindex 124ee122f2c8f8..6c07420644e45a 100644--- a/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=22a94e0530b5e7a2d420f38f46c9a8ea91b89c64)+++ b/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=c21c7c1c00bcc60cf752ec491bdfd47693f4d3c7)@@ -4,7 +4,7 @@ #include <linux/lapb.h> #include <linux/refcount.h> -#define LAPB\_HEADER\_LEN 20 /\* LAPB over Ethernet + a bit more \*/+#define LAPB\_HEADER\_LEN MAX\_HEADER /\* LAPB over Ethernet + a bit more \*/  #define LAPB\_ACK\_PENDING\_CONDITION 0x01 #define LAPB\_REJECT\_CONDITION 0x02 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:01:59 +0000



=== Content from git.kernel.org_215290e1_20250114_210321.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-12-04 14:10:31 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:05:03 +0100 |
| commit | [3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700)) | |
| tree | [b7c6af483ac14e109028d29586768d9037b609e0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700) | |
| parent | [d1d4dfb189a115734bff81c411bc58d9e348db7d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d1d4dfb189a115734bff81c411bc58d9e348db7d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700&id2=d1d4dfb189a115734bff81c411bc58d9e348db7d)) | |
| download | [linux-3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700.tar.gz) | |

net: lapb: increase LAPB\_HEADER\_LEN[ Upstream commit a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4 ]
It is unclear if net/lapb code is supposed to be ready for 8021q.
We can at least avoid crashes like the following :
skbuff: skb\_under\_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
------------[ cut here ]------------
kernel BUG at net/core/skbuff.c:206 !
Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
RIP: 0010:skb\_panic net/core/skbuff.c:206 [inline]
RIP: 0010:skb\_under\_panic+0x14b/0x150 net/core/skbuff.c:216
Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
FS: 00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
<TASK>
skb\_push+0xe5/0x100 net/core/skbuff.c:2636
nr\_header+0x36/0x320 net/netrom/nr\_dev.c:69
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
vlan\_dev\_hard\_header+0x359/0x480 net/8021q/vlan\_dev.c:83
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
lapbeth\_data\_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
lapb\_data\_transmit+0x91/0xb0 net/lapb/lapb\_iface.c:447
lapb\_transmit\_buffer+0x168/0x1f0 net/lapb/lapb\_out.c:149
lapb\_establish\_data\_link+0x84/0xd0
lapb\_device\_event+0x4e0/0x670
notifier\_call\_chain+0x19f/0x3e0 kernel/notifier.c:93
\_\_dev\_notify\_flags+0x207/0x400
dev\_change\_flags+0xf0/0x1a0 net/core/dev.c:8922
devinet\_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
inet\_ioctl+0x3d7/0x4f0 net/ipv4/af\_inet.c:1003
sock\_do\_ioctl+0x158/0x460 net/socket.c:1227
sock\_ioctl+0x626/0x8e0 net/socket.c:1346
vfs\_ioctl fs/ioctl.c:51 [inline]
\_\_do\_sys\_ioctl fs/ioctl.c:907 [inline]
\_\_se\_sys\_ioctl+0xf9/0x170 fs/ioctl.c:893
do\_syscall\_x64 arch/x86/entry/common.c:52 [inline]
do\_syscall\_64+0xf3/0x230 arch/x86/entry/common.c:83
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com](https://patch.msgid.link/20241204141031.4030267-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700)

| -rw-r--r-- | [include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/net/lapb.h?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/include/net/lapb.h b/include/net/lapb.hindex ccc3d1f020b0ca..c4417a63101399 100644--- a/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=d1d4dfb189a115734bff81c411bc58d9e348db7d)+++ b/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=3aa2ef7ffd0451e8f81c249d2a2a68283c6bc700)@@ -4,7 +4,7 @@ #include <linux/lapb.h> #include <linux/refcount.h> -#define LAPB\_HEADER\_LEN 20 /\* LAPB over Ethernet + a bit more \*/+#define LAPB\_HEADER\_LEN MAX\_HEADER /\* LAPB over Ethernet + a bit more \*/  #define LAPB\_ACK\_PENDING\_CONDITION 0x01 #define LAPB\_REJECT\_CONDITION 0x02 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:01:57 +0000



=== Content from git.kernel.org_b1eea521_20250114_210319.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-12-04 14:10:31 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:11:28 +0100 |
| commit | [03e661b5e7aa1124f24054df9ab2ee5cb2178973](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973)) | |
| tree | [d4971aaac2eae39358015a16514ddbd58e29f89e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973) | |
| parent | [74f0a69129260f35f9909cb221799e5fc73fe5f7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=74f0a69129260f35f9909cb221799e5fc73fe5f7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973&id2=74f0a69129260f35f9909cb221799e5fc73fe5f7)) | |
| download | [linux-03e661b5e7aa1124f24054df9ab2ee5cb2178973.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-03e661b5e7aa1124f24054df9ab2ee5cb2178973.tar.gz) | |

net: lapb: increase LAPB\_HEADER\_LEN[ Upstream commit a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4 ]
It is unclear if net/lapb code is supposed to be ready for 8021q.
We can at least avoid crashes like the following :
skbuff: skb\_under\_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
------------[ cut here ]------------
kernel BUG at net/core/skbuff.c:206 !
Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
RIP: 0010:skb\_panic net/core/skbuff.c:206 [inline]
RIP: 0010:skb\_under\_panic+0x14b/0x150 net/core/skbuff.c:216
Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
FS: 00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
<TASK>
skb\_push+0xe5/0x100 net/core/skbuff.c:2636
nr\_header+0x36/0x320 net/netrom/nr\_dev.c:69
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
vlan\_dev\_hard\_header+0x359/0x480 net/8021q/vlan\_dev.c:83
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
lapbeth\_data\_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
lapb\_data\_transmit+0x91/0xb0 net/lapb/lapb\_iface.c:447
lapb\_transmit\_buffer+0x168/0x1f0 net/lapb/lapb\_out.c:149
lapb\_establish\_data\_link+0x84/0xd0
lapb\_device\_event+0x4e0/0x670
notifier\_call\_chain+0x19f/0x3e0 kernel/notifier.c:93
\_\_dev\_notify\_flags+0x207/0x400
dev\_change\_flags+0xf0/0x1a0 net/core/dev.c:8922
devinet\_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
inet\_ioctl+0x3d7/0x4f0 net/ipv4/af\_inet.c:1003
sock\_do\_ioctl+0x158/0x460 net/socket.c:1227
sock\_ioctl+0x626/0x8e0 net/socket.c:1346
vfs\_ioctl fs/ioctl.c:51 [inline]
\_\_do\_sys\_ioctl fs/ioctl.c:907 [inline]
\_\_se\_sys\_ioctl+0xf9/0x170 fs/ioctl.c:893
do\_syscall\_x64 arch/x86/entry/common.c:52 [inline]
do\_syscall\_64+0xf3/0x230 arch/x86/entry/common.c:83
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com](https://patch.msgid.link/20241204141031.4030267-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973)

| -rw-r--r-- | [include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/net/lapb.h?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/include/net/lapb.h b/include/net/lapb.hindex 124ee122f2c8f8..6c07420644e45a 100644--- a/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=74f0a69129260f35f9909cb221799e5fc73fe5f7)+++ b/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=03e661b5e7aa1124f24054df9ab2ee5cb2178973)@@ -4,7 +4,7 @@ #include <linux/lapb.h> #include <linux/refcount.h> -#define LAPB\_HEADER\_LEN 20 /\* LAPB over Ethernet + a bit more \*/+#define LAPB\_HEADER\_LEN MAX\_HEADER /\* LAPB over Ethernet + a bit more \*/  #define LAPB\_ACK\_PENDING\_CONDITION 0x01 #define LAPB\_REJECT\_CONDITION 0x02 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:01:56 +0000



=== Content from git.kernel.org_13c4b4d9_20250114_210323.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-12-04 14:10:31 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:08:53 +0100 |
| commit | [f0949199651bc87c5ed2c12a7323f441f1af6fe9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9)) | |
| tree | [5f794dfc53f4aa1ed3c5b1188e67c31f2c74b528](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9) | |
| parent | [9724cb1881995ea70f0ed3c77490c58421afa5ad](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9724cb1881995ea70f0ed3c77490c58421afa5ad) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9&id2=9724cb1881995ea70f0ed3c77490c58421afa5ad)) | |
| download | [linux-f0949199651bc87c5ed2c12a7323f441f1af6fe9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f0949199651bc87c5ed2c12a7323f441f1af6fe9.tar.gz) | |

net: lapb: increase LAPB\_HEADER\_LEN[ Upstream commit a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4 ]
It is unclear if net/lapb code is supposed to be ready for 8021q.
We can at least avoid crashes like the following :
skbuff: skb\_under\_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
------------[ cut here ]------------
kernel BUG at net/core/skbuff.c:206 !
Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
RIP: 0010:skb\_panic net/core/skbuff.c:206 [inline]
RIP: 0010:skb\_under\_panic+0x14b/0x150 net/core/skbuff.c:216
Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
FS: 00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
<TASK>
skb\_push+0xe5/0x100 net/core/skbuff.c:2636
nr\_header+0x36/0x320 net/netrom/nr\_dev.c:69
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
vlan\_dev\_hard\_header+0x359/0x480 net/8021q/vlan\_dev.c:83
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
lapbeth\_data\_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
lapb\_data\_transmit+0x91/0xb0 net/lapb/lapb\_iface.c:447
lapb\_transmit\_buffer+0x168/0x1f0 net/lapb/lapb\_out.c:149
lapb\_establish\_data\_link+0x84/0xd0
lapb\_device\_event+0x4e0/0x670
notifier\_call\_chain+0x19f/0x3e0 kernel/notifier.c:93
\_\_dev\_notify\_flags+0x207/0x400
dev\_change\_flags+0xf0/0x1a0 net/core/dev.c:8922
devinet\_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
inet\_ioctl+0x3d7/0x4f0 net/ipv4/af\_inet.c:1003
sock\_do\_ioctl+0x158/0x460 net/socket.c:1227
sock\_ioctl+0x626/0x8e0 net/socket.c:1346
vfs\_ioctl fs/ioctl.c:51 [inline]
\_\_do\_sys\_ioctl fs/ioctl.c:907 [inline]
\_\_se\_sys\_ioctl+0xf9/0x170 fs/ioctl.c:893
do\_syscall\_x64 arch/x86/entry/common.c:52 [inline]
do\_syscall\_64+0xf3/0x230 arch/x86/entry/common.c:83
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com](https://patch.msgid.link/20241204141031.4030267-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9)

| -rw-r--r-- | [include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/net/lapb.h?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/include/net/lapb.h b/include/net/lapb.hindex 124ee122f2c8f8..6c07420644e45a 100644--- a/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=9724cb1881995ea70f0ed3c77490c58421afa5ad)+++ b/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=f0949199651bc87c5ed2c12a7323f441f1af6fe9)@@ -4,7 +4,7 @@ #include <linux/lapb.h> #include <linux/refcount.h> -#define LAPB\_HEADER\_LEN 20 /\* LAPB over Ethernet + a bit more \*/+#define LAPB\_HEADER\_LEN MAX\_HEADER /\* LAPB over Ethernet + a bit more \*/  #define LAPB\_ACK\_PENDING\_CONDITION 0x01 #define LAPB\_REJECT\_CONDITION 0x02 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:02:00 +0000



=== Content from git.kernel.org_0b607fe8_20250114_210320.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2b351355bbd50ae25d096785b6eb31998d2bf765)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2b351355bbd50ae25d096785b6eb31998d2bf765)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2b351355bbd50ae25d096785b6eb31998d2bf765)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b351355bbd50ae25d096785b6eb31998d2bf765)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-12-04 14:10:31 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:13:13 +0100 |
| commit | [2b351355bbd50ae25d096785b6eb31998d2bf765](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2b351355bbd50ae25d096785b6eb31998d2bf765) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2b351355bbd50ae25d096785b6eb31998d2bf765)) | |
| tree | [fade3e6fab362f0ed9f146c48ec8705d0288d13c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2b351355bbd50ae25d096785b6eb31998d2bf765) | |
| parent | [35fe39bc39af72b9756115e02766bb78d13d8242](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=35fe39bc39af72b9756115e02766bb78d13d8242) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b351355bbd50ae25d096785b6eb31998d2bf765&id2=35fe39bc39af72b9756115e02766bb78d13d8242)) | |
| download | [linux-2b351355bbd50ae25d096785b6eb31998d2bf765.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2b351355bbd50ae25d096785b6eb31998d2bf765.tar.gz) | |

net: lapb: increase LAPB\_HEADER\_LEN[ Upstream commit a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4 ]
It is unclear if net/lapb code is supposed to be ready for 8021q.
We can at least avoid crashes like the following :
skbuff: skb\_under\_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
------------[ cut here ]------------
kernel BUG at net/core/skbuff.c:206 !
Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
RIP: 0010:skb\_panic net/core/skbuff.c:206 [inline]
RIP: 0010:skb\_under\_panic+0x14b/0x150 net/core/skbuff.c:216
Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
FS: 00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
<TASK>
skb\_push+0xe5/0x100 net/core/skbuff.c:2636
nr\_header+0x36/0x320 net/netrom/nr\_dev.c:69
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
vlan\_dev\_hard\_header+0x359/0x480 net/8021q/vlan\_dev.c:83
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
lapbeth\_data\_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
lapb\_data\_transmit+0x91/0xb0 net/lapb/lapb\_iface.c:447
lapb\_transmit\_buffer+0x168/0x1f0 net/lapb/lapb\_out.c:149
lapb\_establish\_data\_link+0x84/0xd0
lapb\_device\_event+0x4e0/0x670
notifier\_call\_chain+0x19f/0x3e0 kernel/notifier.c:93
\_\_dev\_notify\_flags+0x207/0x400
dev\_change\_flags+0xf0/0x1a0 net/core/dev.c:8922
devinet\_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
inet\_ioctl+0x3d7/0x4f0 net/ipv4/af\_inet.c:1003
sock\_do\_ioctl+0x158/0x460 net/socket.c:1227
sock\_ioctl+0x626/0x8e0 net/socket.c:1346
vfs\_ioctl fs/ioctl.c:51 [inline]
\_\_do\_sys\_ioctl fs/ioctl.c:907 [inline]
\_\_se\_sys\_ioctl+0xf9/0x170 fs/ioctl.c:893
do\_syscall\_x64 arch/x86/entry/common.c:52 [inline]
do\_syscall\_64+0xf3/0x230 arch/x86/entry/common.c:83
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com](https://patch.msgid.link/20241204141031.4030267-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2b351355bbd50ae25d096785b6eb31998d2bf765)

| -rw-r--r-- | [include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/net/lapb.h?id=2b351355bbd50ae25d096785b6eb31998d2bf765) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/include/net/lapb.h b/include/net/lapb.hindex 124ee122f2c8f8..6c07420644e45a 100644--- a/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=35fe39bc39af72b9756115e02766bb78d13d8242)+++ b/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=2b351355bbd50ae25d096785b6eb31998d2bf765)@@ -4,7 +4,7 @@ #include <linux/lapb.h> #include <linux/refcount.h> -#define LAPB\_HEADER\_LEN 20 /\* LAPB over Ethernet + a bit more \*/+#define LAPB\_HEADER\_LEN MAX\_HEADER /\* LAPB over Ethernet + a bit more \*/  #define LAPB\_ACK\_PENDING\_CONDITION 0x01 #define LAPB\_REJECT\_CONDITION 0x02 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:01:57 +0000



=== Content from git.kernel.org_2095f154_20250114_210322.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-12-04 14:10:31 +0000 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2024-12-06 17:43:08 -0800 |
| commit | [a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4)) | |
| tree | [ec6321e27cc06d75dfdddf79c5705571696e4668](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4) | |
| parent | [ff9b30531510b49abee57a4737346acf633d9e38](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ff9b30531510b49abee57a4737346acf633d9e38) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4&id2=ff9b30531510b49abee57a4737346acf633d9e38)) | |
| download | [linux-a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4.tar.gz) | |

net: lapb: increase LAPB\_HEADER\_LENIt is unclear if net/lapb code is supposed to be ready for 8021q.
We can at least avoid crashes like the following :
skbuff: skb\_under\_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
------------[ cut here ]------------
kernel BUG at net/core/skbuff.c:206 !
Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
RIP: 0010:skb\_panic net/core/skbuff.c:206 [inline]
RIP: 0010:skb\_under\_panic+0x14b/0x150 net/core/skbuff.c:216
Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
FS: 00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
<TASK>
skb\_push+0xe5/0x100 net/core/skbuff.c:2636
nr\_header+0x36/0x320 net/netrom/nr\_dev.c:69
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
vlan\_dev\_hard\_header+0x359/0x480 net/8021q/vlan\_dev.c:83
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
lapbeth\_data\_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
lapb\_data\_transmit+0x91/0xb0 net/lapb/lapb\_iface.c:447
lapb\_transmit\_buffer+0x168/0x1f0 net/lapb/lapb\_out.c:149
lapb\_establish\_data\_link+0x84/0xd0
lapb\_device\_event+0x4e0/0x670
notifier\_call\_chain+0x19f/0x3e0 kernel/notifier.c:93
\_\_dev\_notify\_flags+0x207/0x400
dev\_change\_flags+0xf0/0x1a0 net/core/dev.c:8922
devinet\_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
inet\_ioctl+0x3d7/0x4f0 net/ipv4/af\_inet.c:1003
sock\_do\_ioctl+0x158/0x460 net/socket.c:1227
sock\_ioctl+0x626/0x8e0 net/socket.c:1346
vfs\_ioctl fs/ioctl.c:51 [inline]
\_\_do\_sys\_ioctl fs/ioctl.c:907 [inline]
\_\_se\_sys\_ioctl+0xf9/0x170 fs/ioctl.c:893
do\_syscall\_x64 arch/x86/entry/common.c:52 [inline]
do\_syscall\_64+0xf3/0x230 arch/x86/entry/common.c:83
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com](https://patch.msgid.link/20241204141031.4030267-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4)

| -rw-r--r-- | [include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/net/lapb.h?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/include/net/lapb.h b/include/net/lapb.hindex 124ee122f2c8f8..6c07420644e45a 100644--- a/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=ff9b30531510b49abee57a4737346acf633d9e38)+++ b/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4)@@ -4,7 +4,7 @@ #include <linux/lapb.h> #include <linux/refcount.h> -#define LAPB\_HEADER\_LEN 20 /\* LAPB over Ethernet + a bit more \*/+#define LAPB\_HEADER\_LEN MAX\_HEADER /\* LAPB over Ethernet + a bit more \*/  #define LAPB\_ACK\_PENDING\_CONDITION 0x01 #define LAPB\_REJECT\_CONDITION 0x02 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:01:59 +0000



=== Content from git.kernel.org_6b0b0e9a_20250114_210321.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-12-04 14:10:31 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:06:10 +0100 |
| commit | [76d856f03d0290cf5392364ecdf74c15ee16b8fd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd)) | |
| tree | [cc3587c4dc1a0a19b9e054104b43d4b6528d7a16](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd) | |
| parent | [4d2b56e2fb1ee9e1bc94a66ea95a109619f4e545](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4d2b56e2fb1ee9e1bc94a66ea95a109619f4e545) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd&id2=4d2b56e2fb1ee9e1bc94a66ea95a109619f4e545)) | |
| download | [linux-76d856f03d0290cf5392364ecdf74c15ee16b8fd.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-76d856f03d0290cf5392364ecdf74c15ee16b8fd.tar.gz) | |

net: lapb: increase LAPB\_HEADER\_LEN[ Upstream commit a6d75ecee2bf828ac6a1b52724aba0a977e4eaf4 ]
It is unclear if net/lapb code is supposed to be ready for 8021q.
We can at least avoid crashes like the following :
skbuff: skb\_under\_panic: text:ffffffff8aabe1f6 len:24 put:20 head:ffff88802824a400 data:ffff88802824a3fe tail:0x16 end:0x140 dev:nr0.2
------------[ cut here ]------------
kernel BUG at net/core/skbuff.c:206 !
Oops: invalid opcode: 0000 [#1] PREEMPT SMP KASAN PTI
CPU: 1 UID: 0 PID: 5508 Comm: dhcpcd Not tainted 6.12.0-rc7-syzkaller-00144-g66418447d27b #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 10/30/2024
RIP: 0010:skb\_panic net/core/skbuff.c:206 [inline]
RIP: 0010:skb\_under\_panic+0x14b/0x150 net/core/skbuff.c:216
Code: 0d 8d 48 c7 c6 2e 9e 29 8e 48 8b 54 24 08 8b 0c 24 44 8b 44 24 04 4d 89 e9 50 41 54 41 57 41 56 e8 1a 6f 37 02 48 83 c4 20 90 <0f> 0b 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 f3
RSP: 0018:ffffc90002ddf638 EFLAGS: 00010282
RAX: 0000000000000086 RBX: dffffc0000000000 RCX: 7a24750e538ff600
RDX: 0000000000000000 RSI: 0000000000000201 RDI: 0000000000000000
RBP: ffff888034a86650 R08: ffffffff8174b13c R09: 1ffff920005bbe60
R10: dffffc0000000000 R11: fffff520005bbe61 R12: 0000000000000140
R13: ffff88802824a400 R14: ffff88802824a3fe R15: 0000000000000016
FS: 00007f2a5990d740(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 000000110c2631fd CR3: 0000000029504000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400
Call Trace:
<TASK>
skb\_push+0xe5/0x100 net/core/skbuff.c:2636
nr\_header+0x36/0x320 net/netrom/nr\_dev.c:69
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
vlan\_dev\_hard\_header+0x359/0x480 net/8021q/vlan\_dev.c:83
dev\_hard\_header include/linux/netdevice.h:3148 [inline]
lapbeth\_data\_transmit+0x1f6/0x2a0 drivers/net/wan/lapbether.c:257
lapb\_data\_transmit+0x91/0xb0 net/lapb/lapb\_iface.c:447
lapb\_transmit\_buffer+0x168/0x1f0 net/lapb/lapb\_out.c:149
lapb\_establish\_data\_link+0x84/0xd0
lapb\_device\_event+0x4e0/0x670
notifier\_call\_chain+0x19f/0x3e0 kernel/notifier.c:93
\_\_dev\_notify\_flags+0x207/0x400
dev\_change\_flags+0xf0/0x1a0 net/core/dev.c:8922
devinet\_ioctl+0xa4e/0x1aa0 net/ipv4/devinet.c:1188
inet\_ioctl+0x3d7/0x4f0 net/ipv4/af\_inet.c:1003
sock\_do\_ioctl+0x158/0x460 net/socket.c:1227
sock\_ioctl+0x626/0x8e0 net/socket.c:1346
vfs\_ioctl fs/ioctl.c:51 [inline]
\_\_do\_sys\_ioctl fs/ioctl.c:907 [inline]
\_\_se\_sys\_ioctl+0xf9/0x170 fs/ioctl.c:893
do\_syscall\_x64 arch/x86/entry/common.c:52 [inline]
do\_syscall\_64+0xf3/0x230 arch/x86/entry/common.c:83
Fixes: 1da177e4c3f4 ("Linux-2.6.12-rc2")
Reported-by: syzbot+fb99d1b0c0f81d94a5e2@syzkaller.appspotmail.com
Closes: https://lore.kernel.org/netdev/67506220.050a0220.17bd51.006c.GAE@google.com/T/#u
Signed-off-by: Eric Dumazet <edumazet@google.com>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241204141031.4030267-1-edumazet@google.com](https://patch.msgid.link/20241204141031.4030267-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd)

| -rw-r--r-- | [include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/include/net/lapb.h?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/include/net/lapb.h b/include/net/lapb.hindex ccc3d1f020b0ca..c4417a63101399 100644--- a/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=4d2b56e2fb1ee9e1bc94a66ea95a109619f4e545)+++ b/[include/net/lapb.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/include/net/lapb.h?id=76d856f03d0290cf5392364ecdf74c15ee16b8fd)@@ -4,7 +4,7 @@ #include <linux/lapb.h> #include <linux/refcount.h> -#define LAPB\_HEADER\_LEN 20 /\* LAPB over Ethernet + a bit more \*/+#define LAPB\_HEADER\_LEN MAX\_HEADER /\* LAPB over Ethernet + a bit more \*/  #define LAPB\_ACK\_PENDING\_CONDITION 0x01 #define LAPB\_REJECT\_CONDITION 0x02 |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:01:58 +0000


