=== Content from github.com_44f16d23_20250115_082820.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshadow-maint%2Fshadow%2Fissues%2F1157)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshadow-maint%2Fshadow%2Fissues%2F1157)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=shadow-maint%2Fshadow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shadow-maint](/shadow-maint)
/
**[shadow](/shadow-maint/shadow)**
Public

* [Notifications](/login?return_to=%2Fshadow-maint%2Fshadow) You must be signed in to change notification settings
* [Fork
  240](/login?return_to=%2Fshadow-maint%2Fshadow)
* [Star
   315](/login?return_to=%2Fshadow-maint%2Fshadow)

* [Code](/shadow-maint/shadow)
* [Issues
  87](/shadow-maint/shadow/issues)
* [Pull requests
  34](/shadow-maint/shadow/pulls)
* [Actions](/shadow-maint/shadow/actions)
* [Projects
  0](/shadow-maint/shadow/projects)
* [Wiki](/shadow-maint/shadow/wiki)
* [Security](/shadow-maint/shadow/security)
* [Insights](/shadow-maint/shadow/pulse)

Additional navigation options

* [Code](/shadow-maint/shadow)
* [Issues](/shadow-maint/shadow/issues)
* [Pull requests](/shadow-maint/shadow/pulls)
* [Actions](/shadow-maint/shadow/actions)
* [Projects](/shadow-maint/shadow/projects)
* [Wiki](/shadow-maint/shadow/wiki)
* [Security](/shadow-maint/shadow/security)
* [Insights](/shadow-maint/shadow/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fshadow-maint%2Fshadow%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fshadow-maint%2Fshadow%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Default subordinate ID configuration in /etc/login.defs could lead to compromise #1157

Open

[JonnyWhatshisface](/JonnyWhatshisface) opened this issue
Dec 22, 2024
· 8 comments

Open

# [Default subordinate ID configuration in /etc/login.defs could lead to compromise](#top) #1157

[JonnyWhatshisface](/JonnyWhatshisface) opened this issue
Dec 22, 2024
· 8 comments

## Comments

[![@JonnyWhatshisface](https://avatars.githubusercontent.com/u/6776518?s=80&u=64c9ca09a3c2d6b11d11fe2b1fb131567e72c482&v=4)](/JonnyWhatshisface)

Copy link

### **[JonnyWhatshisface](/JonnyWhatshisface)** commented [Dec 22, 2024](#issue-2754895239) • edited Loading

| Trying to find the right place to bring this up to, as I'm not sure whether shadow-utils is shipping this out like this or if it's the distributions that have distributed it like this.  I'm seeing on Red Hat 9 and Debian 12 that login.defs is shipping with SUB\_UID\_\* configuration resulting in /etc/subuid and /etc/subgid entries for local accounts being added to the system.  This can have unintended consequences, as it assumes the systems are running in an environment where there would be no ID's on the network that fall within the ranges handed out by this configuration.  The issue is that the subordinate ID's can easily become the effective UID/GID of the account they're assigned to. For example, my local account had an entirely unexpected subordinate ID range assigned to it which happens to overlap with a user ID on my network. With minimal effort I'm able to become that ID and write to the users NFS home directory.  jon@localhost ~]$ id;uname -a;cat /etc/subuid uid=1000(jon) gid=1000(jon) groups=1000(jon),10(wheel) Linux localhost.localdomain 5.14.0-503.14.1.el9\_5.aarch64 [#1](https://github.com/shadow-maint/shadow/pull/1) SMP PREEMPT\_DYNAMIC Fri Nov 15 07:14:03 EST 2024 aarch64 aarch64 aarch64 GNU/Linux jon:100000:65536 [jon@localhost ~]$ getent passwd msteph msteph:x:108472:108472::/mnt/home/msteph:/bin/bash [jon@localhost ~]$ ls -al subdo;getcap subdo -rwxr-xr-x 1 jon jon 72936 Dec 22 23:12 subdo [jon@localhost ~]$ ./subdo -u 108472 -g 108472 -r 1 bash bash: /home/jon/.bashrc: Permission denied bash-5.1$ id uid=108472(msteph) gid=108472(msteph) groups=108472(msteph),65534(nobody) bash-5.1$ cd ~msteph bash-5.1$ ls bash-5.1$ ls -al total 16 drwx------ 3 msteph nobody 99 Dec 22 23:19 . drwxr-xr-x. 8 nobody nobody 85 Dec 22 23:18 .. -rw------- 1 msteph msteph 20 Dec 22 23:19 .bash\_history -rw-r--r-- 1 msteph nobody 18 Apr 30 2024 .bash\_logout -rw-r--r-- 1 msteph nobody 141 Apr 30 2024 .bash\_profile -rw-r--r-- 1 msteph nobody 492 Apr 30 2024 .bashrc drwxr-xr-x 4 msteph nobody 39 Dec 20 09:10 .mozilla bash-5.1$ touch testing123 bash-5.1$ ls -aal total 16 drwx------ 3 msteph nobody 117 Dec 22 23:23 . drwxr-xr-x. 8 nobody nobody 85 Dec 22 23:18 .. -rw------- 1 msteph msteph 20 Dec 22 23:19 .bash\_history -rw-r--r-- 1 msteph nobody 18 Apr 30 2024 .bash\_logout -rw-r--r-- 1 msteph nobody 141 Apr 30 2024 .bash\_profile -rw-r--r-- 1 msteph nobody 492 Apr 30 2024 .bashrc drwxr-xr-x 4 msteph nobody 39 Dec 20 09:10 .mozilla -rw-r--r-- 1 msteph msteph 0 Dec 22 23:23 testing123 bash-5.1$ |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@ikerexxe](https://avatars.githubusercontent.com/u/2324748?s=80&u=1cc55551dea75d465de83ac6e038f19e660991fd&v=4)](/ikerexxe)

Copy link

Collaborator

### **[ikerexxe](/ikerexxe)** commented [Dec 23, 2024](#issuecomment-2559354209)

| This can have unintended consequences, as it assumes the systems are running in an environment where there would be no ID's on the network that fall within the ranges handed out by this configuration.  That's one way of seeing things, but I have another one in mind. The remote server doesn't take into account that lower ID's might be used in the system and tries to use an ID that is already allocated to subordinate ID ranges. This is a gray area since there is no range of IDs assigned for centrally managed users. The issue of ID assignment was already addressed when the assignment of subordinates for centrally managed users was implemented [#154 (comment)](https://github.com/shadow-maint/shadow/issues/154#issuecomment-571415244) and [#154 (comment)](https://github.com/shadow-maint/shadow/issues/154#issuecomment-587364598) to name a few.  Some projects like FreeIPA define the [ID range allocation](https://freeipa.readthedocs.io/en/ipa-4-11/designs/id-mapping.html#id-range-allocation) for a number that is big enough to avoid this type of collision. Unfortunately this isn't always the case, and it's up to the sysadmin to define the boundaries correctly to avoid this type of problem.  By the way, this problem could happen in other cases as well, such as centrally managed user IDs being assigned to values below 1000. So there is a collision with the range of system users. This case is not theoretical, but I saw it a little over a year ago. The system administrator should try to avoid these problems by assigning values that do not collide with each other. |
| --- |

All reactions

Sorry, something went wrong.

[![@JonnyWhatshisface](https://avatars.githubusercontent.com/u/6776518?s=80&u=64c9ca09a3c2d6b11d11fe2b1fb131567e72c482&v=4)](/JonnyWhatshisface)

Copy link

Author

### **[JonnyWhatshisface](/JonnyWhatshisface)** commented [Dec 23, 2024](#issuecomment-2559381766) • edited Loading

| Unfortunately, in larger enterprise environments (including the one I recently left which is a 170k machine RH shop) - these default subordinate ID ranges are low enough that the likeliness of collision becomes very high. For example, in that said previous environment, the first local user given a range of 100000-165535 results in collision with more than 8,000 valid ID's, giving potential for severe internal privilege escalation in what is a publicly regulated environment.  I think the biggest problem here stems from two things:   1. The default range chosen is low enough that it increases the likeliness of collision. Even in my own personal network I've run in to a collision as demonstrated above. 2. Most system administrators are entirely unaware of this configuration and thus may be unaware of the risk lying quietly in their infrastructure   I found this purely by coincidence because I already have incredibly complex and large subuid/subgid configurations in my infrastructure. I was confused about where the entries came from and initially assumed I must have done it and forgotten about it.  I've spoken with a few directors from four separate multinational organizations who have confirmed their operations and engineering teams were entirely unaware of this default behaviour. Llikewise, all 4 have identified and confirmed collisions with ID's within just the first delegated range assigned to local accounts created on the system both with adduser/useradd and through the user addition at install time.  I do believe that raising the starting range to somewhere in the billions would do more to reduce the likeliness of collision, but I also believe that defaulting delegation of subordinate ID's within any range is something better left to the administrators to configure and should probably not be a default configuration out of the box. |
| --- |

All reactions

Sorry, something went wrong.

[![@ikerexxe](https://avatars.githubusercontent.com/u/2324748?s=80&u=1cc55551dea75d465de83ac6e038f19e660991fd&v=4)](/ikerexxe)

Copy link

Collaborator

### **[ikerexxe](/ikerexxe)** commented [Dec 24, 2024](#issuecomment-2560871479)

| ``` 1. The default range chosen is low enough that it increases the likeliness of collision. Even in my own personal network I've run in to a collision as demonstrated above.  ```  Choosing a higher range of IDs would have meant a higher risk of collision with other suppliers. There is no perfect solution and this needs to be assessed very carefully.  ``` 2. Most system administrators are entirely unaware of this configuration and thus may be unaware of the risk lying quietly in their infrastructure  ```  This is a big problem, but there is no way to contact each of them to make sure they have understood it correctly before enabling a new feature like this.  I do believe that raising the starting range to somewhere in the billions would do more to reduce the likeliness of collision, but I also believe that defaulting delegation of subordinate ID's within any range is something better left to the administrators to configure and should probably not be a default configuration out of the box.  I prefer the second option since the first one as I mentioned would probably cause collisions with other environments.  CC'ing [@abbra](https://github.com/abbra) [@alexey-tikhonov](https://github.com/alexey-tikhonov) |
| --- |

All reactions

Sorry, something went wrong.

[![@JonnyWhatshisface](https://avatars.githubusercontent.com/u/6776518?s=80&u=64c9ca09a3c2d6b11d11fe2b1fb131567e72c482&v=4)](/JonnyWhatshisface)

Copy link

Author

### **[JonnyWhatshisface](/JonnyWhatshisface)** commented [Dec 27, 2024](#issuecomment-2563432879)

| I agree with both of your sentiments.   * A documentation update would not be sufficient alone because there is high a probability that many people may not even understand what the subordinate ID's are or how they work. This is especially true in large environments where SOD becomes a factor. (speaking from experience) * No range you set will guarantee not risking collisions. Thus, this "feature" is something that should only be enabled explicitly by the administrators who wish to use it. For regulated environments, this can create a major PCI and SOX problem.   It begs to question: what was the intended purpose of adding this default configuration? Whatever it is, I suspect the risk it introduces far outweighs whatever the benefit in doing so is. |
| --- |

All reactions

Sorry, something went wrong.

[![@carnil](https://avatars.githubusercontent.com/u/773068?s=80&u=54a9fd1cfc2b1abb34a487f17e07eb8a03cecdae&v=4)](/carnil)

Copy link

### **[carnil](/carnil)** commented [Dec 27, 2024](#issuecomment-2563438552) • edited Loading

| FTR: According to [CVE-2024-56433](https://www.cve.org/CVERecord?id=CVE-2024-56433) has been assigned. |
| --- |

All reactions

Sorry, something went wrong.

[![@alexey-tikhonov](https://avatars.githubusercontent.com/u/45339146?s=80&v=4)](/alexey-tikhonov)

Copy link

### **[alexey-tikhonov](/alexey-tikhonov)** commented [Dec 27, 2024](#issuecomment-2563590054)

| Choosing a higher range of IDs would have meant a higher risk of collision with other suppliers. There is no perfect solution and this needs to be assessed very carefully.  If you want to keep auto assignment then, imo, 2147483648…4294967294 range would be the best bet as it doesn't conflict systemd (<https://systemd.io/UIDS-GIDS/>) and matches what IPA does. |
| --- |

All reactions

Sorry, something went wrong.

[![@JonnyWhatshisface](https://avatars.githubusercontent.com/u/6776518?s=80&u=64c9ca09a3c2d6b11d11fe2b1fb131567e72c482&v=4)](/JonnyWhatshisface)

Copy link

Author

### **[JonnyWhatshisface](/JonnyWhatshisface)** commented [Dec 27, 2024](#issuecomment-2563768672) via email • edited Loading

| One thing to keep in mind is that in Financial environments regulated by FINRA, allowing any system account or network user to arbitrarily change ID’s is a major problem. In those cases, even if you increase the default range to a high enough range that collision is unlikely, it still puts such environments at risk of running in to issues with regulators. I believe the right answer here is to disable it by default entirely. Why is it needed? What benefit are you gaining from assigning arbitrary subordinate id delegations as a default for local users? |
| --- |

All reactions

Sorry, something went wrong.

[![@abbra](https://avatars.githubusercontent.com/u/2066?s=80&u=7be1e8141ed012bac924d46be5de0d525994ec36&v=4)](/abbra)

Copy link

### **[abbra](/abbra)** commented [Jan 11, 2025](#issuecomment-2585237098)

| Note that pluggable subid support does not allow to use multiple subid modules, so if you are supplying subid mappings via SSSD from a centralized source (e.g. FreeIPA), the local source (`/etc/subuid` and `/etc/subgid`) would not be used at all. In FreeIPA we do not allocate subids to users by default, it has to be an explicit action done centrally first.  For purely local setup I believe it should also be done explicitly. However, we still cannot agree with systemd folks on a way to jointly define and manage ID ranges used for various types of objects in the ID space. Sadly, most of allocation decisions therefore are static. |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fshadow-maint%2Fshadow%2Fissues%2F1157)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

5 participants

[![@abbra](https://avatars.githubusercontent.com/u/2066?s=52&v=4)](/abbra) [![@carnil](https://avatars.githubusercontent.com/u/773068?s=52&v=4)](/carnil) [![@ikerexxe](https://avatars.githubusercontent.com/u/2324748?s=52&v=4)](/ikerexxe) [![@JonnyWhatshisface](https://avatars.githubusercontent.com/u/6776518?s=52&v=4)](/JonnyWhatshisface) [![@alexey-tikhonov](https://avatars.githubusercontent.com/u/45339146?s=52&v=4)](/alexey-tikhonov)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_29eb316f_20250115_082820.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshadow-maint%2Fshadow%2Freleases%2Ftag%2F4.4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshadow-maint%2Fshadow%2Freleases%2Ftag%2F4.4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=shadow-maint%2Fshadow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shadow-maint](/shadow-maint)
/
**[shadow](/shadow-maint/shadow)**
Public

* [Notifications](/login?return_to=%2Fshadow-maint%2Fshadow) You must be signed in to change notification settings
* [Fork
  240](/login?return_to=%2Fshadow-maint%2Fshadow)
* [Star
   315](/login?return_to=%2Fshadow-maint%2Fshadow)

* [Code](/shadow-maint/shadow/tree/4.4)
* [Issues
  87](/shadow-maint/shadow/issues)
* [Pull requests
  34](/shadow-maint/shadow/pulls)
* [Actions](/shadow-maint/shadow/actions)
* [Projects
  0](/shadow-maint/shadow/projects)
* [Wiki](/shadow-maint/shadow/wiki)
* [Security](/shadow-maint/shadow/security)
* [Insights](/shadow-maint/shadow/pulse)

Additional navigation options

* [Code](/shadow-maint/shadow/tree/4.4)
* [Issues](/shadow-maint/shadow/issues)
* [Pull requests](/shadow-maint/shadow/pulls)
* [Actions](/shadow-maint/shadow/actions)
* [Projects](/shadow-maint/shadow/projects)
* [Wiki](/shadow-maint/shadow/wiki)
* [Security](/shadow-maint/shadow/security)
* [Insights](/shadow-maint/shadow/pulse)

1. [Releases](/shadow-maint/shadow/releases)
2. [4.4](/shadow-maint/shadow/releases/tag/4.4)

# Shadow 4.4

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/shadow-maint/shadow/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...4.4)

 Loading

[View all tags](/shadow-maint/shadow/tags)

![@hallyn](https://avatars.githubusercontent.com/u/1359441?s=40&v=4)
[hallyn](/hallyn)
released this
02 Dec 22:05

·
[1864 commits](/shadow-maint/shadow/compare/4.4...master)
to master
since this release

[4.4](/shadow-maint/shadow/tree/4.4)

[`68061f2`](/shadow-maint/shadow/commit/68061f2059124f5aa450dfbf6bbad3e7a6f65f9f)

```
    * Changes since 4.2.1:

      - Documentation, error report and translations updates
      - Replace path_max with 32
      - User namespace support fixes/updates including:
        - Correct sanity checks in newXidmap
        - Fix building without subuid support
        - Add /etc/subuid support for UID matching
        - Support subuid for nonlocal users
        - Default to 65536 subuid allocations
        - Respect -r
        - Check for range overflows
      - Add tests from svn tree
      - Use AC_CHECK_SIZEOF for uid_t size checks
      - Accomodate missing /etc and login.defs
      - Support FORCE_SHADOW
      - Be more robust in hostile environment
      - Allow removing a primary group
      - Clear passwords on __pw_dup errors
      - Memory leak fix in commonio_update and get_map_ranges
      - Fix resource leak in syslog_sg
      - Fix user busy error at userdel
      - Support set/clear lastlog record via lastlog command
      - Add --no-create-home as longopt for -M
      - Fix signal races
      - Reduce syslog priority of common usage events

```

 Assets
6

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2449f4d8_20250115_082818.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshadow-maint%2Fshadow%2Fblob%2Fe2512d5741d4a44bdd81a8c2d0029b6222728cf0%2Fetc%2Flogin.defs)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fshadow-maint%2Fshadow%2Fblob%2Fe2512d5741d4a44bdd81a8c2d0029b6222728cf0%2Fetc%2Flogin.defs)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=shadow-maint%2Fshadow)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[shadow-maint](/shadow-maint)
/
**[shadow](/shadow-maint/shadow)**
Public

* [Notifications](/login?return_to=%2Fshadow-maint%2Fshadow) You must be signed in to change notification settings
* [Fork
  240](/login?return_to=%2Fshadow-maint%2Fshadow)
* [Star
   315](/login?return_to=%2Fshadow-maint%2Fshadow)

* [Code](/shadow-maint/shadow)
* [Issues
  87](/shadow-maint/shadow/issues)
* [Pull requests
  34](/shadow-maint/shadow/pulls)
* [Actions](/shadow-maint/shadow/actions)
* [Projects
  0](/shadow-maint/shadow/projects)
* [Wiki](/shadow-maint/shadow/wiki)
* [Security](/shadow-maint/shadow/security)
* [Insights](/shadow-maint/shadow/pulse)

Additional navigation options

* [Code](/shadow-maint/shadow)
* [Issues](/shadow-maint/shadow/issues)
* [Pull requests](/shadow-maint/shadow/pulls)
* [Actions](/shadow-maint/shadow/actions)
* [Projects](/shadow-maint/shadow/projects)
* [Wiki](/shadow-maint/shadow/wiki)
* [Security](/shadow-maint/shadow/security)
* [Insights](/shadow-maint/shadow/pulse)

## Files

 e2512d5
## Breadcrumbs

1. [shadow](/shadow-maint/shadow/tree/e2512d5741d4a44bdd81a8c2d0029b6222728cf0)
2. /[etc](/shadow-maint/shadow/tree/e2512d5741d4a44bdd81a8c2d0029b6222728cf0/etc)
/
# login.defs

Copy path Blame  Blame
## Latest commit

## History

[History](/shadow-maint/shadow/commits/e2512d5741d4a44bdd81a8c2d0029b6222728cf0/etc/login.defs)473 lines (416 loc) · 13.2 KB e2512d5
## Breadcrumbs

1. [shadow](/shadow-maint/shadow/tree/e2512d5741d4a44bdd81a8c2d0029b6222728cf0)
2. /[etc](/shadow-maint/shadow/tree/e2512d5741d4a44bdd81a8c2d0029b6222728cf0/etc)
/
# login.defs

Top
## File metadata and controls

* Code
* Blame

473 lines (416 loc) · 13.2 KB[Raw](https://github.com/shadow-maint/shadow/raw/e2512d5741d4a44bdd81a8c2d0029b6222728cf0/etc/login.defs)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473## /etc/login.defs - Configuration control definitions for the shadow package.## $Id$#
## Delay in seconds before being allowed another attempt after a login failure# Note: When PAM is used, some modules may enforce a minimum delay (e.g.# pam\_unix(8) enforces a 2s delay)#FAIL\_DELAY 3
## Enable logging and display of /var/log/faillog login(1) failure info.#FAILLOG\_ENAB yes
## Enable display of unknown usernames when login(1) failures are recorded.#LOG\_UNKFAIL\_ENAB no
## Enable logging of successful logins#LOG\_OK\_LOGINS no
## Enable logging and display of /var/log/lastlog login(1) time info.#LASTLOG\_ENAB yes
## Limit the highest user ID number for which the lastlog entries should# be updated.## No LASTLOG\_UID\_MAX means that there is no user ID limit for writing# lastlog entries.##LASTLOG\_UID\_MAX
## Enable checking and display of mailbox status upon login.## Disable if the shell startup files already check for mail# ("mailx -e" or equivalent).#MAIL\_CHECK\_ENAB yes
## Enable additional checks upon password changes.#OBSCURE\_CHECKS\_ENAB yes
## Enable checking of time restrictions specified in /etc/porttime.#PORTTIME\_CHECKS\_ENAB yes
## Enable setting of ulimit, umask, and niceness from passwd(5) gecos field.#QUOTAS\_ENAB yes
## Enable "syslog" logging of su(1) activity - in addition to sulog file logging.# SYSLOG\_SG\_ENAB does the same for newgrp(1) and sg(1).#SYSLOG\_SU\_ENAB yesSYSLOG\_SG\_ENAB yes
## If defined, either full pathname of a file containing device names or# a ":" delimited list of device names. Root logins will be allowed only# from these devices.#CONSOLE /etc/securetty#CONSOLE console:tty01:tty02:tty03:tty04
## If defined, all su(1) activity is logged to this file.##SULOG\_FILE /var/log/sulog
## If defined, ":" delimited list of "message of the day" files to# be displayed upon login.#MOTD\_FILE /etc/motd#MOTD\_FILE /etc/motd:/usr/lib/news/news-motd
## If defined, this file will be output before each login(1) prompt.##ISSUE\_FILE /etc/issue
## If defined, file which maps tty line to TERM environment parameter.# Each line of the file is in a format similar to "vt100 tty01".##TTYTYPE\_FILE /etc/ttytype
## If defined, login(1) failures will be logged here in a utmp format.# last(1), when invoked as lastb(1), will read /var/log/btmp, so...#FTMP\_FILE /var/log/btmp
## If defined, name of file whose presence will inhibit non-root# logins. The content of this file should be a message indicating# why logins are inhibited.#NOLOGINS\_FILE /etc/nologin
## If defined, the command name to display when running "su -". For# example, if this is defined as "su" then ps(1) will display the# command as "-su". If not defined, then ps(1) will display the# name of the shell actually being run, e.g. something like "-sh".#SU\_NAME su
## \*REQUIRED\*# Directory where mailboxes reside, \_or\_ name of file, relative to the# home directory. If you \_do\_ define both, MAIL\_DIR takes precedence.#MAIL\_DIR /var/spool/mail#MAIL\_FILE .mail
## If defined, file which inhibits all the usual chatter during the login# sequence. If a full pathname, then hushed mode will be enabled if the# user's name or shell are found in the file. If not a full pathname, then# hushed mode will be enabled if the file exists in the user's home directory.#HUSHLOGIN\_FILE .hushlogin#HUSHLOGIN\_FILE /etc/hushlogins
## If defined, either a TZ environment parameter spec or the# fully-rooted pathname of a file containing such a spec.##ENV\_TZ TZ=CST6CDT#ENV\_TZ /etc/tzname
## If defined, an HZ environment parameter spec.## for Linux/x86ENV\_HZ HZ=100# For Linux/Alpha...#ENV\_HZ HZ=1024
## \*REQUIRED\* The default PATH settings, for superuser and normal users.## (they are minimal, add the rest in the shell startup files)ENV\_SUPATH PATH=/sbin:/bin:/usr/sbin:/usr/binENV\_PATH PATH=/bin:/usr/bin
## Terminal permissions## TTYGROUP Login tty will be assigned this group ownership.# TTYPERM Login tty will be set to this permission.## If you have a write(1) program which is "setgid" to a special group# which owns the terminals, define TTYGROUP as the number of such group# and TTYPERM as 0620. Otherwise leave TTYGROUP commented out and# set TTYPERM to either 622 or 600.#TTYGROUP ttyTTYPERM 0600
## Login configuration initializations:## ERASECHAR Terminal ERASE character ('\010' = backspace).# KILLCHAR Terminal KILL character ('\025' = CTRL/U).# ULIMIT Default "ulimit" value.## The ERASECHAR and KILLCHAR are used only on System V machines.# The ULIMIT is used only if the system supports it.# (now it works with setrlimit too; ulimit is in 512-byte units)## Prefix these values with "0" to get octal, "0x" to get hexadecimal.#ERASECHAR 0177KILLCHAR 025#ULIMIT 2097152
# Default initial "umask" value used by login(1) on non-PAM enabled systems.# Default "umask" value for pam\_umask(8) on PAM enabled systems.# UMASK is also used by useradd(8) and newusers(8) to set the mode for new# home directories if HOME\_MODE is not set.# 022 is the default value, but 027, or even 077, could be considered# for increased privacy. There is no One True Answer here: each sysadmin# must make up their mind.UMASK 022
# HOME\_MODE is used by useradd(8) and newusers(8) to set the mode for new# home directories.# If HOME\_MODE is not set, the value of UMASK is used to create the mode.#HOME\_MODE 0700
## Password aging controls:## PASS\_MAX\_DAYS Maximum number of days a password may be used.# PASS\_MIN\_DAYS Minimum number of days allowed between password changes.# PASS\_MIN\_LEN Minimum acceptable password length.# PASS\_WARN\_AGE Number of days warning given before a password expires.#PASS\_MAX\_DAYS 99999PASS\_MIN\_DAYS 0PASS\_MIN\_LEN 5PASS\_WARN\_AGE 7
## If "yes", the user must be listed as a member of the first gid 0 group# in /etc/group (called "root" on most Linux systems) to be able to "su"# to uid 0 accounts. If the group doesn't exist or is empty, no one# will be able to "su" to uid 0.#SU\_WHEEL\_ONLY no
## Min/max values for automatic uid selection in useradd(8)#UID\_MIN 1000UID\_MAX 60000# System accountsSYS\_UID\_MIN 101SYS\_UID\_MAX 999# Extra per user uidsSUB\_UID\_MIN 100000SUB\_UID\_MAX 600100000SUB\_UID\_COUNT 65536
## Min/max values for automatic gid selection in groupadd(8)#GID\_MIN 1000GID\_MAX 60000# System accountsSYS\_GID\_MIN 101SYS\_GID\_MAX 999# Extra per user group idsSUB\_GID\_MIN 100000SUB\_GID\_MAX 600100000SUB\_GID\_COUNT 65536
## Max number of login(1) retries if password is bad#LOGIN\_RETRIES 5
## Max time in seconds for login(1)#LOGIN\_TIMEOUT 60
## Maximum number of attempts to change password if rejected (too easy)#PASS\_CHANGE\_TRIES 5
## Warn about weak passwords (but still allow them) if you are root.#PASS\_ALWAYS\_WARN yes
## Number of significant characters in the password for crypt().# Default is 8, don't change unless your crypt() is better.# Ignored if MD5\_CRYPT\_ENAB set to "yes".##PASS\_MAX\_LEN 8
## Require password before chfn(1)/chsh(1) can make any changes.#CHFN\_AUTH yes
## Which fields may be changed by regular users using chfn(1) - use# any combination of letters "frwh" (full name, room number, work# phone, home phone). If not defined, no changes are allowed.# For backward compatibility, "yes" = "rwh" and "no" = "frwh".#CHFN\_RESTRICT rwh
## Password prompt (%s will be replaced by user name).## XXX - it doesn't work correctly yet, for now leave it commented out# to use the default which is just "Password: ".#LOGIN\_STRING "%s's Password: "
## Only works if compiled with MD5\_CRYPT defined:# If set to "yes", new passwords will be encrypted using the MD5-based# algorithm compatible with the one used by recent releases of FreeBSD.# It supports passwords of unlimited length and longer salt strings.# Set to "no" if you need to copy encrypted passwords to other systems# which don't understand the new algorithm. Default is "no".## Note: If you use PAM, it is recommended to use a value consistent with# the PAM modules configuration.## This variable is deprecated. You should use ENCRYPT\_METHOD instead.##MD5\_CRYPT\_ENAB no
## Only works if compiled with ENCRYPTMETHOD\_SELECT defined:# If set to MD5, MD5-based algorithm will be used for encrypting password# If set to SHA256, SHA256-based algorithm will be used for encrypting password# If set to SHA512, SHA512-based algorithm will be used for encrypting password# If set to BCRYPT, BCRYPT-based algorithm will be used for encrypting password# If set to YESCRYPT, YESCRYPT-based algorithm will be used for encrypting password# If set to DES, DES-based algorithm will be used for encrypting password (default)# MD5 and DES should not be used for new hashes, see crypt(5) for recommendations.# Overrides the MD5\_CRYPT\_ENAB option## Note: If you use PAM, it is recommended to use a value consistent with# the PAM modules configuration.##ENCRYPT\_METHOD DES
## Only works if ENCRYPT\_METHOD is set to SHA256 or SHA512.## Define the number of SHA rounds.# With a lot of rounds, it is more difficult to brute-force the password.# However, more CPU resources will be needed to authenticate users if# this value is increased.## If not specified, the libc will choose the default number of rounds (5000),# which is orders of magnitude too low for modern hardware.# The values must be within the 1000-999999999 range.# If only one of the MIN or MAX values is set, then this value will be used.# If MIN > MAX, the highest value will be used.##SHA\_CRYPT\_MIN\_ROUNDS 5000#SHA\_CRYPT\_MAX\_ROUNDS 5000
## Only works if ENCRYPT\_METHOD is set to BCRYPT.## Define the number of BCRYPT rounds.# With a lot of rounds, it is more difficult to brute-force the password.# However, more CPU resources will be needed to authenticate users if# this value is increased.## If not specified, 13 rounds will be attempted.# If only one of the MIN or MAX values is set, then this value will be used.# If MIN > MAX, the highest value will be used.##BCRYPT\_MIN\_ROUNDS 13#BCRYPT\_MAX\_ROUNDS 13
## Only works if ENCRYPT\_METHOD is set to YESCRYPT.## Define the YESCRYPT cost factor.# With a higher cost factor, it is more difficult to brute-force the password.# However, more CPU time and more memory will be needed to authenticate users# if this value is increased.## If not specified, a cost factor of 5 will be used.# The value must be within the 1-11 range.##YESCRYPT\_COST\_FACTOR 5
## List of groups to add to the user's supplementary group set# when logging in from the console (as determined by the CONSOLE# setting). Default is none.## Use with caution - it is possible for users to gain permanent# access to these groups, even when not logged in from the console.# How to do it is left as an exercise for the reader...##CONSOLE\_GROUPS floppy:audio:cdrom
## Should login be allowed if we can't cd to the home directory?# Default is no.#DEFAULT\_HOME yes
## The pwck(8) utility emits a warning for any system account with a home# directory that does not exist. Some system accounts intentionally do# not have a home directory. Such accounts may have this string as# their home directory in /etc/passwd to avoid a spurious warning.#NONEXISTENT /nonexistent
## If this file exists and is readable, login environment will be# read from it. Every line should be in the form name=value.#ENVIRON\_FILE /etc/environment
## If defined, this command is run when removing a user.# It should remove any at/cron/print jobs etc. owned by# the user to be removed (passed as the first argument).##USERDEL\_CMD /usr/sbin/userdel\_local
## Enable setting of the umask group bits to be the same as owner bits# (examples: 022 -> 002, 077 -> 007) for non-root users, if the uid is# the same as gid, and username is the same as the primary group name.## This also enables userdel(8) to remove user groups if no members exist.#USERGROUPS\_ENAB yes
## If set to a non-zero number, the shadow utilities will make sure that# groups never have more than this number of users on one line.# This permits to support split groups (groups split into multiple lines,# with the same group ID, to avoid limitation of the line length in the# group file).## 0 is the default value and disables this feature.##MAX\_MEMBERS\_PER\_GROUP 0
## If useradd(8) should create home directories for users by default (non# system users only).# This option is overridden with the -M or -m flags on the useradd(8)# command-line.##CREATE\_HOME yes
## Force use shadow, even if shadow passwd & shadow group files are# missing.##FORCE\_SHADOW yes
## Allow newuidmap and newgidmap when running under an alternative# primary group.##GRANT\_AUX\_GROUP\_SUBIDS yes
## Prevents an empty password field to be interpreted as "no authentication# required".# Set to "yes" to prevent for all accounts# Set to "superuser" to prevent for UID 0 / root (default)# Set to "no" to not prevent for any account (dangerous, historical default)PREVENT\_NO\_AUTH superuser
## Select the HMAC cryptography algorithm.# Used in pam\_timestamp module to calculate the keyed-hash message# authentication code.## Note: It is recommended to check hmac(3) to see the possible algorithms# that are available in your system.##HMAC\_CRYPTO\_ALGO SHA512

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


