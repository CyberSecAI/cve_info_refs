=== Content from git.kernel.org_d21fc9d6_20250114_190325.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=21f1b85c8912262adf51707e63614a114425eb10)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=21f1b85c8912262adf51707e63614a114425eb10)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=21f1b85c8912262adf51707e63614a114425eb10)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=21f1b85c8912262adf51707e63614a114425eb10)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Björn Töpel <bjorn@rivosinc.com> | 2024-11-20 14:12:02 +0100 |
| --- | --- | --- |
| committer | Palmer Dabbelt <palmer@rivosinc.com> | 2024-12-11 11:44:21 -0800 |
| commit | [21f1b85c8912262adf51707e63614a114425eb10](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=21f1b85c8912262adf51707e63614a114425eb10) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=21f1b85c8912262adf51707e63614a114425eb10)) | |
| tree | [8de387fddc034909b72df5586031414df967f46d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=21f1b85c8912262adf51707e63614a114425eb10) | |
| parent | [b3431a8bb336cece8adc452437befa7d4534b2fd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b3431a8bb336cece8adc452437befa7d4534b2fd) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=21f1b85c8912262adf51707e63614a114425eb10&id2=b3431a8bb336cece8adc452437befa7d4534b2fd)) | |
| download | [linux-21f1b85c8912262adf51707e63614a114425eb10.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-21f1b85c8912262adf51707e63614a114425eb10.tar.gz) | |

riscv: mm: Do not call pmd dtor on vmemmap page table teardownThe vmemmap's, which is used for RV64 with SPARSEMEM\_VMEMMAP, page
tables are populated using pmd (page middle directory) hugetables.
However, the pmd allocation is not using the generic mechanism used by
the VMA code (e.g. pmd\_alloc()), or the RISC-V specific
create\_pgd\_mapping()/alloc\_pmd\_late(). Instead, the vmemmap page table
code allocates a page, and calls vmemmap\_set\_pmd(). This results in
that the pmd ctor is \*not\* called, nor would it make sense to do so.
Now, when tearing down a vmemmap page table pmd, the cleanup code
would unconditionally, and incorrectly call the pmd dtor, which
results in a crash (best case).
This issue was found when running the HMM selftests:
| tools/testing/selftests/mm# ./test\_hmm.sh smoke
| ... # when unloading the test\_hmm.ko module
| page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x10915b
| flags: 0x1000000000000000(node=0|zone=1)
| raw: 1000000000000000 0000000000000000 dead000000000122 0000000000000000
| raw: 0000000000000000 0000000000000000 00000001ffffffff 0000000000000000
| page dumped because: VM\_BUG\_ON\_PAGE(ptdesc->pmd\_huge\_pte)
| ------------[ cut here ]------------
| kernel BUG at include/linux/mm.h:3080!
| Kernel BUG [#1]
| Modules linked in: test\_hmm(-) sch\_fq\_codel fuse drm drm\_panel\_orientation\_quirks backlight dm\_mod
| CPU: 1 UID: 0 PID: 514 Comm: modprobe Tainted: G W 6.12.0-00982-gf2a4f1682d07 #2
| Tainted: [W]=WARN
| Hardware name: riscv-virtio qemu/qemu, BIOS 2024.10 10/01/2024
| epc : remove\_pgd\_mapping+0xbec/0x1070
| ra : remove\_pgd\_mapping+0xbec/0x1070
| epc : ffffffff80010a68 ra : ffffffff80010a68 sp : ff20000000a73940
| gp : ffffffff827b2d88 tp : ff6000008785da40 t0 : ffffffff80fbce04
| t1 : 0720072007200720 t2 : 706d756420656761 s0 : ff20000000a73a50
| s1 : ff6000008915cff8 a0 : 0000000000000039 a1 : 0000000000000008
| a2 : ff600003fff0de20 a3 : 0000000000000000 a4 : 0000000000000000
| a5 : 0000000000000000 a6 : c0000000ffffefff a7 : ffffffff824469b8
| s2 : ff1c0000022456c0 s3 : ff1ffffffdbfffff s4 : ff6000008915c000
| s5 : ff6000008915c000 s6 : ff6000008915c000 s7 : ff1ffffffdc00000
| s8 : 0000000000000001 s9 : ff1ffffffdc00000 s10: ffffffff819a31f0
| s11: ffffffffffffffff t3 : ffffffff8000c950 t4 : ff60000080244f00
| t5 : ff60000080244000 t6 : ff20000000a73708
| status: 0000000200000120 badaddr: ffffffff80010a68 cause: 0000000000000003
| [<ffffffff80010a68>] remove\_pgd\_mapping+0xbec/0x1070
| [<ffffffff80fd238e>] vmemmap\_free+0x14/0x1e
| [<ffffffff8032e698>] section\_deactivate+0x220/0x452
| [<ffffffff8032ef7e>] sparse\_remove\_section+0x4a/0x58
| [<ffffffff802f8700>] \_\_remove\_pages+0x7e/0xba
| [<ffffffff803760d8>] memunmap\_pages+0x2bc/0x3fe
| [<ffffffff02a3ca28>] dmirror\_device\_remove\_chunks+0x2ea/0x518 [test\_hmm]
| [<ffffffff02a3e026>] hmm\_dmirror\_exit+0x3e/0x1018 [test\_hmm]
| [<ffffffff80102c14>] \_\_riscv\_sys\_delete\_module+0x15a/0x2a6
| [<ffffffff80fd020c>] do\_trap\_ecall\_u+0x1f2/0x266
| [<ffffffff80fde0a2>] \_new\_vmalloc\_restore\_context\_a0+0xc6/0xd2
| Code: bf51 7597 0184 8593 76a5 854a 4097 0029 80e7 2c00 (9002) 7597
| ---[ end trace 0000000000000000 ]---
| Kernel panic - not syncing: Fatal exception in interrupt
Add a check to avoid calling the pmd dtor, if the calling context is
vmemmap\_free().
Fixes: c75a74f4ba19 ("riscv: mm: Add memory hotplugging support")
Signed-off-by: Björn Töpel <bjorn@rivosinc.com>
Reviewed-by: Alexandre Ghiti <alexghiti@rivosinc.com>
Link: [https://lore.kernel.org/r/20241120131203.1859787-1-bjorn@kernel.org](https://lore.kernel.org/r/20241120131203.1859787-1-bjorn%40kernel.org)
Cc: stable@vger.kernel.org
Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=21f1b85c8912262adf51707e63614a114425eb10)

| -rw-r--r-- | [arch/riscv/mm/init.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/riscv/mm/init.c?id=21f1b85c8912262adf51707e63614a114425eb10) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/arch/riscv/mm/init.c b/arch/riscv/mm/init.cindex 0e8c20adcd98df..fc53ce748c8049 100644--- a/[arch/riscv/mm/init.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/riscv/mm/init.c?id=b3431a8bb336cece8adc452437befa7d4534b2fd)+++ b/[arch/riscv/mm/init.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/riscv/mm/init.c?id=21f1b85c8912262adf51707e63614a114425eb10)@@ -1566,7 +1566,7 @@ static void \_\_meminit free\_pte\_table(pte\_t \*pte\_start, pmd\_t \*pmd) pmd\_clear(pmd); } -static void \_\_meminit free\_pmd\_table(pmd\_t \*pmd\_start, pud\_t \*pud)+static void \_\_meminit free\_pmd\_table(pmd\_t \*pmd\_start, pud\_t \*pud, bool is\_vmemmap) { struct page \*page = pud\_page(\*pud); struct ptdesc \*ptdesc = page\_ptdesc(page);@@ -1579,7 +1579,8 @@ static void \_\_meminit free\_pmd\_table(pmd\_t \*pmd\_start, pud\_t \*pud) return; } - pagetable\_pmd\_dtor(ptdesc);+ if (!is\_vmemmap)+ pagetable\_pmd\_dtor(ptdesc); if (PageReserved(page)) free\_reserved\_page(page); else@@ -1703,7 +1704,7 @@ static void \_\_meminit remove\_pud\_mapping(pud\_t \*pud\_base, unsigned long addr, un remove\_pmd\_mapping(pmd\_base, addr, next, is\_vmemmap, altmap);  if (pgtable\_l4\_enabled)- free\_pmd\_table(pmd\_base, pudp);+ free\_pmd\_table(pmd\_base, pudp, is\_vmemmap); } } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:02:02 +0000



=== Content from git.kernel.org_4768999f_20250114_190326.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=344945806f2f7af68be98bac02836c867f223aa9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=344945806f2f7af68be98bac02836c867f223aa9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=344945806f2f7af68be98bac02836c867f223aa9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=344945806f2f7af68be98bac02836c867f223aa9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Björn Töpel <bjorn@rivosinc.com> | 2024-11-20 14:12:02 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:12:59 +0100 |
| commit | [344945806f2f7af68be98bac02836c867f223aa9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=344945806f2f7af68be98bac02836c867f223aa9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=344945806f2f7af68be98bac02836c867f223aa9)) | |
| tree | [34609d14f7906e686e318d2717a8a4bf434daa7b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=344945806f2f7af68be98bac02836c867f223aa9) | |
| parent | [edd776618eee1e83a22be1845efa42e132d88133](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=edd776618eee1e83a22be1845efa42e132d88133) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=344945806f2f7af68be98bac02836c867f223aa9&id2=edd776618eee1e83a22be1845efa42e132d88133)) | |
| download | [linux-344945806f2f7af68be98bac02836c867f223aa9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-344945806f2f7af68be98bac02836c867f223aa9.tar.gz) | |

riscv: mm: Do not call pmd dtor on vmemmap page table teardowncommit 21f1b85c8912262adf51707e63614a114425eb10 upstream.
The vmemmap's, which is used for RV64 with SPARSEMEM\_VMEMMAP, page
tables are populated using pmd (page middle directory) hugetables.
However, the pmd allocation is not using the generic mechanism used by
the VMA code (e.g. pmd\_alloc()), or the RISC-V specific
create\_pgd\_mapping()/alloc\_pmd\_late(). Instead, the vmemmap page table
code allocates a page, and calls vmemmap\_set\_pmd(). This results in
that the pmd ctor is \*not\* called, nor would it make sense to do so.
Now, when tearing down a vmemmap page table pmd, the cleanup code
would unconditionally, and incorrectly call the pmd dtor, which
results in a crash (best case).
This issue was found when running the HMM selftests:
| tools/testing/selftests/mm# ./test\_hmm.sh smoke
| ... # when unloading the test\_hmm.ko module
| page: refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x10915b
| flags: 0x1000000000000000(node=0|zone=1)
| raw: 1000000000000000 0000000000000000 dead000000000122 0000000000000000
| raw: 0000000000000000 0000000000000000 00000001ffffffff 0000000000000000
| page dumped because: VM\_BUG\_ON\_PAGE(ptdesc->pmd\_huge\_pte)
| ------------[ cut here ]------------
| kernel BUG at include/linux/mm.h:3080!
| Kernel BUG [#1]
| Modules linked in: test\_hmm(-) sch\_fq\_codel fuse drm drm\_panel\_orientation\_quirks backlight dm\_mod
| CPU: 1 UID: 0 PID: 514 Comm: modprobe Tainted: G W 6.12.0-00982-gf2a4f1682d07 #2
| Tainted: [W]=WARN
| Hardware name: riscv-virtio qemu/qemu, BIOS 2024.10 10/01/2024
| epc : remove\_pgd\_mapping+0xbec/0x1070
| ra : remove\_pgd\_mapping+0xbec/0x1070
| epc : ffffffff80010a68 ra : ffffffff80010a68 sp : ff20000000a73940
| gp : ffffffff827b2d88 tp : ff6000008785da40 t0 : ffffffff80fbce04
| t1 : 0720072007200720 t2 : 706d756420656761 s0 : ff20000000a73a50
| s1 : ff6000008915cff8 a0 : 0000000000000039 a1 : 0000000000000008
| a2 : ff600003fff0de20 a3 : 0000000000000000 a4 : 0000000000000000
| a5 : 0000000000000000 a6 : c0000000ffffefff a7 : ffffffff824469b8
| s2 : ff1c0000022456c0 s3 : ff1ffffffdbfffff s4 : ff6000008915c000
| s5 : ff6000008915c000 s6 : ff6000008915c000 s7 : ff1ffffffdc00000
| s8 : 0000000000000001 s9 : ff1ffffffdc00000 s10: ffffffff819a31f0
| s11: ffffffffffffffff t3 : ffffffff8000c950 t4 : ff60000080244f00
| t5 : ff60000080244000 t6 : ff20000000a73708
| status: 0000000200000120 badaddr: ffffffff80010a68 cause: 0000000000000003
| [<ffffffff80010a68>] remove\_pgd\_mapping+0xbec/0x1070
| [<ffffffff80fd238e>] vmemmap\_free+0x14/0x1e
| [<ffffffff8032e698>] section\_deactivate+0x220/0x452
| [<ffffffff8032ef7e>] sparse\_remove\_section+0x4a/0x58
| [<ffffffff802f8700>] \_\_remove\_pages+0x7e/0xba
| [<ffffffff803760d8>] memunmap\_pages+0x2bc/0x3fe
| [<ffffffff02a3ca28>] dmirror\_device\_remove\_chunks+0x2ea/0x518 [test\_hmm]
| [<ffffffff02a3e026>] hmm\_dmirror\_exit+0x3e/0x1018 [test\_hmm]
| [<ffffffff80102c14>] \_\_riscv\_sys\_delete\_module+0x15a/0x2a6
| [<ffffffff80fd020c>] do\_trap\_ecall\_u+0x1f2/0x266
| [<ffffffff80fde0a2>] \_new\_vmalloc\_restore\_context\_a0+0xc6/0xd2
| Code: bf51 7597 0184 8593 76a5 854a 4097 0029 80e7 2c00 (9002) 7597
| ---[ end trace 0000000000000000 ]---
| Kernel panic - not syncing: Fatal exception in interrupt
Add a check to avoid calling the pmd dtor, if the calling context is
vmemmap\_free().
Fixes: c75a74f4ba19 ("riscv: mm: Add memory hotplugging support")
Signed-off-by: Björn Töpel <bjorn@rivosinc.com>
Reviewed-by: Alexandre Ghiti <alexghiti@rivosinc.com>
Link: [https://lore.kernel.org/r/20241120131203.1859787-1-bjorn@kernel.org](https://lore.kernel.org/r/20241120131203.1859787-1-bjorn%40kernel.org)
Cc: stable@vger.kernel.org
Signed-off-by: Palmer Dabbelt <palmer@rivosinc.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=344945806f2f7af68be98bac02836c867f223aa9)

| -rw-r--r-- | [arch/riscv/mm/init.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/riscv/mm/init.c?id=344945806f2f7af68be98bac02836c867f223aa9) | 7 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 3 deletions

| diff --git a/arch/riscv/mm/init.c b/arch/riscv/mm/init.cindex 0e8c20adcd98df..fc53ce748c8049 100644--- a/[arch/riscv/mm/init.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/riscv/mm/init.c?id=edd776618eee1e83a22be1845efa42e132d88133)+++ b/[arch/riscv/mm/init.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/riscv/mm/init.c?id=344945806f2f7af68be98bac02836c867f223aa9)@@ -1566,7 +1566,7 @@ static void \_\_meminit free\_pte\_table(pte\_t \*pte\_start, pmd\_t \*pmd) pmd\_clear(pmd); } -static void \_\_meminit free\_pmd\_table(pmd\_t \*pmd\_start, pud\_t \*pud)+static void \_\_meminit free\_pmd\_table(pmd\_t \*pmd\_start, pud\_t \*pud, bool is\_vmemmap) { struct page \*page = pud\_page(\*pud); struct ptdesc \*ptdesc = page\_ptdesc(page);@@ -1579,7 +1579,8 @@ static void \_\_meminit free\_pmd\_table(pmd\_t \*pmd\_start, pud\_t \*pud) return; } - pagetable\_pmd\_dtor(ptdesc);+ if (!is\_vmemmap)+ pagetable\_pmd\_dtor(ptdesc); if (PageReserved(page)) free\_reserved\_page(page); else@@ -1703,7 +1704,7 @@ static void \_\_meminit remove\_pud\_mapping(pud\_t \*pud\_base, unsigned long addr, un remove\_pmd\_mapping(pmd\_base, addr, next, is\_vmemmap, altmap);  if (pgtable\_l4\_enabled)- free\_pmd\_table(pmd\_base, pudp);+ free\_pmd\_table(pmd\_base, pudp, is\_vmemmap); } } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:02:03 +0000


