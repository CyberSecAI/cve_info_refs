=== Content from gist.github.com_16f9a278_20250115_101311.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fharuki3hhh%2Fe468ac3b3234f9bc42a9cc367457119a)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fharuki3hhh%2Fe468ac3b3234f9bc42a9cc367457119a&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fharuki3hhh%2Fe468ac3b3234f9bc42a9cc367457119a) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fharuki3hhh%2Fe468ac3b3234f9bc42a9cc367457119a&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@haruki3hhh](https://avatars.githubusercontent.com/u/135201297?s=64&v=4)](/haruki3hhh)

# [haruki3hhh](/haruki3hhh)/**[report.md](/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a)**

Last active
November 8, 2024 18:24

Show Gist options

* [Download ZIP](/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a/archive/a495d2b2ae50ebad8366ef34992d86627641c6ca.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fharuki3hhh%2Fe468ac3b3234f9bc42a9cc367457119a)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2Fharuki3hhh%2Fe468ac3b3234f9bc42a9cc367457119a)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a.js&quot;&gt;&lt;/script&gt;
* Save haruki3hhh/e468ac3b3234f9bc42a9cc367457119a to your computer and use it in GitHub Desktop.

[Code](/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a)
[Revisions
2](/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a.js&quot;&gt;&lt;/script&gt;

Save haruki3hhh/e468ac3b3234f9bc42a9cc367457119a to your computer and use it in GitHub Desktop.

[Download ZIP](/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a/archive/a495d2b2ae50ebad8366ef34992d86627641c6ca.zip)

Advisory for CVE-2024-27532

 [Raw](/haruki3hhh/e468ac3b3234f9bc42a9cc367457119a/raw/a495d2b2ae50ebad8366ef34992d86627641c6ca/report.md)

[**report.md**](#file-report-md)

# Discoverers: Ziyi Guo, quhe, L4Nce

# Details:

> [Suggested description]
> wasm-micro-runtime (aka WebAssembly Micro Runtime or WAMR) 06df58f is
> vulnerable to NULL Pointer Dereference in function
> `block\_type\_get\_result\_types.
>
> ---
>
> [VulnerabilityType Other]
> NULL Pointer Dereference
>
> ---
>
> [Vendor of Product]
> <https://github.com/bytecodealliance/wasm-micro-runtime.git>
>
> ---
>
> [Affected Product Code Base]
> <https://github.com/bytecodealliance/wasm-micro-runtime.git> 06df58f - [bytecodealliance/wasm-micro-runtime#3130](https://github.com/bytecodealliance/wasm-micro-runtime/issues/3130)
>
> ---
>
> [Affected Component]
> whole wasm runtime is affected
>
> ---
>
> [Attack Type]
> Remote
>
> ---
>
> [Impact Denial of Service]
> true
>
> ---
>
> [Attack Vectors]
> a crafted wasm file
>
> ---
>
> [Reference]
> [bytecodealliance/wasm-micro-runtime#3130](https://github.com/bytecodealliance/wasm-micro-runtime/issues/3130)
>
> ---
>
> [Has vendor confirmed or acknowledged the vulnerability?]
> true
>
> ---

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fharuki3hhh%2Fe468ac3b3234f9bc42a9cc367457119a)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0983e7d9_20250115_101315.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbytecodealliance%2Fwasm-micro-runtime%2Fissues%2F3130)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fbytecodealliance%2Fwasm-micro-runtime%2Fissues%2F3130)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=bytecodealliance%2Fwasm-micro-runtime)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[bytecodealliance](/bytecodealliance)
/
**[wasm-micro-runtime](/bytecodealliance/wasm-micro-runtime)**
Public

* [Notifications](/login?return_to=%2Fbytecodealliance%2Fwasm-micro-runtime) You must be signed in to change notification settings
* [Fork
  646](/login?return_to=%2Fbytecodealliance%2Fwasm-micro-runtime)
* [Star
   5.1k](/login?return_to=%2Fbytecodealliance%2Fwasm-micro-runtime)

* [Code](/bytecodealliance/wasm-micro-runtime)
* [Issues
  388](/bytecodealliance/wasm-micro-runtime/issues)
* [Pull requests
  20](/bytecodealliance/wasm-micro-runtime/pulls)
* [Discussions](/bytecodealliance/wasm-micro-runtime/discussions)
* [Actions](/bytecodealliance/wasm-micro-runtime/actions)
* [Projects
  0](/bytecodealliance/wasm-micro-runtime/projects)
* [Wiki](/bytecodealliance/wasm-micro-runtime/wiki)
* [Security](/bytecodealliance/wasm-micro-runtime/security)
* [Insights](/bytecodealliance/wasm-micro-runtime/pulse)

Additional navigation options

* [Code](/bytecodealliance/wasm-micro-runtime)
* [Issues](/bytecodealliance/wasm-micro-runtime/issues)
* [Pull requests](/bytecodealliance/wasm-micro-runtime/pulls)
* [Discussions](/bytecodealliance/wasm-micro-runtime/discussions)
* [Actions](/bytecodealliance/wasm-micro-runtime/actions)
* [Projects](/bytecodealliance/wasm-micro-runtime/projects)
* [Wiki](/bytecodealliance/wasm-micro-runtime/wiki)
* [Security](/bytecodealliance/wasm-micro-runtime/security)
* [Insights](/bytecodealliance/wasm-micro-runtime/pulse)

# NULL Pointer Dereference in block\_type\_get\_result\_types #3130

[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy link[New issue](/login?return_to=)[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[NULL Pointer Dereference in block\_type\_get\_result\_types](#top)#3130Copy linkLabels[bugSomething isn't working](https://github.com/bytecodealliance/wasm-micro-runtime/issues?q=state%3Aopen%20label%3A%22bug%22)Something isn't working[fixed](https://github.com/bytecodealliance/wasm-micro-runtime/issues?q=state%3Aopen%20label%3A%22fixed%22)[wasm loader](https://github.com/bytecodealliance/wasm-micro-runtime/issues?q=state%3Aopen%20label%3A%22wasm%20loader%22)![@haruki3hhh](https://avatars.githubusercontent.com/u/135201297?u=65ec58dae1af5e0f5b4517f23559cf3d9659c5ce&v=4&size=80)
## Description

![@haruki3hhh](https://avatars.githubusercontent.com/u/135201297?u=65ec58dae1af5e0f5b4517f23559cf3d9659c5ce&v=4&size=48)[haruki3hhh](https://github.com/haruki3hhh)opened [on Feb 5, 2024](https://github.com/bytecodealliance/wasm-micro-runtime/issues/3130#issue-2117407729)
### Version

commit [06df58f](https://github.com/bytecodealliance/wasm-micro-runtime/commit/06df58f20eeb46351b0ca7ff46d21eb541d2784a) (HEAD -> main, origin/main, origin/HEAD)

### Compile

```
cd wasm-micro-runtime/product-mini/platforms/linux/
cmake -DCMAKE_C_COMPILER="gcc" -DCMAKE_C_FLAGS="-g -fsanitize=address -fno-omit-frame-pointer" -DCMAKE_LINKER_FLAGS="-g -fsanitize=address -fno-omit-frame-pointer" ..
make -j
```
### ASAN Log

```
AddressSanitizer:DEADLYSIGNAL
=================================================================
==866714==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x565157bc383f bp 0x7ffe6cfb60d0 sp 0x7ffe6cfb5f90 T0)
==866714==The signal is caused by a READ memory access.
==866714==Hint: address points to the zero page.
    #0 0x565157bc383e in block_type_get_result_types /root/wasm-micro-runtime/core/iwasm/interpreter/wasm.h:875
    #1 0x565157bc383e in block_type_get_result_types /root/wasm-micro-runtime/core/iwasm/interpreter/wasm.h:863
    #2 0x565157bc383e in wasm_loader_check_br /root/wasm-micro-runtime/core/iwasm/interpreter/wasm_loader.c:7092
    #3 0x565157bc383e in check_branch_block /root/wasm-micro-runtime/core/iwasm/interpreter/wasm_loader.c:7143
    #4 0x565157bd0a73 in wasm_loader_prepare_bytecode /root/wasm-micro-runtime/core/iwasm/interpreter/wasm_loader.c:8127
    #5 0x565157bd0a73 in load_from_sections /root/wasm-micro-runtime/core/iwasm/interpreter/wasm_loader.c:3852
    #6 0x565157bdf654 in load /root/wasm-micro-runtime/core/iwasm/interpreter/wasm_loader.c:4215
    #7 0x565157bdf654 in wasm_loader_load /root/wasm-micro-runtime/core/iwasm/interpreter/wasm_loader.c:4391
    #8 0x565157b5571c in main /root/wasm-micro-runtime/product-mini/platforms/linux/../posix/main.c:885
    #9 0x7f54f8c2a082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082)
    #10 0x565157b56b4d in _start (/root/wasm-micro-runtime/product-mini/platforms/linux/build_asan/iwasm+0x22b4d)

AddressSanitizer can not provide additional info.
SUMMARY: AddressSanitizer: SEGV /root/wasm-micro-runtime/core/iwasm/interpreter/wasm.h:875 in block_type_get_result_types
==866714==ABORTING

```
### Reproduce

```
./iwasm /root/wasm-fuzz-instruction/fuzz_out/crashes/id\:000000\,sig\:06\,src\:028368\,op\:python\,pos\:0
```
### PoC

[PoC](https://github.com/haruki3hhh/fuzzing/blob/main/id%3A000000%2Csig%3A06%2Csrc%3A028368%2Cop%3Apython%2Cpos%3A0)

## Metadata

### Assignees

No one assigned

### Labels

[bugSomething isn't working](https://github.com/bytecodealliance/wasm-micro-runtime/issues?q=state%3Aopen%20label%3A%22bug%22)Something isn't working[fixed](https://github.com/bytecodealliance/wasm-micro-runtime/issues?q=state%3Aopen%20label%3A%22fixed%22)[wasm loader](https://github.com/bytecodealliance/wasm-micro-runtime/issues?q=state%3Aopen%20label%3A%22wasm%20loader%22)
### Type

No type
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


