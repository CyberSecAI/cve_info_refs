```
{
  "vulnerability": {
    "root_cause": "Integer overflow when calculating the size of a PostgreSQL protocol message, specifically in the length field of the message. When a message exceeds 4GB, a 32-bit integer representing the message size overflows, leading to a much smaller value being written in the message header. The rest of the data is then interpreted as a new message.",
    "weaknesses": [
      "Integer overflow",
      "Improper message parsing"
    ],
    "impact": "SQL injection vulnerability. By crafting a large message that triggers the overflow, attackers can inject arbitrary SQL commands into the connection between an application and a PostgreSQL database. This includes the ability to read, write, and delete data, and potentially achieve code execution if the database is misconfigured.",
    "attack_vectors": [
      "Sending a single, large query or bind message that exceeds 4GB in size, causing integer overflow in the length field."
    ],
    "required_attacker_capabilities": "The attacker needs to control data that is used to construct a SQL query or bind message. They must also be able to send messages exceeding 4GB to the database server. This can include user input, data obtained through SSRF or other means that bypass request size limits.",
    "additional_details": [
      "The vulnerability is present in multiple Go, C, and Rust libraries. Java and JavaScript libraries were vulnerable in theory but not exploitable due to language limitations on buffer size.",
        "The provided YouTube video elaborates on how the vulnerability works and different bypass methods for request size limits. It also introduces exploitation techniques such as 'Knob Sleds' and 'Trampolines' to make the exploitation more reliable.",
        "The vulnerability is present in both the pgx and pgproto3 libraries.",
       "pgx versions prior to v4.18.2 and v5.5.4 are vulnerable.",
        "pgproto3 versions prior to commit `945c212` are vulnerable.",
        "The vulnerability can be exploited in the default configuration of applications that use the vulnerable libraries, such as Harbor."
    ]
  }
}
```