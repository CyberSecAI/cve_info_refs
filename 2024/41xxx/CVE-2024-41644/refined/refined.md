```
{
  "vulnerability_details": {
    "root_cause": "The dynamic parameter callback threads in ROS2 Navigation2 were not being properly shut down during the cleanup phase of lifecycle nodes. Instead of removing the callback, the code was only resetting the `dyn_params_handler_`, leading to a use-after-free vulnerability when the callback thread continued to execute and access deallocated resources.",
    "weaknesses": [
      "Improper resource management",
      "Use-after-free"
    ],
    "impact": "A use-after-free vulnerability that can lead to crashes, denial of service, or potentially arbitrary code execution.",
    "attack_vectors": [
      "Sending dynamic parameter change requests to a ROS2 node that utilizes dynamic parameters, followed by node deactivation/cleanup."
    ],
    "required_capabilities": [
      "Ability to send parameter change requests to a ROS2 node.",
      "Ability to trigger the lifecycle transition of a ROS2 node."
    ],
    "additional_details": "The fix involves explicitly removing the dynamic parameter callback using `remove_on_set_parameters_callback()` before resetting the handler. This ensures that the callback threads are properly shut down before resources are released. The vulnerability was found in multiple packages of navigation2, including `nav2_amcl`, `nav2_controller`, `nav2_costmap_2d`, `nav2_docking`, `nav2_velocity_smoother`, `waypoint_follower`, `nav2_dwb_controller`, `nav2_graceful_controller`, `nav2_mppi_controller`, `nav2_navfn_planner`, `nav2_regulated_pure_pursuit_controller`, `nav2_rotation_shim_controller`, and `nav2_smac_planner`"
  }
}
```