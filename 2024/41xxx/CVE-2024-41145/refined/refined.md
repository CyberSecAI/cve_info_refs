- **Root cause of vulnerability**: The `Microsoft Teams WebView.app` helper app on macOS has the `com.apple.security.cs.disable-library-validation` entitlement enabled, which disables the hardened runtime's library hijacking protections. Additionally, it uses `dlopen` to load the `Microsoft Edge Framework` library at runtime, creating a possibility for library injection.
- **Weaknesses/vulnerabilities present**:
    -   **Disabled Library Validation**: The `com.apple.security.cs.disable-library-validation` entitlement set to true allows the loading of unsigned dynamic libraries, effectively nullifying the hardened runtime's protection against library hijacking.
    -   **Dynamic Library Loading with dlopen**: The application uses `dlopen` to load the `Microsoft Edge Framework` library, making it susceptible to library injection.
- **Impact of exploitation**: A malicious application can inject a crafted library into `Microsoft Teams WebView.app` and then start the program to trigger the vulnerability. This allows the malicious library to leverage Teamsâ€™ access privileges, potentially leading to a permission bypass and allowing the malicious application to execute code with the vulnerable application's permissions. This could include access to resources like audio recording which would appear as if it's from the main Teams application.
- **Attack vectors**: A malicious application can inject a library by exploiting the disabled library validation and the use of `dlopen` to load the `Microsoft Edge Framework` at runtime by placing a malicious library in the expected location
- **Required attacker capabilities/position**: The attacker needs to be able to run a malicious application on the target macOS system to perform the library injection. The attacker also needs to be able to place the malicious library in a location where the vulnerable application will attempt to load it at runtime.