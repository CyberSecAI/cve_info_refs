=== Content from lists.debian.org_d0d32a04_20250114_232126.html ===


---

[[Date Prev](msg00021.html)][[Date Next](msg00023.html)]
[[Thread Prev](msg00021.html)][[Thread Next](msg00023.html)]
[[Date Index](maillist.html#00022)]
[[Thread Index](threads.html#00022)]

# [SECURITY] [DLA 3727-1] firefox-esr security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3727-1] firefox-esr security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Wed, 31 Jan 2024 16:16:20 +0100 (CET)
* *Message-id*: <[[üîé]](/msgid-search/20240131151620.C92DC2A01ED%40andromeda)¬†[20240131151620.C92DC2A01ED@andromeda](msg00022.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3727-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
January 31, 2024                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : firefox-esr
Version        : 115.7.0esr-1~deb10u1
CVE ID         : CVE-2024-0741 CVE-2024-0742 CVE-2024-0746 CVE-2024-0747
                 CVE-2024-0749 CVE-2024-0750 CVE-2024-0751 CVE-2024-0753
                 CVE-2024-0755

Multiple security issues have been found in the Mozilla Firefox web
browser, which could potentially result in the execution of arbitrary
code, phishing, clickjacking, privilege escalation, HSTS bypass or
bypass of content security policies.

For Debian 10 buster, these problems have been fixed in version
115.7.0esr-1~deb10u1.

We recommend that you upgrade your firefox-esr packages.

For the detailed security status of firefox-esr please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/firefox-esr>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmW6ZD8ACgkQnUbEiOQ2
gwLwtRAAkrRo4Tp7+yx/1wUz9/TR5vREOCXoszy2WdVQvuTgiNYwkSAMDL1TpId1
M2mNLtL8v3QCCNoZqA3rIDVsixrBwZWdDLUA1OMjqyB3ChuX45lcyu3A+71v9MkI
2VaOIlkaWicu9rxNSQOYuPqItl2ydFLTUmVgR1pR4J+NstP/imijiEbPAiG5BM4n
U8L0IiUs8J+DQxeft5SWwFbMjbS8pi2R845z7p9RjGkIMPJF3CUdpsKnQcItCQIV
Ncc4YzVc8h7qpR4IWgLsGMoqA0EOtQB6NzFHZlASItgLJhDJSCVx/9/kUggjkq2D
DYTz5SoXW5P2QhX6rhkzYb8PVzyd9OQLXk2gEqEq4mtAidKO0IYl9ImwiCsnUoQp
HGz/e3QzFd2g1PVZ2RrjXjHAVe3r2wX3hv/eU8zZJadMR7/FcuYGKUPM897iov0K
Pac32GKpDdr7+x+LABrpzit1RjaULdzfOIa8EakOKtnnmtzH2KTf7nkLG8+KshfL
L5gmaWeBj1korqswg6p6ptPgm/KaqTK9ycyHZnwWNOdtDmAedfYJqITWgWZLP/nx
WzElPEQgqL521o/oFpAQ3Dp+OqNrjPV47oP5xdHQrdj1VJ0omc6F3GtJIvh182ak
HDKoTxdvLigeN4l9HnIdNqSFNRrsjNUbFjf2LdvdHYM382R5W9s=
=hLRb
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_81006655_20250114_232124.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ¬∑
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary‚ñæ

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ‚ñæ

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1813463)
* [XML](/show_bug.cgi?ctype=xml&id=1813463)

Closed
[Bug 1813463](/show_bug.cgi?id=1813463)
(CVE-2024-0749)

Opened 2 years ago
Closed 1 year ago

# Phishing site opens popup which falsely reports "This page is stored on your computer"

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Phishing site opens popup which falsely reports "This page is stored on your computer"

## Categories

### (Firefox :: Site Identity, defect, P2)

[Product:](/describecomponents.cgi?product=Firefox)

Firefox
‚ñæ

Firefox
For bugs in Firefox Desktop, the Mozilla Foundation's web browser. For Firefox user interface issues in menus, bookmarks, location bar, and preferences. Many Firefox bugs will either be filed here or in the [Core](https://bugzilla.mozilla.org/describecomponents.cgi?product=Core) product. Bugs for developer tools (F12) should be filed in the [DevTools](https://bugzilla.mozilla.org/describecomponents.cgi?product=DevTools) product. ([more info](https://wiki.mozilla.org/Modules/All#Firefox))
[See Open Bugs in This Product](/buglist.cgi?product=Firefox&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Firefox)
Watch This Product

[Component:](/describecomponents.cgi?product=Firefox&component=Site%20Identity#Site%20Identity)

Site Identity
‚ñæ

Firefox :: Site Identity
For bugs and feature requests in the UI that signals site identity and connection security, such as the lock icon and the corresponding ‚Äúidentity panel‚Äù.
[See Open Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Identity&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Firefox&component=Site%20Identity&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Firefox&component=Site%20Identity)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 111

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

122 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr102 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix) |
| firefox-esr115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox109 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox109&o1=equals&v1=wontfix) |
| firefox110 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix) |
| firefox111 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix) |
| firefox112 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix) |
| firefox113 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix) |
| firefox114 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix) |
| firefox115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix) |
| firefox116 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix) |
| firefox120 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix) |
| firefox121 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix) |
| firefox122 | --- | [verified](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=verified) |
| firefox123 | --- | [verified](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr102 |  | wontfix |
| firefox-esr115 | --- | wontfix |
| firefox-esr128 | --- | --- |
| firefox109 |  | wontfix |
| firefox110 |  | wontfix |
| firefox111 |  | wontfix |
| firefox112 |  | wontfix |
| firefox113 |  | wontfix |
| firefox114 |  | wontfix |
| firefox115 |  | wontfix |
| firefox116 |  | wontfix |
| firefox120 |  | wontfix |
| firefox121 |  | wontfix |
| firefox122 |  | verified |
| firefox123 |  | verified |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: ke5trel, Assigned: bvandersloot)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/903832f17a97919b41873befa924b21d?d=mm&size=40)  [bvandersloot](/user_profile?user_id=692134)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8be4cc066b150c7bb3357462b93fdbfa?d=mm&size=40)  [ke5trel](/user_profile?user_id=479064)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/46f58cc04758e80835820f0f1d5646bb?d=mm&size=40)  [emz](/user_profile?user_id=636491)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

21 people

## References

### (Regression)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1813463&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1813463)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

[1570678](/show_bug.cgi?id=1570678 "RESOLVED FIXED - Consider replacing the (i) icon as the fallback icon for \"unknown identity\"/\"potentially trustworthy\" pages")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank")

## Details

### (4 keywords, Whiteboard: [fixed in bug 1525943][adv-main122+][adv-esr115.7+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-0749

[Keywords:](/describekeywords.cgi)

[csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[fixed in bug 1525943][adv-main122+][adv-esr115.7+]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c43 "1 year ago") | + |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | blocking-fx-sync1.7 | ? |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 3 obsolete files)

| [Popup window claiming site is local file](/attachment.cgi?id=9314786)  [2 years ago](#c0)  [Kestrel](/user_profile?user_id=479064)   46.56 KB, image/png |  | [Details](/attachment.cgi?id=9314786&action=edit) |
| --- | --- | --- |
| [2023-02-09\_19-54-popup-in-chromium.png](/attachment.cgi?id=9316860)  [2 years ago](#c6)  [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)   73.95 KB, image/png |  | [Details](/attachment.cgi?id=9316860&action=edit) |
| [potential poc](/attachment.cgi?id=9317389)  [2 years ago](#c8)  [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482)   1.32 KB, text/html |  | [Details](/attachment.cgi?id=9317389&action=edit) |
| [WIP: Bug 1813463](/attachment.cgi?id=9322388)  [2 years ago](#c12)  [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9322388&action=edit) | [Review](/attachment.cgi?id=9322388) |
| [WIP: Bug 1813463 - Update the identity section from principal.URI rather than gBrowser.currentURI](/attachment.cgi?id=9322790)  [2 years ago](#c15)  [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9322790&action=edit) | [Review](/attachment.cgi?id=9322790) |
| [Bug 1813463 - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!](/attachment.cgi?id=9363934)  [1 year ago](#c31)  [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9363934&action=edit) | [Review](/attachment.cgi?id=9363934) |
| [Bug 1813463 - Add tests to validate the icon, message, and origin displayed for associated popup windows - r=gijs!](/attachment.cgi?id=9365890)  [1 year ago](#c32)  [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9365890&action=edit) | [Review](/attachment.cgi?id=9365890) |
| [advisory.txt](/attachment.cgi?id=9373604)  [1 year ago](#c38)  [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733)   206 bytes, text/plain |  | [Details](/attachment.cgi?id=9373604&action=edit) |

Show Obsolete

Bottom ‚Üì
Tags ‚ñæ

* Reset

Timeline ‚ñæ

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Kestrel](/user_profile?user_id=479064)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1813463#c0)‚Ä¢ 2 years ago |
|  | |

Attached image
[Popup window claiming site is local file](attachment.cgi?id=9314786)
‚Äî [Details](attachment.cgi?id=9314786&action=edit)

STR:

1. Set `browser.safebrowsing.phishing.enabled = false` to bypass the deceptive site warning.
2. Visit <https://twitch.gift/csgo>.
3. Click "Get free item".
4. Input code: "32TZA6NJQ".
5. Click "Enter".
6. Click "Take my prize".

Popup window opens login page for `steampowered.com`, address bar displays `https://twitch.gift/csgo` but the site icon shows a local file and reports:

```
Site information for about:blank
This page is stored on your computer.

```

Before the regression:

```
Site information for about:blank
Connection not secure

```

Regression window:

<https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=f3a829091fef65cf49209ed374688cdd6d5753ed&tochange=e33aea19d0c50b6b5eec8a45a8b21abcfdc79c85>

Most likely regressed by [Bug 1570678](/show_bug.cgi?id=1570678 "RESOLVED FIXED - Consider replacing the (i) icon as the fallback icon for \"unknown identity\"/\"potentially trustworthy\" pages").

|  | [Pascal Chevrel:pascalc](/user_profile?user_id=24572) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a24892_24572)‚Ä¢ 2 years ago |

[status-firefox110](/buglist.cgi?f1=cf_status_firefox110&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox110&o1=equals&v1=wontfix)

|  | [Tim Huang[:timhuang]](/user_profile?user_id=547199) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a717138_547199)‚Ä¢ 2 years ago |

Flags: needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1813463#c1)‚Ä¢ 2 years ago |
|  | |

Unfortunately (or fortunately, it's a scam site!) the site from the STR is no longer available. Do you have a different site that shows this bug?

Flags: needinfo?(pbz) ‚Üí needinfo?(ke5trel)

|  | [Kestrel](/user_profile?user_id=479064)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1813463#c2)‚Ä¢ 2 years ago |
|  | |

A currently active URL is <https://twltchs-camp.com/csgo> with code `57YFl1`.

Flags: needinfo?(ke5trel)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a895286_636491)‚Ä¢ 2 years ago |

Group: firefox-core-security

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1813463#c3)‚Ä¢ 2 years ago |
|  | |

Thanks! I can reproduce. Looking into it. What makes this annoying to debug is that they obfuscate their JS code and inject `debugger` statements.

I've marked this as a sec bug because it may trick users into thinking the site is safe.

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1813463#c4)‚Ä¢ 2 years ago |
|  | |

The issue seems to be that this is treated as an `about:blank` page. Chromium also shows it as such. Firefox shows the page URI, but still shows all the security UI as if it was about:blank, which is bad.

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1813463#c5)‚Ä¢ 2 years ago |
|  | |

What I think is happening is that the top BrowsingContext of the popup dispatches an `onSecurityChange` message via `nsIWebProgressListener`. However, at the time of dispatch the URI is still `about:blank`. You can see that in the log here:

<https://gist.github.com/Trikolon/27ee3d52de198a4a7cf6e034fefcd7c1#file-firefox-bc-log-L3-L6>

The site identity code uses this URI to update the security UI, such as the identity icon, to "local page", because it assumes `about:blank`.

Shortly after an `OnLocationChange` is triggered as shown in the log, updating to the final URI that is shown in the urlbar:

```
[Parent 137456: Main Thread]: I/BCWebProgress OnLocationChange({isTopLevel:1, isLoadingDocument:0}, <null>, https://twltchs-camp.com/csgo, LOCATION_CHANGE_SAME_DOCUMENT) on {top:1, id:100000001, url:https://twltchs-camp.com/csgo}

```

This however does not cause an identity block update, because `gIdentityHandler.updateIdentity` is only ever called as the result of an `onSecurityChange`. There are no further calls to `onSecurityChange`.

Nika, do you know if this is expected behavior from the platform / BrowsingContext side? I'm trying to figure out where exactly we need to fix this bug. I unfortunately don't have a minimal PoC because the site obfuscates its JS code quite well.

Flags: needinfo?(nika)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1813463#c6)‚Ä¢ 2 years ago |
|  | |

Attached image
[2023-02-09\_19-54-popup-in-chromium.png](attachment.cgi?id=9316860)
‚Äî [Details](attachment.cgi?id=9316860&action=edit)

Here is what the popup looks like in Chromium. This looks to be an about:blank page controlled by the parent with a borderless iframe injected.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1813463#c7)‚Ä¢ 2 years ago |
|  | |

I think the URL bar updating is a similar situation to [bug 1814019](/show_bug.cgi?id=1814019 "RESOLVED INVALID - Can get the current website's address to the new about:blank window"), which I was looking at last week. The site probably opens an about:blank pop-up window, and then loads content into the page. The difference in behaviour between Chrome and Firefox is potentially because the page fills the about:blank document with a command like `document.write`, which as noted in [bug 1814019](/show_bug.cgi?id=1814019 "RESOLVED INVALID - Can get the current website's address to the new about:blank window") will cause `window.location` to be updated based on the calling principal (in this case the phishing site). For Firefox, we then update the URL bar to reflect the new location, whereas in chrome, the URL bar continues to say "about:blank". I don't think that updating the URL bar to more accurately reflect the actual origin of the content being shown is a problem though, and it's perhaps fine that we don't do a security update in that situation as well, as nothing has actually changed with regards to the security situation.

Given that it would be possible for the website to have updated the content either way without causing the location bar to be updated, so that it would stay on `about:blank`, we should perhaps make a point of updating the security dialog for content-controlled about:blank documents to no longer state that "This page is stored on your computer" in general? We should perhaps be showing the security principal of the controlling document instead in the security dialog in this case.

We could also try to do a security update when we do this location change, but overall I think that a large issue here is that we claim content in an about:blank document is stored locally. The actual document being rendered in that situation didn't end up changing, just its `window.location`.

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1813463#c8)‚Ä¢ 2 years ago ‚Ä¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1813463&comment_id=16278903 "1 revision") |
|  | |

Attached file
[potential poc](attachment.cgi?id=9317389)
‚Äî [Details](attachment.cgi?id=9317389&action=edit)

While I haven't confirmed that the actual phishing website uses this strategy (as noted, the code is annoying to look at due to frequent `debugger;` statements, and general obfuscation strategy), I'm guessing that it uses an approach similar to the `document.write` one I've quickly implemented in this file. I've also included an example which doesn't update the URL bar (leaving it at `about:blank`), but where the content is still controlled by the website.

We probably want to make sure that the security info for these documents reflects that the document is under the control of web content.

EDIT: I should note that in the second example I showed, the URL bar doesn't even show security info, just showing the magnifying glass, as it is considered to be a blank document.

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a1243648_534482)‚Ä¢ 2 years ago |

[Attachment #9317389](/attachment.cgi?id=9317389&action=edit "potential poc") -
Attachment mime type: text/plain ‚Üí text/html

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a1243747_534482)‚Ä¢ 2 years ago |

Flags: needinfo?(pbz)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1813463#c9)‚Ä¢ 2 years ago |
|  | |

Set release status flags based on info from the regressing [bug 1570678](/show_bug.cgi?id=1570678 "RESOLVED FIXED - Consider replacing the (i) icon as the fallback icon for \"unknown identity\"/\"potentially trustworthy\" pages")

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a2789661_695136)‚Ä¢ 2 years ago |

[status-firefox111](/buglist.cgi?f1=cf_status_firefox111&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox111&o1=equals&v1=wontfix)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1813463#c10)‚Ä¢ 2 years ago |
|  | |

Sorry for the late response, just getting back to this now.

> I don't think that updating the URL bar to more accurately reflect the actual origin of the content being shown is a problem though, and it's perhaps fine that we don't do a security update in that situation as well, as nothing has actually changed with regards to the security situation.

Agreed, I think updating the url bar is good. I understand that conceptually the security situation has not changed. But could we still fire a security change when we update the location (because of document.write) so that the frontend shows the correct state? I would rather keep the authority for the security state in the backend.

Flags: needinfo?(pbz) ‚Üí needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1813463#c11)‚Ä¢ 2 years ago |
|  | |

I'm not sure I understand why we'd want to fire a security change notification in this situation, as there's been no change to the security state of the document - the exact same document is still loaded, and it has the exact same principal and other security information as before, the only difference is the URL bar being updated. It's sort-of like how the URL changes when you call `pushState()` or `popState()`.

I suppose I just am not convinced that there's anything which should be updated in the security state backend in this case, and that if it seems to be wrong right now, it was also wrong before the URL changed, and we should be updating what the security dialog looks like in that case.

Flags: needinfo?(nika)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1813463#c12)‚Ä¢ 2 years ago |
|  | |

Attached file
[WIP: Bug 1813463](attachment.cgi?id=9322388) (obsolete)
‚Äî [Details](attachment.cgi?id=9322388&action=edit)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1813463#c13)‚Ä¢ 2 years ago |
|  | |

We have two issues here:

1. Showing about:blank in URLBar and identity section when the current window / tab is actually site-controlled. Ideally the user should be able to see what controls the tab looking at any of the two UI surfaces.
2. For this specific edge case where the URI is updated via JS on an about:blank page which leads to a disconnect between the URI in the URLBar and the info in the identity panel. I've attached WIP a patch that targets this specific case.

Fixing (1) isn't trivial (and not as problematic) so I think we should focus on (2) for now.

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1813463#c14)‚Ä¢ 2 years ago |
|  | |

After some discussion with Nika we agreed that the main security issue is that we show about:blank even though the page is controlled by the site that opened it. This combined with our message "This page is stored on your computer" may give the user a false sense of security. They may assume that it is a trusted page.

We can address this by getting the URI for the identity panel from `gBrowser.contentPrincipal` and `gBrowser.contentPrincipal.precursorPrincipal` rather via `gBrowser.currentURI`. The content principal is a more accurate representation of the entity controlling the given tab, particularly for the `about:blank` case discussed in this bug.

A potential downside of this approach is that we create a disconnect between the URI shown in the UrlBar and the URI / domain shown in the identity panel. This may be OK for the edge case in this bug, e.g. showing `about:blank` in the UrlBar while showing `example.com` in the identity panel, but there may be other edge cases I'm missing here.

Assignee: nobody ‚Üí pbzStatus: NEW ‚Üí ASSIGNED

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1813463#c15)‚Ä¢ 2 years ago |
|  | |

Attached file
[WIP: Bug 1813463 - Update the identity section from principal.URI rather than gBrowser.currentURI](attachment.cgi?id=9322790) (obsolete)
‚Äî [Details](attachment.cgi?id=9322790&action=edit)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1813463#c16)‚Ä¢ 2 years ago |
|  | |

Gijs, what do you think about the approach I outlined in [comment 14](/show_bug.cgi?id=1813463#c14 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"")? Are you aware of any edge cases we should be mindful of when using the content principal URI rather than the browser URI?

I've attached a draft for the patch in [comment 15](/show_bug.cgi?id=1813463#c15 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"").

Flags: needinfo?(gijskruitbosch+bugs)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1813463#c17)‚Ä¢ 2 years ago ‚Ä¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1813463&comment_id=16324461 "1 revision") |
|  | |

Unfortunately this approach breaks internal pages like about:certerror, their principal has an about URI, e.g.: `about:certerror?e=nssBadCert&u=https%3A//expired.badssl.com/&c=UTF-8&d=%20`

Curious we could get away with only using the principal URI for the about:blank case.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1813463#c18)‚Ä¢ 2 years ago |
|  | |

(In reply to Paul Z√ºhlcke [:pbz] from [comment #16](/show_bug.cgi?id=1813463#c16 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\""))

> Gijs, what do you think about the approach I outlined in [comment 14](/show_bug.cgi?id=1813463#c14 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"")? Are you aware of any edge cases we should be mindful of when using the content principal URI rather than the browser URI?
>
> I've attached a draft for the patch in [comment 15](/show_bug.cgi?id=1813463#c15 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"").

load errors is the main one which you've already discovered. Otherwise I think it should be OK. You're basically fixing [bug 1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank").

I could have sworn there was a bug on file to show the controlling URI in the address bar even for non-`document.write`'d about:blank, but can't find it at the moment.

The change to `onLocationChange` has performance implications. I don't know if we can avoid that.

(In reply to Paul Z√ºhlcke [:pbz] from [comment #17](/show_bug.cgi?id=1813463#c17 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\""))

> Unfortunately this approach breaks internal pages like about:certerror, their principal has an about URI, e.g.: `about:certerror?e=nssBadCert&u=https%3A//expired.badssl.com/&c=UTF-8&d=%20`
>
> Curious we could get away with only using the principal URI for the about:blank case.

I'd sooner use the principal URI everywhere except about:neterror/about:certerror (and maybe about:blocked, if that has the same problem? If so, how does that relate to [comment 0](/show_bug.cgi?id=1813463#c0 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"") and the fact this was originally reported on a safebrowsing-hit site?)

Flags: needinfo?(gijskruitbosch+bugs) ‚Üí needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1813463#c19)‚Ä¢ 2 years ago |
|  | |

Nice, thanks for linking the bug! Looks like we can land a fix there instead.

> and maybe about:blocked, if that has the same problem? If so, how does that relate to [comment 0](/show_bug.cgi?id=1813463#c0 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"") and the fact this was originally reported on a safebrowsing-hit site?

Yes, about:blocked as the same issue. I don't think this bug is specifically related to Safe Browsing errors. The reporter explicitly disables the warning in the STR.

I need to check where we do the URI display overrides for these pages. It would be good if we could have a single point of truth for them, rather than having another list for URIs where we shouldn't use the principal URI. Or perhaps we just skip any case where the principal URI is an about: URI itself?

Flags: needinfo?(pbz)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1813463#c20)‚Ä¢ 2 years ago |
|  | |

(In reply to Paul Z√ºhlcke [:pbz] from [comment #19](/show_bug.cgi?id=1813463#c19 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\""))

> Nice, thanks for linking the bug! Looks like we can land a fix there instead.
>
> > and maybe about:blocked, if that has the same problem? If so, how does that relate to [comment 0](/show_bug.cgi?id=1813463#c0 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"") and the fact this was originally reported on a safebrowsing-hit site?
>
> Yes, about:blocked as the same issue. I don't think this bug is specifically related to Safe Browsing errors. The reporter explicitly disables the warning in the STR.
>
> I need to check where we do the URI display overrides for these pages. It would be good if we could have a single point of truth for them, rather than having another list for URIs where we shouldn't use the principal URI. Or perhaps we just skip any case where the principal URI is an about: URI itself?

In the content process there's `failedChannel` and stuff. I don't know if we have something in the parent process to distinguish error page loads, though this has some interesting overlap with an otherwise unrelated issue I'm running into atm around what to do for `fixupAndLoadURI` string input that we can't process into a URL (ie for which we show an error page straight away, without even trying to connect). I expect Nika knows how best to recognize an error page load in the parent.

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1813463#c21)‚Ä¢ 2 years ago |
|  | |

Internal error pages like about:neterror are interesting, as technically the page being shown is in fact stored on your computer, but yes you probably want to be showing security information about the page which was originally going to be loaded.

The page will be loaded with LOAD\_ERROR\_PAGE, and in the content process we definitely track that it's an error page, but I don't know off the top of my head of e.g. a flag on WindowContext tracking this, though it could probably be added.

Flags: needinfo?(nika)

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a3829169_600971)‚Ä¢ 2 years ago |

[Attachment #9322790](/attachment.cgi?id=9322790&action=edit "WIP: Bug 1813463 - Update the identity section from principal.URI rather than gBrowser.currentURI") -
Attachment is obsolete: true

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a3829180_600971)‚Ä¢ 2 years ago |

[Attachment #9322388](/attachment.cgi?id=9322388&action=edit "WIP: Bug 1813463") -
Attachment is obsolete: true

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a4272901_636491)‚Ä¢ 2 years ago |

Severity: -- ‚Üí S3Priority: -- ‚Üí P2

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a6090993_690067)‚Ä¢ 2 years ago |

[status-firefox112](/buglist.cgi?f1=cf_status_firefox112&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox112&o1=equals&v1=wontfix)
[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected)
[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a7026585_75935)‚Ä¢ 2 years ago |

[status-firefox113](/buglist.cgi?f1=cf_status_firefox113&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox113&o1=equals&v1=wontfix)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a8688495_406194)‚Ä¢ 2 years ago |

Keywords: [csectype-spoof](/buglist.cgi?keywords=csectype-spoof&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a8688702_406194)‚Ä¢ 2 years ago |

Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a10437281_75935)‚Ä¢ 2 years ago |

[status-firefox114](/buglist.cgi?f1=cf_status_firefox114&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox114&o1=equals&v1=wontfix)
[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a11869593_695136)‚Ä¢ 2 years ago |

[status-firefox115](/buglist.cgi?f1=cf_status_firefox115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox115&o1=equals&v1=wontfix)
[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
--- ‚Üí [affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected)

|  | [Dianna Smith [:diannaS]](/user_profile?user_id=690067) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a15076398_690067)‚Ä¢ 1 years ago |

[status-firefox116](/buglist.cgi?f1=cf_status_firefox116&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox116&o1=equals&v1=wontfix)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1813463#c22)‚Ä¢ 1 years ago |
|  | |

I unfortunately don't have enough time to further work on this bug. I'll try to find a new assignee.

Assignee: pbz ‚Üí nobodyStatus: ASSIGNED ‚Üí NEWFlags: needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a16100826_636491)‚Ä¢ 1 years ago |

Flags: needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1813463#c23)‚Ä¢ 1 years ago |
|  | |

Sorry, didn't mean to clear the NI.

Flags: needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a16955967_636491)‚Ä¢ 1 year ago |

Flags: needinfo?(pbz)

|  | [Emma Z√ºhlcke [:emz]](/user_profile?user_id=636491) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a17034797_636491)‚Ä¢ 1 year ago |

See Also: ‚Üí [1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank")

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1813463#c24)‚Ä¢ 1 year ago |
|  | |

I'm stepping into this bug and playing around with some of Paul's old patches from [Bug 1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank").

One problem I'm seeing is that in the onSecurityChange notification to the popup [sets the security state to STATE\_IS\_INSECURE via the aState argument](https://searchfox.org/mozilla-central/rev/e37662380b7b5507732a4f37a17da1a2f7802c04/browser/base/content/browser.js#5527). This state [helps define what icon to show](https://searchfox.org/mozilla-central/rev/e37662380b7b5507732a4f37a17da1a2f7802c04/browser/base/content/browser-siteIdentity.js#828)- lock, paper, etc. Should we keep the security state on the predecessorPrincipal to allow that to propogate to the about:blank page as well? Or should there be some reaching onto the opener directly when we realize the we inherit the security context? Or something more general and a bigger change?

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1813463#c25)‚Ä¢ 1 year ago |
|  | |

We shouldn't be adding any extra flags into the predecessor principal - information like `STATE_IS_INSECURE` isn't part of the document's principal. I also don't think we should be reaching through `opener` (the target there is dynamic and could e.g. be navigated or cross-origin).

I think perhaps I don't understand the existing setup and how it's supposedly working right now very well. My understanding was roughly that we would determine the security status of the about:blank pop-up or similar based on the principal which it has, and would communicate that specific information. WE can't be showing things like SSL certificates and whether the document was loaded with one or anything like that because the about:blank document wasn't loaded with one, so we are just showing information based on the principal.

Perhaps there's a different icon we should be showing in this sort of locally-controlled about:blank document case? I imagine that historically we've just shown an icon indicating that it's a local document (a page or similar perhaps?), and that seems like it's probably fine to show still? IIRC the bug here was that we don't communicate that the document is controlled by a webpage in the info dialog text.

Flags: needinfo?(nika)

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1813463#c26)‚Ä¢ 1 year ago |
|  | |

> We shouldn't be adding any extra flags into the predecessor principal - information like STATE\_IS\_INSECURE isn't part of the document's principal. I also don't think we should be reaching through opener (the target there is dynamic and could e.g. be navigated or cross-origin).

:+1: those approaches were giving me doubt.

Admittedly I don't understand the existing setup and how it's working right now that well either- this is my first time around this code.

I think I misunderstood the desired outcome. I thought you wanted the entire identity popup (including the icon and certificate information) to be that of the predecessor. That obviously isn't true given your last comment. And adding SSL information would probably be misleading, so I agree here. Also, in that case I think the "document" icon is fine. I think I was basing my misunderstanding of what you wanted off of Paul's comment:

> After some discussion with Nika we agreed that the main security issue is that we show about:blank even though the page is controlled by the site that opened it. This combined with our message "This page is stored on your computer" may give the user a false sense of security. They may assume that it is a trusted page.

So, to clarify, the ideal scenario here would be a document icon in the address bar that when clicked provides an identity panel that says "Site information for predecessor.tld" and not show a "This page is stored on your computer" message?

I have a follow up question: what should we put in place of the "This page is stored on your computer" message? The [current set of alternatives in the panel](https://searchfox.org/mozilla-central/rev/01a0d864a9442d0fe2dbd4beee5c88b9b46e96bd/browser/components/controlcenter/content/identityPanel.inc.xhtml#31-41) don't have me jumping at a better idea. Perhaps we could drop the message entirely, add a new alternative, or re-design a more general string that doesn't imply a `file://`? This would be the only instance of an identity panel not having one of those messages, so that idea doesn't have me jumping either. I lean toward a string re-design, e.g. "No connection"?

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1813463#c27)‚Ä¢ 1 year ago ‚Ä¢ [Edited](/page.cgi?id=comment-revisions.html&bug_id=1813463&comment_id=16650453 "1 revision") |
|  | |

I'm probably not the person to be asking for what to write in that location. I don't know what the aims of the dialog are intended to be, so it's hard to say how it should act in this case. We could perhaps do something where we look at whether the precursor is for a secure scheme (like `https`), and then say something like "This page is controlled by another webpage"? (I worry that would be confusing, though)

EDIT: We might also want to make it so that the controlled about:blank pop-up shows something like this in the normal case, rather than the search icon?

Flags: needinfo?(nika)

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a24211410_692134)‚Ä¢ 1 year ago |

Assignee: nobody ‚Üí bvandersloot

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1813463#c28)‚Ä¢ 1 year ago |
|  | |

So... my loose understanding of this stuff is that the security state notifications were originally set up so we could also communicate things like "this is using TLS but some bits of the page are mixed content" or "this is using TLS but it's using a cert for which an exception was added" or "this is using old encryption that we will stop trusting in the future" (RC4 / SHA1 and whatnot, back in the day). Matt Woodrow last substantially touched the setup of the security change stuff in [bug 1631405](/show_bug.cgi?id=1631405 "RESOLVED FIXED - Make Mixed Content Security UI fission compatible"). I *think* Dana might know more about it, too?

The STATE\_IS\_INSECURE bit is based on the URL not using `https` - <https://searchfox.org/mozilla-central/rev/6f0792f9f3f1a6175ce1f8e318a8a0f51ba76dee/dom/ipc/WindowGlobalChild.cpp#232-237> and <https://searchfox.org/mozilla-central/rev/6f0792f9f3f1a6175ce1f8e318a8a0f51ba76dee/security/manager/ssl/nsSecureBrowserUI.cpp#59,65> .

AIUI, `about:blank` that is `window.open`'d that then loads `http:` content would count as "mixed content" so I'm surprised that for an `about:blank` doc we wouldn't treat the doc as "secure" based on the principal. AIUI that would potentially (counterintuitively...) improve things here? But I don't know what other impact that might have...

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1813463#c29)‚Ä¢ 1 year ago |
|  | |

An `about:blank` that has been `window.open`'d seems like it should at most inherit the security state of the document that opened it. Just treating it as secure would provide a way for an insecure document to create a window that looks secure to the user. That would require putting the security state information along with the inherited principal. I think Nika didn't want that and I tend to agree.

An alternative approach to solving this would be to not update the identity block in the `document.write` case. This makes it match the `innerHTML` PoC where the urlbar shows `about:blank` and has a search icon. FWIW Chrome has similar behavior, but with a different icon. We can then add a UI change to show a different icon in this case because the search icon doesn't make a ton of sense here, but isn't actively harmful.

That would let us resolve the `sec-medium` aspect more directly (since the search icon doesn't tell you a page is a file on your local computer), maybe updating the search icon to the file for this case, and we then deal with "what is the best UI for this corner case" independently. The downside to this approach is a reduced likelihood of actually getting to that last step :).

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1813463#c30)‚Ä¢ 1 year ago |
|  | |

The task of identifying precisely "the `document.write` case," left as an exercise for the reader, was of course, non-trivial.

I think I have a good fix based upon the abandoned patches and the discussions here and on Phabricator. I'm going to sleep on it and submit it for review.

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1813463#c31)‚Ä¢ 1 year ago |
|  | |

Attached file
[Bug 1813463 - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!](attachment.cgi?id=9363934) (obsolete)
‚Äî [Details](attachment.cgi?id=9363934&action=edit)

Depends on D193804

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1813463#c32)‚Ä¢ 1 year ago |
|  | |

Attached file
[Bug 1813463 - Add tests to validate the icon, message, and origin displayed for associated popup windows - r=gijs!](attachment.cgi?id=9365890)
‚Äî [Details](attachment.cgi?id=9365890&action=edit)

This adds testing for this bug and the previous ones in the stack

Depends on D193806

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1813463#c33)‚Ä¢ 1 year ago |
|  | |

Comment on [attachment 9363934](/attachment.cgi?id=9363934 "Bug 1813463 - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!") [[details]](/attachment.cgi?id=9363934&action=edit "Bug 1813463 - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!")

[Bug 1813463](/show_bug.cgi?id=1813463 "VERIFIED FIXED - Phishing site opens popup which falsely reports \"This page is stored on your computer\"") - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!

Revision D193806 was moved to [bug 1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank"). Setting [attachment 9363934](/attachment.cgi?id=9363934 "Bug 1813463 - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!") [[details]](/attachment.cgi?id=9363934&action=edit "Bug 1813463 - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!") to obsolete.

[Attachment #9363934](/attachment.cgi?id=9363934&action=edit "Bug 1813463 - Treat web-controlled about:blank differently than local files in the site identity UI - r=pbz!,Gijs!,nika!") -
Attachment is obsolete: true

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1813463#c34)‚Ä¢ 1 year ago |
|  | |

Fixed in patches for [Bug 1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank"). Marking as in-testsuite=? to remember to land tests in <https://phabricator.services.mozilla.com/D194901>.

Status: NEW ‚Üí RESOLVEDClosed: 1 year agoFlags: in-testsuite?Resolution: --- ‚Üí FIXED

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a26371630_692134)‚Ä¢ 1 year ago |

Whiteboard: [reminder-test 2024-02-20]

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a26372034_75935)‚Ä¢ 1 year ago |

Group: firefox-core-security ‚Üí core-security-release
[status-firefox120](/buglist.cgi?f1=cf_status_firefox120&o1=isnotempty):
--- ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox120&o1=equals&v1=wontfix)
[status-firefox121](/buglist.cgi?f1=cf_status_firefox121&o1=isnotempty):
--- ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox121&o1=equals&v1=wontfix)
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- ‚Üí [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed)
[status-firefox-esr102](/buglist.cgi?f1=cf_status_firefox_esr102&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=affected) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox_esr102&o1=equals&v1=wontfix)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- ‚Üí [fix-optional](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fix-optional)Target Milestone: --- ‚Üí 122 Branch

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a27931329_551058)‚Ä¢ 1 year ago |

Flags: qe-verify+

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a28168570_488993)‚Ä¢ 1 year ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1813463#c35)‚Ä¢ 1 year ago |
|  | |

This issue could not be reproduced because the test page (<https://twitch.gift/csgo>) cannot be found. Is there another that we could use to reproduce the issue and verify fix? Is there anything that we might be missing? Would this website be locked in a specific region?

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a29826928_616104)‚Ä¢ 1 year ago |

Flags: needinfo?(ke5trel)Flags: needinfo?(bvandersloot)

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1813463#c36)‚Ä¢ 1 year ago |
|  | |

The test page was taken down as it was a scam site. You can verify using Nika's PoC (clicking the links to open the popups): <https://bugzilla.mozilla.org/attachment.cgi?id=9317389>

Flags: needinfo?(ke5trel)Flags: needinfo?(bvandersloot)

|  | [Daniel Bodea [:danibodea]](/user_profile?user_id=616104) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1813463#c37)‚Ä¢ 1 year ago |
|  | |

I have reproduced the issue in Release v121.0.1: When loading <https://bugzilla.mozilla.org/attachment.cgi?id=9317389> and clicking "document.write example", the newly opened window's information would show "This page was stored on your computer."

In Beta v122.0b8 and Nightly v123.0a1, performing the same steps would show in the pop-up's page info the text: "This page is loaded from another page.". Reproduction and verfication was performed in Windows 10, Mac OS 11 and Ubuntu 22.

Status: RESOLVED ‚Üí VERIFIED
[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed) ‚Üí [verified](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=verified)
[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- ‚Üí [verified](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=verified)Flags: qe-verify+OS: Unspecified ‚Üí AllHardware: Unspecified ‚Üí Desktop

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a30456468_486733)‚Ä¢ 1 year ago |

Whiteboard: [reminder-test 2024-02-20] ‚Üí [reminder-test 2024-02-20][adv-main122+][adv-esr115.7+]

|  | [Jesse Schwartzentruber (:truber)](/user_profile?user_id=486733) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1813463#c38)‚Ä¢ 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9373604)
‚Äî [Details](attachment.cgi?id=9373604&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a30616981_578488)‚Ä¢ 1 year ago |

Alias: CVE-2024-0749

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a32341446_75935)‚Ä¢ 11 months ago |

[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=fix-optional) ‚Üí [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a32373480_1689)‚Ä¢ 11 months ago |

Depends on: [1525943](/show_bug.cgi?id=1525943 "RESOLVED FIXED - We should show the identity block for web-controlled about:blank, and the identity popup should show the domain + permissions of the site controlling about:blank")Whiteboard: [reminder-test 2024-02-20][adv-main122+][adv-esr115.7+] ‚Üí [fixed in bug 1525943][reminder-test 2024-02-20][adv-main122+][adv-esr115.7+]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1813463#c39)‚Ä¢ 11 months ago |
|  | |

2 months ago, bvandersloot placed a reminder on the bug using the whiteboard tag `[reminder-test 2024-02-20]` .

bvandersloot, please refer to the original comment to better understand the reason for the reminder.

Flags: needinfo?(bvandersloot)Whiteboard: [fixed in bug 1525943][reminder-test 2024-02-20][adv-main122+][adv-esr115.7+] ‚Üí [fixed in bug 1525943][adv-main122+][adv-esr115.7+]

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1813463#c40)‚Ä¢ 11 months ago |
|  | |

Pushed by bvandersloot@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/a2e8a3a99f07>
Add tests to validate the icon, message, and origin displayed for associated popup windows - r=Gijs

|  | [Benjamin VanderSloot [:bvandersloot]](/user_profile?user_id=692134)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1813463#a33375306_692134)‚Ä¢ 11 months ago |

Flags: needinfo?(bvandersloot)

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1813463#c41)‚Ä¢ 11 months ago |
|  | |

Backed out for causing bc failures in browser\_identity\_web\_controlled\_blank.js:

<https://hg.mozilla.org/integration/autoland/rev/682b6de9834db4460b2522bb74c9393f55bb0190>

[Push with failures](https://treeherder.mozilla.org/jobs?repo=autoland&resultStatus=testfailed%2Cbusted%2Cexception%2Crunnable&revision=a2e8a3a99f078a211ae81262d89a1d210f7ff2e4&selectedTaskRun=TxEuwtRtRd6gWCLNU_mqLw.0)

[Failure log](https://treeherder.mozilla.org/logviewer?job_id=447757690&repo=autoland)

> TEST-UNEXPECTED-FAIL | browser/base/content/test/siteIdentity/browser\_identity\_web\_controlled\_blank.js | Uncaught exception in test bound test\_document\_write - at chrome://mochitests/content/browser/browser/base/content/test/siteIdentity/browser\_identity\_web\_controlled\_blank.js:43 - TypeError: can't access property "querySelector", popupWindow.ownerDocument is undefined

Flags: needinfo?(bvandersloot)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1813463#c42)‚Ä¢ 11 months ago |
|  | |

Pushed by bvandersloot@mozilla.com:
<https://hg.mozilla.org/integration/autoland/rev/5b23520f478a>
Add tests to validate the icon, message, and origin displayed for associated popup windows - r=Gijs

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1813463#c43)‚Ä¢ 11 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/5b23520f478a>

Flags: needinfo?(bvandersloot)Flags: in-testsuite?Flags: in-testsuite+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1813463#c44)‚Ä¢ 8 months ago |
|  | |

Making Firefox 122 security bugs public. [bugspam filter string: Pilgarlic-Towers]

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1813463#c45)‚Ä¢ 8 months ago |
|  | |

Sorry for the burst of bugspam: filter on tinkling-glitter-filtrate

Adding `reporter-external` keyword to security bugs found by non-employees for accounting reasons

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1813463&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ‚Üë

## Attachment

Hide Details

### General

Creator:  [Kestrel](/user_profile?user_id=479064)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_edd21a79_20250114_232127.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we‚Äôd like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured ‚Äî we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-01

## Security Vulnerabilities fixed in Firefox 122

Announced
January 23, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 122

#### [#CVE-2024-0741: Out of bounds write in ANGLE](#CVE-2024-0741)

Reporter
Renan Rios
Impact
high
##### Description

An out of bounds write in ANGLE could have allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1864587](https://bugzilla.mozilla.org/show_bug.cgi?id=1864587)

#### [#CVE-2024-0742: Failure to update user input timestamp](#CVE-2024-0742)

Reporter
Andrew McCreight
Impact
high
##### Description

It was possible for certain browser prompts and dialogs to be activated or dismissed unintentionally by the user due to an incorrect timestamp used to prevent input after page load.

##### References

* [Bug 1867152](https://bugzilla.mozilla.org/show_bug.cgi?id=1867152)

#### [#CVE-2024-0743: Crash in NSS TLS method](#CVE-2024-0743)

Reporter
John Schanck
Impact
high
##### Description

An unchecked return value in TLS handshake code could have caused a potentially exploitable crash.

##### References

* [Bug 1867408](https://bugzilla.mozilla.org/show_bug.cgi?id=1867408)

#### [#CVE-2024-0744: Wild pointer dereference in JavaScript](#CVE-2024-0744)

Reporter
Lukas Bernhard
Impact
high
##### Description

In some circumstances, JIT compiled code could have dereferenced a wild pointer value. This could have led to an exploitable crash.

##### References

* [Bug 1871089](https://bugzilla.mozilla.org/show_bug.cgi?id=1871089)

#### [#CVE-2024-0745: Stack buffer overflow in WebAudio](#CVE-2024-0745)

Reporter
Yangkang of 360 ATA Team
Impact
high
##### Description

The WebAudio `OscillatorNode` object was susceptible to a stack buffer overflow. This could have led to a potentially exploitable crash.

##### References

* [Bug 1871838](https://bugzilla.mozilla.org/show_bug.cgi?id=1871838)

#### [#CVE-2024-0746: Crash when listing printers on Linux](#CVE-2024-0746)

Reporter
Cornel Ionce
Impact
moderate
##### Description

A Linux user opening the print preview dialog could have caused the browser to crash.

##### References

* [Bug 1660223](https://bugzilla.mozilla.org/show_bug.cgi?id=1660223)

#### [#CVE-2024-0747: Bypass of Content Security Policy when directive unsafe-inline was set](#CVE-2024-0747)

Reporter
Seongil Wi
Impact
moderate
##### Description

When a parent page loaded a child in an iframe with `unsafe-inline`, the parent Content Security Policy could have overridden the child Content Security Policy.

##### References

* [Bug 1764343](https://bugzilla.mozilla.org/show_bug.cgi?id=1764343)

#### [#CVE-2024-0748: Compromised content process could modify document URI](#CVE-2024-0748)

Reporter
Young Min Kim
Impact
moderate
##### Description

A compromised content process could have updated the document URI. This could have allowed an attacker to set an arbitrary URI in the address bar or history.

##### References

* [Bug 1783504](https://bugzilla.mozilla.org/show_bug.cgi?id=1783504)

#### [#CVE-2024-0749: Phishing site popup could show local origin in address bar](#CVE-2024-0749)

Reporter
Kestrel
Impact
moderate
##### Description

A phishing site could have repurposed an `about:` dialog to show phishing content with an incorrect origin in the address bar.

##### References

* [Bug 1813463](https://bugzilla.mozilla.org/show_bug.cgi?id=1813463)

#### [#CVE-2024-0750: Potential permissions request bypass via clickjacking](#CVE-2024-0750)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1863083](https://bugzilla.mozilla.org/show_bug.cgi?id=1863083)

#### [#CVE-2024-0751: Privilege escalation through devtools](#CVE-2024-0751)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious devtools extension could have been used to escalate privileges.

##### References

* [Bug 1865689](https://bugzilla.mozilla.org/show_bug.cgi?id=1865689)

#### [#CVE-2024-0752: Use-after-free could occur when applying update on macOS](#CVE-2024-0752)

Reporter
Nika Layzell
Impact
moderate
##### Description

A use-after-free crash could have occurred on macOS if a Firefox update were being applied on a very busy system. This could have resulted in an exploitable crash.

##### References

* [Bug 1866840](https://bugzilla.mozilla.org/show_bug.cgi?id=1866840)

#### [#CVE-2024-0753: HSTS policy on subdomain could bypass policy of upper domain](#CVE-2024-0753)

Reporter
Hanno B√∂ck
Impact
moderate
##### Description

In specific HSTS configurations an attacker could have bypassed HSTS on a subdomain.

##### References

* [Bug 1870262](https://bugzilla.mozilla.org/show_bug.cgi?id=1870262)

#### [#CVE-2024-0754: Crash when using some WASM files in devtools](#CVE-2024-0754)

Reporter
Christian Holler
Impact
moderate
##### Description

Some WASM source files could have caused a crash when loaded in devtools.

##### References

* [Bug 1871605](https://bugzilla.mozilla.org/show_bug.cgi?id=1871605)

#### [#CVE-2024-0755: Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](#CVE-2024-0755)

Reporter
Daniel Holbert, Andrew Osmond, and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1868456%2C1871445%2C1873701)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation‚Äôs](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ¬©1998‚Äì2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from lists.debian.org_e97caf08_20250114_232126.html ===


---

[[Date Prev](msg00014.html)][[Date Next](msg00016.html)]
[[Thread Prev](msg00014.html)][[Thread Next](msg00016.html)]
[[Date Index](maillist.html#00015)]
[[Thread Index](threads.html#00015)]

# [SECURITY] [DLA 3720-1] thunderbird security update

---

* *To*: <debian-lts-announce@lists.debian.org>
* *Subject*: [SECURITY] [DLA 3720-1] thunderbird security update
* *From*: Emilio Pozuelo Monfort <pochu@debian.org>
* *Date*: Thu, 25 Jan 2024 11:49:57 +0100 (CET)
* *Message-id*: <[[üîé]](/msgid-search/20240125104957.8D75D2AB5D4%40andromeda)¬†[20240125104957.8D75D2AB5D4@andromeda](msg00015.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian LTS Advisory DLA-3720-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Emilio Pozuelo Monfort
January 25, 2024                              <https://wiki.debian.org/LTS>
- -------------------------------------------------------------------------

Package        : thunderbird
Version        : 1:115.7.0-1~deb10u1
CVE ID         : CVE-2024-0741 CVE-2024-0742 CVE-2024-0746 CVE-2024-0747
                 CVE-2024-0749 CVE-2024-0750 CVE-2024-0751 CVE-2024-0753
                 CVE-2024-0755

Multiple security issues were discovered in Thunderbird, which could
result in denial of service or the execution of arbitrary code.

For Debian 10 buster, these problems have been fixed in version
1:115.7.0-1~deb10u1.

We recommend that you upgrade your thunderbird packages.

For the detailed security status of thunderbird please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/thunderbird>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEcJymx+vmJZxd92Q+nUbEiOQ2gwIFAmWyPNUACgkQnUbEiOQ2
gwJUfBAAii62ZY/Ii3bdR/NHircg99wh+aBQpFQqQaDmuobl3h3PuNttJvBF6xfV
bgUKzv224LAlADMmxK05h3nvuCmYvu+wsx58EekwEJlTGI7ED7zDqKx9UUrxPMwX
Ojl5aSfI6RYbw5lQ/NcyI/NOGdU3ds21xadbKkDG8h2iKxpVcTXTpqpFOqToCDax
FHChrj1FeNJADuL+w4w7Eice2+I2ArgvsAGkMuLH2CxG9gdQMon05eOwL571bU1+
MqueuTY1T9tFZC+7+Q2qxixorw4p/AMV3xXl1zAfb1cCx8wOKXt/86ElgyRyc14X
eIDcPh9o98bnyU30fVYViGYAzIEmJ5+CcPkXOcI0YIF41krOHSSnptmOE8Hxj9h+
deiUjHLAKQ6Ncyu/jnCltrSeFvRnfamagh9B28VMyV2Q/gY/LC3yzzfYgsBVGfmT
jjNgPWU2IoUSzyfqz8kPyqRffTj3kDDlVkdJc2afobkpcx88afxYXO+x95ilcVYv
I+rgsjU4BKitdA0GcXiC8JMcFulrZZg9un6zfMZjYipPlJX6x2XEllwpUv30IdiT
wGlKUeC04jrD9X2kxTCdijAKIZJMRJzspuHERgLWEOmJSo9k1zlbFxPzrVq5RgTk
mwkkF9Lvgy7PrnuvkDmcYwSx9FEHb+D6dMM8e/UiRwZu3s3R150=
=fQo/
-----END PGP SIGNATURE-----

```

---



=== Content from www.mozilla.org_3a71a3b3_20250114_232128.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we‚Äôd like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured ‚Äî we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-04

## Security Vulnerabilities fixed in Thunderbird 115.7

Announced
January 23, 2024
Impact
high
Products
Thunderbird
Fixed in

* Thunderbird 115.7

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2024-0741: Out of bounds write in ANGLE](#CVE-2024-0741)

Reporter
Renan Rios
Impact
high
##### Description

An out of bounds write in ANGLE could have allowed an attacker to corrupt memory leading to a potentially exploitable crash.

##### References

* [Bug 1864587](https://bugzilla.mozilla.org/show_bug.cgi?id=1864587)

#### [#CVE-2024-0742: Failure to update user input timestamp](#CVE-2024-0742)

Reporter
Andrew McCreight
Impact
high
##### Description

It was possible for certain browser prompts and dialogs to be activated or dismissed unintentionally by the user due to an incorrect timestamp used to prevent input after page load.

##### References

* [Bug 1867152](https://bugzilla.mozilla.org/show_bug.cgi?id=1867152)

#### [#CVE-2024-0746: Crash when listing printers on Linux](#CVE-2024-0746)

Reporter
Cornel Ionce
Impact
moderate
##### Description

A Linux user opening the print preview dialog could have caused the browser to crash.

##### References

* [Bug 1660223](https://bugzilla.mozilla.org/show_bug.cgi?id=1660223)

#### [#CVE-2024-0747: Bypass of Content Security Policy when directive unsafe-inline was set](#CVE-2024-0747)

Reporter
Seongil Wi
Impact
moderate
##### Description

When a parent page loaded a child in an iframe with `unsafe-inline`, the parent Content Security Policy could have overridden the child Content Security Policy.

##### References

* [Bug 1764343](https://bugzilla.mozilla.org/show_bug.cgi?id=1764343)

#### [#CVE-2024-0749: Phishing site popup could show local origin in address bar](#CVE-2024-0749)

Reporter
Kestrel
Impact
moderate
##### Description

A phishing site could have repurposed an `about:` dialog to show phishing content with an incorrect origin in the address bar.

##### References

* [Bug 1813463](https://bugzilla.mozilla.org/show_bug.cgi?id=1813463)

#### [#CVE-2024-0750: Potential permissions request bypass via clickjacking](#CVE-2024-0750)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications delay calculation could have made it possible for an attacker to trick a user into granting permissions.

##### References

* [Bug 1863083](https://bugzilla.mozilla.org/show_bug.cgi?id=1863083)

#### [#CVE-2024-0751: Privilege escalation through devtools](#CVE-2024-0751)

Reporter
Rob Wu
Impact
moderate
##### Description

A malicious devtools extension could have been used to escalate privileges.

##### References

* [Bug 1865689](https://bugzilla.mozilla.org/show_bug.cgi?id=1865689)

#### [#CVE-2024-0753: HSTS policy on subdomain could bypass policy of upper domain](#CVE-2024-0753)

Reporter
Hanno B√∂ck
Impact
moderate
##### Description

In specific HSTS configurations an attacker could have bypassed HSTS on a subdomain.

##### References

* [Bug 1870262](https://bugzilla.mozilla.org/show_bug.cgi?id=1870262)

#### [#CVE-2024-0755: Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](#CVE-2024-0755)

Reporter
Daniel Holbert, Andrew Osmond, and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 121, Firefox ESR 115.6, and Thunderbird 115.6. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 122, Firefox ESR 115.7, and Thunderbird 115.7](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1868456%2C1871445%2C1873701)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation‚Äôs](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ¬©1998‚Äì2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


