=== Content from bugzilla.mozilla.org_41f9ca16_20250115_102539.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1855030)
* [XML](/show_bug.cgi?ctype=xml&id=1855030)

Closed
[Bug 1855030](/show_bug.cgi?id=1855030)
(CVE-2024-0606)

Opened 1 year ago
Closed 1 year ago

# iOS Firefox Focus UXSS

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

iOS Firefox Focus UXSS

## Categories

### (Focus :: Security: iOS, defect)

[Product:](/describecomponents.cgi?product=Focus)

Focus
▾

Focus
For bugs in Firefox Focus for Android. Bugs in Firefox Focus for iOS should be filed on [GitHub](https://github.com/mozilla-mobile/firefox-ios/issues/new/choose)
[See Open Bugs in This Product](/buglist.cgi?product=Focus&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Focus)
Watch This Product

[Component:](/describecomponents.cgi?product=Focus&component=Security%3A%20iOS#Security%3A%20iOS)

Security: iOS
▾

Focus :: Security: iOS
Security bugs in Focus for iOS. Other Focus for iOS bugs should be filed at <https://github.com/mozilla-mobile/focus-ios/issues>
[See Open Bugs in This Component](/buglist.cgi?product=Focus&component=Security%3A%20iOS&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Focus&component=Security%3A%20iOS&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Focus&component=Security%3A%20iOS)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 122

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

--

Points:

---

## Tracking

### (firefox122+ fixed)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox122 | [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| fxios | --- |  |
| relnote-firefox |  | --- |
| firefox122 | + | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: proof131072, Assigned: lmarceau)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/7fb2b1922d97306f98551a6d1db2768a?d=mm&size=40)  [lmarceau](/user_profile?user_id=694570)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/302893eb3990c528336f2ee08964bfa5?d=mm&size=40)  [proof131072](/user_profile?user_id=619332)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/481f85b35d45ebad6d41f98cae68ccbf?d=mm&size=40)  [jeevans](/user_profile?user_id=654438)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[CVE-2024-0605](/show_bug.cgi?id=1855575 "VERIFIED FIXED - iOS Firefox Focus let javascript: URI to run on Top Origin sites")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1855030&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1855030)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[CVE-2024-0605](/show_bug.cgi?id=1855575 "VERIFIED FIXED - iOS Firefox Focus let javascript: URI to run on Top Origin sites")

[github.com/mozilla-mobile/focus-ios/p...](https://github.com/mozilla-mobile/focus-ios/pull/3967 "https://github.com/mozilla-mobile/focus-ios/pull/3967")

[mozilla-hub.atlassian.net/browse/FXIO...](https://mozilla-hub.atlassian.net/browse/FXIOS-7773 "https://mozilla-hub.atlassian.net/browse/FXIOS-7773")

## Details

### (Keywords: csectype-sop, reporter-external, sec-high, Whiteboard: [reporter-external] [client-bounty-form] [verif?])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-0606

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[reporter-external] [client-bounty-form] [verif?]

QA Whiteboard:

---

Change Request:

---

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a10376315_1689 "1 year ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | sec-bounty-hof |  |
| --- | --- | --- |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files)

| [Victim site PoC (frames attacker site)](/attachment.cgi?id=9354984)  [1 year ago](#c2)  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)   62 bytes, text/html |  | [Details](/attachment.cgi?id=9354984&action=edit) |
| --- | --- | --- |
| [1855030.html](/attachment.cgi?id=9365073)  [1 year ago](#c12)  [James Lee](/user_profile?user_id=619332)   94 bytes, text/html |  | [Details](/attachment.cgi?id=9365073&action=edit) |
| [Screenshot 2023-11-22.png](/attachment.cgi?id=9365075)  [1 year ago](#c15)  [Nishant Bhasin](/user_profile?user_id=651766)   24.35 KB, image/png |  | [Details](/attachment.cgi?id=9365075&action=edit) |
| [Screenshot 2023-11-22v2.png](/attachment.cgi?id=9365077)  [1 year ago](#c19)  [Nishant Bhasin](/user_profile?user_id=651766)   30.44 KB, image/png |  | [Details](/attachment.cgi?id=9365077&action=edit) |
| [GitHub Pull Request](/attachment.cgi?id=9371145)  [1 year ago](#c27)  [lmarceau](/user_profile?user_id=694570)   53 bytes, text/x-github-pull-request |  | [Details](/attachment.cgi?id=9371145&action=edit) | [Review](/attachment.cgi?id=9371145) |
| [advisory.txt](/attachment.cgi?id=9373323)  [1 year ago](#c32)  [lmarceau](/user_profile?user_id=694570)   235 bytes, text/plain |  | [Details](/attachment.cgi?id=9373323&action=edit) |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | Multiple Authors |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1855030#c0)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1855030&comment_id=16592881 "2 revisions") |
|  | |

We are able to achieve UXSS on iOS Firefox Focus with window.open().

document.write shows we are escalating to legitimate top origin site.

PoC demo

Legitimate Top Origin Site: <https://qrcodescanerror.000webhost.com/UXSS.php>

```
<iframe src="https://pwning.click/uxsstester.php"/></iframe>

```

Cross-Origin Malicious Evil Site: <https://pwning.click/uxsstester.php>

```
<script>
function a(){
	window.open('javascript:document.write(document.domain)', 'x');
	setTimeout(function(){
		window.open('');
	}, 500000);
}
</script>
<center><input type="button" class="button" value="Trigger UXSS!" onclick="a()"></center>

```
Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a375_406194)• 1 year ago |

Group: firefox-core-security → mobile-core-securityComponent: Security → Security: iOSProduct: Firefox → Focus

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1855030#c1)• 1 year ago |
|  | |

The site <https://qrcodescanerror.000webhost.com/UXSS.php> appears down or unreachable from California. Thank you for including the testcase source in the bug this time.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1855030#c2)• 1 year ago |
|  | |

Attached file
[Victim site PoC (frames attacker site)](attachment.cgi?id=9354984)
— [Details](attachment.cgi?id=9354984&action=edit)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1855030#c3)• 1 year ago |
|  | |

I could not reproduce the claimed UXSS using the the PoC I attached based on [comment 0](/show_bug.cgi?id=1855030#c0 "VERIFIED FIXED - iOS Firefox Focus UXSS"). Since the main work is done by the framed pwning.click page it shouldn't have been possible for me to screw that up, but please check.

### The results I see:

* clicking on the "Trigger UXSS" button causes a new window
* that window says "about:blank" in the address bar (expected for script-created content)
* the content of the window says `pwning.click` (the output of `document.domain`)
* never see a second window open after a 500 second timeout even though I kept my device from going asleep for more than the full 8+ minutes. I'm not sure what opening a blank window that late would accomplish, plus I'd expect safari to block it since the "user activation" was already consumed by the first popup.

I don't see an XSS here: the framed content was hosted at pwning.click, and the new window also appears to be the domain pwning.click.

### Expected results according to [comment 0](/show_bug.cgi?id=1855030#c0 "VERIFIED FIXED - iOS Firefox Focus UXSS")

My interpretation of "document.write shows we are escalating to legitimate top origin site." (which matches my definition of XSS) means I should have seen the text `bug1855030.bmoattachments.org`, or if I was able to load the site mentioned in [comment 0](/show_bug.cgi?id=1855030#c0 "VERIFIED FIXED - iOS Firefox Focus UXSS") I should have seen `qrcodescanerror.000webhost.com`

I'm using Firefox for iOS 117.3, on iOS 16.7

James: what version of FIrefox for iOS were you testing? Can you still reproduce this? What version of iOS do you have, and can you reproduce this on the Safari on your machine?

Flags: needinfo?(proof131072)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1855030#c4)• 1 year ago |
|  | |

Latest iOS and please test on Firefox Focus not Firefox.

Flags: needinfo?(proof131072)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1855030#c5)• 1 year ago |
|  | |

And no, it doesn't work on Safari but only on Focus. I also confirmed that JavaScript runs on Top Origin Site <https://bug1855030.bmoattachments.org> with your attached test case.

There is also a side impact of Focus showing empty address bar, which is an example of blank address bar spoof to use it together with <https://bugzilla.mozilla.org/show_bug.cgi?id=1853592> so I'll add it on that report.

Please note that for both reports, there was some confusion from your side since testing should be done on "Focus" but it was done on Firefox.

I understand this can happen time to time so please check on that part and test on Focus. Thanks!

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1855030#c6)• 1 year ago |
|  | |

> please test on Firefox Focus not Firefox.

Ugh, sorry, wasn't paying enough attention to what I was doing.

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a763313_159069)• 1 year ago |

See Also: → [CVE-2024-0605](/show_bug.cgi?id=1855575 "VERIFIED FIXED - iOS Firefox Focus let javascript: URI to run on Top Origin sites")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1855030#c7)• 1 year ago |
|  | |

If this isn't fixed by the same thing as [bug 1855575](/show_bug.cgi?id=1855575 "VERIFIED FIXED - iOS Firefox Focus let javascript: URI to run on Top Origin sites") then this is sec-high.

Keywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1855030#c8)• 1 year ago |
|  | |

The severity field is not set for this bug.

:jeevans, could you have a look please?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#workflow.2Fno_severity.py).

Flags: needinfo?(jeevans)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1855030#c9)• 1 year ago |
|  | |

I believe this is sec-critical due to identical impact to bug id 1719026 Android Firefox Focus Semi-UXSS I discovered before which was assigned as sec-critical without Full UXSS part I described on <https://bugzilla.mozilla.org/show_bug.cgi?id=1719814> because of <https://bugzilla.mozilla.org/show_bug.cgi?id=1719026#c8> (it's a reliable and easy attack vector that could spread quickly once known, and will be easy to deduce from most imaginable ways of patching this.)

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1855030#c10)• 1 year ago |
|  | |

Checking this as well, what are the steps here

visit: <https://bug1855030.bmoattachments.org/> and then I land or bugzilla. While going <https://pwning.click/uxsstester.php> nothing happens.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1855030#c11)• 1 year ago |
|  | |

Tap on Cool Genius Cat to reproduce this issue, thanks!

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1855030#c12)• 1 year ago |
|  | |

Attached file
[1855030.html](attachment.cgi?id=9365073)
— [Details](attachment.cgi?id=9365073&action=edit)

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1855030#c13)• 1 year ago |
|  | |

But how would one do that on a Focus browser, this needs to be deployed to a webpage page right?

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1855030#c14)• 1 year ago |
|  | |

My steps are

* <https://pwning.click/uxsstester.php>
* Tap on Cool Genius Cat
* Nothing happens

  See the attachment in my next comment, lmk if there are any other steps

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1855030#c15)• 1 year ago |
|  | |

Attached image
[Screenshot 2023-11-22.png](attachment.cgi?id=9365075)
— [Details](attachment.cgi?id=9365075&action=edit)

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1855030#c16)• 1 year ago |
|  | |

You just need to click it which will load <https://bug1855030.bmoattachments.org/attachment.cgi?id=9365073> and you can test it on there. document.domain should return the Origin we're running JavaScript which is <https://pwning.click> not <https://bug1855030.bmoattachments.org>

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1855030#c17)• 1 year ago |
|  | |

Try that by clicking on the attachment or on <https://bug1855030.bmoattachments.org/attachment.cgi?id=9365073> not <https://pwning.click/uxsstester.php>

<https://pwning.click/uxsstester.php> is a main but frame document to test this UXSS vulnerability.

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1855030#c18)• 1 year ago |
|  | |

typo: \*is not a main

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1855030#c19)• 1 year ago |
|  | |

Attached image
[Screenshot 2023-11-22v2.png](attachment.cgi?id=9365077)
— [Details](attachment.cgi?id=9365077&action=edit)

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1855030#c20)• 1 year ago |
|  | |

Comment on [attachment 9365077](/attachment.cgi?id=9365077 "Screenshot 2023-11-22v2.png") [[details]](/attachment.cgi?id=9365077&action=edit "Screenshot 2023-11-22v2.png")

Screenshot 2023-11-22v2.png

Tapping on the attachment shows its loading, is that what you meant James?

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1855030#c21)• 1 year ago |
|  | |

Yes, thanks for the confirmation!

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1855030#c22)• 1 year ago |
|  | |

Dan also explained this behaviour on <https://bugzilla.mozilla.org/show_bug.cgi?id=1855030#c3> "Expected results according to [comment 0](/show_bug.cgi?id=1855030#c0 "VERIFIED FIXED - iOS Firefox Focus UXSS")" FYI.

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1855030#c23)• 1 year ago • [Edited](/page.cgi?id=comment-revisions.html&bug_id=1855030&comment_id=16681760 "1 revision") |
|  | |

Few things here

a) Focus doesn't have multi window support so I am not sure if this particular script is what I would consider UXSS

b) You are trying to run javascript and want to control that in WKWebview, that isn't something directly possible unless we disable it as whole. Firefox (Desktop) does the same by opening in a new link. You see about:blank in Firefox desktop as its a new tab. However in Focus we use the same webview and create one on top of the same webview.

I am not aware of any api that I can use that would help us intersect the request from that a() link

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1855030#c24)• 1 year ago |
|  | |

This is UXSS because of the reason you explained on "a)". Please check Android Firefox Focus version of this vulnerability I found before on <https://bugzilla.mozilla.org/show_bug.cgi?id=1719026>

Reply to "b)": I'm not trying but it's already UXSS since you can check document.domain value returned Top Origin site allowing to run any JavaScript (I know the size is small so it could be hard to see that but could be clearly checked from <https://bugzilla.mozilla.org/show_bug.cgi?id=1855030#c19>

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1855030#c25)• 1 year ago |
|  | |

Tracking it here: <https://mozilla-hub.atlassian.net/browse/FXIOS-7773>

|  | [James Lee](/user_profile?user_id=619332)  Reporter |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1855030#c26)• 1 year ago |
|  | |

Thanks! could we check we can reproduce <https://bugzilla.mozilla.org/show_bug.cgi?id=1855117> and I have other bug that I'll report soon which I can prove this and <https://bugzilla.mozilla.org/show_bug.cgi?id=1855117> is different root cause. Please also let me know on reproducing <https://bugzilla.mozilla.org/show_bug.cgi?id=1855575> sometime later!

Thanks.

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1855030#c27)• 1 year ago |
|  | |

Attached file
[GitHub Pull Request](attachment.cgi?id=9371145)
— [Details](attachment.cgi?id=9371145&action=edit)

Assignee: nobody → lmarceau

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a8735278_694570)• 1 year ago |

Version: unspecified → Firefox 122

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1855030#c28)• 1 year ago |
|  | |

Hello, can someone help me with some steps on what needs to be verified here?

I wanna verify the fix and I wanna see how it was before and how it's now to make sure I verify it correctly.

|  | [Nishant Bhasin](/user_profile?user_id=651766) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1855030#c29)• 1 year ago |
|  | |

I will ping you with steps [:andrei]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a9108903_1689)• 1 year ago |

See Also: → <https://github.com/mozilla-mobile/focus-ios/pull/3967>,
<https://mozilla-hub.atlassian.net/browse/FXIOS-7773>

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1855030#c30)• 1 year ago |
|  | |

Verified as fixed on v9000 (17517) with iPhone 15 Pro (17.1.2).

Please note that there was no JS on the URL.

After tapping on the genius cat nothing happened.

Status: NEW → RESOLVEDClosed: 1 year agoResolution: --- → FIXED

|  | [Andrei Bodea[:andrei]](/user_profile?user_id=616105) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a9136696_616105)• 1 year ago |

Status: RESOLVED → VERIFIED

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a9247428_75935)• 1 year ago |

Group: mobile-core-security → core-security-release

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a9760327_578488)• 1 year ago |

Alias: CVE-2024-0606

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1855030#c31)• 1 year ago |
|  | |

This patch adds a call to URIFixup(), but presumably that only helps because the fix for [bug 1855575](/show_bug.cgi?id=1855575 "VERIFIED FIXED - iOS Firefox Focus let javascript: URI to run on Top Origin sites") added a check for "javascript:" in URIFixup

Depends on: [CVE-2024-0605](/show_bug.cgi?id=1855575 "VERIFIED FIXED - iOS Firefox Focus let javascript: URI to run on Top Origin sites")Flags: needinfo?(jeevans)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1855030#c32)• 1 year ago |
|  | |

Attached file
[advisory.txt](attachment.cgi?id=9373323)
— [Details](attachment.cgi?id=9373323&action=edit)

|  | [lmarceau](/user_profile?user_id=694570)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1855030#c33)• 1 year ago |
|  | |

[Tracking Requested - why for this release]:

[status-firefox122](/buglist.cgi?f1=cf_status_firefox122&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox122&o1=equals&v1=fixed)
[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%3F)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a9872188_695136)• 1 year ago |

[tracking-firefox122](/buglist.cgi?f1=cf_tracking_firefox122&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox122&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a10376315_1689)• 1 year ago |

Flags: sec-bounty? → sec-bounty+

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a21431497_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1855030#a30809370_1689)• 4 months ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1855030&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Daniel Veditz [:dveditz]](/user_profile?user_id=1689)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_21136f47_20250115_102540.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-03

## Security Vulnerabilities fixed in Focus for iOS 122

Announced
January 22, 2024
Impact
critical
Products
Focus for iOS
Fixed in

* Focus for iOS 122

#### [#CVE-2024-0605: JavaScript URI running on top origin sites](#CVE-2024-0605)

Reporter
James Lee
Impact
critical
##### Description

Using a javascript: URI with a setTimeout race condition, an attacker can execute unauthorized scripts on top origin sites in urlbar. This bypasses security measures, potentially leading to arbitrary code execution or unauthorized actions within the user's loaded webpage.

##### References

* [Bug 1855575](https://bugzilla.mozilla.org/show_bug.cgi?id=1855575)

#### [#CVE-2024-0606: UXSS attack with window.open()](#CVE-2024-0606)

Reporter
James Lee
Impact
high
##### Description

An attacker could execute unauthorized script on a legitimate site through UXSS using window.open() by opening a javascript URI leading to unauthorized actions within the user's loaded webpage.

##### References

* [Bug 1855030](https://bugzilla.mozilla.org/show_bug.cgi?id=1855030)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


