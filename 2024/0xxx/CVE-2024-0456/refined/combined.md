=== Content from about.gitlab.com_c13d3f3f_20250114_215725.html ===


[←
Back to
releases](/releases/categories/releases/)
Jan 25, 2024

-
[Greg Myers](/company/team/#gitlab)
# GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8

Learn more about GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).

Today we are releasing versions 16.8.1, 16.7.4, 16.6.6, 16.5.8 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain important security fixes, and we strongly recommend that all GitLab installations be upgraded to
one of these versions immediately. GitLab.com and GitLab Dedicated environments are already running the patched version.

GitLab releases patches for vulnerabilities in dedicated security releases. There are two types of security releases:
a monthly, scheduled security release, released a week after the feature release (which deploys on the 3rd Thursday of each month),
and ad-hoc security releases for critical vulnerabilities. For more information, you can visit our [security FAQ](https://about.gitlab.com/security/faq/).
You can see all of our regular and security release blog posts [here](/releases/categories/releases/).
In addition, the issues detailing each vulnerability are made public on our
[issue tracker](https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&state=closed&label_name%5B%5D=bug%3A%3Avulnerability&confidential=no&first_page_size=100)
30 days after the release in which they were patched.

We are dedicated to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to
the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers
upgrade to the latest security release for their supported version. You can read more
[best practices in securing your GitLab instance](/blog/2020/05/20/gitlab-instance-security-best-practices/) in our blog post.

### Recommended Action

We **strongly recommend** that all installations running a version affected by the issues described below are **upgraded to the latest version as soon as possible**.

When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.

## Table of fixes

| Title | Severity |
| --- | --- |
| [Arbitrary file write while creating workspace](#arbitrary-file-write-while-creating-workspace) | Critical |
| [ReDoS in `Cargo.toml` blob viewer](#redos-in-cargotoml-blob-viewer) | Medium |
| [Arbitrary API PUT requests via HTML injection in user's name](#arbitrary-api-put-requests-via-html-injection-in-users-name) | Medium |
| [Disclosure of the public email in Tags RSS Feed](#disclosure-of-the-public-email-in-tags-rss-feed) | Medium |
| [Non-Member can update MR Assignees of owned MRs](#non-member-can-update-mr-assignees-of-owned-mrs) | Medium |

### Arbitrary file write while creating workspace

An issue has been discovered in GitLab CE/EE affecting all versions from 16.0 prior to 16.5.8, 16.6 prior to 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1 which allows an authenticated user to write files to arbitrary locations on the GitLab server while creating a workspace.
This is a critical severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H`, 9.9).
It is now mitigated in the latest release and is assigned [CVE-2024-0402](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0402).

The fix for this security vulnerability has been backported to 16.5.8 in addition to 16.6.6, 16.7.4, and 16.8.1. GitLab 16.5.8 *only* includes a fix for this vulnerability and does *not* contain any of the other fixes or changes mentioned in this blog post.

This vulnerability has been discovered internally by GitLab team member [joernchen](https://gitlab.com/joernchen).

### ReDoS in `Cargo.toml` blob viewer

An issue has been discovered in GitLab CE/EE affecting all versions from 12.7 prior to 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1 It was possible for an attacker to trigger a Regular Expression Denial of Service via a `Cargo.toml` containing maliciously crafted input.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`, 6.5).
It is now mitigated in the latest release and is assigned [CVE-2023-6159](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6159).

Thanks [yvvdwf](https://hackerone.com/yvvdwf) for reporting this vulnerability through our HackerOne bug bounty program.

### Arbitrary API PUT requests via HTML injection in user's name

An issue has been discovered in GitLab CE/EE affecting all versions after 13.7 before 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1. Improper input sanitization of user name allows arbitrary API PUT requests.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:U/C:H/I:H/A:N`, 6.4).
It is now mitigated in the latest release and is assigned [CVE-2023-5933](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5933).

Thanks [yvvdwf](https://hackerone.com/yvvdwf) for reporting this vulnerability through our HackerOne bug bounty program.

### Disclosure of the public email in Tags RSS Feed

An issue has been discovered in GitLab affecting all versions before 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1. It was possible to read the user email address via tags feed although the visibility in the user profile has been disabled.
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`, 5.3).
It is now mitigated in the latest release and is assigned [CVE-2023-5612](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-5612).

Thanks [erruqill](https://hackerone.com/erruqill) for reporting this vulnerability through our HackerOne bug bounty program.

### Non-Member can update MR Assignees of owned MRs

An authorization vulnerability exists in GitLab versions 14.0 prior to 16.6.6, 16.7 prior to 16.7.4, and 16.8 prior to 16.8.1. An unauthorized attacker is able to assign arbitrary users to MRs that they created within the project .
This is a medium severity issue (`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N`, 4.3).
It is now mitigated in the latest release and is assigned [CVE-2024-0456](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-0456).

Thanks to [Niklas](https://gitlab.com/Taucher2003) for reporting this vulnerability.

### Update xmlsoft/libxml2 to >= v2.11.6

The `xmlsoft/libxml2` version has been upgraded to 2.12.3 to mitigate [CVE-2023-45322](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-45322).

### Upgrade redis to address CVE-2023-41056 (Redis RCE)

Redis has been upgraded to version 7.0.15 to mitigate [CVE-2023-41056](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-41056).

## Non Security Patches

### 16.8.1

* [Update dependency gitlab-glfm-markdown to '~> 0.0.11'](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142344)
* [Backport Redis migration to 16.8](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142307)
* [[Backport] Optimize garbage collection process](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142398)
* [[Backport] Bump GitLab Shell version to 14.33.0](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/142628)

### 16.7.4

* [Backport - Bring legacy verification behavior back for repositories](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/141413)
* [Sync chef-gem and chef-bin (16.7)](https://gitlab.com/gitlab-org/omnibus-gitlab/-/merge_requests/7352)

### 16.6.6

* [Backport: Move release-environments pipeline to be sourced from master](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/141821)
* [Backport - Bring legacy verification behavior back for repositories](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/141412)

## Updating

To update GitLab, see the [Update page](/update).
To update Gitlab Runner, see the [Updating the Runner page](https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner).

## Receive Security Release Notifications

To receive security release blog notifications delivered to your inbox, visit our [contact us](https://about.gitlab.com/company/contact/) page.
To receive release notifications via RSS, subscribe to our [security release RSS feed](https://about.gitlab.com/security-releases.xml) or our [RSS feed for all releases](https://about.gitlab.com/all-releases.xml).

[GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8
via @gitlab

Click to tweet!](http://twitter.com/share?text=GitLab+Critical+Security+Release%3A+16.8.1%2C+16.7.4%2C+16.6.6%2C+16.5.8+via+%40gitlab&url=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&text=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&title=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2024/01/25/critical-security-release-gitlab-16-8-1-released/&t=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8)

* [Previous Post:
  GitLab 16.8 released with Google Cloud Secret Manager
  ...](/releases/2024/01/18/gitlab-16-8-released/ "GitLab 16.8 released with Google Cloud Secret Manager support and the ability to speed up your builds with the Maven dependency proxy")
* [Next Post:
  GitLab Security Release: 16.8.2, 16.7.5, 16.6.7](/releases/2024/02/07/security-release-gitlab-16-8-2-released/ "GitLab Security Release: 16.8.2, 16.7.5, 16.6.7")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Critical Security Release: 16.8.1, 16.7.4, 16.6.6, 16.5.8&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2024-01-25-critical-security-release-gitlab-16-8-1-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2024-01-25-critical-security-release-gitlab-16-8-1-released.html.md)



=== Content from gitlab.com_0fb7aa2c_20250114_215729.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Non-Member can update MR Assignees of own created MRs

### Summary

A user can set assignees and reviewers on merge requests that are created by them in projects where they have no membership

### Steps to reproduce

1. Fork a project
2. Make some changes and open a MR to the upstream project
3. `curl -X PUT -H 'Private-Token:[TOKEN]' https://gitlab.com/api/v4/projects/<UPSTREAM-PROJECT-ID>/merge_requests/<MR-ID>?assignee_ids[]=<ANY-USER-ID>`

### Example Project

[leipert-projects/test-project!1 (closed)](https://gitlab.com/leipert-projects/test-project/-/merge_requests/1 "Update Readme.md") (Thanks [@leipert](/leipert "Lukas 'ai-pi' Eipert") for looking through the code with me and allowing me to use the test project for this)

I'm not a member of the project (<https://gitlab.com/leipert-projects/test-project/-/project_members>) and also can't change assignees with the UI

[![image](data:image/gif;base64...)](/-/project/278964/uploads/353a8dec0304f76ae53634fd46e8fddc/image.png)

### What is the current *bug* behavior?

Users without project membership can assign any user to a MR that they created themself.

This only works if **only** `assignee_id` or `assignee_ids` parameters are used. Once you include another parameter like `labels`, the assignees will not change.

### What is the expected *correct* behavior?

As I can't change the assignee in the UI, I would expect that it is also not possible with the API.

### Relevant logs and/or screenshots

### Output of checks

This bug happens on GitLab.com

#### Results of GitLab environment info

Expand for output related to GitLab environment info
```

(For installations with omnibus-gitlab package run and paste the output of:
`sudo gitlab-rake gitlab:env:info`)

(For installations from source run and paste the output of:
`sudo -u git -H bundle exec rake gitlab:env:info RAILS_ENV=production`)

```
#### Results of GitLab application Check

Expand for output related to the GitLab application check
```

(For installations with omnibus-gitlab package run and paste the output of:
sudo gitlab-rake gitlab:check SANITIZE=true)

(For installations from source run and paste the output of:
sudo -u git -H bundle exec rake gitlab:check RAILS_ENV=production SANITIZE=true)

(we will only investigate if the tests are passing)

```
### Possible fixes

`MergeRequests::UpdateAssigneesService` checks for [`:update_merge_request`](https://gitlab.com/gitlab-org/gitlab/-/blob/82b7330f49713b692ef8c4e318e0903c2339c4e4/app/services/merge_requests/update_assignees_service.rb#L10).

This ability is given to authors and assignees here: <https://gitlab.com/gitlab-org/gitlab/-/blob/2c3dc38890cf7f8f1c3b9431c56da502b19694da/app/policies/issuable_policy.rb#L28>

One thing to consider is `MergeRequests::UpdateReviewersService` also checks for [`:update_merge_request`](https://gitlab.com/gitlab-org/gitlab/-/blob/0157fbcb69e8537c3cd4623bbb8991482cc2100b/app/services/merge_requests/update_reviewers_service.rb#L6).

This service is not affected by this if the [REST API](https://docs.gitlab.com/ee/api/merge_requests.html#update-mr) is used.

It is however affected when the `mergeRequestSetReviewers` GraphQL mutation is used. The `mergeRequestSetAssignees` mutation works as well.

A fix could be to change these services to check for `:set_merge_request_metadata` instead of `:update_merge_request`, but it could be considered a [breaking change](/gitlab-org/gitlab/-/issues?label_name=breaking+change "A backwards-incompatible change that will need to be made with the next major release. See https://docs.gitlab.com/ee/development/contributing/index.html#breaking-changes") as it makes the required permissions more strict.

---

cc [@gitlab-com/gl-security/appsec](/gitlab-com/gl-security/appsec "GitLab.com / GitLab Security Department / Application Security") (I'm not sure if this is really a [bugvulnerability](/gitlab-org/gitlab/-/issues?label_name=bug%3A%3Avulnerability "<span class='font-weight-bold scoped-label-tooltip-title'>Scoped label</span><br>A security vulnerability"), I will let you decide that)

Edited Nov 03, 2023 by [Niklas van Schrick](/Taucher2003)

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.


