=== Content from git.kernel.org_c5e01253_20250115_085921.html ===


| [cgit logo](/) | [index](/) : [kernel/git/torvalds/linux.git](/pub/scm/linux/kernel/git/torvalds/linux.git/) | for-next master vsnprintf |
| --- | --- | --- |
| Linux kernel source tree | Linus Torvalds |

| [about](/pub/scm/linux/kernel/git/torvalds/linux.git/about/)[summary](/pub/scm/linux/kernel/git/torvalds/linux.git/)[refs](/pub/scm/linux/kernel/git/torvalds/linux.git/refs/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7)[log](/pub/scm/linux/kernel/git/torvalds/linux.git/log/)[tree](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7)[commit](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7)[diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7)[stats](/pub/scm/linux/kernel/git/torvalds/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-01-12 23:28:45 +0100 |
| --- | --- | --- |
| committer | Pablo Neira Ayuso <pablo@netfilter.org> | 2024-01-17 12:02:49 +0100 |
| commit | [b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7) ([patch](/pub/scm/linux/kernel/git/torvalds/linux.git/patch/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7)) | |
| tree | [aa04b409ad83be3028a7ea2a8cf58e93e97b004a](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7) | |
| parent | [9874808878d9eed407e3977fd11fee49de1e1d86](/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=9874808878d9eed407e3977fd11fee49de1e1d86) ([diff](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7&id2=9874808878d9eed407e3977fd11fee49de1e1d86)) | |
| download | [linux-b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7.tar.gz](/pub/scm/linux/kernel/git/torvalds/linux.git/snapshot/linux-b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7.tar.gz) | |

netfilter: nf\_tables: check if catch-all set element is active in next generationWhen deactivating the catch-all set element, check the state in the next
generation that represents this transaction.
This bug uncovered after the recent removal of the element busy mark
a2dd0233cbc4 ("netfilter: nf\_tables: remove busy mark and gc batch API").
Fixes: aaa31047a6d2 ("netfilter: nftables: add catch-all set element support")
Cc: stable@vger.kernel.org
Reported-by: lonial con <kongln9170@gmail.com>
Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
[Diffstat](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7)

| -rw-r--r-- | [net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/diff/net/netfilter/nf_tables_api.c?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/net/netfilter/nf\_tables\_api.c b/net/netfilter/nf\_tables\_api.cindex b3db97440db15b..50b595ef638924 100644--- a/[net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nf_tables_api.c?id=9874808878d9eed407e3977fd11fee49de1e1d86)+++ b/[net/netfilter/nf\_tables\_api.c](/pub/scm/linux/kernel/git/torvalds/linux.git/tree/net/netfilter/nf_tables_api.c?id=b1db244ffd041a49ecc9618e8feb6b5c1afcdaa7)@@ -6578,7 +6578,7 @@ static int nft\_setelem\_catchall\_deactivate(const struct net \*net,  list\_for\_each\_entry(catchall, &set->catchall\_list, list) { ext = nft\_set\_elem\_ext(set, catchall->elem);- if (!nft\_is\_active(net, ext))+ if (!nft\_is\_active\_next(net, ext)) continue;  kfree(elem->priv); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 08:57:59 +0000


