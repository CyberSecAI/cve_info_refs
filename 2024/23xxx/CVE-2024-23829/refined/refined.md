```
{
  "vulnerability": {
    "root_cause": "The Python HTTP parser in aiohttp was overly lenient in parsing HTTP requests, specifically in the following areas:\n\n1.  The regular expression for matching the HTTP version (`HTTP/(\\d).(\\d)`) did not enforce a literal dot as a separator, allowing any Unicode code point instead.\n2. The parser accepted Unicode digits for the HTTP version, while only ASCII digits are standards compliant.\n3.  Distinct regular expressions were used for validating HTTP method and header field names, although both should adhere to the restrictions of RFC9110 token.",
    "weaknesses": [
      "CWE-444"
    ],
    "impact": "The vulnerabilities could lead to the following:\n\n1.  **Request Smuggling**: When used behind a proxy, the lenient parsing could enable request smuggling, depending on the deployment environment.\n2.  **Resource Consumption**: If the server directly receives or is exposed to malformed input, unhandled exceptions could cause excessive resource consumption on the application server and/or its logging facilities.",
    "attack_vectors": "Malformed HTTP requests with invalid characters in the HTTP version, header names or method could be sent to the aiohttp server.",
    "attacker_capabilities": "An attacker needs the ability to send HTTP requests to a vulnerable server. No special privileges or user interaction is required."
  },
  "additional_details": {
      "details": "The vulnerability is located in the Python HTTP parser (not the llhttp parser). The issues were caused by:\n\n1. Incorrect regex: The regex `HTTP/(\\d).(\\d)` should have been `HTTP/(\\d)\\.(\\d)` to ensure the separator is a literal dot.\n2. Unicode digits: The parser was allowing Unicode digits in the HTTP version, which are not standards compliant.\n3. Inconsistent regex:  Different regular expressions were being used for HTTP method and header validation instead of using the RFC9110 `token` definition.",
        "poc": [
            "GET / HTTP/1√∂1",
            "GET / HTTP/1.ùüô",
            "GET/: HTTP/1.1",
            "Content-Encoding?: chunked"
          ],
         "affected_versions": "< 3.9.2",
         "patched_versions": "3.9.2",
      "patch": "https://github.com/aio-libs/aiohttp/pull/8074/files",
    "references": [
      "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-8qpw-xqxj-h4r2",
       "https://github.com/aio-libs/aiohttp/security/advisories/GHSA-gfw2-4jvh-wgfg",
       "https://github.com/aio-libs/aiohttp/pull/3235",
       "https://github.com/aio-libs/aiohttp/pull/8074/files",
       "https://github.com/aio-libs/aiohttp/commit/33ccdfb0a12690af5bb49bda2319ec0907fa7827",
        "https://nvd.nist.gov/vuln/detail/CVE-2024-23829",
        "https://github.com/aio-libs/aiohttp/pull/8074",
        "https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2024-26.yaml",
        "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ICUOCFGTB25WUT336BZ4UNYLSZOUVKBD",
       "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XXWVZIVAYWEBHNRIILZVB3R3SDQNNAA7"
    ],
        "cvss_v4": "CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:L/VA:L/SC:N/SI:N/SA:N"
  }
}
```