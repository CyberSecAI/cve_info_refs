=== Content from github.com_da7b5dd7_20250115_091156.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F1f44674eb9ab3fbab7103e8d08067846e88bace4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F1f44674eb9ab3fbab7103e8d08067846e88bace4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=enonic%2Fxp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[enonic](/enonic)
/
**[xp](/enonic/xp)**
Public

* [Notifications](/login?return_to=%2Fenonic%2Fxp) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fenonic%2Fxp)
* [Star
   203](/login?return_to=%2Fenonic%2Fxp)

* [Code](/enonic/xp)
* [Issues
  244](/enonic/xp/issues)
* [Pull requests
  10](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects
  0](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

Additional navigation options

* [Code](/enonic/xp)
* [Issues](/enonic/xp/issues)
* [Pull requests](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

## Commit

[Permalink](/enonic/xp/commit/1f44674eb9ab3fbab7103e8d08067846e88bace4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Invalidate old session after login [#9253](https://github.com/enonic/xp/issues/9253)

[Browse files](/enonic/xp/tree/1f44674eb9ab3fbab7103e8d08067846e88bace4)
Browse the repository at this point in the history

```
(cherry picked from commit [0189975](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff))
```

* Loading branch information

[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&v=4)](/vbradnitski) [![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&v=4)](/alansemenov)

[vbradnitski](/enonic/xp/commits?author=vbradnitski "View all commits by vbradnitski")
authored and
[alansemenov](/enonic/xp/commits?author=alansemenov "View all commits by alansemenov")
committed
Dec 6, 2021

1 parent
[cb99e61](/enonic/xp/commit/cb99e61feaaadf3eafa846a83c89608907a2aef5)

commit 1f44674

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**52 additions**
and
**19 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* modules/lib/lib-auth/src

  + main/java/com/enonic/xp/lib/auth

    - modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java
      [LoginHandler.java](#diff-92d4db6d3ee81a28e100ee04cd8aa655fc2be6400456f74e60d1ebaa30308069)
  + test/java/com/enonic/xp/lib/auth

    - modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java
      [LoginHandlerTest.java](#diff-93a4d04a177b370691e8bfc00964addec8cdf55af1610461c9cdcec231c54b45)

## There are no files selected for viewing

50 changes: 31 additions & 19 deletions

50
[modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java](#diff-92d4db6d3ee81a28e100ee04cd8aa655fc2be6400456f74e60d1ebaa30308069 "modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java")

Show comments

[View file](/enonic/xp/blob/1f44674eb9ab3fbab7103e8d08067846e88bace4/modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,6 +9,7 @@ |
|  |  |  |
|  |  | import com.enonic.xp.context.Context; |
|  |  | import com.enonic.xp.context.ContextBuilder; |
|  |  | import com.enonic.xp.context.LocalScope; |
|  |  | import com.enonic.xp.portal.PortalRequest; |
|  |  | import com.enonic.xp.script.bean.BeanContext; |
|  |  | import com.enonic.xp.script.bean.ScriptBean; |
| Expand All | | @@ -30,11 +31,6 @@ |
|  |  | public final class LoginHandler |
|  |  | implements ScriptBean |
|  |  | { |
|  |  | private enum Scope |
|  |  | { |
|  |  | SESSION, REQUEST, NONE |
|  |  | } |
|  |  |  |
|  |  | private String user; |
|  |  |  |
|  |  | private String password; |
| Expand Down  Expand Up | | @@ -113,15 +109,26 @@ public LoginResultMapper login() |
|  |  |  |
|  |  | private void createSession( final AuthenticationInfo authInfo ) |
|  |  | { |
|  |  | final Session session = this.context.get().getLocalScope().getSession(); |
|  |  | final LocalScope localScope = this.context.get().getLocalScope(); |
|  |  | final Session session = localScope.getSession(); |
|  |  |  |
|  |  | if ( session != null ) |
|  |  | { |
|  |  | session.setAttribute( authInfo ); |
|  |  | } |
|  |  | final var attributes = session.getAttributes(); |
|  |  | session.invalidate(); |
|  |  |  |
|  |  | if ( this.sessionTimeout != null ) |
|  |  | { |
|  |  | setSessionTimeout(); |
|  |  | final Session newSession = localScope.getSession(); |
|  |  |  |
|  |  | if ( newSession != null ) |
|  |  | { |
|  |  | attributes.forEach( newSession::setAttribute ); |
|  |  | session.setAttribute( authInfo ); |
|  |  |  |
|  |  | if ( this.sessionTimeout != null ) |
|  |  | { |
|  |  | setSessionTimeout(); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -149,9 +156,8 @@ private AuthenticationInfo attemptLoginWithAllExistingIdProviders() |
|  |  | private IdProviders getSortedIdProviders() |
|  |  | { |
|  |  | IdProviders idProviders = securityService.get().getIdProviders(); |
|  |  | return IdProviders.from( idProviders.stream(). |
|  |  | sorted( Comparator.comparing( u -> u.getKey().toString() ) ). |
|  |  | collect( Collectors.toList() ) ); |
|  |  | return IdProviders.from( |
|  |  | idProviders.stream().sorted( Comparator.comparing( u -> u.getKey().toString() ) ).collect( Collectors.toList() ) ); |
|  |  | } |
|  |  |  |
|  |  | private AuthenticationInfo attemptLogin() |
| Expand Down  Expand Up | | @@ -221,11 +227,12 @@ private AuthenticationInfo authenticate( IdProviderKey idProvider ) |
|  |  | private <T> T runAsAuthenticated( Callable<T> runnable ) |
|  |  | { |
|  |  | final AuthenticationInfo authInfo = AuthenticationInfo.create().principals( RoleKeys.AUTHENTICATED ).user( User.ANONYMOUS ).build(); |
|  |  | return ContextBuilder.from( this.context.get() ). |
|  |  | authInfo( authInfo ). |
|  |  | repositoryId( SystemConstants.SYSTEM\_REPO\_ID ). |
|  |  | branch( SecurityConstants.BRANCH\_SECURITY ).build(). |
|  |  | callWith( runnable ); |
|  |  | return ContextBuilder.from( this.context.get() ) |
|  |  | .authInfo( authInfo ) |
|  |  | .repositoryId( SystemConstants.SYSTEM\_REPO\_ID ) |
|  |  | .branch( SecurityConstants.BRANCH\_SECURITY ) |
|  |  | .build() |
|  |  | .callWith( runnable ); |
|  |  | } |
|  |  |  |
|  |  | private boolean isValidEmail( final String value ) |
| Expand Down  Expand Up | | @@ -253,4 +260,9 @@ public void initialize( final BeanContext context ) |
|  |  | this.context = context.getBinding( Context.class ); |
|  |  | this.portalRequestSupplier = context.getBinding( PortalRequest.class ); |
|  |  | } |
|  |  |  |
|  |  | private enum Scope |
|  |  | { |
|  |  | SESSION, REQUEST, NONE |
|  |  | } |
|  |  | } |

21 changes: 21 additions & 0 deletions

21
[modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java](#diff-93a4d04a177b370691e8bfc00964addec8cdf55af1610461c9cdcec231c54b45 "modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java")

Show comments

[View file](/enonic/xp/blob/1f44674eb9ab3fbab7103e8d08067846e88bace4/modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,8 @@ |
|  |  |  |
|  |  | import static org.junit.jupiter.api.Assertions.assertEquals; |
|  |  | import static org.junit.jupiter.api.Assertions.assertNull; |
|  |  | import static org.mockito.Mockito.times; |
|  |  | import static org.mockito.Mockito.verify; |
|  |  |  |
|  |  | public class LoginHandlerTest |
|  |  | extends ScriptTestSupport |
| Expand Down  Expand Up | | @@ -192,6 +194,25 @@ public void testLoginMultipleIdProvidersInOrder() |
|  |  | assertEquals( "idprovider3", matcher.loginIdProviderAttempts.get( 2 ).toString() ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testSessionInvalidatedOnLogin() |
|  |  | { |
|  |  | final AuthenticationInfo authInfo = TestDataFixtures.createAuthenticationInfo(); |
|  |  |  |
|  |  | final IdProviders idProviders = |
|  |  | IdProviders.from( IdProvider.create().displayName( "system" ).key( IdProviderKey.from( "system" ) ).build() ); |
|  |  |  |
|  |  | Mockito.when( this.securityService.authenticate( Mockito.any() ) ).thenReturn( authInfo ); |
|  |  | Mockito.when( this.securityService.getIdProviders() ).thenReturn( idProviders ); |
|  |  |  |
|  |  | final SessionMock session = Mockito.spy( new SessionMock() ); |
|  |  | ContextAccessor.current().getLocalScope().setSession( session ); |
|  |  |  |
|  |  | runScript( "/lib/xp/examples/auth/login.js" ); |
|  |  |  |
|  |  | verify( session, times( 5 ) ).invalidate(); |
|  |  | } |
|  |  |  |
|  |  | private static class AuthTokenMatcher |
|  |  | implements ArgumentMatcher<AuthenticationToken> |
|  |  | { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `1f44674`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F1f44674eb9ab3fbab7103e8d08067846e88bace4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_62f5024e_20250115_091154.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-4m5p-5w5w-3jcf)

**GHSA-4m5p-5w5w-3jcf**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-4m5p-5w5w-3jcf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [GHSA-4m5p-5w5w-3jcf](/advisories/GHSA-4m5p-5w5w-3jcf)

## com.enonic.xp:lib-auth vulnerable to Session Fixation

Critical severity

GitHub Reviewed

Published
Oct 12, 2022
in
[enonic/xp](/enonic/xp)
•
Updated Mar 1, 2024

[Vulnerability details](/advisories/GHSA-4m5p-5w5w-3jcf)
[Dependabot alerts
0](/advisories/GHSA-4m5p-5w5w-3jcf/dependabot)

## Package

maven

com.enonic.xp:lib-auth
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 7.7.4

## Patched versions

7.7.4

## Description

### Impact

All id-providers using lib-auth `login` method.

### Patches

[enonic/xp@0189975](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff)

[enonic/xp@2abac31](https://github.com/enonic/xp/commit/2abac31cec8679074debc4f1fb69c25930e40842)

[enonic/xp@1f44674](https://github.com/enonic/xp/commit/1f44674eb9ab3fbab7103e8d08067846e88bace4)

### Workarounds

Don't use lib-auth for `login`.

Java API uses low-level structures and allows to invalidate previous session before auth-info is added.

### References

[enonic/xp#9253](https://github.com/enonic/xp/issues/9253)

### References

* [GHSA-4m5p-5w5w-3jcf](https://github.com/enonic/xp/security/advisories/GHSA-4m5p-5w5w-3jcf "GHSA-4m5p-5w5w-3jcf")
* [enonic/xp#9253](https://github.com/enonic/xp/issues/9253)
* [enonic/xp@0189975](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff)
* [enonic/xp@1f44674](https://github.com/enonic/xp/commit/1f44674eb9ab3fbab7103e8d08067846e88bace4)
* [enonic/xp@2abac31](https://github.com/enonic/xp/commit/2abac31cec8679074debc4f1fb69c25930e40842)

[![@rymsha](https://avatars.githubusercontent.com/u/2891483?s=40&v=4)](/rymsha)
[rymsha](/rymsha)
published to
[enonic/xp](/enonic/xp/security/advisories/GHSA-4m5p-5w5w-3jcf)
Oct 12, 2022

Published to the GitHub Advisory Database
Oct 12, 2022

Reviewed
Oct 12, 2022

Last updated
Mar 1, 2024

### Severity

Critical

### Weaknesses

[CWE-384](/advisories?query=cwe%3A384)

### CVE ID

No known CVE

### GHSA ID

GHSA-4m5p-5w5w-3jcf

### Source code

[enonic/xp](https://github.com/enonic/xp)

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-4m5p-5w5w-3jcf/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_b32d8839_20250115_091155.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F0189975691e9e6407a9fee87006f730e84f734ff)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F0189975691e9e6407a9fee87006f730e84f734ff)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=enonic%2Fxp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[enonic](/enonic)
/
**[xp](/enonic/xp)**
Public

* [Notifications](/login?return_to=%2Fenonic%2Fxp) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fenonic%2Fxp)
* [Star
   203](/login?return_to=%2Fenonic%2Fxp)

* [Code](/enonic/xp)
* [Issues
  244](/enonic/xp/issues)
* [Pull requests
  10](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects
  0](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

Additional navigation options

* [Code](/enonic/xp)
* [Issues](/enonic/xp/issues)
* [Pull requests](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

## Commit

[Permalink](/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Invalidate old session after login [#9253](https://github.com/enonic/xp/issues/9253)

[Browse files](/enonic/xp/tree/0189975691e9e6407a9fee87006f730e84f734ff)
Browse the repository at this point in the history

* Loading branch information

[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&v=4)](/vbradnitski) [![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&v=4)](/alansemenov)

[vbradnitski](/enonic/xp/commits?author=vbradnitski "View all commits by vbradnitski")
authored and
[alansemenov](/enonic/xp/commits?author=alansemenov "View all commits by alansemenov")
committed
Dec 6, 2021

1 parent
[e31f823](/enonic/xp/commit/e31f8239af38afbd1b0506922d724184cc65bc91)

commit 0189975

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**52 additions**
and
**19 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* modules/lib/lib-auth/src

  + main/java/com/enonic/xp/lib/auth

    - modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java
      [LoginHandler.java](#diff-92d4db6d3ee81a28e100ee04cd8aa655fc2be6400456f74e60d1ebaa30308069)
  + test/java/com/enonic/xp/lib/auth

    - modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java
      [LoginHandlerTest.java](#diff-93a4d04a177b370691e8bfc00964addec8cdf55af1610461c9cdcec231c54b45)

## There are no files selected for viewing

50 changes: 31 additions & 19 deletions

50
[modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java](#diff-92d4db6d3ee81a28e100ee04cd8aa655fc2be6400456f74e60d1ebaa30308069 "modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java")

Show comments

[View file](/enonic/xp/blob/0189975691e9e6407a9fee87006f730e84f734ff/modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,6 +9,7 @@ |
|  |  |  |
|  |  | import com.enonic.xp.context.Context; |
|  |  | import com.enonic.xp.context.ContextBuilder; |
|  |  | import com.enonic.xp.context.LocalScope; |
|  |  | import com.enonic.xp.portal.PortalRequest; |
|  |  | import com.enonic.xp.script.bean.BeanContext; |
|  |  | import com.enonic.xp.script.bean.ScriptBean; |
| Expand All | | @@ -30,11 +31,6 @@ |
|  |  | public final class LoginHandler |
|  |  | implements ScriptBean |
|  |  | { |
|  |  | private enum Scope |
|  |  | { |
|  |  | SESSION, REQUEST, NONE |
|  |  | } |
|  |  |  |
|  |  | private String user; |
|  |  |  |
|  |  | private String password; |
| Expand Down  Expand Up | | @@ -113,15 +109,26 @@ public LoginResultMapper login() |
|  |  |  |
|  |  | private void createSession( final AuthenticationInfo authInfo ) |
|  |  | { |
|  |  | final Session session = this.context.get().getLocalScope().getSession(); |
|  |  | final LocalScope localScope = this.context.get().getLocalScope(); |
|  |  | final Session session = localScope.getSession(); |
|  |  |  |
|  |  | if ( session != null ) |
|  |  | { |
|  |  | session.setAttribute( authInfo ); |
|  |  | } |
|  |  | final var attributes = session.getAttributes(); |
|  |  | session.invalidate(); |
|  |  |  |
|  |  | if ( this.sessionTimeout != null ) |
|  |  | { |
|  |  | setSessionTimeout(); |
|  |  | final Session newSession = localScope.getSession(); |
|  |  |  |
|  |  | if ( newSession != null ) |
|  |  | { |
|  |  | attributes.forEach( newSession::setAttribute ); |
|  |  | session.setAttribute( authInfo ); |
|  |  |  |
|  |  | if ( this.sessionTimeout != null ) |
|  |  | { |
|  |  | setSessionTimeout(); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -149,9 +156,8 @@ private AuthenticationInfo attemptLoginWithAllExistingIdProviders() |
|  |  | private IdProviders getSortedIdProviders() |
|  |  | { |
|  |  | IdProviders idProviders = securityService.get().getIdProviders(); |
|  |  | return IdProviders.from( idProviders.stream(). |
|  |  | sorted( Comparator.comparing( u -> u.getKey().toString() ) ). |
|  |  | collect( Collectors.toList() ) ); |
|  |  | return IdProviders.from( |
|  |  | idProviders.stream().sorted( Comparator.comparing( u -> u.getKey().toString() ) ).collect( Collectors.toList() ) ); |
|  |  | } |
|  |  |  |
|  |  | private AuthenticationInfo attemptLogin() |
| Expand Down  Expand Up | | @@ -221,11 +227,12 @@ private AuthenticationInfo authenticate( IdProviderKey idProvider ) |
|  |  | private <T> T runAsAuthenticated( Callable<T> runnable ) |
|  |  | { |
|  |  | final AuthenticationInfo authInfo = AuthenticationInfo.create().principals( RoleKeys.AUTHENTICATED ).user( User.ANONYMOUS ).build(); |
|  |  | return ContextBuilder.from( this.context.get() ). |
|  |  | authInfo( authInfo ). |
|  |  | repositoryId( SystemConstants.SYSTEM\_REPO\_ID ). |
|  |  | branch( SecurityConstants.BRANCH\_SECURITY ).build(). |
|  |  | callWith( runnable ); |
|  |  | return ContextBuilder.from( this.context.get() ) |
|  |  | .authInfo( authInfo ) |
|  |  | .repositoryId( SystemConstants.SYSTEM\_REPO\_ID ) |
|  |  | .branch( SecurityConstants.BRANCH\_SECURITY ) |
|  |  | .build() |
|  |  | .callWith( runnable ); |
|  |  | } |
|  |  |  |
|  |  | private boolean isValidEmail( final String value ) |
| Expand Down  Expand Up | | @@ -253,4 +260,9 @@ public void initialize( final BeanContext context ) |
|  |  | this.context = context.getBinding( Context.class ); |
|  |  | this.portalRequestSupplier = context.getBinding( PortalRequest.class ); |
|  |  | } |
|  |  |  |
|  |  | private enum Scope |
|  |  | { |
|  |  | SESSION, REQUEST, NONE |
|  |  | } |
|  |  | } |

21 changes: 21 additions & 0 deletions

21
[modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java](#diff-93a4d04a177b370691e8bfc00964addec8cdf55af1610461c9cdcec231c54b45 "modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java")

Show comments

[View file](/enonic/xp/blob/0189975691e9e6407a9fee87006f730e84f734ff/modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,8 @@ |
|  |  |  |
|  |  | import static org.junit.jupiter.api.Assertions.assertEquals; |
|  |  | import static org.junit.jupiter.api.Assertions.assertNull; |
|  |  | import static org.mockito.Mockito.times; |
|  |  | import static org.mockito.Mockito.verify; |
|  |  |  |
|  |  | public class LoginHandlerTest |
|  |  | extends ScriptTestSupport |
| Expand Down  Expand Up | | @@ -192,6 +194,25 @@ public void testLoginMultipleIdProvidersInOrder() |
|  |  | assertEquals( "idprovider3", matcher.loginIdProviderAttempts.get( 2 ).toString() ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testSessionInvalidatedOnLogin() |
|  |  | { |
|  |  | final AuthenticationInfo authInfo = TestDataFixtures.createAuthenticationInfo(); |
|  |  |  |
|  |  | final IdProviders idProviders = |
|  |  | IdProviders.from( IdProvider.create().displayName( "system" ).key( IdProviderKey.from( "system" ) ).build() ); |
|  |  |  |
|  |  | Mockito.when( this.securityService.authenticate( Mockito.any() ) ).thenReturn( authInfo ); |
|  |  | Mockito.when( this.securityService.getIdProviders() ).thenReturn( idProviders ); |
|  |  |  |
|  |  | final SessionMock session = Mockito.spy( new SessionMock() ); |
|  |  | ContextAccessor.current().getLocalScope().setSession( session ); |
|  |  |  |
|  |  | runScript( "/lib/xp/examples/auth/login.js" ); |
|  |  |  |
|  |  | verify( session, times( 5 ) ).invalidate(); |
|  |  | } |
|  |  |  |
|  |  | private static class AuthTokenMatcher |
|  |  | implements ArgumentMatcher<AuthenticationToken> |
|  |  | { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `0189975`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F0189975691e9e6407a9fee87006f730e84f734ff) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_46ec4303_20250115_091158.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F2abac31cec8679074debc4f1fb69c25930e40842)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F2abac31cec8679074debc4f1fb69c25930e40842)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=enonic%2Fxp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[enonic](/enonic)
/
**[xp](/enonic/xp)**
Public

* [Notifications](/login?return_to=%2Fenonic%2Fxp) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fenonic%2Fxp)
* [Star
   203](/login?return_to=%2Fenonic%2Fxp)

* [Code](/enonic/xp)
* [Issues
  244](/enonic/xp/issues)
* [Pull requests
  10](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects
  0](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

Additional navigation options

* [Code](/enonic/xp)
* [Issues](/enonic/xp/issues)
* [Pull requests](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

## Commit

[Permalink](/enonic/xp/commit/2abac31cec8679074debc4f1fb69c25930e40842)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Invalidate old session after login [#9253](https://github.com/enonic/xp/issues/9253)

[Browse files](/enonic/xp/tree/2abac31cec8679074debc4f1fb69c25930e40842)
Browse the repository at this point in the history

```
(cherry picked from commit [0189975](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff))
```

* Loading branch information

[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&v=4)](/vbradnitski) [![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&v=4)](/alansemenov)

[vbradnitski](/enonic/xp/commits?author=vbradnitski "View all commits by vbradnitski")
authored and
[alansemenov](/enonic/xp/commits?author=alansemenov "View all commits by alansemenov")
committed
Dec 6, 2021

1 parent
[dc6ac15](/enonic/xp/commit/dc6ac15033c9b969158aa8863dd0aaa054b0e1cc)

commit 2abac31

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**55 additions**
and
**19 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* modules/lib/lib-auth/src

  + main/java/com/enonic/xp/lib/auth

    - modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java
      [LoginHandler.java](#diff-92d4db6d3ee81a28e100ee04cd8aa655fc2be6400456f74e60d1ebaa30308069)
  + test/java/com/enonic/xp/lib/auth

    - modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java
      [LoginHandlerTest.java](#diff-93a4d04a177b370691e8bfc00964addec8cdf55af1610461c9cdcec231c54b45)

## There are no files selected for viewing

53 changes: 34 additions & 19 deletions

53
[modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java](#diff-92d4db6d3ee81a28e100ee04cd8aa655fc2be6400456f74e60d1ebaa30308069 "modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java")

Show comments

[View file](/enonic/xp/blob/2abac31cec8679074debc4f1fb69c25930e40842/modules/lib/lib-auth/src/main/java/com/enonic/xp/lib/auth/LoginHandler.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,6 +9,7 @@ |
|  |  |  |
|  |  | import com.enonic.xp.context.Context; |
|  |  | import com.enonic.xp.context.ContextBuilder; |
|  |  | import com.enonic.xp.context.LocalScope; |
|  |  | import com.enonic.xp.portal.PortalRequest; |
|  |  | import com.enonic.xp.script.bean.BeanContext; |
|  |  | import com.enonic.xp.script.bean.ScriptBean; |
| Expand All | | @@ -30,11 +31,6 @@ |
|  |  | public final class LoginHandler |
|  |  | implements ScriptBean |
|  |  | { |
|  |  | private enum Scope |
|  |  | { |
|  |  | SESSION, REQUEST |
|  |  | } |
|  |  |  |
|  |  | private String user; |
|  |  |  |
|  |  | private String password; |
| Expand Down  Expand Up | | @@ -91,6 +87,9 @@ public LoginResultMapper login() |
|  |  | { |
|  |  | switch ( this.scope ) |
|  |  | { |
|  |  | case NONE: |
|  |  | // do nothing |
|  |  | break; |
|  |  | case REQUEST: |
|  |  | this.context.get().getLocalScope().setAttribute( authInfo ); |
|  |  | break; |
| Expand All | | @@ -110,15 +109,26 @@ public LoginResultMapper login() |
|  |  |  |
|  |  | private void createSession( final AuthenticationInfo authInfo ) |
|  |  | { |
|  |  | final Session session = this.context.get().getLocalScope().getSession(); |
|  |  | final LocalScope localScope = this.context.get().getLocalScope(); |
|  |  | final Session session = localScope.getSession(); |
|  |  |  |
|  |  | if ( session != null ) |
|  |  | { |
|  |  | session.setAttribute( authInfo ); |
|  |  | } |
|  |  | final var attributes = session.getAttributes(); |
|  |  | session.invalidate(); |
|  |  |  |
|  |  | if ( this.sessionTimeout != null ) |
|  |  | { |
|  |  | setSessionTimeout(); |
|  |  | final Session newSession = localScope.getSession(); |
|  |  |  |
|  |  | if ( newSession != null ) |
|  |  | { |
|  |  | attributes.forEach( newSession::setAttribute ); |
|  |  | session.setAttribute( authInfo ); |
|  |  |  |
|  |  | if ( this.sessionTimeout != null ) |
|  |  | { |
|  |  | setSessionTimeout(); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -146,9 +156,8 @@ private AuthenticationInfo attemptLoginWithAllExistingIdProviders() |
|  |  | private IdProviders getSortedIdProviders() |
|  |  | { |
|  |  | IdProviders idProviders = securityService.get().getIdProviders(); |
|  |  | return IdProviders.from( idProviders.stream(). |
|  |  | sorted( Comparator.comparing( u -> u.getKey().toString() ) ). |
|  |  | collect( Collectors.toList() ) ); |
|  |  | return IdProviders.from( |
|  |  | idProviders.stream().sorted( Comparator.comparing( u -> u.getKey().toString() ) ).collect( Collectors.toList() ) ); |
|  |  | } |
|  |  |  |
|  |  | private AuthenticationInfo attemptLogin() |
| Expand Down  Expand Up | | @@ -218,11 +227,12 @@ private AuthenticationInfo authenticate( IdProviderKey idProvider ) |
|  |  | private <T> T runAsAuthenticated( Callable<T> runnable ) |
|  |  | { |
|  |  | final AuthenticationInfo authInfo = AuthenticationInfo.create().principals( RoleKeys.AUTHENTICATED ).user( User.ANONYMOUS ).build(); |
|  |  | return ContextBuilder.from( this.context.get() ). |
|  |  | authInfo( authInfo ). |
|  |  | repositoryId( SystemConstants.SYSTEM\_REPO\_ID ). |
|  |  | branch( SecurityConstants.BRANCH\_SECURITY ).build(). |
|  |  | callWith( runnable ); |
|  |  | return ContextBuilder.from( this.context.get() ) |
|  |  | .authInfo( authInfo ) |
|  |  | .repositoryId( SystemConstants.SYSTEM\_REPO\_ID ) |
|  |  | .branch( SecurityConstants.BRANCH\_SECURITY ) |
|  |  | .build() |
|  |  | .callWith( runnable ); |
|  |  | } |
|  |  |  |
|  |  | private boolean isValidEmail( final String value ) |
| Expand Down  Expand Up | | @@ -250,4 +260,9 @@ public void initialize( final BeanContext context ) |
|  |  | this.context = context.getBinding( Context.class ); |
|  |  | this.portalRequestSupplier = context.getBinding( PortalRequest.class ); |
|  |  | } |
|  |  |  |
|  |  | private enum Scope |
|  |  | { |
|  |  | SESSION, REQUEST, NONE |
|  |  | } |
|  |  | } |

21 changes: 21 additions & 0 deletions

21
[modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java](#diff-93a4d04a177b370691e8bfc00964addec8cdf55af1610461c9cdcec231c54b45 "modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java")

Show comments

[View file](/enonic/xp/blob/2abac31cec8679074debc4f1fb69c25930e40842/modules/lib/lib-auth/src/test/java/com/enonic/xp/lib/auth/LoginHandlerTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -23,6 +23,8 @@ |
|  |  |  |
|  |  | import static org.junit.jupiter.api.Assertions.assertEquals; |
|  |  | import static org.junit.jupiter.api.Assertions.assertNull; |
|  |  | import static org.mockito.Mockito.times; |
|  |  | import static org.mockito.Mockito.verify; |
|  |  |  |
|  |  | public class LoginHandlerTest |
|  |  | extends ScriptTestSupport |
| Expand Down  Expand Up | | @@ -171,6 +173,25 @@ public void testLoginMultipleIdProvidersInOrder() |
|  |  | assertEquals( "idprovider3", matcher.loginIdProviderAttempts.get( 2 ).toString() ); |
|  |  | } |
|  |  |  |
|  |  | @Test |
|  |  | public void testSessionInvalidatedOnLogin() |
|  |  | { |
|  |  | final AuthenticationInfo authInfo = TestDataFixtures.createAuthenticationInfo(); |
|  |  |  |
|  |  | final IdProviders idProviders = |
|  |  | IdProviders.from( IdProvider.create().displayName( "system" ).key( IdProviderKey.from( "system" ) ).build() ); |
|  |  |  |
|  |  | Mockito.when( this.securityService.authenticate( Mockito.any() ) ).thenReturn( authInfo ); |
|  |  | Mockito.when( this.securityService.getIdProviders() ).thenReturn( idProviders ); |
|  |  |  |
|  |  | final SessionMock session = Mockito.spy( new SessionMock() ); |
|  |  | ContextAccessor.current().getLocalScope().setSession( session ); |
|  |  |  |
|  |  | runScript( "/lib/xp/examples/auth/login.js" ); |
|  |  |  |
|  |  | verify( session, times( 5 ) ).invalidate(); |
|  |  | } |
|  |  |  |
|  |  | private static class AuthTokenMatcher |
|  |  | implements ArgumentMatcher<AuthenticationToken> |
|  |  | { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `2abac31`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fcommit%2F2abac31cec8679074debc4f1fb69c25930e40842) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from vulncheck.com_b949df70_20250115_091201.html ===

## Cookies

We use our own cookies and third-party cookies so that we can display this website correctly and better understand how this website is used, with a view to improving the services we offer. A decision on cookie usage permissions can be changed anytime using the cookie button that will appear after a selection has been made on this banner.

AcceptDeclineLearn more and customize[Products](/product)[Government](/government)Resources[Community](/community)Open Source[Company](/company)Go back

Enonic XP Session Fixation Vulnerability

severitycriticaldateJanuary 19, 2024Affecting

* Enonic XP versions less than 7.7.4

CVECVE-2024-23679CVE typeSession FixationCVSS7.4CVSS V3 VectorCVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:NReferences

* [Vendor Advisory](https://github.com/enonic/xp/security/advisories/GHSA-4m5p-5w5w-3jcf)
* [Issue Tracking](https://github.com/enonic/xp/issues/9253)
* [Related Link](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff)
* [Related Link](https://github.com/enonic/xp/commit/1f44674eb9ab3fbab7103e8d08067846e88bace4)
* [Related Link](https://github.com/enonic/xp/commit/2abac31cec8679074debc4f1fb69c25930e40842)
* [Third Party Advisory](https://github.com/advisories/GHSA-4m5p-5w5w-3jcf)

FooterVulnCheck helps organizations outpace adversaries with vulnerability intelligence that predicts avenues of attack with speed and accuracy.© 2025 VulnCheck Inc.Products

* [Exploit & Vulnerability Intelligence](/product/exploit-intelligence)
* [Initial Access Intelligence](/product/initial-access-intelligence)
* [IP Intelligence](/product/ip-intelligence)
* [VulnCheck for Government](/government)

Resources

* [Documentation](https://docs.vulncheck.com/)
* [API](https://docs.vulncheck.com/api)
* [Changelog](https://docs.vulncheck.com/changelog)
* [Glossary](https://docs.vulncheck.com/glossary/terms)
* Contact Support

Community

* [VulnCheck KEV](/kev)
* [NVD++](/nvd2)
* [XDB](/xdb)
* [Knowledge Base](/blog?tags=101)
* [Report a Vulnerability](/advisories/report)

Open Source

* [SDK for Go](https://github.com/vulncheck-oss/sdk-go)
* [SDK for Python](https://github.com/vulncheck-oss/sdk-python)
* [CLI](https://github.com/vulncheck-oss/cli)
* [GitHub Action](https://github.com/vulncheck-oss/action)
* [go-exploit](https://github.com/vulncheck-oss/go-exploit)

Company

* [Blog](/blog)
* [News and Awards](/news)
* [Press Releases](/press)
* [Partners](/partners)
* [Events](/events)
* [VulnCheck Advisories](/advisories)
* [Leadership Team](/company/about)

Legal

* [Privacy Policy](/privacy)
* [Terms & Conditions](/terms)
* [Vulnerability Disclosure Policy](/vulnerability-disclosure-policy)



=== Content from github.com_87b7cc7f_20250115_091200.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fsecurity%2Fadvisories%2FGHSA-4m5p-5w5w-3jcf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fsecurity%2Fadvisories%2FGHSA-4m5p-5w5w-3jcf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=enonic%2Fxp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[enonic](/enonic)
/
**[xp](/enonic/xp)**
Public

* [Notifications](/login?return_to=%2Fenonic%2Fxp) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fenonic%2Fxp)
* [Star
   203](/login?return_to=%2Fenonic%2Fxp)

* [Code](/enonic/xp)
* [Issues
  244](/enonic/xp/issues)
* [Pull requests
  10](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects
  0](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

Additional navigation options

* [Code](/enonic/xp)
* [Issues](/enonic/xp/issues)
* [Pull requests](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

# Session Fixation in lib-auth

Critical

[rymsha](/rymsha)
published
GHSA-4m5p-5w5w-3jcf
Oct 12, 2022

## Package

maven

com.enonic.xp.lib.auth
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

< 7.7.4

## Patched versions

7.7.4, 7.8.0

## Description

### Impact

All id-providers using lib-auth `login` method.

### Patches

[0189975](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff)

[2abac31](https://github.com/enonic/xp/commit/2abac31cec8679074debc4f1fb69c25930e40842)

[1f44674](https://github.com/enonic/xp/commit/1f44674eb9ab3fbab7103e8d08067846e88bace4)

### Workarounds

Don't use lib-auth for `login`.

Java API uses low-level structures and allows to invalidate previous session before auth-info is added.

### References

[#9253](https://github.com/enonic/xp/issues/9253)

### Severity

Critical

### CVE ID

CVE-2024-23679

### Weaknesses

No CWEs

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c776dd00_20250115_091159.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fissues%2F9253)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fissues%2F9253)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=enonic%2Fxp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[enonic](/enonic)
/
**[xp](/enonic/xp)**
Public

* [Notifications](/login?return_to=%2Fenonic%2Fxp) You must be signed in to change notification settings
* [Fork
  34](/login?return_to=%2Fenonic%2Fxp)
* [Star
   203](/login?return_to=%2Fenonic%2Fxp)

* [Code](/enonic/xp)
* [Issues
  244](/enonic/xp/issues)
* [Pull requests
  10](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects
  0](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

Additional navigation options

* [Code](/enonic/xp)
* [Issues](/enonic/xp/issues)
* [Pull requests](/enonic/xp/pulls)
* [Actions](/enonic/xp/actions)
* [Projects](/enonic/xp/projects)
* [Wiki](/enonic/xp/wiki)
* [Security](/enonic/xp/security)
* [Insights](/enonic/xp/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fenonic%2Fxp%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fenonic%2Fxp%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Invalidate old session after login #9253

Closed

[alansemenov](/alansemenov) opened this issue
Dec 6, 2021
· 0 comments

Closed

# [Invalidate old session after login](#top) #9253

[alansemenov](/alansemenov) opened this issue
Dec 6, 2021
· 0 comments

Assignees
[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&v=4)](/vbradnitski)

Labels
[Improvement](/enonic/xp/labels/Improvement)
[Security](/enonic/xp/labels/Security)
Fix for something unsafe

## Comments

[![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=80&u=d347c10c9e5dac11ebf64affbacdd6d5fc3b15b6&v=4)](/alansemenov)

Copy link

Member

### **[alansemenov](/alansemenov)** commented [Dec 6, 2021](#issue-1072117958)

| lib-auth should invalidate old session after login and replicate session attributes in a new one. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&u=d347c10c9e5dac11ebf64affbacdd6d5fc3b15b6&v=4)](/alansemenov)
[alansemenov](/alansemenov)
added
[Security](/enonic/xp/labels/Security)
Fix for something unsafe
[Improvement](/enonic/xp/labels/Improvement)
labels
[Dec 6, 2021](#event-5720386234)

[![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&u=d347c10c9e5dac11ebf64affbacdd6d5fc3b15b6&v=4)](/alansemenov)
[alansemenov](/alansemenov)
assigned [vbradnitski](/vbradnitski)
[Dec 6, 2021](#event-5720386256)

[alansemenov](/alansemenov)
pushed a commit
that referenced
this issue
[Dec 6, 2021](#ref-commit-0189975)
[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&u=229f1095b63f50bfb4cfd5ec3630c15c1e20376f&v=4)](/vbradnitski) [![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&v=4)](/alansemenov)

`[Invalidate old session after login](/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff "Invalidate old session after login #9253") [#9253](https://github.com/enonic/xp/issues/9253)`

`[0189975](/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff)`

[alansemenov](/alansemenov)
pushed a commit
that referenced
this issue
[Dec 6, 2021](#ref-commit-2abac31)
[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&u=229f1095b63f50bfb4cfd5ec3630c15c1e20376f&v=4)](/vbradnitski) [![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&v=4)](/alansemenov)

`[Invalidate old session after login](/enonic/xp/commit/2abac31cec8679074debc4f1fb69c25930e40842 "Invalidate old session after login #9253

(cherry picked from commit 0189975691e9e6407a9fee87006f730e84f734ff)") [#9253](https://github.com/enonic/xp/issues/9253)`
…

`[2abac31](/enonic/xp/commit/2abac31cec8679074debc4f1fb69c25930e40842)`

```
(cherry picked from commit [0189975](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff))
```

[alansemenov](/alansemenov)
pushed a commit
that referenced
this issue
[Dec 6, 2021](#ref-commit-1f44674)
[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&u=229f1095b63f50bfb4cfd5ec3630c15c1e20376f&v=4)](/vbradnitski) [![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&v=4)](/alansemenov)

`[Invalidate old session after login](/enonic/xp/commit/1f44674eb9ab3fbab7103e8d08067846e88bace4 "Invalidate old session after login #9253

(cherry picked from commit 0189975691e9e6407a9fee87006f730e84f734ff)") [#9253](https://github.com/enonic/xp/issues/9253)`
…

`[1f44674](/enonic/xp/commit/1f44674eb9ab3fbab7103e8d08067846e88bace4)`

```
(cherry picked from commit [0189975](https://github.com/enonic/xp/commit/0189975691e9e6407a9fee87006f730e84f734ff))
```

This was referenced Dec 8, 2021

[Invalidate old session after login
enonic/app-simple-idprovider#40](/enonic/app-simple-idprovider/issues/40)

Closed

[Invalidate old session after login
enonic/app-adfs-idprovider#65](/enonic/app-adfs-idprovider/issues/65)

Closed

[Invalidate old session after login
enonic/app-auth0-idprovider#53](/enonic/app-auth0-idprovider/issues/53)

Closed

[Invalidate old session after login
enonic/app-ldap-idprovider#37](/enonic/app-ldap-idprovider/issues/37)

Closed

[Invalidate old session after login
enonic/app-oidc-idprovider#65](/enonic/app-oidc-idprovider/issues/65)

Closed

[vbradnitski](/vbradnitski)
added a commit
that referenced
this issue
[Dec 13, 2021](#ref-commit-2862f13)
[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&u=229f1095b63f50bfb4cfd5ec3630c15c1e20376f&v=4)](/vbradnitski)

`[Invalidate old session after login](/enonic/xp/commit/2862f13deb7e4861a0834cb88da4eeb1a77634f6 "Invalidate old session after login #9253") [#9253](https://github.com/enonic/xp/issues/9253)`

`[2862f13](/enonic/xp/commit/2862f13deb7e4861a0834cb88da4eeb1a77634f6)`

[rymsha](/rymsha)
pushed a commit
that referenced
this issue
[Dec 13, 2021](#ref-commit-141ea13)
[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&u=229f1095b63f50bfb4cfd5ec3630c15c1e20376f&v=4)](/vbradnitski) [![@rymsha](https://avatars.githubusercontent.com/u/2891483?s=40&v=4)](/rymsha)

`[Invalidate old session after login](/enonic/xp/commit/141ea1320f2524818fe205e0fb6d3f433784f304 "Invalidate old session after login #9253") [#9253](https://github.com/enonic/xp/issues/9253)`

`[141ea13](/enonic/xp/commit/141ea1320f2524818fe205e0fb6d3f433784f304)`

[![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=40&u=d347c10c9e5dac11ebf64affbacdd6d5fc3b15b6&v=4)](/alansemenov)
[alansemenov](/alansemenov)
closed this as [completed](/enonic/xp/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
[Dec 14, 2021](#event-5763894329)

[![@rymsha](https://avatars.githubusercontent.com/u/2891483?s=40&u=f77c648d574fa697fb93730f02d2c5a7610b1e4c&v=4)](/rymsha)
[rymsha](/rymsha)
mentioned this issue
[Dec 16, 2021](#ref-issue-1082075512)

[Extend API for Session
#9276](/enonic/xp/issues/9276)

Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fenonic%2Fxp%2Fissues%2F9253)

Assignees

[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=40&v=4)](/vbradnitski) [vbradnitski](/vbradnitski)

Labels

[Improvement](/enonic/xp/labels/Improvement)
[Security](/enonic/xp/labels/Security)
Fix for something unsafe

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@vbradnitski](https://avatars.githubusercontent.com/u/8234920?s=52&v=4)](/vbradnitski) [![@alansemenov](https://avatars.githubusercontent.com/u/11612490?s=52&v=4)](/alansemenov)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


