=== Content from github.com_fb581cca_20250115_093255.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLemmyNet%2Flemmy%2Fsecurity%2Fadvisories%2FGHSA-r64r-5h43-26qv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLemmyNet%2Flemmy%2Fsecurity%2Fadvisories%2FGHSA-r64r-5h43-26qv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=LemmyNet%2Flemmy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[LemmyNet](/LemmyNet)
/
**[lemmy](/LemmyNet/lemmy)**
Public

* [Notifications](/login?return_to=%2FLemmyNet%2Flemmy) You must be signed in to change notification settings
* [Fork
  886](/login?return_to=%2FLemmyNet%2Flemmy)
* [Star
   13.4k](/login?return_to=%2FLemmyNet%2Flemmy)

* [Code](/LemmyNet/lemmy)
* [Issues
  170](/LemmyNet/lemmy/issues)
* [Pull requests
  12](/LemmyNet/lemmy/pulls)
* [Actions](/LemmyNet/lemmy/actions)
* [Security](/LemmyNet/lemmy/security)
* [Insights](/LemmyNet/lemmy/pulse)

Additional navigation options

* [Code](/LemmyNet/lemmy)
* [Issues](/LemmyNet/lemmy/issues)
* [Pull requests](/LemmyNet/lemmy/pulls)
* [Actions](/LemmyNet/lemmy/actions)
* [Security](/LemmyNet/lemmy/security)
* [Insights](/LemmyNet/lemmy/pulse)

# Any authenticated user may obtain private message details from other users on the same instance

High

[dessalines](/dessalines)
published
GHSA-r64r-5h43-26qv
Jan 24, 2024

## Package

cargo

lemmy\_server
([Rust](/advisories?query=ecosystem%3Arust))

## Affected versions

>=0.17.0, <0.19.1

## Patched versions

0.19.1

## Description

### Summary

Users can report private messages, even when they're neither sender nor recipient of the message.

The API response to creating a private message report contains the private message itself, which means any user can just iterate over message ids to (loudly) obtain all private messages of an instance.

A user with instance admin privileges can also abuse this if the private message is removed from the response, as they're able to see the resulting reports.

### Details

Creating a private message report by POSTing to `/api/v3/private_message/report` does not validate whether the reporter is the recipient of the message.

At least lemmy-ui does not allow the sender to report the message; the API method should likely be restricted to accessible to recipients only.

The API response when creating a report contains the `private_message_report_view` with all the details of the report, including the private message that has been reported:

Example response

In the report below, the creator with id 3 is different from the private message creator (id 2) and private message recipient (id 6).

```
{
  "private_message_report_view": {
    "private_message_report": {
      "id": 14,
      "creator_id": 3,
      "private_message_id": 7,
      "original_pm_text": "testfoo",
      "reason": "reporting id 7",
      "resolved": false,
      "published": "2023-12-15T19:23:03.441967Z"
    },
    "private_message": {
      "id": 7,
      "creator_id": 2,
      "recipient_id": 6,
      "content": "testfoo",
      "deleted": false,
      "read": false,
      "published": "2023-12-15T19:21:41.920872Z",
      "ap_id": "https://1b1w56.lem.rocks/private_message/7",
      "local": true
    },
    "private_message_creator": {
      "id": 2,
      "name": "admin",
      "banned": false,
      "published": "2023-12-14T23:45:05.055427Z",
      "actor_id": "https://1b1w56.lem.rocks/u/admin",
      "local": true,
      "deleted": false,
      "bot_account": false,
      "instance_id": 1
    },
    "creator": {
      "id": 3,
      "name": "testuser1",
      "banned": false,
      "published": "2023-12-14T23:47:57.571772Z",
      "actor_id": "https://1b1w56.lem.rocks/u/testuser1",
      "local": true,
      "deleted": false,
      "bot_account": false,
      "instance_id": 1
    }
  }
}
```

If these details were not available in the response, but reports could still be created by any user, or at least by any admin, this would allow an instance admin to create reports and obtain the message contents from the report system.

This was originally discovered from incorrect reports on a 0.18.5 instance and has been replicated in a 0.19.0 test environment.

### PoC

```
curl -v 'https://myinstance.tld/api/v3/private_message/report' -X POST -H 'Content-Type: application/json' -H 'authorization: Bearer ...' --data-raw '{"private_message_id":1,"reason":"i like reports"}'
```
### Impact

Any authenticated user can obtain arbitrary (untargeted) private message contents.

Privileges required depend on the instance configuration; when registratons are enabled without application system, the privileges required are practically none.

When registration applications are required, privileges required could be considered low, but this assessment heavily varies by instance.

### Detection

Any private message reports where the report creator is not equal to the private message recipient may be an attempt to exploit this.

As this was originally discovered from an incorrect report, likely related to a bug in a client app, it should be noted that not all mismatching reports should be considered malicious; though a frequent occurrence of them likely indicates an exploitation attempt.

### Workaround when updating is not immediately possible

If an update to a fixed Lemmy version is not immediately possible, the API route can be blocked in the reverse proxy.

This will prevent anyone from reporting private messages, but it will also prevent exploitation before the update has been applied.

nginx example:

```
location = /api/v3/private_message/report {
  default_type application/json;
  return 403 '{"error":"couldnt_create_report"}';
}
```

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-23649

### Weaknesses

[CWE-285](/advisories?query=cwe%3A285)

### Credits

* [![@Nothing4You](https://avatars.githubusercontent.com/u/3694534?s=40&v=4)](/Nothing4You)
  [Nothing4You](/Nothing4You)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_396cd1c6_20250115_093255.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLemmyNet%2Flemmy%2Fcommit%2Fbc32b408b523b9b64aa57b8e47748f96cce0dae5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLemmyNet%2Flemmy%2Fcommit%2Fbc32b408b523b9b64aa57b8e47748f96cce0dae5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=LemmyNet%2Flemmy)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[LemmyNet](/LemmyNet)
/
**[lemmy](/LemmyNet/lemmy)**
Public

* [Notifications](/login?return_to=%2FLemmyNet%2Flemmy) You must be signed in to change notification settings
* [Fork
  886](/login?return_to=%2FLemmyNet%2Flemmy)
* [Star
   13.4k](/login?return_to=%2FLemmyNet%2Flemmy)

* [Code](/LemmyNet/lemmy)
* [Issues
  170](/LemmyNet/lemmy/issues)
* [Pull requests
  12](/LemmyNet/lemmy/pulls)
* [Actions](/LemmyNet/lemmy/actions)
* [Security](/LemmyNet/lemmy/security)
* [Insights](/LemmyNet/lemmy/pulse)

Additional navigation options

* [Code](/LemmyNet/lemmy)
* [Issues](/LemmyNet/lemmy/issues)
* [Pull requests](/LemmyNet/lemmy/pulls)
* [Actions](/LemmyNet/lemmy/actions)
* [Security](/LemmyNet/lemmy/security)
* [Insights](/LemmyNet/lemmy/pulse)

## Commit

[Permalink](/LemmyNet/lemmy/commit/bc32b408b523b9b64aa57b8e47748f96cce0dae5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fixing private message reports. ([#4279](https://github.com/LemmyNet/lemmy/pull/4279))

[Browse files](/LemmyNet/lemmy/tree/bc32b408b523b9b64aa57b8e47748f96cce0dae5)
Browse the repository at this point in the history

* Loading branch information

[![@dessalines](https://avatars.githubusercontent.com/u/930215?s=40&v=4)](/dessalines)

[dessalines](/LemmyNet/lemmy/commits?author=dessalines "View all commits by dessalines")
authored
Dec 18, 2023

1 parent
[aab3ca4](/LemmyNet/lemmy/commit/aab3ca4eb0888b6089fb5b68805b06ad4b4f43af)

commit bc32b40

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**60 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* api\_tests

  + api\_tests/prepare-drone-federation-test.sh
    [prepare-drone-federation-test.sh](#diff-8d24820d34a37575a962fd78a8f479071b747d049921bde0248d943f312b42f2)
  + src

    - api\_tests/src/private\_message.spec.ts
      [private\_message.spec.ts](#diff-8e2e5b4d66087a0e36e03427f1ee25b75cd598764ba592d5371949667fbe6572)
    - api\_tests/src/shared.ts
      [shared.ts](#diff-7a3c30d847e466487bed050c0f10fd3f78ef8843f6f572eb6a1676502fc2e586)
* crates/api/src/private\_message\_report

  + crates/api/src/private\_message\_report/create.rs
    [create.rs](#diff-65d66770cbd0830f287445508a9a617d7e7899037f6b97bcbcf9b953fa8afb23)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[api\_tests/prepare-drone-federation-test.sh](#diff-8d24820d34a37575a962fd78a8f479071b747d049921bde0248d943f312b42f2 "api_tests/prepare-drone-federation-test.sh")

Show comments

[View file](/LemmyNet/lemmy/blob/bc32b408b523b9b64aa57b8e47748f96cce0dae5/api_tests/prepare-drone-federation-test.sh)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,7 +9,7 @@ export RUST\_LOG="warn,lemmy\_server=debug,lemmy\_federate=debug,lemmy\_api=debug,le |
|  |  | export LEMMY\_TEST\_FAST\_FEDERATION=1 # by default, the persistent federation queue has delays in the scale of 30s-5min |
|  |  |  |
|  |  | # pictrs setup |
|  |  | if ! [ -f "pict-rs" ]; then |
|  |  | if [ ! -f "pict-rs" ]; then |
|  |  | curl "https://git.asonix.dog/asonix/pict-rs/releases/download/v0.5.0-beta.2/pict-rs-linux-amd64" -o api\_tests/pict-rs |
|  |  | chmod +x api\_tests/pict-rs |
|  |  | fi |
| Expand Down | |  |

40 changes: 40 additions & 0 deletions

40
[api\_tests/src/private\_message.spec.ts](#diff-8e2e5b4d66087a0e36e03427f1ee25b75cd598764ba592d5371949667fbe6572 "api_tests/src/private_message.spec.ts")

Show comments

[View file](/LemmyNet/lemmy/blob/bc32b408b523b9b64aa57b8e47748f96cce0dae5/api_tests/src/private_message.spec.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -10,6 +10,7 @@ import { |
|  |  | deletePrivateMessage, |
|  |  | unfollowRemotes, |
|  |  | waitUntil, |
|  |  | reportPrivateMessage, |
|  |  | } from "./shared"; |
|  |  |  |
|  |  | let recipient\_id: number; |
| Expand Down  Expand Up | | @@ -109,3 +110,42 @@ test("Delete a private message", async () => { |
|  |  | betaPms1.private\_messages.length, |
|  |  | ); |
|  |  | }); |
|  |  |  |
|  |  | test("Create a private message report", async () => { |
|  |  | let pmRes = await createPrivateMessage(alpha, recipient\_id); |
|  |  | let betaPms1 = await waitUntil( |
|  |  | () => listPrivateMessages(beta), |
|  |  | m => |
|  |  | !!m.private\_messages.find( |
|  |  | e => |
|  |  | e.private\_message.ap\_id === |
|  |  | pmRes.private\_message\_view.private\_message.ap\_id, |
|  |  | ), |
|  |  | ); |
|  |  | let betaPm = betaPms1.private\_messages[0]; |
|  |  | expect(betaPm).toBeDefined(); |
|  |  |  |
|  |  | // Make sure that only the recipient can report it, so this should fail |
|  |  | await expect( |
|  |  | reportPrivateMessage( |
|  |  | alpha, |
|  |  | pmRes.private\_message\_view.private\_message.id, |
|  |  | "a reason", |
|  |  | ), |
|  |  | ).rejects.toStrictEqual(Error("couldnt\_create\_report")); |
|  |  |  |
|  |  | // This one should pass |
|  |  | let reason = "another reason"; |
|  |  | let report = await reportPrivateMessage( |
|  |  | beta, |
|  |  | betaPm.private\_message.id, |
|  |  | reason, |
|  |  | ); |
|  |  |  |
|  |  | expect(report.private\_message\_report\_view.private\_message.id).toBe( |
|  |  | betaPm.private\_message.id, |
|  |  | ); |
|  |  | expect(report.private\_message\_report\_view.private\_message\_report.reason).toBe( |
|  |  | reason, |
|  |  | ); |
|  |  | }); |

14 changes: 14 additions & 0 deletions

14
[api\_tests/src/shared.ts](#diff-7a3c30d847e466487bed050c0f10fd3f78ef8843f6f572eb6a1676502fc2e586 "api_tests/src/shared.ts")

Show comments

[View file](/LemmyNet/lemmy/blob/bc32b408b523b9b64aa57b8e47748f96cce0dae5/api_tests/src/shared.ts)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -4,12 +4,14 @@ import { |
|  |  | BlockInstance, |
|  |  | BlockInstanceResponse, |
|  |  | CommunityId, |
|  |  | CreatePrivateMessageReport, |
|  |  | GetReplies, |
|  |  | GetRepliesResponse, |
|  |  | GetUnreadCountResponse, |
|  |  | InstanceId, |
|  |  | LemmyHttp, |
|  |  | PostView, |
|  |  | PrivateMessageReportResponse, |
|  |  | SuccessResponse, |
|  |  | } from "lemmy-js-client"; |
|  |  | import { CreatePost } from "lemmy-js-client/dist/types/CreatePost"; |
| Expand Down  Expand Up | | @@ -781,6 +783,18 @@ export async function reportComment( |
|  |  | return api.createCommentReport(form); |
|  |  | } |
|  |  |  |
|  |  | export async function reportPrivateMessage( |
|  |  | api: LemmyHttp, |
|  |  | private\_message\_id: number, |
|  |  | reason: string, |
|  |  | ): Promise<PrivateMessageReportResponse> { |
|  |  | let form: CreatePrivateMessageReport = { |
|  |  | private\_message\_id, |
|  |  | reason, |
|  |  | }; |
|  |  | return api.createPrivateMessageReport(form); |
|  |  | } |
|  |  |  |
|  |  | export async function listCommentReports( |
|  |  | api: LemmyHttp, |
|  |  | ): Promise<ListCommentReportsResponse> { |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[crates/api/src/private\_message\_report/create.rs](#diff-65d66770cbd0830f287445508a9a617d7e7899037f6b97bcbcf9b953fa8afb23 "crates/api/src/private_message_report/create.rs")

Show comments

[View file](/LemmyNet/lemmy/blob/bc32b408b523b9b64aa57b8e47748f96cce0dae5/crates/api/src/private_message_report/create.rs)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,6 +31,11 @@ pub async fn create\_pm\_report( |
|  |  | let private\_message\_id = data.private\_message\_id; |
|  |  | let private\_message = PrivateMessage::read(&mut context.pool(), private\_message\_id).await?; |
|  |  |  |
|  |  | // Make sure that only the recipient of the private message can create a report |
|  |  | if person\_id != private\_message.recipient\_id { |
|  |  | Err(LemmyErrorType::CouldntCreateReport)? |
|  |  | } |
|  |  |  |
|  |  | let report\_form = PrivateMessageReportForm { |
|  |  | creator\_id: person\_id, |
|  |  | private\_message\_id, |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `bc32b40`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLemmyNet%2Flemmy%2Fcommit%2Fbc32b408b523b9b64aa57b8e47748f96cce0dae5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


