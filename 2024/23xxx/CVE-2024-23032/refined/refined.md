The provided content is related to CVE-2024-23032.

**Root cause of vulnerability:**
The vulnerability stems from improper handling of parameters within the JWT encrypted header used during local image uploads. Specifically, the `info` parameter, which carries upload form parameters, is vulnerable. The application incorrectly handles URL encoding and decoding, accepting "+" but not "-" after JWT encryption. The application uses the parameters in the header without proper sanitization, allowing for injection of malicious payloads.

**Weaknesses/vulnerabilities present:**
- Reflected Cross-Site Scripting (XSS) vulnerability.
- Improper handling of URL encoding/decoding.
- Lack of sanitization of user-controlled data.
- Vulnerable parameters: `num`, `input`, `path`, `func`, and `is_water`.

**Impact of exploitation:**
- An attacker can inject malicious JavaScript code that will be executed within the context of the victim's browser.
- An administrator who accesses a malicious URL may have their cookie stolen.

**Attack vectors:**
- By crafting a malicious URL that includes a specially crafted JWT encrypted header within the `info` parameter.
- The attacker manipulates the `num`, `input`, `path`, `func`, or `is_water` parameters in the JWT header to inject XSS payloads.
- The attacker can also manipulate the JWT header by replacing `-` with `+` after encryption.

**Required attacker capabilities/position:**
- The attacker needs to be able to craft a malicious URL.
- The attacker does not need to be authenticated.
- The target user needs to be an administrator or logged in user.