=== Content from github.com_b6b3d0fc_20250114_221705.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRhinoSecurityLabs%2FCVEs%2Ftree%2Fmaster%2FCVE-2024-23724)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FRhinoSecurityLabs%2FCVEs%2Ftree%2Fmaster%2FCVE-2024-23724)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=RhinoSecurityLabs%2FCVEs)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[RhinoSecurityLabs](/RhinoSecurityLabs)
/
**[CVEs](/RhinoSecurityLabs/CVEs)**
Public

* [Notifications](/login?return_to=%2FRhinoSecurityLabs%2FCVEs) You must be signed in to change notification settings
* [Fork
  238](/login?return_to=%2FRhinoSecurityLabs%2FCVEs)
* [Star
   815](/login?return_to=%2FRhinoSecurityLabs%2FCVEs)

* [Code](/RhinoSecurityLabs/CVEs)
* [Issues
  0](/RhinoSecurityLabs/CVEs/issues)
* [Pull requests
  0](/RhinoSecurityLabs/CVEs/pulls)
* [Actions](/RhinoSecurityLabs/CVEs/actions)
* [Security](/RhinoSecurityLabs/CVEs/security)
* [Insights](/RhinoSecurityLabs/CVEs/pulse)

Additional navigation options

* [Code](/RhinoSecurityLabs/CVEs)
* [Issues](/RhinoSecurityLabs/CVEs/issues)
* [Pull requests](/RhinoSecurityLabs/CVEs/pulls)
* [Actions](/RhinoSecurityLabs/CVEs/actions)
* [Security](/RhinoSecurityLabs/CVEs/security)
* [Insights](/RhinoSecurityLabs/CVEs/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from rhinosecuritylabs.com_69c18c11_20250114_221707.html ===


# [Rhino Security Labs](https://rhinosecuritylabs.com)

(888) 944-8679

* [Contact Us](https://rhinosecuritylabs.com/contact/)
* [Get a quote](https://rhinosecuritylabs.com/landing/request-a-quote/)

* [Assessments](/assessment-services/)
  + [Application and Network](https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/)
    - [Web Application Penetration Testing](https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/)
    - [Network Penetration Testing](https://rhinosecuritylabs.com/assessment-services/network-penetration-testing/)
    - [Mobile App Penetration Testing](https://rhinosecuritylabs.com/assessment-services/mobile-app-assessment/)
  + [Cloud Penetration Testing](https://rhinosecuritylabs.com/assessment-services/aws-cloud-penetration-testing/)
    - [AWS Penetration Testing](/assessment-services/aws-cloud-penetration-testing/)
    - [GCP Penetration Testing](https://rhinosecuritylabs.com/assessment-services/gcp-penetration-testing/)
    - [Azure Penetration Testing](https://rhinosecuritylabs.com/assessment-services/azure-penetration-testing/)
  + [Adversary Simulation](https://rhinosecuritylabs.com/assessment-services/red-team-engagement/)
    - [Red Team Assessments](https://rhinosecuritylabs.com/assessment-services/red-team-engagement/)
    - [Email Spear Phishing](https://rhinosecuritylabs.com/assessment-services/social-engineering/email-phishing-assessment/)
    - [Vishing (Voice Call) Testing](https://rhinosecuritylabs.com/assessment-services/social-engineering/vishing-assessments/)
* [Industries](https://rhinosecuritylabs.com/industry/)
  + [Technology](https://rhinosecuritylabs.com/industry/technology/)
  + [Healthcare](https://rhinosecuritylabs.com/industry/healthcare/)
  + [Financial](https://rhinosecuritylabs.com/industry/financial/)
  + [Retail](https://rhinosecuritylabs.com/industry/retail/)
* [Resources](https://rhinosecuritylabs.com/resources/)
  + [Security Blog](https://rhinosecuritylabs.com/blog/)
    - [Penetration Testing AWS Environments](https://rhinosecuritylabs.com/penetration-testing/aws-security-vulnerabilities-and-the-attackers-perspective/)
    - [EasyMP Zeroday Disclosure](https://rhinosecuritylabs.com/research/epson-easymp-remote-projection-vulnerabilities/)
  + [Downloads](https://rhinosecuritylabs.com/resources/)
    - [Ebook: Questions For Every Pentest Vendor](https://rhinosecuritylabs.com/landing/6-questions-ask-pentest-vendors/)
    - [Example Pentest Report](https://rhinosecuritylabs.com/landing/penetration-test-report/)
    - [Penetration Testing FAQ](https://rhinosecuritylabs.com/assessment-services/penetration-testing-faq/)
  + [Security Research](/research-and-vulnerability-disclosure)
    - [Research and Tool Development](https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/#section-1)
    - [Vulnerability Disclosure](/research-and-vulnerability-disclosure/#section-2)
* [Security Blog](https://rhinosecuritylabs.com/blog/)
* [Company](https://rhinosecuritylabs.com/company/)
  + [About Us](https://rhinosecuritylabs.com/company/)
  + [Leadership](https://rhinosecuritylabs.com/company/leadership/)
  + [Careers](https://rhinosecuritylabs.com/careers/)
  + [Company Principles](https://rhinosecuritylabs.com/careers/rhino-company-principles/)

* [Assessments](/assessment-services/)

  [Application and Network](https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/)
  + [Web Application Penetration Testing](https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/)
  + [Network Penetration Testing](https://rhinosecuritylabs.com/assessment-services/network-penetration-testing/)
  + [Mobile App Penetration Testing](https://rhinosecuritylabs.com/assessment-services/mobile-app-assessment/)

  [Cloud Penetration Testing](https://rhinosecuritylabs.com/assessment-services/aws-cloud-penetration-testing/)
  + [AWS Penetration Testing](/assessment-services/aws-cloud-penetration-testing/)
  + [GCP Penetration Testing](https://rhinosecuritylabs.com/assessment-services/gcp-penetration-testing/)
  + [Azure Penetration Testing](https://rhinosecuritylabs.com/assessment-services/azure-penetration-testing/)

  [Adversary Simulation](https://rhinosecuritylabs.com/assessment-services/red-team-engagement/)
  + [Red Team Assessments](https://rhinosecuritylabs.com/assessment-services/red-team-engagement/)
  + [Email Spear Phishing](https://rhinosecuritylabs.com/assessment-services/social-engineering/email-phishing-assessment/)
  + [Vishing (Voice Call) Testing](https://rhinosecuritylabs.com/assessment-services/social-engineering/vishing-assessments/)
* [Industries](https://rhinosecuritylabs.com/industry/)

  + [Technology](https://rhinosecuritylabs.com/industry/technology/)
  + [Healthcare](https://rhinosecuritylabs.com/industry/healthcare/)
  + [Financial](https://rhinosecuritylabs.com/industry/financial/)
  + [Retail](https://rhinosecuritylabs.com/industry/retail/)
* [Resources](https://rhinosecuritylabs.com/resources/)

  [Security Blog](https://rhinosecuritylabs.com/blog/)
  + [Penetration Testing AWS Environments](https://rhinosecuritylabs.com/penetration-testing/aws-security-vulnerabilities-and-the-attackers-perspective/)
  + [EasyMP Zeroday Disclosure](https://rhinosecuritylabs.com/research/epson-easymp-remote-projection-vulnerabilities/)

  [Downloads](https://rhinosecuritylabs.com/resources/)
  + [Ebook: Questions For Every Pentest Vendor](https://rhinosecuritylabs.com/landing/6-questions-ask-pentest-vendors/)
  + [Example Pentest Report](https://rhinosecuritylabs.com/landing/penetration-test-report/)
  + [Penetration Testing FAQ](https://rhinosecuritylabs.com/assessment-services/penetration-testing-faq/)

  [Security Research](/research-and-vulnerability-disclosure)
  + [Research and Tool Development](https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/#section-1)
  + [Vulnerability Disclosure](/research-and-vulnerability-disclosure/#section-2)
* [Security Blog](https://rhinosecuritylabs.com/blog/)
* [Company](https://rhinosecuritylabs.com/company/)

  + [About Us](https://rhinosecuritylabs.com/company/)
  + [Leadership](https://rhinosecuritylabs.com/company/leadership/)
  + [Careers](https://rhinosecuritylabs.com/careers/)
  + [Company Principles](https://rhinosecuritylabs.com/careers/rhino-company-principles/)

# Strategic & Technical Blog

[Technical](https://rhinosecuritylabs.com/blog-technical/)
[Strategic](https://rhinosecuritylabs.com/blog-strategic/)
[Technical & Strategic

Both](https://rhinosecuritylabs.com/blog/)

![](https://rhinosecuritylabs.com/wp-content/themes/rhino-v1.2/img/loader.svg)

![]()
[Research](https://rhinosecuritylabs.com/research/)

## CloudGoat Official Walkthrough Series: ‘sqs\_flag\_shop’

John De Armas
December 3, 2024

CloudGoat is Rhino Security Labs’s tool for deploying “vulnerable by design” AWS infrastructure. This blog post will walk through one of the newest CloudGoat scenarios, sqs\_flag\_shop. where you will attempt to move through an AWS…

[Read more](https://rhinosecuritylabs.com/research/cloudgoat-walkthrough-sqs_flag_shop/)

![]()
[Research](https://rhinosecuritylabs.com/research/)

## CloudGoat: New Scenario and Walkthrough (sns\_secrets)

![]()
[Cloud Security](https://rhinosecuritylabs.com/cloud-security/)

## CloudGoat Official Walkthrough Series: ‘glue\_privesc’

[Technical](https://rhinosecuritylabs.com/blog-technical/)
[Strategic](https://rhinosecuritylabs.com/blog-strategic/)
[Technical & Strategic

Both](https://rhinosecuritylabs.com/blog/)

Categories

Clear Selection

API

Application Security

AWS

Azure

Buyer's Guide

Cloud Security

Compliance

Enterprise Security

GCP

Google Cloud

Internet of Things

Mobile Security

Network Security

News

Penetration Testing

Research

Social Engineering

Tool Development

Uncategorized

![]()
[Research](https://rhinosecuritylabs.com/research/)

## Vestaboard: Exploring Broken Access Controls and Privilege Escalation

Tyler Ramsbey

During research on the Vestaboard web platform, the Rhino research team identified three instances of Broken Access Controls.

Read-Access to other Vestaboards.

Ability to update names of other users.

Privilege escalation from Admin to…

[Read more](https://rhinosecuritylabs.com/research/vestaboard-vulnerabilities/)

##### [Assessment Services](https://rhinosecuritylabs.com/assessment-services/)

* [Network Penetration Test](https://rhinosecuritylabs.com/assessment-services/network-penetration-testing/)
* [Webapp Penetration Test](https://rhinosecuritylabs.com/assessment-services/web-penetration-testing/)
* [AWS Cloud Penetration Testing](https://rhinosecuritylabs.com/assessment-services/aws-cloud-penetration-testing/)
* [GCP Cloud Penetration Testing](https://rhinosecuritylabs.com/assessment-services/gcp-penetration-testing/)
* [Azure Penetration Testing](https://rhinosecuritylabs.com/assessment-services/azure-penetration-testing/)
* [Mobile App Assessment](https://rhinosecuritylabs.com/assessment-services/mobile-app-assessment/)
* [Secure Code Review](https://rhinosecuritylabs.com/assessment-services/secure-code-review/)
* [Social Engineering / Phishing Testing](https://rhinosecuritylabs.com/assessment-services/social-engineering/)
* [Vishing (Voice Call) Testing](https://rhinosecuritylabs.com/assessment-services/social-engineering/vishing-assessments/)
* [Red Team Engagements](https://rhinosecuritylabs.com/assessment-services/red-team-engagement/)

##### [Industries](https://rhinosecuritylabs.com/industry/)

* [Healthcare](https://rhinosecuritylabs.com/industry/healthcare/)
* [Finance](https://rhinosecuritylabs.com/industry/financial/)
* [Technology](https://rhinosecuritylabs.com/industry/technology/)
* [Retail](https://rhinosecuritylabs.com/industry/retail/)

##### [Resources](https://rhinosecuritylabs.com/resources/)

* [Technical Blog](https://rhinosecuritylabs.com/blog-technical/)
* [Strategic Blog](https://rhinosecuritylabs.com/blog-strategic/)
* [Example Pentest Report](https://rhinosecuritylabs.com/landing/penetration-test-report/)
* [Technical Research](https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/)
* [Vulnerability Disclosures](https://rhinosecuritylabs.com/research-and-vulnerability-disclosure/)
* [Disclosure Policy](https://rhinosecuritylabs.com/company/vulnerability-disclosure-policy/)
* [Penetration Testing FAQ](https://rhinosecuritylabs.com/assessment-services/penetration-testing-faq/)
* [Support: AWS Pentest Form](https://rhinosecuritylabs.com/assessment-services/support-aws-penetration-testing-form/)

##### [Company](https://rhinosecuritylabs.com/company/)

* [Leadership](https://rhinosecuritylabs.com/company/leadership/)
* [Blog](https://rhinosecuritylabs.com/blog/)
* [Careers](https://rhinosecuritylabs.com/careers/)
* [Company Principles](https://rhinosecuritylabs.com/careers/rhino-company-principles/)
* [Contact Us](https://rhinosecuritylabs.com/contact/)
* [Get a Quote](https://rhinosecuritylabs.com/request-a-quote/)
* [RSS Feed](https://rhinosecuritylabs.com/blog/feed/)

##### About Us

Rhino Security Labs is a top penetration testing and security assessment firm, with a focus on cloud pentesting (AWS, GCP, Azure), network pentesting, web application pentesting, and phishing.

With manual, deep-dive engagements, we identify security vulnerabilities which put clients at risk.

Endorsed by industry leaders, Rhino Security Labs is a trusted security advisor to the Fortune 500.

info@rhinosecuritylabs.com

(888) 944-8679

Rhino Security Labs, Inc



=== Content from github.com_2f0da5f9_20250114_221706.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTryGhost%2FGhost%2Fpull%2F19646)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FTryGhost%2FGhost%2Fpull%2F19646)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=TryGhost%2FGhost)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[TryGhost](/TryGhost)
/
**[Ghost](/TryGhost/Ghost)**
Public

* [Notifications](/login?return_to=%2FTryGhost%2FGhost) You must be signed in to change notification settings
* [Fork
  10.5k](/login?return_to=%2FTryGhost%2FGhost)
* [Star
   48k](/login?return_to=%2FTryGhost%2FGhost)

* [Code](/TryGhost/Ghost)
* [Issues
  31](/TryGhost/Ghost/issues)
* [Pull requests
  144](/TryGhost/Ghost/pulls)
* [Actions](/TryGhost/Ghost/actions)
* [Security](/TryGhost/Ghost/security)
* [Insights](/TryGhost/Ghost/pulse)

Additional navigation options

* [Code](/TryGhost/Ghost)
* [Issues](/TryGhost/Ghost/issues)
* [Pull requests](/TryGhost/Ghost/pulls)
* [Actions](/TryGhost/Ghost/actions)
* [Security](/TryGhost/Ghost/security)
* [Insights](/TryGhost/Ghost/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FTryGhost%2FGhost%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FTryGhost%2FGhost%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# 🐛 Fix XSS Vulnerability in SVG Upload Handling #19646

 Closed

[TeneBrae93](/TeneBrae93)
wants to merge
3
commits into
[TryGhost:main](/TryGhost/Ghost/tree/main "TryGhost/Ghost:main")
from
[TeneBrae93:main](/TeneBrae93/Ghost/tree/main "TeneBrae93/Ghost:main")

 Closed

# [🐛 Fix XSS Vulnerability in SVG Upload Handling](#top) #19646

[TeneBrae93](/TeneBrae93)
wants to merge
3
commits into
[TryGhost:main](/TryGhost/Ghost/tree/main "TryGhost/Ghost:main")
from
[TeneBrae93:main](/TeneBrae93/Ghost/tree/main "TeneBrae93/Ghost:main")

[Conversation
2](/TryGhost/Ghost/pull/19646)
[Commits
3](/TryGhost/Ghost/pull/19646/commits)
[Checks
2](/TryGhost/Ghost/pull/19646/checks)
[Files changed](/TryGhost/Ghost/pull/19646/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![TeneBrae93](https://avatars.githubusercontent.com/u/86263907?s=60&v=4)](/TeneBrae93)

Copy link

### @TeneBrae93 **[TeneBrae93](/TeneBrae93)** commented [Feb 2, 2024](#issue-2115947134)

This PR addresses a vulnerability in the handling of SVG file uploads (especially in staff profile pictures) within Ghost CMS. By integrating DOMPurify, we ensure that SVG files are sanitized to remove potential XSS attacks, enhancing the security of the platform without affecting the core functionalities.

**Changes Made:**

* Integrated DOMPurify to sanitize SVG content during the upload process in `update.js`.
* Updated `package.json` to include `dompurify` as a dependency, ensuring the sanitization process is robust and effective.

**Impact:**

* Enhances the security of Ghost CMS by preventing XSS attacks through SVG uploads.
* Maintains the user experience and functionalities related to SVG uploads, ensuring only malicious content is targeted and removed.

**Testing:**

* Manual testing was conducted with various SVG files to ensure legitimate uploads remain unaffected while potential XSS payloads are sanitized.

This fix contributes to the ongoing effort to maintain and improve the security posture of Ghost CMS, ensuring it remains a safe and reliable platform for users and developers alike.

**Additional Notes:**

* This PR is submitted in response to the ability to execute JavaScript in SVG files when uploaded as profile pictures. Further discussions and contributions to this fix are welcome. This was initially submitted to `security@ghost.org` but was declined since staff are trusted users. This PR will fix the core issue and prevent XSS in SVG uploads.

Thank you for considering this contribution to enhance Ghost CMS's security.

Sorry, something went wrong.

All reactions

 [TeneBrae93](/TeneBrae93)
added 3 commits
[February 2, 2024 15:43](#commits-pushed-2b7dfa0)

[![@TeneBrae93](https://avatars.githubusercontent.com/u/86263907?s=40&v=4)](/TeneBrae93)

`[Integrate DOMPurify for SVG file sanitization to prevent XSS attacks](/TryGhost/Ghost/pull/19646/commits/2b7dfa0b3f05d554e1c8bcfe7878ba70e875f32a "Integrate DOMPurify for SVG file sanitization to prevent XSS attacks

This commit introduces DOMPurify as a dependency to sanitize SVG files during upload. SVG files can potentially contain malicious code leading to Cross-Site Scripting (XSS) vulnerabilities. By sanitizing SVG content with DOMPurify, we mitigate the risk of XSS, enhancing the security of the Ghost CMS platform.

- Added `dompurify` and `jsdom` to `package.json` dependencies for server-side DOM emulation and sanitization.
- Updated file validation logic to include SVG sanitization in `upload.js`.
- Ensured that all SVG files are checked and sanitized before being saved or processed further.
- Added relevant documentation in `README.md` and `CONTRIBUTING.md` to guide developers on the necessity and usage of DOMPurify for handling SVG uploads.

This security measure is crucial for protecting both the Ghost CMS platform and its users from potential XSS attacks through SVG file uploads. While DOMPurify aims to sanitize SVG files thoroughly, it's configured to strike a balance between security and usability, ensuring valid SVG files remain functional after sanitization.")`
 …

`[2b7dfa0](/TryGhost/Ghost/pull/19646/commits/2b7dfa0b3f05d554e1c8bcfe7878ba70e875f32a)`

```
This commit introduces DOMPurify as a dependency to sanitize SVG files during upload. SVG files can potentially contain malicious code leading to Cross-Site Scripting (XSS) vulnerabilities. By sanitizing SVG content with DOMPurify, we mitigate the risk of XSS, enhancing the security of the Ghost CMS platform.

- Added `dompurify` and `jsdom` to `package.json` dependencies for server-side DOM emulation and sanitization.
- Updated file validation logic to include SVG sanitization in `upload.js`.
- Ensured that all SVG files are checked and sanitized before being saved or processed further.
- Added relevant documentation in `README.md` and `CONTRIBUTING.md` to guide developers on the necessity and usage of DOMPurify for handling SVG uploads.

This security measure is crucial for protecting both the Ghost CMS platform and its users from potential XSS attacks through SVG file uploads. While DOMPurify aims to sanitize SVG files thoroughly, it's configured to strike a balance between security and usability, ensuring valid SVG files remain functional after sanitization.
```

[![@TeneBrae93](https://avatars.githubusercontent.com/u/86263907?s=40&v=4)](/TeneBrae93)

`[Implement XSS protection for SVG uploads in update.js](/TryGhost/Ghost/pull/19646/commits/733de57ef7ba8f4dac7c7351963811141e5f9688 "Implement XSS protection for SVG uploads in update.js

This commit addresses a vulnerability by integrating DOMPurify to sanitize SVG file uploads, preventing potential XSS attacks within Ghost CMS. The changes made in the `update.js` file ensure that all SVG files undergo a sanitization process before being processed or stored.

Key Changes:
- Integrated DOMPurify within `update.js` to sanitize SVG files against XSS vulnerabilities.
- Added `jsdom` to emulate a DOM environment for DOMPurify to operate in a server-side context.
- Updated the SVG file validation workflow to include a sanitization step using DOMPurify, ensuring SVG files are clean before acceptance.
- Ensured backward compatibility and non-disruption of existing functionalities by selectively applying sanitization only to SVG files.")`
 …

`[733de57](/TryGhost/Ghost/pull/19646/commits/733de57ef7ba8f4dac7c7351963811141e5f9688)`

```
This commit addresses a vulnerability by integrating DOMPurify to sanitize SVG file uploads, preventing potential XSS attacks within Ghost CMS. The changes made in the `update.js` file ensure that all SVG files undergo a sanitization process before being processed or stored.

Key Changes:
- Integrated DOMPurify within `update.js` to sanitize SVG files against XSS vulnerabilities.
- Added `jsdom` to emulate a DOM environment for DOMPurify to operate in a server-side context.
- Updated the SVG file validation workflow to include a sanitization step using DOMPurify, ensuring SVG files are clean before acceptance.
- Ensured backward compatibility and non-disruption of existing functionalities by selectively applying sanitization only to SVG files.
```

[![@TeneBrae93](https://avatars.githubusercontent.com/u/86263907?s=40&v=4)](/TeneBrae93)

`[Update package.json](/TryGhost/Ghost/pull/19646/commits/731fc25c7810fa659f8067f80e252903e092ac24 "Update package.json

Fixed syntax causing errors.")`
 …

`[731fc25](/TryGhost/Ghost/pull/19646/commits/731fc25c7810fa659f8067f80e252903e092ac24)`

```
Fixed syntax causing errors.
```

[![@Yaniv-git](https://avatars.githubusercontent.com/u/59412524?s=80&u=320f70f64c191c52aead4bdbb9245d65d1353a17&v=4)](/Yaniv-git)

Copy link

### **[Yaniv-git](/Yaniv-git)** commented [Feb 28, 2024](#issuecomment-1968506774)

| If the sanitized SVG content is then served via an SVG file (meaning `Content-Type: image/svg+xml`) the sanitization should have only the SVG namespace (taken example from [here](https://github.com/cure53/DOMPurify?tab=readme-ov-file#control-our-allow-lists-and-block-lists)):  ``` const clean = DOMPurify.sanitize(dirty, {USE_PROFILES: {svg: true}});  ```  Because if not, we introduce namespace confusion and could be prone to mXSS. for example, in a normal parsing (as done in DOMPurify): [image](https://private-user-images.githubusercontent.com/59412524/308480862-3280d7d7-e912-48bc-b09c-35ec97555fa7.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTMzMjYsIm5iZiI6MTczNjg5MzAyNiwicGF0aCI6Ii81OTQxMjUyNC8zMDg0ODA4NjItMzI4MGQ3ZDctZTkxMi00OGJjLWIwOWMtMzVlYzk3NTU1ZmE3LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMTcwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTEzMzE5NzNkZTA5YWZjNjY3ZDg4YWYyYTk1ZTMyY2Q1MzgwNzViMzY3MjMwYWRkMDljYzdkN2IyMWYzYTY5YmMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.fVOU8cTZPnIYK2wVIOpKVMkN85n4C80TvdiiHlW8Vhs) vs how the browser will parse it when the `Content-Type: image/svg+xml` [image](https://private-user-images.githubusercontent.com/59412524/308481196-eb1f9f73-b702-490e-bbc1-3cb3810e00ec.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTMzMjYsIm5iZiI6MTczNjg5MzAyNiwicGF0aCI6Ii81OTQxMjUyNC8zMDg0ODExOTYtZWIxZjlmNzMtYjcwMi00OTBlLWJiYzEtM2NiMzgxMGUwMGVjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMTcwNlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWI1Y2I3ZGI0NTI4Nzc2OGI5ZmZjYjU2Mjg3ODcwMWNhMTQ5MmM5ZmI4MTczMDcwYTM2YWM5MjJlYjI3NDVhY2UmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.lXE0NgYZWuHnIltEhoLMf4NpwNalWAY0NoAXPRdU8BE) |
| --- |

All reactions

Sorry, something went wrong.

[![@9larsons](https://avatars.githubusercontent.com/u/21961100?s=80&u=88733bec5cae98b114339c88d882ccdc1fc4cf96&v=4)](/9larsons)

Copy link

Contributor

### **[9larsons](/9larsons)** commented [May 28, 2024](#issuecomment-2135295429)

| [@TeneBrae93](https://github.com/TeneBrae93) Thanks for the comprehensive report and proposed fix! I've merged a PR [here](https://github.com/TryGhost/Ghost/pull/20264). `dompurify` had a few issues, namely that it always modifies the base file/content and doesn't provide a flag to tell you if it actually did any cleaning, meaning we couldn't write a replicable test using it. |
| --- |

All reactions

Sorry, something went wrong.

[![@9larsons](https://avatars.githubusercontent.com/u/21961100?s=40&u=88733bec5cae98b114339c88d882ccdc1fc4cf96&v=4)](/9larsons)
[9larsons](/9larsons)
closed this
[May 28, 2024](#event-12958217513)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FTryGhost%2FGhost%2Fpull%2F19646)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

3 participants

[![@TeneBrae93](https://avatars.githubusercontent.com/u/86263907?s=52&v=4)](/TeneBrae93) [![@Yaniv-git](https://avatars.githubusercontent.com/u/59412524?s=52&v=4)](/Yaniv-git) [![@9larsons](https://avatars.githubusercontent.com/u/21961100?s=52&v=4)](/9larsons)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


