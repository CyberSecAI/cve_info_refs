=== Content from www.jenkins.io_fa807762_20250115_195355.html ===


[> User Documentation Home](/doc/)

##### User Handbook

* [User Handbook Overview](/doc/book/getting-started/)
* [Installing Jenkins](/doc/book/installing/)
* [Platform Information](/doc/book/platform-information/)
* [Using Jenkins](/doc/book/using/)
* [Pipeline](/doc/book/pipeline/)
* [Blue Ocean](/doc/book/blueocean/)
* [Managing Jenkins](/doc/book/managing/)
  + [Configuring the System](/doc/book/managing/system-configuration/)
  + [Configuration as Code](/doc/book/managing/casc/)
  + [Managing Tools](/doc/book/managing/tools/)
  + [Managing Plugins](/doc/book/managing/plugins/)
  + [About Jenkins](/doc/book/managing/about-jenkins/)
  + [System Information](/doc/book/managing/system-info/)
  + [Jenkins Features Controlled with System Properties](/doc/book/managing/system-properties/)
  + [Change System Time Zone](/doc/book/managing/change-system-timezone/)
  + [Jenkins CLI](/doc/book/managing/cli/)
  + [Script Console](/doc/book/managing/script-console/)
  + [Groovy Hook Scripts](/doc/book/managing/groovy-hook-scripts/)
  + [Managing Nodes](/doc/book/managing/nodes/)
  + [In-process Script Approval](/doc/book/managing/script-approval/)
  + [Users](/doc/book/managing/users/)
  + [Themes for user interface](/doc/book/managing/ui-themes/)
  + [User Content](/doc/book/managing/user-content/)
  + [Spawning Processes From Build](/doc/book/managing/spawning-processes/)
* [Securing Jenkins](/doc/book/security/)
* [System Administration](/doc/book/system-administration/)
* [Scaling Jenkins](/doc/book/scaling/)
* [Troubleshooting Jenkins](/doc/book/troubleshooting/)
* [Glossary](/doc/book/glossary/)

##### Tutorials

* [Guided Tour](/doc/pipeline/tour/getting-started/)
* [Jenkins Pipeline](/doc/tutorials#pipeline)
* [Using Build Tools](/doc/tutorials#tools)

##### Resources

* [Pipeline Syntax reference](/doc/book/pipeline/syntax/)
* [Pipeline Steps reference](/doc/pipeline/steps/)
* [LTS Upgrade guides](/doc/upgrade-guide/)

[â Change System Time Zone](../change-system-timezone)

[â Managing Jenkins](../)
[Index](../../)

[Script Console â](../script-console)

# Jenkins CLI

Table of Contents

* [Using the CLI over SSH](#ssh)
  + [Authentication](#authentication)
  + [Common Commands](#common-commands)
* [Using the CLI client](#using-the-cli-client)
  + [Comparing SSH and CLI client](#comparing-ssh-and-cli-client)
  + [Downloading the client](#downloading-the-client)
  + [Using the client](#using-the-client)
  + [Client connection modes](#client-connection-modes)
  + [Common Problems with the CLI client](#common-problems-with-the-cli-client)

Jenkins has a built-in command line interface that allows users and
administrators to access Jenkins from a script or shell environment. This can
be convenient for scripting of routine tasks, bulk updates, troubleshooting,
and more.

The command line interface can be accessed over SSH or with the Jenkins CLI
client, a `.jar` file distributed with Jenkins.

|  | This document assumes Jenkins 2.54 or newer. Older versions of the CLI client are considered insecure and should not be used.   WebSocket support is available when using both server and client 2.217 or newer. |
| --- | --- |

## Using the CLI over SSH

In a new Jenkins installation, the SSH service is disabled by default.
Administrators may choose to set a specific port or ask Jenkins to pick a random port
in the [Security](../security/#ssh-server) page.
In order to determine the randomly assigned SSH port,
inspect the headers returned on a Jenkins URL, for example:

```
% curl -Lv https://JENKINS_URL/login 2>&1 | grep -i 'x-ssh-endpoint'
< X-SSH-Endpoint: localhost:53801
%
```

With the random SSH port (`53801` in this example), and [Authentication](#authentication)
configured, any modern SSH client may securely execute CLI commands.

### Authentication

Whichever user used for authentication with the Jenkins controller must have the
`Overall/Read` permission in order to *access* the CLI. The user may require
additional permissions depending on the commands executed.

Authentication in SSH mode relies on
SSH-based public/private key authentication. In order to add an SSH public key
for the appropriate user, navigate to
`[JENKINS_URL/me/security](https://JENKINS_URL/me/security)` and paste an SSH public key
into the appropriate text area.

![Adding public SSH keys for a user](../../resources/managing/cli-adding-ssh-public-keys.png)

### Common Commands

Jenkins has a number of built-in CLI commands which can be found in every
Jenkins environment, such as `build` or `list-jobs`. Plugins may also provide
CLI commands; in order to determine the full list of commands available
in a given Jenkins environment, execute the CLI `help` command:

```
% ssh -l kohsuke -p 53801 localhost help
```

The following list of commands is not comprehensive, but it is a useful
starting point for Jenkins CLI usage.

#### build

One of the most common and useful CLI commands is `build`, which allows the
user to trigger any job or Pipeline for which they have permission.

The most basic invocation will simply trigger the job or Pipeline and exit, but
with the additional options a user may also pass parameters, poll SCM, or even
follow the console output of the triggered build or Pipeline run.

```
% ssh -l kohsuke -p 53801 localhost help build

java -jar jenkins-cli.jar build JOB [-c] [-f] [-p] [-r N] [-s] [-v] [-w]
Starts a build, and optionally waits for a completion.  Aside from general
scripting use, this command can be used to invoke another job from within a
build of one job.  With the -s option, this command changes the exit code based
on the outcome of the build (exit code 0 indicates a success) and interrupting
the command will interrupt the job.  With the -f option, this command changes
the exit code based on the outcome of the build (exit code 0 indicates a
success) however, unlike -s, interrupting the command will not interrupt the
job (exit code 125 indicates the command was interrupted).  With the -c option,
a build will only run if there has been an SCM change.
 JOB : Name of the job to build
 -c  : Check for SCM changes before starting the build, and if there's no
       change, exit without doing a build
 -f  : Follow the build progress. Like -s only interrupts are not passed
       through to the build.
 -p  : Specify the build parameters in the key=value format.
 -s  : Wait until the completion/abortion of the command. Interrupts are passed
       through to the build.
 -v  : Prints out the console output of the build. Use with -s
 -w  : Wait until the start of the command
% ssh -l kohsuke -p 53801 localhost build build-all-software -f -v
Started build-all-software #1
Started from command line by admin
Building in workspace /tmp/jenkins/workspace/build-all-software
[build-all-software] /bin/sh -xe /tmp/hudson1100603797526301795.sh
+ echo hello world
hello world
Finished: SUCCESS
Completed build-all-software #1 : SUCCESS
%
```

#### console

Similarly useful is the `console` command, which retrieves the console output
for the specified build or Pipeline run. When no build number is provided, the
`console` command will output the last completed build’s console output.

```
% ssh -l kohsuke -p 53801 localhost help console

java -jar jenkins-cli.jar console JOB [BUILD] [-f] [-n N]
Produces the console output of a specific build to stdout, as if you are doing 'cat build.log'
 JOB   : Name of the job
 BUILD : Build number or permalink to point to the build. Defaults to the last
         build
 -f    : If the build is in progress, stay around and append console output as
         it comes, like 'tail -f'
 -n N  : Display the last N lines
% ssh -l kohsuke -p 53801 localhost console build-all-software
Started from command line by kohsuke
Building in workspace /tmp/jenkins/workspace/build-all-software
[build-all-software] /bin/sh -xe /tmp/hudson1100603797526301795.sh
+ echo hello world
yes
Finished: SUCCESS
%
```

#### who-am-i

The `who-am-i` command is helpful for listing the current user’s credentials
and permissions available to the user. This can be useful when debugging the
absence of CLI commands due to the lack of certain permissions.

```
% ssh -l kohsuke -p 53801 localhost help who-am-i

java -jar jenkins-cli.jar who-am-i
Reports your credential and permissions.
% ssh -l kohsuke -p 53801 localhost who-am-i
Authenticated as: kohsuke
Authorities:
  authenticated
%
```

## Using the CLI client

While the SSH-based CLI is fast and covers most needs, there may be situations where the CLI
client distributed with Jenkins is a better fit. For example, the default transport for the CLI client
is HTTP which means no additional ports need to be opened in a firewall for its
use.

### Comparing SSH and CLI client

Both SSH and jenkins-cli.jar provide access to a set of commands that lets you interact with Jenkins from a command line, but they have a few differences:

* Jenkins SSH does not require any custom jar file on the client side, making it easier to access Jenkins from a variety of sources
* SSH client was build to be a generic tool to serve several purposes.
  It doesn’t offer an easy way to do basic things that are common and specific to Jenkins environments.
  Using the `jenkins-cli.jar` instead of the ssh client may increase productivity and improve the development experience

### Downloading the client

The CLI client can be downloaded directly from a Jenkins controller at the URL
`/jnlpJars/jenkins-cli.jar`, in effect `[JENKINS_URL/jnlpJars/jenkins-cli.jar](https://JENKINS_URL/jnlpJars/jenkins-cli.jar)`

While a CLI `.jar` can be used against different versions of Jenkins, should
any compatibility issues arise during use, please re-download the latest `.jar`
file from the Jenkins controller.

### Using the client

The general syntax for invoking the client is as follows:

```
java -jar jenkins-cli.jar [-s JENKINS_URL] [global options...] command [command options...] [arguments...]
```

The `JENKINS_URL` can be specified via the environment variable `$JENKINS_URL`.
Summaries of other general options can be displayed by running the client with no arguments at all.

### Client connection modes

There are three basic modes in which the client may be used, selectable by global option:
`-webSocket`, `-http` and `-ssh`.

#### WebSocket connection mode

This is the default mode, though you may pass the `-webSocket` option explicitly for clarity.
The advantage is that a more standard transport is used, avoiding problems with many reverse proxies or the need for special proxy configuration.

#### HTTP connection mode

Starting from Jenkins 2.391, the default mode is `-webSocket`.
To use the HTTP mode, you must explicitly pass the `-http` option.

Authentication is preferably with an `-auth` option, which takes a `username:apitoken` argument.
Get your API token from `/me/configure`:

```
java -jar jenkins-cli.jar [-s JENKINS_URL] -auth kohsuke:abc1234ffe4a command ...
```

(Actual passwords are also accepted, but this is discouraged.)

You can also precede the argument with `@` to load the same content from a file:

```
java -jar jenkins-cli.jar [-s JENKINS_URL] -auth @/home/kohsuke/.jenkins-cli command ...
```

|  | For security reasons the use of a file to load the authentication credentials is the recommended authentication way. |
| --- | --- |

An alternative authentication method is to configure environment variables in a similar way as the `$JENKINS_URL`
is used.
The `username` can be specified via the environment variable `$JENKINS_USER_ID` while the `apitoken` can
be specified via the variable `$JENKINS_API_TOKEN`.
Both variables have to be set all at once.

```
export JENKINS_USER_ID=kohsuke
export JENKINS_API_TOKEN=abc1234ffe4a
java -jar jenkins-cli.jar [-s JENKINS_URL] command ...
```

In case these environment variables are configured you could still override the authentication method using different
credentials with the `-auth` option, which takes preference over them.

Generally no special system configuration need be done to enable HTTP-based CLI connections.
If you are running Jenkins behind an HTTP(S) reverse proxy,
ensure it does not buffer request or response bodies.

|  | This mode is known to not work reliably or at all when using certain reverse proxies. Prefer WebSocket mode. |
| --- | --- |

#### SSH connection mode

Authentication is via SSH keypair.
You must select the Jenkins user ID as well:

```
java -jar jenkins-cli.jar [-s JENKINS_URL] -ssh -user kohsuke command ...
```

In this mode, the client acts essentially like a native `ssh` command.

By default the client will try to connect to an SSH port on the same host as is used in the `JENKINS_URL`.
If Jenkins is behind an HTTP reverse proxy, this will not generally work,
so run Jenkins with the system property `-Dorg.jenkinsci.main.modules.sshd.SSHD.hostName=ACTUALHOST`
to define a hostname or IP address for the SSH endpoint.

### Common Problems with the CLI client

There are a number of common problems that may be experienced when running the
CLI client.

#### Server key did not validate

You may get the error below and find a log entry just below that concerning `mismatched keys`:

```
org.apache.sshd.common.SshException: Server key did not validate
    at org.apache.sshd.client.session.AbstractClientSession.checkKeys(AbstractClientSession.java:523)
    at org.apache.sshd.common.session.helpers.AbstractSession.handleKexMessage(AbstractSession.java:616)
    ...
```

This means your SSH configuration does not recognize the public key presented by the server.
It’s often the case when you run Jenkins in dev mode and multiple instances
of the application are run under the same SSH port over time.

In a development context, access your `~/.ssh/known_hosts` (or in `C:/Users/<your_name>/.ssh/known_hosts` for Windows)
and remove the line corresponding to your current SSH port (e.g. `[localhost]:3485`).
In a production context, check with the Jenkins administrator if the public key of the server changed recently.
If so, ask the administrator to do the the steps described above.

#### UsernameNotFoundException

If your client displays a stacktrace that looks like:

```
org.acegisecurity.userdetails.UsernameNotFoundException: <name_you_used>
    ...
```

This means your SSH keys were recognized and validated against the stored users but the username is not valid for the security realm your application is using at the moment.
This could occur when you were using the Jenkins database initially, configured your users, and then switched to another security realm (like LDAP, etc.) where the defined users do not exist yet.

To solve the problem, ensure your users exist in your configured security realm.

#### Troubleshooting logs

To get more information about the authentication process:

1. Go into **Manage Jenkins** > **System Log** > **Add new log recorder**.
2. Enter any name you want and click on **Ok**.
3. Click on **Add**
4. Type `org.jenkinsci.main.modules.sshd.PublicKeyAuthenticatorImpl` (or type `PublicKeyAuth` and then select the full name)
5. Set the level to **ALL**.
6. Repeat the previous three steps for `hudson.model.User`
7. Click on **Save**

When you try to authenticate, you can then refresh the page and see what happen internally.

---

[â Change System Time Zone](../change-system-timezone)

[â Managing Jenkins](../)
[Index](../../)

[Script Console â](../script-console)

---

[Was this page helpful?](#feedback)

Please submit your feedback about this page through this
[quick form](/doc/feedback-form/).

Alternatively, if you don't wish to complete the quick form, you can simply
indicate if you found this page helpful?

Yes

No

Submit

See existing feedback [here](https://docs.google.com/spreadsheets/d/1IIdpVs39JDYKg0sLQIv-MNO928qcGApAIfdW5ohfD78).



=== Content from portswigger.net_cc9e9dac_20250115_124309.html ===


[Login](/users)

Products

Solutions

[Research](/research)
[Academy](/web-security)
Support

Company

[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)

[My account](/users/youraccount)
[Customers](/customers)
[About](/about)
[Blog](/blog)
[Careers](/careers)
[Legal](/legal)
[Contact](/contact)
[Resellers](/support/reseller-faqs)
[![Burp Suite Enterprise Edition](/content/images/svg/icons/enterprise.svg)
**Burp Suite Enterprise Edition**
The enterprise-enabled dynamic web vulnerability scanner.](/burp/enterprise)
[![Burp Suite Professional](/content/images/svg/icons/professional.svg)
**Burp Suite Professional**
The world's #1 web penetration testing toolkit.](/burp/pro)
[![Burp Suite Community Edition](/content/images/svg/icons/community.svg)
**Burp Suite Community Edition**
The best manual tools to start web security testing.](/burp/communitydownload)
[![Dastardly, from Burp Suite](/mega-nav/images/dastardly.svg)
**Dastardly, from Burp Suite**
Free, lightweight web application security scanning for CI/CD.](/burp/dastardly)
[View all product editions](/burp)

[**Burp Scanner**

Burp Suite's web vulnerability scanner

![Burp Suite's web vulnerability scanner'](/mega-nav/images/burp-suite-scanner.jpg)](/burp/vulnerability-scanner)

[**Attack surface visibility**
Improve security posture, prioritize manual testing, free up time.](/solutions/attack-surface-visibility)
[**CI-driven scanning**
More proactive security - find and fix vulnerabilities earlier.](/solutions/ci-driven-scanning)
[**Application security testing**
See how our software enables the world to secure the web.](/solutions)
[**DevSecOps**
Catch critical bugs; ship more secure software, more quickly.](/solutions/devsecops)
[**Penetration testing**
Accelerate penetration testing - find more bugs, more quickly.](/solutions/penetration-testing)
[**Automated scanning**
Scale dynamic scanning. Reduce risk. Save time/money.](/solutions/automated-security-testing)
[**Bug bounty hunting**
Level up your hacking and earn more bug bounties.](/solutions/bug-bounty-hunting)
[**Compliance**
Enhance security monitoring to comply with confidence.](/solutions/compliance)

[View all solutions](/solutions)

[**Product comparison**

What's the difference between Pro and Enterprise Edition?

![Burp Suite Professional vs Burp Suite Enterprise Edition](/mega-nav/images/burp-suite.jpg)](/burp/enterprise/resources/enterprise-edition-vs-professional)

[**Support Center**
Get help and advice from our experts on all things Burp.](/support)
[**Documentation**
Tutorials and guides for Burp Suite.](/burp/documentation)
[**Get Started - Professional**
Get started with Burp Suite Professional.](/burp/documentation/desktop/getting-started)
[**Get Started - Enterprise**
Get started with Burp Suite Enterprise Edition.](/burp/documentation/enterprise/getting-started)
[**User Forum**
Get your questions answered in the User Forum.](https://forum.portswigger.net/)
[**Downloads**
Download the latest version of Burp Suite.](/burp/releases)

[Visit the Support Center](/support)

[**Downloads**

Download the latest version of Burp Suite.

![The latest version of Burp Suite software for download](/mega-nav/images/latest-burp-suite-software-download.jpg)](/burp/releases)

Academy home

* [Dashboard](https://portswigger.net/web-security/index.html)
* [Learning paths](https://portswigger.net/web-security/learning-paths)
* Latest topics

  [Web cache deception](/web-security/web-cache-deception)
  [Web LLM attacks](/web-security/llm-attacks)
  [API testing](/web-security/api-testing)
  [NoSQL injection](/web-security/nosql-injection)
  [Race conditions](/web-security/race-conditions)
  [View all topics](/web-security/all-topics)
* All content

  [All labs](/web-security/all-labs)
  [All topics](/web-security/all-topics)
  [Mystery labs](/web-security/mystery-lab-challenge)
* Hall of Fame

  [Leaderboard](https://portswigger.net/web-security/hall-of-fame)
  [Interview - Kamil Vavra](https://portswigger.net/web-security/getting-started/kamil-vavra/index.html)
  [Interview - Johnny Villarreal](https://portswigger.net/web-security/getting-started/johnny-villarreal/index.html)
  [Interview - Andres Rauschecker](https://portswigger.net/web-security/getting-started/andres-rauschecker/index.html)
* [Get started](https://portswigger.net/web-security/getting-started/index.html)
* Get certified

  [Get certified](https://portswigger.net/web-security/certification/index.html)
  [How to prepare](https://portswigger.net/web-security/certification/how-to-prepare/index.html)
  [How it works](https://portswigger.net/web-security/certification/how-it-works/index.html)
  [Practice exam](https://portswigger.net/web-security/certification/practice-exam/index.html)
  [Exam hints and guidance](https://portswigger.net/web-security/certification/exam-hints-and-guidance/index.html)
  [What the exam involves](https://portswigger.net/web-security/certification/how-it-works/index.html#what-the-exam-involves)
  [FAQs](https://portswigger.net/web-security/certification/frequently-asked-questions/index.html)
  [Validate your certification](https://portswigger.net/web-security/certification#validate-your-certification)

[Back to all topics](/web-security/all-topics)

### Cross-site request forgery (CSRF)

* [What is CSRF?](/web-security/csrf#what-is-csrf)
* [Impact](/web-security/csrf#what-is-the-impact-of-a-csrf-attack)
* [How does CSRF work?](/web-security/csrf#how-does-csrf-work)
* [XSS vs CSRF](/web-security/csrf/xss-vs-csrf)

  + [Can CSRF tokens prevent XSS attacks?](/web-security/csrf/xss-vs-csrf#can-csrf-tokens-prevent-xss-attacks)
* [Constructing an attack](/web-security/csrf#how-to-construct-a-csrf-attack)
* [Delivering an exploit](/web-security/csrf#how-to-deliver-a-csrf-exploit)
* [Defences](/web-security/csrf#common-defences-against-csrf)
* [Bypassing CSRF token validation](/web-security/csrf/bypassing-token-validation)

  + [What is a CSRF token?](/web-security/csrf/bypassing-token-validation#what-is-a-csrf-token)
  + [Flaws in CSRF token validation](/web-security/csrf/bypassing-token-validation#common-flaws-in-csrf-token-validation)

    - [Validation depends on request method](/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-request-method)
    - [Validation depends on token being present](/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-token-being-present)
    - [Token isn't tied to user session](/web-security/csrf/bypassing-token-validation#csrf-token-is-not-tied-to-the-user-session)
    - [Token is tied to a non-session cookie](/web-security/csrf/bypassing-token-validation#csrf-token-is-tied-to-a-non-session-cookie)
    - [Token is duplicated in a cookie](/web-security/csrf/bypassing-token-validation#csrf-token-is-simply-duplicated-in-a-cookie)
* [Bypassing SameSite cookie restrictions](/web-security/csrf/bypassing-samesite-restrictions)

  + [What is a site?](/web-security/csrf/bypassing-samesite-restrictions#what-is-a-site-in-the-context-of-samesite-cookies)
  + [Site vs origin](/web-security/csrf/bypassing-samesite-restrictions#what-s-the-difference-between-a-site-and-an-origin)
  + [How does SameSite work?](/web-security/csrf/bypassing-samesite-restrictions#how-does-samesite-work)

    - [Strict restriction level](/web-security/csrf/bypassing-samesite-restrictions#strict)
    - [Lax restriction level](/web-security/csrf/bypassing-samesite-restrictions#lax)
    - [No SameSite restrictions](/web-security/csrf/bypassing-samesite-restrictions#none)
  + [Bypassing Lax restrictions using GET requests](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-using-get-requests)
  + [Bypassing restrictions using on-site gadgets](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-using-on-site-gadgets)
  + [Bypassing restrictions via vulnerable sibling domains](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-via-vulnerable-sibling-domains)
  + [Bypassing Lax restrictions with newly issued cookies](/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-with-newly-issued-cookies)
* [Bypassing Referer-based CSRF defenses](/web-security/csrf/bypassing-referer-based-defenses)

  + [Validation of Referer depends on header being present](/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-depends-on-header-being-present)
  + [Validation of Referer can be circumvented](/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-can-be-circumvented)
* [Preventing CSRF vulnerabilities](/web-security/csrf/preventing)

  + [CSRF tokens](/web-security/csrf/preventing#use-csrf-tokens)

    - [Generating](/web-security/csrf/preventing#how-should-csrf-tokens-be-generated)
    - [Transmitting](/web-security/csrf/preventing#how-should-csrf-tokens-be-transmitted)
    - [Validating](/web-security/csrf/preventing#how-should-csrf-tokens-be-validated)
  + [Strict SameSite cookie restrictions](/web-security/csrf/preventing#use-strict-samesite-cookie-restrictions)
  + [Be wary of cross-origin, same-site attacks](/web-security/csrf/preventing#be-wary-of-cross-origin-same-site-attacks)
* [View all CSRF labs](/web-security/all-labs#cross-site-request-forgery-csrf)

* [Web Security Academy](/web-security)
* [CSRF](/web-security/csrf)
* [Bypassing SameSite cookie restrictions](/web-security/csrf/bypassing-samesite-restrictions)

# Bypassing SameSite cookie restrictions

SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. SameSite cookie restrictions provide partial protection against a variety of cross-site attacks, including CSRF, cross-site leaks, and some CORS exploits.

Since 2021, Chrome applies `Lax` SameSite restrictions by default if the website that issues the cookie doesn't explicitly set its own restriction level. This is a proposed standard, and we expect other major browsers to adopt this behavior in the future. As a result, it's essential to have solid grasp of how these restrictions work, as well as how they can potentially be bypassed, in order to thoroughly test for cross-site attack vectors.

In this section, we'll first cover how the SameSite mechanism works and clarify some of the related terminology. We'll then look at some of the most common ways you may be able to bypass these restrictions, enabling CSRF and other cross-site attacks on websites that may initially appear secure.

## What is a site in the context of SameSite cookies?

In the context of SameSite cookie restrictions, a site is defined as the top-level domain (TLD), usually something like `.com` or `.net`, plus one additional level of the domain name. This is often referred to as the TLD+1.

When determining whether a request is same-site or not, the URL scheme is also taken into consideration. This means that a link from `http://app.example.com` to `https://app.example.com` is treated as cross-site by most browsers.

![What is the site for SameSite cookies?](/web-security/csrf/images/site-definition.png)
#### Note

You may come across the term "effective top-level domain" (eTLD). This is just a way of accounting for the reserved multipart suffixes that are treated as top-level domains in practice, such as `.co.uk`.

## What's the difference between a site and an origin?

The difference between a site and an origin is their scope; a site encompasses multiple domain names, whereas an origin only includes one. Although they're closely related, it's important not to use the terms interchangeably as conflating the two can have serious security implications.

Two URLs are considered to have the same origin if they share the exact same scheme, domain name, and port. Although note that the port is often inferred from the scheme.

![Site vs origin](/web-security/csrf/images/site-vs-origin.png)

As you can see from this example, the term "site" is much less specific as it only accounts for the scheme and last part of the domain name. Crucially, this means that a cross-origin request can still be same-site, but not the other way around.

| **Request from** | **Request to** | **Same-site?** | **Same-origin?** |
| --- | --- | --- | --- |
| `https://example.com` | `https://example.com` | Yes | Yes |
| `https://app.example.com` | `https://intranet.example.com` | Yes | No: mismatched domain name |
| `https://example.com` | `https://example.com:8080` | Yes | No: mismatched port |
| `https://example.com` | `https://example.co.uk` | No: mismatched eTLD | No: mismatched domain name |
| `https://example.com` | `http://example.com` | No: mismatched scheme | No: mismatched scheme |

This is an important distinction as it means that any vulnerability enabling arbitrary JavaScript execution can be abused to bypass site-based defenses on other domains belonging to the same site. We'll see an example of this in one of the labs later.

## How does SameSite work?

Before the SameSite mechanism was introduced, browsers sent cookies in every request to the domain that issued them, even if the request was triggered by an unrelated third-party website. SameSite works by enabling browsers and website owners to limit which cross-site requests, if any, should include specific cookies. This can help to reduce users' exposure to CSRF attacks, which induce the victim's browser to issue a request that triggers a harmful action on the vulnerable website. As these requests typically require a cookie associated with the victim's authenticated session, the attack will fail if the browser doesn't include this.

All major browsers currently support the following SameSite restriction levels:

* [`Strict`](/web-security/csrf/bypassing-samesite-restrictions#strict)
* [`Lax`](/web-security/csrf/bypassing-samesite-restrictions#lax)
* [`None`](/web-security/csrf/bypassing-samesite-restrictions#none)

Developers can manually configure a restriction level for each cookie they set, giving them more control over when these cookies are used. To do this, they just have to include the `SameSite` attribute in the `Set-Cookie` response header, along with their preferred value:

`Set-Cookie: session=0F8tgdOhi9ynR1M9wa3ODa; SameSite=Strict`

Although this offers some protection against CSRF attacks, none of these restrictions provide guaranteed immunity, as we'll demonstrate using deliberately vulnerable, interactive labs later in this section.

#### Note

If the website issuing the cookie doesn't explicitly set a `SameSite` attribute, Chrome automatically applies `Lax` restrictions by default. This means that the cookie is only sent in cross-site requests that meet specific criteria, even though the developers never configured this behavior. As this is a proposed new standard, we expect other major browsers to adopt this behavior in future.

### Strict

If a cookie is set with the `SameSite=Strict` attribute, browsers will not send it in any cross-site requests. In simple terms, this means that if the target site for the request does not match the site currently shown in the browser's address bar, it will not include the cookie.

This is recommended when setting cookies that enable the bearer to modify data or perform other sensitive actions, such as accessing specific pages that are only available to authenticated users.

Although this is the most secure option, it can negatively impact the user experience in cases where cross-site functionality is desirable.

### Lax

`Lax` SameSite restrictions mean that browsers will send the cookie in cross-site requests, but only if both of the following conditions are met:

* The request uses the `GET` method.
* The request resulted from a top-level navigation by the user, such as clicking on a link.

This means that the cookie is not included in cross-site `POST` requests, for example. As `POST` requests are generally used to perform actions that modify data or state (at least according to best practice), they are much more likely to be the target of CSRF attacks.

Likewise, the cookie is not included in background requests, such as those initiated by scripts, iframes, or references to images and other resources.

### None

If a cookie is set with the `SameSite=None` attribute, this effectively disables SameSite restrictions altogether, regardless of the browser. As a result, browsers will send this cookie in all requests to the site that issued it, even those that were triggered by completely unrelated third-party sites.

With the exception of Chrome, this is the default behavior used by major browsers if no `SameSite` attribute is provided when setting the cookie.

There are legitimate reasons for disabling SameSite, such as when the cookie is intended to be used from a third-party context and doesn't grant the bearer access to any sensitive data or functionality. Tracking cookies are a typical example.

If you encounter a cookie set with `SameSite=None` or with no explicit restrictions, it's worth investigating whether it's of any use. When the "Lax-by-default" behavior was first adopted by Chrome, this had the side-effect of breaking a lot of existing web functionality. As a quick workaround, some websites have opted to simply disable SameSite restrictions on all cookies, including potentially sensitive ones.

When setting a cookie with `SameSite=None`, the website must also include the `Secure` attribute, which ensures that the cookie is only sent in encrypted messages over HTTPS. Otherwise, browsers will reject the cookie and it won't be set.

`Set-Cookie: trackingId=0F8tgdOhi9ynR1M9wa3ODa; SameSite=None; Secure`
## Bypassing SameSite Lax restrictions using GET requests

In practice, servers aren't always fussy about whether they receive a `GET` or `POST` request to a given endpoint, even those that are expecting a form submission. If they also use `Lax` restrictions for their session cookies, either explicitly or due to the browser default, you may still be able to perform a CSRF attack by eliciting a `GET` request from the victim's browser.

As long as the request involves a top-level navigation, the browser will still include the victim's session cookie. The following is one of the simplest approaches to launching such an attack:

`<script>
document.location = 'https://vulnerable-website.com/account/transfer-payment?recipient=hacker&amount=1000000';
</script>`

Even if an ordinary `GET` request isn't allowed, some frameworks provide ways of overriding the method specified in the request line. For example, Symfony supports the `_method` parameter in forms, which takes precedence over the normal method for routing purposes:

`<form action="https://vulnerable-website.com/account/transfer-payment" method="POST">
<input type="hidden" name="_method" value="GET">
<input type="hidden" name="recipient" value="hacker">
<input type="hidden" name="amount" value="1000000">
</form>`

Other frameworks support a variety of similar parameters.

LAB
PRACTITIONER
[SameSite Lax bypass via method override](/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-lax-bypass-via-method-override)

## Bypassing SameSite restrictions using on-site gadgets

If a cookie is set with the `SameSite=Strict` attribute, browsers won't include it in any cross-site requests. You may be able to get around this limitation if you can find a gadget that results in a secondary request within the same site.

One possible gadget is a client-side redirect that dynamically constructs the redirection target using attacker-controllable input like URL parameters. For some examples, see our materials on [DOM-based open redirection](/web-security/dom-based/open-redirection).

As far as browsers are concerned, these client-side redirects aren't really redirects at all; the resulting request is just treated as an ordinary, standalone request. Most importantly, this is a same-site request and, as such, will include all cookies related to the site, regardless of any restrictions that are in place.

If you can manipulate this gadget to elicit a malicious secondary request, this can enable you to bypass any SameSite cookie restrictions completely.

LAB
PRACTITIONER
[SameSite Strict bypass via client-side redirect](/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-client-side-redirect)

Note that the equivalent attack is not possible with server-side redirects. In this case, browsers recognize that the request to follow the redirect resulted from a cross-site request initially, so they still apply the appropriate cookie restrictions.

## Bypassing SameSite restrictions via vulnerable sibling domains

Whether you're testing someone else's website or trying to secure your own, it's essential to keep in mind that a request can still be same-site even if it's issued cross-origin.

Make sure you thoroughly audit all of the available attack surface, including any sibling domains. In particular, vulnerabilities that enable you to elicit an arbitrary secondary request, such as XSS, can compromise site-based defenses completely, exposing all of the site's domains to cross-site attacks.

In addition to classic CSRF, don't forget that if the target website supports WebSockets, this functionality might be vulnerable to cross-site WebSocket hijacking (CSWSH), which is essentially just a CSRF attack targeting a WebSocket handshake. For more details, see our topic on [WebSocket vulnerabilities](/web-security/websockets).

LAB
PRACTITIONER
[SameSite Strict bypass via sibling domain](/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-sibling-domain)

## Bypassing SameSite Lax restrictions with newly issued cookies

Cookies with `Lax` SameSite restrictions aren't normally sent in any cross-site `POST` requests, but there are some exceptions.

As mentioned earlier, if a website doesn't include a `SameSite` attribute when setting a cookie, Chrome automatically applies `Lax` restrictions by default. However, to avoid breaking single sign-on (SSO) mechanisms, it doesn't actually enforce these restrictions for the first 120 seconds on top-level `POST` requests. As a result, there is a two-minute window in which users may be susceptible to cross-site attacks.

#### Note

This two-minute window does not apply to cookies that were explicitly set with the `SameSite=Lax` attribute.

It's somewhat impractical to try timing the attack to fall within this short window. On the other hand, if you can find a gadget on the site that enables you to force the victim to be issued a new session cookie, you can preemptively refresh their cookie before following up with the main attack. For example, completing an OAuth-based login flow may result in a new session each time as the OAuth service doesn't necessarily know whether the user is still logged in to the target site.

To trigger the cookie refresh without the victim having to manually log in again, you need to use a top-level navigation, which ensures that the cookies associated with their current OAuth session are included. This poses an additional challenge because you then need to redirect the user back to your site so that you can launch the CSRF attack.

Alternatively, you can trigger the cookie refresh from a new tab so the browser doesn't leave the page before you're able to deliver the final attack. A minor snag with this approach is that browsers block popup tabs unless they're opened via a manual interaction. For example, the following popup will be blocked by the browser by default:

`window.open('https://vulnerable-website.com/login/sso');`

To get around this, you can wrap the statement in an `onclick` event handler as follows:

`window.onclick = () => {
window.open('https://vulnerable-website.com/login/sso');
}`

This way, the `window.open()` method is only invoked when the user clicks somewhere on the page.

LAB
PRACTITIONER
[SameSite Lax bypass via cookie refresh](/web-security/csrf/bypassing-samesite-restrictions/lab-samesite-strict-bypass-via-cookie-refresh)

## Register for free to track your learning progress

![The benefits of working through PortSwigger's Web Security Academy](/content/images/vulnerabilities/web-security-academy-footer.png)

* Practise exploiting vulnerabilities on realistic targets.
* Record your progression from Apprentice to Expert.
* See where you rank in our Hall of Fame.

REGISTER

As we use reCAPTCHA, you need to be able to access Google's servers to use this function.

Already got an account?
[Login here](https://portswigger.net/users)

Want to track your progress and have a more personalized learning experience? (It's free!)

[Sign up](/users/register)
[Login](/users?returnurl=%2fweb-security%2fcsrf%2fbypassing-samesite-restrictions)

![Try Burp Suite for Free](/content/images/logos/burp-suite-icon.svg)
#### Find CSRF vulnerabilities using Burp Suite

[Try for free](https://portswigger.net/burp)

Burp Suite

[Web vulnerability scanner](/burp/vulnerability-scanner)
[Burp Suite Editions](/burp)
[Release Notes](/burp/releases)

Vulnerabilities

[Cross-site scripting (XSS)](/web-security/cross-site-scripting)
[SQL injection](/web-security/sql-injection)
[Cross-site request forgery](/web-security/csrf)
[XML external entity injection](/web-security/xxe)
[Directory traversal](/web-security/file-path-traversal)
[Server-side request forgery](/web-security/ssrf)

Customers

[Organizations](/organizations)
[Testers](/testers)
[Developers](/developers)

Company

[About](/about)
[Careers](/careers)
[Contact](/about/contact)
[Legal](/legal)
[Privacy Notice](/privacy)

Insights

[Web Security Academy](/web-security)
[Blog](/blog)
[Research](/research)

[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](/)
 [Follow us](https://twitter.com/Burp_Suite)

© 2025 PortSwigger Ltd.



=== Content from www.sonarsource.com_7945a224_20250114_222448.html ===
NEW![Sonar has entered a definitive agreement to acquire Tidelift! Read the press release.](/company/press-releases/sonar-to-acquire-tidelift/) [![](data:image/svg+xml;charset=utf-8...)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=128&h=32&auto=format&fit=clip)](/ "Home")

* Solutions

  Use Cases

  [AI-assisted & quality-assured codeEnsure code generated by AI assistants is of the highest quality](/solutions/ai/)[DevOps transformationHarness the full potential of DevOps by reducing roll backs and improving quality of releases](/solutions/devops-transformation/)[Code coverageEnsure code quality and security by facilitating faster debugging through clear visibility of coverage gaps.](/solutions/code-coverage/) [Reduce & manage technical debtMaximize innovation by proactively managing technical debt](/solutions/reduce-technical-debt/)[Secure by designIntegrate code security in compliance with NIST Secure Software Development Framework](/solutions/secure-by-design-code/)[All Use CasesRead more about Sonar Use cases with blog articles, technical articles and developer guides](/solutions/use-cases/)

  Clean Code

  [What is clean codeA detailed definition of Clean Code](/solutions/clean-code/)[Power of clean codeBusiness success built on Clean Code](/solutions/power-of-clean-code/)[Security starts with Clean CodeStatic Application Security Testing with Sonar](/solutions/security/)[Clean as You CodeOur unique approach to Clean Code](/solutions/our-unique-approach/)

  Something For Everyone

  [For DevelopersFind and fix issues as you code](/solutions/for-developers/)[For DevOpsBuild your apps on Clean Code foundations](/solutions/infrastructure-as-code/)[For EnterpriseClean Code delivery from development to production](/solutions/for-enterprise/)[For the Public SectorClean Code for the public sector](/solutions/public-sector/)
* Products

  Industry Leading Products

  [![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/aa3b1f02-f1b0-448f-a3f2-a1bd32923a08/SQ_Logo_Cloud_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarCloudCloud-based static analysis tool for your CI/CD workflows](/products/sonarcloud/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/bdac1871-464e-4051-88db-7df20c3bfffa/SQ_Logo_Server_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarQubeSelf-managed static analysis tool for continuous codebase inspection](/products/sonarqube/)[![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/49f23af2-a29b-4d0f-95d7-ffd361f375e1/SQ_Logo_IDE_Light%20Backgrounds.svg?w=176&h=48&auto=format&fit=crop)Formerly SonarLintFree IDE extension that provides on-the-fly analysis and coding guidance](/products/sonarlint/)

  Languages and Frameworks

  [Java](/knowledge/languages/java/)[JavaScript](/knowledge/languages/js/)[TypeScript](/knowledge/languages/ts/)[Python](/knowledge/languages/python/)[C#](/knowledge/languages/csharp/)[C++](/knowledge/languages/cpp/)[C](/knowledge/languages/c/)[PHP](/knowledge/languages/php/)[Kotlin](/knowledge/languages/kotlin/)[See All](/lp/knowledge/languages/)
* Resources

  Learn About Clean Code

  [BlogStay connected with our latest development news and articles](/blog/)[Events hubLet's meet up online or in person - browse our conferences and webinars, or watch previous talks](/resources/events/)[Customer StoriesCheck out Sonar implementation success stories](/resources/customer-stories/)[White PapersFind in-depth articles on clean code](/resources/white-papers/)[LearnDeveloper learning hub - covering essential topics](/learn/)[Solution BriefsOur library of solution briefs](/resources/solution-briefs/)

  Go In Depth

  [SonarQube Server DocumentationFind more information on the technical details of SonarQube Server](https://docs.sonarsource.com/sonarqube/latest/)[SonarQube Cloud DocumentationFind more information on the technical details of SonarQube Cloud](https://docs.sonarsource.com/sonarcloud/)[SonarQube for IDE DocumentationFind more information on the technical details of SonarQube IDE](https://docs.sonarsource.com/sonarlint/)[Explore SonarpediaExplore our publicly available multi-language rules database](https://rules.sonarsource.com/)[LanguagesSee our multi-language coverage](/knowledge/languages/)
* Company

  Deliver Better Software

  [About UsSonar’s industry leading solution enables developers to write clean code and remediate existing code organically](/company/about/)[CareersJoin our growing team](/company/careers/)[Commitment to open sourceOur commitment to transparency, security, and continuous improvement](/solutions/commitment-to-open-source/)[CommunityGet latest updates, suggest features, and share your knowledge](https://community.sonarsource.com/)[PartnersSonar partners with the best resellers to bring Clean Code closer to you](/company/partners/)[Contact usHave questions? Get in touch](/company/contact/)

  Media

  [NewsroomNews announcements, media coverage, and more](/company/newsroom/)[CoverageFind articles about Sonar in the news](/company/coverage/)[Press ReleasesThe latest Sonar updates](/company/press-releases/)[CustomersAn overview of customers using Sonar by industry](/company/customers/)[Press KitExecutive headshots, quick stats, customer logos, and more](/company/press-kit/)
[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)
Search modal toggle button[Start for free](/open-source-editions/)[Explore pricing](/plans-and-pricing/)Mobile menu toggle button

Blog post

# Excessive Expansion: Uncovering Critical Security Vulnerabilities in Jenkins

![](data:image/svg+xml;charset=utf-8...)![Yaniv Nizry photo]()![Yaniv Nizry photo](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/dd553287-d805-4e36-8f4f-17f11fbc1bea/Potrait_square.jpg?w=800&h=800&auto=format&fit=crop)

Yaniv Nizry

Vulnerability Researcher

January 24, 2024

Date

* [Security](/blog/tag/security/)
![](data:image/svg+xml;charset=utf-8...)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/abef1f96-f752-4016-8fb8-43788dcf920e/Vulnerabilities%20in%20Jenkins_blog_index.webp?w=2400&h=1256&auto=format&fit=crop)![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/abef1f96-f752-4016-8fb8-43788dcf920e/Vulnerabilities%20in%20Jenkins_blog_index.webp?w=2400&h=1256&auto=format&fit=crop)
## Key Information

* Sonar’s Vulnerability Research Team has discovered security vulnerabilities in Jenkins, the leading open-source Continuous Integration and Continuous Deployment (CI/CD) software.
* The discovered Critical vulnerability tracked as CVE-2024-23897 allows unauthenticated attackers to read a limited amount of arbitrary files’ data, and "read-only" authorized attackers to an entire arbitrary file from Jenkins’ server.
* Attackers could leverage this vulnerability, by reading Jenkins secrets, to escalate privileges to admin and eventually execute arbitrary code on the server.
* The discovered High severity, cross-site WebSocket hijacking (CSWSH), vulnerability tracked as CVE-2024-23898, allows an attacker to execute arbitrary CLI commands by manipulating a victim to click on a link.
* The vulnerabilities were fixed in Jenkins versions 2.442, and LTS 2.426.3.

Jenkins is the leading open-source automation server widely used for building, deploying, and automating software projects. Originally developed as Hudson, Jenkins has evolved into a powerful tool for continuous integration and continuous delivery (CI/CD). It enables developers to automate various aspects of the software development lifecycle, including building, testing, and deploying applications. With a market share of approximately [44% in 2023](https://cd.foundation/announcement/2023/08/29/jenkins-project-growth/ "44% in 2023"), the popularity of Jenkins is evident. This means the potential impact of security vulnerabilities in Jenkins is large.

## Vulnerabilities Impact

Unauthenticated attackers can read the first few lines of arbitrary files from the server, while read-only authorized attackers can read the entire file. This could ultimately lead to the execution of arbitrary code in some cases (CVE-2024-23897). If one of the following conditions is met, even unauthenticated users have at least read permission:

* Legacy mode authorization is enabled.
* Configuration “Allow anonymous read access” is checked in the “logged-in users can do anything” authorization mode.
* The signup feature is enabled.

The second vulnerability (CVE-2024-23898) resides within the WebSocket CLI feature, which lacks an origin check, allowing Cross-Site WebSocket Hijacking (CSWSH). This vulnerability might be exploited by sending a malicious link to a victim. Certain modern web browsers implement a “[lax by default](https://caniuse.com/mdn-http_headers_set-cookie_samesite_lax_default "lax by default")” policy, which serves as a potential safeguard against this vulnerability. Nonetheless, given that some widely used browsers like Safari and Firefox do not strictly enforce this policy, and considering the associated risks of potential [bypass](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-with-newly-issued-cookies "bypass") techniques or users using outdated browsers, the severity classification for this vulnerability is High.

## Technical Details

In this section of the blog, we will explore our findings taking a deeper dive into the code, to understand the vulnerabilities and how an attacker could exploit them. During the Jenkins security team’s triaging of our report, they found further ways to exploit the first vulnerability (CVE-2024-23897) using an unauthenticated user. The following "Technical Details" covers the attack scenario of a read-only capable attacker.

### Background

Jenkins provides multiple ways of authorization, the unsafe *“anyone can do anything”*, the “*legacy”* permissions, and “*logged-in users can do anything”*. The latter authorization method allows the option for anonymous read access and gives read permission to anyone, which is also the case in the *legacy* mode.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/f98e4284-d45d-4708-88c3-be85efa76b45/Anonymous_example.png?w=554&h=132&auto=format&fit=crop)

On top of that, there is also the not recommended option to *“Allow users to sign up”,* which makes everyone at least read-only capable.

According to the [official documentation](https://www.jenkins.io/doc/book/security/access-control/permissions/#overall-read "official documentation"), read-only access allows users to:

* Access the basic Jenkins API and the API of any object they have access to.
* Access the people directory listing user accounts and known committer identities of anyone involved in visible projects.
* List and view all agents configured in Jenkins and access their summary pages.

On the other hand, [administrators](https://www.jenkins.io/doc/book/security/access-control/permissions/#administer "administrators") can pretty much do everything on a Jenkins instance. From an attacker's point of view, admins can run arbitrary code on a Jenkins server.

### Jenkins-CLI Feature Background

[Jenkins-CLI](https://www.jenkins.io/doc/book/managing/cli/ "Jenkins-CLI") provides users with a built-in command line interface to execute custom commands that are implemented in the [hudson/cli](https://github.com/jenkinsci/jenkins/tree/jenkins-2.441/core/src/main/java/hudson/cli "hudson/cli") directory of the Jenkins Git repository.

Aside from the common ways of invoking a command, using `jenkins-cli.jar` (which utilizes web sockets) or SSH, we found out that there is an additional option by sending two POST requests to `http://jenkins/cli?remoting=false`.

When [Stapler](https://github.com/jenkinsci/stapler "Stapler") (Jenkins' component that correlates a method to an endpoint) is [getting](https://github.com/jenkinsci/stapler/blob/ea4fc6ed8cd1b5eca6b4ce80b35654da9376e2bc/core/src/main/java/org/kohsuke/stapler/Stapler.java#L725 "getting") the relevant method of the *“/cli”* path, the endpoint will throw a [PlainCliEndpointResponse()](https://github.com/jenkinsci/jenkins/blob/3b0de10df3bedba515e13032104d4d84f83045be/core/src/main/java/hudson/cli/CLIAction.java#L195 "PlainCliEndpointResponse()") exception, which will end up in this [generateResponse](https://github.com/jenkinsci/jenkins/blob/824f64c23e52e5c765cc7604414740aab3436f8d/core/src/main/java/jenkins/util/FullDuplexHttpService.java#L166 "generateResponse") function:

```
public void generateResponse(StaplerRequest req, StaplerResponse rsp, Object node) throws IOException, ServletException {
    try {
        UUID uuid = UUID.fromString(req.getHeader("Session"));
        //...
        if (req.getHeader("Side").equals("download")) {
            FullDuplexHttpService service = createService(req, uuid);
            //...
            try {
                service.download(req, rsp);
            }
            //...
        } else {
            FullDuplexHttpService service = services.get(uuid);
            //...
            try {
                service.upload(req, rsp);
            }
            //...
}
}

```

This function requires a downloader and uploader. The downloader returns the command’s response, and the uploader invokes a specified command from the body of the request. Jenkins connects them (downloader and uploader) using the UUID from the `​​Session` header.

### Data Leak Vulnerability (CVE-2024-23897)

When invoking a CLI command with arguments, we have noticed that Jenkins uses [args4j’s](https://github.com/kohsuke/args4j "args4j’s") [parseArgument](https://github.com/jenkinsci/jenkins/blob/3b0de10df3bedba515e13032104d4d84f83045be/core/src/main/java/hudson/cli/CLICommand.java#L248 "parseArgument"), which [calls](https://github.com/kohsuke/args4j/blob/fc458a24d6bd08b58fdd0bd7e37acb08200eac59/args4j/src/org/kohsuke/args4j/CmdLineParser.java#L479 "calls") [expandAtFiles](https://github.com/kohsuke/args4j/blob/fc458a24d6bd08b58fdd0bd7e37acb08200eac59/args4j/src/org/kohsuke/args4j/CmdLineParser.java#L548 "expandAtFiles"):

```
private String[] expandAtFiles(String args[]) throws CmdLineException {
    List<String> result = new ArrayList<String>();
    for (String arg : args) {
        if (arg.startsWith("@")) {
            File file = new File(arg.substring(1));
            if (!file.exists())
                throw new CmdLineException(this,Messages.NO_SUCH_FILE,file.getPath());
            try {
                result.addAll(readAllLines(file));
            } catch (IOException ex) {
                throw new CmdLineException(this, "Failed to parse "+file,ex);
            }
        } else {
            result.add(arg);
        }
    }
    return result.toArray(new String[result.size()]);
}

```

The function checks if the argument starts with the @ character, and if so, it reads the file in the path after the @ and expands a new argument for each line.

![](data:image/svg+xml;charset=utf-8...)![]()![](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/9bbe4ad4-49bc-46c9-aea2-7677372913fe/ExpandAtFile_graph.png?w=1418&h=628&auto=format&fit=crop)

This means that if an attacker can control an argument, they can expand it to an arbitrary number of ones from an arbitrary file on the Jenkins instance.

One way an attacker could leverage this is to find a command that takes an arbitrary number of arguments and displays these back to the user. Since the arguments are populated from the contents of the file, an attacker could leak the file contents this way. We found the command [connect-to-node](https://github.com/jenkinsci/jenkins/blob/jenkins-2.441/core/src/main/java/hudson/cli/ConnectNodeCommand.java "connect-to-node") to be a good candidate: it receives a [list of strings as an argument](https://github.com/jenkinsci/jenkins/blob/824f64c23e52e5c765cc7604414740aab3436f8d/core/src/main/java/hudson/cli/ConnectNodeCommand.java#L46 "list of strings as an argument") and tries to connect to each one. If it fails, an error message is generated with the name of the failed connected node.

```
public class ConnectNodeCommand extends CLICommand {
    //...
    @Argument(metaVar = "NAME", usage = "Agent name, or empty string for built-in node; comma-separated list is supported", required = true, multiValued = true)
    private List<String> nodes;
    //...

    @Override
    protected int run() throws Exception {
        //...
        for (String node_s : hs) {
            try {
                Computer computer = Computer.resolveForCLI(node_s);
                computer.cliConnect(force);
            } catch (Exception e) {
                //...
                final String errorMsg = node_s + ": " + e.getMessage();
                stderr.println(errorMsg);
                //...
            }
        }
        //...
    }
}

```

This [connect-to-node](https://github.com/jenkinsci/jenkins/blob/jenkins-2.441/core/src/main/java/hudson/cli/ConnectNodeCommand.java "connect-to-node") command would usually require the CONNECT permission, which is verified in the [cliConnect](https://github.com/jenkinsci/jenkins/blob/3b0de10df3bedba515e13032104d4d84f83045be/core/src/main/java/hudson/model/Computer.java#L483 "cliConnect") function. But since the exception is thrown before the permission check in the [resolveForCLI](https://github.com/jenkinsci/jenkins/blob/3b0de10df3bedba515e13032104d4d84f83045be/core/src/main/java/hudson/model/Computer.java#L1676 "resolveForCLI") function, the command actually doesn’t require any authorizations apart from the initial [read-only verification](https://github.com/jenkinsci/jenkins/blob/3b0de10df3bedba515e13032104d4d84f83045be/core/src/main/java/hudson/cli/CLICommand.java#L247 "read-only verification").

Achieving code execution from arbitrary file read is dependent on the context. Some potentially interesting files for attackers could be:

* SSH keys
* /etc/passwd, /etc/shadow
* Project secrets and credentials (refer to Jenkins' [advisory](https://www.jenkins.io/security/advisory/2024-01-24/ "advisory") for more information)
* Source code, build artifacts
* and more…

#### Binary Files Reading Limitations

When a file is read, the process's default character encoding is used, which is UTF-8 for most deployments. Because of this, any invalid UTF-8 sequence (statistically almost 50% of all bytes, assuming an equal distribution) would be replaced by the sequence `0xef 0xbf 0xbd` and cause data loss.

Some other encodings (such as Windows-1252, commonly used by instances running on Windows) would make it more feasible to exfiltrate binary data.

### CSWSH Vulnerability (CVE-2024-23898)

As mentioned earlier, one of the ways to invoke the [Jenkins-CLI](https://www.jenkins.io/doc/book/managing/cli/ "Jenkins-CLI") commands is by web sockets (which is the implementation of `jenkins-cli.jar`).

It is known that browsers don’t enforce SOP and CORS policies on WebSockets: “Cross-origin restrictions imposed by SOP and CORS policies do not apply to WebSockets because those restrictions are placed on HTTP responses while WebSockets work over WS(WebSocket) or WSS(WebSocketSecure) protocols.” ([source](https://dev.to/pssingh21/websockets-bypassing-sop-cors-5ajm "source")).

Since there is no Jenkins-crumb (CSRF token) nor Origin header check in the web sockets requests, any website can use [WebSockets](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API "WebSockets") to invoke Jenkins-CLI commands with the victim's identity, in a similar fashion to CSRF vulnerabilities.

### Patch

The Jenkins security team patched CVE-2024-23897 by adding a secure configuration, which disables the “[expandAtFiles](https://github.com/kohsuke/args4j/blob/fc458a24d6bd08b58fdd0bd7e37acb08200eac59/args4j/src/org/kohsuke/args4j/CmdLineParser.java#L478 "expandAtFiles")” feature.

```
+  public static boolean ALLOW_AT_SYNTAX = SystemProperties.getBoolean(CLICommand.class.getName() + ".allowAtSyntax");
//...
-    return new CmdLineParser(this);
+    ParserProperties properties = ParserProperties.defaults().withAtSyntax(ALLOW_AT_SYNTAX);
+    return new CmdLineParser(this, properties);

```

And CVE-2024-23898 was patched by adding an origin verification to the WebSocket endpoint (The `ALLOW` parameter serves as a toggle, granting administrators the ability to override the updated default behavior. Giving the option to consistently permit or deny access to the WS CLI, irrespective of the Origin):

```
public HttpResponse doWs(StaplerRequest req) {
    if (!WebSockets.isSupported()) {
        return HttpResponses.notFound();
    }
+    if (ALLOW == null) {
+        final String actualOrigin = req.getHeader("Origin");
+        final String expectedOrigin = StringUtils.removeEnd(StringUtils.removeEnd(+Jenkins.get().getRootUrlFromRequest(), "/"), req.getContextPath());
+
+        if (actualOrigin == null || !actualOrigin.equals(expectedOrigin)) {
+            LOGGER.log(Level.FINE, () -> "Rejecting origin: " + actualOrigin + "; expected was from request: " + +expectedOrigin);
+            return HttpResponses.forbidden();
+        }
+    } else if (!ALLOW) {
+        return HttpResponses.forbidden();
+    }
    Authentication authentication = Jenkins.getAuthentication2();

```
## Timeline

| **Date** | **Action** |
| --- | --- |
| 2023-11-13 | We reported all issues to the Jenkins Security team |
| 2023-11-13 | Maintainers acknowledged the report |
| 2023-11-24 | Maintainers confirmed the issues |
| 2023-12-12 | We helped the vendor verify the fix |
| 2024-01-10 | Maintainers updated us on other attack scenarios  and the classification of Critical and High for our findings |
| 2024-01-24 | Maintainers assigned CVEs, and  released [advisory](https://www.jenkins.io/security/advisory/2024-01-24/) and patch versions 2.442, and LTS 2.426.3. |

## Summary

In this blog, we uncovered two vulnerabilities on Jenkins, the first one leverages the “[expandAtFiles](https://github.com/kohsuke/args4j/blob/fc458a24d6bd08b58fdd0bd7e37acb08200eac59/args4j/src/org/kohsuke/args4j/CmdLineParser.java#L479 "expandAtFiles")” functionality to read arbitrary files and eventually execute arbitrary code on the server. The second finding has the potential to execute arbitrary commands as the victim, by manipulating them to visit a malicious link.

At Sonar, we emphasize the importance of Clean Code principles. Doing so creates software characterized by clarity, maintainability, and comprehensibility. These attributes not only help the identification and resolution of vulnerabilities throughout the development process but also lower the likelihood of introducing security weaknesses that malicious actors might exploit.

Lastly, we would like to give huge kudos to the Jenkins team, who quickly and professionally assessed our findings, maintained great communication throughout the disclosure process, and provided a comprehensive fix. Thank you!

## Related Blog Posts

* [Source Code at Risk: Critical Code Vulnerability in CI/CD Platform TeamCity](https://www.sonarsource.com/blog/teamcity-vulnerability/ "Source Code at Risk: Critical Code Vulnerability in CI/CD Platform TeamCity")
* [Agent 007: Pre-Auth Takeover of Build Pipelines in GoCD](https://www.sonarsource.com/blog/gocd-pre-auth-pipeline-takeover/ "Agent 007: Pre-Auth Takeover of Build Pipelines in GoCD")
* [Agent 008: Chaining Vulnerabilities to Compromise GoCD](https://www.sonarsource.com/blog/gocd-vulnerability-chain/ "Agent 008: Chaining Vulnerabilities to Compromise GoCD")

#### SHARE

[twitter](https://twitter.com/share?text=undefined)[facebook](https://www.facebook.com/sharer/sharer.php?u=undefined)[linkedin](https://www.linkedin.com/sharing/share-offsite/?url=undefined)mail
## Get new blogs delivered directly to your inbox!

Stay up-to-date with the latest Sonar content. Subscribe now to receive the latest blog articles.

Email\*cheqSign up

By submitting this form, you agree to the storing and processing of your personal data as described in the [Privacy Policy](/company/privacy/ "Privacy Policy") and [Cookie Policy](/company/cookie-policy/ "Cookie Policy"). You can withdraw your consent by unsubscribing at any time.

This site is protected by reCAPTCHA and the Google [Privacy Policy](https://policies.google.com/privacy) and [Terms of Service](https://policies.google.com/terms) apply.

[Go to SonarSource homepage![](data:image/svg+xml;charset=utf-8...)![sonar logo ]()![sonar logo ](https://assets-eu-01.kc-usercontent.com:443/95361965-6528-012b-61fc-b49456de9702/8e59bcad-6e39-41dc-abd9-a0e251e8d63f/Sonar%20%282%29.svg?w=160&h=40&auto=format&fit=crop)](/)

* **Sonar Solutions**
  + [SAST](/solutions/security/)
  + [What is clean code](/solutions/clean-code/)
  + [Power of clean code](/solutions/power-of-clean-code/)
  + [Clean as you code](/solutions/our-unique-approach/)
  + [AI-assisted & quality-assured code](/solutions/ai/)
  + [DevOps transformation](/solutions/devops-transformation/)
  + [Outsourcing software development](/solutions/reduce-outsourcing-software-development-risk/)
  + [Reduce & manage technical debt](/solutions/reduce-technical-debt/)
  + [Secure by design](/solutions/secure-by-design-code/)
  + [Code coverage](/solutions/code-coverage/)
  + [Code review](/solutions/code-review/)
  + [For developers](/solutions/for-developers/)
  + [For enterprise](/solutions/for-enterprise/)
  + [Infrastructure as code](/solutions/infrastructure-as-code/)
  + [Public sector](/solutions/public-sector/)
* **Products**
  + [SonarQube for IDE](/products/sonarlint/)
  + [SonarQube Server](/products/sonarqube/)
  + [SonarQube Cloud](/products/sonarcloud/)**Pricing**
  + [Start for free](/open-source-editions/)
  + [Explore pricing](/plans-and-pricing/)
* **Company**
  + [About](/company/about/)
  + [Careers](/company/careers/)
  + [Commitment to open source](/solutions/commitment-to-open-source/)
  + [Customers](/company/customers/)
  + [Partners](/company/partners/)
  + [Contact us](/company/contact/)
  + [Accessibility](/accessibility/)
  + [NEW! Brand identity](/brand-identity/)**Media**
  + [Coverage](/company/coverage/)
  + [Press releases](/company/press-releases/)
* **Resources**
  + [Events hub](/resources/events/)
  + [Customer stories](/resources/customer-stories/)
  + [White papers](/resources/white-papers/)
  + [Learn](/learn/guide/)
  + [Community](https://community.sonarsource.com/)
  + [Support](/support/)
* **Knowledge**
  + [Explore Sonarpedia](https://rules.sonarsource.com/)
  + [Blog](/blog/)
  + [Languages](/knowledge/languages/)
  + [SonarQube Server Documentation](https://docs.sonarsource.com/sonarqube/latest/)
  + [SonarQube Cloud Documentation](https://docs.sonarsource.com/sonarcloud/)
  + [SonarQube for IDE Documentation](https://docs.sonarsource.com/sonarlint/)

* [Legal documentation](/legal/)
* [Trust center](/trust-center/)

* [Follow SonarSource on Twitter](https://twitter.com/sonarsource)
* [Follow SonarSource on Linkedin](https://www.linkedin.com/company/sonarsource/)

© 2008-2025 SonarSource SA. All rights reserved. SONAR, SONARSOURCE, SONARQUBE, and CLEAN AS YOU CODE are trademarks of SonarSource SA.



=== Content from caniuse.com_e12412ed_20250115_124309.html ===


* [Home](/)
* [News](/ciu/news)

* [Compare browsers](/ciu/comparison)
* [About](/ciu/about)

[April 7, 2024 - 8 new features](https://caniuse.com/wasm-bigint%2Cwasm-bulk-memory%2Cwasm-multi-value%2Cwasm-mutable-globals%2Cwasm-nontrapping-fptoint%2Cwasm-signext%2Cwasm-simd%2Cwasm-threads)
[Can I use](/)
Search

?

Settings

### headers HTTP header: Set-Cookie: SameSite: Defaults to `Lax`

* #### Global usage

  77.07%
   +
  0%
   =
  77.07%

#### IE

1. ❌ 6 - 10: Not supported
2. ❌ 11: Not supported
#### Edge

1. ❌ 12 - 85: Not supported
2. ✅ 86 - 130: Supported
3. ✅ 131: Supported
#### Firefox

1. ❌ 2 - 68: Not supported
2. ❌ 69 - 132: Disabled by default
3. ❌ 133: Disabled by default
4. ❌ 134 - 136: Disabled by default
#### Chrome

1. ❌ 4 - 79: Not supported
2. ✅ 80 - 130: Supported
3. ✅ 131: Supported
4. ✅ 132 - 134: Supported
#### Safari

1. ❌ 3.1 - 18.1: Not supported
2. ❌ 18.2: Not supported
3. ❌ 18.3: Not supported
4. ﹖ TP: Support unknown
#### Opera

1. ❌ 10 - 70: Not supported
2. ✅ 71 - 113: Supported
3. ✅ 114: Supported
#### Safari on iOS

1. ❌ 3.2 - 18.1: Not supported
2. ❌ 18.2: Not supported
3. ❌ 18.3: Not supported
#### Opera Mini

1. ﹖ all: Support unknown
#### Android Browser

1. ❌ 2.1 - 4.4.4: Not supported
2. ✅ 131: Supported
#### Opera Mobile

1. ❌ 12 - 12.1: Not supported
2. ✅ 80: Supported
#### Chrome for Android

1. ✅ 131: Supported
#### Firefox for Android

1. ❌ 132: Not supported
#### UC Browser for Android

1. ﹖ 15.5: Support unknown
#### Samsung Internet

1. ❌ 4 - 12.0: Not supported
2. ✅ 13.0 - 26: Supported
3. ✅ 27: Supported
#### QQ Browser

1. ﹖ 14.9: Support unknown
#### Baidu Browser

1. ﹖ 13.52: Support unknown
#### KaiOS Browser

1. ﹖ 2.5: Support unknown
2. ﹖ 3: Support unknown

### Can I use...

Browser support tables for modern web technologies

Created & maintained by [@Fyrd](https://front-end.social/%40fyrd), design by [@Lensco](https://mastodon.world/%40lensco).

Support data contributions by the GitHub [community](https://github.com/Fyrd/caniuse/graphs/contributors).

Usage share statistics by [StatCounter GlobalStats](http://gs.statcounter.com/) for December, 2024

Location detection provided by [ipinfo.io](//ipinfo.io).

Browser testing done via
[![BrowserStack](/img/browserstack.svg)](https://www.browserstack.com?ref=caniuse-source&caniuse_source=brand-asset&utm_source=caniuse&utm_medium=partnered&utm_campaigncode=701OW000008y9C1YAI)

### Support via Patreon

Become a caniuse Patron to support the site and disable ads for only $1/month!

[![Become a Patron!](/img/become_a_patron_button.png)](https://www.patreon.com/join/caniuse)

or [Log in](http://www.patreon.com/oauth2/authorize?response_type=code&client_id=efdd32564c7459c2c0dcd644b984e6948070b23b72961a3b9fb32ab3ad797184&redirect_uri=https%3A%2F%2Fcaniuse.com)

### Site links

1. [Home](/)
2. [Feature index](/ciu/index)
3. [Browser usage table](/usage-table)
4. [Feature suggestion list](/issue-list)
5. [Caniuse data on GitHub](https://github.com/fyrd/caniuse)

## Legend

* Green
  ✅
  = Supported
* Red
  ❌
  = Not supported
* Greenish yellow
  ◐
  = Partial support
* Gray
  ﹖
  = Support unknown



=== Content from www.openwall.com_5bf0ebf6_20250114_222444.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <3E104BB5-6336-49DD-9C5D-4B0F6DB7D403@beckweb.net>
Date: Wed, 24 Jan 2024 15:57:49 +0100
From: Daniel Beck <ml@...kweb.net>
To: oss-security@...ts.openwall.com
Subject: Multiple vulnerabilities in Jenkins and Jenkins plugins

Jenkins is an open source automation server which enables developers around
the world to reliably build, test, and deploy their software.

The following releases contain fixes for security vulnerabilities:

* Jenkins 2.442
* Jenkins LTS 2.426.3
* Git server Plugin 99.101.v720e86326c09
* GitLab Branch Source Plugin 688.v5fa_356ee8520
* Matrix Project Plugin 822.824.v14451b_c0fd42
* Qualys Policy Compliance Scanning Connector Plugin 1.0.6
* Red Hat Dependency Analytics Plugin 0.9.0

Additionally, we announce unresolved security issues in the following
plugins:

* Log Command Plugin

Summaries of the vulnerabilities are below. More details, workarounds,
severity, and attribution can be found here:
<https://www.jenkins.io/security/advisory/2024-01-24/>

We provide advance notification for security updates on this mailing list:
<https://groups.google.com/d/forum/jenkinsci-advisories>

If you discover security vulnerabilities in Jenkins, please report them as
described here:
<https://www.jenkins.io/security/#reporting-vulnerabilities>

---

SECURITY-3314 / CVE-2024-23897
Jenkins has a built-in command line interface (CLI) to access Jenkins from
a script or shell environment.

Jenkins uses the args4j library to parse command arguments and options on
the Jenkins controller when processing CLI commands. This command parser
has a feature that replaces an `@` character followed by a file path in an
argument with the file's contents (`expandAtFiles`). This feature is
enabled by default and Jenkins 2.441 and earlier, LTS 2.426.2 and earlier
does not disable it.

This allows attackers to read arbitrary files on the Jenkins controller
file system using the default character encoding of the Jenkins controller
process.

* Attackers with Overall/Read permission can read entire files.
* Attackers _without_ Overall/Read permission can read the first few lines
  of files. The number of lines that can be read depends on available CLI
  commands. As of publication of this advisory, the Jenkins security team
  has found ways to read the first three lines of files in recent releases
  of Jenkins without having any plugins installed, and has not identified
  any plugins that would increase this line count.

Binary files containing cryptographic keys used for various Jenkins
features can also be read, with some limitations. As of publication,
the Jenkins security team has confirmed the following possible attacks in
addition to reading contents of all files with a known file path. All of
them leverage attackers' ability to obtain cryptographic keys from binary
files, and are therefore only applicable to instances where that is
feasible.

WARNING: This list is not definitive. Further attacks likely exist,
including ones that do not need attackers to obtain cryptographic keys from
binary files.

* Remote code execution via Resource Root URLs (Variant 1)
* Remote code execution via Resource Root URLs (Variant 2)
* Remote code execution via "Remember me" cookie
* Remote code execution via stored cross-site scripting (XSS) attacks
  through build logs
* Remote code execution via CSRF protection bypass
* Decrypt secrets stored in Jenkins
* Delete any item in Jenkins
* Download a Java heap dump

Limitations for reading binary files:
While files containing binary data can be read, the affected feature
attempts to read them as strings using the controller process's default
character encoding. This is likely to result in some bytes not being read
successfully and being replaced with a placeholder value. Which bytes can
or cannot be read depends on this character encoding. For example,
attempting to read random binary data using UTF-8, roughly half of all
bytes will be replaced with a placeholder for an illegal value. For 32 byte
random binary secrets, as commonly used in Jenkins for HMAC-SHA256, this
would require attackers to correctly guess on average 16 bytes, which is
infeasible. In contrast, with the encoding Windows-1252, only 5 out of 256
possible values are illegal and would be replaced with a placeholder. This
is a significantly lower number of bytes to guess in a binary secret on
average, as well as fewer possible options for each byte.

IMPORTANT: While it is _unlikely_ that randomly generated keys use
significantly fewer than average of the byte values that cannot be read
using a character encoding like UTF-8, it isn't _impossible_. Therefore
administrators should update Jenkins in a timely manner, regardless of the
value of `file.encoding`.

SECURITY-3315 / CVE-2024-23898
Jenkins has a built-in command line interface (CLI) to access Jenkins from
a script or shell environment. Since Jenkins 2.217 and LTS 2.222.1, one of
the ways to communicate with the CLI is through a WebSocket endpoint. This
endpoint relies on the default Jenkins web request authentication
functionality, like HTTP Basic authentication with API tokens, or session
cookies. This endpoint is enabled when running on a version of Jetty for
which Jenkins supports WebSockets. This is the case when using the provided
native installers, packages, or the Docker containers, as well as when
running Jenkins with the command `java -jar jenkins.war`.

Jenkins 2.217 through 2.441 (both inclusive), LTS 2.222.1 through 2.426.2
(both inclusive) does not perform origin validation of requests made
through the CLI WebSocket endpoint, resulting in a cross-site WebSocket
hijacking (CSWSH) vulnerability.

Additionally, Jenkins does not set an explicit `SameSite` attribute for
session cookies. This can allow cross-site requests to make use of the
session cookie, i.e., those requests are sent with the logged-in user's
authentication.

This vulnerability allows attackers to execute CLI commands on the Jenkins
controller. The impact depends on the permissions of the anonymous user
and/or the browser(s) used by the victim(s) of the CSWSH attack.

Additionally, this vulnerability allows exploiting SECURITY-3314 to read
the first few lines of files on the Jenkins controller. See that issue for
more information about the potential impact.

SECURITY-3319 / CVE-2024-23899
Git server Plugin uses the args4j library to parse command arguments and
options on the Jenkins controller when processing Git commands received via
SSH. This command parser has a feature that replaces an `@` character
followed by a file path in an argument with the file's contents
(`expandAtFiles`). This feature is enabled by default and Git server Plugin
99.va_0826a_b_cdfa_d and earlier does not disable it.

This allows attackers with Overall/Read permission to read the first two
lines of arbitrary files on the Jenkins controller file system using the
default character encoding of the Jenkins controller process.

See SECURITY-3314 for further information about the potential impact of being
able to read files on the Jenkins controller, as well as the limitations for
reading binary files. Note that for this issue, unlike SECURITY-3314, attackers
need Overall/Read permission.

SECURITY-3289 / CVE-2024-23900
Matrix Project Plugin 822.v01b_8c85d16d2 and earlier does not sanitize
user-defined axis names of multi-configuration projects submitted through
the `config.xml` REST API endpoint.

This allows attackers with Item/Configure permission to create or replace
any `config.xml` file on the Jenkins controller file system with content
not controllable by the attackers.

SECURITY-3040 / CVE-2024-23901
GitLab allows sharing a project with another group.

GitLab Branch Source Plugin 684.vea_fa_7c1e2fe3 and earlier unconditionally
discovers projects that are shared with the configured owner group.

This allows attackers to configure and share a project, resulting in a
crafted Pipeline being built by Jenkins after the next scan of the group's
projects.

SECURITY-3251 / CVE-2024-23902
GitLab Branch Source Plugin 684.vea_fa_7c1e2fe3 and earlier does not
require POST requests for a form validation endpoint, resulting in a
cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to connect to an attacker-specified
URL.

SECURITY-2871 / CVE-2024-23903
GitLab Branch Source Plugin 684.vea_fa_7c1e2fe3 and earlier does not use a
constant-time comparison function when checking whether the provided and
expected webhook token are equal.

This could potentially allow attackers to use statistical methods to obtain
a valid webhook token.

SECURITY-3006 / CVE-2023-6148
Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does
not escape Qualys API responses displayed on the job configuration page.

This results in a stored cross-site scripting (XSS) vulnerability
exploitable by attackers able to configure jobs.

SECURITY-3005 / CVE-2023-6147
Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does
not configure its XML parser to prevent XML external entity (XXE) attacks.

This allows attackers able to configure jobs to have Jenkins parse a
crafted HTTP response with XML data that uses external entities for
extraction of secrets from the Jenkins controller or server-side request
forgery.

SECURITY-3007 / CVE pending
Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does
not correctly perform permission checks in several HTTP endpoints.

This allows attackers with global Item/Configure permission (while lacking
Item/Configure permission on any particular job) to connect to an
attacker-specified URL using attacker-specified credentials IDs obtained
through another method, capturing credentials stored in Jenkins.

SECURITY-3322 / CVE-2024-23905
Jenkins sets the `Content-Security-Policy` header to static files served by
Jenkins (specifically `DirectoryBrowserSupport`), such as workspaces,
`/userContent`, or archived artifacts, unless a Resource Root URL is
specified.

Red Hat Dependency Analytics Plugin 0.7.1 and earlier globally disables the
`Content-Security-Policy` header for static files served by Jenkins
whenever the 'Invoke Red Hat Dependency Analytics (RHDA)' build step is
executed. This allows cross-site scripting (XSS) attacks by users with the
ability to control files in workspaces, archived artifacts, etc.

SECURITY-3334 / CVE-2024-23904
Log Command Plugin uses the args4j library to parse command arguments and
options on the Jenkins controller when processing commands received via
instant messaging platforms such as IRC or Jabber. This command parser has
a feature that replaces an `@` character followed by a file path in an
argument with the file's contents (`expandAtFiles`). This feature is
enabled by default and Log Command Plugin 1.0.2 and earlier does not
disable it.

This allows unauthenticated attackers to read the first line of arbitrary
files on the Jenkins controller file system using the default character
encoding of the Jenkins controller process.

See SECURITY-3314 for further information about the potential impact of being
able to read files on the Jenkins controller, as well as the limitations for
reading binary files.

As of publication of this advisory, there is no fix.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.jenkins.io_e4b26038_20250114_222446.html ===


[Jenkins Security Home](/security/)

**For Administrators**

* [Overview](/security/for-administrators/)
* [Security Advisories](/security/advisories/)
* [Security Issues](/security/issues/)
* [Advisory Schedule](/security/scheduling/)
* [Vulnerabilities in Plugins](/security/plugins/)
* [How We Fix Security Issues](/security/fixing/)

**For Reporters**

* [Reporting Vulnerabilities](/security/reporting/)
* [Jenkins CNA](/security/cna/)

**For Maintainers**

* [Overview](/security/for-maintainers/)
* [Vulnerabilities in Plugins](/security/plugins/)

**Jenkins Security Team**

* [About](/security/team/)
* [Contributions](/security/improvements/)

# Jenkins Security Advisory 2024-01-24

This advisory announces vulnerabilities in the following Jenkins deliverables:

* Jenkins (core)
* [Git server
  Plugin](https://plugins.jenkins.io/git-server)
* [GitLab Branch Source
  Plugin](https://plugins.jenkins.io/gitlab-branch-source)
* [Log Command
  Plugin](https://plugins.jenkins.io/log-command)
* [Matrix Project
  Plugin](https://plugins.jenkins.io/matrix-project)
* [Qualys Policy Compliance Scanning Connector
  Plugin](https://plugins.jenkins.io/qualys-pc)
* [Red Hat Dependency Analytics
  Plugin](https://plugins.jenkins.io/redhat-dependency-analytics)

## Descriptions

### Arbitrary file read vulnerability through the CLI can lead to RCE

**SECURITY-3314
/
CVE-2024-23897**

**Severity (CVSS):**
[Critical](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

**Description:**

Jenkins has a built-in [command line interface (CLI)](/doc/book/managing/cli/) to access Jenkins from a script or shell environment.

Jenkins uses the [args4j library](https://github.com/kohsuke/args4j) to parse command arguments and options on the Jenkins controller when processing CLI commands.
This command parser has a feature that replaces an `@` character followed by a file path in an argument with the file’s contents (`expandAtFiles`).
This feature is enabled by default and Jenkins 2.441 and earlier, LTS 2.426.2 and earlier does not disable it.

This allows attackers to read arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.

* Attackers with Overall/Read permission can read entire files.
* Attackers **without** Overall/Read permission can read the first few lines of files.
  The number of lines that can be read depends on available CLI commands.
  As of publication of this advisory, the Jenkins security team has found ways to read the first three lines of files in recent releases of Jenkins without having any plugins installed, and has not identified any plugins that would increase this line count.

Binary files containing cryptographic keys used for various Jenkins features can also be read, with some limitations (see [note on binary files below](#binary-files-note)).
As of publication, the Jenkins security team has confirmed the following possible attacks in addition to reading contents of all files with a known file path.
All of them leverage attackers' ability to obtain cryptographic keys from binary files, and are therefore only applicable to instances where that is feasible.

|  | This list is not definitive. Further attacks likely exist, including ones that do not need attackers to obtain cryptographic keys from binary files. |
| --- | --- |

* **Remote code execution via Resource Root URLs** (Variant 1)

  Exploitation requires that all of the following conditions are met:

  + The "Resource Root URL" functionality is enabled (see [documentation](/doc/book/security/user-content/#resource-root-url)).
  + The CLI WebSocket endpoint is accessible.
    This requires that Jenkins is running on a version of Jetty for which Jenkins supports WebSockets.
    This is the case when using the provided native installers, packages, or the Docker containers, as well as when running Jenkins with the command `java -jar jenkins.war`.
    Additionally, reverse proxies may not allow WebSocket requests if improperly configured.
  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
  + Attackers know, or can guess, the user name of any user with Overall/Read permission.
* **Remote code execution via Resource Root URLs** (Variant 2)

  Exploitation requires that all of the following conditions are met:

  + The "Resource Root URL" functionality is enabled (see [documentation](/doc/book/security/user-content/#resource-root-url)).
  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
  + The attacker needs an API token for a (non-anonymous) user account.
    It is not necessary for this user account to (still) have Overall/Read permission.
* **Remote code execution via "Remember me" cookie**

  Forging a "Remember me" cookie allows attackers to log in to Jenkins using a web browser, thereby gaining access to the Script Console if they forge a cookie for an administrator account.
  Exploitation requires that all of the following conditions are met:

  + The "Remember me" feature is enabled (the default).
  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
  + Attackers have Overall/Read permission to be able to read content in files beyond the first few lines.
* **Remote code execution via stored cross-site scripting (XSS) attacks through build logs**

  Forging serialized console note objects allows implementing XSS attacks by injecting arbitrary HTML and JavaScript into build logs.
  This attack bypasses the protections added for [SECURITY-382 in the 2017-02-01 security advisory](/security/advisory/2017-02-01/#persisted-cross-site-scripting-vulnerability-in-console-notes).
  Exploitation requires that all of the following conditions are met:

  + Attackers can control build log output (e.g., through pull requests).
  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
* **Remote code execution via CSRF protection bypass**

  Forged CSRF tokens ("crumbs") can be used to implement CSRF attacks by sending POST requests with a valid crumb.
  Exploitation requires that all of the following conditions are met:

  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
  + The web session ID is not part of CSRF crumbs.
    By default it is (see [SECURITY-626 in the 2019-07-17 security advisory](/security/advisory/2019-07-17/#SECURITY-626)), but not if one of the following conditions is met:

    - Jenkins uses the default crumb issuer and the [Java system property `hudson.security.csrf.DefaultCrumbIssuer.EXCLUDE_SESSION_ID`](/doc/book/managing/system-properties/#hudson-security-csrf-defaultcrumbissuer-exclude_session_id) is set to `true`.
    - Jenkins uses the [Strict Crumb Issuer Plugin](https://plugins.jenkins.io/strict-crumb-issuer/) to generate crumbs and the option "Check the session ID" is unchecked.
* **Decrypt secrets stored in Jenkins**

  Jenkins typically uses secrets to access other systems, like SCMs, external user directories for security realms, cloud providers, deployment targets, etc.
  Exploitation requires that all of the following conditions are met:

  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
  + Attackers have access to encrypted secrets.
    This may require Overall/Read permission, to be able to read content in files beyond the first few lines, but there are other possible sources, like `JENKINS_HOME` backups even if they exclude `secrets/`, or [Configuration as Code](https://plugins.jenkins.io/configuration-as-code/) YAML files.
* **Delete any item in Jenkins**

  Exploitation requires that all of the following conditions are met:

  + The "Resource Root URL" functionality is enabled (see [documentation](/doc/book/security/user-content/#resource-root-url)).
  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
  + Attackers know, or can guess, the user name of any user with Overall/Read permission.
* **Download a Java heap dump** of the Jenkins controller process or any agent process

  Exploitation requires that all of the following conditions are met:

  + The "Resource Root URL" functionality is enabled (see [documentation](/doc/book/security/user-content/#resource-root-url)).
  + Attackers can retrieve binary secrets (see [note below](#binary-files-note)).
  + Attackers know, or can guess, the user name of any user with Overall/Read permission.
  + The Jenkins controller or agent process is running on a Java runtime that allows the creation of heap dump files without `.hprof` file extension.
    Due to [JENKINS-72579](https://issues.jenkins.io/browse/JENKINS-72579) the affected feature does not work by default on recent releases of OpenJDK/HotSpot based JVMs.

|  | Impact of reading arbitrary files  We have previously considered arbitrary file read vulnerabilities to only have an impact on confidentiality. As a result of the report provided by Yaniv Nizry (SonarSource) and the additional research done by the Jenkins security team resulting in the list above, future vulnerabilities of this kind will likewise be considered to have a high score across all impact metrics (confidentiality, integrity, and availability). |
| --- | --- |

|  | Limitations for reading binary files  While files containing binary data can be read, the affected feature attempts to read them as strings using the controller process’s default character encoding. This is likely to result in some bytes not being read successfully and being replaced with a placeholder value. Which bytes can or cannot be read depends on this character encoding. For example, attempting to read random binary data using UTF-8, roughly half of all bytes will be replaced with a placeholder for an illegal value. For 32 byte random binary secrets, as commonly used in Jenkins for [HMAC-SHA256](https://en.wikipedia.org/wiki/HMAC), this would require attackers to correctly guess on average 16 bytes, which is infeasible. In contrast, with the encoding Windows-1252, only 5 out of 256 possible values are illegal and would be replaced with a placeholder. This is a significantly lower number of bytes to guess in a binary secret on average, as well as fewer possible options for each byte.   Telemetry submissions received from Jenkins 2.437 and later indicate that more than 90% of Jenkins instances reporting anonymous usage statistics use UTF-8 as default character encoding. Almost all instances running on Linux and Mac OS X use UTF-8. Instances on Windows are more likely than not to use a character set that makes it feasible to implement exploits involving reading binary files (like Windows-1252).   To determine whether you’re likely affected by the most severe impacts described above, check the value of the `file.encoding` system property in *Manage Jenkins Â» System Information*.   |  | While it is *unlikely* that randomly generated keys use significantly fewer than average of the byte values that cannot be read using a character encoding like UTF-8, it isn’t *impossible*. Therefore administrators should update Jenkins in a timely manner, regardless of the value of `file.encoding`. | | --- | --- | |
| --- | --- | --- | --- |

**Fix Description:**

Jenkins 2.442, LTS 2.426.3, and LTS 2.440.1 disables the command parser feature that replaces an `@` character followed by a file path in an argument with the file’s contents for CLI commands.

In case of problems with this fix, disable this change by setting the [Java system property `hudson.cli.CLICommand.allowAtSyntax`](/doc/book/managing/system-properties/#hudson-cli-clicommand-allowatsyntax) to `true`.
Doing this is strongly discouraged on any network accessible by users who are not Jenkins administrators.

**Workaround:**

Disabling access to the CLI is expected to prevent exploitation completely.
Doing so is strongly recommended to administrators unable to immediately update to Jenkins 2.442, LTS 2.426.3 or LTS 2.440.1.
Applying this workaround does not require a Jenkins restart.
For instructions, see the [documentation for this workaround](https://github.com/jenkinsci-cert/SECURITY-3314-3315/).

|  | Disabling the CLI is only intended as a short-term workaround, even if you do not use the CLI. |
| --- | --- |

### Cross-site WebSocket hijacking vulnerability in the CLI

**SECURITY-3315
/
CVE-2024-23898**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)

**Description:**

Jenkins has a built-in [command line interface (CLI)](/doc/book/managing/cli/) to access Jenkins from a script or shell environment.
Since Jenkins 2.217 and LTS 2.222.1, one of the ways to communicate with the CLI is through a WebSocket endpoint.
This endpoint relies on the default Jenkins web request authentication functionality, like HTTP Basic authentication with API tokens, or session cookies.
This endpoint is enabled when running on a version of Jetty for which Jenkins supports WebSockets.
This is the case when using the provided native installers, packages, or the Docker containers, as well as when running Jenkins with the command `java -jar jenkins.war`.

Jenkins 2.217 through 2.441 (both inclusive), LTS 2.222.1 through 2.426.2 (both inclusive) does not perform origin validation of requests made through the CLI WebSocket endpoint, resulting in a cross-site WebSocket hijacking (CSWSH) vulnerability.

Additionally, Jenkins does not set an explicit `SameSite` attribute for session cookies.
This can allow cross-site requests to make use of the session cookie, i.e., those requests are sent with the logged-in user’s authentication.

|  | In recent releases of Google Chrome and Microsoft Edge the default behavior is for the `SameSite` cookie attribute to be considered `Lax` if not explicitly set. This results in no session cookie being sent with a cross-site request to the WebSocket endpoint, resulting in CLI use as the anonymous user. Mozilla Firefox has an option for this behavior, but it is disabled by default as of publication of this advisory. See [this browser compatibility table](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#browser_compatibility) (row labeled *Defaults to* `Lax`) for details. |
| --- | --- |

This vulnerability allows attackers to execute CLI commands on the Jenkins controller.
The impact depends on the permissions of the anonymous user and/or the browser(s) used by the victim(s) of the CSWSH attack:

* **The anonymous user has no permissions and Jenkins users use web browsers with `SameSite` cookie attribute `Lax` as default**

  Attackers can execute the `who-am-i` CLI command, obtaining limited information about the anonymous user in Jenkins.
  This mostly allows exploiting [SECURITY-3314](#SECURITY-3314) and reading the first few lines of files on the Jenkins controller.
  See that issue for more information about the potential impact.
* **The anonymous user has permissions**

  This is the case with an authorization strategy like "Anyone can do anything", or when the anonymous user has explicitly been granted additional permissions.
  Attackers can execute the CLI commands that these permissions allow using, up to and including Groovy scripting capabilities (`groovy` and `groovysh` commands) resulting in arbitrary code execution.
  If the anonymous user has (only) Overall/Read permission, attackers can obtain the full contents of files by exploiting [SECURITY-3314](#SECURITY-3314) as described in that issue.
* **Jenkins users use web browsers with `SameSite` cookie attribute `Lax` not being the default**

  The session and/or "Remember me" cookie will be sent with the cross-site request, and the user will be authenticated.
  Attackers can execute the CLI commands that the victim’s permissions allow using, up to and including Groovy scripting capabilities (`groovy` and `groovysh` commands) in case of a Jenkins administrator, resulting in arbitrary code execution.

**Fix Description:**

Jenkins 2.442, LTS 2.426.3, and LTS 2.440.1 performs origin validation of requests made through the CLI WebSocket endpoint.

In case of problems with this fix, disable this change by setting the [Java system property `hudson.cli.CLIAction.ALLOW_WEBSOCKET`](/doc/book/managing/system-properties/#hudson-cli-cliaction-allow_websocket) to `true`.

**Workaround:**

Some workarounds are available to mitigate some or all of the impact if you are unable to immediately upgrade to Jenkins 2.442, LTS 2.426.3 or LTS 2.440.1:

* **Disable CLI access**

  Disabling access to the CLI will prevent exploitation completely and is the **recommended workaround** for administrators unable to immediately update.
  Applying this workaround does not require a Jenkins restart.
  For instructions, see the [documentation for this workaround](https://github.com/jenkinsci-cert/SECURITY-3314-3315/).
* **Prevent WebSocket access using a reverse proxy**

  If Jenkins is accessible only through a reverse proxy, configure that proxy to prevent access to the CLI via WebSocket by not upgrading requests.

|  | Administrators of Jenkins instances accessed through a reverse proxy can follow the instructions below to test whether WebSocket endpoints can be reached. These instructions assume that the reverse proxy is not set up to support only selected WebSocket endpoints (e.g., only the CLI).   1. Log in to Jenkins as a user with Overall/Administer permission. 2. Open your web browser’s developer tools while viewing the Jenkins dashboard. 3. On the *Console* tab, paste the following script:  ``` new WebSocket(document.location.toString().replace('http', 'ws') + 'wsecho/') ```    On the *Network* tab, if the `wsecho/` request resulted in a `101 Switching Protocols` response, WebSocket endpoints can be accessed. A `400 Bad Request` response, or lack of response (in Google Chrome), indicates that WebSocket endpoints cannot be accessed. A `403 Forbidden` response indicates that the necessary Overall/Administer permission is missing.   These steps have been validated in Google Chrome, Mozilla Firefox, and Apple Safari. |
| --- | --- |

### Arbitrary file read vulnerability in Git server Plugin can lead to RCE

**SECURITY-3319
/
CVE-2024-23899**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

**Affected plugin:
[`git-server`](https://plugins.jenkins.io/git-server)**

**Description:**

Git server Plugin uses the [args4j library](https://github.com/kohsuke/args4j) to parse command arguments and options on the Jenkins controller when processing Git commands received via SSH.
This command parser has a feature that replaces an `@` character followed by a file path in an argument with the file’s contents (`expandAtFiles`).
This feature is enabled by default and Git server Plugin 99.va\_0826a\_b\_cdfa\_d and earlier does not disable it.

This allows attackers with Overall/Read permission to read the first two lines of arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.

See [SECURITY-3314](#SECURITY-3314) for further information about the potential impact of being able to read files on the Jenkins controller, as well as the [limitations for reading binary files](#binary-files-note).
Note that for this issue, unlike SECURITY-3314, attackers need Overall/Read permission.

**Fix Description:**

Git server Plugin 99.101.v720e86326c09 disables the command parser feature that replaces an `@` character followed by a file path in an argument with the file’s contents for CLI commands.

**Workaround:**

Navigate to *Manage Jenkins Â» Security* and ensure that the *SSHD Port* setting in the *SSH Server* section is set to *Disable*.
This disables access to Git repositories hosted by Jenkins (and the Jenkins CLI) via SSH.

### Path traversal vulnerability in Matrix Project Plugin

**SECURITY-3289
/
CVE-2024-23900**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L)

**Affected plugin:
[`matrix-project`](https://plugins.jenkins.io/matrix-project)**

**Description:**

Matrix Project Plugin 822.v01b\_8c85d16d2 and earlier does not sanitize user-defined axis names of multi-configuration projects submitted through the `config.xml` REST API endpoint.

This allows attackers with Item/Configure permission to create or replace any `config.xml` file on the Jenkins controller file system with content not controllable by the attackers.

Matrix Project Plugin 822.824.v14451b\_c0fd42 sanitizes user-defined axis names of Multi-configuration project.

### Shared projects are unconditionally discovered by GitLab Branch Source Plugin

**SECURITY-3040
/
CVE-2024-23901**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N)

**Affected plugin:
[`gitlab-branch-source`](https://plugins.jenkins.io/gitlab-branch-source)**

**Description:**

GitLab allows sharing a project with another group.

GitLab Branch Source Plugin 684.vea\_fa\_7c1e2fe3 and earlier unconditionally discovers projects that are shared with the configured owner group.

This allows attackers to configure and share a project, resulting in a crafted Pipeline being built by Jenkins after the next scan of the group’s projects.

In GitLab Branch Source Plugin 688.v5fa\_356ee8520, the default strategy for discovering projects does not discover projects shared with the configured owner group.
To discover projects shared with the configured owner group, use the new trait "Discover shared projects".

|  | After updating, any shared project that has already been discovered will be removed unless the new trait is added to the organization folder configuration before running a scan. |
| --- | --- |

### CSRF vulnerability in GitLab Branch Source Plugin

**SECURITY-3251
/
CVE-2024-23902**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)

**Affected plugin:
[`gitlab-branch-source`](https://plugins.jenkins.io/gitlab-branch-source)**

**Description:**

GitLab Branch Source Plugin 684.vea\_fa\_7c1e2fe3 and earlier does not require POST requests for a form validation endpoint, resulting in a cross-site request forgery (CSRF) vulnerability.

This vulnerability allows attackers to connect to an attacker-specified URL.

GitLab Branch Source Plugin 688.v5fa\_356ee8520 requires POST requests for the affected form validation endpoint.

### Non-constant time webhook token comparison in GitLab Branch Source Plugin

**SECURITY-2871
/
CVE-2024-23903**

**Severity (CVSS):**
[Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N)

**Affected plugin:
[`gitlab-branch-source`](https://plugins.jenkins.io/gitlab-branch-source)**

**Description:**

GitLab Branch Source Plugin 684.vea\_fa\_7c1e2fe3 and earlier does not use a constant-time comparison function when checking whether the provided and expected webhook token are equal.

This could potentially allow attackers to use statistical methods to obtain a valid webhook token.

GitLab Branch Source Plugin 688.v5fa\_356ee8520 uses a constant-time comparison function when validating the webhook token.

### Stored XSS vulnerability in Qualys Policy Compliance Scanning Connector Plugin

**SECURITY-3006
/
CVE-2023-6148**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)

**Affected plugin:
[`qualys-pc`](https://plugins.jenkins.io/qualys-pc)**

**Description:**

Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does not escape Qualys API responses displayed on the job configuration page.

This results in a stored cross-site scripting (XSS) vulnerability exploitable by attackers able to configure jobs.

Qualys Policy Compliance Scanning Connector Plugin 1.0.6 escapes Qualys API responses displayed on the job configuration page.

### XXE vulnerability in Qualys Policy Compliance Scanning Connector Plugin

**SECURITY-3005
/
CVE-2023-6147**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N)

**Affected plugin:
[`qualys-pc`](https://plugins.jenkins.io/qualys-pc)**

**Description:**

Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does not configure its XML parser to prevent XML external entity (XXE) attacks.

This allows attackers able to configure jobs to have Jenkins parse a crafted HTTP response with XML data that uses external entities for extraction of secrets from the Jenkins controller or server-side request forgery.

Qualys Policy Compliance Scanning Connector Plugin 1.0.6 disables external entity resolution for its XML parser.

### Incorrect permission checks in Qualys Policy Compliance Scanning Connector Plugin allow capturing credentials

**SECURITY-3007
/
CVE pending**

**Severity (CVSS):**
[Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)

**Affected plugin:
[`qualys-pc`](https://plugins.jenkins.io/qualys-pc)**

**Description:**

Qualys Policy Compliance Scanning Connector Plugin 1.0.5 and earlier does not correctly perform permission checks in several HTTP endpoints.

This allows attackers with global Item/Configure permission (while lacking Item/Configure permission on any particular job) to connect to an attacker-specified URL using attacker-specified credentials IDs obtained through another method, capturing credentials stored in Jenkins.

Qualys Policy Compliance Scanning Connector Plugin 1.0.6 requires the appropriate permissions for the affected HTTP endpoints.

### Content-Security-Policy protection for user content disabled by Red Hat Dependency Analytics Plugin

**SECURITY-3322
/
CVE-2024-23905**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)

**Affected plugin:
[`redhat-dependency-analytics`](https://plugins.jenkins.io/redhat-dependency-analytics)**

**Description:**

Jenkins sets the `Content-Security-Policy` header to static files served by Jenkins (specifically `DirectoryBrowserSupport`), such as workspaces, `/userContent`, or archived artifacts, unless a Resource Root URL is specified.

Red Hat Dependency Analytics Plugin 0.7.1 and earlier globally disables the `Content-Security-Policy` header for static files served by Jenkins whenever the 'Invoke Red Hat Dependency Analytics (RHDA)' build step is executed.
This allows cross-site scripting (XSS) attacks by users with the ability to control files in workspaces, archived artifacts, etc.

|  | Jenkins instances with [Resource Root URL](/doc/book/security/user-content/#resource-root-url) configured are unaffected. |
| --- | --- |

Red Hat Dependency Analytics Plugin 0.9.0 does not disable the `Content-Security-Policy` header for static files served by Jenkins anymore.

### Arbitrary file read vulnerability in Log Command Plugin

**SECURITY-3334
/
CVE-2024-23904**

**Severity (CVSS):**
[High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

**Affected plugin:
[`log-command`](https://plugins.jenkins.io/log-command)**

**Description:**

Log Command Plugin uses the [args4j library](https://github.com/kohsuke/args4j) to parse command arguments and options on the Jenkins controller when processing commands received via instant messaging platforms such as IRC or Jabber.
This command parser has a feature that replaces an `@` character followed by a file path in an argument with the file’s contents (`expandAtFiles`).
This feature is enabled by default and Log Command Plugin 1.0.2 and earlier does not disable it.

This allows unauthenticated attackers to read the first line of arbitrary files on the Jenkins controller file system using the default character encoding of the Jenkins controller process.

See [SECURITY-3314](#SECURITY-3314) for further information about the potential impact of being able to read files on the Jenkins controller, as well as the [limitations for reading binary files](#binary-files-note).

|  | The severity of this issue assumes attackers have no access to Jenkins other than via instant messaging platforms. If attackers can access Jenkins (even lacking Overall/Read permission), the severity is [critical](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H). |
| --- | --- |

As of publication of this advisory, there is no fix.
[Learn why we announce this.](/security/plugins/#unresolved)

## Severity

* SECURITY-2871:
  [Low](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N)
* SECURITY-3005:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N)
* SECURITY-3006:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-3007:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N)
* SECURITY-3040:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N)
* SECURITY-3251:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N)
* SECURITY-3289:
  [Medium](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L)
* SECURITY-3314:
  [Critical](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-3315:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-3319:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)
* SECURITY-3322:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H)
* SECURITY-3334:
  [High](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N)

## Affected Versions

* **Jenkins weekly**
  up to and including
  2.441
* **Jenkins LTS**
  up to and including
  2.426.2
* **Git server
  Plugin**
  up to and including
  99.va\_0826a\_b\_cdfa\_d
* **GitLab Branch Source
  Plugin**
  up to and including
  684.vea\_fa\_7c1e2fe3
* **Log Command
  Plugin**
  up to and including
  1.0.2
* **Matrix Project
  Plugin**
  up to and including
  822.v01b\_8c85d16d2
* **Qualys Policy Compliance Scanning Connector
  Plugin**
  up to and including
  1.0.5
* **Red Hat Dependency Analytics
  Plugin**
  up to and including
  0.7.1

## Fix

* **Jenkins weekly**
  should be updated to version
  2.442
* **Jenkins LTS**
  should be updated to version
  2.426.3 or 2.440.1
* **Git server
  Plugin**
  should be updated to version
  99.101.v720e86326c09
* **GitLab Branch Source
  Plugin**
  should be updated to version
  688.v5fa\_356ee8520
* **Matrix Project
  Plugin**
  should be updated to version
  822.824.v14451b\_c0fd42
* **Qualys Policy Compliance Scanning Connector
  Plugin**
  should be updated to version
  1.0.6
* **Red Hat Dependency Analytics
  Plugin**
  should be updated to version
  0.9.0

These versions include fixes to the vulnerabilities described above. All prior versions are considered to be affected by these vulnerabilities unless otherwise indicated.

As of publication of this advisory, no fixes are available for the following plugins:

* Log Command
  Plugin

[Learn why we announce these issues.](/security/plugins/#unresolved)

## Credit

The Jenkins project would like to thank the reporters for discovering and
[reporting](/security/#reporting-vulnerabilities)
these vulnerabilities:

* **Francois Marot**
  for
  SECURITY-3040
* **Kevin Guerroudj, CloudBees, Inc.**
  for
  SECURITY-3251, SECURITY-3289
* **Pierre Beitz, CloudBees, Inc.**
  for
  SECURITY-3322
* **Yaniv Nizry (SonarSource)**
  for
  SECURITY-3314, SECURITY-3315
* **Yaroslav Afenkin, CloudBees, Inc.**
  for
  SECURITY-3005, SECURITY-3006, SECURITY-3007
* **Yaroslav Afenkin, CloudBees, Inc. and Kevin Guerroudj, CloudBees, Inc.**
  for
  SECURITY-2871


