```
{
  "cve": "CVE-2024-23898",
  "description": "Jenkins has a built-in command line interface (CLI) to access Jenkins from a script or shell environment. Since Jenkins 2.217 and LTS 2.222.1, one of the ways to communicate with the CLI is through a WebSocket endpoint. This endpoint relies on the default Jenkins web request authentication functionality, like HTTP Basic authentication with API tokens, or session cookies. This endpoint is enabled when running on a version of Jetty for which Jenkins supports WebSockets. This is the case when using the provided native installers, packages, or the Docker containers, as well as when running Jenkins with the command `java -jar jenkins.war`. Jenkins 2.217 through 2.441 (both inclusive), LTS 2.222.1 through 2.426.2 (both inclusive) does not perform origin validation of requests made through the CLI WebSocket endpoint, resulting in a cross-site WebSocket hijacking (CSWSH) vulnerability. Additionally, Jenkins does not set an explicit `SameSite` attribute for session cookies. This can allow cross-site requests to make use of the session cookie, i.e., those requests are sent with the logged-in user's authentication. This vulnerability allows attackers to execute CLI commands on the Jenkins controller. The impact depends on the permissions of the anonymous user and/or the browser(s) used by the victim(s) of the CSWSH attack. Additionally, this vulnerability allows exploiting SECURITY-3314 to read the first few lines of files on the Jenkins controller. See that issue for more information about the potential impact.",
  "affected_versions": "Jenkins 2.217 through 2.441 (inclusive), LTS 2.222.1 through 2.426.2 (inclusive)",
  "root_cause": "The Jenkins CLI WebSocket endpoint does not perform origin validation, and Jenkins does not set an explicit `SameSite` attribute for session cookies.",
  "vulnerabilities": [
    "Cross-Site WebSocket Hijacking (CSWSH)",
    "Lack of origin validation on WebSocket endpoint",
    "Missing explicit SameSite attribute on session cookies"
  ],
  "impact": "Attackers can execute arbitrary CLI commands on the Jenkins controller, depending on the permissions of the anonymous user or the victim, potentially leading to arbitrary code execution, and allows exploiting CVE-2024-23897 to read the first few lines of files on the Jenkins controller.",
  "attack_vectors": [
    "Manipulating a victim to visit a malicious link, triggering a cross-site WebSocket request.",
    "Cross-site requests using the victim's session cookies, if SameSite is not set to Strict or browser does not enforce Lax by default.",
    "Executing CLI commands through the vulnerable WebSocket endpoint."
  ],
  "required_capabilities": [
    "Ability to craft a malicious link and induce a victim to click it.",
    "If default SameSite policy is not Lax or the administrator allows anonymous users to do anything - no specific user privileges required, otherwise, valid session cookies that can be obtained through the victim's browser."
  ],
  "additional_details": "Some browsers implement a \"lax by default\" policy for SameSite cookies, potentially mitigating the issue if the anonymous user has no permissions. However, browsers like Safari and Firefox don't enforce this policy strictly. Some techniques could bypass the lax policy, making the vulnerability exploitable. An attacker with Overall/Read permission can leverage a separate vulnerability (CVE-2024-23897) to read entire files.",
    "fix_details": "Jenkins 2.442, LTS 2.426.3, and LTS 2.440.1 performs origin validation of requests made through the CLI WebSocket endpoint.\n\nIn case of problems with this fix, disable this change by setting the Java system property `hudson.cli.CLIAction.ALLOW_WEBSOCKET` to `true`."
}
```