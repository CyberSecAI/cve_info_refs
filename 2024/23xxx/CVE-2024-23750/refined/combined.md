=== Content from github.com_5920acda_20250115_095523.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeekan%2FMetaGPT%2Fissues%2F731)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeekan%2FMetaGPT%2Fissues%2F731)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=geekan%2FMetaGPT)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[geekan](/geekan)
/
**[MetaGPT](/geekan/MetaGPT)**
Public

* [Notifications](/login?return_to=%2Fgeekan%2FMetaGPT) You must be signed in to change notification settings
* [Fork
  5.5k](/login?return_to=%2Fgeekan%2FMetaGPT)
* [Star
   46.7k](/login?return_to=%2Fgeekan%2FMetaGPT)

* [Code](/geekan/MetaGPT)
* [Issues
  63](/geekan/MetaGPT/issues)
* [Pull requests
  28](/geekan/MetaGPT/pulls)
* [Actions](/geekan/MetaGPT/actions)
* [Projects
  1](/geekan/MetaGPT/projects)
* [Security](/geekan/MetaGPT/security)
* [Insights](/geekan/MetaGPT/pulse)

Additional navigation options

* [Code](/geekan/MetaGPT)
* [Issues](/geekan/MetaGPT/issues)
* [Pull requests](/geekan/MetaGPT/pulls)
* [Actions](/geekan/MetaGPT/actions)
* [Projects](/geekan/MetaGPT/projects)
* [Security](/geekan/MetaGPT/security)
* [Insights](/geekan/MetaGPT/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fgeekan%2FMetaGPT%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fgeekan%2FMetaGPT%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [Vulnerability] Arbitrary code execution when use QaEngineer role #731

Open

[fubuki8087](/fubuki8087) opened this issue
Jan 10, 2024
¬∑ 3 comments

Open

# [[Vulnerability] Arbitrary code execution when use QaEngineer role](#top) #731

[fubuki8087](/fubuki8087) opened this issue
Jan 10, 2024
¬∑ 3 comments

Assignees
[![@garylin2099](https://avatars.githubusercontent.com/u/44922098?s=40&v=4)](/garylin2099)

Labels
[enhancement](/geekan/MetaGPT/labels/enhancement)
New feature or request

## Comments

[![@fubuki8087](https://avatars.githubusercontent.com/u/17444844?s=80&u=ab70af89e6880ca123ed494284f511207b589671&v=4)](/fubuki8087)

Copy link

### **[fubuki8087](/fubuki8087)** commented [Jan 10, 2024](#issue-2073465949)

| **Vulnerability description** When we use QaEngineer role, arbitrary code execution could happen because QaEngineer adopt a dangerous action `RunCode` to test codes generated by Engineer. `RunCode.run_script()` method invokes `subprocess.Popen` without any check. Evil guys can manipulate prompts to execute some sensitive operations.  **Proof of concept** My PoC code was designed with slight modifications in your [tutorial example](https://docs.deepwisdom.ai/main/en/guide/get_started/quickstart.html)  ``` import os os.environ["OPENAI_API_KEY"] = "sk-..."  import asyncio from metagpt.roles import (     ProductManager,     Architect,     ProjectManager,     Engineer,     QaEngineer ) from metagpt.team import Team  async def startup(idea: str):     company = Team()     company.hire(         [             ProductManager(),             Architect(),             ProjectManager(),             Engineer(),             QaEngineer()         ]     )     company.invest(investment=1.0)     company.run_project(idea=idea)      await company.run(n_round=16)  async def app(user_prompt):     await startup(idea=user_prompt)  if __name__ == "__main__":     user_input = "I want to execute shell command `ls -l`. Please help me write a piece of code and test this code."     asyncio.run(app(user_input)) ```  And in the path `MetaGPT/workspace/.../test_outputs/`, we can notice the output of `ls -l` in a json file. It means that `ls -l` executes successfully. [rce](https://private-user-images.githubusercontent.com/17444844/295404844-cd0c6905-8971-4b0f-a6da-d7a5327fbb2c.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5MzUyMjIsIm5iZiI6MTczNjkzNDkyMiwicGF0aCI6Ii8xNzQ0NDg0NC8yOTU0MDQ4NDQtY2QwYzY5MDUtODk3MS00YjBmLWE2ZGEtZDdhNTMyN2ZiYjJjLnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE1VDA5NTUyMlomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTNlYmM1ODAwZWQ1ZTY1OGNiZTU5MDQ3ZTI3Y2ZhYTIwNDU3MWE2YzFkNWZmNTI0NjllODFlNDlkODY3ZDQyMWMmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.uVZ3_1xSS62B1C_IepshPyjSMTcYDrKVtuhYRR4f_fc)  Note that in this PoC I only execute `ls -l`, but in real sceanario, attacker could execute dangerous operations such as file deletions, backdoor opening.  **Vulnerability solved suggestion** Using docker to execute python is a good choice. Restricting some sensitive codes via whitelist or blacklist could also be considered. |
| --- |
| The text was updated successfully, but these errors were encountered: |

 üëç
1
 summer-2014 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

[![@voidking](https://avatars.githubusercontent.com/u/9190516?s=80&u=89d758a9eb146108360d910f76a3491ae62f7044&v=4)](/voidking)

Copy link

Collaborator

### **[voidking](/voidking)** commented [Jan 17, 2024](#issuecomment-1895687266)

| Good advice. We will take this into consideration. Maybe you can also contribute a PR? üòÅ |
| --- |

All reactions

Sorry, something went wrong.

[![@fubuki8087](https://avatars.githubusercontent.com/u/17444844?s=80&u=ab70af89e6880ca123ed494284f511207b589671&v=4)](/fubuki8087)

Copy link

Author

### **[fubuki8087](/fubuki8087)** commented [Jan 22, 2024](#issuecomment-1902917246)

| Good advice. We will take this into consideration. Maybe you can also contribute a PR? üòÅ  Thank you, but I am usually quite busy with work. However, I can offer some suggestions here.   1. **Using docker**. Docker offers an isolated environment. Even if attackers gain remote command execution permissions, they are unable to inflict actual harm on the real system. There are two good practices [AutoGPT](https://github.com/Significant-Gravitas/AutoGPT/blob/488f40a20fbd4c5929611ed97ff6782c938b481d/autogpts/autogpt/autogpt/commands/execute_code.py#L96) [AutoGen](https://github.com/microsoft/autogen/blob/ca56782a7f63de6293e9b0a9b8e8335b00da1778/autogen/code_utils.py#L316) you can refer to. 2. **Imposing limitations on the commands that can be executed in Python/Shell**. We can also build a whitelist of commands. Only necessary commands can be executed. There are also two good practices [LlamaIndex](https://github.com/run-llama/llama_index/blob/9f9d048d56e9f6ac739642e124c7a96bfee2101a/llama_index/exec_utils.py#L143) [Pandas-ai](https://github.com/gventuri/pandas-ai/blob/ff0166139f55864bbd1965daf023ea7f66c00f04/pandasai/helpers/code_manager.py#L186) you can refer to.   I hope these suggestions will contribute to the improvement of your project's security. |
| --- |

All reactions

Sorry, something went wrong.

[![@geekan](https://avatars.githubusercontent.com/u/2707039?s=80&u=463185951e02a6ba817bf59f549e917b7690348c&v=4)](/geekan)

Copy link

Owner

### **[geekan](/geekan)** commented [Mar 21, 2024](#issuecomment-2012260743)

| sandbox requirements. I think it is reasonable in a certain sense, but there is always a tradeoff between security and functionality. |
| --- |

All reactions

Sorry, something went wrong.

[![@geekan](https://avatars.githubusercontent.com/u/2707039?s=40&u=463185951e02a6ba817bf59f549e917b7690348c&v=4)](/geekan)
[geekan](/geekan)
added
the
[enhancement](/geekan/MetaGPT/labels/enhancement)
New feature or request
label
[Mar 21, 2024](#event-12200568783)

[![@geekan](https://avatars.githubusercontent.com/u/2707039?s=40&u=463185951e02a6ba817bf59f549e917b7690348c&v=4)](/geekan)
[geekan](/geekan)
assigned [garylin2099](/garylin2099)
[Mar 21, 2024](#event-12200571338)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fgeekan%2FMetaGPT%2Fissues%2F731)

Assignees

[![@garylin2099](https://avatars.githubusercontent.com/u/44922098?s=40&v=4)](/garylin2099) [garylin2099](/garylin2099)

Labels

[enhancement](/geekan/MetaGPT/labels/enhancement)
New feature or request

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

4 participants

[![@geekan](https://avatars.githubusercontent.com/u/2707039?s=52&v=4)](/geekan) [![@voidking](https://avatars.githubusercontent.com/u/9190516?s=52&v=4)](/voidking) [![@fubuki8087](https://avatars.githubusercontent.com/u/17444844?s=52&v=4)](/fubuki8087) [![@garylin2099](https://avatars.githubusercontent.com/u/44922098?s=52&v=4)](/garylin2099)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


