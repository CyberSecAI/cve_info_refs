- **Root cause of vulnerability:** The application fails to prevent the loading of external images embedded within SVG elements in HTML emails, even when the default setting to prevent automatic loading of external resources is enabled. This occurs because the sanitization process using dompurify does not remove external embedded images.
- **Weaknesses/vulnerabilities present:** Failure to properly sanitize and prevent loading of external content within SVG images embedded in HTML emails. Specifically, the application should prevent loading of external content by default, unless the user explicitly allows it.
- **Impact of exploitation:**
    - **Information Disclosure:** An attacker can track when a user opens a crafted email, potentially exposing information such as the user's IP address, device details, and confirmation that the email address is in use.
    - **Privacy Violation:** The user's expectation that external content is not loaded without explicit confirmation is violated.
- **Attack vectors:** An attacker sends an HTML email containing an SVG image with a reference to an external image via `xlink:href`.
- **Required attacker capabilities/position:** The attacker needs the ability to send HTML emails to a victim.