```
{
  "cve": "CVE-2024-32655",
  "description": "The `WriteBind()` method in `src/Npgsql/Internal/NpgsqlConnector.FrontendMessages.cs` uses `int` variables to store the message length and the sum of parameter lengths. Both variables overflow when the sum of parameter lengths becomes too large. This causes Npgsql to write a message size that is too small when constructing a Postgres protocol message to send it over the network to the database. When parsing the message, the database will only read a small number of bytes and treat any following bytes as new messages while they belong to the old message. Attackers can abuse this to inject arbitrary Postgres protocol messages into the connection, leading to the execution of arbitrary SQL statements on the application's behalf.",
  "affected_versions": ">= 8.0.0, < 8.0.3 <= 4.0.13 >= 4.1.0, < 4.1.13 >= 5.0.0, < 5.0.18 >= 6.0.0, < 6.0.11 >= 7.0.0, < 7.0.7",
  "patched_versions": "8.0.3, 4.0.14, 4.1.13, 5.0.18, 6.0.11, 7.0.7",
  "root_cause": "Integer overflow in length calculation during message construction.",
  "vulnerabilities": [
    "Integer overflow",
     "SQL injection"
  ],
  "impact": "Attackers can issue arbitrary SQL statements to the database on behalf of the application, leading to unauthorized data access, modification, or deletion. In some cases, this could lead to code execution on the database server.",
  "attack_vectors": [
    "Network-based attacks by sending specially crafted database queries.",
    "Exploiting application logic using a vulnerable version of the library."
  ],
  "attacker_capabilities": "Attacker needs to be able to send database queries through the vulnerable application, and has control over the size of parameters in the query. No privileges or user interaction are required.",
   "additional_information": "The vulnerability arises from the incorrect handling of message lengths within the Npgsql library when constructing PostgreSQL protocol messages. By providing a large number of parameters to a query, an attacker can trigger an integer overflow which leads to writing an invalid message length. The database server, upon receiving this malformed message, misinterprets it and can be tricked into parsing and executing injected SQL statements that follow the initial part of the message. This can occur even if parameterized queries are in place as the vulnerability is at the protocol level. The exploitation can be done by using crafted payloads, and techniques like 'knob sleds' and 'trampolines' were developed to increase the reliability of exploitation, especially against systems that close the connection on invalid requests. Furthermore, techniques like server-side creation of large strings are also possible to bypass request size limits, depending on the server's implemented logic and features."
}
```