=== Content from gitlab.com_72ee10b9_20250114_193533.html ===


[Skip to content](#content-body)
GitLab
[Next](https://next.gitlab.com)

* Menu

  + [Why GitLab](https://about.gitlab.com/why-gitlab)
  + [Pricing](https://about.gitlab.com/pricing)
  + [Contact Sales](https://about.gitlab.com/sales)
  + [Explore](/explore)
* [Why GitLab](https://about.gitlab.com/why-gitlab)
* [Pricing](https://about.gitlab.com/pricing)
* [Contact Sales](https://about.gitlab.com/sales)
* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Get free trial](/users/sign_up)

# Stored XSS through javascript URL in Analytics dashboards

⚠ **Please read [the process](https://gitlab.com/gitlab-org/release/docs/-/blob/master/general/security/developer.md) on how to fix security issues before starting to work on the issue. Vulnerabilities must be fixed in a security mirror.**

**[HackerOne report #2683863](https://hackerone.com/reports/2683863)** by `joaxcar` on 2024-08-26, assigned to [@cmaxim](/cmaxim "Costel Maxim"):

[Report](#report) | [Attachments](#attachments) | [How To Reproduce](#how-to-reproduce)

## Report

#### Summary

When configuring `Analytics dashboards` ([docs](https://docs.gitlab.com/ee/user/analytics/analytics_dashboards.html)) you gain access to some default dashboards and visualizations. One of these visualizations presents a list of `Top pages` based on view count.

The list contains links to the pages, but only the path is shown.

It's possible for an unauthenticated attacker to spoof these metrics and have them point to a `javascript` URL instead. On Gitlab.com this will get blocked by CSP, but on a self-hosted instance (maybe behind a proxy or VPN) this CSP might not be configured and the payload will trigger.

To get a victim to click the link the attacker can just spam a lot of "visits" to the fake page and have it end up in top of the "top pages" list.

##### Steps to reproduce

Even if it gets blocked by CSP on gitlab.com, it's easiest to reproduce it there just to prove the injection. The feature can be configured on a self-hosted server as well

**as the victim**

1. Create a new `Ultimate` subscription using `trials`
2. In the new group create a new project
3. Go to `https://gitlab.com/GROUPNAME/PROJECTNAME/-/analytics/dashboards` and click `Set up` to the right of `Product Analytics`
4. Click the checkbox `I agree to event collection and processing in this region.` and select `Use Gitlab-managed provider` (this would on selfhosted be set up using custom settings but the end result is still the same, Cube + Snowflake + ClickHouse)
5. You will land on `https://gitlab.com/GROUPNAME/PROJECTNAME/-/analytics/dashboards/product-analytics-onboarding` here just copy the `Using HTML script` html code looking like this

[![Screenshot_2024-08-26_at_16.29.19.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/2cc7febe4f796c7c2c869571760a655140191bbc/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f64366131366236362d303632652d343039372d396238612d6538663235383730663030332f53637265656e73686f745f323032342d30382d32365f61745f31362e32392e31392e706e67)

6. Host this HTML somewhere (you can use something like JSFiddle for this, just make a note of the URL that is hosting the content) This now simulates the service that you are hosting and monitoring

**as the attacker**

7. Use a proxy tool to do a `match and replace` on all traffic from your browser that looks like this

```
type: Request body
match: https://YOURDOMAIN.com/
replace: javascript://YOURDOMAIN.com/%0aalert(document.domain)%0a
```

[![Screenshot_2024-08-26_at_16.33.30.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/74d785dd5b261f5c1e3d098daf8fb7e145ccb9cd/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f38353563666166662d643433302d346234382d386135652d3432666437633362316162372f53637265656e73686f745f323032342d30382d32365f61745f31362e33332e33302e706e67)

8. Now visit the URL from step 6. The page should make an "analytics request" but slightly modified

**as the victim**

9. Go to `https://gitlab.com/GROUPNAME/PROJECTNAME/-/analytics/dashboards/behavior 10. Under` Top Pages` there should be a link, if you click it you should see a warning in devtools that javascript tried to execute but was blocked by CSP.

[![Screenshot_2024-08-26_at_16.37.12.png](data:image/gif;base64...)](https://user-content.gitlab-static.net/11b701e7ff5c6483b3937d37f8dba0096caf5630/68747470733a2f2f68312e7365632e6769746c61622e6e65742f612f61363638653765662d633733632d343232372d383261322d3235343863396463313535362f53637265656e73686f745f323032342d30382d32365f61745f31362e33372e31322e706e67)

##### Impact

XSS on selfhosted services. As this is possible to be used unauthenticated as a `blind xss` against selfhosted servers that are not accessible from the wide web I think its could be seen as having a CVSS of

```
8.0 -> CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:H/A:N
```

as selfhosted servers that are not exposed to the internet are more likely to not have CSP in place.

If not I think it should be put on CVSS

```
6.1 -> CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
```

The complexity is only `high` if the attack is seen as `blind XSS` in my opinion, otherwise its the same as other `javascript:` based XSS's

##### What is the current *bug* behavior?

An attacker can spoof `Top pages` to point to anything. Like javascript urls

##### What is the expected *correct* behavior?

It should not allow any form of URL only safe ones

#### Impact

XSS on selfhosted services

## Attachments

**Warning:** Attachments received through HackerOne, please exercise caution!

* [Screenshot\_2024-08-26\_at\_16.29.19.png](https://h1.sec.gitlab.net/a/d6a16b66-062e-4097-9b8a-e8f25870f003/Screenshot_2024-08-26_at_16.29.19.png)
* [Screenshot\_2024-08-26\_at\_16.37.12.png](https://h1.sec.gitlab.net/a/a668e7ef-c73c-4227-82a2-2548c9dc1556/Screenshot_2024-08-26_at_16.37.12.png)
* [Screenshot\_2024-08-26\_at\_16.33.30.png](https://h1.sec.gitlab.net/a/855cfaff-d430-4b48-8a5e-42fd7c3b1ab7/Screenshot_2024-08-26_at_16.33.30.png)

## How To Reproduce

Please add [reproducibility information](https://about.gitlab.com/handbook/engineering/security/#reproducibility-on-security-issues) to this section:

Assignee
Loading

Time tracking
Loading

Confidentiality

Confidentiality controls have moved to the issue actions menu () at the top of the page.



=== Content from about.gitlab.com_41141f77_20250114_193532.html ===


[←
Back to
releases](/releases/categories/releases/)
Nov 13, 2024

-
[Greg Myers](/company/team/#gitlab)
# GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7

Learn more about GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

Today we are releasing versions 17.5.2, 17.4.4, 17.3.7 for GitLab Community Edition (CE) and Enterprise Edition (EE).

These versions contain important bug and security fixes, and we strongly recommend that all self-managed GitLab installations be upgraded to
one of these versions immediately. GitLab.com is already running the patched version. GitLab Dedicated customers do not need to take action.

GitLab releases fixes for vulnerabilities in patch releases. There are two types of patch releases:
scheduled releases, and ad-hoc critical patches for high-severity vulnerabilities. Scheduled releases are released twice a month on the second and fourth Wednesdays.
For more information, you can visit our [releases handbook](https://handbook.gitlab.com/handbook/engineering/releases/) and [security FAQ](https://about.gitlab.com/security/faq/).
You can see all of GitLab release blog posts [here](/releases/categories/releases/).

For security fixes, the issues detailing each vulnerability are made public on our
[issue tracker](https://gitlab.com/gitlab-org/gitlab/-/issues/?sort=created_date&state=closed&label_name%5B%5D=bug%3A%3Avulnerability&confidential=no&first_page_size=100)
30 days after the release in which they were patched.

We are committed to ensuring all aspects of GitLab that are exposed to customers or that host customer data are held to
the highest security standards. As part of maintaining good security hygiene, it is highly recommended that all customers
upgrade to the latest patch release for their supported version. You can read more
[best practices in securing your GitLab instance](/blog/2020/05/20/gitlab-instance-security-best-practices/) in our blog post.

### Recommended Action

We **strongly recommend** that all installations running a version affected by the issues described below are **upgraded to the latest version as soon as possible**.

When no specific deployment type (omnibus, source code, helm chart, etc.) of a product is mentioned, this means all types are affected.

## Security fixes

### Table of security fixes

| Title | Severity |
| --- | --- |
| [Unauthorized access to Kubernetes cluster agent](#unauthorized-access-to-kubernetes-cluster-agent) | High |
| [Device OAuth flow allows for cross window forgery](#device-oauth-flow-allows-for-cross-window-forgery) | Medium |
| [Denial of Service by importing malicious crafted FogBugz import payload](#denial-of-service-by-importing-malicious-crafted-fogbugz-import-payload) | Medium |
| [Stored XSS through javascript URL in Analytics dashboards](#stored-xss-through-javascript-url-in-analytics-dashboards) | Medium |
| [HTML injection in vulnerability Code flow could lead to XSS on self hosted instances](#html-injection-in-vulnerability-code-flow-could-lead-to-xss-on-self-hosted-instances) | Medium |
| [Information disclosure through an API endpoint](#information-disclosure-through-an-api-endpoint) | Medium |

### Unauthorized access to Kubernetes cluster agent

An issue was discovered in GitLab CE/EE affecting all versions starting from 16.0 prior to 17.3.7, starting from 17.4 prior to 17.4.4, and starting from 17.5 prior to 17.5.2, which could have allowed unauthorized access to the Kubernetes agent in a cluster under specific configurations.
This is a high severity issue ([`CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:H/A:H), 8.5).
It is now mitigated in the latest release and is assigned [CVE-2024-9693](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-9693).

This vulnerability was found internally by a GitLab team member [Tiger Watson](https://gitlab.com/tigerwnz).

### Device OAuth flow allows for cross window forgery

An issue was discovered in GitLab CE/EE affecting all versions starting from 17.2 prior to 17.3.7, starting from 17.4 prior to 17.4.4 and starting from 17.5 prior to 17.5.2, which could have allowed an attacker gaining full API access as the victim via the Device OAuth flow.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N), 6.8).
It is now mitigated in the latest release and is assigned [CVE-2024-7404](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-7404).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### Denial of Service by importing malicious crafted FogBugz import payload

A Denial of Service (DoS) issue has been discovered in GitLab CE/EE affecting all versions starting from 7.14.1 prior to 17.3.7, 17.4 prior to 17.4.4, and 17.5 prior to 17.5.2. A denial of service could occur upon importing maliciously crafted content using the Fogbugz importer.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H), 6.5).
We have requested a CVE ID and will update this blog post when it is assigned.

Thanks [a92847865](https://hackerone.com/a92847865) for reporting this vulnerability through our HackerOne bug bounty program.

### Stored XSS through javascript URL in Analytics dashboards

An issue has been discovered in GitLab CE/EE affecting all versions from 16 before 17.3.7, 17.4 before 17.4.4, and 17.5 before 17.5.2. The vulnerability could allow an attacker to inject malicious JavaScript code in Analytics Dashboards through a specially crafted URL.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N), 6.1).
It is now mitigated in the latest release and is assigned [CVE-2024-8648](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8648).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### HTML injection in vulnerability Code flow could lead to XSS on self hosted instances

An issue has been discovered in GitLab CE/EE affecting all versions from 17.3 before 17.3.7, 17.4 before 17.4.4, and 17.5 before 17.5.2. Improper output encoding could lead to XSS if CSP is not enabled.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N), 5.4).
It is now mitigated in the latest release and is assigned [CVE-2024-8180](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-8180).

Thanks [joaxcar](https://hackerone.com/joaxcar) for reporting this vulnerability through our HackerOne bug bounty program.

### Information disclosure through an API endpoint

An issue has been discovered in GitLab EE affecting all versions starting from 17.3 before 17.3.7, all versions starting from 17.4 before 17.4.4, all versions starting from 17.5 before 17.5.2 in which an unauthenticated user may be able to read some information about an MR in a private project, under certain circumstances.
This is a medium severity issue ([`CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N`](https://gitlab-com.gitlab.io/gl-security/product-security/appsec/cvss-calculator/explain#explain=CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N), 5.3).
It is now mitigated in the latest release and is assigned [CVE-2024-10240](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-10240).

This vulnerability has been discovered internally by GitLab team member [Patrick Bajao](https://gitlab.com/patrickbajao).

### Mattermost Security Updates October 28, 2024

Mattermost has been updated to versions 10.1.2, which contains several patches and security fixes.

## Bug fixes

### 17.5.2

* [Security patch upgrade alert: Only expose to admins 17-5](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170051)
* [[backport] Add epic to the scope and fix the flaky spec](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170814)
* [[Backport] Fix indexing subgroup associations](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170641)
* [Skip creating tables as partitions if any partition exists](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170777)
* [Add knn index setting for workitem index for opensearch clusters](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170058)
* [[Backport]Fix new project group templates pagination](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/169904)
* [Update pdf worker file path in pdf viewer](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170981)
* [[backport] Fix issue label facet can overwrite selected labels](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170961)
* [Fix workitem job in 17-5-stable-ee branch](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171634)
* [[Backport] Go-get: return 404 error code when personal token is invalid](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171703)
* [Add param filtering to avoid error while saving project settings](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171554)
* [Skip multi-version upgrade migration spec on default branches](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171926)
* [Fix group wiki activity events breaking the user feed](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171891)
* [Destroy merge train car after branch deletion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/172133)
* [Backport: Remove permissions JSONB column from the condition](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171585)

### 17.4.4

* [Backport fix for incorrect error classification to 17.4](https://gitlab.com/gitlab-org/gitaly/-/merge_requests/7400)
* [Backport 17-4: Update GoCloud to a version that supports s3ForcePathStyle](https://gitlab.com/gitlab-org/gitaly/-/merge_requests/7414)
* [Use dump from 17.3.5 since 17.3 is the previous required stop](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170209)
* [Security patch upgrade alert: Only expose to admins 17-4](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170055)
* [Fix workitem job in 17-4-stable-ee branch](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171630)
* [Don't run e2e:test-product-analytics](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171784)
* [Ensure auto\_merge\_enabled is set when validating merge trains](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171736)
* [Destroy merge train car after branch deletion](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/172134)
* [Fix broken merge train merge when target branch deleted](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/172135)
* [Backport: Remove permissions JSONB column from the condition](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171586)
* [Update pdf worker file path in pdf viewer](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170978)

### 17.3.7

* [Backport dragonboat's file permission error to 17.3](https://gitlab.com/gitlab-org/gitaly/-/merge_requests/7396)
* [Use dump from 16.11.8 since 16.11 is the previous required stop](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/170208)
* [Fix workitem job in 17-3-stable-ee branch](https://gitlab.com/gitlab-org/gitlab/-/merge_requests/171632)

## Updating

To update GitLab, see the [Update page](/update).
To update Gitlab Runner, see the [Updating the Runner page](https://docs.gitlab.com/runner/install/linux-repository.html#updating-the-runner).

## Receive Patch Notifications

To receive patch blog notifications delivered to your inbox, visit our [contact us](https://about.gitlab.com/company/contact/) page.
To receive release notifications via RSS, subscribe to our [patch release RSS feed](https://about.gitlab.com/security-releases.xml) or our [RSS feed for all releases](https://about.gitlab.com/all-releases.xml).

## Weâre combining patch and security releases

This improvement in our release process matches the industry standard and will help GitLab users get information about security and
bug fixes sooner, [read the blog post here](https://about.gitlab.com/blog/2024/03/26/were-combining-patch-and-security-releases/).

[GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7
via @gitlab

Click to tweet!](http://twitter.com/share?text=GitLab+Patch+Release%3A+17.5.2%2C+17.4.4%2C+17.3.7+via+%40gitlab&url=https://about.gitlab.com/releases/2024/11/13/patch-release-gitlab-17-5-2-released/&hashtags= "Tweet!")

* [security](/releases/tags.html#security)

[Share on Facebook](http://www.facebook.com/sharer.php?u=https://about.gitlab.com/releases/2024/11/13/patch-release-gitlab-17-5-2-released/)
[Share on X](http://x.com/share?url=https://about.gitlab.com/releases/2024/11/13/patch-release-gitlab-17-5-2-released/&text=GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7)
[Share on LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://about.gitlab.com/releases/2024/11/13/patch-release-gitlab-17-5-2-released/&title=GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7&summary=&source=)
[Share on Hacker News](https://news.ycombinator.com/submitlink?u=https://about.gitlab.com/releases/2024/11/13/patch-release-gitlab-17-5-2-released/&t=GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7)

* [Previous Post:
  GitLab Patch Release: 17.5.1, 17.4.3, 17.3.6](/releases/2024/10/23/patch-release-gitlab-17-5-1-released/ "GitLab Patch Release: 17.5.1, 17.4.3, 17.3.6")
* [Next Post:
  GitLab 17.6 released with self-hosted Duo Chat in
  ...](/releases/2024/11/21/gitlab-17-6-released/ "GitLab 17.6 released with self-hosted Duo Chat in beta")

Sign up for GitLab's monthly newsletter

Thanks for subscribing!

### We want to hear from you

Enjoyed reading this blog post or have questions or feedback? Share your thoughts by creating a new topic in the GitLab community forum.

[Share your feedback](https://forum.gitlab.com/new-topic?title=GitLab Patch Release: 17.5.2, 17.4.4, 17.3.7&body=&tags=blog-feedback)

## Take GitLab for a spin

See what your team could do with The DevSecOps Platform.

[Get free trial](https://gitlab.com/-/trials/new?glm_content=default-saas-trial&glm_source=about.gitlab.com)

![](/images/cta/gitlab-enterprise-team-member-photos.png)

Have a question? We're here to help.

[Talk to an expert](https://about.gitlab.com/sales/)

[Edit this page](https://gitlab.com/-/ide/project/gitlab-com/www-gitlab-com/edit/master/-/sites/uncategorized/source/releases/posts/2024-11-13-patch-release-gitlab-17-5-2-released.html.md)
[View source](https://gitlab.com/gitlab-com/www-gitlab-com/blob/master/sites/uncategorized/source/releases/posts/2024-11-13-patch-release-gitlab-17-5-2-released.html.md)


