Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from the `sc_get_details` function in the s2Member plugin, which allows retrieval of sensitive information via the `[s2Get /]` shortcode.  The initial implementation of the shortcode did not properly validate the `constant`, `user_field`, and `user_option` attributes, allowing for the extraction of various user data, site configuration details and even arbitrary constants.

**Weaknesses/Vulnerabilities:**

*   **Insecure Shortcode Handling:** The `sc_get_details` function lacks sufficient validation and sanitization for the attributes passed to the `[s2Get /]` shortcode.
*   **Sensitive Data Exposure:** The shortcode allows access to user data, including login information, email, names, custom fields, subscription details, IP addresses, and more.
*   **Configuration Exposure:** The shortcode can expose internal constants, potentially including database configuration parameters.

**Impact of Exploitation:**

*   **Unauthorized Data Access:** Attackers can obtain sensitive user information.
*   **Account Hijacking:** Exposed login information can lead to account takeovers.
*   **Data Breach:** Sensitive data leaks could harm users and the site owner.
*   **Complete Site Compromise:** Exposed database configuration information could allow the attacker to read, modify or drop database tables, leading to a complete site compromise

**Attack Vectors:**

*   **Shortcode Injection:** Attackers use the `[s2Get /]` shortcode with crafted attributes on a page or post.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker needs to have at least "Contributor" level access on the WordPress site.
*   **Shortcode Usage:** The attacker needs to be able to create or edit content that allows usage of shortcodes.

**Technical Details:**

*   The `sc_get_details` function processes attributes like `constant`, `user_field`, and `user_option` to fetch data.
*   The vulnerability was partially patched in version 241114 by limiting the constants that can be accessed.
*   Version 241216 added extra validation to address the issue further and fully fix the vulnerability.
*   The file `sc-gets-in.inc.php` is the core of the vulnerability. The initial patch in version 241114 (changeset 3188157) limited the constants that can be accessed with the shortcode to only those starting with `S2MEMBER_CURRENT_USER`. The final patch in version 241216 (changeset 3208315) fixed the vulnerability completely by adding an allowlist of valid attribute values.

**Additional Notes:**
*   The Wordfence article provides a clear description of the vulnerability and its impact.
*   The provided Trac links show the evolution of the code and the patches.
*   The vulnerability is rated as High severity (CVSS 8.8).
*   The vulnerability was discovered by wesley (wcraft).