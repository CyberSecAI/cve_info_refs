=== Content from git.kernel.org_a650e60a_20250114_192016.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:56:49 +0200 |
| commit | [fca048f222ce9dcbde5708ba2bf81d85a4a27952](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952)) | |
| tree | [d981a00638313f7a3ea5f7dc689e3847b7fd3ed6](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952) | |
| parent | [d24a0b1a3085e869a9d2f25b665e6257e6d96ff8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d24a0b1a3085e869a9d2f25b665e6257e6d96ff8) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952&id2=d24a0b1a3085e869a9d2f25b665e6257e6d96ff8)) | |
| download | [linux-fca048f222ce9dcbde5708ba2bf81d85a4a27952.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fca048f222ce9dcbde5708ba2bf81d85a4a27952.tar.gz) | |

parport: Proper fix for array out-of-bounds accesscommit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9 upstream.
The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex 8400a379186ea0..180376c09cb41b 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=d24a0b1a3085e869a9d2f25b665e6257e6d96ff8)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=fca048f222ce9dcbde5708ba2bf81d85a4a27952)@@ -51,12 +51,12 @@ static int do\_active\_device(struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -87,19 +87,19 @@ static int do\_autoprobe(struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -128,7 +128,7 @@ static int do\_hardware\_base\_addr(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -155,7 +155,7 @@ static int do\_hardware\_irq(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -182,7 +182,7 @@ static int do\_hardware\_dma(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -213,7 +213,7 @@ static int do\_hardware\_modes(struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:53 +0000



=== Content from git.kernel.org_17100b66_20250114_192015.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-08 16:19:20 +0100 |
| commit | [8aadef73ba3b325704ed5cfc4696a25c350182cf](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf)) | |
| tree | [291b1f5265510b3036185c9c0e1a752a39677541](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf) | |
| parent | [20cc2b146a8748902a5e4f5aa70457f48174b5c4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=20cc2b146a8748902a5e4f5aa70457f48174b5c4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf&id2=20cc2b146a8748902a5e4f5aa70457f48174b5c4)) | |
| download | [linux-8aadef73ba3b325704ed5cfc4696a25c350182cf.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8aadef73ba3b325704ed5cfc4696a25c350182cf.tar.gz) | |

parport: Proper fix for array out-of-bounds accesscommit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9 upstream.
The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8aadef73ba3b325704ed5cfc4696a25c350182cf)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=8aadef73ba3b325704ed5cfc4696a25c350182cf) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex 595e23e6859b63..c193d657f0ab83 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=20cc2b146a8748902a5e4f5aa70457f48174b5c4)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=8aadef73ba3b325704ed5cfc4696a25c350182cf)@@ -51,12 +51,12 @@ static int do\_active\_device(struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -87,19 +87,19 @@ static int do\_autoprobe(struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -128,7 +128,7 @@ static int do\_hardware\_base\_addr(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -156,7 +156,7 @@ static int do\_hardware\_irq(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -184,7 +184,7 @@ static int do\_hardware\_dma(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -216,7 +216,7 @@ static int do\_hardware\_modes(struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:52 +0000



=== Content from git.kernel.org_65550e6c_20250114_192014.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:46:33 +0200 |
| commit | [66029078fee00646e2e9dbb8f41ff7819f8e7569](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569)) | |
| tree | [b80d4227649d5f93a86331c07174ebe43521cd85](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569) | |
| parent | [c895d48c843dee8baf5327dee33ce786760c9d44](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c895d48c843dee8baf5327dee33ce786760c9d44) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569&id2=c895d48c843dee8baf5327dee33ce786760c9d44)) | |
| download | [linux-66029078fee00646e2e9dbb8f41ff7819f8e7569.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-66029078fee00646e2e9dbb8f41ff7819f8e7569.tar.gz) | |

parport: Proper fix for array out-of-bounds accesscommit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9 upstream.
The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=66029078fee00646e2e9dbb8f41ff7819f8e7569)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=66029078fee00646e2e9dbb8f41ff7819f8e7569) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex c334ef6e3b3ff4..3b7d7e23602af2 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=c895d48c843dee8baf5327dee33ce786760c9d44)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=66029078fee00646e2e9dbb8f41ff7819f8e7569)@@ -58,12 +58,12 @@ static int do\_active\_device(struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -94,19 +94,19 @@ static int do\_autoprobe(struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -135,7 +135,7 @@ static int do\_hardware\_base\_addr(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -162,7 +162,7 @@ static int do\_hardware\_irq(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -189,7 +189,7 @@ static int do\_hardware\_dma(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -220,7 +220,7 @@ static int do\_hardware\_modes(struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:52 +0000



=== Content from git.kernel.org_a3ab6e7d_20250114_192012.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-13 18:17:35 +0200 |
| commit | [02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9)) | |
| tree | [d371bcba62de97db769fe1df0671b3cc2c72eeb9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9) | |
| parent | [7528cb0f65d7472c1d6b96956f86b408c5ab6b11](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7528cb0f65d7472c1d6b96956f86b408c5ab6b11) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9&id2=7528cb0f65d7472c1d6b96956f86b408c5ab6b11)) | |
| download | [linux-02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9.tar.gz) | |

parport: Proper fix for array out-of-bounds accessThe recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex 3ef486cd3d6d57..3880460e67f25a 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=7528cb0f65d7472c1d6b96956f86b408c5ab6b11)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9)@@ -51,12 +51,12 @@ static int do\_active\_device(const struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -87,19 +87,19 @@ static int do\_autoprobe(const struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -128,7 +128,7 @@ static int do\_hardware\_base\_addr(const struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -155,7 +155,7 @@ static int do\_hardware\_irq(const struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -182,7 +182,7 @@ static int do\_hardware\_dma(const struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -213,7 +213,7 @@ static int do\_hardware\_modes(const struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:49 +0000



=== Content from git.kernel.org_8b1726fb_20250114_192012.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:39:28 +0200 |
| commit | [1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa)) | |
| tree | [f04586e2fc8200947bc3ec5c0d86f28169b66647](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa) | |
| parent | [9f8ddf14fa790fe598e5cdfa532e8d02543fe613](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9f8ddf14fa790fe598e5cdfa532e8d02543fe613) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa&id2=9f8ddf14fa790fe598e5cdfa532e8d02543fe613)) | |
| download | [linux-1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa.tar.gz) | |

parport: Proper fix for array out-of-bounds accesscommit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9 upstream.
The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex 8400a379186ea0..180376c09cb41b 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=9f8ddf14fa790fe598e5cdfa532e8d02543fe613)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=1826b6d69bbb7f9ae8711827facbb2ad7f8d0aaa)@@ -51,12 +51,12 @@ static int do\_active\_device(struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -87,19 +87,19 @@ static int do\_autoprobe(struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -128,7 +128,7 @@ static int do\_hardware\_base\_addr(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -155,7 +155,7 @@ static int do\_hardware\_irq(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -182,7 +182,7 @@ static int do\_hardware\_dma(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -213,7 +213,7 @@ static int do\_hardware\_modes(struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:49 +0000



=== Content from git.kernel.org_7538a8a4_20250114_192014.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:40:46 +0200 |
| commit | [440311903231c6e6c9bcf8acb6a2885a422e00bc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc)) | |
| tree | [732229c974c4fbc09c07b7a1ff4cbed4fc76155a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc) | |
| parent | [88a892071d228057757301a777b6b44c099ba155](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=88a892071d228057757301a777b6b44c099ba155) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc&id2=88a892071d228057757301a777b6b44c099ba155)) | |
| download | [linux-440311903231c6e6c9bcf8acb6a2885a422e00bc.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-440311903231c6e6c9bcf8acb6a2885a422e00bc.tar.gz) | |

parport: Proper fix for array out-of-bounds accesscommit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9 upstream.
The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=440311903231c6e6c9bcf8acb6a2885a422e00bc)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=440311903231c6e6c9bcf8acb6a2885a422e00bc) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex 8400a379186ea0..180376c09cb41b 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=88a892071d228057757301a777b6b44c099ba155)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=440311903231c6e6c9bcf8acb6a2885a422e00bc)@@ -51,12 +51,12 @@ static int do\_active\_device(struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -87,19 +87,19 @@ static int do\_autoprobe(struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -128,7 +128,7 @@ static int do\_hardware\_base\_addr(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -155,7 +155,7 @@ static int do\_hardware\_irq(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -182,7 +182,7 @@ static int do\_hardware\_dma(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -213,7 +213,7 @@ static int do\_hardware\_modes(struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:51 +0000



=== Content from git.kernel.org_76451e3d_20250114_192016.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-08 16:20:49 +0100 |
| commit | [b0641e53e6cb937487b6cfb15772374f0ba149b3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3)) | |
| tree | [033c779c62ea6c31466aeb924d34cdc4938602c9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3) | |
| parent | [5ead5b445f6b3cde1f2c64fc546f208ef82e3d6d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5ead5b445f6b3cde1f2c64fc546f208ef82e3d6d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3&id2=5ead5b445f6b3cde1f2c64fc546f208ef82e3d6d)) | |
| download | [linux-b0641e53e6cb937487b6cfb15772374f0ba149b3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b0641e53e6cb937487b6cfb15772374f0ba149b3.tar.gz) | |

parport: Proper fix for array out-of-bounds accesscommit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9 upstream.
The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b0641e53e6cb937487b6cfb15772374f0ba149b3)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=b0641e53e6cb937487b6cfb15772374f0ba149b3) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex 595e23e6859b63..c193d657f0ab83 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=5ead5b445f6b3cde1f2c64fc546f208ef82e3d6d)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=b0641e53e6cb937487b6cfb15772374f0ba149b3)@@ -51,12 +51,12 @@ static int do\_active\_device(struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -87,19 +87,19 @@ static int do\_autoprobe(struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -128,7 +128,7 @@ static int do\_hardware\_base\_addr(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -156,7 +156,7 @@ static int do\_hardware\_irq(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -184,7 +184,7 @@ static int do\_hardware\_dma(struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -216,7 +216,7 @@ static int do\_hardware\_modes(struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:53 +0000



=== Content from git.kernel.org_ad511c6e_20250114_192013.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Takashi Iwai <tiwai@suse.de> | 2024-09-20 12:32:19 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:51:34 +0200 |
| commit | [2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6)) | |
| tree | [da5670a6494d5612ed6d561d9e7e19563c93facd](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6) | |
| parent | [01a2d6eeb6a9e39c6e64ce32bd001301481e9cc6](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=01a2d6eeb6a9e39c6e64ce32bd001301481e9cc6) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6&id2=01a2d6eeb6a9e39c6e64ce32bd001301481e9cc6)) | |
| download | [linux-2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6.tar.gz) | |

parport: Proper fix for array out-of-bounds accesscommit 02ac3a9ef3a18b58d8f3ea2b6e46de657bf6c4f9 upstream.
The recent fix for array out-of-bounds accesses replaced sprintf()
calls blindly with snprintf(). However, since snprintf() returns the
would-be-printed size, not the actually output size, the length
calculation can still go over the given limit.
Use scnprintf() instead of snprintf(), which returns the actually
output letters, for addressing the potential out-of-bounds access
properly.
Fixes: ab11dac93d2d ("dev/parport: fix the array out-of-bounds risk")
Cc: stable@vger.kernel.org
Signed-off-by: Takashi Iwai <tiwai@suse.de>
Link: [https://lore.kernel.org/r/20240920103318.19271-1-tiwai@suse.de](https://lore.kernel.org/r/20240920103318.19271-1-tiwai%40suse.de)
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6)

| -rw-r--r-- | [drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/parport/procfs.c?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6) | 22 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 11 insertions, 11 deletions

| diff --git a/drivers/parport/procfs.c b/drivers/parport/procfs.cindex 3ef486cd3d6d57..3880460e67f25a 100644--- a/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=01a2d6eeb6a9e39c6e64ce32bd001301481e9cc6)+++ b/[drivers/parport/procfs.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/parport/procfs.c?id=2a8b26a09c8e3ea03da1ef3cd0ef6b96e559fba6)@@ -51,12 +51,12 @@ static int do\_active\_device(const struct ctl\_table \*table, int write,  for (dev = port->devices; dev ; dev = dev->next) { if(dev == port->cad) {- len += snprintf(buffer, sizeof(buffer), "%s\n", dev->name);+ len += scnprintf(buffer, sizeof(buffer), "%s\n", dev->name); } }  if(!len) {- len += snprintf(buffer, sizeof(buffer), "%s\n", "none");+ len += scnprintf(buffer, sizeof(buffer), "%s\n", "none"); }  if (len > \*lenp)@@ -87,19 +87,19 @@ static int do\_autoprobe(const struct ctl\_table \*table, int write, }  if ((str = info->class\_name) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "CLASS:%s;\n", str);  if ((str = info->model) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MODEL:%s;\n", str);  if ((str = info->mfr) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "MANUFACTURER:%s;\n", str);  if ((str = info->description) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "DESCRIPTION:%s;\n", str);  if ((str = info->cmdset) != NULL)- len += snprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);+ len += scnprintf (buffer + len, sizeof(buffer) - len, "COMMAND SET:%s;\n", str);  if (len > \*lenp) len = \*lenp;@@ -128,7 +128,7 @@ static int do\_hardware\_base\_addr(const struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);+ len += scnprintf (buffer, sizeof(buffer), "%lu\t%lu\n", port->base, port->base\_hi);  if (len > \*lenp) len = \*lenp;@@ -155,7 +155,7 @@ static int do\_hardware\_irq(const struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->irq);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->irq);  if (len > \*lenp) len = \*lenp;@@ -182,7 +182,7 @@ static int do\_hardware\_dma(const struct ctl\_table \*table, int write, if (write) /\* permissions prevent this anyway \*/ return -EACCES; - len += snprintf (buffer, sizeof(buffer), "%d\n", port->dma);+ len += scnprintf (buffer, sizeof(buffer), "%d\n", port->dma);  if (len > \*lenp) len = \*lenp;@@ -213,7 +213,7 @@ static int do\_hardware\_modes(const struct ctl\_table \*table, int write, #define printmode(x) \ do { \ if (port->modes & PARPORT\_MODE\_##x) \- len += snprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \+ len += scnprintf(buffer + len, sizeof(buffer) - len, "%s%s", f++ ? "," : "", #x); \ } while (0) int f = 0; printmode(PCSPP); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:18:50 +0000


