=== Content from git.kernel.org_1662ec45_20250115_094626.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=75f828e944dacaac8870418461d3d48a1ecf2331)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=75f828e944dacaac8870418461d3d48a1ecf2331)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=75f828e944dacaac8870418461d3d48a1ecf2331)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=75f828e944dacaac8870418461d3d48a1ecf2331)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hans de Goede <hdegoede@redhat.com> | 2024-08-27 12:45:23 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-08 16:21:58 +0100 |
| commit | [75f828e944dacaac8870418461d3d48a1ecf2331](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=75f828e944dacaac8870418461d3d48a1ecf2331) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=75f828e944dacaac8870418461d3d48a1ecf2331)) | |
| tree | [15bc7e7a9352bc78e64fdaa7d196c7d078c7aef3](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=75f828e944dacaac8870418461d3d48a1ecf2331) | |
| parent | [649d64650623adc449c5f35b7b1156c1e497569d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=649d64650623adc449c5f35b7b1156c1e497569d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=75f828e944dacaac8870418461d3d48a1ecf2331&id2=649d64650623adc449c5f35b7b1156c1e497569d)) | |
| download | [linux-75f828e944dacaac8870418461d3d48a1ecf2331.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-75f828e944dacaac8870418461d3d48a1ecf2331.tar.gz) | |

drm/vboxvideo: Replace fake VLA at end of vbva\_mouse\_pointer\_shape with real VLA[ Upstream commit d92b90f9a54d9300a6e883258e79f36dab53bfae ]
Replace the fake VLA at end of the vbva\_mouse\_pointer\_shape shape with
a real VLA to fix a "memcpy: detected field-spanning write error" warning:
[ 13.319813] memcpy: detected field-spanning write (size 16896) of single field "p->data" at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 (size 4)
[ 13.319841] WARNING: CPU: 0 PID: 1105 at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 hgsmi\_update\_pointer\_shape+0x192/0x1c0 [vboxvideo]
[ 13.320038] Call Trace:
[ 13.320173] hgsmi\_update\_pointer\_shape [vboxvideo]
[ 13.320184] vbox\_cursor\_atomic\_update [vboxvideo]
Note as mentioned in the added comment it seems the original length
calculation for the allocated and send hgsmi buffer is 4 bytes too large.
Changing this is not the goal of this patch, so this behavior is kept.
Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede@redhat.com](https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede%40redhat.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=75f828e944dacaac8870418461d3d48a1ecf2331)

| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=75f828e944dacaac8870418461d3d48a1ecf2331) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=75f828e944dacaac8870418461d3d48a1ecf2331) | 4 | |  |  |  | | --- | --- | --- | |

2 files changed, 10 insertions, 4 deletions

| diff --git a/drivers/gpu/drm/vboxvideo/hgsmi\_base.c b/drivers/gpu/drm/vboxvideo/hgsmi\_base.cindex 361d3193258eaf..7edc9cf6a6069d 100644--- a/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=649d64650623adc449c5f35b7b1156c1e497569d)+++ b/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=75f828e944dacaac8870418461d3d48a1ecf2331)@@ -135,7 +135,15 @@ int hgsmi\_update\_pointer\_shape(struct gen\_pool \*ctx, u32 flags, flags |= VBOX\_MOUSE\_POINTER\_VISIBLE; } - p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len, HGSMI\_CH\_VBVA,+ /\*+ \* The 4 extra bytes come from switching struct vbva\_mouse\_pointer\_shape+ \* from having a 4 bytes fixed array at the end to using a proper VLA+ \* at the end. These 4 extra bytes were not subtracted from sizeof(\*p)+ \* before the switch to the VLA, so this way the behavior is unchanged.+ \* Chances are these 4 extra bytes are not necessary but they are kept+ \* to avoid regressions.+ \*/+ p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len + 4, HGSMI\_CH\_VBVA, VBVA\_MOUSE\_POINTER\_SHAPE); if (!p) return -ENOMEM;diff --git a/drivers/gpu/drm/vboxvideo/vboxvideo.h b/drivers/gpu/drm/vboxvideo/vboxvideo.hindex a5de40fe1a76a3..bed285fe083c87 100644--- a/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=649d64650623adc449c5f35b7b1156c1e497569d)+++ b/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=75f828e944dacaac8870418461d3d48a1ecf2331)@@ -351,10 +351,8 @@ struct vbva\_mouse\_pointer\_shape { \* Bytes in the gap between the AND and the XOR mask are undefined. \* XOR mask scanlines have no gap between them and size of XOR mask is: \* xor\_len = width \* 4 \* height.- \*- \* Preallocate 4 bytes for accessing actual data as p->data. \*/- u8 data[4];+ u8 data[]; } \_\_packed;  /\* pointer is visible \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:45:03 +0000



=== Content from git.kernel.org_bdc254e7_20250115_094626.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hans de Goede <hdegoede@redhat.com> | 2024-08-27 12:45:23 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-01 01:58:27 +0100 |
| commit | [9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)) | |
| tree | [7cc0c97cf5e34ef6e0b1c3741f91789108f83436](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391) | |
| parent | [0d16f53c91111cec914f0811fcc526a2ba77b20d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0d16f53c91111cec914f0811fcc526a2ba77b20d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391&id2=0d16f53c91111cec914f0811fcc526a2ba77b20d)) | |
| download | [linux-9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391.tar.gz) | |

drm/vboxvideo: Replace fake VLA at end of vbva\_mouse\_pointer\_shape with real VLA[ Upstream commit d92b90f9a54d9300a6e883258e79f36dab53bfae ]
Replace the fake VLA at end of the vbva\_mouse\_pointer\_shape shape with
a real VLA to fix a "memcpy: detected field-spanning write error" warning:
[ 13.319813] memcpy: detected field-spanning write (size 16896) of single field "p->data" at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 (size 4)
[ 13.319841] WARNING: CPU: 0 PID: 1105 at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 hgsmi\_update\_pointer\_shape+0x192/0x1c0 [vboxvideo]
[ 13.320038] Call Trace:
[ 13.320173] hgsmi\_update\_pointer\_shape [vboxvideo]
[ 13.320184] vbox\_cursor\_atomic\_update [vboxvideo]
Note as mentioned in the added comment it seems the original length
calculation for the allocated and send hgsmi buffer is 4 bytes too large.
Changing this is not the goal of this patch, so this behavior is kept.
Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede@redhat.com](https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede%40redhat.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)

| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391) | 4 | |  |  |  | | --- | --- | --- | |

2 files changed, 10 insertions, 4 deletions

| diff --git a/drivers/gpu/drm/vboxvideo/hgsmi\_base.c b/drivers/gpu/drm/vboxvideo/hgsmi\_base.cindex 8c041d7ce4f1bd..87dccaecc3e57d 100644--- a/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=0d16f53c91111cec914f0811fcc526a2ba77b20d)+++ b/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)@@ -139,7 +139,15 @@ int hgsmi\_update\_pointer\_shape(struct gen\_pool \*ctx, u32 flags, flags |= VBOX\_MOUSE\_POINTER\_VISIBLE; } - p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len, HGSMI\_CH\_VBVA,+ /\*+ \* The 4 extra bytes come from switching struct vbva\_mouse\_pointer\_shape+ \* from having a 4 bytes fixed array at the end to using a proper VLA+ \* at the end. These 4 extra bytes were not subtracted from sizeof(\*p)+ \* before the switch to the VLA, so this way the behavior is unchanged.+ \* Chances are these 4 extra bytes are not necessary but they are kept+ \* to avoid regressions.+ \*/+ p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len + 4, HGSMI\_CH\_VBVA, VBVA\_MOUSE\_POINTER\_SHAPE); if (!p) return -ENOMEM;diff --git a/drivers/gpu/drm/vboxvideo/vboxvideo.h b/drivers/gpu/drm/vboxvideo/vboxvideo.hindex f60d82504da02c..79ec8481de0e48 100644--- a/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=0d16f53c91111cec914f0811fcc526a2ba77b20d)+++ b/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=9eb32bd23bbcec44bcbef27b7f282b7a7f3d0391)@@ -351,10 +351,8 @@ struct vbva\_mouse\_pointer\_shape { \* Bytes in the gap between the AND and the XOR mask are undefined. \* XOR mask scanlines have no gap between them and size of XOR mask is: \* xor\_len = width \* 4 \* height.- \*- \* Preallocate 4 bytes for accessing actual data as p->data. \*/- u8 data[4];+ u8 data[]; } \_\_packed;  /\* pointer is visible \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:45:04 +0000



=== Content from git.kernel.org_b8083ca9_20250115_094624.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=02c86c5d5ef4bbba17d38859c74872825f536617)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02c86c5d5ef4bbba17d38859c74872825f536617)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02c86c5d5ef4bbba17d38859c74872825f536617)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02c86c5d5ef4bbba17d38859c74872825f536617)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hans de Goede <hdegoede@redhat.com> | 2024-08-27 12:45:23 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-08 16:20:50 +0100 |
| commit | [02c86c5d5ef4bbba17d38859c74872825f536617](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=02c86c5d5ef4bbba17d38859c74872825f536617) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=02c86c5d5ef4bbba17d38859c74872825f536617)) | |
| tree | [53bf38b7629f0d64f2a60f9e8c0eb66c26c1c686](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=02c86c5d5ef4bbba17d38859c74872825f536617) | |
| parent | [c491ce22f99838bec3d3840815d6e233b3123a8f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c491ce22f99838bec3d3840815d6e233b3123a8f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02c86c5d5ef4bbba17d38859c74872825f536617&id2=c491ce22f99838bec3d3840815d6e233b3123a8f)) | |
| download | [linux-02c86c5d5ef4bbba17d38859c74872825f536617.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-02c86c5d5ef4bbba17d38859c74872825f536617.tar.gz) | |

drm/vboxvideo: Replace fake VLA at end of vbva\_mouse\_pointer\_shape with real VLA[ Upstream commit d92b90f9a54d9300a6e883258e79f36dab53bfae ]
Replace the fake VLA at end of the vbva\_mouse\_pointer\_shape shape with
a real VLA to fix a "memcpy: detected field-spanning write error" warning:
[ 13.319813] memcpy: detected field-spanning write (size 16896) of single field "p->data" at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 (size 4)
[ 13.319841] WARNING: CPU: 0 PID: 1105 at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 hgsmi\_update\_pointer\_shape+0x192/0x1c0 [vboxvideo]
[ 13.320038] Call Trace:
[ 13.320173] hgsmi\_update\_pointer\_shape [vboxvideo]
[ 13.320184] vbox\_cursor\_atomic\_update [vboxvideo]
Note as mentioned in the added comment it seems the original length
calculation for the allocated and send hgsmi buffer is 4 bytes too large.
Changing this is not the goal of this patch, so this behavior is kept.
Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede@redhat.com](https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede%40redhat.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=02c86c5d5ef4bbba17d38859c74872825f536617)

| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=02c86c5d5ef4bbba17d38859c74872825f536617) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=02c86c5d5ef4bbba17d38859c74872825f536617) | 4 | |  |  |  | | --- | --- | --- | |

2 files changed, 10 insertions, 4 deletions

| diff --git a/drivers/gpu/drm/vboxvideo/hgsmi\_base.c b/drivers/gpu/drm/vboxvideo/hgsmi\_base.cindex 361d3193258eaf..7edc9cf6a6069d 100644--- a/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=c491ce22f99838bec3d3840815d6e233b3123a8f)+++ b/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=02c86c5d5ef4bbba17d38859c74872825f536617)@@ -135,7 +135,15 @@ int hgsmi\_update\_pointer\_shape(struct gen\_pool \*ctx, u32 flags, flags |= VBOX\_MOUSE\_POINTER\_VISIBLE; } - p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len, HGSMI\_CH\_VBVA,+ /\*+ \* The 4 extra bytes come from switching struct vbva\_mouse\_pointer\_shape+ \* from having a 4 bytes fixed array at the end to using a proper VLA+ \* at the end. These 4 extra bytes were not subtracted from sizeof(\*p)+ \* before the switch to the VLA, so this way the behavior is unchanged.+ \* Chances are these 4 extra bytes are not necessary but they are kept+ \* to avoid regressions.+ \*/+ p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len + 4, HGSMI\_CH\_VBVA, VBVA\_MOUSE\_POINTER\_SHAPE); if (!p) return -ENOMEM;diff --git a/drivers/gpu/drm/vboxvideo/vboxvideo.h b/drivers/gpu/drm/vboxvideo/vboxvideo.hindex 0592004f71aa05..a03695939c62a4 100644--- a/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=c491ce22f99838bec3d3840815d6e233b3123a8f)+++ b/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=02c86c5d5ef4bbba17d38859c74872825f536617)@@ -351,10 +351,8 @@ struct vbva\_mouse\_pointer\_shape { \* Bytes in the gap between the AND and the XOR mask are undefined. \* XOR mask scanlines have no gap between them and size of XOR mask is: \* xor\_len = width \* 4 \* height.- \*- \* Preallocate 4 bytes for accessing actual data as p->data. \*/- u8 data[4];+ u8 data[]; } \_\_packed;  /\* pointer is visible \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:45:02 +0000



=== Content from git.kernel.org_15e5e8a9_20250115_094627.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hans de Goede <hdegoede@redhat.com> | 2024-08-27 12:45:23 +0200 |
| --- | --- | --- |
| committer | Hans de Goede <hdegoede@redhat.com> | 2024-09-14 13:32:15 +0200 |
| commit | [d92b90f9a54d9300a6e883258e79f36dab53bfae](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)) | |
| tree | [f9ff853335015daa13641ebcc74d71d2b62eb9f5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae) | |
| parent | [4a33aa34e4ac2c2bd746a305d4b39fb60dedc091](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4a33aa34e4ac2c2bd746a305d4b39fb60dedc091) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae&id2=4a33aa34e4ac2c2bd746a305d4b39fb60dedc091)) | |
| download | [linux-d92b90f9a54d9300a6e883258e79f36dab53bfae.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d92b90f9a54d9300a6e883258e79f36dab53bfae.tar.gz) | |

drm/vboxvideo: Replace fake VLA at end of vbva\_mouse\_pointer\_shape with real VLAReplace the fake VLA at end of the vbva\_mouse\_pointer\_shape shape with
a real VLA to fix a "memcpy: detected field-spanning write error" warning:
[ 13.319813] memcpy: detected field-spanning write (size 16896) of single field "p->data" at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 (size 4)
[ 13.319841] WARNING: CPU: 0 PID: 1105 at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 hgsmi\_update\_pointer\_shape+0x192/0x1c0 [vboxvideo]
[ 13.320038] Call Trace:
[ 13.320173] hgsmi\_update\_pointer\_shape [vboxvideo]
[ 13.320184] vbox\_cursor\_atomic\_update [vboxvideo]
Note as mentioned in the added comment it seems the original length
calculation for the allocated and send hgsmi buffer is 4 bytes too large.
Changing this is not the goal of this patch, so this behavior is kept.
Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede@redhat.com](https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede%40redhat.com)
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)

| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=d92b90f9a54d9300a6e883258e79f36dab53bfae) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=d92b90f9a54d9300a6e883258e79f36dab53bfae) | 4 | |  |  |  | | --- | --- | --- | |

2 files changed, 10 insertions, 4 deletions

| diff --git a/drivers/gpu/drm/vboxvideo/hgsmi\_base.c b/drivers/gpu/drm/vboxvideo/hgsmi\_base.cindex 8c041d7ce4f1bd..87dccaecc3e57d 100644--- a/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=4a33aa34e4ac2c2bd746a305d4b39fb60dedc091)+++ b/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)@@ -139,7 +139,15 @@ int hgsmi\_update\_pointer\_shape(struct gen\_pool \*ctx, u32 flags, flags |= VBOX\_MOUSE\_POINTER\_VISIBLE; } - p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len, HGSMI\_CH\_VBVA,+ /\*+ \* The 4 extra bytes come from switching struct vbva\_mouse\_pointer\_shape+ \* from having a 4 bytes fixed array at the end to using a proper VLA+ \* at the end. These 4 extra bytes were not subtracted from sizeof(\*p)+ \* before the switch to the VLA, so this way the behavior is unchanged.+ \* Chances are these 4 extra bytes are not necessary but they are kept+ \* to avoid regressions.+ \*/+ p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len + 4, HGSMI\_CH\_VBVA, VBVA\_MOUSE\_POINTER\_SHAPE); if (!p) return -ENOMEM;diff --git a/drivers/gpu/drm/vboxvideo/vboxvideo.h b/drivers/gpu/drm/vboxvideo/vboxvideo.hindex f60d82504da02c..79ec8481de0e48 100644--- a/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=4a33aa34e4ac2c2bd746a305d4b39fb60dedc091)+++ b/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=d92b90f9a54d9300a6e883258e79f36dab53bfae)@@ -351,10 +351,8 @@ struct vbva\_mouse\_pointer\_shape { \* Bytes in the gap between the AND and the XOR mask are undefined. \* XOR mask scanlines have no gap between them and size of XOR mask is: \* xor\_len = width \* 4 \* height.- \*- \* Preallocate 4 bytes for accessing actual data as p->data. \*/- u8 data[4];+ u8 data[]; } \_\_packed;  /\* pointer is visible \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:45:04 +0000



=== Content from git.kernel.org_1e27ac0c_20250115_094625.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=34a422274b693507025a7db21519865d1862afcb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=34a422274b693507025a7db21519865d1862afcb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=34a422274b693507025a7db21519865d1862afcb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=34a422274b693507025a7db21519865d1862afcb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hans de Goede <hdegoede@redhat.com> | 2024-08-27 12:45:23 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-01 01:52:35 +0100 |
| commit | [34a422274b693507025a7db21519865d1862afcb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=34a422274b693507025a7db21519865d1862afcb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=34a422274b693507025a7db21519865d1862afcb)) | |
| tree | [513bafe8c5a7be7730cff3ce6d216f6a3c1b634c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=34a422274b693507025a7db21519865d1862afcb) | |
| parent | [b723f96407a0a078cf75970e4dbf16b46d286a61](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b723f96407a0a078cf75970e4dbf16b46d286a61) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=34a422274b693507025a7db21519865d1862afcb&id2=b723f96407a0a078cf75970e4dbf16b46d286a61)) | |
| download | [linux-34a422274b693507025a7db21519865d1862afcb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-34a422274b693507025a7db21519865d1862afcb.tar.gz) | |

drm/vboxvideo: Replace fake VLA at end of vbva\_mouse\_pointer\_shape with real VLA[ Upstream commit d92b90f9a54d9300a6e883258e79f36dab53bfae ]
Replace the fake VLA at end of the vbva\_mouse\_pointer\_shape shape with
a real VLA to fix a "memcpy: detected field-spanning write error" warning:
[ 13.319813] memcpy: detected field-spanning write (size 16896) of single field "p->data" at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 (size 4)
[ 13.319841] WARNING: CPU: 0 PID: 1105 at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 hgsmi\_update\_pointer\_shape+0x192/0x1c0 [vboxvideo]
[ 13.320038] Call Trace:
[ 13.320173] hgsmi\_update\_pointer\_shape [vboxvideo]
[ 13.320184] vbox\_cursor\_atomic\_update [vboxvideo]
Note as mentioned in the added comment it seems the original length
calculation for the allocated and send hgsmi buffer is 4 bytes too large.
Changing this is not the goal of this patch, so this behavior is kept.
Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede@redhat.com](https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede%40redhat.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=34a422274b693507025a7db21519865d1862afcb)

| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=34a422274b693507025a7db21519865d1862afcb) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=34a422274b693507025a7db21519865d1862afcb) | 4 | |  |  |  | | --- | --- | --- | |

2 files changed, 10 insertions, 4 deletions

| diff --git a/drivers/gpu/drm/vboxvideo/hgsmi\_base.c b/drivers/gpu/drm/vboxvideo/hgsmi\_base.cindex 8c041d7ce4f1bd..87dccaecc3e57d 100644--- a/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=b723f96407a0a078cf75970e4dbf16b46d286a61)+++ b/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=34a422274b693507025a7db21519865d1862afcb)@@ -139,7 +139,15 @@ int hgsmi\_update\_pointer\_shape(struct gen\_pool \*ctx, u32 flags, flags |= VBOX\_MOUSE\_POINTER\_VISIBLE; } - p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len, HGSMI\_CH\_VBVA,+ /\*+ \* The 4 extra bytes come from switching struct vbva\_mouse\_pointer\_shape+ \* from having a 4 bytes fixed array at the end to using a proper VLA+ \* at the end. These 4 extra bytes were not subtracted from sizeof(\*p)+ \* before the switch to the VLA, so this way the behavior is unchanged.+ \* Chances are these 4 extra bytes are not necessary but they are kept+ \* to avoid regressions.+ \*/+ p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len + 4, HGSMI\_CH\_VBVA, VBVA\_MOUSE\_POINTER\_SHAPE); if (!p) return -ENOMEM;diff --git a/drivers/gpu/drm/vboxvideo/vboxvideo.h b/drivers/gpu/drm/vboxvideo/vboxvideo.hindex a5de40fe1a76a3..bed285fe083c87 100644--- a/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=b723f96407a0a078cf75970e4dbf16b46d286a61)+++ b/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=34a422274b693507025a7db21519865d1862afcb)@@ -351,10 +351,8 @@ struct vbva\_mouse\_pointer\_shape { \* Bytes in the gap between the AND and the XOR mask are undefined. \* XOR mask scanlines have no gap between them and size of XOR mask is: \* xor\_len = width \* 4 \* height.- \*- \* Preallocate 4 bytes for accessing actual data as p->data. \*/- u8 data[4];+ u8 data[]; } \_\_packed;  /\* pointer is visible \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:45:02 +0000



=== Content from git.kernel.org_1c69a4d6_20250115_094625.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hans de Goede <hdegoede@redhat.com> | 2024-08-27 12:45:23 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-01 01:56:02 +0100 |
| commit | [7458a6cdaebb3dc59af8578ee354fae78a154c4a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)) | |
| tree | [b2c46f2f4e28b01806a808a4e255a631eab1bcf5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a) | |
| parent | [3dfd727873c3e8da74a2e3907120ff052c5f0bcc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3dfd727873c3e8da74a2e3907120ff052c5f0bcc) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a&id2=3dfd727873c3e8da74a2e3907120ff052c5f0bcc)) | |
| download | [linux-7458a6cdaebb3dc59af8578ee354fae78a154c4a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7458a6cdaebb3dc59af8578ee354fae78a154c4a.tar.gz) | |

drm/vboxvideo: Replace fake VLA at end of vbva\_mouse\_pointer\_shape with real VLA[ Upstream commit d92b90f9a54d9300a6e883258e79f36dab53bfae ]
Replace the fake VLA at end of the vbva\_mouse\_pointer\_shape shape with
a real VLA to fix a "memcpy: detected field-spanning write error" warning:
[ 13.319813] memcpy: detected field-spanning write (size 16896) of single field "p->data" at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 (size 4)
[ 13.319841] WARNING: CPU: 0 PID: 1105 at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 hgsmi\_update\_pointer\_shape+0x192/0x1c0 [vboxvideo]
[ 13.320038] Call Trace:
[ 13.320173] hgsmi\_update\_pointer\_shape [vboxvideo]
[ 13.320184] vbox\_cursor\_atomic\_update [vboxvideo]
Note as mentioned in the added comment it seems the original length
calculation for the allocated and send hgsmi buffer is 4 bytes too large.
Changing this is not the goal of this patch, so this behavior is kept.
Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede@redhat.com](https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede%40redhat.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)

| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a) | 4 | |  |  |  | | --- | --- | --- | |

2 files changed, 10 insertions, 4 deletions

| diff --git a/drivers/gpu/drm/vboxvideo/hgsmi\_base.c b/drivers/gpu/drm/vboxvideo/hgsmi\_base.cindex 8c041d7ce4f1bd..87dccaecc3e57d 100644--- a/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=3dfd727873c3e8da74a2e3907120ff052c5f0bcc)+++ b/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)@@ -139,7 +139,15 @@ int hgsmi\_update\_pointer\_shape(struct gen\_pool \*ctx, u32 flags, flags |= VBOX\_MOUSE\_POINTER\_VISIBLE; } - p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len, HGSMI\_CH\_VBVA,+ /\*+ \* The 4 extra bytes come from switching struct vbva\_mouse\_pointer\_shape+ \* from having a 4 bytes fixed array at the end to using a proper VLA+ \* at the end. These 4 extra bytes were not subtracted from sizeof(\*p)+ \* before the switch to the VLA, so this way the behavior is unchanged.+ \* Chances are these 4 extra bytes are not necessary but they are kept+ \* to avoid regressions.+ \*/+ p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len + 4, HGSMI\_CH\_VBVA, VBVA\_MOUSE\_POINTER\_SHAPE); if (!p) return -ENOMEM;diff --git a/drivers/gpu/drm/vboxvideo/vboxvideo.h b/drivers/gpu/drm/vboxvideo/vboxvideo.hindex f60d82504da02c..79ec8481de0e48 100644--- a/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=3dfd727873c3e8da74a2e3907120ff052c5f0bcc)+++ b/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=7458a6cdaebb3dc59af8578ee354fae78a154c4a)@@ -351,10 +351,8 @@ struct vbva\_mouse\_pointer\_shape { \* Bytes in the gap between the AND and the XOR mask are undefined. \* XOR mask scanlines have no gap between them and size of XOR mask is: \* xor\_len = width \* 4 \* height.- \*- \* Preallocate 4 bytes for accessing actual data as p->data. \*/- u8 data[4];+ u8 data[]; } \_\_packed;  /\* pointer is visible \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 08:47:55 +0000



=== Content from git.kernel.org_364d222d_20250115_094628.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Hans de Goede <hdegoede@redhat.com> | 2024-08-27 12:45:23 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-01 02:02:33 +0100 |
| commit | [fae9dc12c61ce23cf29d09824a741b7b1ff8f01f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)) | |
| tree | [53d7ca1629d0d927c8907c00024a91a0cb64e80a](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f) | |
| parent | [537ad4a431f6dddbf15d40d19f24bb9ee12b55cb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=537ad4a431f6dddbf15d40d19f24bb9ee12b55cb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f&id2=537ad4a431f6dddbf15d40d19f24bb9ee12b55cb)) | |
| download | [linux-fae9dc12c61ce23cf29d09824a741b7b1ff8f01f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fae9dc12c61ce23cf29d09824a741b7b1ff8f01f.tar.gz) | |

drm/vboxvideo: Replace fake VLA at end of vbva\_mouse\_pointer\_shape with real VLA[ Upstream commit d92b90f9a54d9300a6e883258e79f36dab53bfae ]
Replace the fake VLA at end of the vbva\_mouse\_pointer\_shape shape with
a real VLA to fix a "memcpy: detected field-spanning write error" warning:
[ 13.319813] memcpy: detected field-spanning write (size 16896) of single field "p->data" at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 (size 4)
[ 13.319841] WARNING: CPU: 0 PID: 1105 at drivers/gpu/drm/vboxvideo/hgsmi\_base.c:154 hgsmi\_update\_pointer\_shape+0x192/0x1c0 [vboxvideo]
[ 13.320038] Call Trace:
[ 13.320173] hgsmi\_update\_pointer\_shape [vboxvideo]
[ 13.320184] vbox\_cursor\_atomic\_update [vboxvideo]
Note as mentioned in the added comment it seems the original length
calculation for the allocated and send hgsmi buffer is 4 bytes too large.
Changing this is not the goal of this patch, so this behavior is kept.
Signed-off-by: Hans de Goede <hdegoede@redhat.com>
Reviewed-by: Jani Nikula <jani.nikula@intel.com>
Link: [https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede@redhat.com](https://patchwork.freedesktop.org/patch/msgid/20240827104523.17442-1-hdegoede%40redhat.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)

| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f) | 10 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |
| -rw-r--r-- | [drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f) | 4 | |  |  |  | | --- | --- | --- | |

2 files changed, 10 insertions, 4 deletions

| diff --git a/drivers/gpu/drm/vboxvideo/hgsmi\_base.c b/drivers/gpu/drm/vboxvideo/hgsmi\_base.cindex 8c041d7ce4f1bd..87dccaecc3e57d 100644--- a/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=537ad4a431f6dddbf15d40d19f24bb9ee12b55cb)+++ b/[drivers/gpu/drm/vboxvideo/hgsmi\_base.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/hgsmi_base.c?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)@@ -139,7 +139,15 @@ int hgsmi\_update\_pointer\_shape(struct gen\_pool \*ctx, u32 flags, flags |= VBOX\_MOUSE\_POINTER\_VISIBLE; } - p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len, HGSMI\_CH\_VBVA,+ /\*+ \* The 4 extra bytes come from switching struct vbva\_mouse\_pointer\_shape+ \* from having a 4 bytes fixed array at the end to using a proper VLA+ \* at the end. These 4 extra bytes were not subtracted from sizeof(\*p)+ \* before the switch to the VLA, so this way the behavior is unchanged.+ \* Chances are these 4 extra bytes are not necessary but they are kept+ \* to avoid regressions.+ \*/+ p = hgsmi\_buffer\_alloc(ctx, sizeof(\*p) + pixel\_len + 4, HGSMI\_CH\_VBVA, VBVA\_MOUSE\_POINTER\_SHAPE); if (!p) return -ENOMEM;diff --git a/drivers/gpu/drm/vboxvideo/vboxvideo.h b/drivers/gpu/drm/vboxvideo/vboxvideo.hindex f60d82504da02c..79ec8481de0e48 100644--- a/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=537ad4a431f6dddbf15d40d19f24bb9ee12b55cb)+++ b/[drivers/gpu/drm/vboxvideo/vboxvideo.h](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/gpu/drm/vboxvideo/vboxvideo.h?id=fae9dc12c61ce23cf29d09824a741b7b1ff8f01f)@@ -351,10 +351,8 @@ struct vbva\_mouse\_pointer\_shape { \* Bytes in the gap between the AND and the XOR mask are undefined. \* XOR mask scanlines have no gap between them and size of XOR mask is: \* xor\_len = width \* 4 \* height.- \*- \* Preallocate 4 bytes for accessing actual data as p->data. \*/- u8 data[4];+ u8 data[]; } \_\_packed;  /\* pointer is visible \*/ |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:45:05 +0000


