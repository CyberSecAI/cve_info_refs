The provided content is related to CVE-2024-50288.

**Root cause of vulnerability:**
The vulnerability is due to an out-of-bounds write in the `vivid` driver when using more than 32 buffers for video capture. The `must_blank` array, used by the video capture logic, was sized for 32 buffers (`VIDEO_MAX_FRAME`), while the driver was configured to allow up to 64 buffers. When a buffer index greater than or equal to 32 was used, it resulted in an out-of-bounds write to the `must_blank` array.

**Weaknesses/vulnerabilities present:**
- Out-of-bounds write: The `must_blank` array is accessed with an index that exceeds its bounds, leading to a memory corruption vulnerability.

**Impact of exploitation:**
- Memory corruption: An out-of-bounds write can lead to memory corruption, which can cause the system to crash or become unstable.
- Potential for further exploitation: In some cases, memory corruption vulnerabilities can be further exploited by attackers to execute arbitrary code.

**Attack vectors:**
- Requesting a video capture queue with more than 32 buffers.

**Required attacker capabilities/position:**
- Ability to interact with the video capture functionality of the `vivid` driver.
- Need to request more than 32 buffers for the video capture queue.

**Additional Information:**
- The fix introduces a new define `MAX_VID_CAP_BUFFERS` (set to 64) to define the maximum number of video capture buffers. This new define is used to correctly size the `must_blank` array and to set the `max_num_buffers` for the video capture queue, preventing the out-of-bounds write.
- The issue was reported on the kernel bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=219258
- The vulnerability was introduced by commit `cea70ed416b4 ("media: test-drivers: vivid: Increase max supported buffers for capture queues")`.