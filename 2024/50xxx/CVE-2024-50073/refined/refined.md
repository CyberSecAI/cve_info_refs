The provided content relates to CVE-2024-50073.

**Root cause of vulnerability:**
- A use-after-free vulnerability exists in the `gsm_cleanup_mux` function within the `drivers/tty/n_gsm.c` file of the Linux kernel.

**Weaknesses/vulnerabilities present:**
- Use-after-free: `gsm_msg` on the `tx_ctrl_list` or `tx_data_list` of `gsm_mux` can be freed by multiple threads via ioctl, leading to a use-after-free condition.

**Impact of exploitation:**
- The vulnerability leads to a slab-use-after-free, which can potentially cause a kernel crash or allow for arbitrary code execution by an attacker.

**Attack vectors:**
- The vulnerability can be triggered by sending an ioctl that causes the `gsm_cleanup_mux` function to be called and freeing `gsm_msg` while other threads might be using it.

**Required attacker capabilities/position:**
- The attacker must be able to trigger specific ioctl calls that interact with the n_gsm driver, specifically the `gsmld_ioctl` function.
- The attacker must be able to execute code within the kernel context to trigger this vulnerability.

**Additional details:**
- The vulnerability is mitigated by adding a spinlock (`gsm->tx_lock`) to protect the access to the tx queues during cleanup.
- The patch adds the `guard(spinlock_irqsave)(&gsm->tx_lock)` before iterating through the `tx_ctrl_list` and freeing the `txq` entries in function `gsm_cleanup_mux`.
- The vulnerability was identified by KASAN (Kernel Address Sanitizer), which detected the use-after-free.
- The commit log indicates the fix was backported to stable kernel branches.