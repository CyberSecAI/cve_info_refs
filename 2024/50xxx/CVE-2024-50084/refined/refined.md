The provided content relates to CVE-2024-50084.

**Root Cause:**
The vulnerability stems from a memory leak in the `vcap_api_encode_rule_test()` function within the Microchip VCAP driver. The issue was introduced when a previous fix for a use-after-free error removed a necessary call to `vcap_free_rule()`.

**Vulnerabilities:**
- Memory leak: The `vcap_api_encode_rule_test()` function was allocating memory for rules using `vcap_alloc_rule`, `vcap_rule_add_key`, and `vcap_rule_add_action` but not freeing it in all cases.

**Impact:**
- Memory exhaustion: Repeated execution of the vulnerable code path in the `vcap_api_encode_rule_test` function could lead to memory exhaustion.

**Attack Vectors:**
- The vulnerability is triggered by executing the `vcap_api_encode_rule_test()` function as part of the KUnit tests.

**Required Attacker Capabilities/Position:**
- An attacker would need the ability to execute KUnit tests for the microchip driver.