The provided content relates to CVE-2024-50143.

**Root cause of vulnerability:**
The vulnerability stems from a missing overflow check when calculating the allocation length (`alen`) in the `udf_current_aext` function within the UDF filesystem driver of the Linux kernel. Specifically, the code adds `sizeof(struct allocExtDesc)` and `le32_to_cpu(header->lengthAllocDescs)` without proper overflow protection.

**Weaknesses/vulnerabilities present:**
- Integer overflow: The `alen` calculation could result in an integer overflow if the value of `le32_to_cpu(header->lengthAllocDescs)` is sufficiently large, causing `alen` to wrap to a small value.
- Use of uninitialized value: The overflow in `alen` calculation could lead to an uninitialized value being used later in `udf_get_fileshortad`, triggering a Kernel Memory Sanitizer (KMSAN) bug.

**Impact of exploitation:**
- The integer overflow leads to a read of uninitialized memory in `udf_get_fileshortad`, as detected by KMSAN. This could lead to data corruption, crashes, or potentially other unexpected behavior.

**Attack vectors:**
- The attack vector involves crafting a malicious UDF filesystem image with a specific value for `lengthAllocDescs` in the `allocExtDesc` structure to trigger the integer overflow in `udf_current_aext`.

**Required attacker capabilities/position:**
- The attacker needs to be able to mount a specially crafted UDF filesystem image on a vulnerable system. This could be achieved through local access, or potentially through other means of filesystem exposure.

The patch addresses this vulnerability by using the `check_add_overflow()` function to properly check for integer overflow when calculating `alen`, returning an error if overflow occurs and preventing the use of uninitialized memory.