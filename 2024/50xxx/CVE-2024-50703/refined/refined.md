Based on the provided content, here's an analysis related to a potential vulnerability:

**Root Cause of Vulnerability:**

The vulnerability lies in the `sources/users.queries.php` file. The code implements a check to ensure that non-admin/non-manager users can only modify their own user data. However, there's a flaw in the logic that allows a non-manager to change the authentication type of another user.

**Weaknesses/Vulnerabilities Present:**

*   **Inadequate Authorization Check:** The code has a list of allowed actions (`$all_users_can_access`) for non-admin/non-manager users, including `user_profile_update` and `save_user_change`. However, the `change_user_auth_type` action is not properly checked within the same permission logic, allowing any logged-in user to potentially alter the authentication type for any other user.

*   **Missing Input Validation/Sanitization:** While the code uses `filter_var` to sanitize input for other user data, it does not properly validate the  `$post_type` parameter or the user IDs being modified, which can potentially lead to unintended changes.

**Impact of Exploitation:**

*   **Account Takeover:** By exploiting this vulnerability, a regular user could potentially change another user's authentication type, including setting it to a less secure method. For example, a user could switch another user from a complex password authentication type to 'none', effectively allowing access to the targeted account without credentials.
*   **Privilege Escalation:** Although a regular user cannot directly escalate their own privileges, they could use this vulnerability to disable other users or make them more vulnerable.
*   **Data Manipulation:** The flaw can be used to change sensitive user settings, leading to data integrity issues.

**Attack Vectors:**

*   **Web Request Manipulation:** An attacker can send a crafted HTTP POST request to `sources/users.queries.php` with the `post_type` set to `change_user_auth_type`, a valid target `user_id`, and the desired `auth_type`.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** The attacker must have a valid user account on the application. This vulnerability does not require any special administrative or managerial privileges.
*   **Access to the Application:** The attacker needs network access to the vulnerable application in order to send the crafted requests.

**Additional Details:**

*   The commit diff highlights a change in the `sources/users.queries.php` where  `$post_id = filter_var($dataReceived['id'], FILTER_SANITIZE_NUMBER_INT);` is modified to include ` $post_id = filter_var($dataReceived['user_id'], FILTER_SANITIZE_NUMBER_INT);` in the `change_user_auth_type` case. This change is part of the fix, which appears to move the user id sanitization to the correct variable name, but does not address the authorization bypass.
*   The code uses `prepareExchangedData` to handle data encoding and decoding, which could also be a potential area of weakness but the details are not available.

In summary, a regular user can leverage an authorization bypass vulnerability to change the authentication type of any user by sending a crafted web request.