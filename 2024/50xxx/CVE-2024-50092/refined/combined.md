=== Content from git.kernel.org_4325499c_20250114_214723.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d94785bb46b6167382b1de3290eccc91fa98df53)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d94785bb46b6167382b1de3290eccc91fa98df53)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d94785bb46b6167382b1de3290eccc91fa98df53)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d94785bb46b6167382b1de3290eccc91fa98df53)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Breno Leitao <leitao@debian.org> | 2024-10-08 02:43:24 -0700 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2024-10-09 19:42:43 -0700 |
| commit | [d94785bb46b6167382b1de3290eccc91fa98df53](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d94785bb46b6167382b1de3290eccc91fa98df53) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d94785bb46b6167382b1de3290eccc91fa98df53)) | |
| tree | [44cc9992418b850c0704e01221a8f0d27296d735](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d94785bb46b6167382b1de3290eccc91fa98df53) | |
| parent | [8c924369cb56c3054dca504c2c9c3eb208272865](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8c924369cb56c3054dca504c2c9c3eb208272865) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d94785bb46b6167382b1de3290eccc91fa98df53&id2=8c924369cb56c3054dca504c2c9c3eb208272865)) | |
| download | [linux-d94785bb46b6167382b1de3290eccc91fa98df53.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d94785bb46b6167382b1de3290eccc91fa98df53.tar.gz) | |

net: netconsole: fix wrong warningA warning is triggered when there is insufficient space in the buffer
for userdata. However, this is not an issue since userdata will be sent
in the next iteration.
Current warning message:
------------[ cut here ]------------
WARNING: CPU: 13 PID: 3013042 at drivers/net/netconsole.c:1122 write\_ext\_msg+0x3b6/0x3d0
? write\_ext\_msg+0x3b6/0x3d0
console\_flush\_all+0x1e9/0x330
The code incorrectly issues a warning when this\_chunk is zero, which is
a valid scenario. The warning should only be triggered when this\_chunk
is negative.
Fixes: 1ec9daf95093 ("net: netconsole: append userdata to fragmented netconsole messages")
Signed-off-by: Breno Leitao <leitao@debian.org>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241008094325.896208-1-leitao@debian.org](https://patch.msgid.link/20241008094325.896208-1-leitao%40debian.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d94785bb46b6167382b1de3290eccc91fa98df53)

| -rw-r--r-- | [drivers/net/netconsole.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/netconsole.c?id=d94785bb46b6167382b1de3290eccc91fa98df53) | 8 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 1 deletions

| diff --git a/drivers/net/netconsole.c b/drivers/net/netconsole.cindex 01cf33fa75036c..de20928f740211 100644--- a/[drivers/net/netconsole.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netconsole.c?id=8c924369cb56c3054dca504c2c9c3eb208272865)+++ b/[drivers/net/netconsole.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netconsole.c?id=d94785bb46b6167382b1de3290eccc91fa98df53)@@ -1161,8 +1161,14 @@ static void send\_ext\_msg\_udp(struct netconsole\_target \*nt, const char \*msg,  this\_chunk = min(userdata\_len - sent\_userdata, MAX\_PRINT\_CHUNK - preceding\_bytes);- if (WARN\_ON\_ONCE(this\_chunk <= 0))+ if (WARN\_ON\_ONCE(this\_chunk < 0))+ /\* this\_chunk could be zero if all the previous+ \* message used all the buffer. This is not a+ \* problem, userdata will be sent in the next+ \* iteration+ \*/ return;+ memcpy(buf + this\_header + this\_offset, userdata + sent\_userdata, this\_chunk); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:46:00 +0000



=== Content from git.kernel.org_e062fdeb_20250114_214722.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=712a3af3710263444217df54e7f337f99df198d2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=712a3af3710263444217df54e7f337f99df198d2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=712a3af3710263444217df54e7f337f99df198d2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=712a3af3710263444217df54e7f337f99df198d2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Breno Leitao <leitao@debian.org> | 2024-10-08 02:43:24 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:26:51 +0200 |
| commit | [712a3af3710263444217df54e7f337f99df198d2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=712a3af3710263444217df54e7f337f99df198d2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=712a3af3710263444217df54e7f337f99df198d2)) | |
| tree | [46c69a97f07b528956726c6c81c0574738b35894](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=712a3af3710263444217df54e7f337f99df198d2) | |
| parent | [40be42b3e42a03b706b90b4506cc7f8caa929910](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=40be42b3e42a03b706b90b4506cc7f8caa929910) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=712a3af3710263444217df54e7f337f99df198d2&id2=40be42b3e42a03b706b90b4506cc7f8caa929910)) | |
| download | [linux-712a3af3710263444217df54e7f337f99df198d2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-712a3af3710263444217df54e7f337f99df198d2.tar.gz) | |

net: netconsole: fix wrong warning[ Upstream commit d94785bb46b6167382b1de3290eccc91fa98df53 ]
A warning is triggered when there is insufficient space in the buffer
for userdata. However, this is not an issue since userdata will be sent
in the next iteration.
Current warning message:
------------[ cut here ]------------
WARNING: CPU: 13 PID: 3013042 at drivers/net/netconsole.c:1122 write\_ext\_msg+0x3b6/0x3d0
? write\_ext\_msg+0x3b6/0x3d0
console\_flush\_all+0x1e9/0x330
The code incorrectly issues a warning when this\_chunk is zero, which is
a valid scenario. The warning should only be triggered when this\_chunk
is negative.
Fixes: 1ec9daf95093 ("net: netconsole: append userdata to fragmented netconsole messages")
Signed-off-by: Breno Leitao <leitao@debian.org>
Reviewed-by: Simon Horman <horms@kernel.org>
Link: [https://patch.msgid.link/20241008094325.896208-1-leitao@debian.org](https://patch.msgid.link/20241008094325.896208-1-leitao%40debian.org)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=712a3af3710263444217df54e7f337f99df198d2)

| -rw-r--r-- | [drivers/net/netconsole.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/netconsole.c?id=712a3af3710263444217df54e7f337f99df198d2) | 8 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 1 deletions

| diff --git a/drivers/net/netconsole.c b/drivers/net/netconsole.cindex 9c09293b52588d..3e68f7a6e0abe3 100644--- a/[drivers/net/netconsole.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netconsole.c?id=40be42b3e42a03b706b90b4506cc7f8caa929910)+++ b/[drivers/net/netconsole.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netconsole.c?id=712a3af3710263444217df54e7f337f99df198d2)@@ -1118,8 +1118,14 @@ static void send\_ext\_msg\_udp(struct netconsole\_target \*nt, const char \*msg,  this\_chunk = min(userdata\_len - sent\_userdata, MAX\_PRINT\_CHUNK - preceding\_bytes);- if (WARN\_ON\_ONCE(this\_chunk <= 0))+ if (WARN\_ON\_ONCE(this\_chunk < 0))+ /\* this\_chunk could be zero if all the previous+ \* message used all the buffer. This is not a+ \* problem, userdata will be sent in the next+ \* iteration+ \*/ return;+ memcpy(buf + this\_header + this\_offset, userdata + sent\_userdata, this\_chunk); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:45:59 +0000


