=== Content from git.kernel.org_a7999fd4_20250115_092348.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-10-12 09:42:30 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-01 01:58:22 +0100 |
| commit | [681ce79ab6fba2f8d1c5ea60239f0086baebd0d3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3)) | |
| tree | [855ef0a260bafae6bf9f25b2193f86ba1de6804c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3) | |
| parent | [268446b40bb144f777ae962b5d9e053b2eeab5ad](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=268446b40bb144f777ae962b5d9e053b2eeab5ad) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3&id2=268446b40bb144f777ae962b5d9e053b2eeab5ad)) | |
| download | [linux-681ce79ab6fba2f8d1c5ea60239f0086baebd0d3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-681ce79ab6fba2f8d1c5ea60239f0086baebd0d3.tar.gz) | |

netdevsim: use cond\_resched() in nsim\_dev\_trap\_report\_work()[ Upstream commit a1494d532e28598bde7a5544892ef9c7dbfafa93 ]
I am still seeing many syzbot reports hinting that syzbot
might fool nsim\_dev\_trap\_report\_work() with hundreds of ports [1]
Lets use cond\_resched(), and system\_unbound\_wq
instead of implicit system\_wq.
[1]
INFO: task syz-executor:20633 blocked for more than 143 seconds.
Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
"echo 0 > /proc/sys/kernel/hung\_task\_timeout\_secs" disables this message.
task:syz-executor state:D stack:25856 pid:20633 tgid:20633 ppid:1 flags:0x00004006
...
NMI backtrace for cpu 1
CPU: 1 UID: 0 PID: 16760 Comm: kworker/1:0 Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
Workqueue: events nsim\_dev\_trap\_report\_work
RIP: 0010:\_\_sanitizer\_cov\_trace\_pc+0x0/0x70 kernel/kcov.c:210
Code: 89 fb e8 23 00 00 00 48 8b 3d 04 fb 9c 0c 48 89 de 5b e9 c3 c7 5d 00 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 <f3> 0f 1e fa 48 8b 04 24 65 48 8b 0c 25 c0 d7 03 00 65 8b 15 60 f0
RSP: 0018:ffffc90000a187e8 EFLAGS: 00000246
RAX: 0000000000000100 RBX: ffffc90000a188e0 RCX: ffff888027d3bc00
RDX: ffff888027d3bc00 RSI: 0000000000000000 RDI: 0000000000000000
RBP: ffff88804a2e6000 R08: ffffffff8a4bc495 R09: ffffffff89da3577
R10: 0000000000000004 R11: ffffffff8a4bc2b0 R12: dffffc0000000000
R13: ffff88806573b503 R14: dffffc0000000000 R15: ffff8880663cca00
FS: 0000000000000000(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007fc90a747f98 CR3: 000000000e734000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 000000000000002b DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
Call Trace:
<NMI>
</NMI>
<TASK>
\_\_local\_bh\_enable\_ip+0x1bb/0x200 kernel/softirq.c:382
spin\_unlock\_bh include/linux/spinlock.h:396 [inline]
nsim\_dev\_trap\_report drivers/net/netdevsim/dev.c:820 [inline]
nsim\_dev\_trap\_report\_work+0x75d/0xaa0 drivers/net/netdevsim/dev.c:850
process\_one\_work kernel/workqueue.c:3229 [inline]
process\_scheduled\_works+0xa63/0x1850 kernel/workqueue.c:3310
worker\_thread+0x870/0xd30 kernel/workqueue.c:3391
kthread+0x2f0/0x390 kernel/kthread.c:389
ret\_from\_fork+0x4b/0x80 arch/x86/kernel/process.c:147
ret\_from\_fork\_asm+0x1a/0x30 arch/x86/entry/entry\_64.S:244
</TASK>
Fixes: ba5e1272142d ("netdevsim: avoid potential loop in nsim\_dev\_trap\_report\_work()")
Reported-by: syzbot+d383dc9579a76f56c251@syzkaller.appspotmail.com
Reported-by: syzbot+c596faae21a68bf7afd0@syzkaller.appspotmail.com
Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Jiri Pirko <jiri@nvidia.com>
Link: [https://patch.msgid.link/20241012094230.3893510-1-edumazet@google.com](https://patch.msgid.link/20241012094230.3893510-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3)

| -rw-r--r-- | [drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/netdevsim/dev.c?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3) | 15 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 6 deletions

| diff --git a/drivers/net/netdevsim/dev.c b/drivers/net/netdevsim/dev.cindex 92a7a36b93ac0c..3e0b61202f0c98 100644--- a/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=268446b40bb144f777ae962b5d9e053b2eeab5ad)+++ b/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=681ce79ab6fba2f8d1c5ea60239f0086baebd0d3)@@ -836,7 +836,8 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) nsim\_dev = nsim\_trap\_data->nsim\_dev;  if (!devl\_trylock(priv\_to\_devlink(nsim\_dev))) {- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw, 1);+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw, 1); return; } @@ -848,11 +849,12 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) continue;  nsim\_dev\_trap\_report(nsim\_dev\_port);+ cond\_resched(); } devl\_unlock(priv\_to\_devlink(nsim\_dev));-- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS)); }  static int nsim\_dev\_traps\_init(struct devlink \*devlink)@@ -907,8 +909,9 @@ static int nsim\_dev\_traps\_init(struct devlink \*devlink)  INIT\_DELAYED\_WORK(&nsim\_dev->trap\_data->trap\_report\_dw, nsim\_dev\_trap\_report\_work);- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));  return 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:22:25 +0000



=== Content from git.kernel.org_3d82b4e9_20250115_092347.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=24973f4b64f93232a48fe78029385de762a2418d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=24973f4b64f93232a48fe78029385de762a2418d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24973f4b64f93232a48fe78029385de762a2418d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24973f4b64f93232a48fe78029385de762a2418d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-10-12 09:42:30 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-01 01:55:59 +0100 |
| commit | [24973f4b64f93232a48fe78029385de762a2418d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=24973f4b64f93232a48fe78029385de762a2418d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=24973f4b64f93232a48fe78029385de762a2418d)) | |
| tree | [7e34ba1d46ce021c571d2b126bf81d6e08bfdf28](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=24973f4b64f93232a48fe78029385de762a2418d) | |
| parent | [36ee799f41506f2975c2806199ed06e4c210cb25](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=36ee799f41506f2975c2806199ed06e4c210cb25) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24973f4b64f93232a48fe78029385de762a2418d&id2=36ee799f41506f2975c2806199ed06e4c210cb25)) | |
| download | [linux-24973f4b64f93232a48fe78029385de762a2418d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-24973f4b64f93232a48fe78029385de762a2418d.tar.gz) | |

netdevsim: use cond\_resched() in nsim\_dev\_trap\_report\_work()[ Upstream commit a1494d532e28598bde7a5544892ef9c7dbfafa93 ]
I am still seeing many syzbot reports hinting that syzbot
might fool nsim\_dev\_trap\_report\_work() with hundreds of ports [1]
Lets use cond\_resched(), and system\_unbound\_wq
instead of implicit system\_wq.
[1]
INFO: task syz-executor:20633 blocked for more than 143 seconds.
Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
"echo 0 > /proc/sys/kernel/hung\_task\_timeout\_secs" disables this message.
task:syz-executor state:D stack:25856 pid:20633 tgid:20633 ppid:1 flags:0x00004006
...
NMI backtrace for cpu 1
CPU: 1 UID: 0 PID: 16760 Comm: kworker/1:0 Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
Workqueue: events nsim\_dev\_trap\_report\_work
RIP: 0010:\_\_sanitizer\_cov\_trace\_pc+0x0/0x70 kernel/kcov.c:210
Code: 89 fb e8 23 00 00 00 48 8b 3d 04 fb 9c 0c 48 89 de 5b e9 c3 c7 5d 00 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 <f3> 0f 1e fa 48 8b 04 24 65 48 8b 0c 25 c0 d7 03 00 65 8b 15 60 f0
RSP: 0018:ffffc90000a187e8 EFLAGS: 00000246
RAX: 0000000000000100 RBX: ffffc90000a188e0 RCX: ffff888027d3bc00
RDX: ffff888027d3bc00 RSI: 0000000000000000 RDI: 0000000000000000
RBP: ffff88804a2e6000 R08: ffffffff8a4bc495 R09: ffffffff89da3577
R10: 0000000000000004 R11: ffffffff8a4bc2b0 R12: dffffc0000000000
R13: ffff88806573b503 R14: dffffc0000000000 R15: ffff8880663cca00
FS: 0000000000000000(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007fc90a747f98 CR3: 000000000e734000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 000000000000002b DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
Call Trace:
<NMI>
</NMI>
<TASK>
\_\_local\_bh\_enable\_ip+0x1bb/0x200 kernel/softirq.c:382
spin\_unlock\_bh include/linux/spinlock.h:396 [inline]
nsim\_dev\_trap\_report drivers/net/netdevsim/dev.c:820 [inline]
nsim\_dev\_trap\_report\_work+0x75d/0xaa0 drivers/net/netdevsim/dev.c:850
process\_one\_work kernel/workqueue.c:3229 [inline]
process\_scheduled\_works+0xa63/0x1850 kernel/workqueue.c:3310
worker\_thread+0x870/0xd30 kernel/workqueue.c:3391
kthread+0x2f0/0x390 kernel/kthread.c:389
ret\_from\_fork+0x4b/0x80 arch/x86/kernel/process.c:147
ret\_from\_fork\_asm+0x1a/0x30 arch/x86/entry/entry\_64.S:244
</TASK>
Fixes: ba5e1272142d ("netdevsim: avoid potential loop in nsim\_dev\_trap\_report\_work()")
Reported-by: syzbot+d383dc9579a76f56c251@syzkaller.appspotmail.com
Reported-by: syzbot+c596faae21a68bf7afd0@syzkaller.appspotmail.com
Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Jiri Pirko <jiri@nvidia.com>
Link: [https://patch.msgid.link/20241012094230.3893510-1-edumazet@google.com](https://patch.msgid.link/20241012094230.3893510-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=24973f4b64f93232a48fe78029385de762a2418d)

| -rw-r--r-- | [drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/netdevsim/dev.c?id=24973f4b64f93232a48fe78029385de762a2418d) | 15 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 6 deletions

| diff --git a/drivers/net/netdevsim/dev.c b/drivers/net/netdevsim/dev.cindex f3fa4bd121169e..cdf7a70d66591c 100644--- a/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=36ee799f41506f2975c2806199ed06e4c210cb25)+++ b/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=24973f4b64f93232a48fe78029385de762a2418d)@@ -836,7 +836,8 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) nsim\_dev = nsim\_trap\_data->nsim\_dev;  if (!devl\_trylock(priv\_to\_devlink(nsim\_dev))) {- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw, 1);+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw, 1); return; } @@ -848,11 +849,12 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) continue;  nsim\_dev\_trap\_report(nsim\_dev\_port);+ cond\_resched(); } devl\_unlock(priv\_to\_devlink(nsim\_dev));-- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS)); }  static int nsim\_dev\_traps\_init(struct devlink \*devlink)@@ -907,8 +909,9 @@ static int nsim\_dev\_traps\_init(struct devlink \*devlink)  INIT\_DELAYED\_WORK(&nsim\_dev->trap\_data->trap\_report\_dw, nsim\_dev\_trap\_report\_work);- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));  return 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:22:24 +0000



=== Content from git.kernel.org_b96931de_20250115_092349.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-10-12 09:42:30 +0000 |
| --- | --- | --- |
| committer | Jakub Kicinski <kuba@kernel.org> | 2024-10-15 09:58:43 -0700 |
| commit | [a1494d532e28598bde7a5544892ef9c7dbfafa93](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93)) | |
| tree | [2743d25f257581dc12b475b170d1539139f41b3c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93) | |
| parent | [cf58aefb1332db322060cad4a330d5f9292b0f41](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cf58aefb1332db322060cad4a330d5f9292b0f41) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93&id2=cf58aefb1332db322060cad4a330d5f9292b0f41)) | |
| download | [linux-a1494d532e28598bde7a5544892ef9c7dbfafa93.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a1494d532e28598bde7a5544892ef9c7dbfafa93.tar.gz) | |

netdevsim: use cond\_resched() in nsim\_dev\_trap\_report\_work()I am still seeing many syzbot reports hinting that syzbot
might fool nsim\_dev\_trap\_report\_work() with hundreds of ports [1]
Lets use cond\_resched(), and system\_unbound\_wq
instead of implicit system\_wq.
[1]
INFO: task syz-executor:20633 blocked for more than 143 seconds.
Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
"echo 0 > /proc/sys/kernel/hung\_task\_timeout\_secs" disables this message.
task:syz-executor state:D stack:25856 pid:20633 tgid:20633 ppid:1 flags:0x00004006
...
NMI backtrace for cpu 1
CPU: 1 UID: 0 PID: 16760 Comm: kworker/1:0 Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
Workqueue: events nsim\_dev\_trap\_report\_work
RIP: 0010:\_\_sanitizer\_cov\_trace\_pc+0x0/0x70 kernel/kcov.c:210
Code: 89 fb e8 23 00 00 00 48 8b 3d 04 fb 9c 0c 48 89 de 5b e9 c3 c7 5d 00 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 <f3> 0f 1e fa 48 8b 04 24 65 48 8b 0c 25 c0 d7 03 00 65 8b 15 60 f0
RSP: 0018:ffffc90000a187e8 EFLAGS: 00000246
RAX: 0000000000000100 RBX: ffffc90000a188e0 RCX: ffff888027d3bc00
RDX: ffff888027d3bc00 RSI: 0000000000000000 RDI: 0000000000000000
RBP: ffff88804a2e6000 R08: ffffffff8a4bc495 R09: ffffffff89da3577
R10: 0000000000000004 R11: ffffffff8a4bc2b0 R12: dffffc0000000000
R13: ffff88806573b503 R14: dffffc0000000000 R15: ffff8880663cca00
FS: 0000000000000000(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007fc90a747f98 CR3: 000000000e734000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 000000000000002b DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
Call Trace:
<NMI>
</NMI>
<TASK>
\_\_local\_bh\_enable\_ip+0x1bb/0x200 kernel/softirq.c:382
spin\_unlock\_bh include/linux/spinlock.h:396 [inline]
nsim\_dev\_trap\_report drivers/net/netdevsim/dev.c:820 [inline]
nsim\_dev\_trap\_report\_work+0x75d/0xaa0 drivers/net/netdevsim/dev.c:850
process\_one\_work kernel/workqueue.c:3229 [inline]
process\_scheduled\_works+0xa63/0x1850 kernel/workqueue.c:3310
worker\_thread+0x870/0xd30 kernel/workqueue.c:3391
kthread+0x2f0/0x390 kernel/kthread.c:389
ret\_from\_fork+0x4b/0x80 arch/x86/kernel/process.c:147
ret\_from\_fork\_asm+0x1a/0x30 arch/x86/entry/entry\_64.S:244
</TASK>
Fixes: ba5e1272142d ("netdevsim: avoid potential loop in nsim\_dev\_trap\_report\_work()")
Reported-by: syzbot+d383dc9579a76f56c251@syzkaller.appspotmail.com
Reported-by: syzbot+c596faae21a68bf7afd0@syzkaller.appspotmail.com
Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Jiri Pirko <jiri@nvidia.com>
Link: [https://patch.msgid.link/20241012094230.3893510-1-edumazet@google.com](https://patch.msgid.link/20241012094230.3893510-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a1494d532e28598bde7a5544892ef9c7dbfafa93)

| -rw-r--r-- | [drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/netdevsim/dev.c?id=a1494d532e28598bde7a5544892ef9c7dbfafa93) | 15 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 6 deletions

| diff --git a/drivers/net/netdevsim/dev.c b/drivers/net/netdevsim/dev.cindex 92a7a36b93ac0c..3e0b61202f0c98 100644--- a/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=cf58aefb1332db322060cad4a330d5f9292b0f41)+++ b/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=a1494d532e28598bde7a5544892ef9c7dbfafa93)@@ -836,7 +836,8 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) nsim\_dev = nsim\_trap\_data->nsim\_dev;  if (!devl\_trylock(priv\_to\_devlink(nsim\_dev))) {- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw, 1);+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw, 1); return; } @@ -848,11 +849,12 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) continue;  nsim\_dev\_trap\_report(nsim\_dev\_port);+ cond\_resched(); } devl\_unlock(priv\_to\_devlink(nsim\_dev));-- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS)); }  static int nsim\_dev\_traps\_init(struct devlink \*devlink)@@ -907,8 +909,9 @@ static int nsim\_dev\_traps\_init(struct devlink \*devlink)  INIT\_DELAYED\_WORK(&nsim\_dev->trap\_data->trap\_report\_dw, nsim\_dev\_trap\_report\_work);- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));  return 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:22:26 +0000



=== Content from git.kernel.org_f5cbc268_20250115_092348.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Eric Dumazet <edumazet@google.com> | 2024-10-12 09:42:30 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-01 02:02:28 +0100 |
| commit | [32f054f93937b548c61b3bf57d8f4aefc50f3b16](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16)) | |
| tree | [7d61dcf03e65e4592d2a47bc3fa2e2247a46acd5](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16) | |
| parent | [7c4164d8db9baad1d1d09cf8620adf263f546aaf](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7c4164d8db9baad1d1d09cf8620adf263f546aaf) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16&id2=7c4164d8db9baad1d1d09cf8620adf263f546aaf)) | |
| download | [linux-32f054f93937b548c61b3bf57d8f4aefc50f3b16.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-32f054f93937b548c61b3bf57d8f4aefc50f3b16.tar.gz) | |

netdevsim: use cond\_resched() in nsim\_dev\_trap\_report\_work()[ Upstream commit a1494d532e28598bde7a5544892ef9c7dbfafa93 ]
I am still seeing many syzbot reports hinting that syzbot
might fool nsim\_dev\_trap\_report\_work() with hundreds of ports [1]
Lets use cond\_resched(), and system\_unbound\_wq
instead of implicit system\_wq.
[1]
INFO: task syz-executor:20633 blocked for more than 143 seconds.
Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
"echo 0 > /proc/sys/kernel/hung\_task\_timeout\_secs" disables this message.
task:syz-executor state:D stack:25856 pid:20633 tgid:20633 ppid:1 flags:0x00004006
...
NMI backtrace for cpu 1
CPU: 1 UID: 0 PID: 16760 Comm: kworker/1:0 Not tainted 6.12.0-rc2-syzkaller-00205-g1d227fcc7222 #0
Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS Google 09/13/2024
Workqueue: events nsim\_dev\_trap\_report\_work
RIP: 0010:\_\_sanitizer\_cov\_trace\_pc+0x0/0x70 kernel/kcov.c:210
Code: 89 fb e8 23 00 00 00 48 8b 3d 04 fb 9c 0c 48 89 de 5b e9 c3 c7 5d 00 0f 1f 00 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 <f3> 0f 1e fa 48 8b 04 24 65 48 8b 0c 25 c0 d7 03 00 65 8b 15 60 f0
RSP: 0018:ffffc90000a187e8 EFLAGS: 00000246
RAX: 0000000000000100 RBX: ffffc90000a188e0 RCX: ffff888027d3bc00
RDX: ffff888027d3bc00 RSI: 0000000000000000 RDI: 0000000000000000
RBP: ffff88804a2e6000 R08: ffffffff8a4bc495 R09: ffffffff89da3577
R10: 0000000000000004 R11: ffffffff8a4bc2b0 R12: dffffc0000000000
R13: ffff88806573b503 R14: dffffc0000000000 R15: ffff8880663cca00
FS: 0000000000000000(0000) GS:ffff8880b8700000(0000) knlGS:0000000000000000
CS: 0010 DS: 0000 ES: 0000 CR0: 0000000080050033
CR2: 00007fc90a747f98 CR3: 000000000e734000 CR4: 00000000003526f0
DR0: 0000000000000000 DR1: 000000000000002b DR2: 0000000000000000
DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400
Call Trace:
<NMI>
</NMI>
<TASK>
\_\_local\_bh\_enable\_ip+0x1bb/0x200 kernel/softirq.c:382
spin\_unlock\_bh include/linux/spinlock.h:396 [inline]
nsim\_dev\_trap\_report drivers/net/netdevsim/dev.c:820 [inline]
nsim\_dev\_trap\_report\_work+0x75d/0xaa0 drivers/net/netdevsim/dev.c:850
process\_one\_work kernel/workqueue.c:3229 [inline]
process\_scheduled\_works+0xa63/0x1850 kernel/workqueue.c:3310
worker\_thread+0x870/0xd30 kernel/workqueue.c:3391
kthread+0x2f0/0x390 kernel/kthread.c:389
ret\_from\_fork+0x4b/0x80 arch/x86/kernel/process.c:147
ret\_from\_fork\_asm+0x1a/0x30 arch/x86/entry/entry\_64.S:244
</TASK>
Fixes: ba5e1272142d ("netdevsim: avoid potential loop in nsim\_dev\_trap\_report\_work()")
Reported-by: syzbot+d383dc9579a76f56c251@syzkaller.appspotmail.com
Reported-by: syzbot+c596faae21a68bf7afd0@syzkaller.appspotmail.com
Signed-off-by: Eric Dumazet <edumazet@google.com>
Cc: Jiri Pirko <jiri@nvidia.com>
Link: [https://patch.msgid.link/20241012094230.3893510-1-edumazet@google.com](https://patch.msgid.link/20241012094230.3893510-1-edumazet%40google.com)
Signed-off-by: Jakub Kicinski <kuba@kernel.org>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16)

| -rw-r--r-- | [drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/netdevsim/dev.c?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16) | 15 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 9 insertions, 6 deletions

| diff --git a/drivers/net/netdevsim/dev.c b/drivers/net/netdevsim/dev.cindex 92a7a36b93ac0c..3e0b61202f0c98 100644--- a/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=7c4164d8db9baad1d1d09cf8620adf263f546aaf)+++ b/[drivers/net/netdevsim/dev.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/netdevsim/dev.c?id=32f054f93937b548c61b3bf57d8f4aefc50f3b16)@@ -836,7 +836,8 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) nsim\_dev = nsim\_trap\_data->nsim\_dev;  if (!devl\_trylock(priv\_to\_devlink(nsim\_dev))) {- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw, 1);+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw, 1); return; } @@ -848,11 +849,12 @@ static void nsim\_dev\_trap\_report\_work(struct work\_struct \*work) continue;  nsim\_dev\_trap\_report(nsim\_dev\_port);+ cond\_resched(); } devl\_unlock(priv\_to\_devlink(nsim\_dev));-- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS)); }  static int nsim\_dev\_traps\_init(struct devlink \*devlink)@@ -907,8 +909,9 @@ static int nsim\_dev\_traps\_init(struct devlink \*devlink)  INIT\_DELAYED\_WORK(&nsim\_dev->trap\_data->trap\_report\_dw, nsim\_dev\_trap\_report\_work);- schedule\_delayed\_work(&nsim\_dev->trap\_data->trap\_report\_dw,- msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));+ queue\_delayed\_work(system\_unbound\_wq,+ &nsim\_dev->trap\_data->trap\_report\_dw,+ msecs\_to\_jiffies(NSIM\_TRAP\_REPORT\_INTERVAL\_MS));  return 0; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-15 09:22:25 +0000


