=== Content from git.kernel.org_e474174f_20250114_183808.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=227358e89703c344008119be7e8ffa3fdb5b92de)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=227358e89703c344008119be7e8ffa3fdb5b92de)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=227358e89703c344008119be7e8ffa3fdb5b92de)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=227358e89703c344008119be7e8ffa3fdb5b92de)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pawan Gupta <pawan.kumar.gupta@linux.intel.com> | 2024-09-25 15:25:44 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:46:34 +0200 |
| commit | [227358e89703c344008119be7e8ffa3fdb5b92de](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=227358e89703c344008119be7e8ffa3fdb5b92de) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=227358e89703c344008119be7e8ffa3fdb5b92de)) | |
| tree | [9c8728a9bc5f1484194d7461529b84ad16f142da](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=227358e89703c344008119be7e8ffa3fdb5b92de) | |
| parent | [0c6a7e2c6012cee8273f2b7c1a335a609f8a73b7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0c6a7e2c6012cee8273f2b7c1a335a609f8a73b7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=227358e89703c344008119be7e8ffa3fdb5b92de&id2=0c6a7e2c6012cee8273f2b7c1a335a609f8a73b7)) | |
| download | [linux-227358e89703c344008119be7e8ffa3fdb5b92de.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-227358e89703c344008119be7e8ffa3fdb5b92de.tar.gz) | |

x86/entry\_32: Clear CPU buffers after register restore in NMI returncommit 48a2440d0f20c826b884e04377ccc1e4696c84e9 upstream.
CPU buffers are currently cleared after call to exc\_nmi, but before
register state is restored. This may be okay for MDS mitigation but not for
RDFS. Because RDFS mitigation requires CPU buffers to be cleared when
registers don't have any sensitive data.
Move CLEAR\_CPU\_BUFFERS after RESTORE\_ALL\_NMI.
Fixes: a0e2dab44d22 ("x86/entry\_32: Add VERW just before userspace transition")
Suggested-by: Dave Hansen <dave.hansen@linux.intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
Cc:stable@vger.kernel.org
Link: <https://lore.kernel.org/all/20240925-fix-dosemu-vm86-v7-2-1de0daca2d42%40linux.intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=227358e89703c344008119be7e8ffa3fdb5b92de)

| -rw-r--r-- | [arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/entry/entry_32.S?id=227358e89703c344008119be7e8ffa3fdb5b92de) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/arch/x86/entry/entry\_32.S b/arch/x86/entry/entry\_32.Sindex 7722a1a1a8ae2c..3894acc54b79c4 100644--- a/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=0c6a7e2c6012cee8273f2b7c1a335a609f8a73b7)+++ b/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=227358e89703c344008119be7e8ffa3fdb5b92de)@@ -1149,7 +1149,6 @@ SYM\_CODE\_START(asm\_exc\_nmi)  /\* Not on SYSENTER stack. \*/ call exc\_nmi- CLEAR\_CPU\_BUFFERS jmp .Lnmi\_return  .Lnmi\_from\_sysenter\_stack:@@ -1170,6 +1169,7 @@ SYM\_CODE\_START(asm\_exc\_nmi)  CHECK\_AND\_APPLY\_ESPFIX RESTORE\_ALL\_NMI cr3\_reg=%edi pop=4+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return  #ifdef CONFIG\_X86\_ESPFIX32@@ -1211,6 +1211,7 @@ SYM\_CODE\_START(asm\_exc\_nmi) \* 1 - orig\_ax \*/ lss (1+5+6)\*4(%esp), %esp # back to espfix stack+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return #endif SYM\_CODE\_END(asm\_exc\_nmi) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:36:45 +0000



=== Content from git.kernel.org_77788125_20250114_183809.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=43778de19d2ef129636815274644b9c16e78c66b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=43778de19d2ef129636815274644b9c16e78c66b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=43778de19d2ef129636815274644b9c16e78c66b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=43778de19d2ef129636815274644b9c16e78c66b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pawan Gupta <pawan.kumar.gupta@linux.intel.com> | 2024-09-25 15:25:44 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:56:50 +0200 |
| commit | [43778de19d2ef129636815274644b9c16e78c66b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=43778de19d2ef129636815274644b9c16e78c66b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=43778de19d2ef129636815274644b9c16e78c66b)) | |
| tree | [8a4f77672824cf8af0b4ccec45636d99981c1c85](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=43778de19d2ef129636815274644b9c16e78c66b) | |
| parent | [7f06caaae0cc0cde3e511c6b5e8b48142b54a60d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7f06caaae0cc0cde3e511c6b5e8b48142b54a60d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=43778de19d2ef129636815274644b9c16e78c66b&id2=7f06caaae0cc0cde3e511c6b5e8b48142b54a60d)) | |
| download | [linux-43778de19d2ef129636815274644b9c16e78c66b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-43778de19d2ef129636815274644b9c16e78c66b.tar.gz) | |

x86/entry\_32: Clear CPU buffers after register restore in NMI returncommit 48a2440d0f20c826b884e04377ccc1e4696c84e9 upstream.
CPU buffers are currently cleared after call to exc\_nmi, but before
register state is restored. This may be okay for MDS mitigation but not for
RDFS. Because RDFS mitigation requires CPU buffers to be cleared when
registers don't have any sensitive data.
Move CLEAR\_CPU\_BUFFERS after RESTORE\_ALL\_NMI.
Fixes: a0e2dab44d22 ("x86/entry\_32: Add VERW just before userspace transition")
Suggested-by: Dave Hansen <dave.hansen@linux.intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
Cc:stable@vger.kernel.org
Link: <https://lore.kernel.org/all/20240925-fix-dosemu-vm86-v7-2-1de0daca2d42%40linux.intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=43778de19d2ef129636815274644b9c16e78c66b)

| -rw-r--r-- | [arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/entry/entry_32.S?id=43778de19d2ef129636815274644b9c16e78c66b) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/arch/x86/entry/entry\_32.S b/arch/x86/entry/entry\_32.Sindex 2ecb45160a0752..475ce40401ec9b 100644--- a/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=7f06caaae0cc0cde3e511c6b5e8b48142b54a60d)+++ b/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=43778de19d2ef129636815274644b9c16e78c66b)@@ -1176,7 +1176,6 @@ SYM\_CODE\_START(asm\_exc\_nmi)  /\* Not on SYSENTER stack. \*/ call exc\_nmi- CLEAR\_CPU\_BUFFERS jmp .Lnmi\_return  .Lnmi\_from\_sysenter\_stack:@@ -1197,6 +1196,7 @@ SYM\_CODE\_START(asm\_exc\_nmi)  CHECK\_AND\_APPLY\_ESPFIX RESTORE\_ALL\_NMI cr3\_reg=%edi pop=4+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return  #ifdef CONFIG\_X86\_ESPFIX32@@ -1238,6 +1238,7 @@ SYM\_CODE\_START(asm\_exc\_nmi) \* 1 - orig\_ax \*/ lss (1+5+6)\*4(%esp), %esp # back to espfix stack+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return #endif SYM\_CODE\_END(asm\_exc\_nmi) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:36:46 +0000



=== Content from git.kernel.org_4424a19c_20250114_183810.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pawan Gupta <pawan.kumar.gupta@linux.intel.com> | 2024-09-25 15:25:44 -0700 |
| --- | --- | --- |
| committer | Dave Hansen <dave.hansen@linux.intel.com> | 2024-10-08 15:16:28 -0700 |
| commit | [48a2440d0f20c826b884e04377ccc1e4696c84e9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9)) | |
| tree | [395e54f3197e32ca370f7fe8b3a698e89d8162f7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9) | |
| parent | [2e2e5143d4868163d6756c8c6a4d28cbfa5245e5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2e2e5143d4868163d6756c8c6a4d28cbfa5245e5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9&id2=2e2e5143d4868163d6756c8c6a4d28cbfa5245e5)) | |
| download | [linux-48a2440d0f20c826b884e04377ccc1e4696c84e9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-48a2440d0f20c826b884e04377ccc1e4696c84e9.tar.gz) | |

x86/entry\_32: Clear CPU buffers after register restore in NMI returnCPU buffers are currently cleared after call to exc\_nmi, but before
register state is restored. This may be okay for MDS mitigation but not for
RDFS. Because RDFS mitigation requires CPU buffers to be cleared when
registers don't have any sensitive data.
Move CLEAR\_CPU\_BUFFERS after RESTORE\_ALL\_NMI.
Fixes: a0e2dab44d22 ("x86/entry\_32: Add VERW just before userspace transition")
Suggested-by: Dave Hansen <dave.hansen@linux.intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
Cc:stable@vger.kernel.org
Link: <https://lore.kernel.org/all/20240925-fix-dosemu-vm86-v7-2-1de0daca2d42%40linux.intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=48a2440d0f20c826b884e04377ccc1e4696c84e9)

| -rw-r--r-- | [arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/entry/entry_32.S?id=48a2440d0f20c826b884e04377ccc1e4696c84e9) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/arch/x86/entry/entry\_32.S b/arch/x86/entry/entry\_32.Sindex 9ad6cd89b7acfc..20be5758c2d2e2 100644--- a/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=2e2e5143d4868163d6756c8c6a4d28cbfa5245e5)+++ b/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=48a2440d0f20c826b884e04377ccc1e4696c84e9)@@ -1145,7 +1145,6 @@ SYM\_CODE\_START(asm\_exc\_nmi)  /\* Not on SYSENTER stack. \*/ call exc\_nmi- CLEAR\_CPU\_BUFFERS jmp .Lnmi\_return  .Lnmi\_from\_sysenter\_stack:@@ -1166,6 +1165,7 @@ SYM\_CODE\_START(asm\_exc\_nmi)  CHECK\_AND\_APPLY\_ESPFIX RESTORE\_ALL\_NMI cr3\_reg=%edi pop=4+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return  #ifdef CONFIG\_X86\_ESPFIX32@@ -1207,6 +1207,7 @@ SYM\_CODE\_START(asm\_exc\_nmi) \* 1 - orig\_ax \*/ lss (1+5+6)\*4(%esp), %esp # back to espfix stack+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return #endif SYM\_CODE\_END(asm\_exc\_nmi) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:36:47 +0000



=== Content from git.kernel.org_2205c487_20250114_183811.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=64adf22c4bc73ede920baca5defefb70f190cdbc)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=64adf22c4bc73ede920baca5defefb70f190cdbc)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=64adf22c4bc73ede920baca5defefb70f190cdbc)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=64adf22c4bc73ede920baca5defefb70f190cdbc)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pawan Gupta <pawan.kumar.gupta@linux.intel.com> | 2024-09-25 15:25:44 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:51:34 +0200 |
| commit | [64adf22c4bc73ede920baca5defefb70f190cdbc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=64adf22c4bc73ede920baca5defefb70f190cdbc) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=64adf22c4bc73ede920baca5defefb70f190cdbc)) | |
| tree | [3f9a62a68696ed47565e8f314fb42c581fea0236](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=64adf22c4bc73ede920baca5defefb70f190cdbc) | |
| parent | [8a9e3d70bc97ac9bca7d28965ccff285085bf126](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8a9e3d70bc97ac9bca7d28965ccff285085bf126) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=64adf22c4bc73ede920baca5defefb70f190cdbc&id2=8a9e3d70bc97ac9bca7d28965ccff285085bf126)) | |
| download | [linux-64adf22c4bc73ede920baca5defefb70f190cdbc.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-64adf22c4bc73ede920baca5defefb70f190cdbc.tar.gz) | |

x86/entry\_32: Clear CPU buffers after register restore in NMI returncommit 48a2440d0f20c826b884e04377ccc1e4696c84e9 upstream.
CPU buffers are currently cleared after call to exc\_nmi, but before
register state is restored. This may be okay for MDS mitigation but not for
RDFS. Because RDFS mitigation requires CPU buffers to be cleared when
registers don't have any sensitive data.
Move CLEAR\_CPU\_BUFFERS after RESTORE\_ALL\_NMI.
Fixes: a0e2dab44d22 ("x86/entry\_32: Add VERW just before userspace transition")
Suggested-by: Dave Hansen <dave.hansen@linux.intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
Cc:stable@vger.kernel.org
Link: <https://lore.kernel.org/all/20240925-fix-dosemu-vm86-v7-2-1de0daca2d42%40linux.intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=64adf22c4bc73ede920baca5defefb70f190cdbc)

| -rw-r--r-- | [arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/entry/entry_32.S?id=64adf22c4bc73ede920baca5defefb70f190cdbc) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/arch/x86/entry/entry\_32.S b/arch/x86/entry/entry\_32.Sindex 9ad6cd89b7acfc..20be5758c2d2e2 100644--- a/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=8a9e3d70bc97ac9bca7d28965ccff285085bf126)+++ b/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=64adf22c4bc73ede920baca5defefb70f190cdbc)@@ -1145,7 +1145,6 @@ SYM\_CODE\_START(asm\_exc\_nmi)  /\* Not on SYSENTER stack. \*/ call exc\_nmi- CLEAR\_CPU\_BUFFERS jmp .Lnmi\_return  .Lnmi\_from\_sysenter\_stack:@@ -1166,6 +1165,7 @@ SYM\_CODE\_START(asm\_exc\_nmi)  CHECK\_AND\_APPLY\_ESPFIX RESTORE\_ALL\_NMI cr3\_reg=%edi pop=4+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return  #ifdef CONFIG\_X86\_ESPFIX32@@ -1207,6 +1207,7 @@ SYM\_CODE\_START(asm\_exc\_nmi) \* 1 - orig\_ax \*/ lss (1+5+6)\*4(%esp), %esp # back to espfix stack+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return #endif SYM\_CODE\_END(asm\_exc\_nmi) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:36:48 +0000



=== Content from git.kernel.org_c5f0f6ae_20250114_183811.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pawan Gupta <pawan.kumar.gupta@linux.intel.com> | 2024-09-25 15:25:44 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:39:29 +0200 |
| commit | [6f44a5fc15b5cece0785bc07453db77d99b0a6de](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de)) | |
| tree | [f058aa6425eec5c676ef3b6cd22aa5e1bdd51ded](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de) | |
| parent | [9ab38a1cdb66b10688e07c6eea0b23e913168de1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9ab38a1cdb66b10688e07c6eea0b23e913168de1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de&id2=9ab38a1cdb66b10688e07c6eea0b23e913168de1)) | |
| download | [linux-6f44a5fc15b5cece0785bc07453db77d99b0a6de.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6f44a5fc15b5cece0785bc07453db77d99b0a6de.tar.gz) | |

x86/entry\_32: Clear CPU buffers after register restore in NMI returncommit 48a2440d0f20c826b884e04377ccc1e4696c84e9 upstream.
CPU buffers are currently cleared after call to exc\_nmi, but before
register state is restored. This may be okay for MDS mitigation but not for
RDFS. Because RDFS mitigation requires CPU buffers to be cleared when
registers don't have any sensitive data.
Move CLEAR\_CPU\_BUFFERS after RESTORE\_ALL\_NMI.
Fixes: a0e2dab44d22 ("x86/entry\_32: Add VERW just before userspace transition")
Suggested-by: Dave Hansen <dave.hansen@linux.intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
Cc:stable@vger.kernel.org
Link: <https://lore.kernel.org/all/20240925-fix-dosemu-vm86-v7-2-1de0daca2d42%40linux.intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de)

| -rw-r--r-- | [arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/entry/entry_32.S?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/arch/x86/entry/entry\_32.S b/arch/x86/entry/entry\_32.Sindex 27d5582600aec5..c524aa3f094ab7 100644--- a/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=9ab38a1cdb66b10688e07c6eea0b23e913168de1)+++ b/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=6f44a5fc15b5cece0785bc07453db77d99b0a6de)@@ -1222,7 +1222,6 @@ SYM\_CODE\_START(asm\_exc\_nmi)  /\* Not on SYSENTER stack. \*/ call exc\_nmi- CLEAR\_CPU\_BUFFERS jmp .Lnmi\_return  .Lnmi\_from\_sysenter\_stack:@@ -1243,6 +1242,7 @@ SYM\_CODE\_START(asm\_exc\_nmi)  CHECK\_AND\_APPLY\_ESPFIX RESTORE\_ALL\_NMI cr3\_reg=%edi pop=4+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return  #ifdef CONFIG\_X86\_ESPFIX32@@ -1284,6 +1284,7 @@ SYM\_CODE\_START(asm\_exc\_nmi) \* 1 - orig\_ax \*/ lss (1+5+6)\*4(%esp), %esp # back to espfix stack+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return #endif SYM\_CODE\_END(asm\_exc\_nmi) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:36:48 +0000



=== Content from git.kernel.org_047df4df_20250114_183812.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b6400eb0b347821efc57760221f8fb6d63b9548a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b6400eb0b347821efc57760221f8fb6d63b9548a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b6400eb0b347821efc57760221f8fb6d63b9548a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b6400eb0b347821efc57760221f8fb6d63b9548a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Pawan Gupta <pawan.kumar.gupta@linux.intel.com> | 2024-09-25 15:25:44 -0700 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-22 15:40:46 +0200 |
| commit | [b6400eb0b347821efc57760221f8fb6d63b9548a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b6400eb0b347821efc57760221f8fb6d63b9548a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b6400eb0b347821efc57760221f8fb6d63b9548a)) | |
| tree | [839c7346ae717ba2ee4c354ff155e84d88948f06](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b6400eb0b347821efc57760221f8fb6d63b9548a) | |
| parent | [a6f4701f8dcf0690ecff35a39f2f4a382b1b29cc](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a6f4701f8dcf0690ecff35a39f2f4a382b1b29cc) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b6400eb0b347821efc57760221f8fb6d63b9548a&id2=a6f4701f8dcf0690ecff35a39f2f4a382b1b29cc)) | |
| download | [linux-b6400eb0b347821efc57760221f8fb6d63b9548a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b6400eb0b347821efc57760221f8fb6d63b9548a.tar.gz) | |

x86/entry\_32: Clear CPU buffers after register restore in NMI returncommit 48a2440d0f20c826b884e04377ccc1e4696c84e9 upstream.
CPU buffers are currently cleared after call to exc\_nmi, but before
register state is restored. This may be okay for MDS mitigation but not for
RDFS. Because RDFS mitigation requires CPU buffers to be cleared when
registers don't have any sensitive data.
Move CLEAR\_CPU\_BUFFERS after RESTORE\_ALL\_NMI.
Fixes: a0e2dab44d22 ("x86/entry\_32: Add VERW just before userspace transition")
Suggested-by: Dave Hansen <dave.hansen@linux.intel.com>
Signed-off-by: Pawan Gupta <pawan.kumar.gupta@linux.intel.com>
Signed-off-by: Dave Hansen <dave.hansen@linux.intel.com>
Cc:stable@vger.kernel.org
Link: <https://lore.kernel.org/all/20240925-fix-dosemu-vm86-v7-2-1de0daca2d42%40linux.intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b6400eb0b347821efc57760221f8fb6d63b9548a)

| -rw-r--r-- | [arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/entry/entry_32.S?id=b6400eb0b347821efc57760221f8fb6d63b9548a) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 1 deletions

| diff --git a/arch/x86/entry/entry\_32.S b/arch/x86/entry/entry\_32.Sindex 2ecb45160a0752..475ce40401ec9b 100644--- a/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=a6f4701f8dcf0690ecff35a39f2f4a382b1b29cc)+++ b/[arch/x86/entry/entry\_32.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/entry/entry_32.S?id=b6400eb0b347821efc57760221f8fb6d63b9548a)@@ -1176,7 +1176,6 @@ SYM\_CODE\_START(asm\_exc\_nmi)  /\* Not on SYSENTER stack. \*/ call exc\_nmi- CLEAR\_CPU\_BUFFERS jmp .Lnmi\_return  .Lnmi\_from\_sysenter\_stack:@@ -1197,6 +1196,7 @@ SYM\_CODE\_START(asm\_exc\_nmi)  CHECK\_AND\_APPLY\_ESPFIX RESTORE\_ALL\_NMI cr3\_reg=%edi pop=4+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return  #ifdef CONFIG\_X86\_ESPFIX32@@ -1238,6 +1238,7 @@ SYM\_CODE\_START(asm\_exc\_nmi) \* 1 - orig\_ax \*/ lss (1+5+6)\*4(%esp), %esp # back to espfix stack+ CLEAR\_CPU\_BUFFERS jmp .Lirq\_return #endif SYM\_CODE\_END(asm\_exc\_nmi) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:36:49 +0000


