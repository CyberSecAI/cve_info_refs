=== Content from www.linkedin.com_23f77f95_20250115_112632.html ===


LinkedIn and 3rd parties use essential and non-essential cookies to provide, secure, analyze and improve our Services, and to show you relevant ads (including **professional and job ads**) on and off LinkedIn. Learn more in our [Cookie Policy](https://www.linkedin.com/legal/cookie-policy).

Select Accept to consent or Reject to decline non-essential cookies for this use. You can update your choices at any time in your [settings](https://www.linkedin.com/mypreferences/g/guest-cookies).

Accept

Reject

# Sign in

Stay updated on your professional world.

Email or phone

Password

Show

[Forgot password?](/checkpoint/rp/request-password-reset?session_redirect=https%3A%2F%2Fwww%2Elinkedin%2Ecom%2FshareArticle%3Fmini%3Dtrue%26url%3Dhttps%253A%252F%252Fg3tsyst3m%2Egithub%2Eio%252Fcve%252Fmsi%252FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%252F)

Keep me logged in

Sign in

or

By clicking Continue, you agree to LinkedInâ€™s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

Sign in with Apple

Sign in with a passkey

## Weâ€™ve emailed a one-time link to your primary email address

Click on the link to sign in instantly to your LinkedIn account.

If you donâ€™t see the email in your inbox, check your spam folder.

Resend email

Back

New to LinkedIn? [Join now](/signup/cold-join?session_redirect=https%3A%2F%2Fwww.linkedin.com%2FshareArticle%3Fmini%3Dtrue%26url%3Dhttps%253A%252F%252Fg3tsyst3m.github.io%252Fcve%252Fmsi%252FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%252F)

![](https://ponf.linkedin.com/pixel/tracking.png?reqid=95522aa6-fc0b-448c-97df-cfec849bb319&pageInstance=urn:li:page:checkpoint_lg_uasLogin;77Bi/2EzQfKtIjXh3ZIavA==&js=disabled)

Agree & Join LinkedIn

By clicking Continue, you agree to LinkedInâ€™s [User Agreement](/legal/user-agreement), [Privacy Policy](/legal/privacy-policy), and [Cookie Policy](/legal/cookie-policy).

*LinkedIn

Â© 2025*

* [User Agreement](/legal/user-agreement?trk=d_checkpoint_lg_consumerLogin_ft_user_agreement)
* [Privacy Policy](/legal/privacy-policy?trk=d_checkpoint_lg_consumerLogin_ft_privacy_policy)
* [Community Guidelines](/help/linkedin/answer/34593?lang=en&trk=d_checkpoint_lg_consumerLogin_ft_community_guidelines)
* [Cookie Policy](/legal/cookie-policy?trk=d_checkpoint_lg_consumerLogin_ft_cookie_policy)
* [Copyright Policy](/legal/copyright-policy?trk=d_checkpoint_lg_consumerLogin_ft_copyright_policy)
* [Send Feedback](/help/linkedin?trk=d_checkpoint_lg_consumerLogin_ft_send_feedback&lang=en)
* Language

  + Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© (Arabic)
  + à¦¬à¦¾à¦‚à¦²à¦¾ (Bangla)
  + ÄŒeÅ¡tina (Czech)
  + Dansk (Danish)
  + Deutsch (German)
  + Î•Î»Î»Î·Î½Î¹ÎºÎ¬ (Greek)
  + **English (English)**
  + EspaÃ±ol (Spanish)
  + ÙØ§Ø±Ø³ÛŒ (Persian)
  + Suomi (Finnish)
  + FranÃ§ais (French)
  + à¤¹à¤¿à¤‚à¤¦à¥€ (Hindi)
  + Magyar (Hungarian)
  + Bahasa Indonesia (Indonesian)
  + Italiano (Italian)
  + ×¢×‘×¨×™×ª (Hebrew)
  + æ—¥æœ¬èªž (Japanese)
  + í•œêµ­ì–´ (Korean)
  + à¤®à¤°à¤¾à¤ à¥€ (Marathi)
  + Bahasa Malaysia (Malay)
  + Nederlands (Dutch)
  + Norsk (Norwegian)
  + à¨ªà©°à¨œà¨¾à¨¬à©€ (Punjabi)
  + Polski (Polish)
  + PortuguÃªs (Portuguese)
  + RomÃ¢nÄƒ (Romanian)
  + Ð ÑƒÑÑÐºÐ¸Ð¹ (Russian)
  + Svenska (Swedish)
  + à°¤à±†à°²à±à°—à± (Telugu)
  + à¸ à¸²à¸©à¸²à¹„à¸—à¸¢ (Thai)
  + Tagalog (Tagalog)
  + TÃ¼rkÃ§e (Turkish)
  + Ð£ÐºÑ€Ð°Ñ—Ð½ÑÑŒÐºÐ° (Ukrainian)
  + Tiáº¿ng Viá»‡t (Vietnamese)
  + ç®€ä½“ä¸­æ–‡ (Chinese (Simplified))
  + æ­£é«”ä¸­æ–‡ (Chinese (Traditional))



=== Content from twitter.com_9807aaa2_20250115_112631.html ===



=== Content from www.facebook.com_e1afeb0a_20250115_112632.html ===

# [*Facebook*](https://www.facebook.com/ "Go to Facebook home")

| Email or phone | Password |
| --- | --- |
|  |  |  |
|  | [Forgot account?](https://www.facebook.com/recover/initiate?lwv=110&ars=royal_blue_bar) |

[Sign Up](/r.php?locale=en_US)
## Not Logged In

## Not Logged In

You are not logged in. Please login and try again.

* [Return home](/)

* English (US)
* [Gaeilge](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Irish")
* [Polski](https://ga-ie.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Polish")
* [LietuviÅ³](https://pl-pl.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Lithuanian")
* [PortuguÃªs (Brasil)](https://lt-lt.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Portuguese (Brazil)")
* [Ð ÑƒÑÑÐºÐ¸Ð¹](https://pt-br.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Russian")
* [RomÃ¢nÄƒ](https://ru-ru.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Romanian")
* [EspaÃ±ol](https://ro-ro.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Spanish")
* [FranÃ§ais (France)](https://es-la.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "French (France)")
* [Deutsch](https://fr-fr.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "German")
* [Italiano](https://de-de.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Italian")

* [Sign Up](/reg/ "Sign Up for Facebook")
* [Log In](/login/ "Log into Facebook")
* [Messenger](https://messenger.com/ "Check out Messenger.")
* [Facebook Lite](/lite/ "Facebook Lite for Android.")
* [Video](https://www.facebook.com/watch/ "Browse in Video")
* [Places](/places/ "Check out popular places on Facebook.")
* [Games](/games/ "Check out Facebook games.")
* [Marketplace](/marketplace/ "Buy and sell on Facebook Marketplace.")
* [Meta Pay](https://about.meta.com/technologies/meta-pay "Learn more about Meta Pay")
* [Meta Store](https://www.meta.com/ "Check out Meta")
* [Meta Quest](https://www.meta.com/quest/ "Learn more about Meta Quest")
* [Ray-Ban Meta](https://www.meta.com/smart-glasses/ "Learn more about Ray-Ban Meta")
* [Meta AI](https://www.meta.ai/ "Meta AI")
* [Instagram](https://l.facebook.com/l.php?u=https%3A%2F%2Fwww.instagram.com%2F&h=AT1Bnlbhaxakznj39hQ6AAKFNkgLfL6mbvbqibaf7Qafkqyd7g5_6dQm6POmomtLSGt-jffpUw47B0tQtMLxzDtF5zo7nK1xoV8NiHh7DGOOOXAducRO0sspPGMgFdM0Jq9du95_PcghyeTZ4m3J-g "Check out Instagram")
* [Threads](https://www.threads.net/ "Check out Threads")
* [Fundraisers](/fundraisers/ "Donate to worthy causes.")
* [Services](/biz/directory/ "Browse our Facebook Services directory.")
* [Voting Information Center](/votinginformationcenter/?entry_point=c2l0ZQ%3D%3D "See the Voting Information Center.")
* [Privacy Policy](/privacy/policy/?entry_point=facebook_page_footer "Learn how we collect, use and share information to support Facebook.")
* [Privacy Center](/privacy/center/?entry_point=facebook_page_footer "Learn how to manage and control your privacy on Facebook.")
* [Groups](/groups/discover/ "Explore our Groups.")
* [About](https://about.meta.com/ "Read our blog, discover the resource center, and find job opportunities.")
* [Create ad](/ad_campaign/landing.php?placement=pflo&campaign_id=402047449186&nav_source=unknown&extra_1=auto "Advertise on Facebook.")
* [Create Page](/pages/create/?ref_type=site_footer "Create a page")
* [Developers](https://developers.facebook.com/?ref=pf "Develop on our platform.")
* [Careers](/careers/?ref=pf "Make your next career move to our awesome company.")
* [Cookies](/policies/cookies/ "Learn about cookies and Facebook.")
* [Ad choices](https://www.facebook.com/help/568137493302217 "Learn about Ad Choices.")
* [Terms](/policies?ref=pf "Review our terms and policies.")
* [Help](/help/?ref=pf "Visit our Help Center.")
* [Contact Uploading & Non-Users](https://www.facebook.com/help/637205020878504 "Visit our Contact Uploading & Non-Users Notice.")
* [Settings](/settings "View and edit your Facebook settings.")
* [Activity log](/allactivity?privacy_source=activity_log_top_menu "View your activity log")
 Meta Â© 2025![](https://facebook.com/security/hsts-pixel.gif)



=== Content from g3tsyst3m.github.io_4d644f47_20250115_112632.html ===


* [Skip to primary navigation](#site-nav)
* [Skip to content](#main)
* [Skip to footer](#footer)

[![G3tSyst3m's Infosec Blog](/assets/images/cyberowl.png)](/)
[G3tSyst3m's Infosec Blog](/)

* [About](/about/)

Toggle menu

[![R.B.C (g3tsyst3m)](/assets/images/cyberowl.png)](https://g3tsyst3m.github.io/)

### [R.B.C (g3tsyst3m)](https://g3tsyst3m.github.io/)

Super passionate about Infosecâ€¦Dwight Schrute level of intensity

Follow

* USA
* Email
* [Website](https://g3tsyst3m.github.io/)
* [Twitter](https://twitter.com/G3tSyst3m)
* [GitHub](https://github.com/g3tsyst3m)
* [Discord](https://discord.gg/bqDkEdDrQQ)

# [Arbitrary Write Privilege Escalation - CVE-2024-50804](https://g3tsyst3m.github.io/cve/msi/Arbitrary-Write-Privilege-Escalation-CVE-2024-50804/)

November 16, 2024

5 minute read

This writeup provides an overview of the recently discovered arbitrary write vulnerability in the **MSI Center Pro 2.1.37.0** software for MSI branded machines. MSI has also acknowledged the vulnerability and cooperated with me to deliver a patch. In my final email correspondence with MSI on November 15th 2024, MSI confirmed with me the patch and updated software were successfully released to the Microsoft store. Sure enough, when I browsed the microsoft store per their link below, I could see the new version listed on November 14, 2024.

Hereâ€™s the final email I received and confirmation of the fixed version release! See below:

> **Nov 15, 2024, 5:06â€¯AM**
>
>
> Hi Robbie, MSI Center Pro 2.1.41.0 has been released on Microsoft Store that includes fixes for the two reported vulnerabilities (The Arbitrary Write Vulnerability & the privilege escalation vulnerability).
>
>  https://apps.microsoft.com/detail/9nq4lgt81kgc?hl=zh-TWâ‰·=TW
>
> Weâ€™ve put your name on MSIâ€™s PSIRT Hall of Fame to show our appreciation. Thanks again for the great work and effort.
>
>  https://csr.msi.com/global/product-security-advisories
>
> If we have started programs for doing additional research and consulting work in the future, we will be sure to reach out to you.
>
> Have a nice weekend,
>
> MSI PSIRT Team

## ***CVE-2024-50804 - An Overview***

Funny thing is, this was just a simple effort in reviewing local privilege escalation techniques. I started along the path of learning about symlink/junction arbitrary write vulnerabilities. I was first of all intrigued by the fact that a standard user could point symlinks and junctions to privileged directories, such as `c:\windows\system32`.

I then started looking in to this more intentionally, using procmon and opening the various apps I had installed on my MSI laptop. I wanted to see if any odd read/write behavior stood out. I eventually stumbled upon an interesting discovery - A **SYSTEM** process writing to the **ProgramData** folder and renaming a file that I had control over. This is when I really started to get amped. ðŸ˜¸ Letâ€™s dive in and Iâ€™ll explain how this initial discovery led to an exciting journey into learning all about arbitrary write local privilege escalation using windows symlinks/junctions!

> **Software Affected**: ***MSI Center Pro 2.1.37.0***

![image](https://github.com/user-attachments/assets/06879000-c2d8-4a4c-936d-29f8ca354125)

> **Summary**

An Arbitrary write vulnerability exists within the `C:\ProgramData\MSI\One Dragon Center\Data\Data` folder for the MSI Center Pro software. This vulnerability presents an opportunity for elevation of privilege to `NT AUTHORITY/SYSTEM` due to the file in question, `Device_DeviceID.dat.bak`, being written to by a `SYSTEM` level process.

> **Discovery**

It was observed by yours truly that many config/log files located within the `C:\ProgramData\MSI\One Dragon Center\Data\Data` directory were being written to by the `NT AUTHORITY/SYSTEM` user. This can oftentimes allow for more extensive permissions being granted by default to even a standard user. This on its own is not indicative of compromise, as log files can have explicit permissions preventing abuse of inherited permissions from `ProgramData`. However, in the case of this vulnerability, there exists a weakness with how the .dat files are created within the `Data` directory.

> **The Vulnerability Explained**

A `SYSTEM` arbitrary write vulnerability exists due to how two files are handled by the `C:\Program Files (x86)\MSI\One Dragon Center\MSI.CentralServer.exe` process. The two files in question are `Device_DeviceID.dat` and `Device_DeviceID.dat.bak`, respectively. `The Device_DeviceID.dat` is created after the
`Device_DeviceID.dat.bak` is renamed to `Device_DeviceID.dat`.

`IMAGE A`
![image](https://github.com/user-attachments/assets/c6b22dc6-9a7b-4998-844b-59c481843457)

We can interrupt this process by creating a pseudo-symbolic link that points `Device_DeviceID.dat.bak` to an arbitrary file we have control over (See **Image B**). This will force the renamed `Device_DeviceID.dat` to transform into a **symlink** and take on the inheritable permissions of the `C:\ProgramData\MSI\One Dragon Center\Data\Data` directory. This will also allow our currently logged in `STANDARD` user the ability to delete the newly converted `Device_DeviceID.dat` symlink file, as can be seen in **Image C** below. Otherwise, this file could not be deleted except by a user from the **Administrators** group (See **Image D**).

Hereâ€™s how everything plays out when we start the program, `C:\Program Files (x86)\MSI\One Dragon Center\MSI.CentralServer.exe`. The process will begin to write to the `.bak` file, which will then link to our file, and then get renamed to the final `.dat` file.

`IMAGE B`

![image](https://github.com/user-attachments/assets/2280d79d-6e1b-4dbd-a281-a1344839a637)

`IMAGE C`

![image](https://github.com/user-attachments/assets/97611a44-c73b-4d10-a2d0-649ea72d998c)

`IMAGE D`

![image](https://github.com/user-attachments/assets/908cecb7-f78f-4318-a23f-66d4de567bd4)

Now the previously secured `Device_DeviceID.dat` file can be easily deleted with new permissions applied to the symbolically linked newly created .dat file. See newly applied permissions in **Image E** below:

`IMAGE E`

![image](https://github.com/user-attachments/assets/aa2155e5-34f6-494e-a348-89bd9d6c40ef)

**Why does this matter?**

Once the `Data` folder is emptied, a directory `junction` can be created and we can then begn to craft our exploit. We will create two `Object Manager based, RPC
control symbolic links`:

**The first symlink will be for the `.bak` file pointing to our writeable payload, located in the `c:\temp` folder:**

![image](https://github.com/user-attachments/assets/e34b8bc5-9b34-4fde-94a1-6cccc876ba79)

The second symlink will be to our privileged target directory we wish to write to. I chose the `C:\Program Files (x86)\Microsoft\EdgeUpdate` directory where we will transfer a custom crafted `.dll` payload to that directory and load it using the task scheduler, thus gaining `NT AUTHORITY/SYSTEM` privileges.

The first symlink will force the `.bak` file to take on the permissions of our payload. We then apply those permissions to the second `symlink` which transfers to the target file.

**Hereâ€™s the code snippit that accomplishes this:**

![image](https://github.com/user-attachments/assets/5f12208a-1b3e-4c9d-942d-f9247f54da67)

I figured I would just share the video I submitted to the MSI team to make this next part easier to understand:

(Watching this back, im cringing at my sleep deprived self recording this in like 2 takes and I somehow couldnâ€™t articulate the very simple fact that placing a DLL in the same directory as the executable will make the executable load that DLL ðŸ˜¸ Never miss an opportunity to be humbled right? ðŸ˜„)

Thatâ€™s it! Thanks for reading

> **TIMELINE**

**September 6, 2024:**

Contacted MSI at psirt@msi.com via their responsible disclosure policy:

<https://csr.msi.com/global/product-security-advisories>

**September 15th, 2024:**

MSI confirms receiving vulnerability report and would review findings

**September 26th, 2024:**

PSIRT MSI team required more information

**September 27th, 2024:**

Sent PSIRT team two video walkthroughs of exploiting the arbitrary write vulnerability

**October 4th, 2024:**

MSI confirms vulnerability and applies a fix to prevent the .bak file from being manipulated during the file rename operation

**November 15th, 2024:**
I received confirmation from MSI that the updated, patched version of the software had been released to the Microsoft store. ðŸ˜¸

 **Tags:**
[2024](/tags/#2024),
[arbitrary write](/tags/#arbitrary-write),
[CVE-2024-50804](/tags/#cve-2024-50804),
[MSI](/tags/#msi),
[privilege escalation](/tags/#privilege-escalation),
[symlink](/tags/#symlink)

 **Categories:**
[CVE](/categories/#cve),
[MSI](/categories/#msi)

 **Updated:** November 16, 2024

#### Share on

 [Twitter](https://twitter.com/intent/tweet?text=Arbitrary+Write+Privilege+Escalation+-+CVE-2024-50804%20https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Share on Twitter")
 [Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Share on Facebook")
 [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fg3tsyst3m.github.io%2Fcve%2Fmsi%2FArbitrary-Write-Privilege-Escalation-CVE-2024-50804%2F "Share on LinkedIn")

[Previous](/shellcoding/assembly/debugging/x64-Assembly-%26-Shellcoding-101-Part-6/ "x64 Assembly & Shellcoding 101 - Part 6
")
[Next](/shellcoding/assembly/debugging/x64-Assembly-%26-Shellcoding-101-Conclusion/ "x64 Assembly & Shellcoding 101 - Conclusion
")

#### Leave a comment

## You may also enjoy

![](/assets/images/c2_part3.png)
## [Create your own C2 using Python- Part 3](/c2/python/Create-your-own-C2-using-Python-Part-3/)

December 20, 2024

9 minute read

Twas 5 days before Christmas, and all through the night. Not a sound was heard, because we bypassed EDR with no alerts in sight! ðŸŽ…

![](/assets/images/c2_part2.png)
## [Create your own C2 using Python- Part 2](/c2/python/Create-your-own-C2-using-Python-Part-2/)

November 27, 2024

7 minute read

Hey everyone! Welcome to Part 2 of the Create your own C2 series. You have likely learned by now this is not going to be some crazy beefed out C2. My main...

![](/assets/images/c2.png)
## [Create your own C2 using Python- Part 1](/c2/python/Create-your-own-C2-using-Python-Part-1/)

November 22, 2024

10 minute read

Back in the good ole days of my adolescence, I was fascinated with all things Metasploit. I was a ripe old teenager when Metasploit first came out, and I wa...

![](/assets/images/conclusion.png)
## [x64 Assembly & Shellcoding 101 - Conclusion](/shellcoding/assembly/debugging/x64-Assembly-%26-Shellcoding-101-Conclusion/)

November 17, 2024

16 minute read

Well itâ€™s been a fun ride, but weâ€™ve reached our destination. ðŸš— Time to wrap things up with our Assembly and Shellcoding 101 course and move on to the next e...

* **Follow:**
* [Twitter](https://twitter.com/G3tSyst3m)
* [GitHub](https://github.com/g3tsyst3m)
* [Feed](/feed.xml)

Â© 2025 R.B.C. (g3tsyst3m). Powered by [Jekyll](https://jekyllrb.com) & [Minimal Mistakes](https://mademistakes.com/work/minimal-mistakes-jekyll-theme/).


