```
{
  "cve": "CVE-2024-50202",
  "affected_packages": [
    "linux kernel"
  ],
  "vulnerability": {
    "root_cause": "The `nilfs_find_entry()` function in the nilfs2 filesystem driver ignores errors when loading a directory page/folio via `nilfs_get_folio()`. This can lead to a task hang if the filesystem image is corrupted and fails the sanity check.",
    "weaknesses": [
      "Improper error handling in `nilfs_find_entry()` during directory page/folio loading.",
      "Outdated interface of `nilfs_find_entry()` and its callers, which cannot propagate error codes."
    ],
    "impact": "Task hang in `vcs_open()` during a fuzzing test of nilfs2, which can lead to denial of service. Additionally, the continuous spitting of error messages from nilfs_check_folio() can also degrade system performance.",
    "attack_vectors": "A corrupted filesystem image, specifically with a large directory inode and a directory page/folio that fails the sanity check (e.g., zero-filled).",
     "required_attacker_capabilities": "The attacker needs to be able to provide or create a specifically corrupted nilfs2 filesystem image. This may require root privileges or physical access to the system, depending on how the file system is mounted."
  },
  "patch": "The patch modifies `nilfs_find_entry()` to propagate errors returned from `nilfs_get_folio()`. The function's interface and callers are also updated to handle error codes. This ensures that errors during page loading are properly handled, preventing the task hang and the burst of error messages."
}
```