The provided content relates to CVE-2024-50253.

**Root cause of vulnerability:**
The vulnerability arises from a missing check on the `nr_words` parameter in the `bpf_iter_bits_new()` function. When `nr_words` is excessively large, a multiplication overflow can occur during the calculation of `nr_bits`, which in turn leads to an out-of-bounds read in `bpf_probe_read_kernel_common()` due to a very large value of `nr_bytes`.

**Weaknesses/vulnerabilities present:**
- Integer overflow: Lack of input validation on `nr_words` leads to potential integer overflow during calculation of `nr_bits`
- Out-of-bounds read: The calculated large `nr_bytes` value results in a `bpf_probe_read_kernel_common` read outside the intended memory area, potentially causing a crash.

**Impact of exploitation:**
- Stack corruption: Due to the out-of-bounds read, stack corruption may occur.
- Kernel crash: The incorrect memory access can lead to a kernel crash.

**Attack vectors:**
- BPF programs: A malicious BPF program can pass an oversized `nr_words` value to `bpf_iter_bits_new()`, triggering the vulnerability.

**Required attacker capabilities/position:**
- The attacker needs the ability to load and execute BPF programs on the target system.