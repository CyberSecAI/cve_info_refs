```
{
  "vulnerability": {
    "root_cause": "The altmode device release function in the USB Type-C subsystem did not maintain a reference to its parent device.",
    "weaknesses": [
      "Use-after-free"
    ],
    "impact": "A use-after-free vulnerability can lead to a kernel crash, denial of service, and potentially arbitrary code execution.",
    "attack_vectors": "The vulnerability is triggered during the release of a USB Type-C altmode device.",
    "required_capabilities": "The attacker must be able to trigger the registration and release of a USB Type-C altmode device. This typically involves having physical access to a device with a USB Type-C port and the ability to initiate the relevant interactions."
  },
  "affected_component": "USB Type-C subsystem in the Linux kernel",
  "affected_versions": "Linux kernel versions prior to the fix.",
    "fixes": [
        "The fix involves adding a `get_device()` call when registering the altmode device and a corresponding `put_device()` call when releasing it to maintain a proper reference to the parent device."
    ],
    "details": "The provided commit logs and diffs show that the `typec_altmode_release` function was freeing the altmode without putting the parent device object. This resulted in a use-after-free condition when the parent device was accessed after being freed. The fix adds a `get_device` call to acquire a reference to the parent device during altmode registration, ensuring it remains valid until `typec_altmode_release` puts it with `put_device`. This prevents the use-after-free condition during device release, as the parent is only released after the altmode is completely cleaned up. The issue is triggered with CONFIG_DEBUG_KOBJECT_RELEASE, and a KASAN slab-use-after-free is triggered, with a trace of the call stack leading to typec_altmode_release."
}
```