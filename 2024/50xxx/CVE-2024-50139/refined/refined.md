The provided content relates to a fix for CVE-2024-50139.

**Root cause of vulnerability:**
A shift-out-of-bounds bug occurs when calculating the cache configuration in the KVM module for ARM64 architecture, specifically when Memory Tagging Extensions (MTE) are enabled. The shift exponent was a 32-bit integer, but the value was calculated as 33.

**Weaknesses/vulnerabilities present:**
- Integer overflow/out-of-bounds shift operation when MTE is enabled and calculating cache config.

**Impact of exploitation:**
- The shift-out-of-bounds operation triggers a UBSAN (Undefined Behavior Sanitizer) error and can cause the kernel to crash when running a VM with MTE enabled on the host. It does not cause memory corruption or arbitrary code execution.

**Attack vectors:**
- The vulnerability is triggered when a virtual machine is created with a host kernel that has MTE enabled.
- The vulnerability can be triggered via `kvm_arch_vcpu_ioctl_vcpu_init`.

**Required attacker capabilities/position:**
- The attacker must be able to create a virtual machine using KVM on an ARM64 host with MTE enabled.
- User needs to be able to run `qemu-kvm`.