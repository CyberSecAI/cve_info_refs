=== Content from seclists.org_3c9a6118_20250115_080325.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](25)
[By Date](date.html#26)
[![Next](/images/right-icon-16x16.png)](27)

[![Previous](/images/left-icon-16x16.png)](25)
[By Thread](index.html#26)
[![Next](/images/right-icon-16x16.png)](27)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20240513-0 :: Tolerating Self-Signed Certificates in SAP® Cloud Connector

---

*From*: SEC Consult Vulnerability Lab via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Mon, 13 May 2024 07:22:10 +0000

---

```

SEC Consult Vulnerability Lab Security Advisory < 20240513-0 >
=======================================================================
              title: Tolerating Self-Signed Certificates
            product: SAP® Cloud Connector
 vulnerable version: 2.15.0 - 2.16.1 (Portable and Installer)
      fixed version: 2.16.2 (Portable and Installer)
         CVE number: CVE-2024-25642
             impact: high
           homepage: <https://www.sap.com/about.html>
              found: 2023-11-13
                 by: Mingshuo Li (Office Munich)
                     Fabian Hagg
                     SEC Consult Vulnerability Lab

                     An integrated part of SEC Consult, an Eviden business
                     Europe | Asia

                     <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"The Cloud Connector is an optional on-premise component that is needed to
integrate on-demand applications with customer backend services and is the
counterpart of SAP Connectivity service."

Source: <https://tools.hana.ondemand.com/#cloud>

Business recommendation:
------------------------
SEC Consult recommends to implement the security note 3424610, where the
documented issue is fixed in version 2.16.2 according to the vendor. We
advise installing the correction as a matter of priority to keep
business-critical data secured.

Source: <https://support.sap.com/en/my-support/knowledge-base/security-notes-news/february-2024.html>

Vulnerability overview/description:
-----------------------------------
1) Tolerating Self-Signed Certificates (CVE-2024-25642)
As per vendor documentation, the authentication between SCC and SAP BTP is guaranteed
mutually:

"The tunnel itself is using TLS with strong encryption of the communication,
and mutual authentication of both communication sides, the client side
(Cloud Connector) and the server side (SAP BTP)."

Source: <https://help.sap.com/docs/connectivity/sap-btp-connectivity-cf/inbound-connectivity#tls-tunnel>

It was however discovered that the SCC trusts self-signed X.509 server certificates
for transport security to establish outbound connections with cloud-related
endpoints. Thus, an attacker can impersonate the genuine servers to interact
with the SCC, hence breaking the mutual authentication promise. Our analysis shows
furthermore that the product does not implement Certificate Pinning for the
trusted endpoints.

The security impact of this vulnerability is rated high due to the trust put
into self-signed certificates, SCC is unable to distinguish between genuine and
malicious SAP BTP endpoints, rendering trivial adversary-in-the-middle attacks
possible.

Proof of concept:
-----------------
1) Tolerating Self-Signed Certificates (CVE-2024-25642)
A "tunnel" established between a subaccount of SAP BTP and SCC represents a
long-lived bi-directional WebSocket over TLS customized by the vendor.
Such a tunnel is initiated by the SCC, known as reverse invoke approach,
to give the administrator full control of the tunnel.

Two tunnels established by SCC are protected by TLS with respect to encrypted
communication. However, SCC does not verify the authenticity of the
certification authority, hence allowing an attacker to impersonate the target
server, using self-signed certificates.

In particular, the attack is targeted at the following two endpoints, but not
limited to the region host us10.

- connectivitynotification.cf.us10.hana.ondemand.com
- connectivity.us10.trial.applicationstudio.cloud.sap

Note that the following endpoint, which is used for the initial certificate
signing request by SCC and to receive the BTP subaccount credentials, is
not susceptible to this issue.

- connectivitycertsigning.cf.us10.hana.ondemand.com

Nonetheless, it suffices to silently eavesdrop and manipulate network traffic
between SCC and SAP BTP by impersonating the two vulnerable endpoints above.

Without loss of generality, the first endpoint is taken as example to
demonstrate the issue by the following steps:

1. Add an entry in /etc/hosts of the SCC host as below to resolve the host name
   to an attacker-controlled IP address:

   192.168.1.100       connectivitynotification.cf.us10.hana.ondemand.com

2. Generate a self-signed certificate with the spoofed hostname as common name

```

```
$ openssl req -x509 -newkey rsa:4096 -keyout conn-noti-key.pem -out conn-noti-cert.pem -sha256 -days 3650 -nodes -subj "/C=DE/ST=Baden-Wuerttemberg/L=Walldorf/O=SAP
SE/OU=ITSecurity/CN=connectivitynotification.cf.us10.hana.ondemand.com"
```

```

3. Start an HTTPS server on the attacker machine to receive the connection from
   SCC, using the self-signed certificate created in step 2

The following Python script can be used to start the HTTPS server:
```
$ cat https-dummy-server.py
import http.server
import ssl

server_address = ("192.168.1.100", 443)
httpd = http.server.HTTPServer(server_address, http.server.SimpleHTTPRequestHandler)
httpd.socket = ssl.wrap_socket(httpd.socket,
    server_side=True,
    certfile="self-signed-cert/conn-noti-cert.pem",
    keyfile="self-signed-cert/conn-noti-key.pem",
    ssl_version=ssl.PROTOCOL_TLS)
httpd.serve_forever()
```

4. Connect to a subaccount of BTP, for example US East AWS, in the SCC
   Administration UI

As soon as the connection is launched, the dummy web server will receive the
request as shown below:

```
$ python3 https-dummy-server.py
192.168.1.200 - - [10/Nov/2023 12:00:00] "GET /connectivity HTTP/1.1" 200 -
```

This observation confirms that the TLS connection between SCC and the spoofed
BTP endpoint operated on the attacker's machine has been successfully established
although the server presented a self-signed certificate. No security warning
message is being displayed in the Administration UI, making the attack
surreptitious.

Vulnerable / tested versions:
-----------------------------
The following versions have been tested which were the latest versions available
at the time of the test:

* SAP Cloud Connector Linux x86_64 Version 2.16.0
* SAP Cloud Connector Linux (Portable) x86_64 Version 2.16.0

According to the vendor, the vulnerability is a regression and affects the
versions 2.15.0 - 2.16.1.

Vendor contact timeline:
------------------------
2023-11-14: Contacting vendor through vulnerability submission web form
2023-11-17: Vendor confirms receipt and assign SAP security incident numbers to
            the four submitted findings: 2370150975, 2370150977, 2370150994, 2370151022
2023-11-20: Vendor informs the reported issues be assigned the appropriate
            development teams for analysis
2023-12-05: Requesting status update
2023-12-05: Vendor informs that 2370151022 be rejected
2023-12-05: Issuing rebuttal for 2370151022
2023-12-06: Vendor contemplates further analysis
2023-12-14: Vendor decides not to take any action on 2370151022 and rejects
            2370150977 and 2370150975 as well.
2023-12-15: Vendor accepts 2370150994
2024-01-05: Asked vendor to comment on the three rejected issues
2024-01-10: Vendor gives detailed rationale for the rejection of 2370150975
2024-01-12: Issuing rebuttal for 2370150975
2024-01-15: Vendor insists on rejection of 2370150975 and closes the ticket.
            Removing three rejected potential security issues from advisory.
2024-02-13: Release of SAP Security Patch Day, security note #3424610
2024-02-26: Asking for the disclosure guideline to publish finding 2370150994
2024-02-26: Vendor confirms the three-month embargo
2024-05-13: Coordinated release of SEC Consult advisory.

Solution:
---------
The vendor provides a patched version 2.16.2 which can be downloaded from their
website:
<https://tools.hana.ondemand.com/#cloud>

Also see the vendor's security note #3424610 for further details:
<https://me.sap.com/notes/3424610>

Workaround:
-----------
None

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF M. Li, F. Hagg / @2024

```

**Attachment:
[smime.p7s](att-26/smime_p7s.bin)**

*Description:* S/MIME Cryptographic Signature

```
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>
```

---

[![Previous](/images/left-icon-16x16.png)](25)
[By Date](date.html#26)
[![Next](/images/right-icon-16x16.png)](27)

[![Previous](/images/left-icon-16x16.png)](25)
[By Thread](index.html#26)
[![Next](/images/right-icon-16x16.png)](27)

### Current thread:

* **SEC Consult SA-20240513-0 :: Tolerating Self-Signed Certificates in SAP® Cloud Connector** *SEC Consult Vulnerability Lab via Fulldisclosure (May 14)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.sap.com_132cd901_20250115_080326.html ===


Contact Us

×
How you can contact us:

* [Product Related Assistance](/en/contact-us.html#section_411324132)

  Request product related support from SAP
* [Non-Product Related Assistance](/en/contact-us.html#section_42886245)

  Request for existing cases, user IDs, Portal navigation support and more

# SAP Security Notes

#### Review and implement critical SAP Security Notes, plan for upcoming SAP Security Patch Days

#### SAP Security Notes

SAP Security Notes contain SAP's expert advice regarding action items and patches to ensure the security of your systems.

[Access SAP Security Notes](https://me.sap.com/app/securitynotes "Access SAP Security Notes")

#### SAP Security Notes FAQs

Get your frequently asked questions regarding SAP security patching answered by reviewing our SAP Security Notes FAQs.

[Read the Security Notes FAQs](/en/my-support/knowledge-base/security-notes-news/security-notes-faqs.html "SAP Security Notes FAQ")

#### Report a Security Issue to SAP

SAP takes all matters relating to your security very seriously, and we are constantly working on improving our product security measures.

[Report a Security Issue](https://me.sap.com/createIssue/0/overview "Report a Vulnerability")

## SAP Security Patch Day

The security maintenance of installed SAP software is key to continuously protect also against new types of attacks or newly identified potential weaknesses.

Based on feedback from customers, partners and SAP user groups, SAP has launched a regular **SAP Security Patch Day**, scheduled for the **second Tuesday of every month** — which has been synchronized with the Security Patch Day of other major software vendors.

On these SAP Patch Days, SAP publishes software corrections as **SAP Security Notes**, focused solely on security to protect against potential weaknesses or attacks. Access [SAP Security Notes in SAP for Me](https://me.sap.com/app/securitynotes), then select *All Security Notes*, to get the complete list of all SAP Security Notes. **We recommend that you implement these corrections at a priority**. Several tools are available to help identify, select and implement these corrections.

SAP categorizes SAP Security Notes as *Patch Day Security Not*es and *Support Package Security Notes*, with the sole purpose of making you focus on important fixes on patch days and the rest to be implemented automatically during SP upgrades. For details refer to the [SAP Security Notes FAQ](/en/my-support/knowledge-base/security-notes-news/security-notes-faqs.html). Security fixes for SAP NetWeaver based products are also delivered with the support packages.

Starting June 11, 2019, for all new SAP Security Notes with high or very high severity we deliver fix for Support Packages shipped within the last 24 months\* for the versions under Mainstream Maintenance and Extended Maintenance. This is extended from the previous Support Package coverage of 18 months.

Notes with low or medium priority contain corrections in at least the newest support package in all mainstream and extended maintenance releases.

\*For information on areas with an exception from the 24 months maintenance strategy, refer to the [SAP Security Notes FAQ](https://support.sap.com/en/my-support/knowledge-base/security-notes-news/security-notes-faqs.html?anchorId=section_237298869 "exceptions").

#### Dates for 2025

**[January 14](/en/my-support/knowledge-base/security-notes-news/january-2025.html "January Patch Day notes")**

**February 11**

**March 11**

**April 8**

**May 13**

**June 10**

**July 8**

**August 12**

**September 9**

**October 14**

**November 11**

**December 9**

For previous years bulletins refer to

**[SAP Security Patch Day Bulletin Archive](/en/my-support/knowledge-base/security-notes-news/security-patch-day-archives.html "SAP Security Patch Day Bulletin Archive")**

## Resources

[SAP Security, Data Protection, and Privacy](https://www.sap.com/about/trust-center/security.html "SAP Security, Data Protection, and Privacy")

[SAP Security Patch Day Bulletin Archive](/en/my-support/knowledge-base/security-notes-news/security-patch-day-archives.html "SAP Security Patch Day Bulletin Archive")

[Security News Archive](/en/my-support/knowledge-base/security-notes-news/security-news.html "Security News Archive")

[Security White Papers](/en/security-whitepapers.html "Security White Papers")

[SAP Security Community](https://www.sap.com/community/topics/security.html "SAP Security Community")

[SAP Security Optimization Services](/en/offerings-programs/support-services/security-optimization-services-portfolio.html "SAP Security Optimization Services")

[SAP Security Notes Monthly Webinar and Advisories](/en/offerings-programs/support-services/security-optimization-services-portfolio.html "SAP Security Notes Monthly Webinar and Advisories")

![](https://support.sap.com/akam/13/pixel_7cf8b987?a=dD0xZGFiOTc0NGQ0OWQ4ZWQwMDQ2MDI2NDAwY2NmZWY0MTljMzlhM2RmJmpzPW9mZg==)
