=== Content from github.com_48da0bdb_20250114_222022.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsteve-community%2Fsteve%2Fissues%2F1296)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsteve-community%2Fsteve%2Fissues%2F1296)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=steve-community%2Fsteve)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[steve-community](/steve-community)
/
**[steve](/steve-community/steve)**
Public

* [Notifications](/login?return_to=%2Fsteve-community%2Fsteve) You must be signed in to change notification settings
* [Fork
  403](/login?return_to=%2Fsteve-community%2Fsteve)
* [Star
   830](/login?return_to=%2Fsteve-community%2Fsteve)

* [Code](/steve-community/steve)
* [Issues
  98](/steve-community/steve/issues)
* [Pull requests
  22](/steve-community/steve/pulls)
* [Discussions](/steve-community/steve/discussions)
* [Actions](/steve-community/steve/actions)
* [Projects
  0](/steve-community/steve/projects)
* [Wiki](/steve-community/steve/wiki)
* [Security](/steve-community/steve/security)
* [Insights](/steve-community/steve/pulse)

Additional navigation options

* [Code](/steve-community/steve)
* [Issues](/steve-community/steve/issues)
* [Pull requests](/steve-community/steve/pulls)
* [Discussions](/steve-community/steve/discussions)
* [Actions](/steve-community/steve/actions)
* [Projects](/steve-community/steve/projects)
* [Wiki](/steve-community/steve/wiki)
* [Security](/steve-community/steve/security)
* [Insights](/steve-community/steve/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fsteve-community%2Fsteve%2Fissues%2Fnew%2Fchoose)

By clicking ‚ÄúSign up for GitHub‚Äù, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We‚Äôll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fsteve-community%2Fsteve%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Predictable Transaction ID Possible Vulnerability Allows Unauthorized Termination of OCPP Sessions #1296

Open

2 of 4 tasks

[Tano-Coppoletta](/Tano-Coppoletta) opened this issue
Nov 9, 2023
¬∑ 4 comments

Open

2 of 4 tasks

# [Predictable Transaction ID Possible Vulnerability Allows Unauthorized Termination of OCPP Sessions](#top) #1296

[Tano-Coppoletta](/Tano-Coppoletta) opened this issue
Nov 9, 2023
¬∑ 4 comments

## Comments

[![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=80&u=b5ed630e8dffdcc7167608a0c881c049bb728f56&v=4)](/Tano-Coppoletta)

Copy link

### **[Tano-Coppoletta](/Tano-Coppoletta)** commented [Nov 9, 2023](#issue-1986217837)

| Checklist  * I checked other issues already, but found no answer/solution * I checked the documentation and wiki, but found no answer/solution * I am running the latest version and the issue still occurs * I am sure that this issue is about SteVe (and not about the charging station software or something unrelated to SteVe)  Specifications ``` SteVe Version     : 3.6.0 Operating system  : Ubuntu 22.04.1 JDK               : openjdk version "11.0.20.1" Database          : version 1.0.3  ``` Docker Container Setup Two Docker containers are set up to simulate two OCPP clients for testing purposes. Issue Description A possible security vulnerability was identified where unauthorized termination of transactions is possible due to predictable transaction Ids. The server issues a new transaction ID upon receiving an incomplete `StartTransaction` request and, due to the IDs being auto-incremented, an attacker can predict and use them to terminate other transactions. Steps to Reproduce  1. From the first Docker container (Client 1), a transaction is started:    ```    [2,"1","StartTransaction", {        "connectorId": 1,        "idTag": "test",        "meterStart": 20,        "timestamp": "2023-09-03T12:34:56Z"    }]    ``` 2. From the second Docker container (Client 2), a `StartTransaction` request with an empty idTag is sent to obtain a new transaction Id:  ```    [2, "1", "StartTransaction", {"idTag": ""}] ```  3. Client 2 then sends a `StopTransaction` request using the new transaction ID minus 1:  ``` [2, "1","StopTransaction", {   "meterStop": 1,   "timestamp": "2023-11-06T15:54:23Z",   "transactionId": [Retrieved Transaction ID - 1],   "reason": "EVDisconnected",   "transactionData": [...] }] ```  4.The unauthorized termination of Client 1's transaction is confirmed via the web interface. [Screenshot from 2023-11-08 16-30-39](https://private-user-images.githubusercontent.com/62875720/281835246-49fac839-9325-4928-8409-c0fef8f16d69.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM1MjAsIm5iZiI6MTczNjg5MzIyMCwicGF0aCI6Ii82Mjg3NTcyMC8yODE4MzUyNDYtNDlmYWM4MzktOTMyNS00OTI4LTg0MDktYzBmZWY4ZjE2ZDY5LnBuZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTQlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE0VDIyMjAyMFomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPTMyZDVlZDQ3MzMxMTZmMWZhMmJhZThhYzQ3MDA1NDAyMTUzMDY0YzNhMDljYTc1ZTQ3YmE4Yjg2MzVlMDE3NDImWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.w7yfR1MryId5In-SxRVEBh3kXuzmNnColz1LrHZ7kAU) Expected behavior The server should not issue a transaction ID for incomplete `StartTransaction` requests and should authenticate `StopTransaction` requests before processing. Actual behavior The server processes unauthorized `StopTransaction` requests using predicted transaction IDs. |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@lategoodbye](https://avatars.githubusercontent.com/u/1618443?s=80&v=4)](/lategoodbye)

Copy link

Contributor

### **[lategoodbye](/lategoodbye)** commented [Nov 11, 2023](#issuecomment-1806870103)

| From my point of view does the StartTransaction from point 2 violates the OCPP 1.6 schema (fields connectorId, meterStart and timestamp are missing). I think for OCPP 1.6J this should generate a CallError with ErrorCode = OccurenceConstraintViolation. There is no point in processing such a message, because no charging station should send such a mess. |
| --- |

All reactions

Sorry, something went wrong.

[![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=80&u=b5ed630e8dffdcc7167608a0c881c049bb728f56&v=4)](/Tano-Coppoletta)

Copy link

Author

### **[Tano-Coppoletta](/Tano-Coppoletta)** commented [Nov 13, 2023](#issuecomment-1808302310)

| I appreciate your insight regarding the schema violation for the StartTransaction message. However, it's important to consider scenarios where a charging station might be compromised. If an attacker gains physical access to a charging station, they could potentially send malformed or incomplete OCPP messages. Therefore, server-side validation is crucial to safeguard against such threats. |
| --- |

All reactions

Sorry, something went wrong.

[![@lategoodbye](https://avatars.githubusercontent.com/u/1618443?s=80&v=4)](/lategoodbye)

Copy link

Contributor

### **[lategoodbye](/lategoodbye)** commented [Nov 13, 2023](#issuecomment-1808383830)

| [@Tano-Coppoletta](https://github.com/Tano-Coppoletta) Maybe you got me wrong, i wanted to say that Steve (server side) should generate a CallError and prevent further processing of the transaction. So your concerns are valid from my point of view. |
| --- |

All reactions

Sorry, something went wrong.

[![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=80&u=b5ed630e8dffdcc7167608a0c881c049bb728f56&v=4)](/Tano-Coppoletta)

Copy link

Author

### **[Tano-Coppoletta](/Tano-Coppoletta)** commented [Dec 2, 2023](#issuecomment-1837271314)

| Hello,  I'm reaching out for an update regarding this issue.  We are in the process of submitting Common Vulnerabilities and Exposures (CVEs) related to this matter. However, we can wait if you are in the process of fixing it.  Additionally, we intend to publish our findings in an academic paper.  Your prompt response and attention to this matter would be greatly appreciated as it will greatly inform our next steps.  Thank you and looking forward to your response. |
| --- |

 üëç
1
 Joaocabral2024 reacted with thumbs up emoji

All reactions

* üëç
  1 reaction

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fsteve-community%2Fsteve%2Fissues%2F1296)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

2 participants

[![@lategoodbye](https://avatars.githubusercontent.com/u/1618443?s=52&v=4)](/lategoodbye) [![@Tano-Coppoletta](https://avatars.githubusercontent.com/u/62875720?s=52&v=4)](/Tano-Coppoletta)

## Footer

¬© 2025 GitHub,¬†Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can‚Äôt perform that action at this time.


