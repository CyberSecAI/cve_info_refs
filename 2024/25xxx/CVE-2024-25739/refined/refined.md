```
{
  "vulnerability_details": [
    {
      "cve_id": "CVE-2024-25739",
      "root_cause": "The Logical Erase Block (LEB) size is smaller than the volume table record size, leading to a zero-size allocation.",
      "weaknesses": [
        "Insufficient validation of Logical Erase Block (LEB) size against the required volume table record size."
      ],
      "impact": "The vulnerability leads to a crash due to zero-size vmalloc in `ubi_read_volume_table` when UBI (Unsorted Block Images) volume management system is used.",
      "attack_vectors": [
        "Manipulating the `vid_hdr_offset` and `max_beb_per1024` fields within the `ubi_attach_req` argument during IOCTL call with command value `UBI_IOCATT` on the `/dev/ubi_ctrl` driver to cause the LEB size to be smaller than volume table record."
      ],
       "required_capabilities": [
        "Ability to use the `/dev/ubi_ctrl` driver and make IOCTL calls.",
	"Ability to control/manipulate the `vid_hdr_offset` and `max_beb_per1024` fields of ubi_attach_req."
      ],
       "details": "The vulnerability occurs in the `ubi_read_volume_table` function in the UBI driver (`drivers/mtd/ubi/vtbl.c`). When the LEB size is smaller than the size of a volume table record (`UBI_VTBL_RECORD_SIZE`), the calculation of the volume table returns zero. This leads to `vzalloc` being called with a zero size. This can be triggered by creating an empty logical volume using `create_empty_lvol`. The size allocated can be controlled by modifying the `vid_hdr_offset` and `max_beb_per1024` fields in the `ubi_attach_req` structure."
    }
  ]
}
```