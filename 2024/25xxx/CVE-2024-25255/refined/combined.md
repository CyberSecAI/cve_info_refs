=== Content from www.sublimetext.com_2c2ae6c5_20250115_185941.html ===

[![Sublime Text](/images/logo.svg)](/)
[Download](/download)
[Buy](https://www.sublimehq.com/store/text)
[Support](/support)

[News](/blog/)
[Forum](https://forum.sublimetext.com)

# [Documentation](/docs/index.html) [TOC](#toc) TOP Build Systems Version:

Sublime Text provides *build systems* to allow users to run external programs.
Examples of common uses for build systems include: compiling, transpiling,
linting, and executing tests.

Build systems are specified via JSON and saved in a file with the
extension .sublime-build. A new build system can be created by
the Tools ![▶](/images/right.svg) Build System ![▶](/images/right.svg) New Build System… menu item or the `Build:
New Build System` command palette entry.

Build systems have various ways they can associate themselves with files and
projects. Using this information, Sublime Text can intelligently display only
viable build systems to the user. The built-in `exec` target
provides common options to get up and running quickly. For more complex
requirements, build systems can target custom Sublime Text commands written in
Python.

* [Basic Example](#basic-example)
* [Usage](#usage)
* [Options](#options)
* [exec Target Options](#exec-target-options)
* [Custom Options](#custom-options)
* [Variables](#variables)
* [Advanced Example](#advanced-example)

## Basic Example[🔗](#basic-example "Permalink to this heading")

The following is a basic example of a build system. This build system will
execute the currently-open Python file.

```
{
    "cmd": ["python", "$file"],
    "selector": "source.python",
    "file_regex": "^\\s*File \"(...*?)\", line ([0-9]*)"
}

```

The [Usage](#usage) and [Options](#options) sections will discuss how to use and customize a
build system.

## Usage[🔗](#usage "Permalink to this heading")

Build systems include the following functionality:

* Automatic selection of a build system based on file type
* Remembering the last used build system
* Navigation of build system results
* Ability to cancel a build

### Running a Build[🔗](#running-a-build "Permalink to this heading")

A build can be run by one of the following methods:

| Keyboard | | | Menu |
| --- | --- | --- | --- |
| *Windows/Linux* | *Mac* | *All* | Tools ▶ Build |
| **Ctrl***+***B** | **⌘***+***B** | **F7** |

Output will be shown in an output panel displayed at the bottom of the Sublime
Text window.

### Selecting a Build System[🔗](#selecting-a-build-system "Permalink to this heading")

By default, Sublime Text uses automatic selection of build systems. When a user
invokes a build, the current file’s syntax and filename will be used to pick
the appropriate build system.

If more than one build system matches the current file type, the user will be
prompted to pick the build system they wish to use. Once a build system has
been selected, Sublime Text will remember it until the user changes their
selection.

To manually choose a build system, use: Tools ![▶](/images/right.svg) Build System

To change the build system, within the viable options, use one of the following
methods:

| Keyboard | | Menu | Command Palette |
| --- | --- | --- | --- |
| *Windows/Linux* | *Mac* | Tools ▶ Build With… | `Build With:` |
| **Ctrl***+***Shift***+***B** | **⇧***+***⌘***+***B** |

### Navigating Results[🔗](#navigating-results "Permalink to this heading")

Build systems allow navigation of files specified in the build output. Typically
this is used to jump to the location of errors. Navigation can be performed
via:

| Command | Keyboard | Menu |
| --- | --- | --- |
| Next Result | **F4** | Tools ▶ Build Results ▶ Next Result |
| Previous Result | **Shift***+***F4** | Tools ▶ Build Results ▶ Previous Result |

### Cancelling a Build[🔗](#cancelling-a-build "Permalink to this heading")

An in-process build can be cancelled via:

| Keyboard | | Menu | Command Palette |
| --- | --- | --- | --- |
| *Windows/Linux* | *Mac* | Tools ▶ Cancel Build | `Build: Cancel` |
| **Ctrl***+***Break** | **Ctrl***+***C** |

## Options[🔗](#options "Permalink to this heading")

All build systems may use the following top-level keys in
the .sublime-build file:

"selector" string[🔗](#selector "Permalink to this definition")

A [selector](selectors.html) to match the syntax that this build system should
be enabled for.

Example: `"source.python"`

"file\_patterns" array of strings[🔗](#file_patterns "Permalink to this definition")

[Patterns](file_patterns.html) of file names the build system should be enabled
for.

Example: `["*.py"]`

"keyfiles" array of strings[🔗](#keyfiles "Permalink to this definition")

File names, if present in one of the opened folders, that will cause the
build system to be enabled.

Example: `["Makefile"]`

"variants" array of objects[🔗](#variants "Permalink to this definition")

Subsidiary build systems that will inherit the options from the top-level
build system. Each variant needs to specify a `"name"` key, and may
override or add options to the top-level build system.

Example:

```
[
    {
        "name": "Debug Symbols",
        "cmd": ["my_command", "-D", "$file"]
    }
]

```

"cancel" string, array of strings[🔗](#cancel "Permalink to this definition")

A string command name, or an array of string options.

If a string is specified, the command specified will be used to cancel the
build.

If an array of strings, the primary `"target"` will be called, with these
options added on. This only needs to be specified when using a custom
`"target"`.

Examples: `"cancel_my_build"` or `{ "kill": true }`

"target" string[🔗](#target "Permalink to this definition")

The command to run when the build system is invoked. The default value of
`exec` allows use of the additional options specified in [exec Target
Options](#exec-target-options).

If a value other than `"exec"` is specified, none of the options in [exec
Target Options](#exec-target-options) will do anything.

See the [Advanced Example](#advanced-example) for a complete example.

Example: `"my_build"`

"windows" object[🔗](#windows "Permalink to this definition")

Options to use when the build system is being executed on a Windows
machine.

Example:

```
{
    "cmd": ["my_command.exe", "/D", "$file"]
}

```

"osx" object[🔗](#osx "Permalink to this definition")

Options to use when the build system is being executed on a Mac machine.

Example:

```
{
    "cmd": ["/Applications/MyProgram.app/Contents/MacOS/my_command", "-d", "$file"]
}

```

"linux" object[🔗](#linux "Permalink to this definition")

Options to use when the build system is being executed on a Linux machine.

Example:

```
{
    "cmd": ["/usr/local/bin/my_command", "-d", "$file"]
}

```

## `exec` Target Options[🔗](#exec-target-options "Permalink to this heading")

The default `target` of `exec` is used by the majority of build systems. It
provides the following options to control what program to execute, and how to
display the results.

"cmd" array of strings[🔗](#cmd "Permalink to this definition")

The executable to run, plus any arguments to pass to it. Shell constructs
such as piping and redirection are not supported – see [`"shell_cmd"`](#shell_cmd "\"shell_cmd\"").

May use [variables](#variables).

Example: `["my_command", "-d", "$file"]`

"shell\_cmd" string[🔗](#shell_cmd "Permalink to this definition")

A shell command to execute. Unlike the [`"cmd"`](#cmd "\"cmd\"") option, this does allow
piping and redirection. Will use `bash` on Mac and Linux machine, and
`cmd.exe` on Windows.

This takes precedence over [`"cmd"`](#cmd "\"cmd\""). If you want to override the
[`"shell_cmd"`](#shell_cmd "\"shell_cmd\"") in a build variant with a [`"cmd"`](#cmd "\"cmd\"") then also set the
[`"shell_cmd"`](#shell_cmd "\"shell_cmd\"") to `null`.

May use [variables](#variables).

Example: `"my_command \"$file\" | other_command"`

"working\_dir" string[🔗](#working_dir "Permalink to this definition")

The directory to execute the [`"cmd"`](#cmd "\"cmd\"") or [`"shell_cmd"`](#shell_cmd "\"shell_cmd\"") within.

May use [variables](#variables).

Example: `"$file_path"`

"file\_regex" string[🔗](#file_regex "Permalink to this definition")

A regular expression to run on the build output to match file information.
The matched file information is used to enable result navigation. The regex
should capture 2, 3 or 4 groups.

The capture groups should be:

1. filename
2. line number
3. column number
4. message

Example: `"^\s*(\\S[^:]*)\\((\\d+):(\\d+)\\): ([^\\n]+)"`

"line\_regex" string[🔗](#line_regex "Permalink to this definition")

A regular expression to run on the build output to match line information.
The matched file information is used to enable result navigation. The regex
should capture 1, 2 or 3 groups.

The groups should capture:

1. line number
2. column number
3. error message

This regular expression is only necessary when some results contain strictly
a line number, line and column numbers, or line and column numbers with a
message. When such a match is made, the [`"file_regex"`](#file_regex "\"file_regex\"") option will be used
to search backwards to find the appropriate file name.

Example: `"^\s*line (\\d+) col (\\d+): ([^\\n]+)"`

"encoding" string[🔗](#encoding "Permalink to this definition")

The encoding of the build system output. Uses [Python codec names](https://docs.python.org/3.3/library/codecs.html#id3). Defaults to
`"utf-8"`.

Example: `"iso-8859-1"`

"env" object[🔗](#env "Permalink to this definition")

Environment variable values to use when running the [`"cmd"`](#cmd "\"cmd\"") or
[`"shell_cmd"`](#shell_cmd "\"shell_cmd\"").

Example:

```
{
    "PYTHONIOENCODING": "utf-8"
}

```

"quiet" boolean[🔗](#quiet "Permalink to this definition")

Reduces the amount of output about the build system invocation.

Example: `true`

"word\_wrap" boolean[🔗](#word_wrap "Permalink to this definition")

Turns on word wrapping in the build system output panel.

Example: `true`

"syntax" string[🔗](#syntax "Permalink to this definition")

The syntax file to use to highlight the build system output panel.

Example: `"Packages/JavaScript/JSON.sublime-syntax"`

## Custom Options[🔗](#custom-options "Permalink to this heading")

When implementing a command to act as a build system target, the command’s
keyword arguments are available via options in the .sublime-build file.
However, certain parameter names will not work since they conflict with
built-in build system functionality.

The following names will not be passed as arguments to commands. This also
applies to other situations, such as options specified in the `"cancel"`,
`"linux"`, `"osx"` and `"windows"` options.

* `"cancel"`
* `"file_patterns"`
* `"keyfile"`
* `"keyfiles"`
* `"linux"`
* `"osx"`
* `"save_untitled_files"`
* `"selector"`
* `"target"`
* `"variants"`
* `"windows"`
## Variables[🔗](#variables "Permalink to this heading")

The following variables will be expanded within any string specified in the
`"cmd"`, `"shell_cmd"` or `"working_dir"` options.

If a literal `$` needs to be specified in one of these options, it must be
escaped with a `\`. Since JSON uses backslashes for escaping also, `$` will
need to be written as `\\$`.

Please note that this substitution will occur for any <span
class=”key”>”target”</span>. If a custom target is used, it may implement
variable expansion for additional options by using
`sublime.expand_variables()` with the result from
`self.window.extract_variables()`. </p>

| Variable | Description |
| --- | --- |
| `$packages` | The path to the Packages/ folder. |
| `$platform` | The platform Sublime Text is running on: `"windows"`, `"osx"` or `"linux"`. |
| `$file` | The full path, including folder, to the file in the active view. |
| `$file_path` | The path to the folder that contains the file in the active view. |
| `$file_name` | The file name (sans folder path) of the file in the active view. |
| `$file_base_name` | The file name, exluding the extension, of the file in the active view. |
| `$file_extension` | The extension of the file name of the file in the active view. |
| `$folder` | The full path to the first folder listed in the side bar. |
| `$project` | The full path to the current project file. |
| `$project_path` | The path to the folder containing the current project file. |
| `$project_name` | The file name (sans folder path) of the current project file. |
| `$project_base_name` | The file name, excluding the extension, of the current project file. |
| `$project_extension` | The extension of the current project file. |

## Advanced Example[🔗](#advanced-example "Permalink to this heading")

The following example shows a custom `target` command, with the ability to
cancel a build and navigate results.

A `target` for a build system should be a [`sublime_plugin.WindowCommand`](api_reference.html#sublime_plugin.WindowCommand "sublime_plugin.WindowCommand"). This
will provide the instance variable of `self.window` to allow interaction with
the current project, window and active view.

*Please note that the following example is somewhat simplistic in its
implementation, and it won’t handle many common edge cases.*

The following Python can be saved to a file
named Package/User/my\_example\_build.py:

```
import sublime
import sublime_plugin

import subprocess
import threading
import os

class MyExampleBuildCommand(sublime_plugin.WindowCommand):

    encoding = 'utf-8'
    killed = False
    proc = None
    panel = None
    panel_lock = threading.Lock()

    def is_enabled(self, lint=False, integration=False, kill=False):
        # The Cancel build option should only be available
        # when the process is still running
        if kill:
            return self.proc is not None and self.proc.poll() is None
        return True

    def run(self, lint=False, integration=False, kill=False):
        if kill:
            if self.proc:
                self.killed = True
                self.proc.terminate()
            return

        vars = self.window.extract_variables()
        working_dir = vars['file_path']

        # A lock is used to ensure only one thread is
        # touching the output panel at a time
        with self.panel_lock:
            # Creating the panel implicitly clears any previous contents
            self.panel = self.window.create_output_panel('exec')

            # Enable result navigation. The result_file_regex does
            # the primary matching, but result_line_regex is used
            # when build output includes some entries that only
            # contain line/column info beneath a previous line
            # listing the file info. The result_base_dir sets the
            # path to resolve relative file names against.
            settings = self.panel.settings()
            settings.set(
                'result_file_regex',
                r'^File "([^"]+)" line (\d+) col (\d+)'
            )
            settings.set(
                'result_line_regex',
                r'^\s+line (\d+) col (\d+)'
            )
            settings.set('result_base_dir', working_dir)

            self.window.run_command('show_panel', {'panel': 'output.exec'})

        if self.proc is not None:
            self.proc.terminate()
            self.proc = None

        args = ['my_cli']
        if lint:
            args.append('-l')
        elif integration:
            args.append('-i')
        args.append(vars['file_name'])
        self.proc = subprocess.Popen(
            args,
            stdout=subprocess.PIPE,
            stderr=subprocess.STDOUT,
            cwd=working_dir
        )
        self.killed = False

        threading.Thread(
            target=self.read_handle,
            args=(self.proc.stdout,)
        ).start()

    def read_handle(self, handle):
        chunk_size = 2 ** 13
        out = b''
        while True:
            try:
                data = os.read(handle.fileno(), chunk_size)
                # If exactly the requested number of bytes was
                # read, there may be more data, and the current
                # data may contain part of a multibyte char
                out += data
                if len(data) == chunk_size:
                    continue
                if data == b'' and out == b'':
                    raise IOError('EOF')
                # We pass out to a function to ensure the
                # timeout gets the value of out right now,
                # rather than a future (mutated) version
                self.queue_write(out.decode(self.encoding))
                if data == b'':
                    raise IOError('EOF')
                out = b''
            except (UnicodeDecodeError) as e:
                msg = 'Error decoding output using %s - %s'
                self.queue_write(msg  % (self.encoding, str(e)))
                break
            except (IOError):
                if self.killed:
                    msg = 'Cancelled'
                else:
                    msg = 'Finished'
                self.queue_write('\n[%s]' % msg)
                break

    def queue_write(self, text):
        sublime.set_timeout(lambda: self.do_write(text), 1)

    def do_write(self, text):
        with self.panel_lock:
            self.panel.run_command('append', {'characters': text})

```

The custom `MyExampleBuildCommand` can be configured as a build system using
the following JSON saved to a file named Packages/User/My Example
Build.sublime-build:

```
{
    "target": "my_example_build",
    "selector": "source.mylang",
    "cancel": {"kill": true},
    "variants": [
        {
            "name": "Lint",
            "lint": true
        },
        {
            "name": "Integration Tests",
            "integration": true
        }
    ]
}

```

[Introducing our Git client

**![](/images/merge_icon.svg) Sublime Merge**
![](data:image/gif;base64...)](https://www.sublimemerge.com)

© [Sublime HQ Pty Ltd](https://www.sublimehq.com)

Woollahra, Sydney.

[Follow @sublimehq](https://twitter.com/sublimehq?ref_src=twsrc%5Etfw)



=== Content from exploitart.ist_46a10db1_20250114_211854.html ===


* [/root](/)
* [/about](/about/)
* [/blog](/blog/)
* [/exploits](/exploits/)
* [/contact](/contact/)

# Exploit Title: Sublime Text 4 - OS Command Injection

# Discovered by: Ahmet Ümit BAYRAM

# Discovered Date: 17.09.2023

# Vendor Homepage: https://www.sublimetext.com

# Software Link: https://www.sublimetext.com/download\_thanks?target=win-x64

# Tested Version: 4 (latest)

# Tested on: Windows 2019 Server 64bit

### Steps to Reproduce

1. Open Sublime Text.
2. Navigate to **Tools > Build System > New Build System…**
3. In the newly opened configuration window, paste the following code:

   ```
    {
        "shell_cmd": "your reverse shell code goes here",
        "shell": true
    }

   ```
4. Use the **File > Save** option to save this configuration. (For example, save it as `ReverseShell.sublime-build`).
5. From the **Tools > Build System** menu, select the `ReverseShell` option that you just saved.
6. Press `Ctrl + B` to run the build system.
7. Your reverse shell should now be active.

Replace `"your reverse shell code goes here"` with your actual reverse shell command to establish a connection.

exploit artist - copyLeft 2024



=== Content from forum.sublimetext.com_20bdc870_20250114_211855.html ===

[## Sublime Forum](/)

# [Cve-2024-25255 Critical](/t/cve-2024-25255-critical/74906)

[Technical Support](/c/technical-support)

[**Ryukrg**](/u/Ryukrg)

December 23, 2024, 7:28pm

#1

Hi,

Can you help me please,

What is the version with issues?, and are there a patch?

Thanks

0 Likes

---

[**2cents**](/u/2cents)
December 23, 2024, 7:59pm

#2

I would consider this an invalid CVE as this is intended behavior outlined within Sublime Text’s Build System’s documentation (<https://www.sublimetext.com/docs/build_systems.html#exec-target-options>). Check the reference website from the CVE record (<https://www.cve.org/CVERecord?id=CVE-2024-25255>) and make the determination for yourself.

0 Likes

---

[**deathaxe**](/u/deathaxe)
December 23, 2024, 8:18pm

#3

What a bullshit CVE!

ST’s build system is just an entry point to run shell scripts.

What the CVE describes as “OS Command Injection” is by design the primary function of ST’s build system.

Can you start harmfull shell scripts by hitting `ctrl+b`. For sure, but you can do so with a `make` as well.

3 Likes

---

[**ravindUwU**](/u/ravindUwU)
December 25, 2024, 5:34am

#4

New sh/bash/zsh vulnerability found. You can launch one of those, `<your reverse shell code goes here>`, hit enter, your reverse shell should now be active! 🤦

0 Likes

---

[Home](/)
[Categories](/categories)
[FAQ/Guidelines](/guidelines)
[Terms of Service](/tos)
[Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled

[![Sublime HQ](https://www.sublimehq.com/images/logo.svg)](https://www.sublimehq.com)
[Products](https://www.sublimehq.com/)
[Buy](https://www.sublimehq.com/buy)

[News](https://www.sublimetext.com/blog/)
[Forum](https://forum.sublimetext.com/)



=== Content from www.sublimetext.com_cb774b38_20250114_211857.html ===

[![Sublime Text](/images/logo.svg)](/)
[Download](/download)
[Buy](https://www.sublimehq.com/store/text)
[Support](/support)

[News](/blog/)
[Forum](https://forum.sublimetext.com)

# [Documentation](/docs/index.html) [TOC](#toc) TOP Build Systems Version:

Sublime Text provides *build systems* to allow users to run external programs.
Examples of common uses for build systems include: compiling, transpiling,
linting, and executing tests.

Build systems are specified via JSON and saved in a file with the
extension .sublime-build. A new build system can be created by
the Tools ![▶](/images/right.svg) Build System ![▶](/images/right.svg) New Build System… menu item or the `Build:
New Build System` command palette entry.

Build systems have various ways they can associate themselves with files and
projects. Using this information, Sublime Text can intelligently display only
viable build systems to the user. The built-in `exec` target
provides common options to get up and running quickly. For more complex
requirements, build systems can target custom Sublime Text commands written in
Python.

* [Basic Example](#basic-example)
* [Usage](#usage)
* [Options](#options)
* [exec Target Options](#exec-target-options)
* [Custom Options](#custom-options)
* [Variables](#variables)
* [Advanced Example](#advanced-example)

## Basic Example[🔗](#basic-example "Permalink to this heading")

The following is a basic example of a build system. This build system will
execute the currently-open Python file.

```
{
    "cmd": ["python", "$file"],
    "selector": "source.python",
    "file_regex": "^\\s*File \"(...*?)\", line ([0-9]*)"
}

```

The [Usage](#usage) and [Options](#options) sections will discuss how to use and customize a
build system.

## Usage[🔗](#usage "Permalink to this heading")

Build systems include the following functionality:

* Automatic selection of a build system based on file type
* Remembering the last used build system
* Navigation of build system results
* Ability to cancel a build

### Running a Build[🔗](#running-a-build "Permalink to this heading")

A build can be run by one of the following methods:

| Keyboard | | | Menu |
| --- | --- | --- | --- |
| *Windows/Linux* | *Mac* | *All* | Tools ▶ Build |
| **Ctrl***+***B** | **⌘***+***B** | **F7** |

Output will be shown in an output panel displayed at the bottom of the Sublime
Text window.

### Selecting a Build System[🔗](#selecting-a-build-system "Permalink to this heading")

By default, Sublime Text uses automatic selection of build systems. When a user
invokes a build, the current file’s syntax and filename will be used to pick
the appropriate build system.

If more than one build system matches the current file type, the user will be
prompted to pick the build system they wish to use. Once a build system has
been selected, Sublime Text will remember it until the user changes their
selection.

To manually choose a build system, use: Tools ![▶](/images/right.svg) Build System

To change the build system, within the viable options, use one of the following
methods:

| Keyboard | | Menu | Command Palette |
| --- | --- | --- | --- |
| *Windows/Linux* | *Mac* | Tools ▶ Build With… | `Build With:` |
| **Ctrl***+***Shift***+***B** | **⇧***+***⌘***+***B** |

### Navigating Results[🔗](#navigating-results "Permalink to this heading")

Build systems allow navigation of files specified in the build output. Typically
this is used to jump to the location of errors. Navigation can be performed
via:

| Command | Keyboard | Menu |
| --- | --- | --- |
| Next Result | **F4** | Tools ▶ Build Results ▶ Next Result |
| Previous Result | **Shift***+***F4** | Tools ▶ Build Results ▶ Previous Result |

### Cancelling a Build[🔗](#cancelling-a-build "Permalink to this heading")

An in-process build can be cancelled via:

| Keyboard | | Menu | Command Palette |
| --- | --- | --- | --- |
| *Windows/Linux* | *Mac* | Tools ▶ Cancel Build | `Build: Cancel` |
| **Ctrl***+***Break** | **Ctrl***+***C** |

## Options[🔗](#options "Permalink to this heading")

All build systems may use the following top-level keys in
the .sublime-build file:

"selector" string[🔗](#selector "Permalink to this definition")

A [selector](selectors.html) to match the syntax that this build system should
be enabled for.

Example: `"source.python"`

"file\_patterns" array of strings[🔗](#file_patterns "Permalink to this definition")

[Patterns](file_patterns.html) of file names the build system should be enabled
for.

Example: `["*.py"]`

"keyfiles" array of strings[🔗](#keyfiles "Permalink to this definition")

File names, if present in one of the opened folders, that will cause the
build system to be enabled.

Example: `["Makefile"]`

"variants" array of objects[🔗](#variants "Permalink to this definition")

Subsidiary build systems that will inherit the options from the top-level
build system. Each variant needs to specify a `"name"` key, and may
override or add options to the top-level build system.

Example:

```
[
    {
        "name": "Debug Symbols",
        "cmd": ["my_command", "-D", "$file"]
    }
]

```

"cancel" string, array of strings[🔗](#cancel "Permalink to this definition")

A string command name, or an array of string options.

If a string is specified, the command specified will be used to cancel the
build.

If an array of strings, the primary `"target"` will be called, with these
options added on. This only needs to be specified when using a custom
`"target"`.

Examples: `"cancel_my_build"` or `{ "kill": true }`

"target" string[🔗](#target "Permalink to this definition")

The command to run when the build system is invoked. The default value of
`exec` allows use of the additional options specified in [exec Target
Options](#exec-target-options).

If a value other than `"exec"` is specified, none of the options in [exec
Target Options](#exec-target-options) will do anything.

See the [Advanced Example](#advanced-example) for a complete example.

Example: `"my_build"`

"windows" object[🔗](#windows "Permalink to this definition")

Options to use when the build system is being executed on a Windows
machine.

Example:

```
{
    "cmd": ["my_command.exe", "/D", "$file"]
}

```

"osx" object[🔗](#osx "Permalink to this definition")

Options to use when the build system is being executed on a Mac machine.

Example:

```
{
    "cmd": ["/Applications/MyProgram.app/Contents/MacOS/my_command", "-d", "$file"]
}

```

"linux" object[🔗](#linux "Permalink to this definition")

Options to use when the build system is being executed on a Linux machine.

Example:

```
{
    "cmd": ["/usr/local/bin/my_command", "-d", "$file"]
}

```

## `exec` Target Options[🔗](#exec-target-options "Permalink to this heading")

The default `target` of `exec` is used by the majority of build systems. It
provides the following options to control what program to execute, and how to
display the results.

"cmd" array of strings[🔗](#cmd "Permalink to this definition")

The executable to run, plus any arguments to pass to it. Shell constructs
such as piping and redirection are not supported – see [`"shell_cmd"`](#shell_cmd "\"shell_cmd\"").

May use [variables](#variables).

Example: `["my_command", "-d", "$file"]`

"shell\_cmd" string[🔗](#shell_cmd "Permalink to this definition")

A shell command to execute. Unlike the [`"cmd"`](#cmd "\"cmd\"") option, this does allow
piping and redirection. Will use `bash` on Mac and Linux machine, and
`cmd.exe` on Windows.

This takes precedence over [`"cmd"`](#cmd "\"cmd\""). If you want to override the
[`"shell_cmd"`](#shell_cmd "\"shell_cmd\"") in a build variant with a [`"cmd"`](#cmd "\"cmd\"") then also set the
[`"shell_cmd"`](#shell_cmd "\"shell_cmd\"") to `null`.

May use [variables](#variables).

Example: `"my_command \"$file\" | other_command"`

"working\_dir" string[🔗](#working_dir "Permalink to this definition")

The directory to execute the [`"cmd"`](#cmd "\"cmd\"") or [`"shell_cmd"`](#shell_cmd "\"shell_cmd\"") within.

May use [variables](#variables).

Example: `"$file_path"`

"file\_regex" string[🔗](#file_regex "Permalink to this definition")

A regular expression to run on the build output to match file information.
The matched file information is used to enable result navigation. The regex
should capture 2, 3 or 4 groups.

The capture groups should be:

1. filename
2. line number
3. column number
4. message

Example: `"^\s*(\\S[^:]*)\\((\\d+):(\\d+)\\): ([^\\n]+)"`

"line\_regex" string[🔗](#line_regex "Permalink to this definition")

A regular expression to run on the build output to match line information.
The matched file information is used to enable result navigation. The regex
should capture 1, 2 or 3 groups.

The groups should capture:

1. line number
2. column number
3. error message

This regular expression is only necessary when some results contain strictly
a line number, line and column numbers, or line and column numbers with a
message. When such a match is made, the [`"file_regex"`](#file_regex "\"file_regex\"") option will be used
to search backwards to find the appropriate file name.

Example: `"^\s*line (\\d+) col (\\d+): ([^\\n]+)"`

"encoding" string[🔗](#encoding "Permalink to this definition")

The encoding of the build system output. Uses [Python codec names](https://docs.python.org/3.3/library/codecs.html#id3). Defaults to
`"utf-8"`.

Example: `"iso-8859-1"`

"env" object[🔗](#env "Permalink to this definition")

Environment variable values to use when running the [`"cmd"`](#cmd "\"cmd\"") or
[`"shell_cmd"`](#shell_cmd "\"shell_cmd\"").

Example:

```
{
    "PYTHONIOENCODING": "utf-8"
}

```

"quiet" boolean[🔗](#quiet "Permalink to this definition")

Reduces the amount of output about the build system invocation.

Example: `true`

"word\_wrap" boolean[🔗](#word_wrap "Permalink to this definition")

Turns on word wrapping in the build system output panel.

Example: `true`

"syntax" string[🔗](#syntax "Permalink to this definition")

The syntax file to use to highlight the build system output panel.

Example: `"Packages/JavaScript/JSON.sublime-syntax"`

## Custom Options[🔗](#custom-options "Permalink to this heading")

When implementing a command to act as a build system target, the command’s
keyword arguments are available via options in the .sublime-build file.
However, certain parameter names will not work since they conflict with
built-in build system functionality.

The following names will not be passed as arguments to commands. This also
applies to other situations, such as options specified in the `"cancel"`,
`"linux"`, `"osx"` and `"windows"` options.

* `"cancel"`
* `"file_patterns"`
* `"keyfile"`
* `"keyfiles"`
* `"linux"`
* `"osx"`
* `"save_untitled_files"`
* `"selector"`
* `"target"`
* `"variants"`
* `"windows"`
## Variables[🔗](#variables "Permalink to this heading")

The following variables will be expanded within any string specified in the
`"cmd"`, `"shell_cmd"` or `"working_dir"` options.

If a literal `$` needs to be specified in one of these options, it must be
escaped with a `\`. Since JSON uses backslashes for escaping also, `$` will
need to be written as `\\$`.

Please note that this substitution will occur for any <span
class=”key”>”target”</span>. If a custom target is used, it may implement
variable expansion for additional options by using
`sublime.expand_variables()` with the result from
`self.window.extract_variables()`. </p>

| Variable | Description |
| --- | --- |
| `$packages` | The path to the Packages/ folder. |
| `$platform` | The platform Sublime Text is running on: `"windows"`, `"osx"` or `"linux"`. |
| `$file` | The full path, including folder, to the file in the active view. |
| `$file_path` | The path to the folder that contains the file in the active view. |
| `$file_name` | The file name (sans folder path) of the file in the active view. |
| `$file_base_name` | The file name, exluding the extension, of the file in the active view. |
| `$file_extension` | The extension of the file name of the file in the active view. |
| `$folder` | The full path to the first folder listed in the side bar. |
| `$project` | The full path to the current project file. |
| `$project_path` | The path to the folder containing the current project file. |
| `$project_name` | The file name (sans folder path) of the current project file. |
| `$project_base_name` | The file name, excluding the extension, of the current project file. |
| `$project_extension` | The extension of the current project file. |

## Advanced Example[🔗](#advanced-example "Permalink to this heading")

The following example shows a custom `target` command, with the ability to
cancel a build and navigate results.

A `target` for a build system should be a [`sublime_plugin.WindowCommand`](api_reference.html#sublime_plugin.WindowCommand "sublime_plugin.WindowCommand"). This
will provide the instance variable of `self.window` to allow interaction with
the current project, window and active view.

*Please note that the following example is somewhat simplistic in its
implementation, and it won’t handle many common edge cases.*

The following Python can be saved to a file
named Package/User/my\_example\_build.py:

```
import sublime
import sublime_plugin

import subprocess
import threading
import os

class MyExampleBuildCommand(sublime_plugin.WindowCommand):

    encoding = 'utf-8'
    killed = False
    proc = None
    panel = None
    panel_lock = threading.Lock()

    def is_enabled(self, lint=False, integration=False, kill=False):
        # The Cancel build option should only be available
        # when the process is still running
        if kill:
            return self.proc is not None and self.proc.poll() is None
        return True

    def run(self, lint=False, integration=False, kill=False):
        if kill:
            if self.proc:
                self.killed = True
                self.proc.terminate()
            return

        vars = self.window.extract_variables()
        working_dir = vars['file_path']

        # A lock is used to ensure only one thread is
        # touching the output panel at a time
        with self.panel_lock:
            # Creating the panel implicitly clears any previous contents
            self.panel = self.window.create_output_panel('exec')

            # Enable result navigation. The result_file_regex does
            # the primary matching, but result_line_regex is used
            # when build output includes some entries that only
            # contain line/column info beneath a previous line
            # listing the file info. The result_base_dir sets the
            # path to resolve relative file names against.
            settings = self.panel.settings()
            settings.set(
                'result_file_regex',
                r'^File "([^"]+)" line (\d+) col (\d+)'
            )
            settings.set(
                'result_line_regex',
                r'^\s+line (\d+) col (\d+)'
            )
            settings.set('result_base_dir', working_dir)

            self.window.run_command('show_panel', {'panel': 'output.exec'})

        if self.proc is not None:
            self.proc.terminate()
            self.proc = None

        args = ['my_cli']
        if lint:
            args.append('-l')
        elif integration:
            args.append('-i')
        args.append(vars['file_name'])
        self.proc = subprocess.Popen(
            args,
            stdout=subprocess.PIPE,
            stderr=subprocess.STDOUT,
            cwd=working_dir
        )
        self.killed = False

        threading.Thread(
            target=self.read_handle,
            args=(self.proc.stdout,)
        ).start()

    def read_handle(self, handle):
        chunk_size = 2 ** 13
        out = b''
        while True:
            try:
                data = os.read(handle.fileno(), chunk_size)
                # If exactly the requested number of bytes was
                # read, there may be more data, and the current
                # data may contain part of a multibyte char
                out += data
                if len(data) == chunk_size:
                    continue
                if data == b'' and out == b'':
                    raise IOError('EOF')
                # We pass out to a function to ensure the
                # timeout gets the value of out right now,
                # rather than a future (mutated) version
                self.queue_write(out.decode(self.encoding))
                if data == b'':
                    raise IOError('EOF')
                out = b''
            except (UnicodeDecodeError) as e:
                msg = 'Error decoding output using %s - %s'
                self.queue_write(msg  % (self.encoding, str(e)))
                break
            except (IOError):
                if self.killed:
                    msg = 'Cancelled'
                else:
                    msg = 'Finished'
                self.queue_write('\n[%s]' % msg)
                break

    def queue_write(self, text):
        sublime.set_timeout(lambda: self.do_write(text), 1)

    def do_write(self, text):
        with self.panel_lock:
            self.panel.run_command('append', {'characters': text})

```

The custom `MyExampleBuildCommand` can be configured as a build system using
the following JSON saved to a file named Packages/User/My Example
Build.sublime-build:

```
{
    "target": "my_example_build",
    "selector": "source.mylang",
    "cancel": {"kill": true},
    "variants": [
        {
            "name": "Lint",
            "lint": true
        },
        {
            "name": "Integration Tests",
            "integration": true
        }
    ]
}

```

[Introducing our Git client

**![](/images/merge_icon.svg) Sublime Merge**
![](data:image/gif;base64...)](https://www.sublimemerge.com)

© [Sublime HQ Pty Ltd](https://www.sublimehq.com)

Woollahra, Sydney.

[Follow @sublimehq](https://twitter.com/sublimehq?ref_src=twsrc%5Etfw)


