=== Content from infosecwriteups.com_69efd8c7_20250115_080456.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F13787c4d97b4&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderCollection&source=---top_nav_layout_nav----------------------------------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

[Sign up](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# DLL hijacking in TOTOLINK A600UB Driver Installer | CVE-2024–51141

[![Miguel Méndez Z.](https://miro.medium.com/v2/resize:fill:88:88/1*Q4hN4YUHZYVEO_qiggsBWQ@2x.jpeg)](https://medium.com/%40s1kr10s?source=post_page---byline--13787c4d97b4--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:48:48/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---byline--13787c4d97b4--------------------------------)

[Miguel Méndez Z.](https://medium.com/%40s1kr10s?source=post_page---byline--13787c4d97b4--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F691af447be50&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&user=Miguel+M%C3%A9ndez+Z.&userId=691af447be50&source=post_page-691af447be50--byline--13787c4d97b4---------------------post_header-----------)

Published in[InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---byline--13787c4d97b4--------------------------------)·4 min read·Oct 27, 2024

--

Listen

Share

![]()
# Introduction

In this article, we will explore a DLL Hijacking vulnerability detected in a driver installer for Realtek, used by the device company TOTOLINK in one of its USB modems. We will analyze how this vulnerability works and its implications in terms of security. Through this analysis, we aim to provide a deep understanding of this threat and promote more robust development and security practices to prevent future incidents.

# What is DLL Hijacking?

DLL Hijacking is an attack technique that exploits the way Windows loads dynamic link libraries (DLLs). When an application requires a DLL, Windows follows a search order to locate it. An attacker can place a malicious DLL in a preferred location within this order, causing it to load instead of the legitimate DLL. This allows the attacker to execute malicious code with the same privileges as the application, potentially compromising the system and performing unauthorized actions.

# Technical Details

![]()

* Installer Executable
* Operating System: Windows 10/8.1/8/7/XP
* Download Binarie: <https://totolink.com.my/products/a600ub/>

# Exploitation Process

Upon downloading and executing the binary, it presents two installation options: the first allows the installation of the Wi-Fi driver, while the second option is for installing the Bluetooth driver. Both drivers are installed and are ultimately stored on the disk.

![]()

After completing the installation and configuration process, the corresponding files are saved on the hard drive, specifically in the path `C:\Program Files\TOTOLINK\WiFiAutoInstall`.

![]()

When executing the corresponding binary, it can be observed, through the use of the Procmon tool, that the binary makes calls to several DLLs. However, these DLLs are not present on the system or in the current path of the binary, allowing the end user to add a custom DLL to execute a specific action.

![]()

It can be observed that `lpVerb` is set to "runas," which indicates that the program will run with administrator privileges, activating User Account Control (UAC). This will then execute `WifiAutoInstallDriver.exe`, which is set in `lpFile`.

![]()

Here is a basic code to create a test DLL that executes `cmd.exe` when loaded.

![]()
# Exploitation Chain Flow

With the identification of the missing DLL and the creation of a custom DLL, the attacker could place this DLL in a directory from which the trusted binary can load it. The attacker could then wait for an administrator to execute the legitimate binary or use social engineering techniques to convince a user with appropriate permissions to run the binary. This would cause the binary to load the malicious DLL, allowing the attacker to elevate their privileges on the system.

![]()
# Video PoC

# **Conclusion**

The analysis of the DLL Hijacking vulnerability in the TOTOLINK A600UB driver installer reveals a critical security gap that can be easily exploited to compromise systems. By detecting and taking advantage of the absence of certain DLLs during the installation process, an attacker has the opportunity to inject malicious code, achieving privilege escalation that grants control over the affected system. This type of vulnerability underscores the urgent need to adopt more secure development practices, such as thorough validation of loaded files and careful management of DLL search paths.

# Advisory Timeline

* October 14, 2024: Initial Contact with the Vendor
* October 16, 2024: Request for CVE ID Submitted
* November 13, 2024: CVE-2024–51141 Assigned

Bye, see you soon…

[Research](https://medium.com/tag/research?source=post_page-----13787c4d97b4--------------------------------)[Exploitation](https://medium.com/tag/exploitation?source=post_page-----13787c4d97b4--------------------------------)[Binary](https://medium.com/tag/binary?source=post_page-----13787c4d97b4--------------------------------)[Reversing](https://medium.com/tag/reversing?source=post_page-----13787c4d97b4--------------------------------)[Dll Hijacking](https://medium.com/tag/dll-hijacking?source=post_page-----13787c4d97b4--------------------------------)

--

--

[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:96:96/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--13787c4d97b4--------------------------------)[![InfoSec Write-ups](https://miro.medium.com/v2/resize:fill:128:128/1*SWJxYWGZzgmBP1D0Qg_3zQ.png)](https://infosecwriteups.com/?source=post_page---post_publication_info--13787c4d97b4--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fbugbountywriteup&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&collection=InfoSec+Write-ups&collectionId=7b722bfd1b8d&source=post_page---post_publication_info--13787c4d97b4---------------------follow_profile-----------)[## Published in InfoSec Write-ups](https://infosecwriteups.com/?source=post_page---post_publication_info--13787c4d97b4--------------------------------)[50K Followers](/followers?source=post_page---post_publication_info--13787c4d97b4--------------------------------)·[Last published 2 days ago](/bypassing-endpoint-detection-and-response-edr-solutions-practical-evasion-techniques-with-fc041ad65d0b?source=post_page---post_publication_info--13787c4d97b4--------------------------------)

A collection of write-ups from the best hackers in the world on topics ranging from bug bounties and CTFs to vulnhub machines, hardware challenges and real life encounters. Subscribe to our weekly newsletter for the coolest infosec updates: <https://weekly.infosecwriteups.com/>

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fcollection%2Fbugbountywriteup&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&collection=InfoSec+Write-ups&collectionId=7b722bfd1b8d&source=post_page---post_publication_info--13787c4d97b4---------------------follow_profile-----------)[![Miguel Méndez Z.](https://miro.medium.com/v2/resize:fill:96:96/1*Q4hN4YUHZYVEO_qiggsBWQ@2x.jpeg)](https://medium.com/%40s1kr10s?source=post_page---post_author_info--13787c4d97b4--------------------------------)[![Miguel Méndez Z.](https://miro.medium.com/v2/resize:fill:128:128/1*Q4hN4YUHZYVEO_qiggsBWQ@2x.jpeg)](https://medium.com/%40s1kr10s?source=post_page---post_author_info--13787c4d97b4--------------------------------)[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F691af447be50&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&user=Miguel+M%C3%A9ndez+Z.&userId=691af447be50&source=post_page-691af447be50--post_author_info--13787c4d97b4---------------------follow_profile-----------)[## Written by Miguel Méndez Z.](https://medium.com/%40s1kr10s?source=post_page---post_author_info--13787c4d97b4--------------------------------)[142 Followers](https://medium.com/%40s1kr10s/followers?source=post_page---post_author_info--13787c4d97b4--------------------------------)·[45 Following](https://medium.com/%40s1kr10s/following?source=post_page---post_author_info--13787c4d97b4--------------------------------)

<https://s1kr10s.github.io/whoami.html> — @s1kr10s

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F691af447be50&operation=register&redirect=https%3A%2F%2Finfosecwriteups.com%2Fdll-hijacking-in-totolink-a600ub-driver-installer-13787c4d97b4&user=Miguel+M%C3%A9ndez+Z.&userId=691af447be50&source=post_page-691af447be50--post_author_info--13787c4d97b4---------------------follow_profile-----------)
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----13787c4d97b4--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----13787c4d97b4--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----13787c4d97b4--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----13787c4d97b4--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----13787c4d97b4--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----13787c4d97b4--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----13787c4d97b4--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----13787c4d97b4--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----13787c4d97b4--------------------------------)[Teams](https://medium.com/business?source=post_page-----13787c4d97b4--------------------------------)


