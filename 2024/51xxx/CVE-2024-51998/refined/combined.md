=== Content from github.com_25f185ac_20250114_193539.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fsecurity%2Fadvisories%2FGHSA-6jrf-rcjf-245r)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fsecurity%2Fadvisories%2FGHSA-6jrf-rcjf-245r)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dgtlmoon%2Fchangedetection.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dgtlmoon](/dgtlmoon)
/
**[changedetection.io](/dgtlmoon/changedetection.io)**
Public

* [Notifications](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)
* [Star
   21.1k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)

* [Code](/dgtlmoon/changedetection.io)
* [Issues
  223](/dgtlmoon/changedetection.io/issues)
* [Pull requests
  35](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects
  0](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

Additional navigation options

* [Code](/dgtlmoon/changedetection.io)
* [Issues](/dgtlmoon/changedetection.io/issues)
* [Pull requests](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

# Path traversal using file URI scheme without supplying hostname

High

[dgtlmoon](/dgtlmoon)
published
GHSA-6jrf-rcjf-245r
Nov 7, 2024

## Package

pip

changedetection.io
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<= 0.47.05

## Patched versions

0.47.06

docker

dgtlmoon/changedetection.io
([Docker](/advisories?query=ecosystem%3Adocker))

<= 0.47.05

0.47.06

docker

ghcr.io/dgtlmoon/changedetection.io
([Docker](/advisories?query=ecosystem%3Adocker))

<= 0.47.05

0.47.06

## Description

### Summary

The validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.

### Details

The check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:

[changedetection.io/changedetectionio/model/Watch.py](https://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13)

Lines 11 to 13
in
[e0abf0b](/dgtlmoon/changedetection.io/commit/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4)

|  | # Allowable protocols, protects against javascript: etc |
| --- | --- |
|  | # file:// is further checked by ALLOW\_FILE\_URI |
|  | SAFE\_PROTOCOL\_REGEX='^(http|https|ftp|file):' |

It later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.

> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.
>
> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)

[changedetection.io/changedetectionio/processors/\_\_init\_\_.py](https://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41)

Lines 37 to 41
in
[e0abf0b](/dgtlmoon/changedetection.io/commit/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4)

|  | if re.search(r'^file://', url, re.IGNORECASE): |
| --- | --- |
|  | if not strtobool(os.getenv('ALLOW\_FILE\_URI', 'false')): |
|  | raise Exception( |
|  | "file:// type access is denied for security reasons." |
|  | ) |

### PoC

1. Open up a changedetection.io instance with a webdriver configured
2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode
3. Wait for it to be checked
4. Open preview
5. Notice contents of the file

### Severity

High

8.6

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N

### CVE ID

CVE-2024-51998

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### Credits

* [![@Erb3](https://avatars.githubusercontent.com/u/49862976?s=40&v=4)](/Erb3)
  [Erb3](/Erb3)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_91ee419b_20250114_193537.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fblob%2Fe0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4%2Fchangedetectionio%2Fmodel%2FWatch.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fblob%2Fe0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4%2Fchangedetectionio%2Fmodel%2FWatch.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=dgtlmoon%2Fchangedetection.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dgtlmoon](/dgtlmoon)
/
**[changedetection.io](/dgtlmoon/changedetection.io)**
Public

* [Notifications](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)
* [Star
   21.1k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)

* [Code](/dgtlmoon/changedetection.io)
* [Issues
  223](/dgtlmoon/changedetection.io/issues)
* [Pull requests
  35](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects
  0](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

Additional navigation options

* [Code](/dgtlmoon/changedetection.io)
* [Issues](/dgtlmoon/changedetection.io/issues)
* [Pull requests](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

## Files

 e0abf0b
## Breadcrumbs

1. [changedetection.io](/dgtlmoon/changedetection.io/tree/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4)
2. /[changedetectionio](/dgtlmoon/changedetection.io/tree/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio)
3. /[model](/dgtlmoon/changedetection.io/tree/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model)
/
# Watch.py

Copy path Blame  Blame
## Latest commit

## History

[History](/dgtlmoon/changedetection.io/commits/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py)641 lines (500 loc) · 22.7 KB e0abf0b
## Breadcrumbs

1. [changedetection.io](/dgtlmoon/changedetection.io/tree/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4)
2. /[changedetectionio](/dgtlmoon/changedetection.io/tree/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio)
3. /[model](/dgtlmoon/changedetection.io/tree/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model)
/
# Watch.py

Top
## File metadata and controls

* Code
* Blame

641 lines (500 loc) · 22.7 KB[Raw](https://github.com/dgtlmoon/changedetection.io/raw/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641from changedetectionio.strtobool import strtoboolfrom changedetectionio.safe\_jinja import render as jinja\_renderfrom . import watch\_baseimport osimport refrom pathlib import Pathfrom loguru import logger
from ..html\_tools import TRANSLATE\_WHITESPACE\_TABLE
# Allowable protocols, protects against javascript: etc# file:// is further checked by ALLOW\_FILE\_URISAFE\_PROTOCOL\_REGEX='^(http|https|ftp|file):'
minimum\_seconds\_recheck\_time = int(os.getenv('MINIMUM\_SECONDS\_RECHECK\_TIME', 3))mtable = {'seconds': 1, 'minutes': 60, 'hours': 3600, 'days': 86400, 'weeks': 86400 \* 7}
def is\_safe\_url(test\_url): # See https://github.com/dgtlmoon/changedetection.io/issues/1358
 # Remove 'source:' prefix so we dont get 'source:javascript:' etc # 'source:' is a valid way to tell us to return the source
 r = re.compile(re.escape('source:'), re.IGNORECASE) test\_url = r.sub('', test\_url)
 pattern = re.compile(os.getenv('SAFE\_PROTOCOL\_REGEX', SAFE\_PROTOCOL\_REGEX), re.IGNORECASE) if not pattern.match(test\_url.strip()): return False
 return True
class model(watch\_base): \_\_newest\_history\_key = None \_\_history\_n = 0 jitter\_seconds = 0
 def \_\_init\_\_(self, \*arg, \*\*kw): self.\_\_datastore\_path = kw.get('datastore\_path') if kw.get('datastore\_path'): del kw['datastore\_path'] super(model, self).\_\_init\_\_(\*arg, \*\*kw) if kw.get('default'): self.update(kw['default']) del kw['default']
 if self.get('default'): del self['default']
 # Be sure the cached timestamp is ready bump = self.history
 @property def viewed(self): # Don't return viewed when last\_viewed is 0 and newest\_key is 0 if int(self['last\_viewed']) and int(self['last\_viewed']) >= int(self.newest\_history\_key) : return True
 return False
 def ensure\_data\_dir\_exists(self): if not os.path.isdir(self.watch\_data\_dir): logger.debug(f"> Creating data dir {self.watch\_data\_dir}") os.mkdir(self.watch\_data\_dir)
 @property def link(self):
 url = self.get('url', '') if not is\_safe\_url(url): return 'DISABLED'
 ready\_url = url if '{%' in url or '{{' in url: # Jinja2 available in URLs along with https://pypi.org/project/jinja2-time/ try: ready\_url = jinja\_render(template\_str=url) except Exception as e: logger.critical(f"Invalid URL template for: '{url}' - {str(e)}") from flask import ( flash, Markup, url\_for ) message = Markup('<a href="{}#general">The URL {} is invalid and cannot be used, click to edit</a>'.format( url\_for('edit\_page', uuid=self.get('uuid')), self.get('url', ''))) flash(message, 'error') return ''
 if ready\_url.startswith('source:'): ready\_url=ready\_url.replace('source:', '')
 # Also double check it after any Jinja2 formatting just incase if not is\_safe\_url(ready\_url): return 'DISABLED' return ready\_url
 def clear\_watch(self): import pathlib
 # JSON Data, Screenshots, Textfiles (history index and snapshots), HTML in the future etc for item in pathlib.Path(str(self.watch\_data\_dir)).rglob("\*.\*"): os.unlink(item)
 # Force the attr to recalculate bump = self.history
 # Do this last because it will trigger a recheck due to last\_checked being zero self.update({ 'browser\_steps\_last\_error\_step': None, 'check\_count': 0, 'fetch\_time': 0.0, 'has\_ldjson\_price\_data': None, 'last\_checked': 0, 'last\_error': False, 'last\_notification\_error': False, 'last\_viewed': 0, 'previous\_md5': False, 'previous\_md5\_before\_filters': False, 'remote\_server\_reply': None, 'track\_ldjson\_price\_data': None }) return
 @property def is\_source\_type\_url(self): return self.get('url', '').startswith('source:')
 @property def get\_fetch\_backend(self): """ Like just using the `fetch\_backend` key but there could be some logic :return: """ # Maybe also if is\_image etc? # This is because chrome/playwright wont render the PDF in the browser and we will just fetch it and use pdf2html to see the text. if self.is\_pdf: return 'html\_requests'
 return self.get('fetch\_backend')
 @property def is\_pdf(self): # content\_type field is set in the future # https://github.com/dgtlmoon/changedetection.io/issues/1392 # Not sure the best logic here return self.get('url', '').lower().endswith('.pdf') or 'pdf' in self.get('content\_type', '').lower()
 @property def label(self): # Used for sorting return self.get('title') if self.get('title') else self.get('url')
 @property def last\_changed(self): # last\_changed will be the newest snapshot, but when we have just one snapshot, it should be 0 if self.\_\_history\_n <= 1: return 0 if self.\_\_newest\_history\_key: return int(self.\_\_newest\_history\_key) return 0
 @property def history\_n(self): return self.\_\_history\_n
 @property def history(self): """History index is just a text file as a list {watch-uuid}/history.txt
 contains a list like
 {epoch-time},{filename}\n
 We read in this list as the history information
 """ tmp\_history = {}
 # In the case we are only using the watch for processing without history if not self.watch\_data\_dir: return []
 # Read the history file as a dict fname = os.path.join(self.watch\_data\_dir, "history.txt") if os.path.isfile(fname): logger.debug(f"Reading watch history index for {self.get('uuid')}") with open(fname, "r") as f: for i in f.readlines(): if ',' in i: k, v = i.strip().split(',', 2)
 # The index history could contain a relative path, so we need to make the fullpath # so that python can read it if not '/' in v and not '\'' in v: v = os.path.join(self.watch\_data\_dir, v) else: # It's possible that they moved the datadir on older versions # So the snapshot exists but is in a different path snapshot\_fname = v.split('/')[-1] proposed\_new\_path = os.path.join(self.watch\_data\_dir, snapshot\_fname) if not os.path.exists(v) and os.path.exists(proposed\_new\_path): v = proposed\_new\_path
 tmp\_history[k] = v
 if len(tmp\_history): self.\_\_newest\_history\_key = list(tmp\_history.keys())[-1] else: self.\_\_newest\_history\_key = None
 self.\_\_history\_n = len(tmp\_history)
 return tmp\_history
 @property def has\_history(self): fname = os.path.join(self.watch\_data\_dir, "history.txt") return os.path.isfile(fname)
 @property def has\_browser\_steps(self): has\_browser\_steps = self.get('browser\_steps') and list(filter( lambda s: (s['operation'] and len(s['operation']) and s['operation'] != 'Choose one' and s['operation'] != 'Goto site'), self.get('browser\_steps')))
 return has\_browser\_steps
 @property def has\_restock\_info(self): if self.get('restock') and self['restock'].get('in\_stock') != None: return True
 return False
 # Returns the newest key, but if theres only 1 record, then it's counted as not being new, so return 0. @property def newest\_history\_key(self): if self.\_\_newest\_history\_key is not None: return self.\_\_newest\_history\_key
 if len(self.history) <= 1: return 0
 bump = self.history return self.\_\_newest\_history\_key
 # Given an arbitrary timestamp, find the closest next key # For example, last\_viewed = 1000 so it should return the next 1001 timestamp # # used for the [diff] button so it can preset a smarter from\_version @property def get\_next\_snapshot\_key\_to\_last\_viewed(self):
 """Unfortunately for now timestamp is stored as string key""" keys = list(self.history.keys()) if not keys: return None
 last\_viewed = int(self.get('last\_viewed')) prev\_k = keys[0] sorted\_keys = sorted(keys, key=lambda x: int(x)) sorted\_keys.reverse()
 # When the 'last viewed' timestamp is greater than the newest snapshot, return second last if last\_viewed > int(sorted\_keys[0]): return sorted\_keys[1]
 for k in sorted\_keys: if int(k) < last\_viewed: if prev\_k == sorted\_keys[0]: # Return the second last one so we dont recommend the same version compares itself return sorted\_keys[1]
 return prev\_k prev\_k = k
 return keys[0]
 def get\_history\_snapshot(self, timestamp): import brotli filepath = self.history[timestamp]
 # See if a brotli versions exists and switch to that if not filepath.endswith('.br') and os.path.isfile(f"{filepath}.br"): filepath = f"{filepath}.br"
 # OR in the backup case that the .br does not exist, but the plain one does if filepath.endswith('.br') and not os.path.isfile(filepath): if os.path.isfile(filepath.replace('.br', '')): filepath = filepath.replace('.br', '')
 if filepath.endswith('.br'): # Brotli doesnt have a fileheader to detect it, so we rely on filename # https://www.rfc-editor.org/rfc/rfc7932 with open(filepath, 'rb') as f: return(brotli.decompress(f.read()).decode('utf-8'))
 with open(filepath, 'r', encoding='utf-8', errors='ignore') as f: return f.read()
 # Save some text file to the appropriate path and bump the history # result\_obj from fetch\_site\_status.run() def save\_history\_text(self, contents, timestamp, snapshot\_id): import brotli
 logger.trace(f"{self.get('uuid')} - Updating history.txt with timestamp {timestamp}")
 self.ensure\_data\_dir\_exists()
 threshold = int(os.getenv('SNAPSHOT\_BROTLI\_COMPRESSION\_THRESHOLD', 1024)) skip\_brotli = strtobool(os.getenv('DISABLE\_BROTLI\_TEXT\_SNAPSHOT', 'False'))
 if not skip\_brotli and len(contents) > threshold: snapshot\_fname = f"{snapshot\_id}.txt.br" dest = os.path.join(self.watch\_data\_dir, snapshot\_fname) if not os.path.exists(dest): with open(dest, 'wb') as f: f.write(brotli.compress(contents.encode('utf-8'), mode=brotli.MODE\_TEXT)) else: snapshot\_fname = f"{snapshot\_id}.txt" dest = os.path.join(self.watch\_data\_dir, snapshot\_fname) if not os.path.exists(dest): with open(dest, 'wb') as f: f.write(contents.encode('utf-8'))
 # Append to index # @todo check last char was \n index\_fname = os.path.join(self.watch\_data\_dir, "history.txt") with open(index\_fname, 'a') as f: f.write("{},{}\n".format(timestamp, snapshot\_fname)) f.close()
 self.\_\_newest\_history\_key = timestamp self.\_\_history\_n += 1
 # @todo bump static cache of the last timestamp so we dont need to examine the file to set a proper ''viewed'' status return snapshot\_fname
 @property @property def has\_empty\_checktime(self): # using all() + dictionary comprehension # Check if all values are 0 in dictionary res = all(x == None or x == False or x==0 for x in self.get('time\_between\_check', {}).values()) return res
 def threshold\_seconds(self): seconds = 0 for m, n in mtable.items(): x = self.get('time\_between\_check', {}).get(m, None) if x: seconds += x \* n return seconds
 # Iterate over all history texts and see if something new exists # Always applying .strip() to start/end but optionally replace any other whitespace def lines\_contain\_something\_unique\_compared\_to\_history(self, lines: list, ignore\_whitespace=False): local\_lines = [] if lines: if ignore\_whitespace: if isinstance(lines[0], str): # Can be either str or bytes depending on what was on the disk local\_lines = set([l.translate(TRANSLATE\_WHITESPACE\_TABLE).lower() for l in lines]) else: local\_lines = set([l.decode('utf-8').translate(TRANSLATE\_WHITESPACE\_TABLE).lower() for l in lines]) else: if isinstance(lines[0], str): # Can be either str or bytes depending on what was on the disk local\_lines = set([l.strip().lower() for l in lines]) else: local\_lines = set([l.decode('utf-8').strip().lower() for l in lines])
 # Compare each lines (set) against each history text file (set) looking for something new.. existing\_history = set({}) for k, v in self.history.items(): content = self.get\_history\_snapshot(k)
 if ignore\_whitespace: alist = set([line.translate(TRANSLATE\_WHITESPACE\_TABLE).lower() for line in content.splitlines()]) else: alist = set([line.strip().lower() for line in content.splitlines()])
 existing\_history = existing\_history.union(alist)
 # Check that everything in local\_lines(new stuff) already exists in existing\_history - it should # if not, something new happened return not local\_lines.issubset(existing\_history)
 def get\_screenshot(self): fname = os.path.join(self.watch\_data\_dir, "last-screenshot.png") if os.path.isfile(fname): return fname
 # False is not an option for AppRise, must be type None return None
 def \_\_get\_file\_ctime(self, filename): fname = os.path.join(self.watch\_data\_dir, filename) if os.path.isfile(fname): return int(os.path.getmtime(fname)) return False
 @property def error\_text\_ctime(self): return self.\_\_get\_file\_ctime('last-error.txt')
 @property def snapshot\_text\_ctime(self): if self.history\_n==0: return False
 timestamp = list(self.history.keys())[-1] return int(timestamp)
 @property def snapshot\_screenshot\_ctime(self): return self.\_\_get\_file\_ctime('last-screenshot.png')
 @property def snapshot\_error\_screenshot\_ctime(self): return self.\_\_get\_file\_ctime('last-error-screenshot.png')
 @property def watch\_data\_dir(self): # The base dir of the watch data return os.path.join(self.\_\_datastore\_path, self['uuid']) if self.\_\_datastore\_path else None
 def get\_error\_text(self): """Return the text saved from a previous request that resulted in a non-200 error""" fname = os.path.join(self.watch\_data\_dir, "last-error.txt") if os.path.isfile(fname): with open(fname, 'r') as f: return f.read() return False
 def get\_error\_snapshot(self): """Return path to the screenshot that resulted in a non-200 error""" fname = os.path.join(self.watch\_data\_dir, "last-error-screenshot.png") if os.path.isfile(fname): return fname return False
 def pause(self): self['paused'] = True
 def unpause(self): self['paused'] = False
 def toggle\_pause(self): self['paused'] ^= True
 def mute(self): self['notification\_muted'] = True
 def unmute(self): self['notification\_muted'] = False
 def toggle\_mute(self): self['notification\_muted'] ^= True
 def extra\_notification\_token\_values(self): # Used for providing extra tokens # return {'widget': 555} return {}
 def extra\_notification\_token\_placeholder\_info(self): # Used for providing extra tokens # return [('widget', "Get widget amounts")] return []
 def extract\_regex\_from\_all\_history(self, regex): import csv import re import datetime csv\_output\_filename = False csv\_writer = False f = None
 # self.history will be keyed with the full path for k, fname in self.history.items(): if os.path.isfile(fname): if True: contents = self.get\_history\_snapshot(k) res = re.findall(regex, contents, re.MULTILINE) if res: if not csv\_writer: # A file on the disk can be transferred much faster via flask than a string reply csv\_output\_filename = 'report.csv' f = open(os.path.join(self.watch\_data\_dir, csv\_output\_filename), 'w') # @todo some headers in the future #fieldnames = ['Epoch seconds', 'Date'] csv\_writer = csv.writer(f, delimiter=',', quotechar='"', quoting=csv.QUOTE\_MINIMAL, #fieldnames=fieldnames ) csv\_writer.writerow(['Epoch seconds', 'Date']) # csv\_writer.writeheader()
 date\_str = datetime.datetime.fromtimestamp(int(k)).strftime('%Y-%m-%d %H:%M:%S') for r in res: row = [k, date\_str] if isinstance(r, str): row.append(r) else: row+=r csv\_writer.writerow(row)
 if f: f.close()
 return csv\_output\_filename
 def has\_special\_diff\_filter\_options\_set(self):
 # All False - nothing would be done, so act like it's not processable if not self.get('filter\_text\_added', True) and not self.get('filter\_text\_replaced', True) and not self.get('filter\_text\_removed', True): return False
 # Or one is set if not self.get('filter\_text\_added', True) or not self.get('filter\_text\_replaced', True) or not self.get('filter\_text\_removed', True): return True
 # None is set return False
 def save\_error\_text(self, contents): self.ensure\_data\_dir\_exists() target\_path = os.path.join(self.watch\_data\_dir, "last-error.txt") with open(target\_path, 'w') as f: f.write(contents)
 def save\_xpath\_data(self, data, as\_error=False): import json
 if as\_error: target\_path = os.path.join(self.watch\_data\_dir, "elements-error.json") else: target\_path = os.path.join(self.watch\_data\_dir, "elements.json")
 self.ensure\_data\_dir\_exists()
 with open(target\_path, 'w') as f: f.write(json.dumps(data)) f.close()
 # Save as PNG, PNG is larger but better for doing visual diff in the future def save\_screenshot(self, screenshot: bytes, as\_error=False):
 if as\_error: target\_path = os.path.join(self.watch\_data\_dir, "last-error-screenshot.png") else: target\_path = os.path.join(self.watch\_data\_dir, "last-screenshot.png")
 self.ensure\_data\_dir\_exists()
 with open(target\_path, 'wb') as f: f.write(screenshot) f.close()
 def get\_last\_fetched\_text\_before\_filters(self): import brotli filepath = os.path.join(self.watch\_data\_dir, 'last-fetched.br')
 if not os.path.isfile(filepath): # If a previous attempt doesnt yet exist, just snarf the previous snapshot instead dates = list(self.history.keys()) if len(dates): return self.get\_history\_snapshot(dates[-1]) else: return ''
 with open(filepath, 'rb') as f: return(brotli.decompress(f.read()).decode('utf-8'))
 def save\_last\_text\_fetched\_before\_filters(self, contents): import brotli filepath = os.path.join(self.watch\_data\_dir, 'last-fetched.br') with open(filepath, 'wb') as f: f.write(brotli.compress(contents, mode=brotli.MODE\_TEXT))
 def save\_last\_fetched\_html(self, timestamp, contents): import brotli
 self.ensure\_data\_dir\_exists() snapshot\_fname = f"{timestamp}.html.br" filepath = os.path.join(self.watch\_data\_dir, snapshot\_fname)
 with open(filepath, 'wb') as f: contents = contents.encode('utf-8') if isinstance(contents, str) else contents try: f.write(brotli.compress(contents)) except Exception as e: logger.warning(f"{self.get('uuid')} - Unable to compress snapshot, saving as raw data to {filepath}") logger.warning(e) f.write(contents)
 self.\_prune\_last\_fetched\_html\_snapshots()
 def get\_fetched\_html(self, timestamp): import brotli
 snapshot\_fname = f"{timestamp}.html.br" filepath = os.path.join(self.watch\_data\_dir, snapshot\_fname) if os.path.isfile(filepath): with open(filepath, 'rb') as f: return (brotli.decompress(f.read()).decode('utf-8'))
 return False
 def \_prune\_last\_fetched\_html\_snapshots(self):
 dates = list(self.history.keys()) dates.reverse()
 for index, timestamp in enumerate(dates): snapshot\_fname = f"{timestamp}.html.br" filepath = os.path.join(self.watch\_data\_dir, snapshot\_fname)
 # Keep only the first 2 if index > 1 and os.path.isfile(filepath): os.remove(filepath)
 @property def get\_browsersteps\_available\_screenshots(self): "For knowing which screenshots are available to show the user in BrowserSteps UI" available = [] for f in Path(self.watch\_data\_dir).glob('step\_before-\*.jpeg'): step\_n=re.search(r'step\_before-(\d+)', f.name) if step\_n: available.append(step\_n.group(1)) return available

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e0570533_20250115_114741.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6jrf-rcjf-245r)

**CVE-2024-51998**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-6jrf-rcjf-245r)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2024-51998](/advisories/GHSA-6jrf-rcjf-245r)

## changedetection.io path traversal using file URI scheme without supplying hostname

High severity

GitHub Reviewed

Published
Nov 7, 2024
in
[dgtlmoon/changedetection.io](/dgtlmoon/changedetection.io)
•
Updated Nov 8, 2024

[Vulnerability details](/advisories/GHSA-6jrf-rcjf-245r)
[Dependabot alerts
0](/advisories/GHSA-6jrf-rcjf-245r/dependabot)

## Package

pip

changedetection.io
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<= 0.47.5

## Patched versions

0.47.6

## Description

### Summary

The validation for the file URI scheme falls short, and results in an attacker being able to read any file on the system. This issue only affects instances with a webdriver enabled, and `ALLOW_FILE_URI` false or not defined.

### Details

The check used for URL protocol, `is_safe_url`, allows `file:` as a URL scheme:

<https://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13>

It later checks if local files are permitted, but one of the preconditions for the check is that the URL starts with `file://`. The issue comes with the fact that the file URI scheme is not required to have double slashes.

> A valid file URI must therefore begin with either `file:/path` (no hostname), `file:///path` (empty hostname), or `file://hostname/path`.
>
> — [Wikipedia](https://en.wikipedia.org/wiki/File_URI_scheme#Number_of_slash_characters)

<https://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41>

### PoC

1. Open up a changedetection.io instance with a webdriver configured
2. Create a new watch: `file:/etc/passwd` or a similar path for your operating system. Enable webdriver mode
3. Wait for it to be checked
4. Open preview
5. Notice contents of the file

### References

* [GHSA-6jrf-rcjf-245r](https://github.com/dgtlmoon/changedetection.io/security/advisories/GHSA-6jrf-rcjf-245r "GHSA-6jrf-rcjf-245r")
* [dgtlmoon/changedetection.io@49bc982](https://github.com/dgtlmoon/changedetection.io/commit/49bc982c697169c98b79698889fb9d26f6b3317f)
* <https://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/model/Watch.py#L11-L13>
* <https://github.com/dgtlmoon/changedetection.io/blob/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4/changedetectionio/processors/__init__.py#L37-L41>
* <https://github.com/dgtlmoon/changedetection.io/releases/tag/0.47.06>
* <https://nvd.nist.gov/vuln/detail/CVE-2024-51998>

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&v=4)](/dgtlmoon)
[dgtlmoon](/dgtlmoon)
published to
[dgtlmoon/changedetection.io](/dgtlmoon/changedetection.io/security/advisories/GHSA-6jrf-rcjf-245r)
Nov 7, 2024

Published to the GitHub Advisory Database
Nov 7, 2024

Reviewed
Nov 7, 2024

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2024-51998)
Nov 8, 2024

Last updated
Nov 8, 2024

### Severity

High

7.7

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Network

Attack Complexity
Low

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None
##### Subsequent System Impact Metrics

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:N/AC:L/AT:N/PR:N/UI:N/VC:N/VI:N/VA:N/SC:H/SI:N/SA:N

### [EPSS score](https://www.first.org/epss/user-guide)

0.045%
 (18th percentile)

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### CVE ID

CVE-2024-51998

### GHSA ID

GHSA-6jrf-rcjf-245r

### Source code

[dgtlmoon/changedetection.io](https://github.com/dgtlmoon/changedetection.io)

### Credits

* [![@Erb3](https://avatars.githubusercontent.com/u/49862976?s=40&v=4)](/Erb3)
  [Erb3](/Erb3)
  Finder

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-6jrf-rcjf-245r/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_6a413d54_20250114_193538.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fcommit%2F49bc982c697169c98b79698889fb9d26f6b3317f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fcommit%2F49bc982c697169c98b79698889fb9d26f6b3317f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=dgtlmoon%2Fchangedetection.io)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dgtlmoon](/dgtlmoon)
/
**[changedetection.io](/dgtlmoon/changedetection.io)**
Public

* [Notifications](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io) You must be signed in to change notification settings
* [Fork
  1.2k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)
* [Star
   21.1k](/login?return_to=%2Fdgtlmoon%2Fchangedetection.io)

* [Code](/dgtlmoon/changedetection.io)
* [Issues
  223](/dgtlmoon/changedetection.io/issues)
* [Pull requests
  35](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects
  0](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

Additional navigation options

* [Code](/dgtlmoon/changedetection.io)
* [Issues](/dgtlmoon/changedetection.io/issues)
* [Pull requests](/dgtlmoon/changedetection.io/pulls)
* [Discussions](/dgtlmoon/changedetection.io/discussions)
* [Actions](/dgtlmoon/changedetection.io/actions)
* [Projects](/dgtlmoon/changedetection.io/projects)
* [Wiki](/dgtlmoon/changedetection.io/wiki)
* [Security](/dgtlmoon/changedetection.io/security)
* [Insights](/dgtlmoon/changedetection.io/pulse)

## Commit

[Permalink](/dgtlmoon/changedetection.io/commit/49bc982c697169c98b79698889fb9d26f6b3317f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[CVE-2024-51998](https://github.com/advisories/GHSA-6jrf-rcjf-245r "CVE-2024-51998") - file:/ path traversal access should not be allowed t…

[Browse files](/dgtlmoon/changedetection.io/tree/49bc982c697169c98b79698889fb9d26f6b3317f)
Browse the repository at this point in the history

```
…o access a file without ALLOW_FILE_URI set
```

* Loading branch information

[![@dgtlmoon](https://avatars.githubusercontent.com/u/275001?s=40&v=4)](/dgtlmoon)

[dgtlmoon](/dgtlmoon/changedetection.io/commits?author=dgtlmoon "View all commits by dgtlmoon")
committed
Nov 7, 2024

1 parent
[e0abf0b](/dgtlmoon/changedetection.io/commit/e0abf0b50507a8a3d0c1d8522ab23519b3e4cdf4)

commit 49bc982

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**30 additions**
and
**3 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* changedetectionio

  + processors

    - changedetectionio/processors/\_\_init\_\_.py
      [\_\_init\_\_.py](#diff-9765208dad11e16dd8cb4412fdd27ce85e45ad1e5d39da9e08b6689cae37201d)
  + tests

    - changedetectionio/tests/test\_security.py
      [test\_security.py](#diff-3ab00b8859be47b3f012b2ce0d37eb12c84daa2ca230f17add64d5969c30b6e2)

## There are no files selected for viewing

4 changes: 2 additions & 2 deletions

4
[changedetectionio/processors/\_\_init\_\_.py](#diff-9765208dad11e16dd8cb4412fdd27ce85e45ad1e5d39da9e08b6689cae37201d "changedetectionio/processors/__init__.py")

Show comments

[View file](/dgtlmoon/changedetection.io/blob/49bc982c697169c98b79698889fb9d26f6b3317f/changedetectionio/processors/__init__.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -33,8 +33,8 @@ def call\_browser(self, preferred\_proxy\_id=None): |
|  |  |  |
|  |  | url = self.watch.link |
|  |  |  |
|  |  | # Protect against file:// access, check the real "link" without any meta "source:" etc prepended. |
|  |  | if re.search(r'^file://', url, re.IGNORECASE): |
|  |  | # Protect against file://, file:/ access, check the real "link" without any meta "source:" etc prepended. |
|  |  | if re.search(r'^file:/', url.strip(), re.IGNORECASE): |
|  |  | if not strtobool(os.getenv('ALLOW\_FILE\_URI', 'false')): |
|  |  | raise Exception( |
|  |  | "file:// type access is denied for security reasons." |
| Expand Down | |  |

29 changes: 28 additions & 1 deletion

29
[changedetectionio/tests/test\_security.py](#diff-3ab00b8859be47b3f012b2ce0d37eb12c84daa2ca230f17add64d5969c30b6e2 "changedetectionio/tests/test_security.py")

Show comments

[View file](/dgtlmoon/changedetection.io/blob/49bc982c697169c98b79698889fb9d26f6b3317f/changedetectionio/tests/test_security.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -61,7 +61,7 @@ def test\_bad\_access(client, live\_server, measure\_memory\_usage): |
|  |  | assert b'Watch protocol is not permitted by SAFE\_PROTOCOL\_REGEX' in res.data |
|  |  |  |
|  |  |  |
|  |  | def test\_file\_access(client, live\_server, measure\_memory\_usage): |
|  |  | def test\_file\_slashslash\_access(client, live\_server, measure\_memory\_usage): |
|  |  | #live\_server\_setup(live\_server) |
|  |  |  |
|  |  | test\_file\_path = "/tmp/test-file.txt" |
| Expand All | | @@ -88,6 +88,33 @@ def test\_file\_access(client, live\_server, measure\_memory\_usage): |
|  |  | # Default should be here |
|  |  | assert b'file:// type access is denied for security reasons.' in res.data |
|  |  |  |
|  |  | def test\_file\_slash\_access(client, live\_server, measure\_memory\_usage): |
|  |  | #live\_server\_setup(live\_server) |
|  |  |  |
|  |  | test\_file\_path = "/tmp/test-file.txt" |
|  |  |  |
|  |  | # file:// is permitted by default, but it will be caught by ALLOW\_FILE\_URI |
|  |  | client.post( |
|  |  | url\_for("form\_quick\_watch\_add"), |
|  |  | data={"url": f"file:/{test\_file\_path}", "tags": ''}, |
|  |  | follow\_redirects=True |
|  |  | ) |
|  |  | wait\_for\_all\_checks(client) |
|  |  | res = client.get(url\_for("index")) |
|  |  |  |
|  |  | # If it is enabled at test time |
|  |  | if strtobool(os.getenv('ALLOW\_FILE\_URI', 'false')): |
|  |  | res = client.get( |
|  |  | url\_for("preview\_page", uuid="first"), |
|  |  | follow\_redirects=True |
|  |  | ) |
|  |  |  |
|  |  | # Should see something (this file added by run\_basic\_tests.sh) |
|  |  | assert b"Hello world" in res.data |
|  |  | else: |
|  |  | # Default should be here |
|  |  | assert b'file:// type access is denied for security reasons.' in res.data |
|  |  |  |
|  |  | def test\_xss(client, live\_server, measure\_memory\_usage): |
|  |  | #live\_server\_setup(live\_server) |
|  |  | from changedetectionio.notification import ( |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `49bc982`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdgtlmoon%2Fchangedetection.io%2Fcommit%2F49bc982c697169c98b79698889fb9d26f6b3317f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


