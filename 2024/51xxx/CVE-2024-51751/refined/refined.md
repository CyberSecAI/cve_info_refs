- **Root cause of vulnerability:** The vulnerability stems from insufficient sanitization of file paths in Gradio applications using `File` or `UploadButton` components. Specifically, the `client_utils.is_file_obj_with_meta` function, which is meant to filter file inputs for sanitization, doesn't trigger for all inputs containing a file path. If the `meta` key with `_type` as `gradio.FileData` is absent in the input, the file path is not checked, allowing an attacker to supply an arbitrary file path.
- **Weaknesses/vulnerabilities present:** Improper input validation and sanitization, specifically concerning file paths within requests. Reliance on the presence of a "meta" key in the input data to trigger sanitization, creating a bypass if the key is missing.
- **Impact of exploitation:** An attacker can read arbitrary files from the application server by supplying malicious file paths within a request, potentially exposing sensitive information.
- **Attack vectors:** Sending a crafted HTTP request to the `/gradio_api/run/predict` endpoint, exploiting the file handling logic in Gradio. The attacker omits the `meta` key or the `_type` within `meta` to bypass sanitization logic.
- **Required attacker capabilities/position:** The attacker needs network access to the Gradio application's endpoint and knowledge of the request structure expected by the application. No special user privileges on the server are needed, only the ability to interact with the application's API.