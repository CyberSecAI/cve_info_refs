The virtio_vq_recordon function is subject to a time-of-check to time-of-use (TOCTOU) race condition.