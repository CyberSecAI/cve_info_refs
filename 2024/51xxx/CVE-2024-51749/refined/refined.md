The provided content relates to CVE-2024-51749.

**Root cause of vulnerability:**
The vulnerability stems from the lack of proper checks on thumbnails for attachments, stickers, and images in versions of Element Web and Desktop prior to 1.11.85. Specifically, the application does not verify if the provided thumbnails are coherent with the actual file type or content.

**Weaknesses/vulnerabilities present:**
- Inadequate validation of thumbnail coherence with actual content.
- Lack of checks on the advertised mimetype of sticker content.
- Missing checks to ensure that advertised mimetypes for image/video messages match the actual file type/extension.

**Impact of exploitation:**
An attacker can craft malicious attachments, stickers, or images with misleading thumbnails. When a user clicks on such a manipulated thumbnail, it could trigger the download of a file that does not correspond to the displayed thumbnail, potentially leading to the user downloading and opening malicious files.

**Attack vectors:**
The attack vector is through the manipulation of message content, specifically by providing misleading thumbnails along with attachments, stickers and images.

**Required attacker capabilities/position:**
The attacker needs to be able to send messages to a user via the Element Web/Desktop application, with the ability to set custom metadata. This means the attacker must be in a position to communicate with the victim through the platform (e.g. be in the same room). The attacker also needs to be able to manipulate the metadata in a way that they can control the thumbnail.

The provided content also includes the fix for the vulnerability, which involves adding mimetype checks to stickers, image and video messages.