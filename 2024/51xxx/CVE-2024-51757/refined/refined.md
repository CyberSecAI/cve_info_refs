Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The `happy-dom` library used `child_process.execFileSync()` to perform synchronous fetch requests.
- The URL provided to the fetch function was not properly sanitized, allowing an attacker to inject server-side code via a `<script>` tag's `src` attribute.

**Weaknesses/Vulnerabilities:**

- **Code Injection:** The primary vulnerability is the ability to inject and execute arbitrary server-side code by manipulating the URL passed to the synchronous fetch. Specifically, the library was vulnerable to code injection within the URL string when using the `child_process.execFileSync()` function.
- **Unsafe use of `child_process.execFileSync()`:** The library utilized `child_process.execFileSync()` without properly sanitizing the input, which resulted in the ability to execute arbitrary code on the server when processing a crafted URL.
- **Inadequate URL handling:** The library didn't properly handle special characters within the URL which allowed the injection of malicious code within the URL string, causing it to be executed on the server.

**Impact of Exploitation:**

- **Arbitrary Code Execution:** An attacker could execute arbitrary commands on the server where the `happy-dom` library is used. This could lead to complete system compromise, data theft, or other malicious activities.
- **Server Compromise:** Successful exploitation could allow an attacker to gain control of the server, potentially leading to further attacks on the infrastructure or other connected systems.

**Attack Vectors:**

- **Malicious `<script>` tag `src` attribute:** By crafting a URL containing malicious code, an attacker could inject code into the `src` attribute of a `<script>` tag when a webpage is rendered through `happy-dom`.
- **URL manipulation:** The primary attack vector is through manipulation of the URL passed to the fetch function.

**Required Attacker Capabilities/Position:**

- **Ability to Control Input:** The attacker needs to have control over the URL that is used when making a request using happy-dom's synchronous fetch functionality.
- **Knowledge of `happy-dom` Implementation:** The attacker needs knowledge about how `happy-dom` handles fetch requests and how it uses `child_process.execFileSync()`.
- **Target system is using a vulnerable version of `happy-dom`:** The vulnerability exists in versions prior to 15.10.2.

**Mitigation:**

The vulnerability was fixed by:

-   Enclosing the URL in backticks during construction to prevent injection into the string itself.
-   Using `JSON.stringify()` to handle the URL to prevent code injection during the execution of the script by `child_process.execFileSync()`.

This prevents the execution of arbitrary code by escaping the URL string.

**Additional Notes:**

-   The vulnerability was reported by `@kevin-mizu`.
-   The vulnerability is considered critical.
-   The fix was implemented in pull request #1586 and #1588 and included in version 15.10.2.
-   The issue was tracked under issue #1585.
-   The vulnerability is also tracked as GHSA-96g7-g7g9-jxw8
-   The vulnerability was assigned CVE ID CVE-2024-51757.