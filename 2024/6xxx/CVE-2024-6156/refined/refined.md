- **Root cause of vulnerability**: The LXD server, when configured in "PKI mode", does not properly enforce that client certificates are signed by the configured Certificate Authority (CA). It requests a client certificate during the TLS handshake but doesn't require one and proceeds with the handshake if the client provides a certificate present in the trust store, regardless of whether it's CA-signed.
- **Weaknesses/vulnerabilities present**:
    -  Bypass of intended PKI certificate validation.
    -  Incorrect `tls.Config` settings in PKI mode: the `ClientAuth` field is set to `tls.RequestClientCert` instead of `tls.RequireAndVerifyClientCert`, which doesn't enforce CA-signed certificates.
    -  The check in `(*Daemon).Authenticate` for TLS clients doesn't trigger `util.CheckTrustState` if the client certificate is present in the trust store and sent during the handshake, even if it is not CA signed.
- **Impact of exploitation**: An attacker with a certificate already in the LXD trust store can bypass the intended PKI-based client authentication requirements. Although full authentication bypass is not possible since the attacker needs a trusted certificate, it allows access without proper CA-signed certificates.
- **Attack vectors**: A manual client (e.g., `curl`) is used to establish a TLS connection with the LXD server, sending a non-CA signed certificate that is already in the trust store.
- **Required attacker capabilities/position**:
    - The attacker must have a client certificate already present in the LXD trust store before PKI mode is enabled.
    - The attacker must be able to initiate a TLS connection with the LXD server.
    - The attacker must send a non-CA signed certificate during the handshake.