=== Content from plugins.trac.wordpress.org_9ca18a80_20250114_181917.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fwpdiscuz%2Ftrunk%2Fclass.WpdiscuzCore.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/wpdiscuz/trunk/class.WpdiscuzCore.php?rev=3167125 "Revision 3167125")
* Next Revision →
* [Blame](/browser/wpdiscuz/trunk/class.WpdiscuzCore.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/wpdiscuz/trunk/class.WpdiscuzCore.php)

---

# [source:](/browser?order=name "Go to repository root") [wpdiscuz](/browser/wpdiscuz?order=name "View wpdiscuz")/[trunk](/browser/wpdiscuz/trunk?order=name "View trunk")/[class.WpdiscuzCore.php](/browser/wpdiscuz/trunk/class.WpdiscuzCore.php?order=name "View class.WpdiscuzCore.php")

View diff against:

View revision:

| [Last change](/changeset/3168768/wpdiscuz/trunk/class.WpdiscuzCore.php "View differences") on this file was [3168768](/changeset/3168768/ "View changeset 3168768"), checked in by AdvancedCoding, [3 months ago](/timeline?from=2024-10-14T17%3A02%3A07Z&precision=second "See timeline at 10/14/2024 05:02:07 PM") |
| --- |
| Comments - wpDiscuz v7.6.27 - 14.10.2024  * Added: A new option for Social Login * Fixed: Undefined array key "is\_rate\_editable" |
| **File size:** 145.1 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\* |
| [3](#L3) | \* Plugin Name: wpDiscuz |
| [4](#L4) | \* Description: #1 WordPress Comment Plugin. Innovative, modern and feature-rich comment system to supercharge your website comment section. |
| [5](#L5) | \* Version: 7.6.27 |
| [6](#L6) | \* Author: gVectors Team |
| [7](#L7) | \* Author URI: https://gvectors.com/ |
| [8](#L8) | \* Plugin URI: https://wpdiscuz.com/ |
| [9](#L9) | \* Text Domain: wpdiscuz |
| [10](#L10) | \* Domain Path: /languages/ |
| [11](#L11) | \* wpDiscuz Update: auto |
| [12](#L12) | \*/ |
| [13](#L13) | if ( ! defined( "ABSPATH" ) ) { |
| [14](#L14) | exit(); |
| [15](#L15) | } |
| [16](#L16) |  |
| [17](#L17) | define( "WPDISCUZ\_DIR\_PATH", dirname( \_\_FILE\_\_ ) ); |
| [18](#L18) | define( "WPDISCUZ\_DIR\_NAME", basename( WPDISCUZ\_DIR\_PATH ) ); |
| [19](#L19) | define( "WPDISCUZ\_DIR\_URL", rtrim(plugin\_dir\_url(\_\_FILE\_\_), '/\\') ); |
| [20](#L20) |  |
| [21](#L21) | include\_once WPDISCUZ\_DIR\_PATH . "/includes/interface.WpDiscuzConstants.php"; |
| [22](#L22) | include\_once WPDISCUZ\_DIR\_PATH . "/utils/functions.php"; |
| [23](#L23) | include\_once WPDISCUZ\_DIR\_PATH . "/options/class.WpdiscuzOptions.php"; |
| [24](#L24) | include\_once WPDISCUZ\_DIR\_PATH . "/utils/class.WpdiscuzHelper.php"; |
| [25](#L25) | include\_once WPDISCUZ\_DIR\_PATH . "/utils/class.WpdiscuzHelperEmail.php"; |
| [26](#L26) | include\_once WPDISCUZ\_DIR\_PATH . "/utils/class.WpdiscuzHelperOptimization.php"; |
| [27](#L27) | include\_once WPDISCUZ\_DIR\_PATH . "/utils/class.WpdiscuzHelperUpload.php"; |
| [28](#L28) | include\_once WPDISCUZ\_DIR\_PATH . "/includes/class.WpdiscuzDBManager.php"; |
| [29](#L29) | include\_once WPDISCUZ\_DIR\_PATH . "/forms/wpDiscuzForm.php"; |
| [30](#L30) | include\_once WPDISCUZ\_DIR\_PATH . "/utils/class.WpdiscuzCache.php"; |
| [31](#L31) | include\_once WPDISCUZ\_DIR\_PATH . "/utils/class.WpdiscuzHelperAjax.php"; |
| [32](#L32) | include\_once WPDISCUZ\_DIR\_PATH . "/includes/class.WpdiscuzRest.php"; |
| [33](#L33) |  |
| [34](#L34) | class WpdiscuzCore implements WpDiscuzConstants { |
| [35](#L35) |  |
| [36](#L36) | public $dbManager; |
| [37](#L37) | public $helper; |
| [38](#L38) | public $helperAjax; |
| [39](#L39) | public $helperEmail; |
| [40](#L40) | public $helperOptimization; |
| [41](#L41) | public $helperUpload; |
| [42](#L42) | public $wpdiscuzOptionsJs; |
| [43](#L43) |  |
| [44](#L44) | /\*\* |
| [45](#L45) | \* @var WpdiscuzOptions |
| [46](#L46) | \*/ |
| [47](#L47) | public $options; |
| [48](#L48) | public $commentsArgs; |
| [49](#L49) | private $version; |
| [50](#L50) | /\*\* |
| [51](#L51) | \* @var wpDiscuzForm |
| [52](#L52) | \*/ |
| [53](#L53) | public $wpdiscuzForm; |
| [54](#L54) | /\*\* |
| [55](#L55) | \* @var \wpdFormAttr\Form |
| [56](#L56) | \*/ |
| [57](#L57) | public $form; |
| [58](#L58) | private $cache; |
| [59](#L59) | public $subscriptionData; |
| [60](#L60) | public $isWpdiscuzLoaded; |
| [61](#L61) | private $requestUri; |
| [62](#L62) | public static $DEFAULT\_COMMENT\_TYPE; |
| [63](#L63) | private static $\_instance = null; |
| [64](#L64) |  |
| [65](#L65) | private function \_\_construct() { |
| [66](#L66) | add\_option( self::OPTION\_SLUG\_VERSION, "1.0.0" ); |
| [67](#L67) | $this->version = get\_option( self::OPTION\_SLUG\_VERSION, "1.0.0" ); |
| [68](#L68) | wp\_cookie\_constants(); |
| [69](#L69) | self::$DEFAULT\_COMMENT\_TYPE = version\_compare( get\_bloginfo( "version" ), "5.5", ">=" ) ? "comment" : ""; |
| [70](#L70) | $this->dbManager            = new WpdiscuzDBManager(); |
| [71](#L71) | $this->options              = new WpdiscuzOptions( $this->dbManager ); |
| [72](#L72) | $this->wpdiscuzForm         = new wpDiscuzForm( $this->options, $this->version ); |
| [73](#L73) | $this->helper               = new WpdiscuzHelper( $this->options, $this->dbManager, $this->wpdiscuzForm ); |
| [74](#L74) | $this->helperEmail          = new WpdiscuzHelperEmail( $this->options, $this->dbManager, $this->helper ); |
| [75](#L75) | $this->helperOptimization   = new WpdiscuzHelperOptimization( $this->options, $this->dbManager, $this->helperEmail, $this->helper ); |
| [76](#L76) | $this->helperAjax           = new WpdiscuzHelperAjax( $this->options, $this->dbManager, $this->helper, $this->helperEmail, $this->wpdiscuzForm ); |
| [77](#L77) | $this->helperUpload         = new WpdiscuzHelperUpload( $this->options, $this->dbManager, $this->wpdiscuzForm, $this->helper ); |
| [78](#L78) | $this->cache                = new WpdiscuzCache( $this->options, $this->helper ); |
| [79](#L79) | $this->requestUri           = ! empty( $\_SERVER["REQUEST\_URI"] ) ? $\_SERVER["REQUEST\_URI"] : ""; |
| [80](#L80) |  |
| [81](#L81) | if ( $this->options->thread\_display["isLoadOnlyParentComments"] ) { |
| [82](#L82) | add\_action( "wp\_ajax\_wpdShowReplies", [ &$this, "showReplies" ] ); |
| [83](#L83) | add\_action( "wp\_ajax\_nopriv\_wpdShowReplies", [ &$this, "showReplies" ] ); |
| [84](#L84) | } |
| [85](#L85) |  |
| [86](#L86) | register\_activation\_hook( \_\_FILE\_\_, [ &$this, "pluginActivation" ] ); |
| [87](#L87) |  |
| [88](#L88) | /\* CRON JOBS \*/ |
| [89](#L89) | register\_activation\_hook( \_\_FILE\_\_, [ &$this, "registerJobs" ] ); |
| [90](#L90) | register\_deactivation\_hook( \_\_FILE\_\_, [ &$this, "deregisterJobs" ] ); |
| [91](#L91) | add\_filter( "cron\_schedules", [ &$this, "setIntervals" ] ); |
| [92](#L92) | /\* /CRON JOBS \*/ |
| [93](#L93) | add\_action( "wp\_insert\_site", [ &$this, "addNewBlog" ] ); |
| [94](#L94) | add\_action( "delete\_blog", [ &$this, "deleteBlog" ] ); |
| [95](#L95) | add\_action( "wp", [ &$this, "initCurrentPostType" ] ); |
| [96](#L96) |  |
| [97](#L97) | add\_action( "admin\_init", [ &$this, "uninstall" ], 1 ); |
| [98](#L98) | add\_action( "init", [ &$this, "wpdiscuzTextDomain" ] ); |
| [99](#L99) | add\_action( "init", [ &$this, "wpdiscuzBlockInit" ] ); |
| [100](#L100) | add\_action( "admin\_init", [ &$this, "pluginNewVersion" ], 1 ); |
| [101](#L101) | add\_action( "admin\_enqueue\_scripts", [ &$this, "backendFiles" ], 100 ); |
| [102](#L102) | add\_action( "wp\_enqueue\_scripts", [ &$this, "frontendFiles" ] ); |
| [103](#L103) | add\_action( "admin\_menu", [ &$this, "addPluginOptionsPage" ], 1 ); |
| [104](#L104) | add\_action( "admin\_head", [ &$this, "addInlineStyle" ], 1 ); |
| [105](#L105) | add\_shortcode( "wpdiscuz\_comments", [ &$this, "wpdiscuzShortcode" ] ); |
| [106](#L106) |  |
| [107](#L107) | add\_action( "wp\_ajax\_wpdLoadMoreComments", [ &$this, "loadMoreComments" ] ); |
| [108](#L108) | add\_action( "wp\_ajax\_nopriv\_wpdLoadMoreComments", [ &$this, "loadMoreComments" ] ); |
| [109](#L109) | add\_action( "wp\_ajax\_wpdSorting", [ &$this, "sorting" ] ); |
| [110](#L110) | add\_action( "wp\_ajax\_nopriv\_wpdSorting", [ &$this, "sorting" ] ); |
| [111](#L111) | add\_action( "wp\_ajax\_wpdAddComment", [ &$this, "addComment" ] ); |
| [112](#L112) | add\_action( "wp\_ajax\_nopriv\_wpdAddComment", [ &$this, "addComment" ] ); |
| [113](#L113) | add\_action( "wp\_ajax\_wpdGetSingleComment", [ &$this, "getSingleComment" ] ); |
| [114](#L114) | add\_action( "wp\_ajax\_nopriv\_wpdGetSingleComment", [ &$this, "getSingleComment" ] ); |
| [115](#L115) | add\_action( "wp\_ajax\_wpdMostReactedComment", [ &$this, "mostReactedComment" ] ); |
| [116](#L116) | add\_action( "wp\_ajax\_nopriv\_wpdMostReactedComment", [ &$this, "mostReactedComment" ] ); |
| [117](#L117) | add\_action( "wp\_ajax\_wpdHottestThread", [ &$this, "hottestThread" ] ); |
| [118](#L118) | add\_action( "wp\_ajax\_nopriv\_wpdHottestThread", [ &$this, "hottestThread" ] ); |
| [119](#L119) |  |
| [120](#L120) | $plugin = plugin\_basename( \_\_FILE\_\_ ); |
| [121](#L121) | add\_filter( "plugin\_action\_links\_$plugin", [ &$this, "addPluginSettingsLink" ] ); |
| [122](#L122) | add\_filter( "comments\_clauses", [ &$this, "commentsClauses" ] ); |
| [123](#L123) |  |
| [124](#L124) | add\_action( "wp\_ajax\_wpdSaveEditedComment", [ &$this, "saveEditedComment" ] ); |
| [125](#L125) | add\_action( "wp\_ajax\_nopriv\_wpdSaveEditedComment", [ &$this, "saveEditedComment" ] ); |
| [126](#L126) |  |
| [127](#L127) | if ( $this->options->live["commentListUpdateType"] ) { |
| [128](#L128) | add\_action( "wp\_ajax\_wpdUpdateAutomatically", [ &$this, "updateAutomatically" ] ); |
| [129](#L129) | add\_action( "wp\_ajax\_nopriv\_wpdUpdateAutomatically", [ &$this, "updateAutomatically" ] ); |
| [130](#L130) | } |
| [131](#L131) |  |
| [132](#L132) | add\_action( "wp\_loaded", [ &$this, "addNewRoles" ] ); |
| [133](#L133) | add\_filter( "comments\_template\_query\_args", [ &$this, "commentsTemplateQueryArgs" ] ); |
| [134](#L134) | add\_action( "pre\_get\_comments", [ &$this, "preGetComments" ] ); |
| [135](#L135) | add\_filter( "found\_comments\_query", [ &$this, "foundCommentsQuery" ], 10, 2 ); |
| [136](#L136) |  |
| [137](#L137) | add\_action( "rest\_api\_init", [ &$this, "registerRestRoutes" ], 10 ); |
| [138](#L138) |  |
| [139](#L139) | if ( $this->options->live["enableBubble"] && $this->options->live["bubbleLiveUpdate"] ) { |
| [140](#L140) | add\_action( "wp\_ajax\_wpdBubbleUpdate", [ &$this, "bubbleUpdate" ] ); |
| [141](#L141) | add\_action( "wp\_ajax\_nopriv\_wpdBubbleUpdate", [ &$this, "bubbleUpdate" ] ); |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | add\_action( "admin\_footer", [ &$this, "feedbackDialog" ] ); |
| [145](#L145) | add\_filter( "mce\_buttons", [ &$this, "mceButton" ] ); |
| [146](#L146) | add\_filter( "mce\_external\_plugins", [ &$this, "mceExternalPlugin" ] ); |
| [147](#L147) | add\_shortcode( self::WPDISCUZ\_FEEDBACK\_SHORTCODE, [ &$this, "feedbackShortcode" ] ); |
| [148](#L148) | add\_action( "wp\_ajax\_wpdAddInlineComment", [ &$this, "addInlineComment" ] ); |
| [149](#L149) | add\_action( "wp\_ajax\_nopriv\_wpdAddInlineComment", [ &$this, "addInlineComment" ] ); |
| [150](#L150) | add\_action( "wp\_footer", [ &$this, "footerContents" ] ); |
| [151](#L151) | add\_action( "enqueue\_block\_editor\_assets", [ &$this, "gutenbergButton" ] ); |
| [152](#L152) |  |
| [153](#L153) | add\_filter( "extra\_plugin\_headers", [ &$this, "extraPluginHeaders" ] ); |
| [154](#L154) | add\_filter( "auto\_update\_plugin", [ &$this, "shouldUpdate" ], 10, 2 ); |
| [155](#L155) |  |
| [156](#L156) | add\_filter( "preprocess\_comment", [ &$this, "validateRecaptcha" ], 10, 2 ); |
| [157](#L157) | add\_filter( "preprocess\_comment", [ &$this, "validateWebSite" ], 11, 2 ); |
| [158](#L158) |  |
| [159](#L159) | add\_action( "admin\_bar\_menu", [ &$this, "addToolbarItems" ], 300 ); |
| [160](#L160) |  |
| [161](#L161) | add\_filter( 'register\_block\_type\_args', [ &$this, "replaceDefaultCommentBlock" ], 99, 2 ); |
| [162](#L162) |  |
| [163](#L163) | add\_action( "elementor/editor/after\_enqueue\_scripts", [ &$this, "inlineCommentForElementorJS" ] ); |
| [164](#L164) | add\_action( "elementor/editor/after\_enqueue\_styles", [ &$this, "inlineCommentForElementorCSS" ] ); |
| [165](#L165) | add\_action( "elementor/editor/footer", [ &$this, "feedbackDialog" ] ); |
| [166](#L166) | add\_action( "elementor/widgets/register", [ &$this, "registerWpdiscuzWidgetInElementor" ] ); |
| [167](#L167) | } |
| [168](#L168) |  |
| [169](#L169) | public static function getInstance() { |
| [170](#L170) | if ( is\_null( self::$\_instance ) ) { |
| [171](#L171) | self::$\_instance = new self(); |
| [172](#L172) | } |
| [173](#L173) |  |
| [174](#L174) | return self::$\_instance; |
| [175](#L175) | } |
| [176](#L176) |  |
| [177](#L177) | public function extraPluginHeaders( $headers ) { |
| [178](#L178) | $headers[] = "wpDiscuz Update"; |
| [179](#L179) |  |
| [180](#L180) | return $headers; |
| [181](#L181) | } |
| [182](#L182) |  |
| [183](#L183) | public function shouldUpdate( $shouldUpdate, $plugin ) { |
| [184](#L184) | if ( ! isset( $plugin->plugin, $plugin->new\_version ) ) { |
| [185](#L185) | return $shouldUpdate; |
| [186](#L186) | } |
| [187](#L187) |  |
| [188](#L188) | if ( "wpdiscuz/class.WpdiscuzCore.php" !== $plugin->plugin ) { |
| [189](#L189) | return $shouldUpdate; |
| [190](#L190) | } |
| [191](#L191) |  |
| [192](#L192) | $pluginData = get\_plugin\_data( \_\_FILE\_\_ ); |
| [193](#L193) |  |
| [194](#L194) | if ( isset( $pluginData["wpDiscuz Update"] ) && $pluginData["wpDiscuz Update"] === "manual" ) { |
| [195](#L195) | return false; |
| [196](#L196) | } |
| [197](#L197) |  |
| [198](#L198) | return $shouldUpdate; |
| [199](#L199) | } |
| [200](#L200) |  |
| [201](#L201) | public function pluginActivation( $networkwide ) { |
| [202](#L202) | if ( function\_exists( "is\_multisite" ) && is\_multisite() && $networkwide ) { |
| [203](#L203) | $oldBlogID            = $this->dbManager->getBlogID(); |
| [204](#L204) | $oldSitePluginVersion = $this->version; |
| [205](#L205) | $blogIDs              = $this->dbManager->getBlogIDs(); |
| [206](#L206) | foreach ( $blogIDs as $blogID ) { |
| [207](#L207) | switch\_to\_blog( $blogID ); |
| [208](#L208) | $this->version = get\_option( self::OPTION\_SLUG\_VERSION, "1.0.0" ); |
| [209](#L209) | $this->activateWpDiscuz(); |
| [210](#L210) | } |
| [211](#L211) | switch\_to\_blog( $oldBlogID ); |
| [212](#L212) | $this->version = $oldSitePluginVersion; |
| [213](#L213) |  |
| [214](#L214) | return; |
| [215](#L215) | } |
| [216](#L216) | $this->activateWpDiscuz(); |
| [217](#L217) | } |
| [218](#L218) |  |
| [219](#L219) | public function addNewBlog( $new\_site ) { |
| [220](#L220) | if ( is\_plugin\_active\_for\_network( "wpdiscuz/class.WpdiscuzCore.php" ) ) { |
| [221](#L221) | $oldBlogID            = $this->dbManager->getBlogID(); |
| [222](#L222) | $oldSitePluginVersion = $this->version; |
| [223](#L223) | switch\_to\_blog( $new\_site->blogID ); |
| [224](#L224) | $this->version = get\_option( self::OPTION\_SLUG\_VERSION, "1.0.0" ); |
| [225](#L225) | $this->activateWpDiscuz(); |
| [226](#L226) | switch\_to\_blog( $oldBlogID ); |
| [227](#L227) | $this->version = $oldSitePluginVersion; |
| [228](#L228) | } |
| [229](#L229) | } |
| [230](#L230) |  |
| [231](#L231) | public function deleteBlog( $blogID ) { |
| [232](#L232) | if ( is\_plugin\_active\_for\_network( "wpdiscuz/class.WpdiscuzCore.php" ) ) { |
| [233](#L233) | $oldBlogID = $this->dbManager->getBlogID(); |
| [234](#L234) | switch\_to\_blog( $blogID ); |
| [235](#L235) | $this->dbManager->dropTables(); |
| [236](#L236) | switch\_to\_blog( $oldBlogID ); |
| [237](#L237) | } |
| [238](#L238) | } |
| [239](#L239) |  |
| [240](#L240) | private function activateWpDiscuz() { |
| [241](#L241) | $this->dbManager->dbCreateTables(); |
| [242](#L242) | $this->pluginNewVersion(); |
| [243](#L243) | } |
| [244](#L244) |  |
| [245](#L245) | public function wpdiscuzTextDomain() { |
| [246](#L246) | load\_plugin\_textdomain( "wpdiscuz", false, dirname( plugin\_basename( \_\_FILE\_\_ ) ) . "/languages/" ); |
| [247](#L247) | } |
| [248](#L248) |  |
| [249](#L249) | public function registerJobs() { |
| [250](#L250) | if ( ! wp\_next\_scheduled( self::DELETE\_UNATTACHED\_FILES\_ACTION ) ) { |
| [251](#L251) | wp\_schedule\_event( current\_time( "timestamp" ), self::DELETE\_UNATTACHED\_FILES\_KEY\_RECURRENCE, self::DELETE\_UNATTACHED\_FILES\_ACTION ); |
| [252](#L252) | } |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | public function deregisterJobs() { |
| [256](#L256) | if ( wp\_next\_scheduled( self::DELETE\_UNATTACHED\_FILES\_ACTION ) ) { |
| [257](#L257) | wp\_clear\_scheduled\_hook( self::DELETE\_UNATTACHED\_FILES\_ACTION ); |
| [258](#L258) | } |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | public function setIntervals( $schedules ) { |
| [262](#L262) | $schedules[ self::DELETE\_UNATTACHED\_FILES\_KEY\_RECURRENCE ] = [ |
| [263](#L263) | "interval" => self::DELETE\_UNATTACHED\_FILES\_RECURRENCE \* HOUR\_IN\_SECONDS, |
| [264](#L264) | "display"  => esc\_html\_\_( "Every 48 hours", "wpdiscuz" ) |
| [265](#L265) | ]; |
| [266](#L266) |  |
| [267](#L267) | return $schedules; |
| [268](#L268) | } |
| [269](#L269) |  |
| [270](#L270) | public function updateAutomatically() { |
| [271](#L271) | $postId            = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [272](#L272) | $loadLastCommentId = WpdiscuzHelper::sanitize( INPUT\_POST, "loadLastCommentId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [273](#L273) | if ( $postId ) { |
| [274](#L274) | $this->isWpdiscuzLoaded = true; |
| [275](#L275) | $visibleCommentIds      = rtrim( WpdiscuzHelper::sanitize( INPUT\_POST, "visibleCommentIds", "FILTER\_SANITIZE\_STRING" ), "," ); |
| [276](#L276) | $this->commentsArgs     = $this->getDefaultCommentsArgs( $postId ); |
| [277](#L277) | $commentListArgs        = $this->getCommentListArgs( $postId ); |
| [278](#L278) | if ( $this->form->isUserCanSeeComments( $commentListArgs["current\_user"], $postId ) ) { |
| [279](#L279) | $lastCommentId = $this->dbManager->getLastCommentId( $this->commentsArgs ); |
| [280](#L280) | if ( $lastCommentId > $loadLastCommentId ) { |
| [281](#L281) | $response                            = []; |
| [282](#L282) | $response["loadLastCommentId"]       = $lastCommentId; |
| [283](#L283) | $commentListArgs["new\_loaded\_class"] = "wpd-new-loaded-comment"; |
| [284](#L284) | $sentEmail                           = isset( $\_COOKIE[ "comment\_author\_email\_" . COOKIEHASH ] ) ? trim( sanitize\_email( $\_COOKIE[ "comment\_author\_email\_" . COOKIEHASH ] ) ) : ""; |
| [285](#L285) | $email                               = ! empty( $commentListArgs["current\_user"]->ID ) ? $commentListArgs["current\_user"]->user\_email : $sentEmail; |
| [286](#L286) | $newCommentIds                       = $this->dbManager->getNewCommentIds( $this->commentsArgs, $loadLastCommentId, $email, $visibleCommentIds ); |
| [287](#L287) | $newCommentIds                       = apply\_filters( "wpdiscuz\_live\_update\_new\_comment\_ids", $newCommentIds, $postId, $commentListArgs["current\_user"] ); |
| [288](#L288) | $response["message"]                 = []; |
| [289](#L289) | foreach ( $newCommentIds as $newCommentId ) { |
| [290](#L290) | $comment = get\_comment( $newCommentId ); |
| [291](#L291) | if ( ( $comment->comment\_parent && ( in\_array( $comment->comment\_parent, explode( ",", $visibleCommentIds ) ) || in\_array( $comment->comment\_parent, $newCommentIds ) ) ) || ! $comment->comment\_parent ) { |
| [292](#L292) | $commentHtml   = wp\_list\_comments( $commentListArgs, [ $comment ] ); |
| [293](#L293) | $commentObject = [ |
| [294](#L294) | "comment\_parent" => $comment->comment\_parent, |
| [295](#L295) | "comment\_html"   => $commentHtml |
| [296](#L296) | ]; |
| [297](#L297) | if ( $comment->comment\_parent ) { |
| [298](#L298) | array\_push( $response["message"], $commentObject ); |
| [299](#L299) | } else { |
| [300](#L300) | array\_unshift( $response["message"], $commentObject ); |
| [301](#L301) | } |
| [302](#L302) | } |
| [303](#L303) | } |
| [304](#L304) | $response["wc\_all\_comments\_count\_new"]                 = get\_comments\_number( $postId ); |
| [305](#L305) | $response["wc\_all\_comments\_count\_before\_threads\_html"] = "<span class='wpdtc' title='" . esc\_attr( $response["wc\_all\_comments\_count\_new"] ) . "'>" . esc\_html( $this->helper->getNumber( $response["wc\_all\_comments\_count\_new"] ) ) . "</span> " . esc\_html( apply\_filters( "wpdiscuz\_comment\_count\_phrase", ( 1 == $response["wc\_all\_comments\_count\_new"] ? $this->form->getHeaderTextSingle() : $this->form->getHeaderTextPlural() ), $response["wc\_all\_comments\_count\_new"] ) ); |
| [306](#L306) | $response["wc\_all\_comments\_count\_bubble\_html"]         = "<span id='wpd-bubble-all-comments-count'" . ( $response["wc\_all\_comments\_count\_new"] ? "" : " style='display:none;'" ) . " title='" . esc\_attr( $response["wc\_all\_comments\_count\_new"] ) . "'>" . esc\_html( $this->helper->getNumber( $response["wc\_all\_comments\_count\_new"] ) ) . "</span>"; |
| [307](#L307) | wp\_send\_json\_success( $response ); |
| [308](#L308) | } |
| [309](#L309) | } |
| [310](#L310) | } |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | public function bubbleUpdate() { |
| [314](#L314) | $postId        = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [315](#L315) | $newCommentIds = WpdiscuzHelper::sanitize( INPUT\_POST, "newCommentIds", "FILTER\_SANITIZE\_STRING" ); |
| [316](#L316) | if ( $postId && $newCommentIds ) { |
| [317](#L317) | $this->isWpdiscuzLoaded = true; |
| [318](#L318) | $commentListArgs        = $this->getCommentListArgs( $postId ); |
| [319](#L319) | if ( $this->form->isUserCanSeeComments( $commentListArgs["current\_user"], $postId ) ) { |
| [320](#L320) | $newCommentIds                       = explode( ",", trim( $newCommentIds, "," ) ); |
| [321](#L321) | $commentListArgs["new\_loaded\_class"] = "wpd-new-loaded-comment"; |
| [322](#L322) | $response                            = [ "message" => [] ]; |
| [323](#L323) | foreach ( $newCommentIds as $newCommentId ) { |
| [324](#L324) | $comment               = get\_comment( $newCommentId ); |
| [325](#L325) | $commentHtml           = wp\_list\_comments( $commentListArgs, [ $comment ] ); |
| [326](#L326) | $response["message"][] = [ |
| [327](#L327) | "comment\_id"     => $comment->comment\_ID, |
| [328](#L328) | "comment\_parent" => $comment->comment\_parent, |
| [329](#L329) | "comment\_html"   => $commentHtml |
| [330](#L330) | ]; |
| [331](#L331) | } |
| [332](#L332) | $response = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdBubbleUpdate" ); |
| [333](#L333) | wp\_send\_json\_success( $response ); |
| [334](#L334) | } |
| [335](#L335) | } |
| [336](#L336) | } |
| [337](#L337) |  |
| [338](#L338) | public function addComment() { |
| [339](#L339) | $this->helper->validateNonce(); |
| [340](#L340) | $isAnonymous = false; |
| [341](#L341) | $uniqueId    = WpdiscuzHelper::sanitize( INPUT\_POST, "wpdiscuz\_unique\_id", "FILTER\_SANITIZE\_STRING" ); |
| [342](#L342) | $postId      = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [343](#L343) | // $comment\_content is filtered in function "$this->helper->filterCommentText" by WP's native function wp\_kses |
| [344](#L344) | $comment\_content = isset( $\_POST["wc\_comment"] ) ? $\_POST["wc\_comment"] : ""; |
| [345](#L345) |  |
| [346](#L346) | if ( $uniqueId && $postId ) { |
| [347](#L347) |  |
| [348](#L348) | $this->isWpdiscuzLoaded = true; |
| [349](#L349) | $this->form             = $this->wpdiscuzForm->getForm( $postId ); |
| [350](#L350) | $this->form->initFormFields(); |
| [351](#L351) | $currentUser = WpdiscuzHelper::getCurrentUser(); |
| [352](#L352) | if ( $this->form->isUserCanSeeComments( $currentUser, $postId ) && $this->form->isUserCanComment( $currentUser, $postId ) ) { |
| [353](#L353) | $post = get\_post( $postId ); |
| [354](#L354) | do\_action( "wpdiscuz\_before\_comment\_post" ); |
| [355](#L355) | $uid\_data       = $this->helper->getUIDData( $uniqueId ); |
| [356](#L356) | $comment\_parent = intval( $uid\_data[0] ); |
| [357](#L357) | $result         = $this->helper->handleCommentSubmission( $post, $comment\_parent ); |
| [358](#L358) | if ( is\_wp\_error( $result ) ) { |
| [359](#L359) | wp\_die( esc\_html( $result->get\_error\_message() ) ); |
| [360](#L360) | } |
| [361](#L361) |  |
| [362](#L362) | if ( function\_exists( "zerospam\_get\_key" ) && $wpdiscuzZS = WpdiscuzHelper::sanitize( INPUT\_POST, "wpdiscuz\_zs", "FILTER\_SANITIZE\_STRING" ) ) { |
| [363](#L363) | $\_POST["zerospam\_key"] = $wpdiscuzZS === md5( zerospam\_get\_key() ) ? zerospam\_get\_key() : ""; |
| [364](#L364) | } |
| [365](#L365) | $commentDepth      = WpdiscuzHelper::sanitize( INPUT\_POST, "wpd\_comment\_depth", FILTER\_SANITIZE\_NUMBER\_INT, 1 ); |
| [366](#L366) | $isInSameContainer = "1"; |
| [367](#L367) | $wooExists         = class\_exists( "WooCommerce" ) && get\_post\_type( $postId ) === "product"; |
| [368](#L368) | $replyForWoo       = apply\_filters( "wpdiscuz\_product\_review\_replies", true, $postId ); |
| [369](#L369) | if ( $wooExists && ! $replyForWoo ) { |
| [370](#L370) | $isInSameContainer = "0"; |
| [371](#L371) | } else if ( $commentDepth > $this->options->wp["threadCommentsDepth"] ) { |
| [372](#L372) | $commentDepth      = $this->options->wp["threadCommentsDepth"]; |
| [373](#L373) | $isInSameContainer = "0"; |
| [374](#L374) | } else if ( ! $this->options->wp["threadComments"] ) { |
| [375](#L375) | $isInSameContainer = "0"; |
| [376](#L376) | } |
| [377](#L377) | $notificationType = WpdiscuzHelper::sanitize( INPUT\_POST, "wpdiscuz\_notification\_type", "FILTER\_SANITIZE\_STRING" ); |
| [378](#L378) |  |
| [379](#L379) | $this->form->validateFields( $currentUser ); |
| [380](#L380) |  |
| [381](#L381) | $website\_url = ""; |
| [382](#L382) | if ( $currentUser && $currentUser->ID ) { |
| [383](#L383) | $user\_id = $currentUser->ID; |
| [384](#L384) | $name    = $this->helper->getCurrentUserDisplayName( $currentUser ); |
| [385](#L385) | $email   = $currentUser->user\_email; |
| [386](#L386) | } else { |
| [387](#L387) | $user\_id     = 0; |
| [388](#L388) | $name        = urldecode( $this->form->validateDefaultName( $currentUser ) ); |
| [389](#L389) | $email       = urldecode( $this->form->validateDefaultEmail( $currentUser, $isAnonymous ) ); |
| [390](#L390) | $website\_url = $this->form->validateDefaultWebsite( $currentUser ); |
| [391](#L391) | } |
| [392](#L392) | $email = apply\_filters( "wpdiscuz\_commenter\_email", $email ); |
| [393](#L393) |  |
| [394](#L394) | $comment\_content = ( $this->options->form["richEditor"] === "both" || ( ! wp\_is\_mobile() && $this->options->form["richEditor"] === "desktop" ) ) && ! $this->options->showEditorToolbar() ? html\_entity\_decode( $comment\_content ) : $comment\_content; |
| [395](#L395) | $comment\_content = $this->helper->replaceCommentContentCode( $comment\_content ); |
| [396](#L396) | $comment\_content = $this->helper->filterCommentText( $comment\_content ); |
| [397](#L397) |  |
| [398](#L398) | $parentComment  = $comment\_parent ? get\_comment( $comment\_parent ) : null; |
| [399](#L399) | $comment\_parent = isset( $parentComment->comment\_ID ) ? $parentComment->comment\_ID : 0; |
| [400](#L400) | if ( $parentComment && intval( get\_comment\_meta( $comment\_parent, self::META\_KEY\_CLOSED, true ) ) ) { |
| [401](#L401) | wp\_die( esc\_html( $this->options->getPhrase( "wc\_closed\_comment\_thread", [ "comment" => $parentComment ] ) ) ); |
| [402](#L402) | } |
| [403](#L403) | $isReply = $wooExists && ! $replyForWoo ? 0 : $comment\_parent; |
| [404](#L404) | if ( $isReply ) { |
| [405](#L405) | $commentMinLength = intval( $this->options->content["replyTextMinLength"] ); |
| [406](#L406) | $commentMaxLength = intval( $this->options->content["replyTextMaxLength"] ); |
| [407](#L407) | } else { |
| [408](#L408) | $commentMinLength = intval( $this->options->content["commentTextMinLength"] ); |
| [409](#L409) | $commentMaxLength = intval( $this->options->content["commentTextMaxLength"] ); |
| [410](#L410) | } |
| [411](#L411) | $contentLength = function\_exists( "mb\_strlen" ) ? mb\_strlen( strip\_tags( $comment\_content ) ) : strlen( strip\_tags( $comment\_content ) ); |
| [412](#L412) | if ( $commentMinLength > 0 && $contentLength < $commentMinLength ) { |
| [413](#L413) | wp\_send\_json\_error( "wc\_msg\_input\_min\_length" ); |
| [414](#L414) | } |
| [415](#L415) |  |
| [416](#L416) | if ( $commentMaxLength > 0 && $contentLength > $commentMaxLength ) { |
| [417](#L417) | wp\_send\_json\_error( "wc\_msg\_input\_max\_length" ); |
| [418](#L418) | } |
| [419](#L419) |  |
| [420](#L420) | if ( $name && $email ) { |
| [421](#L421) | $website\_url   = $website\_url ? urldecode( $website\_url ) : ""; |
| [422](#L422) | $stickyComment = ""; |
| [423](#L423) | $closedComment = 0; |
| [424](#L424) | if ( $comment\_parent === 0 && ( current\_user\_can( "moderate\_comments" ) || ( $post && isset( $post->post\_author ) && $post->post\_author == $currentUser->ID ) ) ) { |
| [425](#L425) | $stickyComment = WpdiscuzHelper::sanitize( INPUT\_POST, "wc\_sticky\_comment", FILTER\_SANITIZE\_NUMBER\_INT, "" ); |
| [426](#L426) | $closedComment = absint( WpdiscuzHelper::sanitize( INPUT\_POST, "wc\_closed\_comment", FILTER\_SANITIZE\_NUMBER\_INT, 0 ) ); |
| [427](#L427) | } |
| [428](#L428) |  |
| [429](#L429) | $this->helper->restrictCommentingPerUser( $email, $comment\_parent, $postId ); |
| [430](#L430) | $wc\_user\_agent   = isset( $\_SERVER["HTTP\_USER\_AGENT"] ) ? sanitize\_text\_field( $\_SERVER["HTTP\_USER\_AGENT"] ) : ""; |
| [431](#L431) | $new\_commentdata = [ |
| [432](#L432) | "user\_id"              => $user\_id, |
| [433](#L433) | "comment\_post\_ID"      => $postId, |
| [434](#L434) | "comment\_parent"       => $wooExists && ! $replyForWoo ? 0 : $comment\_parent, |
| [435](#L435) | "comment\_author"       => $name, |
| [436](#L436) | "comment\_author\_email" => $email, |
| [437](#L437) | "comment\_content"      => $comment\_content, |
| [438](#L438) | "comment\_author\_url"   => $website\_url, |
| [439](#L439) | "comment\_agent"        => $wc\_user\_agent, |
| [440](#L440) | "comment\_type"         => $wooExists ? "review" : ( $stickyComment ? self::WPDISCUZ\_STICKY\_COMMENT : self::$DEFAULT\_COMMENT\_TYPE ), |
| [441](#L441) | ]; |
| [442](#L442) |  |
| [443](#L443) | $allow\_empty\_comment = apply\_filters( "allow\_empty\_comment", false, $new\_commentdata ); |
| [444](#L444) | if ( "" === $comment\_content && ! $allow\_empty\_comment ) { |
| [445](#L445) | wp\_send\_json\_error( "wc\_msg\_required\_fields" ); |
| [446](#L446) | } |
| [447](#L447) | $new\_comment\_id = wp\_new\_comment( wp\_slash( $new\_commentdata ) ); |
| [448](#L448) | if ( $closedComment ) { |
| [449](#L449) | add\_comment\_meta( $new\_comment\_id, self::META\_KEY\_CLOSED, "1" ); |
| [450](#L450) | } |
| [451](#L451) | //                    $this->form->saveCommentMeta($new\_comment\_id); |
| [452](#L452) | $newComment    = get\_comment( $new\_comment\_id ); |
| [453](#L453) | $held\_moderate = 1; |
| [454](#L454) | if ( $newComment->comment\_approved === "1" ) { |
| [455](#L455) | $held\_moderate = 0; |
| [456](#L456) | if ( $wooExists ) { |
| [457](#L457) | update\_post\_meta( $postId, "\_wc\_review\_count", get\_comments( [ |
| [458](#L458) | "count"   => true, |
| [459](#L459) | "post\_id" => $postId |
| [460](#L460) | ] ) ); |
| [461](#L461) | } |
| [462](#L462) | } |
| [463](#L463) | if ( $notificationType === WpdiscuzCore::SUBSCRIPTION\_POST && class\_exists( "Prompt\_Comment\_Form\_Handling" ) && $this->options->subscription["usePostmaticForCommentNotification"] ) { |
| [464](#L464) | $\_POST[ Prompt\_Comment\_Form\_Handling::SUBSCRIBE\_CHECKBOX\_NAME ] = 1; |
| [465](#L465) | Prompt\_Comment\_Form\_Handling::handle\_form( $new\_comment\_id, $newComment->comment\_approved ); |
| [466](#L466) | } else if ( ! $isAnonymous && $notificationType ) { |
| [467](#L467) | $subscriptionData = $this->dbManager->hasSubscription( $postId, $email ); |
| [468](#L468) | if ( ! $subscriptionData || ( $subscriptionData && $subscriptionData["type"] === self::SUBSCRIPTION\_COMMENT ) ) { |
| [469](#L469) | $noNeedMemberConfirm = ( $currentUser->ID && ! $this->options->subscription["enableMemberConfirm"] ); |
| [470](#L470) | $noNeedGuestsConfirm = ( ! $currentUser->ID && ! $this->options->subscription["enableGuestsConfirm"] ); |
| [471](#L471) | if ( $noNeedMemberConfirm || $noNeedGuestsConfirm ) { |
| [472](#L472) | $this->dbManager->addEmailNotification( $new\_comment\_id, $postId, $email, self::SUBSCRIPTION\_COMMENT, 1 ); |
| [473](#L473) | } else { |
| [474](#L474) | $confirmData = $this->dbManager->addEmailNotification( $new\_comment\_id, $postId, $email, self::SUBSCRIPTION\_COMMENT ); |
| [475](#L475) | if ( $confirmData ) { |
| [476](#L476) | $this->helperEmail->confirmEmailSender( $confirmData["id"], $confirmData["activation\_key"], $postId, $email ); |
| [477](#L477) | } |
| [478](#L478) | } |
| [479](#L479) | } |
| [480](#L480) | } |
| [481](#L481) | $response                                              = []; |
| [482](#L482) | $response["redirect"]                                  = $this->options->general["redirectPage"]; |
| [483](#L483) | $response["new\_comment\_id"]                            = $new\_comment\_id; |
| [484](#L484) | $response["comment\_author"]                            = $name; |
| [485](#L485) | $response["comment\_author\_email"]                      = $email; |
| [486](#L486) | $response["comment\_author\_url"]                        = $website\_url; |
| [487](#L487) | $response["is\_main"]                                   = $wooExists && ! $replyForWoo ? 1 : ( $comment\_parent ? 0 : 1 ); |
| [488](#L488) | $response["held\_moderate"]                             = $held\_moderate; |
| [489](#L489) | $response["is\_in\_same\_container"]                      = $isInSameContainer; |
| [490](#L490) | $response["wc\_all\_comments\_count\_new"]                 = get\_comments\_number( $postId ); |
| [491](#L491) | $response["wc\_all\_comments\_count\_before\_threads\_html"] = "<span class='wpdtc' title='" . esc\_attr( $response["wc\_all\_comments\_count\_new"] ) . "'>" . esc\_html( $this->helper->getNumber( $response["wc\_all\_comments\_count\_new"] ) ) . "</span> " . esc\_html( apply\_filters( "wpdiscuz\_comment\_count\_phrase", ( 1 == $response["wc\_all\_comments\_count\_new"] ? $this->form->getHeaderTextSingle() : $this->form->getHeaderTextPlural() ), $response["wc\_all\_comments\_count\_new"] ) ); |
| [492](#L492) | $response["wc\_all\_comments\_count\_bubble\_html"]         = "<span id='wpd-bubble-all-comments-count'" . ( $response["wc\_all\_comments\_count\_new"] ? "" : " style='display:none;'" ) . " title='" . esc\_attr( $response["wc\_all\_comments\_count\_new"] ) . "'>" . esc\_html( $this->helper->getNumber( $response["wc\_all\_comments\_count\_new"] ) ) . "</span>"; |
| [493](#L493) |  |
| [494](#L494) | $commentListArgs                         = $this->getCommentListArgs( $postId ); |
| [495](#L495) | $commentListArgs["addComment"]           = $commentDepth; |
| [496](#L496) | $commentListArgs["comment\_author\_email"] = $email; |
| [497](#L497) |  |
| [498](#L498) | $response["uniqueid"] = $uniqueId; |
| [499](#L499) | $response["message"]  = wp\_list\_comments( $commentListArgs, [ $newComment ] ); |
| [500](#L500) | if ( apply\_filters( "wpdiscuz\_unslash\_response", true ) ) { |
| [501](#L501) | $response["message"] = wp\_unslash( $response["message"] ); |
| [502](#L502) | } |
| [503](#L503) | do\_action( "wpdiscuz\_after\_comment\_post", $newComment, $currentUser ); |
| [504](#L504) | $response["callbackFunctions"] = []; |
| [505](#L505) | $response                      = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdAddComment" ); |
| [506](#L506) | $response                      = apply\_filters( "wpdiscuz\_comment\_post", $response ); |
| [507](#L507) | do\_action( "wpdiscuz\_clean\_post\_cache", $postId, "comment\_posted" ); |
| [508](#L508) | wp\_send\_json\_success( $response ); |
| [509](#L509) | } else { |
| [510](#L510) | wp\_send\_json\_error( "wc\_invalid\_field" ); |
| [511](#L511) | } |
| [512](#L512) | } else { |
| [513](#L513) | wp\_die( esc\_html( $this->options->getPhrase( "wc\_commenting\_is\_closed" ) ) ); |
| [514](#L514) | } |
| [515](#L515) | } else { |
| [516](#L516) | wp\_send\_json\_error( "wc\_msg\_required\_fields" ); |
| [517](#L517) | } |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | /\*\* |
| [521](#L521) | \* save edited comment via ajax |
| [522](#L522) | \*/ |
| [523](#L523) | public function saveEditedComment() { |
| [524](#L524) | $this->helper->validateNonce(); |
| [525](#L525) | $commentId      = WpdiscuzHelper::sanitize( INPUT\_POST, "commentId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [526](#L526) | $trimmedContent = isset( $\_POST["wc\_comment"] ) ? trim( $\_POST["wc\_comment"] ) : ""; |
| [527](#L527) | $trimmedContent = ( $this->options->form["richEditor"] === "both" || ( ! wp\_is\_mobile() && $this->options->form["richEditor"] === "desktop" ) ) && ! $this->options->showEditorToolbar() ? html\_entity\_decode( $trimmedContent ) : $trimmedContent; |
| [528](#L528) | if ( $commentId ) { |
| [529](#L529) | $this->isWpdiscuzLoaded = true; |
| [530](#L530) | $comment                = get\_comment( $commentId ); |
| [531](#L531) | if ( ! $comment ) { |
| [532](#L532) | wp\_send\_json\_error( "wc\_comment\_edit\_not\_possible" ); |
| [533](#L533) | } |
| [534](#L534) |  |
| [535](#L535) | $result = $this->helper->handleCommentSubmission( $comment->comment\_post\_ID, $comment->comment\_parent, false ); |
| [536](#L536) |  |
| [537](#L537) | if ( is\_wp\_error( $result ) ) { |
| [538](#L538) | wp\_die( $result->get\_error\_message() ); |
| [539](#L539) | } |
| [540](#L540) |  |
| [541](#L541) | $currentUser          = WpdiscuzHelper::getCurrentUser(); |
| [542](#L542) | $uniqueId             = $comment->comment\_ID . "\_" . $comment->comment\_parent; |
| [543](#L543) | $highLevelUser        = current\_user\_can( "moderate\_comments" ); |
| [544](#L544) | $isCurrentUserCanEdit = $this->helper->isCommentEditable( $comment ) && $this->helper->canUserEditComment( $comment, $currentUser ); |
| [545](#L545) | $this->form           = $this->wpdiscuzForm->getForm( $comment->comment\_post\_ID ); |
| [546](#L546) | $this->form->initFormFields(); |
| [547](#L547) | $this->form->validateFields( $currentUser ); |
| [548](#L548) | if ( ! ( (int) get\_comment\_meta( $comment->comment\_ID, self::META\_KEY\_CLOSED, true ) ) && ( $highLevelUser || $isCurrentUserCanEdit ) && $this->form->isUserCanSeeComments( $currentUser, $comment->comment\_post\_ID ) && $this->form->isUserCanComment( $currentUser, $comment->comment\_post\_ID ) ) { |
| [549](#L549) | $isInRange = $this->helper->isContentInRange( $trimmedContent, $comment->comment\_parent ); |
| [550](#L550) |  |
| [551](#L551) | if ( ! $isInRange && ! $highLevelUser ) { |
| [552](#L552) | if ( $comment->comment\_parent ) { |
| [553](#L553) | $commentMinLength = intval( $this->options->content["replyTextMinLength"] ); |
| [554](#L554) | $commentMaxLength = intval( $this->options->content["replyTextMaxLength"] ); |
| [555](#L555) | } else { |
| [556](#L556) | $commentMinLength = intval( $this->options->content["commentTextMinLength"] ); |
| [557](#L557) | $commentMaxLength = intval( $this->options->content["commentTextMaxLength"] ); |
| [558](#L558) | } |
| [559](#L559) | $contentLength = function\_exists( "mb\_strlen" ) ? mb\_strlen( strip\_tags( $trimmedContent ) ) : strlen( strip\_tags( $trimmedContent ) ); |
| [560](#L560) | if ( $commentMinLength > 0 && $contentLength < $commentMinLength ) { |
| [561](#L561) | wp\_send\_json\_error( "wc\_msg\_input\_min\_length" ); |
| [562](#L562) | } |
| [563](#L563) |  |
| [564](#L564) | if ( $commentMaxLength > 0 && $contentLength > $commentMaxLength ) { |
| [565](#L565) | wp\_send\_json\_error( "wc\_msg\_input\_max\_length" ); |
| [566](#L566) | } |
| [567](#L567) | } |
| [568](#L568) |  |
| [569](#L569) | if ( $isInRange || $highLevelUser ) { |
| [570](#L570) | $response   = []; |
| [571](#L571) | $commentarr = [ |
| [572](#L572) | "comment\_ID"           => $commentId, |
| [573](#L573) | "comment\_content"      => $comment->comment\_content, |
| [574](#L574) | "comment\_approved"     => $comment->comment\_approved, |
| [575](#L575) | "comment\_post\_ID"      => $comment->comment\_post\_ID, |
| [576](#L576) | "comment\_author"       => $comment->comment\_author, |
| [577](#L577) | "comment\_author\_url"   => $comment->comment\_author\_url, |
| [578](#L578) | "comment\_author\_email" => $comment->comment\_author\_email, |
| [579](#L579) | "comment\_type"         => $comment->comment\_type, |
| [580](#L580) | "comment\_parent"       => $comment->comment\_parent, |
| [581](#L581) | "user\_id"              => $comment->user\_id, |
| [582](#L582) | "comment\_author\_IP"    => $comment->comment\_author\_IP, |
| [583](#L583) | "comment\_date\_gmt"     => $comment->comment\_date\_gmt |
| [584](#L584) | ]; |
| [585](#L585) |  |
| [586](#L586) | //                      remove\_filter( 'wp\_is\_comment\_flood', 'wp\_check\_comment\_flood', 10); |
| [587](#L587) |  |
| [588](#L588) | add\_filter( 'wp\_is\_comment\_flood', '\_\_return\_false', 99 ); |
| [589](#L589) |  |
| [590](#L590) | $commentdata                    = wp\_slash( $commentarr ); |
| [591](#L591) | $commentdata['comment\_content'] = wp\_slash( $trimmedContent ); |
| [592](#L592) | $commentarr['comment\_approved'] = wp\_allow\_comment( $commentdata, true ); |
| [593](#L593) |  |
| [594](#L594) | if ( is\_wp\_error( $commentarr['comment\_approved'] ) ) { |
| [595](#L595) | wp\_die( $commentarr['comment\_approved']->get\_error\_message() ); |
| [596](#L596) | } |
| [597](#L597) |  |
| [598](#L598) | if ( $trimmedContent !== $comment->comment\_content ) { |
| [599](#L599) |  |
| [600](#L600) | $trimmedContent                = $this->helper->replaceCommentContentCode( $trimmedContent ); |
| [601](#L601) | $commentContent                = $this->helper->filterCommentText( $trimmedContent ); |
| [602](#L602) | $userAgent                     = isset( $\_SERVER["HTTP\_USER\_AGENT"] ) ? $\_SERVER["HTTP\_USER\_AGENT"] : ""; |
| [603](#L603) | $commentarr["comment\_content"] = $commentContent; |
| [604](#L604) | $commentarr["comment\_agent"]   = $userAgent; |
| [605](#L605) |  |
| [606](#L606) |  |
| [607](#L607) | if ( class\_exists( "Akismet" ) && method\_exists( 'Akismet', 'auto\_check\_comment' ) ) { |
| [608](#L608) |  |
| [609](#L609) | $commentarr = Akismet::auto\_check\_comment( $commentarr ); |
| [610](#L610) | if ( $commentarr["akismet\_result"] === "false" && $comment->comment\_approved == "spam" ) { |
| [611](#L611) | $commentarr["comment\_approved"] = 0; |
| [612](#L612) | } else if ( $commentarr["akismet\_result"] === "true" ) { |
| [613](#L613) | $commentarr["comment\_approved"] = "spam"; |
| [614](#L614) | } |
| [615](#L615) | } |
| [616](#L616) |  |
| [617](#L617) | $allow\_empty\_comment = apply\_filters( "allow\_empty\_comment", false, $commentarr ); |
| [618](#L618) |  |
| [619](#L619) | if ( "" === $commentContent && ! $allow\_empty\_comment ) { |
| [620](#L620) | wp\_send\_json\_error( "wc\_msg\_required\_fields" ); |
| [621](#L621) | } |
| [622](#L622) |  |
| [623](#L623) | wp\_update\_comment( wp\_slash( $commentarr ) ); |
| [624](#L624) | $lastEditedAt = current\_time( "mysql", 1 ); |
| [625](#L625) | update\_comment\_meta( $commentId, self::META\_KEY\_LAST\_EDITED\_AT, $lastEditedAt ); |
| [626](#L626) | update\_comment\_meta( $commentId, self::META\_KEY\_LAST\_EDITED\_BY, ! empty( $currentUser->ID ) ? $currentUser->ID : $comment->comment\_author\_email ); |
| [627](#L627) | if ( $this->options->moderation["displayEditingInfo"] ) { |
| [628](#L628) | if ( ! empty( $currentUser->ID ) ) { |
| [629](#L629) | $lastEditedBy = get\_user\_by( "id", $currentUser->ID ); |
| [630](#L630) | } else { |
| [631](#L631) | $lastEditedBy = get\_user\_by( "email", $currentUser->comment\_author\_email ); |
| [632](#L632) | } |
| [633](#L633) | $username               = $lastEditedBy ? $lastEditedBy->display\_name : $comment->comment\_author; |
| [634](#L634) | $response["lastEdited"] = "<div class='wpd-comment-last-edited'><i class='far fa-edit'></i>" . esc\_html( sprintf( $this->options->getPhrase( "wc\_last\_edited", [ "comment" => $comment ] ), $this->helper->dateDiff( $lastEditedAt ), $username ) ) . "</div>"; |
| [635](#L635) | } |
| [636](#L636) | do\_action( "wpdiscuz\_clean\_post\_cache", $comment->comment\_post\_ID, "comment\_edited" ); |
| [637](#L637) | do\_action( "wpdiscuz\_reset\_comments\_cache", $comment->comment\_post\_ID ); |
| [638](#L638) | } |
| [639](#L639) |  |
| [640](#L640) | $this->form->saveCommentMeta( $comment->comment\_ID ); |
| [641](#L641) | $commentContent = isset( $commentContent ) ? $commentContent : $trimmedContent; |
| [642](#L642) | if ( $this->options->content["enableImageConversion"] ) { |
| [643](#L643) | $commentContent = $this->helper->makeClickable( $commentContent ); |
| [644](#L644) | } |
| [645](#L645) | $commentLink          = get\_comment\_link( $comment ); |
| [646](#L646) | $commentContent       = apply\_filters( "comment\_text", $commentContent, $comment, [ "is\_wpdiscuz\_comment" => true ] ); |
| [647](#L647) | $commentReadMoreLimit = $this->options->content["commentReadMoreLimit"]; |
| [648](#L648) | if ( stripos( $commentContent, "[/spoiler]" ) !== false ) { |
| [649](#L649) | $commentReadMoreLimit = 0; |
| [650](#L650) | $commentContent       = $this->helper->spoiler( $commentContent ); |
| [651](#L651) | } |
| [652](#L652) | if ( $commentReadMoreLimit && WpdiscuzHelper::strWordCount( wp\_strip\_all\_tags( $commentContent ) ) > $commentReadMoreLimit ) { |
| [653](#L653) | $commentContent = WpdiscuzHelper::getCommentExcerpt( $commentContent, $uniqueId, $this->options ); |
| [654](#L654) | } |
| [655](#L655) | $commentContent = apply\_filters( "wpdiscuz\_after\_read\_more", $commentContent, $comment, [ "is\_wpdiscuz\_comment" => true ] ); |
| [656](#L656) | if ( $this->options->social["enableTwitterShare"] ) { |
| [657](#L657) | $response["twitterShareLink"] = esc\_url\_raw( "https://twitter.com/intent/tweet?text=" . $this->helper->getTwitterShareContent( $commentContent, $commentLink ) . "&url=" . urlencode( $commentLink ) ); |
| [658](#L658) | } |
| [659](#L659) | if ( $this->options->social["enableWhatsappShare"] ) { |
| [660](#L660) | $response["whatsappShareLink"] = esc\_url\_raw( ( wp\_is\_mobile() ? "https://api.whatsapp.com" : "https://web.whatsapp.com" ) . "/send?text=" . $this->helper->getWhatsappShareContent( $commentContent, $commentLink ) ); |
| [661](#L661) | } |
| [662](#L662) |  |
| [663](#L663) | $components    = $this->helper->getComponents( $this->form->getTheme(), $this->form->getLayout() ); |
| [664](#L664) | $inlineContent = ""; |
| [665](#L665) | if ( $inlineFormID = intval( get\_comment\_meta( $comment->comment\_ID, self::META\_KEY\_FEEDBACK\_FORM\_ID, true ) ) ) { |
| [666](#L666) | $feedbackForm  = $this->dbManager->getFeedbackForm( $inlineFormID ); |
| [667](#L667) | $inlineContent = "<div class='wpd-inline-feedback-wrapper'><span class='wpd-inline-feedback-info'>" . esc\_html( $this->options->getPhrase( "wc\_feedback\_content\_text" ) ) . "</span> <i class='fas fa-quote-left'></i>" . wp\_trim\_words( $feedbackForm->content, apply\_filters( "wpdiscuz\_feedback\_content\_words\_count", 20 ) ) . "&quot;  <a class='wpd-feedback-content-link' data-feedback-content-id='{$feedbackForm->id}' href='#wpd-inline-{$feedbackForm->id}'>" . esc\_html( $this->options->getPhrase( "wc\_read\_more" ) ) . "</a></div>"; |
| [668](#L668) | } |
| [669](#L669) | if ( $commentarr["comment\_approved"] === "spam" ) { |
| [670](#L670) | $commentContent = "<span style='color:#fc9007;'>" . esc\_html( $this->options->getPhrase( "wc\_awaiting\_for\_approval", [ "comment" => $comment ] ) ) . ": " . esc\_html\_\_( "Spam" ) . "</span>"; |
| [671](#L671) | } |
| [672](#L672) | $response["message"] = str\_replace( [ "{TEXT\_WRAPPER\_CLASSES}", "{TEXT}" ], [ |
| [673](#L673) | "wpd-comment-text", |
| [674](#L674) | $inlineContent . $commentContent |
| [675](#L675) | ], $components["text.html"] ); |
| [676](#L676) |  |
| [677](#L677) | $response["callbackFunctions"] = []; |
| [678](#L678) | $response                      = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdSaveEditedComment" ); |
| [679](#L679) | $response                      = apply\_filters( "wpdiscuz\_comment\_edit\_save", $response ); |
| [680](#L680) | wp\_send\_json\_success( $response ); |
| [681](#L681) | } else { |
| [682](#L682) | wp\_send\_json\_error( "wc\_comment\_edit\_not\_possible" ); |
| [683](#L683) | } |
| [684](#L684) | } else { |
| [685](#L685) | wp\_send\_json\_error( "wc\_comment\_edit\_not\_possible" ); |
| [686](#L686) | } |
| [687](#L687) | } |
| [688](#L688) | } |
| [689](#L689) |  |
| [690](#L690) | /\*\* |
| [691](#L691) | \* Gets single comment with its full thread and displays in comment list |
| [692](#L692) | \*/ |
| [693](#L693) | public function getSingleComment() { |
| [694](#L694) | $commentId = WpdiscuzHelper::sanitize( INPUT\_POST, "commentId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [695](#L695) | $comment   = get\_comment( $commentId ); |
| [696](#L696) | $postId    = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [697](#L697) | if ( $commentId && $postId && $comment && $comment->comment\_post\_ID == $postId ) { |
| [698](#L698) | $commentListArgs    = $this->getCommentListArgs( $postId ); |
| [699](#L699) | $this->commentsArgs = $this->getDefaultCommentsArgs( $postId ); |
| [700](#L700) | if ( $this->form->isUserCanSeeComments( $commentListArgs["current\_user"], $postId ) ) { |
| [701](#L701) | $showUnapprovedComment = false; |
| [702](#L702) | $includeUnapproved     = null; |
| [703](#L703) | if ( $comment->comment\_approved === "0" ) { |
| [704](#L704) | if ( $commentListArgs["high\_level\_user"] ) { |
| [705](#L705) | $showUnapprovedComment = true; |
| [706](#L706) | } else if ( ! empty( $this->commentsArgs["include\_unapproved"] ) ) { |
| [707](#L707) | $includeUnapproved = $this->commentsArgs["include\_unapproved"][0]; |
| [708](#L708) | if ( is\_numeric( $this->commentsArgs["include\_unapproved"][0] ) ) { |
| [709](#L709) | if ( $comment->user\_id == $this->commentsArgs["include\_unapproved"][0] ) { |
| [710](#L710) | $showUnapprovedComment = true; |
| [711](#L711) | } |
| [712](#L712) | } else if ( $comment->comment\_author\_email === $this->commentsArgs["include\_unapproved"][0] ) { |
| [713](#L713) | $showUnapprovedComment = true; |
| [714](#L714) | } |
| [715](#L715) | } |
| [716](#L716) | } |
| [717](#L717) | if ( $comment->comment\_approved === "1" || $showUnapprovedComment ) { |
| [718](#L718) | $this->isWpdiscuzLoaded = true; |
| [719](#L719) | $commentStatusIn        = [ "1" ]; |
| [720](#L720) | if ( $this->commentsArgs["status"] === "all" ) { |
| [721](#L721) | $commentStatusIn[] = "0"; |
| [722](#L722) | } |
| [723](#L723) |  |
| [724](#L724) | if ( ! $this->options->wp["threadComments"] ) { |
| [725](#L725) | $comments      = [ $comment ]; |
| [726](#L726) | $parentComment = $comment; |
| [727](#L727) | } else if ( $parentComment = $this->helperOptimization->getCommentRoot( $commentId, $commentStatusIn, $includeUnapproved ) ) { |
| [728](#L728) | $args = [ |
| [729](#L729) | "format"  => "flat", |
| [730](#L730) | "status"  => $this->commentsArgs["status"], |
| [731](#L731) | "orderby" => $this->commentsArgs["orderby"], |
| [732](#L732) | "post\_id" => $this->commentsArgs["post\_id"], |
| [733](#L733) | ]; |
| [734](#L734) | if ( ! empty( $this->commentsArgs["include\_unapproved"] ) ) { |
| [735](#L735) | $args["include\_unapproved"] = $this->commentsArgs["include\_unapproved"]; |
| [736](#L736) | } |
| [737](#L737) | $tree     = $parentComment->get\_children( $args ); |
| [738](#L738) | $comments = array\_merge( [ $parentComment ], $tree ); |
| [739](#L739) | } |
| [740](#L740) | if ( $parentComment ) { |
| [741](#L741) | $commentListArgs["isSingle"]         = true; |
| [742](#L742) | $commentListArgs["new\_loaded\_class"] = "wpd-new-loaded-comment"; |
| [743](#L743) | if ( $comments && $this->options->thread\_layouts["highlightVotingButtons"] ) { |
| [744](#L744) | if ( ! empty( $commentListArgs['current\_user']->ID ) ) { |
| [745](#L745) | $commentListArgs['user\_votes'] = $this->dbManager->getUserVotes( $comments, $commentListArgs['current\_user']->ID ); |
| [746](#L746) | } else { |
| [747](#L747) | $commentListArgs['user\_votes'] = $this->dbManager->getUserVotes( $comments, md5( $this->helper->getRealIPAddr() ) ); |
| [748](#L748) | } |
| [749](#L749) | } |
| [750](#L750) | $response                      = []; |
| [751](#L751) | $response["message"]           = wp\_list\_comments( $commentListArgs, $comments ); |
| [752](#L752) | $response["parentCommentID"]   = $parentComment->comment\_ID; |
| [753](#L753) | $response["callbackFunctions"] = []; |
| [754](#L754) | $response                      = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdGetSingleComment" ); |
| [755](#L755) | wp\_send\_json\_success( $response ); |
| [756](#L756) | } |
| [757](#L757) | } |
| [758](#L758) | } |
| [759](#L759) | } |
| [760](#L760) | } |
| [761](#L761) |  |
| [762](#L762) | public function loadMoreComments() { |
| [763](#L763) | $postId       = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [764](#L764) | $lastParentId = WpdiscuzHelper::sanitize( INPUT\_POST, "lastParentId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [765](#L765) | if ( $lastParentId >= 0 && $postId ) { |
| [766](#L766) | $this->form = $this->wpdiscuzForm->getForm( $postId ); |
| [767](#L767) | if ( $this->form->isUserCanSeeComments( WpdiscuzHelper::getCurrentUser(), $postId ) ) { |
| [768](#L768) | $this->isWpdiscuzLoaded = true; |
| [769](#L769) | $isFirstLoad            = WpdiscuzHelper::sanitize( INPUT\_POST, "isFirstLoad", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [770](#L770) | // max value of php int for limit |
| [771](#L771) | $limit           = ( $isFirstLoad && $this->options->thread\_display["commentListLoadType"] == 3 ) || ( ! $isFirstLoad && $this->options->thread\_display["commentListLoadType"] == 1 ) ? PHP\_INT\_MAX - 1 : $this->options->wp["commentPerPage"]; |
| [772](#L772) | $args            = [ "number" => $limit ]; |
| [773](#L773) | $args["wpdType"] = WpdiscuzHelper::sanitize( INPUT\_POST, "wpdType", "FILTER\_SANITIZE\_STRING" ); |
| [774](#L774) | if ( $isFirstLoad ) { |
| [775](#L775) | $args["first\_load"] = true; |
| [776](#L776) | } |
| [777](#L777) | $sorting = WpdiscuzHelper::sanitize( INPUT\_POST, "sorting", "FILTER\_SANITIZE\_STRING" ); |
| [778](#L778) | if ( $sorting === "newest" ) { |
| [779](#L779) | $args["orderby"] = $this->options->thread\_display["orderCommentsBy"]; |
| [780](#L780) | $args["order"]   = "desc"; |
| [781](#L781) | } else if ( $sorting === "oldest" ) { |
| [782](#L782) | $args["orderby"] = $this->options->thread\_display["orderCommentsBy"]; |
| [783](#L783) | $args["order"]   = "asc"; |
| [784](#L784) | } else if ( $sorting === "by\_vote" ) { |
| [785](#L785) | $args["orderby"] = "by\_vote"; |
| [786](#L786) | $args["order"]   = $this->options->wp["commentOrder"]; |
| [787](#L787) | } |
| [788](#L788) | if ( isset( $args["orderby"] ) && $args["orderby"] === "by\_vote" && ( $offset = WpdiscuzHelper::sanitize( INPUT\_POST, "offset", FILTER\_SANITIZE\_NUMBER\_INT, 0 ) ) ) { |
| [789](#L789) | $args["offset"] = $offset \* ( $isFirstLoad && $this->options->thread\_display["commentListLoadType"] == 3 ? 0 : $this->options->wp["commentPerPage"] ); |
| [790](#L790) | } |
| [791](#L791) | $args["last\_parent\_id"] = $lastParentId; |
| [792](#L792) | $args["post\_id"]        = $postId; |
| [793](#L793) | $args                   = apply\_filters( "wpdiscuz\_filter\_args", $args ); |
| [794](#L794) | $commentData            = $this->getWPComments( $args ); |
| [795](#L795) | if ( $this->options->live["commentListUpdateType"] || ( $this->options->live["enableBubble"] && $this->options->live["bubbleLiveUpdate"] ) ) { |
| [796](#L796) | $commentData["loadLastCommentId"] = $this->dbManager->getLastCommentId( $this->commentsArgs ); |
| [797](#L797) | } |
| [798](#L798) | $commentData["callbackFunctions"] = []; |
| [799](#L799) | $commentData                      = apply\_filters( "wpdiscuz\_ajax\_callbacks", $commentData, $action = "wpdLoadMoreComments" ); |
| [800](#L800) | wp\_send\_json\_success( $commentData ); |
| [801](#L801) | } |
| [802](#L802) | } |
| [803](#L803) | } |
| [804](#L804) |  |
| [805](#L805) | public function sorting() { |
| [806](#L806) | $postId  = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [807](#L807) | $sorting = WpdiscuzHelper::sanitize( INPUT\_POST, "sorting", "FILTER\_SANITIZE\_STRING" ); |
| [808](#L808) | if ( $postId && $sorting ) { |
| [809](#L809) | $this->form = $this->wpdiscuzForm->getForm( $postId ); |
| [810](#L810) | if ( $this->form->isUserCanSeeComments( WpdiscuzHelper::getCurrentUser(), $postId ) ) { |
| [811](#L811) | $this->isWpdiscuzLoaded = true; |
| [812](#L812) | $args                   = [ "post\_id" => $postId ]; |
| [813](#L813) | if ( $sorting === "newest" ) { |
| [814](#L814) | $args["orderby"] = $this->options->thread\_display["orderCommentsBy"]; |
| [815](#L815) | $args["order"]   = "desc"; |
| [816](#L816) | } else if ( $sorting === "oldest" ) { |
| [817](#L817) | $args["orderby"] = $this->options->thread\_display["orderCommentsBy"]; |
| [818](#L818) | $args["order"]   = "asc"; |
| [819](#L819) | } else if ( $sorting === "by\_vote" ) { |
| [820](#L820) | $args["orderby"] = "by\_vote"; |
| [821](#L821) | $args["order"]   = $this->options->wp["commentOrder"]; |
| [822](#L822) | } |
| [823](#L823) | $args["first\_load"] = 1; |
| [824](#L824) | $args["wpdType"]    = WpdiscuzHelper::sanitize( INPUT\_POST, "wpdType", "FILTER\_SANITIZE\_STRING" ); |
| [825](#L825) | $args               = apply\_filters( "wpdiscuz\_filter\_args", $args ); |
| [826](#L826) | $commentData        = $this->getWPComments( $args ); |
| [827](#L827) | $response           = [ |
| [828](#L828) | "last\_parent\_id"    => $commentData["last\_parent\_id"], |
| [829](#L829) | "is\_show\_load\_more" => $commentData["is\_show\_load\_more"], |
| [830](#L830) | "message"           => $commentData["comment\_list"], |
| [831](#L831) | "callbackFunctions" => [], |
| [832](#L832) | ]; |
| [833](#L833) | $response           = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdSorting" ); |
| [834](#L834) | wp\_send\_json\_success( $response ); |
| [835](#L835) | } |
| [836](#L836) | } |
| [837](#L837) | } |
| [838](#L838) |  |
| [839](#L839) | /\*\* |
| [840](#L840) | \* get comments by comment type |
| [841](#L841) | \*/ |
| [842](#L842) | public function getWPComments( $args = [] ) { |
| [843](#L843) | global $post; |
| [844](#L844) | $postId             = isset( $args["post\_id"] ) ? $args["post\_id"] : $post->ID; |
| [845](#L845) | $defaults           = $this->getDefaultCommentsArgs( $postId ); |
| [846](#L846) | $this->commentsArgs = wp\_parse\_args( $args, $defaults ); |
| [847](#L847) | $commentListArgs    = $this->getCommentListArgs( $postId ); |
| [848](#L848) | do\_action( "wpdiscuz\_before\_getcomments", $this->commentsArgs, $commentListArgs["current\_user"], $args ); |
| [849](#L849) | $commentData = []; |
| [850](#L850) |  |
| [851](#L851) | if ( $commentCache = $this->cache->getCommentsCache( $this->commentsArgs ) ) { |
| [852](#L852) | $commentList = $commentCache["commentList"]; |
| [853](#L853) | $commentData = $commentCache["commentData"]; |
| [854](#L854) | if ( $commentList && $this->options->thread\_layouts["highlightVotingButtons"] ) { |
| [855](#L855) | if ( ! empty( $commentListArgs["current\_user"]->ID ) ) { |
| [856](#L856) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $commentList, $commentListArgs['current\_user']->ID ); |
| [857](#L857) | } else { |
| [858](#L858) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $commentList, md5( $this->helper->getRealIPAddr() ) ); |
| [859](#L859) | } |
| [860](#L860) | } |
| [861](#L861) | if ( $this->options->wp["isPaginate"] ) { |
| [862](#L862) | $commentListArgs["page"]              = 0; |
| [863](#L863) | $commentListArgs["per\_page"]          = 0; |
| [864](#L864) | $commentListArgs["reverse\_top\_level"] = $this->options->wp["commentOrder"] === "desc"; |
| [865](#L865) | } |
| [866](#L866) | if ( $this->options->wp["threadComments"] && $this->options->thread\_display["isLoadOnlyParentComments"] && $commentList ) { |
| [867](#L867) | $commentList = $this->getChildren( $commentList, $commentListArgs ); |
| [868](#L868) | } |
| [869](#L869) | } else { |
| [870](#L870) | $commentList = $this->\_getWPComments( $commentListArgs, $commentData ); |
| [871](#L871) | $this->cache->setCommentsCache( $this->commentsArgs, $commentList, $commentData ); |
| [872](#L872) | } |
| [873](#L873) |  |
| [874](#L874) | if ( is\_array( $commentList ) && ( $count = count( $commentList ) ) ) { |
| [875](#L875) | $commentListArgs["lastCommentIdInList"] = $commentList[ $count - 1 ]->comment\_ID; |
| [876](#L876) | } |
| [877](#L877) |  |
| [878](#L878) | $commentData["comments\_count"] = $commentList && is\_array( $commentList ) ? count( $commentList ) : - 1; |
| [879](#L879) | $commentData["comment\_list"]   = wp\_list\_comments( $commentListArgs, $commentList ); |
| [880](#L880) | $commentData["comment\_list"]   .= $commentCache ? "<!-- // From wpDiscuz's Caches // -->" : ""; |
| [881](#L881) | $this->commentsArgs["caller"]  = ""; |
| [882](#L882) |  |
| [883](#L883) | return $commentData; |
| [884](#L884) | } |
| [885](#L885) |  |
| [886](#L886) | public function \_getWPComments( &$commentListArgs, &$commentData ) { |
| [887](#L887) | if ( $this->options->wp["isPaginate"] ) {// PAGINATION |
| [888](#L888) | $oldOrder                     = $this->commentsArgs["order"]; |
| [889](#L889) | $page                         = get\_query\_var( "cpage" ); |
| [890](#L890) | $this->commentsArgs["number"] = $this->options->wp["commentPerPage"]; |
| [891](#L891) | $this->commentsArgs["order"]  = "asc"; |
| [892](#L892) | $this->commentsArgs["caller"] = ""; |
| [893](#L893) | if ( $this->options->wp["threadComments"] ) { |
| [894](#L894) | $this->commentsArgs["parent"] = 0; |
| [895](#L895) | } |
| [896](#L896) |  |
| [897](#L897) | if ( $page ) { |
| [898](#L898) | $this->commentsArgs["offset"] = ( $page - 1 ) \* $this->options->wp["commentPerPage"]; |
| [899](#L899) | } else if ( $this->options->wp["defaultCommentsPage"] === "oldest" ) { |
| [900](#L900) | $this->commentsArgs["offset"] = 0; |
| [901](#L901) | } |
| [902](#L902) |  |
| [903](#L903) | $commentListArgs["page"]              = 0; |
| [904](#L904) | $commentListArgs["per\_page"]          = 0; |
| [905](#L905) | $commentListArgs["reverse\_top\_level"] = $this->options->wp["commentOrder"] === "desc"; |
| [906](#L906) |  |
| [907](#L907) | $commentList = get\_comments( $this->commentsArgs ); |
| [908](#L908) | if ( $this->options->wp["threadComments"] && $commentList ) { |
| [909](#L909) | $commentList = $this->getChildren( $commentList, $commentListArgs ); |
| [910](#L910) | } |
| [911](#L911) | $this->getStickyComments( true, $commentList, $commentListArgs ); |
| [912](#L912) | $this->commentsArgs["order"] = $oldOrder; |
| [913](#L913) | } else { // AJAX LOAD MORE |
| [914](#L914) | $limitBefore = $this->commentsArgs["number"]; |
| [915](#L915) | if ( $this->commentsArgs["number"] ) { |
| [916](#L916) | $this->commentsArgs["number"] += 1; |
| [917](#L917) | } |
| [918](#L918) | if ( $this->commentsArgs["wpdType"] === "inline" ) { |
| [919](#L919) | $this->commentsArgs["meta\_query"] = [ |
| [920](#L920) | [ |
| [921](#L921) | "key"     => self::META\_KEY\_FEEDBACK\_FORM\_ID, |
| [922](#L922) | "value"   => 0, |
| [923](#L923) | "compare" => "!=", |
| [924](#L924) | ], |
| [925](#L925) | ]; |
| [926](#L926) | } |
| [927](#L927) | $commentList      = get\_comments( $this->commentsArgs ); |
| [928](#L928) | $commentListCount = $commentList && is\_array( $commentList ) ? count( $commentList ) : 0; |
| [929](#L929) | if ( $limitBefore && $commentListCount > $limitBefore ) { |
| [930](#L930) | unset( $commentList[ $commentListCount - 1 ] ); |
| [931](#L931) | $commentListCount --; |
| [932](#L932) | $commentData["is\_show\_load\_more"] = true; |
| [933](#L933) | } else { |
| [934](#L934) | $commentData["is\_show\_load\_more"] = false; |
| [935](#L935) | } |
| [936](#L936) | if ( $commentList && is\_array( $commentList ) ) { |
| [937](#L937) | $commentData["last\_parent\_id"] = $commentList[ $commentListCount - 1 ]->comment\_ID; |
| [938](#L938) | // get count of left comments |
| [939](#L939) | if ( apply\_filters( "wpdiscuz\_show\_comments\_left", false ) ) { |
| [940](#L940) | $lastId                               = $this->commentsArgs["last\_parent\_id"]; |
| [941](#L941) | $this->commentsArgs["last\_parent\_id"] = $commentData["last\_parent\_id"]; |
| [942](#L942) | $this->commentsArgs["count"]          = true; |
| [943](#L943) | $this->commentsArgs["caller"]         = "wpdiscuz"; |
| [944](#L944) | $commentsLeft                         = get\_comments( $this->commentsArgs ); |
| [945](#L945) | $this->commentsArgs["last\_parent\_id"] = $lastId; |
| [946](#L946) | $this->commentsArgs["count"]          = false; |
| [947](#L947) | $this->commentsArgs["caller"]         = ""; |
| [948](#L948) | $commentData["comments\_left"]         = $commentsLeft; //send back to ajax comments left count |
| [949](#L949) | $commentData["comments\_left\_text"]    = apply\_filters( "wpdiscuz\_comments\_left\_text", |
| [950](#L950) | "({$commentsLeft})", |
| [951](#L951) | [ |
| [952](#L952) | "post"          => $this->commentsArgs["post\_id"], |
| [953](#L953) | "user"          => $this->commentsArgs["user"], |
| [954](#L954) | "comments\_left" => $commentsLeft |
| [955](#L955) | ] |
| [956](#L956) | ); |
| [957](#L957) | } |
| [958](#L958) | if ( $this->options->wp["threadComments"] ) { |
| [959](#L959) | $commentList = $this->getChildren( $commentList, $commentListArgs ); |
| [960](#L960) | } |
| [961](#L961) | } else { |
| [962](#L962) | $commentData["last\_parent\_id"] = 0; |
| [963](#L963) | } |
| [964](#L964) | $this->getStickyComments( false, $commentList, $commentListArgs ); |
| [965](#L965) | $commentListArgs["page"]           = 1; |
| [966](#L966) | $commentListArgs["last\_parent\_id"] = $commentData["last\_parent\_id"]; |
| [967](#L967) | } |
| [968](#L968) | if ( $commentList && $this->options->thread\_layouts["highlightVotingButtons"] ) { |
| [969](#L969) | if ( ! empty( $commentListArgs["current\_user"]->ID ) ) { |
| [970](#L970) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $commentList, $commentListArgs['current\_user']->ID ); |
| [971](#L971) | } else { |
| [972](#L972) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $commentList, md5( $this->helper->getRealIPAddr() ) ); |
| [973](#L973) | } |
| [974](#L974) | } |
| [975](#L975) |  |
| [976](#L976) | return apply\_filters( "comments\_array", $commentList, $this->commentsArgs["post\_id"] ); |
| [977](#L977) | } |
| [978](#L978) |  |
| [979](#L979) | private function getChildren( $commentList, &$commentListArgs ) { |
| [980](#L980) | $parentComments = []; |
| [981](#L981) | $args           = [ |
| [982](#L982) | "format"                    => "flat", |
| [983](#L983) | "status"                    => $this->commentsArgs["status"], |
| [984](#L984) | "orderby"                   => $this->commentsArgs["orderby"], |
| [985](#L985) | "post\_id"                   => $this->commentsArgs["post\_id"], |
| [986](#L986) | "update\_comment\_meta\_cache" => false, |
| [987](#L987) | "no\_found\_rows"             => false, |
| [988](#L988) | "update\_comment\_post\_cache" => false, |
| [989](#L989) | ]; |
| [990](#L990) | if ( ! empty( $this->commentsArgs["include\_unapproved"] ) ) { |
| [991](#L991) | $args["include\_unapproved"] = $this->commentsArgs["include\_unapproved"]; |
| [992](#L992) | } |
| [993](#L993) | foreach ( $commentList as $parentComment ) { |
| [994](#L994) | $parentComments[] = $parentComment; |
| [995](#L995) | $children         = $parentComment->get\_children( $args ); |
| [996](#L996) | if ( $this->options->thread\_display["isLoadOnlyParentComments"] ) { |
| [997](#L997) | $commentListArgs[ "wpdiscuz\_child\_count\_" . $parentComment->comment\_ID ] = count( $children ); |
| [998](#L998) | } else { |
| [999](#L999) | $parentComments = array\_merge( $parentComments, $children ); |
| [1000](#L1000) | } |
| [1001](#L1001) | } |
| [1002](#L1002) |  |
| [1003](#L1003) | return $parentComments; |
| [1004](#L1004) | } |
| [1005](#L1005) |  |
| [1006](#L1006) | public function commentsTemplateQueryArgs( $args ) { |
| [1007](#L1007) | global $post; |
| [1008](#L1008) | if ( $this->isWpdiscuzLoaded ) { |
| [1009](#L1009) | if ( $this->options->wp["isPaginate"] ) { |
| [1010](#L1010) | $args["caller"] = "wpdiscuz"; |
| [1011](#L1011) | } else { |
| [1012](#L1012) | $args["post\_\_not\_in"] = $post->ID; |
| [1013](#L1013) | } |
| [1014](#L1014) | } |
| [1015](#L1015) |  |
| [1016](#L1016) | return $args; |
| [1017](#L1017) | } |
| [1018](#L1018) |  |
| [1019](#L1019) | public function preGetComments( $queryObj ) { |
| [1020](#L1020) | if ( isset( $this->commentsArgs["caller"] ) && $this->commentsArgs["caller"] === "wpdiscuz-" ) { |
| [1021](#L1021) | $vars                 = $queryObj->query\_vars; |
| [1022](#L1022) | $vars["comment\_\_in"]  = ""; |
| [1023](#L1023) | $queryObj->query\_vars = $vars; |
| [1024](#L1024) | } |
| [1025](#L1025) | } |
| [1026](#L1026) |  |
| [1027](#L1027) | public function foundCommentsQuery( $q, $qObj ) { |
| [1028](#L1028) | if ( $this->options->wp["isPaginate"] && isset( $qObj->query\_vars["caller"] ) && $qObj->query\_vars["caller"] === "wpdiscuz" && empty( $this->commentsArgs["sticky"] ) ) { |
| [1029](#L1029) | global $wpdb, $post; |
| [1030](#L1030) | $where = "WHERE"; |
| [1031](#L1031) | if ( ! empty( $qObj->query\_vars["include\_unapproved"][0] ) ) { |
| [1032](#L1032) | if ( is\_numeric( $qObj->query\_vars["include\_unapproved"][0] ) ) { |
| [1033](#L1033) | $where .= " (comment\_approved = '1' OR " . $wpdb->prepare( "(user\_id = %d AND comment\_approved = '0')", $qObj->query\_vars["include\_unapproved"][0] ) . ")"; |
| [1034](#L1034) | } else { |
| [1035](#L1035) | $where .= " (comment\_approved = '1' OR " . $wpdb->prepare( "(comment\_author\_email = %s AND comment\_approved = '0')", $qObj->query\_vars["include\_unapproved"][0] ) . ")"; |
| [1036](#L1036) | } |
| [1037](#L1037) | } else { |
| [1038](#L1038) | $where .= " comment\_approved = '1'"; |
| [1039](#L1039) | } |
| [1040](#L1040) | $where .= " AND comment\_post\_ID = {$post->ID}"; |
| [1041](#L1041) | if ( $this->options->wp["threadComments"] ) { |
| [1042](#L1042) | $where .= " AND comment\_parent = 0"; |
| [1043](#L1043) | } |
| [1044](#L1044) | $typesNotIn = apply\_filters( "wpdiscuz\_found\_comments\_query", [ self::WPDISCUZ\_STICKY\_COMMENT ], $post->ID ); |
| [1045](#L1045) | foreach ( $typesNotIn as &$type ) { |
| [1046](#L1046) | $type = esc\_sql( $type ); |
| [1047](#L1047) | } |
| [1048](#L1048) | $where .= " AND comment\_type NOT IN ('" . implode( "','", $typesNotIn ) . "')"; |
| [1049](#L1049) | $q     = "SELECT COUNT(\*) FROM {$wpdb->comments} $where"; |
| [1050](#L1050) | } |
| [1051](#L1051) |  |
| [1052](#L1052) | return $q; |
| [1053](#L1053) | } |
| [1054](#L1054) |  |
| [1055](#L1055) | /\*\* |
| [1056](#L1056) | \* add comments clauses |
| [1057](#L1057) | \* add new orderby clause when sort type is vote and wordpress comments order is older (ASC) |
| [1058](#L1058) | \*/ |
| [1059](#L1059) | public function commentsClauses( $args ) { |
| [1060](#L1060) | global $wpdb; |
| [1061](#L1061) | if ( isset( $this->commentsArgs["caller"] ) && $this->commentsArgs["caller"] === "wpdiscuz" && ! $this->options->wp["isPaginate"] ) { |
| [1062](#L1062) | $orderby        = ""; |
| [1063](#L1063) | $args["caller"] = $this->commentsArgs["caller"] = "wpdiscuz-"; |
| [1064](#L1064) | if ( $this->options->thread\_layouts["showVotingButtons"] && $this->commentsArgs["orderby"] === "by\_vote" ) { |
| [1065](#L1065) | $args["join"] .= " LEFT JOIN " . $wpdb->commentmeta . " AS `cm` ON " . $wpdb->comments . ".comment\_ID = `cm`.comment\_id  AND (`cm`.meta\_key = '" . self::META\_KEY\_VOTES . "')"; |
| [1066](#L1066) | $orderby      = " IFNULL(`cm`.meta\_value,0)+0 DESC, "; |
| [1067](#L1067) | } else if ( $this->commentsArgs["last\_parent\_id"] && empty( $this->commentsArgs["sticky"] ) ) { |
| [1068](#L1068) | $args["where"] = $wpdb->comments . ".`comment\_ID`" . ( $this->commentsArgs["order"] === 'desc' ? " < " : " > " ) . $this->commentsArgs["last\_parent\_id"] . ( $args["where"] ? " AND " : "" ) . $args["where"]; |
| [1069](#L1069) | } |
| [1070](#L1070) | $args["orderby"] = $orderby . $wpdb->comments . ".`{$this->options->thread\_display["orderCommentsBy"]}` "; |
| [1071](#L1071) | $args["orderby"] .= isset( $args["order"] ) ? "" : $this->commentsArgs["order"]; |
| [1072](#L1072) | } |
| [1073](#L1073) |  |
| [1074](#L1074) | return $args; |
| [1075](#L1075) | } |
| [1076](#L1076) |  |
| [1077](#L1077) | public function getDefaultCommentsArgs( $postId = 0 ) { |
| [1078](#L1078) | global $user\_ID; |
| [1079](#L1079) | $commenter = wp\_get\_current\_commenter(); |
| [1080](#L1080) | $args      = [ |
| [1081](#L1081) | "caller"                    => "wpdiscuz", |
| [1082](#L1082) | "post\_id"                   => intval( $postId ), |
| [1083](#L1083) | "last\_parent\_id"            => 0, |
| [1084](#L1084) | "orderby"                   => $this->options->thread\_display["orderCommentsBy"], |
| [1085](#L1085) | "order"                     => $this->options->wp["commentOrder"], |
| [1086](#L1086) | // max value of php int for limit |
| [1087](#L1087) | "number"                    => $this->options->thread\_display["commentListLoadType"] == 3 ? PHP\_INT\_MAX - 1 : $this->options->wp["commentPerPage"], |
| [1088](#L1088) | "status"                    => ! $this->options->wp["isPaginate"] && current\_user\_can( "moderate\_comments" ) ? "all" : "approve", |
| [1089](#L1089) | "update\_comment\_meta\_cache" => false, |
| [1090](#L1090) | "no\_found\_rows"             => false, |
| [1091](#L1091) | "update\_comment\_post\_cache" => false, |
| [1092](#L1092) | "type\_\_not\_in"              => [ self::WPDISCUZ\_STICKY\_COMMENT ], |
| [1093](#L1093) | "wpdType"                   => "", |
| [1094](#L1094) | "page"                      => 1, |
| [1095](#L1095) | ]; |
| [1096](#L1096) | if ( $this->options->wp["isPaginate"] ) { |
| [1097](#L1097) | $args["page"] = intval( get\_query\_var( "cpage" ) ); |
| [1098](#L1098) | } |
| [1099](#L1099) | if ( $this->options->wp["threadComments"] ) { |
| [1100](#L1100) | $args["parent"] = 0; |
| [1101](#L1101) | } |
| [1102](#L1102) | if ( ! current\_user\_can( "moderate\_comments" ) ) { |
| [1103](#L1103) | if ( $user\_ID ) { |
| [1104](#L1104) | $args["include\_unapproved"] = [ $user\_ID ]; |
| [1105](#L1105) | } elseif ( ! empty( $commenter["comment\_author\_email"] ) ) { |
| [1106](#L1106) | $args["include\_unapproved"] = [ $commenter["comment\_author\_email"] ]; |
| [1107](#L1107) | } |
| [1108](#L1108) | } |
| [1109](#L1109) |  |
| [1110](#L1110) | $user = WpdiscuzHelper::getCurrentUser(); |
| [1111](#L1111) |  |
| [1112](#L1112) | if ( empty( $user->ID ) || empty( $user->roles ) || ! is\_array( $user->roles ) ) { |
| [1113](#L1113) | $args["user"]       = 0; |
| [1114](#L1114) | $args["user\_roles"] = [ "guest" ]; |
| [1115](#L1115) | } else { |
| [1116](#L1116) | $args["user"]       = $user; |
| [1117](#L1117) | $args["user\_roles"] = $user->roles; |
| [1118](#L1118) | } |
| [1119](#L1119) |  |
| [1120](#L1120) | return apply\_filters( "wpdiscuz\_comments\_args", $args ); |
| [1121](#L1121) | } |
| [1122](#L1122) |  |
| [1123](#L1123) | /\*\* |
| [1124](#L1124) | \* register options page for plugin |
| [1125](#L1125) | \*/ |
| [1126](#L1126) | public function addPluginOptionsPage() { |
| [1127](#L1127) | $menuIcon = "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAyMDQ4IDIwNDgiIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCB0cmFuc2Zvcm09InRyYW5zbGF0ZSg5OTQsMzIwKSIgZD0ibTAgMGg1OGwzNCAyIDQzIDUgMzkgNyAzOCA5IDM0IDEwIDI5IDEwIDMwIDEyIDI2IDEyIDE5IDkgMjIgMTIgMTYgOSAyMSAxMyAyNCAxNiAyOCAyMSAxNyAxNCAxMSA5IDE0IDEzIDggNyA4IDggOCA3IDQgNHYyaDJsNyA4IDEwIDEwIDcgOCAxMiAxNCAxMCAxMiA5IDExIDE0IDE5IDE0IDIwIDEyIDE5IDE5IDMyIDE4IDM1IDEzIDI4IDEzIDMzIDEyIDM2IDcgMjQgOCAzMiA3IDM3IDQgMjcgMyAyOCAyIDQwdjQxbC0yIDQwLTUgNDItNyAzOS03IDMxLTkgMzItMTIgMzYtMTMgMzMtMTUgMzMtMTEgMjItMTMgMjMtMTUgMjUtOCAxMi0xMSAxNi0xNCAxOS0xMSAxNC0xMyAxNi0xMCAxMS03IDgtOSAxMC0zNiAzNi04IDctMTQgMTItMTcgMTQtMTcgMTMtMTEgOC0xNiAxMS0xNSAxMC0xOCAxMS0xNyAxMC0zMiAxNy0yOCAxMy0zMiAxMy0yOCAxMC0yOSA5LTMwIDgtMzggOC0zMyA1LTM3IDQtMzYgMmgtNDJsLTQ5LTMtMzItNC0yNC00LTIzLTUtMzAtNy0zNy0xMS0yOS0xMC0zMC0xMi0yNC0xMS0yMS0xMC05IDItMzAgNy02NyAxNy0yMDEgNTAtNyAxaC0xM2wtMTYtNC0xMS02LTEwLTgtOS0xMS04LTE2LTMtMTkgMy0yMCAzMi0xMjggMTktNzUgMTUtNjAgNS0xOSAyLTExIDItMy0xLTUtMTUtMzEtMTMtMzEtMTMtMzYtMTEtMzctOC0zMi03LTM2LTQtMjctMy0yNi0yLTMydi02M2wzLTQzIDQtMzAgNC0yNCA3LTM0IDgtMzAgOC0yNiA4LTIzIDExLTI4IDEyLTI3IDktMTkgMTAtMTkgMTMtMjMgMTMtMjEgMTItMTggMTItMTcgOS0xMiA4LTEwIDE4LTIyIDEyLTEzIDctOCAxMi0xMyAyMC0yMCA4LTcgMTMtMTIgMTQtMTIgMjUtMjAgMTctMTIgMTQtMTAgMTctMTEgMjgtMTcgMjYtMTQgMjItMTEgMjQtMTEgMjgtMTEgMTktNyAzOS0xMiAzMi04IDE4LTQgMjItNCAyNi00IDI3LTN6bTAgMTI4LTM3IDMtMzQgNS0zNCA3LTM2IDEwLTMyIDExLTI5IDEyLTI5IDE0LTIxIDExLTIyIDEzLTIxIDE0LTE0IDEwLTE2IDEyLTE3IDE0LTIwIDE4LTE1IDE0LTkgOS03IDgtMTQgMTUtOSAxMS0xMyAxNi0xMiAxNy0xOCAyNy05IDE1LTE0IDI1LTE1IDMxLTEzIDMyLTEyIDM1LTEwIDM4LTcgMzUtNCAyOC0zIDQwdjUxbDMgMzggNSAzNiA2IDI5IDggMzEgOCAyNSAxMCAyOCAxMyAzMCA4IDE3IDEwIDE5IDYgMTIgNCAxNXYxNGwtNiAyNi0zMiAxMjgtMTggNzMtMSA2IDIyNS01NiA3LTFoMTdsMTQgNCA0NSAyMyAyOCAxMiAyNCA5IDMwIDEwIDMwIDggMzUgNyAzNyA1IDI0IDIgMjIgMWgzMGwzNC0yIDI3LTMgMjYtNCAzMy03IDI5LTggMzYtMTIgMjctMTEgMjYtMTIgMjUtMTMgMjItMTMgMTktMTIgMTgtMTMgMTYtMTIgMTQtMTEgMTEtMTAgOC03IDEwLTkgMjctMjcgNy04IDktMTAgMTEtMTQgMTItMTUgMTItMTcgOC0xMiAxMy0yMSAxMy0yMyA4LTE2IDExLTIzIDExLTI3IDctMTkgMTAtMzMgOC0zMyA3LTQxIDMtMjcgMi0zNHYtMzVsLTItMzQtNS00MC03LTM2LTctMjgtOS0yOS0xMC0yNy0xMi0yOC0xMC0yMS0xMi0yMi0xMy0yMi0xNi0yNC0xMC0xNC0xMC0xMy05LTExLTExLTEzLTExLTEyLTE0LTE1LTEyLTEyLTgtNy0xMi0xMS0xMS05LTE1LTEyLTE4LTEzLTI3LTE4LTE1LTktMjUtMTQtMzEtMTUtMTktOC0yNC05LTI3LTktMzQtOS0zNS03LTI5LTQtNDAtM3oiIGZpbGw9IiNBQUFEQUUiLz4KPHBhdGggdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNzA4LDgwNCkiIGQ9Im0wIDBoMTIxbDIgMiAxNiA4OCAxNyA5MiA5IDUwIDE0IDc1IDMgOSA0LTIzIDE1LTY4IDI3LTEyMyAxOS04NyA0LTE1aDEwNWw2IDI1IDQwIDE4MCAxNyA3NiA2IDI5IDEgNmgxbDE0LTc0IDI0LTEzMiAxOC05OCAzLTEyaDEyMmwtMSA4LTEyIDU3LTI2IDEyMy0yOCAxMzItMjAgOTQtMTkgOTAtMiA3LTIgMWgtMTI2bC0zLTktMTItNTAtMzItMTM2LTE4LTc3LTQtMTUtMS0xLTUgMjUtMjAgODctMTQgNjEtMjAgODctNiAyNi0zIDJoLTEyNWwtMi0zLTIyLTEwMy0xNi03NS0yNy0xMjctMTMtNjEtMjAtOTQtOS00MnoiIGZpbGw9IiNBQUFEQUUiLz4KPC9zdmc+Cg=="; |
| [1128](#L1128) | add\_menu\_page( "wpDiscuz", "wpDiscuz", "manage\_options", self::PAGE\_WPDISCUZ, "", $menuIcon, 26 ); |
| [1129](#L1129) | add\_submenu\_page( self::PAGE\_WPDISCUZ, "&raquo; " . esc\_html\_\_( "Dashboard", "wpdiscuz" ), "&raquo; " . esc\_html\_\_( "Dashboard", "wpdiscuz" ), "manage\_options", self::PAGE\_WPDISCUZ, [ |
| [1130](#L1130) | &$this->options, |
| [1131](#L1131) | "dashboard" |
| [1132](#L1132) | ] ); |
| [1133](#L1133) | add\_submenu\_page( self::PAGE\_WPDISCUZ, "&raquo; " . esc\_html\_\_( "Settings", "wpdiscuz" ), "&raquo; " . esc\_html\_\_( "Settings", "wpdiscuz" ), "manage\_options", self::PAGE\_SETTINGS, [ |
| [1134](#L1134) | &$this->options, |
| [1135](#L1135) | "mainOptionsForm" |
| [1136](#L1136) | ] ); |
| [1137](#L1137) | if ( ! $this->options->general["isUsePoMo"] ) { |
| [1138](#L1138) | add\_submenu\_page( self::PAGE\_WPDISCUZ, "&raquo; " . esc\_html\_\_( "Phrases", "wpdiscuz" ), "&raquo; " . esc\_html\_\_( "Phrases", "wpdiscuz" ), "manage\_options", self::PAGE\_PHRASES, [ |
| [1139](#L1139) | &$this->options, |
| [1140](#L1140) | "phrasesOptionsForm" |
| [1141](#L1141) | ] ); |
| [1142](#L1142) | } |
| [1143](#L1143) | add\_submenu\_page( self::PAGE\_WPDISCUZ, "&raquo; " . esc\_html\_\_( "Tools", "wpdiscuz" ), "&raquo; " . esc\_html\_\_( "Tools", "wpdiscuz" ), "manage\_options", self::PAGE\_TOOLS, [ |
| [1144](#L1144) | &$this->options, |
| [1145](#L1145) | "tools" |
| [1146](#L1146) | ] ); |
| [1147](#L1147) |  |
| [1148](#L1148) | do\_action( "wpdiscuz\_submenu\_page" ); |
| [1149](#L1149) | } |
| [1150](#L1150) |  |
| [1151](#L1151) | public function addInlineStyle() { |
| [1152](#L1152) | echo "<style> |
| [1153](#L1153) | #toplevel\_page\_wpdiscuz .wp-menu-image img{width:24px;height:24px;padding:0;} |
| [1154](#L1154) | #toplevel\_page\_wpdiscuz .wp-menu-image.dashicons-before{display:flex;justify-content:center;align-items:center;} |
| [1155](#L1155) | </style>"; |
| [1156](#L1156) | } |
| [1157](#L1157) |  |
| [1158](#L1158) | /\*\* |
| [1159](#L1159) | \* Scripts and styles registration on administration pages |
| [1160](#L1160) | \*/ |
| [1161](#L1161) | public function backendFiles() { |
| [1162](#L1162) | global $typenow, $pagenow; |
| [1163](#L1163) | $wp\_version      = get\_bloginfo( "version" ); |
| [1164](#L1164) | $wpdiscuzWpPages = apply\_filters( "wpdiscuz\_wp\_admin\_pages", [ |
| [1165](#L1165) | "edit-comments.php", |
| [1166](#L1166) | "admin.php", |
| [1167](#L1167) | "comment.php" |
| [1168](#L1168) | ] ); |
| [1169](#L1169) | $wpdiscuzPages   = apply\_filters( "wpdiscuz\_admin\_pages", [ |
| [1170](#L1170) | self::PAGE\_WPDISCUZ, |
| [1171](#L1171) | self::PAGE\_SETTINGS, |
| [1172](#L1172) | self::PAGE\_PHRASES, |
| [1173](#L1173) | self::PAGE\_TOOLS, |
| [1174](#L1174) | self::PAGE\_ADDONS |
| [1175](#L1175) | ] ); |
| [1176](#L1176) | wp\_register\_style( "wpdiscuz-font-awesome", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/font-awesome-5.13.0/css/fontawesome-all.min.css" ), null, $this->version ); |
| [1177](#L1177) |  |
| [1178](#L1178) | if ( ( isset( $\_GET["page"] ) && in\_array( $\_GET["page"], $wpdiscuzPages ) && in\_array( $pagenow, $wpdiscuzWpPages ) ) || ( $typenow === "wpdiscuz\_form" ) || ( $pagenow === self::PAGE\_COMMENTS ) ) { |
| [1179](#L1179) | $args = [ |
| [1180](#L1180) | "msgConfirmResetOptions"        => esc\_html\_\_( "Do you really want to reset all options?", "wpdiscuz" ), |
| [1181](#L1181) | "msgConfirmResetTabOptions"     => esc\_html\_\_( "Do you really want to reset tab options?", "wpdiscuz" ), |
| [1182](#L1182) | "msgConfirmRemoveVotes"         => esc\_html\_\_( "Do you really want to remove voting data?", "wpdiscuz" ), |
| [1183](#L1183) | "msgConfirmRemoveSocialAvatars" => esc\_html\_\_( "Do you really want to remove social network avatars ?", "wpdiscuz" ), |
| [1184](#L1184) | "msgConfirmResetPhrases"        => esc\_html\_\_( "Do you really want to reset phrases?", "wpdiscuz" ), |
| [1185](#L1185) | "wmuMsgConfirmAttachmentDelete" => esc\_html\_\_( "Do you really want to delet this attachment?", "wpdiscuz" ), |
| [1186](#L1186) | "msgConfirmPurgeCache"          => esc\_html\_\_( "Do you really want to delete comments and users cache?", "wpdiscuz" ), |
| [1187](#L1187) | "wpdOptionNonce"                => wp\_create\_nonce( "wpd-option-nonce" ), |
| [1188](#L1188) | ]; |
| [1189](#L1189) | // Media Upload Lightbox |
| [1190](#L1190) | wp\_register\_style( "wmu-colorbox-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/colorbox/colorbox.css" ) ); |
| [1191](#L1191) | wp\_enqueue\_style( "wmu-colorbox-css" ); |
| [1192](#L1192) | wp\_register\_script( "wmu-colorbox-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/colorbox/jquery.colorbox.min.js" ), [ "jquery" ] ); |
| [1193](#L1193) | wp\_enqueue\_script( "wmu-colorbox-js" ); |
| [1194](#L1194) |  |
| [1195](#L1195) | wp\_register\_style( "wpdiscuz-mu-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-mu-backend.css" ) ); |
| [1196](#L1196) | wp\_enqueue\_style( "wpdiscuz-mu-css" ); |
| [1197](#L1197) | wp\_register\_script( "wpdiscuz-mu-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-mu-backend.js" ), [ "jquery" ], $this->version, true ); |
| [1198](#L1198) | wp\_localize\_script( "wpdiscuz-mu-js", "wpdiscuzMUJsObj", $args ); |
| [1199](#L1199) | wp\_enqueue\_script( "wpdiscuz-mu-js" ); |
| [1200](#L1200) |  |
| [1201](#L1201) | wp\_enqueue\_style( "wpdiscuz-font-awesome" ); |
| [1202](#L1202) | wp\_enqueue\_style( "wp-color-picker" ); |
| [1203](#L1203) | wp\_enqueue\_script( "wp-color-picker" ); |
| [1204](#L1204) | wp\_register\_style( "wpdiscuz-options-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-options.css" ), null, $this->version ); |
| [1205](#L1205) | wp\_enqueue\_style( "wpdiscuz-options-css" ); |
| [1206](#L1206) | wp\_register\_script( "wpdiscuz-options-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-options.js" ), [ "jquery" ], $this->version ); |
| [1207](#L1207) | wp\_enqueue\_script( "wpdiscuz-options-js" ); |
| [1208](#L1208) | wp\_localize\_script( "wpdiscuz-options-js", "wpdiscuzObj", $args ); |
| [1209](#L1209) | wp\_enqueue\_script( "thickbox" ); |
| [1210](#L1210) | wp\_register\_script( "wpdiscuz-contenthover", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/contenthover/jquery.contenthover.min.js" ), [ "jquery" ], $this->version, true ); |
| [1211](#L1211) | wp\_enqueue\_script( "wpdiscuz-contenthover" ); |
| [1212](#L1212) |  |
| [1213](#L1213) | if ( isset( $\_GET["page"] ) ) { |
| [1214](#L1214) | if ( $\_GET["page"] === self::PAGE\_WPDISCUZ ) { |
| [1215](#L1215) | wp\_register\_style( "wpdiscuz-easy-responsive-tabs-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/easy-responsive-tabs/css/easy-responsive-tabs.min.css" ), null, $this->version ); |
| [1216](#L1216) | wp\_enqueue\_style( "wpdiscuz-easy-responsive-tabs-css" ); |
| [1217](#L1217) | wp\_register\_script( "wpdiscuz-easy-responsive-tabs-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/easy-responsive-tabs/js/easy-responsive-tabs.js" ), [ "jquery" ], $this->version, true ); |
| [1218](#L1218) | wp\_enqueue\_script( "wpdiscuz-easy-responsive-tabs-js" ); |
| [1219](#L1219) | wp\_register\_script( "wpdiscuz-jquery-cookie", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/wpdccjs/wpdcc.js" ), [ "jquery" ], $this->version, true ); |
| [1220](#L1220) | wp\_enqueue\_script( "wpdiscuz-jquery-cookie" ); |
| [1221](#L1221) | wp\_register\_script( "wpdiscuz-chart-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/chart/chart.min.js" ), [], $this->version, true ); |
| [1222](#L1222) | wp\_enqueue\_script( "wpdiscuz-chart-js" ); |
| [1223](#L1223) | } else if ( $\_GET["page"] === self::PAGE\_PHRASES ) { |
| [1224](#L1224) | wp\_register\_style( "wpdiscuz-easy-responsive-tabs-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/easy-responsive-tabs/css/easy-responsive-tabs.min.css" ), null, $this->version ); |
| [1225](#L1225) | wp\_enqueue\_style( "wpdiscuz-easy-responsive-tabs-css" ); |
| [1226](#L1226) | wp\_register\_script( "wpdiscuz-easy-responsive-tabs-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/easy-responsive-tabs/js/easy-responsive-tabs.js" ), [ "jquery" ], $this->version, true ); |
| [1227](#L1227) | wp\_enqueue\_script( "wpdiscuz-easy-responsive-tabs-js" ); |
| [1228](#L1228) | wp\_register\_script( "wpdiscuz-jquery-cookie", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/wpdccjs/wpdcc.js" ), [ "jquery" ], $this->version, true ); |
| [1229](#L1229) | wp\_enqueue\_script( "wpdiscuz-jquery-cookie" ); |
| [1230](#L1230) | } |
| [1231](#L1231) | } |
| [1232](#L1232) | } else if ( $pagenow === "comment.php" ) { |
| [1233](#L1233) | wp\_register\_style( "wpdiscuz-options-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-options.css" ), null, $this->version ); |
| [1234](#L1234) | wp\_enqueue\_style( "wpdiscuz-options-css" ); |
| [1235](#L1235) | wp\_enqueue\_style( "wpdiscuz-font-awesome" ); |
| [1236](#L1236) | } |
| [1237](#L1237) | if ( version\_compare( $wp\_version, "4.2.0", ">=" ) ) { |
| [1238](#L1238) | wp\_register\_script( "wpdiscuz-addon-notes", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-notes.js" ), [ "jquery" ], $this->version, true ); |
| [1239](#L1239) | wp\_enqueue\_script( "wpdiscuz-addon-notes" ); |
| [1240](#L1240) | } |
| [1241](#L1241) |  |
| [1242](#L1242) | if ( ! get\_option( self::OPTION\_SLUG\_DEACTIVATION ) && ( strpos( $this->requestUri, "/plugins.php" ) !== false ) ) { |
| [1243](#L1243) | $reasonArgs = [ |
| [1244](#L1244) | "msgReasonRequired"     => esc\_html\_\_( "Please check one of reasons before sending feedback!", "wpdiscuz" ), |
| [1245](#L1245) | "msgReasonDescRequired" => esc\_html\_\_( "Please provide more information", "wpdiscuz" ), |
| [1246](#L1246) | "adminUrl"              => get\_admin\_url() |
| [1247](#L1247) | ]; |
| [1248](#L1248) | wp\_register\_style( "wpdiscuz-lity-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/lity/lity.css" ), null, $this->version ); |
| [1249](#L1249) | wp\_enqueue\_style( "wpdiscuz-lity-css" ); |
| [1250](#L1250) | wp\_register\_script( "wpdiscuz-lity-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/lity/lity.js" ), [ "jquery" ], $this->version ); |
| [1251](#L1251) | wp\_enqueue\_script( "wpdiscuz-lity-js" ); |
| [1252](#L1252) | wp\_register\_style( "wpdiscuz-deactivation-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-deactivation.css" ) ); |
| [1253](#L1253) | wp\_enqueue\_style( "wpdiscuz-deactivation-css" ); |
| [1254](#L1254) | wp\_register\_script( "wpdiscuz-deactivation-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-deactivation.js" ), [ "jquery" ], $this->version ); |
| [1255](#L1255) | wp\_enqueue\_script( "wpdiscuz-deactivation-js" ); |
| [1256](#L1256) | wp\_localize\_script( "wpdiscuz-deactivation-js", "deactivationObj", $reasonArgs ); |
| [1257](#L1257) | } |
| [1258](#L1258) | wp\_register\_script( self::WPDISCUZ\_FEEDBACK\_SHORTCODE . "-shortcode-js", '' ); |
| [1259](#L1259) | wp\_enqueue\_script( self::WPDISCUZ\_FEEDBACK\_SHORTCODE . "-shortcode-js" ); |
| [1260](#L1260) | wp\_localize\_script( self::WPDISCUZ\_FEEDBACK\_SHORTCODE . "-shortcode-js", "wpdObject", [ |
| [1261](#L1261) | "ajaxUrl"          => admin\_url( "admin-ajax.php" ), |
| [1262](#L1262) | "shortcode"        => self::WPDISCUZ\_FEEDBACK\_SHORTCODE, |
| [1263](#L1263) | "image"            => plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/img/shortcode.png" ), |
| [1264](#L1264) | "tooltip"          => $this->options->getPhrase( "wc\_feedback\_shortcode\_tooltip" ), |
| [1265](#L1265) | "popup\_title"      => $this->options->getPhrase( "wc\_feedback\_popup\_title" ), |
| [1266](#L1266) | "leave\_feebdack"   => $this->options->getPhrase( "wc\_please\_leave\_feebdack" ), |
| [1267](#L1267) | "no\_text\_selected" => esc\_html\_\_( "No text is selected. Please select a part of text from post content.", "wpdiscuz" ) |
| [1268](#L1268) | ] ); |
| [1269](#L1269) | } |
| [1270](#L1270) |  |
| [1271](#L1271) | /\*\* |
| [1272](#L1272) | \* Styles and scripts registration to use on front page |
| [1273](#L1273) | \*/ |
| [1274](#L1274) | public function frontendFiles() { |
| [1275](#L1275) | global $post; |
| [1276](#L1276) | $suf = $this->options->general["loadMinVersion"] ? ".min" : ""; |
| [1277](#L1277) | wp\_register\_style( "wpdiscuz-font-awesome", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/font-awesome-5.13.0/css/fontawesome-all.min.css" ), null, $this->version ); |
| [1278](#L1278) | wp\_register\_style( "wpdiscuz-ratings", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-ratings$suf.css" ), null, $this->version ); |
| [1279](#L1279) | wp\_register\_style( "wpdiscuz-ratings-rtl", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-ratings-rtl$suf.css" ), null, $this->version ); |
| [1280](#L1280) | if ( ! $this->isWpdiscuzLoaded && $this->options->rating["ratingCssOnNoneSingular"] ) { |
| [1281](#L1281) | wp\_enqueue\_style( "wpdiscuz-ratings" ); |
| [1282](#L1282) | if ( is\_rtl() ) { |
| [1283](#L1283) | wp\_enqueue\_style( "wpdiscuz-ratings-rtl" ); |
| [1284](#L1284) | } |
| [1285](#L1285) | } |
| [1286](#L1286) | if ( $this->isWpdiscuzLoaded ) { |
| [1287](#L1287) | $this->form = $this->wpdiscuzForm->getForm( $post->ID ); |
| [1288](#L1288) | $formGeneralOptions = $this->form->getGeneralOptions(); |
| [1289](#L1289) | $this->form->initFormMeta(); |
| [1290](#L1290) | $this->wpdiscuzOptionsJs                      = $this->options->getOptionsForJs(); |
| [1291](#L1291) | $this->wpdiscuzOptionsJs["version"]           = $this->version; |
| [1292](#L1292) | $this->wpdiscuzOptionsJs["wc\_post\_id"]        = $post->ID; |
| [1293](#L1293) | $this->wpdiscuzOptionsJs["isCookiesEnabled"]  = has\_action( "set\_comment\_cookies" ); |
| [1294](#L1294) | $this->wpdiscuzOptionsJs["loadLastCommentId"] = 0; |
| [1295](#L1295) |  |
| [1296](#L1296) | if ( $this->options->live["commentListUpdateType"] || ( $this->options->live["enableBubble"] && $this->options->live["bubbleLiveUpdate"] ) ) { |
| [1297](#L1297) | $cArgs                                        = $this->getDefaultCommentsArgs( $post->ID ); |
| [1298](#L1298) | $this->wpdiscuzOptionsJs["loadLastCommentId"] = $this->dbManager->getLastCommentId( $cArgs ); |
| [1299](#L1299) | } |
| [1300](#L1300) | $this->wpdiscuzOptionsJs["dataFilterCallbacks"] = []; |
| [1301](#L1301) | $this->wpdiscuzOptionsJs["phraseFilters"]       = []; |
| [1302](#L1302) | $this->wpdiscuzOptionsJs["scrollSize"]          = 32; |
| [1303](#L1303) | $this->wpdiscuzOptionsJs                        = apply\_filters( "wpdiscuz\_js\_options", $this->wpdiscuzOptionsJs, $this->options ); |
| [1304](#L1304) | $this->wpdiscuzOptionsJs["url"]                 = admin\_url( "admin-ajax.php" ); |
| [1305](#L1305) | $this->wpdiscuzOptionsJs["customAjaxUrl"]       = plugins\_url( WPDISCUZ\_DIR\_NAME . "/utils/ajax/wpdiscuz-ajax.php" ); |
| [1306](#L1306) | $this->wpdiscuzOptionsJs["bubbleUpdateUrl"]     = rest\_url( "wpdiscuz/v1/update" ); |
| [1307](#L1307) | $this->wpdiscuzOptionsJs["restNonce"]           = wp\_create\_nonce( "wp\_rest" ); |
| [1308](#L1308) | $this->wpdiscuzOptionsJs["is\_rate\_editable"]    = isset($formGeneralOptions["is\_rate\_editable"]) ? $formGeneralOptions["is\_rate\_editable"] : 0; |
| [1309](#L1309) | $this->wpdiscuzOptionsJs["menu\_icon"]           = WPDISCUZ\_DIR\_URL . "/assets/img/plugin-icon/wpdiscuz-svg.svg"; |
| [1310](#L1310) | $this->wpdiscuzOptionsJs["menu\_icon\_hover"]     = WPDISCUZ\_DIR\_URL . "/assets/img/plugin-icon/wpdiscuz-svg\_hover.svg"; |
| [1311](#L1311) | $loadQuill                                      = $this->options->form["richEditor"] === "both" || ( ! wp\_is\_mobile() && $this->options->form["richEditor"] === "desktop" ); |
| [1312](#L1312) | $customCSSSlug                                  = "wpdiscuz-frontend-custom-css"; |
| [1313](#L1313) | $customFileName                                 = "style-custom"; |
| [1314](#L1314) | if ( is\_rtl() ) { |
| [1315](#L1315) | $customCSSSlug  = "wpdiscuz-frontend-custom-rtl-css"; |
| [1316](#L1316) | $customFileName = "style-custom-rtl"; |
| [1317](#L1317) | if ( $this->options->thread\_styles["theme"] === "wpd-minimal" ) { |
| [1318](#L1318) | $cssSlug  = "wpdiscuz-frontend-minimal-rtl-css"; |
| [1319](#L1319) | $fileName = "style-minimal-rtl"; |
| [1320](#L1320) | } else { |
| [1321](#L1321) | $cssSlug  = "wpdiscuz-frontend-rtl-css"; |
| [1322](#L1322) | $fileName = "style-rtl"; |
| [1323](#L1323) | } |
| [1324](#L1324) | } else if ( $this->options->thread\_styles["theme"] === "wpd-minimal" ) { |
| [1325](#L1325) | $cssSlug  = "wpdiscuz-frontend-minimal-css"; |
| [1326](#L1326) | $fileName = "style-minimal"; |
| [1327](#L1327) | } else { |
| [1328](#L1328) | $cssSlug  = "wpdiscuz-frontend-css"; |
| [1329](#L1329) | $fileName = "style"; |
| [1330](#L1330) | } |
| [1331](#L1331) | $this->helper->enqueueWpDiscuzStyle( $cssSlug, $fileName, $this->version, $this->form ); |
| [1332](#L1332) | $this->helper->enqueueWpDiscuzStyle( $customCSSSlug, $customFileName, $this->version, $this->form ); |
| [1333](#L1333) | wp\_add\_inline\_style( $cssSlug, $this->helper->initCustomCss() ); |
| [1334](#L1334) | $ucArgs = [ |
| [1335](#L1335) | "msgConfirmDeleteComment"      => esc\_html( $this->options->getPhrase( "wc\_confirm\_comment\_delete" ) ), |
| [1336](#L1336) | "msgConfirmCancelSubscription" => esc\_html( $this->options->getPhrase( "wc\_confirm\_cancel\_subscription" ) ), |
| [1337](#L1337) | "msgConfirmCancelFollow"       => esc\_html( $this->options->getPhrase( "wc\_confirm\_cancel\_follow" ) ), |
| [1338](#L1338) | "additionalTab"                => (int) apply\_filters( "wpdiscuz\_enable\_content\_modal", false ), |
| [1339](#L1339) | ]; |
| [1340](#L1340) | if ( $this->options->thread\_styles["enableFontAwesome"] ) { |
| [1341](#L1341) | if ( $this->form->hasIcon ) { |
| [1342](#L1342) | wp\_enqueue\_style( "wpdiscuz-font-awesome" ); |
| [1343](#L1343) | } else { |
| [1344](#L1344) | wp\_register\_style( "wpdiscuz-fa", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/font-awesome-5.13.0/css/fa.min.css" ), null, $this->version ); |
| [1345](#L1345) | wp\_enqueue\_style( "wpdiscuz-fa" ); |
| [1346](#L1346) | } |
| [1347](#L1347) | } |
| [1348](#L1348) | if ( $this->options->general["loadComboVersion"] ) { |
| [1349](#L1349) | $combo\_js  = ""; |
| [1350](#L1350) | $combo\_css = ""; |
| [1351](#L1351) | if ( ! $loadQuill ) { |
| [1352](#L1352) | $combo\_js  = "-no\_quill"; |
| [1353](#L1353) | $combo\_css = "-no\_quill"; |
| [1354](#L1354) | } |
| [1355](#L1355) | wp\_register\_style( "wpdiscuz-combo-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-combo$combo\_css.min.css" ) ); |
| [1356](#L1356) | wp\_enqueue\_style( "wpdiscuz-combo-css" ); |
| [1357](#L1357) | wp\_register\_script( "wpdiscuz-combo-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-combo$combo\_js.min.js" ), [ "jquery" ], $this->version, true ); |
| [1358](#L1358) | wp\_enqueue\_script( "wpdiscuz-combo-js" ); |
| [1359](#L1359) | wp\_localize\_script( "wpdiscuz-combo-js", "wpdiscuzAjaxObj", $this->wpdiscuzOptionsJs ); |
| [1360](#L1360) | wp\_localize\_script( "wpdiscuz-combo-js", "wpdiscuzUCObj", $ucArgs ); |
| [1361](#L1361) | if ( $loadQuill ) { |
| [1362](#L1362) | wp\_add\_inline\_script( "wpdiscuz-combo-js", $this->options->editorOptions(), "before" ); |
| [1363](#L1363) | } |
| [1364](#L1364) | } else { |
| [1365](#L1365) | wp\_register\_script( "wpdiscuz-cookie-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/wpdccjs/wpdcc.js" ), [ "jquery" ], $this->version, true ); |
| [1366](#L1366) | wp\_enqueue\_script( "wpdiscuz-cookie-js" ); |
| [1367](#L1367) | // |
| [1368](#L1368) | if ( $loadQuill ) { |
| [1369](#L1369) | wp\_register\_style( "quill-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/quill/quill.snow$suf.css" ), null, "1.3.6" ); |
| [1370](#L1370) | wp\_enqueue\_style( "quill-css" ); |
| [1371](#L1371) | wp\_register\_script( "quill", plugins\_url( "/assets/third-party/quill/quill$suf.js", \_\_FILE\_\_ ), [ "wpdiscuz-cookie-js" ], "1.3.6", true ); |
| [1372](#L1372) | wp\_enqueue\_script( "quill" ); |
| [1373](#L1373) | wp\_add\_inline\_script( "quill", $this->options->editorOptions(), "before" ); |
| [1374](#L1374) | wp\_register\_script( "wpd-editor", plugins\_url( "/assets/js/wpd-editor$suf.js", \_\_FILE\_\_ ), [ "quill" ], "1.3.6", true ); |
| [1375](#L1375) | wp\_enqueue\_script( "wpd-editor" ); |
| [1376](#L1376) | } |
| [1377](#L1377) | wp\_register\_script( "autogrowtextarea-js", plugins\_url( "/assets/third-party/autogrow/jquery.autogrowtextarea.min.js", \_\_FILE\_\_ ), [ "jquery" ], "1.3.6", true ); |
| [1378](#L1378) | wp\_enqueue\_script( "autogrowtextarea-js" ); |
| [1379](#L1379) | wp\_register\_script( "wpdiscuz-ajax-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz$suf.js" ), [ $loadQuill ? "wpd-editor" : "jquery" ], $this->version, true ); |
| [1380](#L1380) | wp\_enqueue\_script( "wpdiscuz-ajax-js" ); |
| [1381](#L1381) | wp\_localize\_script( "wpdiscuz-ajax-js", "wpdiscuzAjaxObj", $this->wpdiscuzOptionsJs ); |
| [1382](#L1382) | // |
| [1383](#L1383) | if ( $this->options->content["wmuIsEnabled"] ) { |
| [1384](#L1384) | // Media Upload Lightbox |
| [1385](#L1385) | if ( $this->options->content["wmuIsLightbox"] ) { |
| [1386](#L1386) | wp\_register\_style( "wmu-colorbox-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/colorbox/colorbox$suf.css" ) ); |
| [1387](#L1387) | wp\_enqueue\_style( "wmu-colorbox-css" ); |
| [1388](#L1388) | wp\_register\_script( "wmu-colorbox-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/colorbox/jquery.colorbox$suf.js" ), [ "jquery" ], $this->version, true ); |
| [1389](#L1389) | wp\_enqueue\_script( "wmu-colorbox-js" ); |
| [1390](#L1390) | } |
| [1391](#L1391) | wp\_register\_style( "wpdiscuz-mu-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-mu-frontend$suf.css" ) ); |
| [1392](#L1392) | wp\_enqueue\_style( "wpdiscuz-mu-css" ); |
| [1393](#L1393) | wp\_register\_script( "wpdiscuz-mu-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-mu-frontend$suf.js" ), [ "wpdiscuz-ajax-js" ], $this->version, true ); |
| [1394](#L1394) | wp\_enqueue\_script( "wpdiscuz-mu-js" ); |
| [1395](#L1395) | } |
| [1396](#L1396) | if ( $this->options->login["showActivityTab"] || $this->options->login["showSubscriptionsTab"] || $this->options->login["showFollowsTab"] || apply\_filters( "wpdiscuz\_enable\_content\_modal", false ) ) { |
| [1397](#L1397) | wp\_register\_style( "wpdiscuz-user-content-css", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-user-content$suf.css" ), null, $this->version ); |
| [1398](#L1398) | wp\_enqueue\_style( "wpdiscuz-user-content-css" ); |
| [1399](#L1399) | wp\_register\_script( "wpdiscuz-lity-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/third-party/lity/lity$suf.js" ), [ "jquery" ], $this->version, true ); |
| [1400](#L1400) | wp\_enqueue\_script( "wpdiscuz-lity-js" ); |
| [1401](#L1401) | wp\_register\_script( "wpdiscuz-user-content-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-user-content$suf.js" ), [ "wpdiscuz-lity-js" ], $this->version, true ); |
| [1402](#L1402) | wp\_enqueue\_script( "wpdiscuz-user-content-js" ); |
| [1403](#L1403) | wp\_localize\_script( "wpdiscuz-user-content-js", "wpdiscuzUCObj", $ucArgs ); |
| [1404](#L1404) | } |
| [1405](#L1405) | } |
| [1406](#L1406) | if ( $this->form->showRecaptcha() && apply\_filters( "wpdiscuz\_recaptcha\_site\_key", $this->options->recaptcha["siteKey"] ) && apply\_filters( "wpdiscuz\_recaptcha\_secret", $this->options->recaptcha["secretKey"] ) ) { |
| [1407](#L1407) | wp\_register\_script( "wpdiscuz-google-recaptcha", apply\_filters( "wpdiscuz\_recaptcha\_url", $this->options->recaptcha["reCaptchaUrl"] ), [ $this->options->general["loadComboVersion"] ? "wpdiscuz-combo-js" : "wpdiscuz-ajax-js" ], "1.0.0", true ); |
| [1408](#L1408) | wp\_enqueue\_script( "wpdiscuz-google-recaptcha" ); |
| [1409](#L1409) | } |
| [1410](#L1410) | if ( ! $loadQuill && $this->options->form["enableQuickTags"] ) { |
| [1411](#L1411) | wp\_enqueue\_script( "quicktags" ); |
| [1412](#L1412) | wp\_register\_script( "wpdiscuz-quicktags", plugins\_url( "/assets/third-party/quicktags/wpdiscuz-quictags.js", \_\_FILE\_\_ ), [ $this->options->general["loadComboVersion"] ? "wpdiscuz-combo-js" : "wpdiscuz-ajax-js" ], $this->version, true ); |
| [1413](#L1413) | wp\_enqueue\_script( "wpdiscuz-quicktags" ); |
| [1414](#L1414) | } |
| [1415](#L1415) | do\_action( "wpdiscuz\_front\_scripts", $this->options ); |
| [1416](#L1416) | } |
| [1417](#L1417) | } |
| [1418](#L1418) |  |
| [1419](#L1419) | public function inlineCommentForElementorJS() { |
| [1420](#L1420) | wp\_register\_script( "wpdiscuz-for-elementor", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-shortcode-for-elementor.js" ), [ "jquery" ], $this->version, true ); |
| [1421](#L1421) | wp\_enqueue\_script( "wpdiscuz-for-elementor" ); |
| [1422](#L1422) | wp\_localize\_script( "wpdiscuz-for-elementor", "wpdObjectEl", [ |
| [1423](#L1423) | "shortcode"        => self::WPDISCUZ\_FEEDBACK\_SHORTCODE, |
| [1424](#L1424) | "image"            => plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/img/shortcode.png" ), |
| [1425](#L1425) | "tooltip"          => $this->options->getPhrase( "wc\_feedback\_shortcode\_tooltip" ), |
| [1426](#L1426) | "popup\_title"      => $this->options->getPhrase( "wc\_feedback\_popup\_title" ), |
| [1427](#L1427) | "leave\_feebdack"   => $this->options->getPhrase( "wc\_please\_leave\_feebdack" ), |
| [1428](#L1428) | "no\_text\_selected" => esc\_html\_\_( "No text is selected. Please select a part of text from post content.", "wpdiscuz" ) |
| [1429](#L1429) | ] ); |
| [1430](#L1430) | wp\_enqueue\_script( "thickbox" ); |
| [1431](#L1431) | } |
| [1432](#L1432) |  |
| [1433](#L1433) | public function inlineCommentForElementorCSS() { |
| [1434](#L1434) | wp\_register\_style( "wpdiscuz-for-elementor", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/css/wpdiscuz-shortcode-for-elementor.css" ) ); |
| [1435](#L1435) | wp\_enqueue\_style( "wpdiscuz-for-elementor" ); |
| [1436](#L1436) | } |
| [1437](#L1437) |  |
| [1438](#L1438) | public function uninstall() { |
| [1439](#L1439) | if ( is\_admin() && ! empty( $\_GET["action"] ) && $\_GET["action"] === "wpdiscuz-uninstall" ) { |
| [1440](#L1440) | if ( check\_admin\_referer( "wpdiscuz\_uninstall" ) && current\_user\_can( "manage\_options" ) ) { |
| [1441](#L1441) | $this->dbManager->deleteCommentMeta( self::META\_KEY\_VOTES ); |
| [1442](#L1442) | $this->dbManager->deleteCommentMeta( self::META\_KEY\_VOTES\_SEPARATE ); |
| [1443](#L1443) | $this->dbManager->deleteCommentMeta( self::META\_KEY\_CLOSED ); |
| [1444](#L1444) | $this->dbManager->deleteCommentMeta( self::META\_KEY\_FEEDBACK\_FORM\_ID ); |
| [1445](#L1445) | $this->dbManager->deleteCommentMeta( self::META\_KEY\_LAST\_EDITED\_AT ); |
| [1446](#L1446) | $this->dbManager->deleteCommentMeta( self::META\_KEY\_LAST\_EDITED\_BY ); |
| [1447](#L1447) |  |
| [1448](#L1448) | $this->dbManager->makeStickyCommentsRegular(); |
| [1449](#L1449) |  |
| [1450](#L1450) | $this->dbManager->deleteStatisticCaches(); |
| [1451](#L1451) | $this->dbManager->deletePostMeta( self::POSTMETA\_RATING\_COUNT ); |
| [1452](#L1452) | $this->dbManager->deletePostMeta( self::POSTMETA\_POST\_RATING ); |
| [1453](#L1453) | $this->dbManager->deletePostMeta( self::POSTMETA\_POST\_RATING\_COUNT ); |
| [1454](#L1454) | $this->dbManager->deleteFieldsRatingsPostMeta(); |
| [1455](#L1455) | foreach ( get\_posts( [ "numberposts" => - 1, "post\_type" => "wpdiscuz\_form" ] ) as $form ) { |
| [1456](#L1456) | wp\_delete\_post( $form->ID, true ); |
| [1457](#L1457) | } |
| [1458](#L1458) |  |
| [1459](#L1459) | $this->dbManager->deleteUserMeta( self::USERMETA\_LAST\_VISIT ); |
| [1460](#L1460) |  |
| [1461](#L1461) | delete\_option( self::OPTION\_SLUG\_OPTIONS ); |
| [1462](#L1462) | delete\_option( self::OPTION\_SLUG\_VERSION ); |
| [1463](#L1463) | delete\_option( self::OPTION\_SLUG\_DEACTIVATION ); |
| [1464](#L1464) | delete\_option( self::OPTION\_SLUG\_SHOW\_DEMO ); |
| [1465](#L1465) | delete\_option( self::OPTION\_SLUG\_HASH\_KEY ); |
| [1466](#L1466) | delete\_option( self::OPTION\_SLUG\_SHOW\_VOTE\_REG\_MESSAGE ); |
| [1467](#L1467) | delete\_option( self::OPTION\_SLUG\_SHOW\_CLOSED\_REG\_MESSAGE ); |
| [1468](#L1468) | delete\_option( self::OPTION\_SLUG\_SHOW\_VOTE\_DATA\_REG\_MESSAGE ); |
| [1469](#L1469) | delete\_option( self::OPTION\_SLUG\_SHOW\_SYNC\_COMMENTERS\_MESSAGE ); |
| [1470](#L1470) | delete\_option( self::OPTION\_SLUG\_WIZARD\_COMPLETED ); |
| [1471](#L1471) | delete\_option( self::OPTION\_SLUG\_WIZARD\_AFTER\_UPDATE ); |
| [1472](#L1472) | delete\_option( self::OPTION\_SLUG\_WIZARD\_SHOW\_ADDONS\_MSG ); |
| [1473](#L1473) | delete\_option( self::OPTION\_SLUG\_SHOW\_RATING\_REBUIL\_MSG ); |
| [1474](#L1474) | delete\_option( "wpdiscuz\_form\_content\_type\_rel" ); |
| [1475](#L1475) | delete\_option( "wpdiscuz\_form\_post\_rel" ); |
| [1476](#L1476) |  |
| [1477](#L1477) | if ( ! class\_exists( "WP\_Filesystem\_Direct" ) ) { |
| [1478](#L1478) | require\_once ABSPATH . "wp-admin/includes/class-wp-filesystem-base.php"; |
| [1479](#L1479) | require\_once ABSPATH . "wp-admin/includes/class-wp-filesystem-direct.php"; |
| [1480](#L1480) | } |
| [1481](#L1481) | $fs   = new WP\_Filesystem\_Direct( [] ); |
| [1482](#L1482) | $path = wp\_upload\_dir(); |
| [1483](#L1483) | $fs->rmdir( $path["basedir"] . self::WPDISCUZ\_CACHE\_DIR, true ); |
| [1484](#L1484) |  |
| [1485](#L1485) | $this->dbManager->dropTables(); |
| [1486](#L1486) |  |
| [1487](#L1487) | deactivate\_plugins( plugin\_basename( \_\_FILE\_\_ ) ); |
| [1488](#L1488) | } |
| [1489](#L1489) | wp\_safe\_redirect( admin\_url( "plugins.php" ) ); |
| [1490](#L1490) | exit(); |
| [1491](#L1491) | } |
| [1492](#L1492) | } |
| [1493](#L1493) |  |
| [1494](#L1494) | public function pluginNewVersion() { |
| [1495](#L1495) | $pluginData = get\_plugin\_data( \_\_FILE\_\_ ); |
| [1496](#L1496) | if ( version\_compare( $pluginData["Version"], $this->version, ">" ) ) { |
| [1497](#L1497) | $this->dbManager->dbCreateTables(); |
| [1498](#L1498) | $this->wpdiscuzForm->createDefaultForm( $this->version ); |
| [1499](#L1499) | $options = $this->changeOldOptions( get\_option( self::OPTION\_SLUG\_OPTIONS ), $pluginData ); |
| [1500](#L1500) | if ( $this->version === "5.3.2" ) { |
| [1501](#L1501) | $this->mergeOptions( $options ); |
| [1502](#L1502) | } else { |
| [1503](#L1503) | $this->addNewOptions( $options ); |
| [1504](#L1504) | } |
| [1505](#L1505) | $this->addNewPhrases(); |
| [1506](#L1506) | update\_option( self::OPTION\_SLUG\_VERSION, $pluginData["Version"] ); |
| [1507](#L1507) |  |
| [1508](#L1508) | if ( version\_compare( $this->version, "2.1.2", "<=" ) && version\_compare( $this->version, "1.0.0", "!=" ) ) { |
| [1509](#L1509) | $this->dbManager->alterPhrasesTable(); |
| [1510](#L1510) | } |
| [1511](#L1511) |  |
| [1512](#L1512) | if ( version\_compare( $this->version, "2.1.7", "<=" ) && version\_compare( $this->version, "1.0.0", "!=" ) ) { |
| [1513](#L1513) | $this->dbManager->alterVotingTable(); |
| [1514](#L1514) | } |
| [1515](#L1515) |  |
| [1516](#L1516) | if ( version\_compare( $this->version, "5.0.5", "<=" ) && version\_compare( $this->version, "1.0.0", "!=" ) ) { |
| [1517](#L1517) | $this->dbManager->alterNotificationTable(); |
| [1518](#L1518) | } |
| [1519](#L1519) |  |
| [1520](#L1520) | if ( version\_compare( $this->version, "5.1.2", "<=" ) ) { |
| [1521](#L1521) | $this->dbManager->deleteOldStatisticCaches(); |
| [1522](#L1522) | } |
| [1523](#L1523) |  |
| [1524](#L1524) | if ( version\_compare( $this->version, "7.0.0", "<" ) ) { |
| [1525](#L1525) | $this->deactivateAddons(); |
| [1526](#L1526) | if ( version\_compare( $this->version, "1.0.0", "!=" ) && version\_compare( $this->version, "7.0.0-beta-1", "<" ) ) { |
| [1527](#L1527) | $this->dbManager->alterVotingTableForDateAndPostId(); |
| [1528](#L1528) | $this->options->replaceOldOptions( $options ); |
| [1529](#L1529) | } |
| [1530](#L1530) | $this->setRecaptchaOptions( $options ); |
| [1531](#L1531) | $showVoteRegenerate = intval( $this->dbManager->showVoteRegenerate() ); |
| [1532](#L1532) | add\_option( self::OPTION\_SLUG\_SHOW\_VOTE\_REG\_MESSAGE, ( $showVoteRegenerate ? "1" : "0" ), "", "no" ); |
| [1533](#L1533) | $showClosedRegenerate = intval( $this->dbManager->showClosedRegenerate() ); |
| [1534](#L1534) | add\_option( self::OPTION\_SLUG\_SHOW\_CLOSED\_REG\_MESSAGE, ( $showClosedRegenerate ? "1" : "0" ), "", "no" ); |
| [1535](#L1535) | $showVoteDataRegenerate = intval( $this->dbManager->showVoteDataRegenerate() ); |
| [1536](#L1536) | add\_option( self::OPTION\_SLUG\_SHOW\_VOTE\_DATA\_REG\_MESSAGE, ( $showVoteDataRegenerate ? "1" : "0" ), "", "no" ); |
| [1537](#L1537) | add\_option( self::OPTION\_SLUG\_SHOW\_SYNC\_COMMENTERS\_MESSAGE, ( $this->dbManager->usersHaveComments() ? "1" : "0" ), "", "no" ); |
| [1538](#L1538) | add\_option( self::OPTION\_SLUG\_WIZARD\_COMPLETED, "0", "", "no" ); |
| [1539](#L1539) | add\_option( self::OPTION\_SLUG\_WIZARD\_AFTER\_UPDATE, ( $this->version === "1.0.0" ? "0" : "1" ), "", "no" ); |
| [1540](#L1540) | $this->removeOldFiles(); |
| [1541](#L1541) | $this->dbManager->deleteStatisticCaches(); |
| [1542](#L1542) | if ( ( $advancedNocaptcha = get\_option( "anr\_admin\_options" ) ) && ! empty( $advancedNocaptcha["enabled\_forms"] ) && ( $key = array\_search( "comment", $advancedNocaptcha["enabled\_forms"] ) ) ) { |
| [1543](#L1543) | unset( $advancedNocaptcha["enabled\_forms"][ $key ] ); |
| [1544](#L1544) | update\_option( "anr\_admin\_options", $advancedNocaptcha ); |
| [1545](#L1545) | } |
| [1546](#L1546) | if ( ( $invisibleRecaptcha = get\_option( "ic-wordpress-settings" ) ) && ! empty( $invisibleRecaptcha["CF"] ) ) { |
| [1547](#L1547) | unset( $invisibleRecaptcha["CF"] ); |
| [1548](#L1548) | update\_option( "ic-wordpress-settings", $invisibleRecaptcha ); |
| [1549](#L1549) | } |
| [1550](#L1550) | } |
| [1551](#L1551) | if ( version\_compare( $this->version, "7.0.3", "<" ) && version\_compare( $this->version, "1.0.0", "!=" ) ) { |
| [1552](#L1552) | $this->dbManager->alterSubscriptionTable(); |
| [1553](#L1553) | } |
| [1554](#L1554) | if ( version\_compare( $this->version, "7.1.4", "<" ) && version\_compare( $this->version, "1.0.0", "!=" ) ) { |
| [1555](#L1555) | $showRatingRebuildMsg = intval( $this->dbManager->showRatingRebuildMsg() ); |
| [1556](#L1556) | add\_option( self::OPTION\_SLUG\_SHOW\_RATING\_REBUIL\_MSG, ( $showRatingRebuildMsg ? "1" : "0" ), "", "no" ); |
| [1557](#L1557) | } |
| [1558](#L1558) | if ( version\_compare( $this->version, "7.3.0", "<" ) && version\_compare( $this->version, "1.0.0", "!=" ) ) { |
| [1559](#L1559) | wp\_clear\_scheduled\_hook( "wpdiscuz\_gravatars\_cache\_add" ); |
| [1560](#L1560) | wp\_clear\_scheduled\_hook( "wpdiscuz\_gravatars\_cache\_delete" ); |
| [1561](#L1561) | $this->cache->deleteGravatarsFolder(); |
| [1562](#L1562) | $this->dbManager->deleteGravatarsTable(); |
| [1563](#L1563) | } |
| [1564](#L1564) | // adding email templates as options |
| [1565](#L1565) | if ( version\_compare( $this->version, "7.3.17", "<=" ) ) { |
| [1566](#L1566) | $this->options->addEmailTemplates( true ); |
| [1567](#L1567) | } |
| [1568](#L1568) | do\_action( "wpdiscuz\_clean\_all\_caches", $pluginData["Version"], $this->version ); |
| [1569](#L1569) | } |
| [1570](#L1570) | do\_action( "wpdiscuz\_check\_version" ); |
| [1571](#L1571) | } |
| [1572](#L1572) |  |
| [1573](#L1573) | /\*\* |
| [1574](#L1574) | \* remove old captcha files |
| [1575](#L1575) | \*/ |
| [1576](#L1576) | private function removeOldFiles() { |
| [1577](#L1577) | $wpUploadsDir = wp\_upload\_dir(); |
| [1578](#L1578) | $captchaDir   = $wpUploadsDir["basedir"] . "/wpdiscuz/captcha/"; |
| [1579](#L1579) | if ( file\_exists( $captchaDir ) ) { |
| [1580](#L1580) | $files = function\_exists( "scandir" ) ? scandir( $captchaDir ) : false; |
| [1581](#L1581) | if ( $files && is\_array( $files ) ) { |
| [1582](#L1582) | foreach ( $files as $file ) { |
| [1583](#L1583) | if ( $file !== "." && $file !== ".." ) { |
| [1584](#L1584) | $fileName = $captchaDir . $file; |
| [1585](#L1585) | if ( is\_file( $fileName ) ) { |
| [1586](#L1586) | @unlink( $fileName ); |
| [1587](#L1587) | } else { |
| [1588](#L1588) | @rmdir( $fileName ); |
| [1589](#L1589) | } |
| [1590](#L1590) | } |
| [1591](#L1591) | } |
| [1592](#L1592) | } |
| [1593](#L1593) | @rmdir( $captchaDir ); |
| [1594](#L1594) | } |
| [1595](#L1595) | } |
| [1596](#L1596) |  |
| [1597](#L1597) | private function deactivateAddons() { |
| [1598](#L1598) | $plugins = []; |
| [1599](#L1599) | if ( is\_plugin\_active( "wpdiscuz-buddypress-integration/wpDiscuzBPIntegration.php" ) ) { |
| [1600](#L1600) | $plugins[] = "wpdiscuz-buddypress-integration/wpDiscuzBPIntegration.php"; |
| [1601](#L1601) | } |
| [1602](#L1602) | if ( is\_plugin\_active( "wpdiscuz-ads-manager/class-WpdiscuzAdsManager.php" ) ) { |
| [1603](#L1603) | $plugins[] = "wpdiscuz-ads-manager/class-WpdiscuzAdsManager.php"; |
| [1604](#L1604) | } |
| [1605](#L1605) | if ( is\_plugin\_active( "wpdiscuz-advanced-likers/class.WpdiscuzVoters.php" ) ) { |
| [1606](#L1606) | $plugins[] = "wpdiscuz-advanced-likers/class.WpdiscuzVoters.php"; |
| [1607](#L1607) | } |
| [1608](#L1608) | if ( is\_plugin\_active( "wpdiscuz-comment-author-info/wpdiscuz-comment-author-info.php" ) ) { |
| [1609](#L1609) | $plugins[] = "wpdiscuz-comment-author-info/wpdiscuz-comment-author-info.php"; |
| [1610](#L1610) | } |
| [1611](#L1611) | if ( is\_plugin\_active( "wpdiscuz-comment-search/wpDiscuzCommentSearch.php" ) ) { |
| [1612](#L1612) | $plugins[] = "wpdiscuz-comment-search/wpDiscuzCommentSearch.php"; |
| [1613](#L1613) | } |
| [1614](#L1614) | if ( is\_plugin\_active( "wpdiscuz-comment-translation/wpdiscuz-translate.php" ) ) { |
| [1615](#L1615) | $plugins[] = "wpdiscuz-comment-translation/wpdiscuz-translate.php"; |
| [1616](#L1616) | } |
| [1617](#L1617) | if ( is\_plugin\_active( "wpdiscuz-emoticons/wpDiscuzSmile.php" ) ) { |
| [1618](#L1618) | $plugins[] = "wpdiscuz-emoticons/wpDiscuzSmile.php"; |
| [1619](#L1619) | } |
| [1620](#L1620) | if ( is\_plugin\_active( "wpdiscuz-frontend-moderation/class.wpDiscuzFrontEndModeration.php" ) ) { |
| [1621](#L1621) | $plugins[] = "wpdiscuz-frontend-moderation/class.wpDiscuzFrontEndModeration.php"; |
| [1622](#L1622) | } |
| [1623](#L1623) | if ( is\_plugin\_active( "wpdiscuz-media-uploader/class.WpdiscuzMediaUploader.php" ) ) { |
| [1624](#L1624) | $plugins[] = "wpdiscuz-media-uploader/class.WpdiscuzMediaUploader.php"; |
| [1625](#L1625) | } |
| [1626](#L1626) | if ( is\_plugin\_active( "wpdiscuz-mycred/wpdiscuz-mc.php" ) ) { |
| [1627](#L1627) | $plugins[] = "wpdiscuz-mycred/wpdiscuz-mc.php"; |
| [1628](#L1628) | } |
| [1629](#L1629) | if ( is\_plugin\_active( "wpdiscuz-online-users/wpdiscuz-ou.php" ) ) { |
| [1630](#L1630) | $plugins[] = "wpdiscuz-online-users/wpdiscuz-ou.php"; |
| [1631](#L1631) | } |
| [1632](#L1632) | if ( is\_plugin\_active( "wpdiscuz-recaptcha/wpDiscuzReCaptcha.php" ) ) { |
| [1633](#L1633) | $plugins[] = "wpdiscuz-recaptcha/wpDiscuzReCaptcha.php"; |
| [1634](#L1634) | } |
| [1635](#L1635) | if ( is\_plugin\_active( "wpdiscuz-report-flagging/wpDiscuzFlagComment.php" ) ) { |
| [1636](#L1636) | $plugins[] = "wpdiscuz-report-flagging/wpDiscuzFlagComment.php"; |
| [1637](#L1637) | } |
| [1638](#L1638) | if ( is\_plugin\_active( "wpdiscuz-subscribe-manager/wpdSubscribeManager.php" ) ) { |
| [1639](#L1639) | $plugins[] = "wpdiscuz-subscribe-manager/wpdSubscribeManager.php"; |
| [1640](#L1640) | } |
| [1641](#L1641) | if ( is\_plugin\_active( "wpdiscuz-user-comment-mentioning/WpdiscuzUCM.php" ) ) { |
| [1642](#L1642) | $plugins[] = "wpdiscuz-user-comment-mentioning/WpdiscuzUCM.php"; |
| [1643](#L1643) | } |
| [1644](#L1644) | if ( is\_plugin\_active( "wpdiscuz-widgets/wpDiscuzWidgets.php" ) ) { |
| [1645](#L1645) | $plugins[] = "wpdiscuz-widgets/wpDiscuzWidgets.php"; |
| [1646](#L1646) | } |
| [1647](#L1647) | if ( $plugins ) { |
| [1648](#L1648) | deactivate\_plugins( $plugins ); |
| [1649](#L1649) | add\_option( self::OPTION\_SLUG\_WIZARD\_SHOW\_ADDONS\_MSG, "1", "", "no" ); |
| [1650](#L1650) | } |
| [1651](#L1651) | } |
| [1652](#L1652) |  |
| [1653](#L1653) | /\*\* |
| [1654](#L1654) | \* set recaptcha options |
| [1655](#L1655) | \*/ |
| [1656](#L1656) | private function setRecaptchaOptions( $options ) { |
| [1657](#L1657) | if ( ! $options[ self::TAB\_RECAPTCHA ]["siteKey"] && ( $recaptchaSettings = get\_option( "wpdiscuz\_recaptcha" ) ) ) { |
| [1658](#L1658) | $options[ self::TAB\_RECAPTCHA ]["siteKey"]               = $recaptchaSettings["site\_key"]; |
| [1659](#L1659) | $options[ self::TAB\_RECAPTCHA ]["secretKey"]             = $recaptchaSettings["secret\_key"]; |
| [1660](#L1660) | $options[ self::TAB\_RECAPTCHA ]["theme"]                 = $recaptchaSettings["theme"]; |
| [1661](#L1661) | $options[ self::TAB\_RECAPTCHA ]["lang"]                  = $recaptchaSettings["lang"]; |
| [1662](#L1662) | $options[ self::TAB\_RECAPTCHA ]["showForGuests"]         = 1; |
| [1663](#L1663) | $options[ self::TAB\_RECAPTCHA ]["requestMethod"]         = $recaptchaSettings["request\_method"]; |
| [1664](#L1664) | $options[ self::TAB\_RECAPTCHA ]["isShowOnSubscribeForm"] = $recaptchaSettings["isShowOnSubscribeForm"] === "on" ? 1 : 0; |
| [1665](#L1665) | $this->options->initOptions( $options ); |
| [1666](#L1666) | $this->options->updateOptions(); |
| [1667](#L1667) | } |
| [1668](#L1668) | } |
| [1669](#L1669) |  |
| [1670](#L1670) | /\*\* |
| [1671](#L1671) | \* merge old and new options |
| [1672](#L1672) | \*/ |
| [1673](#L1673) | private function addNewOptions( &$options ) { |
| [1674](#L1674) | $options = array\_merge( $this->options->getDefaultOptions(), $options ); |
| [1675](#L1675) | $this->options->initOptions( $options ); |
| [1676](#L1676) | $this->options->updateOptions(); |
| [1677](#L1677) | } |
| [1678](#L1678) |  |
| [1679](#L1679) | /\*\* |
| [1680](#L1680) | \* merge old and new options recursively |
| [1681](#L1681) | \*/ |
| [1682](#L1682) | private function mergeOptions( &$options ) { |
| [1683](#L1683) | $newOptions = []; |
| [1684](#L1684) | $defaults   = $this->options->getDefaultOptions(); |
| [1685](#L1685) | foreach ( $options as $key => $value ) { |
| [1686](#L1686) | $newOptions[ $key ] = array\_merge( $defaults[ $key ], $value ); |
| [1687](#L1687) | } |
| [1688](#L1688) | $options = $newOptions; |
| [1689](#L1689) | $this->options->initOptions( $options ); |
| [1690](#L1690) | $this->options->updateOptions(); |
| [1691](#L1691) | } |
| [1692](#L1692) |  |
| [1693](#L1693) | /\*\* |
| [1694](#L1694) | \* merge old and new phrases |
| [1695](#L1695) | \*/ |
| [1696](#L1696) | private function addNewPhrases() { |
| [1697](#L1697) | if ( $this->dbManager->isPhraseExists( "wc\_be\_the\_first\_text" ) ) { |
| [1698](#L1698) | $wc\_saved\_phrases = $this->dbManager->getPhrases(); |
| [1699](#L1699) | $this->options->initPhrases(); |
| [1700](#L1700) | $wc\_phrases     = $this->options->phrases; |
| [1701](#L1701) | $wc\_new\_phrases = array\_merge( $wc\_phrases, $wc\_saved\_phrases ); |
| [1702](#L1702) | $this->dbManager->updatePhrases( $wc\_new\_phrases ); |
| [1703](#L1703) | } |
| [1704](#L1704) | } |
| [1705](#L1705) |  |
| [1706](#L1706) | /\*\* |
| [1707](#L1707) | \* change old options if needed |
| [1708](#L1708) | \*/ |
| [1709](#L1709) | private function changeOldOptions( $options, $pluginData ) { |
| [1710](#L1710) | $oldOptions = maybe\_unserialize( $options ); |
| [1711](#L1711) | if ( isset( $oldOptions["wc\_comment\_list\_order"] ) ) { |
| [1712](#L1712) | update\_option( "comment\_order", $oldOptions["wc\_comment\_list\_order"] ); |
| [1713](#L1713) | } |
| [1714](#L1714) | if ( isset( $oldOptions["wc\_comment\_count"] ) ) { |
| [1715](#L1715) | update\_option( "comments\_per\_page", $oldOptions["wc\_comment\_count"] ); |
| [1716](#L1716) | } |
| [1717](#L1717) | if ( isset( $oldOptions["wc\_load\_all\_comments"] ) ) { |
| [1718](#L1718) | $this->options->commentListLoadType = 1; |
| [1719](#L1719) | } |
| [1720](#L1720) | if ( isset( $this->options->disableFontAwesome ) && $this->options->disableFontAwesome && $pluginData["Version"] === "5.0.4" ) { |
| [1721](#L1721) | $this->options->disableFontAwesome = 0; |
| [1722](#L1722) | $oldOptions["disableFontAwesome"]  = 0; |
| [1723](#L1723) | } |
| [1724](#L1724) |  |
| [1725](#L1725) | if ( version\_compare( $this->version, "5.2.1", "<=" ) ) { |
| [1726](#L1726) | $oldOptions["isNativeAjaxEnabled"] = 1; |
| [1727](#L1727) | } |
| [1728](#L1728) | if ( version\_compare( $this->version, "7.0.0", ">=" ) && version\_compare( $this->version, "7.0.2", "<" ) ) { |
| [1729](#L1729) | $oldOptions[ self::TAB\_RATING ]["enablePostRatingSchema"] = 0; |
| [1730](#L1730) | } |
| [1731](#L1731) | if ( version\_compare( $this->version, "7.0.0", ">=" ) && version\_compare( $this->version, "7.0.4", "<" ) ) { |
| [1732](#L1732) | $newMimeTypes = []; |
| [1733](#L1733) | foreach ( $oldOptions[ self::TAB\_CONTENT ]["wmuMimeTypes"] as $exts => $type ) { |
| [1734](#L1734) | foreach ( explode( '|', $exts ) as $ext ) { |
| [1735](#L1735) | $newMimeTypes[ $ext ] = $type; |
| [1736](#L1736) | } |
| [1737](#L1737) | } |
| [1738](#L1738) | $oldOptions[ self::TAB\_CONTENT ]["wmuMimeTypes"] = $newMimeTypes; |
| [1739](#L1739) | } |
| [1740](#L1740) |  |
| [1741](#L1741) | return $oldOptions; |
| [1742](#L1742) | } |
| [1743](#L1743) |  |
| [1744](#L1744) | // Add settings link on plugin page |
| [1745](#L1745) | public function addPluginSettingsLink( $links ) { |
| [1746](#L1746) | $links[] = "<a href='" . esc\_url\_raw( admin\_url( "admin.php?page=" . self::PAGE\_SETTINGS ) ) . "'>" . esc\_html\_\_( "Settings", "wpdiscuz" ) . "</a>"; |
| [1747](#L1747) | $links[] = "<a href='" . esc\_url\_raw( wp\_nonce\_url( admin\_url( "plugins.php?action=wpdiscuz-uninstall" ), "wpdiscuz\_uninstall" ) ) . "' style='color:#b32d2e;' onclick='return confirm(\"" . esc\_js( "IMPORTANT! Uninstall is not a simple deactivation action. This action will permanently remove all data added by wpDiscuz (comment subscriptions, attachments, like/dislikes, and all other data that do not exist in the native comment system...) from database. Please backup database before this action. If you are sure that you want to delete all wpDiscuz data please confirm. If not, just cancel it, then you can deactivate this plugin.", "wpdiscuz" ) . "\")'>" . esc\_html\_\_( "Uninstall", "wpdiscuz" ) . "</a>"; |
| [1748](#L1748) |  |
| [1749](#L1749) | return $links; |
| [1750](#L1750) | } |
| [1751](#L1751) |  |
| [1752](#L1752) | public function initCurrentPostType() { |
| [1753](#L1753) | global $post; |
| [1754](#L1754) | $this->isWpdiscuzLoaded = $this->helper->isLoadWpdiscuz( $post ); |
| [1755](#L1755) | if ( $this->isWpdiscuzLoaded ) { |
| [1756](#L1756) | $this->form = $this->wpdiscuzForm->getForm( $post->ID ); |
| [1757](#L1757) | add\_filter( "comments\_template", [ &$this, "addCommentForm" ], 9999999 ); |
| [1758](#L1758) | } |
| [1759](#L1759) | } |
| [1760](#L1760) |  |
| [1761](#L1761) | public function addContentModal() { |
| [1762](#L1762) | echo "<span id='wpdUserContentInfoAnchor' style='display:none;' rel='#wpdUserContentInfo' data-wpd-lity>wpDiscuz</span>"; |
| [1763](#L1763) | echo "<div id='wpdUserContentInfo' style='overflow:auto;background:#FDFDF6;padding:20px;width:600px;max-width:100%;border-radius:6px;' class='lity-hide'></div>"; |
| [1764](#L1764) | } |
| [1765](#L1765) |  |
| [1766](#L1766) | public function saveLastVisit( $post ) { |
| [1767](#L1767) | $currentUser = WpdiscuzHelper::getCurrentUser(); |
| [1768](#L1768) | if ( ! empty( $currentUser->ID ) ) { |
| [1769](#L1769) | $lastVisit              = get\_user\_meta( $currentUser->ID, self::USERMETA\_LAST\_VISIT, true ); |
| [1770](#L1770) | $lastVisit              = is\_array( $lastVisit ) ? $lastVisit : []; |
| [1771](#L1771) | $lastVisit[ $post->ID ] = current\_time( "timestamp" ); |
| [1772](#L1772) | update\_user\_meta( $currentUser->ID, self::USERMETA\_LAST\_VISIT, $lastVisit ); |
| [1773](#L1773) | } |
| [1774](#L1774) | } |
| [1775](#L1775) |  |
| [1776](#L1776) | public function addCommentForm() { |
| [1777](#L1777) | return $this->helper->getCommentFormPath( $this->form->getTheme() ); |
| [1778](#L1778) | } |
| [1779](#L1779) |  |
| [1780](#L1780) | public function getCommentListArgs( $postId ) { |
| [1781](#L1781) | $post             = get\_post( $postId ); |
| [1782](#L1782) | $postsAuthors     = $post->comment\_count && $this->options->login["enableProfileURLs"] ? $this->dbManager->getPostsAuthors() : []; |
| [1783](#L1783) | $voteSvgs         = [ |
| [1784](#L1784) | "fa-plus|fa-minus"              => [ |
| [1785](#L1785) | "<svg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='plus' class='svg-inline--fa fa-plus fa-w-14' role='img' xmlns='https://www.w3.org/2000/svg' viewBox='0 0 448 512'><path d='M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z'></path></svg>", |
| [1786](#L1786) | "<svg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='minus' class='svg-inline--fa fa-minus fa-w-14' role='img' xmlns='https://www.w3.org/2000/svg' viewBox='0 0 448 512'><path d='M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z'></path></svg>", |
| [1787](#L1787) | ], |
| [1788](#L1788) | "fa-chevron-up|fa-chevron-down" => [ |
| [1789](#L1789) | "<svg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='chevron-up' class='svg-inline--fa fa-chevron-up fa-w-14' role='img' xmlns='https://www.w3.org/2000/svg' viewBox='0 0 448 512'><path d='M240.971 130.524l194.343 194.343c9.373 9.373 9.373 24.569 0 33.941l-22.667 22.667c-9.357 9.357-24.522 9.375-33.901.04L224 227.495 69.255 381.516c-9.379 9.335-24.544 9.317-33.901-.04l-22.667-22.667c-9.373-9.373-9.373-24.569 0-33.941L207.03 130.525c9.372-9.373 24.568-9.373 33.941-.001z'></path></svg>", |
| [1790](#L1790) | "<svg aria-hidden='true' focusable='false' data-prefix='fas' data-icon='chevron-down' class='svg-inline--fa fa-chevron-down fa-w-14' role='img' xmlns='https://www.w3.org/2000/svg' viewBox='0 0 448 512'><path d='M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z'></path></svg>", |
| [1791](#L1791) | ], |
| [1792](#L1792) | "fa-thumbs-up|fa-thumbs-down"   => [ |
| [1793](#L1793) | "<svg xmlns='https://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='none' d='M0 0h24v24H0V0z'/><path d='M1 21h4V9H1v12zm22-11c0-1.1-.9-2-2-2h-6.31l.95-4.57.03-.32c0-.41-.17-.79-.44-1.06L14.17 1 7.59 7.59C7.22 7.95 7 8.45 7 9v10c0 1.1.9 2 2 2h9c.83 0 1.54-.5 1.84-1.22l3.02-7.05c.09-.23.14-.47.14-.73v-2z'/></svg>", |
| [1794](#L1794) | "<svg xmlns='https://www.w3.org/2000/svg' viewBox='0 0 24 24'><path fill='none' d='M0 0h24v24H0z'/><path d='M15 3H6c-.83 0-1.54.5-1.84 1.22l-3.02 7.05c-.09.23-.14.47-.14.73v2c0 1.1.9 2 2 2h6.31l-.95 4.57-.03.32c0 .41.17.79.44 1.06L9.83 23l6.59-6.59c.36-.36.58-.86.58-1.41V5c0-1.1-.9-2-2-2zm4 0v12h4V3h-4z'/></svg>", |
| [1795](#L1795) | ], |
| [1796](#L1796) | "fa-smile|fa-frown"             => [ |
| [1797](#L1797) | "<svg aria-hidden='true' focusable='false' data-prefix='far' data-icon='smile' class='svg-inline--fa fa-smile fa-w-16' role='img' xmlns='https://www.w3.org/2000/svg' viewBox='0 0 496 512'><path d='M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm-80-216c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160 0c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm4 72.6c-20.8 25-51.5 39.4-84 39.4s-63.2-14.3-84-39.4c-8.5-10.2-23.7-11.5-33.8-3.1-10.2 8.5-11.5 23.6-3.1 33.8 30 36 74.1 56.6 120.9 56.6s90.9-20.6 120.9-56.6c8.5-10.2 7.1-25.3-3.1-33.8-10.1-8.4-25.3-7.1-33.8 3.1z'></path></svg>", |
| [1798](#L1798) | "<svg aria-hidden='true' focusable='false' data-prefix='far' data-icon='frown' class='svg-inline--fa fa-frown fa-w-16' role='img' xmlns='https://www.w3.org/2000/svg' viewBox='0 0 496 512'><path d='M248 8C111 8 0 119 0 256s111 248 248 248 248-111 248-248S385 8 248 8zm0 448c-110.3 0-200-89.7-200-200S137.7 56 248 56s200 89.7 200 200-89.7 200-200 200zm-80-216c17.7 0 32-14.3 32-32s-14.3-32-32-32-32 14.3-32 32 14.3 32 32 32zm160-64c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zm-80 128c-40.2 0-78 17.7-103.8 48.6-8.5 10.2-7.1 25.3 3.1 33.8 10.2 8.4 25.3 7.1 33.8-3.1 16.6-19.9 41-31.4 66.9-31.4s50.3 11.4 66.9 31.4c8.1 9.7 23.1 11.9 33.8 3.1 10.2-8.5 11.5-23.6 3.1-33.8C326 321.7 288.2 304 248 304z'></path></svg>", |
| [1799](#L1799) | ], |
| [1800](#L1800) | ]; |
| [1801](#L1801) | $currentUser      = WpdiscuzHelper::getCurrentUser(); |
| [1802](#L1802) | $currentUserEmail = ""; |
| [1803](#L1803) | $isUserLoggedIn   = false; |
| [1804](#L1804) | if ( ! empty( $currentUser->ID ) ) { |
| [1805](#L1805) | $currentUserEmail = $currentUser->user\_email; |
| [1806](#L1806) | $isUserLoggedIn   = true; |
| [1807](#L1807) | } else if ( ! empty( $\_COOKIE[ "comment\_author\_email\_" . COOKIEHASH ] ) ) { |
| [1808](#L1808) | $currentUserEmail = urldecode( trim( $\_COOKIE[ "comment\_author\_email\_" . COOKIEHASH ] ) ); |
| [1809](#L1809) | } |
| [1810](#L1810) | $this->form         = $this->wpdiscuzForm->getForm( $postId ); |
| [1811](#L1811) | $high\_level\_user    = current\_user\_can( "moderate\_comments" ); |
| [1812](#L1812) | $can\_stick\_or\_close = $post->post\_author == $currentUser->ID; |
| [1813](#L1813) | $post\_permalink     = get\_permalink( $postId ); |
| [1814](#L1814) | $theme              = $this->form->getTheme(); |
| [1815](#L1815) | $layout             = $this->form->getLayout(); |
| [1816](#L1816) | $replyForWoo        = apply\_filters( "wpdiscuz\_product\_review\_replies", true, $postId ); |
| [1817](#L1817) | $isMobile           = wp\_is\_mobile(); |
| [1818](#L1818) | include\_once $this->helper->getWalkerPath( $theme ); |
| [1819](#L1819) | $args = [ |
| [1820](#L1820) | "style"                        => "div", |
| [1821](#L1821) | "echo"                         => false, |
| [1822](#L1822) | "isSingle"                     => false, |
| [1823](#L1823) | "reverse\_top\_level"            => false, |
| [1824](#L1824) | "post\_id"                      => $postId, |
| [1825](#L1825) | "reverse\_children"             => ! $this->options->thread\_display["reverseChildren"], |
| [1826](#L1826) | "post\_author"                  => $post->post\_author, |
| [1827](#L1827) | "posts\_authors"                => $postsAuthors, |
| [1828](#L1828) | "voting\_icons"                 => $voteSvgs[ $this->options->thread\_layouts["votingButtonsIcon"] ], |
| [1829](#L1829) | "high\_level\_user"              => $high\_level\_user, |
| [1830](#L1830) | "avatar\_trackback"             => apply\_filters( "wpdiscuz\_avatar\_trackback", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/img/trackback.png" ) ), |
| [1831](#L1831) | "wpdiscuz\_gravatar\_size"       => apply\_filters( "wpdiscuz\_gravatar\_size", 64 ), |
| [1832](#L1832) | "can\_stick\_or\_close"           => $can\_stick\_or\_close, |
| [1833](#L1833) | "user\_follows"                 => $this->dbManager->getUserFollows( $currentUserEmail ), |
| [1834](#L1834) | "current\_user"                 => $currentUser, |
| [1835](#L1835) | "current\_user\_email"           => $currentUserEmail, |
| [1836](#L1836) | "is\_share\_enabled"             => $this->options->isShareEnabled(), |
| [1837](#L1837) | "post\_permalink"               => $post\_permalink, |
| [1838](#L1838) | "can\_user\_reply"               => comments\_open( $post->ID ) && $this->options->wp["threadComments"] && ( ( $this->form ? $this->form->isUserCanComment( $currentUser, $postId ) : true ) || $high\_level\_user ) && ! ( class\_exists( "WooCommerce" ) && get\_post\_type( $post ) === "product" && ! $replyForWoo ), |
| [1839](#L1839) | "can\_user\_follow"              => $this->options->subscription["isFollowActive"] && $isUserLoggedIn && ! empty( $currentUserEmail ) && $this->helper->isUserCanFollowOrSubscribe( $currentUserEmail ), |
| [1840](#L1840) | "can\_user\_vote"                => $currentUser->ID || $this->options->thread\_layouts["isGuestCanVote"], |
| [1841](#L1841) | "wpd\_stick\_btn"                => $this->options->moderation["enableStickButton"] && ( $high\_level\_user || $can\_stick\_or\_close ) ? "<span class='wpd\_stick\_btn wpd-cta-button'>%s</span>" : "", |
| [1842](#L1842) | "wpd\_close\_btn"                => $this->options->moderation["enableCloseButton"] && ( $high\_level\_user || $can\_stick\_or\_close ) ? "<span class='wpd\_close\_btn wpd-cta-button'>%s</span>" : "", |
| [1843](#L1843) | "is\_wpdiscuz\_comment"          => true, |
| [1844](#L1844) | "share\_buttons"                => "", |
| [1845](#L1845) | "feedback\_content\_words\_count" => apply\_filters( "wpdiscuz\_feedback\_content\_words\_count", 20 ), |
| [1846](#L1846) | "user\_votes"                   => [], |
| [1847](#L1847) | "last\_visit"                   => $this->options->thread\_display["highlightUnreadComments"] && ( $lastVisit = get\_user\_meta( $currentUser->ID, self::USERMETA\_LAST\_VISIT, true ) ) && ! empty( $lastVisit[ $postId ] ) ? $lastVisit[ $postId ] : "", |
| [1848](#L1848) | "site\_url"                     => get\_site\_url(), |
| [1849](#L1849) | "layout"                       => $layout, |
| [1850](#L1850) | "components"                   => $this->helper->getComponents( $theme, $layout ), |
| [1851](#L1851) | "follow\_tooltip\_position"      => $layout ? ( ! is\_rtl() ? ( $isMobile ? 'left' : 'right' ) : ( $isMobile ? 'right' : 'left' ) ) : "top", |
| [1852](#L1852) | "walker"                       => new WpdiscuzWalker( $this->helper, $this->helperOptimization, $this->dbManager, $this->options, $this->cache ), |
| [1853](#L1853) | "commentsArgs"                 => $this->commentsArgs, |
| [1854](#L1854) | ]; |
| [1855](#L1855) | if ( $this->options->social["enableFbShare"] && $this->options->social["fbAppID"] ) { |
| [1856](#L1856) | $args["share\_buttons"] .= "<span class='wc\_fb'><i class='fab fa-facebook-f wpf-cta' aria-hidden='true' title='" . esc\_attr( $this->options->getPhrase( "wc\_share\_facebook" ) ) . "'></i></span>"; |
| [1857](#L1857) | } |
| [1858](#L1858) | if ( $this->options->social["enableVkShare"] ) { |
| [1859](#L1859) | $args["share\_buttons"] .= "<a class='wc\_vk' rel='noreferrer' target='\_blank' href='https://vk.com/share.php?url=" . esc\_url\_raw( $post\_permalink ) . "' title='" . esc\_attr( $this->options->getPhrase( "wc\_share\_vk" ) ) . "'><i class='fab fa-vk wpf-cta' aria-hidden='true'></i></a>"; |
| [1860](#L1860) | } |
| [1861](#L1861) | if ( $this->options->social["enableOkShare"] ) { |
| [1862](#L1862) | $args["share\_buttons"] .= "<a class='wc\_ok' rel='noreferrer' target='\_blank' href='https://connect.ok.ru/offer?url=" . esc\_url\_raw( $post\_permalink ) . "' title='" . esc\_attr( $this->options->getPhrase( "wc\_share\_ok" ) ) . "'><i class='fab fa-odnoklassniki wpf-cta' aria-hidden='true'></i></a>"; |
| [1863](#L1863) | } |
| [1864](#L1864) | if ( $this->options->social["enableWhatsappShare"] ) { |
| [1865](#L1865) | $args["whatsapp\_url"] = $isMobile ? "https://api.whatsapp.com" : "https://web.whatsapp.com"; |
| [1866](#L1866) | } |
| [1867](#L1867) |  |
| [1868](#L1868) | return apply\_filters( "wpdiscuz\_comment\_list\_args", $args ); |
| [1869](#L1869) | } |
| [1870](#L1870) |  |
| [1871](#L1871) | public function addNewRoles() { |
| [1872](#L1872) | global $wp\_roles; |
| [1873](#L1873) | $roles             = empty( $wp\_roles->roles ) ? [] : $wp\_roles->roles; |
| [1874](#L1874) | $newBlogRoles      = []; |
| [1875](#L1875) | $newBlogRoleLabels = []; |
| [1876](#L1876) | $newRolePhrases    = []; |
| [1877](#L1877) | foreach ( $roles as $roleName => $roleInfo ) { |
| [1878](#L1878) | $newBlogRoles[ $roleName ] = isset( $this->options->labels["blogRoles"][ $roleName ] ) ? $this->options->labels["blogRoles"][ $roleName ] : "#00B38F"; |
| [1879](#L1879) | if ( $roleName === "administrator" ) { |
| [1880](#L1880) | $newBlogRoleLabels[ $roleName ]                = isset( $this->options->labels["blogRoleLabels"][ $roleName ] ) ? $this->options->labels["blogRoleLabels"][ $roleName ] : 1; |
| [1881](#L1881) | $newRolePhrases[ "wc\_blog\_role\_" . $roleName ] = isset( $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] ) ? $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] : esc\_html\_\_( "Admin", "wpdiscuz" ); |
| [1882](#L1882) | } elseif ( $roleName === "post\_author" ) { |
| [1883](#L1883) | $newBlogRoleLabels[ $roleName ]                = isset( $this->options->labels["blogRoleLabels"][ $roleName ] ) ? $this->options->labels["blogRoleLabels"][ $roleName ] : 1; |
| [1884](#L1884) | $newRolePhrases[ "wc\_blog\_role\_" . $roleName ] = isset( $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] ) ? $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] : esc\_html\_\_( "Author", "wpdiscuz" ); |
| [1885](#L1885) | } elseif ( $roleName === "editor" ) { |
| [1886](#L1886) | $newBlogRoleLabels[ $roleName ]                = isset( $this->options->labels["blogRoleLabels"][ $roleName ] ) ? $this->options->labels["blogRoleLabels"][ $roleName ] : 1; |
| [1887](#L1887) | $newRolePhrases[ "wc\_blog\_role\_" . $roleName ] = isset( $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] ) ? $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] : esc\_html\_\_( "Editor", "wpdiscuz" ); |
| [1888](#L1888) | } else { |
| [1889](#L1889) | $newBlogRoleLabels[ $roleName ]                = isset( $this->options->labels["blogRoleLabels"][ $roleName ] ) ? $this->options->labels["blogRoleLabels"][ $roleName ] : 0; |
| [1890](#L1890) | $newRolePhrases[ "wc\_blog\_role\_" . $roleName ] = isset( $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] ) ? $this->options->phrases[ "wc\_blog\_role\_" . $roleName ] : esc\_html\_\_( "Member", "wpdiscuz" ); |
| [1891](#L1891) | } |
| [1892](#L1892) | } |
| [1893](#L1893) | $newBlogRoles["post\_author"]                = isset( $this->options->labels["blogRoles"]["post\_author"] ) ? $this->options->labels["blogRoles"]["post\_author"] : "#00B38F"; |
| [1894](#L1894) | $newBlogRoleLabels["post\_author"]           = isset( $this->options->labels["blogRoleLabels"]["post\_author"] ) ? $this->options->labels["blogRoleLabels"]["post\_author"] : 1; |
| [1895](#L1895) | $newBlogRoles["guest"]                      = isset( $this->options->labels["blogRoles"]["guest"] ) ? $this->options->labels["blogRoles"]["guest"] : "#00B38F"; |
| [1896](#L1896) | $newBlogRoleLabels["guest"]                 = isset( $this->options->labels["blogRoleLabels"]["guest"] ) ? $this->options->labels["blogRoleLabels"]["guest"] : 0; |
| [1897](#L1897) | $newRolePhrases["wc\_blog\_role\_post\_author"] = isset( $this->options->phrases["wc\_blog\_role\_post\_author"] ) ? $this->options->phrases["wc\_blog\_role\_post\_author"] : esc\_html\_\_( "Author", "wpdiscuz" ); |
| [1898](#L1898) | $newRolePhrases["wc\_blog\_role\_guest"]       = isset( $this->options->phrases["wc\_blog\_role\_guest"] ) ? $this->options->phrases["wc\_blog\_role\_guest"] : esc\_html\_\_( "Guest", "wpdiscuz" ); |
| [1899](#L1899) | foreach ( $this->options->phrases as $key => $value ) { |
| [1900](#L1900) | if ( strpos( "wc\_blog\_role\_", $key ) === 0 ) { |
| [1901](#L1901) | unset( $this->options->phrases[ $key ] ); |
| [1902](#L1902) | } |
| [1903](#L1903) | } |
| [1904](#L1904) | foreach ( $newRolePhrases as $key => $value ) { |
| [1905](#L1905) | $this->options->phrases[ $key ] = $value; |
| [1906](#L1906) | } |
| [1907](#L1907) | $this->options->labels["blogRoles"]      = $newBlogRoles; |
| [1908](#L1908) | $this->options->labels["blogRoleLabels"] = $newBlogRoleLabels; |
| [1909](#L1909) | } |
| [1910](#L1910) |  |
| [1911](#L1911) | public function showReplies() { |
| [1912](#L1912) | $postId    = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [1913](#L1913) | $commentId = WpdiscuzHelper::sanitize( INPUT\_POST, "commentId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [1914](#L1914) | if ( $postId ) { |
| [1915](#L1915) | $this->isWpdiscuzLoaded = true; |
| [1916](#L1916) | $this->commentsArgs     = $this->getDefaultCommentsArgs( $postId ); |
| [1917](#L1917) | $commentListArgs        = $this->getCommentListArgs( $postId ); |
| [1918](#L1918) | if ( $this->form->isUserCanSeeComments( $commentListArgs["current\_user"], $postId ) ) { |
| [1919](#L1919) | $this->commentsArgs["parent"] = $commentId; |
| [1920](#L1920) | $this->commentsArgs["number"] = null; |
| [1921](#L1921) | $comment                      = get\_comment( $commentId ); |
| [1922](#L1922) | $args                         = [ |
| [1923](#L1923) | "format"                    => "flat", |
| [1924](#L1924) | "status"                    => $this->commentsArgs["status"], |
| [1925](#L1925) | "orderby"                   => $this->commentsArgs["orderby"], |
| [1926](#L1926) | "post\_id"                   => $this->commentsArgs["post\_id"], |
| [1927](#L1927) | "update\_comment\_meta\_cache" => false, |
| [1928](#L1928) | "no\_found\_rows"             => false, |
| [1929](#L1929) | "update\_comment\_post\_cache" => false, |
| [1930](#L1930) | ]; |
| [1931](#L1931) | if ( ! empty( $this->commentsArgs["include\_unapproved"] ) ) { |
| [1932](#L1932) | $args["include\_unapproved"] = $this->commentsArgs["include\_unapproved"]; |
| [1933](#L1933) | } |
| [1934](#L1934) | $children                                                          = $comment->get\_children( $args ); |
| [1935](#L1935) | $commentListArgs[ "wpdiscuz\_child\_count\_" . $comment->comment\_ID ] = count( $children ); |
| [1936](#L1936) | $comments                                                          = array\_merge( [ $comment ], $children ); |
| [1937](#L1937) | if ( $comments ) { |
| [1938](#L1938) | $response = []; |
| [1939](#L1939) | if ( $this->options->thread\_layouts["highlightVotingButtons"] ) { |
| [1940](#L1940) | if ( ! empty( $commentListArgs["current\_user"]->ID ) ) { |
| [1941](#L1941) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $comments, $commentListArgs['current\_user']->ID ); |
| [1942](#L1942) | } else { |
| [1943](#L1943) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $comments, md5( $this->helper->getRealIPAddr() ) ); |
| [1944](#L1944) | } |
| [1945](#L1945) | } |
| [1946](#L1946) | $response["comment\_list"]      = wp\_list\_comments( $commentListArgs, $comments ); |
| [1947](#L1947) | $response["callbackFunctions"] = []; |
| [1948](#L1948) | $response                      = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdShowReplies" ); |
| [1949](#L1949) | wp\_send\_json\_success( $response ); |
| [1950](#L1950) | } |
| [1951](#L1951) | } |
| [1952](#L1952) | } |
| [1953](#L1953) | } |
| [1954](#L1954) |  |
| [1955](#L1955) | public function mostReactedComment() { |
| [1956](#L1956) | $postId = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [1957](#L1957) | if ( $postId ) { |
| [1958](#L1958) | $this->isWpdiscuzLoaded = true; |
| [1959](#L1959) | $commentListArgs        = $this->getCommentListArgs( $postId ); |
| [1960](#L1960) | if ( $this->form->isUserCanSeeComments( $commentListArgs["current\_user"], $postId ) ) { |
| [1961](#L1961) | $commentId = $this->dbManager->getMostReactedCommentId( $postId ); |
| [1962](#L1962) | $comment   = get\_comment( $commentId ); |
| [1963](#L1963) | if ( $comment && $comment->comment\_post\_ID == $postId ) { |
| [1964](#L1964) | $this->commentsArgs = $this->getDefaultCommentsArgs( $postId ); |
| [1965](#L1965) | $commentStatusIn    = [ "1" ]; |
| [1966](#L1966) | if ( $this->commentsArgs["status"] === "all" ) { |
| [1967](#L1967) | $commentStatusIn[] = "0"; |
| [1968](#L1968) | } |
| [1969](#L1969) | $args              = [ |
| [1970](#L1970) | "format"  => "flat", |
| [1971](#L1971) | "status"  => $this->commentsArgs["status"], |
| [1972](#L1972) | "orderby" => $this->commentsArgs["orderby"], |
| [1973](#L1973) | "post\_id" => $this->commentsArgs["post\_id"], |
| [1974](#L1974) | ]; |
| [1975](#L1975) | $includeUnapproved = null; |
| [1976](#L1976) | if ( ! empty( $this->commentsArgs["include\_unapproved"] ) ) { |
| [1977](#L1977) | $args["include\_unapproved"] = $this->commentsArgs["include\_unapproved"]; |
| [1978](#L1978) | $includeUnapproved          = $this->commentsArgs["include\_unapproved"]; |
| [1979](#L1979) | } |
| [1980](#L1980) | $parentComment                       = $this->helperOptimization->getCommentRoot( $commentId, $commentStatusIn, $includeUnapproved ); |
| [1981](#L1981) | $tree                                = $parentComment->get\_children( $args ); |
| [1982](#L1982) | $comments                            = array\_merge( [ $parentComment ], $tree ); |
| [1983](#L1983) | $commentListArgs["isSingle"]         = true; |
| [1984](#L1984) | $commentListArgs["new\_loaded\_class"] = "wpd-new-loaded-comment"; |
| [1985](#L1985) | $response                            = []; |
| [1986](#L1986) | if ( $comments && $this->options->thread\_layouts["highlightVotingButtons"] ) { |
| [1987](#L1987) | if ( ! empty( $commentListArgs['current\_user']->ID ) ) { |
| [1988](#L1988) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $comments, $commentListArgs['current\_user']->ID ); |
| [1989](#L1989) | } else { |
| [1990](#L1990) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $comments, md5( $this->helper->getRealIPAddr() ) ); |
| [1991](#L1991) | } |
| [1992](#L1992) | } |
| [1993](#L1993) | $response["message"]           = wp\_list\_comments( $commentListArgs, $comments ); |
| [1994](#L1994) | $response["commentId"]         = $commentId; |
| [1995](#L1995) | $response["parentCommentID"]   = $parentComment->comment\_ID; |
| [1996](#L1996) | $response["callbackFunctions"] = []; |
| [1997](#L1997) | $response                      = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdMostReactedComment" ); |
| [1998](#L1998) | wp\_send\_json\_success( $response ); |
| [1999](#L1999) | } |
| [2000](#L2000) | } |
| [2001](#L2001) | } |
| [2002](#L2002) | } |
| [2003](#L2003) |  |
| [2004](#L2004) | public function hottestThread() { |
| [2005](#L2005) | $postId = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [2006](#L2006) | if ( $postId ) { |
| [2007](#L2007) | $this->isWpdiscuzLoaded = true; |
| [2008](#L2008) | $commentListArgs        = $this->getCommentListArgs( $postId ); |
| [2009](#L2009) | if ( $this->form->isUserCanSeeComments( $commentListArgs["current\_user"], $postId ) ) { |
| [2010](#L2010) | $this->commentsArgs = $this->getDefaultCommentsArgs( $postId ); |
| [2011](#L2011) | $commentStatusIn    = [ "1" ]; |
| [2012](#L2012) | if ( $this->commentsArgs["status"] === "all" ) { |
| [2013](#L2013) | $commentStatusIn[] = "0"; |
| [2014](#L2014) | } |
| [2015](#L2015) | $parentCommentIds = $this->dbManager->getParentCommentsHavingReplies( $postId, $commentStatusIn ); |
| [2016](#L2016) | $childCount       = 0; |
| [2017](#L2017) | $hottestCommentId = 0; |
| [2018](#L2018) | $hottestChildren  = []; |
| [2019](#L2019) | foreach ( $parentCommentIds as $parentCommentId ) { |
| [2020](#L2020) | $children = $this->dbManager->getHottestTree( $parentCommentId ); |
| [2021](#L2021) | $tmpCount = count( $children ); |
| [2022](#L2022) | if ( $childCount < $tmpCount ) { |
| [2023](#L2023) | $childCount       = $tmpCount; |
| [2024](#L2024) | $hottestCommentId = $parentCommentId; |
| [2025](#L2025) | $hottestChildren  = $children; |
| [2026](#L2026) | } |
| [2027](#L2027) | } |
| [2028](#L2028) |  |
| [2029](#L2029) | if ( $hottestCommentId && $hottestChildren ) { |
| [2030](#L2030) | $args              = [ |
| [2031](#L2031) | "format"  => "flat", |
| [2032](#L2032) | "status"  => $this->commentsArgs["status"], |
| [2033](#L2033) | "orderby" => $this->commentsArgs["orderby"], |
| [2034](#L2034) | "post\_id" => $this->commentsArgs["post\_id"], |
| [2035](#L2035) | ]; |
| [2036](#L2036) | $includeUnapproved = null; |
| [2037](#L2037) | if ( ! empty( $this->commentsArgs["include\_unapproved"] ) ) { |
| [2038](#L2038) | $args["include\_unapproved"] = $this->commentsArgs["include\_unapproved"]; |
| [2039](#L2039) | $includeUnapproved          = $this->commentsArgs["include\_unapproved"]; |
| [2040](#L2040) | } |
| [2041](#L2041) | $parentComment                       = $this->helperOptimization->getCommentRoot( $hottestCommentId, $commentStatusIn, $includeUnapproved ); |
| [2042](#L2042) | $tree                                = $parentComment->get\_children( $args ); |
| [2043](#L2043) | $comments                            = array\_merge( [ $parentComment ], $tree ); |
| [2044](#L2044) | $commentListArgs["isSingle"]         = true; |
| [2045](#L2045) | $commentListArgs["new\_loaded\_class"] = "wpd-new-loaded-comment"; |
| [2046](#L2046) | $response                            = []; |
| [2047](#L2047) | if ( $comments && $this->options->thread\_layouts["highlightVotingButtons"] ) { |
| [2048](#L2048) | if ( ! empty( $commentListArgs['current\_user']->ID ) ) { |
| [2049](#L2049) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $comments, $commentListArgs['current\_user']->ID ); |
| [2050](#L2050) | } else { |
| [2051](#L2051) | $commentListArgs["user\_votes"] = $this->dbManager->getUserVotes( $comments, md5( $this->helper->getRealIPAddr() ) ); |
| [2052](#L2052) | } |
| [2053](#L2053) | } |
| [2054](#L2054) | $response["message"]           = wp\_list\_comments( $commentListArgs, $comments ); |
| [2055](#L2055) | $response["commentId"]         = $hottestCommentId; |
| [2056](#L2056) | $response["callbackFunctions"] = []; |
| [2057](#L2057) | $response                      = apply\_filters( "wpdiscuz\_ajax\_callbacks", $response, $action = "wpdHottestThread" ); |
| [2058](#L2058) | wp\_send\_json\_success( $response ); |
| [2059](#L2059) | } |
| [2060](#L2060) | } |
| [2061](#L2061) | } |
| [2062](#L2062) | } |
| [2063](#L2063) |  |
| [2064](#L2064) | private function getStickyComments( $isPaginate, &$commentList, &$commentListArgs ) { |
| [2065](#L2065) | if ( ! empty( $this->commentsArgs["first\_load"] ) ) { |
| [2066](#L2066) | $this->commentsArgs["sticky"] = 1; |
| [2067](#L2067) | $this->commentsArgs["number"] = null; |
| [2068](#L2068) | if ( $isPaginate ) { |
| [2069](#L2069) | $this->commentsArgs["number"] = ""; |
| [2070](#L2070) | $this->commentsArgs["offset"] = ""; |
| [2071](#L2071) | $this->commentsArgs["parent"] = ""; |
| [2072](#L2072) | } |
| [2073](#L2073) | $this->commentsArgs["caller"]       = "wpdiscuz"; |
| [2074](#L2074) | $this->commentsArgs["type\_\_not\_in"] = []; |
| [2075](#L2075) | $this->commentsArgs["type\_\_in"]     = [ self::WPDISCUZ\_STICKY\_COMMENT ]; |
| [2076](#L2076) | $stickyComments                     = get\_comments( $this->commentsArgs ); |
| [2077](#L2077) | if ( $stickyComments ) { |
| [2078](#L2078) | if ( $this->options->wp["threadComments"] ) { |
| [2079](#L2079) | $stickyComments = $this->getChildren( $stickyComments, $commentListArgs ); |
| [2080](#L2080) | } |
| [2081](#L2081) | $commentList = ( $isPaginate && $this->options->wp["commentOrder"] === "desc" ) ? array\_merge( $commentList, $stickyComments ) : array\_merge( $stickyComments, $commentList ); |
| [2082](#L2082) | } |
| [2083](#L2083) | } |
| [2084](#L2084) | } |
| [2085](#L2085) |  |
| [2086](#L2086) | public function footerContents() { |
| [2087](#L2087) | if ( $this->isWpdiscuzLoaded ) { |
| [2088](#L2088) | global $post; |
| [2089](#L2089) | if ( $this->options->login["showActivityTab"] || $this->options->login["showSubscriptionsTab"] || $this->options->login["showFollowsTab"] || apply\_filters( "wpdiscuz\_enable\_content\_modal", false ) ) { |
| [2090](#L2090) | $this->addContentModal(); |
| [2091](#L2091) | } |
| [2092](#L2092) | if ( $this->options->live["enableBubble"] ) { |
| [2093](#L2093) | $this->addBubble( $post ); |
| [2094](#L2094) | } |
| [2095](#L2095) | if ( $this->options->thread\_display["highlightUnreadComments"] ) { |
| [2096](#L2096) | $this->saveLastVisit( $post ); |
| [2097](#L2097) | } |
| [2098](#L2098) | echo "<div id='wpd-editor-source-code-wrapper-bg'></div><div id='wpd-editor-source-code-wrapper'><textarea id='wpd-editor-source-code'></textarea><button id='wpd-insert-source-code'>Insert</button><input type='hidden' id='wpd-editor-uid' /></div>"; |
| [2099](#L2099) | } |
| [2100](#L2100) | } |
| [2101](#L2101) |  |
| [2102](#L2102) | public function addBubble( $post ) { |
| [2103](#L2103) | if ( comments\_open( $post->ID ) ) { |
| [2104](#L2104) | echo "<div id='wpd-bubble-wrapper'>"; |
| [2105](#L2105) | $commentsNumber = get\_comments\_number( $post->ID ); |
| [2106](#L2106) | echo "<span id='wpd-bubble-all-comments-count'" . ( $commentsNumber ? "" : " style='display:none;'" ) . " title='" . esc\_attr( $commentsNumber ) . "'>" . esc\_html( $this->helper->getNumber( $commentsNumber ) ) . "</span>"; |
| [2107](#L2107) | echo "<div id='wpd-bubble-count'>"; |
| [2108](#L2108) | echo "<svg xmlns='https://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path class='wpd-bubble-count-first' d='M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z'/><path class='wpd-bubble-count-second' d='M0 0h24v24H0z' /></svg>"; |
| [2109](#L2109) | echo "<span class='wpd-new-comments-count'>0</span>"; |
| [2110](#L2110) | echo "</div>"; |
| [2111](#L2111) | echo "<div id='wpd-bubble'>"; |
| [2112](#L2112) | echo "<svg xmlns='https://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path class='wpd-bubble-plus-first' d='M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z'/><path class='wpd-bubble-plus-second' d='M0 0h24v24H0z' /></svg>"; |
| [2113](#L2113) | echo "<div id='wpd-bubble-add-message'>" . esc\_html( $this->options->getPhrase( "wc\_bubble\_invite\_message" ) ) . "<span id='wpd-bubble-add-message-close'><a href='#'>x</a></span></div>"; |
| [2114](#L2114) | echo "</div>"; |
| [2115](#L2115) | echo "<div id='wpd-bubble-notification'><svg xmlns='https://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path class='wpd-bubble-notification-first' d='M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z'/><path class='wpd-bubble-notification-second' d='M0 0h24v24H0z' /></svg>"; |
| [2116](#L2116) | if ( $this->options->live["bubbleShowNewCommentMessage"] ) { |
| [2117](#L2117) | echo "<div id='wpd-bubble-notification-message'>"; |
| [2118](#L2118) | echo "<div id='wpd-bubble-author'>"; |
| [2119](#L2119) | echo "<div>"; |
| [2120](#L2120) | echo "<span id='wpd-bubble-author-avatar'></span>"; |
| [2121](#L2121) | echo "<span id='wpd-bubble-author-name'></span>"; |
| [2122](#L2122) | echo "<span id='wpd-bubble-comment-date'>(<span class='wpd-bubble-spans'></span>)</span>"; |
| [2123](#L2123) | echo "</div>"; |
| [2124](#L2124) | echo "<span id='wpd-bubble-comment-close'><a href='#'>x</a></span>"; |
| [2125](#L2125) | echo "</div>"; |
| [2126](#L2126) | echo "<div id='wpd-bubble-comment'>"; |
| [2127](#L2127) | echo "<span id='wpd-bubble-comment-text'></span>"; |
| [2128](#L2128) | echo "<span id='wpd-bubble-comment-reply-link'>| <a href='#'>" . $this->options->getPhrase( "wc\_reply\_text" ) . "</a></span>"; |
| [2129](#L2129) | echo "</div>"; |
| [2130](#L2130) | echo "</div>"; |
| [2131](#L2131) | } |
| [2132](#L2132) | echo "</div>"; |
| [2133](#L2133) | echo "</div>"; |
| [2134](#L2134) | } |
| [2135](#L2135) | } |
| [2136](#L2136) |  |
| [2137](#L2137) | public function registerRestRoutes() { |
| [2138](#L2138) | $controller = new WpdiscuzRest( $this->dbManager, $this->options, $this->helper, $this->wpdiscuzForm ); |
| [2139](#L2139) | $controller->registerRoutes(); |
| [2140](#L2140) | } |
| [2141](#L2141) |  |
| [2142](#L2142) | public function mceButton( $buttons ) { |
| [2143](#L2143) | global $post; |
| [2144](#L2144) | if ( ! empty( $post->ID ) && comments\_open( $post->ID ) && apply\_filters( "wpdiscuz\_enable\_feedback\_shortcode\_button", true ) && ( $form = $this->wpdiscuzForm->getForm( $post->ID ) ) && $form->getFormID() ) { |
| [2145](#L2145) | array\_push( $buttons, "|", "wpDiscuz" ); |
| [2146](#L2146) | } |
| [2147](#L2147) |  |
| [2148](#L2148) | return $buttons; |
| [2149](#L2149) | } |
| [2150](#L2150) |  |
| [2151](#L2151) | public function mceExternalPlugin( $plugin\_array ) { |
| [2152](#L2152) | global $post; |
| [2153](#L2153) | if ( ! empty( $post->ID ) && comments\_open( $post->ID ) && apply\_filters( "wpdiscuz\_enable\_feedback\_shortcode\_button", true ) && ( $form = $this->wpdiscuzForm->getForm( $post->ID ) ) && $form->getFormID() ) { |
| [2154](#L2154) | $plugin\_array["wpDiscuz"] = esc\_url\_raw( plugins\_url( "assets/js/wpdiscuz-shortcode-tinymce.js", \_\_FILE\_\_ ) ); |
| [2155](#L2155) | } |
| [2156](#L2156) |  |
| [2157](#L2157) | return $plugin\_array; |
| [2158](#L2158) | } |
| [2159](#L2159) |  |
| [2160](#L2160) | public function gutenbergButton() { |
| [2161](#L2161) | global $post; |
| [2162](#L2162) | if ( ! empty( $post->ID ) && comments\_open( $post->ID ) && apply\_filters( "wpdiscuz\_enable\_feedback\_shortcode\_button", true ) && ( $form = $this->wpdiscuzForm->getForm( $post->ID ) ) && $form->getFormID() ) { |
| [2163](#L2163) | wp\_register\_script( self::WPDISCUZ\_FEEDBACK\_SHORTCODE . "-shortcode-gutenberg-js", plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/js/wpdiscuz-shortcode-gutenberg.js" ), [ |
| [2164](#L2164) | "wp-blocks", |
| [2165](#L2165) | "wp-editor", |
| [2166](#L2166) | "wp-components" |
| [2167](#L2167) | ] ); |
| [2168](#L2168) | wp\_enqueue\_script( self::WPDISCUZ\_FEEDBACK\_SHORTCODE . "-shortcode-gutenberg-js" ); |
| [2169](#L2169) | wp\_localize\_script( self::WPDISCUZ\_FEEDBACK\_SHORTCODE . "-shortcode-gutenberg-js", "wpdObject", [ |
| [2170](#L2170) | "shortcode"      => self::WPDISCUZ\_FEEDBACK\_SHORTCODE, |
| [2171](#L2171) | "image"          => plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/img/shortcode.png" ), |
| [2172](#L2172) | "tooltip"        => $this->options->getPhrase( "wc\_feedback\_shortcode\_tooltip" ), |
| [2173](#L2173) | "popup\_title"    => $this->options->getPhrase( "wc\_feedback\_popup\_title" ), |
| [2174](#L2174) | "leave\_feebdack" => $this->options->getPhrase( "wc\_please\_leave\_feebdack" ) |
| [2175](#L2175) | ] ); |
| [2176](#L2176) | } |
| [2177](#L2177) | } |
| [2178](#L2178) |  |
| [2179](#L2179) | public function feedbackDialog() { |
| [2180](#L2180) | global $post; |
| [2181](#L2181) | if ( ! empty( $post->ID ) && comments\_open( $post->ID ) && apply\_filters( "wpdiscuz\_enable\_feedback\_shortcode\_button", true ) && ( $form = $this->wpdiscuzForm->getForm( $post->ID ) ) && $form->getFormID() ) { |
| [2182](#L2182) | ?> |
| [2183](#L2183) | <style type="text/css"> |
| [2184](#L2184) | #TB\_title { |
| [2185](#L2185) | background: #E9E9E9 !important; |
| [2186](#L2186) | font-size: 16px !important; |
| [2187](#L2187) | font-weight: normal !important; |
| [2188](#L2188) | line-height: 20px !important; |
| [2189](#L2189) | padding: 5px 10px; |
| [2190](#L2190) | } |
| [2191](#L2191) |  |
| [2192](#L2192) | #TB\_ajaxContent { |
| [2193](#L2193) | width: 100% !important; |
| [2194](#L2194) | box-sizing: border-box; |
| [2195](#L2195) | height: 80vh !important; |
| [2196](#L2196) | overflow-y: auto; |
| [2197](#L2197) | } |
| [2198](#L2198) |  |
| [2199](#L2199) | #TB\_ajaxContent .wpd-put-shortcode-parent { |
| [2200](#L2200) | padding-top: 20px; |
| [2201](#L2201) | text-align: center; |
| [2202](#L2202) | } |
| [2203](#L2203) |  |
| [2204](#L2204) | #TB\_ajaxContent p { |
| [2205](#L2205) | padding: 0; |
| [2206](#L2206) | margin-top: 2px; |
| [2207](#L2207) | } |
| [2208](#L2208) |  |
| [2209](#L2209) | #TB\_ajaxContent input[type="text"] { |
| [2210](#L2210) | width: 98%; |
| [2211](#L2211) | padding: 7px 10px; |
| [2212](#L2212) | box-sizing: border-box; |
| [2213](#L2213) | } |
| [2214](#L2214) |  |
| [2215](#L2215) | #TB\_ajaxContent .wpd-shortcode-inline-form h3 { |
| [2216](#L2216) | font-size: 14px; |
| [2217](#L2217) | color: #000000; |
| [2218](#L2218) | padding-top: 0; |
| [2219](#L2219) | margin-bottom: 5px; |
| [2220](#L2220) | } |
| [2221](#L2221) |  |
| [2222](#L2222) | #TB\_ajaxContent img.wpd-fbs-screen { |
| [2223](#L2223) | width: 100%; |
| [2224](#L2224) | } |
| [2225](#L2225) |  |
| [2226](#L2226) | #TB\_ajaxContent .wpd-inline-type { |
| [2227](#L2227) | width: 100%; |
| [2228](#L2228) | text-align: center; |
| [2229](#L2229) | font-weight: 600; |
| [2230](#L2230) | padding: 1px 0 5px 0; |
| [2231](#L2231) | box-sizing: border-box; |
| [2232](#L2232) | margin-top: 5px; |
| [2233](#L2233) | line-height: 10px; |
| [2234](#L2234) | } |
| [2235](#L2235) |  |
| [2236](#L2236) | #wpd-inline-content { |
| [2237](#L2237) | padding: 10px; |
| [2238](#L2238) | background-color: #f5f5f5; |
| [2239](#L2239) | margin: 10px 0 0 0; |
| [2240](#L2240) | max-height: 55px; |
| [2241](#L2241) | overflow-y: auto; |
| [2242](#L2242) | font-size: 12px; |
| [2243](#L2243) | line-height: 15px; |
| [2244](#L2244) | } |
| [2245](#L2245) |  |
| [2246](#L2246) | #wpd-inline-content p { |
| [2247](#L2247) | font-size: 12px; |
| [2248](#L2248) | line-height: 15px; |
| [2249](#L2249) | } |
| [2250](#L2250) |  |
| [2251](#L2251) | #wpd-inline-content .wpd-text-error { |
| [2252](#L2252) | color: #DD0000; |
| [2253](#L2253) | font-size: 13px; |
| [2254](#L2254) | } |
| [2255](#L2255) | </style> |
| [2256](#L2256) | <div id="wpdiscuz\_feedback\_dialog" style="display:none"> |
| [2257](#L2257) | <div class="wpd-shortcode-inline-form"> |
| [2258](#L2258) | <h3><?php esc\_html\_e( "Selected Text", "wpdiscuz" ) ?></h3> |
| [2259](#L2259) | <div id="wpd-inline-content"> |
| [2260](#L2260) | <span class="wpd-text-error"><?php esc\_html\_e( "No text is selected. Please select a part of text from post content.", "wpdiscuz" ); ?></span> |
| [2261](#L2261) | </div> |
| [2262](#L2262) | <table> |
| [2263](#L2263) | <tr> |
| [2264](#L2264) | <td colspan="2"> |
| [2265](#L2265) | <h3><?php esc\_html\_e( "Your Question to Readers", "wpdiscuz" ); ?></h3> |
| [2266](#L2266) | <p class="description" |
| [2267](#L2267) | style="line-height: 17px; color: #777; font-size: 12px;"><?php esc\_html\_e( "A simple question or a call to leave a feedback on the selected part of text. Something like &quot;By the way. Do you agree with this?&quot; or &quot;Would love your thoughts, please comment on this.&quot;", "wpdiscuz" ); ?></p> |
| [2268](#L2268) | </td> |
| [2269](#L2269) | </tr> |
| [2270](#L2270) | <tr> |
| [2271](#L2271) | <td colspan="2"> |
| [2272](#L2272) | <input type="text" id="wpd-inline-question" name="wpd-inline-question" |
| [2273](#L2273) | placeholder="<?php esc\_attr\_e( "e.g: Any thoughts on this?", "wpdiscuz" ) ?>"/> |
| [2274](#L2274) | </td> |
| [2275](#L2275) | </tr> |
| [2276](#L2276) | <tr> |
| [2277](#L2277) | <td colspan="2"> |
| [2278](#L2278) | <h3><?php esc\_html\_e( "Feedback Button Display Type", "wpdiscuz" ); ?></h3> |
| [2279](#L2279) | <p class="description" |
| [2280](#L2280) | style="line-height: 17px; color: #777; font-size: 12px;"><?php esc\_html\_e( "By default the inline feedback form is closed and only the button is displayed. Once reader scrolled and reached to the selected text part, this button animates with comment button size and color changes attracting readers attention. Readers click on the button and open your question with feedback form. Using this option you can keep opened the feedback form. Readers can close it using [x] button.", "wpdiscuz" ); ?></p> |
| [2281](#L2281) | </td> |
| [2282](#L2282) | </tr> |
| [2283](#L2283) | <tr> |
| [2284](#L2284) | <td style="width: 50%;"> |
| [2285](#L2285) | <div class="wpd-inline-type"> |
| [2286](#L2286) | <label> |
| [2287](#L2287) | <input type="radio" name="wpd-inline-type" value="0" checked="checked"/> |
| [2288](#L2288) | <?php esc\_html\_e( "CLOSED", "wpdiscuz" ) ?> |
| [2289](#L2289) | </label> |
| [2290](#L2290) | </div> |
| [2291](#L2291) | <img src="<?php echo esc\_url\_raw( plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/img/dashboard/inline-feedback-closed.png" ) ) ?>" |
| [2292](#L2292) | class="wpd-fbs-screen"> |
| [2293](#L2293) | </td> |
| [2294](#L2294) | <td style="width: 50%"> |
| [2295](#L2295) | <div class="wpd-inline-type"> |
| [2296](#L2296) | <label> |
| [2297](#L2297) | <input type="radio" name="wpd-inline-type" value="1"/> |
| [2298](#L2298) | <?php esc\_html\_e( "OPENED", "wpdiscuz" ) ?> |
| [2299](#L2299) | </label> |
| [2300](#L2300) | </div> |
| [2301](#L2301) | <img src="<?php echo esc\_url\_raw( plugins\_url( WPDISCUZ\_DIR\_NAME . "/assets/img/dashboard/inline-feedback-opened.png" ) ) ?>" |
| [2302](#L2302) | class="wpd-fbs-screen"> |
| [2303](#L2303) | </td> |
| [2304](#L2304) | </tr> |
| [2305](#L2305) | </table> |
| [2306](#L2306) | </div> |
| [2307](#L2307) | <div class="wpd-put-shortcode-parent"> |
| [2308](#L2308) | <button type="button" class="button button-primary button-large" |
| [2309](#L2309) | id="wpd-put-shortcode"><?php esc\_html\_e( "Add Inline Feedback Button", "wpdiscuz" ); ?></button> |
| [2310](#L2310) | </div> |
| [2311](#L2311) | </div> |
| [2312](#L2312) | <?php |
| [2313](#L2313) | } |
| [2314](#L2314) | } |
| [2315](#L2315) |  |
| [2316](#L2316) | public function registerWpdiscuzWidgetInElementor( $widgets\_manager ) { |
| [2317](#L2317) |  |
| [2318](#L2318) | require\_once( WPDISCUZ\_DIR\_PATH . "/utils/WpdiscuzElementorIntegration.php" ); |
| [2319](#L2319) |  |
| [2320](#L2320) | $widgets\_manager->register( new WpdiscuzElementorIntegration() ); |
| [2321](#L2321) |  |
| [2322](#L2322) | } |
| [2323](#L2323) |  |
| [2324](#L2324) | public function feedbackShortcode( $atts, $content = "" ) { |
| [2325](#L2325) | global $post; |
| [2326](#L2326) | if ( $this->isWpdiscuzLoaded && comments\_open( $post->ID ) && apply\_filters( "wpdiscuz\_enable\_feedback\_shortcode\_button", true ) && $this->form->isUserCanSeeComments( WpdiscuzHelper::getCurrentUser(), $post->ID ) ) { |
| [2327](#L2327) | $atts = shortcode\_atts( [ |
| [2328](#L2328) | "id"       => "", |
| [2329](#L2329) | "question" => "", |
| [2330](#L2330) | "opened"   => 0 |
| [2331](#L2331) | ], $atts, self::WPDISCUZ\_FEEDBACK\_SHORTCODE ); |
| [2332](#L2332) | if ( $atts["id"] && $atts["question"] && ( $inline\_form = $this->dbManager->getFeedbackFormByUid( $post->ID, $atts["id"] ) ) ) { |
| [2333](#L2333) | $content = "<div class='wpd-inline-shortcode wpd-inline-" . ( $inline\_form->opened && $this->form->isUserCanComment( WpdiscuzHelper::getCurrentUser(), $post->ID ) ? "opened" : "closed" ) . "' id='wpd-inline-" . $inline\_form->id . "'>" . wp\_kses\_post(html\_entity\_decode( $content )); |
| [2334](#L2334) | $content .= "<div class='wpd-inline-icon-wrapper'>"; |
| [2335](#L2335) | $content .= "<svg class='wpd-inline-icon" . ( $this->options->inline["inlineFeedbackAttractionType"] === "blink" ? " wpd-ignored" : "" ) . "' xmlns='https://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><path class='wpd-inline-icon-first' d='M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z'/><path class='wpd-inline-icon-second' d='M0 0h24v24H0z' /></svg>"; |
| [2336](#L2336) | $args    = [ |
| [2337](#L2337) | "count"      => true, |
| [2338](#L2338) | "status"     => ! $this->options->wp["isPaginate"] && current\_user\_can( "moderate\_comments" ) ? "all" : "approve", |
| [2339](#L2339) | "meta\_query" => [ |
| [2340](#L2340) | [ |
| [2341](#L2341) | "key"     => self::META\_KEY\_FEEDBACK\_FORM\_ID, |
| [2342](#L2342) | "value"   => $inline\_form->id, |
| [2343](#L2343) | "compare" => "=", |
| [2344](#L2344) | ], |
| [2345](#L2345) | ], |
| [2346](#L2346) | ]; |
| [2347](#L2347) | $count   = get\_comments( $args ); |
| [2348](#L2348) | $content .= "<div class='wpd-inline-icon-count" . esc\_attr( $count ? " wpd-has-comments" : "" ) . "'>" . esc\_html( $count ) . "</div>"; |
| [2349](#L2349) | $content .= "<div class='wpd-inline-form-wrapper'>"; |
| [2350](#L2350) | $content .= "<div class='wpd-inline-form-question'>" . esc\_html( $inline\_form->question ); |
| [2351](#L2351) | $content .= "<span class='wpd-inline-form-close'><a href='#'>x</a></span>"; |
| [2352](#L2352) | $content .= "</div>"; |
| [2353](#L2353) | $content .= "</div>"; |
| [2354](#L2354) | $content .= "</div>"; |
| [2355](#L2355) | $content .= "</div>"; |
| [2356](#L2356) | } |
| [2357](#L2357) | } |
| [2358](#L2358) |  |
| [2359](#L2359) | return $content; |
| [2360](#L2360) | } |
| [2361](#L2361) |  |
| [2362](#L2362) | public function addInlineComment() { |
| [2363](#L2363) | $inline\_form\_id = WpdiscuzHelper::sanitize( INPUT\_POST, "inline\_form\_id", FILTER\_SANITIZE\_NUMBER\_INT, 0 ); |
| [2364](#L2364) | if ( $inline\_form\_id && apply\_filters( "wpdiscuz\_enable\_feedback\_shortcode\_button", true ) && ( $inline\_form = $this->dbManager->getFeedbackForm( $inline\_form\_id ) ) ) { |
| [2365](#L2365) | if ( wp\_verify\_nonce( WpdiscuzHelper::sanitize( INPUT\_POST, "\_wpd\_inline\_nonce", "FILTER\_SANITIZE\_STRING" ), "wpd\_inline\_nonce\_" . $inline\_form->post\_id ) ) { |
| [2366](#L2366) | $result = $this->helper->handleCommentSubmission( $inline\_form->post\_id, 0 ); |
| [2367](#L2367) | if ( is\_wp\_error( $result ) ) { |
| [2368](#L2368) | wp\_die( esc\_html( $result->get\_error\_message() ) ); |
| [2369](#L2369) | } |
| [2370](#L2370) | $this->isWpdiscuzLoaded = true; |
| [2371](#L2371) | $currentUser            = WpdiscuzHelper::getCurrentUser(); |
| [2372](#L2372) | $this->form             = $this->wpdiscuzForm->getForm( $inline\_form->post\_id ); |
| [2373](#L2373) | if ( $this->form->isUserCanSeeComments( $currentUser, $inline\_form->post\_id ) ) { |
| [2374](#L2374) | $isAnonymous = false; |
| [2375](#L2375) | if ( ! empty( $currentUser->ID ) ) { |
| [2376](#L2376) | $user\_id = $currentUser->ID; |
| [2377](#L2377) | $name    = $this->helper->getCurrentUserDisplayName( $currentUser ); |
| [2378](#L2378) | $email   = $currentUser->user\_email; |
| [2379](#L2379) | } else { |
| [2380](#L2380) | $user\_id = 0; |
| [2381](#L2381) | $name    = urldecode( trim( sanitize\_text\_field( $\_POST["wpd\_inline\_name"] ) ) ); |
| [2382](#L2382) | if ( ! empty( $\_POST["wpd\_inline\_email"] ) && ( $email = sanitize\_email( trim( $\_POST["wpd\_inline\_email"] ) ) ) ) { |
| [2383](#L2383) | if ( filter\_var( $email, FILTER\_VALIDATE\_EMAIL ) === false ) { |
| [2384](#L2384) | wp\_send\_json\_error( "wc\_error\_email\_text" ); |
| [2385](#L2385) | } |
| [2386](#L2386) | } else { |
| [2387](#L2387) | $email       = uniqid() . "@example.com"; |
| [2388](#L2388) | $isAnonymous = true; |
| [2389](#L2389) | } |
| [2390](#L2390) | $email = urldecode( $email ); |
| [2391](#L2391) | } |
| [2392](#L2392) | $email = apply\_filters( "wpdiscuz\_feedback\_commenter\_email", $email ); |
| [2393](#L2393) |  |
| [2394](#L2394) | // $comment\_content is filtered in function "$this->helper->filterCommentText" by WP's native function wp\_kses |
| [2395](#L2395) | $comment\_content = ! empty( $\_POST["wpd\_inline\_comment"] ) ? stripslashes( trim( $\_POST["wpd\_inline\_comment"] ) ) : ""; |
| [2396](#L2396) | $comment\_content = $this->helper->filterCommentText( $comment\_content ); |
| [2397](#L2397) |  |
| [2398](#L2398) | $commentMinLength = intval( $this->options->content["commentTextMinLength"] ); |
| [2399](#L2399) | $commentMaxLength = intval( $this->options->content["commentTextMaxLength"] ); |
| [2400](#L2400) | $contentLength    = function\_exists( "mb\_strlen" ) ? mb\_strlen( $comment\_content ) : strlen( $comment\_content ); |
| [2401](#L2401) | if ( $commentMinLength > 0 && $contentLength < $commentMinLength ) { |
| [2402](#L2402) | wp\_send\_json\_error( "wc\_msg\_input\_min\_length" ); |
| [2403](#L2403) | } |
| [2404](#L2404) | if ( $commentMaxLength > 0 && $contentLength > $commentMaxLength ) { |
| [2405](#L2405) | wp\_send\_json\_error( "wc\_msg\_input\_max\_length" ); |
| [2406](#L2406) | } |
| [2407](#L2407) |  |
| [2408](#L2408) | if ( $name && $email ) { |
| [2409](#L2409) | $wc\_user\_agent   = ! empty( $\_SERVER["HTTP\_USER\_AGENT"] ) ? $\_SERVER["HTTP\_USER\_AGENT"] : ""; |
| [2410](#L2410) | $new\_commentdata = [ |
| [2411](#L2411) | "user\_id"              => $user\_id, |
| [2412](#L2412) | "comment\_post\_ID"      => $inline\_form->post\_id, |
| [2413](#L2413) | "comment\_parent"       => 0, |
| [2414](#L2414) | "comment\_author"       => $name, |
| [2415](#L2415) | "comment\_author\_email" => $email, |
| [2416](#L2416) | "comment\_author\_url"   => "", |
| [2417](#L2417) | "comment\_content"      => $comment\_content, |
| [2418](#L2418) | "comment\_agent"        => $wc\_user\_agent, |
| [2419](#L2419) | "comment\_type"         => self::$DEFAULT\_COMMENT\_TYPE, |
| [2420](#L2420) | ]; |
| [2421](#L2421) |  |
| [2422](#L2422) | $allow\_empty\_comment = apply\_filters( 'allow\_empty\_comment', false, $new\_commentdata ); |
| [2423](#L2423) | if ( '' === $comment\_content && ! $allow\_empty\_comment ) { |
| [2424](#L2424) | wp\_send\_json\_error( "wc\_msg\_required\_fields" ); |
| [2425](#L2425) | } |
| [2426](#L2426) |  |
| [2427](#L2427) | $this->helper->restrictCommentingPerUser( $email, 0, $inline\_form->post\_id ); |
| [2428](#L2428) | $new\_comment\_id = wp\_new\_comment( wp\_slash( $new\_commentdata ) ); |
| [2429](#L2429) | add\_comment\_meta( $new\_comment\_id, self::META\_KEY\_FEEDBACK\_FORM\_ID, $inline\_form->id ); |
| [2430](#L2430) | $args       = [ |
| [2431](#L2431) | "count"      => true, |
| [2432](#L2432) | "meta\_query" => [ |
| [2433](#L2433) | [ |
| [2434](#L2434) | "key"     => self::META\_KEY\_FEEDBACK\_FORM\_ID, |
| [2435](#L2435) | "value"   => $inline\_form->id, |
| [2436](#L2436) | "compare" => "=", |
| [2437](#L2437) | ], |
| [2438](#L2438) | ], |
| [2439](#L2439) | ]; |
| [2440](#L2440) | $newComment = get\_comment( $new\_comment\_id ); |
| [2441](#L2441) | if ( $newComment->comment\_approved === "1" && class\_exists( "WooCommerce" ) && get\_post\_type( $inline\_form->post\_id ) === "product" ) { |
| [2442](#L2442) | update\_post\_meta( $inline\_form->post\_id, "\_wc\_review\_count", get\_comments( [ |
| [2443](#L2443) | "count"   => true, |
| [2444](#L2444) | "post\_id" => $inline\_form->post\_id |
| [2445](#L2445) | ] ) ); |
| [2446](#L2446) | } |
| [2447](#L2447) | if ( apply\_filters( "wpdiscuz\_enable\_user\_mentioning", $this->options->subscription["enableUserMentioning"] ) && $this->options->subscription["sendMailToMentionedUsers"] && ( $mentionedUsers = $this->helper->getMentionedUsers( $newComment->comment\_content ) ) ) { |
| [2448](#L2448) | $this->helperEmail->sendMailToMentionedUsers( $mentionedUsers, $newComment ); |
| [2449](#L2449) | } |
| [2450](#L2450) | $notifiyMe = absint( WpdiscuzHelper::sanitize( INPUT\_POST, "wpd\_inline\_notify\_me", FILTER\_SANITIZE\_NUMBER\_INT, 0 ) ); |
| [2451](#L2451) | if ( ! $isAnonymous && $notifiyMe ) { |
| [2452](#L2452) | $noNeedMemberConfirm = ( $currentUser->ID && ! $this->options->subscription["enableMemberConfirm"] ); |
| [2453](#L2453) | $noNeedGuestsConfirm = ( ! $currentUser->ID && ! $this->options->subscription["enableGuestsConfirm"] ); |
| [2454](#L2454) | if ( $noNeedMemberConfirm || $noNeedGuestsConfirm ) { |
| [2455](#L2455) | $this->dbManager->addEmailNotification( $new\_comment\_id, $inline\_form->post\_id, $email, self::SUBSCRIPTION\_COMMENT, 1 ); |
| [2456](#L2456) | } else { |
| [2457](#L2457) | $confirmData = $this->dbManager->addEmailNotification( $new\_comment\_id, $inline\_form->post\_id, $email, self::SUBSCRIPTION\_COMMENT ); |
| [2458](#L2458) | if ( $confirmData ) { |
| [2459](#L2459) | $this->helperEmail->confirmEmailSender( $confirmData["id"], $confirmData["activation\_key"], $inline\_form->post\_id, $email ); |
| [2460](#L2460) | } |
| [2461](#L2461) | } |
| [2462](#L2462) | } |
| [2463](#L2463) | if ( $newComment->comment\_approved === "spam" || $newComment->comment\_approved === "trash" ) { |
| [2464](#L2464) | wp\_send\_json\_error(); |
| [2465](#L2465) | } |
| [2466](#L2466) | $response                                      = []; |
| [2467](#L2467) | $commentListArgs                               = $this->getCommentListArgs( $inline\_form->post\_id ); |
| [2468](#L2468) | $response["message"]                           = wp\_list\_comments( $commentListArgs, [ $newComment ] ); |
| [2469](#L2469) | $response["newCount"]                          = esc\_html( get\_comments( $args ) ); |
| [2470](#L2470) | $response["new\_comment\_id"]                    = $new\_comment\_id; |
| [2471](#L2471) | $response["notification"]                      = esc\_html( $this->options->getPhrase( "wc\_feedback\_comment\_success" ) ); |
| [2472](#L2472) | $response["allCommentsCountNew"]               = get\_comments\_number( $inline\_form->post\_id ); |
| [2473](#L2473) | $response["allCommentsCountBeforeThreadsHtml"] = "<span class='wpdtc' title='" . esc\_attr( $response["allCommentsCountNew"] ) . "'>" . esc\_html( $this->helper->getNumber( $response["allCommentsCountNew"] ) ) . "</span> " . esc\_html( apply\_filters( "wpdiscuz\_comment\_count\_phrase", ( 1 == $response["allCommentsCountNew"] ? $this->form->getHeaderTextSingle() : $this->form->getHeaderTextPlural() ), $response["allCommentsCountNew"] ) ); |
| [2474](#L2474) | $response["allCommentsCountBubbleHtml"]        = "<span id='wpd-bubble-all-comments-count'" . ( $response["allCommentsCountNew"] ? "" : " style='display:none;'" ) . " title='" . esc\_attr( $response["allCommentsCountNew"] ) . "'>" . esc\_html( $this->helper->getNumber( $response["allCommentsCountNew"] ) ) . "</span>"; |
| [2475](#L2475) | do\_action( "wpdiscuz\_clean\_post\_cache", $inline\_form->post\_id, "inline\_comment\_posted" ); |
| [2476](#L2476) | do\_action( "wpdiscuz\_clean\_post\_cache", $inline\_form->post\_id, "comment\_posted" ); |
| [2477](#L2477) | do\_action( "wpdiscuz\_reset\_comments\_cache", $inline\_form->post\_id ); |
| [2478](#L2478) | wp\_send\_json\_success( $response ); |
| [2479](#L2479) | } else { |
| [2480](#L2480) | wp\_send\_json\_error( "wc\_invalid\_field" ); |
| [2481](#L2481) | } |
| [2482](#L2482) | } |
| [2483](#L2483) | } |
| [2484](#L2484) | } |
| [2485](#L2485) | wp\_send\_json\_error( "wc\_msg\_required\_fields" ); |
| [2486](#L2486) | } |
| [2487](#L2487) |  |
| [2488](#L2488) | public function validateRecaptcha( $commentdata ) { |
| [2489](#L2489) | if ( ! current\_user\_can( "moderate\_comments" ) ) { |
| [2490](#L2490) | $postId = WpdiscuzHelper::sanitize( INPUT\_POST, "postId", FILTER\_SANITIZE\_NUMBER\_INT, "" ); |
| [2491](#L2491) | if ( ! $postId ) { |
| [2492](#L2492) | global $post; |
| [2493](#L2493) | if ( ! empty( $post->ID ) ) { |
| [2494](#L2494) | $postId = $post->ID; |
| [2495](#L2495) | } else if ( ! empty( $commentdata["comment\_post\_ID"] ) ) { |
| [2496](#L2496) | $postId = $commentdata["comment\_post\_ID"]; |
| [2497](#L2497) | } |
| [2498](#L2498) | } |
| [2499](#L2499) | if ( $postId && ( $post = get\_post( $postId ) ) ) { |
| [2500](#L2500) | $form = $this->wpdiscuzForm->getForm( $postId ); |
| [2501](#L2501) | if ( $form->getFormID() ) { |
| [2502](#L2502) | $currentUser = WpdiscuzHelper::getCurrentUser(); |
| [2503](#L2503) | if ( empty( $currentUser->ID ) || ( ! empty( $currentUser->ID ) && $currentUser->ID != $post->post\_author ) ) { |
| [2504](#L2504) | $inlineVerified = wp\_verify\_nonce( WpdiscuzHelper::sanitize( INPUT\_POST, "\_wpd\_inline\_nonce", "FILTER\_SANITIZE\_STRING" ), "wpd\_inline\_nonce\_" . $postId ); |
| [2505](#L2505) | if ( ! $inlineVerified ) { |
| [2506](#L2506) | if ( apply\_filters( "wpdiscuz\_verify\_recaptcha", true, $commentdata ) ) { |
| [2507](#L2507) | $typesExclude = [ "pingback", "trackback" ]; |
| [2508](#L2508) | if ( ! empty( $commentdata["comment\_type"] ) && in\_array( $commentdata["comment\_type"], $typesExclude ) ) { |
| [2509](#L2509) | return $commentdata; |
| [2510](#L2510) | } |
| [2511](#L2511) | $form->initFormFields(); |
| [2512](#L2512) | $form->validateDefaultCaptcha( $currentUser ); |
| [2513](#L2513) | } |
| [2514](#L2514) | } |
| [2515](#L2515) | } |
| [2516](#L2516) | } |
| [2517](#L2517) | } |
| [2518](#L2518) | } |
| [2519](#L2519) |  |
| [2520](#L2520) | return $commentdata; |
| [2521](#L2521) | } |
| [2522](#L2522) |  |
| [2523](#L2523) | public function validateWebSite( $commentdata ) { |
| [2524](#L2524) | $postId = $commentdata["comment\_post\_ID"]; |
| [2525](#L2525) | if ( ! $postId ) { |
| [2526](#L2526) | return $commentdata; |
| [2527](#L2527) | } |
| [2528](#L2528) |  |
| [2529](#L2529) | $form = $this->wpdiscuzForm->getForm( $postId ); |
| [2530](#L2530) | if ( $form->getFormID() ) { |
| [2531](#L2531) | $formFields = $form->getFormFields(); |
| [2532](#L2532) | if ( isset( $formFields["wc\_website"] ) && $formFields["wc\_website"]["enable"] !== 1 ) { |
| [2533](#L2533) | $commentdata["comment\_author\_url"] = ""; |
| [2534](#L2534) | } |
| [2535](#L2535) | } |
| [2536](#L2536) |  |
| [2537](#L2537) | return $commentdata; |
| [2538](#L2538) | } |
| [2539](#L2539) |  |
| [2540](#L2540) | /\*\* |
| [2541](#L2541) | \* @param $admin\_bar WP\_Admin\_Bar |
| [2542](#L2542) | \* @return void |
| [2543](#L2543) | \*/ |
| [2544](#L2544) | public function addToolbarItems( $admin\_bar ) { |
| [2545](#L2545) | if ( $this->isWpdiscuzLoaded && current\_user\_can( "manage\_options" ) ) { |
| [2546](#L2546) | $admin\_bar->add\_menu( [ |
| [2547](#L2547) | "id"    => self::PAGE\_WPDISCUZ, |
| [2548](#L2548) | "title" => "wpDiscuz", |
| [2549](#L2549) | "href"  => esc\_url\_raw( admin\_url( "admin.php?page=" . self::PAGE\_WPDISCUZ ) ), |
| [2550](#L2550) | "meta"  => [ |
| [2551](#L2551) | "title"  => "wpDiscuz", |
| [2552](#L2552) | "target" => "\_blank", |
| [2553](#L2553) | ], |
| [2554](#L2554) | ] ); |
| [2555](#L2555) | $admin\_bar->add\_menu( [ |
| [2556](#L2556) | "id"     => self::PAGE\_WPDISCUZ . "-child", |
| [2557](#L2557) | "parent" => self::PAGE\_WPDISCUZ, |
| [2558](#L2558) | "title"  => esc\_html\_\_( "Dashboard", "wpdiscuz" ), |
| [2559](#L2559) | "href"   => esc\_url\_raw( admin\_url( "admin.php?page=" . self::PAGE\_WPDISCUZ ) ), |
| [2560](#L2560) | "meta"   => [ |
| [2561](#L2561) | "title"  => esc\_html\_\_( "Dashboard", "wpdiscuz" ), |
| [2562](#L2562) | "target" => "\_blank", |
| [2563](#L2563) | ], |
| [2564](#L2564) | ] ); |
| [2565](#L2565) | $admin\_bar->add\_menu( [ |
| [2566](#L2566) | "id"     => self::PAGE\_SETTINGS, |
| [2567](#L2567) | "parent" => self::PAGE\_WPDISCUZ, |
| [2568](#L2568) | "title"  => esc\_html\_\_( "Settings", "wpdiscuz" ), |
| [2569](#L2569) | "href"   => esc\_url\_raw( admin\_url( "admin.php?page=" . self::PAGE\_SETTINGS ) ), |
| [2570](#L2570) | "meta"   => [ |
| [2571](#L2571) | "title"  => esc\_html\_\_( "Settings", "wpdiscuz" ), |
| [2572](#L2572) | "target" => "\_blank", |
| [2573](#L2573) | ], |
| [2574](#L2574) | ] ); |
| [2575](#L2575) | if ( ! $this->options->general["isUsePoMo"] ) { |
| [2576](#L2576) | $admin\_bar->add\_menu( [ |
| [2577](#L2577) | "id"     => self::PAGE\_PHRASES, |
| [2578](#L2578) | "parent" => self::PAGE\_WPDISCUZ, |
| [2579](#L2579) | "title"  => esc\_html\_\_( "Phrases", "wpdiscuz" ), |
| [2580](#L2580) | "href"   => esc\_url\_raw( admin\_url( "admin.php?page=" . self::PAGE\_PHRASES ) ), |
| [2581](#L2581) | "meta"   => [ |
| [2582](#L2582) | "title"  => esc\_html\_\_( "Phrases", "wpdiscuz" ), |
| [2583](#L2583) | "target" => "\_blank", |
| [2584](#L2584) | ], |
| [2585](#L2585) | ] ); |
| [2586](#L2586) | } |
| [2587](#L2587) | $admin\_bar->add\_menu( [ |
| [2588](#L2588) | "id"     => self::PAGE\_TOOLS, |
| [2589](#L2589) | "parent" => self::PAGE\_WPDISCUZ, |
| [2590](#L2590) | "title"  => esc\_html\_\_( "Tools", "wpdiscuz" ), |
| [2591](#L2591) | "href"   => esc\_url\_raw( admin\_url( "admin.php?page=" . self::PAGE\_TOOLS ) ), |
| [2592](#L2592) | "meta"   => [ |
| [2593](#L2593) | "title"  => esc\_html\_\_( "Tools", "wpdiscuz" ), |
| [2594](#L2594) | "target" => "\_blank", |
| [2595](#L2595) | ], |
| [2596](#L2596) | ] ); |
| [2597](#L2597) | $admin\_bar->add\_menu( [ |
| [2598](#L2598) | "id"     => self::PAGE\_ADDONS, |
| [2599](#L2599) | "parent" => self::PAGE\_WPDISCUZ, |
| [2600](#L2600) | "title"  => esc\_html\_\_( "Addons", "wpdiscuz" ), |
| [2601](#L2601) | "href"   => esc\_url\_raw( admin\_url( "admin.php?page=" . self::PAGE\_ADDONS ) ), |
| [2602](#L2602) | "meta"   => [ |
| [2603](#L2603) | "title"  => esc\_html\_\_( "Addons", "wpdiscuz" ), |
| [2604](#L2604) | "target" => "\_blank", |
| [2605](#L2605) | ], |
| [2606](#L2606) | ] ); |
| [2607](#L2607) | if ( $this->options->general["isCacheEnabled"] ) { |
| [2608](#L2608) | $admin\_bar->add\_menu( [ |
| [2609](#L2609) | "id"     => "purgeAllCaches", |
| [2610](#L2610) | "parent" => self::PAGE\_WPDISCUZ, |
| [2611](#L2611) | "title"  => esc\_html\_\_( "Purge All Caches", "wpdiscuz" ), |
| [2612](#L2612) | "href"   => esc\_url\_raw( wp\_nonce\_url( admin\_url( "admin-post.php?action=purgeAllCaches" ), "purgeAllCaches" ) ), |
| [2613](#L2613) | "meta"   => [ |
| [2614](#L2614) | "title" => esc\_html\_\_( "Purge All Caches", "wpdiscuz" ), |
| [2615](#L2615) | ], |
| [2616](#L2616) | ] ); |
| [2617](#L2617) | global $post; |
| [2618](#L2618) | if ( ! empty( $post->ID ) ) { |
| [2619](#L2619) | $admin\_bar->add\_menu( [ |
| [2620](#L2620) | "id"     => "purgePostCaches", |
| [2621](#L2621) | "parent" => self::PAGE\_WPDISCUZ, |
| [2622](#L2622) | "title"  => esc\_html\_\_( "Purge This Url Caches", "wpdiscuz" ), |
| [2623](#L2623) | "href"   => esc\_url\_raw( wp\_nonce\_url( admin\_url( "admin-post.php?action=purgePostCaches&post\_id=" . $post->ID ), "purgePostCaches" ) ), |
| [2624](#L2624) | "meta"   => [ |
| [2625](#L2625) | "title" => esc\_html\_\_( "Purge All Caches", "wpdiscuz" ), |
| [2626](#L2626) | ], |
| [2627](#L2627) | ] ); |
| [2628](#L2628) | } |
| [2629](#L2629) | } |
| [2630](#L2630) | } |
| [2631](#L2631) | } |
| [2632](#L2632) |  |
| [2633](#L2633) | /\*\* |
| [2634](#L2634) | \* @return WpdiscuzOptions |
| [2635](#L2635) | \*/ |
| [2636](#L2636) | public function getOptions() { |
| [2637](#L2637) | return $this->options; |
| [2638](#L2638) | } |
| [2639](#L2639) |  |
| [2640](#L2640) | public function wpdiscuzShortcode() { |
| [2641](#L2641) | global $post; |
| [2642](#L2642) | $html = ""; |
| [2643](#L2643) | $form = $this->wpdiscuzForm->getForm( $post->ID ); |
| [2644](#L2644) | $form->initFormFields(); |
| [2645](#L2645) | if ( apply\_filters( "is\_load\_wpdiscuz", $form->getFormID() && ( comments\_open( $post ) || $post->comment\_count ) && is\_singular() && post\_type\_supports( $post->post\_type, "comments" ), $post ) ) { |
| [2646](#L2646) | ob\_start(); |
| [2647](#L2647) | include ABSPATH . "wp-content/plugins/wpdiscuz/themes/default/comment-form.php"; |
| [2648](#L2648) | $html = ob\_get\_clean(); |
| [2649](#L2649) | } elseif ( is\_single() || is\_page() ) { |
| [2650](#L2650) | if ( comments\_open() || get\_comments\_number() ) { |
| [2651](#L2651) | ob\_start(); |
| [2652](#L2652) | add\_filter( 'deprecated\_file\_trigger\_error', '\_\_return\_false' ); |
| [2653](#L2653) | comments\_template(); |
| [2654](#L2654) | remove\_filter( 'deprecated\_file\_trigger\_error', '\_\_return\_false' ); |
| [2655](#L2655) | $html = ob\_get\_clean(); |
| [2656](#L2656) | } |
| [2657](#L2657) | } |
| [2658](#L2658) |  |
| [2659](#L2659) | return $html; |
| [2660](#L2660) | } |
| [2661](#L2661) |  |
| [2662](#L2662) | public function replaceDefaultCommentBlock( $settings, $name ) { |
| [2663](#L2663) | if ( $name == 'core/comments' ) { |
| [2664](#L2664) | $settings['render\_callback'] = [ &$this, 'renderBlockWpdiscuz' ]; |
| [2665](#L2665) | } |
| [2666](#L2666) |  |
| [2667](#L2667) | return $settings; |
| [2668](#L2668) | } |
| [2669](#L2669) |  |
| [2670](#L2670) | public function wpdiscuzBlockInit() { |
| [2671](#L2671) | register\_block\_type( \_\_DIR\_\_ . "/assets/block", [ "render\_callback" => [ &$this, "renderBlockWpdiscuz" ] ] ); |
| [2672](#L2672) | } |
| [2673](#L2673) |  |
| [2674](#L2674) | public function renderBlockWpdiscuz( $attributes, $content, $block ) { |
| [2675](#L2675) | global $post; |
| [2676](#L2676) | $post\_id = isset( $block->context['postId'] ) ? $block->context['postId'] : 0; |
| [2677](#L2677) | $context = isset( $\_GET['context'] ) ? $\_GET['context'] : ''; |
| [2678](#L2678) | ob\_start(); |
| [2679](#L2679) | if ( $context === 'edit' ) { |
| [2680](#L2680) | $editBlockNotice = wp\_kses\_post( \_\_( 'This is just a demo of wpDiscuz comment section.<br> |
| [2681](#L2681) | Further customization can be done in the Dashboard > wpDiscuz > Settings admin page.<br> |
| [2682](#L2682) | The comment form layout can be customized in the Dashboard > wpDiscuz > Forms admin page.', 'wpdiscuz' ) ); |
| [2683](#L2683) | if ( $post\_id ) { |
| [2684](#L2684) | $post\_before = $post; |
| [2685](#L2685) | $post        = get\_post( $post\_id ); |
| [2686](#L2686) | $form        = $this->wpdiscuzForm->getForm( $post\_id ); |
| [2687](#L2687) | $form->initFormFields(); |
| [2688](#L2688) | if ( ! apply\_filters( "is\_load\_wpdiscuz", $form->getFormID() && ( comments\_open( $post ) || $post->comment\_count ) && post\_type\_supports( $post->post\_type, "comments" ), $post ) ) { |
| [2689](#L2689) | echo '<div class="wpdiscuz-edit-bloc-notice block-editor-warning">' . esc\_html\_\_( 'wpDiscuz is not loaded for the following reason.', 'wpdiscuz' ); |
| [2690](#L2690) | if ( ! post\_type\_supports( $post->post\_type, "comments" ) ) { |
| [2691](#L2691) | echo '<br>' . esc\_html\_\_( 'The post type doesn\'t support comments.', 'wpdiscuz' ); |
| [2692](#L2692) | } else if ( ! comments\_open( $post ) ) { |
| [2693](#L2693) | echo '<br>' . esc\_html\_\_( 'The comments are closed for the post.', 'wpdiscuz' ); |
| [2694](#L2694) | } else { |
| [2695](#L2695) | echo '<br>' . esc\_html\_\_( 'The post type is not enabled in the "Display comment form for post types" section.', 'wpdiscuz' ); |
| [2696](#L2696) | } |
| [2697](#L2697) | echo '</div>'; |
| [2698](#L2698) | } else { |
| [2699](#L2699) | echo '<div class="wpdiscuz-edit-bloc-notice block-editor-warning">' . $editBlockNotice . '</div>'; |
| [2700](#L2700) | include \_\_DIR\_\_ . "/themes/default/comment-form.php"; |
| [2701](#L2701) | } |
| [2702](#L2702) | $post = $post\_before; |
| [2703](#L2703) | } else { |
| [2704](#L2704) | echo '<div class="wpdiscuz-edit-bloc-notice block-editor-warning">' . $editBlockNotice . '</div>'; |
| [2705](#L2705) | include \_\_DIR\_\_ . "/themes/default/demo.php"; |
| [2706](#L2706) | } |
| [2707](#L2707) | } else { |
| [2708](#L2708) | if ( $post\_id ) { |
| [2709](#L2709) | $post\_before = $post; |
| [2710](#L2710) | $post        = get\_post( $post\_id ); |
| [2711](#L2711) | setup\_postdata( $post ); |
| [2712](#L2712) | $form = $this->wpdiscuzForm->getForm( $post\_id ); |
| [2713](#L2713) | $form->initFormFields(); |
| [2714](#L2714) | if ( apply\_filters( "is\_load\_wpdiscuz", $form->getFormID() && ( comments\_open( $post ) || $post->comment\_count ) && is\_singular() && post\_type\_supports( $post->post\_type, "comments" ), $post ) ) { |
| [2715](#L2715) | add\_filter( 'deprecated\_file\_trigger\_error', '\_\_return\_false' ); |
| [2716](#L2716) | comments\_template(); |
| [2717](#L2717) | remove\_filter( 'deprecated\_file\_trigger\_error', '\_\_return\_false' ); |
| [2718](#L2718) | } |
| [2719](#L2719) | $post = $post\_before; |
| [2720](#L2720) | } |
| [2721](#L2721) | } |
| [2722](#L2722) | $output            = ob\_get\_clean(); |
| [2723](#L2723) | $wrapperAttributes = get\_block\_wrapper\_attributes(); |
| [2724](#L2724) |  |
| [2725](#L2725) | return sprintf( '<div %1$s><div>%2$s</div></div>', $wrapperAttributes, $output ); |
| [2726](#L2726) | } |
| [2727](#L2727) |  |
| [2728](#L2728) | } |
| [2729](#L2729) |  |
| [2730](#L2730) | $wpdiscuz = wpDiscuz(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/wpdiscuz/trunk/class.WpdiscuzCore.php?format=txt)
* [Original Format](/export/3222433/wpdiscuz/trunk/class.WpdiscuzCore.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_1b63ae8f_20250114_181934.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Comments – wpDiscuz <= 7.6.21 - Unauthenticated HTML Injection

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Comments – wpDiscuz <= 7.6.21 - Unauthenticated HTML Injection

5.3

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

| CVE | [CVE-2024-6704](https://www.cve.org/CVERecord?id=CVE-2024-6704) |
| --- | --- |
| CVSS | 5.3 (Medium) |
| Publicly Published | August 1, 2024 |
| Last Updated | August 2, 2024 |
| Researcher | [Tieu Pham Trong Nhan - TechlabCorp](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/tieu-nhan) |

### Description

The Comments – wpDiscuz plugin for WordPress is vulnerable to HTML Injection in all versions up to, and including, 7.6.21. This is due to a lack of filtering of HTML tags in comments. This makes it possible for unauthenticated attackers to add HTML such as hyperlinks to comments when rich editing is disabled.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/wpdiscuz/trunk/class.WpdiscuzCore.php#L335)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3124810/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpdiscuz%2Fcomments-wpdiscuz-7621-unauthenticated-html-injection&t=Comments%20%E2%80%93%20wpDiscuz%20%3C%3D%207.6.21%20-%20Unauthenticated%20HTML%20Injection "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpdiscuz%2Fcomments-wpdiscuz-7621-unauthenticated-html-injection&text=Comments%20%E2%80%93%20wpDiscuz%20%3C%3D%207.6.21%20-%20Unauthenticated%20HTML%20Injection "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fwpdiscuz%2Fcomments-wpdiscuz-7621-unauthenticated-html-injection "LinkedIn")
Email

## Vulnerability Details for Comments – wpDiscuz

#### [Comments – wpDiscuz](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/wpdiscuz)

| Software Type | Plugin |
| --- | --- |
| Software Slug | wpdiscuz [(view on wordpress.org)](https://wordpress.org/plugins/wpdiscuz) |
| Patched? | Yes |
| Remediation | Update to version 7.6.22, or a newer patched version |
| Affected Version | * <= 7.6.21 |
| Patched Version | * 7.6.22 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_8c77997d_20250114_181932.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3124810)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3124809 "Changeset 3124809")
* [Next Changeset](/changeset/3124811 "Changeset 3124811") →

---

# Changeset 3124810

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
07/24/2024 06:07:00 PM
([6 months](/timeline?from=2024-07-24T18%3A07%3A00Z&precision=second "See timeline at 07/24/2024 06:07:00 PM") ago)

Author:
AdvancedCoding
Message:
# Comments - wpDiscuz v7.6.22 - 24.07.2024

* Added: A new hook "wpdiscuz\_generate\_thumbnails\_check" to disable thumbnails generation cron
* Added: A new JS event on comment post "wpdiscuz\_comment\_posted"
* Fixed: Filtering buttons now visible if there is at least one comment
* Fixed: Security issue, if reach editor and quick tags are disabled clean all HTML from comment content

Location:
[wpdiscuz](/browser/wpdiscuz?rev=3124810)
Files:

665 added
9 edited

* [tags/7.6.22](/browser/wpdiscuz/tags/7.6.22?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets](/browser/wpdiscuz/tags/7.6.22/assets?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons](/browser/wpdiscuz/tags/7.6.22/assets/addons?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/ads-manager](/browser/wpdiscuz/tags/7.6.22/assets/addons/ads-manager?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/ads-manager/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/ads-manager/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/ads-manager/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/ads-manager/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/author-info](/browser/wpdiscuz/tags/7.6.22/assets/addons/author-info?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/author-info/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/author-info/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/author-info/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/author-info/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/avatarmanager](/browser/wpdiscuz/tags/7.6.22/assets/addons/avatarmanager?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/avatarmanager/avatar-manager.jpg](/browser/wpdiscuz/tags/7.6.22/assets/addons/avatarmanager/avatar-manager.jpg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/avatarmanager/avatar-manager1.jpg](/browser/wpdiscuz/tags/7.6.22/assets/addons/avatarmanager/avatar-manager1.jpg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/buddypress](/browser/wpdiscuz/tags/7.6.22/assets/addons/buddypress?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/buddypress/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/buddypress/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/buddypress/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/buddypress/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/bundle](/browser/wpdiscuz/tags/7.6.22/assets/addons/bundle?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/bundle/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/bundle/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/bundle/wpdiscuz-bundle.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/bundle/wpdiscuz-bundle.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/censure](/browser/wpdiscuz/tags/7.6.22/assets/addons/censure?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/censure/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/censure/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/censure/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/censure/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/embeds](/browser/wpdiscuz/tags/7.6.22/assets/addons/embeds?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/embeds/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/embeds/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/embeds/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/embeds/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/emoticons](/browser/wpdiscuz/tags/7.6.22/assets/addons/emoticons?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/emoticons/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/emoticons/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/emoticons/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/emoticons/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/frontend-moderation](/browser/wpdiscuz/tags/7.6.22/assets/addons/frontend-moderation?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/frontend-moderation/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/frontend-moderation/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/frontend-moderation/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/frontend-moderation/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/giphy](/browser/wpdiscuz/tags/7.6.22/assets/addons/giphy?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/giphy/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/giphy/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/giphy/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/giphy/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/likers](/browser/wpdiscuz/tags/7.6.22/assets/addons/likers?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/likers/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/likers/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/likers/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/likers/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/mycred](/browser/wpdiscuz/tags/7.6.22/assets/addons/mycred?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/mycred/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/mycred/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/mycred/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/mycred/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/notifications](/browser/wpdiscuz/tags/7.6.22/assets/addons/notifications?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/notifications/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/notifications/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/notifications/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/notifications/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/online-users](/browser/wpdiscuz/tags/7.6.22/assets/addons/online-users?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/online-users/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/online-users/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/online-users/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/online-users/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/private](/browser/wpdiscuz/tags/7.6.22/assets/addons/private?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/private/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/private/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/private/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/private/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/recaptcha](/browser/wpdiscuz/tags/7.6.22/assets/addons/recaptcha?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/recaptcha/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/recaptcha/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/recaptcha/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/recaptcha/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/report](/browser/wpdiscuz/tags/7.6.22/assets/addons/report?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/report/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/report/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/report/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/report/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/search](/browser/wpdiscuz/tags/7.6.22/assets/addons/search?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/search/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/search/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/search/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/search/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/subscriptions](/browser/wpdiscuz/tags/7.6.22/assets/addons/subscriptions?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/subscriptions/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/subscriptions/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/subscriptions/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/subscriptions/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/syntax](/browser/wpdiscuz/tags/7.6.22/assets/addons/syntax?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/syntax/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/syntax/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/syntax/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/syntax/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/tenor](/browser/wpdiscuz/tags/7.6.22/assets/addons/tenor?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/tenor/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/tenor/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/tenor/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/tenor/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/translate](/browser/wpdiscuz/tags/7.6.22/assets/addons/translate?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/translate/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/translate/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/translate/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/translate/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/uploader](/browser/wpdiscuz/tags/7.6.22/assets/addons/uploader?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/uploader/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/uploader/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/uploader/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/uploader/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/user-mention](/browser/wpdiscuz/tags/7.6.22/assets/addons/user-mention?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/user-mention/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/user-mention/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/user-mention/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/user-mention/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/voice](/browser/wpdiscuz/tags/7.6.22/assets/addons/voice?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/voice/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/voice/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/voice/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/voice/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/widgets](/browser/wpdiscuz/tags/7.6.22/assets/addons/widgets?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/widgets/header-off.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/widgets/header-off.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/addons/widgets/header.png](/browser/wpdiscuz/tags/7.6.22/assets/addons/widgets/header.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/block](/browser/wpdiscuz/tags/7.6.22/assets/block?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/block/block.json](/browser/wpdiscuz/tags/7.6.22/assets/block/block.json?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/block/index.asset.php](/browser/wpdiscuz/tags/7.6.22/assets/block/index.asset.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/block/index.js](/browser/wpdiscuz/tags/7.6.22/assets/block/index.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css](/browser/wpdiscuz/tags/7.6.22/assets/css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/icomoon.eot](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/icomoon.eot?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/icomoon.svg](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/icomoon.svg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/icomoon.ttf](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/icomoon.ttf?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/icomoon.woff](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/icomoon.woff?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/index.html](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/sqr721c-webfont.eot](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/sqr721c-webfont.eot?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/sqr721c-webfont.svg](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/sqr721c-webfont.svg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/sqr721c-webfont.ttf](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/sqr721c-webfont.ttf?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/sqr721c-webfont.woff](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/sqr721c-webfont.woff?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/fonts/sqr721c-webfont.woff2](/browser/wpdiscuz/tags/7.6.22/assets/css/fonts/sqr721c-webfont.woff2?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/index.html](/browser/wpdiscuz/tags/7.6.22/assets/css/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-combo-no\_quill.min.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-combo-no_quill.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-combo.min.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-combo.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-custom-form.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-custom-form.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-deactivation.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-deactivation.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-mu-backend.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-mu-backend.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-mu-frontend.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-mu-frontend.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-mu-frontend.min.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-mu-frontend.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-options.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-options.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-ratings-rtl.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-ratings-rtl.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-ratings-rtl.min.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-ratings-rtl.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-ratings.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-ratings.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-ratings.min.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-ratings.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-shortcode-for-elementor.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-shortcode-for-elementor.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-user-content.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-user-content.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/css/wpdiscuz-user-content.min.css](/browser/wpdiscuz/tags/7.6.22/assets/css/wpdiscuz-user-content.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img](/browser/wpdiscuz/tags/7.6.22/assets/img?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/captcha-loading.png](/browser/wpdiscuz/tags/7.6.22/assets/img/captcha-loading.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/addon.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/addon.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/arrow-right.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/arrow-right.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-badges.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-badges.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-bubble.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-bubble.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-content.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-content.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-email.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-email.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-feedback.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-feedback.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-forms.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-forms.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-general.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-general.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-layouts.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-layouts.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-login.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-login.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-moderation.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-moderation.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-rating.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-rating.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-recaptcha.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-recaptcha.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-social.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-social.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-styles.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-styles.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/box-threads.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/box-threads.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/bubble-invite-to-comment.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/bubble-invite-to-comment.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/bubble-location-left.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/bubble-location-left.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/bubble-location-right.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/bubble-location-right.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/bubble-location-side.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/bubble-location-side.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/bubble-new-comment-info.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/bubble-new-comment-info.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/cancel.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/cancel.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/cog.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/cog.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/dots.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/dots.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/icon-comment-inlinepng.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/icon-comment-inlinepng.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/icon-comment.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/icon-comment.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/icon-guests.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/icon-guests.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/icon-replies.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/icon-replies.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/icon-threads.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/icon-threads.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/icon-users.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/icon-users.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/index.html](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/inline-feedback-closed.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/inline-feedback-closed.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/inline-feedback-opened.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/inline-feedback-opened.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/inline-feedback-toolbar-button-vertical.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/inline-feedback-toolbar-button-vertical.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/inline-feedback-toolbar-button.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/inline-feedback-toolbar-button.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/layout-1.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/layout-1.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/layout-1s.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/layout-1s.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/layout-2.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/layout-2.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/layout-2s.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/layout-2s.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/layout-3.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/layout-3.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/layout-3s.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/layout-3s.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/new-feature.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/new-feature.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/new.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/new.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/bubble-invite-to-comment.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/bubble-invite-to-comment.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/bubble-new-comment-info.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/bubble-new-comment-info.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/feedback-form.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/feedback-form.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/icon-bubble.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/icon-bubble.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/icon-feedback.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/icon-feedback.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/icon-layouts.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/icon-layouts.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/icon-rating.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/icon-rating.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/icon-social.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/icon-social.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/rating-vs-v.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/rating-vs-v.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/rating-vs.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/rating-vs.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/social-networks-shadow.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/social-networks-shadow.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/news/wpDiscuz-Social-Network-icons-on-user-avatars.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/news/wpDiscuz-Social-Network-icons-on-user-avatars.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/note.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/note.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/ok.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/ok.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/rating.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/rating.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/solved.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/solved.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/warning.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/warning.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/dashboard/wpdiscuz-7-logo.png](/browser/wpdiscuz/tags/7.6.22/assets/img/dashboard/wpdiscuz-7-logo.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/delete.png](/browser/wpdiscuz/tags/7.6.22/assets/img/delete.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/demo-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/demo-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/demo.png](/browser/wpdiscuz/tags/7.6.22/assets/img/demo.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/editor](/browser/wpdiscuz/tags/7.6.22/assets/img/editor?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/editor/active.png](/browser/wpdiscuz/tags/7.6.22/assets/img/editor/active.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/editor/attachment.png](/browser/wpdiscuz/tags/7.6.22/assets/img/editor/attachment.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/editor/passive.png](/browser/wpdiscuz/tags/7.6.22/assets/img/editor/passive.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/file-icons](/browser/wpdiscuz/tags/7.6.22/assets/img/file-icons?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/file-icons/delete.png](/browser/wpdiscuz/tags/7.6.22/assets/img/file-icons/delete.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/file-icons/file-type.png](/browser/wpdiscuz/tags/7.6.22/assets/img/file-icons/file-type.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/file-icons/index.html](/browser/wpdiscuz/tags/7.6.22/assets/img/file-icons/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/file-icons/video-audio-type.png](/browser/wpdiscuz/tags/7.6.22/assets/img/file-icons/video-audio-type.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/form-loading.gif](/browser/wpdiscuz/tags/7.6.22/assets/img/form-loading.gif?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/gc](/browser/wpdiscuz/tags/7.6.22/assets/img/gc?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/gc/5s.png](/browser/wpdiscuz/tags/7.6.22/assets/img/gc/5s.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/gc/index.html](/browser/wpdiscuz/tags/7.6.22/assets/img/gc/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/icon-link.gif](/browser/wpdiscuz/tags/7.6.22/assets/img/icon-link.gif?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/index.html](/browser/wpdiscuz/tags/7.6.22/assets/img/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/loading.gif](/browser/wpdiscuz/tags/7.6.22/assets/img/loading.gif?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/plugin-icon](/browser/wpdiscuz/tags/7.6.22/assets/img/plugin-icon?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/plugin-icon/icon\_info.png](/browser/wpdiscuz/tags/7.6.22/assets/img/plugin-icon/icon_info.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/plugin-icon/index.html](/browser/wpdiscuz/tags/7.6.22/assets/img/plugin-icon/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/plugin-icon/plugin-icon-48.png](/browser/wpdiscuz/tags/7.6.22/assets/img/plugin-icon/plugin-icon-48.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/shortcode.png](/browser/wpdiscuz/tags/7.6.22/assets/img/shortcode.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/baidu.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/baidu.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/dq-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/dq-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/fb-18x18-orig.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/fb-18x18-orig.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/fb-18x18.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/fb-18x18.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/fb-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/fb-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/g-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/g-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/gg-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/gg-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/google-18x18-orig.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/google-18x18-orig.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/google-18x18.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/google-18x18.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/ig-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/ig-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/in-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/in-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/index.html](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/mr-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/mr-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/ok-18x18-orig.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/ok-18x18-orig.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/ok-18x18.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/ok-18x18.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/ok-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/ok-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/qq.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/qq.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/telegram.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/telegram.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/tw-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/tw-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/twitter-18x18-orig.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/twitter-18x18-orig.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/twitter-18x18.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/twitter-18x18.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/vk-18x18-orig.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/vk-18x18-orig.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/vk-18x18.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/vk-18x18.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/vk-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/vk-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/wapp-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/wapp-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/wechat.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/wechat.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/weibo.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/weibo.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/wp-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/wp-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/x-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/x-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/social-icons/ya-m.png](/browser/wpdiscuz/tags/7.6.22/assets/img/social-icons/ya-m.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/thumbs-down.png](/browser/wpdiscuz/tags/7.6.22/assets/img/thumbs-down.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/thumbs-up.png](/browser/wpdiscuz/tags/7.6.22/assets/img/thumbs-up.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/tips](/browser/wpdiscuz/tags/7.6.22/assets/img/tips?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/tips/custom-form.png](/browser/wpdiscuz/tags/7.6.22/assets/img/tips/custom-form.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/img/trackback.png](/browser/wpdiscuz/tags/7.6.22/assets/img/trackback.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js](/browser/wpdiscuz/tags/7.6.22/assets/js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/index.html](/browser/wpdiscuz/tags/7.6.22/assets/js/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/prepros.config](/browser/wpdiscuz/tags/7.6.22/assets/js/prepros.config?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpd-editor.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpd-editor.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpd-editor.min.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpd-editor.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-admin-menu-item.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-admin-menu-item.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-combo-no\_quill.min.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-combo-no_quill.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-combo.min.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-combo.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-custom-form.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-custom-form.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-deactivation.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-deactivation.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-mu-backend.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-mu-backend.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-mu-frontend.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-mu-frontend.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-mu-frontend.min.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-mu-frontend.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-notes.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-notes.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-options.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-options.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-shortcode-for-elementor.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-shortcode-for-elementor.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-shortcode-gutenberg.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-shortcode-gutenberg.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-shortcode-tinymce.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-shortcode-tinymce.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-social.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-social.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-social.min.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-social.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-user-content.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-user-content.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz-user-content.min.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz-user-content.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/js/wpdiscuz.min.js](/browser/wpdiscuz/tags/7.6.22/assets/js/wpdiscuz.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party](/browser/wpdiscuz/tags/7.6.22/assets/third-party?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/autogrow](/browser/wpdiscuz/tags/7.6.22/assets/third-party/autogrow?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/autogrow/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/autogrow/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/autogrow/jquery.autogrowtextarea.min.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/autogrow/jquery.autogrowtextarea.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/chart](/browser/wpdiscuz/tags/7.6.22/assets/third-party/chart?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/chart/chart.min.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/chart/chart.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/colorbox.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/colorbox.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/colorbox.min.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/colorbox.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/images](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/images?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/images/border.png](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/images/border.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/images/controls.png](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/images/controls.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/images/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/images/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/images/loading.gif](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/images/loading.gif?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/images/loading\_background.png](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/images/loading_background.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/images/overlay.png](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/images/overlay.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/jquery.colorbox.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/jquery.colorbox.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/colorbox/jquery.colorbox.min.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/colorbox/jquery.colorbox.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/contenthover](/browser/wpdiscuz/tags/7.6.22/assets/third-party/contenthover?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/contenthover/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/contenthover/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/contenthover/jquery.contenthover.min.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/contenthover/jquery.contenthover.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/MIT-license](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/MIT-license?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/css/easy-responsive-tabs.min.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/css/easy-responsive-tabs.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/css/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/css/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/js/easy-responsive-tabs.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/js/easy-responsive-tabs.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/js/easy-responsive-tabs.min.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/js/easy-responsive-tabs.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/easy-responsive-tabs/js/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/easy-responsive-tabs/js/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/LICENSE.txt](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/LICENSE.txt?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/css/fa.min.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/css/fa.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/css/fontawesome-all.min.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/css/fontawesome-all.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/css/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/css/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.eot](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.eot?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.svg](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.svg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.ttf](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.ttf?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.woff](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.woff?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.woff2](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-brands-400.woff2?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.eot](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.eot?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.svg](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.svg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.ttf](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.ttf?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.woff](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.woff?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.woff2](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-regular-400.woff2?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.eot](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.eot?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.svg](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.svg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.ttf](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.ttf?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.woff](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.woff?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.woff2](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/fa-solid-900.woff2?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/font-awesome-5.13.0/webfonts/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker/css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker/css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker/css/fontawesome-iconpicker.min.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker/css/fontawesome-iconpicker.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker/css/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker/css/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker/js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker/js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker/js/fontawesome-iconpicker.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker/js/fontawesome-iconpicker.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/fontawesome-iconpicker/js/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/fontawesome-iconpicker/js/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/lity](/browser/wpdiscuz/tags/7.6.22/assets/third-party/lity?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/lity/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/lity/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/lity/lity.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/lity/lity.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/lity/lity.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/lity/lity.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/lity/lity.min.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/lity/lity.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quicktags](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quicktags?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quicktags/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quicktags/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quicktags/wpdiscuz-quictags.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quicktags/wpdiscuz-quictags.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quill](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quill?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quill/quill.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quill/quill.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quill/quill.min.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quill/quill.min.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quill/quill.snow.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quill/quill.snow.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/quill/quill.snow.min.css](/browser/wpdiscuz/tags/7.6.22/assets/third-party/quill/quill.snow.min.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/wpdccjs](/browser/wpdiscuz/tags/7.6.22/assets/third-party/wpdccjs?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/wpdccjs/index.html](/browser/wpdiscuz/tags/7.6.22/assets/third-party/wpdccjs/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/assets/third-party/wpdccjs/wpdcc.js](/browser/wpdiscuz/tags/7.6.22/assets/third-party/wpdccjs/wpdcc.js?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/class.WpdiscuzCore.php](/browser/wpdiscuz/tags/7.6.22/class.WpdiscuzCore.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms](/browser/wpdiscuz/tags/7.6.22/forms?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/autoload.php](/browser/wpdiscuz/tags/7.6.22/forms/autoload.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpDiscuzForm.php](/browser/wpdiscuz/tags/7.6.22/forms/wpDiscuzForm.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/AgreementCheckbox.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/AgreementCheckbox.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/CheckboxField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/CheckboxField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/ColorField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/ColorField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/CookiesConsent.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/CookiesConsent.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DateField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DateField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Captcha.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Captcha.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Email.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Email.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Name.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Name.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/ReCaptcha.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/ReCaptcha.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/Curl.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/Curl.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/CurlPost.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/CurlPost.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/Post.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/Post.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/Socket.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/Socket.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/SocketPost.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestMethod/SocketPost.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestParameters.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/RequestParameters.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/Response.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/ReCaptcha/Response.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Submit.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Submit.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Website.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/DefaultField/Website.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/Field.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/Field.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/HTMLField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/HTMLField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/NumberField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/NumberField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/RadioField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/RadioField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/RatingField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/RatingField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/SelectField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/SelectField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/TextAreaField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/TextAreaField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/TextField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/TextField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Field/UrlField.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Field/UrlField.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Form.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Form.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/FormConst](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/FormConst?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/FormConst/wpdFormConst.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/FormConst/wpdFormConst.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/SocialLogin.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/SocialLogin.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/Utils.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/Utils.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Config.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Config.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Consumer.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Consumer.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/HmacSha1.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/HmacSha1.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Request.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Request.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Response.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Response.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/SignatureMethod.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/SignatureMethod.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Token.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Token.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/TwitterOAuth.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/TwitterOAuth.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/TwitterOAuthException.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/TwitterOAuthException.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Util](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Util?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Util.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Util.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/Util/JsonDecoder.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/Util/JsonDecoder.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Login/twitter/cacert.pem](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Login/twitter/cacert.pem?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Row.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Row.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Tools](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Tools?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Tools/PersonalDataExporter.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Tools/PersonalDataExporter.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/Tools/Sanitizer.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/Tools/Sanitizer.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/html](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/html/admin-form-fields-list.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/html/admin-form-fields-list.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/forms/wpdFormAttr/html/default-fields.php](/browser/wpdiscuz/tags/7.6.22/forms/wpdFormAttr/html/default-fields.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/includes](/browser/wpdiscuz/tags/7.6.22/includes?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/includes/class.WpdiscuzDBManager.php](/browser/wpdiscuz/tags/7.6.22/includes/class.WpdiscuzDBManager.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/includes/class.WpdiscuzRest.php](/browser/wpdiscuz/tags/7.6.22/includes/class.WpdiscuzRest.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/includes/index.html](/browser/wpdiscuz/tags/7.6.22/includes/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/includes/interface.WpDiscuzConstants.php](/browser/wpdiscuz/tags/7.6.22/includes/interface.WpDiscuzConstants.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/index.html](/browser/wpdiscuz/tags/7.6.22/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages](/browser/wpdiscuz/tags/7.6.22/languages?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/index.html](/browser/wpdiscuz/tags/7.6.22/languages/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-ar.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-ar.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-ar.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-ar.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-de\_DE.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-de_DE.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-de\_DE.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-de_DE.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-eo.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-eo.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-eo.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-eo.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-fa\_IR.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-fa_IR.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-fa\_IR.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-fa_IR.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-fr\_FR.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-fr_FR.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-fr\_FR.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-fr_FR.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-he\_IL.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-he_IL.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-he\_IL.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-he_IL.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-hu\_HU.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-hu_HU.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-hu\_HU.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-hu_HU.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-hy.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-hy.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-hy.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-hy.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-it\_IT.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-it_IT.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-it\_IT.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-it_IT.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-nl\_NL.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-nl_NL.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-nl\_NL.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-nl_NL.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-pl\_PL.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-pl_PL.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-pl\_PL.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-pl_PL.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-pt\_BR.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-pt_BR.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-pt\_BR.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-pt_BR.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-pt\_PT.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-pt_PT.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-pt\_PT.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-pt_PT.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-ru\_RU.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-ru_RU.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-ru\_RU.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-ru_RU.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-tr\_TR.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-tr_TR.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-tr\_TR.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-tr_TR.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-uk.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-uk.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-uk.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-uk.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-zh\_CN.mo](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-zh_CN.mo?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz-zh\_CN.po](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz-zh_CN.po?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz.pot](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz.pot?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/languages/wpdiscuz.pot\_\_OLD](/browser/wpdiscuz/tags/7.6.22/languages/wpdiscuz.pot__OLD?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options](/browser/wpdiscuz/tags/7.6.22/options?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons](/browser/wpdiscuz/tags/7.6.22/options/addons?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/al](/browser/wpdiscuz/tags/7.6.22/options/addons/al?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/al/content.php](/browser/wpdiscuz/tags/7.6.22/options/addons/al/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/al/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/al/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/al/title.php](/browser/wpdiscuz/tags/7.6.22/options/addons/al/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/cai](/browser/wpdiscuz/tags/7.6.22/options/addons/cai?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/cai/content.php](/browser/wpdiscuz/tags/7.6.22/options/addons/cai/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/cai/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/cai/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/cai/title.php](/browser/wpdiscuz/tags/7.6.22/options/addons/cai/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/fem](/browser/wpdiscuz/tags/7.6.22/options/addons/fem?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/fem/content.php](/browser/wpdiscuz/tags/7.6.22/options/addons/fem/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/fem/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/fem/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/fem/title.php](/browser/wpdiscuz/tags/7.6.22/options/addons/fem/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images](/browser/wpdiscuz/tags/7.6.22/options/addons/images?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/embedded-content.png](/browser/wpdiscuz/tags/7.6.22/options/addons/images/embedded-content.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/file.png](/browser/wpdiscuz/tags/7.6.22/options/addons/images/file.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/html5-audio-player.png](/browser/wpdiscuz/tags/7.6.22/options/addons/images/html5-audio-player.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/html5-video-player.png](/browser/wpdiscuz/tags/7.6.22/options/addons/images/html5-video-player.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/html5-youtub-player.png](/browser/wpdiscuz/tags/7.6.22/options/addons/images/html5-youtub-player.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/image.png](/browser/wpdiscuz/tags/7.6.22/options/addons/images/image.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/images/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/images/video.png](/browser/wpdiscuz/tags/7.6.22/options/addons/images/video.png?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/more](/browser/wpdiscuz/tags/7.6.22/options/addons/more?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/more/content.php](/browser/wpdiscuz/tags/7.6.22/options/addons/more/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/more/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/more/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/more/title.php](/browser/wpdiscuz/tags/7.6.22/options/addons/more/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/mu](/browser/wpdiscuz/tags/7.6.22/options/addons/mu?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/mu/content.php](/browser/wpdiscuz/tags/7.6.22/options/addons/mu/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/mu/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/mu/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/mu/title.php](/browser/wpdiscuz/tags/7.6.22/options/addons/mu/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/raf](/browser/wpdiscuz/tags/7.6.22/options/addons/raf?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/raf/content.php](/browser/wpdiscuz/tags/7.6.22/options/addons/raf/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/raf/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/raf/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/raf/title.php](/browser/wpdiscuz/tags/7.6.22/options/addons/raf/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/ucm](/browser/wpdiscuz/tags/7.6.22/options/addons/ucm?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/ucm/content.php](/browser/wpdiscuz/tags/7.6.22/options/addons/ucm/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/ucm/index.html](/browser/wpdiscuz/tags/7.6.22/options/addons/ucm/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/addons/ucm/title.php](/browser/wpdiscuz/tags/7.6.22/options/addons/ucm/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/class.WpdiscuzAddons.php](/browser/wpdiscuz/tags/7.6.22/options/class.WpdiscuzAddons.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/class.WpdiscuzOptions.php](/browser/wpdiscuz/tags/7.6.22/options/class.WpdiscuzOptions.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/html-addons.php](/browser/wpdiscuz/tags/7.6.22/options/html-addons.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/html-dashboard.php](/browser/wpdiscuz/tags/7.6.22/options/html-dashboard.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/html-options.php](/browser/wpdiscuz/tags/7.6.22/options/html-options.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/html-phrases.php](/browser/wpdiscuz/tags/7.6.22/options/html-phrases.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/html-tools.php](/browser/wpdiscuz/tags/7.6.22/options/html-tools.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/index.html](/browser/wpdiscuz/tags/7.6.22/options/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts](/browser/wpdiscuz/tags/7.6.22/options/options-layouts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-content.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-form.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-form.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-general.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-general.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-inline.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-inline.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-labels.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-labels.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-live.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-live.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-login.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-login.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-moderation.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-moderation.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-rating.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-rating.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-recaptcha.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-recaptcha.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-social.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-social.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-subscription.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-subscription.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-thread\_display.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-thread_display.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-thread\_layouts.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-thread_layouts.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/html-thread\_styles.php](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/html-thread_styles.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/options-layouts/index.html](/browser/wpdiscuz/tags/7.6.22/options/options-layouts/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/index.html](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-comment.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-comment.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-datetime.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-datetime.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-email.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-email.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-error.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-error.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-follow.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-follow.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-form.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-form.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-general.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-general.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-media.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-media.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-notification.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-notification.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-social-login.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-social-login.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/phrases-layouts/phrases-user-settings.php](/browser/wpdiscuz/tags/7.6.22/options/phrases-layouts/phrases-user-settings.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts/tool-database.php](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts/tool-database.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts/tool-images.php](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts/tool-images.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts/tool-options.php](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts/tool-options.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts/tool-phrases.php](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts/tool-phrases.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts/tool-ratings.php](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts/tool-ratings.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts/tool-regenerate.php](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts/tool-regenerate.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/options/tools-layouts/tool-subscriptions.php](/browser/wpdiscuz/tags/7.6.22/options/tools-layouts/tool-subscriptions.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/readme.txt](/browser/wpdiscuz/tags/7.6.22/readme.txt?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes](/browser/wpdiscuz/tags/7.6.22/themes?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default](/browser/wpdiscuz/tags/7.6.22/themes/default?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/class.WpdiscuzWalker.php](/browser/wpdiscuz/tags/7.6.22/themes/default/class.WpdiscuzWalker.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/comment-form.php](/browser/wpdiscuz/tags/7.6.22/themes/default/comment-form.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css](/browser/wpdiscuz/tags/7.6.22/themes/default/css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/fonts](/browser/wpdiscuz/tags/7.6.22/themes/default/css/fonts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/fonts/index.html](/browser/wpdiscuz/tags/7.6.22/themes/default/css/fonts/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.eot](/browser/wpdiscuz/tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.eot?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.svg](/browser/wpdiscuz/tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.svg?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.ttf](/browser/wpdiscuz/tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.ttf?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.woff](/browser/wpdiscuz/tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.woff?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.woff2](/browser/wpdiscuz/tags/7.6.22/themes/default/css/fonts/sqr721c-webfont.woff2?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/css/index.html](/browser/wpdiscuz/tags/7.6.22/themes/default/css/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/demo.php](/browser/wpdiscuz/tags/7.6.22/themes/default/demo.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/index.html](/browser/wpdiscuz/tags/7.6.22/themes/default/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/author.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/author.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/avatar.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/avatar.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/date.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/date.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/follow.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/follow.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/footer.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/footer.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/header.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/header.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/index.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/label.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/label.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/left.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/left.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/link.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/link.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/reply.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/reply.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/reply\_to.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/reply_to.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/right.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/right.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/share.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/share.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/status.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/status.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/text.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/text.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/toggle.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/toggle.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/tools.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/tools.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/vote.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/vote.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/1/wrapper.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/1/wrapper.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/author.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/author.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/avatar.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/avatar.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/date.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/date.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/follow.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/follow.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/footer.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/footer.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/header.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/header.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/index.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/label.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/label.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/link.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/link.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/reply.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/reply.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/reply\_to.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/reply_to.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/right.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/right.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/share.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/share.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/status.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/status.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/text.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/text.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/toggle.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/toggle.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/tools.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/tools.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/user\_info.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/user_info.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/user\_info\_bottom.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/user_info_bottom.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/user\_info\_top.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/user_info_top.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/vote.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/vote.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/2/wrapper.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/2/wrapper.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/author.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/author.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/avatar.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/avatar.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/date.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/date.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/follow.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/follow.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/footer.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/footer.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/header.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/header.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/index.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/label.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/label.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/left.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/left.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/link.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/link.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/reply.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/reply.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/reply\_to.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/reply_to.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/right.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/right.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/share.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/share.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/status.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/status.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/subheader.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/subheader.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/text.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/text.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/toggle.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/toggle.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/tools.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/tools.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/tools\_wrap.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/tools_wrap.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/vote.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/vote.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/3/wrapper.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/3/wrapper.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/layouts/index.html](/browser/wpdiscuz/tags/7.6.22/themes/default/layouts/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/prepros.config](/browser/wpdiscuz/tags/7.6.22/themes/default/prepros.config?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/style-minimal-rtl.css](/browser/wpdiscuz/tags/7.6.22/themes/default/style-minimal-rtl.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/style-minimal.css](/browser/wpdiscuz/tags/7.6.22/themes/default/style-minimal.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/style-rtl.css](/browser/wpdiscuz/tags/7.6.22/themes/default/style-rtl.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/default/style.css](/browser/wpdiscuz/tags/7.6.22/themes/default/style.css?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/index.html](/browser/wpdiscuz/tags/7.6.22/themes/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/themes/unsubscription.php](/browser/wpdiscuz/tags/7.6.22/themes/unsubscription.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils](/browser/wpdiscuz/tags/7.6.22/utils?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/WpdiscuzElementorIntegration.php](/browser/wpdiscuz/tags/7.6.22/utils/WpdiscuzElementorIntegration.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/ajax](/browser/wpdiscuz/tags/7.6.22/utils/ajax?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/ajax/index.html](/browser/wpdiscuz/tags/7.6.22/utils/ajax/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/ajax/wpdiscuz-ajax.php](/browser/wpdiscuz/tags/7.6.22/utils/ajax/wpdiscuz-ajax.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/class.WpdiscuzCache.php](/browser/wpdiscuz/tags/7.6.22/utils/class.WpdiscuzCache.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/class.WpdiscuzHelper.php](/browser/wpdiscuz/tags/7.6.22/utils/class.WpdiscuzHelper.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/class.WpdiscuzHelperAjax.php](/browser/wpdiscuz/tags/7.6.22/utils/class.WpdiscuzHelperAjax.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/class.WpdiscuzHelperEmail.php](/browser/wpdiscuz/tags/7.6.22/utils/class.WpdiscuzHelperEmail.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/class.WpdiscuzHelperOptimization.php](/browser/wpdiscuz/tags/7.6.22/utils/class.WpdiscuzHelperOptimization.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/class.WpdiscuzHelperUpload.php](/browser/wpdiscuz/tags/7.6.22/utils/class.WpdiscuzHelperUpload.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/deactivation-reason-modal.php](/browser/wpdiscuz/tags/7.6.22/utils/deactivation-reason-modal.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/functions.php](/browser/wpdiscuz/tags/7.6.22/utils/functions.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/index.html](/browser/wpdiscuz/tags/7.6.22/utils/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts](/browser/wpdiscuz/tags/7.6.22/utils/layouts?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/activity](/browser/wpdiscuz/tags/7.6.22/utils/layouts/activity?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/activity/activity-page.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/activity/activity-page.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/activity/content.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/activity/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/activity/index.html](/browser/wpdiscuz/tags/7.6.22/utils/layouts/activity/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/activity/item.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/activity/item.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/activity/title.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/activity/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/follows](/browser/wpdiscuz/tags/7.6.22/utils/layouts/follows?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/follows/content.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/follows/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/follows/follows-page.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/follows/follows-page.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/follows/index.html](/browser/wpdiscuz/tags/7.6.22/utils/layouts/follows/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/follows/item.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/follows/item.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/follows/title.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/follows/title.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/index.html](/browser/wpdiscuz/tags/7.6.22/utils/layouts/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/pagination.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/pagination.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/subscriptions](/browser/wpdiscuz/tags/7.6.22/utils/layouts/subscriptions?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/subscriptions/content.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/subscriptions/content.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/subscriptions/index.html](/browser/wpdiscuz/tags/7.6.22/utils/layouts/subscriptions/index.html?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/subscriptions/item.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/subscriptions/item.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/subscriptions/subscriptions-page.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/subscriptions/subscriptions-page.php?rev=3124810 "Show entry in browser")
  (added)
* [tags/7.6.22/utils/layouts/subscriptions/title.php](/browser/wpdiscuz/tags/7.6.22/utils/layouts/subscriptions/title.php?rev=3124810 "Show entry in browser")
  (added)
* [trunk/assets/js/wpdiscuz-combo-no\_quill.min.js](/browser/wpdiscuz/trunk/assets/js/wpdiscuz-combo-no_quill.min.js?rev=3124810 "Show entry in browser")
  (modified)
  ([1 diff](#file664 "Show differences"))
* [trunk/assets/js/wpdiscuz-combo.min.js](/browser/wpdiscuz/trunk/assets/js/wpdiscuz-combo.min.js?rev=3124810 "Show entry in browser")
  (modified)
  ([1 diff](#file665 "Show differences"))
* [trunk/assets/js/wpdiscuz.js](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.js?rev=3124810 "Show entry in browser")
  (modified)
  ([2 diffs](#file666 "Show differences"))
* [trunk/assets/js/wpdiscuz.min.js](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.min.js?rev=3124810 "Show entry in browser")
  (modified)
  ([1 diff](#file667 "Show differences"))
* [trunk/class.WpdiscuzCore.php](/browser/wpdiscuz/trunk/class.WpdiscuzCore.php?rev=3124810 "Show entry in browser")
  (modified)
  ([1 diff](#file668 "Show differences"))
* [trunk/readme.txt](/browser/wpdiscuz/trunk/readme.txt?rev=3124810 "Show entry in browser")
  (modified)
  ([2 diffs](#file669 "Show differences"))
* [trunk/themes/default/comment-form.php](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810 "Show entry in browser")
  (modified)
  ([11 diffs](#file670 "Show differences"))
* [trunk/themes/default/prepros.config](/browser/wpdiscuz/trunk/themes/default/prepros.config?rev=3124810 "Show entry in browser")
  (added)
* [trunk/utils/class.WpdiscuzHelper.php](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810 "Show entry in browser")
  (modified)
  ([101 diffs](#file672 "Show differences"))
* [trunk/utils/class.WpdiscuzHelperUpload.php](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php?rev=3124810 "Show entry in browser")
  (modified)
  ([2 diffs](#file673 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [wpdiscuz/trunk/assets/js/wpdiscuz-combo-no\_quill.min.js](/changeset/3124810/wpdiscuz/trunk/assets/js/wpdiscuz-combo-no_quill.min.js "Show the changeset 3124810 restricted to wpdiscuz/trunk/assets/js/wpdiscuz-combo-no_quill.min.js")

  | [r3106072](/browser/wpdiscuz/trunk/assets/js/wpdiscuz-combo-no_quill.min.js?rev=3106072#L4 "Show revision 3106072 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/assets/js/wpdiscuz-combo-no_quill.min.js?rev=3124810#L4 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | jQuery.fn.autoGrow=function(){return this.each(function(){var createMirror=function(textarea){jQuery(textarea).after('<div class="autogrow-textarea-mirror"></div>');return jQuery(textarea).next(".autogrow-textarea-mirror")[0]};var sendContentToMirror=function(textarea){mirror.innerHTML=String(textarea.value).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />")+".<br/>.";if(jQuery(textarea).height()!=jQuery(mirror).height())jQuery(textarea).height(jQuery(mirror).height())};var growTextarea=function(){sendContentToMirror(this)};var mirror=createMirror(this);mirror.style.display="none";mirror.style.wordWrap="break-word";mirror.style.padding=jQuery(this).css("padding");mirror.style.width=jQuery(this).css("width");mirror.style.fontFamily=jQuery(this).css("font-family");mirror.style.fontSize=jQuery(this).css("font-size");mirror.style.lineHeight=jQuery(this).css("line-height");this.style.overflow="hidden";this.style.minHeight=this.rows+"em";this.onkeydown=growTextarea;sendContentToMirror(this)})}; |
  | 5 | 5 | /\* wpDiscuz \*/ |
  | 6 |  | var wpdiscuzLoadRichEditor=parseInt(wpdiscuzAjaxObj.loadRichEditor);if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap"))var wpDiscuzEditor=new WpdEditor;function wpdMessagesOnInit(e,t){wpdiscuzAjaxObj.setCommentMessage(e,t),setTimeout((function(){location.href=location.href.substring(0,location.href.indexOf("wpdiscuzUrlAnchor")-1)}),3e3)}wpdiscuzAjaxObj.setCommentMessage=function(e,t,a){var o="wpdiscuz-message-error";if(e instanceof Array)for(var n in e)t instanceof Array?"success"===t[n]?o="wpdiscuz-message-success":"warning"===t[n]&&(o="wpdiscuz-message-warning"):"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e[n]).prependTo("#wpdiscuz-comment-message").delay(a instanceof Array?a[n]:a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}));else"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e).prependTo("#wpdiscuz-comment-message").delay(a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}))},wpdiscuzAjaxObj.applyFilterOnPhrase=function(e,t,a){return wpdiscuzAjaxObj.phraseFilters&&jQuery.each(wpdiscuzAjaxObj.phraseFilters,(function(o){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]]&&(e=wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]](e,t,a))})),e},jQuery(document).ready((function(e){e("body").addClass("wpdiscuz\_"+wpdiscuzAjaxObj.version);var t=wpdiscuzAjaxObj.is\_user\_logged\_in,a=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!t,o=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&t,n=wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion,i=parseInt(wpdiscuzAjaxObj.commentListLoadType),d=parseInt(wpdiscuzAjaxObj.wc\_post\_id),s=parseInt(wpdiscuzAjaxObj.commentListUpdateType),c=1e3\*parseInt(wpdiscuzAjaxObj.commentListUpdateTimer),p=parseInt(wpdiscuzAjaxObj.liveUpdateGuests),r=wpdiscuzAjaxObj.loadLastCommentId,l=r,m=parseInt(wpdiscuzAjaxObj.firstLoadWithAjax);Cookies.get("wpdiscuz\_comments\_sorting")&&Cookies.remove("wpdiscuz\_comments\_sorting",{path:""}),Cookies.get("wordpress\_last\_visit")&&Cookies.remove("wordpress\_last\_visit",{path:""}),Cookies.get("wpdiscuz\_last\_visit")&&Cookies.remove("wpdiscuz\_last\_visit",{path:""});var w,u=parseInt(wpdiscuzAjaxObj.wordpressIsPaginate),f=wpdiscuzAjaxObj.storeCommenterData,h=(parseInt(wpdiscuzAjaxObj.wmuEnabled),wpdiscuzAjaxObj.isCookiesEnabled),b=!0,\_=wpdiscuzAjaxObj.cookiehash,g=parseInt(wpdiscuzAjaxObj.isLoadOnlyParentComments),z=parseInt(wpdiscuzAjaxObj.enableDropAnimation)?500:0,v=parseInt(wpdiscuzAjaxObj.isNativeAjaxEnabled),j=parseInt(wpdiscuzAjaxObj.enableBubble),x=parseInt(wpdiscuzAjaxObj.bubbleLiveUpdate),C=parseInt(wpdiscuzAjaxObj.bubbleHintTimeout),y=parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout)?parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout):5,k=parseInt(wpdiscuzAjaxObj.bubbleShowNewCommentMessage),O=wpdiscuzAjaxObj.bubbleLocation,A=wpdiscuzAjaxObj.inlineFeedbackAttractionType,I=(I=parseInt(wpdiscuzAjaxObj.scrollSize))||32,T=[],D=[],E=[],F=!1,M=1,L=e("html").css("scroll-behavior"),R=e("body").css("scroll-behavior");(e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").length?e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").length?e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .social\_connect\_form").length?e(".wc\_social\_plugin\_wrapper .social\_connect\_form").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .oneall\_social\_login\_providers").length&&e(".wc\_social\_plugin\_wrapper .oneall\_social\_login .oneall\_social\_login\_providers").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"),wpdiscuzLoadRichEditor&&e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0"),window.addEventListener("beforeunload",(function(t){var a=e(".wpd-form").not(":hidden");if(a.length)if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap")){for(var o=0;o<a.length;o++)if("\n"!==wpDiscuzEditor.createEditor(e(a[o]).find(".ql-container").attr("id")).getText())return t.preventDefault(),void(t.returnValue="")}else for(o=0;o<a.length;o++)if(e(a[o]).find(".wc\_comment").val())return t.preventDefault(),void(t.returnValue="")})),wpdiscuzLoadRichEditor||(e(document).delegate("textarea.wc\_comment","input",(function(){me(e(this))})),e.each(e("textarea.wc\_comment"),(function(){me(e(this))}))),e("body").on("focus","#wpdcom .ql-editor, #wpdcom .wc\_comment",(function(){e(".wpd-form-foot",e(this).parents(".wpd\_comm\_form")).slideDown(z)})),e("body").on("focus","#wpdcom textarea",(function(){e(this).next(".autogrow-textarea-mirror").length||e(this).autoGrow()})),t)||q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)});if(e(".wpd-vote-down.wpd-dislike-hidden").remove(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd"),e("body").on("click","#wpd-editor-source-code-wrapper-bg",(function(){e(this).hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),wpdiscuzLoadRichEditor&&e("body").on("click","#wpd-insert-source-code",(function(){var t=wpDiscuzEditor.createEditor("#"+e("#wpd-editor-uid").val());t.deleteText(0,t.getLength(),Quill.sources.USER);var a=e("#wpd-editor-source-code").val();a.length&&t.clipboard.dangerouslyPasteHTML(0,a,Quill.sources.USER),t.update(),e("#wpd-editor-source-code-wrapper-bg").hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),e("body").on("click",".wpd-reply-button",(function(){var i=$(e(this),0);e(this).hasClass("wpdiscuz-clonned")?(wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+i).focus()}),z):setTimeout((function(){e("#wc-textarea-"+i).trigger("focus")}),z),e("#wpd-secondary-form-wrapper-"+i).slideToggle(z)):function(a){var o=$(a,0);e("#wpdiscuz\_form\_anchor-"+o).before(function(t){return e("#wpdiscuz\_hidden\_secondary\_form").html().replace(/wpdiscuzuniqueid/g,t)}(o));var n=e("#wpd-secondary-form-wrapper-"+o);if(!t){q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)})}wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+o).focus()}),z):setTimeout((function(){e("#wc-textarea-"+o).trigger("focus")}),z);n.slideToggle(z,(function(){a.addClass("wpdiscuz-clonned")}))}(e(this)),function(t){if((a||o)&&"2.0"===n){var i=X(t);setTimeout((function(){if(!D[i])try{D[i]=grecaptcha.render("wpdiscuz-recaptcha-"+t,{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(a){e("#wpdiscuz-recaptcha-field-"+t).val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-"+t).val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3)}}(i)})),e("body").on("click","#wpdcom [data-wpd-clipboard]",(function(){var t=e(this).data("wpd-clipboard");e(this).data("wpd-ismention")&&(t="@"+t);var a=e("<input/>");a.appendTo("body").css({position:"absolute",top:"-10000000px"}).val(t),a.trigger("select"),document.execCommand("copy"),a.remove(),wpdiscuzAjaxObj.setCommentMessage(t+"<br/>"+wpdiscuzAjaxObj.wc\_copied\_to\_clipboard,"success",5e3)})),e("body").on("click",".wpdiscuz-nofollow,.wc\_captcha\_refresh\_img,.wpd-load-more-submit",(function(e){e.preventDefault()})),e("body").on("click",".wpd-toggle.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked");var a=$(e(this),0),o=e(this),n=e(".fas",o);!o.parents(".wpd-comment:not(.wpd-reply)").children(".wpd-reply").length&&g?function(t,a){var o=X(t),n=new FormData;n.append("action","wpdShowReplies"),n.append("commentId",o),ue(v,!0,n).done((function(o){a.addClass("wpd\_not\_clicked"),"object"==typeof o&&o.success&&(e("#wpd-comm-"+t).replaceWith(o.data.comment\_list),e("#wpd-comm-"+t+" .wpd-toggle .fas").removeClass("fa-chevron-down").addClass("fa-chevron-up"),e("#wpd-comm-"+t+" .wpd-toggle .wpd-view-replies .wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),e("#wpd-comm-"+t+" .wpd-toggle").attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text),we(o)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,o,n){console.log(n),a.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}(a,t):e("#wpd-comm-"+a+"> .wpd-reply").slideToggle(700,(function(){e(this).is(":hidden")?(n.removeClass("fa-chevron-up"),n.addClass("fa-chevron-down"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_show\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_show\_replies\_text)):(n.removeClass("fa-chevron-down"),n.addClass("fa-chevron-up"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text)),t.addClass("wpd\_not\_clicked")}))})),e("body").on("mouseenter",".wpd-new-loaded-comment",(function(){e(this).removeClass("wpd-new-loaded-comment")})),e("body").on("click",".wpd-sbs-toggle",(function(){e(".wpdiscuz-subscribe-bar").slideToggle(z)})),parseInt(wpdiscuzAjaxObj.wpDiscuzIsShowOnSubscribeForm)&&!t&&wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&e("#wpdiscuz-subscribe-form").length&&("2.0"===n?(setTimeout((function(){try{grecaptcha.render("wpdiscuz-recaptcha-subscribe-form",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-subscribe-form").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val()?e(".wpdiscuz-recaptcha",e(this)).css("border","none"):(e(".wpdiscuz-recaptcha",e(this)).css("border","1px solid red"),ee(e(this),""),t.preventDefault())}))):"3.0"===n&&e("body").on("click","#wpdiscuz\_subscription\_button",(function(t){var a=e(this).parents("#wpdiscuz-subscribe-form");ee(a,""),t.preventDefault();try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/wpdAddSubscription"}).then((function(e){document.getElementById("wpdiscuz-recaptcha-field-subscribe-form").value=e,a.trigger("submit")}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error")}}))),(a||o)&&"2.0"===n){var S=e(window).width(),H=e("#wpdcom").width();H>=1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"65%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"35%"})),H>=940&&H<1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"60%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"40%"})),H>=810&&H<940&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"60%"})),H>=730&&H<810&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"45%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"55%"})),H>=610&&H<730&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.85)","-webkit-transform":"scale(0.85)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"43%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"55%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"})),S>650&&(H>=510&&H<610&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"35%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"63%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%",position:"relative",right:"-60px"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H>=470&&H<510&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"60%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd\_main\_comm\_form .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H<470&&(e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({margin:"0px auto","transform-origin":"center 0","-webkit-transform-origin":"center 0"}),e("#wpdcom .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc\_notification\_checkboxes").css({"text-align":"center"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-field-submit").css({"text-align":"center"})))}function P(t,a,o){ue(v,!1,a).done((function(a){if(e(o).addClass("wpd\_not\_clicked"),"object"==typeof a)if(a.success){"collapsed"===wpdiscuzAjaxObj.commentFormView&&e(".wpd-form-foot",t).slideUp(z),a.data.wc\_all\_comments\_count\_new=parseInt(a.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(a.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(a.data.wc\_all\_comments\_count\_bubble\_html);var n=z;a.data.is\_main?oe(a.data.message):(n=z+700,e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).slideToggle(700),1==a.data.is\_in\_same\_container?e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).after(a.data.message):e("#wpd-comm-"+a.data.uniqueid).after(a.data.message)),function(e){if(!e.data.held\_moderate){var t=new FormData;t.append("action","wpdCheckNotificationType"),t.append("comment\_id",e.data.new\_comment\_id),t.append("email",e.data.comment\_author\_email),t.append("isParent",e.data.is\_main),ue(v,!0,t)}}(a),function(e){if(e.data.redirect>0&&e.data.new\_comment\_id){var t=new FormData;t.append("action","wpdRedirect"),t.append("commentId",e.data.new\_comment\_id),ue(v,!0,t).done((function(e){"object"==typeof e&&e.success&&setTimeout((function(){location.href=e.data}),2e3)})).fail((function(e,t,a){console.log(a)}))}}(a),h&&b?function(t){var a=t.comment\_author\_email,o=t.comment\_author,n=t.comment\_author\_url;null==f?(Cookies.set("comment\_author\_email\_"+\_,a),Cookies.set("comment\_author\_"+\_,o),n.length&&Cookies.set("comment\_author\_url\_"+\_,n)):(f=parseInt(f),Cookies.set("comment\_author\_email\_"+\_,a,{expires:f,path:"/"}),Cookies.set("comment\_author\_"+\_,o,{expires:f,path:"/"}),n.length&&Cookies.set("comment\_author\_url\_"+\_,n,{expires:f,path:"/"}));e(".wpd-cookies-checkbox").length&&e(".wpd-cookies-checkbox").prop("checked",!0)}(a.data):b||e(".wpd-cookies-checkbox").prop("checked",!1),t.get(0).reset(),wpdiscuzLoadRichEditor?wpDiscuzEditor.createEditor("#wpd-editor-"+e(".wpdiscuz\_unique\_id",t).val()).setContents([{insert:"\n"}]):me(t.find(".wc\_comment")),q(a.data),e(".wmu-preview-wrap",t).remove(),T.length&&(T.forEach((function(e){e.parents(".wpd-field-checkbox").remove()})),T=[]),parseInt(wpdiscuzAjaxObj.scrollToComment)&&setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.new\_comment\_id).offset().top-I},1e3,ae)}),n),we(a,t)~~}else a.data&&(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"),we(a,t));else wpdiscuzAjaxObj.setCommentMessage(a,"error");e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,n){console.log(n),e(o).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}function q(t){e(".wpd\_comm\_form .wc\_name").val(t.comment\_author),t.comment\_author\_email&&t.comment\_author\_email.indexOf("@example.com")<0&&e(".wpd\_comm\_form .wc\_email").val(t.comment\_author\_email),t.comment\_author\_url&&e(".wpd\_comm\_form .wc\_website").val(t.comment\_author\_url)}function U(t,a){e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").show(),e("#wpd-comm-"+t+" .wpdiscuz-edit-form-wrap").replaceWith(a),e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-last-edited").show()}e("body").on("click",".wc\_comm\_submit.wpd\_not\_clicked",(function(){var i=e(this),d=1,s=e(this).parents("form");if("true"!==s.attr("data-uploading")){if(s.hasClass("wpd\_main\_comm\_form")||(d=function(t){var a=t.attr("class").split(" "),o="";return e.each(a,(function(e,t){"wpd\_comment\_level"===Y(t,!1)&&(o=Y(t,!0))})),parseInt(o)+1}(e(this).parents(".wpd-comment"))),ee(s,"#wpd-editor-"+e(".wpdiscuz\_unique\_id",s).val()),s.on("submit",(function(e){e.preventDefault()})),s[0].checkValidity()&&(p=s,r=!0,"2.0"===n&&e("input[name=wc\_captcha]",p).length&&!e("input[name=wc\_captcha]",p).val().length?(r=!1,e(".wpdiscuz-recaptcha",p).css("border","1px solid red")):"2.0"===n&&e("input[name=wc\_captcha]",p).length&&e(".wpdiscuz-recaptcha",p).css("border","none"),r)){F=!0,function(t){e(".wpd-agreement-checkbox",t).each((function(){e(this).hasClass("wpd\_agreement\_hide")&&h&&e(this).prop("checked")&&(Cookies.set(e(this).attr("name")+"\_"+\_,1,{expires:30,path:"/"}),e("input[name="+e(this).attr("name")+"]").each((function(){T.push(e(this))})))}))}(s),e(i).removeClass("wpd\_not\_clicked");var c=new FormData;if(c.append("action","wpdAddComment"),e(":input",s).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&c.append(this.name+"",e(this).val().trim()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&c.append(this.name+"",e(this).val())})),c.append("wpd\_comment\_depth",d),wpdiscuzAjaxObj.wpdiscuz\_zs&&c.append("wpdiscuz\_zs",wpdiscuzAjaxObj.wpdiscuz\_zs),e(".wpd-cookies-checkbox",s).length?e(".wpd-cookies-checkbox",s).prop("checked")||(b=!1):t&&(b=!1),e("#wpdiscuz-loading-bar").show(),wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&"3.0"===n&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/addComment"}).then((function(e){c.append("g-recaptcha-response",e),P(s,c,i)}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)}else P(s,c,i)}var p,r;!function(e){if((a||o)&&"2.0"===n){var t=X(e);grecaptcha.reset(D[t])}}(e(".wpdiscuz\_unique\_id",s).val()),e(".wpdiscuz\_reset").val("")}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj.wmuPhraseDoingUpload,"wmuPhraseDoingUpload",s),"warning")})),e("body").on("click",".wpd\_editable\_comment",(function(){w&&e(".wpdiscuz-edit-form-wrap").length&&U($(e(".wpdiscuz-edit-form-wrap"),0),w);var t=e(this),a=$(t,0),o=X(a),n=new FormData;n.append("action","wpdEditComment"),n.append("commentId",o),w=e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-text").get(0),ue(v,!0,n).done((function(o){if("object"==typeof o)if(o.success){if(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text").replaceWith(o.data.html),wpdiscuzLoadRichEditor){var n=wpDiscuzEditor.createEditor("#wpd-editor-edit\_"+a);n.clipboard.dangerouslyPasteHTML(0,o.data.content),n.update(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd")}else e("#wc-textarea-edit\_"+a).val(o.data.content),me(e("#wc-textarea-edit\_"+a));e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").hide(),e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").hide()}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[o.data],o.data,t),"error");else console.log(o);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wc\_save\_edited\_comment",(function(){var t=e(this),a=$(t),o=X(a),n=e("#wpd-comm-"+a+" #wpdiscuz-edit-form");if(ee(n,"#wpd-editor-edit\_"+a),n.on("submit",(function(e){e.preventDefault()})),n[0].checkValidity()){var i=new FormData;i.append("action","wpdSaveEditedComment"),i.append("commentId",o),e(":input",n).each((function(){""!==this.name&&"checkbox"!==this.type&&"radio"!==this.type&&i.append(this.name+"",e(this).val()),"checkbox"!==this.type&&"radio"!==this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(n){"object"==typeof n?(n.success?(U(a,n.data.message),n.data.comment\_approved\_html&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-subheader").append(n.data.comment\_approved\_html),n.data.lastEdited&&(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").remove(),e(n.data.lastEdited).insertAfter("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text")),n.data.twitterShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_tw").attr("href",n.data.twitterShareLink),n.data.whatsappShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_whatsapp").attr("href",n.data.whatsappShareLink),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error"),we(n,o)):wpdiscuzAjaxObj.setCommentMessage(n,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("click",".wc\_cancel\_edit",(function(){var t=$(e(this));U(t,w),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+t)})),!u&&m&&(M=0,1==m?setTimeout((function(){V(!0)}),500):e("body").on("click",".wpd-load-comments",(function(){e(this).parent(".wpd-load-more-submit-wrap").remove(),V(!0)}))),e("body").on("click",".wpd-load-more-submit",(function(){var t=e(this),a="wpd-loaded";t.hasClass(a)&&V(!1,t,a,"wpd-loading")}));var W=!1;function B(){var t=document.getElementById("wpdiscuzHasMoreComments"),a=0;t&&(a=t.dataset.is\_show\_load\_more);var o=document.getElementById("wpdcom")?document.getElementById("wpdcom").clientHeight:0,n=e(window).height()+e(window).scrollTop();o&&n&&(100\*n/o>=80&&!1===W&&1==a&&(W=!0,V(!1,e(".wpd-load-more-submit"))))}function V(t,a,o,n){a&&(a.toggleClass(o),a.toggleClass(n));var d=new FormData;d.append("action","wpdLoadMoreComments");var s=e(".wpdiscuz-sort-button-active").attr("data-sorting");s&&d.append("sorting",s),d.append("offset",M),d.append("lastParentId",e(".wpd-load-more-submit").attr("data-lastparentid")),d.append("isFirstLoad",t?1:0);var c=e(".wpdf-active").attr("data-filter-type");d.append("wpdType",c||""),ue(v,!t||1!=m,d).done((function(d){"object"==typeof d&&d.success&&(M++,t&&e(".wpd-comment").remove(),e(".wpdiscuz\_single").remove(),e(".wpdiscuz-comment-pagination").before(d.data.comment\_list),K(d,t&&2!==i),W=!1,d.data.loadLastCommentId&&(r=d.data.loadLastCommentId),we(d),t&&Q(!1)),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))})).fail((function(t,i,d){console.log(d),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))}))}function K(t,a){var o,n=document.getElementById("wpdiscuzHasMoreComments");if(0==t.data.is\_show\_load\_more)n&&(n.dataset.is\_show\_load\_more=0),e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide();else if(o=t.data.last\_parent\_id,e(".wpd-load-more-submit").attr("data-lastparentid",o),2!==i&&e(".wpdiscuz-comment-pagination").show(),n&&(n.dataset.is\_show\_load\_more=1),a&&e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").show(),t.data.comments\_left>0){if(!e(".wpd-load-more-submit .wpd-comments-left").length){const t=e("<span>");t.addClass("wpd-comments-left"),e(".wpd-load-more-submit").append(t)}e(".wpd-load-more-submit .wpd-comments-left").text(t.data.comments\_left\_text)}we(t)}function Q(t){var a=location.href.match(/#comment\-(\d+)/);if(null!==a){var o=a[1];if(e("#comment-"+o).length)setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+o).parents("[id^=wpd-comm-]").offset().top-I},1e3,ae),t&&N(o)}),500);else{var n=new FormData;n.append("action","wpdGetSingleComment"),n.append("commentId",o),ue(v,!0,n).done((function(a){if("object"==typeof a&&a.success){var n="#comment-"+o;e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e(n).offset().top-I},1e3,ae),t&&N(o)}e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}}}function N(t){setTimeout((function(){e("#comment-"+t).siblings(".wpd-secondary-form-wrapper").is(":visible")||e("#comment-"+t).find(".wpd-reply-button").trigger("click")}),1100)}function G(e){if(void 0!==e.data.message)for(var t,a=e.data.message,o=0;o<a.length;o++)J((t=a[o]).comment\_parent,t.comment\_html)}function $(e,t){var a="";return(a=t?e.parents(".wpd-main-form-wrapper").attr("id"):e.parents(".wpd-comment").attr("id")).substring(a.lastIndexOf("-")+1)}function X(e){return e.substring(0,e.indexOf("\_"))}function Y(e,t){return t?e.substring(e.indexOf("-")+1):e.substring(0,e.indexOf("-"))}function J(t,a){if(0==t)oe(a);else{var o=$(e("#comment-"+t),0);e("#wpdiscuz\_form\_anchor-"+o).after(a)}}function Z(){var t=[];return e(".wpd-comment-right").each((function(){t.push(X($(e(this),0)))})),t.join(",")}function ee(t,a){var o=t.find(".wpd-required-group");wpdiscuzLoadRichEditor&&t.find(".wc\_comment").val(e(a+">.ql-editor").html()),function(e){if("wpdiscuz-subscribe-form"==e.attr("id"))return;var t=e.find(".wc\_comment"),a=t.val().trim().replace(/<p><br><\/p>/g,"\n").replace(/<p>(.\*?)<\/p>/g,"$1\n");a=(a=(a=(a=a.replace(/<img src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img[^>]+alt=["|']([^"|']+)["|'][^>]+src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'][^>]?>/g," $1 ")).replace(/<img\s+([^>]\*)class=["|']wpdem\-sticker["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img\s+([^>]\*)src=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $2 "),t.val(a)}(t),e.each(o,(function(){e("input",this).prop("required",!1),0===e("input:checked",this).length?e("input",e(this)).prop("required",!0):e(".wpd-field-invalid",this).remove()}))}function te(){e("html, body").css("scroll-behavior","unset")}function ae(){e("html").css("scroll-behavior",L),e("body").css("scroll-behavior",R)}function oe(t){e(".wpd-sticky-comment").last()[0]?e(t).insertAfter(e(".wpd-sticky-comment").last()[0]):e(".wpd-thread-list").prepend(t)}function ne(t){t?t.prop("required")||(t.val()?t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none")):e.each(e(".wc\_email"),(function(t,a){var o=e(a);o.prop("required")||(o.val()?o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none"))}))}if(2!==i||u||(e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide(),B(),e(window).scroll((function(){B()}))),wpdiscuzAjaxObj.setLoadMoreVisibility=K,e("body").on("click",".wpd-vote-up.wpd\_not\_clicked, .wpd-vote-down.wpd\_not\_clicked",(function(){var t=e(this);e(t).removeClass("wpd\_not\_clicked");var a,o=X($(t));a=e(this).hasClass("wpd-vote-up")?1:-1;var n=new FormData;n.append("action","wpdVoteOnComment"),n.append("commentId",o),n.append("voteType",a),ue(v,!0,n).done((function(n){if(e(t).addClass("wpd\_not\_clicked"),"object"==typeof n){if(n.success){if("total"===n.data.buttonsStyle){var i=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result"),d=n.data.votes;i.text(n.data.votesHumanReadable),i.attr("title",d),i.removeClass("wpd-up wpd-down"),d>0&&i.addClass("wpd-up"),d<0&&i.addClass("wpd-down")}else{var s=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-like"),c=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-dislike");s.text(n.data.likeCountHumanReadable),s.attr("title",n.data.likeCount),c.text(n.data.dislikeCountHumanReadable),c.attr("title",n.data.dislikeCount),parseInt(n.data.likeCount)>0?s.addClass("wpd-up"):s.removeClass("wpd-up"),parseInt(n.data.dislikeCount)<0?c.addClass("wpd-down"):c.removeClass("wpd-down")}var p=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-up"),r=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-down");p.removeClass("wpd-up"),r.removeClass("wpd-down"),n.data.curUserReaction>0?p.addClass("wpd-up"):n.data.curUserReaction<0&&r.addClass("wpd-down")}else n.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error");we(n,o,a)}else console.log(n);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(t).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e(document).on("click","body",(function(t){var a=e(".wpdiscuz-sort-buttons");e(t.target).hasClass("wpdf-sorting")||e(t.target).parent().hasClass("wpdf-sorting")?a.css({display:a.is(":visible")?"none":"flex"}):a.hide()})),e("body").on("click",".wpdiscuz-sort-button:not(.wpdiscuz-sort-button-active)",(function(){var t=e(this),a=e(this).attr("data-sorting");if(a){e(".wpd-load-comments").parents(".wpd-load-more-submit-wrap").remove(),e(".wpdiscuz-sort-button.wpdiscuz-sort-button-active").removeClass("wpdiscuz-sort-button-active").appendTo(".wpdiscuz-sort-buttons"),t.addClass("wpdiscuz-sort-button-active").prependTo(".wpdf-sorting");var o=new FormData;o.append("action","wpdSorting"),o.append("sorting",a);var n=e(".wpdf-active").attr("data-filter-type");o.append("wpdType",n||""),ue(v,!0,o).done((function(t){"object"==typeof t&&t.success&&(e("#wpdcom .wpd-comment").remove(),e("#wpdcom .wpd-thread-list").prepend(t.data.message),K(t,!1),M=1),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),window.onhashchange=function(){Q(!1)},1!=m&&Q(!1),e("body").on("click",".wpdiscuz-readmore",(function(){var t=$(e(this)),a=X(t),o=new FormData;o.append("action","wpdReadMore"),o.append("commentId",a),ue(v,!0,o).done((function(o){"object"==typeof o?(o.success?(e("#comment-"+a+" .wpd-comment-text").replaceWith(" "+o.data.message),e("#wpdiscuz-readmore-"+t).remove()):console.log(o.data),we(o)):console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("change",".wpd-required-group",(function(){0!==e("input:checked",this).length?e("input",e(this)).prop("required",!1):e("input",e(this)).prop("required",!0)})),e("body").on("click",".wpdiscuz-spoiler",(function(){e(this).next().slideToggle(),e(this).hasClass("wpdiscuz-spoiler-closed")?e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"):e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),e(this).toggleClass("wpdiscuz-spoiler-closed")})),e("body").on("click",".wpd-tools",(function(){var t=e(".wpd-tools-actions",e(this));t.is(":visible")||e(this).parents(".wpd-comment-right").attr("id")!==e("[id^=comment-]","#wpdcom").last().attr("id")||e("#comments").css({paddingBottom:"160px"}),t.css({display:t.is(":visible")?"none":"flex"})})),e("body").on("mouseleave",".wpd-comment-right",(function(){e(this).find(".wpd-tools-actions").hide(),e("#comments").css({paddingBottom:"0"})})),e("body").on("click",".wpd\_stick\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdStickComment"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd\_close\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdCloseThread"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-filter.wpd\_not\_clicked[data-filter-type]",(function(){var t=e(this),a=t.attr("data-filter-type");wpdiscuzAjaxObj.resetActiveFilters(".wpdf-"+a),t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var o=new FormData;o.append("action","wpdLoadMoreComments");var n=e(".wpdiscuz-sort-button-active").attr("data-sorting");n&&o.append("sorting",n),o.append("lastParentId",0),o.append("offset",0),M=1,o.append("wpdType",t.hasClass("wpdf-active")?"":a),o.append("isFirstLoad",1),e(this).hasClass("wpdf-inline")?e(this).hasClass("wpdf-active")?e(".wpd-comment-info-bar").hide():e(".wpd-comment-info-bar").css("display","flex"):e(".wpd-comment-info-bar").hide(),ue(v,!1,o).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(t.toggleClass("wpdf-active"),e(".wpd-load-comments").remove(),e(".wpd-comment").remove(),e(".wpd-thread-list").prepend(a.data.comment\_list),K(a),r=a.data.loadLastCommentId,e(".wpd-load-more-submit").blur(),we(a)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpdf-reacted.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdMostReactedComment"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e("#comment-"+a.data.commentId).length||e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpdf-hottest.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdHottestThread"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.commentId).length?e("#comment-"+a.data.commentId).parents("[id^=wpd-comm-"+a.data.commentId+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpd-filter-view-all",(function(){e(".wpdf-inline.wpdf-active.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-follow-link.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=X($(t,0)),o=new FormData;o.append("action","wpdFollowUser"),o.append("commentId",a),ue(v,!0,o).done((function(a){t.addClass("wpd\_not\_clicked"),"object"==typeof a?a.success?(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data.code],a.data.code,t),"success"),t.removeClass("wpd-follow-active"),a.data.followTip&&t.attr("wpd-tooltip",a.data.followTip),a.data.followClass&&t.addClass(a.data.followClass),we(a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),ne(),e("body").on("keyup",".wc\_email",(function(){ne(e(this))})),j&&e("#wpdcom").length){if(e("#wpd-bubble-wrapper").hover((function(){e(this).addClass("wpd-bubble-hover")}),(function(){e(this).removeClass("wpd-bubble-hover")})),C&&!Cookies.get(wpdiscuzAjaxObj.cookieHideBubbleHint)&&setTimeout((function(){e("#wpd-bubble-wrapper").addClass("wpd-bubble-hover");const t=wpdiscuzAjaxObj.bubbleHintShowOnce?"/":location.href;wpdiscuzAjaxObj.bubbleHintCookieExpires&&parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10);Cookies.set(wpdiscuzAjaxObj.cookieHideBubbleHint,"1",{expires:parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10),path:t}),setTimeout((function(){e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")}),1e3\*y)}),1e3\*C),"content\_left"===O)if(e(".entry-content").length){var ie=(de=Math.min(e(".entry-content").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".post-entry").length){ie=(de=Math.min(e(".post-entry").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".container").length){var de;ie=(de=Math.min(e(".container").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner");else"left\_corner"===O?(e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner")):"right\_corner"===O&&(e("#wpd-bubble-wrapper").css({right:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-right-corner"));e("#wpd-bubble-wrapper").show(),e("body").on("click","#wpd-bubble-add-message-close",(function(t){t.preventDefault(),t.stopPropagation(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")})),e("body").on("click","#wpd-bubble",(function(){te(),e("#tab-title-reviews").length&&e("#tab-title-reviews a").trigger("click"),e("html, body").animate({scrollTop:e("#wpdcom").offset().top-(I+28)},1e3,(function(){ae(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover"),wpdiscuzLoadRichEditor?e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0").focus():e("#wc-textarea-0\_0").length&&e("#wc-textarea-0\_0").trigger("focus")}))})),e("body").on("click","#wpd-bubble-comment-close",(function(t){t.preventDefault(),e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")})),e("body").on("click","#wpd-bubble-comment-reply-link a",(function(){var t=e(this).attr("href");setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),Q~~(!0);var a=t.match(/#comment\-(\d+)/);E=E.filter((function(e){return e!=a[1]})),e("#wpd-bubble-count .wpd-new-comments-count").text(E.length),0==E.length&&e("#wpd-bubble-count").removeClass("wpd-new-comments")}),100)})),e("body").on("click","#wpd-bubble-count",(function(){if(E.length){var t=new FormData;t.append("action","wpdBubbleUpdate"),t.append("newCommentIds",E.join()),ue(v,!0,t).done((function(t){"object"==typeof t&&t.success&&(t.data.message=t.data.message.filter((function(t){if(!e("#comment-"+t.comment\_id).length)return t})),G(t),e("#wpd-bubble-count").removeClass("wpd-new-comments"),e("#wpd-bubble-count .wpd-new-comments-count").text("0"),E=[],e(".wpd-new-loaded-comment").length&&(te(),e("html, body").animate({scrollTop:e(e(".wpd-new-loaded-comment")[0]).offset().top-(I+28)},1e3,ae)),we(t)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(e,t,a){console.log(a)}))}}))}if((j&&x||s)&&(t||!t&&p)&&setTimeout((function t(){e.ajax({type:"GET",url:wpdiscuzAjaxObj.bubbleUpdateUrl,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpdiscuzAjaxObj.restNonce)},data:{postId:d,lastId:l,visibleCommentIds:Z()}}).done((function(a){if(!F)if("object"==typeof a){if(a.commentIDsToRemove.forEach((function(t){e("[id^=wpd-comm-"+t+"]").remove()})),a.ids.length){s&&function(){var t=new FormData;t.append("action","wpdUpdateAutomatically"),t.append("loadLastCommentId",r),t.append("visibleCommentIds",Z()),ue(v,!1,t).done((function(t){F||"object"==typeof t&&t.success&&(G(t),t.data.wc\_all\_comments\_count\_new=parseInt(t.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(t.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",t.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(t.data.wc\_all\_comments\_count\_bubble\_html),r=t.data.loadLastCommentId)})).fail((function(e,t,a){console.log(a)}))}(),a.ids=a.ids.filter((function(t){if(!e("#comment-"+t).length)return t}));var o=5e3;l=parseInt(a.ids[a.ids.length-1]),E=E.concat(a.ids),k&&a.commentText&&(e("#wpd-bubble-author-avatar").html(a.avatar),e("#wpd-bubble-author-name").html(a.authorName),e("#wpd-bubble-comment-date span").html(a.commentDate),e("#wpd-bubble-comment-text").html(a.commentText),e("#wpd-bubble-comment-reply-link a").attr("href",a.commentLink),e("#wpd-bubble-notification-message").show(),o=1e4);var n=parseInt(e(".wpd-new-comments-count").text());n+=a.ids.length,e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),e("#wpd-bubble-wrapper").addClass("wpd-new-comment-added"),setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")}),o),e(".wpd-new-comments-count").text(n),e("#wpd-bubble-count").addClass("wpd-new-comments")}a.all\_comments\_count=parseInt(a.all\_comments\_count),e("#wpd-bubble-all-comments-count").replaceWith(a.all\_comments\_count\_bubble\_html),e(".wpd-reviews-tab").length||(e(".wpd-thread-info").html(a.all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.all\_comments\_count))}else console.log(a);setTimeout(t,c)})).fail((function(e,a,o){console.log(o),setTimeout(t,c)}))}),c),e(".wpd-inline-form-wrapper").length){var se=new FormData;se.append("action","wpdGetInlineCommentForm"),ue(v,!1,se).done((function(t){"object"==typeof t?t.success?(e(".wpd-inline-form-wrapper").append(t.data),e.each(e("[name=\_wpd\_inline\_nonce]"),(function(){var t=e(this).attr("id"),a=e(this).parents(".wpd-inline-shortcode").attr("id");e(this).attr("id",t+"-"+a.substring(a.lastIndexOf("-")+1))})),e(".wpd-inline-opened").addClass("wpd-active"),e(".wpd-inline-opened").find(".wpd-inline-form-wrapper").show(),e(".wpd-inline-opened").find(".wpd-inline-icon").addClass("wpd-open"),e(".wpd-inline-opened").find(".wpd-inline-icon").removeClass("wpd-ignored"),le()):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data]),t.data,"error"):console.log(t)})).fail((function(e,t,a){console.log(a)}))}function ce(t){if(e(t).hasClass("wpd-inline-shortcode"))var a=e(t).attr("id");else a=e(t).parents(".wpd-inline-shortcode").attr("id");return a.substring(a.lastIndexOf("-")+1)}function pe(){e(".wpd-inline-form-wrapper").hide(),e(".wpd-inline-shortcode").removeClass("wpd-active"),e(".wpd-inline-icon").removeClass("wpd-open")}function re(){e.each(e(".wpd-inline-shortcode:not(.wpd-inline-opened) .wpd-inline-icon"),(function(){var t=e(this),a=t.offset().top-window.pageYOffset;t.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&a>0&&a<300&&("blink"===A?(t.addClass("wpd-blink"),setTimeout((function(){t.removeClass("wpd-blink")}),3e3)):(t.parents(".wpd-inline-shortcode").addClass("wpd-active"),t.siblings(".wpd-inline-form-wrapper").show(),t.addClass("wpd-open"),le(t.siblings(".wpd-inline-form-wrapper"))))}))}function le(t){if(t){if(t.offset().left<=10)t.css("left",Math.ceil(parseInt(t.css("left"))-t.offset().left+10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))<3&&(a=3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;");else if(t.offset().left+t.width()>document.body.clientWidth-10){var a;t.css("left",Math.ceil(parseInt(t.css("left"))+(document.body.clientWidth-(t.offset().left+t.width()))-10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))>t.width()-3&&(a=t.width()-3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;")}}else e.each(e(".wpd-inline-form-wrapper:visible"),(function(){if(e(this).offset().left<=10)e(this).css("left",Math.ceil(parseInt(e(this).css("left"))-e(this).offset().left+10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))<3&&(t=3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;");else if(e(this).offset().left+e(this).width()>document.body.clientWidth-10){var t;e(this).css("left",Math.ceil(parseInt(e(this).css("left"))+(document.body.clientWidth-(e(this).offset().left+e(this).width()))-10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))>e(this).width()-3&&(t=e(this).width()-3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;")}}))}function me(t){var a,o=0;if(t.parents(".wpd\_main\_comm\_form").length)o=parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents(".wpd\_main\_comm\_form");else if(t.parents(".wpd-secondary-form-wrapper").length)o=parseInt(wpdiscuzAjaxObj.replyTextMaxLength),a=t.parents(".wpd-secondary-form-wrapper");else if(t.parents("#wpdiscuz-edit-form").length){var n=$(t);o=parseInt(n.substring(n.lastIndexOf("\_")+1))?parseInt(wpdiscuzAjaxObj.replyTextMaxLength):parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents("#wpdiscuz-edit-form")}if(o&&a){var i=t.val().length,d=e(".wpd-editor-char-counter",a),s=o-i;d.html(s),s<=10?d.addClass("error"):d.removeClass("error")}}function we(t,a,o,n){t.data.callbackFunctions&&e.each(t.data.callbackFunctions,(function(e){"function"==typeof wpdiscuzAjaxObj[t.data.callbackFunctions[e]]?wpdiscuzAjaxObj[t.data.callbackFunctions[e]](t,a,o,n):"function"==typeof window[t.data.callbackFunctions[e]]?window[t.data.callbackFunctions[e]](t,a,o,n):console.log(t.data.callbackFunctions[e]+" is not a function")}))}function ue(t,a,o){a&&e("#wpdiscuz-loading-bar").show(),o.append("postId",d);var n=o.get("action");wpdiscuzAjaxObj.dataFilterCallbacks&&wpdiscuzAjaxObj.dataFilterCallbacks[n]&&e.each(wpdiscuzAjaxObj.dataFilterCallbacks[n],(function(e){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]]&&(o=wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]](o,t,a))}));var i=t?wpdiscuzAjaxObj.url:wpdiscuzAjaxObj.customAjaxUrl;return console.log(i),e.ajax({type:"POST",url:i,data:o,contentType:!1,processData:!1})}e(document).on("click","body",(function(t){if(e(t.target).hasClass("wpd-inline-form-close")||e(t.target).parents(".wpd-inline-form-close").length)t.preventDefault(),e(t.target).parents(".wpd-inline-form-wrapper").hide(),e(t.target).parents(".wpd-inline-shortcode").removeClass("wpd-active"),e(t.target).parents(".wpd-inline-form-wrapper").siblings(".wpd-inline-icon").removeClass("wpd-open");else if(!e(t.target).hasClass("wpd-inline-form-wrapper")&&!e(t.target).parents(".wpd-inline-form-wrapper").length){pe();var a="";e(t.target).hasClass("wpd-inline-icon")?a=e(t.target):e(t.target).parents(".wpd-inline-icon").length&&(a=e(t.target).parents(".wpd-inline-icon")),a.length&&a.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&(a.parents(".wpd-inline-shortcode").addClass("wpd-active"),a.siblings(".wpd-inline-form-wrapper").show(),a.addClass("wpd-open"),a.removeClass("wpd-ignored"),le(a.siblings(".wpd-inline-form-wrapper")))}(!e(t.target).hasClass("wpd-last-inline-comments-wrapper")&&!e(t.target).parents(".wpd-last-inline-comments-wrapper").length||e(t.target).parents(".wpd-last-inline-comments-wrapper").length&&e(t.target).hasClass("wpd-load-inline-comment"))&&e(".wpd-last-inline-comments-wrapper").remove()})),e("body").on("click",".wpd-inline-submit.wpd\_not\_clicked",(function(t){t.preventDefault();var a=e(this),o=e(this).parents(".wpd\_inline\_comm\_form");if(o[0].checkValidity()){e(this).removeClass("wpd\_not\_clicked");var n=new FormData;n.append("action","wpdAddInlineComment"),n.append("inline\_form\_id",ce(o)),e.each(e("input, textarea",o),(function(t,a){"checkbox"===this.type?e(this).is(":checked")&&n.append(e(a).attr("name"),e(a).val()):n.append(e(a).attr("name"),e(a).val())})),ue(v,!0,n).done((function(t){if(a.addClass("wpd\_not\_clicked"),"object"==typeof t)if(t.success){o[0].reset(),pe();var n=parseInt(t.data.newCount),i=a.parents(".wpd-inline-icon-wrapper").find(".wpd-inline-icon-count");i.text(n),n?i.addClass("wpd-has-comments"):i.removeClass("wpd-has-comments"),t.data.allCommentsCountNew=parseInt(t.data.allCommentsCountNew),e(".wpd-thread-info").html(t.data.allCommentsCountBeforeThreadsHtml),e(".wpd-thread-info").attr("data-comments-count",t.data.allCommentsCountNew),e("#wpd-bubble-all-comments-count").replaceWith(t.data.allCommentsCountBubbleHtml),t.data.message&&oe(t.data.message),wpdiscuzAjaxObj.setCommentMessage(t.data.notification,"success")}else t.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data,a),"error");else wpdiscuzAjaxObj.setCommentMessage(t,"error");e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("keydown",".wpd-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_comm\_submit").trigger("click")})),e("body").on("keydown","#wpdiscuz-edit-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_save\_edited\_comment").trigger("click")})),e("body").on("keydown",".wpd-inline-comment-content",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).parents(".wpd\_inline\_comm\_form").find(".wpd-inline-submit.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-inline-icon-count.wpd-has-comments",(function(){var t=e(this),a=new FormData;a.append("action","wpdGetLastInlineComments"),a.append("inline\_form\_id",ce(t)),ue(v,!0,a).done((function(a){"object"==typeof a?a.success?e(a.data).insertAfter(t):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-view-all-inline-comments",(function(t){t.preventDefault(),e(this).parents(".wpd-last-inline-comments-wrapper").remove(),e(".wpdf-inline").hasClass("wpdf-active")||e(".wpdf-inline").trigger("click"),te(),e("html, body").animate({scrollTop:e(".wpdf-inline").offset().top-I},1e3,ae)})),e("body").on("click",".wpd-feedback-content-link",(function(t){t.preventDefault();var a=e(this).data("feedback-content-id");te(),e("html, body").animate({scrollTop:e("#wpd-inline-"+a).offset().top-(I+6)},1e3,(function(){ae(),e("#wpd-inline-"+a).addClass("wpd-active")}))})),"scroll\_open"!==A&&"blink"!==A||(re(),e(window).on("scroll",re)),e("body").on("click","#wpd-post-rating.wpd-not-rated .wpd-rate-starts svg",(function(){var t=new FormData,a=e(this).index();a>=0&&a<5&&(t.append("action","wpdUserRate"),t.append("rating",a+1),ue(v,!0,t).done((function(t){"object"==typeof t?(t.success?location.reload(!0):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data),"error"),we(t)):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})))})),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){t.preventDefault();var a=e(this);const o=e("#wpdiscuz\_subscription\_button",a);if(a[0].checkValidity()&&(d=a,s=!0,"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&!e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).val().length?(s=!1,e(".wpdiscuz-recaptcha",d).css("border","1px solid red")):"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&e(".wpdiscuz-recaptcha",d).css("border","none"),s)&&o.hasClass("wpd\_not\_clicked")){o.removeClass("wpd\_not\_clicked");var i=new FormData;i.append("action","wpdAddSubscription"),e("\*",a).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&i.append(this.name+"",e(this).val()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):wpdiscuzAjaxObj.setCommentMessage(t,"error"),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1,o.addClass("wpd\_not\_clicked")})).fail((function(t,a,n){console.log(n),o.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}var d,s})),e("body").on("click",".wpd-unsubscribe",(function(t){t.preventDefault();var a=new FormData;a.append("action","wpdUnsubscribe"),a.append("sid",e(this).data("sid")),a.append("skey",e(this).data("skey")),ue(v,!0,a).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),wpdiscuzAjaxObj.resetActiveFilters=function(t){e(".wpd-filter.wpdf-active"+(t?":not("+t+")":"")).removeClass("wpdf-active")},wpdiscuzAjaxObj.getAjaxObj=ue}));var onloadCallback=function(){if(document.getElementById("wpdiscuz-recaptcha-0\_0")&&"2.0"===wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.render("wpdiscuz-recaptcha-0\_0",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(e){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("key")},"expired-callback":function(){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}; |
  |  | 6 | var wpdiscuzLoadRichEditor=parseInt(wpdiscuzAjaxObj.loadRichEditor);if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap"))var wpDiscuzEditor=new WpdEditor;function wpdMessagesOnInit(e,t){wpdiscuzAjaxObj.setCommentMessage(e,t),setTimeout((function(){location.href=location.href.substring(0,location.href.indexOf("wpdiscuzUrlAnchor")-1)}),3e3)}wpdiscuzAjaxObj.setCommentMessage=function(e,t,a){var o="wpdiscuz-message-error";if(e instanceof Array)for(var n in e)t instanceof Array?"success"===t[n]?o="wpdiscuz-message-success":"warning"===t[n]&&(o="wpdiscuz-message-warning"):"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e[n]).prependTo("#wpdiscuz-comment-message").delay(a instanceof Array?a[n]:a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}));else"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e).prependTo("#wpdiscuz-comment-message").delay(a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}))},wpdiscuzAjaxObj.applyFilterOnPhrase=function(e,t,a){return wpdiscuzAjaxObj.phraseFilters&&jQuery.each(wpdiscuzAjaxObj.phraseFilters,(function(o){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]]&&(e=wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]](e,t,a))})),e},jQuery(document).ready((function(e){e("body").addClass("wpdiscuz\_"+wpdiscuzAjaxObj.version);var t=wpdiscuzAjaxObj.is\_user\_logged\_in,a=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!t,o=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&t,n=wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion,i=parseInt(wpdiscuzAjaxObj.commentListLoadType),d=parseInt(wpdiscuzAjaxObj.wc\_post\_id),s=parseInt(wpdiscuzAjaxObj.commentListUpdateType),c=1e3\*parseInt(wpdiscuzAjaxObj.commentListUpdateTimer),p=parseInt(wpdiscuzAjaxObj.liveUpdateGuests),r=wpdiscuzAjaxObj.loadLastCommentId,l=r,m=parseInt(wpdiscuzAjaxObj.firstLoadWithAjax);Cookies.get("wpdiscuz\_comments\_sorting")&&Cookies.remove("wpdiscuz\_comments\_sorting",{path:""}),Cookies.get("wordpress\_last\_visit")&&Cookies.remove("wordpress\_last\_visit",{path:""}),Cookies.get("wpdiscuz\_last\_visit")&&Cookies.remove("wpdiscuz\_last\_visit",{path:""});var w,u=parseInt(wpdiscuzAjaxObj.wordpressIsPaginate),f=wpdiscuzAjaxObj.storeCommenterData,h=(parseInt(wpdiscuzAjaxObj.wmuEnabled),wpdiscuzAjaxObj.isCookiesEnabled),b=!0,\_=wpdiscuzAjaxObj.cookiehash,g=parseInt(wpdiscuzAjaxObj.isLoadOnlyParentComments),z=parseInt(wpdiscuzAjaxObj.enableDropAnimation)?500:0,v=parseInt(wpdiscuzAjaxObj.isNativeAjaxEnabled),j=parseInt(wpdiscuzAjaxObj.enableBubble),x=parseInt(wpdiscuzAjaxObj.bubbleLiveUpdate),C=parseInt(wpdiscuzAjaxObj.bubbleHintTimeout),y=parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout)?parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout):5,k=parseInt(wpdiscuzAjaxObj.bubbleShowNewCommentMessage),O=wpdiscuzAjaxObj.bubbleLocation,A=wpdiscuzAjaxObj.inlineFeedbackAttractionType,I=(I=parseInt(wpdiscuzAjaxObj.scrollSize))||32,T=[],D=[],E=[],F=!1,M=1,L=e("html").css("scroll-behavior"),R=e("body").css("scroll-behavior");(e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").length?e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").length?e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .social\_connect\_form").length?e(".wc\_social\_plugin\_wrapper .social\_connect\_form").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .oneall\_social\_login\_providers").length&&e(".wc\_social\_plugin\_wrapper .oneall\_social\_login .oneall\_social\_login\_providers").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"),wpdiscuzLoadRichEditor&&e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0"),window.addEventListener("beforeunload",(function(t){var a=e(".wpd-form").not(":hidden");if(a.length)if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap")){for(var o=0;o<a.length;o++)if("\n"!==wpDiscuzEditor.createEditor(e(a[o]).find(".ql-container").attr("id")).getText())return t.preventDefault(),void(t.returnValue="")}else for(o=0;o<a.length;o++)if(e(a[o]).find(".wc\_comment").val())return t.preventDefault(),void(t.returnValue="")})),wpdiscuzLoadRichEditor||(e(document).delegate("textarea.wc\_comment","input",(function(){me(e(this))})),e.each(e("textarea.wc\_comment"),(function(){me(e(this))}))),e("body").on("focus","#wpdcom .ql-editor, #wpdcom .wc\_comment",(function(){e(".wpd-form-foot",e(this).parents(".wpd\_comm\_form")).slideDown(z)})),e("body").on("focus","#wpdcom textarea",(function(){e(this).next(".autogrow-textarea-mirror").length||e(this).autoGrow()})),t)||q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)});if(e(".wpd-vote-down.wpd-dislike-hidden").remove(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd"),e("body").on("click","#wpd-editor-source-code-wrapper-bg",(function(){e(this).hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),wpdiscuzLoadRichEditor&&e("body").on("click","#wpd-insert-source-code",(function(){var t=wpDiscuzEditor.createEditor("#"+e("#wpd-editor-uid").val());t.deleteText(0,t.getLength(),Quill.sources.USER);var a=e("#wpd-editor-source-code").val();a.length&&t.clipboard.dangerouslyPasteHTML(0,a,Quill.sources.USER),t.update(),e("#wpd-editor-source-code-wrapper-bg").hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),e("body").on("click",".wpd-reply-button",(function(){var i=$(e(this),0);e(this).hasClass("wpdiscuz-clonned")?(wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+i).focus()}),z):setTimeout((function(){e("#wc-textarea-"+i).trigger("focus")}),z),e("#wpd-secondary-form-wrapper-"+i).slideToggle(z)):function(a){var o=$(a,0);e("#wpdiscuz\_form\_anchor-"+o).before(function(t){return e("#wpdiscuz\_hidden\_secondary\_form").html().replace(/wpdiscuzuniqueid/g,t)}(o));var n=e("#wpd-secondary-form-wrapper-"+o);if(!t){q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)})}wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+o).focus()}),z):setTimeout((function(){e("#wc-textarea-"+o).trigger("focus")}),z);n.slideToggle(z,(function(){a.addClass("wpdiscuz-clonned")}))}(e(this)),function(t){if((a||o)&&"2.0"===n){var i=X(t);setTimeout((function(){if(!D[i])try{D[i]=grecaptcha.render("wpdiscuz-recaptcha-"+t,{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(a){e("#wpdiscuz-recaptcha-field-"+t).val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-"+t).val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3)}}(i)})),e("body").on("click","#wpdcom [data-wpd-clipboard]",(function(){var t=e(this).data("wpd-clipboard");e(this).data("wpd-ismention")&&(t="@"+t);var a=e("<input/>");a.appendTo("body").css({position:"absolute",top:"-10000000px"}).val(t),a.trigger("select"),document.execCommand("copy"),a.remove(),wpdiscuzAjaxObj.setCommentMessage(t+"<br/>"+wpdiscuzAjaxObj.wc\_copied\_to\_clipboard,"success",5e3)})),e("body").on("click",".wpdiscuz-nofollow,.wc\_captcha\_refresh\_img,.wpd-load-more-submit",(function(e){e.preventDefault()})),e("body").on("click",".wpd-toggle.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked");var a=$(e(this),0),o=e(this),n=e(".fas",o);!o.parents(".wpd-comment:not(.wpd-reply)").children(".wpd-reply").length&&g?function(t,a){var o=X(t),n=new FormData;n.append("action","wpdShowReplies"),n.append("commentId",o),ue(v,!0,n).done((function(o){a.addClass("wpd\_not\_clicked"),"object"==typeof o&&o.success&&(e("#wpd-comm-"+t).replaceWith(o.data.comment\_list),e("#wpd-comm-"+t+" .wpd-toggle .fas").removeClass("fa-chevron-down").addClass("fa-chevron-up"),e("#wpd-comm-"+t+" .wpd-toggle .wpd-view-replies .wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),e("#wpd-comm-"+t+" .wpd-toggle").attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text),we(o)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,o,n){console.log(n),a.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}(a,t):e("#wpd-comm-"+a+"> .wpd-reply").slideToggle(700,(function(){e(this).is(":hidden")?(n.removeClass("fa-chevron-up"),n.addClass("fa-chevron-down"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_show\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_show\_replies\_text)):(n.removeClass("fa-chevron-down"),n.addClass("fa-chevron-up"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text)),t.addClass("wpd\_not\_clicked")}))})),e("body").on("mouseenter",".wpd-new-loaded-comment",(function(){e(this).removeClass("wpd-new-loaded-comment")})),e("body").on("click",".wpd-sbs-toggle",(function(){e(".wpdiscuz-subscribe-bar").slideToggle(z)})),parseInt(wpdiscuzAjaxObj.wpDiscuzIsShowOnSubscribeForm)&&!t&&wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&e("#wpdiscuz-subscribe-form").length&&("2.0"===n?(setTimeout((function(){try{grecaptcha.render("wpdiscuz-recaptcha-subscribe-form",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-subscribe-form").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val()?e(".wpdiscuz-recaptcha",e(this)).css("border","none"):(e(".wpdiscuz-recaptcha",e(this)).css("border","1px solid red"),ee(e(this),""),t.preventDefault())}))):"3.0"===n&&e("body").on("click","#wpdiscuz\_subscription\_button",(function(t){var a=e(this).parents("#wpdiscuz-subscribe-form");ee(a,""),t.preventDefault();try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/wpdAddSubscription"}).then((function(e){document.getElementById("wpdiscuz-recaptcha-field-subscribe-form").value=e,a.trigger("submit")}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error")}}))),(a||o)&&"2.0"===n){var S=e(window).width(),H=e("#wpdcom").width();H>=1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"65%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"35%"})),H>=940&&H<1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"60%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"40%"})),H>=810&&H<940&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"60%"})),H>=730&&H<810&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"45%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"55%"})),H>=610&&H<730&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.85)","-webkit-transform":"scale(0.85)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"43%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"55%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"})),S>650&&(H>=510&&H<610&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"35%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"63%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%",position:"relative",right:"-60px"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H>=470&&H<510&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"60%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd\_main\_comm\_form .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H<470&&(e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({margin:"0px auto","transform-origin":"center 0","-webkit-transform-origin":"center 0"}),e("#wpdcom .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc\_notification\_checkboxes").css({"text-align":"center"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-field-submit").css({"text-align":"center"})))}function P(t,a,o){ue(v,!1,a).done((function(a){if(e(o).addClass("wpd\_not\_clicked"),"object"==typeof a)if(a.success){"collapsed"===wpdiscuzAjaxObj.commentFormView&&e(".wpd-form-foot",t).slideUp(z),a.data.wc\_all\_comments\_count\_new=parseInt(a.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(a.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(a.data.wc\_all\_comments\_count\_bubble\_html);var n=z;a.data.is\_main?oe(a.data.message):(n=z+700,e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).slideToggle(700),1==a.data.is\_in\_same\_container?e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).after(a.data.message):e("#wpd-comm-"+a.data.uniqueid).after(a.data.message)),function(e){if(!e.data.held\_moderate){var t=new FormData;t.append("action","wpdCheckNotificationType"),t.append("comment\_id",e.data.new\_comment\_id),t.append("email",e.data.comment\_author\_email),t.append("isParent",e.data.is\_main),ue(v,!0,t)}}(a),function(e){if(e.data.redirect>0&&e.data.new\_comment\_id){var t=new FormData;t.append("action","wpdRedirect"),t.append("commentId",e.data.new\_comment\_id),ue(v,!0,t).done((function(e){"object"==typeof e&&e.success&&setTimeout((function(){location.href=e.data}),2e3)})).fail((function(e,t,a){console.log(a)}))}}(a),h&&b?function(t){var a=t.comment\_author\_email,o=t.comment\_author,n=t.comment\_author\_url;null==f?(Cookies.set("comment\_author\_email\_"+\_,a),Cookies.set("comment\_author\_"+\_,o),n.length&&Cookies.set("comment\_author\_url\_"+\_,n)):(f=parseInt(f),Cookies.set("comment\_author\_email\_"+\_,a,{expires:f,path:"/"}),Cookies.set("comment\_author\_"+\_,o,{expires:f,path:"/"}),n.length&&Cookies.set("comment\_author\_url\_"+\_,n,{expires:f,path:"/"}));e(".wpd-cookies-checkbox").length&&e(".wpd-cookies-checkbox").prop("checked",!0)}(a.data):b||e(".wpd-cookies-checkbox").prop("checked",!1),t.get(0).reset(),wpdiscuzLoadRichEditor?wpDiscuzEditor.createEditor("#wpd-editor-"+e(".wpdiscuz\_unique\_id",t).val()).setContents([{insert:"\n"}]):me(t.find(".wc\_comment")),q(a.data),e(".wmu-preview-wrap",t).remove(),T.length&&(T.forEach((function(e){e.parents(".wpd-field-checkbox").remove()})),T=[]),parseInt(wpdiscuzAjaxObj.scrollToComment)&&setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.new\_comment\_id).offset().top-I},1e3,ae)}),n),we(a,t),e(document.body).trigger("wpdiscuz\_comment\_posted",[a.data.new\_comment\_id,a.data.wc\_all\_comments\_count\_new])}else a.data&&(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"),we(a,t));else wpdiscuzAjaxObj.setCommentMessage(a,"error");e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,n){console.log(n),e(o).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}function q(t){e(".wpd\_comm\_form .wc\_name").val(t.comment\_author),t.comment\_author\_email&&t.comment\_author\_email.indexOf("@example.com")<0&&e(".wpd\_comm\_form .wc\_email").val(t.comment\_author\_email),t.comment\_author\_url&&e(".wpd\_comm\_form .wc\_website").val(t.comment\_author\_url)}function U(t,a){e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").show(),e("#wpd-comm-"+t+" .wpdiscuz-edit-form-wrap").replaceWith(a),e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-last-edited").show()}e("body").on("click",".wc\_comm\_submit.wpd\_not\_clicked",(function(){var i=e(this),d=1,s=e(this).parents("form");if("true"!==s.attr("data-uploading")){if(s.hasClass("wpd\_main\_comm\_form")||(d=function(t){var a=t.attr("class").split(" "),o="";return e.each(a,(function(e,t){"wpd\_comment\_level"===Y(t,!1)&&(o=Y(t,!0))})),parseInt(o)+1}(e(this).parents(".wpd-comment"))),ee(s,"#wpd-editor-"+e(".wpdiscuz\_unique\_id",s).val()),s.on("submit",(function(e){e.preventDefault()})),s[0].checkValidity()&&(p=s,r=!0,"2.0"===n&&e("input[name=wc\_captcha]",p).length&&!e("input[name=wc\_captcha]",p).val().length?(r=!1,e(".wpdiscuz-recaptcha",p).css("border","1px solid red")):"2.0"===n&&e("input[name=wc\_captcha]",p).length&&e(".wpdiscuz-recaptcha",p).css("border","none"),r)){F=!0,function(t){e(".wpd-agreement-checkbox",t).each((function(){e(this).hasClass("wpd\_agreement\_hide")&&h&&e(this).prop("checked")&&(Cookies.set(e(this).attr("name")+"\_"+\_,1,{expires:30,path:"/"}),e("input[name="+e(this).attr("name")+"]").each((function(){T.push(e(this))})))}))}(s),e(i).removeClass("wpd\_not\_clicked");var c=new FormData;if(c.append("action","wpdAddComment"),e(":input",s).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&c.append(this.name+"",e(this).val().trim()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&c.append(this.name+"",e(this).val())})),c.append("wpd\_comment\_depth",d),wpdiscuzAjaxObj.wpdiscuz\_zs&&c.append("wpdiscuz\_zs",wpdiscuzAjaxObj.wpdiscuz\_zs),e(".wpd-cookies-checkbox",s).length?e(".wpd-cookies-checkbox",s).prop("checked")||(b=!1):t&&(b=!1),e("#wpdiscuz-loading-bar").show(),wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&"3.0"===n&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/addComment"}).then((function(e){c.append("g-recaptcha-response",e),P(s,c,i)}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)}else P(s,c,i)}var p,r;!function(e){if((a||o)&&"2.0"===n){var t=X(e);grecaptcha.reset(D[t])}}(e(".wpdiscuz\_unique\_id",s).val()),e(".wpdiscuz\_reset").val("")}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj.wmuPhraseDoingUpload,"wmuPhraseDoingUpload",s),"warning")})),e(document.body).on("wpdiscuz\_comment\_posted",(function(t,a,o){const n=e(".wpd-thread-filter");isNaN(o)||void 0===o||!o?n.find(".wpd-filter").addClass("wpdiscuz-hidden"):n.find(".wpd-filter").removeClass("wpdiscuz-hidden")})),e("body").on("click",".wpd\_editable\_comment",(function(){w&&e(".wpdiscuz-edit-form-wrap").length&&U($(e(".wpdiscuz-edit-form-wrap"),0),w);var t=e(this),a=$(t,0),o=X(a),n=new FormData;n.append("action","wpdEditComment"),n.append("commentId",o),w=e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-text").get(0),ue(v,!0,n).done((function(o){if("object"==typeof o)if(o.success){if(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text").replaceWith(o.data.html),wpdiscuzLoadRichEditor){var n=wpDiscuzEditor.createEditor("#wpd-editor-edit\_"+a);n.clipboard.dangerouslyPasteHTML(0,o.data.content),n.update(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd")}else e("#wc-textarea-edit\_"+a).val(o.data.content),me(e("#wc-textarea-edit\_"+a));e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").hide(),e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").hide()}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[o.data],o.data,t),"error");else console.log(o);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wc\_save\_edited\_comment",(function(){var t=e(this),a=$(t),o=X(a),n=e("#wpd-comm-"+a+" #wpdiscuz-edit-form");if(ee(n,"#wpd-editor-edit\_"+a),n.on("submit",(function(e){e.preventDefault()})),n[0].checkValidity()){var i=new FormData;i.append("action","wpdSaveEditedComment"),i.append("commentId",o),e(":input",n).each((function(){""!==this.name&&"checkbox"!==this.type&&"radio"!==this.type&&i.append(this.name+"",e(this).val()),"checkbox"!==this.type&&"radio"!==this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(n){"object"==typeof n?(n.success?(U(a,n.data.message),n.data.comment\_approved\_html&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-subheader").append(n.data.comment\_approved\_html),n.data.lastEdited&&(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").remove(),e(n.data.lastEdited).insertAfter("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text")),n.data.twitterShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_tw").attr("href",n.data.twitterShareLink),n.data.whatsappShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_whatsapp").attr("href",n.data.whatsappShareLink),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error"),we(n,o)):wpdiscuzAjaxObj.setCommentMessage(n,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("click",".wc\_cancel\_edit",(function(){var t=$(e(this));U(t,w),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+t)})),!u&&m&&(M=0,1==m?setTimeout((function(){N(!0)}),500):e("body").on("click",".wpd-load-comments",(function(){e(this).parent(".wpd-load-more-submit-wrap").remove(),N(!0)}))),e("body").on("click",".wpd-load-more-submit",(function(){var t=e(this),a="wpd-loaded";t.hasClass(a)&&N(!1,t,a,"wpd-loading")}));var W=!1;function B(){var t=document.getElementById("wpdiscuzHasMoreComments"),a=0;t&&(a=t.dataset.is\_show\_load\_more);var o=document.getElementById("wpdcom")?document.getElementById("wpdcom").clientHeight:0,n=e(window).height()+e(window).scrollTop();o&&n&&(100\*n/o>=80&&!1===W&&1==a&&(W=!0,N(!1,e(".wpd-load-more-submit"))))}function N(t,a,o,n){a&&(a.toggleClass(o),a.toggleClass(n));var d=new FormData;d.append("action","wpdLoadMoreComments");var s=e(".wpdiscuz-sort-button-active").attr("data-sorting");s&&d.append("sorting",s),d.append("offset",M),d.append("lastParentId",e(".wpd-load-more-submit").attr("data-lastparentid")),d.append("isFirstLoad",t?1:0);var c=e(".wpdf-active").attr("data-filter-type");d.append("wpdType",c||""),ue(v,!t||1!=m,d).done((function(d){"object"==typeof d&&d.success&&(M++,t&&e(".wpd-comment").remove(),e(".wpdiscuz\_single").remove(),e(".wpdiscuz-comment-pagination").before(d.data.comment\_list),V(d,t&&2!==i),W=!1,d.data.loadLastCommentId&&(r=d.data.loadLastCommentId),we(d),t&&K(!1)),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))})).fail((function(t,i,d){console.log(d),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))}))}function V(t,a){var o,n=document.getElementById("wpdiscuzHasMoreComments");if(0==t.data.is\_show\_load\_more)n&&(n.dataset.is\_show\_load\_more=0),e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide();else if(o=t.data.last\_parent\_id,e(".wpd-load-more-submit").attr("data-lastparentid",o),2!==i&&e(".wpdiscuz-comment-pagination").show(),n&&(n.dataset.is\_show\_load\_more=1),a&&e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").show(),t.data.comments\_left>0){if(!e(".wpd-load-more-submit .wpd-comments-left").length){const t=e("<span>");t.addClass("wpd-comments-left"),e(".wpd-load-more-submit").append(t)}e(".wpd-load-more-submit .wpd-comments-left").text(t.data.comments\_left\_text)}we(t)}function K(t){var a=location.href.match(/#comment\-(\d+)/);if(null!==a){var o=a[1];if(e("#comment-"+o).length)setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+o).parents("[id^=wpd-comm-]").offset().top-I},1e3,ae),t&&Q(o)}),500);else{var n=new FormData;n.append("action","wpdGetSingleComment"),n.append("commentId",o),ue(v,!0,n).done((function(a){if("object"==typeof a&&a.success){var n="#comment-"+o;e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e(n).offset().top-I},1e3,ae),t&&Q(o)}e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}}}function Q(t){setTimeout((function(){e("#comment-"+t).siblings(".wpd-secondary-form-wrapper").is(":visible")||e("#comment-"+t).find(".wpd-reply-button").trigger("click")}),1100)}function G(e){if(void 0!==e.data.message)for(var t,a=e.data.message,o=0;o<a.length;o++)J((t=a[o]).comment\_parent,t.comment\_html)}function $(e,t){var a="";return(a=t?e.parents(".wpd-main-form-wrapper").attr("id"):e.parents(".wpd-comment").attr("id")).substring(a.lastIndexOf("-")+1)}function X(e){return e.substring(0,e.indexOf("\_"))}function Y(e,t){return t?e.substring(e.indexOf("-")+1):e.substring(0,e.indexOf("-"))}function J(t,a){if(0==t)oe(a);else{var o=$(e("#comment-"+t),0);e("#wpdiscuz\_form\_anchor-"+o).after(a)}}function Z(){var t=[];return e(".wpd-comment-right").each((function(){t.push(X($(e(this),0)))})),t.join(",")}function ee(t,a){var o=t.find(".wpd-required-group");wpdiscuzLoadRichEditor&&t.find(".wc\_comment").val(e(a+">.ql-editor").html()),function(e){if("wpdiscuz-subscribe-form"==e.attr("id"))return;var t=e.find(".wc\_comment"),a=t.val().trim().replace(/<p><br><\/p>/g,"\n").replace(/<p>(.\*?)<\/p>/g,"$1\n");a=(a=(a=(a=a.replace(/<img src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img[^>]+alt=["|']([^"|']+)["|'][^>]+src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'][^>]?>/g," $1 ")).replace(/<img\s+([^>]\*)class=["|']wpdem\-sticker["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img\s+([^>]\*)src=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $2 "),t.val(a)}(t),e.each(o,(function(){e("input",this).prop("required",!1),0===e("input:checked",this).length?e("input",e(this)).prop("required",!0):e(".wpd-field-invalid",this).remove()}))}function te(){e("html, body").css("scroll-behavior","unset")}function ae(){e("html").css("scroll-behavior",L),e("body").css("scroll-behavior",R)}function oe(t){e(".wpd-sticky-comment").last()[0]?e(t).insertAfter(e(".wpd-sticky-comment").last()[0]):e(".wpd-thread-list").prepend(t)}function ne(t){t?t.prop("required")||(t.val()?t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none")):e.each(e(".wc\_email"),(function(t,a){var o=e(a);o.prop("required")||(o.val()?o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none"))}))}if(2!==i||u||(e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide(),B(),e(window).scroll((function(){B()}))),wpdiscuzAjaxObj.setLoadMoreVisibility=V,e("body").on("click",".wpd-vote-up.wpd\_not\_clicked, .wpd-vote-down.wpd\_not\_clicked",(function(){var t=e(this);e(t).removeClass("wpd\_not\_clicked");var a,o=X($(t));a=e(this).hasClass("wpd-vote-up")?1:-1;var n=new FormData;n.append("action","wpdVoteOnComment"),n.append("commentId",o),n.append("voteType",a),ue(v,!0,n).done((function(n){if(e(t).addClass("wpd\_not\_clicked"),"object"==typeof n){if(n.success){if("total"===n.data.buttonsStyle){var i=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result"),d=n.data.votes;i.text(n.data.votesHumanReadable),i.attr("title",d),i.removeClass("wpd-up wpd-down"),d>0&&i.addClass("wpd-up"),d<0&&i.addClass("wpd-down")}else{var s=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-like"),c=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-dislike");s.text(n.data.likeCountHumanReadable),s.attr("title",n.data.likeCount),c.text(n.data.dislikeCountHumanReadable),c.attr("title",n.data.dislikeCount),parseInt(n.data.likeCount)>0?s.addClass("wpd-up"):s.removeClass("wpd-up"),parseInt(n.data.dislikeCount)<0?c.addClass("wpd-down"):c.removeClass("wpd-down")}var p=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-up"),r=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-down");p.removeClass("wpd-up"),r.removeClass("wpd-down"),n.data.curUserReaction>0?p.addClass("wpd-up"):n.data.curUserReaction<0&&r.addClass("wpd-down")}else n.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error");we(n,o,a)}else console.log(n);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(t).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e(document).on("click","body",(function(t){var a=e(".wpdiscuz-sort-buttons");e(t.target).hasClass("wpdf-sorting")||e(t.target).parent().hasClass("wpdf-sorting")?a.css({display:a.is(":visible")?"none":"flex"}):a.hide()})),e("body").on("click",".wpdiscuz-sort-button:not(.wpdiscuz-sort-button-active)",(function(){var t=e(this),a=e(this).attr("data-sorting");if(a){e(".wpd-load-comments").parents(".wpd-load-more-submit-wrap").remove(),e(".wpdiscuz-sort-button.wpdiscuz-sort-button-active").removeClass("wpdiscuz-sort-button-active").appendTo(".wpdiscuz-sort-buttons"),t.addClass("wpdiscuz-sort-button-active").prependTo(".wpdf-sorting");var o=new FormData;o.append("action","wpdSorting"),o.append("sorting",a);var n=e(".wpdf-active").attr("data-filter-type");o.append("wpdType",n||""),ue(v,!0,o).done((function(t){"object"==typeof t&&t.success&&(e("#wpdcom .wpd-comment").remove(),e("#wpdcom .wpd-thread-list").prepend(t.data.message),V(t,!1),M=1),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),window.onhashchange=function(){K(!1)},1!=m&&K(!1),e("body").on("click",".wpdiscuz-readmore",(function(){var t=$(e(this)),a=X(t),o=new FormData;o.append("action","wpdReadMore"),o.append("commentId",a),ue(v,!0,o).done((function(o){"object"==typeof o?(o.success?(e("#comment-"+a+" .wpd-comment-text").replaceWith(" "+o.data.message),e("#wpdiscuz-readmore-"+t).remove()):console.log(o.data),we(o)):console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("change",".wpd-required-group",(function(){0!==e("input:checked",this).length?e("input",e(this)).prop("required",!1):e("input",e(this)).prop("required",!0)})),e("body").on("click",".wpdiscuz-spoiler",(function(){e(this).next().slideToggle(),e(this).hasClass("wpdiscuz-spoiler-closed")?e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"):e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),e(this).toggleClass("wpdiscuz-spoiler-closed")})),e("body").on("click",".wpd-tools",(function(){var t=e(".wpd-tools-actions",e(this));t.is(":visible")||e(this).parents(".wpd-comment-right").attr("id")!==e("[id^=comment-]","#wpdcom").last().attr("id")||e("#comments").css({paddingBottom:"160px"}),t.css({display:t.is(":visible")?"none":"flex"})})),e("body").on("mouseleave",".wpd-comment-right",(function(){e(this).find(".wpd-tools-actions").hide(),e("#comments").css({paddingBottom:"0"})})),e("body").on("click",".wpd\_stick\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdStickComment"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd\_close\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdCloseThread"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-filter.wpd\_not\_clicked[data-filter-type]",(function(){var t=e(this),a=t.attr("data-filter-type");wpdiscuzAjaxObj.resetActiveFilters(".wpdf-"+a),t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var o=new FormData;o.append("action","wpdLoadMoreComments");var n=e(".wpdiscuz-sort-button-active").attr("data-sorting");n&&o.append("sorting",n),o.append("lastParentId",0),o.append("offset",0),M=1,o.append("wpdType",t.hasClass("wpdf-active")?"":a),o.append("isFirstLoad",1),e(this).hasClass("wpdf-inline")?e(this).hasClass("wpdf-active")?e(".wpd-comment-info-bar").hide():e(".wpd-comment-info-bar").css("display","flex"):e(".wpd-comment-info-bar").hide(),ue(v,!1,o).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(t.toggleClass("wpdf-active"),e(".wpd-load-comments").remove(),e(".wpd-comment").remove(),e(".wpd-thread-list").prepend(a.data.comment\_list),V(a),r=a.data.loadLastCommentId,e(".wpd-load-more-submit").blur(),we(a)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpdf-reacted.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdMostReactedComment"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e("#comment-"+a.data.commentId).length||e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpdf-hottest.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdHottestThread"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.commentId).length?e("#comment-"+a.data.commentId).parents("[id^=wpd-comm-"+a.data.commentId+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpd-filter-view-all",(function(){e(".wpdf-inline.wpdf-active.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-follow-link.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=X($(t,0)),o=new FormData;o.append("action","wpdFollowUser"),o.append("commentId",a),ue(v,!0,o).done((function(a){t.addClass("wpd\_not\_clicked"),"object"==typeof a?a.success?(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data.code],a.data.code,t),"success"),t.removeClass("wpd-follow-active"),a.data.followTip&&t.attr("wpd-tooltip",a.data.followTip),a.data.followClass&&t.addClass(a.data.followClass),we(a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),ne(),e("body").on("keyup",".wc\_email",(function(){ne(e(this))})),j&&e("#wpdcom").length){if(e("#wpd-bubble-wrapper").hover((function(){e(this).addClass("wpd-bubble-hover")}),(function(){e(this).removeClass("wpd-bubble-hover")})),C&&!Cookies.get(wpdiscuzAjaxObj.cookieHideBubbleHint)&&setTimeout((function(){e("#wpd-bubble-wrapper").addClass("wpd-bubble-hover");const t=wpdiscuzAjaxObj.bubbleHintShowOnce?"/":location.href;wpdiscuzAjaxObj.bubbleHintCookieExpires&&parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10);Cookies.set(wpdiscuzAjaxObj.cookieHideBubbleHint,"1",{expires:parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10),path:t}),setTimeout((function(){e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")}),1e3\*y)}),1e3\*C),"content\_left"===O)if(e(".entry-content").length){var ie=(de=Math.min(e(".entry-content").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".post-entry").length){ie=(de=Math.min(e(".post-entry").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".container").length){var de;ie=(de=Math.min(e(".container").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner");else"left\_corner"===O?(e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner")):"right\_corner"===O&&(e("#wpd-bubble-wrapper").css({right:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-right-corner"));e("#wpd-bubble-wrapper").show(),e("body").on("click","#wpd-bubble-add-message-close",(function(t){t.preventDefault(),t.stopPropagation(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")})),e("body").on("click","#wpd-bubble",(function(){te(),e("#tab-title-reviews").length&&e("#tab-title-reviews a").trigger("click"),e("html, body").animate({scrollTop:e("#wpdcom").offset().top-(I+28)},1e3,(function(){ae(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover"),wpdiscuzLoadRichEditor?e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0").focus():e("#wc-textarea-0\_0").length&&e("#wc-textarea-0\_0").trigger("focus")}))})),e("body").on("click","#wpd-bubble-comment-close",(function(t){t.preventDefault(),e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")})),e("body").on("click","#wpd-bubble-comment-reply-link a",(function(){var t=e(this).attr("href");setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),K(!0);var a=t.match(/#comment\-(\d+)/);E=E.filter((function(e){return e!=a[1]})),e("#wpd-bubble-count .wpd-new-comments-count").text(E.length),0==E.length&&e("#wpd-bubble-count").removeClass("wpd-new-comments")}),100)})),e("body").on("click","#wpd-bubble-count",(function(){if(E.length){var t=new FormData;t.append("action","wpdBubbleUpdate"),t.append("newCommentIds",E.join()),ue(v,!0,t).done((function(t){"object"==typeof t&&t.success&&(t.data.message=t.data.message.filter((function(t){if(!e("#comment-"+t.comment\_id).length)return t})),G(t),e("#wpd-bubble-count").removeClass("wpd-new-comments"),e("#wpd-bubble-count .wpd-new-comments-count").text("0"),E=[],e(".wpd-new-loaded-comment").length&&(te(),e("html, body").animate({scrollTop:e(e(".wpd-new-loaded-comment")[0]).offset().top-(I+28)},1e3,ae)),we(t)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(e,t,a){console.log(a)}))}}))}if((j&&x||s)&&(t||!t&&p)&&setTimeout((function t(){e.ajax({type:"GET",url:wpdiscuzAjaxObj.bubbleUpdateUrl,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpdiscuzAjaxObj.restNonce)},data:{postId:d,lastId:l,visibleCommentIds:Z()}}).done((function(a){if(!F)if("object"==typeof a){if(a.commentIDsToRemove.forEach((function(t){e("[id^=wpd-comm-"+t+"]").remove()})),a.ids.length){s&&function(){var t=new FormData;t.append("action","wpdUpdateAutomatically"),t.append("loadLastCommentId",r),t.append("visibleCommentIds",Z()),ue(v,!1,t).done((function(t){F||"object"==typeof t&&t.success&&(G(t),t.data.wc\_all\_comments\_count\_new=parseInt(t.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(t.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",t.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(t.data.wc\_all\_comments\_count\_bubble\_html),r=t.data.loadLastCommentId)})).fail((function(e,t,a){console.log(a)}))}(),a.ids=a.ids.filter((function(t){if(!e("#comment-"+t).length)return t}));var o=5e3;l=parseInt(a.ids[a.ids.length-1]),E=E.concat(a.ids),k&&a.commentText&&(e("#wpd-bubble-author-avatar").html(a.avatar),e("#wpd-bubble-author-name").html(a.authorName),e("#wpd-bubble-comment-date span").html(a.commentDate),e("#wpd-bubble-comment-text").html(a.commentText),e("#wpd-bubble-comment-reply-link a").attr("href",a.commentLink),e("#wpd-bubble-notification-message").show(),o=1e4);var n=parseInt(e(".wpd-new-comments-count").text());n+=a.ids.length,e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),e("#wpd-bubble-wrapper").addClass("wpd-new-comment-added"),setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")}),o),e(".wpd-new-comments-count").text(n),e("#wpd-bubble-count").addClass("wpd-new-comments")}a.all\_comments\_count=parseInt(a.all\_comments\_count),e("#wpd-bubble-all-comments-count").replaceWith(a.all\_comments\_count\_bubble\_html),e(".wpd-reviews-tab").length||(e(".wpd-thread-info").html(a.all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.all\_comments\_count))}else console.log(a);setTimeout(t,c)})).fail((function(e,a,o){console.log(o),setTimeout(t,c)}))}),c),e(".wpd-inline-form-wrapper").length){var se=new FormData;se.append("action","wpdGetInlineCommentForm"),ue(v,!1,se).done((function(t){"object"==typeof t?t.success?(e(".wpd-inline-form-wrapper").append(t.data),e.each(e("[name=\_wpd\_inline\_nonce]"),(function(){var t=e(this).attr("id"),a=e(this).parents(".wpd-inline-shortcode").attr("id");e(this).attr("id",t+"-"+a.substring(a.lastIndexOf("-")+1))})),e(".wpd-inline-opened").addClass("wpd-active"),e(".wpd-inline-opened").find(".wpd-inline-form-wrapper").show(),e(".wpd-inline-opened").find(".wpd-inline-icon").addClass("wpd-open"),e(".wpd-inline-opened").find(".wpd-inline-icon").removeClass("wpd-ignored"),le()):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data]),t.data,"error"):console.log(t)})).fail((function(e,t,a){console.log(a)}))}function ce(t){if(e(t).hasClass("wpd-inline-shortcode"))var a=e(t).attr("id");else a=e(t).parents(".wpd-inline-shortcode").attr("id");return a.substring(a.lastIndexOf("-")+1)}function pe(){e(".wpd-inline-form-wrapper").hide(),e(".wpd-inline-shortcode").removeClass("wpd-active"),e(".wpd-inline-icon").removeClass("wpd-open")}function re(){e.each(e(".wpd-inline-shortcode:not(.wpd-inline-opened) .wpd-inline-icon"),(function(){var t=e(this),a=t.offset().top-window.pageYOffset;t.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&a>0&&a<300&&("blink"===A?(t.addClass("wpd-blink"),setTimeout((function(){t.removeClass("wpd-blink")}),3e3)):(t.parents(".wpd-inline-shortcode").addClass("wpd-active"),t.siblings(".wpd-inline-form-wrapper").show(),t.addClass("wpd-open"),le(t.siblings(".wpd-inline-form-wrapper"))))}))}function le(t){if(t){if(t.offset().left<=10)t.css("left",Math.ceil(parseInt(t.css("left"))-t.offset().left+10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))<3&&(a=3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;");else if(t.offset().left+t.width()>document.body.clientWidth-10){var a;t.css("left",Math.ceil(parseInt(t.css("left"))+(document.body.clientWidth-(t.offset().left+t.width()))-10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))>t.width()-3&&(a=t.width()-3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;")}}else e.each(e(".wpd-inline-form-wrapper:visible"),(function(){if(e(this).offset().left<=10)e(this).css("left",Math.ceil(parseInt(e(this).css("left"))-e(this).offset().left+10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))<3&&(t=3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;");else if(e(this).offset().left+e(this).width()>document.body.clientWidth-10){var t;e(this).css("left",Math.ceil(parseInt(e(this).css("left"))+(document.body.clientWidth-(e(this).offset().left+e(this).width()))-10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))>e(this).width()-3&&(t=e(this).width()-3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;")}}))}function me(t){var a,o=0;if(t.parents(".wpd\_main\_comm\_form").length)o=parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents(".wpd\_main\_comm\_form");else if(t.parents(".wpd-secondary-form-wrapper").length)o=parseInt(wpdiscuzAjaxObj.replyTextMaxLength),a=t.parents(".wpd-secondary-form-wrapper");else if(t.parents("#wpdiscuz-edit-form").length){var n=$(t);o=parseInt(n.substring(n.lastIndexOf("\_")+1))?parseInt(wpdiscuzAjaxObj.replyTextMaxLength):parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents("#wpdiscuz-edit-form")}if(o&&a){var i=t.val().length,d=e(".wpd-editor-char-counter",a),s=o-i;d.html(s),s<=10?d.addClass("error"):d.removeClass("error")}}function we(t,a,o,n){t.data.callbackFunctions&&e.each(t.data.callbackFunctions,(function(e){"function"==typeof wpdiscuzAjaxObj[t.data.callbackFunctions[e]]?wpdiscuzAjaxObj[t.data.callbackFunctions[e]](t,a,o,n):"function"==typeof window[t.data.callbackFunctions[e]]?window[t.data.callbackFunctions[e]](t,a,o,n):console.log(t.data.callbackFunctions[e]+" is not a function")}))}function ue(t,a,o){a&&e("#wpdiscuz-loading-bar").show(),o.append("postId",d);var n=o.get("action");wpdiscuzAjaxObj.dataFilterCallbacks&&wpdiscuzAjaxObj.dataFilterCallbacks[n]&&e.each(wpdiscuzAjaxObj.dataFilterCallbacks[n],(function(e){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]]&&(o=wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]](o,t,a))}));var i=t?wpdiscuzAjaxObj.url:wpdiscuzAjaxObj.customAjaxUrl;return console.log(i),e.ajax({type:"POST",url:i,data:o,contentType:!1,processData:!1})}e(document).on("click","body",(function(t){if(e(t.target).hasClass("wpd-inline-form-close")||e(t.target).parents(".wpd-inline-form-close").length)t.preventDefault(),e(t.target).parents(".wpd-inline-form-wrapper").hide(),e(t.target).parents(".wpd-inline-shortcode").removeClass("wpd-active"),e(t.target).parents(".wpd-inline-form-wrapper").siblings(".wpd-inline-icon").removeClass("wpd-open");else if(!e(t.target).hasClass("wpd-inline-form-wrapper")&&!e(t.target).parents(".wpd-inline-form-wrapper").length){pe();var a="";e(t.target).hasClass("wpd-inline-icon")?a=e(t.target):e(t.target).parents(".wpd-inline-icon").length&&(a=e(t.target).parents(".wpd-inline-icon")),a.length&&a.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&(a.parents(".wpd-inline-shortcode").addClass("wpd-active"),a.siblings(".wpd-inline-form-wrapper").show(),a.addClass("wpd-open"),a.removeClass("wpd-ignored"),le(a.siblings(".wpd-inline-form-wrapper")))}(!e(t.target).hasClass("wpd-last-inline-comments-wrapper")&&!e(t.target).parents(".wpd-last-inline-comments-wrapper").length||e(t.target).parents(".wpd-last-inline-comments-wrapper").length&&e(t.target).hasClass("wpd-load-inline-comment"))&&e(".wpd-last-inline-comments-wrapper").remove()})),e("body").on("click",".wpd-inline-submit.wpd\_not\_clicked",(function(t){t.preventDefault();var a=e(this),o=e(this).parents(".wpd\_inline\_comm\_form");if(o[0].checkValidity()){e(this).removeClass("wpd\_not\_clicked");var n=new FormData;n.append("action","wpdAddInlineComment"),n.append("inline\_form\_id",ce(o)),e.each(e("input, textarea",o),(function(t,a){"checkbox"===this.type?e(this).is(":checked")&&n.append(e(a).attr("name"),e(a).val()):n.append(e(a).attr("name"),e(a).val())})),ue(v,!0,n).done((function(t){if(a.addClass("wpd\_not\_clicked"),"object"==typeof t)if(t.success){o[0].reset(),pe();var n=parseInt(t.data.newCount),i=a.parents(".wpd-inline-icon-wrapper").find(".wpd-inline-icon-count");i.text(n),n?i.addClass("wpd-has-comments"):i.removeClass("wpd-has-comments"),t.data.allCommentsCountNew=parseInt(t.data.allCommentsCountNew),e(".wpd-thread-info").html(t.data.allCommentsCountBeforeThreadsHtml),e(".wpd-thread-info").attr("data-comments-count",t.data.allCommentsCountNew),e("#wpd-bubble-all-comments-count").replaceWith(t.data.allCommentsCountBubbleHtml),t.data.message&&oe(t.data.message),wpdiscuzAjaxObj.setCommentMessage(t.data.notification,"success")}else t.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data,a),"error");else wpdiscuzAjaxObj.setCommentMessage(t,"error");e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("keydown",".wpd-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_comm\_submit").trigger("click")})),e("body").on("keydown","#wpdiscuz-edit-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_save\_edited\_comment").trigger("click")})),e("body").on("keydown",".wpd-inline-comment-content",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).parents(".wpd\_inline\_comm\_form").find(".wpd-inline-submit.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-inline-icon-count.wpd-has-comments",(function(){var t=e(this),a=new FormData;a.append("action","wpdGetLastInlineComments"),a.append("inline\_form\_id",ce(t)),ue(v,!0,a).done((function(a){"object"==typeof a?a.success?e(a.data).insertAfter(t):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-view-all-inline-comments",(function(t){t.preventDefault(),e(this).parents(".wpd-last-inline-comments-wrapper").remove(),e(".wpdf-inline").hasClass("wpdf-active")||e(".wpdf-inline").trigger("click"),te(),e("html, body").animate({scrollTop:e(".wpdf-inline").offset().top-I},1e3,ae)})),e("body").on("click",".wpd-feedback-content-link",(function(t){t.preventDefault();var a=e(this).data("feedback-content-id");te(),e("html, body").animate({scrollTop:e("#wpd-inline-"+a).offset().top-(I+6)},1e3,(function(){ae(),e("#wpd-inline-"+a).addClass("wpd-active")}))})),"scroll\_open"!==A&&"blink"!==A||(re(),e(window).on("scroll",re)),e("body").on("click","#wpd-post-rating.wpd-not-rated .wpd-rate-starts svg",(function(){var t=new FormData,a=e(this).index();a>=0&&a<5&&(t.append("action","wpdUserRate"),t.append("rating",a+1),ue(v,!0,t).done((function(t){"object"==typeof t?(t.success?location.reload(!0):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data),"error"),we(t)):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})))})),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){t.preventDefault();var a=e(this);const o=e("#wpdiscuz\_subscription\_button",a);if(a[0].checkValidity()&&(d=a,s=!0,"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&!e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).val().length?(s=!1,e(".wpdiscuz-recaptcha",d).css("border","1px solid red")):"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&e(".wpdiscuz-recaptcha",d).css("border","none"),s)&&o.hasClass("wpd\_not\_clicked")){o.removeClass("wpd\_not\_clicked");var i=new FormData;i.append("action","wpdAddSubscription"),e("\*",a).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&i.append(this.name+"",e(this).val()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):wpdiscuzAjaxObj.setCommentMessage(t,"error"),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1,o.addClass("wpd\_not\_clicked")})).fail((function(t,a,n){console.log(n),o.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}var d,s})),e("body").on("click",".wpd-unsubscribe",(function(t){t.preventDefault();var a=new FormData;a.append("action","wpdUnsubscribe"),a.append("sid",e(this).data("sid")),a.append("skey",e(this).data("skey")),ue(v,!0,a).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),wpdiscuzAjaxObj.resetActiveFilters=function(t){e(".wpd-filter.wpdf-active"+(t?":not("+t+")":"")).removeClass("wpdf-active")},wpdiscuzAjaxObj.getAjaxObj=ue}));var onloadCallback=function(){if(document.getElementById("wpdiscuz-recaptcha-0\_0")&&"2.0"===wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.render("wpdiscuz-recaptcha-0\_0",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(e){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("key")},"expired-callback":function(){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}; |
  | 7 | 7 | /\* Colorbox \*/ |
  | 8 | 8 | !function(t,e,i){var o,n,r,h,a,s,l,c,d,g,f,u,p,m,w,v,y,x,b,T,C,H,k,W,E,I,M,L,R,S,K,P,B,O={html:!1,photo:!1,iframe:!1,inline:!1,transition:"elastic",speed:300,fadeOut:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,opacity:.9,preloading:!0,className:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:void 0,closeButton:!0,fastIframe:!0,open:!1,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).\*)?$/i,retinaImage:!1,retinaUrl:!1,retinaSuffix:"@2x.$1",current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",returnFocus:!0,trapFocus:!0,onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,rel:function(){return this.rel},href:function(){return t(this).attr("href")},title:function(){return this.title},createImg:function(){var e=new Image,i=t(this).data("cbox-img-attrs");return"object"==typeof i&&t.each(i,function(t,i){e[t]=i}),e},createIframe:function(){var i=e.createElement("iframe"),o=t(this).data("cbox-iframe-attrs");return"object"==typeof o&&t.each(o,function(t,e){i[t]=e}),"frameBorder"in i&&(i.frameBorder=0),"allowTransparency"in i&&(i.allowTransparency="true"),i.name=(new Date).getTime(),i.allowFullscreen=!0,i}},\_="colorbox",j="cbox",D=j+"Element",F=j+"\_open",N=j+"\_load",z=j+"\_complete",A=j+"\_cleanup",q=j+"\_closed",U=j+"\_purge",$=t("<a/>"),G="div",Q=0,J={};function V(i,o,n){var r=e.createElement(i);return o&&(r.id=j+o),n&&(r.style.cssText=n),t(r)}function X(){return i.innerHeight?i.innerHeight:t(i).height()}function Y(e,i){i!==Object(i)&&(i={}),this.cache={},this.el=e,this.value=function(e){var o;return void 0===this.cache[e]&&(void 0!==(o=t(this.el).attr("data-cbox-"+e))?this.cache[e]=o:void 0!==i[e]?this.cache[e]=i[e]:void 0!==O[e]&&(this.cache[e]=O[e])),this.cache[e]},this.get=function(t){var e=this.value(t);return"function"==typeof e?e.call(this.el,this):e}}function Z(t){var e=d.length,i=(I+t)%e;return i<0?e+i:i}function tt(t,e){return Math.round((/%/.test(t)?("x"===e?g.width():X())/100:1)\*parseInt(t,10))}function et(t,e){return t.get("photo")||t.get("photoRegex").test(e)}function it(t,e){return t.get("retinaUrl")&&i.devicePixelRatio>1?e.replace(t.get("photoRegex"),t.get("retinaSuffix")):e}function ot(t){"contains"in n[0]&&!n[0].contains(t.target)&&t.target!==o[0]&&(t.stopPropagation(),n.trigger("focus"))}function nt(t){nt.str!==t&&(n.add(o).removeClass(nt.str).addClass(t),nt.str=t)}function rt(i){t(e).trigger(i),$.triggerHandler(i)}var ht=function(){var t,e,i=j+"Slideshow\_",o="click."+j;function r(){clearTimeout(e)}function h(){(C.get("loop")||d[I+1])&&(r(),e=setTimeout(P.next,C.get("slideshowSpeed")))}function a(){v.html(C.get("slideshowStop")).off(o).one(o,s),$.on(z,h).on(N,r),n.removeClass(i+"off").addClass(i+"on")}function s(){r(),$.off(z,h).off(N,r),v.html(C.get("slideshowStart")).off(o).one(o,function(){P.next(),a()}),n.removeClass(i+"on").addClass(i+"off")}function l(){t=!1,v.hide(),r(),$.off(z,h).off(N,r),n.removeClass(i+"off "+i+"on")}return function(){t?C.get("slideshow")||($.off(A,l),l()):C.get("slideshow")&&d[1]&&(t=!0,$.one(A,l),C.get("slideshowAuto")?a():s(),v.show())}}();function at(r){var g,w;if(!S){if(g=t(r).data(\_),C=new Y(r,g),w=C.get("rel"),I=0,w&&!1!==w&&"nofollow"!==w?(d=t("."+D).filter(function(){return new Y(this,t.data(this,\_)).get("rel")===w}),-1===(I=d.index(C.el))&&(d=d.add(C.el),I=d.length-1)):d=t(C.el),!L){L=R=!0,nt(C.get("className")),n.css({visibility:"hidden",display:"block",opacity:""}),f=V(G,"LoadedContent","width:0; height:0; overflow:hidden; visibility:hidden"),h.css({width:"",height:""}).append(f),H=a.height()+c.height()+h.outerHeight(!0)-h.height(),k=s.width()+l.width()+h.outerWidth(!0)-h.width(),W=f.outerHeight(!0),E=f.outerWidth(!0);var v=tt(C.get("initialWidth"),"x"),y=tt(C.get("initialHeight"),"y"),x=C.get("maxWidth"),B=C.get("maxHeight");C.w=Math.max((!1!==x?Math.min(v,tt(x,"x")):v)-E-k,0),C.h=Math.max((!1!==B?Math.min(y,tt(B,"y")):y)-W-H,0),f.css({width:"",height:C.h}),P.position(),rt(F),C.get("onOpen"),T.add(m).hide(),n.trigger("focus"),C.get("trapFocus")&&e.addEventListener&&(e.addEventListener("focus",ot,!0),$.one(q,function(){e.removeEventListener("focus",ot,!0)})),C.get("returnFocus")&&$.one(q,function(){t(C.el).trigger("focus")})}var O=parseFloat(C.get("opacity"));o.css({opacity:O==O?O:"",cursor:C.get("overlayClose")?"pointer":"",visibility:"visible"}).show(),C.get("closeButton")?b.html(C.get("close")).appendTo(h):b.appendTo("<div/>"),function(){var e,o,n,r=P.prep,h=++Q;R=!0,M=!1,rt(U),rt(N),C.get("onLoad"),C.h=C.get("height")?tt(C.get("height"),"y")-W-H:C.get("innerHeight")&&tt(C.get("innerHeight"),"y"),C.w=C.get("width")?tt(C.get("width"),"x")-E-k:C.get("innerWidth")&&tt(C.get("innerWidth"),"x"),C.mw=C.w,C.mh=C.h,C.get("maxWidth")&&(C.mw=tt(C.get("maxWidth"),"x")-E-k,C.mw=C.w&&C.w<C.mw?C.w:C.mw);C.get("maxHeight")&&(C.mh=tt(C.get("maxHeight"),"y")-W-H,C.mh=C.h&&C.h<C.mh?C.h:C.mh);if(e=C.get("href"),K=setTimeout(function(){p.show()},100),C.get("inline")){var a=t(e).eq(0);n=t("<div>").hide().insertBefore(a),$.one(U,function(){n.replaceWith(a)}),r(a)}else C.get("iframe")?r(" "):C.get("html")?r(C.get("html")):et(C,e)?(e=it(C,e),M=C.get("createImg"),t(M).addClass(j+"Photo").on("error."+j,function(){r(V(G,"Error").html(C.get("imgError")))}).one("load",function(){h===Q&&setTimeout(function(){var e;C.get("retinaImage")&&i.devicePixelRatio>1&&(M.height=M.height/i.devicePixelRatio,M.width=M.width/i.devicePixelRatio),C.get("scalePhotos")&&(o=function(){M.height-=M.height\*e,M.width-=M.width\*e},C.mw&&M.width>C.mw&&(e=(M.width-C.mw)/M.width,o()),C.mh&&M.height>C.mh&&(e=(M.height-C.mh)/M.height,o())),C.h&&(M.style.marginTop=Math.max(C.mh-M.height,0)/2+"px"),d[1]&&(C.get("loop")||d[I+1])&&(M.style.cursor="pointer",t(M).on("click."+j,function(){P.next()})),M.style.width=M.width+"px",M.style.height=M.height+"px",r(M)},1)}),M.src=e):e&&u.load(e,C.get("data"),function(e,i){h===Q&&r("error"===i?V(G,"Error").html(C.get("xhrError")):t(this).contents())})}()}}function st(){n||(B=!1,g=t(i),n=V(G).attr({id:\_,class:!1===t.support.opacity?j+"IE":"",role:"dialog",tabindex:"-1"}).hide(),o=V(G,"Overlay").hide(),p=t([V(G,"LoadingOverlay")[0],V(G,"LoadingGraphic")[0]]),r=V(G,"Wrapper"),h=V(G,"Content").append(m=V(G,"Title"),w=V(G,"Current"),x=t('<button type="button"/>').attr({id:j+"Previous"}),y=t('<button type="button"/>').attr({id:j+"Next"}),v=t('<button type="button"/>').attr({id:j+"Slideshow"}),p),b=t('<button type="button"/>').attr({id:j+"Close"}),r.append(V(G).append(V(G,"TopLeft"),a=V(G,"TopCenter"),V(G,"TopRight")),V(G,!1,"clear:left").append(s=V(G,"MiddleLeft"),h,l=V(G,"MiddleRight")),V(G,!1,"clear:left").append(V(G,"BottomLeft"),c=V(G,"BottomCenter"),V(G,"BottomRight"))).find("div div").css({float:"left"}),u=V(G,!1,"position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;"),T=y.add(x).add(w).add(v)),e.body&&!n.parent().length&&t(e.body).append(o,n.append(r,u))}function lt(){function i(t){t.which>1||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey||(t.preventDefault(),at(this))}return!!n&&(B||(B=!0,y.on("click",function(){P.next()}),x.on("click",function(){P.prev()}),b.on("click",function(){P.close()}),o.on("click",function(){C.get("overlayClose")&&P.close()}),t(e).on("keydown."+j,function(t){var e=t.keyCode;L&&C.get("escKey")&&27===e&&(t.preventDefault(),P.close()),L&&C.get("arrowKey")&&d[1]&&!t.altKey&&(37===e?(t.preventDefault(),x.trigger("click")):39===e&&(t.preventDefault(),y.trigger("click")))}),"function"==typeof t.fn.on?t(e).on("click."+j,"."+D,i):t("."+D).live("click."+j,i)),!0)}t[\_]||(t(st),(P=t.fn[\_]=t[\_]=function(e,i){var o=this;return e=e||{},"function"==typeof o&&(o=t("<a/>"),e.open=!0),o[0]?(st(),lt()&&(i&&(e.onComplete=i),o.each(function(){var i=t.data(this,\_)||{};t.data(this,\_,t.extend(i,e))}).addClass(D),new Y(o[0],e).get("open")&&at(o[0])),o):o}).position=function(e,i){var o,d,f,u=0,p=0,m=n.offset();function w(){a[0].style.width=c[0].style.width=h[0].style.width=parseInt(n[0].style.width,10)-k+"px",h[0].style.height=s[0].style.height=l[0].style.height=parseInt(n[0].style.height,10)-H+"px"}if(g.off("resize."+j),n.css({top:-9e4,left:-9e4}),d=g.scrollTop(),f=g.scrollLeft(),C.get("fixed")?(m.top-=d,m.left-=f,n.css({position:"fixed"})):(u=d,p=f,n.css({position:"absolute"})),!1!==C.get("right")?p+=Math.max(g.width()-C.w-E-k-tt(C.get("right"),"x"),0):!1!==C.get("left")?p+=tt(C.get("left"),"x"):p+=Math.round(Math.max(g.width()-C.w-E-k,0)/2),!1!==C.get("bottom")?u+=Math.max(X()-C.h-W-H-tt(C.get("bottom"),"y"),0):!1!==C.get("top")?u+=tt(C.get("top"),"y"):u+=Math.round(Math.max(X()-C.h-W-H,0)/2),n.css({top:m.top,left:m.left,visibility:"visible"}),r[0].style.width=r[0].style.height="9999px",o={width:C.w+E+k,height:C.h+W+H,top:u,left:p},e){var v=0;t.each(o,function(t){o[t]===J[t]||(v=e)}),e=v}J=o,e||n.css(o),n.dequeue().animate(o,{duration:e||0,complete:function(){w(),R=!1,r[0].style.width=C.w+E+k+"px",r[0].style.height=C.h+W+H+"px",C.get("reposition")&&setTimeout(function(){g.on("resize."+j,P.position)},1),"function"==typeof i&&i()},step:w})},P.resize=function(t){var e;L&&((t=t||{}).width&&(C.w=tt(t.width,"x")-E-k),t.innerWidth&&(C.w=tt(t.innerWidth,"x")),f.css({width:C.w}),t.height&&(C.h=tt(t.height,"y")-W-H),t.innerHeight&&(C.h=tt(t.innerHeight,"y")),t.innerHeight||t.height||(e=f.scrollTop(),f.css({height:"auto"}),C.h=f.height()),f.css({height:C.h}),e&&f.scrollTop(e),P.position("none"===C.get("transition")?0:C.get("speed")))},P.prep=function(i){if(L){var o,r="none"===C.get("transition")?0:C.get("speed");f.remove(),(f=V(G,"LoadedContent").append(i)).hide().appendTo(u.show()).css({width:(C.w=C.w||f.width(),C.w=C.mw&&C.mw<C.w?C.mw:C.w,C.w),overflow:C.get("scrolling")?"auto":"hidden"}).css({height:(C.h=C.h||f.height(),C.h=C.mh&&C.mh<C.h?C.mh:C.h,C.h)}).prependTo(h),u.hide(),t(M).css({float:"none"}),nt(C.get("className")),o=function(){var i,o,h=d.length;function a(){!1===t.support.opacity&&n[0].style.removeAttribute("filter")}L&&(o=function(){clearTimeout(K),p.hide(),rt(z),C.get("onComplete")},m.html(C.get("title")).show(),f.show(),h>1?("string"==typeof C.get("current")&&w.html(C.get("current").replace("{current}",I+1).replace("{total}",h)).show(),y[C.get("loop")||I<h-1?"show":"hide"]().html(C.get("next")),x[C.get("loop")||I?"show":"hide"]().html(C.get("previous")),ht(),C.get("preloading")&&t.each([Z(-1),Z(1)],function(){var i=d[this],o=new Y(i,t.data(i,\_)),n=o.get("href");n&&et(o,n)&&(n=it(o,n),e.createElement("img").src=n)})):T.hide(),C.get("iframe")?(i=C.get("createIframe"),C.get("scrolling")||(i.scrolling="no"),t(i).attr({src:C.get("href"),class:j+"Iframe"}).one("load",o).appendTo(f),$.one(U,function(){i.src="//about:blank"}),C.get("fastIframe")&&t(i).trigger("load")):o(),"fade"===C.get("transition")?n.fadeTo(r,1,a):a())},"fade"===C.get("transition")?n.fadeTo(r,0,function(){P.position(0,o)}):P.position(r,o)}},P.next=function(){!R&&d[1]&&(C.get("loop")||d[I+1])&&(I=Z(1),at(d[I]))},P.prev=function(){!R&&d[1]&&(C.get("loop")||I)&&(I=Z(-1),at(d[I]))},P.close=function(){L&&!S&&(S=!0,L=!1,rt(A),C.get("onCleanup"),g.off("."+j),o.fadeTo(C.get("fadeOut")||0,0),n.stop().fadeTo(C.get("fadeOut")||0,0,function(){n.hide(),o.hide(),rt(U),f.remove(),setTimeout(function(){S=!1,rt(q),C.get("onClosed")},1)}))},P.remove=function(){n&&(n.stop(),t[\_].close(),n.stop(!1,!0).remove(),o.remove(),S=!1,n=null,t("."+D).removeData(\_).removeClass(D),t(e).off("click."+j).off("keydown."+j))},P.element=function(){return t(C.el)},P.settings=O)}(jQuery,document,window); |
* ## [wpdiscuz/trunk/assets/js/wpdiscuz-combo.min.js](/changeset/3124810/wpdiscuz/trunk/assets/js/wpdiscuz-combo.min.js "Show the changeset 3124810 restricted to wpdiscuz/trunk/assets/js/wpdiscuz-combo.min.js")

  | [r3106072](/browser/wpdiscuz/trunk/assets/js/wpdiscuz-combo.min.js?rev=3106072#L8 "Show revision 3106072 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/assets/js/wpdiscuz-combo.min.js?rev=3124810#L8 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | jQuery.fn.autoGrow=function(){return this.each(function(){var createMirror=function(textarea){jQuery(textarea).after('<div class="autogrow-textarea-mirror"></div>');return jQuery(textarea).next(".autogrow-textarea-mirror")[0]};var sendContentToMirror=function(textarea){mirror.innerHTML=String(textarea.value).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/g,"<br />")+".<br/>.";if(jQuery(textarea).height()!=jQuery(mirror).height())jQuery(textarea).height(jQuery(mirror).height())};var growTextarea=function(){sendContentToMirror(this)};var mirror=createMirror(this);mirror.style.display="none";mirror.style.wordWrap="break-word";mirror.style.padding=jQuery(this).css("padding");mirror.style.width=jQuery(this).css("width");mirror.style.fontFamily=jQuery(this).css("font-family");mirror.style.fontSize=jQuery(this).css("font-size");mirror.style.lineHeight=jQuery(this).css("line-height");this.style.overflow="hidden";this.style.minHeight=this.rows+"em";this.onkeydown=growTextarea;sendContentToMirror(this)})}; |
  | 9 | 9 | /\* wpDiscuz \*/ |
  | 10 |  | var wpdiscuzLoadRichEditor=parseInt(wpdiscuzAjaxObj.loadRichEditor);if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap"))var wpDiscuzEditor=new WpdEditor;function wpdMessagesOnInit(e,t){wpdiscuzAjaxObj.setCommentMessage(e,t),setTimeout((function(){location.href=location.href.substring(0,location.href.indexOf("wpdiscuzUrlAnchor")-1)}),3e3)}wpdiscuzAjaxObj.setCommentMessage=function(e,t,a){var o="wpdiscuz-message-error";if(e instanceof Array)for(var n in e)t instanceof Array?"success"===t[n]?o="wpdiscuz-message-success":"warning"===t[n]&&(o="wpdiscuz-message-warning"):"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e[n]).prependTo("#wpdiscuz-comment-message").delay(a instanceof Array?a[n]:a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}));else"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e).prependTo("#wpdiscuz-comment-message").delay(a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}))},wpdiscuzAjaxObj.applyFilterOnPhrase=function(e,t,a){return wpdiscuzAjaxObj.phraseFilters&&jQuery.each(wpdiscuzAjaxObj.phraseFilters,(function(o){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]]&&(e=wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]](e,t,a))})),e},jQuery(document).ready((function(e){e("body").addClass("wpdiscuz\_"+wpdiscuzAjaxObj.version);var t=wpdiscuzAjaxObj.is\_user\_logged\_in,a=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!t,o=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&t,n=wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion,i=parseInt(wpdiscuzAjaxObj.commentListLoadType),d=parseInt(wpdiscuzAjaxObj.wc\_post\_id),s=parseInt(wpdiscuzAjaxObj.commentListUpdateType),c=1e3\*parseInt(wpdiscuzAjaxObj.commentListUpdateTimer),p=parseInt(wpdiscuzAjaxObj.liveUpdateGuests),r=wpdiscuzAjaxObj.loadLastCommentId,l=r,m=parseInt(wpdiscuzAjaxObj.firstLoadWithAjax);Cookies.get("wpdiscuz\_comments\_sorting")&&Cookies.remove("wpdiscuz\_comments\_sorting",{path:""}),Cookies.get("wordpress\_last\_visit")&&Cookies.remove("wordpress\_last\_visit",{path:""}),Cookies.get("wpdiscuz\_last\_visit")&&Cookies.remove("wpdiscuz\_last\_visit",{path:""});var w,u=parseInt(wpdiscuzAjaxObj.wordpressIsPaginate),f=wpdiscuzAjaxObj.storeCommenterData,h=(parseInt(wpdiscuzAjaxObj.wmuEnabled),wpdiscuzAjaxObj.isCookiesEnabled),b=!0,\_=wpdiscuzAjaxObj.cookiehash,g=parseInt(wpdiscuzAjaxObj.isLoadOnlyParentComments),z=parseInt(wpdiscuzAjaxObj.enableDropAnimation)?500:0,v=parseInt(wpdiscuzAjaxObj.isNativeAjaxEnabled),j=parseInt(wpdiscuzAjaxObj.enableBubble),x=parseInt(wpdiscuzAjaxObj.bubbleLiveUpdate),C=parseInt(wpdiscuzAjaxObj.bubbleHintTimeout),y=parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout)?parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout):5,k=parseInt(wpdiscuzAjaxObj.bubbleShowNewCommentMessage),O=wpdiscuzAjaxObj.bubbleLocation,A=wpdiscuzAjaxObj.inlineFeedbackAttractionType,I=(I=parseInt(wpdiscuzAjaxObj.scrollSize))||32,T=[],D=[],E=[],F=!1,M=1,L=e("html").css("scroll-behavior"),R=e("body").css("scroll-behavior");(e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").length?e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").length?e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .social\_connect\_form").length?e(".wc\_social\_plugin\_wrapper .social\_connect\_form").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .oneall\_social\_login\_providers").length&&e(".wc\_social\_plugin\_wrapper .oneall\_social\_login .oneall\_social\_login\_providers").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"),wpdiscuzLoadRichEditor&&e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0"),window.addEventListener("beforeunload",(function(t){var a=e(".wpd-form").not(":hidden");if(a.length)if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap")){for(var o=0;o<a.length;o++)if("\n"!==wpDiscuzEditor.createEditor(e(a[o]).find(".ql-container").attr("id")).getText())return t.preventDefault(),void(t.returnValue="")}else for(o=0;o<a.length;o++)if(e(a[o]).find(".wc\_comment").val())return t.preventDefault(),void(t.returnValue="")})),wpdiscuzLoadRichEditor||(e(document).delegate("textarea.wc\_comment","input",(function(){me(e(this))})),e.each(e("textarea.wc\_comment"),(function(){me(e(this))}))),e("body").on("focus","#wpdcom .ql-editor, #wpdcom .wc\_comment",(function(){e(".wpd-form-foot",e(this).parents(".wpd\_comm\_form")).slideDown(z)})),e("body").on("focus","#wpdcom textarea",(function(){e(this).next(".autogrow-textarea-mirror").length||e(this).autoGrow()})),t)||q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)});if(e(".wpd-vote-down.wpd-dislike-hidden").remove(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd"),e("body").on("click","#wpd-editor-source-code-wrapper-bg",(function(){e(this).hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),wpdiscuzLoadRichEditor&&e("body").on("click","#wpd-insert-source-code",(function(){var t=wpDiscuzEditor.createEditor("#"+e("#wpd-editor-uid").val());t.deleteText(0,t.getLength(),Quill.sources.USER);var a=e("#wpd-editor-source-code").val();a.length&&t.clipboard.dangerouslyPasteHTML(0,a,Quill.sources.USER),t.update(),e("#wpd-editor-source-code-wrapper-bg").hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),e("body").on("click",".wpd-reply-button",(function(){var i=$(e(this),0);e(this).hasClass("wpdiscuz-clonned")?(wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+i).focus()}),z):setTimeout((function(){e("#wc-textarea-"+i).trigger("focus")}),z),e("#wpd-secondary-form-wrapper-"+i).slideToggle(z)):function(a){var o=$(a,0);e("#wpdiscuz\_form\_anchor-"+o).before(function(t){return e("#wpdiscuz\_hidden\_secondary\_form").html().replace(/wpdiscuzuniqueid/g,t)}(o));var n=e("#wpd-secondary-form-wrapper-"+o);if(!t){q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)})}wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+o).focus()}),z):setTimeout((function(){e("#wc-textarea-"+o).trigger("focus")}),z);n.slideToggle(z,(function(){a.addClass("wpdiscuz-clonned")}))}(e(this)),function(t){if((a||o)&&"2.0"===n){var i=X(t);setTimeout((function(){if(!D[i])try{D[i]=grecaptcha.render("wpdiscuz-recaptcha-"+t,{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(a){e("#wpdiscuz-recaptcha-field-"+t).val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-"+t).val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3)}}(i)})),e("body").on("click","#wpdcom [data-wpd-clipboard]",(function(){var t=e(this).data("wpd-clipboard");e(this).data("wpd-ismention")&&(t="@"+t);var a=e("<input/>");a.appendTo("body").css({position:"absolute",top:"-10000000px"}).val(t),a.trigger("select"),document.execCommand("copy"),a.remove(),wpdiscuzAjaxObj.setCommentMessage(t+"<br/>"+wpdiscuzAjaxObj.wc\_copied\_to\_clipboard,"success",5e3)})),e("body").on("click",".wpdiscuz-nofollow,.wc\_captcha\_refresh\_img,.wpd-load-more-submit",(function(e){e.preventDefault()})),e("body").on("click",".wpd-toggle.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked");var a=$(e(this),0),o=e(this),n=e(".fas",o);!o.parents(".wpd-comment:not(.wpd-reply)").children(".wpd-reply").length&&g?function(t,a){var o=X(t),n=new FormData;n.append("action","wpdShowReplies"),n.append("commentId",o),ue(v,!0,n).done((function(o){a.addClass("wpd\_not\_clicked"),"object"==typeof o&&o.success&&(e("#wpd-comm-"+t).replaceWith(o.data.comment\_list),e("#wpd-comm-"+t+" .wpd-toggle .fas").removeClass("fa-chevron-down").addClass("fa-chevron-up"),e("#wpd-comm-"+t+" .wpd-toggle .wpd-view-replies .wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),e("#wpd-comm-"+t+" .wpd-toggle").attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text),we(o)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,o,n){console.log(n),a.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}(a,t):e("#wpd-comm-"+a+"> .wpd-reply").slideToggle(700,(function(){e(this).is(":hidden")?(n.removeClass("fa-chevron-up"),n.addClass("fa-chevron-down"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_show\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_show\_replies\_text)):(n.removeClass("fa-chevron-down"),n.addClass("fa-chevron-up"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text)),t.addClass("wpd\_not\_clicked")}))})),e("body").on("mouseenter",".wpd-new-loaded-comment",(function(){e(this).removeClass("wpd-new-loaded-comment")})),e("body").on("click",".wpd-sbs-toggle",(function(){e(".wpdiscuz-subscribe-bar").slideToggle(z)})),parseInt(wpdiscuzAjaxObj.wpDiscuzIsShowOnSubscribeForm)&&!t&&wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&e("#wpdiscuz-subscribe-form").length&&("2.0"===n?(setTimeout((function(){try{grecaptcha.render("wpdiscuz-recaptcha-subscribe-form",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-subscribe-form").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val()?e(".wpdiscuz-recaptcha",e(this)).css("border","none"):(e(".wpdiscuz-recaptcha",e(this)).css("border","1px solid red"),ee(e(this),""),t.preventDefault())}))):"3.0"===n&&e("body").on("click","#wpdiscuz\_subscription\_button",(function(t){var a=e(this).parents("#wpdiscuz-subscribe-form");ee(a,""),t.preventDefault();try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/wpdAddSubscription"}).then((function(e){document.getElementById("wpdiscuz-recaptcha-field-subscribe-form").value=e,a.trigger("submit")}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error")}}))),(a||o)&&"2.0"===n){var S=e(window).width(),H=e("#wpdcom").width();H>=1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"65%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"35%"})),H>=940&&H<1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"60%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"40%"})),H>=810&&H<940&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"60%"})),H>=730&&H<810&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"45%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"55%"})),H>=610&&H<730&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.85)","-webkit-transform":"scale(0.85)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"43%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"55%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"})),S>650&&(H>=510&&H<610&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"35%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"63%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%",position:"relative",right:"-60px"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H>=470&&H<510&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"60%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd\_main\_comm\_form .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H<470&&(e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({margin:"0px auto","transform-origin":"center 0","-webkit-transform-origin":"center 0"}),e("#wpdcom .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc\_notification\_checkboxes").css({"text-align":"center"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-field-submit").css({"text-align":"center"})))}function P(t,a,o){ue(v,!1,a).done((function(a){if(e(o).addClass("wpd\_not\_clicked"),"object"==typeof a)if(a.success){"collapsed"===wpdiscuzAjaxObj.commentFormView&&e(".wpd-form-foot",t).slideUp(z),a.data.wc\_all\_comments\_count\_new=parseInt(a.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(a.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(a.data.wc\_all\_comments\_count\_bubble\_html);var n=z;a.data.is\_main?oe(a.data.message):(n=z+700,e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).slideToggle(700),1==a.data.is\_in\_same\_container?e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).after(a.data.message):e("#wpd-comm-"+a.data.uniqueid).after(a.data.message)),function(e){if(!e.data.held\_moderate){var t=new FormData;t.append("action","wpdCheckNotificationType"),t.append("comment\_id",e.data.new\_comment\_id),t.append("email",e.data.comment\_author\_email),t.append("isParent",e.data.is\_main),ue(v,!0,t)}}(a),function(e){if(e.data.redirect>0&&e.data.new\_comment\_id){var t=new FormData;t.append("action","wpdRedirect"),t.append("commentId",e.data.new\_comment\_id),ue(v,!0,t).done((function(e){"object"==typeof e&&e.success&&setTimeout((function(){location.href=e.data}),2e3)})).fail((function(e,t,a){console.log(a)}))}}(a),h&&b?function(t){var a=t.comment\_author\_email,o=t.comment\_author,n=t.comment\_author\_url;null==f?(Cookies.set("comment\_author\_email\_"+\_,a),Cookies.set("comment\_author\_"+\_,o),n.length&&Cookies.set("comment\_author\_url\_"+\_,n)):(f=parseInt(f),Cookies.set("comment\_author\_email\_"+\_,a,{expires:f,path:"/"}),Cookies.set("comment\_author\_"+\_,o,{expires:f,path:"/"}),n.length&&Cookies.set("comment\_author\_url\_"+\_,n,{expires:f,path:"/"}));e(".wpd-cookies-checkbox").length&&e(".wpd-cookies-checkbox").prop("checked",!0)}(a.data):b||e(".wpd-cookies-checkbox").prop("checked",!1),t.get(0).reset(),wpdiscuzLoadRichEditor?wpDiscuzEditor.createEditor("#wpd-editor-"+e(".wpdiscuz\_unique\_id",t).val()).setContents([{insert:"\n"}]):me(t.find(".wc\_comment")),q(a.data),e(".wmu-preview-wrap",t).remove(),T.length&&(T.forEach((function(e){e.parents(".wpd-field-checkbox").remove()})),T=[]),parseInt(wpdiscuzAjaxObj.scrollToComment)&&setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.new\_comment\_id).offset().top-I},1e3,ae)}),n),we(a,t)~~}else a.data&&(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"),we(a,t));else wpdiscuzAjaxObj.setCommentMessage(a,"error");e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,n){console.log(n),e(o).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}function q(t){e(".wpd\_comm\_form .wc\_name").val(t.comment\_author),t.comment\_author\_email&&t.comment\_author\_email.indexOf("@example.com")<0&&e(".wpd\_comm\_form .wc\_email").val(t.comment\_author\_email),t.comment\_author\_url&&e(".wpd\_comm\_form .wc\_website").val(t.comment\_author\_url)}function U(t,a){e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").show(),e("#wpd-comm-"+t+" .wpdiscuz-edit-form-wrap").replaceWith(a),e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-last-edited").show()}e("body").on("click",".wc\_comm\_submit.wpd\_not\_clicked",(function(){var i=e(this),d=1,s=e(this).parents("form");if("true"!==s.attr("data-uploading")){if(s.hasClass("wpd\_main\_comm\_form")||(d=function(t){var a=t.attr("class").split(" "),o="";return e.each(a,(function(e,t){"wpd\_comment\_level"===Y(t,!1)&&(o=Y(t,!0))})),parseInt(o)+1}(e(this).parents(".wpd-comment"))),ee(s,"#wpd-editor-"+e(".wpdiscuz\_unique\_id",s).val()),s.on("submit",(function(e){e.preventDefault()})),s[0].checkValidity()&&(p=s,r=!0,"2.0"===n&&e("input[name=wc\_captcha]",p).length&&!e("input[name=wc\_captcha]",p).val().length?(r=!1,e(".wpdiscuz-recaptcha",p).css("border","1px solid red")):"2.0"===n&&e("input[name=wc\_captcha]",p).length&&e(".wpdiscuz-recaptcha",p).css("border","none"),r)){F=!0,function(t){e(".wpd-agreement-checkbox",t).each((function(){e(this).hasClass("wpd\_agreement\_hide")&&h&&e(this).prop("checked")&&(Cookies.set(e(this).attr("name")+"\_"+\_,1,{expires:30,path:"/"}),e("input[name="+e(this).attr("name")+"]").each((function(){T.push(e(this))})))}))}(s),e(i).removeClass("wpd\_not\_clicked");var c=new FormData;if(c.append("action","wpdAddComment"),e(":input",s).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&c.append(this.name+"",e(this).val().trim()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&c.append(this.name+"",e(this).val())})),c.append("wpd\_comment\_depth",d),wpdiscuzAjaxObj.wpdiscuz\_zs&&c.append("wpdiscuz\_zs",wpdiscuzAjaxObj.wpdiscuz\_zs),e(".wpd-cookies-checkbox",s).length?e(".wpd-cookies-checkbox",s).prop("checked")||(b=!1):t&&(b=!1),e("#wpdiscuz-loading-bar").show(),wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&"3.0"===n&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/addComment"}).then((function(e){c.append("g-recaptcha-response",e),P(s,c,i)}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)}else P(s,c,i)}var p,r;!function(e){if((a||o)&&"2.0"===n){var t=X(e);grecaptcha.reset(D[t])}}(e(".wpdiscuz\_unique\_id",s).val()),e(".wpdiscuz\_reset").val("")}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj.wmuPhraseDoingUpload,"wmuPhraseDoingUpload",s),"warning")})),e("body").on("click",".wpd\_editable\_comment",(function(){w&&e(".wpdiscuz-edit-form-wrap").length&&U($(e(".wpdiscuz-edit-form-wrap"),0),w);var t=e(this),a=$(t,0),o=X(a),n=new FormData;n.append("action","wpdEditComment"),n.append("commentId",o),w=e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-text").get(0),ue(v,!0,n).done((function(o){if("object"==typeof o)if(o.success){if(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text").replaceWith(o.data.html),wpdiscuzLoadRichEditor){var n=wpDiscuzEditor.createEditor("#wpd-editor-edit\_"+a);n.clipboard.dangerouslyPasteHTML(0,o.data.content),n.update(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd")}else e("#wc-textarea-edit\_"+a).val(o.data.content),me(e("#wc-textarea-edit\_"+a));e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").hide(),e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").hide()}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[o.data],o.data,t),"error");else console.log(o);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wc\_save\_edited\_comment",(function(){var t=e(this),a=$(t),o=X(a),n=e("#wpd-comm-"+a+" #wpdiscuz-edit-form");if(ee(n,"#wpd-editor-edit\_"+a),n.on("submit",(function(e){e.preventDefault()})),n[0].checkValidity()){var i=new FormData;i.append("action","wpdSaveEditedComment"),i.append("commentId",o),e(":input",n).each((function(){""!==this.name&&"checkbox"!==this.type&&"radio"!==this.type&&i.append(this.name+"",e(this).val()),"checkbox"!==this.type&&"radio"!==this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(n){"object"==typeof n?(n.success?(U(a,n.data.message),n.data.comment\_approved\_html&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-subheader").append(n.data.comment\_approved\_html),n.data.lastEdited&&(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").remove(),e(n.data.lastEdited).insertAfter("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text")),n.data.twitterShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_tw").attr("href",n.data.twitterShareLink),n.data.whatsappShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_whatsapp").attr("href",n.data.whatsappShareLink),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error"),we(n,o)):wpdiscuzAjaxObj.setCommentMessage(n,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("click",".wc\_cancel\_edit",(function(){var t=$(e(this));U(t,w),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+t)})),!u&&m&&(M=0,1==m?setTimeout((function(){V(!0)}),500):e("body").on("click",".wpd-load-comments",(function(){e(this).parent(".wpd-load-more-submit-wrap").remove(),V(!0)}))),e("body").on("click",".wpd-load-more-submit",(function(){var t=e(this),a="wpd-loaded";t.hasClass(a)&&V(!1,t,a,"wpd-loading")}));var W=!1;function B(){var t=document.getElementById("wpdiscuzHasMoreComments"),a=0;t&&(a=t.dataset.is\_show\_load\_more);var o=document.getElementById("wpdcom")?document.getElementById("wpdcom").clientHeight:0,n=e(window).height()+e(window).scrollTop();o&&n&&(100\*n/o>=80&&!1===W&&1==a&&(W=!0,V(!1,e(".wpd-load-more-submit"))))}function V(t,a,o,n){a&&(a.toggleClass(o),a.toggleClass(n));var d=new FormData;d.append("action","wpdLoadMoreComments");var s=e(".wpdiscuz-sort-button-active").attr("data-sorting");s&&d.append("sorting",s),d.append("offset",M),d.append("lastParentId",e(".wpd-load-more-submit").attr("data-lastparentid")),d.append("isFirstLoad",t?1:0);var c=e(".wpdf-active").attr("data-filter-type");d.append("wpdType",c||""),ue(v,!t||1!=m,d).done((function(d){"object"==typeof d&&d.success&&(M++,t&&e(".wpd-comment").remove(),e(".wpdiscuz\_single").remove(),e(".wpdiscuz-comment-pagination").before(d.data.comment\_list),K(d,t&&2!==i),W=!1,d.data.loadLastCommentId&&(r=d.data.loadLastCommentId),we(d),t&&Q(!1)),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))})).fail((function(t,i,d){console.log(d),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))}))}function K(t,a){var o,n=document.getElementById("wpdiscuzHasMoreComments");if(0==t.data.is\_show\_load\_more)n&&(n.dataset.is\_show\_load\_more=0),e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide();else if(o=t.data.last\_parent\_id,e(".wpd-load-more-submit").attr("data-lastparentid",o),2!==i&&e(".wpdiscuz-comment-pagination").show(),n&&(n.dataset.is\_show\_load\_more=1),a&&e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").show(),t.data.comments\_left>0){if(!e(".wpd-load-more-submit .wpd-comments-left").length){const t=e("<span>");t.addClass("wpd-comments-left"),e(".wpd-load-more-submit").append(t)}e(".wpd-load-more-submit .wpd-comments-left").text(t.data.comments\_left\_text)}we(t)}function Q(t){var a=location.href.match(/#comment\-(\d+)/);if(null!==a){var o=a[1];if(e("#comment-"+o).length)setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+o).parents("[id^=wpd-comm-]").offset().top-I},1e3,ae),t&&N(o)}),500);else{var n=new FormData;n.append("action","wpdGetSingleComment"),n.append("commentId",o),ue(v,!0,n).done((function(a){if("object"==typeof a&&a.success){var n="#comment-"+o;e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e(n).offset().top-I},1e3,ae),t&&N(o)}e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}}}function N(t){setTimeout((function(){e("#comment-"+t).siblings(".wpd-secondary-form-wrapper").is(":visible")||e("#comment-"+t).find(".wpd-reply-button").trigger("click")}),1100)}function G(e){if(void 0!==e.data.message)for(var t,a=e.data.message,o=0;o<a.length;o++)J((t=a[o]).comment\_parent,t.comment\_html)}function $(e,t){var a="";return(a=t?e.parents(".wpd-main-form-wrapper").attr("id"):e.parents(".wpd-comment").attr("id")).substring(a.lastIndexOf("-")+1)}function X(e){return e.substring(0,e.indexOf("\_"))}function Y(e,t){return t?e.substring(e.indexOf("-")+1):e.substring(0,e.indexOf("-"))}function J(t,a){if(0==t)oe(a);else{var o=$(e("#comment-"+t),0);e("#wpdiscuz\_form\_anchor-"+o).after(a)}}function Z(){var t=[];return e(".wpd-comment-right").each((function(){t.push(X($(e(this),0)))})),t.join(",")}function ee(t,a){var o=t.find(".wpd-required-group");wpdiscuzLoadRichEditor&&t.find(".wc\_comment").val(e(a+">.ql-editor").html()),function(e){if("wpdiscuz-subscribe-form"==e.attr("id"))return;var t=e.find(".wc\_comment"),a=t.val().trim().replace(/<p><br><\/p>/g,"\n").replace(/<p>(.\*?)<\/p>/g,"$1\n");a=(a=(a=(a=a.replace(/<img src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img[^>]+alt=["|']([^"|']+)["|'][^>]+src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'][^>]?>/g," $1 ")).replace(/<img\s+([^>]\*)class=["|']wpdem\-sticker["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img\s+([^>]\*)src=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $2 "),t.val(a)}(t),e.each(o,(function(){e("input",this).prop("required",!1),0===e("input:checked",this).length?e("input",e(this)).prop("required",!0):e(".wpd-field-invalid",this).remove()}))}function te(){e("html, body").css("scroll-behavior","unset")}function ae(){e("html").css("scroll-behavior",L),e("body").css("scroll-behavior",R)}function oe(t){e(".wpd-sticky-comment").last()[0]?e(t).insertAfter(e(".wpd-sticky-comment").last()[0]):e(".wpd-thread-list").prepend(t)}function ne(t){t?t.prop("required")||(t.val()?t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none")):e.each(e(".wc\_email"),(function(t,a){var o=e(a);o.prop("required")||(o.val()?o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none"))}))}if(2!==i||u||(e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide(),B(),e(window).scroll((function(){B()}))),wpdiscuzAjaxObj.setLoadMoreVisibility=K,e("body").on("click",".wpd-vote-up.wpd\_not\_clicked, .wpd-vote-down.wpd\_not\_clicked",(function(){var t=e(this);e(t).removeClass("wpd\_not\_clicked");var a,o=X($(t));a=e(this).hasClass("wpd-vote-up")?1:-1;var n=new FormData;n.append("action","wpdVoteOnComment"),n.append("commentId",o),n.append("voteType",a),ue(v,!0,n).done((function(n){if(e(t).addClass("wpd\_not\_clicked"),"object"==typeof n){if(n.success){if("total"===n.data.buttonsStyle){var i=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result"),d=n.data.votes;i.text(n.data.votesHumanReadable),i.attr("title",d),i.removeClass("wpd-up wpd-down"),d>0&&i.addClass("wpd-up"),d<0&&i.addClass("wpd-down")}else{var s=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-like"),c=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-dislike");s.text(n.data.likeCountHumanReadable),s.attr("title",n.data.likeCount),c.text(n.data.dislikeCountHumanReadable),c.attr("title",n.data.dislikeCount),parseInt(n.data.likeCount)>0?s.addClass("wpd-up"):s.removeClass("wpd-up"),parseInt(n.data.dislikeCount)<0?c.addClass("wpd-down"):c.removeClass("wpd-down")}var p=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-up"),r=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-down");p.removeClass("wpd-up"),r.removeClass("wpd-down"),n.data.curUserReaction>0?p.addClass("wpd-up"):n.data.curUserReaction<0&&r.addClass("wpd-down")}else n.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error");we(n,o,a)}else console.log(n);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(t).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e(document).on("click","body",(function(t){var a=e(".wpdiscuz-sort-buttons");e(t.target).hasClass("wpdf-sorting")||e(t.target).parent().hasClass("wpdf-sorting")?a.css({display:a.is(":visible")?"none":"flex"}):a.hide()})),e("body").on("click",".wpdiscuz-sort-button:not(.wpdiscuz-sort-button-active)",(function(){var t=e(this),a=e(this).attr("data-sorting");if(a){e(".wpd-load-comments").parents(".wpd-load-more-submit-wrap").remove(),e(".wpdiscuz-sort-button.wpdiscuz-sort-button-active").removeClass("wpdiscuz-sort-button-active").appendTo(".wpdiscuz-sort-buttons"),t.addClass("wpdiscuz-sort-button-active").prependTo(".wpdf-sorting");var o=new FormData;o.append("action","wpdSorting"),o.append("sorting",a);var n=e(".wpdf-active").attr("data-filter-type");o.append("wpdType",n||""),ue(v,!0,o).done((function(t){"object"==typeof t&&t.success&&(e("#wpdcom .wpd-comment").remove(),e("#wpdcom .wpd-thread-list").prepend(t.data.message),K(t,!1),M=1),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),window.onhashchange=function(){Q(!1)},1!=m&&Q(!1),e("body").on("click",".wpdiscuz-readmore",(function(){var t=$(e(this)),a=X(t),o=new FormData;o.append("action","wpdReadMore"),o.append("commentId",a),ue(v,!0,o).done((function(o){"object"==typeof o?(o.success?(e("#comment-"+a+" .wpd-comment-text").replaceWith(" "+o.data.message),e("#wpdiscuz-readmore-"+t).remove()):console.log(o.data),we(o)):console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("change",".wpd-required-group",(function(){0!==e("input:checked",this).length?e("input",e(this)).prop("required",!1):e("input",e(this)).prop("required",!0)})),e("body").on("click",".wpdiscuz-spoiler",(function(){e(this).next().slideToggle(),e(this).hasClass("wpdiscuz-spoiler-closed")?e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"):e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),e(this).toggleClass("wpdiscuz-spoiler-closed")})),e("body").on("click",".wpd-tools",(function(){var t=e(".wpd-tools-actions",e(this));t.is(":visible")||e(this).parents(".wpd-comment-right").attr("id")!==e("[id^=comment-]","#wpdcom").last().attr("id")||e("#comments").css({paddingBottom:"160px"}),t.css({display:t.is(":visible")?"none":"flex"})})),e("body").on("mouseleave",".wpd-comment-right",(function(){e(this).find(".wpd-tools-actions").hide(),e("#comments").css({paddingBottom:"0"})})),e("body").on("click",".wpd\_stick\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdStickComment"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd\_close\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdCloseThread"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-filter.wpd\_not\_clicked[data-filter-type]",(function(){var t=e(this),a=t.attr("data-filter-type");wpdiscuzAjaxObj.resetActiveFilters(".wpdf-"+a),t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var o=new FormData;o.append("action","wpdLoadMoreComments");var n=e(".wpdiscuz-sort-button-active").attr("data-sorting");n&&o.append("sorting",n),o.append("lastParentId",0),o.append("offset",0),M=1,o.append("wpdType",t.hasClass("wpdf-active")?"":a),o.append("isFirstLoad",1),e(this).hasClass("wpdf-inline")?e(this).hasClass("wpdf-active")?e(".wpd-comment-info-bar").hide():e(".wpd-comment-info-bar").css("display","flex"):e(".wpd-comment-info-bar").hide(),ue(v,!1,o).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(t.toggleClass("wpdf-active"),e(".wpd-load-comments").remove(),e(".wpd-comment").remove(),e(".wpd-thread-list").prepend(a.data.comment\_list),K(a),r=a.data.loadLastCommentId,e(".wpd-load-more-submit").blur(),we(a)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpdf-reacted.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdMostReactedComment"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e("#comment-"+a.data.commentId).length||e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpdf-hottest.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdHottestThread"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.commentId).length?e("#comment-"+a.data.commentId).parents("[id^=wpd-comm-"+a.data.commentId+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpd-filter-view-all",(function(){e(".wpdf-inline.wpdf-active.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-follow-link.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=X($(t,0)),o=new FormData;o.append("action","wpdFollowUser"),o.append("commentId",a),ue(v,!0,o).done((function(a){t.addClass("wpd\_not\_clicked"),"object"==typeof a?a.success?(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data.code],a.data.code,t),"success"),t.removeClass("wpd-follow-active"),a.data.followTip&&t.attr("wpd-tooltip",a.data.followTip),a.data.followClass&&t.addClass(a.data.followClass),we(a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),ne(),e("body").on("keyup",".wc\_email",(function(){ne(e(this))})),j&&e("#wpdcom").length){if(e("#wpd-bubble-wrapper").hover((function(){e(this).addClass("wpd-bubble-hover")}),(function(){e(this).removeClass("wpd-bubble-hover")})),C&&!Cookies.get(wpdiscuzAjaxObj.cookieHideBubbleHint)&&setTimeout((function(){e("#wpd-bubble-wrapper").addClass("wpd-bubble-hover");const t=wpdiscuzAjaxObj.bubbleHintShowOnce?"/":location.href;wpdiscuzAjaxObj.bubbleHintCookieExpires&&parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10);Cookies.set(wpdiscuzAjaxObj.cookieHideBubbleHint,"1",{expires:parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10),path:t}),setTimeout((function(){e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")}),1e3\*y)}),1e3\*C),"content\_left"===O)if(e(".entry-content").length){var ie=(de=Math.min(e(".entry-content").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".post-entry").length){ie=(de=Math.min(e(".post-entry").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".container").length){var de;ie=(de=Math.min(e(".container").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner");else"left\_corner"===O?(e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner")):"right\_corner"===O&&(e("#wpd-bubble-wrapper").css({right:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-right-corner"));e("#wpd-bubble-wrapper").show(),e("body").on("click","#wpd-bubble-add-message-close",(function(t){t.preventDefault(),t.stopPropagation(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")})),e("body").on("click","#wpd-bubble",(function(){te(),e("#tab-title-reviews").length&&e("#tab-title-reviews a").trigger("click"),e("html, body").animate({scrollTop:e("#wpdcom").offset().top-(I+28)},1e3,(function(){ae(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover"),wpdiscuzLoadRichEditor?e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0").focus():e("#wc-textarea-0\_0").length&&e("#wc-textarea-0\_0").trigger("focus")}))})),e("body").on("click","#wpd-bubble-comment-close",(function(t){t.preventDefault(),e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")})),e("body").on("click","#wpd-bubble-comment-reply-link a",(function(){var t=e(this).attr("href");setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),Q~~(!0);var a=t.match(/#comment\-(\d+)/);E=E.filter((function(e){return e!=a[1]})),e("#wpd-bubble-count .wpd-new-comments-count").text(E.length),0==E.length&&e("#wpd-bubble-count").removeClass("wpd-new-comments")}),100)})),e("body").on("click","#wpd-bubble-count",(function(){if(E.length){var t=new FormData;t.append("action","wpdBubbleUpdate"),t.append("newCommentIds",E.join()),ue(v,!0,t).done((function(t){"object"==typeof t&&t.success&&(t.data.message=t.data.message.filter((function(t){if(!e("#comment-"+t.comment\_id).length)return t})),G(t),e("#wpd-bubble-count").removeClass("wpd-new-comments"),e("#wpd-bubble-count .wpd-new-comments-count").text("0"),E=[],e(".wpd-new-loaded-comment").length&&(te(),e("html, body").animate({scrollTop:e(e(".wpd-new-loaded-comment")[0]).offset().top-(I+28)},1e3,ae)),we(t)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(e,t,a){console.log(a)}))}}))}if((j&&x||s)&&(t||!t&&p)&&setTimeout((function t(){e.ajax({type:"GET",url:wpdiscuzAjaxObj.bubbleUpdateUrl,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpdiscuzAjaxObj.restNonce)},data:{postId:d,lastId:l,visibleCommentIds:Z()}}).done((function(a){if(!F)if("object"==typeof a){if(a.commentIDsToRemove.forEach((function(t){e("[id^=wpd-comm-"+t+"]").remove()})),a.ids.length){s&&function(){var t=new FormData;t.append("action","wpdUpdateAutomatically"),t.append("loadLastCommentId",r),t.append("visibleCommentIds",Z()),ue(v,!1,t).done((function(t){F||"object"==typeof t&&t.success&&(G(t),t.data.wc\_all\_comments\_count\_new=parseInt(t.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(t.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",t.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(t.data.wc\_all\_comments\_count\_bubble\_html),r=t.data.loadLastCommentId)})).fail((function(e,t,a){console.log(a)}))}(),a.ids=a.ids.filter((function(t){if(!e("#comment-"+t).length)return t}));var o=5e3;l=parseInt(a.ids[a.ids.length-1]),E=E.concat(a.ids),k&&a.commentText&&(e("#wpd-bubble-author-avatar").html(a.avatar),e("#wpd-bubble-author-name").html(a.authorName),e("#wpd-bubble-comment-date span").html(a.commentDate),e("#wpd-bubble-comment-text").html(a.commentText),e("#wpd-bubble-comment-reply-link a").attr("href",a.commentLink),e("#wpd-bubble-notification-message").show(),o=1e4);var n=parseInt(e(".wpd-new-comments-count").text());n+=a.ids.length,e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),e("#wpd-bubble-wrapper").addClass("wpd-new-comment-added"),setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")}),o),e(".wpd-new-comments-count").text(n),e("#wpd-bubble-count").addClass("wpd-new-comments")}a.all\_comments\_count=parseInt(a.all\_comments\_count),e("#wpd-bubble-all-comments-count").replaceWith(a.all\_comments\_count\_bubble\_html),e(".wpd-reviews-tab").length||(e(".wpd-thread-info").html(a.all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.all\_comments\_count))}else console.log(a);setTimeout(t,c)})).fail((function(e,a,o){console.log(o),setTimeout(t,c)}))}),c),e(".wpd-inline-form-wrapper").length){var se=new FormData;se.append("action","wpdGetInlineCommentForm"),ue(v,!1,se).done((function(t){"object"==typeof t?t.success?(e(".wpd-inline-form-wrapper").append(t.data),e.each(e("[name=\_wpd\_inline\_nonce]"),(function(){var t=e(this).attr("id"),a=e(this).parents(".wpd-inline-shortcode").attr("id");e(this).attr("id",t+"-"+a.substring(a.lastIndexOf("-")+1))})),e(".wpd-inline-opened").addClass("wpd-active"),e(".wpd-inline-opened").find(".wpd-inline-form-wrapper").show(),e(".wpd-inline-opened").find(".wpd-inline-icon").addClass("wpd-open"),e(".wpd-inline-opened").find(".wpd-inline-icon").removeClass("wpd-ignored"),le()):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data]),t.data,"error"):console.log(t)})).fail((function(e,t,a){console.log(a)}))}function ce(t){if(e(t).hasClass("wpd-inline-shortcode"))var a=e(t).attr("id");else a=e(t).parents(".wpd-inline-shortcode").attr("id");return a.substring(a.lastIndexOf("-")+1)}function pe(){e(".wpd-inline-form-wrapper").hide(),e(".wpd-inline-shortcode").removeClass("wpd-active"),e(".wpd-inline-icon").removeClass("wpd-open")}function re(){e.each(e(".wpd-inline-shortcode:not(.wpd-inline-opened) .wpd-inline-icon"),(function(){var t=e(this),a=t.offset().top-window.pageYOffset;t.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&a>0&&a<300&&("blink"===A?(t.addClass("wpd-blink"),setTimeout((function(){t.removeClass("wpd-blink")}),3e3)):(t.parents(".wpd-inline-shortcode").addClass("wpd-active"),t.siblings(".wpd-inline-form-wrapper").show(),t.addClass("wpd-open"),le(t.siblings(".wpd-inline-form-wrapper"))))}))}function le(t){if(t){if(t.offset().left<=10)t.css("left",Math.ceil(parseInt(t.css("left"))-t.offset().left+10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))<3&&(a=3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;");else if(t.offset().left+t.width()>document.body.clientWidth-10){var a;t.css("left",Math.ceil(parseInt(t.css("left"))+(document.body.clientWidth-(t.offset().left+t.width()))-10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))>t.width()-3&&(a=t.width()-3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;")}}else e.each(e(".wpd-inline-form-wrapper:visible"),(function(){if(e(this).offset().left<=10)e(this).css("left",Math.ceil(parseInt(e(this).css("left"))-e(this).offset().left+10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))<3&&(t=3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;");else if(e(this).offset().left+e(this).width()>document.body.clientWidth-10){var t;e(this).css("left",Math.ceil(parseInt(e(this).css("left"))+(document.body.clientWidth-(e(this).offset().left+e(this).width()))-10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))>e(this).width()-3&&(t=e(this).width()-3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;")}}))}function me(t){var a,o=0;if(t.parents(".wpd\_main\_comm\_form").length)o=parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents(".wpd\_main\_comm\_form");else if(t.parents(".wpd-secondary-form-wrapper").length)o=parseInt(wpdiscuzAjaxObj.replyTextMaxLength),a=t.parents(".wpd-secondary-form-wrapper");else if(t.parents("#wpdiscuz-edit-form").length){var n=$(t);o=parseInt(n.substring(n.lastIndexOf("\_")+1))?parseInt(wpdiscuzAjaxObj.replyTextMaxLength):parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents("#wpdiscuz-edit-form")}if(o&&a){var i=t.val().length,d=e(".wpd-editor-char-counter",a),s=o-i;d.html(s),s<=10?d.addClass("error"):d.removeClass("error")}}function we(t,a,o,n){t.data.callbackFunctions&&e.each(t.data.callbackFunctions,(function(e){"function"==typeof wpdiscuzAjaxObj[t.data.callbackFunctions[e]]?wpdiscuzAjaxObj[t.data.callbackFunctions[e]](t,a,o,n):"function"==typeof window[t.data.callbackFunctions[e]]?window[t.data.callbackFunctions[e]](t,a,o,n):console.log(t.data.callbackFunctions[e]+" is not a function")}))}function ue(t,a,o){a&&e("#wpdiscuz-loading-bar").show(),o.append("postId",d);var n=o.get("action");wpdiscuzAjaxObj.dataFilterCallbacks&&wpdiscuzAjaxObj.dataFilterCallbacks[n]&&e.each(wpdiscuzAjaxObj.dataFilterCallbacks[n],(function(e){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]]&&(o=wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]](o,t,a))}));var i=t?wpdiscuzAjaxObj.url:wpdiscuzAjaxObj.customAjaxUrl;return console.log(i),e.ajax({type:"POST",url:i,data:o,contentType:!1,processData:!1})}e(document).on("click","body",(function(t){if(e(t.target).hasClass("wpd-inline-form-close")||e(t.target).parents(".wpd-inline-form-close").length)t.preventDefault(),e(t.target).parents(".wpd-inline-form-wrapper").hide(),e(t.target).parents(".wpd-inline-shortcode").removeClass("wpd-active"),e(t.target).parents(".wpd-inline-form-wrapper").siblings(".wpd-inline-icon").removeClass("wpd-open");else if(!e(t.target).hasClass("wpd-inline-form-wrapper")&&!e(t.target).parents(".wpd-inline-form-wrapper").length){pe();var a="";e(t.target).hasClass("wpd-inline-icon")?a=e(t.target):e(t.target).parents(".wpd-inline-icon").length&&(a=e(t.target).parents(".wpd-inline-icon")),a.length&&a.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&(a.parents(".wpd-inline-shortcode").addClass("wpd-active"),a.siblings(".wpd-inline-form-wrapper").show(),a.addClass("wpd-open"),a.removeClass("wpd-ignored"),le(a.siblings(".wpd-inline-form-wrapper")))}(!e(t.target).hasClass("wpd-last-inline-comments-wrapper")&&!e(t.target).parents(".wpd-last-inline-comments-wrapper").length||e(t.target).parents(".wpd-last-inline-comments-wrapper").length&&e(t.target).hasClass("wpd-load-inline-comment"))&&e(".wpd-last-inline-comments-wrapper").remove()})),e("body").on("click",".wpd-inline-submit.wpd\_not\_clicked",(function(t){t.preventDefault();var a=e(this),o=e(this).parents(".wpd\_inline\_comm\_form");if(o[0].checkValidity()){e(this).removeClass("wpd\_not\_clicked");var n=new FormData;n.append("action","wpdAddInlineComment"),n.append("inline\_form\_id",ce(o)),e.each(e("input, textarea",o),(function(t,a){"checkbox"===this.type?e(this).is(":checked")&&n.append(e(a).attr("name"),e(a).val()):n.append(e(a).attr("name"),e(a).val())})),ue(v,!0,n).done((function(t){if(a.addClass("wpd\_not\_clicked"),"object"==typeof t)if(t.success){o[0].reset(),pe();var n=parseInt(t.data.newCount),i=a.parents(".wpd-inline-icon-wrapper").find(".wpd-inline-icon-count");i.text(n),n?i.addClass("wpd-has-comments"):i.removeClass("wpd-has-comments"),t.data.allCommentsCountNew=parseInt(t.data.allCommentsCountNew),e(".wpd-thread-info").html(t.data.allCommentsCountBeforeThreadsHtml),e(".wpd-thread-info").attr("data-comments-count",t.data.allCommentsCountNew),e("#wpd-bubble-all-comments-count").replaceWith(t.data.allCommentsCountBubbleHtml),t.data.message&&oe(t.data.message),wpdiscuzAjaxObj.setCommentMessage(t.data.notification,"success")}else t.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data,a),"error");else wpdiscuzAjaxObj.setCommentMessage(t,"error");e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("keydown",".wpd-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_comm\_submit").trigger("click")})),e("body").on("keydown","#wpdiscuz-edit-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_save\_edited\_comment").trigger("click")})),e("body").on("keydown",".wpd-inline-comment-content",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).parents(".wpd\_inline\_comm\_form").find(".wpd-inline-submit.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-inline-icon-count.wpd-has-comments",(function(){var t=e(this),a=new FormData;a.append("action","wpdGetLastInlineComments"),a.append("inline\_form\_id",ce(t)),ue(v,!0,a).done((function(a){"object"==typeof a?a.success?e(a.data).insertAfter(t):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-view-all-inline-comments",(function(t){t.preventDefault(),e(this).parents(".wpd-last-inline-comments-wrapper").remove(),e(".wpdf-inline").hasClass("wpdf-active")||e(".wpdf-inline").trigger("click"),te(),e("html, body").animate({scrollTop:e(".wpdf-inline").offset().top-I},1e3,ae)})),e("body").on("click",".wpd-feedback-content-link",(function(t){t.preventDefault();var a=e(this).data("feedback-content-id");te(),e("html, body").animate({scrollTop:e("#wpd-inline-"+a).offset().top-(I+6)},1e3,(function(){ae(),e("#wpd-inline-"+a).addClass("wpd-active")}))})),"scroll\_open"!==A&&"blink"!==A||(re(),e(window).on("scroll",re)),e("body").on("click","#wpd-post-rating.wpd-not-rated .wpd-rate-starts svg",(function(){var t=new FormData,a=e(this).index();a>=0&&a<5&&(t.append("action","wpdUserRate"),t.append("rating",a+1),ue(v,!0,t).done((function(t){"object"==typeof t?(t.success?location.reload(!0):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data),"error"),we(t)):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})))})),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){t.preventDefault();var a=e(this);const o=e("#wpdiscuz\_subscription\_button",a);if(a[0].checkValidity()&&(d=a,s=!0,"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&!e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).val().length?(s=!1,e(".wpdiscuz-recaptcha",d).css("border","1px solid red")):"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&e(".wpdiscuz-recaptcha",d).css("border","none"),s)&&o.hasClass("wpd\_not\_clicked")){o.removeClass("wpd\_not\_clicked");var i=new FormData;i.append("action","wpdAddSubscription"),e("\*",a).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&i.append(this.name+"",e(this).val()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):wpdiscuzAjaxObj.setCommentMessage(t,"error"),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1,o.addClass("wpd\_not\_clicked")})).fail((function(t,a,n){console.log(n),o.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}var d,s})),e("body").on("click",".wpd-unsubscribe",(function(t){t.preventDefault();var a=new FormData;a.append("action","wpdUnsubscribe"),a.append("sid",e(this).data("sid")),a.append("skey",e(this).data("skey")),ue(v,!0,a).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),wpdiscuzAjaxObj.resetActiveFilters=function(t){e(".wpd-filter.wpdf-active"+(t?":not("+t+")":"")).removeClass("wpdf-active")},wpdiscuzAjaxObj.getAjaxObj=ue}));var onloadCallback=function(){if(document.getElementById("wpdiscuz-recaptcha-0\_0")&&"2.0"===wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.render("wpdiscuz-recaptcha-0\_0",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(e){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("key")},"expired-callback":function(){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}; |
  |  | 10 | var wpdiscuzLoadRichEditor=parseInt(wpdiscuzAjaxObj.loadRichEditor);if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap"))var wpDiscuzEditor=new WpdEditor;function wpdMessagesOnInit(e,t){wpdiscuzAjaxObj.setCommentMessage(e,t),setTimeout((function(){location.href=location.href.substring(0,location.href.indexOf("wpdiscuzUrlAnchor")-1)}),3e3)}wpdiscuzAjaxObj.setCommentMessage=function(e,t,a){var o="wpdiscuz-message-error";if(e instanceof Array)for(var n in e)t instanceof Array?"success"===t[n]?o="wpdiscuz-message-success":"warning"===t[n]&&(o="wpdiscuz-message-warning"):"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e[n]).prependTo("#wpdiscuz-comment-message").delay(a instanceof Array?a[n]:a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}));else"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e).prependTo("#wpdiscuz-comment-message").delay(a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}))},wpdiscuzAjaxObj.applyFilterOnPhrase=function(e,t,a){return wpdiscuzAjaxObj.phraseFilters&&jQuery.each(wpdiscuzAjaxObj.phraseFilters,(function(o){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]]&&(e=wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]](e,t,a))})),e},jQuery(document).ready((function(e){e("body").addClass("wpdiscuz\_"+wpdiscuzAjaxObj.version);var t=wpdiscuzAjaxObj.is\_user\_logged\_in,a=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!t,o=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&t,n=wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion,i=parseInt(wpdiscuzAjaxObj.commentListLoadType),d=parseInt(wpdiscuzAjaxObj.wc\_post\_id),s=parseInt(wpdiscuzAjaxObj.commentListUpdateType),c=1e3\*parseInt(wpdiscuzAjaxObj.commentListUpdateTimer),p=parseInt(wpdiscuzAjaxObj.liveUpdateGuests),r=wpdiscuzAjaxObj.loadLastCommentId,l=r,m=parseInt(wpdiscuzAjaxObj.firstLoadWithAjax);Cookies.get("wpdiscuz\_comments\_sorting")&&Cookies.remove("wpdiscuz\_comments\_sorting",{path:""}),Cookies.get("wordpress\_last\_visit")&&Cookies.remove("wordpress\_last\_visit",{path:""}),Cookies.get("wpdiscuz\_last\_visit")&&Cookies.remove("wpdiscuz\_last\_visit",{path:""});var w,u=parseInt(wpdiscuzAjaxObj.wordpressIsPaginate),f=wpdiscuzAjaxObj.storeCommenterData,h=(parseInt(wpdiscuzAjaxObj.wmuEnabled),wpdiscuzAjaxObj.isCookiesEnabled),b=!0,\_=wpdiscuzAjaxObj.cookiehash,g=parseInt(wpdiscuzAjaxObj.isLoadOnlyParentComments),z=parseInt(wpdiscuzAjaxObj.enableDropAnimation)?500:0,v=parseInt(wpdiscuzAjaxObj.isNativeAjaxEnabled),j=parseInt(wpdiscuzAjaxObj.enableBubble),x=parseInt(wpdiscuzAjaxObj.bubbleLiveUpdate),C=parseInt(wpdiscuzAjaxObj.bubbleHintTimeout),y=parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout)?parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout):5,k=parseInt(wpdiscuzAjaxObj.bubbleShowNewCommentMessage),O=wpdiscuzAjaxObj.bubbleLocation,A=wpdiscuzAjaxObj.inlineFeedbackAttractionType,I=(I=parseInt(wpdiscuzAjaxObj.scrollSize))||32,T=[],D=[],E=[],F=!1,M=1,L=e("html").css("scroll-behavior"),R=e("body").css("scroll-behavior");(e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").length?e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").length?e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .social\_connect\_form").length?e(".wc\_social\_plugin\_wrapper .social\_connect\_form").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .oneall\_social\_login\_providers").length&&e(".wc\_social\_plugin\_wrapper .oneall\_social\_login .oneall\_social\_login\_providers").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"),wpdiscuzLoadRichEditor&&e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0"),window.addEventListener("beforeunload",(function(t){var a=e(".wpd-form").not(":hidden");if(a.length)if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap")){for(var o=0;o<a.length;o++)if("\n"!==wpDiscuzEditor.createEditor(e(a[o]).find(".ql-container").attr("id")).getText())return t.preventDefault(),void(t.returnValue="")}else for(o=0;o<a.length;o++)if(e(a[o]).find(".wc\_comment").val())return t.preventDefault(),void(t.returnValue="")})),wpdiscuzLoadRichEditor||(e(document).delegate("textarea.wc\_comment","input",(function(){me(e(this))})),e.each(e("textarea.wc\_comment"),(function(){me(e(this))}))),e("body").on("focus","#wpdcom .ql-editor, #wpdcom .wc\_comment",(function(){e(".wpd-form-foot",e(this).parents(".wpd\_comm\_form")).slideDown(z)})),e("body").on("focus","#wpdcom textarea",(function(){e(this).next(".autogrow-textarea-mirror").length||e(this).autoGrow()})),t)||q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)});if(e(".wpd-vote-down.wpd-dislike-hidden").remove(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd"),e("body").on("click","#wpd-editor-source-code-wrapper-bg",(function(){e(this).hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),wpdiscuzLoadRichEditor&&e("body").on("click","#wpd-insert-source-code",(function(){var t=wpDiscuzEditor.createEditor("#"+e("#wpd-editor-uid").val());t.deleteText(0,t.getLength(),Quill.sources.USER);var a=e("#wpd-editor-source-code").val();a.length&&t.clipboard.dangerouslyPasteHTML(0,a,Quill.sources.USER),t.update(),e("#wpd-editor-source-code-wrapper-bg").hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),e("body").on("click",".wpd-reply-button",(function(){var i=$(e(this),0);e(this).hasClass("wpdiscuz-clonned")?(wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+i).focus()}),z):setTimeout((function(){e("#wc-textarea-"+i).trigger("focus")}),z),e("#wpd-secondary-form-wrapper-"+i).slideToggle(z)):function(a){var o=$(a,0);e("#wpdiscuz\_form\_anchor-"+o).before(function(t){return e("#wpdiscuz\_hidden\_secondary\_form").html().replace(/wpdiscuzuniqueid/g,t)}(o));var n=e("#wpd-secondary-form-wrapper-"+o);if(!t){q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)})}wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+o).focus()}),z):setTimeout((function(){e("#wc-textarea-"+o).trigger("focus")}),z);n.slideToggle(z,(function(){a.addClass("wpdiscuz-clonned")}))}(e(this)),function(t){if((a||o)&&"2.0"===n){var i=X(t);setTimeout((function(){if(!D[i])try{D[i]=grecaptcha.render("wpdiscuz-recaptcha-"+t,{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(a){e("#wpdiscuz-recaptcha-field-"+t).val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-"+t).val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3)}}(i)})),e("body").on("click","#wpdcom [data-wpd-clipboard]",(function(){var t=e(this).data("wpd-clipboard");e(this).data("wpd-ismention")&&(t="@"+t);var a=e("<input/>");a.appendTo("body").css({position:"absolute",top:"-10000000px"}).val(t),a.trigger("select"),document.execCommand("copy"),a.remove(),wpdiscuzAjaxObj.setCommentMessage(t+"<br/>"+wpdiscuzAjaxObj.wc\_copied\_to\_clipboard,"success",5e3)})),e("body").on("click",".wpdiscuz-nofollow,.wc\_captcha\_refresh\_img,.wpd-load-more-submit",(function(e){e.preventDefault()})),e("body").on("click",".wpd-toggle.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked");var a=$(e(this),0),o=e(this),n=e(".fas",o);!o.parents(".wpd-comment:not(.wpd-reply)").children(".wpd-reply").length&&g?function(t,a){var o=X(t),n=new FormData;n.append("action","wpdShowReplies"),n.append("commentId",o),ue(v,!0,n).done((function(o){a.addClass("wpd\_not\_clicked"),"object"==typeof o&&o.success&&(e("#wpd-comm-"+t).replaceWith(o.data.comment\_list),e("#wpd-comm-"+t+" .wpd-toggle .fas").removeClass("fa-chevron-down").addClass("fa-chevron-up"),e("#wpd-comm-"+t+" .wpd-toggle .wpd-view-replies .wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),e("#wpd-comm-"+t+" .wpd-toggle").attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text),we(o)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,o,n){console.log(n),a.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}(a,t):e("#wpd-comm-"+a+"> .wpd-reply").slideToggle(700,(function(){e(this).is(":hidden")?(n.removeClass("fa-chevron-up"),n.addClass("fa-chevron-down"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_show\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_show\_replies\_text)):(n.removeClass("fa-chevron-down"),n.addClass("fa-chevron-up"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text)),t.addClass("wpd\_not\_clicked")}))})),e("body").on("mouseenter",".wpd-new-loaded-comment",(function(){e(this).removeClass("wpd-new-loaded-comment")})),e("body").on("click",".wpd-sbs-toggle",(function(){e(".wpdiscuz-subscribe-bar").slideToggle(z)})),parseInt(wpdiscuzAjaxObj.wpDiscuzIsShowOnSubscribeForm)&&!t&&wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&e("#wpdiscuz-subscribe-form").length&&("2.0"===n?(setTimeout((function(){try{grecaptcha.render("wpdiscuz-recaptcha-subscribe-form",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-subscribe-form").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val()?e(".wpdiscuz-recaptcha",e(this)).css("border","none"):(e(".wpdiscuz-recaptcha",e(this)).css("border","1px solid red"),ee(e(this),""),t.preventDefault())}))):"3.0"===n&&e("body").on("click","#wpdiscuz\_subscription\_button",(function(t){var a=e(this).parents("#wpdiscuz-subscribe-form");ee(a,""),t.preventDefault();try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/wpdAddSubscription"}).then((function(e){document.getElementById("wpdiscuz-recaptcha-field-subscribe-form").value=e,a.trigger("submit")}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error")}}))),(a||o)&&"2.0"===n){var S=e(window).width(),H=e("#wpdcom").width();H>=1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"65%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"35%"})),H>=940&&H<1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"60%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"40%"})),H>=810&&H<940&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"60%"})),H>=730&&H<810&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"45%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"55%"})),H>=610&&H<730&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.85)","-webkit-transform":"scale(0.85)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"43%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"55%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"})),S>650&&(H>=510&&H<610&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"35%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"63%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%",position:"relative",right:"-60px"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H>=470&&H<510&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"60%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd\_main\_comm\_form .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H<470&&(e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({margin:"0px auto","transform-origin":"center 0","-webkit-transform-origin":"center 0"}),e("#wpdcom .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc\_notification\_checkboxes").css({"text-align":"center"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-field-submit").css({"text-align":"center"})))}function P(t,a,o){ue(v,!1,a).done((function(a){if(e(o).addClass("wpd\_not\_clicked"),"object"==typeof a)if(a.success){"collapsed"===wpdiscuzAjaxObj.commentFormView&&e(".wpd-form-foot",t).slideUp(z),a.data.wc\_all\_comments\_count\_new=parseInt(a.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(a.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(a.data.wc\_all\_comments\_count\_bubble\_html);var n=z;a.data.is\_main?oe(a.data.message):(n=z+700,e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).slideToggle(700),1==a.data.is\_in\_same\_container?e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).after(a.data.message):e("#wpd-comm-"+a.data.uniqueid).after(a.data.message)),function(e){if(!e.data.held\_moderate){var t=new FormData;t.append("action","wpdCheckNotificationType"),t.append("comment\_id",e.data.new\_comment\_id),t.append("email",e.data.comment\_author\_email),t.append("isParent",e.data.is\_main),ue(v,!0,t)}}(a),function(e){if(e.data.redirect>0&&e.data.new\_comment\_id){var t=new FormData;t.append("action","wpdRedirect"),t.append("commentId",e.data.new\_comment\_id),ue(v,!0,t).done((function(e){"object"==typeof e&&e.success&&setTimeout((function(){location.href=e.data}),2e3)})).fail((function(e,t,a){console.log(a)}))}}(a),h&&b?function(t){var a=t.comment\_author\_email,o=t.comment\_author,n=t.comment\_author\_url;null==f?(Cookies.set("comment\_author\_email\_"+\_,a),Cookies.set("comment\_author\_"+\_,o),n.length&&Cookies.set("comment\_author\_url\_"+\_,n)):(f=parseInt(f),Cookies.set("comment\_author\_email\_"+\_,a,{expires:f,path:"/"}),Cookies.set("comment\_author\_"+\_,o,{expires:f,path:"/"}),n.length&&Cookies.set("comment\_author\_url\_"+\_,n,{expires:f,path:"/"}));e(".wpd-cookies-checkbox").length&&e(".wpd-cookies-checkbox").prop("checked",!0)}(a.data):b||e(".wpd-cookies-checkbox").prop("checked",!1),t.get(0).reset(),wpdiscuzLoadRichEditor?wpDiscuzEditor.createEditor("#wpd-editor-"+e(".wpdiscuz\_unique\_id",t).val()).setContents([{insert:"\n"}]):me(t.find(".wc\_comment")),q(a.data),e(".wmu-preview-wrap",t).remove(),T.length&&(T.forEach((function(e){e.parents(".wpd-field-checkbox").remove()})),T=[]),parseInt(wpdiscuzAjaxObj.scrollToComment)&&setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.new\_comment\_id).offset().top-I},1e3,ae)}),n),we(a,t),e(document.body).trigger("wpdiscuz\_comment\_posted",[a.data.new\_comment\_id,a.data.wc\_all\_comments\_count\_new])}else a.data&&(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"),we(a,t));else wpdiscuzAjaxObj.setCommentMessage(a,"error");e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,n){console.log(n),e(o).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}function q(t){e(".wpd\_comm\_form .wc\_name").val(t.comment\_author),t.comment\_author\_email&&t.comment\_author\_email.indexOf("@example.com")<0&&e(".wpd\_comm\_form .wc\_email").val(t.comment\_author\_email),t.comment\_author\_url&&e(".wpd\_comm\_form .wc\_website").val(t.comment\_author\_url)}function U(t,a){e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").show(),e("#wpd-comm-"+t+" .wpdiscuz-edit-form-wrap").replaceWith(a),e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-last-edited").show()}e("body").on("click",".wc\_comm\_submit.wpd\_not\_clicked",(function(){var i=e(this),d=1,s=e(this).parents("form");if("true"!==s.attr("data-uploading")){if(s.hasClass("wpd\_main\_comm\_form")||(d=function(t){var a=t.attr("class").split(" "),o="";return e.each(a,(function(e,t){"wpd\_comment\_level"===Y(t,!1)&&(o=Y(t,!0))})),parseInt(o)+1}(e(this).parents(".wpd-comment"))),ee(s,"#wpd-editor-"+e(".wpdiscuz\_unique\_id",s).val()),s.on("submit",(function(e){e.preventDefault()})),s[0].checkValidity()&&(p=s,r=!0,"2.0"===n&&e("input[name=wc\_captcha]",p).length&&!e("input[name=wc\_captcha]",p).val().length?(r=!1,e(".wpdiscuz-recaptcha",p).css("border","1px solid red")):"2.0"===n&&e("input[name=wc\_captcha]",p).length&&e(".wpdiscuz-recaptcha",p).css("border","none"),r)){F=!0,function(t){e(".wpd-agreement-checkbox",t).each((function(){e(this).hasClass("wpd\_agreement\_hide")&&h&&e(this).prop("checked")&&(Cookies.set(e(this).attr("name")+"\_"+\_,1,{expires:30,path:"/"}),e("input[name="+e(this).attr("name")+"]").each((function(){T.push(e(this))})))}))}(s),e(i).removeClass("wpd\_not\_clicked");var c=new FormData;if(c.append("action","wpdAddComment"),e(":input",s).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&c.append(this.name+"",e(this).val().trim()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&c.append(this.name+"",e(this).val())})),c.append("wpd\_comment\_depth",d),wpdiscuzAjaxObj.wpdiscuz\_zs&&c.append("wpdiscuz\_zs",wpdiscuzAjaxObj.wpdiscuz\_zs),e(".wpd-cookies-checkbox",s).length?e(".wpd-cookies-checkbox",s).prop("checked")||(b=!1):t&&(b=!1),e("#wpdiscuz-loading-bar").show(),wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&"3.0"===n&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/addComment"}).then((function(e){c.append("g-recaptcha-response",e),P(s,c,i)}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)}else P(s,c,i)}var p,r;!function(e){if((a||o)&&"2.0"===n){var t=X(e);grecaptcha.reset(D[t])}}(e(".wpdiscuz\_unique\_id",s).val()),e(".wpdiscuz\_reset").val("")}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj.wmuPhraseDoingUpload,"wmuPhraseDoingUpload",s),"warning")})),e(document.body).on("wpdiscuz\_comment\_posted",(function(t,a,o){const n=e(".wpd-thread-filter");isNaN(o)||void 0===o||!o?n.find(".wpd-filter").addClass("wpdiscuz-hidden"):n.find(".wpd-filter").removeClass("wpdiscuz-hidden")})),e("body").on("click",".wpd\_editable\_comment",(function(){w&&e(".wpdiscuz-edit-form-wrap").length&&U($(e(".wpdiscuz-edit-form-wrap"),0),w);var t=e(this),a=$(t,0),o=X(a),n=new FormData;n.append("action","wpdEditComment"),n.append("commentId",o),w=e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-text").get(0),ue(v,!0,n).done((function(o){if("object"==typeof o)if(o.success){if(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text").replaceWith(o.data.html),wpdiscuzLoadRichEditor){var n=wpDiscuzEditor.createEditor("#wpd-editor-edit\_"+a);n.clipboard.dangerouslyPasteHTML(0,o.data.content),n.update(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd")}else e("#wc-textarea-edit\_"+a).val(o.data.content),me(e("#wc-textarea-edit\_"+a));e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").hide(),e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").hide()}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[o.data],o.data,t),"error");else console.log(o);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wc\_save\_edited\_comment",(function(){var t=e(this),a=$(t),o=X(a),n=e("#wpd-comm-"+a+" #wpdiscuz-edit-form");if(ee(n,"#wpd-editor-edit\_"+a),n.on("submit",(function(e){e.preventDefault()})),n[0].checkValidity()){var i=new FormData;i.append("action","wpdSaveEditedComment"),i.append("commentId",o),e(":input",n).each((function(){""!==this.name&&"checkbox"!==this.type&&"radio"!==this.type&&i.append(this.name+"",e(this).val()),"checkbox"!==this.type&&"radio"!==this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(n){"object"==typeof n?(n.success?(U(a,n.data.message),n.data.comment\_approved\_html&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-subheader").append(n.data.comment\_approved\_html),n.data.lastEdited&&(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").remove(),e(n.data.lastEdited).insertAfter("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text")),n.data.twitterShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_tw").attr("href",n.data.twitterShareLink),n.data.whatsappShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_whatsapp").attr("href",n.data.whatsappShareLink),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error"),we(n,o)):wpdiscuzAjaxObj.setCommentMessage(n,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("click",".wc\_cancel\_edit",(function(){var t=$(e(this));U(t,w),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+t)})),!u&&m&&(M=0,1==m?setTimeout((function(){N(!0)}),500):e("body").on("click",".wpd-load-comments",(function(){e(this).parent(".wpd-load-more-submit-wrap").remove(),N(!0)}))),e("body").on("click",".wpd-load-more-submit",(function(){var t=e(this),a="wpd-loaded";t.hasClass(a)&&N(!1,t,a,"wpd-loading")}));var W=!1;function B(){var t=document.getElementById("wpdiscuzHasMoreComments"),a=0;t&&(a=t.dataset.is\_show\_load\_more);var o=document.getElementById("wpdcom")?document.getElementById("wpdcom").clientHeight:0,n=e(window).height()+e(window).scrollTop();o&&n&&(100\*n/o>=80&&!1===W&&1==a&&(W=!0,N(!1,e(".wpd-load-more-submit"))))}function N(t,a,o,n){a&&(a.toggleClass(o),a.toggleClass(n));var d=new FormData;d.append("action","wpdLoadMoreComments");var s=e(".wpdiscuz-sort-button-active").attr("data-sorting");s&&d.append("sorting",s),d.append("offset",M),d.append("lastParentId",e(".wpd-load-more-submit").attr("data-lastparentid")),d.append("isFirstLoad",t?1:0);var c=e(".wpdf-active").attr("data-filter-type");d.append("wpdType",c||""),ue(v,!t||1!=m,d).done((function(d){"object"==typeof d&&d.success&&(M++,t&&e(".wpd-comment").remove(),e(".wpdiscuz\_single").remove(),e(".wpdiscuz-comment-pagination").before(d.data.comment\_list),V(d,t&&2!==i),W=!1,d.data.loadLastCommentId&&(r=d.data.loadLastCommentId),we(d),t&&K(!1)),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))})).fail((function(t,i,d){console.log(d),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))}))}function V(t,a){var o,n=document.getElementById("wpdiscuzHasMoreComments");if(0==t.data.is\_show\_load\_more)n&&(n.dataset.is\_show\_load\_more=0),e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide();else if(o=t.data.last\_parent\_id,e(".wpd-load-more-submit").attr("data-lastparentid",o),2!==i&&e(".wpdiscuz-comment-pagination").show(),n&&(n.dataset.is\_show\_load\_more=1),a&&e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").show(),t.data.comments\_left>0){if(!e(".wpd-load-more-submit .wpd-comments-left").length){const t=e("<span>");t.addClass("wpd-comments-left"),e(".wpd-load-more-submit").append(t)}e(".wpd-load-more-submit .wpd-comments-left").text(t.data.comments\_left\_text)}we(t)}function K(t){var a=location.href.match(/#comment\-(\d+)/);if(null!==a){var o=a[1];if(e("#comment-"+o).length)setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+o).parents("[id^=wpd-comm-]").offset().top-I},1e3,ae),t&&Q(o)}),500);else{var n=new FormData;n.append("action","wpdGetSingleComment"),n.append("commentId",o),ue(v,!0,n).done((function(a){if("object"==typeof a&&a.success){var n="#comment-"+o;e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e(n).offset().top-I},1e3,ae),t&&Q(o)}e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}}}function Q(t){setTimeout((function(){e("#comment-"+t).siblings(".wpd-secondary-form-wrapper").is(":visible")||e("#comment-"+t).find(".wpd-reply-button").trigger("click")}),1100)}function G(e){if(void 0!==e.data.message)for(var t,a=e.data.message,o=0;o<a.length;o++)J((t=a[o]).comment\_parent,t.comment\_html)}function $(e,t){var a="";return(a=t?e.parents(".wpd-main-form-wrapper").attr("id"):e.parents(".wpd-comment").attr("id")).substring(a.lastIndexOf("-")+1)}function X(e){return e.substring(0,e.indexOf("\_"))}function Y(e,t){return t?e.substring(e.indexOf("-")+1):e.substring(0,e.indexOf("-"))}function J(t,a){if(0==t)oe(a);else{var o=$(e("#comment-"+t),0);e("#wpdiscuz\_form\_anchor-"+o).after(a)}}function Z(){var t=[];return e(".wpd-comment-right").each((function(){t.push(X($(e(this),0)))})),t.join(",")}function ee(t,a){var o=t.find(".wpd-required-group");wpdiscuzLoadRichEditor&&t.find(".wc\_comment").val(e(a+">.ql-editor").html()),function(e){if("wpdiscuz-subscribe-form"==e.attr("id"))return;var t=e.find(".wc\_comment"),a=t.val().trim().replace(/<p><br><\/p>/g,"\n").replace(/<p>(.\*?)<\/p>/g,"$1\n");a=(a=(a=(a=a.replace(/<img src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img[^>]+alt=["|']([^"|']+)["|'][^>]+src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'][^>]?>/g," $1 ")).replace(/<img\s+([^>]\*)class=["|']wpdem\-sticker["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img\s+([^>]\*)src=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $2 "),t.val(a)}(t),e.each(o,(function(){e("input",this).prop("required",!1),0===e("input:checked",this).length?e("input",e(this)).prop("required",!0):e(".wpd-field-invalid",this).remove()}))}function te(){e("html, body").css("scroll-behavior","unset")}function ae(){e("html").css("scroll-behavior",L),e("body").css("scroll-behavior",R)}function oe(t){e(".wpd-sticky-comment").last()[0]?e(t).insertAfter(e(".wpd-sticky-comment").last()[0]):e(".wpd-thread-list").prepend(t)}function ne(t){t?t.prop("required")||(t.val()?t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none")):e.each(e(".wc\_email"),(function(t,a){var o=e(a);o.prop("required")||(o.val()?o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none"))}))}if(2!==i||u||(e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide(),B(),e(window).scroll((function(){B()}))),wpdiscuzAjaxObj.setLoadMoreVisibility=V,e("body").on("click",".wpd-vote-up.wpd\_not\_clicked, .wpd-vote-down.wpd\_not\_clicked",(function(){var t=e(this);e(t).removeClass("wpd\_not\_clicked");var a,o=X($(t));a=e(this).hasClass("wpd-vote-up")?1:-1;var n=new FormData;n.append("action","wpdVoteOnComment"),n.append("commentId",o),n.append("voteType",a),ue(v,!0,n).done((function(n){if(e(t).addClass("wpd\_not\_clicked"),"object"==typeof n){if(n.success){if("total"===n.data.buttonsStyle){var i=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result"),d=n.data.votes;i.text(n.data.votesHumanReadable),i.attr("title",d),i.removeClass("wpd-up wpd-down"),d>0&&i.addClass("wpd-up"),d<0&&i.addClass("wpd-down")}else{var s=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-like"),c=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-dislike");s.text(n.data.likeCountHumanReadable),s.attr("title",n.data.likeCount),c.text(n.data.dislikeCountHumanReadable),c.attr("title",n.data.dislikeCount),parseInt(n.data.likeCount)>0?s.addClass("wpd-up"):s.removeClass("wpd-up"),parseInt(n.data.dislikeCount)<0?c.addClass("wpd-down"):c.removeClass("wpd-down")}var p=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-up"),r=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-down");p.removeClass("wpd-up"),r.removeClass("wpd-down"),n.data.curUserReaction>0?p.addClass("wpd-up"):n.data.curUserReaction<0&&r.addClass("wpd-down")}else n.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error");we(n,o,a)}else console.log(n);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(t).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e(document).on("click","body",(function(t){var a=e(".wpdiscuz-sort-buttons");e(t.target).hasClass("wpdf-sorting")||e(t.target).parent().hasClass("wpdf-sorting")?a.css({display:a.is(":visible")?"none":"flex"}):a.hide()})),e("body").on("click",".wpdiscuz-sort-button:not(.wpdiscuz-sort-button-active)",(function(){var t=e(this),a=e(this).attr("data-sorting");if(a){e(".wpd-load-comments").parents(".wpd-load-more-submit-wrap").remove(),e(".wpdiscuz-sort-button.wpdiscuz-sort-button-active").removeClass("wpdiscuz-sort-button-active").appendTo(".wpdiscuz-sort-buttons"),t.addClass("wpdiscuz-sort-button-active").prependTo(".wpdf-sorting");var o=new FormData;o.append("action","wpdSorting"),o.append("sorting",a);var n=e(".wpdf-active").attr("data-filter-type");o.append("wpdType",n||""),ue(v,!0,o).done((function(t){"object"==typeof t&&t.success&&(e("#wpdcom .wpd-comment").remove(),e("#wpdcom .wpd-thread-list").prepend(t.data.message),V(t,!1),M=1),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),window.onhashchange=function(){K(!1)},1!=m&&K(!1),e("body").on("click",".wpdiscuz-readmore",(function(){var t=$(e(this)),a=X(t),o=new FormData;o.append("action","wpdReadMore"),o.append("commentId",a),ue(v,!0,o).done((function(o){"object"==typeof o?(o.success?(e("#comment-"+a+" .wpd-comment-text").replaceWith(" "+o.data.message),e("#wpdiscuz-readmore-"+t).remove()):console.log(o.data),we(o)):console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("change",".wpd-required-group",(function(){0!==e("input:checked",this).length?e("input",e(this)).prop("required",!1):e("input",e(this)).prop("required",!0)})),e("body").on("click",".wpdiscuz-spoiler",(function(){e(this).next().slideToggle(),e(this).hasClass("wpdiscuz-spoiler-closed")?e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"):e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),e(this).toggleClass("wpdiscuz-spoiler-closed")})),e("body").on("click",".wpd-tools",(function(){var t=e(".wpd-tools-actions",e(this));t.is(":visible")||e(this).parents(".wpd-comment-right").attr("id")!==e("[id^=comment-]","#wpdcom").last().attr("id")||e("#comments").css({paddingBottom:"160px"}),t.css({display:t.is(":visible")?"none":"flex"})})),e("body").on("mouseleave",".wpd-comment-right",(function(){e(this).find(".wpd-tools-actions").hide(),e("#comments").css({paddingBottom:"0"})})),e("body").on("click",".wpd\_stick\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdStickComment"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd\_close\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdCloseThread"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-filter.wpd\_not\_clicked[data-filter-type]",(function(){var t=e(this),a=t.attr("data-filter-type");wpdiscuzAjaxObj.resetActiveFilters(".wpdf-"+a),t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var o=new FormData;o.append("action","wpdLoadMoreComments");var n=e(".wpdiscuz-sort-button-active").attr("data-sorting");n&&o.append("sorting",n),o.append("lastParentId",0),o.append("offset",0),M=1,o.append("wpdType",t.hasClass("wpdf-active")?"":a),o.append("isFirstLoad",1),e(this).hasClass("wpdf-inline")?e(this).hasClass("wpdf-active")?e(".wpd-comment-info-bar").hide():e(".wpd-comment-info-bar").css("display","flex"):e(".wpd-comment-info-bar").hide(),ue(v,!1,o).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(t.toggleClass("wpdf-active"),e(".wpd-load-comments").remove(),e(".wpd-comment").remove(),e(".wpd-thread-list").prepend(a.data.comment\_list),V(a),r=a.data.loadLastCommentId,e(".wpd-load-more-submit").blur(),we(a)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpdf-reacted.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdMostReactedComment"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e("#comment-"+a.data.commentId).length||e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpdf-hottest.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdHottestThread"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.commentId).length?e("#comment-"+a.data.commentId).parents("[id^=wpd-comm-"+a.data.commentId+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpd-filter-view-all",(function(){e(".wpdf-inline.wpdf-active.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-follow-link.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=X($(t,0)),o=new FormData;o.append("action","wpdFollowUser"),o.append("commentId",a),ue(v,!0,o).done((function(a){t.addClass("wpd\_not\_clicked"),"object"==typeof a?a.success?(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data.code],a.data.code,t),"success"),t.removeClass("wpd-follow-active"),a.data.followTip&&t.attr("wpd-tooltip",a.data.followTip),a.data.followClass&&t.addClass(a.data.followClass),we(a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),ne(),e("body").on("keyup",".wc\_email",(function(){ne(e(this))})),j&&e("#wpdcom").length){if(e("#wpd-bubble-wrapper").hover((function(){e(this).addClass("wpd-bubble-hover")}),(function(){e(this).removeClass("wpd-bubble-hover")})),C&&!Cookies.get(wpdiscuzAjaxObj.cookieHideBubbleHint)&&setTimeout((function(){e("#wpd-bubble-wrapper").addClass("wpd-bubble-hover");const t=wpdiscuzAjaxObj.bubbleHintShowOnce?"/":location.href;wpdiscuzAjaxObj.bubbleHintCookieExpires&&parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10);Cookies.set(wpdiscuzAjaxObj.cookieHideBubbleHint,"1",{expires:parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10),path:t}),setTimeout((function(){e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")}),1e3\*y)}),1e3\*C),"content\_left"===O)if(e(".entry-content").length){var ie=(de=Math.min(e(".entry-content").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".post-entry").length){ie=(de=Math.min(e(".post-entry").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".container").length){var de;ie=(de=Math.min(e(".container").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner");else"left\_corner"===O?(e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner")):"right\_corner"===O&&(e("#wpd-bubble-wrapper").css({right:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-right-corner"));e("#wpd-bubble-wrapper").show(),e("body").on("click","#wpd-bubble-add-message-close",(function(t){t.preventDefault(),t.stopPropagation(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")})),e("body").on("click","#wpd-bubble",(function(){te(),e("#tab-title-reviews").length&&e("#tab-title-reviews a").trigger("click"),e("html, body").animate({scrollTop:e("#wpdcom").offset().top-(I+28)},1e3,(function(){ae(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover"),wpdiscuzLoadRichEditor?e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0").focus():e("#wc-textarea-0\_0").length&&e("#wc-textarea-0\_0").trigger("focus")}))})),e("body").on("click","#wpd-bubble-comment-close",(function(t){t.preventDefault(),e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")})),e("body").on("click","#wpd-bubble-comment-reply-link a",(function(){var t=e(this).attr("href");setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),K(!0);var a=t.match(/#comment\-(\d+)/);E=E.filter((function(e){return e!=a[1]})),e("#wpd-bubble-count .wpd-new-comments-count").text(E.length),0==E.length&&e("#wpd-bubble-count").removeClass("wpd-new-comments")}),100)})),e("body").on("click","#wpd-bubble-count",(function(){if(E.length){var t=new FormData;t.append("action","wpdBubbleUpdate"),t.append("newCommentIds",E.join()),ue(v,!0,t).done((function(t){"object"==typeof t&&t.success&&(t.data.message=t.data.message.filter((function(t){if(!e("#comment-"+t.comment\_id).length)return t})),G(t),e("#wpd-bubble-count").removeClass("wpd-new-comments"),e("#wpd-bubble-count .wpd-new-comments-count").text("0"),E=[],e(".wpd-new-loaded-comment").length&&(te(),e("html, body").animate({scrollTop:e(e(".wpd-new-loaded-comment")[0]).offset().top-(I+28)},1e3,ae)),we(t)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(e,t,a){console.log(a)}))}}))}if((j&&x||s)&&(t||!t&&p)&&setTimeout((function t(){e.ajax({type:"GET",url:wpdiscuzAjaxObj.bubbleUpdateUrl,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpdiscuzAjaxObj.restNonce)},data:{postId:d,lastId:l,visibleCommentIds:Z()}}).done((function(a){if(!F)if("object"==typeof a){if(a.commentIDsToRemove.forEach((function(t){e("[id^=wpd-comm-"+t+"]").remove()})),a.ids.length){s&&function(){var t=new FormData;t.append("action","wpdUpdateAutomatically"),t.append("loadLastCommentId",r),t.append("visibleCommentIds",Z()),ue(v,!1,t).done((function(t){F||"object"==typeof t&&t.success&&(G(t),t.data.wc\_all\_comments\_count\_new=parseInt(t.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(t.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",t.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(t.data.wc\_all\_comments\_count\_bubble\_html),r=t.data.loadLastCommentId)})).fail((function(e,t,a){console.log(a)}))}(),a.ids=a.ids.filter((function(t){if(!e("#comment-"+t).length)return t}));var o=5e3;l=parseInt(a.ids[a.ids.length-1]),E=E.concat(a.ids),k&&a.commentText&&(e("#wpd-bubble-author-avatar").html(a.avatar),e("#wpd-bubble-author-name").html(a.authorName),e("#wpd-bubble-comment-date span").html(a.commentDate),e("#wpd-bubble-comment-text").html(a.commentText),e("#wpd-bubble-comment-reply-link a").attr("href",a.commentLink),e("#wpd-bubble-notification-message").show(),o=1e4);var n=parseInt(e(".wpd-new-comments-count").text());n+=a.ids.length,e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),e("#wpd-bubble-wrapper").addClass("wpd-new-comment-added"),setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")}),o),e(".wpd-new-comments-count").text(n),e("#wpd-bubble-count").addClass("wpd-new-comments")}a.all\_comments\_count=parseInt(a.all\_comments\_count),e("#wpd-bubble-all-comments-count").replaceWith(a.all\_comments\_count\_bubble\_html),e(".wpd-reviews-tab").length||(e(".wpd-thread-info").html(a.all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.all\_comments\_count))}else console.log(a);setTimeout(t,c)})).fail((function(e,a,o){console.log(o),setTimeout(t,c)}))}),c),e(".wpd-inline-form-wrapper").length){var se=new FormData;se.append("action","wpdGetInlineCommentForm"),ue(v,!1,se).done((function(t){"object"==typeof t?t.success?(e(".wpd-inline-form-wrapper").append(t.data),e.each(e("[name=\_wpd\_inline\_nonce]"),(function(){var t=e(this).attr("id"),a=e(this).parents(".wpd-inline-shortcode").attr("id");e(this).attr("id",t+"-"+a.substring(a.lastIndexOf("-")+1))})),e(".wpd-inline-opened").addClass("wpd-active"),e(".wpd-inline-opened").find(".wpd-inline-form-wrapper").show(),e(".wpd-inline-opened").find(".wpd-inline-icon").addClass("wpd-open"),e(".wpd-inline-opened").find(".wpd-inline-icon").removeClass("wpd-ignored"),le()):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data]),t.data,"error"):console.log(t)})).fail((function(e,t,a){console.log(a)}))}function ce(t){if(e(t).hasClass("wpd-inline-shortcode"))var a=e(t).attr("id");else a=e(t).parents(".wpd-inline-shortcode").attr("id");return a.substring(a.lastIndexOf("-")+1)}function pe(){e(".wpd-inline-form-wrapper").hide(),e(".wpd-inline-shortcode").removeClass("wpd-active"),e(".wpd-inline-icon").removeClass("wpd-open")}function re(){e.each(e(".wpd-inline-shortcode:not(.wpd-inline-opened) .wpd-inline-icon"),(function(){var t=e(this),a=t.offset().top-window.pageYOffset;t.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&a>0&&a<300&&("blink"===A?(t.addClass("wpd-blink"),setTimeout((function(){t.removeClass("wpd-blink")}),3e3)):(t.parents(".wpd-inline-shortcode").addClass("wpd-active"),t.siblings(".wpd-inline-form-wrapper").show(),t.addClass("wpd-open"),le(t.siblings(".wpd-inline-form-wrapper"))))}))}function le(t){if(t){if(t.offset().left<=10)t.css("left",Math.ceil(parseInt(t.css("left"))-t.offset().left+10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))<3&&(a=3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;");else if(t.offset().left+t.width()>document.body.clientWidth-10){var a;t.css("left",Math.ceil(parseInt(t.css("left"))+(document.body.clientWidth-(t.offset().left+t.width()))-10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))>t.width()-3&&(a=t.width()-3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;")}}else e.each(e(".wpd-inline-form-wrapper:visible"),(function(){if(e(this).offset().left<=10)e(this).css("left",Math.ceil(parseInt(e(this).css("left"))-e(this).offset().left+10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))<3&&(t=3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;");else if(e(this).offset().left+e(this).width()>document.body.clientWidth-10){var t;e(this).css("left",Math.ceil(parseInt(e(this).css("left"))+(document.body.clientWidth-(e(this).offset().left+e(this).width()))-10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))>e(this).width()-3&&(t=e(this).width()-3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;")}}))}function me(t){var a,o=0;if(t.parents(".wpd\_main\_comm\_form").length)o=parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents(".wpd\_main\_comm\_form");else if(t.parents(".wpd-secondary-form-wrapper").length)o=parseInt(wpdiscuzAjaxObj.replyTextMaxLength),a=t.parents(".wpd-secondary-form-wrapper");else if(t.parents("#wpdiscuz-edit-form").length){var n=$(t);o=parseInt(n.substring(n.lastIndexOf("\_")+1))?parseInt(wpdiscuzAjaxObj.replyTextMaxLength):parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents("#wpdiscuz-edit-form")}if(o&&a){var i=t.val().length,d=e(".wpd-editor-char-counter",a),s=o-i;d.html(s),s<=10?d.addClass("error"):d.removeClass("error")}}function we(t,a,o,n){t.data.callbackFunctions&&e.each(t.data.callbackFunctions,(function(e){"function"==typeof wpdiscuzAjaxObj[t.data.callbackFunctions[e]]?wpdiscuzAjaxObj[t.data.callbackFunctions[e]](t,a,o,n):"function"==typeof window[t.data.callbackFunctions[e]]?window[t.data.callbackFunctions[e]](t,a,o,n):console.log(t.data.callbackFunctions[e]+" is not a function")}))}function ue(t,a,o){a&&e("#wpdiscuz-loading-bar").show(),o.append("postId",d);var n=o.get("action");wpdiscuzAjaxObj.dataFilterCallbacks&&wpdiscuzAjaxObj.dataFilterCallbacks[n]&&e.each(wpdiscuzAjaxObj.dataFilterCallbacks[n],(function(e){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]]&&(o=wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]](o,t,a))}));var i=t?wpdiscuzAjaxObj.url:wpdiscuzAjaxObj.customAjaxUrl;return console.log(i),e.ajax({type:"POST",url:i,data:o,contentType:!1,processData:!1})}e(document).on("click","body",(function(t){if(e(t.target).hasClass("wpd-inline-form-close")||e(t.target).parents(".wpd-inline-form-close").length)t.preventDefault(),e(t.target).parents(".wpd-inline-form-wrapper").hide(),e(t.target).parents(".wpd-inline-shortcode").removeClass("wpd-active"),e(t.target).parents(".wpd-inline-form-wrapper").siblings(".wpd-inline-icon").removeClass("wpd-open");else if(!e(t.target).hasClass("wpd-inline-form-wrapper")&&!e(t.target).parents(".wpd-inline-form-wrapper").length){pe();var a="";e(t.target).hasClass("wpd-inline-icon")?a=e(t.target):e(t.target).parents(".wpd-inline-icon").length&&(a=e(t.target).parents(".wpd-inline-icon")),a.length&&a.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&(a.parents(".wpd-inline-shortcode").addClass("wpd-active"),a.siblings(".wpd-inline-form-wrapper").show(),a.addClass("wpd-open"),a.removeClass("wpd-ignored"),le(a.siblings(".wpd-inline-form-wrapper")))}(!e(t.target).hasClass("wpd-last-inline-comments-wrapper")&&!e(t.target).parents(".wpd-last-inline-comments-wrapper").length||e(t.target).parents(".wpd-last-inline-comments-wrapper").length&&e(t.target).hasClass("wpd-load-inline-comment"))&&e(".wpd-last-inline-comments-wrapper").remove()})),e("body").on("click",".wpd-inline-submit.wpd\_not\_clicked",(function(t){t.preventDefault();var a=e(this),o=e(this).parents(".wpd\_inline\_comm\_form");if(o[0].checkValidity()){e(this).removeClass("wpd\_not\_clicked");var n=new FormData;n.append("action","wpdAddInlineComment"),n.append("inline\_form\_id",ce(o)),e.each(e("input, textarea",o),(function(t,a){"checkbox"===this.type?e(this).is(":checked")&&n.append(e(a).attr("name"),e(a).val()):n.append(e(a).attr("name"),e(a).val())})),ue(v,!0,n).done((function(t){if(a.addClass("wpd\_not\_clicked"),"object"==typeof t)if(t.success){o[0].reset(),pe();var n=parseInt(t.data.newCount),i=a.parents(".wpd-inline-icon-wrapper").find(".wpd-inline-icon-count");i.text(n),n?i.addClass("wpd-has-comments"):i.removeClass("wpd-has-comments"),t.data.allCommentsCountNew=parseInt(t.data.allCommentsCountNew),e(".wpd-thread-info").html(t.data.allCommentsCountBeforeThreadsHtml),e(".wpd-thread-info").attr("data-comments-count",t.data.allCommentsCountNew),e("#wpd-bubble-all-comments-count").replaceWith(t.data.allCommentsCountBubbleHtml),t.data.message&&oe(t.data.message),wpdiscuzAjaxObj.setCommentMessage(t.data.notification,"success")}else t.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data,a),"error");else wpdiscuzAjaxObj.setCommentMessage(t,"error");e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("keydown",".wpd-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_comm\_submit").trigger("click")})),e("body").on("keydown","#wpdiscuz-edit-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_save\_edited\_comment").trigger("click")})),e("body").on("keydown",".wpd-inline-comment-content",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).parents(".wpd\_inline\_comm\_form").find(".wpd-inline-submit.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-inline-icon-count.wpd-has-comments",(function(){var t=e(this),a=new FormData;a.append("action","wpdGetLastInlineComments"),a.append("inline\_form\_id",ce(t)),ue(v,!0,a).done((function(a){"object"==typeof a?a.success?e(a.data).insertAfter(t):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-view-all-inline-comments",(function(t){t.preventDefault(),e(this).parents(".wpd-last-inline-comments-wrapper").remove(),e(".wpdf-inline").hasClass("wpdf-active")||e(".wpdf-inline").trigger("click"),te(),e("html, body").animate({scrollTop:e(".wpdf-inline").offset().top-I},1e3,ae)})),e("body").on("click",".wpd-feedback-content-link",(function(t){t.preventDefault();var a=e(this).data("feedback-content-id");te(),e("html, body").animate({scrollTop:e("#wpd-inline-"+a).offset().top-(I+6)},1e3,(function(){ae(),e("#wpd-inline-"+a).addClass("wpd-active")}))})),"scroll\_open"!==A&&"blink"!==A||(re(),e(window).on("scroll",re)),e("body").on("click","#wpd-post-rating.wpd-not-rated .wpd-rate-starts svg",(function(){var t=new FormData,a=e(this).index();a>=0&&a<5&&(t.append("action","wpdUserRate"),t.append("rating",a+1),ue(v,!0,t).done((function(t){"object"==typeof t?(t.success?location.reload(!0):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data),"error"),we(t)):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})))})),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){t.preventDefault();var a=e(this);const o=e("#wpdiscuz\_subscription\_button",a);if(a[0].checkValidity()&&(d=a,s=!0,"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&!e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).val().length?(s=!1,e(".wpdiscuz-recaptcha",d).css("border","1px solid red")):"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&e(".wpdiscuz-recaptcha",d).css("border","none"),s)&&o.hasClass("wpd\_not\_clicked")){o.removeClass("wpd\_not\_clicked");var i=new FormData;i.append("action","wpdAddSubscription"),e("\*",a).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&i.append(this.name+"",e(this).val()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):wpdiscuzAjaxObj.setCommentMessage(t,"error"),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1,o.addClass("wpd\_not\_clicked")})).fail((function(t,a,n){console.log(n),o.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}var d,s})),e("body").on("click",".wpd-unsubscribe",(function(t){t.preventDefault();var a=new FormData;a.append("action","wpdUnsubscribe"),a.append("sid",e(this).data("sid")),a.append("skey",e(this).data("skey")),ue(v,!0,a).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),wpdiscuzAjaxObj.resetActiveFilters=function(t){e(".wpd-filter.wpdf-active"+(t?":not("+t+")":"")).removeClass("wpdf-active")},wpdiscuzAjaxObj.getAjaxObj=ue}));var onloadCallback=function(){if(document.getElementById("wpdiscuz-recaptcha-0\_0")&&"2.0"===wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.render("wpdiscuz-recaptcha-0\_0",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(e){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("key")},"expired-callback":function(){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}; |
  | 11 | 11 | /\* Colorbox \*/ |
  | 12 | 12 | !function(t,e,i){var o,n,r,h,a,s,l,c,d,g,f,u,p,m,w,v,y,x,b,T,C,H,k,W,E,I,M,L,R,S,K,P,B,O={html:!1,photo:!1,iframe:!1,inline:!1,transition:"elastic",speed:300,fadeOut:300,width:!1,initialWidth:"600",innerWidth:!1,maxWidth:!1,height:!1,initialHeight:"450",innerHeight:!1,maxHeight:!1,scalePhotos:!0,scrolling:!0,opacity:.9,preloading:!0,className:!1,overlayClose:!0,escKey:!0,arrowKey:!0,top:!1,bottom:!1,left:!1,right:!1,fixed:!1,data:void 0,closeButton:!0,fastIframe:!0,open:!1,reposition:!0,loop:!0,slideshow:!1,slideshowAuto:!0,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).\*)?$/i,retinaImage:!1,retinaUrl:!1,retinaSuffix:"@2x.$1",current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",returnFocus:!0,trapFocus:!0,onOpen:!1,onLoad:!1,onComplete:!1,onCleanup:!1,onClosed:!1,rel:function(){return this.rel},href:function(){return t(this).attr("href")},title:function(){return this.title},createImg:function(){var e=new Image,i=t(this).data("cbox-img-attrs");return"object"==typeof i&&t.each(i,function(t,i){e[t]=i}),e},createIframe:function(){var i=e.createElement("iframe"),o=t(this).data("cbox-iframe-attrs");return"object"==typeof o&&t.each(o,function(t,e){i[t]=e}),"frameBorder"in i&&(i.frameBorder=0),"allowTransparency"in i&&(i.allowTransparency="true"),i.name=(new Date).getTime(),i.allowFullscreen=!0,i}},\_="colorbox",j="cbox",D=j+"Element",F=j+"\_open",N=j+"\_load",z=j+"\_complete",A=j+"\_cleanup",q=j+"\_closed",U=j+"\_purge",$=t("<a/>"),G="div",Q=0,J={};function V(i,o,n){var r=e.createElement(i);return o&&(r.id=j+o),n&&(r.style.cssText=n),t(r)}function X(){return i.innerHeight?i.innerHeight:t(i).height()}function Y(e,i){i!==Object(i)&&(i={}),this.cache={},this.el=e,this.value=function(e){var o;return void 0===this.cache[e]&&(void 0!==(o=t(this.el).attr("data-cbox-"+e))?this.cache[e]=o:void 0!==i[e]?this.cache[e]=i[e]:void 0!==O[e]&&(this.cache[e]=O[e])),this.cache[e]},this.get=function(t){var e=this.value(t);return"function"==typeof e?e.call(this.el,this):e}}function Z(t){var e=d.length,i=(I+t)%e;return i<0?e+i:i}function tt(t,e){return Math.round((/%/.test(t)?("x"===e?g.width():X())/100:1)\*parseInt(t,10))}function et(t,e){return t.get("photo")||t.get("photoRegex").test(e)}function it(t,e){return t.get("retinaUrl")&&i.devicePixelRatio>1?e.replace(t.get("photoRegex"),t.get("retinaSuffix")):e}function ot(t){"contains"in n[0]&&!n[0].contains(t.target)&&t.target!==o[0]&&(t.stopPropagation(),n.trigger("focus"))}function nt(t){nt.str!==t&&(n.add(o).removeClass(nt.str).addClass(t),nt.str=t)}function rt(i){t(e).trigger(i),$.triggerHandler(i)}var ht=function(){var t,e,i=j+"Slideshow\_",o="click."+j;function r(){clearTimeout(e)}function h(){(C.get("loop")||d[I+1])&&(r(),e=setTimeout(P.next,C.get("slideshowSpeed")))}function a(){v.html(C.get("slideshowStop")).off(o).one(o,s),$.on(z,h).on(N,r),n.removeClass(i+"off").addClass(i+"on")}function s(){r(),$.off(z,h).off(N,r),v.html(C.get("slideshowStart")).off(o).one(o,function(){P.next(),a()}),n.removeClass(i+"on").addClass(i+"off")}function l(){t=!1,v.hide(),r(),$.off(z,h).off(N,r),n.removeClass(i+"off "+i+"on")}return function(){t?C.get("slideshow")||($.off(A,l),l()):C.get("slideshow")&&d[1]&&(t=!0,$.one(A,l),C.get("slideshowAuto")?a():s(),v.show())}}();function at(r){var g,w;if(!S){if(g=t(r).data(\_),C=new Y(r,g),w=C.get("rel"),I=0,w&&!1!==w&&"nofollow"!==w?(d=t("."+D).filter(function(){return new Y(this,t.data(this,\_)).get("rel")===w}),-1===(I=d.index(C.el))&&(d=d.add(C.el),I=d.length-1)):d=t(C.el),!L){L=R=!0,nt(C.get("className")),n.css({visibility:"hidden",display:"block",opacity:""}),f=V(G,"LoadedContent","width:0; height:0; overflow:hidden; visibility:hidden"),h.css({width:"",height:""}).append(f),H=a.height()+c.height()+h.outerHeight(!0)-h.height(),k=s.width()+l.width()+h.outerWidth(!0)-h.width(),W=f.outerHeight(!0),E=f.outerWidth(!0);var v=tt(C.get("initialWidth"),"x"),y=tt(C.get("initialHeight"),"y"),x=C.get("maxWidth"),B=C.get("maxHeight");C.w=Math.max((!1!==x?Math.min(v,tt(x,"x")):v)-E-k,0),C.h=Math.max((!1!==B?Math.min(y,tt(B,"y")):y)-W-H,0),f.css({width:"",height:C.h}),P.position(),rt(F),C.get("onOpen"),T.add(m).hide(),n.trigger("focus"),C.get("trapFocus")&&e.addEventListener&&(e.addEventListener("focus",ot,!0),$.one(q,function(){e.removeEventListener("focus",ot,!0)})),C.get("returnFocus")&&$.one(q,function(){t(C.el).trigger("focus")})}var O=parseFloat(C.get("opacity"));o.css({opacity:O==O?O:"",cursor:C.get("overlayClose")?"pointer":"",visibility:"visible"}).show(),C.get("closeButton")?b.html(C.get("close")).appendTo(h):b.appendTo("<div/>"),function(){var e,o,n,r=P.prep,h=++Q;R=!0,M=!1,rt(U),rt(N),C.get("onLoad"),C.h=C.get("height")?tt(C.get("height"),"y")-W-H:C.get("innerHeight")&&tt(C.get("innerHeight"),"y"),C.w=C.get("width")?tt(C.get("width"),"x")-E-k:C.get("innerWidth")&&tt(C.get("innerWidth"),"x"),C.mw=C.w,C.mh=C.h,C.get("maxWidth")&&(C.mw=tt(C.get("maxWidth"),"x")-E-k,C.mw=C.w&&C.w<C.mw?C.w:C.mw);C.get("maxHeight")&&(C.mh=tt(C.get("maxHeight"),"y")-W-H,C.mh=C.h&&C.h<C.mh?C.h:C.mh);if(e=C.get("href"),K=setTimeout(function(){p.show()},100),C.get("inline")){var a=t(e).eq(0);n=t("<div>").hide().insertBefore(a),$.one(U,function(){n.replaceWith(a)}),r(a)}else C.get("iframe")?r(" "):C.get("html")?r(C.get("html")):et(C,e)?(e=it(C,e),M=C.get("createImg"),t(M).addClass(j+"Photo").on("error."+j,function(){r(V(G,"Error").html(C.get("imgError")))}).one("load",function(){h===Q&&setTimeout(function(){var e;C.get("retinaImage")&&i.devicePixelRatio>1&&(M.height=M.height/i.devicePixelRatio,M.width=M.width/i.devicePixelRatio),C.get("scalePhotos")&&(o=function(){M.height-=M.height\*e,M.width-=M.width\*e},C.mw&&M.width>C.mw&&(e=(M.width-C.mw)/M.width,o()),C.mh&&M.height>C.mh&&(e=(M.height-C.mh)/M.height,o())),C.h&&(M.style.marginTop=Math.max(C.mh-M.height,0)/2+"px"),d[1]&&(C.get("loop")||d[I+1])&&(M.style.cursor="pointer",t(M).on("click."+j,function(){P.next()})),M.style.width=M.width+"px",M.style.height=M.height+"px",r(M)},1)}),M.src=e):e&&u.load(e,C.get("data"),function(e,i){h===Q&&r("error"===i?V(G,"Error").html(C.get("xhrError")):t(this).contents())})}()}}function st(){n||(B=!1,g=t(i),n=V(G).attr({id:\_,class:!1===t.support.opacity?j+"IE":"",role:"dialog",tabindex:"-1"}).hide(),o=V(G,"Overlay").hide(),p=t([V(G,"LoadingOverlay")[0],V(G,"LoadingGraphic")[0]]),r=V(G,"Wrapper"),h=V(G,"Content").append(m=V(G,"Title"),w=V(G,"Current"),x=t('<button type="button"/>').attr({id:j+"Previous"}),y=t('<button type="button"/>').attr({id:j+"Next"}),v=t('<button type="button"/>').attr({id:j+"Slideshow"}),p),b=t('<button type="button"/>').attr({id:j+"Close"}),r.append(V(G).append(V(G,"TopLeft"),a=V(G,"TopCenter"),V(G,"TopRight")),V(G,!1,"clear:left").append(s=V(G,"MiddleLeft"),h,l=V(G,"MiddleRight")),V(G,!1,"clear:left").append(V(G,"BottomLeft"),c=V(G,"BottomCenter"),V(G,"BottomRight"))).find("div div").css({float:"left"}),u=V(G,!1,"position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;"),T=y.add(x).add(w).add(v)),e.body&&!n.parent().length&&t(e.body).append(o,n.append(r,u))}function lt(){function i(t){t.which>1||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey||(t.preventDefault(),at(this))}return!!n&&(B||(B=!0,y.on("click",function(){P.next()}),x.on("click",function(){P.prev()}),b.on("click",function(){P.close()}),o.on("click",function(){C.get("overlayClose")&&P.close()}),t(e).on("keydown."+j,function(t){var e=t.keyCode;L&&C.get("escKey")&&27===e&&(t.preventDefault(),P.close()),L&&C.get("arrowKey")&&d[1]&&!t.altKey&&(37===e?(t.preventDefault(),x.trigger("click")):39===e&&(t.preventDefault(),y.trigger("click")))}),"function"==typeof t.fn.on?t(e).on("click."+j,"."+D,i):t("."+D).live("click."+j,i)),!0)}t[\_]||(t(st),(P=t.fn[\_]=t[\_]=function(e,i){var o=this;return e=e||{},"function"==typeof o&&(o=t("<a/>"),e.open=!0),o[0]?(st(),lt()&&(i&&(e.onComplete=i),o.each(function(){var i=t.data(this,\_)||{};t.data(this,\_,t.extend(i,e))}).addClass(D),new Y(o[0],e).get("open")&&at(o[0])),o):o}).position=function(e,i){var o,d,f,u=0,p=0,m=n.offset();function w(){a[0].style.width=c[0].style.width=h[0].style.width=parseInt(n[0].style.width,10)-k+"px",h[0].style.height=s[0].style.height=l[0].style.height=parseInt(n[0].style.height,10)-H+"px"}if(g.off("resize."+j),n.css({top:-9e4,left:-9e4}),d=g.scrollTop(),f=g.scrollLeft(),C.get("fixed")?(m.top-=d,m.left-=f,n.css({position:"fixed"})):(u=d,p=f,n.css({position:"absolute"})),!1!==C.get("right")?p+=Math.max(g.width()-C.w-E-k-tt(C.get("right"),"x"),0):!1!==C.get("left")?p+=tt(C.get("left"),"x"):p+=Math.round(Math.max(g.width()-C.w-E-k,0)/2),!1!==C.get("bottom")?u+=Math.max(X()-C.h-W-H-tt(C.get("bottom"),"y"),0):!1!==C.get("top")?u+=tt(C.get("top"),"y"):u+=Math.round(Math.max(X()-C.h-W-H,0)/2),n.css({top:m.top,left:m.left,visibility:"visible"}),r[0].style.width=r[0].style.height="9999px",o={width:C.w+E+k,height:C.h+W+H,top:u,left:p},e){var v=0;t.each(o,function(t){o[t]===J[t]||(v=e)}),e=v}J=o,e||n.css(o),n.dequeue().animate(o,{duration:e||0,complete:function(){w(),R=!1,r[0].style.width=C.w+E+k+"px",r[0].style.height=C.h+W+H+"px",C.get("reposition")&&setTimeout(function(){g.on("resize."+j,P.position)},1),"function"==typeof i&&i()},step:w})},P.resize=function(t){var e;L&&((t=t||{}).width&&(C.w=tt(t.width,"x")-E-k),t.innerWidth&&(C.w=tt(t.innerWidth,"x")),f.css({width:C.w}),t.height&&(C.h=tt(t.height,"y")-W-H),t.innerHeight&&(C.h=tt(t.innerHeight,"y")),t.innerHeight||t.height||(e=f.scrollTop(),f.css({height:"auto"}),C.h=f.height()),f.css({height:C.h}),e&&f.scrollTop(e),P.position("none"===C.get("transition")?0:C.get("speed")))},P.prep=function(i){if(L){var o,r="none"===C.get("transition")?0:C.get("speed");f.remove(),(f=V(G,"LoadedContent").append(i)).hide().appendTo(u.show()).css({width:(C.w=C.w||f.width(),C.w=C.mw&&C.mw<C.w?C.mw:C.w,C.w),overflow:C.get("scrolling")?"auto":"hidden"}).css({height:(C.h=C.h||f.height(),C.h=C.mh&&C.mh<C.h?C.mh:C.h,C.h)}).prependTo(h),u.hide(),t(M).css({float:"none"}),nt(C.get("className")),o=function(){var i,o,h=d.length;function a(){!1===t.support.opacity&&n[0].style.removeAttribute("filter")}L&&(o=function(){clearTimeout(K),p.hide(),rt(z),C.get("onComplete")},m.html(C.get("title")).show(),f.show(),h>1?("string"==typeof C.get("current")&&w.html(C.get("current").replace("{current}",I+1).replace("{total}",h)).show(),y[C.get("loop")||I<h-1?"show":"hide"]().html(C.get("next")),x[C.get("loop")||I?"show":"hide"]().html(C.get("previous")),ht(),C.get("preloading")&&t.each([Z(-1),Z(1)],function(){var i=d[this],o=new Y(i,t.data(i,\_)),n=o.get("href");n&&et(o,n)&&(n=it(o,n),e.createElement("img").src=n)})):T.hide(),C.get("iframe")?(i=C.get("createIframe"),C.get("scrolling")||(i.scrolling="no"),t(i).attr({src:C.get("href"),class:j+"Iframe"}).one("load",o).appendTo(f),$.one(U,function(){i.src="//about:blank"}),C.get("fastIframe")&&t(i).trigger("load")):o(),"fade"===C.get("transition")?n.fadeTo(r,1,a):a())},"fade"===C.get("transition")?n.fadeTo(r,0,function(){P.position(0,o)}):P.position(r,o)}},P.next=function(){!R&&d[1]&&(C.get("loop")||d[I+1])&&(I=Z(1),at(d[I]))},P.prev=function(){!R&&d[1]&&(C.get("loop")||I)&&(I=Z(-1),at(d[I]))},P.close=function(){L&&!S&&(S=!0,L=!1,rt(A),C.get("onCleanup"),g.off("."+j),o.fadeTo(C.get("fadeOut")||0,0),n.stop().fadeTo(C.get("fadeOut")||0,0,function(){n.hide(),o.hide(),rt(U),f.remove(),setTimeout(function(){S=!1,rt(q),C.get("onClosed")},1)}))},P.remove=function(){n&&(n.stop(),t[\_].close(),n.stop(!1,!0).remove(),o.remove(),S=!1,n=null,t("."+D).removeData(\_).removeClass(D),t(e).off("click."+j).off("keydown."+j))},P.element=function(){return t(C.el)},P.settings=O)}(jQuery,document,window); |
* ## [wpdiscuz/trunk/assets/js/wpdiscuz.js](/changeset/3124810/wpdiscuz/trunk/assets/js/wpdiscuz.js "Show the changeset 3124810 restricted to wpdiscuz/trunk/assets/js/wpdiscuz.js")

  | [r3106072](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.js?rev=3106072#L656 "Show revision 3106072 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.js?rev=3124810#L656 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 656 | 656 | } |
  | 657 | 657 | runCallbacks(r, wcForm); |
  |  | 658 | $(document.body).trigger('wpdiscuz\_comment\_posted', [r.data.new\_comment\_id, r.data.wc\_all\_comments\_count\_new]); |
  | 658 | 659 | } else if (r.data) { |
  | 659 | 660 | wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[r.data], r.data, wcForm), 'error'); |
  | […](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.js?rev=3106072#L672) | […](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.js?rev=3124810#L673) |  |
  | 672 | 673 | }); |
  | 673 | 674 | } |
  |  | 675 |  |
  |  | 676 | $(document.body).on('wpdiscuz\_comment\_posted', function(e, commentID, commentsCount) { |
  |  | 677 | const threadFilter = $('.wpd-thread-filter'); |
  |  | 678 |  |
  |  | 679 | if (isNaN(commentsCount) || (typeof commentsCount === 'undefined') || !commentsCount) { |
  |  | 680 | threadFilter.find('.wpd-filter').addClass('wpdiscuz-hidden'); |
  |  | 681 | } else { |
  |  | 682 | threadFilter.find('.wpd-filter').removeClass('wpdiscuz-hidden'); |
  |  | 683 | } |
  |  | 684 | }); |
  | 674 | 685 |  |
  | 675 | 686 | function notifySubscribers(r) { |
* ## [wpdiscuz/trunk/assets/js/wpdiscuz.min.js](/changeset/3124810/wpdiscuz/trunk/assets/js/wpdiscuz.min.js "Show the changeset 3124810 restricted to wpdiscuz/trunk/assets/js/wpdiscuz.min.js")

  | [r3106072](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.min.js?rev=3106072#L1 "Show revision 3106072 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/assets/js/wpdiscuz.min.js?rev=3124810#L1 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 1 |  | var wpdiscuzLoadRichEditor=parseInt(wpdiscuzAjaxObj.loadRichEditor);if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap"))var wpDiscuzEditor=new WpdEditor;function wpdMessagesOnInit(e,t){wpdiscuzAjaxObj.setCommentMessage(e,t),setTimeout((function(){location.href=location.href.substring(0,location.href.indexOf("wpdiscuzUrlAnchor")-1)}),3e3)}wpdiscuzAjaxObj.setCommentMessage=function(e,t,a){var o="wpdiscuz-message-error";if(e instanceof Array)for(var n in e)t instanceof Array?"success"===t[n]?o="wpdiscuz-message-success":"warning"===t[n]&&(o="wpdiscuz-message-warning"):"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e[n]).prependTo("#wpdiscuz-comment-message").delay(a instanceof Array?a[n]:a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}));else"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e).prependTo("#wpdiscuz-comment-message").delay(a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}))},wpdiscuzAjaxObj.applyFilterOnPhrase=function(e,t,a){return wpdiscuzAjaxObj.phraseFilters&&jQuery.each(wpdiscuzAjaxObj.phraseFilters,(function(o){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]]&&(e=wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]](e,t,a))})),e},jQuery(document).ready((function(e){e("body").addClass("wpdiscuz\_"+wpdiscuzAjaxObj.version);var t=wpdiscuzAjaxObj.is\_user\_logged\_in,a=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!t,o=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&t,n=wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion,i=parseInt(wpdiscuzAjaxObj.commentListLoadType),d=parseInt(wpdiscuzAjaxObj.wc\_post\_id),s=parseInt(wpdiscuzAjaxObj.commentListUpdateType),c=1e3\*parseInt(wpdiscuzAjaxObj.commentListUpdateTimer),p=parseInt(wpdiscuzAjaxObj.liveUpdateGuests),r=wpdiscuzAjaxObj.loadLastCommentId,l=r,m=parseInt(wpdiscuzAjaxObj.firstLoadWithAjax);Cookies.get("wpdiscuz\_comments\_sorting")&&Cookies.remove("wpdiscuz\_comments\_sorting",{path:""}),Cookies.get("wordpress\_last\_visit")&&Cookies.remove("wordpress\_last\_visit",{path:""}),Cookies.get("wpdiscuz\_last\_visit")&&Cookies.remove("wpdiscuz\_last\_visit",{path:""});var w,u=parseInt(wpdiscuzAjaxObj.wordpressIsPaginate),f=wpdiscuzAjaxObj.storeCommenterData,h=(parseInt(wpdiscuzAjaxObj.wmuEnabled),wpdiscuzAjaxObj.isCookiesEnabled),b=!0,\_=wpdiscuzAjaxObj.cookiehash,g=parseInt(wpdiscuzAjaxObj.isLoadOnlyParentComments),z=parseInt(wpdiscuzAjaxObj.enableDropAnimation)?500:0,v=parseInt(wpdiscuzAjaxObj.isNativeAjaxEnabled),j=parseInt(wpdiscuzAjaxObj.enableBubble),x=parseInt(wpdiscuzAjaxObj.bubbleLiveUpdate),C=parseInt(wpdiscuzAjaxObj.bubbleHintTimeout),y=parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout)?parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout):5,k=parseInt(wpdiscuzAjaxObj.bubbleShowNewCommentMessage),O=wpdiscuzAjaxObj.bubbleLocation,A=wpdiscuzAjaxObj.inlineFeedbackAttractionType,I=(I=parseInt(wpdiscuzAjaxObj.scrollSize))||32,T=[],D=[],E=[],F=!1,M=1,L=e("html").css("scroll-behavior"),R=e("body").css("scroll-behavior");(e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").length?e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").length?e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .social\_connect\_form").length?e(".wc\_social\_plugin\_wrapper .social\_connect\_form").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .oneall\_social\_login\_providers").length&&e(".wc\_social\_plugin\_wrapper .oneall\_social\_login .oneall\_social\_login\_providers").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"),wpdiscuzLoadRichEditor&&e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0"),window.addEventListener("beforeunload",(function(t){var a=e(".wpd-form").not(":hidden");if(a.length)if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap")){for(var o=0;o<a.length;o++)if("\n"!==wpDiscuzEditor.createEditor(e(a[o]).find(".ql-container").attr("id")).getText())return t.preventDefault(),void(t.returnValue="")}else for(o=0;o<a.length;o++)if(e(a[o]).find(".wc\_comment").val())return t.preventDefault(),void(t.returnValue="")})),wpdiscuzLoadRichEditor||(e(document).delegate("textarea.wc\_comment","input",(function(){me(e(this))})),e.each(e("textarea.wc\_comment"),(function(){me(e(this))}))),e("body").on("focus","#wpdcom .ql-editor, #wpdcom .wc\_comment",(function(){e(".wpd-form-foot",e(this).parents(".wpd\_comm\_form")).slideDown(z)})),e("body").on("focus","#wpdcom textarea",(function(){e(this).next(".autogrow-textarea-mirror").length||e(this).autoGrow()})),t)||q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)});if(e(".wpd-vote-down.wpd-dislike-hidden").remove(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd"),e("body").on("click","#wpd-editor-source-code-wrapper-bg",(function(){e(this).hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),wpdiscuzLoadRichEditor&&e("body").on("click","#wpd-insert-source-code",(function(){var t=wpDiscuzEditor.createEditor("#"+e("#wpd-editor-uid").val());t.deleteText(0,t.getLength(),Quill.sources.USER);var a=e("#wpd-editor-source-code").val();a.length&&t.clipboard.dangerouslyPasteHTML(0,a,Quill.sources.USER),t.update(),e("#wpd-editor-source-code-wrapper-bg").hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),e("body").on("click",".wpd-reply-button",(function(){var i=$(e(this),0);e(this).hasClass("wpdiscuz-clonned")?(wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+i).focus()}),z):setTimeout((function(){e("#wc-textarea-"+i).trigger("focus")}),z),e("#wpd-secondary-form-wrapper-"+i).slideToggle(z)):function(a){var o=$(a,0);e("#wpdiscuz\_form\_anchor-"+o).before(function(t){return e("#wpdiscuz\_hidden\_secondary\_form").html().replace(/wpdiscuzuniqueid/g,t)}(o));var n=e("#wpd-secondary-form-wrapper-"+o);if(!t){q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)})}wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+o).focus()}),z):setTimeout((function(){e("#wc-textarea-"+o).trigger("focus")}),z);n.slideToggle(z,(function(){a.addClass("wpdiscuz-clonned")}))}(e(this)),function(t){if((a||o)&&"2.0"===n){var i=X(t);setTimeout((function(){if(!D[i])try{D[i]=grecaptcha.render("wpdiscuz-recaptcha-"+t,{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(a){e("#wpdiscuz-recaptcha-field-"+t).val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-"+t).val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3)}}(i)})),e("body").on("click","#wpdcom [data-wpd-clipboard]",(function(){var t=e(this).data("wpd-clipboard");e(this).data("wpd-ismention")&&(t="@"+t);var a=e("<input/>");a.appendTo("body").css({position:"absolute",top:"-10000000px"}).val(t),a.trigger("select"),document.execCommand("copy"),a.remove(),wpdiscuzAjaxObj.setCommentMessage(t+"<br/>"+wpdiscuzAjaxObj.wc\_copied\_to\_clipboard,"success",5e3)})),e("body").on("click",".wpdiscuz-nofollow,.wc\_captcha\_refresh\_img,.wpd-load-more-submit",(function(e){e.preventDefault()})),e("body").on("click",".wpd-toggle.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked");var a=$(e(this),0),o=e(this),n=e(".fas",o);!o.parents(".wpd-comment:not(.wpd-reply)").children(".wpd-reply").length&&g?function(t,a){var o=X(t),n=new FormData;n.append("action","wpdShowReplies"),n.append("commentId",o),ue(v,!0,n).done((function(o){a.addClass("wpd\_not\_clicked"),"object"==typeof o&&o.success&&(e("#wpd-comm-"+t).replaceWith(o.data.comment\_list),e("#wpd-comm-"+t+" .wpd-toggle .fas").removeClass("fa-chevron-down").addClass("fa-chevron-up"),e("#wpd-comm-"+t+" .wpd-toggle .wpd-view-replies .wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),e("#wpd-comm-"+t+" .wpd-toggle").attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text),we(o)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,o,n){console.log(n),a.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}(a,t):e("#wpd-comm-"+a+"> .wpd-reply").slideToggle(700,(function(){e(this).is(":hidden")?(n.removeClass("fa-chevron-up"),n.addClass("fa-chevron-down"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_show\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_show\_replies\_text)):(n.removeClass("fa-chevron-down"),n.addClass("fa-chevron-up"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text)),t.addClass("wpd\_not\_clicked")}))})),e("body").on("mouseenter",".wpd-new-loaded-comment",(function(){e(this).removeClass("wpd-new-loaded-comment")})),e("body").on("click",".wpd-sbs-toggle",(function(){e(".wpdiscuz-subscribe-bar").slideToggle(z)})),parseInt(wpdiscuzAjaxObj.wpDiscuzIsShowOnSubscribeForm)&&!t&&wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&e("#wpdiscuz-subscribe-form").length&&("2.0"===n?(setTimeout((function(){try{grecaptcha.render("wpdiscuz-recaptcha-subscribe-form",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-subscribe-form").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val()?e(".wpdiscuz-recaptcha",e(this)).css("border","none"):(e(".wpdiscuz-recaptcha",e(this)).css("border","1px solid red"),ee(e(this),""),t.preventDefault())}))):"3.0"===n&&e("body").on("click","#wpdiscuz\_subscription\_button",(function(t){var a=e(this).parents("#wpdiscuz-subscribe-form");ee(a,""),t.preventDefault();try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/wpdAddSubscription"}).then((function(e){document.getElementById("wpdiscuz-recaptcha-field-subscribe-form").value=e,a.trigger("submit")}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error")}}))),(a||o)&&"2.0"===n){var S=e(window).width(),H=e("#wpdcom").width();H>=1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"65%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"35%"})),H>=940&&H<1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"60%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"40%"})),H>=810&&H<940&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"60%"})),H>=730&&H<810&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"45%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"55%"})),H>=610&&H<730&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.85)","-webkit-transform":"scale(0.85)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"43%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"55%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"})),S>650&&(H>=510&&H<610&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"35%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"63%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%",position:"relative",right:"-60px"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H>=470&&H<510&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"60%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd\_main\_comm\_form .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H<470&&(e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({margin:"0px auto","transform-origin":"center 0","-webkit-transform-origin":"center 0"}),e("#wpdcom .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc\_notification\_checkboxes").css({"text-align":"center"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-field-submit").css({"text-align":"center"})))}function P(t,a,o){ue(v,!1,a).done((function(a){if(e(o).addClass("wpd\_not\_clicked"),"object"==typeof a)if(a.success){"collapsed"===wpdiscuzAjaxObj.commentFormView&&e(".wpd-form-foot",t).slideUp(z),a.data.wc\_all\_comments\_count\_new=parseInt(a.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(a.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(a.data.wc\_all\_comments\_count\_bubble\_html);var n=z;a.data.is\_main?oe(a.data.message):(n=z+700,e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).slideToggle(700),1==a.data.is\_in\_same\_container?e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).after(a.data.message):e("#wpd-comm-"+a.data.uniqueid).after(a.data.message)),function(e){if(!e.data.held\_moderate){var t=new FormData;t.append("action","wpdCheckNotificationType"),t.append("comment\_id",e.data.new\_comment\_id),t.append("email",e.data.comment\_author\_email),t.append("isParent",e.data.is\_main),ue(v,!0,t)}}(a),function(e){if(e.data.redirect>0&&e.data.new\_comment\_id){var t=new FormData;t.append("action","wpdRedirect"),t.append("commentId",e.data.new\_comment\_id),ue(v,!0,t).done((function(e){"object"==typeof e&&e.success&&setTimeout((function(){location.href=e.data}),2e3)})).fail((function(e,t,a){console.log(a)}))}}(a),h&&b?function(t){var a=t.comment\_author\_email,o=t.comment\_author,n=t.comment\_author\_url;null==f?(Cookies.set("comment\_author\_email\_"+\_,a),Cookies.set("comment\_author\_"+\_,o),n.length&&Cookies.set("comment\_author\_url\_"+\_,n)):(f=parseInt(f),Cookies.set("comment\_author\_email\_"+\_,a,{expires:f,path:"/"}),Cookies.set("comment\_author\_"+\_,o,{expires:f,path:"/"}),n.length&&Cookies.set("comment\_author\_url\_"+\_,n,{expires:f,path:"/"}));e(".wpd-cookies-checkbox").length&&e(".wpd-cookies-checkbox").prop("checked",!0)}(a.data):b||e(".wpd-cookies-checkbox").prop("checked",!1),t.get(0).reset(),wpdiscuzLoadRichEditor?wpDiscuzEditor.createEditor("#wpd-editor-"+e(".wpdiscuz\_unique\_id",t).val()).setContents([{insert:"\n"}]):me(t.find(".wc\_comment")),q(a.data),e(".wmu-preview-wrap",t).remove(),T.length&&(T.forEach((function(e){e.parents(".wpd-field-checkbox").remove()})),T=[]),parseInt(wpdiscuzAjaxObj.scrollToComment)&&setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.new\_comment\_id).offset().top-I},1e3,ae)}),n),we(a,t)~~}else a.data&&(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"),we(a,t));else wpdiscuzAjaxObj.setCommentMessage(a,"error");e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,n){console.log(n),e(o).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}function q(t){e(".wpd\_comm\_form .wc\_name").val(t.comment\_author),t.comment\_author\_email&&t.comment\_author\_email.indexOf("@example.com")<0&&e(".wpd\_comm\_form .wc\_email").val(t.comment\_author\_email),t.comment\_author\_url&&e(".wpd\_comm\_form .wc\_website").val(t.comment\_author\_url)}function U(t,a){e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").show(),e("#wpd-comm-"+t+" .wpdiscuz-edit-form-wrap").replaceWith(a),e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-last-edited").show()}e("body").on("click",".wc\_comm\_submit.wpd\_not\_clicked",(function(){var i=e(this),d=1,s=e(this).parents("form");if("true"!==s.attr("data-uploading")){if(s.hasClass("wpd\_main\_comm\_form")||(d=function(t){var a=t.attr("class").split(" "),o="";return e.each(a,(function(e,t){"wpd\_comment\_level"===Y(t,!1)&&(o=Y(t,!0))})),parseInt(o)+1}(e(this).parents(".wpd-comment"))),ee(s,"#wpd-editor-"+e(".wpdiscuz\_unique\_id",s).val()),s.on("submit",(function(e){e.preventDefault()})),s[0].checkValidity()&&(p=s,r=!0,"2.0"===n&&e("input[name=wc\_captcha]",p).length&&!e("input[name=wc\_captcha]",p).val().length?(r=!1,e(".wpdiscuz-recaptcha",p).css("border","1px solid red")):"2.0"===n&&e("input[name=wc\_captcha]",p).length&&e(".wpdiscuz-recaptcha",p).css("border","none"),r)){F=!0,function(t){e(".wpd-agreement-checkbox",t).each((function(){e(this).hasClass("wpd\_agreement\_hide")&&h&&e(this).prop("checked")&&(Cookies.set(e(this).attr("name")+"\_"+\_,1,{expires:30,path:"/"}),e("input[name="+e(this).attr("name")+"]").each((function(){T.push(e(this))})))}))}(s),e(i).removeClass("wpd\_not\_clicked");var c=new FormData;if(c.append("action","wpdAddComment"),e(":input",s).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&c.append(this.name+"",e(this).val().trim()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&c.append(this.name+"",e(this).val())})),c.append("wpd\_comment\_depth",d),wpdiscuzAjaxObj.wpdiscuz\_zs&&c.append("wpdiscuz\_zs",wpdiscuzAjaxObj.wpdiscuz\_zs),e(".wpd-cookies-checkbox",s).length?e(".wpd-cookies-checkbox",s).prop("checked")||(b=!1):t&&(b=!1),e("#wpdiscuz-loading-bar").show(),wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&"3.0"===n&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/addComment"}).then((function(e){c.append("g-recaptcha-response",e),P(s,c,i)}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)}else P(s,c,i)}var p,r;!function(e){if((a||o)&&"2.0"===n){var t=X(e);grecaptcha.reset(D[t])}}(e(".wpdiscuz\_unique\_id",s).val()),e(".wpdiscuz\_reset").val("")}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj.wmuPhraseDoingUpload,"wmuPhraseDoingUpload",s),"warning")})),e("body").on("click",".wpd\_editable\_comment",(function(){w&&e(".wpdiscuz-edit-form-wrap").length&&U($(e(".wpdiscuz-edit-form-wrap"),0),w);var t=e(this),a=$(t,0),o=X(a),n=new FormData;n.append("action","wpdEditComment"),n.append("commentId",o),w=e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-text").get(0),ue(v,!0,n).done((function(o){if("object"==typeof o)if(o.success){if(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text").replaceWith(o.data.html),wpdiscuzLoadRichEditor){var n=wpDiscuzEditor.createEditor("#wpd-editor-edit\_"+a);n.clipboard.dangerouslyPasteHTML(0,o.data.content),n.update(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd")}else e("#wc-textarea-edit\_"+a).val(o.data.content),me(e("#wc-textarea-edit\_"+a));e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").hide(),e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").hide()}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[o.data],o.data,t),"error");else console.log(o);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wc\_save\_edited\_comment",(function(){var t=e(this),a=$(t),o=X(a),n=e("#wpd-comm-"+a+" #wpdiscuz-edit-form");if(ee(n,"#wpd-editor-edit\_"+a),n.on("submit",(function(e){e.preventDefault()})),n[0].checkValidity()){var i=new FormData;i.append("action","wpdSaveEditedComment"),i.append("commentId",o),e(":input",n).each((function(){""!==this.name&&"checkbox"!==this.type&&"radio"!==this.type&&i.append(this.name+"",e(this).val()),"checkbox"!==this.type&&"radio"!==this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(n){"object"==typeof n?(n.success?(U(a,n.data.message),n.data.comment\_approved\_html&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-subheader").append(n.data.comment\_approved\_html),n.data.lastEdited&&(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").remove(),e(n.data.lastEdited).insertAfter("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text")),n.data.twitterShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_tw").attr("href",n.data.twitterShareLink),n.data.whatsappShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_whatsapp").attr("href",n.data.whatsappShareLink),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error"),we(n,o)):wpdiscuzAjaxObj.setCommentMessage(n,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("click",".wc\_cancel\_edit",(function(){var t=$(e(this));U(t,w),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+t)})),!u&&m&&(M=0,1==m?setTimeout((function(){V(!0)}),500):e("body").on("click",".wpd-load-comments",(function(){e(this).parent(".wpd-load-more-submit-wrap").remove(),V(!0)}))),e("body").on("click",".wpd-load-more-submit",(function(){var t=e(this),a="wpd-loaded";t.hasClass(a)&&V(!1,t,a,"wpd-loading")}));var W=!1;function B(){var t=document.getElementById("wpdiscuzHasMoreComments"),a=0;t&&(a=t.dataset.is\_show\_load\_more);var o=document.getElementById("wpdcom")?document.getElementById("wpdcom").clientHeight:0,n=e(window).height()+e(window).scrollTop();o&&n&&(100\*n/o>=80&&!1===W&&1==a&&(W=!0,V(!1,e(".wpd-load-more-submit"))))}function V(t,a,o,n){a&&(a.toggleClass(o),a.toggleClass(n));var d=new FormData;d.append("action","wpdLoadMoreComments");var s=e(".wpdiscuz-sort-button-active").attr("data-sorting");s&&d.append("sorting",s),d.append("offset",M),d.append("lastParentId",e(".wpd-load-more-submit").attr("data-lastparentid")),d.append("isFirstLoad",t?1:0);var c=e(".wpdf-active").attr("data-filter-type");d.append("wpdType",c||""),ue(v,!t||1!=m,d).done((function(d){"object"==typeof d&&d.success&&(M++,t&&e(".wpd-comment").remove(),e(".wpdiscuz\_single").remove(),e(".wpdiscuz-comment-pagination").before(d.data.comment\_list),K(d,t&&2!==i),W=!1,d.data.loadLastCommentId&&(r=d.data.loadLastCommentId),we(d),t&&Q(!1)),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))})).fail((function(t,i,d){console.log(d),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))}))}function K(t,a){var o,n=document.getElementById("wpdiscuzHasMoreComments");if(0==t.data.is\_show\_load\_more)n&&(n.dataset.is\_show\_load\_more=0),e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide();else if(o=t.data.last\_parent\_id,e(".wpd-load-more-submit").attr("data-lastparentid",o),2!==i&&e(".wpdiscuz-comment-pagination").show(),n&&(n.dataset.is\_show\_load\_more=1),a&&e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").show(),t.data.comments\_left>0){if(!e(".wpd-load-more-submit .wpd-comments-left").length){const t=e("<span>");t.addClass("wpd-comments-left"),e(".wpd-load-more-submit").append(t)}e(".wpd-load-more-submit .wpd-comments-left").text(t.data.comments\_left\_text)}we(t)}function Q(t){var a=location.href.match(/#comment\-(\d+)/);if(null!==a){var o=a[1];if(e("#comment-"+o).length)setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+o).parents("[id^=wpd-comm-]").offset().top-I},1e3,ae),t&&N(o)}),500);else{var n=new FormData;n.append("action","wpdGetSingleComment"),n.append("commentId",o),ue(v,!0,n).done((function(a){if("object"==typeof a&&a.success){var n="#comment-"+o;e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e(n).offset().top-I},1e3,ae),t&&N(o)}e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}}}function N(t){setTimeout((function(){e("#comment-"+t).siblings(".wpd-secondary-form-wrapper").is(":visible")||e("#comment-"+t).find(".wpd-reply-button").trigger("click")}),1100)}function G(e){if(void 0!==e.data.message)for(var t,a=e.data.message,o=0;o<a.length;o++)J((t=a[o]).comment\_parent,t.comment\_html)}function $(e,t){var a="";return(a=t?e.parents(".wpd-main-form-wrapper").attr("id"):e.parents(".wpd-comment").attr("id")).substring(a.lastIndexOf("-")+1)}function X(e){return e.substring(0,e.indexOf("\_"))}function Y(e,t){return t?e.substring(e.indexOf("-")+1):e.substring(0,e.indexOf("-"))}function J(t,a){if(0==t)oe(a);else{var o=$(e("#comment-"+t),0);e("#wpdiscuz\_form\_anchor-"+o).after(a)}}function Z(){var t=[];return e(".wpd-comment-right").each((function(){t.push(X($(e(this),0)))})),t.join(",")}function ee(t,a){var o=t.find(".wpd-required-group");wpdiscuzLoadRichEditor&&t.find(".wc\_comment").val(e(a+">.ql-editor").html()),function(e){if("wpdiscuz-subscribe-form"==e.attr("id"))return;var t=e.find(".wc\_comment"),a=t.val().trim().replace(/<p><br><\/p>/g,"\n").replace(/<p>(.\*?)<\/p>/g,"$1\n");a=(a=(a=(a=a.replace(/<img src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img[^>]+alt=["|']([^"|']+)["|'][^>]+src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'][^>]?>/g," $1 ")).replace(/<img\s+([^>]\*)class=["|']wpdem\-sticker["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img\s+([^>]\*)src=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $2 "),t.val(a)}(t),e.each(o,(function(){e("input",this).prop("required",!1),0===e("input:checked",this).length?e("input",e(this)).prop("required",!0):e(".wpd-field-invalid",this).remove()}))}function te(){e("html, body").css("scroll-behavior","unset")}function ae(){e("html").css("scroll-behavior",L),e("body").css("scroll-behavior",R)}function oe(t){e(".wpd-sticky-comment").last()[0]?e(t).insertAfter(e(".wpd-sticky-comment").last()[0]):e(".wpd-thread-list").prepend(t)}function ne(t){t?t.prop("required")||(t.val()?t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none")):e.each(e(".wc\_email"),(function(t,a){var o=e(a);o.prop("required")||(o.val()?o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none"))}))}if(2!==i||u||(e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide(),B(),e(window).scroll((function(){B()}))),wpdiscuzAjaxObj.setLoadMoreVisibility=K,e("body").on("click",".wpd-vote-up.wpd\_not\_clicked, .wpd-vote-down.wpd\_not\_clicked",(function(){var t=e(this);e(t).removeClass("wpd\_not\_clicked");var a,o=X($(t));a=e(this).hasClass("wpd-vote-up")?1:-1;var n=new FormData;n.append("action","wpdVoteOnComment"),n.append("commentId",o),n.append("voteType",a),ue(v,!0,n).done((function(n){if(e(t).addClass("wpd\_not\_clicked"),"object"==typeof n){if(n.success){if("total"===n.data.buttonsStyle){var i=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result"),d=n.data.votes;i.text(n.data.votesHumanReadable),i.attr("title",d),i.removeClass("wpd-up wpd-down"),d>0&&i.addClass("wpd-up"),d<0&&i.addClass("wpd-down")}else{var s=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-like"),c=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-dislike");s.text(n.data.likeCountHumanReadable),s.attr("title",n.data.likeCount),c.text(n.data.dislikeCountHumanReadable),c.attr("title",n.data.dislikeCount),parseInt(n.data.likeCount)>0?s.addClass("wpd-up"):s.removeClass("wpd-up"),parseInt(n.data.dislikeCount)<0?c.addClass("wpd-down"):c.removeClass("wpd-down")}var p=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-up"),r=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-down");p.removeClass("wpd-up"),r.removeClass("wpd-down"),n.data.curUserReaction>0?p.addClass("wpd-up"):n.data.curUserReaction<0&&r.addClass("wpd-down")}else n.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error");we(n,o,a)}else console.log(n);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(t).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e(document).on("click","body",(function(t){var a=e(".wpdiscuz-sort-buttons");e(t.target).hasClass("wpdf-sorting")||e(t.target).parent().hasClass("wpdf-sorting")?a.css({display:a.is(":visible")?"none":"flex"}):a.hide()})),e("body").on("click",".wpdiscuz-sort-button:not(.wpdiscuz-sort-button-active)",(function(){var t=e(this),a=e(this).attr("data-sorting");if(a){e(".wpd-load-comments").parents(".wpd-load-more-submit-wrap").remove(),e(".wpdiscuz-sort-button.wpdiscuz-sort-button-active").removeClass("wpdiscuz-sort-button-active").appendTo(".wpdiscuz-sort-buttons"),t.addClass("wpdiscuz-sort-button-active").prependTo(".wpdf-sorting");var o=new FormData;o.append("action","wpdSorting"),o.append("sorting",a);var n=e(".wpdf-active").attr("data-filter-type");o.append("wpdType",n||""),ue(v,!0,o).done((function(t){"object"==typeof t&&t.success&&(e("#wpdcom .wpd-comment").remove(),e("#wpdcom .wpd-thread-list").prepend(t.data.message),K(t,!1),M=1),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),window.onhashchange=function(){Q(!1)},1!=m&&Q(!1),e("body").on("click",".wpdiscuz-readmore",(function(){var t=$(e(this)),a=X(t),o=new FormData;o.append("action","wpdReadMore"),o.append("commentId",a),ue(v,!0,o).done((function(o){"object"==typeof o?(o.success?(e("#comment-"+a+" .wpd-comment-text").replaceWith(" "+o.data.message),e("#wpdiscuz-readmore-"+t).remove()):console.log(o.data),we(o)):console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("change",".wpd-required-group",(function(){0!==e("input:checked",this).length?e("input",e(this)).prop("required",!1):e("input",e(this)).prop("required",!0)})),e("body").on("click",".wpdiscuz-spoiler",(function(){e(this).next().slideToggle(),e(this).hasClass("wpdiscuz-spoiler-closed")?e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"):e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),e(this).toggleClass("wpdiscuz-spoiler-closed")})),e("body").on("click",".wpd-tools",(function(){var t=e(".wpd-tools-actions",e(this));t.is(":visible")||e(this).parents(".wpd-comment-right").attr("id")!==e("[id^=comment-]","#wpdcom").last().attr("id")||e("#comments").css({paddingBottom:"160px"}),t.css({display:t.is(":visible")?"none":"flex"})})),e("body").on("mouseleave",".wpd-comment-right",(function(){e(this).find(".wpd-tools-actions").hide(),e("#comments").css({paddingBottom:"0"})})),e("body").on("click",".wpd\_stick\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdStickComment"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd\_close\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdCloseThread"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-filter.wpd\_not\_clicked[data-filter-type]",(function(){var t=e(this),a=t.attr("data-filter-type");wpdiscuzAjaxObj.resetActiveFilters(".wpdf-"+a),t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var o=new FormData;o.append("action","wpdLoadMoreComments");var n=e(".wpdiscuz-sort-button-active").attr("data-sorting");n&&o.append("sorting",n),o.append("lastParentId",0),o.append("offset",0),M=1,o.append("wpdType",t.hasClass("wpdf-active")?"":a),o.append("isFirstLoad",1),e(this).hasClass("wpdf-inline")?e(this).hasClass("wpdf-active")?e(".wpd-comment-info-bar").hide():e(".wpd-comment-info-bar").css("display","flex"):e(".wpd-comment-info-bar").hide(),ue(v,!1,o).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(t.toggleClass("wpdf-active"),e(".wpd-load-comments").remove(),e(".wpd-comment").remove(),e(".wpd-thread-list").prepend(a.data.comment\_list),K(a),r=a.data.loadLastCommentId,e(".wpd-load-more-submit").blur(),we(a)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpdf-reacted.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdMostReactedComment"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e("#comment-"+a.data.commentId).length||e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpdf-hottest.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdHottestThread"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.commentId).length?e("#comment-"+a.data.commentId).parents("[id^=wpd-comm-"+a.data.commentId+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpd-filter-view-all",(function(){e(".wpdf-inline.wpdf-active.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-follow-link.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=X($(t,0)),o=new FormData;o.append("action","wpdFollowUser"),o.append("commentId",a),ue(v,!0,o).done((function(a){t.addClass("wpd\_not\_clicked"),"object"==typeof a?a.success?(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data.code],a.data.code,t),"success"),t.removeClass("wpd-follow-active"),a.data.followTip&&t.attr("wpd-tooltip",a.data.followTip),a.data.followClass&&t.addClass(a.data.followClass),we(a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),ne(),e("body").on("keyup",".wc\_email",(function(){ne(e(this))})),j&&e("#wpdcom").length){if(e("#wpd-bubble-wrapper").hover((function(){e(this).addClass("wpd-bubble-hover")}),(function(){e(this).removeClass("wpd-bubble-hover")})),C&&!Cookies.get(wpdiscuzAjaxObj.cookieHideBubbleHint)&&setTimeout((function(){e("#wpd-bubble-wrapper").addClass("wpd-bubble-hover");const t=wpdiscuzAjaxObj.bubbleHintShowOnce?"/":location.href;wpdiscuzAjaxObj.bubbleHintCookieExpires&&parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10);Cookies.set(wpdiscuzAjaxObj.cookieHideBubbleHint,"1",{expires:parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10),path:t}),setTimeout((function(){e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")}),1e3\*y)}),1e3\*C),"content\_left"===O)if(e(".entry-content").length){var ie=(de=Math.min(e(".entry-content").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".post-entry").length){ie=(de=Math.min(e(".post-entry").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".container").length){var de;ie=(de=Math.min(e(".container").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner");else"left\_corner"===O?(e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner")):"right\_corner"===O&&(e("#wpd-bubble-wrapper").css({right:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-right-corner"));e("#wpd-bubble-wrapper").show(),e("body").on("click","#wpd-bubble-add-message-close",(function(t){t.preventDefault(),t.stopPropagation(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")})),e("body").on("click","#wpd-bubble",(function(){te(),e("#tab-title-reviews").length&&e("#tab-title-reviews a").trigger("click"),e("html, body").animate({scrollTop:e("#wpdcom").offset().top-(I+28)},1e3,(function(){ae(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover"),wpdiscuzLoadRichEditor?e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0").focus():e("#wc-textarea-0\_0").length&&e("#wc-textarea-0\_0").trigger("focus")}))})),e("body").on("click","#wpd-bubble-comment-close",(function(t){t.preventDefault(),e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")})),e("body").on("click","#wpd-bubble-comment-reply-link a",(function(){var t=e(this).attr("href");setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),Q~~(!0);var a=t.match(/#comment\-(\d+)/);E=E.filter((function(e){return e!=a[1]})),e("#wpd-bubble-count .wpd-new-comments-count").text(E.length),0==E.length&&e("#wpd-bubble-count").removeClass("wpd-new-comments")}),100)})),e("body").on("click","#wpd-bubble-count",(function(){if(E.length){var t=new FormData;t.append("action","wpdBubbleUpdate"),t.append("newCommentIds",E.join()),ue(v,!0,t).done((function(t){"object"==typeof t&&t.success&&(t.data.message=t.data.message.filter((function(t){if(!e("#comment-"+t.comment\_id).length)return t})),G(t),e("#wpd-bubble-count").removeClass("wpd-new-comments"),e("#wpd-bubble-count .wpd-new-comments-count").text("0"),E=[],e(".wpd-new-loaded-comment").length&&(te(),e("html, body").animate({scrollTop:e(e(".wpd-new-loaded-comment")[0]).offset().top-(I+28)},1e3,ae)),we(t)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(e,t,a){console.log(a)}))}}))}if((j&&x||s)&&(t||!t&&p)&&setTimeout((function t(){e.ajax({type:"GET",url:wpdiscuzAjaxObj.bubbleUpdateUrl,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpdiscuzAjaxObj.restNonce)},data:{postId:d,lastId:l,visibleCommentIds:Z()}}).done((function(a){if(!F)if("object"==typeof a){if(a.commentIDsToRemove.forEach((function(t){e("[id^=wpd-comm-"+t+"]").remove()})),a.ids.length){s&&function(){var t=new FormData;t.append("action","wpdUpdateAutomatically"),t.append("loadLastCommentId",r),t.append("visibleCommentIds",Z()),ue(v,!1,t).done((function(t){F||"object"==typeof t&&t.success&&(G(t),t.data.wc\_all\_comments\_count\_new=parseInt(t.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(t.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",t.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(t.data.wc\_all\_comments\_count\_bubble\_html),r=t.data.loadLastCommentId)})).fail((function(e,t,a){console.log(a)}))}(),a.ids=a.ids.filter((function(t){if(!e("#comment-"+t).length)return t}));var o=5e3;l=parseInt(a.ids[a.ids.length-1]),E=E.concat(a.ids),k&&a.commentText&&(e("#wpd-bubble-author-avatar").html(a.avatar),e("#wpd-bubble-author-name").html(a.authorName),e("#wpd-bubble-comment-date span").html(a.commentDate),e("#wpd-bubble-comment-text").html(a.commentText),e("#wpd-bubble-comment-reply-link a").attr("href",a.commentLink),e("#wpd-bubble-notification-message").show(),o=1e4);var n=parseInt(e(".wpd-new-comments-count").text());n+=a.ids.length,e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),e("#wpd-bubble-wrapper").addClass("wpd-new-comment-added"),setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")}),o),e(".wpd-new-comments-count").text(n),e("#wpd-bubble-count").addClass("wpd-new-comments")}a.all\_comments\_count=parseInt(a.all\_comments\_count),e("#wpd-bubble-all-comments-count").replaceWith(a.all\_comments\_count\_bubble\_html),e(".wpd-reviews-tab").length||(e(".wpd-thread-info").html(a.all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.all\_comments\_count))}else console.log(a);setTimeout(t,c)})).fail((function(e,a,o){console.log(o),setTimeout(t,c)}))}),c),e(".wpd-inline-form-wrapper").length){var se=new FormData;se.append("action","wpdGetInlineCommentForm"),ue(v,!1,se).done((function(t){"object"==typeof t?t.success?(e(".wpd-inline-form-wrapper").append(t.data),e.each(e("[name=\_wpd\_inline\_nonce]"),(function(){var t=e(this).attr("id"),a=e(this).parents(".wpd-inline-shortcode").attr("id");e(this).attr("id",t+"-"+a.substring(a.lastIndexOf("-")+1))})),e(".wpd-inline-opened").addClass("wpd-active"),e(".wpd-inline-opened").find(".wpd-inline-form-wrapper").show(),e(".wpd-inline-opened").find(".wpd-inline-icon").addClass("wpd-open"),e(".wpd-inline-opened").find(".wpd-inline-icon").removeClass("wpd-ignored"),le()):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data]),t.data,"error"):console.log(t)})).fail((function(e,t,a){console.log(a)}))}function ce(t){if(e(t).hasClass("wpd-inline-shortcode"))var a=e(t).attr("id");else a=e(t).parents(".wpd-inline-shortcode").attr("id");return a.substring(a.lastIndexOf("-")+1)}function pe(){e(".wpd-inline-form-wrapper").hide(),e(".wpd-inline-shortcode").removeClass("wpd-active"),e(".wpd-inline-icon").removeClass("wpd-open")}function re(){e.each(e(".wpd-inline-shortcode:not(.wpd-inline-opened) .wpd-inline-icon"),(function(){var t=e(this),a=t.offset().top-window.pageYOffset;t.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&a>0&&a<300&&("blink"===A?(t.addClass("wpd-blink"),setTimeout((function(){t.removeClass("wpd-blink")}),3e3)):(t.parents(".wpd-inline-shortcode").addClass("wpd-active"),t.siblings(".wpd-inline-form-wrapper").show(),t.addClass("wpd-open"),le(t.siblings(".wpd-inline-form-wrapper"))))}))}function le(t){if(t){if(t.offset().left<=10)t.css("left",Math.ceil(parseInt(t.css("left"))-t.offset().left+10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))<3&&(a=3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;");else if(t.offset().left+t.width()>document.body.clientWidth-10){var a;t.css("left",Math.ceil(parseInt(t.css("left"))+(document.body.clientWidth-(t.offset().left+t.width()))-10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))>t.width()-3&&(a=t.width()-3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;")}}else e.each(e(".wpd-inline-form-wrapper:visible"),(function(){if(e(this).offset().left<=10)e(this).css("left",Math.ceil(parseInt(e(this).css("left"))-e(this).offset().left+10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))<3&&(t=3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;");else if(e(this).offset().left+e(this).width()>document.body.clientWidth-10){var t;e(this).css("left",Math.ceil(parseInt(e(this).css("left"))+(document.body.clientWidth-(e(this).offset().left+e(this).width()))-10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))>e(this).width()-3&&(t=e(this).width()-3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;")}}))}function me(t){var a,o=0;if(t.parents(".wpd\_main\_comm\_form").length)o=parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents(".wpd\_main\_comm\_form");else if(t.parents(".wpd-secondary-form-wrapper").length)o=parseInt(wpdiscuzAjaxObj.replyTextMaxLength),a=t.parents(".wpd-secondary-form-wrapper");else if(t.parents("#wpdiscuz-edit-form").length){var n=$(t);o=parseInt(n.substring(n.lastIndexOf("\_")+1))?parseInt(wpdiscuzAjaxObj.replyTextMaxLength):parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents("#wpdiscuz-edit-form")}if(o&&a){var i=t.val().length,d=e(".wpd-editor-char-counter",a),s=o-i;d.html(s),s<=10?d.addClass("error"):d.removeClass("error")}}function we(t,a,o,n){t.data.callbackFunctions&&e.each(t.data.callbackFunctions,(function(e){"function"==typeof wpdiscuzAjaxObj[t.data.callbackFunctions[e]]?wpdiscuzAjaxObj[t.data.callbackFunctions[e]](t,a,o,n):"function"==typeof window[t.data.callbackFunctions[e]]?window[t.data.callbackFunctions[e]](t,a,o,n):console.log(t.data.callbackFunctions[e]+" is not a function")}))}function ue(t,a,o){a&&e("#wpdiscuz-loading-bar").show(),o.append("postId",d);var n=o.get("action");wpdiscuzAjaxObj.dataFilterCallbacks&&wpdiscuzAjaxObj.dataFilterCallbacks[n]&&e.each(wpdiscuzAjaxObj.dataFilterCallbacks[n],(function(e){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]]&&(o=wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]](o,t,a))}));var i=t?wpdiscuzAjaxObj.url:wpdiscuzAjaxObj.customAjaxUrl;return console.log(i),e.ajax({type:"POST",url:i,data:o,contentType:!1,processData:!1})}e(document).on("click","body",(function(t){if(e(t.target).hasClass("wpd-inline-form-close")||e(t.target).parents(".wpd-inline-form-close").length)t.preventDefault(),e(t.target).parents(".wpd-inline-form-wrapper").hide(),e(t.target).parents(".wpd-inline-shortcode").removeClass("wpd-active"),e(t.target).parents(".wpd-inline-form-wrapper").siblings(".wpd-inline-icon").removeClass("wpd-open");else if(!e(t.target).hasClass("wpd-inline-form-wrapper")&&!e(t.target).parents(".wpd-inline-form-wrapper").length){pe();var a="";e(t.target).hasClass("wpd-inline-icon")?a=e(t.target):e(t.target).parents(".wpd-inline-icon").length&&(a=e(t.target).parents(".wpd-inline-icon")),a.length&&a.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&(a.parents(".wpd-inline-shortcode").addClass("wpd-active"),a.siblings(".wpd-inline-form-wrapper").show(),a.addClass("wpd-open"),a.removeClass("wpd-ignored"),le(a.siblings(".wpd-inline-form-wrapper")))}(!e(t.target).hasClass("wpd-last-inline-comments-wrapper")&&!e(t.target).parents(".wpd-last-inline-comments-wrapper").length||e(t.target).parents(".wpd-last-inline-comments-wrapper").length&&e(t.target).hasClass("wpd-load-inline-comment"))&&e(".wpd-last-inline-comments-wrapper").remove()})),e("body").on("click",".wpd-inline-submit.wpd\_not\_clicked",(function(t){t.preventDefault();var a=e(this),o=e(this).parents(".wpd\_inline\_comm\_form");if(o[0].checkValidity()){e(this).removeClass("wpd\_not\_clicked");var n=new FormData;n.append("action","wpdAddInlineComment"),n.append("inline\_form\_id",ce(o)),e.each(e("input, textarea",o),(function(t,a){"checkbox"===this.type?e(this).is(":checked")&&n.append(e(a).attr("name"),e(a).val()):n.append(e(a).attr("name"),e(a).val())})),ue(v,!0,n).done((function(t){if(a.addClass("wpd\_not\_clicked"),"object"==typeof t)if(t.success){o[0].reset(),pe();var n=parseInt(t.data.newCount),i=a.parents(".wpd-inline-icon-wrapper").find(".wpd-inline-icon-count");i.text(n),n?i.addClass("wpd-has-comments"):i.removeClass("wpd-has-comments"),t.data.allCommentsCountNew=parseInt(t.data.allCommentsCountNew),e(".wpd-thread-info").html(t.data.allCommentsCountBeforeThreadsHtml),e(".wpd-thread-info").attr("data-comments-count",t.data.allCommentsCountNew),e("#wpd-bubble-all-comments-count").replaceWith(t.data.allCommentsCountBubbleHtml),t.data.message&&oe(t.data.message),wpdiscuzAjaxObj.setCommentMessage(t.data.notification,"success")}else t.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data,a),"error");else wpdiscuzAjaxObj.setCommentMessage(t,"error");e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("keydown",".wpd-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_comm\_submit").trigger("click")})),e("body").on("keydown","#wpdiscuz-edit-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_save\_edited\_comment").trigger("click")})),e("body").on("keydown",".wpd-inline-comment-content",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).parents(".wpd\_inline\_comm\_form").find(".wpd-inline-submit.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-inline-icon-count.wpd-has-comments",(function(){var t=e(this),a=new FormData;a.append("action","wpdGetLastInlineComments"),a.append("inline\_form\_id",ce(t)),ue(v,!0,a).done((function(a){"object"==typeof a?a.success?e(a.data).insertAfter(t):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-view-all-inline-comments",(function(t){t.preventDefault(),e(this).parents(".wpd-last-inline-comments-wrapper").remove(),e(".wpdf-inline").hasClass("wpdf-active")||e(".wpdf-inline").trigger("click"),te(),e("html, body").animate({scrollTop:e(".wpdf-inline").offset().top-I},1e3,ae)})),e("body").on("click",".wpd-feedback-content-link",(function(t){t.preventDefault();var a=e(this).data("feedback-content-id");te(),e("html, body").animate({scrollTop:e("#wpd-inline-"+a).offset().top-(I+6)},1e3,(function(){ae(),e("#wpd-inline-"+a).addClass("wpd-active")}))})),"scroll\_open"!==A&&"blink"!==A||(re(),e(window).on("scroll",re)),e("body").on("click","#wpd-post-rating.wpd-not-rated .wpd-rate-starts svg",(function(){var t=new FormData,a=e(this).index();a>=0&&a<5&&(t.append("action","wpdUserRate"),t.append("rating",a+1),ue(v,!0,t).done((function(t){"object"==typeof t?(t.success?location.reload(!0):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data),"error"),we(t)):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})))})),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){t.preventDefault();var a=e(this);const o=e("#wpdiscuz\_subscription\_button",a);if(a[0].checkValidity()&&(d=a,s=!0,"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&!e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).val().length?(s=!1,e(".wpdiscuz-recaptcha",d).css("border","1px solid red")):"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&e(".wpdiscuz-recaptcha",d).css("border","none"),s)&&o.hasClass("wpd\_not\_clicked")){o.removeClass("wpd\_not\_clicked");var i=new FormData;i.append("action","wpdAddSubscription"),e("\*",a).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&i.append(this.name+"",e(this).val()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):wpdiscuzAjaxObj.setCommentMessage(t,"error"),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1,o.addClass("wpd\_not\_clicked")})).fail((function(t,a,n){console.log(n),o.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}var d,s})),e("body").on("click",".wpd-unsubscribe",(function(t){t.preventDefault();var a=new FormData;a.append("action","wpdUnsubscribe"),a.append("sid",e(this).data("sid")),a.append("skey",e(this).data("skey")),ue(v,!0,a).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),wpdiscuzAjaxObj.resetActiveFilters=function(t){e(".wpd-filter.wpdf-active"+(t?":not("+t+")":"")).removeClass("wpdf-active")},wpdiscuzAjaxObj.getAjaxObj=ue}));var onloadCallback=function(){if(document.getElementById("wpdiscuz-recaptcha-0\_0")&&"2.0"===wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.render("wpdiscuz-recaptcha-0\_0",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(e){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("key")},"expired-callback":function(){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}; |
  |  | 1 | var wpdiscuzLoadRichEditor=parseInt(wpdiscuzAjaxObj.loadRichEditor);if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap"))var wpDiscuzEditor=new WpdEditor;function wpdMessagesOnInit(e,t){wpdiscuzAjaxObj.setCommentMessage(e,t),setTimeout((function(){location.href=location.href.substring(0,location.href.indexOf("wpdiscuzUrlAnchor")-1)}),3e3)}wpdiscuzAjaxObj.setCommentMessage=function(e,t,a){var o="wpdiscuz-message-error";if(e instanceof Array)for(var n in e)t instanceof Array?"success"===t[n]?o="wpdiscuz-message-success":"warning"===t[n]&&(o="wpdiscuz-message-warning"):"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e[n]).prependTo("#wpdiscuz-comment-message").delay(a instanceof Array?a[n]:a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}));else"success"===t?o="wpdiscuz-message-success":"warning"===t&&(o="wpdiscuz-message-warning"),jQuery("<div/>").addClass(o).html(e).prependTo("#wpdiscuz-comment-message").delay(a||4e3).fadeOut(1e3,(function(){jQuery(this).remove()}))},wpdiscuzAjaxObj.applyFilterOnPhrase=function(e,t,a){return wpdiscuzAjaxObj.phraseFilters&&jQuery.each(wpdiscuzAjaxObj.phraseFilters,(function(o){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]]&&(e=wpdiscuzAjaxObj[wpdiscuzAjaxObj.phraseFilters[o]](e,t,a))})),e},jQuery(document).ready((function(e){e("body").addClass("wpdiscuz\_"+wpdiscuzAjaxObj.version);var t=wpdiscuzAjaxObj.is\_user\_logged\_in,a=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!t,o=1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&t,n=wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion,i=parseInt(wpdiscuzAjaxObj.commentListLoadType),d=parseInt(wpdiscuzAjaxObj.wc\_post\_id),s=parseInt(wpdiscuzAjaxObj.commentListUpdateType),c=1e3\*parseInt(wpdiscuzAjaxObj.commentListUpdateTimer),p=parseInt(wpdiscuzAjaxObj.liveUpdateGuests),r=wpdiscuzAjaxObj.loadLastCommentId,l=r,m=parseInt(wpdiscuzAjaxObj.firstLoadWithAjax);Cookies.get("wpdiscuz\_comments\_sorting")&&Cookies.remove("wpdiscuz\_comments\_sorting",{path:""}),Cookies.get("wordpress\_last\_visit")&&Cookies.remove("wordpress\_last\_visit",{path:""}),Cookies.get("wpdiscuz\_last\_visit")&&Cookies.remove("wpdiscuz\_last\_visit",{path:""});var w,u=parseInt(wpdiscuzAjaxObj.wordpressIsPaginate),f=wpdiscuzAjaxObj.storeCommenterData,h=(parseInt(wpdiscuzAjaxObj.wmuEnabled),wpdiscuzAjaxObj.isCookiesEnabled),b=!0,\_=wpdiscuzAjaxObj.cookiehash,g=parseInt(wpdiscuzAjaxObj.isLoadOnlyParentComments),z=parseInt(wpdiscuzAjaxObj.enableDropAnimation)?500:0,v=parseInt(wpdiscuzAjaxObj.isNativeAjaxEnabled),j=parseInt(wpdiscuzAjaxObj.enableBubble),x=parseInt(wpdiscuzAjaxObj.bubbleLiveUpdate),C=parseInt(wpdiscuzAjaxObj.bubbleHintTimeout),y=parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout)?parseInt(wpdiscuzAjaxObj.bubbleHintHideTimeout):5,k=parseInt(wpdiscuzAjaxObj.bubbleShowNewCommentMessage),O=wpdiscuzAjaxObj.bubbleLocation,A=wpdiscuzAjaxObj.inlineFeedbackAttractionType,I=(I=parseInt(wpdiscuzAjaxObj.scrollSize))||32,T=[],D=[],E=[],F=!1,M=1,L=e("html").css("scroll-behavior"),R=e("body").css("scroll-behavior");(e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").length?e(".wc\_social\_plugin\_wrapper .wp-social-login-provider-list").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").length?e(".wc\_social\_plugin\_wrapper .the\_champ\_login\_container").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .social\_connect\_form").length?e(".wc\_social\_plugin\_wrapper .social\_connect\_form").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"):e(".wc\_social\_plugin\_wrapper .oneall\_social\_login\_providers").length&&e(".wc\_social\_plugin\_wrapper .oneall\_social\_login .oneall\_social\_login\_providers").clone().prependTo("#wpdiscuz\_hidden\_secondary\_form > .wpd-form-wrapper >  .wpd-secondary-forms-social-content"),wpdiscuzLoadRichEditor&&e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0"),window.addEventListener("beforeunload",(function(t){var a=e(".wpd-form").not(":hidden");if(a.length)if(wpdiscuzLoadRichEditor&&document.querySelector(".wpdiscuz-textarea-wrap")){for(var o=0;o<a.length;o++)if("\n"!==wpDiscuzEditor.createEditor(e(a[o]).find(".ql-container").attr("id")).getText())return t.preventDefault(),void(t.returnValue="")}else for(o=0;o<a.length;o++)if(e(a[o]).find(".wc\_comment").val())return t.preventDefault(),void(t.returnValue="")})),wpdiscuzLoadRichEditor||(e(document).delegate("textarea.wc\_comment","input",(function(){me(e(this))})),e.each(e("textarea.wc\_comment"),(function(){me(e(this))}))),e("body").on("focus","#wpdcom .ql-editor, #wpdcom .wc\_comment",(function(){e(".wpd-form-foot",e(this).parents(".wpd\_comm\_form")).slideDown(z)})),e("body").on("focus","#wpdcom textarea",(function(){e(this).next(".autogrow-textarea-mirror").length||e(this).autoGrow()})),t)||q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)});if(e(".wpd-vote-down.wpd-dislike-hidden").remove(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd"),e("body").on("click","#wpd-editor-source-code-wrapper-bg",(function(){e(this).hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),wpdiscuzLoadRichEditor&&e("body").on("click","#wpd-insert-source-code",(function(){var t=wpDiscuzEditor.createEditor("#"+e("#wpd-editor-uid").val());t.deleteText(0,t.getLength(),Quill.sources.USER);var a=e("#wpd-editor-source-code").val();a.length&&t.clipboard.dangerouslyPasteHTML(0,a,Quill.sources.USER),t.update(),e("#wpd-editor-source-code-wrapper-bg").hide(),e("#wpd-editor-source-code-wrapper").hide(),e("#wpd-editor-uid").val(""),e("#wpd-editor-source-code").val("")})),e("body").on("click",".wpd-reply-button",(function(){var i=$(e(this),0);e(this).hasClass("wpdiscuz-clonned")?(wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+i).focus()}),z):setTimeout((function(){e("#wc-textarea-"+i).trigger("focus")}),z),e("#wpd-secondary-form-wrapper-"+i).slideToggle(z)):function(a){var o=$(a,0);e("#wpdiscuz\_form\_anchor-"+o).before(function(t){return e("#wpdiscuz\_hidden\_secondary\_form").html().replace(/wpdiscuzuniqueid/g,t)}(o));var n=e("#wpd-secondary-form-wrapper-"+o);if(!t){q({comment\_author:Cookies.get("comment\_author\_"+\_),comment\_author\_email:Cookies.get("comment\_author\_email\_"+\_),comment\_author\_url:Cookies.get("comment\_author\_url\_"+\_)})}wpdiscuzLoadRichEditor?setTimeout((function(){wpDiscuzEditor.createEditor("#wpd-editor-"+o).focus()}),z):setTimeout((function(){e("#wc-textarea-"+o).trigger("focus")}),z);n.slideToggle(z,(function(){a.addClass("wpdiscuz-clonned")}))}(e(this)),function(t){if((a||o)&&"2.0"===n){var i=X(t);setTimeout((function(){if(!D[i])try{D[i]=grecaptcha.render("wpdiscuz-recaptcha-"+t,{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(a){e("#wpdiscuz-recaptcha-field-"+t).val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-"+t).val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3)}}(i)})),e("body").on("click","#wpdcom [data-wpd-clipboard]",(function(){var t=e(this).data("wpd-clipboard");e(this).data("wpd-ismention")&&(t="@"+t);var a=e("<input/>");a.appendTo("body").css({position:"absolute",top:"-10000000px"}).val(t),a.trigger("select"),document.execCommand("copy"),a.remove(),wpdiscuzAjaxObj.setCommentMessage(t+"<br/>"+wpdiscuzAjaxObj.wc\_copied\_to\_clipboard,"success",5e3)})),e("body").on("click",".wpdiscuz-nofollow,.wc\_captcha\_refresh\_img,.wpd-load-more-submit",(function(e){e.preventDefault()})),e("body").on("click",".wpd-toggle.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked");var a=$(e(this),0),o=e(this),n=e(".fas",o);!o.parents(".wpd-comment:not(.wpd-reply)").children(".wpd-reply").length&&g?function(t,a){var o=X(t),n=new FormData;n.append("action","wpdShowReplies"),n.append("commentId",o),ue(v,!0,n).done((function(o){a.addClass("wpd\_not\_clicked"),"object"==typeof o&&o.success&&(e("#wpd-comm-"+t).replaceWith(o.data.comment\_list),e("#wpd-comm-"+t+" .wpd-toggle .fas").removeClass("fa-chevron-down").addClass("fa-chevron-up"),e("#wpd-comm-"+t+" .wpd-toggle .wpd-view-replies .wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),e("#wpd-comm-"+t+" .wpd-toggle").attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text),we(o)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,o,n){console.log(n),a.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}(a,t):e("#wpd-comm-"+a+"> .wpd-reply").slideToggle(700,(function(){e(this).is(":hidden")?(n.removeClass("fa-chevron-up"),n.addClass("fa-chevron-down"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_show\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_show\_replies\_text)):(n.removeClass("fa-chevron-down"),n.addClass("fa-chevron-up"),o.find(".wpd-view-replies-text").text(wpdiscuzAjaxObj.wc\_hide\_replies\_text),o.attr("wpd-tooltip",wpdiscuzAjaxObj.wc\_hide\_replies\_text)),t.addClass("wpd\_not\_clicked")}))})),e("body").on("mouseenter",".wpd-new-loaded-comment",(function(){e(this).removeClass("wpd-new-loaded-comment")})),e("body").on("click",".wpd-sbs-toggle",(function(){e(".wpdiscuz-subscribe-bar").slideToggle(z)})),parseInt(wpdiscuzAjaxObj.wpDiscuzIsShowOnSubscribeForm)&&!t&&wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&e("#wpdiscuz-subscribe-form").length&&("2.0"===n?(setTimeout((function(){try{grecaptcha.render("wpdiscuz-recaptcha-subscribe-form",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val("key")},"expired-callback":function(){e("#wpdiscuz-recaptcha-field-subscribe-form").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}),1e3),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){e("#wpdiscuz-recaptcha-field-subscribe-form").val()?e(".wpdiscuz-recaptcha",e(this)).css("border","none"):(e(".wpdiscuz-recaptcha",e(this)).css("border","1px solid red"),ee(e(this),""),t.preventDefault())}))):"3.0"===n&&e("body").on("click","#wpdiscuz\_subscription\_button",(function(t){var a=e(this).parents("#wpdiscuz-subscribe-form");ee(a,""),t.preventDefault();try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/wpdAddSubscription"}).then((function(e){document.getElementById("wpdiscuz-recaptcha-field-subscribe-form").value=e,a.trigger("submit")}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error")}}))),(a||o)&&"2.0"===n){var S=e(window).width(),H=e("#wpdcom").width();H>=1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"65%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"35%"})),H>=940&&H<1100&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"60%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"40%"})),H>=810&&H<940&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"60%"})),H>=730&&H<810&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.9)","-webkit-transform":"scale(0.9)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"45%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"55%"})),H>=610&&H<730&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.85)","-webkit-transform":"scale(0.85)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({transform:"scale(0.8)","-webkit-transform":"scale(0.8)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"43%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"55%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"})),S>650&&(H>=510&&H<610&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"35%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"63%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({width:"30%",position:"relative",right:"-60px"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({width:"70%"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H>=470&&H<510&&(e("#wpdcom .wpd\_main\_comm\_form .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"center 0","-webkit-transform-origin":"center 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({"transform-origin":"right 0","-webkit-transform-origin":"right 0",transform:"scale(0.77)","-webkit-transform":"scale(0.77)"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-left").css({width:"40%"}),e("#wpdcom .wpd\_main\_comm\_form .wpd-form-col-right").css({width:"60%"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd\_main\_comm\_form .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"})),H<470&&(e("#wpdcom .wpd-secondary-form-wrapper .wpd-field-captcha .wpdiscuz-recaptcha").css({margin:"0px auto","transform-origin":"center 0","-webkit-transform-origin":"center 0"}),e("#wpdcom .wpd-form-col-left").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-form-col-right").css({float:"none",width:"100%",display:"block"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-form-footer").css({"margin-left":"0px"}),e("#wpdcom .wpd-secondary-form-wrapper .wc\_notification\_checkboxes").css({"text-align":"center"}),e("#wpdcom .wpd-secondary-form-wrapper .wc-field-submit").css({"text-align":"center"})))}function P(t,a,o){ue(v,!1,a).done((function(a){if(e(o).addClass("wpd\_not\_clicked"),"object"==typeof a)if(a.success){"collapsed"===wpdiscuzAjaxObj.commentFormView&&e(".wpd-form-foot",t).slideUp(z),a.data.wc\_all\_comments\_count\_new=parseInt(a.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(a.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(a.data.wc\_all\_comments\_count\_bubble\_html);var n=z;a.data.is\_main?oe(a.data.message):(n=z+700,e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).slideToggle(700),1==a.data.is\_in\_same\_container?e("#wpd-secondary-form-wrapper-"+a.data.uniqueid).after(a.data.message):e("#wpd-comm-"+a.data.uniqueid).after(a.data.message)),function(e){if(!e.data.held\_moderate){var t=new FormData;t.append("action","wpdCheckNotificationType"),t.append("comment\_id",e.data.new\_comment\_id),t.append("email",e.data.comment\_author\_email),t.append("isParent",e.data.is\_main),ue(v,!0,t)}}(a),function(e){if(e.data.redirect>0&&e.data.new\_comment\_id){var t=new FormData;t.append("action","wpdRedirect"),t.append("commentId",e.data.new\_comment\_id),ue(v,!0,t).done((function(e){"object"==typeof e&&e.success&&setTimeout((function(){location.href=e.data}),2e3)})).fail((function(e,t,a){console.log(a)}))}}(a),h&&b?function(t){var a=t.comment\_author\_email,o=t.comment\_author,n=t.comment\_author\_url;null==f?(Cookies.set("comment\_author\_email\_"+\_,a),Cookies.set("comment\_author\_"+\_,o),n.length&&Cookies.set("comment\_author\_url\_"+\_,n)):(f=parseInt(f),Cookies.set("comment\_author\_email\_"+\_,a,{expires:f,path:"/"}),Cookies.set("comment\_author\_"+\_,o,{expires:f,path:"/"}),n.length&&Cookies.set("comment\_author\_url\_"+\_,n,{expires:f,path:"/"}));e(".wpd-cookies-checkbox").length&&e(".wpd-cookies-checkbox").prop("checked",!0)}(a.data):b||e(".wpd-cookies-checkbox").prop("checked",!1),t.get(0).reset(),wpdiscuzLoadRichEditor?wpDiscuzEditor.createEditor("#wpd-editor-"+e(".wpdiscuz\_unique\_id",t).val()).setContents([{insert:"\n"}]):me(t.find(".wc\_comment")),q(a.data),e(".wmu-preview-wrap",t).remove(),T.length&&(T.forEach((function(e){e.parents(".wpd-field-checkbox").remove()})),T=[]),parseInt(wpdiscuzAjaxObj.scrollToComment)&&setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.new\_comment\_id).offset().top-I},1e3,ae)}),n),we(a,t),e(document.body).trigger("wpdiscuz\_comment\_posted",[a.data.new\_comment\_id,a.data.wc\_all\_comments\_count\_new])}else a.data&&(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"),we(a,t));else wpdiscuzAjaxObj.setCommentMessage(a,"error");e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,n){console.log(n),e(o).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}function q(t){e(".wpd\_comm\_form .wc\_name").val(t.comment\_author),t.comment\_author\_email&&t.comment\_author\_email.indexOf("@example.com")<0&&e(".wpd\_comm\_form .wc\_email").val(t.comment\_author\_email),t.comment\_author\_url&&e(".wpd\_comm\_form .wc\_website").val(t.comment\_author\_url)}function U(t,a){e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").show(),e("#wpd-comm-"+t+" .wpdiscuz-edit-form-wrap").replaceWith(a),e("#wpd-comm-"+t+" > .wpd-comment-wrap .wpd-comment-last-edited").show()}e("body").on("click",".wc\_comm\_submit.wpd\_not\_clicked",(function(){var i=e(this),d=1,s=e(this).parents("form");if("true"!==s.attr("data-uploading")){if(s.hasClass("wpd\_main\_comm\_form")||(d=function(t){var a=t.attr("class").split(" "),o="";return e.each(a,(function(e,t){"wpd\_comment\_level"===Y(t,!1)&&(o=Y(t,!0))})),parseInt(o)+1}(e(this).parents(".wpd-comment"))),ee(s,"#wpd-editor-"+e(".wpdiscuz\_unique\_id",s).val()),s.on("submit",(function(e){e.preventDefault()})),s[0].checkValidity()&&(p=s,r=!0,"2.0"===n&&e("input[name=wc\_captcha]",p).length&&!e("input[name=wc\_captcha]",p).val().length?(r=!1,e(".wpdiscuz-recaptcha",p).css("border","1px solid red")):"2.0"===n&&e("input[name=wc\_captcha]",p).length&&e(".wpdiscuz-recaptcha",p).css("border","none"),r)){F=!0,function(t){e(".wpd-agreement-checkbox",t).each((function(){e(this).hasClass("wpd\_agreement\_hide")&&h&&e(this).prop("checked")&&(Cookies.set(e(this).attr("name")+"\_"+\_,1,{expires:30,path:"/"}),e("input[name="+e(this).attr("name")+"]").each((function(){T.push(e(this))})))}))}(s),e(i).removeClass("wpd\_not\_clicked");var c=new FormData;if(c.append("action","wpdAddComment"),e(":input",s).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&c.append(this.name+"",e(this).val().trim()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&c.append(this.name+"",e(this).val())})),c.append("wpd\_comment\_depth",d),wpdiscuzAjaxObj.wpdiscuz\_zs&&c.append("wpdiscuz\_zs",wpdiscuzAjaxObj.wpdiscuz\_zs),e(".wpd-cookies-checkbox",s).length?e(".wpd-cookies-checkbox",s).prop("checked")||(b=!1):t&&(b=!1),e("#wpdiscuz-loading-bar").show(),wpdiscuzAjaxObj.wpDiscuzReCaptchaSK&&"3.0"===n&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.ready((function(){grecaptcha.execute(wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,{action:"wpdiscuz/addComment"}).then((function(e){c.append("g-recaptcha-response",e),P(s,c,i)}),(function(e){wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error","error"),console.log(e)}))}))}catch(t){console.log(t),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+t.message,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)}else P(s,c,i)}var p,r;!function(e){if((a||o)&&"2.0"===n){var t=X(e);grecaptcha.reset(D[t])}}(e(".wpdiscuz\_unique\_id",s).val()),e(".wpdiscuz\_reset").val("")}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj.wmuPhraseDoingUpload,"wmuPhraseDoingUpload",s),"warning")})),e(document.body).on("wpdiscuz\_comment\_posted",(function(t,a,o){const n=e(".wpd-thread-filter");isNaN(o)||void 0===o||!o?n.find(".wpd-filter").addClass("wpdiscuz-hidden"):n.find(".wpd-filter").removeClass("wpdiscuz-hidden")})),e("body").on("click",".wpd\_editable\_comment",(function(){w&&e(".wpdiscuz-edit-form-wrap").length&&U($(e(".wpdiscuz-edit-form-wrap"),0),w);var t=e(this),a=$(t,0),o=X(a),n=new FormData;n.append("action","wpdEditComment"),n.append("commentId",o),w=e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-text").get(0),ue(v,!0,n).done((function(o){if("object"==typeof o)if(o.success){if(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text").replaceWith(o.data.html),wpdiscuzLoadRichEditor){var n=wpDiscuzEditor.createEditor("#wpd-editor-edit\_"+a);n.clipboard.dangerouslyPasteHTML(0,o.data.content),n.update(),e(".wpd-toolbar-hidden").prev("[id^=wpd-editor-]").css("border-bottom","1px solid #dddddd")}else e("#wc-textarea-edit\_"+a).val(o.data.content),me(e("#wc-textarea-edit\_"+a));e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd\_editable\_comment").hide(),e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").hide()}else wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[o.data],o.data,t),"error");else console.log(o);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wc\_save\_edited\_comment",(function(){var t=e(this),a=$(t),o=X(a),n=e("#wpd-comm-"+a+" #wpdiscuz-edit-form");if(ee(n,"#wpd-editor-edit\_"+a),n.on("submit",(function(e){e.preventDefault()})),n[0].checkValidity()){var i=new FormData;i.append("action","wpdSaveEditedComment"),i.append("commentId",o),e(":input",n).each((function(){""!==this.name&&"checkbox"!==this.type&&"radio"!==this.type&&i.append(this.name+"",e(this).val()),"checkbox"!==this.type&&"radio"!==this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(n){"object"==typeof n?(n.success?(U(a,n.data.message),n.data.comment\_approved\_html&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-subheader").append(n.data.comment\_approved\_html),n.data.lastEdited&&(e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-last-edited").remove(),e(n.data.lastEdited).insertAfter("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-right .wpd-comment-text")),n.data.twitterShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_tw").attr("href",n.data.twitterShareLink),n.data.whatsappShareLink&&e("#wpd-comm-"+a+" > .wpd-comment-wrap .wpd-comment-share .wpd-tooltip-content .wc\_whatsapp").attr("href",n.data.whatsappShareLink),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error"),we(n,o)):wpdiscuzAjaxObj.setCommentMessage(n,"error"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("click",".wc\_cancel\_edit",(function(){var t=$(e(this));U(t,w),wpdiscuzLoadRichEditor&&wpDiscuzEditor.removeEditor("#wpd-editor-edit\_"+t)})),!u&&m&&(M=0,1==m?setTimeout((function(){N(!0)}),500):e("body").on("click",".wpd-load-comments",(function(){e(this).parent(".wpd-load-more-submit-wrap").remove(),N(!0)}))),e("body").on("click",".wpd-load-more-submit",(function(){var t=e(this),a="wpd-loaded";t.hasClass(a)&&N(!1,t,a,"wpd-loading")}));var W=!1;function B(){var t=document.getElementById("wpdiscuzHasMoreComments"),a=0;t&&(a=t.dataset.is\_show\_load\_more);var o=document.getElementById("wpdcom")?document.getElementById("wpdcom").clientHeight:0,n=e(window).height()+e(window).scrollTop();o&&n&&(100\*n/o>=80&&!1===W&&1==a&&(W=!0,N(!1,e(".wpd-load-more-submit"))))}function N(t,a,o,n){a&&(a.toggleClass(o),a.toggleClass(n));var d=new FormData;d.append("action","wpdLoadMoreComments");var s=e(".wpdiscuz-sort-button-active").attr("data-sorting");s&&d.append("sorting",s),d.append("offset",M),d.append("lastParentId",e(".wpd-load-more-submit").attr("data-lastparentid")),d.append("isFirstLoad",t?1:0);var c=e(".wpdf-active").attr("data-filter-type");d.append("wpdType",c||""),ue(v,!t||1!=m,d).done((function(d){"object"==typeof d&&d.success&&(M++,t&&e(".wpd-comment").remove(),e(".wpdiscuz\_single").remove(),e(".wpdiscuz-comment-pagination").before(d.data.comment\_list),V(d,t&&2!==i),W=!1,d.data.loadLastCommentId&&(r=d.data.loadLastCommentId),we(d),t&&K(!1)),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))})).fail((function(t,i,d){console.log(d),e("#wpdiscuz-loading-bar").fadeOut(250),e(".wpd-load-more-submit").blur(),a&&(a.toggleClass(o),a.toggleClass(n))}))}function V(t,a){var o,n=document.getElementById("wpdiscuzHasMoreComments");if(0==t.data.is\_show\_load\_more)n&&(n.dataset.is\_show\_load\_more=0),e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide();else if(o=t.data.last\_parent\_id,e(".wpd-load-more-submit").attr("data-lastparentid",o),2!==i&&e(".wpdiscuz-comment-pagination").show(),n&&(n.dataset.is\_show\_load\_more=1),a&&e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").show(),t.data.comments\_left>0){if(!e(".wpd-load-more-submit .wpd-comments-left").length){const t=e("<span>");t.addClass("wpd-comments-left"),e(".wpd-load-more-submit").append(t)}e(".wpd-load-more-submit .wpd-comments-left").text(t.data.comments\_left\_text)}we(t)}function K(t){var a=location.href.match(/#comment\-(\d+)/);if(null!==a){var o=a[1];if(e("#comment-"+o).length)setTimeout((function(){te(),e("html, body").animate({scrollTop:e("#comment-"+o).parents("[id^=wpd-comm-]").offset().top-I},1e3,ae),t&&Q(o)}),500);else{var n=new FormData;n.append("action","wpdGetSingleComment"),n.append("commentId",o),ue(v,!0,n).done((function(a){if("object"==typeof a&&a.success){var n="#comment-"+o;e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e(n).offset().top-I},1e3,ae),t&&Q(o)}e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}}}function Q(t){setTimeout((function(){e("#comment-"+t).siblings(".wpd-secondary-form-wrapper").is(":visible")||e("#comment-"+t).find(".wpd-reply-button").trigger("click")}),1100)}function G(e){if(void 0!==e.data.message)for(var t,a=e.data.message,o=0;o<a.length;o++)J((t=a[o]).comment\_parent,t.comment\_html)}function $(e,t){var a="";return(a=t?e.parents(".wpd-main-form-wrapper").attr("id"):e.parents(".wpd-comment").attr("id")).substring(a.lastIndexOf("-")+1)}function X(e){return e.substring(0,e.indexOf("\_"))}function Y(e,t){return t?e.substring(e.indexOf("-")+1):e.substring(0,e.indexOf("-"))}function J(t,a){if(0==t)oe(a);else{var o=$(e("#comment-"+t),0);e("#wpdiscuz\_form\_anchor-"+o).after(a)}}function Z(){var t=[];return e(".wpd-comment-right").each((function(){t.push(X($(e(this),0)))})),t.join(",")}function ee(t,a){var o=t.find(".wpd-required-group");wpdiscuzLoadRichEditor&&t.find(".wc\_comment").val(e(a+">.ql-editor").html()),function(e){if("wpdiscuz-subscribe-form"==e.attr("id"))return;var t=e.find(".wc\_comment"),a=t.val().trim().replace(/<p><br><\/p>/g,"\n").replace(/<p>(.\*?)<\/p>/g,"$1\n");a=(a=(a=(a=a.replace(/<img src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img[^>]+alt=["|']([^"|']+)["|'][^>]+src=["|']https\:\/\/s\.w\.org\/images\/core\/emoji\/([^"|']+)["|'][^>]?>/g," $1 ")).replace(/<img\s+([^>]\*)class=["|']wpdem\-sticker["|'](.\*?)alt=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $3 ")).replace(/<img\s+([^>]\*)src=["|']([^"|']+)["|'](.\*?)[^>]\*>/g," $2 "),t.val(a)}(t),e.each(o,(function(){e("input",this).prop("required",!1),0===e("input:checked",this).length?e("input",e(this)).prop("required",!0):e(".wpd-field-invalid",this).remove()}))}function te(){e("html, body").css("scroll-behavior","unset")}function ae(){e("html").css("scroll-behavior",L),e("body").css("scroll-behavior",R)}function oe(t){e(".wpd-sticky-comment").last()[0]?e(t).insertAfter(e(".wpd-sticky-comment").last()[0]):e(".wpd-thread-list").prepend(t)}function ne(t){t?t.prop("required")||(t.val()?t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):t.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none")):e.each(e(".wc\_email"),(function(t,a){var o=e(a);o.prop("required")||(o.val()?o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","inline-block"):o.parents("form").find("[name=wpdiscuz\_notification\_type]").parent().css("display","none"))}))}if(2!==i||u||(e(".wpd-load-more-submit").parents(".wpdiscuz-comment-pagination").hide(),B(),e(window).scroll((function(){B()}))),wpdiscuzAjaxObj.setLoadMoreVisibility=V,e("body").on("click",".wpd-vote-up.wpd\_not\_clicked, .wpd-vote-down.wpd\_not\_clicked",(function(){var t=e(this);e(t).removeClass("wpd\_not\_clicked");var a,o=X($(t));a=e(this).hasClass("wpd-vote-up")?1:-1;var n=new FormData;n.append("action","wpdVoteOnComment"),n.append("commentId",o),n.append("voteType",a),ue(v,!0,n).done((function(n){if(e(t).addClass("wpd\_not\_clicked"),"object"==typeof n){if(n.success){if("total"===n.data.buttonsStyle){var i=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result"),d=n.data.votes;i.text(n.data.votesHumanReadable),i.attr("title",d),i.removeClass("wpd-up wpd-down"),d>0&&i.addClass("wpd-up"),d<0&&i.addClass("wpd-down")}else{var s=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-like"),c=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-result-dislike");s.text(n.data.likeCountHumanReadable),s.attr("title",n.data.likeCount),c.text(n.data.dislikeCountHumanReadable),c.attr("title",n.data.dislikeCount),parseInt(n.data.likeCount)>0?s.addClass("wpd-up"):s.removeClass("wpd-up"),parseInt(n.data.dislikeCount)<0?c.addClass("wpd-down"):c.removeClass("wpd-down")}var p=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-up"),r=e("#comment-"+o+" .wpd-comment-footer .wpd-vote-down");p.removeClass("wpd-up"),r.removeClass("wpd-down"),n.data.curUserReaction>0?p.addClass("wpd-up"):n.data.curUserReaction<0&&r.addClass("wpd-down")}else n.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[n.data],n.data,t),"error");we(n,o,a)}else console.log(n);e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(t).addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e(document).on("click","body",(function(t){var a=e(".wpdiscuz-sort-buttons");e(t.target).hasClass("wpdf-sorting")||e(t.target).parent().hasClass("wpdf-sorting")?a.css({display:a.is(":visible")?"none":"flex"}):a.hide()})),e("body").on("click",".wpdiscuz-sort-button:not(.wpdiscuz-sort-button-active)",(function(){var t=e(this),a=e(this).attr("data-sorting");if(a){e(".wpd-load-comments").parents(".wpd-load-more-submit-wrap").remove(),e(".wpdiscuz-sort-button.wpdiscuz-sort-button-active").removeClass("wpdiscuz-sort-button-active").appendTo(".wpdiscuz-sort-buttons"),t.addClass("wpdiscuz-sort-button-active").prependTo(".wpdf-sorting");var o=new FormData;o.append("action","wpdSorting"),o.append("sorting",a);var n=e(".wpdf-active").attr("data-filter-type");o.append("wpdType",n||""),ue(v,!0,o).done((function(t){"object"==typeof t&&t.success&&(e("#wpdcom .wpd-comment").remove(),e("#wpdcom .wpd-thread-list").prepend(t.data.message),V(t,!1),M=1),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),window.onhashchange=function(){K(!1)},1!=m&&K(!1),e("body").on("click",".wpdiscuz-readmore",(function(){var t=$(e(this)),a=X(t),o=new FormData;o.append("action","wpdReadMore"),o.append("commentId",a),ue(v,!0,o).done((function(o){"object"==typeof o?(o.success?(e("#comment-"+a+" .wpd-comment-text").replaceWith(" "+o.data.message),e("#wpdiscuz-readmore-"+t).remove()):console.log(o.data),we(o)):console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("change",".wpd-required-group",(function(){0!==e("input:checked",this).length?e("input",e(this)).prop("required",!1):e("input",e(this)).prop("required",!0)})),e("body").on("click",".wpdiscuz-spoiler",(function(){e(this).next().slideToggle(),e(this).hasClass("wpdiscuz-spoiler-closed")?e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-plus").removeClass("fa-plus").addClass("fa-minus"):e(this).parents(".wpdiscuz-spoiler-wrap").find(".fa-minus").removeClass("fa-minus").addClass("fa-plus"),e(this).toggleClass("wpdiscuz-spoiler-closed")})),e("body").on("click",".wpd-tools",(function(){var t=e(".wpd-tools-actions",e(this));t.is(":visible")||e(this).parents(".wpd-comment-right").attr("id")!==e("[id^=comment-]","#wpdcom").last().attr("id")||e("#comments").css({paddingBottom:"160px"}),t.css({display:t.is(":visible")?"none":"flex"})})),e("body").on("mouseleave",".wpd-comment-right",(function(){e(this).find(".wpd-tools-actions").hide(),e("#comments").css({paddingBottom:"0"})})),e("body").on("click",".wpd\_stick\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdStickComment"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd\_close\_btn",(function(){var t=X($(e(this),0)),a=new FormData;a.append("action","wpdCloseThread"),a.append("commentId",t),ue(v,!0,a).done((function(t){"object"==typeof t&&t.success&&location.reload(!0),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-filter.wpd\_not\_clicked[data-filter-type]",(function(){var t=e(this),a=t.attr("data-filter-type");wpdiscuzAjaxObj.resetActiveFilters(".wpdf-"+a),t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var o=new FormData;o.append("action","wpdLoadMoreComments");var n=e(".wpdiscuz-sort-button-active").attr("data-sorting");n&&o.append("sorting",n),o.append("lastParentId",0),o.append("offset",0),M=1,o.append("wpdType",t.hasClass("wpdf-active")?"":a),o.append("isFirstLoad",1),e(this).hasClass("wpdf-inline")?e(this).hasClass("wpdf-active")?e(".wpd-comment-info-bar").hide():e(".wpd-comment-info-bar").css("display","flex"):e(".wpd-comment-info-bar").hide(),ue(v,!1,o).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(t.toggleClass("wpdf-active"),e(".wpd-load-comments").remove(),e(".wpd-comment").remove(),e(".wpd-thread-list").prepend(a.data.comment\_list),V(a),r=a.data.loadLastCommentId,e(".wpd-load-more-submit").blur(),we(a)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpdf-reacted.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdMostReactedComment"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.parentCommentID).length?e("#comment-"+a.data.parentCommentID).parents("[id^=wpd-comm-"+a.data.parentCommentID+"]").replaceWith(a.data.message):e("#comment-"+a.data.commentId).length||e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpdf-hottest.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=new FormData;a.append("action","wpdHottestThread"),ue(v,!1,a).done((function(a){t.addClass("wpd\_not\_clicked"),e(".fas",t).removeClass("fa-pulse fa-spinner"),"object"==typeof a&&a.success&&(e("#comment-"+a.data.commentId).length?e("#comment-"+a.data.commentId).parents("[id^=wpd-comm-"+a.data.commentId+"]").replaceWith(a.data.message):e(".wpd-thread-list").prepend(a.data.message),we(a),te(),e("html, body").animate({scrollTop:e("#comment-"+a.data.commentId).offset().top-I},1e3,ae))})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner")}))})),e("body").on("click",".wpd-filter-view-all",(function(){e(".wpdf-inline.wpdf-active.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-follow-link.wpd\_not\_clicked",(function(){var t=e(this);t.removeClass("wpd\_not\_clicked"),e(".fas",t).addClass("fa-pulse fa-spinner");var a=X($(t,0)),o=new FormData;o.append("action","wpdFollowUser"),o.append("commentId",a),ue(v,!0,o).done((function(a){t.addClass("wpd\_not\_clicked"),"object"==typeof a?a.success?(wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data.code],a.data.code,t),"success"),t.removeClass("wpd-follow-active"),a.data.followTip&&t.attr("wpd-tooltip",a.data.followTip),a.data.followClass&&t.addClass(a.data.followClass),we(a)):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(a,o,n){console.log(n),e(".fas",t).removeClass("fa-pulse fa-spinner"),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),ne(),e("body").on("keyup",".wc\_email",(function(){ne(e(this))})),j&&e("#wpdcom").length){if(e("#wpd-bubble-wrapper").hover((function(){e(this).addClass("wpd-bubble-hover")}),(function(){e(this).removeClass("wpd-bubble-hover")})),C&&!Cookies.get(wpdiscuzAjaxObj.cookieHideBubbleHint)&&setTimeout((function(){e("#wpd-bubble-wrapper").addClass("wpd-bubble-hover");const t=wpdiscuzAjaxObj.bubbleHintShowOnce?"/":location.href;wpdiscuzAjaxObj.bubbleHintCookieExpires&&parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10);Cookies.set(wpdiscuzAjaxObj.cookieHideBubbleHint,"1",{expires:parseInt(wpdiscuzAjaxObj.bubbleHintCookieExpires,10),path:t}),setTimeout((function(){e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")}),1e3\*y)}),1e3\*C),"content\_left"===O)if(e(".entry-content").length){var ie=(de=Math.min(e(".entry-content").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".post-entry").length){ie=(de=Math.min(e(".post-entry").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else if(e(".container").length){var de;ie=(de=Math.min(e(".container").offset().left,e("#wpdcom").offset().left)-120)>25?de:25;e("#wpd-bubble-wrapper").css({left:ie+"px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-content")}else e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner");else"left\_corner"===O?(e("#wpd-bubble-wrapper").css({left:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-left-corner")):"right\_corner"===O&&(e("#wpd-bubble-wrapper").css({right:"25px"}),e("#wpd-bubble-wrapper").addClass("wpd-right-corner"));e("#wpd-bubble-wrapper").show(),e("body").on("click","#wpd-bubble-add-message-close",(function(t){t.preventDefault(),t.stopPropagation(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover")})),e("body").on("click","#wpd-bubble",(function(){te(),e("#tab-title-reviews").length&&e("#tab-title-reviews a").trigger("click"),e("html, body").animate({scrollTop:e("#wpdcom").offset().top-(I+28)},1e3,(function(){ae(),e("#wpd-bubble-wrapper").removeClass("wpd-bubble-hover"),wpdiscuzLoadRichEditor?e("#wpd-editor-0\_0").length&&wpDiscuzEditor.createEditor("#wpd-editor-0\_0").focus():e("#wc-textarea-0\_0").length&&e("#wc-textarea-0\_0").trigger("focus")}))})),e("body").on("click","#wpd-bubble-comment-close",(function(t){t.preventDefault(),e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")})),e("body").on("click","#wpd-bubble-comment-reply-link a",(function(){var t=e(this).attr("href");setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),K(!0);var a=t.match(/#comment\-(\d+)/);E=E.filter((function(e){return e!=a[1]})),e("#wpd-bubble-count .wpd-new-comments-count").text(E.length),0==E.length&&e("#wpd-bubble-count").removeClass("wpd-new-comments")}),100)})),e("body").on("click","#wpd-bubble-count",(function(){if(E.length){var t=new FormData;t.append("action","wpdBubbleUpdate"),t.append("newCommentIds",E.join()),ue(v,!0,t).done((function(t){"object"==typeof t&&t.success&&(t.data.message=t.data.message.filter((function(t){if(!e("#comment-"+t.comment\_id).length)return t})),G(t),e("#wpd-bubble-count").removeClass("wpd-new-comments"),e("#wpd-bubble-count .wpd-new-comments-count").text("0"),E=[],e(".wpd-new-loaded-comment").length&&(te(),e("html, body").animate({scrollTop:e(e(".wpd-new-loaded-comment")[0]).offset().top-(I+28)},1e3,ae)),we(t)),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(e,t,a){console.log(a)}))}}))}if((j&&x||s)&&(t||!t&&p)&&setTimeout((function t(){e.ajax({type:"GET",url:wpdiscuzAjaxObj.bubbleUpdateUrl,beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",wpdiscuzAjaxObj.restNonce)},data:{postId:d,lastId:l,visibleCommentIds:Z()}}).done((function(a){if(!F)if("object"==typeof a){if(a.commentIDsToRemove.forEach((function(t){e("[id^=wpd-comm-"+t+"]").remove()})),a.ids.length){s&&function(){var t=new FormData;t.append("action","wpdUpdateAutomatically"),t.append("loadLastCommentId",r),t.append("visibleCommentIds",Z()),ue(v,!1,t).done((function(t){F||"object"==typeof t&&t.success&&(G(t),t.data.wc\_all\_comments\_count\_new=parseInt(t.data.wc\_all\_comments\_count\_new),e(".wpd-thread-info").html(t.data.wc\_all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",t.data.wc\_all\_comments\_count\_new),e("#wpd-bubble-all-comments-count").replaceWith(t.data.wc\_all\_comments\_count\_bubble\_html),r=t.data.loadLastCommentId)})).fail((function(e,t,a){console.log(a)}))}(),a.ids=a.ids.filter((function(t){if(!e("#comment-"+t).length)return t}));var o=5e3;l=parseInt(a.ids[a.ids.length-1]),E=E.concat(a.ids),k&&a.commentText&&(e("#wpd-bubble-author-avatar").html(a.avatar),e("#wpd-bubble-author-name").html(a.authorName),e("#wpd-bubble-comment-date span").html(a.commentDate),e("#wpd-bubble-comment-text").html(a.commentText),e("#wpd-bubble-comment-reply-link a").attr("href",a.commentLink),e("#wpd-bubble-notification-message").show(),o=1e4);var n=parseInt(e(".wpd-new-comments-count").text());n+=a.ids.length,e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added"),e("#wpd-bubble-wrapper").addClass("wpd-new-comment-added"),setTimeout((function(){e("#wpd-bubble-notification-message").hide(),e("#wpd-bubble-wrapper").removeClass("wpd-new-comment-added")}),o),e(".wpd-new-comments-count").text(n),e("#wpd-bubble-count").addClass("wpd-new-comments")}a.all\_comments\_count=parseInt(a.all\_comments\_count),e("#wpd-bubble-all-comments-count").replaceWith(a.all\_comments\_count\_bubble\_html),e(".wpd-reviews-tab").length||(e(".wpd-thread-info").html(a.all\_comments\_count\_before\_threads\_html),e(".wpd-thread-info").attr("data-comments-count",a.all\_comments\_count))}else console.log(a);setTimeout(t,c)})).fail((function(e,a,o){console.log(o),setTimeout(t,c)}))}),c),e(".wpd-inline-form-wrapper").length){var se=new FormData;se.append("action","wpdGetInlineCommentForm"),ue(v,!1,se).done((function(t){"object"==typeof t?t.success?(e(".wpd-inline-form-wrapper").append(t.data),e.each(e("[name=\_wpd\_inline\_nonce]"),(function(){var t=e(this).attr("id"),a=e(this).parents(".wpd-inline-shortcode").attr("id");e(this).attr("id",t+"-"+a.substring(a.lastIndexOf("-")+1))})),e(".wpd-inline-opened").addClass("wpd-active"),e(".wpd-inline-opened").find(".wpd-inline-form-wrapper").show(),e(".wpd-inline-opened").find(".wpd-inline-icon").addClass("wpd-open"),e(".wpd-inline-opened").find(".wpd-inline-icon").removeClass("wpd-ignored"),le()):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data]),t.data,"error"):console.log(t)})).fail((function(e,t,a){console.log(a)}))}function ce(t){if(e(t).hasClass("wpd-inline-shortcode"))var a=e(t).attr("id");else a=e(t).parents(".wpd-inline-shortcode").attr("id");return a.substring(a.lastIndexOf("-")+1)}function pe(){e(".wpd-inline-form-wrapper").hide(),e(".wpd-inline-shortcode").removeClass("wpd-active"),e(".wpd-inline-icon").removeClass("wpd-open")}function re(){e.each(e(".wpd-inline-shortcode:not(.wpd-inline-opened) .wpd-inline-icon"),(function(){var t=e(this),a=t.offset().top-window.pageYOffset;t.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&a>0&&a<300&&("blink"===A?(t.addClass("wpd-blink"),setTimeout((function(){t.removeClass("wpd-blink")}),3e3)):(t.parents(".wpd-inline-shortcode").addClass("wpd-active"),t.siblings(".wpd-inline-form-wrapper").show(),t.addClass("wpd-open"),le(t.siblings(".wpd-inline-form-wrapper"))))}))}function le(t){if(t){if(t.offset().left<=10)t.css("left",Math.ceil(parseInt(t.css("left"))-t.offset().left+10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))<3&&(a=3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;");else if(t.offset().left+t.width()>document.body.clientWidth-10){var a;t.css("left",Math.ceil(parseInt(t.css("left"))+(document.body.clientWidth-(t.offset().left+t.width()))-10)),(a=Math.ceil(t.siblings(".wpd-inline-icon.wpd-open").offset().left-t.offset().left+2))>t.width()-3&&(a=t.width()-3),document.styleSheets[0].addRule("#"+t.parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+a+"px;")}}else e.each(e(".wpd-inline-form-wrapper:visible"),(function(){if(e(this).offset().left<=10)e(this).css("left",Math.ceil(parseInt(e(this).css("left"))-e(this).offset().left+10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))<3&&(t=3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;");else if(e(this).offset().left+e(this).width()>document.body.clientWidth-10){var t;e(this).css("left",Math.ceil(parseInt(e(this).css("left"))+(document.body.clientWidth-(e(this).offset().left+e(this).width()))-10)),(t=Math.ceil(e(this).siblings(".wpd-inline-icon.wpd-open").offset().left-e(this).offset().left+2))>e(this).width()-3&&(t=e(this).width()-3),document.styleSheets[0].addRule("#"+e(this).parents(".wpd-inline-shortcode").attr("id")+" .wpd-inline-form-wrapper::before","left: "+t+"px;")}}))}function me(t){var a,o=0;if(t.parents(".wpd\_main\_comm\_form").length)o=parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents(".wpd\_main\_comm\_form");else if(t.parents(".wpd-secondary-form-wrapper").length)o=parseInt(wpdiscuzAjaxObj.replyTextMaxLength),a=t.parents(".wpd-secondary-form-wrapper");else if(t.parents("#wpdiscuz-edit-form").length){var n=$(t);o=parseInt(n.substring(n.lastIndexOf("\_")+1))?parseInt(wpdiscuzAjaxObj.replyTextMaxLength):parseInt(wpdiscuzAjaxObj.commentTextMaxLength),a=t.parents("#wpdiscuz-edit-form")}if(o&&a){var i=t.val().length,d=e(".wpd-editor-char-counter",a),s=o-i;d.html(s),s<=10?d.addClass("error"):d.removeClass("error")}}function we(t,a,o,n){t.data.callbackFunctions&&e.each(t.data.callbackFunctions,(function(e){"function"==typeof wpdiscuzAjaxObj[t.data.callbackFunctions[e]]?wpdiscuzAjaxObj[t.data.callbackFunctions[e]](t,a,o,n):"function"==typeof window[t.data.callbackFunctions[e]]?window[t.data.callbackFunctions[e]](t,a,o,n):console.log(t.data.callbackFunctions[e]+" is not a function")}))}function ue(t,a,o){a&&e("#wpdiscuz-loading-bar").show(),o.append("postId",d);var n=o.get("action");wpdiscuzAjaxObj.dataFilterCallbacks&&wpdiscuzAjaxObj.dataFilterCallbacks[n]&&e.each(wpdiscuzAjaxObj.dataFilterCallbacks[n],(function(e){"function"==typeof wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]]&&(o=wpdiscuzAjaxObj[wpdiscuzAjaxObj.dataFilterCallbacks[n][e]](o,t,a))}));var i=t?wpdiscuzAjaxObj.url:wpdiscuzAjaxObj.customAjaxUrl;return console.log(i),e.ajax({type:"POST",url:i,data:o,contentType:!1,processData:!1})}e(document).on("click","body",(function(t){if(e(t.target).hasClass("wpd-inline-form-close")||e(t.target).parents(".wpd-inline-form-close").length)t.preventDefault(),e(t.target).parents(".wpd-inline-form-wrapper").hide(),e(t.target).parents(".wpd-inline-shortcode").removeClass("wpd-active"),e(t.target).parents(".wpd-inline-form-wrapper").siblings(".wpd-inline-icon").removeClass("wpd-open");else if(!e(t.target).hasClass("wpd-inline-form-wrapper")&&!e(t.target).parents(".wpd-inline-form-wrapper").length){pe();var a="";e(t.target).hasClass("wpd-inline-icon")?a=e(t.target):e(t.target).parents(".wpd-inline-icon").length&&(a=e(t.target).parents(".wpd-inline-icon")),a.length&&a.parents(".wpd-inline-shortcode").find(".wpd-inline-form").length&&(a.parents(".wpd-inline-shortcode").addClass("wpd-active"),a.siblings(".wpd-inline-form-wrapper").show(),a.addClass("wpd-open"),a.removeClass("wpd-ignored"),le(a.siblings(".wpd-inline-form-wrapper")))}(!e(t.target).hasClass("wpd-last-inline-comments-wrapper")&&!e(t.target).parents(".wpd-last-inline-comments-wrapper").length||e(t.target).parents(".wpd-last-inline-comments-wrapper").length&&e(t.target).hasClass("wpd-load-inline-comment"))&&e(".wpd-last-inline-comments-wrapper").remove()})),e("body").on("click",".wpd-inline-submit.wpd\_not\_clicked",(function(t){t.preventDefault();var a=e(this),o=e(this).parents(".wpd\_inline\_comm\_form");if(o[0].checkValidity()){e(this).removeClass("wpd\_not\_clicked");var n=new FormData;n.append("action","wpdAddInlineComment"),n.append("inline\_form\_id",ce(o)),e.each(e("input, textarea",o),(function(t,a){"checkbox"===this.type?e(this).is(":checked")&&n.append(e(a).attr("name"),e(a).val()):n.append(e(a).attr("name"),e(a).val())})),ue(v,!0,n).done((function(t){if(a.addClass("wpd\_not\_clicked"),"object"==typeof t)if(t.success){o[0].reset(),pe();var n=parseInt(t.data.newCount),i=a.parents(".wpd-inline-icon-wrapper").find(".wpd-inline-icon-count");i.text(n),n?i.addClass("wpd-has-comments"):i.removeClass("wpd-has-comments"),t.data.allCommentsCountNew=parseInt(t.data.allCommentsCountNew),e(".wpd-thread-info").html(t.data.allCommentsCountBeforeThreadsHtml),e(".wpd-thread-info").attr("data-comments-count",t.data.allCommentsCountNew),e("#wpd-bubble-all-comments-count").replaceWith(t.data.allCommentsCountBubbleHtml),t.data.message&&oe(t.data.message),wpdiscuzAjaxObj.setCommentMessage(t.data.notification,"success")}else t.data&&wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data,a),"error");else wpdiscuzAjaxObj.setCommentMessage(t,"error");e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))}})),e("body").on("keydown",".wpd-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_comm\_submit").trigger("click")})),e("body").on("keydown","#wpdiscuz-edit-form",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).find(".wc\_save\_edited\_comment").trigger("click")})),e("body").on("keydown",".wpd-inline-comment-content",(function(t){t.ctrlKey&&13==t.keyCode&&e(this).parents(".wpd\_inline\_comm\_form").find(".wpd-inline-submit.wpd\_not\_clicked").trigger("click")})),e("body").on("click",".wpd-inline-icon-count.wpd-has-comments",(function(){var t=e(this),a=new FormData;a.append("action","wpdGetLastInlineComments"),a.append("inline\_form\_id",ce(t)),ue(v,!0,a).done((function(a){"object"==typeof a?a.success?e(a.data).insertAfter(t):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[a.data],a.data,t),"error"):console.log(a),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),e("body").on("click",".wpd-view-all-inline-comments",(function(t){t.preventDefault(),e(this).parents(".wpd-last-inline-comments-wrapper").remove(),e(".wpdf-inline").hasClass("wpdf-active")||e(".wpdf-inline").trigger("click"),te(),e("html, body").animate({scrollTop:e(".wpdf-inline").offset().top-I},1e3,ae)})),e("body").on("click",".wpd-feedback-content-link",(function(t){t.preventDefault();var a=e(this).data("feedback-content-id");te(),e("html, body").animate({scrollTop:e("#wpd-inline-"+a).offset().top-(I+6)},1e3,(function(){ae(),e("#wpd-inline-"+a).addClass("wpd-active")}))})),"scroll\_open"!==A&&"blink"!==A||(re(),e(window).on("scroll",re)),e("body").on("click","#wpd-post-rating.wpd-not-rated .wpd-rate-starts svg",(function(){var t=new FormData,a=e(this).index();a>=0&&a<5&&(t.append("action","wpdUserRate"),t.append("rating",a+1),ue(v,!0,t).done((function(t){"object"==typeof t?(t.success?location.reload(!0):wpdiscuzAjaxObj.setCommentMessage(wpdiscuzAjaxObj.applyFilterOnPhrase(wpdiscuzAjaxObj[t.data],t.data),"error"),we(t)):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250)})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)})))})),e("body").on("submit","#wpdiscuz-subscribe-form",(function(t){t.preventDefault();var a=e(this);const o=e("#wpdiscuz\_subscription\_button",a);if(a[0].checkValidity()&&(d=a,s=!0,"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&!e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).val().length?(s=!1,e(".wpdiscuz-recaptcha",d).css("border","1px solid red")):"2.0"===n&&e("input[name=wpdiscuz\_recaptcha\_subscribe\_form]",d).length&&e(".wpdiscuz-recaptcha",d).css("border","none"),s)&&o.hasClass("wpd\_not\_clicked")){o.removeClass("wpd\_not\_clicked");var i=new FormData;i.append("action","wpdAddSubscription"),e("\*",a).each((function(){""!=this.name&&"checkbox"!=this.type&&"radio"!=this.type&&i.append(this.name+"",e(this).val()),"checkbox"!=this.type&&"radio"!=this.type||e(this).is(":checked")&&i.append(this.name+"",e(this).val())})),ue(v,!0,i).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):wpdiscuzAjaxObj.setCommentMessage(t,"error"),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1,o.addClass("wpd\_not\_clicked")})).fail((function(t,a,n){console.log(n),o.addClass("wpd\_not\_clicked"),e("#wpdiscuz-loading-bar").fadeOut(250)}))}var d,s})),e("body").on("click",".wpd-unsubscribe",(function(t){t.preventDefault();var a=new FormData;a.append("action","wpdUnsubscribe"),a.append("sid",e(this).data("sid")),a.append("skey",e(this).data("skey")),ue(v,!0,a).done((function(t){"object"==typeof t?t.success?(wpdiscuzAjaxObj.setCommentMessage(t.data,"success"),setTimeout((function(){location.reload(!0)}),3e3)):wpdiscuzAjaxObj.setCommentMessage(t.data,"error"):console.log(t),e("#wpdiscuz-loading-bar").fadeOut(250),F=!1})).fail((function(t,a,o){console.log(o),e("#wpdiscuz-loading-bar").fadeOut(250)}))})),wpdiscuzAjaxObj.resetActiveFilters=function(t){e(".wpd-filter.wpdf-active"+(t?":not("+t+")":"")).removeClass("wpdf-active")},wpdiscuzAjaxObj.getAjaxObj=ue}));var onloadCallback=function(){if(document.getElementById("wpdiscuz-recaptcha-0\_0")&&"2.0"===wpdiscuzAjaxObj.wpDiscuzReCaptchaVersion&&(1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_guest&&!wpdiscuzAjaxObj.is\_user\_logged\_in||1==wpdiscuzAjaxObj.wc\_captcha\_show\_for\_members&&wpdiscuzAjaxObj.is\_user\_logged\_in))try{grecaptcha.render("wpdiscuz-recaptcha-0\_0",{sitekey:wpdiscuzAjaxObj.wpDiscuzReCaptchaSK,theme:wpdiscuzAjaxObj.wpDiscuzReCaptchaTheme,callback:function(e){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("key")},"expired-callback":function(){jQuery("#wpdiscuz-recaptcha-field-0\_0").val("")}})}catch(e){console.log(e),wpdiscuzAjaxObj.setCommentMessage("reCaptcha Error: "+e.message,"error")}}; |
* ## [wpdiscuz/trunk/class.WpdiscuzCore.php](/changeset/3124810/wpdiscuz/trunk/class.WpdiscuzCore.php "Show the changeset 3124810 restricted to wpdiscuz/trunk/class.WpdiscuzCore.php")

  | [r3113460](/browser/wpdiscuz/trunk/class.WpdiscuzCore.php?rev=3113460#L3 "Show revision 3113460 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/class.WpdiscuzCore.php?rev=3124810#L3 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | \* Plugin Name: wpDiscuz |
  | 4 | 4 | \* Description: #1 WordPress Comment Plugin. Innovative, modern and feature-rich comment system to supercharge your website comment section. |
  | 5 |  | \* Version: 7.6.2~~1~~ |
  |  | 5 | \* Version: 7.6.22 |
  | 6 | 6 | \* Author: gVectors Team |
  | 7 | 7 | \* Author URI: https://gvectors.com/ |
* ## [wpdiscuz/trunk/readme.txt](/changeset/3124810/wpdiscuz/trunk/readme.txt "Show the changeset 3124810 restricted to wpdiscuz/trunk/readme.txt")

  | [r3113460](/browser/wpdiscuz/trunk/readme.txt?rev=3113460#L4 "Show revision 3113460 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/readme.txt?rev=3124810#L4 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Requires at least: 5.0 |
  | 5 | 5 | Tested up to: 6.5 |
  | 6 |  | Stable tag: 7.6.2~~1~~ |
  |  | 6 | Stable tag: 7.6.22 |
  | 7 | 7 | Requires PHP: 5.6 |
  | 8 | 8 | License: GPLv3 |
  | […](/browser/wpdiscuz/trunk/readme.txt?rev=3113460#L190) | […](/browser/wpdiscuz/trunk/readme.txt?rev=3124810#L190) |  |
  | 190 | 190 | Please don't forget delete all caches and purge CDN after the update. |
  | 191 | 191 |  |
  |  | 192 | = Comments - wpDiscuz v7.6.22 - 24.07.2024 = |
  |  | 193 |  |
  |  | 194 | \* Added: A new hook "wpdiscuz\_generate\_thumbnails\_check" to disable thumbnails generation cron |
  |  | 195 | \* Added: A new JS event on comment post "wpdiscuz\_comment\_posted" |
  |  | 196 | \* Fixed: Filtering buttons now visible if there is at least one comment |
  |  | 197 | \* Fixed: Security issue, if reach editor and quick tags are disabled clean all HTML from comment content |
  |  | 198 |  |
  | 192 | 199 | = Comments - wpDiscuz v7.6.21 - 06.07.2024 = |
  | 193 | 200 |  |
* ## [wpdiscuz/trunk/themes/default/comment-form.php](/changeset/3124810/wpdiscuz/trunk/themes/default/comment-form.php "Show the changeset 3124810 restricted to wpdiscuz/trunk/themes/default/comment-form.php")

  | [r3018355](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L13 "Show revision 3018355 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L13 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 13 | 13 | $load = apply\_filters("wpdiscuz\_load\_template", true, $currentUser, $post); |
  | 14 | 14 | if (!post\_password\_required($post->ID) && $load) { |
  | 15 |  | $commentsCount = get\_comments\_number(); |
  | 16 |  | $wpCommClasses = []; |
  | 17 |  | $wpCommClasses[] = $currentUser && $currentUser->ID ? "wpdiscuz\_auth" : "wpdiscuz\_unauth"; |
  | 18 |  | $wpCommClasses[] = $wpdiscuz->options->thread\_styles["theme"]; |
  |  | 15 | $commentsCount          = (int)get\_comments\_number(); |
  |  | 16 | $filtersVisibilityClass = $commentsCount === 0 ? 'wpdiscuz-hidden' : ''; |
  |  | 17 | $wpCommClasses          = []; |
  |  | 18 | $wpCommClasses[]        = $currentUser && $currentUser->ID ? "wpdiscuz\_auth" : "wpdiscuz\_unauth"; |
  |  | 19 | $wpCommClasses[]        = $wpdiscuz->options->thread\_styles["theme"]; |
  | 19 | 20 |  |
  | 20 | 21 | if (!$wpdiscuz->options->thread\_layouts["showAvatars"] || !$wpdiscuz->options->wp["showAvatars"]) { |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L27) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L28) |  |
  | 27 | 28 |  |
  | 28 | 29 | $wpCommClasses[] = "wpd-layout-" . $form->getLayout(); |
  | 29 |  | $commentsOpen = comments\_open($post); |
  |  | 30 | $commentsOpen    = comments\_open($post); |
  | 30 | 31 | $wpCommClasses[] = $commentsOpen ? "wpd-comments-open" : "wpd-comments-closed"; |
  | 31 |  | $wpCommClasses = apply\_filters("wpdiscuz\_container\_classes", $wpCommClasses); |
  |  | 32 | $wpCommClasses   = apply\_filters("wpdiscuz\_container\_classes", $wpCommClasses); |
  | 32 | 33 |  |
  | 33 | 34 | $wpCommClasses = implode(" ", $wpCommClasses); |
  | 34 | 35 |  |
  | 35 |  | $currentUserId = 0; |
  |  | 36 | $currentUserId    = 0; |
  | 36 | 37 | $currentUserEmail = isset($\_COOKIE["comment\_author\_email\_" . COOKIEHASH]) ? sanitize\_email($\_COOKIE["comment\_author\_email\_" . COOKIEHASH]) : ""; |
  | 37 | 38 | if ($currentUser && $currentUser->ID) { |
  | 38 |  | $currentUserId = $currentUser->ID; |
  |  | 39 | $currentUserId    = $currentUser->ID; |
  | 39 | 40 | $currentUserEmail = $currentUser->user\_email; |
  | 40 | 41 | } |
  | 41 | 42 |  |
  | 42 | 43 | $isShowSubscribeBar = $form->isShowSubscriptionBar() && WpdiscuzHelper::isUserCanFollowOrSubscribe($currentUserEmail); |
  | 43 |  | $isPostmaticActive = !class\_exists("Prompt\_Comment\_Form\_Handling") || (class\_exists("Prompt\_Comment\_Form\_Handling") && !$wpdiscuz->options->subscription["usePostmaticForCommentNotification"]); |
  |  | 44 | $isPostmaticActive  = !class\_exists("Prompt\_Comment\_Form\_Handling") || (class\_exists("Prompt\_Comment\_Form\_Handling") && !$wpdiscuz->options->subscription["usePostmaticForCommentNotification"]); |
  | 44 | 45 |  |
  | 45 | 46 | $wpdiscuz->helper->superSocializerFix(); |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L83) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L84) |  |
  | 83 | 84 | $user\_url = get\_author\_posts\_url($currentUser->ID); |
  | 84 | 85 | $user\_url = $wpdiscuz->helper->getProfileUrl($user\_url, $currentUser); |
  | 85 |  | $logout = wp\_loginout(get\_permalink(), false); |
  | 86 |  | $logout = preg\_replace("!>([^<]+)!is", ">" . esc\_html($wpdiscuz->options->getPhrase("wc\_log\_out")), $logout); |
  |  | 86 | $logout   = wp\_loginout(get\_permalink(), false); |
  |  | 87 | $logout   = preg\_replace("!>([^<]+)!is", ">" . esc\_html($wpdiscuz->options->getPhrase("wc\_log\_out")), $logout); |
  | 87 | 88 | if ($user\_url) { |
  | 88 | 89 | $logout\_text = esc\_html($wpdiscuz->options->getPhrase("wc\_logged\_in\_as")) . " <a href='" . esc\_url\_raw($user\_url) . "'>" . esc\_html($wpdiscuz->helper->getCurrentUserDisplayName($currentUser)) . "</a> | " . $logout; |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L112) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L113) |  |
  | 112 | 113 | if ($isShowSubscribeBar && $isPostmaticActive) { |
  | 113 | 114 | $wpdiscuz->subscriptionData = $wpdiscuz->dbManager->hasSubscription($post->ID, $currentUser->user\_email); |
  | 114 |  | $subscriptionType = null; |
  |  | 115 | $subscriptionType           = null; |
  | 115 | 116 | if ($wpdiscuz->subscriptionData) { |
  | 116 |  | $isConfirmed = $wpdiscuz->subscriptionData["confirm"]; |
  |  | 117 | $isConfirmed      = $wpdiscuz->subscriptionData["confirm"]; |
  | 117 | 118 | $subscriptionType = $wpdiscuz->subscriptionData["type"]; |
  | 118 | 119 | if ($subscriptionType === WpdiscuzCore::SUBSCRIPTION\_POST || $subscriptionType === WpdiscuzCore::SUBSCRIPTION\_ALL\_COMMENT) { |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L237) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L238) |  |
  | 237 | 238 | if (!$wpdiscuz->options->wp["isPaginate"] && $wpdiscuz->options->inline["showInlineFilterButton"] && $wpdiscuz->dbManager->postHasFeedbackForms($post->ID)) { |
  | 238 | 239 | ?> |
  | 239 |  | <div class="wpd-filter wpdf-inline wpd\_not\_clicked" data-filter-type="inline" |
  |  | 240 | <div class="wpd-filter wpdf-inline wpd\_not\_clicked <?php echo esc\_attr($filtersVisibilityClass); ?>" data-filter-type="inline" |
  | 240 | 241 | wpd-tooltip="<?php echo esc\_attr($wpdiscuz->options->getPhrase("wc\_inline\_comments")); ?>"> |
  | 241 | 242 | <i class="fas fa-quote-left"></i></div> |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L244) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L245) |  |
  | 244 | 245 | if ($wpdiscuz->options->thread\_display["showReactedFilterButton"]) { |
  | 245 | 246 | ?> |
  | 246 |  | <div class="wpd-filter wpdf-reacted wpd\_not\_clicked" |
  |  | 247 | <div class="wpd-filter wpdf-reacted wpd\_not\_clicked <?php echo esc\_attr($filtersVisibilityClass); ?>" |
  | 247 | 248 | wpd-tooltip="<?php echo esc\_attr($wpdiscuz->options->getPhrase("wc\_most\_reacted\_comment")); ?>"> |
  | 248 | 249 | <i class="fas fa-bolt"></i></div> |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L251) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L252) |  |
  | 251 | 252 | if ($wpdiscuz->options->thread\_display["showHottestFilterButton"]) { |
  | 252 | 253 | ?> |
  | 253 |  | <div class="wpd-filter wpdf-hottest wpd\_not\_clicked" |
  |  | 254 | <div class="wpd-filter wpdf-hottest wpd\_not\_clicked <?php echo esc\_attr($filtersVisibilityClass); ?>" |
  | 254 | 255 | wpd-tooltip="<?php echo esc\_attr($wpdiscuz->options->getPhrase("wc\_hottest\_comment\_thread")); ?>"> |
  | 255 | 256 | <i class="fas fa-fire"></i></div> |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L263) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L264) |  |
  | 263 | 264 | } |
  | 264 | 265 | $wpdiscuzCommentsOrderBy = apply\_filters("wpdiscuz\_comments\_order\_by", $wpdiscuzCommentsOrderBy); |
  | 265 |  | $wpdiscuzCommentsOrder = apply\_filters("wpdiscuz\_comments\_order", $wpdiscuzCommentsOrder); |
  | 266 |  | if ($~~commentsCount && $~~wpdiscuz->options->thread\_display["showSortingButtons"] && !$wpdiscuz->options->wp["isPaginate"]) { |
  |  | 266 | $wpdiscuzCommentsOrder   = apply\_filters("wpdiscuz\_comments\_order", $wpdiscuzCommentsOrder); |
  |  | 267 | if ($wpdiscuz->options->thread\_display["showSortingButtons"] && !$wpdiscuz->options->wp["isPaginate"]) { |
  | 267 | 268 | $sortingButtons = [ |
  | 268 | 269 | [ |
  | 269 | 270 | "orderBy" => $wpdiscuz->options->thread\_display["orderCommentsBy"], |
  | 270 |  | "order" => "desc", |
  | 271 |  | "class" => "wpdiscuz-date-sort-desc", |
  | 272 |  | "text" => $wpdiscuz->options->getPhrase("wc\_newest"), |
  | 273 |  | "type" => "newest", |
  |  | 271 | "order"   => "desc", |
  |  | 272 | "class"   => "wpdiscuz-date-sort-desc", |
  |  | 273 | "text"    => $wpdiscuz->options->getPhrase("wc\_newest"), |
  |  | 274 | "type"    => "newest", |
  | 274 | 275 | ], |
  | 275 | 276 | [ |
  | 276 | 277 | "orderBy" => $wpdiscuz->options->thread\_display["orderCommentsBy"], |
  | 277 |  | "order" => "asc", |
  | 278 |  | "class" => "wpdiscuz-date-sort-asc", |
  | 279 |  | "text" => $wpdiscuz->options->getPhrase("wc\_oldest"), |
  | 280 |  | "type" => "oldest", |
  |  | 278 | "order"   => "asc", |
  |  | 279 | "class"   => "wpdiscuz-date-sort-asc", |
  |  | 280 | "text"    => $wpdiscuz->options->getPhrase("wc\_oldest"), |
  |  | 281 | "type"    => "oldest", |
  | 281 | 282 | ], |
  | 282 | 283 | ]; |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L284) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L285) |  |
  | 284 | 285 | $sortingButtons[] = [ |
  | 285 | 286 | "orderBy" => "by\_vote", |
  | 286 |  | "order" => $wpdiscuz->options->wp["commentOrder"], |
  | 287 |  | "class" => "wpdiscuz-vote-sort-up", |
  | 288 |  | "text" => $wpdiscuz->options->getPhrase("wc\_most\_voted"), |
  | 289 |  | "type" => "by\_vote", |
  |  | 287 | "order"   => $wpdiscuz->options->wp["commentOrder"], |
  |  | 288 | "class"   => "wpdiscuz-vote-sort-up", |
  |  | 289 | "text"    => $wpdiscuz->options->getPhrase("wc\_most\_voted"), |
  |  | 290 | "type"    => "by\_vote", |
  | 290 | 291 | ]; |
  | 291 | 292 | } |
  | 292 | 293 | $sortingButtons = apply\_filters("wpdiscuz\_sorting\_buttons\_array", $sortingButtons); |
  | 293 | 294 | ?> |
  | 294 |  | <div class="wpd-filter wpdf-sorting"> |
  |  | 295 | <div class="wpd-filter wpdf-sorting <?php echo esc\_attr($filtersVisibilityClass); ?>"> |
  | 295 | 296 | <?php |
  | 296 | 297 | foreach ($sortingButtons as $key => $value) { |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L332) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L333) |  |
  | 332 | 333 | <?php |
  | 333 | 334 | if ($wpdiscuz->options->wp["isPaginate"] || !$wpdiscuz->options->thread\_display["firstLoadWithAjax"]) { |
  | 334 |  | $args = [ |
  |  | 335 | $args        = [ |
  | 335 | 336 | "first\_load" => 1, |
  | 336 |  | "orderby" => $wpdiscuzCommentsOrderBy, |
  | 337 |  | "order" => $wpdiscuzCommentsOrder |
  |  | 337 | "orderby"    => $wpdiscuzCommentsOrderBy, |
  |  | 338 | "order"      => $wpdiscuzCommentsOrder |
  | 338 | 339 | ]; |
  | 339 | 340 | $commentData = $wpdiscuz->getWPComments($args); |
  | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3018355#L376) | […](/browser/wpdiscuz/trunk/themes/default/comment-form.php?rev=3124810#L377) |  |
  | 376 | 377 | <?php |
  | 377 | 378 | if (apply\_filters("wpdiscuz\_show\_comments\_left", false) && !empty($commentData["comments\_left"])) { |
  | 378 |  | $commentsLeft = $commentData["comments\_left"]; |
  |  | 379 | $commentsLeft     = $commentData["comments\_left"]; |
  | 379 | 380 | $commentsLeftText = apply\_filters( |
  | 380 | 381 | "wpdiscuz\_comments\_left\_text", |
  | 381 | 382 | "({$commentsLeft})", |
  | 382 | 383 | [ |
  | 383 |  | "post" => $post, |
  | 384 |  | "user" => $currentUser, |
  |  | 384 | "post"          => $post, |
  |  | 385 | "user"          => $currentUser, |
  | 385 | 386 | "comments\_left" => $commentsLeft |
  | 386 | 387 | ] |
* ## [wpdiscuz/trunk/utils/class.WpdiscuzHelper.php](/changeset/3124810/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php "Show the changeset 3124810 restricted to wpdiscuz/trunk/utils/class.WpdiscuzHelper.php")

  | [r3083013](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L4 "Show revision 3083013 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L4 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | } |
  | 5 | 5 |  |
  | 6 |  | class WpdiscuzHelper implements WpDiscuzConstants { |
  |  | 6 | class WpdiscuzHelper implements WpDiscuzConstants |
  |  | 7 | { |
  | 7 | 8 |  |
  | 8 | 9 | private static $spoilerPattern = '@\[(\[?)(spoiler)(?![\w-])([^\]\/]\*(?:\/(?!\])[^\]\/]\*)\*?)(?:(\/)\]|\](?:([^\[]\*+(?:\[(?!\/\2\])[^\[]\*+)\*+)\[\/\2\])?)(\]?)@isu'; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L19) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L20) |  |
  | 19 | 20 | private $avatars; |
  | 20 | 21 |  |
  | 21 |  | public function \_\_construct($options, $dbManager, $wpdiscuzForm) { |
  |  | 22 | public function \_\_construct($options, $dbManager, $wpdiscuzForm) |
  |  | 23 | { |
  | 22 | 24 | $this->options = $options; |
  | 23 | 25 | $this->dbManager = $dbManager; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L63) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L65) |  |
  | 63 | 65 | add\_action("admin\_post\_disableAddonsDemo", [&$this, "disableAddonsDemo"]); |
  | 64 | 66 | $requestUri = !empty($\_SERVER["REQUEST\_URI"]) ? $\_SERVER["REQUEST\_URI"] : ""; |
  | 65 |  | if (!get\_option(self::OPTION\_SLUG\_DEACTIVATION) && (~~strpos($requestUri, "/plugins.php") !== false~~ )) { |
  |  | 67 | if (!get\_option(self::OPTION\_SLUG\_DEACTIVATION) && (strpos($requestUri, "/plugins.php") !== false)) { |
  | 66 | 68 | add\_action("admin\_footer", [&$this, "wpdDeactivationReasonModal"]); |
  | 67 | 69 | } |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L75) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L77) |  |
  | 75 | 77 | } |
  | 76 | 78 |  |
  | 77 |  | public function filterKses() { |
  |  | 79 | public function filterKses() |
  |  | 80 | { |
  | 78 | 81 | $allowedtags = []; |
  | 79 | 82 | $allowedtags["br"] = []; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L118) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L121) |  |
  | 118 | 121 | } |
  | 119 | 122 |  |
  | 120 |  | public function filterCommentText($commentContent) { |
  |  | 123 | public function filterCommentText($commentContent) |
  |  | 124 | { |
  | 121 | 125 | if (!current\_user\_can("unfiltered\_html")) { |
  | 122 | 126 | kses\_remove\_filters(); |
  | 123 |  | $commentContent = wp\_kses($commentContent, $this->filterKses()); |
  |  | 127 | if ($this->options->form["richEditor"] === "none" && $this->options->form["enableQuickTags"] === 0) { |
  |  | 128 | $allowedTags = []; |
  |  | 129 | } else { |
  |  | 130 | $allowedTags = $this->filterKses(); |
  |  | 131 | } |
  |  | 132 | $commentContent = wp\_kses($commentContent, $allowedTags); |
  | 124 | 133 | } |
  | 125 | 134 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L127) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L136) |  |
  | 127 | 136 | } |
  | 128 | 137 |  |
  | 129 |  | public function dateDiff($datetime) { |
  |  | 138 | public function dateDiff($datetime) |
  |  | 139 | { |
  | 130 | 140 | $text = ""; |
  | 131 | 141 | if ($datetime) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L166) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L176) |  |
  | 166 | 176 |  |
  | 167 | 177 | //================== Nonce================================================== |
  | 168 |  | public function setNonceLife($lifetime, $action = - 1) { |
  |  | 178 | public function setNonceLife($lifetime, $action = -1) |
  |  | 179 | { |
  | 169 | 180 | if (isset($action) && $action === $this->generateNonceKey()) { |
  | 170 | 181 | return DAY\_IN\_SECONDS / 2; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L174) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L185) |  |
  | 174 | 185 | } |
  | 175 | 186 |  |
  | 176 |  | public function generateNonceKey() { |
  | 177 |  | return ( $key = get\_home\_url() ) ? md5($key) : self::GLOBAL\_NONCE\_NAME; |
  | 178 |  | } |
  | 179 |  |  |
  | 180 |  | public function generateNonce() { |
  |  | 187 | public function generateNonceKey() |
  |  | 188 | { |
  |  | 189 | return ($key = get\_home\_url()) ? md5($key) : self::GLOBAL\_NONCE\_NAME; |
  |  | 190 | } |
  |  | 191 |  |
  |  | 192 | public function generateNonce() |
  |  | 193 | { |
  | 181 | 194 | return wp\_create\_nonce($this->generateNonceKey()); |
  | 182 | 195 | } |
  | 183 | 196 |  |
  | 184 |  | public function validateNonce() { |
  |  | 197 | public function validateNonce() |
  |  | 198 | { |
  | 185 | 199 | if (is\_user\_logged\_in() || apply\_filters('wpdiscuz\_validate\_nonce\_for\_guests', false)) { |
  | 186 | 200 | $nonce = !empty($\_COOKIE[self::GLOBAL\_NONCE\_NAME . '\_' . COOKIEHASH]) ? sanitize\_text\_field($\_COOKIE[self::GLOBAL\_NONCE\_NAME . '\_' . COOKIEHASH]) : ""; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L195) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L209) |  |
  | 195 | 209 | } |
  | 196 | 210 |  |
  | 197 |  | public function setNonceInCookies($timeDependent = 2, $checkNonce = true) { |
  |  | 211 | public function setNonceInCookies($timeDependent = 2, $checkNonce = true) |
  |  | 212 | { |
  | 198 | 213 | if (headers\_sent()) { |
  | 199 | 214 | return; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L233) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L248) |  |
  | 233 | 248 | //========================================================================== |
  | 234 | 249 |  |
  | 235 |  | public function getNumber($number) { |
  |  | 250 | public function getNumber($number) |
  |  | 251 | { |
  | 236 | 252 | if ($this->options->general["humanReadableNumbers"]) { |
  | 237 | 253 | if (absint($number) >= 1000000) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L245) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L261) |  |
  | 245 | 261 | } |
  | 246 | 262 |  |
  | 247 |  | public function makeClickable($ret) { |
  |  | 263 | public function makeClickable($ret) |
  |  | 264 | { |
  | 248 | 265 | $ret = " " . $ret; |
  | 249 | 266 | $hook = "?"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L254) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L271) |  |
  | 254 | 271 | &$this, |
  | 255 | 272 | "replaceUrlToImg" |
  | 256 |  | ], $ret); |
  |  | 273 | ], $ret); |
  | 257 | 274 | // this one is not in an array because we need it to run last, for cleanup of accidental links within links |
  | 258 | 275 | $ret = preg\_replace("#(<a( [^>]+?>|>))<a [^>]+?>([^>]+?)</a></a>#i", "$1$3</a>", $ret); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L262) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L279) |  |
  | 262 | 279 | } |
  | 263 | 280 |  |
  | 264 |  | public function replaceUrlToImg($matches) { |
  |  | 281 | public function replaceUrlToImg($matches) |
  |  | 282 | { |
  | 265 | 283 | $url = $matches[1]; |
  | 266 | 284 | if (is\_ssl() && $this->options->general["commentLinkFilter"] == 2 && strpos($matches[1], "https://") === false) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L282) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L300) |  |
  | 282 | 300 | \* @return type |
  | 283 | 301 | \*/ |
  | 284 |  | public static function isPostedToday($comment) { |
  |  | 302 | public static function isPostedToday($comment) |
  |  | 303 | { |
  | 285 | 304 | if (is\_object($comment)) { |
  | 286 | 305 | return date("Ymd", strtotime(current\_time("Ymd"))) <= date("Ymd", strtotime($comment->comment\_date)); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L290) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L309) |  |
  | 290 | 309 | } |
  | 291 | 310 |  |
  | 292 |  | public static function getMicrotime() { |
  | 293 |  | list( $pfx\_usec, $pfx\_sec ) = explode(" ", microtime()); |
  | 294 |  |  |
  | 295 |  | return ( (float) $pfx\_usec + (float) $pfx\_sec ); |
  |  | 311 | public static function getMicrotime() |
  |  | 312 | { |
  |  | 313 | list($pfx\_usec, $pfx\_sec) = explode(" ", microtime()); |
  |  | 314 |  |
  |  | 315 | return ((float)$pfx\_usec + (float)$pfx\_sec); |
  | 296 | 316 | } |
  | 297 | 317 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L300) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L320) |  |
  | 300 | 320 | \* return boolean |
  | 301 | 321 | \*/ |
  | 302 |  | public function isCommentEditable($comment) { |
  |  | 322 | public function isCommentEditable($comment) |
  |  | 323 | { |
  | 303 | 324 | if (!$comment) { |
  | 304 | 325 | return false; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L308) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L329) |  |
  | 308 | 329 | $editableTimeLimit = $this->options->moderation["commentEditableTime"] === "unlimit" ? abs($timeDiff) + 100 : intval($this->options->moderation["commentEditableTime"]); |
  | 309 | 330 |  |
  | 310 |  | return apply\_filters("wpdiscuz\_is\_comment\_editable", $editableTimeLimit && (~~$timeDiff < $editableTimeLimit~~ ), $comment); |
  |  | 331 | return apply\_filters("wpdiscuz\_is\_comment\_editable", $editableTimeLimit && ($timeDiff < $editableTimeLimit), $comment); |
  | 311 | 332 | } |
  | 312 | 333 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L314) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L335) |  |
  | 314 | 335 | \* checks if the current comment content is in min/max range defined in options |
  | 315 | 336 | \*/ |
  | 316 |  | public function isContentInRange($commentContent, $isReply) { |
  |  | 337 | public function isContentInRange($commentContent, $isReply) |
  |  | 338 | { |
  | 317 | 339 | if ($isReply) { |
  | 318 | 340 | $commentMinLength = intval($this->options->content["replyTextMinLength"]); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L325) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L347) |  |
  | 325 | 347 | $contentLength = function\_exists("mb\_strlen") ? mb\_strlen($commentContent) : strlen($commentContent); |
  | 326 | 348 |  |
  | 327 |  | return (~~$contentLength >= $commentMinLength ) && ( $commentMaxLength == 0 || $contentLength <= $commentMaxLength~~ ); |
  |  | 349 | return ($contentLength >= $commentMinLength) && ($commentMaxLength == 0 || $contentLength <= $commentMaxLength); |
  | 328 | 350 | } |
  | 329 | 351 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L331) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L353) |  |
  | 331 | 353 | \* return client real ip |
  | 332 | 354 | \*/ |
  | 333 |  | public static function getRealIPAddr() { |
  |  | 355 | public static function getRealIPAddr() |
  |  | 356 | { |
  | 334 | 357 | $ip = $\_SERVER["REMOTE\_ADDR"]; |
  | 335 | 358 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L343) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L366) |  |
  | 343 | 366 | } |
  | 344 | 367 |  |
  | 345 |  | public function getUIDData($uid) { |
  |  | 368 | public function getUIDData($uid) |
  |  | 369 | { |
  | 346 | 370 | $id\_strings = explode("\_", $uid); |
  | 347 | 371 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L349) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L373) |  |
  | 349 | 373 | } |
  | 350 | 374 |  |
  | 351 |  | public function superSocializerFix() { |
  |  | 375 | public function superSocializerFix() |
  |  | 376 | { |
  | 352 | 377 | $output = ""; |
  | 353 | 378 | if (function\_exists("the\_champ\_login\_button")) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L361) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L386) |  |
  | 361 | 386 | } |
  | 362 | 387 |  |
  | 363 |  | public static function getCommentExcerpt($commentContent, $uniqueId, $options) { |
  |  | 388 | public static function getCommentExcerpt($commentContent, $uniqueId, $options) |
  |  | 389 | { |
  | 364 | 390 | $readMoreLink = "<span id='wpdiscuz-readmore-" . esc\_attr($uniqueId) . "'><span class='wpdiscuz-hellip'>&hellip;&nbsp;</span><span class='wpdiscuz-readmore' title='" . esc\_attr($options->getPhrase("wc\_read\_more")) . "'>" . esc\_html($options->getPhrase("wc\_read\_more")) . "</span></span>"; |
  | 365 | 391 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L367) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L393) |  |
  | 367 | 393 | } |
  | 368 | 394 |  |
  | 369 |  | public static function strWordCount($content) { |
  | 370 |  | $words = preg\_split("/[\n\r\t ]+/", $content, - 1, PREG\_SPLIT\_NO\_EMPTY); |
  |  | 395 | public static function strWordCount($content) |
  |  | 396 | { |
  |  | 397 | $words = preg\_split("/[\n\r\t ]+/", $content, -1, PREG\_SPLIT\_NO\_EMPTY); |
  | 371 | 398 | $words = array\_filter($words, function ($w) { |
  | 372 | 399 | return $w !== "&nbsp;"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L376) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L403) |  |
  | 376 | 403 | } |
  | 377 | 404 |  |
  | 378 |  | public function isLoadWpdiscuz($post) { |
  | 379 |  | if (!$post || !is\_object($post) || ( is\_front\_page() && !$this->options->general["isEnableOnHome"] )) { |
  |  | 405 | public function isLoadWpdiscuz($post) |
  |  | 406 | { |
  |  | 407 | if (!$post || !is\_object($post) || (is\_front\_page() && !$this->options->general["isEnableOnHome"])) { |
  | 380 | 408 | return false; |
  | 381 | 409 | } |
  | 382 | 410 | $form = $this->wpdiscuzForm->getForm($post->ID); |
  | 383 | 411 |  |
  | 384 |  | return apply\_filters("is\_load\_wpdiscuz", $form->getFormID() && ( comments\_open($post) || $post->comment\_count ) && is\_singular() && post\_type\_supports($post->post\_type, "comments"), $post); |
  | 385 |  | } |
  | 386 |  |  |
  | 387 |  | public function replaceCommentContentCode($content) { |
  |  | 412 | return apply\_filters("is\_load\_wpdiscuz", $form->getFormID() && (comments\_open($post) || $post->comment\_count) && is\_singular() && post\_type\_supports($post->post\_type, "comments"), $post); |
  |  | 413 | } |
  |  | 414 |  |
  |  | 415 | public function replaceCommentContentCode($content) |
  |  | 416 | { |
  | 388 | 417 | if (is\_ssl()) { |
  | 389 | 418 | $content = preg\_replace\_callback("#<\s\*?img[^>]\*src\*=\*[\"\']?([^\"\']\*)[^>]+>#is", [ |
  | 390 | 419 | &$this, |
  | 391 | 420 | "replaceImageToURL" |
  | 392 |  | ], $content); |
  |  | 421 | ], $content); |
  | 393 | 422 | } |
  | 394 | 423 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L396) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L425) |  |
  | 396 | 425 | } |
  | 397 | 426 |  |
  | 398 |  | private function replaceImageToURL($matches) { |
  |  | 427 | private function replaceImageToURL($matches) |
  |  | 428 | { |
  | 399 | 429 | if (strpos($matches[1], "https://") === false && $this->options->general["commentLinkFilter"] == 1) { |
  | 400 | 430 | return "\r\n" . $matches[1] . "\r\n"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L406) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L436) |  |
  | 406 | 436 | } |
  | 407 | 437 |  |
  | 408 |  | private function replaceCodeContent($matches) { |
  |  | 438 | private function replaceCodeContent($matches) |
  |  | 439 | { |
  | 409 | 440 | $codeContent = trim($matches[1]); |
  | 410 | 441 | $codeContent = str\_replace(["<", ">"], ["&lt;", "&gt;"], $codeContent); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L413) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L444) |  |
  | 413 | 444 | } |
  | 414 | 445 |  |
  | 415 |  | public function spoiler($content) { |
  |  | 446 | public function spoiler($content) |
  |  | 447 | { |
  | 416 | 448 | return preg\_replace\_callback(self::$spoilerPattern, [$this, "\_spoiler"], $content); |
  | 417 | 449 | } |
  | 418 | 450 |  |
  | 419 |  | private function \_spoiler($matches) { |
  |  | 451 | private function \_spoiler($matches) |
  |  | 452 | { |
  | 420 | 453 | $html = "<div class='wpdiscuz-spoiler-wrap'>"; |
  | 421 | 454 | $title = esc\_html($this->options->getPhrase("wc\_spoiler")); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L432) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L465) |  |
  | 432 | 465 | } |
  | 433 | 466 |  |
  | 434 |  | public function getCurrentUserDisplayName($current\_user) { |
  |  | 467 | public function getCurrentUserDisplayName($current\_user) |
  |  | 468 | { |
  | 435 | 469 | $displayName = trim($current\_user->display\_name); |
  | 436 | 470 | if (!$displayName) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L442) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L476) |  |
  | 442 | 476 | } |
  | 443 | 477 |  |
  | 444 |  | public function enqueueWpDiscuzStyle($slug, $fileName, $version, $form) { |
  |  | 478 | public function enqueueWpDiscuzStyle($slug, $fileName, $version, $form) |
  |  | 479 | { |
  | 445 | 480 | $themes = $form->getThemes(); |
  | 446 | 481 | $theme = $form->getTheme(); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L459) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L494) |  |
  | 459 | 494 | } |
  | 460 | 495 |  |
  | 461 |  | public function wpDiscuzSuperSocializerLogin($html, $theChampLoginOptions) { |
  |  | 496 | public function wpDiscuzSuperSocializerLogin($html, $theChampLoginOptions) |
  |  | 497 | { |
  | 462 | 498 | global $wp\_current\_filter; |
  | 463 | 499 | if (in\_array("comment\_form\_top", $wp\_current\_filter) && isset($theChampLoginOptions["providers"]) && is\_array($theChampLoginOptions["providers"]) && count($theChampLoginOptions["providers"]) > 0) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L493) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L529) |  |
  | 493 | 529 | } |
  | 494 | 530 |  |
  | 495 |  | public static function getCurrentUser() { |
  |  | 531 | public static function getCurrentUser() |
  |  | 532 | { |
  | 496 | 533 | if ($user\_ID = get\_current\_user\_id()) { |
  | 497 | 534 | $user = get\_userdata($user\_ID); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L503) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L540) |  |
  | 503 | 540 | } |
  | 504 | 541 |  |
  | 505 |  | public function userNicename($html, $comment, $user) { |
  |  | 542 | public function userNicename($html, $comment, $user) |
  |  | 543 | { |
  | 506 | 544 | if (apply\_filters("wpdiscuz\_show\_nicename", false) && $this->options->subscription["enableUserMentioning"] && isset($user->user\_nicename)) { |
  | 507 | 545 | $html .= "<span class='wpd-user-nicename' data-wpd-ismention='1' data-wpd-clipboard='" . esc\_attr($user->user\_nicename) . "'>(@" . esc\_html($user->user\_nicename) . ")</span>"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L511) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L549) |  |
  | 511 | 549 | } |
  | 512 | 550 |  |
  | 513 |  | public function canUserEditComment($comment, $currentUser, $commentListArgs = []) { |
  | 514 |  | if (!( $comment instanceof WP\_Comment )) { |
  |  | 551 | public function canUserEditComment($comment, $currentUser, $commentListArgs = []) |
  |  | 552 | { |
  |  | 553 | if (!($comment instanceof WP\_Comment)) { |
  | 515 | 554 | return false; |
  | 516 | 555 | } |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L521) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L560) |  |
  | 521 | 560 | } |
  | 522 | 561 |  |
  | 523 |  | return !(!$this->options->moderation["enableEditingWhenHaveReplies"] && $comment->get\_children(["post\_id" => $comment->comment\_post\_ID]) ) && ( ( $storedCookieEmail === $comment->comment\_author\_email && $\_SERVER["REMOTE\_ADDR"] === $comment->comment\_author\_IP ) || ( $currentUser && $currentUser->ID && $currentUser->ID == $comment->user\_id ) ); |
  | 524 |  | } |
  | 525 |  |  |
  | 526 |  | public function addCommentTypes($args) { |
  |  | 562 | return !(!$this->options->moderation["enableEditingWhenHaveReplies"] && $comment->get\_children(["post\_id" => $comment->comment\_post\_ID])) && (($storedCookieEmail === $comment->comment\_author\_email && $\_SERVER["REMOTE\_ADDR"] === $comment->comment\_author\_IP) || ($currentUser && $currentUser->ID && $currentUser->ID == $comment->user\_id)); |
  |  | 563 | } |
  |  | 564 |  |
  |  | 565 | public function addCommentTypes($args) |
  |  | 566 | { |
  | 527 | 567 | $args[self::WPDISCUZ\_STICKY\_COMMENT] = esc\_html\_\_("Sticky", "wpdiscuz"); |
  | 528 | 568 |  |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L530) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L570) |  |
  | 530 | 570 | } |
  | 531 | 571 |  |
  | 532 |  | public function commentRowStickAction($actions, $comment) { |
  |  | 572 | public function commentRowStickAction($actions, $comment) |
  |  | 573 | { |
  | 533 | 574 | if (!$comment->comment\_parent) { |
  | 534 | 575 | $stickText = $comment->comment\_type === self::WPDISCUZ\_STICKY\_COMMENT ? $this->options->getPhrase("wc\_unstick\_comment", ["comment" => $comment]) : $this->options->getPhrase("wc\_stick\_comment", ["comment" => $comment]); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L547) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L588) |  |
  | 547 | 588 | } |
  | 548 | 589 |  |
  | 549 |  | public function wpdDeactivationReasonModal() { |
  |  | 590 | public function wpdDeactivationReasonModal() |
  |  | 591 | { |
  | 550 | 592 | include\_once WPDISCUZ\_DIR\_PATH . "/utils/deactivation-reason-modal.php"; |
  | 551 | 593 | } |
  | 552 | 594 |  |
  | 553 |  | public function disableAddonsDemo() { |
  |  | 595 | public function disableAddonsDemo() |
  |  | 596 | { |
  | 554 | 597 | if (current\_user\_can("manage\_options") && isset($\_GET["\_wpnonce"]) && wp\_verify\_nonce($\_GET["\_wpnonce"], "disableAddonsDemo") && isset($\_GET["show"])) { |
  | 555 | 598 | update\_option(self::OPTION\_SLUG\_SHOW\_DEMO, intval($\_GET["show"])); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L558) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L601) |  |
  | 558 | 601 | } |
  | 559 | 602 |  |
  | 560 |  | public function getCommentDate($comment) { |
  |  | 603 | public function getCommentDate($comment) |
  |  | 604 | { |
  | 561 | 605 | if ($this->options->general["simpleCommentDate"]) { |
  | 562 | 606 | $dateFormat = $this->options->wp["dateFormat"]; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L574) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L618) |  |
  | 574 | 618 | } |
  | 575 | 619 |  |
  | 576 |  | public function getPostDate($post) { |
  |  | 620 | public function getPostDate($post) |
  |  | 621 | { |
  | 577 | 622 | if ($this->options->general["simpleCommentDate"]) { |
  | 578 | 623 | $dateFormat = $this->options->wp["dateFormat"]; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L590) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L635) |  |
  | 590 | 635 | } |
  | 591 | 636 |  |
  | 592 |  | public function getDate($comment) { |
  |  | 637 | public function getDate($comment) |
  |  | 638 | { |
  | 593 | 639 | if ($this->options->general["simpleCommentDate"]) { |
  | 594 | 640 | $dateFormat = $this->options->wp["dateFormat"]; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L606) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L652) |  |
  | 606 | 652 | } |
  | 607 | 653 |  |
  | 608 |  | private function isPostPostedToday($post) { |
  |  | 654 | private function isPostPostedToday($post) |
  |  | 655 | { |
  | 609 | 656 | return date("Ymd", strtotime(current\_time("Ymd"))) <= date("Ymd", strtotime($post->post\_date)); |
  | 610 | 657 | } |
  | 611 | 658 |  |
  | 612 |  | public function wpdGetInfo() { |
  |  | 659 | public function wpdGetInfo() |
  |  | 660 | { |
  | 613 | 661 | $this->validateNonce(); |
  | 614 | 662 | $response = ""; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L677) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L725) |  |
  | 677 | 725 | } |
  | 678 | 726 |  |
  | 679 |  | private function getDeleteAllCommentsButton($email) { |
  |  | 727 | private function getDeleteAllCommentsButton($email) |
  |  | 728 | { |
  | 680 | 729 | $html = ""; |
  | 681 | 730 | if (!is\_email($email)) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L695) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L744) |  |
  | 695 | 744 | } |
  | 696 | 745 |  |
  | 697 |  | private function getDeleteAllSubscriptionsButton($email) { |
  |  | 746 | private function getDeleteAllSubscriptionsButton($email) |
  |  | 747 | { |
  | 698 | 748 | $html = ""; |
  | 699 | 749 | if (!is\_email($email)) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L713) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L763) |  |
  | 713 | 763 | } |
  | 714 | 764 |  |
  | 715 |  | private function deleteCookiesButton($email, $cookieBtnClass) { |
  |  | 765 | private function deleteCookiesButton($email, $cookieBtnClass) |
  |  | 766 | { |
  | 716 | 767 | $html = ""; |
  | 717 | 768 | if (!is\_email($email)) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L728) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L779) |  |
  | 728 | 779 | } |
  | 729 | 780 |  |
  | 730 |  | private function getActivityTitleHtml() { |
  |  | 781 | private function getActivityTitleHtml() |
  |  | 782 | { |
  | 731 | 783 | ob\_start(); |
  | 732 | 784 | include\_once WPDISCUZ\_DIR\_PATH . "/utils/layouts/activity/title.php"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L735) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L787) |  |
  | 735 | 787 | } |
  | 736 | 788 |  |
  | 737 |  | private function getActivityContentHtml($currentUserId, $currentUserEmail, $isFirstTab) { |
  |  | 789 | private function getActivityContentHtml($currentUserId, $currentUserEmail, $isFirstTab) |
  |  | 790 | { |
  | 738 | 791 | $html = "<div id='wpd-content-item-1' class='wpd-content-item'>"; |
  | 739 | 792 | if ($isFirstTab) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L747) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L800) |  |
  | 747 | 800 | } |
  | 748 | 801 |  |
  | 749 |  | public function getActivityPage() { |
  |  | 802 | public function getActivityPage() |
  |  | 803 | { |
  | 750 | 804 | $this->validateNonce(); |
  | 751 | 805 | ob\_start(); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L755) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L809) |  |
  | 755 | 809 | } |
  | 756 | 810 |  |
  | 757 |  | private function getSubscriptionsTitleHtml() { |
  |  | 811 | private function getSubscriptionsTitleHtml() |
  |  | 812 | { |
  | 758 | 813 | //        $this->validateNonce(); |
  | 759 | 814 | ob\_start(); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L763) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L818) |  |
  | 763 | 818 | } |
  | 764 | 819 |  |
  | 765 |  | private function getSubscriptionsContentHtml($currentUserId, $currentUserEmail, $isFirstTab) { |
  |  | 820 | private function getSubscriptionsContentHtml($currentUserId, $currentUserEmail, $isFirstTab) |
  |  | 821 | { |
  | 766 | 822 | $html = "<div id='wpd-content-item-2' class='wpd-content-item'>"; |
  | 767 | 823 | if ($isFirstTab) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L775) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L831) |  |
  | 775 | 831 | } |
  | 776 | 832 |  |
  | 777 |  | public function getSubscriptionsPage() { |
  |  | 833 | public function getSubscriptionsPage() |
  |  | 834 | { |
  | 778 | 835 | $this->validateNonce(); |
  | 779 | 836 | ob\_start(); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L783) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L840) |  |
  | 783 | 840 | } |
  | 784 | 841 |  |
  | 785 |  | private function getFollowsTitleHtml() { |
  |  | 842 | private function getFollowsTitleHtml() |
  |  | 843 | { |
  | 786 | 844 | //        $this->validateNonce(); |
  | 787 | 845 | ob\_start(); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L791) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L849) |  |
  | 791 | 849 | } |
  | 792 | 850 |  |
  | 793 |  | private function getFollowsContentHtml($currentUserId, $currentUserEmail, $isFirstTab) { |
  |  | 851 | private function getFollowsContentHtml($currentUserId, $currentUserEmail, $isFirstTab) |
  |  | 852 | { |
  | 794 | 853 | $html = "<div id='wpd-content-item-3' class='wpd-content-item'>"; |
  | 795 | 854 | if ($isFirstTab) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L803) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L862) |  |
  | 803 | 862 | } |
  | 804 | 863 |  |
  | 805 |  | public function getFollowsPage() { |
  |  | 864 | public function getFollowsPage() |
  |  | 865 | { |
  | 806 | 866 | ob\_start(); |
  | 807 | 867 | include\_once WPDISCUZ\_DIR\_PATH . "/utils/layouts/follows/follows-page.php"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L810) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L870) |  |
  | 810 | 870 | } |
  | 811 | 871 |  |
  | 812 |  | public static function fixEmailFrom($domain) { |
  |  | 872 | public static function fixEmailFrom($domain) |
  |  | 873 | { |
  | 813 | 874 | $domain = strtolower($domain); |
  | 814 | 875 | if (substr($domain, 0, 4) === "www.") { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L823) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L884) |  |
  | 823 | 884 | } |
  | 824 | 885 |  |
  | 825 |  | public function fixLocalhostIp($ip) { |
  |  | 886 | public function fixLocalhostIp($ip) |
  |  | 887 | { |
  | 826 | 888 | if (trim($ip) === "::1") { |
  | 827 | 889 | $ip = "127.0.0.1"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L831) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L893) |  |
  | 831 | 893 | } |
  | 832 | 894 |  |
  | 833 |  | public function fixURLScheme($url) { |
  |  | 895 | public function fixURLScheme($url) |
  |  | 896 | { |
  | 834 | 897 | if (is\_ssl() && strpos($url, "http://") !== false) { |
  | 835 | 898 | $url = str\_replace("http://", "https://", $url); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L839) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L902) |  |
  | 839 | 902 | } |
  | 840 | 903 |  |
  | 841 |  | public function commentDataArr($data, $comment, $commentarr) { |
  |  | 904 | public function commentDataArr($data, $comment, $commentarr) |
  |  | 905 | { |
  | 842 | 906 | if (!empty($data["wpdiscuz\_comment\_update"])) { |
  | 843 | 907 | $data["comment\_date"] = $comment["comment\_date"]; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L848) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L912) |  |
  | 848 | 912 | } |
  | 849 | 913 |  |
  | 850 |  | public function getTwitterShareContent($comment\_content, $commentLink) { |
  |  | 914 | public function getTwitterShareContent($comment\_content, $commentLink) |
  |  | 915 | { |
  | 851 | 916 | $commentLinkLength = strlen($commentLink); |
  | 852 | 917 | $twitt\_content = ""; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L863) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L928) |  |
  | 863 | 928 | } |
  | 864 | 929 |  |
  | 865 |  | public function getWhatsappShareContent($comment\_content, $commentLink) { |
  |  | 930 | public function getWhatsappShareContent($comment\_content, $commentLink) |
  |  | 931 | { |
  | 866 | 932 | $whatsapp\_content = esc\_attr(strip\_tags($comment\_content)); |
  | 867 | 933 | $length = strlen($whatsapp\_content); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L875) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L941) |  |
  | 875 | 941 | } |
  | 876 | 942 |  |
  | 877 |  | public function preGetDefaultAvatarForUser($avatar, $idOrEmail, $args) { |
  |  | 943 | public function preGetDefaultAvatarForUser($avatar, $idOrEmail, $args) |
  |  | 944 | { |
  | 878 | 945 | if ($this->options->thread\_layouts["changeAvatarsEverywhere"] || isset($args["wpdiscuz\_gravatar\_user\_email"])) { |
  | 879 | 946 | $nameAndEmail = $this->getUserNameAndEmail($idOrEmail); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L889) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L956) |  |
  | 889 | 956 | } |
  | 890 | 957 | if (!$valid) { |
  | 891 |  | $class = ["avatar", "avatar-" . (int)$args["size"], "photo"]; |
  |  | 958 | $class = ["avatar", "avatar-" . (int)$args["size"], "photo"]; |
  | 892 | 959 | if ($args["class"]) { |
  | 893 | 960 | if (is\_array($args["class"])) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L899) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L966) |  |
  | 899 | 966 | $url = $this->options->thread\_layouts["defaultAvatarUrlForUser"]; |
  | 900 | 967 | $url2x = $url; |
  | 901 |  | $avatar = sprintf("<img alt='%s' src='%s' srcset='%s' class='%s' height='%d' width='%d' %s/>", esc\_attr($args["alt"]), esc\_url\_raw($url), esc\_attr("$url2x 2x"), esc\_attr(implode(" ", $class)), esc\_attr((int)~~$args["height"]), esc\_attr((int)~~ $args["width"]), $args["extra\_attr"]); |
  |  | 968 | $avatar = sprintf("<img alt='%s' src='%s' srcset='%s' class='%s' height='%d' width='%d' %s/>", esc\_attr($args["alt"]), esc\_url\_raw($url), esc\_attr("$url2x 2x"), esc\_attr(implode(" ", $class)), esc\_attr((int)$args["height"]), esc\_attr((int)$args["width"]), $args["extra\_attr"]); |
  | 902 | 969 | } |
  | 903 | 970 | } |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L907) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L974) |  |
  | 907 | 974 | } |
  | 908 | 975 |  |
  | 909 |  | public function preGetDefaultAvatarForGuest($avatar, $idOrEmail, $args) { |
  |  | 976 | public function preGetDefaultAvatarForGuest($avatar, $idOrEmail, $args) |
  |  | 977 | { |
  | 910 | 978 | if ($this->options->thread\_layouts["changeAvatarsEverywhere"] || isset($args["wpdiscuz\_gravatar\_user\_email"])) { |
  | 911 | 979 | $nameAndEmail = $this->getUserNameAndEmail($idOrEmail); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L921) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L989) |  |
  | 921 | 989 | } |
  | 922 | 990 | if (!$valid) { |
  | 923 |  | $class = ["avatar", "avatar-" . (int)$args["size"], "photo"]; |
  |  | 991 | $class = ["avatar", "avatar-" . (int)$args["size"], "photo"]; |
  | 924 | 992 | if ($args["class"]) { |
  | 925 | 993 | if (is\_array($args["class"])) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L931) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L999) |  |
  | 931 | 999 | $url = $this->options->thread\_layouts["defaultAvatarUrlForGuest"]; |
  | 932 | 1000 | $url2x = $url; |
  | 933 |  | $avatar = sprintf("<img alt='%s' src='%s' srcset='%s' class='%s' height='%d' width='%d' %s/>", esc\_attr($args["alt"]), esc\_url\_raw($url), esc\_attr("$url2x 2x"), esc\_attr(implode(" ", $class)), esc\_attr((int)~~$args["height"]), esc\_attr((int)~~ $args["width"]), $args["extra\_attr"]); |
  |  | 1001 | $avatar = sprintf("<img alt='%s' src='%s' srcset='%s' class='%s' height='%d' width='%d' %s/>", esc\_attr($args["alt"]), esc\_url\_raw($url), esc\_attr("$url2x 2x"), esc\_attr(implode(" ", $class)), esc\_attr((int)$args["height"]), esc\_attr((int)$args["width"]), $args["extra\_attr"]); |
  | 934 | 1002 | } |
  | 935 | 1003 | } |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L939) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1007) |  |
  | 939 | 1007 | } |
  | 940 | 1008 |  |
  | 941 |  | private function isValidAvatar($email) { |
  |  | 1009 | private function isValidAvatar($email) |
  |  | 1010 | { |
  | 942 | 1011 | $url = "https://www.gravatar.com/avatar/" . md5($email) . "?d=404"; |
  | 943 | 1012 | $headers = wp\_remote\_head($url); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L946) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1015) |  |
  | 946 | 1015 | } |
  | 947 | 1016 |  |
  | 948 |  | private function getUserNameAndEmail($idOrEmail) { |
  |  | 1017 | private function getUserNameAndEmail($idOrEmail) |
  |  | 1018 | { |
  | 949 | 1019 | $nameAndEmail = ["name" => "guest", "email" => "unknown@example.com", "isUser" => 0]; |
  | 950 | 1020 | if (is\_object($idOrEmail)) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L973) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1043) |  |
  | 973 | 1043 | } |
  | 974 | 1044 |  |
  | 975 |  | public function userMentioning($content, $comment, $args = []) { |
  | 976 |  | if (apply\_filters("wpdiscuz\_enable\_user\_mentioning", true) && !empty($args["is\_wpdiscuz\_comment"]) && ( $users = $this->getMentionedUsers($content) )) { |
  |  | 1045 | public function userMentioning($content, $comment, $args = []) |
  |  | 1046 | { |
  |  | 1047 | if (apply\_filters("wpdiscuz\_enable\_user\_mentioning", true) && !empty($args["is\_wpdiscuz\_comment"]) && ($users = $this->getMentionedUsers($content))) { |
  | 977 | 1048 | foreach ($users as $k => $user) { |
  | 978 | 1049 | if ($this->options->login["enableProfileURLs"]) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1003) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1074) |  |
  | 1003 | 1074 | } |
  | 1004 | 1075 |  |
  | 1005 |  | public function doShortcode($content, $comment, $args = []) { |
  |  | 1076 | public function doShortcode($content, $comment, $args = []) |
  |  | 1077 | { |
  | 1006 | 1078 | if (!empty($args["is\_wpdiscuz\_comment"])) { |
  | 1007 | 1079 | return do\_shortcode($content); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1011) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1083) |  |
  | 1011 | 1083 | } |
  | 1012 | 1084 |  |
  | 1013 |  | public function getMentionedUsers($content) { |
  |  | 1085 | public function getMentionedUsers($content) |
  |  | 1086 | { |
  | 1014 | 1087 | $users = []; |
  | 1015 | 1088 | if (preg\_match\_all("/(@[^\s\,\@\.\!\?\#\$\%\:\;\'\"\`\~\)\(\}\{\|\\\[\]]\*)/is", $content, $nicenames)) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1031) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1104) |  |
  | 1031 | 1104 | } |
  | 1032 | 1105 |  |
  | 1033 |  | public function checkFeedbackShortcodes($post\_ID, $post\_after, $post\_before) { |
  | 1034 |  | if (comments\_open($post\_ID) && ( $form = $this->wpdiscuzForm->getForm($post\_ID) ) && $form->getFormID()) { |
  |  | 1106 | public function checkFeedbackShortcodes($post\_ID, $post\_after, $post\_before) |
  |  | 1107 | { |
  |  | 1108 | if (comments\_open($post\_ID) && ($form = $this->wpdiscuzForm->getForm($post\_ID)) && $form->getFormID()) { |
  | 1035 | 1109 | preg\_match\_all(self::$inlineFormPattern, $post\_before->post\_content, $matchesBefore, PREG\_SET\_ORDER); |
  | 1036 | 1110 | if ($post\_after->post\_content) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1052) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1126) |  |
  | 1052 | 1126 | } |
  | 1053 | 1127 | $atts = array\_merge($defaultAtts, $atts); |
  | 1054 |  | if ((~~$atts["id"] = trim($atts["id"]) ) && ( $atts["question"] = strip\_tags($atts["question"])~~ )) { |
  |  | 1128 | if (($atts["id"] = trim($atts["id"])) && ($atts["question"] = strip\_tags($atts["question"]))) { |
  | 1055 | 1129 | $inlineFormsBefore[$atts["id"]] = [ |
  | 1056 | 1130 | "question" => $atts["question"], |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1075) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1149) |  |
  | 1075 | 1149 | $atts["content"] = $matchAfter[5]; |
  | 1076 | 1150 | $atts = array\_merge($defaultAtts, $atts); |
  | 1077 |  | if ((~~$atts["id"] = trim($atts["id"]) ) && ( $atts["question"] = strip\_tags($atts["question"])~~ )) { |
  |  | 1151 | if (($atts["id"] = trim($atts["id"])) && ($atts["question"] = strip\_tags($atts["question"]))) { |
  | 1078 | 1152 | if (isset($inlineFormsBefore[$atts["id"]])) { |
  | 1079 | 1153 | if ($this->dbManager->getFeedbackFormByUid($post\_ID, $atts["id"])) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1099) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1173) |  |
  | 1099 | 1173 | } |
  | 1100 | 1174 |  |
  | 1101 |  | public function checkMetaFeedbackShortcodes($meta\_id, $post\_ID, $meta\_key, $meta\_value) { |
  | 1102 |  | if($meta\_key === '\_edit\_lock' || $meta\_key === '\_edit\_last'){ |
  |  | 1175 | public function checkMetaFeedbackShortcodes($meta\_id, $post\_ID, $meta\_key, $meta\_value) |
  |  | 1176 | { |
  |  | 1177 | if ($meta\_key === '\_edit\_lock' || $meta\_key === '\_edit\_last') { |
  | 1103 | 1178 | return; |
  | 1104 | 1179 | } |
  | 1105 |  | if (comments\_open($post\_ID) && (~~$form = $this->wpdiscuzForm->getForm($post\_ID)~~ ) && $form->getFormID()) { |
  |  | 1180 | if (comments\_open($post\_ID) && ($form = $this->wpdiscuzForm->getForm($post\_ID)) && $form->getFormID()) { |
  | 1106 | 1181 | $meta\_before = get\_post\_meta($post\_ID, $meta\_key, true); |
  | 1107 |  | if~~(!is\_string($meta\_before) || !is\_string($meta\_value))~~{ |
  |  | 1182 | if (!is\_string($meta\_before) || !is\_string($meta\_value)) { |
  | 1108 | 1183 | return; |
  | 1109 | 1184 | } |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1127) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1202) |  |
  | 1127 | 1202 | } |
  | 1128 | 1203 | $atts = array\_merge($defaultAtts, $atts); |
  | 1129 |  | if ((~~$atts["id"] = trim($atts["id"]) ) && ( $atts["question"] = strip\_tags($atts["question"])~~ )) { |
  |  | 1204 | if (($atts["id"] = trim($atts["id"])) && ($atts["question"] = strip\_tags($atts["question"]))) { |
  | 1130 | 1205 | $inlineFormsBefore[$atts["id"]] = [ |
  | 1131 | 1206 | "question" => $atts["question"], |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1150) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1225) |  |
  | 1150 | 1225 | $atts["content"] = $matchAfter[5]; |
  | 1151 | 1226 | $atts = array\_merge($defaultAtts, $atts); |
  | 1152 |  | if ((~~$atts["id"] = trim($atts["id"]) ) && ( $atts["question"] = strip\_tags($atts["question"])~~ )) { |
  |  | 1227 | if (($atts["id"] = trim($atts["id"])) && ($atts["question"] = strip\_tags($atts["question"]))) { |
  | 1153 | 1228 | if (isset($inlineFormsBefore[$atts["id"]])) { |
  | 1154 | 1229 | if ($this->dbManager->getFeedbackFormByUid($post\_ID, $atts["id"])) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1174) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1249) |  |
  | 1174 | 1249 | } |
  | 1175 | 1250 |  |
  | 1176 |  | public function getCommentFormPath($theme) { |
  |  | 1251 | public function getCommentFormPath($theme) |
  |  | 1252 | { |
  | 1177 | 1253 | if (file\_exists(get\_stylesheet\_directory() . "/wpdiscuz/comment-form.php")) { |
  | 1178 | 1254 | return get\_stylesheet\_directory() . "/wpdiscuz/comment-form.php"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1184) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1260) |  |
  | 1184 | 1260 | } |
  | 1185 | 1261 |  |
  | 1186 |  | public function getWalkerPath($theme) { |
  |  | 1262 | public function getWalkerPath($theme) |
  |  | 1263 | { |
  | 1187 | 1264 | if (file\_exists(get\_stylesheet\_directory() . "/wpdiscuz/class.WpdiscuzWalker.php")) { |
  | 1188 | 1265 | return get\_stylesheet\_directory() . "/wpdiscuz/class.WpdiscuzWalker.php"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1194) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1271) |  |
  | 1194 | 1271 | } |
  | 1195 | 1272 |  |
  | 1196 |  | public function scanDir($path) { |
  |  | 1273 | public function scanDir($path) |
  |  | 1274 | { |
  | 1197 | 1275 | $scannedComponents = scandir($path); |
  | 1198 | 1276 | unset($scannedComponents[0]); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1208) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1286) |  |
  | 1208 | 1286 | } |
  | 1209 | 1287 |  |
  | 1210 |  | public function getComponents($theme, $layout) { |
  |  | 1288 | public function getComponents($theme, $layout) |
  |  | 1289 | { |
  | 1211 | 1290 | $wpdPath = $theme . "/layouts/{$layout}/"; |
  | 1212 | 1291 | $wpdComponents = $this->scanDir($wpdPath); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1225) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1304) |  |
  | 1225 | 1304 | } |
  | 1226 | 1305 |  |
  | 1227 |  | public function restrictCommentingPerUser($email, $comment\_parent, $postId) { |
  |  | 1306 | public function restrictCommentingPerUser($email, $comment\_parent, $postId) |
  |  | 1307 | { |
  | 1228 | 1308 | if ($this->options->moderation["restrictCommentingPerUser"] !== "disable") { |
  | 1229 | 1309 | $args = ["count" => true, "author\_email" => $email]; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1252) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1332) |  |
  | 1252 | 1332 | } |
  | 1253 | 1333 |  |
  | 1254 |  | public function isUnapprovedInTree($comments) { |
  |  | 1334 | public function isUnapprovedInTree($comments) |
  |  | 1335 | { |
  | 1255 | 1336 | foreach ($comments as $comment) { |
  | 1256 | 1337 | if ($comment->comment\_approved === "0") { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1265) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1346) |  |
  | 1265 | 1346 | } |
  | 1266 | 1347 |  |
  | 1267 |  | public function getCommentAuthor($comment, $args) { |
  |  | 1348 | public function getCommentAuthor($comment, $args) |
  |  | 1349 | { |
  | 1268 | 1350 | $user = ["user" => ""]; |
  | 1269 | 1351 | if ($comment->user\_id) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1272) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1354) |  |
  | 1272 | 1354 | $user["user"] = get\_user\_by("email", $comment->comment\_author\_email); |
  | 1273 | 1355 | } |
  | 1274 |  | $user["commentAuthorUrl"] = (~~"http://" === $comment->comment\_author\_url~~ ) ? "" : $comment->comment\_author\_url; |
  |  | 1356 | $user["commentAuthorUrl"] = ("http://" === $comment->comment\_author\_url) ? "" : $comment->comment\_author\_url; |
  | 1275 | 1357 | $user["commentAuthorUrl"] = apply\_filters("get\_comment\_author\_url", $user["commentAuthorUrl"], $comment->comment\_ID, $comment); |
  | 1276 | 1358 | $user["commentWrapClass"] = []; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1282) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1364) |  |
  | 1282 | 1364 | $user["profileUrl"] = in\_array($user["user"]->ID, $args["posts\_authors"]) ? get\_author\_posts\_url($user["user"]->ID) : ""; |
  | 1283 | 1365 | $user["profileUrl"] = $this->getProfileUrl($user["profileUrl"], $user["user"]); |
  | 1284 |  | if ($this->options->social["displayIconOnAvatar"] && (~~$socialProvider = get\_user\_meta($user["user"]->ID, self::WPDISCUZ\_SOCIAL\_PROVIDER\_KEY, true)~~ )) { |
  |  | 1366 | if ($this->options->social["displayIconOnAvatar"] && ($socialProvider = get\_user\_meta($user["user"]->ID, self::WPDISCUZ\_SOCIAL\_PROVIDER\_KEY, true))) { |
  | 1285 | 1367 | $user["commentWrapClass"][] = "wpd-soc-user-" . $socialProvider; |
  | 1286 | 1368 | if ($socialProvider === "facebook") { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1329) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1411) |  |
  | 1329 | 1411 | "target" => "\_blank", |
  | 1330 | 1412 | "rel" => "noreferrer ugc" |
  | 1331 |  | ]); |
  |  | 1413 | ]); |
  | 1332 | 1414 | if ($attributes && is\_array($attributes)) { |
  | 1333 | 1415 | $attributesHtml = ""; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1340) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1422) |  |
  | 1340 | 1422 | } |
  | 1341 | 1423 | } |
  | 1342 |  | if ((~~( $href = $user["commentAuthorUrl"] ) && $this->options->login["websiteAsProfileUrl"] ) || ( $href = $user["profileUrl"]~~ )) { |
  |  | 1424 | if ((($href = $user["commentAuthorUrl"]) && $this->options->login["websiteAsProfileUrl"]) || ($href = $user["profileUrl"])) { |
  | 1343 | 1425 | $rel = "noreferrer ugc"; |
  | 1344 | 1426 | if (strpos($href, $args["site\_url"]) !== 0) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1349) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1431) |  |
  | 1349 | 1431 | "rel" => $rel, |
  | 1350 | 1432 | "target" => "\_blank" |
  | 1351 |  | ]); |
  |  | 1433 | ]); |
  | 1352 | 1434 | if ($attributes && is\_array($attributes)) { |
  | 1353 | 1435 | $attributesHtml = ""; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1366) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1448) |  |
  | 1366 | 1448 | } |
  | 1367 | 1449 |  |
  | 1368 |  | public function fillUserRoleData(&$user, $args) { |
  |  | 1450 | public function fillUserRoleData(&$user, $args) |
  |  | 1451 | { |
  | 1369 | 1452 | $user["author\_title"] = ""; |
  | 1370 | 1453 | $user["commentWrapRoleClass"] = []; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1406) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1489) |  |
  | 1406 | 1489 | } |
  | 1407 | 1490 |  |
  | 1408 |  | public function getProfileUrl($profile\_url, $user) { |
  |  | 1491 | public function getProfileUrl($profile\_url, $user) |
  |  | 1492 | { |
  | 1409 | 1493 | if ($this->options->login["enableProfileURLs"] && $user) { |
  | 1410 | 1494 | if (class\_exists("BuddyPress")) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1421) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1505) |  |
  | 1421 | 1505 | } |
  | 1422 | 1506 |  |
  | 1423 |  | public function umAuthorName($author\_name, $comment) { |
  |  | 1507 | public function umAuthorName($author\_name, $comment) |
  |  | 1508 | { |
  | 1424 | 1509 | if ($comment->user\_id) { |
  | 1425 | 1510 | if (class\_exists("UM\_API") || class\_exists("UM")) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1433) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1518) |  |
  | 1433 | 1518 | } |
  | 1434 | 1519 |  |
  | 1435 |  | public function multipleBlockquotesToOne($content) { |
  |  | 1520 | public function multipleBlockquotesToOne($content) |
  |  | 1521 | { |
  | 1436 | 1522 | $content = preg\_replace('~<\/blockquote>\s?<blockquote>~is', '</p><p>', $content); |
  | 1437 | 1523 | $content = preg\_replace('~<\/code>\s?<code>~is', '</p><p>', $content); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1440) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1526) |  |
  | 1440 | 1526 | } |
  | 1441 | 1527 |  |
  | 1442 |  | public static function isUserCanFollowOrSubscribe($email) { |
  |  | 1528 | public static function isUserCanFollowOrSubscribe($email) |
  |  | 1529 | { |
  | 1443 | 1530 | return !in\_array(strstr($email, "@"), [ |
  | 1444 |  | "@facebook.com", |
  | 1445 |  | "@twitter.com", |
  | 1446 |  | "@ok.ru", |
  | 1447 |  | "@wechat.com", |
  | 1448 |  | "@qq.com", |
  | 1449 |  | "@weibo.com", |
  | 1450 |  | "@baidu.com", |
  | 1451 |  | "@example.com", |
  | 1452 |  | ]); |
  | 1453 |  | } |
  | 1454 |  |  |
  | 1455 |  | public function addRatingResetButton($postType, $post) { |
  |  | 1531 | "@facebook.com", |
  |  | 1532 | "@twitter.com", |
  |  | 1533 | "@ok.ru", |
  |  | 1534 | "@wechat.com", |
  |  | 1535 | "@qq.com", |
  |  | 1536 | "@weibo.com", |
  |  | 1537 | "@baidu.com", |
  |  | 1538 | "@example.com", |
  |  | 1539 | ]); |
  |  | 1540 | } |
  |  | 1541 |  |
  |  | 1542 | public function addRatingResetButton($postType, $post) |
  |  | 1543 | { |
  | 1456 | 1544 | if (!$post) { |
  | 1457 | 1545 | return; |
  | 1458 | 1546 | } |
  | 1459 | 1547 | $form = $this->wpdiscuzForm->getForm($post->ID); |
  | 1460 |  | if ($form->getFormID() && (~~$form->getEnableRateOnPost() || $form->getRatingsExists()~~ )) { |
  |  | 1548 | if ($form->getFormID() && ($form->getEnableRateOnPost() || $form->getRatingsExists())) { |
  | 1461 | 1549 | add\_meta\_box("wpd\_reset\_ratings", \_\_("Reset Ratings", "wpdiscuz"), [ |
  | 1462 | 1550 | &$this, |
  | 1463 | 1551 | "resetRatingsButtons" |
  | 1464 |  | ], $postType, "side", "low"); |
  | 1465 |  | } |
  | 1466 |  | } |
  | 1467 |  |  |
  | 1468 |  | public function resetRatingsButtons($post) { |
  |  | 1552 | ], $postType, "side", "low"); |
  |  | 1553 | } |
  |  | 1554 | } |
  |  | 1555 |  |
  |  | 1556 | public function resetRatingsButtons($post) |
  |  | 1557 | { |
  | 1469 | 1558 | $form = $this->wpdiscuzForm->getForm($post->ID); |
  | 1470 | 1559 | $ajax\_nonce = wp\_create\_nonce("wpd-reset-rating"); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1562) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1651) |  |
  | 1562 | 1651 | \* init wpdiscuz styles |
  | 1563 | 1652 | \*/ |
  | 1564 |  | public function initCustomCss() { |
  |  | 1653 | public function initCustomCss() |
  |  | 1654 | { |
  | 1565 | 1655 | ob\_start(); |
  | 1566 | 1656 | $left = is\_rtl() ? "right" : "left"; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1606) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1696) |  |
  | 1606 | 1696 | } |
  | 1607 | 1697 | ?> |
  | 1608 |  | <?php echo (~~$this->options->thread\_styles["commentTextSize"] !== "14px"~~ ) ? "#wpdcom .wpd-comment-text p{font-size:" . esc\_html($this->options->thread\_styles["commentTextSize"]) . ";}\r\n" : ""; ?> |
  |  | 1698 | <?php echo ($this->options->thread\_styles["commentTextSize"] !== "14px") ? "#wpdcom .wpd-comment-text p{font-size:" . esc\_html($this->options->thread\_styles["commentTextSize"]) . ";}\r\n" : ""; ?> |
  | 1609 | 1699 | <?php if ($dark) { ?> |
  | 1610 | 1700 | #comments, #respond, .comments-area, #wpdcom.wpd-dark{<?php echo esc\_html($darkCommentAreaBG . $darkCommentTextColor) ?>} |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1722) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1812) |  |
  | 1722 | 1812 | \* @return  string |
  | 1723 | 1813 | \*/ |
  | 1724 |  | public function colorBrightness($hexCode, $adjustPercent = 1) { |
  |  | 1814 | public function colorBrightness($hexCode, $adjustPercent = 1) |
  |  | 1815 | { |
  | 1725 | 1816 | if (!$hexCode) { |
  | 1726 | 1817 | return '#000'; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1741) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1832) |  |
  | 1741 | 1832 | } |
  | 1742 | 1833 |  |
  | 1743 |  | public static function sanitize($action, $variable\_name, $filter, $default = "") { |
  |  | 1834 | public static function sanitize($action, $variable\_name, $filter, $default = "") |
  |  | 1835 | { |
  | 1744 | 1836 | if ($filter === "FILTER\_SANITIZE\_STRING") { |
  | 1745 | 1837 | $glob = INPUT\_POST === $action ? $\_POST : $\_GET; |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1755) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1847) |  |
  | 1755 | 1847 | } |
  | 1756 | 1848 |  |
  | 1757 |  | public function handleCommentSubmission($post, $comment\_parent, $isNewComment = true) { |
  |  | 1849 | public function handleCommentSubmission($post, $comment\_parent, $isNewComment = true) |
  |  | 1850 | { |
  | 1758 | 1851 |  |
  | 1759 | 1852 | if (!$post) { |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1773) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1866) |  |
  | 1773 | 1866 | $comment\_parent\_object = get\_comment($comment\_parent); |
  | 1774 | 1867 | if ( |
  | 1775 |  | 0 !== $comment\_parent && |
  | 1776 |  | ( |
  |  | 1868 | 0 !== $comment\_parent && |
  |  | 1869 | ( |
  | 1777 | 1870 | !$comment\_parent\_object instanceof WP\_Comment || |
  | 1778 |  | 0 === (int)$comment\_parent\_object->comment\_approved |
  | 1779 |  | ) |
  |  | 1871 | 0 === (int)$comment\_parent\_object->comment\_approved |
  |  | 1872 | ) |
  | 1780 | 1873 | ) { |
  | 1781 | 1874 | do\_action("comment\_reply\_to\_unapproved\_comment", $comment\_post\_id, $comment\_parent); |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1795) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1888) |  |
  | 1795 | 1888 | $status = get\_post\_status($\_post); |
  | 1796 | 1889 |  |
  | 1797 |  | if ((~~"private" === $status~~ ) && !current\_user\_can("read\_post", $comment\_post\_id)) { |
  |  | 1890 | if (("private" === $status) && !current\_user\_can("read\_post", $comment\_post\_id)) { |
  | 1798 | 1891 | return new WP\_Error("comment\_id\_not\_found", \_\_("Current post doesn't found.", "wpdiscuz")); |
  | 1799 | 1892 | } |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3083013#L1835) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelper.php?rev=3124810#L1928) |  |
  | 1835 | 1928 | } |
  | 1836 | 1929 |  |
  | 1837 |  | public function updatePostAuthorsTrs($post\_id) { |
  |  | 1930 | public function updatePostAuthorsTrs($post\_id) |
  |  | 1931 | { |
  | 1838 | 1932 | set\_transient(self::TRS\_POSTS\_AUTHORS, null); |
  | 1839 | 1933 | $this->dbManager->getPostsAuthors(); |
  | 1840 | 1934 | } |
  | 1841 | 1935 |  |
  | 1842 |  | public static function getBPUserUrl($user\_id) { |
  |  | 1936 | public static function getBPUserUrl($user\_id) |
  |  | 1937 | { |
  | 1843 | 1938 | return function\_exists('bp\_members\_get\_user\_url') ? bp\_members\_get\_user\_url($user\_id) : bp\_core\_get\_user\_domain($user\_id); |
  | 1844 | 1939 | } |
* ## [wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php](/changeset/3124810/wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php "Show the changeset 3124810 restricted to wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php")

  | [r3113460](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php?rev=3113460#L920 "Show revision 3113460 of this file in browser") | [r3124810](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php?rev=3124810#L920 "Show revision 3124810 of this file in browser") |  |
  | --- | --- | --- |
  | 920 | 920 |  |
  | 921 | 921 | public function generateThumbnails() { |
  |  | 922 | if (!apply\_filters("wpdiscuz\_generate\_thumbnails\_check", true)) { |
  |  | 923 | wp\_clear\_scheduled\_hook(self::GENERATE\_THUMBNAILS\_ACTION); |
  |  | 924 | return; |
  |  | 925 | } |
  |  | 926 |  |
  | 922 | 927 | set\_time\_limit(-1); |
  | 923 | 928 | $attachments = get\_posts([ |
  | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php?rev=3113460#L949) | […](/browser/wpdiscuz/trunk/utils/class.WpdiscuzHelperUpload.php?rev=3124810#L954) |  |
  | 949 | 954 | foreach ($attachments as $attachId) { |
  | 950 | 955 | $fileName = get\_post\_meta($attachId, "\_wp\_attached\_file", true); |
  | 951 |  | if (!$fileName) { |
  |  | 956 | $is\_wpdiscuz\_attachment = (int)get\_post\_meta($attachId, '\_wmu\_comment\_id', true); |
  |  | 957 | if (!$fileName || !$is\_wpdiscuz\_attachment) { |
  | 952 | 958 | continue; |
  | 953 | 959 | } |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3124810)
* [Zip Archive](?format=zip&new=3124810)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


