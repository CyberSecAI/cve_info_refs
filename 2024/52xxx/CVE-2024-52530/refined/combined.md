=== Content from gitlab.gnome.org_a447175b_20250114_183641.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# headers: Strictly don't allow NUL bytes

Code

* Review changes
* Check out branch
* ---
* Download
* [Patches](/GNOME/libsoup/-/merge_requests/402.patch)
* [Plain diff](/GNOME/libsoup/-/merge_requests/402.diff)

[Patrick Griffis](/pgriffis) requested to merge [pgriffis/no-nul-headers](/GNOME/libsoup/-/tree/pgriffis/no-nul-headers "pgriffis/no-nul-headers")
 into [master](/GNOME/libsoup/-/tree/master "master") Jul 08, 2024

* [Overview
  1](/GNOME/libsoup/-/merge_requests/402)
* [Commits
  1](/GNOME/libsoup/-/merge_requests/402/commits)
* [Pipelines
  1](/GNOME/libsoup/-/merge_requests/402/pipelines)
* [Changes
  2](/GNOME/libsoup/-/merge_requests/402/diffs)

Expand

In the past (2015) this was allowed for some problematic sites. However Chromium also does not allow NUL bytes in either header names or values these days. So this should no longer be a problem.

## Merge request reports

Assignee
Loading

Reviewers
Loading

Request review fromRequest review fromLoading

Time tracking
Loading

Loading



=== Content from gitlab.gnome.org_42c93d38_20250114_183640.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

# (CVE-2024-52530) Request smuggling via stripping of null bytes from the ends of header names

When Libsoup parses HTTP headers, it ignores null bytes at the ends of header names. Thus, `Transfer-Encoding: chunked` is equivalent to `Transfer-Encoding\x00: chunked`. This allows for request smuggling when Libsoup is used in a service that's behind a reverse proxy that forwards null bytes without stripping them.

For example, a malicious client might send the following request to one such reverse proxy:

```
POST / HTTP/1.1\r\n
Host: whatever\r\n
Transfer-Encoding\x00: chunked\r\n
Content-Length: 32\r\n
\r\n
0\r\n\r\nGET / HTTP/1.1\r\nHost: a\r\n\r\n
```

The proxy would see one request, since it does not consider `Transfer-Encoding\x00` to be equivalent to `Transfer-Encoding`. When the proxy forwards the request, Libsoup will see two requests, because it will strip the null byte from the header, and `Transfer-Encoding` takes priority over `Content-Length`.

A reasonable fix would be to respond 400 to any request with a null byte in a header name.

Edited Nov 13, 2024 by [Michael Catanzaro](/mcatanzaro)

To upload designs, you'll need to enable LFS and have an admin enable hashed storage. [More information](/help/user/project/issues/design_management.md#prerequisites)

Assignee
Loading

Time tracking
Loading



=== Content from gitlab.gnome.org_e4e67b61_20250114_183641.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)

## Pages

2


