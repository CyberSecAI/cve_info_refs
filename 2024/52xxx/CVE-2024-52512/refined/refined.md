The provided content relates to CVE-2024-52512.

**Root Cause of Vulnerability:**
The vulnerability stems from the fact that the application was not properly sanitizing the redirect URL after login, potentially allowing it to redirect to an arbitrary external URL.

**Weaknesses/Vulnerabilities:**
- Improper handling of redirect URLs. The application did not validate or sanitize the redirect URL, allowing an attacker to supply an absolute URL including the protocol and hostname.

**Impact of Exploitation:**
- An attacker could potentially redirect users to a malicious website after a successful login to the application. This can lead to phishing attacks, where users could be tricked into entering their credentials on a fake login page, or other forms of malicious activity.

**Attack Vectors:**
- The attack vector is through the `redirectUrl` parameter in the login process. By providing a specially crafted URL as the redirect target, an attacker could redirect the user to an arbitrary malicious location after they have logged in.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to influence the `redirectUrl` parameter. This may be achieved by crafting a malicious link, or possibly exploiting another vulnerability which allows modifying it.
- The attacker does not need to be authenticated to exploit the vulnerability.

**Additional Notes:**
- The fix uses `parse_url($redirectUrl, PHP_URL_PATH)` to extract only the path part of the URL, effectively removing the protocol and host, thus preventing redirection to absolute URLs.
- The original code was vulnerable because it was directly using the provided `redirectUrl` parameter in the `RedirectResponse` object.