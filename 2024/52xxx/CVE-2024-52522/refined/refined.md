The provided content is related to CVE-2024-52522.

**Root cause of vulnerability:**
The vulnerability stems from the improper handling of symlinks when using the `--links` and `--metadata` options in `rclone` while copying data to a local backend. Instead of applying `chown` and `chmod` operations to the symlink itself, `rclone` incorrectly applies these operations to the target of the symlink.

**Weaknesses/vulnerabilities present:**
- Insecure handling of symlinks.
- Incorrect application of `chown` and `chmod` operations to symlink targets instead of the symlinks themselves.
- Failure to use link-safe syscall variants like `lchown` and `fchmodat` when using the `--links` and `--metadata` options (fixed in the patch).

**Impact of exploitation:**
- Unprivileged users can modify the ownership and permissions of sensitive system files by creating symlinks to them in directories that are subsequently copied by an administrator with `rclone --links --metadata`.
- This can lead to unauthorized access, privilege escalation, and potential system compromise. For instance, an attacker could gain ownership of `/etc/shadow`, potentially compromising the system.

**Attack vectors:**
- Local file system. An unprivileged user creates a symlink to a sensitive file within a directory.
- The attacker relies on a privileged user or process to copy/backup data using rclone with the vulnerable options.

**Required attacker capabilities/position:**
- The attacker needs the ability to create symlinks.
- The attacker needs a privileged user or process to execute `rclone` with the vulnerable parameters (`--links` and `--metadata`) to copy a directory structure containing the malicious symlink.