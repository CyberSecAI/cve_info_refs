Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from an insecure default configuration in the OAuth2 provider of the authentik application. When no redirect URIs are explicitly configured, the application automatically uses the first `redirect_uri` value it receives as an allowed redirect URI. Critically, it does not escape characters that have special meanings in regular expressions (regex). This results in a situation where a malicious actor can register a domain that is unintentionally considered valid due to the regex interpretation of the redirect URI.
- The documentation also failed to address this issue, leading to further confusion for users.

**Weaknesses/Vulnerabilities:**

- **Insecure Default Configuration:** The system automatically accepts the first redirect URI without proper sanitization or escaping.
- **Regex Misinterpretation:** The system treats provided URIs as regex patterns without proper escaping.
- **Lack of Input Validation:** The system doesn't validate and properly sanitize the redirect URIs.

**Impact of Exploitation:**

- An attacker can register a malicious domain that the application will treat as a valid redirect URI. This allows an attacker to potentially redirect users to a malicious site and steal authorization codes or tokens.
- The impact is rated as **High** with the following CVSSv4 metrics:
    - Exploitability Metrics:
        - Attack Vector: Network
        - Attack Complexity: Low
        - Attack Requirements: None
        - Privileges Required: None
        - User Interaction: None
    - Vulnerable System Impact Metrics:
        - Confidentiality: None
        - Integrity: None
        - Availability: None
    - Subsequent System Impact Metrics:
        - Confidentiality: High
        - Integrity: High
        - Availability: High

**Attack Vectors:**

- **Network-based:** The attacker can exploit this vulnerability remotely via the network.

**Required Attacker Capabilities/Position:**

- **No special privileges:** The attacker doesn't need any specific privileges or credentials on the vulnerable system.
- **Network access:** The attacker only needs network access to the vulnerable system.
- **No user interaction:** The attack does not require any user interaction beyond the typical OAuth2 flow.

**Additional Notes:**
- The fix for this vulnerability involves a backwards-incompatible database change and API change.
- Manual action is required after applying the patch if any provider was intended to use Regex for Redirect URIs.
- The patched versions of authentik (2024.8.5 and 2024.10.3) introduce explicit configuration to choose between strict URL checking or Regex matching.
- A workaround is to manually escape any wildcard characters in the redirect URIs, for example replacing '.' with '\.'.

**CWE:**
- The vulnerability is associated with **CWE-185** (Incorrect Regular Expression).