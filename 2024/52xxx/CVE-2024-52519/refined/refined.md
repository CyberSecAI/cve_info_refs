Based on the provided content, here's an analysis of CVE-2024-52519:

**Root Cause of Vulnerability:**

- The OAuth2 client secrets were stored in an encrypted format that was reversible. An attacker gaining access to the database and Nextcloud configuration file could decrypt these secrets.

**Weaknesses/Vulnerabilities Present:**

- **Insecure Storage of Sensitive Data:**  Instead of storing a hash of the secret, the application was storing the encrypted secret. This meant that with access to the encryption key, the secrets could be decrypted and recovered.

**Impact of Exploitation:**

- **Confidentiality Breach:** An attacker who obtains a database backup and the Nextcloud config file can decrypt stored OAuth2 client secrets.
- **Potential Further Attacks:** Recovered secrets could be used to impersonate applications using OAuth2 to access Nextcloud data.

**Attack Vectors:**

- **Physical Access to Backups:** The primary attack vector involves an attacker gaining access to backups of the Nextcloud database and the Nextcloud configuration files. This would require access to the server or storage medium.

**Required Attacker Capabilities/Position:**

- **Access to Database Backup:** The attacker must be able to access a backup of the Nextcloud database.
- **Access to Nextcloud Configuration:** The attacker must have access to the Nextcloud config file, which contains the encryption key needed for decryption.
- **High Privileges Required:** The attacker would likely need high privileges to access the database backups and configuration file on the server.
- **User Interaction Required:** The attack requires the user to generate the database backup.

**Additional Details from the Content:**

- **Mitigation:** The fix involves storing a hash of the client secret rather than encrypting it. This makes the secret non-recoverable, thus mitigating the vulnerability.
- **Affected Versions:** Nextcloud Server versions >= 28.0.0 and >= 29.0.0, and Nextcloud Enterprise Server versions >= 27.0.0, >= 28.0.0, and >= 29.0.0 were affected.
- **Patched Versions:** Patched versions are 28.0.10 and 29.0.7 for Nextcloud Server, and 27.1.11.8, 28.0.10, and 29.0.7 for Nextcloud Enterprise Server.
- **CVSS Score:** The vulnerability was given a CVSS v3 base score of 2.7, with vector string: CVSS:3.1/AV:P/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:N.
- **CWE:**  The vulnerability is associated with CWE-922 which refers to Insecure Storage of Sensitive Data.
- **Pull Request:** The fix was implemented in pull request #47635 on the Nextcloud server repository.

In summary, this vulnerability stems from storing OAuth2 client secrets in a reversibly encrypted way, which could lead to a confidentiality breach if an attacker gained access to the database backups and config file. The fix replaces this with hashing the secrets, making them non-recoverable.