- **Root cause of vulnerability**: The Pipeline: Declarative Plugin does not check if the main (Jenkinsfile) script used to restart a build from a specific stage is approved.
- **Weaknesses/vulnerabilities present**: Missing permission check.
- **Impact of exploitation**: Attackers with Item/Build permission can restart a previous build whose (Jenkinsfile) script is no longer approved, potentially leading to unauthorized code execution.
- **Attack vectors**: Network access.
- **Required attacker capabilities/position**: Attacker needs Item/Build permission. They need to be able to trigger the restart of a build.