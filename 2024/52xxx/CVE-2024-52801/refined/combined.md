=== Content from github.com_20734543_20250114_183455.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frs%2Fxid)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frs%2Fxid)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=rs%2Fxid)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[rs](/rs)
/
**[xid](/rs/xid)**
Public

* [Notifications](/login?return_to=%2Frs%2Fxid) You must be signed in to change notification settings
* [Fork
  206](/login?return_to=%2Frs%2Fxid)
* [Star
   4k](/login?return_to=%2Frs%2Fxid)

xid is a globally unique id generator thought for the web

### License

[MIT license](/rs/xid/blob/master/LICENSE)

[4k
stars](/rs/xid/stargazers) [206
forks](/rs/xid/forks) [Branches](/rs/xid/branches) [Tags](/rs/xid/tags) [Activity](/rs/xid/activity)
 [Star](/login?return_to=%2Frs%2Fxid)

 [Notifications](/login?return_to=%2Frs%2Fxid) You must be signed in to change notification settings

* [Code](/rs/xid)
* [Issues
  16](/rs/xid/issues)
* [Pull requests
  1](/rs/xid/pulls)
* [Actions](/rs/xid/actions)
* [Projects
  0](/rs/xid/projects)
* [Wiki](/rs/xid/wiki)
* [Security](/rs/xid/security)
* [Insights](/rs/xid/pulse)

Additional navigation options

* [Code](/rs/xid)
* [Issues](/rs/xid/issues)
* [Pull requests](/rs/xid/pulls)
* [Actions](/rs/xid/actions)
* [Projects](/rs/xid/projects)
* [Wiki](/rs/xid/wiki)
* [Security](/rs/xid/security)
* [Insights](/rs/xid/pulse)

# rs/xid

    master[Branches](/rs/xid/branches)[Tags](/rs/xid/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[84 Commits](/rs/xid/commits/master/) | | |
| [.github/workflows](/rs/xid/tree/master/.github/workflows "This path skips through empty directories") | | [.github/workflows](/rs/xid/tree/master/.github/workflows "This path skips through empty directories") |  |  |
| [b](/rs/xid/tree/master/b "b") | | [b](/rs/xid/tree/master/b "b") |  |  |
| [.appveyor.yml](/rs/xid/blob/master/.appveyor.yml ".appveyor.yml") | | [.appveyor.yml](/rs/xid/blob/master/.appveyor.yml ".appveyor.yml") |  |  |
| [.gitignore](/rs/xid/blob/master/.gitignore ".gitignore") | | [.gitignore](/rs/xid/blob/master/.gitignore ".gitignore") |  |  |
| [.golangci.yml](/rs/xid/blob/master/.golangci.yml ".golangci.yml") | | [.golangci.yml](/rs/xid/blob/master/.golangci.yml ".golangci.yml") |  |  |
| [.travis.yml](/rs/xid/blob/master/.travis.yml ".travis.yml") | | [.travis.yml](/rs/xid/blob/master/.travis.yml ".travis.yml") |  |  |
| [LICENSE](/rs/xid/blob/master/LICENSE "LICENSE") | | [LICENSE](/rs/xid/blob/master/LICENSE "LICENSE") |  |  |
| [README.md](/rs/xid/blob/master/README.md "README.md") | | [README.md](/rs/xid/blob/master/README.md "README.md") |  |  |
| [error.go](/rs/xid/blob/master/error.go "error.go") | | [error.go](/rs/xid/blob/master/error.go "error.go") |  |  |
| [go.mod](/rs/xid/blob/master/go.mod "go.mod") | | [go.mod](/rs/xid/blob/master/go.mod "go.mod") |  |  |
| [hostid\_darwin.go](/rs/xid/blob/master/hostid_darwin.go "hostid_darwin.go") | | [hostid\_darwin.go](/rs/xid/blob/master/hostid_darwin.go "hostid_darwin.go") |  |  |
| [hostid\_fallback.go](/rs/xid/blob/master/hostid_fallback.go "hostid_fallback.go") | | [hostid\_fallback.go](/rs/xid/blob/master/hostid_fallback.go "hostid_fallback.go") |  |  |
| [hostid\_freebsd.go](/rs/xid/blob/master/hostid_freebsd.go "hostid_freebsd.go") | | [hostid\_freebsd.go](/rs/xid/blob/master/hostid_freebsd.go "hostid_freebsd.go") |  |  |
| [hostid\_linux.go](/rs/xid/blob/master/hostid_linux.go "hostid_linux.go") | | [hostid\_linux.go](/rs/xid/blob/master/hostid_linux.go "hostid_linux.go") |  |  |
| [hostid\_windows.go](/rs/xid/blob/master/hostid_windows.go "hostid_windows.go") | | [hostid\_windows.go](/rs/xid/blob/master/hostid_windows.go "hostid_windows.go") |  |  |
| [id.go](/rs/xid/blob/master/id.go "id.go") | | [id.go](/rs/xid/blob/master/id.go "id.go") |  |  |
| [id\_test.go](/rs/xid/blob/master/id_test.go "id_test.go") | | [id\_test.go](/rs/xid/blob/master/id_test.go "id_test.go") |  |  |
| View all files | | |

## Repository files navigation

* README
* MIT license
# Globally Unique ID Generator

[![godoc](https://camo.githubusercontent.com/ac61106dbccca5d31cc4bc2d26cf6d602ee7e76224e0042d787b7363d542cf28/687474703a2f2f696d672e736869656c64732e696f2f62616467652f676f646f632d7265666572656e63652d626c75652e7376673f7374796c653d666c6174)](https://godoc.org/github.com/rs/xid) [![license](https://camo.githubusercontent.com/63f85ddefe6137dfe60899af1d70a3a83636e76302111ff831fc8fb4ca95c1e8/687474703a2f2f696d672e736869656c64732e696f2f62616467652f6c6963656e73652d4d49542d7265642e7376673f7374796c653d666c6174)](https://raw.githubusercontent.com/rs/xid/master/LICENSE) [![Build Status](https://camo.githubusercontent.com/1b13d781b488fd509eca6e231017e665bbc538106da69bcce6f984183dbde366/68747470733a2f2f7472617669732d63692e6f72672f72732f7869642e7376673f6272616e63683d6d6173746572)](https://travis-ci.org/rs/xid) [![Coverage](https://camo.githubusercontent.com/fb5f066f93ee856c4e054cf01c0d1eece0e6f724e97163e35e2d8f2aa4c926d3/687474703a2f2f676f636f7665722e696f2f5f62616467652f6769746875622e636f6d2f72732f786964)](http://gocover.io/github.com/rs/xid)

Package xid is a globally unique id generator library, ready to safely be used directly in your server code.

Xid uses the Mongo Object ID algorithm to generate globally unique ids with a different serialization ([base32hex](https://datatracker.ietf.org/doc/html/rfc4648#page-10)) to make it shorter when transported as a string:
<https://docs.mongodb.org/manual/reference/object-id/>

* 4-byte value representing the seconds since the Unix epoch,
* 3-byte machine identifier,
* 2-byte process id, and
* 3-byte counter, starting with a random value.

The binary representation of the id is compatible with Mongo 12 bytes Object IDs.
The string representation is using [base32hex](https://datatracker.ietf.org/doc/html/rfc4648#page-10) (w/o padding) for better space efficiency
when stored in that form (20 bytes). The hex variant of base32 is used to retain the
sortable property of the id.

Xid doesn't use base64 because case sensitivity and the 2 non alphanum chars may be an
issue when transported as a string between various systems. Base36 wasn't retained either
because 1/ it's not standard 2/ the resulting size is not predictable (not bit aligned)
and 3/ it would not remain sortable. To validate a base32 `xid`, expect a 20 chars long,
all lowercase sequence of `a` to `v` letters and `0` to `9` numbers (`[0-9a-v]{20}`).

UUIDs are 16 bytes (128 bits) and 36 chars as string representation. Twitter Snowflake
ids are 8 bytes (64 bits) but require machine/data-center configuration and/or central
generator servers. xid stands in between with 12 bytes (96 bits) and a more compact
URL-safe string representation (20 chars). No configuration or central generator server
is required so it can be used directly in server's code.

| Name | Binary Size | String Size | Features |
| --- | --- | --- | --- |
| [UUID](https://en.wikipedia.org/wiki/Universally_unique_identifier) | 16 bytes | 36 chars | configuration free, not sortable |
| [shortuuid](https://github.com/stochastic-technologies/shortuuid) | 16 bytes | 22 chars | configuration free, not sortable |
| [Snowflake](https://blog.twitter.com/2010/announcing-snowflake) | 8 bytes | up to 20 chars | needs machine/DC configuration, needs central server, sortable |
| [MongoID](https://docs.mongodb.org/manual/reference/object-id/) | 12 bytes | 24 chars | configuration free, sortable |
| xid | 12 bytes | 20 chars | configuration free, sortable |

Features:

* Size: 12 bytes (96 bits), smaller than UUID, larger than snowflake
* Base32 hex encoded by default (20 chars when transported as printable string, still sortable)
* Non configured, you don't need set a unique machine and/or data center id
* K-ordered
* Embedded time with 1 second precision
* Unicity guaranteed for 16,777,216 (24 bits) unique ids per second and per host/process
* Lock-free (i.e.: unlike UUIDv1 and v2)

Best used with [zerolog](https://github.com/rs/zerolog)'s
[RequestIDHandler](https://godoc.org/github.com/rs/zerolog/hlog#RequestIDHandler).

Notes:

* Xid is dependent on the system time, a monotonic counter and so is not cryptographically secure. If unpredictability of IDs is important, you should not use Xids. It is worth noting that most other UUID-like implementations are also not cryptographically secure. You should use libraries that rely on cryptographically secure sources (like /dev/urandom on unix, crypto/rand in golang), if you want a truly random ID generator.

References:

* <http://www.slideshare.net/davegardnerisme/unique-id-generation-in-distributed-systems>
* <https://en.wikipedia.org/wiki/Universally_unique_identifier>
* <https://blog.twitter.com/2010/announcing-snowflake>
* Python port by [Graham Abbott](https://github.com/graham): <https://github.com/graham/python_xid>
* Scala port by [Egor Kolotaev](https://github.com/kolotaev): <https://github.com/kolotaev/ride>
* Rust port by [Kaz Yoshihara](https://github.com/kazk): <https://github.com/kazk/xid-rs>
* Python wrapper around the Rust port [Aleksandr Shpak](https://github.com/shpaker): <https://github.com/shpaker/epyxid>
* Ruby port by [Valar](https://github.com/valarpirai/): <https://github.com/valarpirai/ruby_xid>
* Java port by [0xShamil](https://github.com/0xShamil/): <https://github.com/0xShamil/java-xid>
* Dart port by [Peter Bwire](https://github.com/pitabwire): <https://pub.dev/packages/xid>
* PostgreSQL port by [Rasmus Holm](https://github.com/crholm): <https://github.com/modfin/pg-xid>
* Swift port by [Uditha Atukorala](https://github.com/uatuko): <https://github.com/uatuko/swift-xid>
* C++ port by [Uditha Atukorala](https://github.com/uatuko): <https://github.com/uatuko/libxid>
* Typescript & Javascript port by [Yiwen AI](https://github.com/yiwen-ai): <https://github.com/yiwen-ai/xid-ts>
* Gleam port by [Alexandre Del Vecchio](https://github.com/defgenx): <https://github.com/defgenx/gxid>

## Install

```
go get github.com/rs/xid

```

## Usage

```
guid := xid.New()

println(guid.String())
// Output: 9m4e2mr0ui3e8a215n4g
```

Get `xid` embedded info:

```
guid.Machine()
guid.Pid()
guid.Time()
guid.Counter()
```

## Benchmark

Benchmark against Go [Maxim Bublis](https://github.com/satori)'s [UUID](https://github.com/satori/go.uuid).

```
BenchmarkXID        	20000000	        91.1 ns/op	      32 B/op	       1 allocs/op
BenchmarkXID-2      	20000000	        55.9 ns/op	      32 B/op	       1 allocs/op
BenchmarkXID-4      	50000000	        32.3 ns/op	      32 B/op	       1 allocs/op
BenchmarkUUIDv1     	10000000	       204 ns/op	      48 B/op	       1 allocs/op
BenchmarkUUIDv1-2   	10000000	       160 ns/op	      48 B/op	       1 allocs/op
BenchmarkUUIDv1-4   	10000000	       195 ns/op	      48 B/op	       1 allocs/op
BenchmarkUUIDv4     	 1000000	      1503 ns/op	      64 B/op	       2 allocs/op
BenchmarkUUIDv4-2   	 1000000	      1427 ns/op	      64 B/op	       2 allocs/op
BenchmarkUUIDv4-4   	 1000000	      1452 ns/op	      64 B/op	       2 allocs/op

```

Note: UUIDv1 requires a global lock, hence the performance degradation as we add more CPUs.

## Licenses

All source code is licensed under the [MIT License](https://raw.github.com/rs/xid/master/LICENSE).

## About

xid is a globally unique id generator thought for the web

### Resources

[Readme](#readme-ov-file)
### License

[MIT license](#MIT-1-ov-file)

[Activity](/rs/xid/activity)
### Stars

[**4k**
stars](/rs/xid/stargazers)
### Watchers

[**36**
watching](/rs/xid/watchers)
### Forks

[**206**
forks](/rs/xid/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Frs%2Fxid&report=rs+%28user%29)

## [Releases 4](/rs/xid/releases)

[Remove dep on x/sys
Latest

Aug 30, 2018](/rs/xid/releases/tag/v1.2.1)
[+ 3 releases](/rs/xid/releases)

## [Packages 0](/users/rs/packages?repo_name=xid)

No packages published

## [Used by 18.1k](/rs/xid/network/dependents)

[* ![@kyaicf](https://avatars.githubusercontent.com/u/194767095?s=64&v=4)
* ![@Mind2Screen-Dev-Team](https://avatars.githubusercontent.com/u/181315021?s=64&v=4)
* ![@cuteLittleDevil](https://avatars.githubusercontent.com/u/38343763?s=64&v=4)
* ![@Titanomyrma](https://avatars.githubusercontent.com/u/63420880?s=64&v=4)
* ![@Satan0x00](https://avatars.githubusercontent.com/u/76834303?s=64&v=4)
* ![@mandarine-io](https://avatars.githubusercontent.com/u/183573168?s=64&v=4)
* ![@ProjectZeroDays](https://avatars.githubusercontent.com/u/56379955?s=64&v=4)
* ![@quarkcloudio](https://avatars.githubusercontent.com/u/2425371?s=64&v=4)

+ 18,072](/rs/xid/network/dependents)

## [Contributors 41](/rs/xid/graphs/contributors)

[+ 27 contributors](/rs/xid/graphs/contributors)

## Languages

* [Go
  100.0%](/rs/xid/search?l=go)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_a2d7627b_20250114_183442.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrakkan%2Fsftpgo%2Fcommit%2Ff30a9a2095bf90c0661b04fe038e3b7efc788bc6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrakkan%2Fsftpgo%2Fcommit%2Ff30a9a2095bf90c0661b04fe038e3b7efc788bc6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=drakkan%2Fsftpgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[drakkan](/drakkan)
/
**[sftpgo](/drakkan/sftpgo)**
Public

* [Notifications](/login?return_to=%2Fdrakkan%2Fsftpgo) You must be signed in to change notification settings
* [Fork
  761](/login?return_to=%2Fdrakkan%2Fsftpgo)
* [Star
   9.8k](/login?return_to=%2Fdrakkan%2Fsftpgo)

* [Code](/drakkan/sftpgo)
* [Issues
  63](/drakkan/sftpgo/issues)
* [Pull requests
  4](/drakkan/sftpgo/pulls)
* [Discussions](/drakkan/sftpgo/discussions)
* [Actions](/drakkan/sftpgo/actions)
* [Projects
  0](/drakkan/sftpgo/projects)
* [Security](/drakkan/sftpgo/security)
* [Insights](/drakkan/sftpgo/pulse)

Additional navigation options

* [Code](/drakkan/sftpgo)
* [Issues](/drakkan/sftpgo/issues)
* [Pull requests](/drakkan/sftpgo/pulls)
* [Discussions](/drakkan/sftpgo/discussions)
* [Actions](/drakkan/sftpgo/actions)
* [Projects](/drakkan/sftpgo/projects)
* [Security](/drakkan/sftpgo/security)
* [Insights](/drakkan/sftpgo/pulse)

## Commit

[Permalink](/drakkan/sftpgo/commit/f30a9a2095bf90c0661b04fe038e3b7efc788bc6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

OIDC cookie: use a cryptographically secure random string

[Browse files](/drakkan/sftpgo/tree/f30a9a2095bf90c0661b04fe038e3b7efc788bc6)
Browse the repository at this point in the history

```
Signed-off-by: Nicola Murino <nicola.murino@gmail.com>
```

* Loading branch information

[![@drakkan](https://avatars.githubusercontent.com/u/553263?s=40&v=4)](/drakkan)

[drakkan](/drakkan/sftpgo/commits?author=drakkan "View all commits by drakkan")
committed
Nov 21, 2024

1 parent
[ed5ff9c](/drakkan/sftpgo/commit/ed5ff9c5cc4b318b2b0a1b868bc3e95ecf65d0b7)

commit f30a9a2

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**24 additions**
and
**25 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* internal

  + httpd

    - internal/httpd/oauth2.go
      [oauth2.go](#diff-82df84147ab9f88f68f13e66510da7957cb49bca1b284c8a9729ab98bcfd701b)
    - internal/httpd/oidc.go
      [oidc.go](#diff-a2070a8228152a5b25164d700ef1c34471ca9270acce6c3afb69e446b7d7d253)
    - internal/httpd/oidc\_test.go
      [oidc\_test.go](#diff-34d0c9f593612715e576170412ed337058a6260ed3051c6a954ec0837425d79e)
  + util

    - internal/util/util.go
      [util.go](#diff-0f38f067df1a3a5e5fb78bd16bfeb63f7c7c89524abc32b98a875b6152474bb4)

## There are no files selected for viewing

6 changes: 1 addition & 5 deletions

6
[internal/httpd/oauth2.go](#diff-82df84147ab9f88f68f13e66510da7957cb49bca1b284c8a9729ab98bcfd701b "internal/httpd/oauth2.go")

Show comments

[View file](/drakkan/sftpgo/blob/f30a9a2095bf90c0661b04fe038e3b7efc788bc6/internal/httpd/oauth2.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,8 +15,6 @@ |
|  |  | package httpd |
|  |  |  |
|  |  | import ( |
|  |  | "crypto/sha256" |
|  |  | "encoding/hex" |
|  |  | "encoding/json" |
|  |  | "errors" |
|  |  | "sync" |
| Expand Down  Expand Up | | @@ -53,10 +51,8 @@ type oauth2PendingAuth struct { |
|  |  | } |
|  |  |  |
|  |  | func newOAuth2PendingAuth(provider int, redirectURL, clientID string, clientSecret \*kms.Secret) oauth2PendingAuth { |
|  |  | state := sha256.Sum256(util.GenerateRandomBytes(32)) |
|  |  |  |
|  |  | return oauth2PendingAuth{ |
|  |  | State: hex.EncodeToString(state[:]), |
|  |  | State: util.GenerateOpaqueString(), |
|  |  | Provider: provider, |
|  |  | ClientID: clientID, |
|  |  | ClientSecret: clientSecret, |
| Expand Down | |  |

11 changes: 3 additions & 8 deletions

11
[internal/httpd/oidc.go](#diff-a2070a8228152a5b25164d700ef1c34471ca9270acce6c3afb69e446b7d7d253 "internal/httpd/oidc.go")

Show comments

[View file](/drakkan/sftpgo/blob/f30a9a2095bf90c0661b04fe038e3b7efc788bc6/internal/httpd/oidc.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,8 +16,6 @@ package httpd |
|  |  |  |
|  |  | import ( |
|  |  | "context" |
|  |  | "crypto/sha256" |
|  |  | "encoding/hex" |
|  |  | "errors" |
|  |  | "fmt" |
|  |  | "net/http" |
| Expand Down  Expand Up | | @@ -204,12 +202,9 @@ type oidcPendingAuth struct { |
|  |  | } |
|  |  |  |
|  |  | func newOIDCPendingAuth(audience tokenAudience) oidcPendingAuth { |
|  |  | state := sha256.Sum256(util.GenerateRandomBytes(32)) |
|  |  | nonce := util.GenerateUniqueID() |
|  |  |  |
|  |  | return oidcPendingAuth{ |
|  |  | State: hex.EncodeToString(state[:]), |
|  |  | Nonce: nonce, |
|  |  | State: util.GenerateOpaqueString(), |
|  |  | Nonce: util.GenerateOpaqueString(), |
|  |  | Audience: audience, |
|  |  | IssuedAt: util.GetTimeAsMsSinceEpoch(time.Now()), |
|  |  | } |
| Expand Down  Expand Up | | @@ -684,7 +679,7 @@ func (s \*httpdServer) handleOIDCRedirect(w http.ResponseWriter, r \*http.Request) |
|  |  | RefreshToken: oauth2Token.RefreshToken, |
|  |  | IDToken: rawIDToken, |
|  |  | Nonce: idToken.Nonce, |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | } |
|  |  | if !oauth2Token.Expiry.IsZero() { |
|  |  | token.ExpiresAt = util.GetTimeAsMsSinceEpoch(oauth2Token.Expiry) |
| Expand Down | |  |

22 changes: 11 additions & 11 deletions

22
[internal/httpd/oidc\_test.go](#diff-34d0c9f593612715e576170412ed337058a6260ed3051c6a954ec0837425d79e "internal/httpd/oidc_test.go")

Show comments

[View file](/drakkan/sftpgo/blob/f30a9a2095bf90c0661b04fe038e3b7efc788bc6/internal/httpd/oidc_test.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -152,8 +152,8 @@ func TestOIDCLoginLogout(t \*testing.T) { |
|  |  | assert.Contains(t, rr.Body.String(), util.I18nInvalidAuth) |
|  |  |  |
|  |  | expiredAuthReq := oidcPendingAuth{ |
|  |  | State: xid.New().String(), |
|  |  | Nonce: xid.New().String(), |
|  |  | State: util.GenerateOpaqueString(), |
|  |  | Nonce: util.GenerateOpaqueString(), |
|  |  | Audience: tokenAudienceWebClient, |
|  |  | IssuedAt: util.GetTimeAsMsSinceEpoch(time.Now().Add(-10 \* time.Minute)), |
|  |  | } |
| Expand Down  Expand Up | | @@ -564,7 +564,7 @@ func TestOIDCRefreshToken(t \*testing.T) { |
|  |  | r, err := http.NewRequest(http.MethodGet, webUsersPath, nil) |
|  |  | assert.NoError(t, err) |
|  |  | token := oidcToken{ |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | AccessToken: xid.New().String(), |
|  |  | TokenType: "Bearer", |
|  |  | ExpiresAt: util.GetTimeAsMsSinceEpoch(time.Now().Add(-1 \* time.Minute)), |
| Expand Down  Expand Up | | @@ -668,7 +668,7 @@ func TestOIDCRefreshToken(t \*testing.T) { |
|  |  |  |
|  |  | func TestOIDCRefreshUser(t \*testing.T) { |
|  |  | token := oidcToken{ |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | AccessToken: xid.New().String(), |
|  |  | TokenType: "Bearer", |
|  |  | ExpiresAt: util.GetTimeAsMsSinceEpoch(time.Now().Add(1 \* time.Minute)), |
| Expand Down  Expand Up | | @@ -782,7 +782,7 @@ func TestValidateOIDCToken(t \*testing.T) { |
|  |  | }, |
|  |  | } |
|  |  | token := oidcToken{ |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | AccessToken: xid.New().String(), |
|  |  | ExpiresAt: util.GetTimeAsMsSinceEpoch(time.Now().Add(-2 \* time.Minute)), |
|  |  | } |
| Expand All | | @@ -798,8 +798,8 @@ func TestValidateOIDCToken(t \*testing.T) { |
|  |  |  |
|  |  | server.tokenAuth = jwtauth.New("PS256", util.GenerateRandomBytes(32), nil) |
|  |  | token = oidcToken{ |
|  |  | Cookie: xid.New().String(), |
|  |  | AccessToken: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | AccessToken: util.GenerateUniqueID(), |
|  |  | } |
|  |  | oidcMgr.addToken(token) |
|  |  | rr = httptest.NewRecorder() |
| Expand All | | @@ -813,7 +813,7 @@ func TestValidateOIDCToken(t \*testing.T) { |
|  |  | assert.Len(t, oidcMgr.tokens, 0) |
|  |  |  |
|  |  | token = oidcToken{ |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | AccessToken: xid.New().String(), |
|  |  | Role: "admin", |
|  |  | } |
| Expand Down  Expand Up | | @@ -1107,7 +1107,7 @@ func TestMemoryOIDCManager(t \*testing.T) { |
|  |  | AccessToken: xid.New().String(), |
|  |  | Nonce: xid.New().String(), |
|  |  | SessionID: xid.New().String(), |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | Username: xid.New().String(), |
|  |  | Role: "admin", |
|  |  | Permissions: []string{dataprovider.PermAdminAny}, |
| Expand Down  Expand Up | | @@ -1157,7 +1157,7 @@ func TestMemoryOIDCManager(t \*testing.T) { |
|  |  | token.UsedAt = usedAt |
|  |  | oidcMgr.tokens[token.Cookie] = token |
|  |  | newToken := oidcToken{ |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | } |
|  |  | oidcMgr.addToken(newToken) |
|  |  | oidcMgr.cleanup() |
| Expand Down  Expand Up | | @@ -1663,7 +1663,7 @@ func TestDbOIDCManager(t \*testing.T) { |
|  |  | } |
|  |  |  |
|  |  | token := oidcToken{ |
|  |  | Cookie: xid.New().String(), |
|  |  | Cookie: util.GenerateOpaqueString(), |
|  |  | AccessToken: xid.New().String(), |
|  |  | TokenType: "Bearer", |
|  |  | RefreshToken: xid.New().String(), |
| Expand Down | |  |

10 changes: 9 additions & 1 deletion

10
[internal/util/util.go](#diff-0f38f067df1a3a5e5fb78bd16bfeb63f7c7c89524abc32b98a875b6152474bb4 "internal/util/util.go")

Show comments

[View file](/drakkan/sftpgo/blob/f30a9a2095bf90c0661b04fe038e3b7efc788bc6/internal/util/util.go)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -22,8 +22,10 @@ import ( |
|  |  | "crypto/elliptic" |
|  |  | "crypto/rand" |
|  |  | "crypto/rsa" |
|  |  | "crypto/sha256" |
|  |  | "crypto/tls" |
|  |  | "crypto/x509" |
|  |  | "encoding/hex" |
|  |  | "encoding/json" |
|  |  | "encoding/pem" |
|  |  | "errors" |
| Expand Down  Expand Up | | @@ -550,7 +552,7 @@ func createDirPathIfMissing(file string, perm os.FileMode) error { |
|  |  | return nil |
|  |  | } |
|  |  |  |
|  |  | // GenerateRandomBytes generates the secret to use for JWT auth |
|  |  | // GenerateRandomBytes generates random bytes with the specified length |
|  |  | func GenerateRandomBytes(length int) []byte { |
|  |  | b := make([]byte, length) |
|  |  | \_, err := io.ReadFull(rand.Reader, b) |
| Expand All | | @@ -560,6 +562,12 @@ func GenerateRandomBytes(length int) []byte { |
|  |  | return b |
|  |  | } |
|  |  |  |
|  |  | // GenerateOpaqueString generates a cryptographically secure opaque string |
|  |  | func GenerateOpaqueString() string { |
|  |  | randomBytes := sha256.Sum256(GenerateRandomBytes(32)) |
|  |  | return hex.EncodeToString(randomBytes[:]) |
|  |  | } |
|  |  |  |
|  |  | // GenerateUniqueID returns an unique ID |
|  |  | func GenerateUniqueID() string { |
|  |  | u, err := uuid.NewRandom() |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f30a9a2`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrakkan%2Fsftpgo%2Fcommit%2Ff30a9a2095bf90c0661b04fe038e3b7efc788bc6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_124d1d18_20250114_183452.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrakkan%2Fsftpgo%2Fsecurity%2Fadvisories%2FGHSA-6943-qr24-82vx)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fdrakkan%2Fsftpgo%2Fsecurity%2Fadvisories%2FGHSA-6943-qr24-82vx)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=drakkan%2Fsftpgo)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[drakkan](/drakkan)
/
**[sftpgo](/drakkan/sftpgo)**
Public

* [Notifications](/login?return_to=%2Fdrakkan%2Fsftpgo) You must be signed in to change notification settings
* [Fork
  761](/login?return_to=%2Fdrakkan%2Fsftpgo)
* [Star
   9.8k](/login?return_to=%2Fdrakkan%2Fsftpgo)

* [Code](/drakkan/sftpgo)
* [Issues
  63](/drakkan/sftpgo/issues)
* [Pull requests
  4](/drakkan/sftpgo/pulls)
* [Discussions](/drakkan/sftpgo/discussions)
* [Actions](/drakkan/sftpgo/actions)
* [Projects
  0](/drakkan/sftpgo/projects)
* [Security](/drakkan/sftpgo/security)
* [Insights](/drakkan/sftpgo/pulse)

Additional navigation options

* [Code](/drakkan/sftpgo)
* [Issues](/drakkan/sftpgo/issues)
* [Pull requests](/drakkan/sftpgo/pulls)
* [Discussions](/drakkan/sftpgo/discussions)
* [Actions](/drakkan/sftpgo/actions)
* [Projects](/drakkan/sftpgo/projects)
* [Security](/drakkan/sftpgo/security)
* [Insights](/drakkan/sftpgo/pulse)

# Brute force takeover of OpenID Connect session cookies

Moderate

[drakkan](/drakkan)
published
GHSA-6943-qr24-82vx
Nov 28, 2024

## Package

gomod

sftpgo
([Go](/advisories?query=ecosystem%3Ago))

## Affected versions

>= 2.3.0, < 2.6.4

## Patched versions

2.6.4

## Description

### Impact

The OpenID Connect implementation, in the affected SFTPGo versions, allows authenticated users to brute force session cookies and thereby gain access to other users' data, since the cookies are generated predictably using the [xid](https://github.com/rs/xid) library and are therefore unique but not cryptographically secure.

### Patches

This issue was fixed in version v2.6.4, where cookies are opaque and cryptographically secure strings.

### References

[f30a9a2](https://github.com/drakkan/sftpgo/commit/f30a9a2095bf90c0661b04fe038e3b7efc788bc6)

### Severity

Moderate

### CVE ID

CVE-2024-52801

### Weaknesses

No CWEs

### Credits

* [![@denisvr72](https://avatars.githubusercontent.com/u/11361000?s=40&v=4)](/denisvr72)
  [denisvr72](/denisvr72)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


