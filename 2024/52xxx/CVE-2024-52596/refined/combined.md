=== Content from github.com_89d1ff32_20250114_203745.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fxml-common%2Fcommit%2Ffa4ade391c3194466acf5fbfd5d2ecdbf5e831f5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fxml-common%2Fcommit%2Ffa4ade391c3194466acf5fbfd5d2ecdbf5e831f5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=simplesamlphp%2Fxml-common)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[simplesamlphp](/simplesamlphp)
/
**[xml-common](/simplesamlphp/xml-common)**
Public

* [Notifications](/login?return_to=%2Fsimplesamlphp%2Fxml-common) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fsimplesamlphp%2Fxml-common)
* [Star
   2](/login?return_to=%2Fsimplesamlphp%2Fxml-common)

* [Code](/simplesamlphp/xml-common)
* [Issues
  1](/simplesamlphp/xml-common/issues)
* [Pull requests
  2](/simplesamlphp/xml-common/pulls)
* [Actions](/simplesamlphp/xml-common/actions)
* [Projects
  0](/simplesamlphp/xml-common/projects)
* [Wiki](/simplesamlphp/xml-common/wiki)
* [Security](/simplesamlphp/xml-common/security)
* [Insights](/simplesamlphp/xml-common/pulse)

Additional navigation options

* [Code](/simplesamlphp/xml-common)
* [Issues](/simplesamlphp/xml-common/issues)
* [Pull requests](/simplesamlphp/xml-common/pulls)
* [Actions](/simplesamlphp/xml-common/actions)
* [Projects](/simplesamlphp/xml-common/projects)
* [Wiki](/simplesamlphp/xml-common/wiki)
* [Security](/simplesamlphp/xml-common/security)
* [Insights](/simplesamlphp/xml-common/pulse)

## Commit

[Permalink](/simplesamlphp/xml-common/commit/fa4ade391c3194466acf5fbfd5d2ecdbf5e831f5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge commit from fork

[Browse files](/simplesamlphp/xml-common/tree/fa4ade391c3194466acf5fbfd5d2ecdbf5e831f5)
Browse the repository at this point in the history

```
Explicitly disable the loading of external entities
```

* Loading branch information

[![@tvdijen](https://avatars.githubusercontent.com/u/841045?s=40&v=4)](/tvdijen)

[tvdijen](/simplesamlphp/xml-common/commits?author=tvdijen "View all commits by tvdijen")
authored
Dec 1, 2024

2 parents
[344fb19](/simplesamlphp/xml-common/commit/344fb19206a07f245525dde78e9ac736b2ec22d2)
+
[7523ee8](/simplesamlphp/xml-common/commit/7523ee8bc346b80ec0c02e6db5a82f78f8b07bba)

commit fa4ade3

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**47 additions**
and
**16 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* src

  + src/DOMDocumentFactory.php
    [DOMDocumentFactory.php](#diff-e2ed4eeac4c5524ec6adf139d70fe04668d3eb3ea7a7baee284518937fa794f6)
* tests/XML

  + tests/XML/DOMDocumentFactoryTest.php
    [DOMDocumentFactoryTest.php](#diff-2b55a3a6eefa6306d99ff53d5d48d0d4d45242c04b272581cbde6c27dec5a34e)

## There are no files selected for viewing

50 changes: 34 additions & 16 deletions

50
[src/DOMDocumentFactory.php](#diff-e2ed4eeac4c5524ec6adf139d70fe04668d3eb3ea7a7baee284518937fa794f6 "src/DOMDocumentFactory.php")

Show comments

[View file](/simplesamlphp/xml-common/blob/fa4ade391c3194466acf5fbfd5d2ecdbf5e831f5/src/DOMDocumentFactory.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -5,15 +5,16 @@ |
|  |  | namespace SimpleSAML\XML; |
|  |  |  |
|  |  | use DOMDocument; |
|  |  | use RuntimeException; |
|  |  | use SimpleSAML\Assert\Assert; |
|  |  | use SimpleSAML\XML\Exception\IOException; |
|  |  | use SimpleSAML\XML\Exception\RuntimeException; |
|  |  | use SimpleSAML\XML\Exception\UnparseableXMLException; |
|  |  |  |
|  |  | use function defined; |
|  |  | use function file\_get\_contents; |
|  |  | use function func\_num\_args; |
|  |  | use function libxml\_clear\_errors; |
|  |  | use function libxml\_get\_last\_error; |
|  |  | use function libxml\_set\_external\_entity\_loader; |
|  |  | use function libxml\_use\_internal\_errors; |
|  |  | use function sprintf; |
|  |  |  |
| Expand All | | @@ -22,25 +23,41 @@ |
|  |  | \*/ |
|  |  | final class DOMDocumentFactory |
|  |  | { |
|  |  | /\*\* |
|  |  | \* @var non-negative-int |
|  |  | \* TODO: Add LIBXML\_NO\_XXE to the defaults when PHP 8.4.0 + libxml 2.13.0 become generally available |
|  |  | \*/ |
|  |  | public const DEFAULT\_OPTIONS = LIBXML\_COMPACT | LIBXML\_NONET | LIBXML\_NSCLEAN; |
|  |  |  |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @param string $xml |
|  |  | \* @param non-empty-string $xml |
|  |  | \* @param non-negative-int $options |
|  |  | \* |
|  |  | \* @return \DOMDocument |
|  |  | \*/ |
|  |  | public static function fromString(string $xml): DOMDocument |
|  |  | { |
|  |  | public static function fromString( |
|  |  | string $xml, |
|  |  | int $options = self::DEFAULT\_OPTIONS, |
|  |  | ): DOMDocument { |
|  |  | libxml\_set\_external\_entity\_loader(null); |
|  |  | Assert::notWhitespaceOnly($xml); |
|  |  | Assert::notRegex( |
|  |  | $xml, |
|  |  | '/<(\s\*)!(\s\*)DOCTYPE/', |
|  |  | 'Dangerous XML detected, DOCTYPE nodes are not allowed in the XML body', |
|  |  | RuntimeException::class, |
|  |  | ); |
|  |  |  |
|  |  | $internalErrors = libxml\_use\_internal\_errors(true); |
|  |  | libxml\_clear\_errors(); |
|  |  |  |
|  |  | $domDocument = self::create(); |
|  |  | $options = LIBXML\_DTDLOAD | LIBXML\_DTDATTR | LIBXML\_NONET | LIBXML\_PARSEHUGE | LIBXML\_NSCLEAN; |
|  |  | if (defined('LIBXML\_COMPACT')) { |
|  |  | $options |= LIBXML\_COMPACT; |
|  |  | // If LIBXML\_NO\_XXE is available and option not set |
|  |  | if (func\_num\_args() === 1 && defined('LIBXML\_NO\_XXE')) { |
|  |  | $options != LIBXML\_NO\_XXE; |
|  |  | } |
|  |  |  |
|  |  | $domDocument = self::create(); |
|  |  | $loaded = $domDocument->loadXML($xml, $options); |
|  |  |  |
|  |  | libxml\_use\_internal\_errors($internalErrors); |
| Expand All | | @@ -55,11 +72,11 @@ public static function fromString(string $xml): DOMDocument |
|  |  | libxml\_clear\_errors(); |
|  |  |  |
|  |  | foreach ($domDocument->childNodes as $child) { |
|  |  | if ($child->nodeType === XML\_DOCUMENT\_TYPE\_NODE) { |
|  |  | throw new RuntimeException( |
|  |  | 'Dangerous XML detected, DOCTYPE nodes are not allowed in the XML body', |
|  |  | ); |
|  |  | } |
|  |  | Assert::false( |
|  |  | $child->nodeType === XML\_DOCUMENT\_TYPE\_NODE, |
|  |  | 'Dangerous XML detected, DOCTYPE nodes are not allowed in the XML body', |
|  |  | RuntimeException::class, |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | return $domDocument; |
| Expand All | | @@ -68,10 +85,11 @@ public static function fromString(string $xml): DOMDocument |
|  |  |  |
|  |  | /\*\* |
|  |  | \* @param string $file |
|  |  | \* @param non-negative-int $options |
|  |  | \* |
|  |  | \* @return \DOMDocument |
|  |  | \*/ |
|  |  | public static function fromFile(string $file): DOMDocument |
|  |  | public static function fromFile(string $file, int $options = self::DEFAULT\_OPTIONS): DOMDocument |
|  |  | { |
|  |  | error\_clear\_last(); |
|  |  | $xml = @file\_get\_contents($file); |
| Expand All | | @@ -83,7 +101,7 @@ public static function fromFile(string $file): DOMDocument |
|  |  | } |
|  |  |  |
|  |  | Assert::notWhitespaceOnly($xml, sprintf('File "%s" does not have content', $file), RuntimeException::class); |
|  |  | return static::fromString($xml); |
|  |  | return (func\_num\_args() === 1) ? static::fromString($xml) : static::fromString($xml, $options); |
|  |  | } |
|  |  |  |
|  |  |  |
| Expand Down | |  |

13 changes: 13 additions & 0 deletions

13
[tests/XML/DOMDocumentFactoryTest.php](#diff-2b55a3a6eefa6306d99ff53d5d48d0d4d45242c04b272581cbde6c27dec5a34e "tests/XML/DOMDocumentFactoryTest.php")

Show comments

[View file](/simplesamlphp/xml-common/blob/fa4ade391c3194466acf5fbfd5d2ecdbf5e831f5/tests/XML/DOMDocumentFactoryTest.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -84,6 +84,19 @@ public function testStringThatContainsDocTypeIsNotAccepted(): void |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | public function testStringThatContainsDocTypeIsNotAccepted2(): void |
|  |  | { |
|  |  | $xml = '<?xml version="1.0" encoding="ISO-8859-1"?> |
|  |  | <!DOCTYPE foo [<!ENTITY % exfiltrate SYSTEM "file://dev/random">%exfiltrate;]> |
|  |  | <foo>y</foo>'; |
|  |  | $this->expectException(RuntimeException::class); |
|  |  | $this->expectExceptionMessage( |
|  |  | 'Dangerous XML detected, DOCTYPE nodes are not allowed in the XML body', |
|  |  | ); |
|  |  | DOMDocumentFactory::fromString($xml); |
|  |  | } |
|  |  |  |
|  |  |  |
|  |  | public function testEmptyFileIsNotValid(): void |
|  |  | { |
|  |  | $file = 'resources/xml/domdocument\_empty.xml'; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fa4ade3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fxml-common%2Fcommit%2Ffa4ade391c3194466acf5fbfd5d2ecdbf5e831f5) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.debian.org_7d02a3a6_20250114_203746.html ===


---

[[Date Prev](msg00000.html)][[Date Next](msg00002.html)]
[[Thread Prev](msg00000.html)][[Thread Next](msg00002.html)]
[[Date Index](maillist.html#00001)]
[[Thread Index](threads.html#00001)]

# [SECURITY] [DLA 3981-1] simplesamlphp security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 3981-1] simplesamlphp security update
* *From*: Santiago Ruano Rincón <santiagorr@riseup.net>
* *Date*: Mon, 2 Dec 2024 12:05:35 -0300
* *Message-id*: <[[🔎]](/msgid-search/Z03Mv08FBvUevhUF%40voleno) [Z03Mv08FBvUevhUF@voleno](msg00001.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-------------------------------------------------------------------------
Debian LTS Advisory DLA-3981-1                debian-lts@lists.debian.org
<https://www.debian.org/lts/security/>               Santiago Ruano Rincón
December 02, 2024                             <https://wiki.debian.org/LTS>
-------------------------------------------------------------------------

Package        : simplesamlphp
Version        : 1.19.0-1+deb11u1
CVE ID         : CVE-2024-52596

It was discovered that in SimpleSAMLphp, an implementation of the SAML 2.0
protocol, is prone to an XXE vulnerability when loading an (untrusted) XML
document.

For Debian 11 bullseye, this problem has been fixed in version
1.19.0-1+deb11u1.

We recommend that you upgrade your simplesamlphp packages.

For the detailed security status of simplesamlphp please refer to
its security tracker page at:
<https://security-tracker.debian.org/tracker/simplesamlphp>

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpkuN1BMtLfU.pgp)**

*Description:* PGP signature

---



=== Content from github.com_343ae2d4_20250114_203746.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fxml-common%2Fsecurity%2Fadvisories%2FGHSA-2x65-fpch-2fcm)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsimplesamlphp%2Fxml-common%2Fsecurity%2Fadvisories%2FGHSA-2x65-fpch-2fcm)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=simplesamlphp%2Fxml-common)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[simplesamlphp](/simplesamlphp)
/
**[xml-common](/simplesamlphp/xml-common)**
Public

* [Notifications](/login?return_to=%2Fsimplesamlphp%2Fxml-common) You must be signed in to change notification settings
* [Fork
  3](/login?return_to=%2Fsimplesamlphp%2Fxml-common)
* [Star
   2](/login?return_to=%2Fsimplesamlphp%2Fxml-common)

* [Code](/simplesamlphp/xml-common)
* [Issues
  1](/simplesamlphp/xml-common/issues)
* [Pull requests
  2](/simplesamlphp/xml-common/pulls)
* [Actions](/simplesamlphp/xml-common/actions)
* [Projects
  0](/simplesamlphp/xml-common/projects)
* [Wiki](/simplesamlphp/xml-common/wiki)
* [Security](/simplesamlphp/xml-common/security)
* [Insights](/simplesamlphp/xml-common/pulse)

Additional navigation options

* [Code](/simplesamlphp/xml-common)
* [Issues](/simplesamlphp/xml-common/issues)
* [Pull requests](/simplesamlphp/xml-common/pulls)
* [Actions](/simplesamlphp/xml-common/actions)
* [Projects](/simplesamlphp/xml-common/projects)
* [Wiki](/simplesamlphp/xml-common/wiki)
* [Security](/simplesamlphp/xml-common/security)
* [Insights](/simplesamlphp/xml-common/pulse)

# XXE

High

[tvdijen](/tvdijen)
published
GHSA-2x65-fpch-2fcm
Dec 1, 2024

## Package

composer

simplesamlphp/xml-common
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<1.20

## Patched versions

1.20.0

## Description

Summary

When loading an (untrusted) XML document, for example the SAMLResponse, it's possible to induce an XXE.

$options is defined as: <https://github.com/simplesamlphp/xml-common/blob/v1.19.0/src/DOMDocumentFactory.php#L39>

including the DTDLoad option, which allows an attacker to read file contents from local file system OR internal network.

While there is the NONET option, an attacker can simply bypass if by using PHP filters:

php://filter/convert.base64-encode/resource=<http://URL> OR FILE

From there an attacker can induce network connections and steal the targeted file OOB (haven't fully tested this).

RCE may be possible with the php://expect or php://phar wrappers, but this hasn't been tested.

Note:

The mitigation here:

<https://github.com/simplesamlphp/xml-common/blob/v1.19.0/src/DOMDocumentFactory.php#L58>

Comes too late, as the XML has already been loaded into a document.

Mitigation:

Remove the LIBXML\_DTDLOAD | LIBXML\_DTDATTR options.

Additionally, as a defense in depth measure, check if there is the string: <!DOCTYPE inside the XML before parsing it. (This is not a complete fix because someone may be able to exploit some parser differentials, to load a DOCTYPE, maybe through spacing like: <! DOCTYPE)

### Severity

High

### CVE ID

CVE-2024-52596

### Weaknesses

[CWE-611](/advisories?query=cwe%3A611)

### Credits

* [![@ahacker1-securesaml](https://avatars.githubusercontent.com/u/180476984?s=40&v=4)](/ahacker1-securesaml)
  [ahacker1-securesaml](/ahacker1-securesaml)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


