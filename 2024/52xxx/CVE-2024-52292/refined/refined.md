- **Root cause of vulnerability**: The `dataUrl` function in Craft CMS allows reading the content of an arbitrary file if an absolute file path is provided. This function converts the file content into a Base64-encoded string, which can then be exfiltrated.
- **Weaknesses/vulnerabilities present**: The vulnerability lies in the insecure implementation of the `dataUrl` function, which does not properly validate or sanitize the provided file path. This, coupled with the ability for an attacker with write permissions to system notification templates to inject malicious code using the `dataUrl` function, constitutes the vulnerability.
- **Impact of exploitation**: Successful exploitation allows an attacker to read arbitrary system files. This can lead to:
    - Exposure of sensitive information such as configuration files, credentials, and API keys.
    - Privilege escalation if the attacker can read files containing privileged information.
    - Server compromise through access to SSH keys or private certificates.
    - Exfiltration of user data, including passwords, session tokens, and personal information.
- **Attack vectors**: The attack vector is through the network by manipulating system notification templates to include the vulnerable `dataUrl` function call.
- **Required attacker capabilities/position**: The attacker needs:
    - Write permissions to system notification templates.
    - The ability to trigger a system email notification (e.g., password reset).