- **Root cause of vulnerability:** SQL injection vulnerability exists in the `addRelatedObjects` function within the `CUser` class. This function is called by the `CUser.get` function, which is accessible to any user with API access.
- **Weaknesses/vulnerabilities present:** SQL injection vulnerability in the `addRelatedObjects` function of the `CUser` class.
- **Impact of exploitation:** Allows a non-admin user with API access to potentially execute arbitrary SQL queries, leading to data breaches, modifications, or other malicious activities.
- **Attack vectors:** Exploitation occurs through the Zabbix API using the `CUser.get` function, which then calls the vulnerable `addRelatedObjects` function.
- **Required attacker capabilities/position:** The attacker needs a non-admin user account on the Zabbix frontend with API access enabled either through the default User role or another role that grants API access.