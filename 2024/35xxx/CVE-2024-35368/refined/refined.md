Based on the provided information:

**CVE ID:** CVE-2024-35368

**Root cause of vulnerability:** Double free

**Weaknesses/vulnerabilities present:** The vulnerability lies within the `rkmpp_retrieve_frame` function in `libavcodec/rkmppdec.c`. When an error occurs after creating an `AVBuffer` and assigning it to `frame->buf[0]`, the code manually frees the objects (AVDRMFrameDescriptor, MppFrame, AVBufferRefs framecontextref and decoder_ref) associated with that buffer. However, the `AVBuffer` itself is also freed when the `AVFrame` is unreferenced. This leads to a double free vulnerability.

**Impact of exploitation:** A successful exploit could lead to memory corruption, program crashes, or potentially arbitrary code execution.

**Attack vectors:** The vulnerability is triggered when an error occurs during frame retrieval, specifically within the `rkmpp_retrieve_frame` function. This could be triggered by providing specially crafted video content that results in such errors during the decoding process, which would then cause the double free to occur during the error handling.

**Required attacker capabilities/position:** An attacker needs to be able to provide a specially crafted video file or stream that is processed by FFmpeg using the Rockchip MPP decoder. The attacker does not need to have a position on the system; a local or remote user can trigger this vulnerability.

**Additional details:**
- The vulnerability is present in FFmpeg version n7.0.
- The fix for this vulnerability is in commit `4513300989502090c4fd6560544dce399a8cd53c`.
- The provided patch removes the manual freeing of objects that are already managed by the AVBuffer.