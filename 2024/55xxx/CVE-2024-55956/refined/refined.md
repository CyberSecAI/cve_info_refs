This document provides a detailed analysis of CVE-2024-55956, an actively exploited vulnerability in Cleo's LexiCom, VLTrader, and Harmony software.

**Root Cause of Vulnerability:**
The vulnerability is an arbitrary file-write vulnerability that allows a threat actor to write files to arbitrary locations on the file system. This is achieved by exploiting a flaw in the software's import functionality.

**Weaknesses/Vulnerabilities Present:**
- **Arbitrary File Write:** The core weakness is the ability to write files to any location on the server's file system due to improper input validation of the file import process.
- **Insufficient Patching:** Although Cleo released a patch for CVE-2024-50623, this patch does not address the arbitrary file write vulnerability, leaving systems vulnerable.
- **Abuse of Autorun Feature:** Attackers exploit the autorun feature of Cleo software to achieve code execution by writing malicious files into the autorun directory.

**Impact of Exploitation:**
- **Remote Code Execution:** Attackers can achieve remote code execution by exploiting the arbitrary file-write vulnerability and leveraging the autorun functionality.
- **Post-Exploitation Activity:** After gaining initial access, attackers engage in post-exploitation activities including:
    - Downloading and executing malicious JAR files for persistence.
    - Performing domain reconnaissance using tools like nltest.exe.
    - Enumerating and potentially compromising other systems on the network.
- **Data Breach:** The access gained could lead to sensitive data exposure and exfiltration.

**Attack Vectors:**
- **Network Exploitation:** Attackers exploit internet-exposed Cleo servers. The vulnerability can be triggered by sending specially crafted data to the vulnerable application.
- **Arbitrary File Write:** The vulnerability is triggered using the file import functionality, writing malicious files to the file system, specifically autorun directory.

**Required Attacker Capabilities/Position:**
- **Network Access:** The attacker requires network access to the vulnerable Cleo server.
- **Exploitation Skills:** The attacker needs the ability to craft malicious data to trigger the arbitrary file-write vulnerability.
- **Post-Exploitation Knowledge:** The attacker needs knowledge to perform post-exploitation activities and maintain persistence on the compromised system, which includes the knowledge of where to write files (autorun directory) and how to leverage the autorun functionality.

**Additional Details:**
- The analysis shows the attack chain, starting with writing a .txt file (`healthchecktemplate.txt`) in the autorun directory, importing a zip file which contains a main.xml file which defines additional actions, including the execution of a PowerShell command. The powershell command downloads JAR files from remote servers for persistence on the host.
- The threat actors are observed deleting the JAR files after execution to remain stealthy.
- The document provides specific IP addresses observed being used for callbacks by the threat actors.
- It includes mitigation steps such as disabling the autorun feature via configuration.
- It details detection methods implemented by Huntress to identify and neutralize this threat.
- It provides Sigma rules and Indicators of Compromise (IOCs) for detection.
- Huntress successfully recreated the proof of concept and confirmed with Cleo that the previously released patch does not mitigate the vulnerability.
- The document provides a CyberChef recipe to decode the Powershell commands.