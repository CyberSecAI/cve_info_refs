=== Content from github.com_3d3f95dd_20250114_212431.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fsigstore-python%2Fcommit%2F300b502ae99ebfaace124f1f4e422a6a669369cf)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fsigstore-python%2Fcommit%2F300b502ae99ebfaace124f1f4e422a6a669369cf)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sigstore%2Fsigstore-python)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[sigstore-python](/sigstore/sigstore-python)**
Public

* [Notifications](/login?return_to=%2Fsigstore%2Fsigstore-python) You must be signed in to change notification settings
* [Fork
  51](/login?return_to=%2Fsigstore%2Fsigstore-python)
* [Star
   239](/login?return_to=%2Fsigstore%2Fsigstore-python)

* [Code](/sigstore/sigstore-python)
* [Issues
  33](/sigstore/sigstore-python/issues)
* [Pull requests
  1](/sigstore/sigstore-python/pulls)
* [Actions](/sigstore/sigstore-python/actions)
* [Projects
  0](/sigstore/sigstore-python/projects)
* [Security](/sigstore/sigstore-python/security)
* [Insights](/sigstore/sigstore-python/pulse)

Additional navigation options

* [Code](/sigstore/sigstore-python)
* [Issues](/sigstore/sigstore-python/issues)
* [Pull requests](/sigstore/sigstore-python/pulls)
* [Actions](/sigstore/sigstore-python/actions)
* [Projects](/sigstore/sigstore-python/projects)
* [Security](/sigstore/sigstore-python/security)
* [Insights](/sigstore/sigstore-python/pulse)

## Commit

[Permalink](/sigstore/sigstore-python/commit/300b502ae99ebfaace124f1f4e422a6a669369cf)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: require an inclusion promise when log integration time is used ([#…](https://github.com/sigstore/sigstore-python/pull/1247)

[Browse files](/sigstore/sigstore-python/tree/300b502ae99ebfaace124f1f4e422a6a669369cf)
Browse the repository at this point in the history

```
[…1247](https://github.com/sigstore/sigstore-python/pull/1247))
```

* Loading branch information

[![@woodruffw](https://avatars.githubusercontent.com/u/3059210?s=40&v=4)](/woodruffw)

[woodruffw](/sigstore/sigstore-python/commits?author=woodruffw "View all commits by woodruffw")
authored
Dec 10, 2024

1 parent
[9ee7ac2](/sigstore/sigstore-python/commit/9ee7ac259bcce37f95db13aa7d84a407c8b99a17)

commit 300b502

 Show file tree

 Hide file tree

Showing
**8 changed files**
with
**150 additions**
and
**4 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGELOG.md
  [CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed)
* sigstore

  + sigstore/models.py
    [models.py](#diff-0a93085d8254638ef9f32f48c9ef87ee757728d8b670214fc61547689af13172)
  + verify

    - sigstore/verify/verifier.py
      [verifier.py](#diff-0287921ae266ddac61ace4f5d2ee5fa8e74495f6e3a7c231d3715a31679690b1)
* test

  + assets

    - test/assets/bundle\_v3\_github.whl.sigstore
      [bundle\_v3\_github.whl.sigstore](#diff-08e1c26e7d08f9a1a1dc0d7d6ab515b94377d540baba61fc22a37e3d46ce9b9e)
    - test/assets/bundle\_v3\_no\_signed\_time.txt
      [bundle\_v3\_no\_signed\_time.txt](#diff-c4a1b3874d7b22e7f1d1b9a2b86a1673a5074c73f69d4e45c12eb107c647f726)
    - test/assets/bundle\_v3\_no\_signed\_time.txt.sigstore.json
      [bundle\_v3\_no\_signed\_time.txt.sigstore.json](#diff-69c2e624b2904267a03602fc3f773fede6b81e1bd369710b792c0a72b93ae4ce)
  + unit

    - test/unit/conftest.py
      [conftest.py](#diff-2ff607437089f83513068ccfb91d1c69f00acdbb1b6e953b7238abe9bed49c25)
    - test/unit/test\_models.py
      [test\_models.py](#diff-44d9bd114968f055169d2ef64ce35b9f5a7bfdde9957f45daebdb3de9c1dd61d)

## There are no files selected for viewing

4 changes: 4 additions & 0 deletions

4
[CHANGELOG.md](#diff-06572a96a58dc510037d5efa622f9bec8519bc1beab13c9f251e97e657a9d4ed "CHANGELOG.md")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/CHANGELOG.md)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -36,6 +36,10 @@ All versions prior to 0.9.0 are untracked. |
|  |  | verifying legacy bundles was never shown |
|  |  | ([#1198](https://github.com/sigstore/sigstore-python/pull/1198)) |
|  |  |  |
|  |  | \* Strengthened the requirement that an inclusion promise is present |
|  |  | \*if\* no other source of signed time is present |
|  |  | ([#1247](https://github.com/sigstore/sigstore-python/pull/1247)) |
|  |  |  |
|  |  | ## [3.5.3] |
|  |  |  |
|  |  | ### Fixed |
| Expand Down | |  |

15 changes: 13 additions & 2 deletions

15
[sigstore/models.py](#diff-0a93085d8254638ef9f32f48c9ef87ee757728d8b670214fc61547689af13172 "sigstore/models.py")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/sigstore/models.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -525,8 +525,11 @@ def \_verify(self) -> None: |
|  |  | # \* For 0.2+, an inclusion proof is required; the client MUST |
|  |  | # verify the inclusion proof. The inclusion prof MUST contain |
|  |  | # a checkpoint. |
|  |  | # The inclusion promise is NOT required; if present, the client |
|  |  | # SHOULD verify it. |
|  |  | # |
|  |  | # The inclusion promise is NOT required if another source of signed |
|  |  | # time (such as a signed timestamp) is present. If no other source |
|  |  | # of signed time is present, then the inclusion promise MUST be |
|  |  | # present. |
|  |  | # |
|  |  | # Before all of this, we require that the inclusion proof be present |
|  |  | # (when constructing the LogEntry). |
| Expand All | | @@ -543,6 +546,14 @@ def \_verify(self) -> None: |
|  |  | if not log\_entry.inclusion\_proof.checkpoint: |
|  |  | raise InvalidBundle("expected checkpoint in inclusion proof") |
|  |  |  |
|  |  | if ( |
|  |  | not log\_entry.inclusion\_promise |
|  |  | and not self.\_inner.verification\_material.timestamp\_verification\_data.rfc3161\_timestamps |
|  |  | ): |
|  |  | raise InvalidBundle( |
|  |  | "bundle must contain an inclusion promise or signed timestamp(s)" |
|  |  | ) |
|  |  |  |
|  |  | self.\_log\_entry = log\_entry |
|  |  |  |
|  |  | @property |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[sigstore/verify/verifier.py](#diff-0287921ae266ddac61ace4f5d2ee5fa8e74495f6e3a7c231d3715a31679690b1 "sigstore/verify/verifier.py")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/sigstore/verify/verifier.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -227,7 +227,12 @@ def \_establish\_time(self, bundle: Bundle) -> List[TimestampVerificationResult]: |
|  |  |  |
|  |  | # If a timestamp from the Transparency Service is available, the Verifier MUST |
|  |  | # perform path validation using the timestamp from the Transparency Service. |
|  |  | if timestamp := bundle.log\_entry.integrated\_time: |
|  |  | # NOTE: We only include this timestamp if it's accompanied by an inclusion |
|  |  | # promise that cryptographically binds it. We verify the inclusion promise |
|  |  | # itself later, as part of log entry verification. |
|  |  | if ( |
|  |  | timestamp := bundle.log\_entry.integrated\_time |
|  |  | ) and bundle.log\_entry.inclusion\_promise: |
|  |  | verified\_timestamps.append( |
|  |  | TimestampVerificationResult( |
|  |  | source=TimestampSource.TRANSPARENCY\_SERVICE, |
| Expand Down | |  |

63 changes: 62 additions & 1 deletion

63
[test/assets/bundle\_v3\_github.whl.sigstore](#diff-08e1c26e7d08f9a1a1dc0d7d6ab515b94377d540baba61fc22a37e3d46ce9b9e "test/assets/bundle_v3_github.whl.sigstore")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/test/assets/bundle_v3_github.whl.sigstore)
Edit file

Delete file

Load diff

Large diffs are not rendered by default.

Oops, something went wrong.

Retry

6 changes: 6 additions & 0 deletions

6
[test/assets/bundle\_v3\_no\_signed\_time.txt](#diff-c4a1b3874d7b22e7f1d1b9a2b86a1673a5074c73f69d4e45c12eb107c647f726 "test/assets/bundle_v3_no_signed_time.txt")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/test/assets/bundle_v3_no_signed_time.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -0,0 +1,6 @@ |
|  |  | DO NOT MODIFY ME! |
|  |  |  |
|  |  | this is the input for bundle\_v3\_no\_signed\_time, which ensures clients reject |
|  |  | bundles that don't have a source of signed time. |
|  |  |  |
|  |  | DO NOT MODIFY ME! |

50 changes: 50 additions & 0 deletions

50
[test/assets/bundle\_v3\_no\_signed\_time.txt.sigstore.json](#diff-69c2e624b2904267a03602fc3f773fede6b81e1bd369710b792c0a72b93ae4ce "test/assets/bundle_v3_no_signed_time.txt.sigstore.json")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/test/assets/bundle_v3_no_signed_time.txt.sigstore.json)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,50 @@ |
|  |  | { |
|  |  | "mediaType": "application/vnd.dev.sigstore.bundle.v0.3+json", |
|  |  | "verificationMaterial": { |
|  |  | "certificate": { |
|  |  | "rawBytes": "MIIC1DCCAlugAwIBAgIUXgKINnY7rbT5gHmj9yeiZXGg3rkwCgYIKoZIzj0EAwMwNzEVMBMGA1UEChMMc2lnc3RvcmUuZGV2MR4wHAYDVQQDExVzaWdzdG9yZS1pbnRlcm1lZGlhdGUwHhcNMjQxMjEwMjE0MTI1WhcNMjQxMjEwMjE1MTI1WjAAMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE4ul4I08UFGizCla6qRUGFiwEPNsFRnvBPDvQ4ViJ+Q83HOlYWWxCAjoJpGd9FWtyxTPKDsG0n4t6Mr+jSwz22KOCAXowggF2MA4GA1UdDwEB/wQEAwIHgDATBgNVHSUEDDAKBggrBgEFBQcDAzAdBgNVHQ4EFgQUZ7cNLqQlnKAXnf6jmb9cv70dppgwHwYDVR0jBBgwFoAU39Ppz1YkEZb5qNjpKFWixi4YZD8wIwYDVR0RAQH/BBkwF4EVd2lsbGlhbUB5b3NzYXJpYW4ubmV0MCwGCisGAQQBg78wAQEEHmh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aDAuBgorBgEEAYO/MAEIBCAMHmh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aDCBiwYKKwYBBAHWeQIEAgR9BHsAeQB3AN09MGrGxxEyYxkeHJlnNwKiSl643jyt/4eKcoAvKe6OAAABk7KFEeIAAAQDAEgwRgIhAOeS6rR2aksHhN9Rxbx+ANuAlXhP4vTPKMLBHd6JAm4lAiEAx+/kzKJ2SxSCAYm582jKeAa1LCVmUaO85FO2WTV7MYEwCgYIKoZIzj0EAwMDZwAwZAIwDXrVAPgutWZWPfE3QWy/4gG/PbMbYUfqNsEpQEeMm8GeraZN3zffzw16FFhWsMbXAjApxDNgKvmztHOKStyvmOXPiJCixzx/gLFbhVn7Q+qY6vjC83B0XgPsyQ2T0i8Ldzg=" |
|  |  | }, |
|  |  | "tlogEntries": [ |
|  |  | { |
|  |  | "logIndex": "154562758", |
|  |  | "logId": { |
|  |  | "keyId": "wNI9atQGlz+VWfO6LRygH4QUfY/8W4RFwiT5i5WRgB0=" |
|  |  | }, |
|  |  | "kindVersion": { |
|  |  | "kind": "hashedrekord", |
|  |  | "version": "0.0.1" |
|  |  | }, |
|  |  | "integratedTime": "1733866885", |
|  |  | "inclusionProof": { |
|  |  | "logIndex": "32658496", |
|  |  | "rootHash": "IbC2+n9aYhFlm5nFwkp+j7/Hc9XuYWxyE5OlXIoIijY=", |
|  |  | "treeSize": "32658497", |
|  |  | "hashes": [ |
|  |  | "CVvwGSdkZ5FUDnltf3Me3nXyco4G9mwTsYbIxz0RS+U=", |
|  |  | "DJrEpKAKhEPhZ5aKvlaRImFebTv5tc17rsfOkhSS6fY=", |
|  |  | "tsYfO+hUsl4KKY+qsPx/k4NzOzE5zWRsc4Ufgn4oh/U=", |
|  |  | "ZjSpDQt5kIQfJd6B/BDNWLRhYOGwnlxE6pT4JJaiD5s=", |
|  |  | "OMoiMVnwD3sG6Cc6HCg+ySmqBAH1nn0mA5+tjFxiyeg=", |
|  |  | "gSWKL2k1ZGZm45C8hSdNwWan8qOrszl5X7Ws56h+FVM=", |
|  |  | "R7hO1X+KgSw8Oojd8i2+G3BzBYztkRBE6LpYSXPg33U=", |
|  |  | "oOecFfN3YqDOkbijS/ej1WF5Da/Gt/AZNhbwE9uoOE8=", |
|  |  | "4lUF0YOu9XkIDXKXA0wMSzd6VeDY3TZAgmoOeWmS2+Y=", |
|  |  | "gf+9m552B3PnkWnO0o4KdVvjcT3WVHLrCbf1DoVYKFw=" |
|  |  | ], |
|  |  | "checkpoint": { |
|  |  | "envelope": "rekor.sigstore.dev - 1193050959916656506\n32658497\nIbC2+n9aYhFlm5nFwkp+j7/Hc9XuYWxyE5OlXIoIijY=\n\n\u2014 rekor.sigstore.dev wNI9ajBGAiEAgjFaCZlVvHUnDgxLf+4XjN6ahWNkkKh9QFTOqHBpyw4CIQDmy4JQs+2BKtvheo/HQogyhh5EYGYZeBDdRvyyX1fg+w==\n" |
|  |  | } |
|  |  | }, |
|  |  | "canonicalizedBody": "eyJhcGlWZXJzaW9uIjoiMC4wLjEiLCJraW5kIjoiaGFzaGVkcmVrb3JkIiwic3BlYyI6eyJkYXRhIjp7Imhhc2giOnsiYWxnb3JpdGhtIjoic2hhMjU2IiwidmFsdWUiOiJjYTZkZTk5YTExZDNkMzgwNTZkODM4YzdkYzlhMjNhMTFhMGM4MWJjYWNlMGQxMWVhYTMwMWEyZmZiNDgyYzQyIn19LCJzaWduYXR1cmUiOnsiY29udGVudCI6Ik1FWUNJUUMzc2pYZVZoTHRqbE13dG0yRE5CYVdVaFBWOVJ1U1dsWW1EcHQzRzFQVW5RSWhBUElxRHUwTVkza1FtelE2QmswS2VSTW5mQ3Y0VVdEVU5jclRnN0cyYjdzTCIsInB1YmxpY0tleSI6eyJjb250ZW50IjoiTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJTMHRMUzB0Q2sxSlNVTXhSRU5EUVd4MVowRjNTVUpCWjBsVldHZExTVTV1V1RkeVlsUTFaMGh0YWpsNVpXbGFXRWRuTTNKcmQwTm5XVWxMYjFwSmVtb3dSVUYzVFhjS1RucEZWazFDVFVkQk1WVkZRMmhOVFdNeWJHNWpNMUoyWTIxVmRWcEhWakpOVWpSM1NFRlpSRlpSVVVSRmVGWjZZVmRrZW1SSE9YbGFVekZ3WW01U2JBcGpiVEZzV2tkc2FHUkhWWGRJYUdOT1RXcFJlRTFxUlhkTmFrVXdUVlJKTVZkb1kwNU5hbEY0VFdwRmQwMXFSVEZOVkVreFYycEJRVTFHYTNkRmQxbElDa3R2V2tsNmFqQkRRVkZaU1V0dldrbDZhakJFUVZGalJGRm5RVVUwZFd3MFNUQTRWVVpIYVhwRGJHRTJjVkpWUjBacGQwVlFUbk5HVW01MlFsQkVkbEVLTkZacFNpdFJPRE5JVDJ4WlYxZDRRMEZxYjBwd1IyUTVSbGQwZVhoVVVFdEVjMGN3YmpSME5rMXlLMnBUZDNveU1rdFBRMEZZYjNkblowWXlUVUUwUndwQk1WVmtSSGRGUWk5M1VVVkJkMGxJWjBSQlZFSm5UbFpJVTFWRlJFUkJTMEpuWjNKQ1owVkdRbEZqUkVGNlFXUkNaMDVXU0ZFMFJVWm5VVlZhTjJOT0NreHhVV3h1UzBGWWJtWTJhbTFpT1dOMk56QmtjSEJuZDBoM1dVUldVakJxUWtKbmQwWnZRVlV6T1ZCd2VqRlphMFZhWWpWeFRtcHdTMFpYYVhocE5Ga0tXa1E0ZDBsM1dVUldVakJTUVZGSUwwSkNhM2RHTkVWV1pESnNjMkpIYkdoaVZVSTFZak5PZWxsWVNuQlpWelIxWW0xV01FMURkMGREYVhOSFFWRlJRZ3BuTnpoM1FWRkZSVWh0YURCa1NFSjZUMms0ZGxveWJEQmhTRlpwVEcxT2RtSlRPWE5pTW1Sd1ltazVkbGxZVmpCaFJFRjFRbWR2Y2tKblJVVkJXVTh2Q2sxQlJVbENRMEZOU0cxb01HUklRbnBQYVRoMldqSnNNR0ZJVm1sTWJVNTJZbE01YzJJeVpIQmlhVGwyV1ZoV01HRkVRMEpwZDFsTFMzZFpRa0pCU0ZjS1pWRkpSVUZuVWpsQ1NITkJaVkZDTTBGT01EbE5SM0pIZUhoRmVWbDRhMlZJU214dVRuZExhVk5zTmpRemFubDBMelJsUzJOdlFYWkxaVFpQUVVGQlFncHJOMHRHUldWSlFVRkJVVVJCUldkM1VtZEphRUZQWlZNMmNsSXlZV3R6U0doT09WSjRZbmdyUVU1MVFXeFlhRkEwZGxSUVMwMU1Ra2hrTmtwQmJUUnNDa0ZwUlVGNEt5OXJla3RLTWxONFUwTkJXVzAxT0RKcVMyVkJZVEZNUTFadFZXRlBPRFZHVHpKWFZGWTNUVmxGZDBObldVbExiMXBKZW1vd1JVRjNUVVFLV25kQmQxcEJTWGRFV0hKV1FWQm5kWFJYV2xkUVprVXpVVmQ1THpSblJ5OVFZazFpV1ZWbWNVNXpSWEJSUldWTmJUaEhaWEpoV2s0emVtWm1lbmN4TmdwR1JtaFhjMDFpV0VGcVFYQjRSRTVuUzNadGVuUklUMHRUZEhsMmJVOVlVR2xLUTJsNGVuZ3ZaMHhHWW1oV2JqZFJLM0ZaTm5acVF6Z3pRakJZWjFCekNubFJNbFF3YVRoTVpIcG5QUW90TFMwdExVVk9SQ0JEUlZKVVNVWkpRMEZVUlMwdExTMHRDZz09In19fX0=" |
|  |  | } |
|  |  | ], |
|  |  | "timestampVerificationData": {} |
|  |  | }, |
|  |  | "messageSignature": { |
|  |  | "messageDigest": { |
|  |  | "algorithm": "SHA2\_256", |
|  |  | "digest": "ym3pmhHT04BW2DjH3JojoRoMgbys4NEeqjAaL/tILEI=" |
|  |  | }, |
|  |  | "signature": "MEYCIQC3sjXeVhLtjlMwtm2DNBaWUhPV9RuSWlYmDpt3G1PUnQIhAPIqDu0MY3kQmzQ6Bk0KeRMnfCv4UWDUNcrTg7G2b7sL" |
|  |  | } |
|  |  | } |

2 changes: 2 additions & 0 deletions

2
[test/unit/conftest.py](#diff-2ff607437089f83513068ccfb91d1c69f00acdbb1b6e953b7238abe9bed49c25 "test/unit/conftest.py")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/test/unit/conftest.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -117,6 +117,8 @@ def signing\_bundle(asset): |
|  |  | def \_signing\_bundle(name: str) -> tuple[Path, Bundle]: |
|  |  | file = asset(name) |
|  |  | bundle\_path = asset(f"{name}.sigstore") |
|  |  | if not bundle\_path.is\_file(): |
|  |  | bundle\_path = asset(f"{name}.sigstore.json") |
|  |  | bundle = Bundle.from\_json(bundle\_path.read\_bytes()) |
|  |  |  |
|  |  | return (file, bundle) |
| Expand Down | |  |

7 changes: 7 additions & 0 deletions

7
[test/unit/test\_models.py](#diff-44d9bd114968f055169d2ef64ce35b9f5a7bfdde9957f45daebdb3de9c1dd61d "test/unit/test_models.py")

Show comments

[View file](/sigstore/sigstore-python/blob/300b502ae99ebfaace124f1f4e422a6a669369cf/test/unit/test_models.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -180,6 +180,13 @@ def test\_bundle\_roundtrip(self, signing\_bundle): |
|  |  | bundle.to\_json() |
|  |  | ) |
|  |  |  |
|  |  | def test\_bundle\_missing\_signed\_time(self, signing\_bundle): |
|  |  | with pytest.raises( |
|  |  | InvalidBundle, |
|  |  | match=r"bundle must contain an inclusion promise or signed timestamp\(s\)", |
|  |  | ): |
|  |  | signing\_bundle("bundle\_v3\_no\_signed\_time.txt") |
|  |  |  |
|  |  |  |
|  |  | class TestKnownBundleTypes: |
|  |  | def test\_str(self): |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `300b502`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fsigstore-python%2Fcommit%2F300b502ae99ebfaace124f1f4e422a6a669369cf) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_26864f80_20250114_212431.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fsigstore-python%2Freleases%2Ftag%2Fv3.6.0)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fsigstore-python%2Freleases%2Ftag%2Fv3.6.0)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=sigstore%2Fsigstore-python)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[sigstore-python](/sigstore/sigstore-python)**
Public

* [Notifications](/login?return_to=%2Fsigstore%2Fsigstore-python) You must be signed in to change notification settings
* [Fork
  51](/login?return_to=%2Fsigstore%2Fsigstore-python)
* [Star
   239](/login?return_to=%2Fsigstore%2Fsigstore-python)

* [Code](/sigstore/sigstore-python/tree/v3.6.0)
* [Issues
  33](/sigstore/sigstore-python/issues)
* [Pull requests
  1](/sigstore/sigstore-python/pulls)
* [Actions](/sigstore/sigstore-python/actions)
* [Projects
  0](/sigstore/sigstore-python/projects)
* [Security](/sigstore/sigstore-python/security)
* [Insights](/sigstore/sigstore-python/pulse)

Additional navigation options

* [Code](/sigstore/sigstore-python/tree/v3.6.0)
* [Issues](/sigstore/sigstore-python/issues)
* [Pull requests](/sigstore/sigstore-python/pulls)
* [Actions](/sigstore/sigstore-python/actions)
* [Projects](/sigstore/sigstore-python/projects)
* [Security](/sigstore/sigstore-python/security)
* [Insights](/sigstore/sigstore-python/pulse)

1. [Releases](/sigstore/sigstore-python/releases)
2. [v3.6.0](/sigstore/sigstore-python/releases/tag/v3.6.0)

# v3.6.0

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/sigstore/sigstore-python/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...v3.6.0)

 Loading

[View all tags](/sigstore/sigstore-python/tags)

![@woodruffw](https://avatars.githubusercontent.com/u/3059210?s=40&v=4)
[woodruffw](/woodruffw)
released this
10 Dec 22:18

·
[26 commits](/sigstore/sigstore-python/compare/v3.6.0...main)
to main
since this release

[v3.6.0](/sigstore/sigstore-python/tree/v3.6.0)

[`44aa3eb`](/sigstore/sigstore-python/commit/44aa3ebe74cfce9fbc39bb5d771f3c2e5fb5daaf)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.

GPG key ID: B5690EEEBB952194

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

### Added

* API: The DSSE `Envelope` class now performs automatic validation

  ([#1211](https://github.com/sigstore/sigstore-python/pull/1211))
* API: Added `signature` property to `Envelope` class for accessing raw

  signature bytes ([#1211](https://github.com/sigstore/sigstore-python/pull/1211))
* Signed timestamps embedded in bundles are now automatically verified

  against Timestamp Authorities provided within the Trusted Root ([[#1206](https://github.com/sigstore/sigstore-python/pull/1206)]

  ([#1206](https://github.com/sigstore/sigstore-python/pull/1206)))
* Bundles are now generated with signed timestamps when signing if the

  Trusted Root contains one or more Timestamp Authorities

  ([#1216](https://github.com/sigstore/sigstore-python/pull/1216))

### Removed

* Support for "detached" SCTs has been fully removed, aligning

  sigstore-python with other sigstore clients

  ([#1236](https://github.com/sigstore/sigstore-python/pull/1236))

### Fixed

* Fixed a CLI parsing bug introduced in 3.5.1 where a warning about

  verifying legacy bundles was never shown

  ([#1198](https://github.com/sigstore/sigstore-python/pull/1198))
* Strengthened the requirement that an inclusion promise is present

  *if* no other source of signed time is present

  ([#1247](https://github.com/sigstore/sigstore-python/pull/1247))

 Assets
4

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_f25380df_20250114_212433.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fsigstore-python%2Fsecurity%2Fadvisories%2FGHSA-hhfg-fwrw-87w7)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsigstore%2Fsigstore-python%2Fsecurity%2Fadvisories%2FGHSA-hhfg-fwrw-87w7)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=sigstore%2Fsigstore-python)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sigstore](/sigstore)
/
**[sigstore-python](/sigstore/sigstore-python)**
Public

* [Notifications](/login?return_to=%2Fsigstore%2Fsigstore-python) You must be signed in to change notification settings
* [Fork
  51](/login?return_to=%2Fsigstore%2Fsigstore-python)
* [Star
   239](/login?return_to=%2Fsigstore%2Fsigstore-python)

* [Code](/sigstore/sigstore-python)
* [Issues
  33](/sigstore/sigstore-python/issues)
* [Pull requests
  1](/sigstore/sigstore-python/pulls)
* [Actions](/sigstore/sigstore-python/actions)
* [Projects
  0](/sigstore/sigstore-python/projects)
* [Security](/sigstore/sigstore-python/security)
* [Insights](/sigstore/sigstore-python/pulse)

Additional navigation options

* [Code](/sigstore/sigstore-python)
* [Issues](/sigstore/sigstore-python/issues)
* [Pull requests](/sigstore/sigstore-python/pulls)
* [Actions](/sigstore/sigstore-python/actions)
* [Projects](/sigstore/sigstore-python/projects)
* [Security](/sigstore/sigstore-python/security)
* [Insights](/sigstore/sigstore-python/pulse)

# Insufficient validation of integration timestamp during verification

Low

[haydentherapper](/haydentherapper)
published
GHSA-hhfg-fwrw-87w7
Dec 10, 2024

## Package

pip

sigstore
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

>= 2.0.0

## Patched versions

3.6.0

## Description

### Summary

Versions of sigstore-python newer than 2.0.0 but prior to 3.6.0 perform insufficient validation of the "integration time" present in "v2" and "v3" bundles during the verification flow: the "integration time" is verified *if* a source of signed time (such as an inclusion promise) is present, but is otherwise trusted if no source of signed time is present.

This does not affect "v1" bundles, as the "v1" bundle format always requires an inclusion promise.

### Details

Sigstore uses signed time to support verification of signatures made against short-lived signing keys.

### Impact

The impact and severity of this weakness is *low*, as Sigstore contains multiple other enforcing components that prevent an attacker who modifies the integration timestamp within a bundle from impersonating a valid signature. In particular, an attacker who modifies the integration timestamp can induce a Denial of Service, but in no different manner than already possible with bundle access (e.g. modifying the signature itself such that it fails to verify).

Separately, an attacker could upload a *new* entry to the transparency service, and substitute their new entry's time. However, this would still be rejected at validation time, as the new entry's (valid) signed time would be outside the validity window of the original signing certificate and would nonetheless render the attacker auditable.

### Severity

Low

### CVE ID

CVE-2024-55655

### Weaknesses

[CWE-20](/advisories?query=cwe%3A20) [CWE-325](/advisories?query=cwe%3A325)

### Credits

* [![@woodruffw](https://avatars.githubusercontent.com/u/3059210?s=40&v=4)](/woodruffw)
  [woodruffw](/woodruffw)
  Remediation developer
* [![@haydentherapper](https://avatars.githubusercontent.com/u/8418760?s=40&v=4)](/haydentherapper)
  [haydentherapper](/haydentherapper)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


