Based on the provided content, here's an analysis of the vulnerability related to rotating SSH host keys in MailCleaner:

**Root cause of vulnerability:**
MailCleaner virtual appliance images were shipped with a generic set of SSH host keys. These keys were the same across all installations, creating a potential man-in-the-middle (MitM) attack vector.

**Weaknesses/vulnerabilities present:**
- Use of default, non-unique SSH host keys across all installations.
- Potential for MitM attack by intercepting SSH connections using the known default keys.

**Impact of exploitation:**
- A successful MitM attack could allow an attacker to read SSH session information in plain text.
- This could compromise the confidentiality of data transmitted over SSH.
- Could lead to unauthorized access and control of the MailCleaner appliance.

**Attack vectors:**
- An attacker with the default SSH host keys could intercept SSH connections to a MailCleaner appliance.
- The attacker would need to be positioned in the network path between the client and the server.

**Required attacker capabilities/position:**
- The attacker needs to have knowledge of the default SSH host keys.
- The attacker must be able to intercept network traffic between a client and the MailCleaner appliance.
- The attacker needs to be on the same local network (LAN) as the MailCleaner machine or have gained access to the local network.

**Additional Notes:**
- The fix involves disabling the default keys and generating unique keys for each installation.
- The update rotates host keys during the first run of the appliance
- Users may need to remove old host keys from their `known_hosts` file after the update.
- The vulnerability is considered to be limited to compromised devices within the same LAN as the MailCleaner machine due to the default firewall rules.
- The provided content also includes a patch to address this issue, involving the `MC_rotate_host_keys.sh` script, and an update to the installer to include it during the installation.