=== Content from github.com_9fd3e1a6_20250115_093717.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fblob%2Fmain%2Fapp%2FCore%2FSession%2FSessionHandler.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fblob%2Fmain%2Fapp%2FCore%2FSession%2FSessionHandler.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=kanboard%2Fkanboard)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kanboard](/kanboard)
/
**[kanboard](/kanboard/kanboard)**
Public

* [Notifications](/login?return_to=%2Fkanboard%2Fkanboard) You must be signed in to change notification settings
* [Fork
  1.8k](/login?return_to=%2Fkanboard%2Fkanboard)
* [Star
   8.6k](/login?return_to=%2Fkanboard%2Fkanboard)

* [Code](/kanboard/kanboard)
* [Issues
  152](/kanboard/kanboard/issues)
* [Pull requests
  6](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

Additional navigation options

* [Code](/kanboard/kanboard)
* [Issues](/kanboard/kanboard/issues)
* [Pull requests](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

## Files

 main
## Breadcrumbs

1. [kanboard](/kanboard/kanboard/tree/main)
2. /[app](/kanboard/kanboard/tree/main/app)
3. /[Core](/kanboard/kanboard/tree/main/app/Core)
4. /[Session](/kanboard/kanboard/tree/main/app/Core/Session)
/
# SessionHandler.php

Copy path Blame  Blame
## Latest commit

## History

[History](/kanboard/kanboard/commits/main/app/Core/Session/SessionHandler.php)89 lines (73 loc) · 2.1 KB main
## Breadcrumbs

1. [kanboard](/kanboard/kanboard/tree/main)
2. /[app](/kanboard/kanboard/tree/main/app)
3. /[Core](/kanboard/kanboard/tree/main/app/Core)
4. /[Session](/kanboard/kanboard/tree/main/app/Core/Session)
/
# SessionHandler.php

Top
## File metadata and controls

* Code
* Blame

89 lines (73 loc) · 2.1 KB[Raw](https://github.com/kanboard/kanboard/raw/refs/heads/main/app/Core/Session/SessionHandler.php)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889<?php
namespace Kanboard\Core\Session;
use PicoDb\Database;use SessionHandlerInterface;
/\*\* \* Class SessionHandler \* \* @package Kanboard\Core\Session \*/class SessionHandler implements SessionHandlerInterface{ const TABLE = 'sessions';
 /\*\* \* @var Database \*/ private $db;
 public function \_\_construct(Database $db) { $this->db = $db; }
 #[\ReturnTypeWillChange] public function close() { return true; }
 #[\ReturnTypeWillChange] public function destroy($sessionID) { return $this->db->table(self::TABLE)->eq('id', $sessionID)->remove(); }
 #[\ReturnTypeWillChange] public function gc($maxlifetime) { return $this->db->table(self::TABLE)->lt('expire\_at', time())->remove(); }
 #[\ReturnTypeWillChange] public function open($savePath, $name) { return true; }
 #[\ReturnTypeWillChange] public function read($sessionID) { $result = $this->db->table(self::TABLE)->eq('id', $sessionID)->gt('expire\_at', time())->findOneColumn('data');
 // Note: Returning false display an error message and write() is never called // preventing new sessions to be created when calling session\_start() return $result ?: ''; }
 #[\ReturnTypeWillChange] public function write($sessionID, $data) { if (SESSION\_DURATION > 0) { $lifetime = time() + SESSION\_DURATION; } else { $lifetime = time() + (ini\_get('session.gc\_maxlifetime') ?: 1440); }
 $this->db->startTransaction();
 if ($this->db->table(self::TABLE)->eq('id', $sessionID)->exists()) { $this->db->table(self::TABLE)->eq('id', $sessionID)->update([ 'expire\_at' => $lifetime, 'data' => $data, ]); } else { $this->db->table(self::TABLE)->insert([ 'id' => $sessionID, 'expire\_at' => $lifetime, 'data' => $data, ]); }
 $this->db->closeTransaction();
 return true; }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_12943ec6_20250115_093719.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fsecurity%2Fadvisories%2FGHSA-gv5c-8pxr-p484)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fsecurity%2Fadvisories%2FGHSA-gv5c-8pxr-p484)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=kanboard%2Fkanboard)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kanboard](/kanboard)
/
**[kanboard](/kanboard/kanboard)**
Public

* [Notifications](/login?return_to=%2Fkanboard%2Fkanboard) You must be signed in to change notification settings
* [Fork
  1.8k](/login?return_to=%2Fkanboard%2Fkanboard)
* [Star
   8.6k](/login?return_to=%2Fkanboard%2Fkanboard)

* [Code](/kanboard/kanboard)
* [Issues
  152](/kanboard/kanboard/issues)
* [Pull requests
  6](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

Additional navigation options

* [Code](/kanboard/kanboard)
* [Issues](/kanboard/kanboard/issues)
* [Pull requests](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

# Insufficient session invalidation

Moderate

[fguillot](/fguillot)
published
GHSA-gv5c-8pxr-p484
Dec 18, 2024

## Package

kanboard
(PHP)

## Affected versions

<= 1.2.42

## Patched versions

1.2.43

## Description

### Summary

Sessions are still usable even though their lifetime has exceeded.

### Details

Kanboard implements a cutom session handler (`app/Core/Session/SessionHandler.php`), to store the session data in a database.

Therefore, when a `session_id` is given, kanboard queries the data from the `sessions` sql table.

At this point, it does not correctly verify, if a given `session_id` has already exceeded its lifetime (`expires_at`).

Thus, a session which's lifetime is already `> time()`, is still queried from the database and hence a valid login.

The implemented [**SessionHandlerInterface::gc**](https://github.com/kanboard/kanboard/blob/main/app/Core/Session/SessionHandler.php#L40) function, that does remove invalid sessions, is called only **with a certain probability** (*Cleans up expired sessions. Called by [session\_start()](https://www.php.net/manual/en/function.session-start.php), based on [session.gc\_divisor](https://www.php.net/manual/en/session.configuration.php#ini.session.gc-divisor), [session.gc\_probability](https://www.php.net/manual/en/session.configuration.php#ini.session.gc-probability) and [session.gc\_maxlifetime](https://www.php.net/manual/en/session.configuration.php#ini.session.gc-maxlifetime) settings*) accordingly to the [php documentation](https://www.php.net/manual/en/sessionhandlerinterface.gc.php).

In the official Kanboard docker image these values default to:

```
php > echo ini_get('session.gc_probability');
1
php > echo ini_get('session.gc_divisor');
1000

```

Thus, an expired session is only terminated with probability 1/1000.

Hence, a possible fix for this vulnerability, is improving the [read()](https://github.com/kanboard/kanboard/blob/main/app/Core/Session/SessionHandler.php#L52) function. Please notice the added `->gt('expire_at', time())` statement.

```
#[\ReturnTypeWillChange]
public function read($sessionID)
{
    # Restricting the session query to entries with expire_at > time()
    $result = $this->db->table(self::TABLE)->eq('id', $sessionID)->gt('expire_at', time())->findOneColumn('data');
    return $result ?: '';
}
```

Further, the [php documentation of read()](https://www.php.net/manual/en/function.session-start.php) says:

> If nothing was read, it must return [false](https://www.php.net/manual/en/reserved.constants.php#constant.false).

Further improvements:

Terminate all sessions of a user, once the password has been changed.

### PoC

1. Create a session by logging in
2. Write down the session\_id (KB\_SID)
3. Close browser
4. Wait till the expire\_at value is > time()
5. Reuse the session\_id (KB\_SID) in a GET request and notice that it is still valid.

### Impact

1. Sessions can be used indefinitely

---

Found by Deutsche Telekom Security GmbH

### Severity

Moderate

6.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N

### CVE ID

CVE-2024-55603

### Weaknesses

[CWE-613](/advisories?query=cwe%3A613)

### Credits

* [![@msatdt](https://avatars.githubusercontent.com/u/142908517?s=40&v=4)](/msatdt)
  [msatdt](/msatdt)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.php.net_90505fee_20250115_093721.html ===

[![](/images/logos/php-logo-white.svg)](/)

* [Downloads](/downloads.php)
* [Documentation](/docs.php)
* [Get Involved](/get-involved.php)
* [Help](/support.php)
* [![PHP 8.4](/images/php8/logo_php8_4.svg)](/releases/8.4/index.php)

 Search docs

[API Platform Conference 2025](/conferences/index.php#2025-01-13-1)
[Getting Started](/manual/en/getting-started.php)
[Introduction](/manual/en/introduction.php)
[A simple tutorial](/manual/en/tutorial.php)
[Language Reference](/manual/en/langref.php)
[Basic syntax](/manual/en/language.basic-syntax.php)
[Types](/manual/en/language.types.php)
[Variables](/manual/en/language.variables.php)
[Constants](/manual/en/language.constants.php)
[Expressions](/manual/en/language.expressions.php)
[Operators](/manual/en/language.operators.php)
[Control Structures](/manual/en/language.control-structures.php)
[Functions](/manual/en/language.functions.php)
[Classes and Objects](/manual/en/language.oop5.php)
[Namespaces](/manual/en/language.namespaces.php)
[Enumerations](/manual/en/language.enumerations.php)
[Errors](/manual/en/language.errors.php)
[Exceptions](/manual/en/language.exceptions.php)
[Fibers](/manual/en/language.fibers.php)
[Generators](/manual/en/language.generators.php)
[Attributes](/manual/en/language.attributes.php)
[References Explained](/manual/en/language.references.php)
[Predefined Variables](/manual/en/reserved.variables.php)
[Predefined Exceptions](/manual/en/reserved.exceptions.php)
[Predefined Interfaces and Classes](/manual/en/reserved.interfaces.php)
[Predefined Attributes](/manual/en/reserved.attributes.php)
[Context options and parameters](/manual/en/context.php)
[Supported Protocols and Wrappers](/manual/en/wrappers.php)

[Security](/manual/en/security.php)
[Introduction](/manual/en/security.intro.php)
[General considerations](/manual/en/security.general.php)
[Installed as CGI binary](/manual/en/security.cgi-bin.php)
[Installed as an Apache module](/manual/en/security.apache.php)
[Session Security](/manual/en/security.sessions.php)
[Filesystem Security](/manual/en/security.filesystem.php)
[Database Security](/manual/en/security.database.php)
[Error Reporting](/manual/en/security.errors.php)
[User Submitted Data](/manual/en/security.variables.php)
[Hiding PHP](/manual/en/security.hiding.php)
[Keeping Current](/manual/en/security.current.php)
[Features](/manual/en/features.php)
[HTTP authentication with PHP](/manual/en/features.http-auth.php)
[Cookies](/manual/en/features.cookies.php)
[Sessions](/manual/en/features.sessions.php)
[Handling file uploads](/manual/en/features.file-upload.php)
[Using remote files](/manual/en/features.remote-files.php)
[Connection handling](/manual/en/features.connection-handling.php)
[Persistent Database Connections](/manual/en/features.persistent-connections.php)
[Command line usage](/manual/en/features.commandline.php)
[Garbage Collection](/manual/en/features.gc.php)
[DTrace Dynamic Tracing](/manual/en/features.dtrace.php)

[Function Reference](/manual/en/funcref.php)
[Affecting PHP's Behaviour](/manual/en/refs.basic.php.php)
[Audio Formats Manipulation](/manual/en/refs.utilspec.audio.php)
[Authentication Services](/manual/en/refs.remote.auth.php)
[Command Line Specific Extensions](/manual/en/refs.utilspec.cmdline.php)
[Compression and Archive Extensions](/manual/en/refs.compression.php)
[Cryptography Extensions](/manual/en/refs.crypto.php)
[Database Extensions](/manual/en/refs.database.php)
[Date and Time Related Extensions](/manual/en/refs.calendar.php)
[File System Related Extensions](/manual/en/refs.fileprocess.file.php)
[Human Language and Character Encoding Support](/manual/en/refs.international.php)
[Image Processing and Generation](/manual/en/refs.utilspec.image.php)
[Mail Related Extensions](/manual/en/refs.remote.mail.php)
[Mathematical Extensions](/manual/en/refs.math.php)
[Non-Text MIME Output](/manual/en/refs.utilspec.nontext.php)
[Process Control Extensions](/manual/en/refs.fileprocess.process.php)
[Other Basic Extensions](/manual/en/refs.basic.other.php)
[Other Services](/manual/en/refs.remote.other.php)
[Search Engine Extensions](/manual/en/refs.search.php)
[Server Specific Extensions](/manual/en/refs.utilspec.server.php)
[Session Extensions](/manual/en/refs.basic.session.php)
[Text Processing](/manual/en/refs.basic.text.php)
[Variable and Type Related Extensions](/manual/en/refs.basic.vartype.php)
[Web Services](/manual/en/refs.webservice.php)
[Windows Only Extensions](/manual/en/refs.utilspec.windows.php)
[XML Manipulation](/manual/en/refs.xml.php)
[GUI Extensions](/manual/en/refs.ui.php)

Keyboard Shortcuts?
This help
j
Next menu item
k
Previous menu item
g p
Previous man page
g n
Next man page
G
Scroll to bottom
g g
Scroll to top
g h
Goto homepage
g s
Goto search
(current page)
/
Focus search box

[Predefined Constants »](session.constants.php)

[« Installation](session.installation.php)

* [PHP Manual](index.php)
* [Function Reference](funcref.php)
* [Session Extensions](refs.basic.session.php)
* [Sessions](book.session.php)
* [Installing/Configuring](session.setup.php)

Change language:
English
German
Spanish
French
Italian
Japanese
Brazilian Portuguese
Russian
Turkish
Ukrainian
Chinese (Simplified)
Other

## Runtime Configuration

The behaviour of these functions is affected by settings in php.ini.

**Session configuration options**
| Name | Default | Changeable | Changelog |
| --- | --- | --- | --- |
| [session.save\_path](session.configuration.php#ini.session.save-path) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.name](session.configuration.php#ini.session.name) | "PHPSESSID" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.save\_handler](session.configuration.php#ini.session.save-handler) | "files" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.auto\_start](session.configuration.php#ini.session.auto-start) | "0" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.gc\_probability](session.configuration.php#ini.session.gc-probability) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.gc\_divisor](session.configuration.php#ini.session.gc-divisor) | "100" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.gc\_maxlifetime](session.configuration.php#ini.session.gc-maxlifetime) | "1440" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.serialize\_handler](session.configuration.php#ini.session.serialize-handler) | "php" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_lifetime](session.configuration.php#ini.session.cookie-lifetime) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_path](session.configuration.php#ini.session.cookie-path) | "/" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_domain](session.configuration.php#ini.session.cookie-domain) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_secure](session.configuration.php#ini.session.cookie-secure) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Prior to PHP 7.2.0, the default was `""`. |
| [session.cookie\_httponly](session.configuration.php#ini.session.cookie-httponly) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Prior to PHP 7.2.0, the default was `""`. |
| [session.cookie\_samesite](session.configuration.php#ini.session.cookie-samesite) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.3.0. |
| [session.use\_strict\_mode](session.configuration.php#ini.session.use-strict-mode) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_cookies](session.configuration.php#ini.session.use-cookies) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_only\_cookies](session.configuration.php#ini.session.use-only-cookies) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.referer\_check](session.configuration.php#ini.session.referer-check) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cache\_limiter](session.configuration.php#ini.session.cache-limiter) | "nocache" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cache\_expire](session.configuration.php#ini.session.cache-expire) | "180" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_trans\_sid](session.configuration.php#ini.session.use-trans-sid) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.trans\_sid\_tags](session.configuration.php#ini.session.trans-sid-tags) | "a=href,area=href,frame=src,form=" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. |
| [session.trans\_sid\_hosts](session.configuration.php#ini.session.trans-sid-hosts) | `$_SERVER['HTTP_HOST']` | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. |
| [session.sid\_length](session.configuration.php#ini.session.sid-length) | "32" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. Deprecated as of PHP 8.4.0. |
| [session.sid\_bits\_per\_character](session.configuration.php#ini.session.sid-bits-per-character) | "4" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. Deprecated as of PHP 8.4.0. |
| [session.upload\_progress.enabled](session.configuration.php#ini.session.upload-progress.enabled) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.cleanup](session.configuration.php#ini.session.upload-progress.cleanup) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.prefix](session.configuration.php#ini.session.upload-progress.prefix) | "upload\_progress\_" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.name](session.configuration.php#ini.session.upload-progress.name) | "PHP\_SESSION\_UPLOAD\_PROGRESS" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.freq](session.configuration.php#ini.session.upload-progress.freq) | "1%" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.min\_freq](session.configuration.php#ini.session.upload-progress.min-freq) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.lazy\_write](session.configuration.php#ini.session.lazy-write) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.hash\_function](session.configuration.php#ini.session.hash-function) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.hash\_bits\_per\_character](session.configuration.php#ini.session.hash-bits-per-character) | "4" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.entropy\_file](session.configuration.php#ini.session.entropy-file) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.entropy\_length](session.configuration.php#ini.session.entropy-length) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0 |

For further details and definitions of the
INI\_\* modes, see the [Where a configuration setting may be set](configuration.changes.modes.php).

The session management system supports a number of configuration
options which you can place in your php.ini file. We will give a
short overview.
`session.save_handler`
[string](language.types.string.php)

`session.save_handler` defines the name of the
handler which is used for storing and retrieving data
associated with a session. Defaults to
`files`. Note that individual extensions may register
their own `save_handler`s; registered handlers can be
obtained on a per-installation basis by referring to
[phpinfo()](function.phpinfo.php). See also
[session\_set\_save\_handler()](function.session-set-save-handler.php).

`session.save_path`
[string](language.types.string.php)

`session.save_path` defines the argument which
is passed to the save handler. If you choose the default files
handler, this is the path where the files are created. See also
[session\_save\_path()](function.session-save-path.php).

There is an optional `N` argument to this directive that determines
the number of directory levels your session files will be spread
around in. For example, setting to `'5;/tmp'`
may end up creating a session file and location like
`/tmp/4/b/1/e/3/sess_4b1e384ad74619bd212e236e52a5a174If`. In order to use `N` you must create all of these
directories before use. A small shell script exists in
ext/session to do this, it's called
mod\_files.sh, with a Windows version called
mod\_files.bat. Also note that if `N` is
used and greater than 0 then automatic garbage collection will
not be performed, see a copy of php.ini for further
information. Also, if you use `N`, be sure to surround
`session.save_path` in
"quotes" because the separator (`;`) is
also used for comments in php.ini.

The file storage module creates files using mode 600 by default.
This default can be changed with the optional `MODE` argument:
`N;MODE;/path` where `MODE` is the octal
representation of the mode.
Setting `MODE` does not affect the process umask.

**Warning**

If this is set to a world-readable directory, such as
/tmp (the default), other users on the
server may be able to hijack sessions by getting the list of
files in that directory.

**Caution**

When using the optional directory level argument `N`,
as described above, note that using a value higher than 1 or 2 is
inappropriate for most sites due to the large number of directories
required: for example, a value of 3 implies that `(2 ** session.sid_bits_per_character) ** 3`
directories exist on the filesystem, which can result in a lot of wasted
space and inodes.

Only use `N` greater than 2 if you are absolutely
certain that your site is large enough to require it.

`session.name`
[string](language.types.string.php)

`session.name` specifies the name of the
session which is used as cookie name. It should only contain
alphanumeric characters. Defaults to `PHPSESSID`.
See also [session\_name()](function.session-name.php).

`session.auto_start`
[bool](language.types.boolean.php)

`session.auto_start` specifies whether the
session module starts a session automatically on request
startup. Defaults to `0` (disabled).

`session.serialize_handler`
[string](language.types.string.php)

`session.serialize_handler` defines the name of
the handler which is used to serialize/deserialize data. PHP
serialize format (name `php_serialize`), PHP
internal formats (name `php` and
`php_binary`) and WDDX are supported (name
`wddx`). WDDX is only available, if PHP is
compiled with [WDDX
support](ref.wddx.php). `php_serialize` uses plain
serialize/unserialize function internally and does not have
limitations that `php`
and `php_binary` have. Older serialize handlers
cannot store numeric index nor string index contains special
characters (`|` and `!`) in
$\_SESSION. Use `php_serialize` to avoid numeric
index or special character errors at script shutdown. Defaults
to `php`.

`session.gc_probability`
[int](language.types.integer.php)

`session.gc_probability` in conjunction with
`session.gc_divisor` is used to manage probability
that the gc (garbage collection) routine is started.
Defaults to `1`. Must be greater than or equal to `0`. See [session.gc\_divisor](session.configuration.php#ini.session.gc-divisor) for details.

`session.gc_divisor`
[int](language.types.integer.php)

`session.gc_divisor` coupled with
`session.gc_probability` defines the probability
that the gc (garbage collection) process is started on every session
initialization.
The probability is calculated by using gc\_probability/gc\_divisor,
e.g. 1/100 means there is a 1% chance that the GC process starts
on each request.
`session.gc_divisor` defaults to `100`.
Must be greater than `0`.

`session.gc_maxlifetime`
[int](language.types.integer.php)

`session.gc_maxlifetime` specifies the number
of seconds after which data will be seen as 'garbage' and
potentially cleaned up. Garbage collection may occur during session start
(depending on [session.gc\_probability](session.configuration.php#ini.session.gc-probability) and
[session.gc\_divisor](session.configuration.php#ini.session.gc-divisor)).
Defaults to `1440` (24 minutes).
> **Note**:
> If different scripts have different values of
> `session.gc_maxlifetime` but share the same place for
> storing the session data then the script with the minimum value will be
> cleaning the data. In this case, use this directive together with [session.save\_path](session.configuration.php#ini.session.save-path).

`session.referer_check`
[string](language.types.string.php)

`session.referer_check` contains the
substring you want to check each HTTP Referer for. If the
Referer was sent by the client and the substring was not
found, the embedded session id will be marked as invalid.
Defaults to the empty string.

`session.entropy_file`
[string](language.types.string.php)

`session.entropy_file` gives a path to an
external resource (file) which will be used as an additional
entropy source in the session id creation process. Examples are
`/dev/random` or `/dev/urandom`
which are available on many Unix systems.

This feature is supported on Windows. Setting
`session.entropy_length` to a non zero value
will make PHP use the Windows Random API as entropy source.
> **Note**:
> Removed in PHP 7.1.0.
>
> `session.entropy_file` defaults
> to `/dev/urandom` or `/dev/arandom`
> if it is available.

`session.entropy_length`
[int](language.types.integer.php)

`session.entropy_length` specifies the number
of bytes which will be read from the file specified
above. Defaults to `32`.

Removed in PHP 7.1.0.

`session.use_strict_mode`
[bool](language.types.boolean.php)

`session.use_strict_mode` specifies whether the
module will use strict session id mode. If this mode is enabled,
the module does not accept uninitialized session IDs. If an uninitialized
session ID is sent from the browser, a new session ID is sent to the browser.
Applications are protected from session fixation via session adoption
with strict mode.
Defaults to `0` (disabled).
> **Note**:
> Enabling `session.use_strict_mode` is mandatory for
> general session security. All sites are advised to enable this. See
> [session\_create\_id()](function.session-create-id.php) example code for more details.

**Warning**

If a custom session handler registered via [session\_set\_save\_handler()](function.session-set-save-handler.php)
does not implement [SessionUpdateTimestampHandlerInterface::validateId()](sessionupdatetimestamphandlerinterface.validateid.php),
nor supplies the `validate_sid` callback, respectively,
strict session ID mode is effectively disabled, regardless of the value of this directive.
Particularly note that [SessionHandler](class.sessionhandler.php) does *not*
implement **SessionHandler::validateId()**.

`session.use_cookies`
[bool](language.types.boolean.php)

`session.use_cookies` specifies whether the
module will use cookies to store the session id on the client
side. Defaults to `1` (enabled).

`session.use_only_cookies`
[bool](language.types.boolean.php)

`session.use_only_cookies` specifies whether
the module will **only** use
cookies to store the session id on the client side.
Enabling this setting prevents attacks that involve passing session
IDs in URLs.
Defaults to `1` (enabled).

`session.cookie_lifetime`
[int](language.types.integer.php)

`session.cookie_lifetime` specifies the lifetime of
the cookie in seconds which is sent to the browser. The value 0
means "until the browser is closed." Defaults to
`0`. See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).
> **Note**:
> The expiration timestamp is set relative to the server time, which is
> not necessarily the same as the time in the client's browser.

`session.cookie_path`
[string](language.types.string.php)

`session.cookie_path` specifies path to set
in the session cookie. Defaults to `/`. See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_domain`
[string](language.types.string.php)

`session.cookie_domain` specifies the domain to
set in the session cookie. Default is none at all meaning the host name of
the server which generated the cookie according to cookies specification.
See also [session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_secure`
[bool](language.types.boolean.php)

`session.cookie_secure` specifies whether
cookies should only be sent over secure connections. With this option set
to `on`, sessions only work with HTTPS connections.
If it is `off`, then sessions work with both HTTP and
HTTPS connections. Defaults to `off`.
See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_httponly`
[bool](language.types.boolean.php)

Marks the cookie as accessible only through the HTTP protocol. This means
that the cookie won't be accessible by scripting languages, such as
JavaScript. This setting can effectively help to reduce identity theft
through XSS attacks (although it is not supported by all browsers).

`session.cookie_samesite`
[string](language.types.string.php)

Allows servers to assert that a cookie ought not to be sent along with
cross-site requests. This assertion allows user agents to mitigate the risk
of cross-origin information leakage, and provides some protection against
cross-site request forgery attacks. Note that this is not supported by all
browsers.
An empty value means that no SameSite cookie attribute will be set.
`Lax` and `Strict` mean that the cookie
will not be sent cross-domain for POST requests; `Lax`
will send the cookie for cross-domain GET requests, while `Strict`
will not.

`session.cache_limiter`
[string](language.types.string.php)

`session.cache_limiter` specifies the cache
control method used for session pages.
It may be one of the following values:
`nocache`, `private`,
`private_no_expire`, or `public`.
Defaults to `nocache`. See also the
[session\_cache\_limiter()](function.session-cache-limiter.php) documentation for
information about what these values mean.

`session.cache_expire`
[int](language.types.integer.php)

`session.cache_expire` specifies time-to-live
for cached session pages in minutes, this has no effect for
nocache limiter. Defaults to `180`. See also
[session\_cache\_expire()](function.session-cache-expire.php).

`session.use_trans_sid`
[bool](language.types.boolean.php)

`session.use_trans_sid` whether transparent
sid support is enabled or not. Defaults to
`0` (disabled).
> **Note**:
> URL based session management has additional security risks
> compared to cookie based session management. Users may send
> a URL that contains an active session ID to their friends by
> email or users may save a URL that contains a session ID to
> their bookmarks and access your site with the same session ID
> always, for example.
>
> Since PHP 7.1.0, full URL path, e.g. https://php.net/, is
> handled by trans sid feature. Previous PHP handled relative
> URL path only. Rewrite target hosts are defined by [session.trans\_sid\_hosts](session.configuration.php#ini.session.trans-sid-hosts).

`session.trans_sid_tags`
[string](language.types.string.php)

`session.trans_sid_tags` specifies which HTML tags
are rewritten to include session id when transparent sid support
is enabled. Defaults to
`a=href,area=href,frame=src,input=src,form=`

`form` is special tag. `<input hidden="session_id" name="session_name">`
is added as form variable.
> **Note**:
> Before PHP 7.1.0, [url\_rewriter.tags](outcontrol.configuration.php#ini.url-rewriter.tags)
> was used for this purpose. Since PHP 7.1.0, `fieldset`
> is no longer considered as special tag.

`session.trans_sid_hosts`
[string](language.types.string.php)

`session.trans_sid_hosts` specifies which hosts
are rewritten to include session id when transparent sid support
is enabled. Defaults to `$_SERVER['HTTP_HOST']`
Multiple hosts can be specified by ",", no space is allowed
between hosts. e.g. `php.net,wiki.php.net,bugs.php.net`

`session.sid_length`
[int](language.types.integer.php)

`session.sid_length` allows you to specify the
length of session ID string. Session ID length can be between 22
to 256.

The default is 32. If you need compatibility you may specify 32,
40, etc. Longer session ID is harder to guess. At least 32 chars
are recommended.

**Tip**

Compatibility Note: Use 32 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=4,
`session.hash_function`=1 (SHA1) and
`session.hash_bits_per_character`=6. Use 26 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=5. Use 22 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=6. You must
configure INI values to have at least 128 bits in session ID. Do
not forget to set an appropriate value for
`session.sid_bits_per_character`, otherwise you
will have weaker session ID.

> **Note**:
> This setting is introduced in PHP 7.1.0.

`session.sid_bits_per_character`
[int](language.types.integer.php)

`session.sid_bits_per_character` allows you to specify the
number of bits in encoded session ID character. The possible values are
'4' (0-9, a-f), '5' (0-9, a-v), and '6' (0-9, a-z, A-Z, "-", ",").

The default is 4. The more bits results in stronger session ID. 5 is
recommended value for most environments.
> **Note**:
> This setting is introduced in PHP 7.1.0.

`session.hash_function`
[mixed](language.types.mixed.php)

`session.hash_function` allows you to specify the hash
algorithm used to generate the session IDs. '0' means MD5 (128 bits) and
'1' means SHA-1 (160 bits).

It is also possible to specify any of the algorithms
provided by the [hash extension](ref.hash.php) (if it is
available), like `sha512` or
`whirlpool`. A complete list of supported algorithms can
be obtained with the [hash\_algos()](function.hash-algos.php) function.

> **Note**:
> Removed in PHP 7.1.0.

`session.hash_bits_per_character`
[int](language.types.integer.php)

`session.hash_bits_per_character` allows you to define
how many bits are stored in each character when converting the binary
hash data to something readable. The possible values are '4' (0-9, a-f),
'5' (0-9, a-v), and '6' (0-9, a-z, A-Z, "-", ",").
> **Note**:
> Removed in PHP 7.1.0.

`session.upload_progress.enabled`
[bool](language.types.boolean.php)

Enables upload progress tracking, populating the [$\_SESSION](reserved.variables.session.php) variable.
Defaults to 1, enabled.

`session.upload_progress.cleanup`
[bool](language.types.boolean.php)

Cleanup the progress information as soon as all POST data has been read
(i.e. upload completed). Defaults to 1, enabled.
> **Note**:
> It is highly recommended to keep this feature enabled.

`session.upload_progress.prefix`
[string](language.types.string.php)

A prefix used for the upload progress key in the [$\_SESSION](reserved.variables.session.php).
This key will be concatenated with the value of
`$_POST[ini_get("session.upload_progress.name")]` to
provide a unique index.

Defaults to "upload\_progress\_".

`session.upload_progress.name`
[string](language.types.string.php)

The name of the key to be used in [$\_SESSION](reserved.variables.session.php) storing
the progress information. See also
[session.upload\_progress.prefix](session.configuration.php#ini.session.upload-progress.prefix).

If `$_POST[ini_get("session.upload_progress.name")]`
is not passed or available, upload progressing will not be recorded.

Defaults to "PHP\_SESSION\_UPLOAD\_PROGRESS".

`session.upload_progress.freq`
[mixed](language.types.mixed.php)

Defines how often the upload progress information should be updated.
This can be defined in bytes (i.e. "update progress information after every 100 bytes"), or in percentages (i.e. "update progress information after receiving every 1% of the whole filesize").

Defaults to "1%".

`session.upload_progress.min_freq`
[int](language.types.integer.php)

The minimum delay between updates, in seconds.
Defaults to "1" (one second).

`session.lazy_write`
[bool](language.types.boolean.php)

`session.lazy_write`, when set to 1, means that session
data is only rewritten if it changes. Defaults to 1, enabled.

Upload progress will not be registered unless
session.upload\_progress.enabled is enabled, and the
$\_POST[ini\_get("session.upload\_progress.name")] variable is set.
See [Session Upload Progress](session.upload-progress.php) for more details on this functionality.

### Found A Problem?

[Learn How To Improve This Page](https://github.com/php/doc-base/blob/master/README.md "This will take you to our contribution guidelines on GitHub")
•
[Submit a Pull Request](https://github.com/php/doc-en/blob/master/reference/session/ini.xml)
•
[Report a Bug](https://github.com/php/doc-en/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fsession.configuration%0A%0A---)

[＋add a note](/manual/add-note.php?sect=session.configuration&repo=en&redirect=https://www.php.net/manual/en/session.configuration.php)
### User Contributed Notes 21 notes

[up](/manual/vote-note.php?id=128936&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=128936&page=session.configuration&vote=down "Vote down!")

38

[***Walerian Walawski - https://w87.eu/***](#128936) [¶](#128936)**1 year ago**
`Can't find mod_files.sh? Here it is:`

[up](/manual/vote-note.php?id=115842&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=115842&page=session.configuration&vote=down "Vote down!")

79

[***Christopher Kramer***](#115842) [¶](#115842)**10 years ago**
`On debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP's own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime).

You can adjust the global value in your php.ini (usually /etc/php5/apache2/php.ini). Or you can change the session.save_path so debian's cronjob will not clean up your sessions anymore. Then you need to either do your own garbage collection with your own cronjob or enable PHP's garbage collection (php then needs sufficient privileges on the save_path).

Why does Debian not use PHP's garbarage collection?
For security reasons, they store session data in a place (/var/lib/php5) with very stringent permissions. With the sticky bit set, only root is allowed to rename or delete files there, so PHP itself cannot clean up old session data. See <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=267720> .`

[up](/manual/vote-note.php?id=129283&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129283&page=session.configuration&vote=down "Vote down!")

3

[***theking2(at)king.ma***](#129283) [¶](#129283)**10 months ago**
`Please be careful with the 'sid_length' when setting 'sid_bits_per_character' to six.

Setting sid_bits_per_character to 6 includes the character "," to the list of possible characters. A comma will be escaped and transmitted as "%2C" (tested on Chromium Version 119.0.6045.199) adding two extra characters for each comma to the SESSION_ID.`

[up](/manual/vote-note.php?id=129114&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129114&page=session.configuration&vote=down "Vote down!")

5

[***zch1***](#129114) [¶](#129114)**1 year ago**
`the pwd should be urlencode when it contanis special chars.
eg:

save_handler:redis
save_path: tcp://127.0.0.1:6739?auth=urlencode('xxxxx')`

[up](/manual/vote-note.php?id=115913&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=115913&page=session.configuration&vote=down "Vote down!")

19

[***GreenReaper***](#115913) [¶](#115913)**10 years ago**
`We found a session.save_path depth of 3 led to excessive wastage of inodes and in fact disk space in storing the directory tree. dir_indexes option on ext2/3/4 makes larger directories more feasible anyway, so we decided to move to a depth of 2 instead.

It took a little puzzling to figure out how to move the existing PHP sessions up one directory tree, but we ended up running this in the root sessions directory:

#!/bin/sh
for a in ./* ; do
 cd ./$a
 pwd
 for b in ./* ; do
 cd ./$b
 pwd
 # Move existing sessions out
 find ./* -xdev -type f -print0 | xargs -0 mv -t .
 # Remove subdirectories
 find ./* -xdev -type d -print0 | xargs -0 rmdir
 cd ..
 done
 cd ..
done

This script may not be the best way to do it, but it got the job done fast. You can modify it for different depths by adding or removing "for" loops.

The documentation gives a depth of 5 as an example, but five is right out. If you're going beyond 2, you're at the scale where you may want to to look at a large memcached or redis instance instead.`

[up](/manual/vote-note.php?id=117668&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=117668&page=session.configuration&vote=down "Vote down!")

16

[***info at thimbleopensource dot com***](#117668) [¶](#117668)**9 years ago**
`I found out that if you need to set custom session settings, you only need to do it once when session starts. Then session maintains its settings, even if you use ini_set and change them, original session still will use it's original setting until it expires.

Just thought it might be useful to someone.`

[up](/manual/vote-note.php?id=129300&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129300&page=session.configuration&vote=down "Vote down!")

1

[***theking2(at)king.ma***](#129300) [¶](#129300)**10 months ago**
`To prevent mitm-attacks you want to make sure the session cookie is only transmitted over a secure channel prefix it with the magic string "__Secure-". [1]

Like :
<?php
 session_start( [ 'name' => '__Secure-Session-ID' ] );
?>

The cookie will not be available on non-secure channel.

(Putting this note it here probably goes unnoticed because of all the noise)

[1]: <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes>`

[up](/manual/vote-note.php?id=97979&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=97979&page=session.configuration&vote=down "Vote down!")

10

[***Wouter***](#97979) [¶](#97979)**14 years ago**
`When setting the session.cookie_lifetime directive in a .htaccess use string format like;

php_value session.cookie_lifetime "123456"

and not

php_value session.cookie_lifetime 123456

Using a integer as stated above dit not work in my case (Apache/2.2.11 (Ubuntu) PHP/5.2.6-3ubuntu4.5 with Suhosin-Patch mod_ssl/2.2.11 OpenSSL/0.9.8g)`

[up](/manual/vote-note.php?id=111451&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=111451&page=session.configuration&vote=down "Vote down!")

8

[***jlevene at etisoftware dot com***](#111451) [¶](#111451)**11 years ago**
`Being unable to find an actual copy of mod_files.sh, and seeing lots of complaints/bug fix requests for it, here's one that works. It gets all its parameters from PHP.INI, so you don't have the opportunity to mess up:

#!/bin/bash
#
# Creates directories for PHP session storage.
# Replaces the one that "comes with" PHP, which (a) doesn't always come with it
# and (b) doesn't work so great.
#
# This version takes no parameters, and uses the values in PHP.INI (if it
# can find it).
#
# Works in OS-X and CentOS (and probably all other) Linux.
#
# Feb '13 by Jeff Levene.

[[ $# -gt 0 ]] && echo "$0 requires NO command-line parameters.
It gets does whatever is called for in the PHP.INI file (if it can find it).
" && exit 1

# Find the PHP.INI file, if possible:
phpIni=/usr/local/lib/php.ini # Default PHP.INI location
[[ ! -f "$phpIni" ]] && phpIni=/etc/php.ini # Secondary location
[[ ! -f "$phpIni" ]] && phpIni= # Found it?

# Outputs the given (as $1) parameter from the PHP.INI file:
# The "empty" brackets have a SPACE and a TAB in them.
#
PhpConfigParam() {
 [[ ! "$phpIni" ]] && return
 # Get the line from the INI file:
 varLine=`grep "^[ ]*$1[ ]*=" "$phpIni"`

 # Extract the value:
 value=`expr "$varLine" : ".*$1[ ]*=[ ]*['\"]*\([^'\"]*\)"`
 echo "$value"
 }

if [[ "$phpIni" ]]
then
 savePath=`PhpConfigParam session.save_path`
 # If there's a number and semicolon at the front, remove them:
 dirDepth=`expr "$savePath" : '\([0-9]*\)'`
 [[ "$dirDepth" ]] && savePath=`expr "$savePath" : '[0-9]*;\(.*\)'` || dirDepth=0
 bits=`PhpConfigParam session.hash_bits_per_character`
 case "x$bits" in
 x) echo "hash_bits_per_character not defined. Not running." ; exit 2 ;;
 x4) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f' ;;
 x5) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v' ;;
 x6) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v'
 alphabet="$alphabet w x y z A B C D E F G H I J K L M N O P Q R S T U V W"
 alphabet="$alphabet X Y Z - ,"
 ;;
 *) echo "unrecognized hash_bits_per_character. Not running." ; exit 2 ;;
 esac
else
 echo "Cannot find the PHP.INI file. Not running. Sorry."
 exit 2
fi

# The depth of directories to create is $1. 0 means just create the named
# directory. Directory to start with is $2.
#
# Used recursively, so variables must be "local".

doDir() {
 local dir="$2"
 if [[ -d "$dir" ]]
 then
 echo "Directory '$dir' already exists. No problem."
 elif [[ -f "$dir" ]]
 then
 echo "FILE '$dir' exists. Aborting." ; exit 2
 else
 if mkdir "$dir"
 then
 echo "Directory '$dir' created."
 else
 echo "Cannot create directory '$dir'. Aborting." ; exit 2
 fi
 fi
 chmod a+rwx "$dir"
 if [[ $1 -gt 0 ]]
 then
 local depth=$(( $1 - 1 ))
 for letter in $alphabet
 do doDir $depth "$dir/$letter"
 done
 fi
 }

echo "Running with savePath='$savePath', dirDepth=$dirDepth, and bitsPerCharacter=$bits."
sleep 3

doDir $dirDepth "$savePath"

exit 0`

[up](/manual/vote-note.php?id=123598&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=123598&page=session.configuration&vote=down "Vote down!")

3

[***boan dot web at outlook dot com***](#123598) [¶](#123598)**5 years ago**
`session.cache_limiter may be empty string to disable cache headers entirely.

Quote:
> Setting the cache limiter to '' will turn off automatic sending of cache headers entirely.

<http://php.net/manual/en/function.session-cache-limiter.php>`

[up](/manual/vote-note.php?id=107990&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=107990&page=session.configuration&vote=down "Vote down!")

7

[***hassankhodadadeh at NOSPAM dot gmail dot com***](#107990) [¶](#107990)**12 years ago**
`max value for "session.gc_maxlifetime" is 65535. values bigger than this may cause php session stops working.`

[up](/manual/vote-note.php?id=122042&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=122042&page=session.configuration&vote=down "Vote down!")

3

[***li-lingjie***](#122042) [¶](#122042)**7 years ago**
`Use SessionHandlerInterface interface Custom redis session, found the following:

Use ini_set ('session.save_path', "tcp: //127.0.0.1: 6379? Auth = password"); will be reported:

PHP Fatal error: session_start (): Failed to initialize storage module: user (path: tcp: //127.0.0.1: 6379? Auth = password);

Using session_save_path ("tcp: //127.0.0.1: 6379? Auth = password") will not`

[up](/manual/vote-note.php?id=99619&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=99619&page=session.configuration&vote=down "Vote down!")

2

[***Nicholas***](#99619) [¶](#99619)**14 years ago**
`Transient sessions do not appear to be working in 5.3.3

E.g.

<?php
 ini_set("session.use_cookies", 0);
 ini_set("session.use_trans_sid", 1);
 session_start();

 if (isset($_SESSION["foo"])) {
 echo "Foo: " . $_SESSION["foo"];
 } else {
 $_SESSION["foo"] = "Bar";
 echo "<a href=?" . session_name() . "=" . session_id() . ">Begin test</a>";
 }
?>

This works in 5.2.5, but not 5.3.3`

[up](/manual/vote-note.php?id=121913&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=121913&page=session.configuration&vote=down "Vote down!")

-1

[***ohcc at 163 dot com***](#121913) [¶](#121913)**7 years ago**
`You should take more care configuring session.gc_maxlifetime when virtual hosts share the same session-saving directory. One host's session data may be gc'ed when another host runs php.`

[up](/manual/vote-note.php?id=100855&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=100855&page=session.configuration&vote=down "Vote down!")

-2

[***AskApache***](#100855) [¶](#100855)**14 years ago**
`This is how I set my session.save_path
session.save_path = "1;/home/askapache/tmp/s"
So to create the folder structure you can use this compatible shell script, if you want to create with 777 permissions change the umask to 0000;
sh -o braceexpand -c "umask 0077;mkdir -p s/{0..9}/{a..z} s/{a..z}/{0..9}"

Then you can create a cronjob to clean the session folder by adding this to your crontab which deletes any session files older than an hour:
@daily find /home/askapache/tmp/s -type f -mmin +60 -exec rm -f {} \; &>/dev/null

That will create sessions in folder like:
 /home/askapache/tmp/s/b/sess_b1aba5q6io4lv01bpc6t52h0ift227j6

I don't think any non-mega site will need to go more than 1 levels deep. Otherwise you create so many directories that it slows the performance gained by this.`

[up](/manual/vote-note.php?id=84045&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=84045&page=session.configuration&vote=down "Vote down!")

-2

[***00 at f00n dot com***](#84045) [¶](#84045)**16 years ago**
`After having many problems with garbage collection not clearing my sessions I have resolved it through the following.

First I found this in the php.ini (not something i noticed as i use phpinfo(); to see my hosting ini).

; NOTE: If you are using the subdirectory option for storing session files
; (see session.save_path above), then garbage collection does *not*
; happen automatically. You will need to do your own garbage

; collection through a shell script, cron entry, or some other method. ; For example, the following script would is the equivalent of
; setting session.gc_maxlifetime to 1440 (1440 seconds = 24 minutes):
; cd /path/to/sessions; find -cmin +24 | xargs rm

With this is mind there are options.

1. dont use a custom save_path.
** This means if your isp hasnt defaulted your session temp to something safer than install default or you are using a shared directory for session data then you would be wise to use named sessions to keep your session from being viewable in other people's scripts. Creating a unique_id name for this is the common method. **

2. use your custom folder but write a garbage collection script.

3. use a custom handler and a database`

[up](/manual/vote-note.php?id=88552&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=88552&page=session.configuration&vote=down "Vote down!")

-2

[***mikaelkael at php dot net***](#88552) [¶](#88552)**15 years ago**
`Recently, I needed to change the session save_path in my program under Windows. With an ini_set('session.save_path', '../data/sessions'); (and session.gc_divisor = 1 for test), I always obtain 'Error #8 session_start(): ps_files_cleanup_dir: opendir(../data/sessions) failed: Result too large'.

I corrected this by changing with ini_set('session.save_path', realpath('../data/sessions'));`

[up](/manual/vote-note.php?id=122038&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=122038&page=session.configuration&vote=down "Vote down!")

-3

[***white-gandalf at web dot de***](#122038) [¶](#122038)**7 years ago**
`session.use_strict_mode does very little to strengthen your security: only one very specific variant of attack is migitated by this (where the attacker hands an "empty" sid to the victim to adapt his own browser to that session later) - versus for example the case where he pre-opens a session, handing the sid of that one to the victim, so the victim gets adapted to the pre-opened session. In the latter case this flag does nothing to help. In every other scenario with other vulnerabilities where the session id gets leaked, the flag helps nigher.

But this flag renders the php function session_id() useless in its parameterized variant, thus preventing any php functionality that builds upon this function.`

[up](/manual/vote-note.php?id=99671&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=99671&page=session.configuration&vote=down "Vote down!")

-4

[***orbill***](#99671) [¶](#99671)**14 years ago**
`apparently the default value for session.use_only_cookies has changed in 5.3.3 from 0 to 1. If you haven't set this in your php.ini or your code to 0 transparent sessions won't work.`

[up](/manual/vote-note.php?id=128544&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=128544&page=session.configuration&vote=down "Vote down!")

-1

[***descartavel1+php at gmail dot com***](#128544) [¶](#128544)**1 year ago**
`You should set `session.name` to use either prefix `__Host-` or `__Secure-`. See <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes>`

[up](/manual/vote-note.php?id=126568&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=126568&page=session.configuration&vote=down "Vote down!")

-5

[***polygon dot co dot in at gmail dot com***](#126568) [¶](#126568)**3 years ago**
`In php.ini, session.save_handler defines the name of the handler which is used for storing and retrieving data associated with a session. [Defaults to files.]

By default session.save_handler has support for below

session.save_handler = files
session.save_handler = sqlite
session.save_handler = redis
session.save_handler = memcached

These locks the session by default for any HTTP request using session.
Locking means, a user can't access session related pages until current request is completed.

So, if you are thinking that switching to these will increase performance; the answer is NO! because of locking behaviour.

To overcome/customise the session locking behaviour use as below.

session.save_handler = user
This is for all (including list above) modes of session storage.

For "user" type save_handler, we can ignore locks for better performance (as explained in function session_set_save_handler). But for this we need to take care to use sessions only for authenticity and not for passing data from one script to other.

For passing data accross scripts use GET method to achieve the goal.`

[＋add a note](/manual/add-note.php?sect=session.configuration&repo=en&redirect=https://www.php.net/manual/en/session.configuration.php)

* [Installing/Configuring](session.setup.php)
  + [Requirements](session.requirements.php "Requirements")
  + [Installation](session.installation.php "Installation")
  + [Runtime Configuration](session.configuration.php "Runtime Configuration")

* [Copyright © 2001-2025 The PHP Documentation Group](/manual/en/copyright.php)
* [My PHP.net](/my.php)
* [Contact](/contact.php)
* [Other PHP.net sites](/sites.php)
* [Privacy policy](/privacy.php)

![To Top](/images/to-top@2x.png)

`↑` and `↓` to navigate •
`Enter` to select •
`Esc` to close

Press `Enter` without
selection to search using Google



=== Content from www.php.net_db61b829_20250115_093722.html ===

[![](/images/logos/php-logo-white.svg)](/)

* [Downloads](/downloads.php)
* [Documentation](/docs.php)
* [Get Involved](/get-involved.php)
* [Help](/support.php)
* [![PHP 8.4](/images/php8/logo_php8_4.svg)](/releases/8.4/index.php)

 Search docs

[API Platform Conference 2025](/conferences/index.php#2025-01-13-1)
[Getting Started](/manual/en/getting-started.php)
[Introduction](/manual/en/introduction.php)
[A simple tutorial](/manual/en/tutorial.php)
[Language Reference](/manual/en/langref.php)
[Basic syntax](/manual/en/language.basic-syntax.php)
[Types](/manual/en/language.types.php)
[Variables](/manual/en/language.variables.php)
[Constants](/manual/en/language.constants.php)
[Expressions](/manual/en/language.expressions.php)
[Operators](/manual/en/language.operators.php)
[Control Structures](/manual/en/language.control-structures.php)
[Functions](/manual/en/language.functions.php)
[Classes and Objects](/manual/en/language.oop5.php)
[Namespaces](/manual/en/language.namespaces.php)
[Enumerations](/manual/en/language.enumerations.php)
[Errors](/manual/en/language.errors.php)
[Exceptions](/manual/en/language.exceptions.php)
[Fibers](/manual/en/language.fibers.php)
[Generators](/manual/en/language.generators.php)
[Attributes](/manual/en/language.attributes.php)
[References Explained](/manual/en/language.references.php)
[Predefined Variables](/manual/en/reserved.variables.php)
[Predefined Exceptions](/manual/en/reserved.exceptions.php)
[Predefined Interfaces and Classes](/manual/en/reserved.interfaces.php)
[Predefined Attributes](/manual/en/reserved.attributes.php)
[Context options and parameters](/manual/en/context.php)
[Supported Protocols and Wrappers](/manual/en/wrappers.php)

[Security](/manual/en/security.php)
[Introduction](/manual/en/security.intro.php)
[General considerations](/manual/en/security.general.php)
[Installed as CGI binary](/manual/en/security.cgi-bin.php)
[Installed as an Apache module](/manual/en/security.apache.php)
[Session Security](/manual/en/security.sessions.php)
[Filesystem Security](/manual/en/security.filesystem.php)
[Database Security](/manual/en/security.database.php)
[Error Reporting](/manual/en/security.errors.php)
[User Submitted Data](/manual/en/security.variables.php)
[Hiding PHP](/manual/en/security.hiding.php)
[Keeping Current](/manual/en/security.current.php)
[Features](/manual/en/features.php)
[HTTP authentication with PHP](/manual/en/features.http-auth.php)
[Cookies](/manual/en/features.cookies.php)
[Sessions](/manual/en/features.sessions.php)
[Handling file uploads](/manual/en/features.file-upload.php)
[Using remote files](/manual/en/features.remote-files.php)
[Connection handling](/manual/en/features.connection-handling.php)
[Persistent Database Connections](/manual/en/features.persistent-connections.php)
[Command line usage](/manual/en/features.commandline.php)
[Garbage Collection](/manual/en/features.gc.php)
[DTrace Dynamic Tracing](/manual/en/features.dtrace.php)

[Function Reference](/manual/en/funcref.php)
[Affecting PHP's Behaviour](/manual/en/refs.basic.php.php)
[Audio Formats Manipulation](/manual/en/refs.utilspec.audio.php)
[Authentication Services](/manual/en/refs.remote.auth.php)
[Command Line Specific Extensions](/manual/en/refs.utilspec.cmdline.php)
[Compression and Archive Extensions](/manual/en/refs.compression.php)
[Cryptography Extensions](/manual/en/refs.crypto.php)
[Database Extensions](/manual/en/refs.database.php)
[Date and Time Related Extensions](/manual/en/refs.calendar.php)
[File System Related Extensions](/manual/en/refs.fileprocess.file.php)
[Human Language and Character Encoding Support](/manual/en/refs.international.php)
[Image Processing and Generation](/manual/en/refs.utilspec.image.php)
[Mail Related Extensions](/manual/en/refs.remote.mail.php)
[Mathematical Extensions](/manual/en/refs.math.php)
[Non-Text MIME Output](/manual/en/refs.utilspec.nontext.php)
[Process Control Extensions](/manual/en/refs.fileprocess.process.php)
[Other Basic Extensions](/manual/en/refs.basic.other.php)
[Other Services](/manual/en/refs.remote.other.php)
[Search Engine Extensions](/manual/en/refs.search.php)
[Server Specific Extensions](/manual/en/refs.utilspec.server.php)
[Session Extensions](/manual/en/refs.basic.session.php)
[Text Processing](/manual/en/refs.basic.text.php)
[Variable and Type Related Extensions](/manual/en/refs.basic.vartype.php)
[Web Services](/manual/en/refs.webservice.php)
[Windows Only Extensions](/manual/en/refs.utilspec.windows.php)
[XML Manipulation](/manual/en/refs.xml.php)
[GUI Extensions](/manual/en/refs.ui.php)

Keyboard Shortcuts?
This help
j
Next menu item
k
Previous menu item
g p
Previous man page
g n
Next man page
G
Scroll to bottom
g g
Scroll to top
g h
Goto homepage
g s
Goto search
(current page)
/
Focus search box

[SessionHandlerInterface::open »](sessionhandlerinterface.open.php)

[« SessionHandlerInterface::destroy](sessionhandlerinterface.destroy.php)

* [PHP Manual](index.php)
* [Function Reference](funcref.php)
* [Session Extensions](refs.basic.session.php)
* [Sessions](book.session.php)
* [SessionHandlerInterface](class.sessionhandlerinterface.php)

Change language:
English
German
Spanish
French
Italian
Japanese
Brazilian Portuguese
Russian
Turkish
Ukrainian
Chinese (Simplified)
Other

# SessionHandlerInterface::gc

(PHP 5 >= 5.4.0, PHP 7, PHP 8)

SessionHandlerInterface::gc — Cleanup old sessions

### Description

public **SessionHandlerInterface::gc**([int](language.types.integer.php) `$max_lifetime`): [int](language.types.integer.php)|[false](language.types.value.php)

Cleans up expired sessions. Called by [session\_start()](function.session-start.php),
based on [session.gc\_divisor](session.configuration.php#ini.session.gc-divisor),
[session.gc\_probability](session.configuration.php#ini.session.gc-probability) and
[session.gc\_maxlifetime](session.configuration.php#ini.session.gc-maxlifetime) settings.

### Parameters

`max_lifetime`

Sessions that have not updated for the last `max_lifetime` seconds will be removed.

### Return Values

Returns the number of deleted sessions on success, or **`[false](reserved.constants.php#constant.false)`** on failure.
Note this value is returned internally to PHP for processing.

### Changelog

| Version | Description |
| --- | --- |
| 7.1.0 | Prior to this version, the function returned **`[true](reserved.constants.php#constant.true)`** on success. |

### Found A Problem?

[Learn How To Improve This Page](https://github.com/php/doc-base/blob/master/README.md "This will take you to our contribution guidelines on GitHub")
•
[Submit a Pull Request](https://github.com/php/doc-en/blob/master/reference/session/sessionhandlerinterface/gc.xml)
•
[Report a Bug](https://github.com/php/doc-en/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fsessionhandlerinterface.gc%0A%0A---)

[＋add a note](/manual/add-note.php?sect=sessionhandlerinterface.gc&repo=en&redirect=https://www.php.net/manual/en/sessionhandlerinterface.gc.php)
### User Contributed Notes

There are no user contributed notes for this page.

* [SessionHandlerInterface](class.sessionhandlerinterface.php)
  + [close](sessionhandlerinterface.close.php "close")
  + [destroy](sessionhandlerinterface.destroy.php "destroy")
  + [gc](sessionhandlerinterface.gc.php "gc")
  + [open](sessionhandlerinterface.open.php "open")
  + [read](sessionhandlerinterface.read.php "read")
  + [write](sessionhandlerinterface.write.php "write")

* [Copyright © 2001-2025 The PHP Documentation Group](/manual/en/copyright.php)
* [My PHP.net](/my.php)
* [Contact](/contact.php)
* [Other PHP.net sites](/sites.php)
* [Privacy policy](/privacy.php)

![To Top](/images/to-top@2x.png)

`↑` and `↓` to navigate •
`Enter` to select •
`Esc` to close

Press `Enter` without
selection to search using Google



=== Content from github.com_b306656d_20250115_093718.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fcommit%2F7ce61c34d962ca8b5dce776289ddf4b207be6e78)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fcommit%2F7ce61c34d962ca8b5dce776289ddf4b207be6e78)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=kanboard%2Fkanboard)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[kanboard](/kanboard)
/
**[kanboard](/kanboard/kanboard)**
Public

* [Notifications](/login?return_to=%2Fkanboard%2Fkanboard) You must be signed in to change notification settings
* [Fork
  1.8k](/login?return_to=%2Fkanboard%2Fkanboard)
* [Star
   8.6k](/login?return_to=%2Fkanboard%2Fkanboard)

* [Code](/kanboard/kanboard)
* [Issues
  152](/kanboard/kanboard/issues)
* [Pull requests
  6](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

Additional navigation options

* [Code](/kanboard/kanboard)
* [Issues](/kanboard/kanboard/issues)
* [Pull requests](/kanboard/kanboard/pulls)
* [Discussions](/kanboard/kanboard/discussions)
* [Actions](/kanboard/kanboard/actions)
* [Security](/kanboard/kanboard/security)
* [Insights](/kanboard/kanboard/pulse)

## Commit

[Permalink](/kanboard/kanboard/commit/7ce61c34d962ca8b5dce776289ddf4b207be6e78)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix: verify the session hasn't expired before returning data

[Browse files](/kanboard/kanboard/tree/7ce61c34d962ca8b5dce776289ddf4b207be6e78)
Browse the repository at this point in the history

* Loading branch information

[![@fguillot](https://avatars.githubusercontent.com/u/323546?s=40&v=4)](/fguillot)

[fguillot](/kanboard/kanboard/commits?author=fguillot "View all commits by fguillot")
committed
Dec 8, 2024

1 parent
[551effd](/kanboard/kanboard/commit/551effd67bc94f8461c0f7a29339707d96afc1f4)

commit 7ce61c3

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**6 additions**
and
**1 deletion**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* app/Core/Session

  + app/Core/Session/SessionHandler.php
    [SessionHandler.php](#diff-7d0b7f20b6929cc5a27c0cf3789034744a1542da3a0eadc0d4ad36d7586c3832)
* docker/etc/php83/conf.d

  + docker/etc/php83/conf.d/local.ini
    [local.ini](#diff-3afe5bdfaf50eb41455433a89ff5bdb7155ca7bea7e9a03891de63d186192898)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[app/Core/Session/SessionHandler.php](#diff-7d0b7f20b6929cc5a27c0cf3789034744a1542da3a0eadc0d4ad36d7586c3832 "app/Core/Session/SessionHandler.php")

Show comments

[View file](/kanboard/kanboard/blob/7ce61c34d962ca8b5dce776289ddf4b207be6e78/app/Core/Session/SessionHandler.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -51,7 +51,10 @@ public function open($savePath, $name) |
|  |  | #[\ReturnTypeWillChange] |
|  |  | public function read($sessionID) |
|  |  | { |
|  |  | $result = $this->db->table(self::TABLE)->eq('id', $sessionID)->findOneColumn('data'); |
|  |  | $result = $this->db->table(self::TABLE)->eq('id', $sessionID)->gt('expire\_at', time())->findOneColumn('data'); |
|  |  |  |
|  |  | // Note: Returning false display an error message and write() is never called |
|  |  | // preventing new sessions to be created when calling session\_start() |
|  |  | return $result ?: ''; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[docker/etc/php83/conf.d/local.ini](#diff-3afe5bdfaf50eb41455433a89ff5bdb7155ca7bea7e9a03891de63d186192898 "docker/etc/php83/conf.d/local.ini")

Show comments

[View file](/kanboard/kanboard/blob/7ce61c34d962ca8b5dce776289ddf4b207be6e78/docker/etc/php83/conf.d/local.ini)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,3 +13,5 @@ opcache.save\_comments = 0 |
|  |  | opcache.enable\_file\_override = 1 |
|  |  | opcache.jit\_buffer\_size = 100M |
|  |  | opcache.jit = tracing |
|  |  | session.gc\_divisor = 100 |
|  |  | session.gc\_probability = 15 |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7ce61c3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fkanboard%2Fkanboard%2Fcommit%2F7ce61c34d962ca8b5dce776289ddf4b207be6e78) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.php.net_8d5c6fab_20250115_093722.html ===

[![](/images/logos/php-logo-white.svg)](/)

* [Downloads](/downloads.php)
* [Documentation](/docs.php)
* [Get Involved](/get-involved.php)
* [Help](/support.php)
* [![PHP 8.4](/images/php8/logo_php8_4.svg)](/releases/8.4/index.php)

 Search docs

[API Platform Conference 2025](/conferences/index.php#2025-01-13-1)
[Getting Started](/manual/en/getting-started.php)
[Introduction](/manual/en/introduction.php)
[A simple tutorial](/manual/en/tutorial.php)
[Language Reference](/manual/en/langref.php)
[Basic syntax](/manual/en/language.basic-syntax.php)
[Types](/manual/en/language.types.php)
[Variables](/manual/en/language.variables.php)
[Constants](/manual/en/language.constants.php)
[Expressions](/manual/en/language.expressions.php)
[Operators](/manual/en/language.operators.php)
[Control Structures](/manual/en/language.control-structures.php)
[Functions](/manual/en/language.functions.php)
[Classes and Objects](/manual/en/language.oop5.php)
[Namespaces](/manual/en/language.namespaces.php)
[Enumerations](/manual/en/language.enumerations.php)
[Errors](/manual/en/language.errors.php)
[Exceptions](/manual/en/language.exceptions.php)
[Fibers](/manual/en/language.fibers.php)
[Generators](/manual/en/language.generators.php)
[Attributes](/manual/en/language.attributes.php)
[References Explained](/manual/en/language.references.php)
[Predefined Variables](/manual/en/reserved.variables.php)
[Predefined Exceptions](/manual/en/reserved.exceptions.php)
[Predefined Interfaces and Classes](/manual/en/reserved.interfaces.php)
[Predefined Attributes](/manual/en/reserved.attributes.php)
[Context options and parameters](/manual/en/context.php)
[Supported Protocols and Wrappers](/manual/en/wrappers.php)

[Security](/manual/en/security.php)
[Introduction](/manual/en/security.intro.php)
[General considerations](/manual/en/security.general.php)
[Installed as CGI binary](/manual/en/security.cgi-bin.php)
[Installed as an Apache module](/manual/en/security.apache.php)
[Session Security](/manual/en/security.sessions.php)
[Filesystem Security](/manual/en/security.filesystem.php)
[Database Security](/manual/en/security.database.php)
[Error Reporting](/manual/en/security.errors.php)
[User Submitted Data](/manual/en/security.variables.php)
[Hiding PHP](/manual/en/security.hiding.php)
[Keeping Current](/manual/en/security.current.php)
[Features](/manual/en/features.php)
[HTTP authentication with PHP](/manual/en/features.http-auth.php)
[Cookies](/manual/en/features.cookies.php)
[Sessions](/manual/en/features.sessions.php)
[Handling file uploads](/manual/en/features.file-upload.php)
[Using remote files](/manual/en/features.remote-files.php)
[Connection handling](/manual/en/features.connection-handling.php)
[Persistent Database Connections](/manual/en/features.persistent-connections.php)
[Command line usage](/manual/en/features.commandline.php)
[Garbage Collection](/manual/en/features.gc.php)
[DTrace Dynamic Tracing](/manual/en/features.dtrace.php)

[Function Reference](/manual/en/funcref.php)
[Affecting PHP's Behaviour](/manual/en/refs.basic.php.php)
[Audio Formats Manipulation](/manual/en/refs.utilspec.audio.php)
[Authentication Services](/manual/en/refs.remote.auth.php)
[Command Line Specific Extensions](/manual/en/refs.utilspec.cmdline.php)
[Compression and Archive Extensions](/manual/en/refs.compression.php)
[Cryptography Extensions](/manual/en/refs.crypto.php)
[Database Extensions](/manual/en/refs.database.php)
[Date and Time Related Extensions](/manual/en/refs.calendar.php)
[File System Related Extensions](/manual/en/refs.fileprocess.file.php)
[Human Language and Character Encoding Support](/manual/en/refs.international.php)
[Image Processing and Generation](/manual/en/refs.utilspec.image.php)
[Mail Related Extensions](/manual/en/refs.remote.mail.php)
[Mathematical Extensions](/manual/en/refs.math.php)
[Non-Text MIME Output](/manual/en/refs.utilspec.nontext.php)
[Process Control Extensions](/manual/en/refs.fileprocess.process.php)
[Other Basic Extensions](/manual/en/refs.basic.other.php)
[Other Services](/manual/en/refs.remote.other.php)
[Search Engine Extensions](/manual/en/refs.search.php)
[Server Specific Extensions](/manual/en/refs.utilspec.server.php)
[Session Extensions](/manual/en/refs.basic.session.php)
[Text Processing](/manual/en/refs.basic.text.php)
[Variable and Type Related Extensions](/manual/en/refs.basic.vartype.php)
[Web Services](/manual/en/refs.webservice.php)
[Windows Only Extensions](/manual/en/refs.utilspec.windows.php)
[XML Manipulation](/manual/en/refs.xml.php)
[GUI Extensions](/manual/en/refs.ui.php)

Keyboard Shortcuts?
This help
j
Next menu item
k
Previous menu item
g p
Previous man page
g n
Next man page
G
Scroll to bottom
g g
Scroll to top
g h
Goto homepage
g s
Goto search
(current page)
/
Focus search box

[Predefined Constants »](session.constants.php)

[« Installation](session.installation.php)

* [PHP Manual](index.php)
* [Function Reference](funcref.php)
* [Session Extensions](refs.basic.session.php)
* [Sessions](book.session.php)
* [Installing/Configuring](session.setup.php)

Change language:
English
German
Spanish
French
Italian
Japanese
Brazilian Portuguese
Russian
Turkish
Ukrainian
Chinese (Simplified)
Other

## Runtime Configuration

The behaviour of these functions is affected by settings in php.ini.

**Session configuration options**
| Name | Default | Changeable | Changelog |
| --- | --- | --- | --- |
| [session.save\_path](session.configuration.php#ini.session.save-path) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.name](session.configuration.php#ini.session.name) | "PHPSESSID" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.save\_handler](session.configuration.php#ini.session.save-handler) | "files" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.auto\_start](session.configuration.php#ini.session.auto-start) | "0" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.gc\_probability](session.configuration.php#ini.session.gc-probability) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.gc\_divisor](session.configuration.php#ini.session.gc-divisor) | "100" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.gc\_maxlifetime](session.configuration.php#ini.session.gc-maxlifetime) | "1440" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.serialize\_handler](session.configuration.php#ini.session.serialize-handler) | "php" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_lifetime](session.configuration.php#ini.session.cookie-lifetime) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_path](session.configuration.php#ini.session.cookie-path) | "/" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_domain](session.configuration.php#ini.session.cookie-domain) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_secure](session.configuration.php#ini.session.cookie-secure) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Prior to PHP 7.2.0, the default was `""`. |
| [session.cookie\_httponly](session.configuration.php#ini.session.cookie-httponly) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Prior to PHP 7.2.0, the default was `""`. |
| [session.cookie\_samesite](session.configuration.php#ini.session.cookie-samesite) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.3.0. |
| [session.use\_strict\_mode](session.configuration.php#ini.session.use-strict-mode) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_cookies](session.configuration.php#ini.session.use-cookies) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_only\_cookies](session.configuration.php#ini.session.use-only-cookies) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.referer\_check](session.configuration.php#ini.session.referer-check) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cache\_limiter](session.configuration.php#ini.session.cache-limiter) | "nocache" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cache\_expire](session.configuration.php#ini.session.cache-expire) | "180" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_trans\_sid](session.configuration.php#ini.session.use-trans-sid) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.trans\_sid\_tags](session.configuration.php#ini.session.trans-sid-tags) | "a=href,area=href,frame=src,form=" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. |
| [session.trans\_sid\_hosts](session.configuration.php#ini.session.trans-sid-hosts) | `$_SERVER['HTTP_HOST']` | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. |
| [session.sid\_length](session.configuration.php#ini.session.sid-length) | "32" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. Deprecated as of PHP 8.4.0. |
| [session.sid\_bits\_per\_character](session.configuration.php#ini.session.sid-bits-per-character) | "4" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. Deprecated as of PHP 8.4.0. |
| [session.upload\_progress.enabled](session.configuration.php#ini.session.upload-progress.enabled) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.cleanup](session.configuration.php#ini.session.upload-progress.cleanup) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.prefix](session.configuration.php#ini.session.upload-progress.prefix) | "upload\_progress\_" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.name](session.configuration.php#ini.session.upload-progress.name) | "PHP\_SESSION\_UPLOAD\_PROGRESS" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.freq](session.configuration.php#ini.session.upload-progress.freq) | "1%" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.min\_freq](session.configuration.php#ini.session.upload-progress.min-freq) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.lazy\_write](session.configuration.php#ini.session.lazy-write) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.hash\_function](session.configuration.php#ini.session.hash-function) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.hash\_bits\_per\_character](session.configuration.php#ini.session.hash-bits-per-character) | "4" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.entropy\_file](session.configuration.php#ini.session.entropy-file) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.entropy\_length](session.configuration.php#ini.session.entropy-length) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0 |

For further details and definitions of the
INI\_\* modes, see the [Where a configuration setting may be set](configuration.changes.modes.php).

The session management system supports a number of configuration
options which you can place in your php.ini file. We will give a
short overview.
`session.save_handler`
[string](language.types.string.php)

`session.save_handler` defines the name of the
handler which is used for storing and retrieving data
associated with a session. Defaults to
`files`. Note that individual extensions may register
their own `save_handler`s; registered handlers can be
obtained on a per-installation basis by referring to
[phpinfo()](function.phpinfo.php). See also
[session\_set\_save\_handler()](function.session-set-save-handler.php).

`session.save_path`
[string](language.types.string.php)

`session.save_path` defines the argument which
is passed to the save handler. If you choose the default files
handler, this is the path where the files are created. See also
[session\_save\_path()](function.session-save-path.php).

There is an optional `N` argument to this directive that determines
the number of directory levels your session files will be spread
around in. For example, setting to `'5;/tmp'`
may end up creating a session file and location like
`/tmp/4/b/1/e/3/sess_4b1e384ad74619bd212e236e52a5a174If`. In order to use `N` you must create all of these
directories before use. A small shell script exists in
ext/session to do this, it's called
mod\_files.sh, with a Windows version called
mod\_files.bat. Also note that if `N` is
used and greater than 0 then automatic garbage collection will
not be performed, see a copy of php.ini for further
information. Also, if you use `N`, be sure to surround
`session.save_path` in
"quotes" because the separator (`;`) is
also used for comments in php.ini.

The file storage module creates files using mode 600 by default.
This default can be changed with the optional `MODE` argument:
`N;MODE;/path` where `MODE` is the octal
representation of the mode.
Setting `MODE` does not affect the process umask.

**Warning**

If this is set to a world-readable directory, such as
/tmp (the default), other users on the
server may be able to hijack sessions by getting the list of
files in that directory.

**Caution**

When using the optional directory level argument `N`,
as described above, note that using a value higher than 1 or 2 is
inappropriate for most sites due to the large number of directories
required: for example, a value of 3 implies that `(2 ** session.sid_bits_per_character) ** 3`
directories exist on the filesystem, which can result in a lot of wasted
space and inodes.

Only use `N` greater than 2 if you are absolutely
certain that your site is large enough to require it.

`session.name`
[string](language.types.string.php)

`session.name` specifies the name of the
session which is used as cookie name. It should only contain
alphanumeric characters. Defaults to `PHPSESSID`.
See also [session\_name()](function.session-name.php).

`session.auto_start`
[bool](language.types.boolean.php)

`session.auto_start` specifies whether the
session module starts a session automatically on request
startup. Defaults to `0` (disabled).

`session.serialize_handler`
[string](language.types.string.php)

`session.serialize_handler` defines the name of
the handler which is used to serialize/deserialize data. PHP
serialize format (name `php_serialize`), PHP
internal formats (name `php` and
`php_binary`) and WDDX are supported (name
`wddx`). WDDX is only available, if PHP is
compiled with [WDDX
support](ref.wddx.php). `php_serialize` uses plain
serialize/unserialize function internally and does not have
limitations that `php`
and `php_binary` have. Older serialize handlers
cannot store numeric index nor string index contains special
characters (`|` and `!`) in
$\_SESSION. Use `php_serialize` to avoid numeric
index or special character errors at script shutdown. Defaults
to `php`.

`session.gc_probability`
[int](language.types.integer.php)

`session.gc_probability` in conjunction with
`session.gc_divisor` is used to manage probability
that the gc (garbage collection) routine is started.
Defaults to `1`. Must be greater than or equal to `0`. See [session.gc\_divisor](session.configuration.php#ini.session.gc-divisor) for details.

`session.gc_divisor`
[int](language.types.integer.php)

`session.gc_divisor` coupled with
`session.gc_probability` defines the probability
that the gc (garbage collection) process is started on every session
initialization.
The probability is calculated by using gc\_probability/gc\_divisor,
e.g. 1/100 means there is a 1% chance that the GC process starts
on each request.
`session.gc_divisor` defaults to `100`.
Must be greater than `0`.

`session.gc_maxlifetime`
[int](language.types.integer.php)

`session.gc_maxlifetime` specifies the number
of seconds after which data will be seen as 'garbage' and
potentially cleaned up. Garbage collection may occur during session start
(depending on [session.gc\_probability](session.configuration.php#ini.session.gc-probability) and
[session.gc\_divisor](session.configuration.php#ini.session.gc-divisor)).
Defaults to `1440` (24 minutes).
> **Note**:
> If different scripts have different values of
> `session.gc_maxlifetime` but share the same place for
> storing the session data then the script with the minimum value will be
> cleaning the data. In this case, use this directive together with [session.save\_path](session.configuration.php#ini.session.save-path).

`session.referer_check`
[string](language.types.string.php)

`session.referer_check` contains the
substring you want to check each HTTP Referer for. If the
Referer was sent by the client and the substring was not
found, the embedded session id will be marked as invalid.
Defaults to the empty string.

`session.entropy_file`
[string](language.types.string.php)

`session.entropy_file` gives a path to an
external resource (file) which will be used as an additional
entropy source in the session id creation process. Examples are
`/dev/random` or `/dev/urandom`
which are available on many Unix systems.

This feature is supported on Windows. Setting
`session.entropy_length` to a non zero value
will make PHP use the Windows Random API as entropy source.
> **Note**:
> Removed in PHP 7.1.0.
>
> `session.entropy_file` defaults
> to `/dev/urandom` or `/dev/arandom`
> if it is available.

`session.entropy_length`
[int](language.types.integer.php)

`session.entropy_length` specifies the number
of bytes which will be read from the file specified
above. Defaults to `32`.

Removed in PHP 7.1.0.

`session.use_strict_mode`
[bool](language.types.boolean.php)

`session.use_strict_mode` specifies whether the
module will use strict session id mode. If this mode is enabled,
the module does not accept uninitialized session IDs. If an uninitialized
session ID is sent from the browser, a new session ID is sent to the browser.
Applications are protected from session fixation via session adoption
with strict mode.
Defaults to `0` (disabled).
> **Note**:
> Enabling `session.use_strict_mode` is mandatory for
> general session security. All sites are advised to enable this. See
> [session\_create\_id()](function.session-create-id.php) example code for more details.

**Warning**

If a custom session handler registered via [session\_set\_save\_handler()](function.session-set-save-handler.php)
does not implement [SessionUpdateTimestampHandlerInterface::validateId()](sessionupdatetimestamphandlerinterface.validateid.php),
nor supplies the `validate_sid` callback, respectively,
strict session ID mode is effectively disabled, regardless of the value of this directive.
Particularly note that [SessionHandler](class.sessionhandler.php) does *not*
implement **SessionHandler::validateId()**.

`session.use_cookies`
[bool](language.types.boolean.php)

`session.use_cookies` specifies whether the
module will use cookies to store the session id on the client
side. Defaults to `1` (enabled).

`session.use_only_cookies`
[bool](language.types.boolean.php)

`session.use_only_cookies` specifies whether
the module will **only** use
cookies to store the session id on the client side.
Enabling this setting prevents attacks that involve passing session
IDs in URLs.
Defaults to `1` (enabled).

`session.cookie_lifetime`
[int](language.types.integer.php)

`session.cookie_lifetime` specifies the lifetime of
the cookie in seconds which is sent to the browser. The value 0
means "until the browser is closed." Defaults to
`0`. See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).
> **Note**:
> The expiration timestamp is set relative to the server time, which is
> not necessarily the same as the time in the client's browser.

`session.cookie_path`
[string](language.types.string.php)

`session.cookie_path` specifies path to set
in the session cookie. Defaults to `/`. See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_domain`
[string](language.types.string.php)

`session.cookie_domain` specifies the domain to
set in the session cookie. Default is none at all meaning the host name of
the server which generated the cookie according to cookies specification.
See also [session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_secure`
[bool](language.types.boolean.php)

`session.cookie_secure` specifies whether
cookies should only be sent over secure connections. With this option set
to `on`, sessions only work with HTTPS connections.
If it is `off`, then sessions work with both HTTP and
HTTPS connections. Defaults to `off`.
See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_httponly`
[bool](language.types.boolean.php)

Marks the cookie as accessible only through the HTTP protocol. This means
that the cookie won't be accessible by scripting languages, such as
JavaScript. This setting can effectively help to reduce identity theft
through XSS attacks (although it is not supported by all browsers).

`session.cookie_samesite`
[string](language.types.string.php)

Allows servers to assert that a cookie ought not to be sent along with
cross-site requests. This assertion allows user agents to mitigate the risk
of cross-origin information leakage, and provides some protection against
cross-site request forgery attacks. Note that this is not supported by all
browsers.
An empty value means that no SameSite cookie attribute will be set.
`Lax` and `Strict` mean that the cookie
will not be sent cross-domain for POST requests; `Lax`
will send the cookie for cross-domain GET requests, while `Strict`
will not.

`session.cache_limiter`
[string](language.types.string.php)

`session.cache_limiter` specifies the cache
control method used for session pages.
It may be one of the following values:
`nocache`, `private`,
`private_no_expire`, or `public`.
Defaults to `nocache`. See also the
[session\_cache\_limiter()](function.session-cache-limiter.php) documentation for
information about what these values mean.

`session.cache_expire`
[int](language.types.integer.php)

`session.cache_expire` specifies time-to-live
for cached session pages in minutes, this has no effect for
nocache limiter. Defaults to `180`. See also
[session\_cache\_expire()](function.session-cache-expire.php).

`session.use_trans_sid`
[bool](language.types.boolean.php)

`session.use_trans_sid` whether transparent
sid support is enabled or not. Defaults to
`0` (disabled).
> **Note**:
> URL based session management has additional security risks
> compared to cookie based session management. Users may send
> a URL that contains an active session ID to their friends by
> email or users may save a URL that contains a session ID to
> their bookmarks and access your site with the same session ID
> always, for example.
>
> Since PHP 7.1.0, full URL path, e.g. https://php.net/, is
> handled by trans sid feature. Previous PHP handled relative
> URL path only. Rewrite target hosts are defined by [session.trans\_sid\_hosts](session.configuration.php#ini.session.trans-sid-hosts).

`session.trans_sid_tags`
[string](language.types.string.php)

`session.trans_sid_tags` specifies which HTML tags
are rewritten to include session id when transparent sid support
is enabled. Defaults to
`a=href,area=href,frame=src,input=src,form=`

`form` is special tag. `<input hidden="session_id" name="session_name">`
is added as form variable.
> **Note**:
> Before PHP 7.1.0, [url\_rewriter.tags](outcontrol.configuration.php#ini.url-rewriter.tags)
> was used for this purpose. Since PHP 7.1.0, `fieldset`
> is no longer considered as special tag.

`session.trans_sid_hosts`
[string](language.types.string.php)

`session.trans_sid_hosts` specifies which hosts
are rewritten to include session id when transparent sid support
is enabled. Defaults to `$_SERVER['HTTP_HOST']`
Multiple hosts can be specified by ",", no space is allowed
between hosts. e.g. `php.net,wiki.php.net,bugs.php.net`

`session.sid_length`
[int](language.types.integer.php)

`session.sid_length` allows you to specify the
length of session ID string. Session ID length can be between 22
to 256.

The default is 32. If you need compatibility you may specify 32,
40, etc. Longer session ID is harder to guess. At least 32 chars
are recommended.

**Tip**

Compatibility Note: Use 32 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=4,
`session.hash_function`=1 (SHA1) and
`session.hash_bits_per_character`=6. Use 26 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=5. Use 22 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=6. You must
configure INI values to have at least 128 bits in session ID. Do
not forget to set an appropriate value for
`session.sid_bits_per_character`, otherwise you
will have weaker session ID.

> **Note**:
> This setting is introduced in PHP 7.1.0.

`session.sid_bits_per_character`
[int](language.types.integer.php)

`session.sid_bits_per_character` allows you to specify the
number of bits in encoded session ID character. The possible values are
'4' (0-9, a-f), '5' (0-9, a-v), and '6' (0-9, a-z, A-Z, "-", ",").

The default is 4. The more bits results in stronger session ID. 5 is
recommended value for most environments.
> **Note**:
> This setting is introduced in PHP 7.1.0.

`session.hash_function`
[mixed](language.types.mixed.php)

`session.hash_function` allows you to specify the hash
algorithm used to generate the session IDs. '0' means MD5 (128 bits) and
'1' means SHA-1 (160 bits).

It is also possible to specify any of the algorithms
provided by the [hash extension](ref.hash.php) (if it is
available), like `sha512` or
`whirlpool`. A complete list of supported algorithms can
be obtained with the [hash\_algos()](function.hash-algos.php) function.

> **Note**:
> Removed in PHP 7.1.0.

`session.hash_bits_per_character`
[int](language.types.integer.php)

`session.hash_bits_per_character` allows you to define
how many bits are stored in each character when converting the binary
hash data to something readable. The possible values are '4' (0-9, a-f),
'5' (0-9, a-v), and '6' (0-9, a-z, A-Z, "-", ",").
> **Note**:
> Removed in PHP 7.1.0.

`session.upload_progress.enabled`
[bool](language.types.boolean.php)

Enables upload progress tracking, populating the [$\_SESSION](reserved.variables.session.php) variable.
Defaults to 1, enabled.

`session.upload_progress.cleanup`
[bool](language.types.boolean.php)

Cleanup the progress information as soon as all POST data has been read
(i.e. upload completed). Defaults to 1, enabled.
> **Note**:
> It is highly recommended to keep this feature enabled.

`session.upload_progress.prefix`
[string](language.types.string.php)

A prefix used for the upload progress key in the [$\_SESSION](reserved.variables.session.php).
This key will be concatenated with the value of
`$_POST[ini_get("session.upload_progress.name")]` to
provide a unique index.

Defaults to "upload\_progress\_".

`session.upload_progress.name`
[string](language.types.string.php)

The name of the key to be used in [$\_SESSION](reserved.variables.session.php) storing
the progress information. See also
[session.upload\_progress.prefix](session.configuration.php#ini.session.upload-progress.prefix).

If `$_POST[ini_get("session.upload_progress.name")]`
is not passed or available, upload progressing will not be recorded.

Defaults to "PHP\_SESSION\_UPLOAD\_PROGRESS".

`session.upload_progress.freq`
[mixed](language.types.mixed.php)

Defines how often the upload progress information should be updated.
This can be defined in bytes (i.e. "update progress information after every 100 bytes"), or in percentages (i.e. "update progress information after receiving every 1% of the whole filesize").

Defaults to "1%".

`session.upload_progress.min_freq`
[int](language.types.integer.php)

The minimum delay between updates, in seconds.
Defaults to "1" (one second).

`session.lazy_write`
[bool](language.types.boolean.php)

`session.lazy_write`, when set to 1, means that session
data is only rewritten if it changes. Defaults to 1, enabled.

Upload progress will not be registered unless
session.upload\_progress.enabled is enabled, and the
$\_POST[ini\_get("session.upload\_progress.name")] variable is set.
See [Session Upload Progress](session.upload-progress.php) for more details on this functionality.

### Found A Problem?

[Learn How To Improve This Page](https://github.com/php/doc-base/blob/master/README.md "This will take you to our contribution guidelines on GitHub")
•
[Submit a Pull Request](https://github.com/php/doc-en/blob/master/reference/session/ini.xml)
•
[Report a Bug](https://github.com/php/doc-en/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fsession.configuration%0A%0A---)

[＋add a note](/manual/add-note.php?sect=session.configuration&repo=en&redirect=https://www.php.net/manual/en/session.configuration.php)
### User Contributed Notes 21 notes

[up](/manual/vote-note.php?id=128936&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=128936&page=session.configuration&vote=down "Vote down!")

38

[***Walerian Walawski - https://w87.eu/***](#128936) [¶](#128936)**1 year ago**
`Can't find mod_files.sh? Here it is:`

[up](/manual/vote-note.php?id=115842&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=115842&page=session.configuration&vote=down "Vote down!")

79

[***Christopher Kramer***](#115842) [¶](#115842)**10 years ago**
`On debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP's own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime).

You can adjust the global value in your php.ini (usually /etc/php5/apache2/php.ini). Or you can change the session.save_path so debian's cronjob will not clean up your sessions anymore. Then you need to either do your own garbage collection with your own cronjob or enable PHP's garbage collection (php then needs sufficient privileges on the save_path).

Why does Debian not use PHP's garbarage collection?
For security reasons, they store session data in a place (/var/lib/php5) with very stringent permissions. With the sticky bit set, only root is allowed to rename or delete files there, so PHP itself cannot clean up old session data. See <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=267720> .`

[up](/manual/vote-note.php?id=129283&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129283&page=session.configuration&vote=down "Vote down!")

3

[***theking2(at)king.ma***](#129283) [¶](#129283)**10 months ago**
`Please be careful with the 'sid_length' when setting 'sid_bits_per_character' to six.

Setting sid_bits_per_character to 6 includes the character "," to the list of possible characters. A comma will be escaped and transmitted as "%2C" (tested on Chromium Version 119.0.6045.199) adding two extra characters for each comma to the SESSION_ID.`

[up](/manual/vote-note.php?id=129114&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129114&page=session.configuration&vote=down "Vote down!")

5

[***zch1***](#129114) [¶](#129114)**1 year ago**
`the pwd should be urlencode when it contanis special chars.
eg:

save_handler:redis
save_path: tcp://127.0.0.1:6739?auth=urlencode('xxxxx')`

[up](/manual/vote-note.php?id=115913&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=115913&page=session.configuration&vote=down "Vote down!")

19

[***GreenReaper***](#115913) [¶](#115913)**10 years ago**
`We found a session.save_path depth of 3 led to excessive wastage of inodes and in fact disk space in storing the directory tree. dir_indexes option on ext2/3/4 makes larger directories more feasible anyway, so we decided to move to a depth of 2 instead.

It took a little puzzling to figure out how to move the existing PHP sessions up one directory tree, but we ended up running this in the root sessions directory:

#!/bin/sh
for a in ./* ; do
 cd ./$a
 pwd
 for b in ./* ; do
 cd ./$b
 pwd
 # Move existing sessions out
 find ./* -xdev -type f -print0 | xargs -0 mv -t .
 # Remove subdirectories
 find ./* -xdev -type d -print0 | xargs -0 rmdir
 cd ..
 done
 cd ..
done

This script may not be the best way to do it, but it got the job done fast. You can modify it for different depths by adding or removing "for" loops.

The documentation gives a depth of 5 as an example, but five is right out. If you're going beyond 2, you're at the scale where you may want to to look at a large memcached or redis instance instead.`

[up](/manual/vote-note.php?id=117668&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=117668&page=session.configuration&vote=down "Vote down!")

16

[***info at thimbleopensource dot com***](#117668) [¶](#117668)**9 years ago**
`I found out that if you need to set custom session settings, you only need to do it once when session starts. Then session maintains its settings, even if you use ini_set and change them, original session still will use it's original setting until it expires.

Just thought it might be useful to someone.`

[up](/manual/vote-note.php?id=129300&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129300&page=session.configuration&vote=down "Vote down!")

1

[***theking2(at)king.ma***](#129300) [¶](#129300)**10 months ago**
`To prevent mitm-attacks you want to make sure the session cookie is only transmitted over a secure channel prefix it with the magic string "__Secure-". [1]

Like :
<?php
 session_start( [ 'name' => '__Secure-Session-ID' ] );
?>

The cookie will not be available on non-secure channel.

(Putting this note it here probably goes unnoticed because of all the noise)

[1]: <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes>`

[up](/manual/vote-note.php?id=97979&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=97979&page=session.configuration&vote=down "Vote down!")

10

[***Wouter***](#97979) [¶](#97979)**14 years ago**
`When setting the session.cookie_lifetime directive in a .htaccess use string format like;

php_value session.cookie_lifetime "123456"

and not

php_value session.cookie_lifetime 123456

Using a integer as stated above dit not work in my case (Apache/2.2.11 (Ubuntu) PHP/5.2.6-3ubuntu4.5 with Suhosin-Patch mod_ssl/2.2.11 OpenSSL/0.9.8g)`

[up](/manual/vote-note.php?id=111451&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=111451&page=session.configuration&vote=down "Vote down!")

8

[***jlevene at etisoftware dot com***](#111451) [¶](#111451)**11 years ago**
`Being unable to find an actual copy of mod_files.sh, and seeing lots of complaints/bug fix requests for it, here's one that works. It gets all its parameters from PHP.INI, so you don't have the opportunity to mess up:

#!/bin/bash
#
# Creates directories for PHP session storage.
# Replaces the one that "comes with" PHP, which (a) doesn't always come with it
# and (b) doesn't work so great.
#
# This version takes no parameters, and uses the values in PHP.INI (if it
# can find it).
#
# Works in OS-X and CentOS (and probably all other) Linux.
#
# Feb '13 by Jeff Levene.

[[ $# -gt 0 ]] && echo "$0 requires NO command-line parameters.
It gets does whatever is called for in the PHP.INI file (if it can find it).
" && exit 1

# Find the PHP.INI file, if possible:
phpIni=/usr/local/lib/php.ini # Default PHP.INI location
[[ ! -f "$phpIni" ]] && phpIni=/etc/php.ini # Secondary location
[[ ! -f "$phpIni" ]] && phpIni= # Found it?

# Outputs the given (as $1) parameter from the PHP.INI file:
# The "empty" brackets have a SPACE and a TAB in them.
#
PhpConfigParam() {
 [[ ! "$phpIni" ]] && return
 # Get the line from the INI file:
 varLine=`grep "^[ ]*$1[ ]*=" "$phpIni"`

 # Extract the value:
 value=`expr "$varLine" : ".*$1[ ]*=[ ]*['\"]*\([^'\"]*\)"`
 echo "$value"
 }

if [[ "$phpIni" ]]
then
 savePath=`PhpConfigParam session.save_path`
 # If there's a number and semicolon at the front, remove them:
 dirDepth=`expr "$savePath" : '\([0-9]*\)'`
 [[ "$dirDepth" ]] && savePath=`expr "$savePath" : '[0-9]*;\(.*\)'` || dirDepth=0
 bits=`PhpConfigParam session.hash_bits_per_character`
 case "x$bits" in
 x) echo "hash_bits_per_character not defined. Not running." ; exit 2 ;;
 x4) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f' ;;
 x5) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v' ;;
 x6) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v'
 alphabet="$alphabet w x y z A B C D E F G H I J K L M N O P Q R S T U V W"
 alphabet="$alphabet X Y Z - ,"
 ;;
 *) echo "unrecognized hash_bits_per_character. Not running." ; exit 2 ;;
 esac
else
 echo "Cannot find the PHP.INI file. Not running. Sorry."
 exit 2
fi

# The depth of directories to create is $1. 0 means just create the named
# directory. Directory to start with is $2.
#
# Used recursively, so variables must be "local".

doDir() {
 local dir="$2"
 if [[ -d "$dir" ]]
 then
 echo "Directory '$dir' already exists. No problem."
 elif [[ -f "$dir" ]]
 then
 echo "FILE '$dir' exists. Aborting." ; exit 2
 else
 if mkdir "$dir"
 then
 echo "Directory '$dir' created."
 else
 echo "Cannot create directory '$dir'. Aborting." ; exit 2
 fi
 fi
 chmod a+rwx "$dir"
 if [[ $1 -gt 0 ]]
 then
 local depth=$(( $1 - 1 ))
 for letter in $alphabet
 do doDir $depth "$dir/$letter"
 done
 fi
 }

echo "Running with savePath='$savePath', dirDepth=$dirDepth, and bitsPerCharacter=$bits."
sleep 3

doDir $dirDepth "$savePath"

exit 0`

[up](/manual/vote-note.php?id=123598&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=123598&page=session.configuration&vote=down "Vote down!")

3

[***boan dot web at outlook dot com***](#123598) [¶](#123598)**5 years ago**
`session.cache_limiter may be empty string to disable cache headers entirely.

Quote:
> Setting the cache limiter to '' will turn off automatic sending of cache headers entirely.

<http://php.net/manual/en/function.session-cache-limiter.php>`

[up](/manual/vote-note.php?id=107990&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=107990&page=session.configuration&vote=down "Vote down!")

7

[***hassankhodadadeh at NOSPAM dot gmail dot com***](#107990) [¶](#107990)**12 years ago**
`max value for "session.gc_maxlifetime" is 65535. values bigger than this may cause php session stops working.`

[up](/manual/vote-note.php?id=122042&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=122042&page=session.configuration&vote=down "Vote down!")

3

[***li-lingjie***](#122042) [¶](#122042)**7 years ago**
`Use SessionHandlerInterface interface Custom redis session, found the following:

Use ini_set ('session.save_path', "tcp: //127.0.0.1: 6379? Auth = password"); will be reported:

PHP Fatal error: session_start (): Failed to initialize storage module: user (path: tcp: //127.0.0.1: 6379? Auth = password);

Using session_save_path ("tcp: //127.0.0.1: 6379? Auth = password") will not`

[up](/manual/vote-note.php?id=99619&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=99619&page=session.configuration&vote=down "Vote down!")

2

[***Nicholas***](#99619) [¶](#99619)**14 years ago**
`Transient sessions do not appear to be working in 5.3.3

E.g.

<?php
 ini_set("session.use_cookies", 0);
 ini_set("session.use_trans_sid", 1);
 session_start();

 if (isset($_SESSION["foo"])) {
 echo "Foo: " . $_SESSION["foo"];
 } else {
 $_SESSION["foo"] = "Bar";
 echo "<a href=?" . session_name() . "=" . session_id() . ">Begin test</a>";
 }
?>

This works in 5.2.5, but not 5.3.3`

[up](/manual/vote-note.php?id=121913&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=121913&page=session.configuration&vote=down "Vote down!")

-1

[***ohcc at 163 dot com***](#121913) [¶](#121913)**7 years ago**
`You should take more care configuring session.gc_maxlifetime when virtual hosts share the same session-saving directory. One host's session data may be gc'ed when another host runs php.`

[up](/manual/vote-note.php?id=100855&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=100855&page=session.configuration&vote=down "Vote down!")

-2

[***AskApache***](#100855) [¶](#100855)**14 years ago**
`This is how I set my session.save_path
session.save_path = "1;/home/askapache/tmp/s"
So to create the folder structure you can use this compatible shell script, if you want to create with 777 permissions change the umask to 0000;
sh -o braceexpand -c "umask 0077;mkdir -p s/{0..9}/{a..z} s/{a..z}/{0..9}"

Then you can create a cronjob to clean the session folder by adding this to your crontab which deletes any session files older than an hour:
@daily find /home/askapache/tmp/s -type f -mmin +60 -exec rm -f {} \; &>/dev/null

That will create sessions in folder like:
 /home/askapache/tmp/s/b/sess_b1aba5q6io4lv01bpc6t52h0ift227j6

I don't think any non-mega site will need to go more than 1 levels deep. Otherwise you create so many directories that it slows the performance gained by this.`

[up](/manual/vote-note.php?id=84045&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=84045&page=session.configuration&vote=down "Vote down!")

-2

[***00 at f00n dot com***](#84045) [¶](#84045)**16 years ago**
`After having many problems with garbage collection not clearing my sessions I have resolved it through the following.

First I found this in the php.ini (not something i noticed as i use phpinfo(); to see my hosting ini).

; NOTE: If you are using the subdirectory option for storing session files
; (see session.save_path above), then garbage collection does *not*
; happen automatically. You will need to do your own garbage

; collection through a shell script, cron entry, or some other method. ; For example, the following script would is the equivalent of
; setting session.gc_maxlifetime to 1440 (1440 seconds = 24 minutes):
; cd /path/to/sessions; find -cmin +24 | xargs rm

With this is mind there are options.

1. dont use a custom save_path.
** This means if your isp hasnt defaulted your session temp to something safer than install default or you are using a shared directory for session data then you would be wise to use named sessions to keep your session from being viewable in other people's scripts. Creating a unique_id name for this is the common method. **

2. use your custom folder but write a garbage collection script.

3. use a custom handler and a database`

[up](/manual/vote-note.php?id=88552&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=88552&page=session.configuration&vote=down "Vote down!")

-2

[***mikaelkael at php dot net***](#88552) [¶](#88552)**15 years ago**
`Recently, I needed to change the session save_path in my program under Windows. With an ini_set('session.save_path', '../data/sessions'); (and session.gc_divisor = 1 for test), I always obtain 'Error #8 session_start(): ps_files_cleanup_dir: opendir(../data/sessions) failed: Result too large'.

I corrected this by changing with ini_set('session.save_path', realpath('../data/sessions'));`

[up](/manual/vote-note.php?id=122038&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=122038&page=session.configuration&vote=down "Vote down!")

-3

[***white-gandalf at web dot de***](#122038) [¶](#122038)**7 years ago**
`session.use_strict_mode does very little to strengthen your security: only one very specific variant of attack is migitated by this (where the attacker hands an "empty" sid to the victim to adapt his own browser to that session later) - versus for example the case where he pre-opens a session, handing the sid of that one to the victim, so the victim gets adapted to the pre-opened session. In the latter case this flag does nothing to help. In every other scenario with other vulnerabilities where the session id gets leaked, the flag helps nigher.

But this flag renders the php function session_id() useless in its parameterized variant, thus preventing any php functionality that builds upon this function.`

[up](/manual/vote-note.php?id=99671&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=99671&page=session.configuration&vote=down "Vote down!")

-4

[***orbill***](#99671) [¶](#99671)**14 years ago**
`apparently the default value for session.use_only_cookies has changed in 5.3.3 from 0 to 1. If you haven't set this in your php.ini or your code to 0 transparent sessions won't work.`

[up](/manual/vote-note.php?id=128544&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=128544&page=session.configuration&vote=down "Vote down!")

-1

[***descartavel1+php at gmail dot com***](#128544) [¶](#128544)**1 year ago**
`You should set `session.name` to use either prefix `__Host-` or `__Secure-`. See <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes>`

[up](/manual/vote-note.php?id=126568&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=126568&page=session.configuration&vote=down "Vote down!")

-5

[***polygon dot co dot in at gmail dot com***](#126568) [¶](#126568)**3 years ago**
`In php.ini, session.save_handler defines the name of the handler which is used for storing and retrieving data associated with a session. [Defaults to files.]

By default session.save_handler has support for below

session.save_handler = files
session.save_handler = sqlite
session.save_handler = redis
session.save_handler = memcached

These locks the session by default for any HTTP request using session.
Locking means, a user can't access session related pages until current request is completed.

So, if you are thinking that switching to these will increase performance; the answer is NO! because of locking behaviour.

To overcome/customise the session locking behaviour use as below.

session.save_handler = user
This is for all (including list above) modes of session storage.

For "user" type save_handler, we can ignore locks for better performance (as explained in function session_set_save_handler). But for this we need to take care to use sessions only for authenticity and not for passing data from one script to other.

For passing data accross scripts use GET method to achieve the goal.`

[＋add a note](/manual/add-note.php?sect=session.configuration&repo=en&redirect=https://www.php.net/manual/en/session.configuration.php)

* [Installing/Configuring](session.setup.php)
  + [Requirements](session.requirements.php "Requirements")
  + [Installation](session.installation.php "Installation")
  + [Runtime Configuration](session.configuration.php "Runtime Configuration")

* [Copyright © 2001-2025 The PHP Documentation Group](/manual/en/copyright.php)
* [My PHP.net](/my.php)
* [Contact](/contact.php)
* [Other PHP.net sites](/sites.php)
* [Privacy policy](/privacy.php)

![To Top](/images/to-top@2x.png)

`↑` and `↓` to navigate •
`Enter` to select •
`Esc` to close

Press `Enter` without
selection to search using Google



=== Content from www.php.net_8b7efd9c_20250115_093720.html ===

[![](/images/logos/php-logo-white.svg)](/)

* [Downloads](/downloads.php)
* [Documentation](/docs.php)
* [Get Involved](/get-involved.php)
* [Help](/support.php)
* [![PHP 8.4](/images/php8/logo_php8_4.svg)](/releases/8.4/index.php)

 Search docs

[API Platform Conference 2025](/conferences/index.php#2025-01-13-1)
[Getting Started](/manual/en/getting-started.php)
[Introduction](/manual/en/introduction.php)
[A simple tutorial](/manual/en/tutorial.php)
[Language Reference](/manual/en/langref.php)
[Basic syntax](/manual/en/language.basic-syntax.php)
[Types](/manual/en/language.types.php)
[Variables](/manual/en/language.variables.php)
[Constants](/manual/en/language.constants.php)
[Expressions](/manual/en/language.expressions.php)
[Operators](/manual/en/language.operators.php)
[Control Structures](/manual/en/language.control-structures.php)
[Functions](/manual/en/language.functions.php)
[Classes and Objects](/manual/en/language.oop5.php)
[Namespaces](/manual/en/language.namespaces.php)
[Enumerations](/manual/en/language.enumerations.php)
[Errors](/manual/en/language.errors.php)
[Exceptions](/manual/en/language.exceptions.php)
[Fibers](/manual/en/language.fibers.php)
[Generators](/manual/en/language.generators.php)
[Attributes](/manual/en/language.attributes.php)
[References Explained](/manual/en/language.references.php)
[Predefined Variables](/manual/en/reserved.variables.php)
[Predefined Exceptions](/manual/en/reserved.exceptions.php)
[Predefined Interfaces and Classes](/manual/en/reserved.interfaces.php)
[Predefined Attributes](/manual/en/reserved.attributes.php)
[Context options and parameters](/manual/en/context.php)
[Supported Protocols and Wrappers](/manual/en/wrappers.php)

[Security](/manual/en/security.php)
[Introduction](/manual/en/security.intro.php)
[General considerations](/manual/en/security.general.php)
[Installed as CGI binary](/manual/en/security.cgi-bin.php)
[Installed as an Apache module](/manual/en/security.apache.php)
[Session Security](/manual/en/security.sessions.php)
[Filesystem Security](/manual/en/security.filesystem.php)
[Database Security](/manual/en/security.database.php)
[Error Reporting](/manual/en/security.errors.php)
[User Submitted Data](/manual/en/security.variables.php)
[Hiding PHP](/manual/en/security.hiding.php)
[Keeping Current](/manual/en/security.current.php)
[Features](/manual/en/features.php)
[HTTP authentication with PHP](/manual/en/features.http-auth.php)
[Cookies](/manual/en/features.cookies.php)
[Sessions](/manual/en/features.sessions.php)
[Handling file uploads](/manual/en/features.file-upload.php)
[Using remote files](/manual/en/features.remote-files.php)
[Connection handling](/manual/en/features.connection-handling.php)
[Persistent Database Connections](/manual/en/features.persistent-connections.php)
[Command line usage](/manual/en/features.commandline.php)
[Garbage Collection](/manual/en/features.gc.php)
[DTrace Dynamic Tracing](/manual/en/features.dtrace.php)

[Function Reference](/manual/en/funcref.php)
[Affecting PHP's Behaviour](/manual/en/refs.basic.php.php)
[Audio Formats Manipulation](/manual/en/refs.utilspec.audio.php)
[Authentication Services](/manual/en/refs.remote.auth.php)
[Command Line Specific Extensions](/manual/en/refs.utilspec.cmdline.php)
[Compression and Archive Extensions](/manual/en/refs.compression.php)
[Cryptography Extensions](/manual/en/refs.crypto.php)
[Database Extensions](/manual/en/refs.database.php)
[Date and Time Related Extensions](/manual/en/refs.calendar.php)
[File System Related Extensions](/manual/en/refs.fileprocess.file.php)
[Human Language and Character Encoding Support](/manual/en/refs.international.php)
[Image Processing and Generation](/manual/en/refs.utilspec.image.php)
[Mail Related Extensions](/manual/en/refs.remote.mail.php)
[Mathematical Extensions](/manual/en/refs.math.php)
[Non-Text MIME Output](/manual/en/refs.utilspec.nontext.php)
[Process Control Extensions](/manual/en/refs.fileprocess.process.php)
[Other Basic Extensions](/manual/en/refs.basic.other.php)
[Other Services](/manual/en/refs.remote.other.php)
[Search Engine Extensions](/manual/en/refs.search.php)
[Server Specific Extensions](/manual/en/refs.utilspec.server.php)
[Session Extensions](/manual/en/refs.basic.session.php)
[Text Processing](/manual/en/refs.basic.text.php)
[Variable and Type Related Extensions](/manual/en/refs.basic.vartype.php)
[Web Services](/manual/en/refs.webservice.php)
[Windows Only Extensions](/manual/en/refs.utilspec.windows.php)
[XML Manipulation](/manual/en/refs.xml.php)
[GUI Extensions](/manual/en/refs.ui.php)

Keyboard Shortcuts?
This help
j
Next menu item
k
Previous menu item
g p
Previous man page
g n
Next man page
G
Scroll to bottom
g g
Scroll to top
g h
Goto homepage
g s
Goto search
(current page)
/
Focus search box

[Predefined Constants »](session.constants.php)

[« Installation](session.installation.php)

* [PHP Manual](index.php)
* [Function Reference](funcref.php)
* [Session Extensions](refs.basic.session.php)
* [Sessions](book.session.php)
* [Installing/Configuring](session.setup.php)

Change language:
English
German
Spanish
French
Italian
Japanese
Brazilian Portuguese
Russian
Turkish
Ukrainian
Chinese (Simplified)
Other

## Runtime Configuration

The behaviour of these functions is affected by settings in php.ini.

**Session configuration options**
| Name | Default | Changeable | Changelog |
| --- | --- | --- | --- |
| [session.save\_path](session.configuration.php#ini.session.save-path) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.name](session.configuration.php#ini.session.name) | "PHPSESSID" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.save\_handler](session.configuration.php#ini.session.save-handler) | "files" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.auto\_start](session.configuration.php#ini.session.auto-start) | "0" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.gc\_probability](session.configuration.php#ini.session.gc-probability) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.gc\_divisor](session.configuration.php#ini.session.gc-divisor) | "100" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.gc\_maxlifetime](session.configuration.php#ini.session.gc-maxlifetime) | "1440" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.serialize\_handler](session.configuration.php#ini.session.serialize-handler) | "php" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_lifetime](session.configuration.php#ini.session.cookie-lifetime) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_path](session.configuration.php#ini.session.cookie-path) | "/" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_domain](session.configuration.php#ini.session.cookie-domain) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cookie\_secure](session.configuration.php#ini.session.cookie-secure) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Prior to PHP 7.2.0, the default was `""`. |
| [session.cookie\_httponly](session.configuration.php#ini.session.cookie-httponly) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Prior to PHP 7.2.0, the default was `""`. |
| [session.cookie\_samesite](session.configuration.php#ini.session.cookie-samesite) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.3.0. |
| [session.use\_strict\_mode](session.configuration.php#ini.session.use-strict-mode) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_cookies](session.configuration.php#ini.session.use-cookies) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_only\_cookies](session.configuration.php#ini.session.use-only-cookies) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.referer\_check](session.configuration.php#ini.session.referer-check) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cache\_limiter](session.configuration.php#ini.session.cache-limiter) | "nocache" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.cache\_expire](session.configuration.php#ini.session.cache-expire) | "180" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.use\_trans\_sid](session.configuration.php#ini.session.use-trans-sid) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.trans\_sid\_tags](session.configuration.php#ini.session.trans-sid-tags) | "a=href,area=href,frame=src,form=" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. |
| [session.trans\_sid\_hosts](session.configuration.php#ini.session.trans-sid-hosts) | `$_SERVER['HTTP_HOST']` | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. |
| [session.sid\_length](session.configuration.php#ini.session.sid-length) | "32" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. Deprecated as of PHP 8.4.0. |
| [session.sid\_bits\_per\_character](session.configuration.php#ini.session.sid-bits-per-character) | "4" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Available as of PHP 7.1.0. Deprecated as of PHP 8.4.0. |
| [session.upload\_progress.enabled](session.configuration.php#ini.session.upload-progress.enabled) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.cleanup](session.configuration.php#ini.session.upload-progress.cleanup) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.prefix](session.configuration.php#ini.session.upload-progress.prefix) | "upload\_progress\_" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.name](session.configuration.php#ini.session.upload-progress.name) | "PHP\_SESSION\_UPLOAD\_PROGRESS" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.freq](session.configuration.php#ini.session.upload-progress.freq) | "1%" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.upload\_progress.min\_freq](session.configuration.php#ini.session.upload-progress.min-freq) | "1" | **`[INI_PERDIR](info.constants.php#constant.ini-perdir)`** |  |
| [session.lazy\_write](session.configuration.php#ini.session.lazy-write) | "1" | **`[INI_ALL](info.constants.php#constant.ini-all)`** |  |
| [session.hash\_function](session.configuration.php#ini.session.hash-function) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.hash\_bits\_per\_character](session.configuration.php#ini.session.hash-bits-per-character) | "4" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.entropy\_file](session.configuration.php#ini.session.entropy-file) | "" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0. |
| [session.entropy\_length](session.configuration.php#ini.session.entropy-length) | "0" | **`[INI_ALL](info.constants.php#constant.ini-all)`** | Removed as of PHP 7.1.0 |

For further details and definitions of the
INI\_\* modes, see the [Where a configuration setting may be set](configuration.changes.modes.php).

The session management system supports a number of configuration
options which you can place in your php.ini file. We will give a
short overview.
`session.save_handler`
[string](language.types.string.php)

`session.save_handler` defines the name of the
handler which is used for storing and retrieving data
associated with a session. Defaults to
`files`. Note that individual extensions may register
their own `save_handler`s; registered handlers can be
obtained on a per-installation basis by referring to
[phpinfo()](function.phpinfo.php). See also
[session\_set\_save\_handler()](function.session-set-save-handler.php).

`session.save_path`
[string](language.types.string.php)

`session.save_path` defines the argument which
is passed to the save handler. If you choose the default files
handler, this is the path where the files are created. See also
[session\_save\_path()](function.session-save-path.php).

There is an optional `N` argument to this directive that determines
the number of directory levels your session files will be spread
around in. For example, setting to `'5;/tmp'`
may end up creating a session file and location like
`/tmp/4/b/1/e/3/sess_4b1e384ad74619bd212e236e52a5a174If`. In order to use `N` you must create all of these
directories before use. A small shell script exists in
ext/session to do this, it's called
mod\_files.sh, with a Windows version called
mod\_files.bat. Also note that if `N` is
used and greater than 0 then automatic garbage collection will
not be performed, see a copy of php.ini for further
information. Also, if you use `N`, be sure to surround
`session.save_path` in
"quotes" because the separator (`;`) is
also used for comments in php.ini.

The file storage module creates files using mode 600 by default.
This default can be changed with the optional `MODE` argument:
`N;MODE;/path` where `MODE` is the octal
representation of the mode.
Setting `MODE` does not affect the process umask.

**Warning**

If this is set to a world-readable directory, such as
/tmp (the default), other users on the
server may be able to hijack sessions by getting the list of
files in that directory.

**Caution**

When using the optional directory level argument `N`,
as described above, note that using a value higher than 1 or 2 is
inappropriate for most sites due to the large number of directories
required: for example, a value of 3 implies that `(2 ** session.sid_bits_per_character) ** 3`
directories exist on the filesystem, which can result in a lot of wasted
space and inodes.

Only use `N` greater than 2 if you are absolutely
certain that your site is large enough to require it.

`session.name`
[string](language.types.string.php)

`session.name` specifies the name of the
session which is used as cookie name. It should only contain
alphanumeric characters. Defaults to `PHPSESSID`.
See also [session\_name()](function.session-name.php).

`session.auto_start`
[bool](language.types.boolean.php)

`session.auto_start` specifies whether the
session module starts a session automatically on request
startup. Defaults to `0` (disabled).

`session.serialize_handler`
[string](language.types.string.php)

`session.serialize_handler` defines the name of
the handler which is used to serialize/deserialize data. PHP
serialize format (name `php_serialize`), PHP
internal formats (name `php` and
`php_binary`) and WDDX are supported (name
`wddx`). WDDX is only available, if PHP is
compiled with [WDDX
support](ref.wddx.php). `php_serialize` uses plain
serialize/unserialize function internally and does not have
limitations that `php`
and `php_binary` have. Older serialize handlers
cannot store numeric index nor string index contains special
characters (`|` and `!`) in
$\_SESSION. Use `php_serialize` to avoid numeric
index or special character errors at script shutdown. Defaults
to `php`.

`session.gc_probability`
[int](language.types.integer.php)

`session.gc_probability` in conjunction with
`session.gc_divisor` is used to manage probability
that the gc (garbage collection) routine is started.
Defaults to `1`. Must be greater than or equal to `0`. See [session.gc\_divisor](session.configuration.php#ini.session.gc-divisor) for details.

`session.gc_divisor`
[int](language.types.integer.php)

`session.gc_divisor` coupled with
`session.gc_probability` defines the probability
that the gc (garbage collection) process is started on every session
initialization.
The probability is calculated by using gc\_probability/gc\_divisor,
e.g. 1/100 means there is a 1% chance that the GC process starts
on each request.
`session.gc_divisor` defaults to `100`.
Must be greater than `0`.

`session.gc_maxlifetime`
[int](language.types.integer.php)

`session.gc_maxlifetime` specifies the number
of seconds after which data will be seen as 'garbage' and
potentially cleaned up. Garbage collection may occur during session start
(depending on [session.gc\_probability](session.configuration.php#ini.session.gc-probability) and
[session.gc\_divisor](session.configuration.php#ini.session.gc-divisor)).
Defaults to `1440` (24 minutes).
> **Note**:
> If different scripts have different values of
> `session.gc_maxlifetime` but share the same place for
> storing the session data then the script with the minimum value will be
> cleaning the data. In this case, use this directive together with [session.save\_path](session.configuration.php#ini.session.save-path).

`session.referer_check`
[string](language.types.string.php)

`session.referer_check` contains the
substring you want to check each HTTP Referer for. If the
Referer was sent by the client and the substring was not
found, the embedded session id will be marked as invalid.
Defaults to the empty string.

`session.entropy_file`
[string](language.types.string.php)

`session.entropy_file` gives a path to an
external resource (file) which will be used as an additional
entropy source in the session id creation process. Examples are
`/dev/random` or `/dev/urandom`
which are available on many Unix systems.

This feature is supported on Windows. Setting
`session.entropy_length` to a non zero value
will make PHP use the Windows Random API as entropy source.
> **Note**:
> Removed in PHP 7.1.0.
>
> `session.entropy_file` defaults
> to `/dev/urandom` or `/dev/arandom`
> if it is available.

`session.entropy_length`
[int](language.types.integer.php)

`session.entropy_length` specifies the number
of bytes which will be read from the file specified
above. Defaults to `32`.

Removed in PHP 7.1.0.

`session.use_strict_mode`
[bool](language.types.boolean.php)

`session.use_strict_mode` specifies whether the
module will use strict session id mode. If this mode is enabled,
the module does not accept uninitialized session IDs. If an uninitialized
session ID is sent from the browser, a new session ID is sent to the browser.
Applications are protected from session fixation via session adoption
with strict mode.
Defaults to `0` (disabled).
> **Note**:
> Enabling `session.use_strict_mode` is mandatory for
> general session security. All sites are advised to enable this. See
> [session\_create\_id()](function.session-create-id.php) example code for more details.

**Warning**

If a custom session handler registered via [session\_set\_save\_handler()](function.session-set-save-handler.php)
does not implement [SessionUpdateTimestampHandlerInterface::validateId()](sessionupdatetimestamphandlerinterface.validateid.php),
nor supplies the `validate_sid` callback, respectively,
strict session ID mode is effectively disabled, regardless of the value of this directive.
Particularly note that [SessionHandler](class.sessionhandler.php) does *not*
implement **SessionHandler::validateId()**.

`session.use_cookies`
[bool](language.types.boolean.php)

`session.use_cookies` specifies whether the
module will use cookies to store the session id on the client
side. Defaults to `1` (enabled).

`session.use_only_cookies`
[bool](language.types.boolean.php)

`session.use_only_cookies` specifies whether
the module will **only** use
cookies to store the session id on the client side.
Enabling this setting prevents attacks that involve passing session
IDs in URLs.
Defaults to `1` (enabled).

`session.cookie_lifetime`
[int](language.types.integer.php)

`session.cookie_lifetime` specifies the lifetime of
the cookie in seconds which is sent to the browser. The value 0
means "until the browser is closed." Defaults to
`0`. See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).
> **Note**:
> The expiration timestamp is set relative to the server time, which is
> not necessarily the same as the time in the client's browser.

`session.cookie_path`
[string](language.types.string.php)

`session.cookie_path` specifies path to set
in the session cookie. Defaults to `/`. See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_domain`
[string](language.types.string.php)

`session.cookie_domain` specifies the domain to
set in the session cookie. Default is none at all meaning the host name of
the server which generated the cookie according to cookies specification.
See also [session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_secure`
[bool](language.types.boolean.php)

`session.cookie_secure` specifies whether
cookies should only be sent over secure connections. With this option set
to `on`, sessions only work with HTTPS connections.
If it is `off`, then sessions work with both HTTP and
HTTPS connections. Defaults to `off`.
See also
[session\_get\_cookie\_params()](function.session-get-cookie-params.php) and
[session\_set\_cookie\_params()](function.session-set-cookie-params.php).

`session.cookie_httponly`
[bool](language.types.boolean.php)

Marks the cookie as accessible only through the HTTP protocol. This means
that the cookie won't be accessible by scripting languages, such as
JavaScript. This setting can effectively help to reduce identity theft
through XSS attacks (although it is not supported by all browsers).

`session.cookie_samesite`
[string](language.types.string.php)

Allows servers to assert that a cookie ought not to be sent along with
cross-site requests. This assertion allows user agents to mitigate the risk
of cross-origin information leakage, and provides some protection against
cross-site request forgery attacks. Note that this is not supported by all
browsers.
An empty value means that no SameSite cookie attribute will be set.
`Lax` and `Strict` mean that the cookie
will not be sent cross-domain for POST requests; `Lax`
will send the cookie for cross-domain GET requests, while `Strict`
will not.

`session.cache_limiter`
[string](language.types.string.php)

`session.cache_limiter` specifies the cache
control method used for session pages.
It may be one of the following values:
`nocache`, `private`,
`private_no_expire`, or `public`.
Defaults to `nocache`. See also the
[session\_cache\_limiter()](function.session-cache-limiter.php) documentation for
information about what these values mean.

`session.cache_expire`
[int](language.types.integer.php)

`session.cache_expire` specifies time-to-live
for cached session pages in minutes, this has no effect for
nocache limiter. Defaults to `180`. See also
[session\_cache\_expire()](function.session-cache-expire.php).

`session.use_trans_sid`
[bool](language.types.boolean.php)

`session.use_trans_sid` whether transparent
sid support is enabled or not. Defaults to
`0` (disabled).
> **Note**:
> URL based session management has additional security risks
> compared to cookie based session management. Users may send
> a URL that contains an active session ID to their friends by
> email or users may save a URL that contains a session ID to
> their bookmarks and access your site with the same session ID
> always, for example.
>
> Since PHP 7.1.0, full URL path, e.g. https://php.net/, is
> handled by trans sid feature. Previous PHP handled relative
> URL path only. Rewrite target hosts are defined by [session.trans\_sid\_hosts](session.configuration.php#ini.session.trans-sid-hosts).

`session.trans_sid_tags`
[string](language.types.string.php)

`session.trans_sid_tags` specifies which HTML tags
are rewritten to include session id when transparent sid support
is enabled. Defaults to
`a=href,area=href,frame=src,input=src,form=`

`form` is special tag. `<input hidden="session_id" name="session_name">`
is added as form variable.
> **Note**:
> Before PHP 7.1.0, [url\_rewriter.tags](outcontrol.configuration.php#ini.url-rewriter.tags)
> was used for this purpose. Since PHP 7.1.0, `fieldset`
> is no longer considered as special tag.

`session.trans_sid_hosts`
[string](language.types.string.php)

`session.trans_sid_hosts` specifies which hosts
are rewritten to include session id when transparent sid support
is enabled. Defaults to `$_SERVER['HTTP_HOST']`
Multiple hosts can be specified by ",", no space is allowed
between hosts. e.g. `php.net,wiki.php.net,bugs.php.net`

`session.sid_length`
[int](language.types.integer.php)

`session.sid_length` allows you to specify the
length of session ID string. Session ID length can be between 22
to 256.

The default is 32. If you need compatibility you may specify 32,
40, etc. Longer session ID is harder to guess. At least 32 chars
are recommended.

**Tip**

Compatibility Note: Use 32 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=4,
`session.hash_function`=1 (SHA1) and
`session.hash_bits_per_character`=6. Use 26 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=5. Use 22 instead of
`session.hash_function`=0 (MD5) and
`session.hash_bits_per_character`=6. You must
configure INI values to have at least 128 bits in session ID. Do
not forget to set an appropriate value for
`session.sid_bits_per_character`, otherwise you
will have weaker session ID.

> **Note**:
> This setting is introduced in PHP 7.1.0.

`session.sid_bits_per_character`
[int](language.types.integer.php)

`session.sid_bits_per_character` allows you to specify the
number of bits in encoded session ID character. The possible values are
'4' (0-9, a-f), '5' (0-9, a-v), and '6' (0-9, a-z, A-Z, "-", ",").

The default is 4. The more bits results in stronger session ID. 5 is
recommended value for most environments.
> **Note**:
> This setting is introduced in PHP 7.1.0.

`session.hash_function`
[mixed](language.types.mixed.php)

`session.hash_function` allows you to specify the hash
algorithm used to generate the session IDs. '0' means MD5 (128 bits) and
'1' means SHA-1 (160 bits).

It is also possible to specify any of the algorithms
provided by the [hash extension](ref.hash.php) (if it is
available), like `sha512` or
`whirlpool`. A complete list of supported algorithms can
be obtained with the [hash\_algos()](function.hash-algos.php) function.

> **Note**:
> Removed in PHP 7.1.0.

`session.hash_bits_per_character`
[int](language.types.integer.php)

`session.hash_bits_per_character` allows you to define
how many bits are stored in each character when converting the binary
hash data to something readable. The possible values are '4' (0-9, a-f),
'5' (0-9, a-v), and '6' (0-9, a-z, A-Z, "-", ",").
> **Note**:
> Removed in PHP 7.1.0.

`session.upload_progress.enabled`
[bool](language.types.boolean.php)

Enables upload progress tracking, populating the [$\_SESSION](reserved.variables.session.php) variable.
Defaults to 1, enabled.

`session.upload_progress.cleanup`
[bool](language.types.boolean.php)

Cleanup the progress information as soon as all POST data has been read
(i.e. upload completed). Defaults to 1, enabled.
> **Note**:
> It is highly recommended to keep this feature enabled.

`session.upload_progress.prefix`
[string](language.types.string.php)

A prefix used for the upload progress key in the [$\_SESSION](reserved.variables.session.php).
This key will be concatenated with the value of
`$_POST[ini_get("session.upload_progress.name")]` to
provide a unique index.

Defaults to "upload\_progress\_".

`session.upload_progress.name`
[string](language.types.string.php)

The name of the key to be used in [$\_SESSION](reserved.variables.session.php) storing
the progress information. See also
[session.upload\_progress.prefix](session.configuration.php#ini.session.upload-progress.prefix).

If `$_POST[ini_get("session.upload_progress.name")]`
is not passed or available, upload progressing will not be recorded.

Defaults to "PHP\_SESSION\_UPLOAD\_PROGRESS".

`session.upload_progress.freq`
[mixed](language.types.mixed.php)

Defines how often the upload progress information should be updated.
This can be defined in bytes (i.e. "update progress information after every 100 bytes"), or in percentages (i.e. "update progress information after receiving every 1% of the whole filesize").

Defaults to "1%".

`session.upload_progress.min_freq`
[int](language.types.integer.php)

The minimum delay between updates, in seconds.
Defaults to "1" (one second).

`session.lazy_write`
[bool](language.types.boolean.php)

`session.lazy_write`, when set to 1, means that session
data is only rewritten if it changes. Defaults to 1, enabled.

Upload progress will not be registered unless
session.upload\_progress.enabled is enabled, and the
$\_POST[ini\_get("session.upload\_progress.name")] variable is set.
See [Session Upload Progress](session.upload-progress.php) for more details on this functionality.

### Found A Problem?

[Learn How To Improve This Page](https://github.com/php/doc-base/blob/master/README.md "This will take you to our contribution guidelines on GitHub")
•
[Submit a Pull Request](https://github.com/php/doc-en/blob/master/reference/session/ini.xml)
•
[Report a Bug](https://github.com/php/doc-en/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Fsession.configuration%0A%0A---)

[＋add a note](/manual/add-note.php?sect=session.configuration&repo=en&redirect=https://www.php.net/manual/en/session.configuration.php)
### User Contributed Notes 21 notes

[up](/manual/vote-note.php?id=128936&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=128936&page=session.configuration&vote=down "Vote down!")

38

[***Walerian Walawski - https://w87.eu/***](#128936) [¶](#128936)**1 year ago**
`Can't find mod_files.sh? Here it is:`

[up](/manual/vote-note.php?id=115842&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=115842&page=session.configuration&vote=down "Vote down!")

79

[***Christopher Kramer***](#115842) [¶](#115842)**10 years ago**
`On debian (based) systems, changing session.gc_maxlifetime at runtime has no real effect. Debian disables PHP's own garbage collector by setting session.gc_probability=0. Instead it has a cronjob running every 30 minutes (see /etc/cron.d/php5) that cleans up old sessions. This cronjob basically looks into your php.ini and uses the value of session.gc_maxlifetime there to decide which sessions to clean (see /usr/lib/php5/maxlifetime).

You can adjust the global value in your php.ini (usually /etc/php5/apache2/php.ini). Or you can change the session.save_path so debian's cronjob will not clean up your sessions anymore. Then you need to either do your own garbage collection with your own cronjob or enable PHP's garbage collection (php then needs sufficient privileges on the save_path).

Why does Debian not use PHP's garbarage collection?
For security reasons, they store session data in a place (/var/lib/php5) with very stringent permissions. With the sticky bit set, only root is allowed to rename or delete files there, so PHP itself cannot clean up old session data. See <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=267720> .`

[up](/manual/vote-note.php?id=129283&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129283&page=session.configuration&vote=down "Vote down!")

3

[***theking2(at)king.ma***](#129283) [¶](#129283)**10 months ago**
`Please be careful with the 'sid_length' when setting 'sid_bits_per_character' to six.

Setting sid_bits_per_character to 6 includes the character "," to the list of possible characters. A comma will be escaped and transmitted as "%2C" (tested on Chromium Version 119.0.6045.199) adding two extra characters for each comma to the SESSION_ID.`

[up](/manual/vote-note.php?id=129114&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129114&page=session.configuration&vote=down "Vote down!")

5

[***zch1***](#129114) [¶](#129114)**1 year ago**
`the pwd should be urlencode when it contanis special chars.
eg:

save_handler:redis
save_path: tcp://127.0.0.1:6739?auth=urlencode('xxxxx')`

[up](/manual/vote-note.php?id=115913&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=115913&page=session.configuration&vote=down "Vote down!")

19

[***GreenReaper***](#115913) [¶](#115913)**10 years ago**
`We found a session.save_path depth of 3 led to excessive wastage of inodes and in fact disk space in storing the directory tree. dir_indexes option on ext2/3/4 makes larger directories more feasible anyway, so we decided to move to a depth of 2 instead.

It took a little puzzling to figure out how to move the existing PHP sessions up one directory tree, but we ended up running this in the root sessions directory:

#!/bin/sh
for a in ./* ; do
 cd ./$a
 pwd
 for b in ./* ; do
 cd ./$b
 pwd
 # Move existing sessions out
 find ./* -xdev -type f -print0 | xargs -0 mv -t .
 # Remove subdirectories
 find ./* -xdev -type d -print0 | xargs -0 rmdir
 cd ..
 done
 cd ..
done

This script may not be the best way to do it, but it got the job done fast. You can modify it for different depths by adding or removing "for" loops.

The documentation gives a depth of 5 as an example, but five is right out. If you're going beyond 2, you're at the scale where you may want to to look at a large memcached or redis instance instead.`

[up](/manual/vote-note.php?id=117668&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=117668&page=session.configuration&vote=down "Vote down!")

16

[***info at thimbleopensource dot com***](#117668) [¶](#117668)**9 years ago**
`I found out that if you need to set custom session settings, you only need to do it once when session starts. Then session maintains its settings, even if you use ini_set and change them, original session still will use it's original setting until it expires.

Just thought it might be useful to someone.`

[up](/manual/vote-note.php?id=129300&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129300&page=session.configuration&vote=down "Vote down!")

1

[***theking2(at)king.ma***](#129300) [¶](#129300)**10 months ago**
`To prevent mitm-attacks you want to make sure the session cookie is only transmitted over a secure channel prefix it with the magic string "__Secure-". [1]

Like :
<?php
 session_start( [ 'name' => '__Secure-Session-ID' ] );
?>

The cookie will not be available on non-secure channel.

(Putting this note it here probably goes unnoticed because of all the noise)

[1]: <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes>`

[up](/manual/vote-note.php?id=97979&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=97979&page=session.configuration&vote=down "Vote down!")

10

[***Wouter***](#97979) [¶](#97979)**14 years ago**
`When setting the session.cookie_lifetime directive in a .htaccess use string format like;

php_value session.cookie_lifetime "123456"

and not

php_value session.cookie_lifetime 123456

Using a integer as stated above dit not work in my case (Apache/2.2.11 (Ubuntu) PHP/5.2.6-3ubuntu4.5 with Suhosin-Patch mod_ssl/2.2.11 OpenSSL/0.9.8g)`

[up](/manual/vote-note.php?id=111451&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=111451&page=session.configuration&vote=down "Vote down!")

8

[***jlevene at etisoftware dot com***](#111451) [¶](#111451)**11 years ago**
`Being unable to find an actual copy of mod_files.sh, and seeing lots of complaints/bug fix requests for it, here's one that works. It gets all its parameters from PHP.INI, so you don't have the opportunity to mess up:

#!/bin/bash
#
# Creates directories for PHP session storage.
# Replaces the one that "comes with" PHP, which (a) doesn't always come with it
# and (b) doesn't work so great.
#
# This version takes no parameters, and uses the values in PHP.INI (if it
# can find it).
#
# Works in OS-X and CentOS (and probably all other) Linux.
#
# Feb '13 by Jeff Levene.

[[ $# -gt 0 ]] && echo "$0 requires NO command-line parameters.
It gets does whatever is called for in the PHP.INI file (if it can find it).
" && exit 1

# Find the PHP.INI file, if possible:
phpIni=/usr/local/lib/php.ini # Default PHP.INI location
[[ ! -f "$phpIni" ]] && phpIni=/etc/php.ini # Secondary location
[[ ! -f "$phpIni" ]] && phpIni= # Found it?

# Outputs the given (as $1) parameter from the PHP.INI file:
# The "empty" brackets have a SPACE and a TAB in them.
#
PhpConfigParam() {
 [[ ! "$phpIni" ]] && return
 # Get the line from the INI file:
 varLine=`grep "^[ ]*$1[ ]*=" "$phpIni"`

 # Extract the value:
 value=`expr "$varLine" : ".*$1[ ]*=[ ]*['\"]*\([^'\"]*\)"`
 echo "$value"
 }

if [[ "$phpIni" ]]
then
 savePath=`PhpConfigParam session.save_path`
 # If there's a number and semicolon at the front, remove them:
 dirDepth=`expr "$savePath" : '\([0-9]*\)'`
 [[ "$dirDepth" ]] && savePath=`expr "$savePath" : '[0-9]*;\(.*\)'` || dirDepth=0
 bits=`PhpConfigParam session.hash_bits_per_character`
 case "x$bits" in
 x) echo "hash_bits_per_character not defined. Not running." ; exit 2 ;;
 x4) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f' ;;
 x5) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v' ;;
 x6) alphabet='0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v'
 alphabet="$alphabet w x y z A B C D E F G H I J K L M N O P Q R S T U V W"
 alphabet="$alphabet X Y Z - ,"
 ;;
 *) echo "unrecognized hash_bits_per_character. Not running." ; exit 2 ;;
 esac
else
 echo "Cannot find the PHP.INI file. Not running. Sorry."
 exit 2
fi

# The depth of directories to create is $1. 0 means just create the named
# directory. Directory to start with is $2.
#
# Used recursively, so variables must be "local".

doDir() {
 local dir="$2"
 if [[ -d "$dir" ]]
 then
 echo "Directory '$dir' already exists. No problem."
 elif [[ -f "$dir" ]]
 then
 echo "FILE '$dir' exists. Aborting." ; exit 2
 else
 if mkdir "$dir"
 then
 echo "Directory '$dir' created."
 else
 echo "Cannot create directory '$dir'. Aborting." ; exit 2
 fi
 fi
 chmod a+rwx "$dir"
 if [[ $1 -gt 0 ]]
 then
 local depth=$(( $1 - 1 ))
 for letter in $alphabet
 do doDir $depth "$dir/$letter"
 done
 fi
 }

echo "Running with savePath='$savePath', dirDepth=$dirDepth, and bitsPerCharacter=$bits."
sleep 3

doDir $dirDepth "$savePath"

exit 0`

[up](/manual/vote-note.php?id=123598&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=123598&page=session.configuration&vote=down "Vote down!")

3

[***boan dot web at outlook dot com***](#123598) [¶](#123598)**5 years ago**
`session.cache_limiter may be empty string to disable cache headers entirely.

Quote:
> Setting the cache limiter to '' will turn off automatic sending of cache headers entirely.

<http://php.net/manual/en/function.session-cache-limiter.php>`

[up](/manual/vote-note.php?id=107990&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=107990&page=session.configuration&vote=down "Vote down!")

7

[***hassankhodadadeh at NOSPAM dot gmail dot com***](#107990) [¶](#107990)**12 years ago**
`max value for "session.gc_maxlifetime" is 65535. values bigger than this may cause php session stops working.`

[up](/manual/vote-note.php?id=122042&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=122042&page=session.configuration&vote=down "Vote down!")

3

[***li-lingjie***](#122042) [¶](#122042)**7 years ago**
`Use SessionHandlerInterface interface Custom redis session, found the following:

Use ini_set ('session.save_path', "tcp: //127.0.0.1: 6379? Auth = password"); will be reported:

PHP Fatal error: session_start (): Failed to initialize storage module: user (path: tcp: //127.0.0.1: 6379? Auth = password);

Using session_save_path ("tcp: //127.0.0.1: 6379? Auth = password") will not`

[up](/manual/vote-note.php?id=99619&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=99619&page=session.configuration&vote=down "Vote down!")

2

[***Nicholas***](#99619) [¶](#99619)**14 years ago**
`Transient sessions do not appear to be working in 5.3.3

E.g.

<?php
 ini_set("session.use_cookies", 0);
 ini_set("session.use_trans_sid", 1);
 session_start();

 if (isset($_SESSION["foo"])) {
 echo "Foo: " . $_SESSION["foo"];
 } else {
 $_SESSION["foo"] = "Bar";
 echo "<a href=?" . session_name() . "=" . session_id() . ">Begin test</a>";
 }
?>

This works in 5.2.5, but not 5.3.3`

[up](/manual/vote-note.php?id=121913&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=121913&page=session.configuration&vote=down "Vote down!")

-1

[***ohcc at 163 dot com***](#121913) [¶](#121913)**7 years ago**
`You should take more care configuring session.gc_maxlifetime when virtual hosts share the same session-saving directory. One host's session data may be gc'ed when another host runs php.`

[up](/manual/vote-note.php?id=100855&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=100855&page=session.configuration&vote=down "Vote down!")

-2

[***AskApache***](#100855) [¶](#100855)**14 years ago**
`This is how I set my session.save_path
session.save_path = "1;/home/askapache/tmp/s"
So to create the folder structure you can use this compatible shell script, if you want to create with 777 permissions change the umask to 0000;
sh -o braceexpand -c "umask 0077;mkdir -p s/{0..9}/{a..z} s/{a..z}/{0..9}"

Then you can create a cronjob to clean the session folder by adding this to your crontab which deletes any session files older than an hour:
@daily find /home/askapache/tmp/s -type f -mmin +60 -exec rm -f {} \; &>/dev/null

That will create sessions in folder like:
 /home/askapache/tmp/s/b/sess_b1aba5q6io4lv01bpc6t52h0ift227j6

I don't think any non-mega site will need to go more than 1 levels deep. Otherwise you create so many directories that it slows the performance gained by this.`

[up](/manual/vote-note.php?id=84045&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=84045&page=session.configuration&vote=down "Vote down!")

-2

[***00 at f00n dot com***](#84045) [¶](#84045)**16 years ago**
`After having many problems with garbage collection not clearing my sessions I have resolved it through the following.

First I found this in the php.ini (not something i noticed as i use phpinfo(); to see my hosting ini).

; NOTE: If you are using the subdirectory option for storing session files
; (see session.save_path above), then garbage collection does *not*
; happen automatically. You will need to do your own garbage

; collection through a shell script, cron entry, or some other method. ; For example, the following script would is the equivalent of
; setting session.gc_maxlifetime to 1440 (1440 seconds = 24 minutes):
; cd /path/to/sessions; find -cmin +24 | xargs rm

With this is mind there are options.

1. dont use a custom save_path.
** This means if your isp hasnt defaulted your session temp to something safer than install default or you are using a shared directory for session data then you would be wise to use named sessions to keep your session from being viewable in other people's scripts. Creating a unique_id name for this is the common method. **

2. use your custom folder but write a garbage collection script.

3. use a custom handler and a database`

[up](/manual/vote-note.php?id=88552&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=88552&page=session.configuration&vote=down "Vote down!")

-2

[***mikaelkael at php dot net***](#88552) [¶](#88552)**15 years ago**
`Recently, I needed to change the session save_path in my program under Windows. With an ini_set('session.save_path', '../data/sessions'); (and session.gc_divisor = 1 for test), I always obtain 'Error #8 session_start(): ps_files_cleanup_dir: opendir(../data/sessions) failed: Result too large'.

I corrected this by changing with ini_set('session.save_path', realpath('../data/sessions'));`

[up](/manual/vote-note.php?id=122038&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=122038&page=session.configuration&vote=down "Vote down!")

-3

[***white-gandalf at web dot de***](#122038) [¶](#122038)**7 years ago**
`session.use_strict_mode does very little to strengthen your security: only one very specific variant of attack is migitated by this (where the attacker hands an "empty" sid to the victim to adapt his own browser to that session later) - versus for example the case where he pre-opens a session, handing the sid of that one to the victim, so the victim gets adapted to the pre-opened session. In the latter case this flag does nothing to help. In every other scenario with other vulnerabilities where the session id gets leaked, the flag helps nigher.

But this flag renders the php function session_id() useless in its parameterized variant, thus preventing any php functionality that builds upon this function.`

[up](/manual/vote-note.php?id=99671&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=99671&page=session.configuration&vote=down "Vote down!")

-4

[***orbill***](#99671) [¶](#99671)**14 years ago**
`apparently the default value for session.use_only_cookies has changed in 5.3.3 from 0 to 1. If you haven't set this in your php.ini or your code to 0 transparent sessions won't work.`

[up](/manual/vote-note.php?id=128544&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=128544&page=session.configuration&vote=down "Vote down!")

-1

[***descartavel1+php at gmail dot com***](#128544) [¶](#128544)**1 year ago**
`You should set `session.name` to use either prefix `__Host-` or `__Secure-`. See <https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#attributes>`

[up](/manual/vote-note.php?id=126568&page=session.configuration&vote=up "Vote up!")

[down](/manual/vote-note.php?id=126568&page=session.configuration&vote=down "Vote down!")

-5

[***polygon dot co dot in at gmail dot com***](#126568) [¶](#126568)**3 years ago**
`In php.ini, session.save_handler defines the name of the handler which is used for storing and retrieving data associated with a session. [Defaults to files.]

By default session.save_handler has support for below

session.save_handler = files
session.save_handler = sqlite
session.save_handler = redis
session.save_handler = memcached

These locks the session by default for any HTTP request using session.
Locking means, a user can't access session related pages until current request is completed.

So, if you are thinking that switching to these will increase performance; the answer is NO! because of locking behaviour.

To overcome/customise the session locking behaviour use as below.

session.save_handler = user
This is for all (including list above) modes of session storage.

For "user" type save_handler, we can ignore locks for better performance (as explained in function session_set_save_handler). But for this we need to take care to use sessions only for authenticity and not for passing data from one script to other.

For passing data accross scripts use GET method to achieve the goal.`

[＋add a note](/manual/add-note.php?sect=session.configuration&repo=en&redirect=https://www.php.net/manual/en/session.configuration.php)

* [Installing/Configuring](session.setup.php)
  + [Requirements](session.requirements.php "Requirements")
  + [Installation](session.installation.php "Installation")
  + [Runtime Configuration](session.configuration.php "Runtime Configuration")

* [Copyright © 2001-2025 The PHP Documentation Group](/manual/en/copyright.php)
* [My PHP.net](/my.php)
* [Contact](/contact.php)
* [Other PHP.net sites](/sites.php)
* [Privacy policy](/privacy.php)

![To Top](/images/to-top@2x.png)

`↑` and `↓` to navigate •
`Enter` to select •
`Esc` to close

Press `Enter` without
selection to search using Google



=== Content from www.php.net_3f6dc5cf_20250115_093720.html ===

[![](/images/logos/php-logo-white.svg)](/)

* [Downloads](/downloads.php)
* [Documentation](/docs.php)
* [Get Involved](/get-involved.php)
* [Help](/support.php)
* [![PHP 8.4](/images/php8/logo_php8_4.svg)](/releases/8.4/index.php)

 Search docs

[API Platform Conference 2025](/conferences/index.php#2025-01-13-1)
[Getting Started](/manual/en/getting-started.php)
[Introduction](/manual/en/introduction.php)
[A simple tutorial](/manual/en/tutorial.php)
[Language Reference](/manual/en/langref.php)
[Basic syntax](/manual/en/language.basic-syntax.php)
[Types](/manual/en/language.types.php)
[Variables](/manual/en/language.variables.php)
[Constants](/manual/en/language.constants.php)
[Expressions](/manual/en/language.expressions.php)
[Operators](/manual/en/language.operators.php)
[Control Structures](/manual/en/language.control-structures.php)
[Functions](/manual/en/language.functions.php)
[Classes and Objects](/manual/en/language.oop5.php)
[Namespaces](/manual/en/language.namespaces.php)
[Enumerations](/manual/en/language.enumerations.php)
[Errors](/manual/en/language.errors.php)
[Exceptions](/manual/en/language.exceptions.php)
[Fibers](/manual/en/language.fibers.php)
[Generators](/manual/en/language.generators.php)
[Attributes](/manual/en/language.attributes.php)
[References Explained](/manual/en/language.references.php)
[Predefined Variables](/manual/en/reserved.variables.php)
[Predefined Exceptions](/manual/en/reserved.exceptions.php)
[Predefined Interfaces and Classes](/manual/en/reserved.interfaces.php)
[Predefined Attributes](/manual/en/reserved.attributes.php)
[Context options and parameters](/manual/en/context.php)
[Supported Protocols and Wrappers](/manual/en/wrappers.php)

[Security](/manual/en/security.php)
[Introduction](/manual/en/security.intro.php)
[General considerations](/manual/en/security.general.php)
[Installed as CGI binary](/manual/en/security.cgi-bin.php)
[Installed as an Apache module](/manual/en/security.apache.php)
[Session Security](/manual/en/security.sessions.php)
[Filesystem Security](/manual/en/security.filesystem.php)
[Database Security](/manual/en/security.database.php)
[Error Reporting](/manual/en/security.errors.php)
[User Submitted Data](/manual/en/security.variables.php)
[Hiding PHP](/manual/en/security.hiding.php)
[Keeping Current](/manual/en/security.current.php)
[Features](/manual/en/features.php)
[HTTP authentication with PHP](/manual/en/features.http-auth.php)
[Cookies](/manual/en/features.cookies.php)
[Sessions](/manual/en/features.sessions.php)
[Handling file uploads](/manual/en/features.file-upload.php)
[Using remote files](/manual/en/features.remote-files.php)
[Connection handling](/manual/en/features.connection-handling.php)
[Persistent Database Connections](/manual/en/features.persistent-connections.php)
[Command line usage](/manual/en/features.commandline.php)
[Garbage Collection](/manual/en/features.gc.php)
[DTrace Dynamic Tracing](/manual/en/features.dtrace.php)

[Function Reference](/manual/en/funcref.php)
[Affecting PHP's Behaviour](/manual/en/refs.basic.php.php)
[Audio Formats Manipulation](/manual/en/refs.utilspec.audio.php)
[Authentication Services](/manual/en/refs.remote.auth.php)
[Command Line Specific Extensions](/manual/en/refs.utilspec.cmdline.php)
[Compression and Archive Extensions](/manual/en/refs.compression.php)
[Cryptography Extensions](/manual/en/refs.crypto.php)
[Database Extensions](/manual/en/refs.database.php)
[Date and Time Related Extensions](/manual/en/refs.calendar.php)
[File System Related Extensions](/manual/en/refs.fileprocess.file.php)
[Human Language and Character Encoding Support](/manual/en/refs.international.php)
[Image Processing and Generation](/manual/en/refs.utilspec.image.php)
[Mail Related Extensions](/manual/en/refs.remote.mail.php)
[Mathematical Extensions](/manual/en/refs.math.php)
[Non-Text MIME Output](/manual/en/refs.utilspec.nontext.php)
[Process Control Extensions](/manual/en/refs.fileprocess.process.php)
[Other Basic Extensions](/manual/en/refs.basic.other.php)
[Other Services](/manual/en/refs.remote.other.php)
[Search Engine Extensions](/manual/en/refs.search.php)
[Server Specific Extensions](/manual/en/refs.utilspec.server.php)
[Session Extensions](/manual/en/refs.basic.session.php)
[Text Processing](/manual/en/refs.basic.text.php)
[Variable and Type Related Extensions](/manual/en/refs.basic.vartype.php)
[Web Services](/manual/en/refs.webservice.php)
[Windows Only Extensions](/manual/en/refs.utilspec.windows.php)
[XML Manipulation](/manual/en/refs.xml.php)
[GUI Extensions](/manual/en/refs.ui.php)

Keyboard Shortcuts?
This help
j
Next menu item
k
Previous menu item
g p
Previous man page
g n
Next man page
G
Scroll to bottom
g g
Scroll to top
g h
Goto homepage
g s
Goto search
(current page)
/
Focus search box

[session\_status »](function.session-status.php)

[« session\_set\_save\_handler](function.session-set-save-handler.php)

* [PHP Manual](index.php)
* [Function Reference](funcref.php)
* [Session Extensions](refs.basic.session.php)
* [Sessions](book.session.php)
* [Session Functions](ref.session.php)

Change language:
English
German
Spanish
French
Italian
Japanese
Brazilian Portuguese
Russian
Turkish
Ukrainian
Chinese (Simplified)
Other

# session\_start

(PHP 4, PHP 5, PHP 7, PHP 8)

session\_start — Start new or resume existing session

### Description

**session\_start**([array](language.types.array.php) `$options` = []): [bool](language.types.boolean.php)

**session\_start()** creates a session or resumes the
current one based on a session identifier passed via a GET or POST
request, or passed via a cookie.

When **session\_start()** is called or when a session auto starts,
PHP will call the open and read session save handlers. These will either be a built-in
save handler provided by default or by PHP extensions (such as SQLite or Memcached); or can be
custom handler as defined by [session\_set\_save\_handler()](function.session-set-save-handler.php).
The read callback will retrieve any existing session data (stored in a special serialized format)
and will be unserialized and used to automatically populate the $\_SESSION superglobal when the
read callback returns the saved session data back to PHP session handling.

To use a named session, call
[session\_name()](function.session-name.php) before calling
**session\_start()**.

When [session.use\_trans\_sid](session.configuration.php#ini.session.use-trans-sid)
is enabled, the **session\_start()** function will
register an internal output handler for URL rewriting.

If a user uses `ob_gzhandler` or similar with
[ob\_start()](function.ob-start.php), the function order is important for
proper output. For example,
`ob_gzhandler` must be registered before starting the session.

### Parameters

`options`

If provided, this is an associative array of options that will override
the currently set
[session configuration directives](session.configuration.php).
The keys should not include the `session.` prefix.

In addition to the normal set of configuration directives, a
`read_and_close` option may also be provided. If set to
**`[true](reserved.constants.php#constant.true)`**, this will result in the session being closed immediately after
being read, thereby avoiding unnecessary locking if the session data
won't be changed.

### Return Values

This function returns **`[true](reserved.constants.php#constant.true)`** if a session was successfully started,
otherwise **`[false](reserved.constants.php#constant.false)`**.

### Changelog

| Version | Description |
| --- | --- |
| 7.1.0 | **session\_start()** now returns **`[false](reserved.constants.php#constant.false)`** and no longer initializes [$\_SESSION](reserved.variables.session.php) when it failed to start the session. |

### Examples

#### A basic session example

**Example #1 page1.php**

`<?php
// page1.php

session_start();

echo 'Welcome to page #1';

$_SESSION['favcolor'] = 'green';
$_SESSION['animal'] = 'cat';
$_SESSION['time'] = time();

// Works if session cookie was accepted
echo '<br /><a href="page2.php">page 2</a>';

// Or maybe pass along the session id, if needed
echo '<br /><a href="page2.php?' . SID . '">page 2</a>';
?>`

After viewing page1.php, the second page
page2.php will magically contain the session
data. Read the [session reference](ref.session.php)
for information on [propagating
session ids](session.idpassing.php) as it, for example, explains what the constant
**`[SID](session.constants.php#constant.sid)`** is all about.

**Example #2 page2.php**

`<?php
// page2.php

session_start();

echo 'Welcome to page #2<br />';

echo $_SESSION['favcolor']; // green
echo $_SESSION['animal']; // cat
echo date('Y m d H:i:s', $_SESSION['time']);

// You may want to use SID here, like we did in page1.php
echo '<br /><a href="page1.php">page 1</a>';
?>`

#### Providing options to **session\_start()**

**Example #3 Overriding the cookie lifetime**

`<?php
// This sends a persistent cookie that lasts a day.
session_start([
 'cookie_lifetime' => 86400,
]);
?>`

**Example #4 Reading the session and closing it**

`<?php
// If we know we don't need to change anything in the
// session, we can just read and close rightaway to avoid
// locking the session file and blocking other pages
session_start([
 'cookie_lifetime' => 86400,
 'read_and_close' => true,
]);`

### Notes

> **Note**:
>
> To use cookie-based sessions, **session\_start()**
> must be called before outputting anything to the browser.

> **Note**:
>
> Use of [zlib.output\_compression](zlib.configuration.php#ini.zlib.output-compression)
> is recommended instead of [ob\_gzhandler()](function.ob-gzhandler.php)

> **Note**:
>
> This function sends out several HTTP headers depending on the
> configuration. See [session\_cache\_limiter()](function.session-cache-limiter.php) to
> customize these headers.

### See Also

* [$\_SESSION](reserved.variables.session.php)
* The [session.auto\_start](session.configuration.php#ini.session.auto-start)
  configuration directive
* [session\_id()](function.session-id.php) - Get and/or set the current session id

### Found A Problem?

[Learn How To Improve This Page](https://github.com/php/doc-base/blob/master/README.md "This will take you to our contribution guidelines on GitHub")
•
[Submit a Pull Request](https://github.com/php/doc-en/blob/master/reference/session/functions/session-start.xml)
•
[Report a Bug](https://github.com/php/doc-en/issues/new?body=From%20manual%20page:%20https:%2F%2Fphp.net%2Ffunction.session-start%0A%0A---)

[＋add a note](/manual/add-note.php?sect=function.session-start&repo=en&redirect=https://www.php.net/manual/en/function.session-start.php)
### User Contributed Notes 36 notes

[up](/manual/vote-note.php?id=102460&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=102460&page=function.session-start&vote=down "Vote down!")

30

[***linblow at hotmail dot fr***](#102460) [¶](#102460)**13 years ago**
`If you want to handle sessions with a class, I wrote this little class:

<?php

/*
 Use the static method getInstance to get the object.
*/

class Session
{
 const SESSION_STARTED = TRUE;
 const SESSION_NOT_STARTED = FALSE;

 // The state of the session
 private $sessionState = self::SESSION_NOT_STARTED;

 // THE only instance of the class
 private static $instance;

 private function __construct() {}

 /**
 * Returns THE instance of 'Session'.
 * The session is automatically initialized if it wasn't.
 *
 * @return object
 **/

 public static function getInstance()
 {
 if ( !isset(self::$instance))
 {
 self::$instance = new self;
 }

 self::$instance->startSession();

 return self::$instance;
 }

 /**
 * (Re)starts the session.
 *
 * @return bool TRUE if the session has been initialized, else FALSE.
 **/

 public function startSession()
 {
 if ( $this->sessionState == self::SESSION_NOT_STARTED )
 {
 $this->sessionState = session_start();
 }

 return $this->sessionState;
 }

 /**
 * Stores datas in the session.
 * Example: $instance->foo = 'bar';
 *
 * @param name Name of the datas.
 * @param value Your datas.
 * @return void
 **/

 public function __set( $name , $value )
 {
 $_SESSION[$name] = $value;
 }

 /**
 * Gets datas from the session.
 * Example: echo $instance->foo;
 *
 * @param name Name of the datas to get.
 * @return mixed Datas stored in session.
 **/

 public function __get( $name )
 {
 if ( isset($_SESSION[$name]))
 {
 return $_SESSION[$name];
 }
 }

 public function __isset( $name )
 {
 return isset($_SESSION[$name]);
 }

 public function __unset( $name )
 {
 unset( $_SESSION[$name] );
 }

 /**
 * Destroys the current session.
 *
 * @return bool TRUE is session has been deleted, else FALSE.
 **/

 public function destroy()
 {
 if ( $this->sessionState == self::SESSION_STARTED )
 {
 $this->sessionState = !session_destroy();
 unset( $_SESSION );

 return !$this->sessionState;
 }

 return FALSE;
 }
}

/*
 Examples:
*/

// We get the instance
$data = Session::getInstance();

// Let's store datas in the session
$data->nickname = 'Someone';
$data->age = 18;

// Let's display datas
printf( '<p>My name is %s and I\'m %d years old.</p>' , $data->nickname , $data->age );

/*
 It will display:

 Array
 (
 [nickname] => Someone
 [age] => 18
 )
*/

printf( '<pre>%s</pre>' , print_r( $_SESSION , TRUE ));

// TRUE
var_dump( isset( $data->nickname ));

// We destroy the session
$data->destroy();

// FALSE
var_dump( isset( $data->nickname ));

?>

I prefer using this class instead of using directly the array $_SESSION.`

[up](/manual/vote-note.php?id=117157&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=117157&page=function.session-start&vote=down "Vote down!")

22

[***aaronw at catalyst dot net dot nz***](#117157) [¶](#117157)**9 years ago**
`As others have noted, PHP's session handler is blocking. When one of your scripts calls session_start(), any other script that also calls session_start() with the same session ID will sleep until the first script closes the session.

A common workaround to this is call session_start() and session_write_close() each time you want to update the session.

The problem with this, is that each time you call session_start(), PHP prints a duplicate copy of the session cookie to the HTTP response header. Do this enough times (as you might do in a long-running script), and the response header can get so large that it causes web servers & browsers to crash or reject your response as malformed.

This error has been reported to PHP HQ, but they've marked it "Won't fix" because they say you're not supposed to open and close the session during a single script like this. <https://bugs.php.net/bug.php?id=31455>

As a workaround, I've written a function that uses headers_list() and header_remove() to clear out the duplicate cookies. It's interesting to note that even on requests when PHP sends duplicate session cookies, headers_list() still only lists one copy of the session cookie. Nonetheless, calling header_remove() removes all the duplicate copies.

<?php
/**
 * Every time you call session_start(), PHP adds another
 * identical session cookie to the response header. Do this
 * enough times, and your response header becomes big enough
 * to choke the web server.
 *
 * This method clears out the duplicate session cookies. You can
 * call it after each time you've called session_start(), or call it
 * just before you send your headers.
 */
function clear_duplicate_cookies() {
 // If headers have already been sent, there's nothing we can do
 if (headers_sent()) {
 return;
 }

 $cookies = array();
 foreach (headers_list() as $header) {
 // Identify cookie headers
 if (strpos($header, 'Set-Cookie:') === 0) {
 $cookies[] = $header;
 }
 }
 // Removes all cookie headers, including duplicates
 header_remove('Set-Cookie');

 // Restore one copy of each cookie
 foreach(array_unique($cookies) as $cookie) {
 header($cookie, false);
 }
}
?>`

[up](/manual/vote-note.php?id=113985&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=113985&page=function.session-start&vote=down "Vote down!")

16

[***ohcc at 163 dot com***](#113985) [¶](#113985)**11 years ago**
`The constant SID would always be '' (an empty string) if directive session.use_trans_sid in php ini file is set to 0.

So remember to set session.use_trans_sid to 1 and restart your server before you use SID in your php script.`

[up](/manual/vote-note.php?id=121507&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=121507&page=function.session-start&vote=down "Vote down!")

10

[***marco dot agnoli at me dot com***](#121507) [¶](#121507)**7 years ago**
`I recently made an interesting observation:

It seems that `session_start()` can return `true` even if the session was not properly created. In my case, the disk storage was full and so the session data could not be written to disk. I had some logic that resulted in an infinite loop when the session was not written to disk.

To check if the session really was saved to disk I used:

```
<?php

function safe_session_start() {
 # Attempt to start a session
 if (!@\session_start()) return false;

 #
 # Check if we need to perform
 # the write test.
 #
 if (!isset($_SESSION['__validated'])) {
 $_SESSION['__validated'] = 1;

 # Attempt to write session to disk
 @\session_write_close();

 # Unset the variable from memory.
 # This step may be unnecessary
 unset($_SESSION['__validated']);

 # Re-start session
 @\session_start();

 # Check if variable value is retained
 if (!isset($_SESSION['__validated'])) {
 # Session was not written to disk
 return false;
 }
 }

 return true;
}

if (!safe_session_start()) {
 # Sessions are probably not written to disk...
 # Handle error accordingly.
}

?>
```

Took me quite a while to figure this out.

Maybe it helps someone!`

[up](/manual/vote-note.php?id=120589&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=120589&page=function.session-start&vote=down "Vote down!")

11

[***bachtel at [googles email service]dotcom***](#120589) [¶](#120589)**7 years ago**
`If you are using a custom session handler via session_set_save_handler() then calling session_start() in PHP 7.1 you might see an error like this:
session_start(): Failed to read session data: user (path: /var/lib/php/session) in ...

As of this writing, it seems to be happening in PHP 7.1, and things look OK in PHP7.0.

It is also hard to track down because if a session already exists for this id (maybe created by an earlier version of PHP), it will not trigger this issue because the $session_data will not be null.

The fix is simple... you just need to check for 'null' during your read function:

<?php

function read($id)
{
 //... pull the data out of the DB, off the disk, memcache, etc
 $session_data = getSessionDataFromSomewhere($id);

 //check to see if $session_data is null before returning (CRITICAL)
 if(is_null($session_data))
 {
 $session_data = ''; //use empty string instead of null!
 }

 return $session_data;
}

?>`

[up](/manual/vote-note.php?id=92432&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=92432&page=function.session-start&vote=down "Vote down!")

9

[***emre@yazici***](#92432) [¶](#92432)**15 years ago**
`PHP Manual specifically denotes this common mistake:

Depending on the session handler, not all characters are allowed within the session id. For example, the file session handler only allows characters in the range a-z A-Z 0-9 , (comma) and - (minus)!

See session_id() manual page for more details.`

[up](/manual/vote-note.php?id=101452&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=101452&page=function.session-start&vote=down "Vote down!")

11

[***dave1010 at gmail dot com***](#101452) [¶](#101452)**14 years ago**
`PHP locks the session file until it is closed. If you have 2 scripts using the same session (i.e. from the same user) then the 2nd script will not finish its call to session_start() until the first script finishes execution.

If you have scripts that run for more than a second and users may be making more than 1 request at a time then it is worth calling session_write_close() as soon as you've finished writing session data.

<?php
// a lock is places on the session, so other scripts will have to wait
session_start();

// do all your writing to $_SESSION
$_SESSION['a'] = 1;

// $_SESSION can still be read, but writing will not update the session.
// the lock is removed and other scripts can now read the session
session_write_close();

do_something_slow();
?>

Found this out from <http://konrness.com/php5/how-to-prevent-blocking-php-requests/>`

[up](/manual/vote-note.php?id=128197&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=128197&page=function.session-start&vote=down "Vote down!")

1

[***bwz***](#128197) [¶](#128197)**1 year ago**
`Be warned of another issue with blocking sessions: if you want to call an external program (or use an external service) that needs to access your website using the same session.

For example I am printing a page as a PDF. I can just save the web page as a HTML file. But the images in the HTML are also private and require the current user session to be seen.

What will happen is that this program might hang indefinitely (or timeout) as session_start waits for the parent PHP process to release the lock. And session_start doesn't obey max_execution_time (as documented in this bug: <https://bugs.php.net/bug.php?id=72345> ), so this will effectively kill the server after a few requests, as each one will be hanging forever

It's the same if you use an external HTTP service:

<?php
$pdf = file_get_contents('<http://pdf.website.tld/?url=http://website.tld/print.php>');
?>

The service will wait for the website host to release the lock, but it can't as it is waiting for the PDF service to finish...

The nice solution is to release the lock immediately by calling session_write_close after session_start, and when you need to write to the session you do the same again, but as noted it has its own issues. Using a custom session handler is probably the best solution.`

[up](/manual/vote-note.php?id=114209&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=114209&page=function.session-start&vote=down "Vote down!")

8

[***elitescripts2000 at yahoo dot com***](#114209) [¶](#114209)**10 years ago**
`3 easy but vital things about Sessions in AJAX Apps.

<?php
// session start

// It is VERY important to include a Period if using
// a whole domain. (.yourdomain.com)
// It is VERY important to set the root path your session will always
// operate in... (/members) will ensure sessions will NOT be interfered
// with a session with a path of say (/admin) ... so you can log in
// as /admin and as /members... NEVER do unset($_SESSION)
// $_SESSION=array(); is preferred, session_unset(); session_destroy();

session_set_cookie_params(0, '/members', '.yourdomain.com', 0, 1);
session_start();
$_SESSION = array();
session_unset();
session_destroy();

session_set_cookie_params(0, '/members', '.yourdomain.com', 0, 1);
session_start();

$_SESSION['whatever'] = 'youwhat';

// session destroying

// To be safe, clear out your $_SESSION array
// Next, what most people do NOT do is delete the session cookie!
// It is easy to delete a cookie by expiring it long before the current time.
// The ONLY WAY to delete a cookie, is to make sure ALL parameters match the
// cookie to be deleted...which is easy to get those params with
// session_get_cookie_params()...
// FInally, use session_unset(); and session_destroy(); in this order to ensure
// Chrome, IE, Firefox and others, are properly destroying the session.
$_SESSION = array();
if (ini_get('session.use_cookies'))
{
 $p = session_get_cookie_params();
 setcookie(session_name(), '', time() - 31536000, $p['path'], $p['domain'], $p['secure'], $p['httponly']);
 }
session_unset();
session_destroy();

// AJAX and SESSIONS.
// Example... you start a session based PHP page, which then calls an Ajax (XMLHTTP) authenticated
// using the SAME SESSION to Poll and output the data, for example. But, you notice when you
// try to start the Polling AJAX call always HANGS and seems to hang at the session_start().
// This is because the session is opened in the first page, calls the AJAX polling example, and
// tries to open the same session (for authentication) and do the AJAX call, you MUST call
// session_write_close(); meaning you are done writing to the $_SESSION variable, which really
// represents a file that must be CLOSED with session_write_close();....
// THAN you can call your AJAX Polling code to reopen the same session and do its polling...
// Normally, the $_SESSION is closed automatically when the script is closed or finished executing
// So, if you need to keep a PHP page running after opening a SESSION, simply close it when finished
// writing to $_SESSION so the AJAX polling page can authenticate and use the same session in a
// seperate web page...

session_write_close();

?>

Hope this helps someone with their sessions...
Thanks.`

[up](/manual/vote-note.php?id=125487&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=125487&page=function.session-start&vote=down "Vote down!")

4

[***Anonymous***](#125487) [¶](#125487)**4 years ago**
`Be careful with the 'read_and_close' option. It doesn't update the session file's last modification time unlike the default PHP behaviour when you don't close the session (or when you use session_write_close explicitly).
Old session files (for me, older than 24 minutes) will be occasionally cleared by the garbage collector (for me every 09 and 39 minute of every hour).
So a session can disappear even if the page regularly sends requests to the server that only reads and closes the session.`

[up](/manual/vote-note.php?id=110649&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=110649&page=function.session-start&vote=down "Vote down!")

10

[***someOne\_01 at somewhere dot com***](#110649) [¶](#110649)**12 years ago**
`When you have an import script that takes long to execute, the browser seem to lock up and you cannot access the website anymore. this is because a request is reading and locking the session file to prevent corruption.

you can either

- use a different session handler with session_set_save_handler()

- use session_write_close() in the import script as soon you don't need session anymore (best moment is just before the long during part takes place), you can session_start when ever you want and as many times you like if your import script requires session variables changed.

example

<?php

session_start(); //initiate / open session

$_SESSION['count'] = 0; // store something in the session

session_write_close(); //now close it,

# from here every other script can be run (and makes it seem like multitasking)

for($i=0; $i<=100; $i++){ //do 100 cycles

 session_start(); //open the session again for editing a variable

 $_SESSION['count'] += 1; //change variable

 session_write_close(); //now close the session again!

 sleep(2); //every cycle sleep two seconds, or do a heavy task

}

?>`

[up](/manual/vote-note.php?id=123917&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=123917&page=function.session-start&vote=down "Vote down!")

4

[***hu60 dot cn at gmail dot com***](#123917) [¶](#123917)**5 years ago**
`The following code shows how the PHP session works. The function my_session_start() does almost the same thing as session_start().

<?php
error_reporting(E_ALL);
ini_set('display_errors', true);
ini_set('session.save_path', __DIR__);

my_session_start();

echo '<p>session id: '.my_session_id().'</p>';

echo '<code><pre>';
var_dump($_SESSION);
echo '</pre></code>';

$now = date('H:i:s');
if (isset($_SESSION['last_visit_time'])) {
 echo '<p>Last Visit Time: '.$_SESSION['last_visit_time'].'</p>';
}
echo '<p>Current Time: '.$now.'</p>';

$_SESSION['last_visit_time'] = $now;

function my_session_start() {
 global $phpsessid, $sessfile;

 if (!isset($_COOKIE['PHPSESSID']) || empty($_COOKIE['PHPSESSID'])) {
 $phpsessid = my_base32_encode(my_random_bytes(16));
 setcookie('PHPSESSID', $phpsessid, ini_get('session.cookie_lifetime'), ini_get('session.cookie_path'), ini_get('session.cookie_domain'), ini_get('session.cookie_secure'), ini_get('session.cookie_httponly'));
 } else {
 $phpsessid = substr(preg_replace('/[^a-z0-9]/', '', $_COOKIE['PHPSESSID']), 0, 26);
 }

 $sessfile = ini_get('session.save_path').'/sess_'.$phpsessid;
 if (is_file($sessfile)) {
 $_SESSION = unserialize(file_get_contents($sessfile));
 } else {
 $_SESSION = array();
 }
 register_shutdown_function('my_session_save');
}

function my_session_save() {
 global $sessfile;

 file_put_contents($sessfile, serialize($_SESSION));
}

function my_session_id() {
 global $phpsessid;
 return $phpsessid;
}

function my_random_bytes($length) {
 if (function_exists('random_bytes')) {
 return random_bytes($length);
 }
 $randomString = '';
 for ($i = 0; $i < $length; $i++) {
 $randomString .= chr(rand(0, 255));
 }
 return $randomString;
}

function my_base32_encode($input) {
 $BASE32_ALPHABET = 'abcdefghijklmnopqrstuvwxyz234567';
 $output = '';
 $v = 0;
 $vbits = 0;
 for ($i = 0, $j = strlen($input); $i < $j; $i++) {
 $v <<= 8;
 $v += ord($input[$i]);
 $vbits += 8;
 while ($vbits >= 5) {
 $vbits -= 5;
 $output .= $BASE32_ALPHABET[$v >> $vbits];
 $v &= ((1 << $vbits) - 1);
 }
 }
 if ($vbits > 0) {
 $v <<= (5 - $vbits);
 $output .= $BASE32_ALPHABET[$v];
 }
 return $output;
}`

[up](/manual/vote-note.php?id=70007&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=70007&page=function.session-start&vote=down "Vote down!")

3

[***ben dot morin at spaboom dot com***](#70007) [¶](#70007)**18 years ago**
`James at skinsupport dot com raises a good point (warning) about additional requests from the browser. The request for favicon.ico, depending on how it is handled, can have unintended results on your sessions.

For example, suppose you have ErrorDocument 404 /signin.php, no favicon.ico file and all pages in your site where the user signs in are also redirected to /signin.php if they're not already signed in.

If signin.php does any clean up or reassigning of session_id (as all good signin.php pages should) then the additional request from the browser for favicon.ico could potentially corrupt the session as set by the actual request.

Kudos to James for pointing it out and shame on me for skimming past it and not seeing how it applied to my problem. Thanks too to the Firefox Live HTTP Headers extension for showing the additional request.

Don't waste days or even hours on this if your session cookies are not being sent or if the session data isn't what you expect it to be. At a minimum, eliminate this case and see if any additional requests could be at fault.`

[up](/manual/vote-note.php?id=68123&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=68123&page=function.session-start&vote=down "Vote down!")

4

[***James***](#68123) [¶](#68123)**18 years ago**
`To avoid the notice commited by PHP since 4.3.3 when you start a session twice, check session_id() first:

if (session_id() == "")
 session_start();`

[up](/manual/vote-note.php?id=95372&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=95372&page=function.session-start&vote=down "Vote down!")

5

[***jamestrowbridge at gmail dot com***](#95372) [¶](#95372)**15 years ago**
`Unfortunately, after pulling my hair out trying to figure out why my application was working fine in every browser other than IE ( Internet Explorer) (Opera, Chrome, Firefox, Safari are what I've tested this in) - when using a DNS CNAME record (like a vanity name that is different from the DNS A record, which is the hostname of the server) sessions do not work correctly.

If you store a session var while on the CNAME:

vanity.example.com and the hostname of the server is hosname.example.com

Then try to call the variable from a different page, it will not find it because of the CNAME (I guess it store the variable under the hostname, then when trying to read it it's still looking under the CNAME) the same application works fine when accessing it under the hostname directly. Keep in mind that I was testing this on an internal network.`

[up](/manual/vote-note.php?id=51520&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=51520&page=function.session-start&vote=down "Vote down!")

4

[***jorrizza at gmail dot com***](#51520) [¶](#51520)**19 years ago**
`If you open a popup window (please no commercial ones!) with javascript window.open it might happen IE blocks the session cookie.
A simple fix for that is opening the new window with the session ID in a GET value. Note I don't use SID for this, because it will not allways be available.

----page.php----
//you must have a session active here
window.open('popup.php?sid=<?php echo session_id(); ?>', '700x500', 'toolbar=no, status=no, scrollbars=yes, location=no, menubar=no, directories=no, width=700, height=500');

----popup.php----
<?php
session_id(strip_tags($_GET['sid']));
session_start();
//and go on with your session vars
?>`

[up](/manual/vote-note.php?id=121313&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=121313&page=function.session-start&vote=down "Vote down!")

3

[***axew3 at axew3 dot com***](#121313) [¶](#121313)**7 years ago**
`X Maintainers ... Sorry to be such pain the ass, please delete this duplicate, because submitted in a crazy 'session' where i've mess things between browser tabs ... sorry again, alessio
<http://php.net/manual/en/function.session-start.php#121310>`

[up](/manual/vote-note.php?id=92490&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=92490&page=function.session-start&vote=down "Vote down!")

3

[***schlang***](#92490) [¶](#92490)**15 years ago**
`if you store your sessions in a database, always ensure that the type of the database column is large enough for your session values`

[up](/manual/vote-note.php?id=87069&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=87069&page=function.session-start&vote=down "Vote down!")

3

[***andy\_isherwood at hotmail dot com***](#87069) [¶](#87069)**16 years ago**
`A session created with session_start will only be available to pages within the directory tree of the page that first created it.

i.e. If the page that first creates the session is /dir1/dir2/index.php and the user then goes to any page above dir2 (e.g. /dir1/index.php), session_start will create a new session rather than use the existing one.`

[up](/manual/vote-note.php?id=112973&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=112973&page=function.session-start&vote=down "Vote down!")

2

[***ilnomedellaccount at gmail dot com***](#112973) [¶](#112973)**11 years ago**
`A note about session_start(), custom handlers and database foreign key constraints, which I think may be of some use...

We know that if we want our sessions into a database table (rather than the default storage), we can refer to session_set_save_handler(...) to get them there. Note that session_set_save_handler must (obviously) be called before session_start(), but let me get to the point...

Upon calling session_start() the "first time", when the session does not already exist, php will spawn a new session but will not call the write handler until script execution finishes.

Thus, the session at this point exists in the server process memory, but won't be visible as a row in the DB before the script ends.

This seems reasonable, because this avoids some unnecessary database access and resource usage before we even populate our session with meaningfull and definitive data, but this also has side-effects.

In my case, the script called session_start() to make sure a session was initiated, then used session_id() to populate another table in the DB, which had foreign_key constraint to the "sessions" table. This failed because no session was in the db at that point, yet!

I know I could simply force the creation of the row in the DB by manually calling the write handler after session_start(), when necessary, but I am not sure if this is the best possible approach.

As soon as I find an "elegant" solution, or a completely different approach, I will post some working sample code.

In the meanwhile... have fun!`

[up](/manual/vote-note.php?id=120497&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=120497&page=function.session-start&vote=down "Vote down!")

1

[***chris at ocproducts dot com***](#120497) [¶](#120497)**7 years ago**
`Initiating a session may overwrite your own custom cache control header, which may break clicking back to get back to a prior post request (on Chrome at least).
On my system it was setting 'no-store', which is much more severe than 'no-cache' and what was breaking the back-button.

If you are controlling your own cache headers carefully you need to call:
session_cache_limiter('');

...to stop it changing your cache control headers.`

[up](/manual/vote-note.php?id=129844&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129844&page=function.session-start&vote=down "Vote down!")

1

[***polygon dot co dot in at gmail dot com***](#129844) [¶](#129844)**2 months ago**
`<?php
session_start([
 'read_and_close' => true,
]);
?>

The read_and_close option I believed was to work as a read only mode session

To the surprise it works even if no sessionId cookie is present in the http request and generates a new sessionId.

Secondly, the function with this option also generates new session files with respect to the newly generated sessionId

Third, if the sessionId is invalid (no file is present with respect to sessionId) it creates a new one.`

[up](/manual/vote-note.php?id=118561&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=118561&page=function.session-start&vote=down "Vote down!")

1

[***fabmlk at hotmail dot com***](#118561) [¶](#118561)**9 years ago**
`If you ever need to open multiple distinct sessions in the same script and still let PHP generate session ids for you, here is a simple function I came up with (PHP default session handler is assumed):

<?php
/**
 * Switch to or transparently create session with name $name.
 * It can easily be expanded to manage different sessions lifetime.
 */
function session_switch($name = "PHPSESSID") {
 static $created_sessions = array();

 if (session_id() != '') { // if a session is currently opened, close it
 session_write_close();
 }
 session_name($name);
 if (isset($_COOKIE[$name])) { // if a specific session already exists, merge with $created_sessions
 $created_sessions[$name] = $_COOKIE[$name];
 }
 if (isset($created_sessions[$name])) { // if existing session, impersonate it
 session_id($created_sessions[$name]);
 session_start();
 } else { // create new session
 session_start();
 $_SESSION = array(); // empty content before duplicating session file
 // duplicate last session file with new id and current $_SESSION content
 // If this is the first created session, there is nothing to duplicate from and passing true as argument will take care of "creating" only one session file
 session_regenerate_id(empty($created_sessions));
 $created_sessions[$name] = session_id();
 }
}

session_switch("SESSION1");
$_SESSION["key"] = "value1"; // specific to session 1
session_switch("SESSION2");
$_SESSION["key"] = "value2"; // specific to session 2
session_switch("SESSION1");
// back to session 1
// ...
?>

When using this function, session_start() should not be called on its own anymore (can be replaced with a call to session_switch() without argument).
Also remember that session_start() sets a Set-Cookie HTTP header on each call, so if you echo in-between sessions, wrap with ouput buffering.

Note: it's probably rarely a good idea to handle multiple sessions so think again if you think you have a good use for it.
Personally it played its role for some quick patching of legacy code I had to maintain.`

[up](/manual/vote-note.php?id=95377&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=95377&page=function.session-start&vote=down "Vote down!")

1

[***info at nospam dot mmfilm dot sk***](#95377) [¶](#95377)**15 years ago**
`For those of you running in problems with UTF-8 encoded files:

I was getting an error because of the BOM, although i set Dreamweaver to "save as" the without the BOM. It appears that DW will not change this setting in already existing files. After creating a new file withou the BOM, everything worked well.

I also recommend <http://people.w3.org/rishida/utils/bomtester/index.php> - a utility that remote checks for the presence of BOM.`

[up](/manual/vote-note.php?id=129579&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=129579&page=function.session-start&vote=down "Vote down!")

0

[***theking2(at)king.ma***](#129579) [¶](#129579)**7 months ago**
`I generally use this to start a new session

<?php
 session_start( [
 'name' => DEBUG ? 'SessionId' : '__Secure-SessionId',
 'cookie_lifetime' => 0,
 'cookie_path' => '/',
 'cookie_secure' => true,
 'cookie_httponly' => true,
 'cookie_samesite' => 'Strict',
 'sid_length' => 96,
 'sid_bits_per_character' => 5,
 'use_strict_mode' => true,
 'referer_check' => $_SERVER['HTTP_HOST'],
 ] );
?>

which will create a session with increased entropy in the session cookie name, requires a secure session, make sure roque refers have no chance at my logon page among other things.

According to MDN[1] prefix "__Secure-" must be set for secure sessions.

[1](<https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie>)`

[up](/manual/vote-note.php?id=121310&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=121310&page=function.session-start&vote=down "Vote down!")

0

[***axew3 at axew3 dot com***](#121310) [¶](#121310)**7 years ago**
`I need, with easy, count how many times the page reload over the site, may to add a warning popup, while the counter is 0 ...
session_start();
if(isset($_SESSION['count'])){
$count = $_SESSION['count'];
$count++;
$count = $_SESSION['count'] = $count;
} else {
 $count = $_SESSION['count'] = 0;
}
echo $count;

//session_destroy();`

[up](/manual/vote-note.php?id=93673&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=93673&page=function.session-start&vote=down "Vote down!")

0

[***Charlie at NOSPAM dot example dot com***](#93673) [¶](#93673)**15 years ago**
`Be warned that depending on end of script to close the session will effectively serialize concurrent session requests. Concurrent background "data retrieval" (e.g. applications such as AJAX or amfphp/Flex) expecting to retrieve data in parallel can fall into this trap easily.

Holding the session_write_close until after an expensive operation is likewise problematic.

To minimize effects, call session_write_close (aka session_commit) as early as practical (e.g. without introducing race conditions) or otherwise avoid the serialization bottleneck.`

[up](/manual/vote-note.php?id=121311&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=121311&page=function.session-start&vote=down "Vote down!")

-1

[***axew3 at axew3 dot com***](#121311) [¶](#121311)**7 years ago**
`I just need with easy, count how many times the page reload over the site, may to add a warning popup, while the counter is 0:

session_start();
if(isset($_SESSION['count'])){
$count = $_SESSION['count'];
$count++;
$count = $_SESSION['count'] = $count;
} else {
 $count = $_SESSION['count'] = 0;
}
echo $count;

//session_destroy();`

[up](/manual/vote-note.php?id=126566&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=126566&page=function.session-start&vote=down "Vote down!")

-1

[***polygon dot co dot in at gmail dot com***](#126566) [¶](#126566)**3 years ago**
`Websites are prone to Session Attack where its proper usage is not done.

There are tools like "Apache Benchmark" (ab) and many others which can hit the website with load for load / performance testing.

Code below starts the session for every request.

<?php
session_start();

$username = $_POST['username'];
$password = $_POST['password'];

if(isValidUser($username, $password)) {

 Suserdetails = getUserDetails($username);

 $_SESSION['user_id'] = Suserdetails['user_id'];
 $_SESSION['username'] = Suserdetails['username'];
 $_SESSION['firstname'] = Suserdetails['firstname'];

 header('Location: dashboard.php');
}
?>

This generates session file for every request irrespective of PHPSESSID cookie value when I use tools like ab, there by creating inode issue.

One should start the session after properly authenticating.

<?php

$username = $_POST['username'];
$password = $_POST['password'];

if(isValidUser($username, $password)) {

 Suserdetails = getUserDetails($username);

 session_start();

 $_SESSION['user_id'] = Suserdetails['user_id'];
 $_SESSION['username'] = Suserdetails['username'];
 $_SESSION['firstname'] = Suserdetails['firstname'];

 header('Location: dashboard.php');
}
?>

Scripts other then login first validates session which requires session.

<?php

 if(session_status()!=PHP_SESSION_NONE) header('Location: login.php');

 session_start();

 if(!isset($_SESSION['user_id'])) header('Location: login.php');

 code logic below....
}
?>

This example is for file based session.
For other modes of session check function session_set_save_handler.`

[up](/manual/vote-note.php?id=102254&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=102254&page=function.session-start&vote=down "Vote down!")

-2

[***anon at ymous dot com***](#102254) [¶](#102254)**13 years ago**
`I am trying to get a session created by a browser call to be used by a command line cli->curl php call (in this case, both calls to the same server and php.ini), for a set of flexible media import routines,

but the cli->curl call always starts a new session despite me putting PHPSESSID=validID as the first parameter for the url called by curl.

I was able to fix it by calling session_id($_GET['PHPSESSID']) before calling session_start() in the script called via curl.`

[up](/manual/vote-note.php?id=105447&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=105447&page=function.session-start&vote=down "Vote down!")

-3

[***sanjuro at 1up-games dot com***](#105447) [¶](#105447)**13 years ago**
`The problem with SID is that if on occasions you don't start a session, instead of outputting an empty string for transparent integration it will return the regular undefined constant notice. So you might want to test the constant with defined() beforehand.`

[up](/manual/vote-note.php?id=96491&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=96491&page=function.session-start&vote=down "Vote down!")

-4

[***info.at.merchandisinginteractive.sk***](#96491) [¶](#96491)**14 years ago**
`A handy script that checks fot the presence of uft-8 byte order mark (BOM) in all files in all directories starting on current dir. Combined from the work of other people here...

<?php

function fopen_utf8 ($filename) {

 $file = @fopen($filename, "r");

 $bom = fread($file, 3);

 if ($bom != b"\xEF\xBB\xBF")

 {

 return false;

 }

 else

 {

 return true;

 }

}

function file_array($path, $exclude = ".|..|design", $recursive = true) {

 $path = rtrim($path, "/") . "/";

 $folder_handle = opendir($path);

 $exclude_array = explode("|", $exclude);

 $result = array();

 while(false !== ($filename = readdir($folder_handle))) {

 if(!in_array(strtolower($filename), $exclude_array)) {

 if(is_dir($path . $filename . "/")) {

 // Need to include full "path" or it's an infinite loop

 if($recursive) $result[] = file_array($path . $filename . "/", $exclude, true);

 } else {

 if ( fopen_utf8($path . $filename) )

 {

 //$result[] = $filename;

 echo ($path . $filename . "<br>");

 }

 }

 }

 }

 return $result;

}

$files = file_array(".");

?>`

[up](/manual/vote-note.php?id=92356&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=92356&page=function.session-start&vote=down "Vote down!")

-3

[***dstuff at brainsware dot org***](#92356) [¶](#92356)**15 years ago**
`It seems like spaces in the name don't work either - got a new session id generated each time`

[up](/manual/vote-note.php?id=33369&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=33369&page=function.session-start&vote=down "Vote down!")

-4

[***m dot kuiphuis at hccnet dot nl***](#33369) [¶](#33369)**21 years ago**
`[Editors Note: For more information about this

<http://www.zvon.org/tmRFC/RFC882/Output/chapter5.html> ]

I use name-based virtual hosting on Linux with Apache and PHP 4.3.2.

Every time when I refreshed (by pressing F5 in Internet Explorer) I noticed that I got a new session_id. Simultaneously browsing the same site with Netscape didn't give me that problem. First I thought this was some PHP issue (before I tested it with Netscape), but after searching a lot on the internet I found the problem.

Since I was using name based virtual hosting for my testserver and we have different webshops for different customers I used the syntax webshop_customername.servername.nl as the domain-name.

The _ in the domain name seemed to be the problem. Internet Explorer just denies setting the cookie on the client when there is a special character (like an _ ) in the domain name. For more information regarding this issue: <http://support.microsoft.com/default.aspx?scid=kb;EN-US;316112>

Stupidly enough, this information was related to asp (yuk :o)`

[up](/manual/vote-note.php?id=73952&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=73952&page=function.session-start&vote=down "Vote down!")

-4

[***leandroico---at---gmail---dot---com***](#73952) [¶](#73952)**17 years ago**
`TAGS: session_start headers output errors include_once require_once php tag new line

Errors with output headers related to *session_start()* being called inside include files.

If you are starting your session inside an include file you must be aware of the presence of undesired characters after php end tag.

Let's take an example:
> page.php
<?php
include_once 'i_have_php_end_tag.inc.php';
include_once 'init_session.inc.php';

echo "Damn! Why I'm having these output header errors?";
?>

> i_have_php_end_tag.inc.php
<?php
$_JUST_A_GLOBAL_VAR = 'Yes, a global var, indeed';
?>

> init_session.inc.php
<?php
session_start();
$_SESSION['blabla'] = 123;
?>

With all this stuff we will get an error, something like:
"... Cannot send session cache limiter - headers already sent (output started at ...", right?

To solve this problem we have to ignore all output sent by include files. To ensure that we need to use the couple of functions: *ob_start()* and *ob_end_clean()* to suppress the output. So, all we have to do is changing the *page.php* to this:

<?php
ob_start();
include_once 'i_have_php_end_tag.inc.php';
include_once 'init_session.inc.php';
ob_end_clean();

echo "Woo hoo! All right! Die you undesired outputs!!!";
?>`

[up](/manual/vote-note.php?id=60018&page=function.session-start&vote=up "Vote up!")

[down](/manual/vote-note.php?id=60018&page=function.session-start&vote=down "Vote down!")

-4

[***james at skinsupport dot com***](#60018) [¶](#60018)**19 years ago**
`One thing of note that caused me three days of trouble:

It's important to note that Firefox (for one) makes two calls to the server automatically. One for the page, and one for favicon.ico.

If you are setting session variables (as I was) to certain values when a page exists, and other values when pages don't exist, the values for non-existent pages will overwrite the values for existing pages if favicon.ico doesn't exist.

I doubt many of you are doing this, but if you are, this is a consideration you need to address or you'll be bald over the course of a three day period!`

[＋add a note](/manual/add-note.php?sect=function.session-start&repo=en&redirect=https://www.php.net/manual/en/function.session-start.php)

* [Session Functions](ref.session.php)
  + [session\_​abort](function.session-abort.php "session_​abort")
  + [session\_​cache\_​expire](function.session-cache-expire.php "session_​cache_​expire")
  + [session\_​cache\_​limiter](function.session-cache-limiter.php "session_​cache_​limiter")
  + [session\_​commit](function.session-commit.php "session_​commit")
  + [session\_​create\_​id](function.session-create-id.php "session_​create_​id")
  + [session\_​decode](function.session-decode.php "session_​decode")
  + [session\_​destroy](function.session-destroy.php "session_​destroy")
  + [session\_​encode](function.session-encode.php "session_​encode")
  + [session\_​gc](function.session-gc.php "session_​gc")
  + [session\_​get\_​cookie\_​params](function.session-get-cookie-params.php "session_​get_​cookie_​params")
  + [session\_​id](function.session-id.php "session_​id")
  + [session\_​module\_​name](function.session-module-name.php "session_​module_​name")
  + [session\_​name](function.session-name.php "session_​name")
  + [session\_​regenerate\_​id](function.session-regenerate-id.php "session_​regenerate_​id")
  + [session\_​register\_​shutdown](function.session-register-shutdown.php "session_​register_​shutdown")
  + [session\_​reset](function.session-reset.php "session_​reset")
  + [session\_​save\_​path](function.session-save-path.php "session_​save_​path")
  + [session\_​set\_​cookie\_​params](function.session-set-cookie-params.php "session_​set_​cookie_​params")
  + [session\_​set\_​save\_​handler](function.session-set-save-handler.php "session_​set_​save_​handler")
  + [session\_​start](function.session-start.php "session_​start")
  + [session\_​status](function.session-status.php "session_​status")
  + [session\_​unset](function.session-unset.php "session_​unset")
  + [session\_​write\_​close](function.session-write-close.php "session_​write_​close")

* [Copyright © 2001-2025 The PHP Documentation Group](/manual/en/copyright.php)
* [My PHP.net](/my.php)
* [Contact](/contact.php)
* [Other PHP.net sites](/sites.php)
* [Privacy policy](/privacy.php)

![To Top](/images/to-top@2x.png)

`↑` and `↓` to navigate •
`Enter` to select •
`Esc` to close

Press `Enter` without
selection to search using Google


