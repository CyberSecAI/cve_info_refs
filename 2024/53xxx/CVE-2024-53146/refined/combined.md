=== Content from git.kernel.org_30cf45e5_20250114_214449.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:48:13 +0100 |
| commit | [3c5f545c9a1f8a1869246f6f3ae8c17289d6a841](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841)) | |
| tree | [fec21f6121f884b63c8702f3b14387e6ab2d084c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841) | |
| parent | [a44a4260a28cc9a6dbe7d57a72715c97b3816c4b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a44a4260a28cc9a6dbe7d57a72715c97b3816c4b) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841&id2=a44a4260a28cc9a6dbe7d57a72715c97b3816c4b)) | |
| download | [linux-3c5f545c9a1f8a1869246f6f3ae8c17289d6a841.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3c5f545c9a1f8a1869246f6f3ae8c17289d6a841.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex 18d62d3424c1ae..a6dc8c479a4b02 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=a44a4260a28cc9a6dbe7d57a72715c97b3816c4b)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=3c5f545c9a1f8a1869246f6f3ae8c17289d6a841)@@ -297,17 +297,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:26 +0000



=== Content from git.kernel.org_e82b8b5e_20250114_214450.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7f33b92e5b18e904a481e6e208486da43e4dc841)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7f33b92e5b18e904a481e6e208486da43e4dc841)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7f33b92e5b18e904a481e6e208486da43e4dc841)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7f33b92e5b18e904a481e6e208486da43e4dc841)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Chuck Lever <chuck.lever@oracle.com> | 2024-11-11 13:41:57 -0500 |
| commit | [7f33b92e5b18e904a481e6e208486da43e4dc841](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7f33b92e5b18e904a481e6e208486da43e4dc841) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7f33b92e5b18e904a481e6e208486da43e4dc841)) | |
| tree | [a8d03f484b318e2d87cae2e92194c4d8632bbb1b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7f33b92e5b18e904a481e6e208486da43e4dc841) | |
| parent | [2d5404caa8c7bb5c4e0435f94b28834ae5456623](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2d5404caa8c7bb5c4e0435f94b28834ae5456623) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7f33b92e5b18e904a481e6e208486da43e4dc841&id2=2d5404caa8c7bb5c4e0435f94b28834ae5456623)) | |
| download | [linux-7f33b92e5b18e904a481e6e208486da43e4dc841.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7f33b92e5b18e904a481e6e208486da43e4dc841.tar.gz) | |

NFSD: Prevent a potential integer overflowIf the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7f33b92e5b18e904a481e6e208486da43e4dc841)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=7f33b92e5b18e904a481e6e208486da43e4dc841) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex b5b3ab9d719a74..478b548f4147f6 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=2d5404caa8c7bb5c4e0435f94b28834ae5456623)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=7f33b92e5b18e904a481e6e208486da43e4dc841)@@ -287,17 +287,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:28 +0000



=== Content from git.kernel.org_a20870f8_20250114_214451.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:51:18 +0100 |
| commit | [842f1c27a1aef5367e535f9e85c8c3b06352151a](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a)) | |
| tree | [469e82a58d08e6412c499cb1cccd0ab028a6c465](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a) | |
| parent | [f78318f70e3c5510179f4247c877ff9f57eb8bc4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f78318f70e3c5510179f4247c877ff9f57eb8bc4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a&id2=f78318f70e3c5510179f4247c877ff9f57eb8bc4)) | |
| download | [linux-842f1c27a1aef5367e535f9e85c8c3b06352151a.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-842f1c27a1aef5367e535f9e85c8c3b06352151a.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=842f1c27a1aef5367e535f9e85c8c3b06352151a)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=842f1c27a1aef5367e535f9e85c8c3b06352151a) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex 18d62d3424c1ae..a6dc8c479a4b02 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=f78318f70e3c5510179f4247c877ff9f57eb8bc4)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=842f1c27a1aef5367e535f9e85c8c3b06352151a)@@ -297,17 +297,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:28 +0000



=== Content from git.kernel.org_e6be88d9_20250114_214454.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=de53c5305184ca1333b87e695d329d1502d694ce)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=de53c5305184ca1333b87e695d329d1502d694ce)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=de53c5305184ca1333b87e695d329d1502d694ce)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=de53c5305184ca1333b87e695d329d1502d694ce)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:54:06 +0100 |
| commit | [de53c5305184ca1333b87e695d329d1502d694ce](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=de53c5305184ca1333b87e695d329d1502d694ce) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=de53c5305184ca1333b87e695d329d1502d694ce)) | |
| tree | [fc3ec78cfd1a55a7487fb00c77bd5847b3210741](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=de53c5305184ca1333b87e695d329d1502d694ce) | |
| parent | [3d230cfd4b9b0558c7b2039ba1def2ce6b6cd158](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d230cfd4b9b0558c7b2039ba1def2ce6b6cd158) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=de53c5305184ca1333b87e695d329d1502d694ce&id2=3d230cfd4b9b0558c7b2039ba1def2ce6b6cd158)) | |
| download | [linux-de53c5305184ca1333b87e695d329d1502d694ce.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-de53c5305184ca1333b87e695d329d1502d694ce.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=de53c5305184ca1333b87e695d329d1502d694ce)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=de53c5305184ca1333b87e695d329d1502d694ce) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex 18d62d3424c1ae..a6dc8c479a4b02 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=3d230cfd4b9b0558c7b2039ba1def2ce6b6cd158)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=de53c5305184ca1333b87e695d329d1502d694ce)@@ -297,17 +297,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:31 +0000



=== Content from git.kernel.org_15cf90e4_20250114_214450.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=745f7ce5a95e783ba62fe774325829466aec2aa8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=745f7ce5a95e783ba62fe774325829466aec2aa8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=745f7ce5a95e783ba62fe774325829466aec2aa8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=745f7ce5a95e783ba62fe774325829466aec2aa8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 10:59:41 +0100 |
| commit | [745f7ce5a95e783ba62fe774325829466aec2aa8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=745f7ce5a95e783ba62fe774325829466aec2aa8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=745f7ce5a95e783ba62fe774325829466aec2aa8)) | |
| tree | [9c434aa3e4a357997e629695726293311de9867b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=745f7ce5a95e783ba62fe774325829466aec2aa8) | |
| parent | [3dad1d8a876aee91f96da36781a6602432ec3e42](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3dad1d8a876aee91f96da36781a6602432ec3e42) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=745f7ce5a95e783ba62fe774325829466aec2aa8&id2=3dad1d8a876aee91f96da36781a6602432ec3e42)) | |
| download | [linux-745f7ce5a95e783ba62fe774325829466aec2aa8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-745f7ce5a95e783ba62fe774325829466aec2aa8.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=745f7ce5a95e783ba62fe774325829466aec2aa8)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=745f7ce5a95e783ba62fe774325829466aec2aa8) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex 8ca4c12dd22ec7..f564cd56aeff4c 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=3dad1d8a876aee91f96da36781a6602432ec3e42)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=745f7ce5a95e783ba62fe774325829466aec2aa8)@@ -283,17 +283,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:27 +0000



=== Content from git.kernel.org_dfb4998e_20250114_214452.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ccd3394f9a7200d6b088553bf38e688620cd27af)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ccd3394f9a7200d6b088553bf38e688620cd27af)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ccd3394f9a7200d6b088553bf38e688620cd27af)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ccd3394f9a7200d6b088553bf38e688620cd27af)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 14:03:02 +0100 |
| commit | [ccd3394f9a7200d6b088553bf38e688620cd27af](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ccd3394f9a7200d6b088553bf38e688620cd27af) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ccd3394f9a7200d6b088553bf38e688620cd27af)) | |
| tree | [b72c9248a0213d15f87f4c3c552cb9a3ab687d0b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ccd3394f9a7200d6b088553bf38e688620cd27af) | |
| parent | [76b9f8cbb1a33d45546677f031eeef2e71c3c6c2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=76b9f8cbb1a33d45546677f031eeef2e71c3c6c2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ccd3394f9a7200d6b088553bf38e688620cd27af&id2=76b9f8cbb1a33d45546677f031eeef2e71c3c6c2)) | |
| download | [linux-ccd3394f9a7200d6b088553bf38e688620cd27af.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ccd3394f9a7200d6b088553bf38e688620cd27af.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ccd3394f9a7200d6b088553bf38e688620cd27af)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=ccd3394f9a7200d6b088553bf38e688620cd27af) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex 72764f73cf19aa..b8cbb15560040f 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=76b9f8cbb1a33d45546677f031eeef2e71c3c6c2)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=ccd3394f9a7200d6b088553bf38e688620cd27af)@@ -287,17 +287,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:30 +0000



=== Content from git.kernel.org_79bb1991_20250114_214451.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=90adbae9dd158da8331d9fdd32077bd1af04f553)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=90adbae9dd158da8331d9fdd32077bd1af04f553)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=90adbae9dd158da8331d9fdd32077bd1af04f553)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=90adbae9dd158da8331d9fdd32077bd1af04f553)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:44:39 +0100 |
| commit | [90adbae9dd158da8331d9fdd32077bd1af04f553](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=90adbae9dd158da8331d9fdd32077bd1af04f553) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=90adbae9dd158da8331d9fdd32077bd1af04f553)) | |
| tree | [8c914e305ae8152adfc7ccfea17a1a241805a3a0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=90adbae9dd158da8331d9fdd32077bd1af04f553) | |
| parent | [af1db93c94819e6761f129b0189420462cd5ccf1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=af1db93c94819e6761f129b0189420462cd5ccf1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=90adbae9dd158da8331d9fdd32077bd1af04f553&id2=af1db93c94819e6761f129b0189420462cd5ccf1)) | |
| download | [linux-90adbae9dd158da8331d9fdd32077bd1af04f553.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-90adbae9dd158da8331d9fdd32077bd1af04f553.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=90adbae9dd158da8331d9fdd32077bd1af04f553)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=90adbae9dd158da8331d9fdd32077bd1af04f553) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex 51462f7958b3cf..55128de1a89da6 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=af1db93c94819e6761f129b0189420462cd5ccf1)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=90adbae9dd158da8331d9fdd32077bd1af04f553)@@ -285,17 +285,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:29 +0000



=== Content from git.kernel.org_f35e5273_20250114_214453.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-09 10:32:54 +0100 |
| commit | [dde654cad08fdaac370febb161ec41eb58e9d2a2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2)) | |
| tree | [ffc34637ec8c8431e2fa4ddd4bf9ba4c3ad79609](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2) | |
| parent | [10209665b5bf199f8065b2e7d2b2dc6cdf227117](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=10209665b5bf199f8065b2e7d2b2dc6cdf227117) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2&id2=10209665b5bf199f8065b2e7d2b2dc6cdf227117)) | |
| download | [linux-dde654cad08fdaac370febb161ec41eb58e9d2a2.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-dde654cad08fdaac370febb161ec41eb58e9d2a2.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=dde654cad08fdaac370febb161ec41eb58e9d2a2)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=dde654cad08fdaac370febb161ec41eb58e9d2a2) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex bc2716c1bdeabd..49a49529c6b8fb 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=10209665b5bf199f8065b2e7d2b2dc6cdf227117)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=dde654cad08fdaac370febb161ec41eb58e9d2a2)@@ -297,17 +297,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:30 +0000



=== Content from git.kernel.org_ca7bbcdc_20250114_214449.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Chuck Lever <chuck.lever@oracle.com> | 2024-09-17 12:15:23 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 13:54:26 +0100 |
| commit | [084f797dbc7e52209a4ab6dbc7f0109268754eb9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9)) | |
| tree | [4273619240833fdb0310723ae95abbe058791bae](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9) | |
| parent | [85211611661f3cd33ea9a0286368cea03486f0d2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=85211611661f3cd33ea9a0286368cea03486f0d2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9&id2=85211611661f3cd33ea9a0286368cea03486f0d2)) | |
| download | [linux-084f797dbc7e52209a4ab6dbc7f0109268754eb9.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-084f797dbc7e52209a4ab6dbc7f0109268754eb9.tar.gz) | |

NFSD: Prevent a potential integer overflowcommit 7f33b92e5b18e904a481e6e208486da43e4dc841 upstream.
If the tag length is >= U32\_MAX - 3 then the "length + 4" addition
can result in an integer overflow. Address this by splitting the
decoding into several steps so that decode\_cb\_compound4res() does
not have to perform arithmetic on the unsafe length value.
Reported-by: Dan Carpenter <dan.carpenter@linaro.org>
Cc: stable@vger.kernel.org
Reviewed-by: Jeff Layton <jlayton@kernel.org>
Signed-off-by: Chuck Lever <chuck.lever@oracle.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9)

| -rw-r--r-- | [fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/nfsd/nfs4callback.c?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9) | 14 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 7 insertions, 7 deletions

| diff --git a/fs/nfsd/nfs4callback.c b/fs/nfsd/nfs4callback.cindex e6183097517ffa..245efbbf145479 100644--- a/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=85211611661f3cd33ea9a0286368cea03486f0d2)+++ b/[fs/nfsd/nfs4callback.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/nfsd/nfs4callback.c?id=084f797dbc7e52209a4ab6dbc7f0109268754eb9)@@ -287,17 +287,17 @@ static int decode\_cb\_compound4res(struct xdr\_stream \*xdr, u32 length; \_\_be32 \*p; - p = xdr\_inline\_decode(xdr, 4 + 4);+ p = xdr\_inline\_decode(xdr, XDR\_UNIT); if (unlikely(p == NULL)) goto out\_overflow;- hdr->status = be32\_to\_cpup(p++);+ hdr->status = be32\_to\_cpup(p); /\* Ignore the tag \*/- length = be32\_to\_cpup(p++);- p = xdr\_inline\_decode(xdr, length + 4);- if (unlikely(p == NULL))+ if (xdr\_stream\_decode\_u32(xdr, &length) < 0)+ goto out\_overflow;+ if (xdr\_inline\_decode(xdr, length) == NULL)+ goto out\_overflow;+ if (xdr\_stream\_decode\_u32(xdr, &hdr->nops) < 0) goto out\_overflow;- p += XDR\_QUADLEN(length);- hdr->nops = be32\_to\_cpup(p); return 0; out\_overflow: return -EIO; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 21:43:26 +0000


