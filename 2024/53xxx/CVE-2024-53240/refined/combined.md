=== Content from git.kernel.org_82c186b2_20250114_232044.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2657ba851fa3381256d81e431b20041dc232fd88)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2657ba851fa3381256d81e431b20041dc232fd88)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2657ba851fa3381256d81e431b20041dc232fd88)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2657ba851fa3381256d81e431b20041dc232fd88)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-11-07 16:17:00 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:07:22 +0100 |
| commit | [2657ba851fa3381256d81e431b20041dc232fd88](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2657ba851fa3381256d81e431b20041dc232fd88) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2657ba851fa3381256d81e431b20041dc232fd88)) | |
| tree | [ac57d24537d18f7201ed8ec7d22a39ef682c88c2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2657ba851fa3381256d81e431b20041dc232fd88) | |
| parent | [3dfd8991ad33b10c2fb027a4cfcf57579fa786c1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2657ba851fa3381256d81e431b20041dc232fd88&id2=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)) | |
| download | [linux-2657ba851fa3381256d81e431b20041dc232fd88.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2657ba851fa3381256d81e431b20041dc232fd88.tar.gz) | |

xen/netfront: fix crash when removing devicecommit f9244fb55f37356f75c739c57323d9422d7aa0f8 upstream.
When removing a netfront device directly after a suspend/resume cycle
it might happen that the queues have not been setup again, causing a
crash during the attempt to stop the queues another time.
Fix that by checking the queues are existing before trying to stop
them.
This is XSA-465 / CVE-2024-53240.
Reported-by: Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>
Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
Signed-off-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2657ba851fa3381256d81e431b20041dc232fd88)

| -rw-r--r-- | [drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/xen-netfront.c?id=2657ba851fa3381256d81e431b20041dc232fd88) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/xen-netfront.c b/drivers/net/xen-netfront.cindex 8b4be2e4d1cf2d..0add51f1b7e4d9 100644--- a/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=3dfd8991ad33b10c2fb027a4cfcf57579fa786c1)+++ b/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=2657ba851fa3381256d81e431b20041dc232fd88)@@ -869,7 +869,7 @@ static netdev\_tx\_t xennet\_start\_xmit(struct sk\_buff \*skb, struct net\_device \*dev static int xennet\_close(struct net\_device \*dev) { struct netfront\_info \*np = netdev\_priv(dev);- unsigned int num\_queues = dev->real\_num\_tx\_queues;+ unsigned int num\_queues = np->queues ? dev->real\_num\_tx\_queues : 0; unsigned int i; struct netfront\_queue \*queue; netif\_tx\_stop\_all\_queues(np->netdev);@@ -884,6 +884,9 @@ static void xennet\_destroy\_queues(struct netfront\_info \*info) { unsigned int i; + if (!info->queues)+ return;+ for (i = 0; i < info->netdev->real\_num\_tx\_queues; i++) { struct netfront\_queue \*queue = &info->queues[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:19:21 +0000



=== Content from git.kernel.org_4ac3bf2e_20250114_232043.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-11-07 16:17:00 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:05:05 +0100 |
| commit | [20f7f0cf7af5d81b218202ef504223af84b16a8f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f)) | |
| tree | [97ded18e98539a38adf4ae269babdd5eb324988b](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f) | |
| parent | [20df02cb98657f38f35d026f2e36049d338539dd](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=20df02cb98657f38f35d026f2e36049d338539dd) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f&id2=20df02cb98657f38f35d026f2e36049d338539dd)) | |
| download | [linux-20f7f0cf7af5d81b218202ef504223af84b16a8f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-20f7f0cf7af5d81b218202ef504223af84b16a8f.tar.gz) | |

xen/netfront: fix crash when removing devicecommit f9244fb55f37356f75c739c57323d9422d7aa0f8 upstream.
When removing a netfront device directly after a suspend/resume cycle
it might happen that the queues have not been setup again, causing a
crash during the attempt to stop the queues another time.
Fix that by checking the queues are existing before trying to stop
them.
This is XSA-465 / CVE-2024-53240.
Reported-by: Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>
Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
Signed-off-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=20f7f0cf7af5d81b218202ef504223af84b16a8f)

| -rw-r--r-- | [drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/xen-netfront.c?id=20f7f0cf7af5d81b218202ef504223af84b16a8f) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/xen-netfront.c b/drivers/net/xen-netfront.cindex 9ae0903bc22506..3d643c935cdc31 100644--- a/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=20df02cb98657f38f35d026f2e36049d338539dd)+++ b/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=20f7f0cf7af5d81b218202ef504223af84b16a8f)@@ -787,7 +787,7 @@ static netdev\_tx\_t xennet\_start\_xmit(struct sk\_buff \*skb, struct net\_device \*dev static int xennet\_close(struct net\_device \*dev) { struct netfront\_info \*np = netdev\_priv(dev);- unsigned int num\_queues = dev->real\_num\_tx\_queues;+ unsigned int num\_queues = np->queues ? dev->real\_num\_tx\_queues : 0; unsigned int i; struct netfront\_queue \*queue; netif\_tx\_stop\_all\_queues(np->netdev);@@ -802,6 +802,9 @@ static void xennet\_destroy\_queues(struct netfront\_info \*info) { unsigned int i; + if (!info->queues)+ return;+ for (i = 0; i < info->netdev->real\_num\_tx\_queues; i++) { struct netfront\_queue \*queue = &info->queues[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:19:20 +0000



=== Content from xenbits.xen.org_e5364998_20250114_232041.html ===

# Information

| Advisory | [XSA-465](advisory-465.html) |
| --- | --- |
| Public release | 2024-12-17 12:00 |
| Updated | 2024-12-17 12:17 |
| Version | 3 |
| CVE(s) | [CVE-2024-53240](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53240) |
| Title | Backend can crash Linux netfront |

# Files

<advisory-465.txt> (signed advisory file)

<xsa465-linux.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

             Xen Security Advisory CVE-2024-53240 / XSA-465
                                version 3

                   Backend can crash Linux netfront

UPDATES IN VERSION 3
====================

Public release.

ISSUE DESCRIPTION
=================

After a suspend/resume cycle of a Linux guest (e.g. via "virsh dompmsuspend"/
"virsh dompmwakeup") a malicious network backend can crash the guest via a
NULL-pointer dereference in the guest's xen-netfront driver.

During the resume operation the xen-netfront driver will release some data
structures used for communication with the backend, in order to reallocate
these data structures with possibly different parameters specified by the
backend. If the backend is triggering a network device removal in the
guest before any network I/O has happened, the NULL-pointer dereference
may happen, causing a crash of the guest.

IMPACT
======

In setups with non-trusted network backends (e.g. when using untrusted
network driver domains) suspend/resume cycles of guests can result in
those guests being crashed by a malicious network backend.

VULNERABLE SYSTEMS
==================

Only systems with non-trusted network backends are vulnerable.

As far as known only Linux guests with the fix for CVE-2022-48969 applied
are vulnerable (this includes all kernel versions from 6.1 onwards).

All guest types (x86 PV, x86 PVH/HVM and Arm32/Arm64) are vulnerable.

MITIGATION
==========

Not doing guest suspend/resume cycles will avoid the vulnerability.

Using emulated NICs instead of PV ones will avoid the vulnerability.

CREDITS
=======

This issue was discovered by Marek Marczykowski-Górecki of Invisible Things Lab.

RESOLUTION
==========

Applying the attached patch resolves this issue.

xsa465-linux.patch     Linux

$ sha256sum xsa465*
[7207a22e1e70d0b00278d90e797313bee9d72a968ddd38464b90f0612667826e  xsa465-linux.patch](xsa465-linux.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of patches or mitigations is NOT permitted (except where
all the affected systems and VMs are administered and used only by
organisations which are members of the Xen Project Security Issues
Predisclosure List).  Specifically, deployment on public cloud systems
is NOT permitted.

This is because the patches need to be applied to the guests and using
emulated NICs is a guest visible configuration change.

Deployment is permitted only AFTER the embargo ends.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmdhaw0MHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZ1kYH/3u0RtjvoOLf2CTFAPhBfgVXZ0nbaQAVeVY14OXL
3WAOQzrspobwSJtVUqRCg14NllEkM2ityeAlussY++b9BFW7nqxji9yL/rSMpuPh
vsH/sDByBSUYxpaw/LgbkZVvhRq3vbK6E7fnXCw8BO9LYA+uTZRf4P6PRe0JeQtz
t0IyHsECXaPoSWzX18OtSrg1JFYhgBqB9vK4rKMvMjPpqZDIKlEgIpFwNlywZ6jx
H6T3CCKUPUZqmVegxJtXIof3STEr9bzd4StPaUrRXfToOg5ZsknUkari0Nr8xW27
mcTZaFVWgWwfI0irMs9jTp2agfQ6T+yptA8ZfM3J7kGvGcc=
=+A6o
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from git.kernel.org_18fa19ad_20250114_232044.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=7728e974ffbf14f17648dd92ea640b42b654d47c)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7728e974ffbf14f17648dd92ea640b42b654d47c)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7728e974ffbf14f17648dd92ea640b42b654d47c)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7728e974ffbf14f17648dd92ea640b42b654d47c)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-11-07 16:17:00 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:13:23 +0100 |
| commit | [7728e974ffbf14f17648dd92ea640b42b654d47c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7728e974ffbf14f17648dd92ea640b42b654d47c) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=7728e974ffbf14f17648dd92ea640b42b654d47c)) | |
| tree | [d9bec920e268e8ace6c695530952a212e018f167](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=7728e974ffbf14f17648dd92ea640b42b654d47c) | |
| parent | [1e04ca11a44452090e468c35633c7babc6019655](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1e04ca11a44452090e468c35633c7babc6019655) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7728e974ffbf14f17648dd92ea640b42b654d47c&id2=1e04ca11a44452090e468c35633c7babc6019655)) | |
| download | [linux-7728e974ffbf14f17648dd92ea640b42b654d47c.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-7728e974ffbf14f17648dd92ea640b42b654d47c.tar.gz) | |

xen/netfront: fix crash when removing devicecommit f9244fb55f37356f75c739c57323d9422d7aa0f8 upstream.
When removing a netfront device directly after a suspend/resume cycle
it might happen that the queues have not been setup again, causing a
crash during the attempt to stop the queues another time.
Fix that by checking the queues are existing before trying to stop
them.
This is XSA-465 / CVE-2024-53240.
Reported-by: Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>
Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
Signed-off-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=7728e974ffbf14f17648dd92ea640b42b654d47c)

| -rw-r--r-- | [drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/xen-netfront.c?id=7728e974ffbf14f17648dd92ea640b42b654d47c) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/xen-netfront.c b/drivers/net/xen-netfront.cindex 4265c1cd0ff716..63fe51d0e64db3 100644--- a/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=1e04ca11a44452090e468c35633c7babc6019655)+++ b/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=7728e974ffbf14f17648dd92ea640b42b654d47c)@@ -867,7 +867,7 @@ static netdev\_tx\_t xennet\_start\_xmit(struct sk\_buff \*skb, struct net\_device \*dev static int xennet\_close(struct net\_device \*dev) { struct netfront\_info \*np = netdev\_priv(dev);- unsigned int num\_queues = dev->real\_num\_tx\_queues;+ unsigned int num\_queues = np->queues ? dev->real\_num\_tx\_queues : 0; unsigned int i; struct netfront\_queue \*queue; netif\_tx\_stop\_all\_queues(np->netdev);@@ -882,6 +882,9 @@ static void xennet\_destroy\_queues(struct netfront\_info \*info) { unsigned int i; + if (!info->queues)+ return;+ for (i = 0; i < info->netdev->real\_num\_tx\_queues; i++) { struct netfront\_queue \*queue = &info->queues[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:19:21 +0000



=== Content from git.kernel.org_09f67560_20250114_232048.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-11-07 16:17:00 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:11:35 +0100 |
| commit | [fe9a8f5250aed0948b668c8a4e051e3b0fc29f09](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09)) | |
| tree | [0123dedd76fd40750dc19efa924fa50234f659b2](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09) | |
| parent | [4a41bb9f2b402469d425a1c13359d3b3ea4e6403](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4a41bb9f2b402469d425a1c13359d3b3ea4e6403) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09&id2=4a41bb9f2b402469d425a1c13359d3b3ea4e6403)) | |
| download | [linux-fe9a8f5250aed0948b668c8a4e051e3b0fc29f09.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fe9a8f5250aed0948b668c8a4e051e3b0fc29f09.tar.gz) | |

xen/netfront: fix crash when removing devicecommit f9244fb55f37356f75c739c57323d9422d7aa0f8 upstream.
When removing a netfront device directly after a suspend/resume cycle
it might happen that the queues have not been setup again, causing a
crash during the attempt to stop the queues another time.
Fix that by checking the queues are existing before trying to stop
them.
This is XSA-465 / CVE-2024-53240.
Reported-by: Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>
Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
Signed-off-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09)

| -rw-r--r-- | [drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/xen-netfront.c?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/xen-netfront.c b/drivers/net/xen-netfront.cindex 8d2aee88526c69..bcb5651f18e0f5 100644--- a/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=4a41bb9f2b402469d425a1c13359d3b3ea4e6403)+++ b/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=fe9a8f5250aed0948b668c8a4e051e3b0fc29f09)@@ -867,7 +867,7 @@ static netdev\_tx\_t xennet\_start\_xmit(struct sk\_buff \*skb, struct net\_device \*dev static int xennet\_close(struct net\_device \*dev) { struct netfront\_info \*np = netdev\_priv(dev);- unsigned int num\_queues = dev->real\_num\_tx\_queues;+ unsigned int num\_queues = np->queues ? dev->real\_num\_tx\_queues : 0; unsigned int i; struct netfront\_queue \*queue; netif\_tx\_stop\_all\_queues(np->netdev);@@ -882,6 +882,9 @@ static void xennet\_destroy\_queues(struct netfront\_info \*info) { unsigned int i; + if (!info->queues)+ return;+ for (i = 0; i < info->netdev->real\_num\_tx\_queues; i++) { struct netfront\_queue \*queue = &info->queues[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:19:25 +0000



=== Content from git.kernel.org_68d8be1a_20250114_232047.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-11-07 16:17:00 +0100 |
| --- | --- | --- |
| committer | Juergen Gross <jgross@suse.com> | 2024-12-13 09:12:24 +0100 |
| commit | [f9244fb55f37356f75c739c57323d9422d7aa0f8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8)) | |
| tree | [b49dd0f8a4ffe4cc903c59a06299d225d579a998](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8) | |
| parent | [f932fb9b40749d1c9a539d89bb3e288c077aafe5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f932fb9b40749d1c9a539d89bb3e288c077aafe5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8&id2=f932fb9b40749d1c9a539d89bb3e288c077aafe5)) | |
| download | [linux-f9244fb55f37356f75c739c57323d9422d7aa0f8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f9244fb55f37356f75c739c57323d9422d7aa0f8.tar.gz) | |

xen/netfront: fix crash when removing deviceWhen removing a netfront device directly after a suspend/resume cycle
it might happen that the queues have not been setup again, causing a
crash during the attempt to stop the queues another time.
Fix that by checking the queues are existing before trying to stop
them.
This is XSA-465 / CVE-2024-53240.
Reported-by: Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>
Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
Signed-off-by: Juergen Gross <jgross@suse.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f9244fb55f37356f75c739c57323d9422d7aa0f8)

| -rw-r--r-- | [drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/xen-netfront.c?id=f9244fb55f37356f75c739c57323d9422d7aa0f8) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/xen-netfront.c b/drivers/net/xen-netfront.cindex 4265c1cd0ff716..63fe51d0e64db3 100644--- a/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=f932fb9b40749d1c9a539d89bb3e288c077aafe5)+++ b/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=f9244fb55f37356f75c739c57323d9422d7aa0f8)@@ -867,7 +867,7 @@ static netdev\_tx\_t xennet\_start\_xmit(struct sk\_buff \*skb, struct net\_device \*dev static int xennet\_close(struct net\_device \*dev) { struct netfront\_info \*np = netdev\_priv(dev);- unsigned int num\_queues = dev->real\_num\_tx\_queues;+ unsigned int num\_queues = np->queues ? dev->real\_num\_tx\_queues : 0; unsigned int i; struct netfront\_queue \*queue; netif\_tx\_stop\_all\_queues(np->netdev);@@ -882,6 +882,9 @@ static void xennet\_destroy\_queues(struct netfront\_info \*info) { unsigned int i; + if (!info->queues)+ return;+ for (i = 0; i < info->netdev->real\_num\_tx\_queues; i++) { struct netfront\_queue \*queue = &info->queues[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:19:24 +0000



=== Content from git.kernel.org_af916562_20250114_232046.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8b41e6bccf7de93982781be4125211443382e66d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8b41e6bccf7de93982781be4125211443382e66d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b41e6bccf7de93982781be4125211443382e66d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8b41e6bccf7de93982781be4125211443382e66d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-11-07 16:17:00 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:08:57 +0100 |
| commit | [8b41e6bccf7de93982781be4125211443382e66d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8b41e6bccf7de93982781be4125211443382e66d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8b41e6bccf7de93982781be4125211443382e66d)) | |
| tree | [ab7fe929216a601989284b9590f488f1f9440027](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8b41e6bccf7de93982781be4125211443382e66d) | |
| parent | [b070291c83a6e7bd7ac4e1bb197655aea29b620f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b070291c83a6e7bd7ac4e1bb197655aea29b620f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8b41e6bccf7de93982781be4125211443382e66d&id2=b070291c83a6e7bd7ac4e1bb197655aea29b620f)) | |
| download | [linux-8b41e6bccf7de93982781be4125211443382e66d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8b41e6bccf7de93982781be4125211443382e66d.tar.gz) | |

xen/netfront: fix crash when removing devicecommit f9244fb55f37356f75c739c57323d9422d7aa0f8 upstream.
When removing a netfront device directly after a suspend/resume cycle
it might happen that the queues have not been setup again, causing a
crash during the attempt to stop the queues another time.
Fix that by checking the queues are existing before trying to stop
them.
This is XSA-465 / CVE-2024-53240.
Reported-by: Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>
Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
Signed-off-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8b41e6bccf7de93982781be4125211443382e66d)

| -rw-r--r-- | [drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/xen-netfront.c?id=8b41e6bccf7de93982781be4125211443382e66d) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/xen-netfront.c b/drivers/net/xen-netfront.cindex 95b5ab4b964e25..8425226c09f0d9 100644--- a/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=b070291c83a6e7bd7ac4e1bb197655aea29b620f)+++ b/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=8b41e6bccf7de93982781be4125211443382e66d)@@ -867,7 +867,7 @@ static netdev\_tx\_t xennet\_start\_xmit(struct sk\_buff \*skb, struct net\_device \*dev static int xennet\_close(struct net\_device \*dev) { struct netfront\_info \*np = netdev\_priv(dev);- unsigned int num\_queues = dev->real\_num\_tx\_queues;+ unsigned int num\_queues = np->queues ? dev->real\_num\_tx\_queues : 0; unsigned int i; struct netfront\_queue \*queue; netif\_tx\_stop\_all\_queues(np->netdev);@@ -882,6 +882,9 @@ static void xennet\_destroy\_queues(struct netfront\_info \*info) { unsigned int i; + if (!info->queues)+ return;+ for (i = 0; i < info->netdev->real\_num\_tx\_queues; i++) { struct netfront\_queue \*queue = &info->queues[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:19:23 +0000



=== Content from git.kernel.org_dcf6606b_20250114_232042.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-11-07 16:17:00 +0100 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:06:13 +0100 |
| commit | [1d5354a9182b6d302ae10367cbec1ca339d4e4e7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7)) | |
| tree | [8b83b6ee8f809b71c8e7fe7a954c5ac392a54559](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7) | |
| parent | [dac3f7ba392ceea9dbc6460857e24e26921776ed](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=dac3f7ba392ceea9dbc6460857e24e26921776ed) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7&id2=dac3f7ba392ceea9dbc6460857e24e26921776ed)) | |
| download | [linux-1d5354a9182b6d302ae10367cbec1ca339d4e4e7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-1d5354a9182b6d302ae10367cbec1ca339d4e4e7.tar.gz) | |

xen/netfront: fix crash when removing devicecommit f9244fb55f37356f75c739c57323d9422d7aa0f8 upstream.
When removing a netfront device directly after a suspend/resume cycle
it might happen that the queues have not been setup again, causing a
crash during the attempt to stop the queues another time.
Fix that by checking the queues are existing before trying to stop
them.
This is XSA-465 / CVE-2024-53240.
Reported-by: Marek Marczykowski-Górecki <marmarek@invisiblethingslab.com>
Fixes: d50b7914fae0 ("xen-netfront: Fix NULL sring after live migration")
Signed-off-by: Juergen Gross <jgross@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7)

| -rw-r--r-- | [drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/xen-netfront.c?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7) | 5 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 4 insertions, 1 deletions

| diff --git a/drivers/net/xen-netfront.c b/drivers/net/xen-netfront.cindex 3d149890fa36e4..bad9e549d533ee 100644--- a/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=dac3f7ba392ceea9dbc6460857e24e26921776ed)+++ b/[drivers/net/xen-netfront.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/xen-netfront.c?id=1d5354a9182b6d302ae10367cbec1ca339d4e4e7)@@ -870,7 +870,7 @@ static netdev\_tx\_t xennet\_start\_xmit(struct sk\_buff \*skb, struct net\_device \*dev static int xennet\_close(struct net\_device \*dev) { struct netfront\_info \*np = netdev\_priv(dev);- unsigned int num\_queues = dev->real\_num\_tx\_queues;+ unsigned int num\_queues = np->queues ? dev->real\_num\_tx\_queues : 0; unsigned int i; struct netfront\_queue \*queue; netif\_tx\_stop\_all\_queues(np->netdev);@@ -885,6 +885,9 @@ static void xennet\_destroy\_queues(struct netfront\_info \*info) { unsigned int i; + if (!info->queues)+ return;+ for (i = 0; i < info->netdev->real\_num\_tx\_queues; i++) { struct netfront\_queue \*queue = &info->queues[i]; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:19:19 +0000


