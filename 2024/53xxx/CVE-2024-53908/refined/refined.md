```
Message-ID: <CAN+fQHwsn21=myA6ay4=pqRVrpC4mo3eLWejcHKazzLmW+6Zqw@mail.gmail.com>
Date: Wed, 4 Dec 2024 17:42:17 +0100
From: Sarah Boyce <sarahboyce@...ngoproject.com>
To: oss-security@...ts.openwall.com
Cc: Django Security Team <security@...ngoproject.com>
Subject: Django CVE-2024-53907 and CVE-2024-53908

<https://www.djangoproject.com/weblog/2024/dec/04/security-releases/>

In accordance with `our security release policy
<<https://docs.djangoproject.com/en/dev/internals/security/>>`_, the Django
team
is issuing releases for
`Django 5.1.4 <<https://docs.djangoproject.com/en/dev/releases/5.1.4/>>`_,
`Django 5.0.10 <<https://docs.djangoproject.com/en/dev/releases/5.0.10/>>`_,
and
`Django 4.2.17 <<https://docs.djangoproject.com/en/dev/releases/4.2.17/>>`_.
These releases address the security issues detailed below. We encourage all
users of Django to upgrade as soon as possible.

CVE-2024-53908: Potential SQL injection in ``HasKey(lhs, rhs)`` on Oracle
=========================================================================

Direct usage of the ``django.db.models.fields.json.HasKey`` lookup on
Oracle is
subject to SQL injection if untrusted data is used as a ``lhs`` value.
Applications that use the ``jsonfield.has_key`` lookup through the ``__``
syntax are
unaffected.

Thanks to Seokchan Yoon for the report.

This issue has severity "high" according to the Django security policy.

Affected supported versions
===========================

* Django main
* Django 5.1
* Django 5.0
* Django 4.2

Resolution
==========

Patches to resolve the issue have been applied to Django's
main, 5.1, 5.0, and 4.2 branches.
The patches may be obtained from the following changesets.


CVE-2024-53908: Potential SQL injection in HasKey(lhs, rhs) on Oracle
---------------------------------------------------------------------

* On the `main branch <
<https://github.com/django/django/commit/8f8dc5a1fca7d076e749f307f6573af3512e7e99>
>`__
* On the `5.1 branch <
<https://github.com/django/django/commit/6943d61818e63e77b65d8b1ae65941e8f04bd87b>
>`__
* On the `5.0 branch <
<https://github.com/django/django/commit/ff08bb6c70aa45f83a5ef3bd0b601c7c9d1a7642>
>`__
* On the `4.2 branch <
<https://github.com/django/django/commit/7376bcbf508883282ffcc0f0fac5cf0ed2d6cbc5>
>`__
```
- **Root cause of vulnerability**: Direct usage of the `django.db.models.fields.json.HasKey` lookup on Oracle with untrusted data as the `lhs` value.
- **Weaknesses/vulnerabilities present**: SQL injection vulnerability.
- **Impact of exploitation**:  Potential SQL injection.
- **Attack vectors**: Direct use of `django.db.models.fields.json.HasKey` with untrusted `lhs` values on Oracle databases.
- **Required attacker capabilities/position**: Ability to control the `lhs` value in a `HasKey` lookup when using a Django application with an Oracle database backend.