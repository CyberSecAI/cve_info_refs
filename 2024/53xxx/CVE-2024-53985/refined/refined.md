Based on the provided content, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-53985

**Root Cause of Vulnerability:**
The vulnerability stems from a combination of factors:
  - The use of `Nokogiri` library for HTML5 sanitization in `rails-html-sanitizer` gem.
  - A specific bug in `Nokogiri`'s HTML5 "foreign style serialization," which is triggered when certain tag combinations are allowed.
  - Overriding the default allowed tags in `rails-html-sanitizer` to include specific combinations ("math" and "style" or "svg" and "style").

**Weaknesses/Vulnerabilities Present:**
- **Cross-Site Scripting (XSS):** The vulnerability allows an attacker to inject malicious script by exploiting how `Nokogiri` handles `style` tags within `svg` or `math` elements when HTML5 sanitization is enabled, and the allowed tags are customized to include these specific combinations, bypassing the sanitizer's intended behavior.

**Impact of Exploitation:**
- An attacker can inject arbitrary JavaScript code into the application, leading to various malicious outcomes, such as:
  - Stealing user session cookies.
  - Redirecting users to phishing websites.
  - Defacing the website.
  - Performing actions on behalf of the user.

**Attack Vectors:**
- The attacker provides malicious input containing a combination of either `<svg>` or `<math>` tag along with a nested `<style>` tag that includes an escaped `<img>` tag with an `onerror` attribute. For example:
  - `<svg><style>&lt;img src onerror=alert(1)></style></svg>`
  - `<math><style>&lt;img src onerror=alert(1)></style></math>`
- The application processes this malicious input using `rails-html-sanitizer` with HTML5 sanitization enabled and the allowed tags overridden to include the vulnerable combinations.
- Due to the `Nokogiri` bug and the customized allowed tags, the sanitizer fails to neutralize the injected script.

**Required Attacker Capabilities/Position:**
- The attacker needs to be able to submit user-controlled input that is then processed by the vulnerable `rails-html-sanitizer` configurations.
- The attacker does not need any special privileges or permissions beyond the ability to submit input, which means any user can potentially be an attacker.
- The application must have HTML5 sanitization enabled and the allowed tags overridden as described in "Impact" section.

**Additional Notes:**
- The issue is triggered specifically by a combination of HTML5 sanitization, the `Nokogiri` bug, and customized allowed tags in `rails-html-sanitizer`.
- The fix is to upgrade `Nokogiri` to v1.15.7 or >= 1.16.8 which addresses the foreign style serialization issue.
- The vulnerability was responsibly reported via HackerOne by So Sakaguchi ([mokusou](https://hackerone.com/mokusou)) and [taise](https://hackerone.com/taise).
- The vulnerability is present in version 1.6.0 of rails-html-sanitizer and fixed in 1.6.1

The provided content includes more detail than the standard CVE description would usually contain.