=== Content from git.kernel.org_c59e76a9_20250114_182840.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ca29cfcc4a21083d671522ad384532e28a43f033)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ca29cfcc4a21083d671522ad384532e28a43f033)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ca29cfcc4a21083d671522ad384532e28a43f033)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ca29cfcc4a21083d671522ad384532e28a43f033)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Russell King (Oracle) <rmk+kernel@armlinux.org.uk> | 2024-11-12 10:16:13 +0000 |
| --- | --- | --- |
| committer | Russell King (Oracle) <rmk+kernel@armlinux.org.uk> | 2024-11-12 23:51:06 +0000 |
| commit | [ca29cfcc4a21083d671522ad384532e28a43f033](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ca29cfcc4a21083d671522ad384532e28a43f033) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ca29cfcc4a21083d671522ad384532e28a43f033)) | |
| tree | [ad848160925863dc73993f2915d57dfd500ed60f](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ca29cfcc4a21083d671522ad384532e28a43f033) | |
| parent | [fb5af7d5405bf89a848819d1af007dfc73e9fb57](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fb5af7d5405bf89a848819d1af007dfc73e9fb57) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ca29cfcc4a21083d671522ad384532e28a43f033&id2=fb5af7d5405bf89a848819d1af007dfc73e9fb57)) | |
| download | [linux-ca29cfcc4a21083d671522ad384532e28a43f033.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ca29cfcc4a21083d671522ad384532e28a43f033.tar.gz) | |

ARM: fix cacheflush with PANIt seems that the cacheflush syscall got broken when PAN for LPAE was
implemented. User access was not enabled around the cache maintenance
instructions, causing them to fault.
Fixes: 7af5b901e847 ("ARM: 9358/2: Implement PAN for LPAE by TTBR0 page table walks disablement")
Reported-by: Michał Pecio <michal.pecio@gmail.com>
Tested-by: Michał Pecio <michal.pecio@gmail.com>
Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ca29cfcc4a21083d671522ad384532e28a43f033)

| -rw-r--r-- | [arch/arm/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/arm/kernel/traps.c?id=ca29cfcc4a21083d671522ad384532e28a43f033) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/arch/arm/kernel/traps.c b/arch/arm/kernel/traps.cindex 480e307501bb4b..6ea645939573fb 100644--- a/[arch/arm/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/arm/kernel/traps.c?id=fb5af7d5405bf89a848819d1af007dfc73e9fb57)+++ b/[arch/arm/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/arm/kernel/traps.c?id=ca29cfcc4a21083d671522ad384532e28a43f033)@@ -570,6 +570,7 @@ static int bad\_syscall(int n, struct pt\_regs \*regs) static inline int \_\_do\_cache\_op(unsigned long start, unsigned long end) {+ unsigned int ua\_flags; int ret;  do {@@ -578,7 +579,9 @@ \_\_do\_cache\_op(unsigned long start, unsigned long end) if (fatal\_signal\_pending(current)) return 0; + ua\_flags = uaccess\_save\_and\_enable(); ret = flush\_icache\_user\_range(start, start + chunk);+ uaccess\_restore(ua\_flags); if (ret) return ret; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:27:16 +0000



=== Content from git.kernel.org_a77b6e32_20250114_182841.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e6960a2ed49c9a25357817535f7cc50594a58604)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e6960a2ed49c9a25357817535f7cc50594a58604)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e6960a2ed49c9a25357817535f7cc50594a58604)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e6960a2ed49c9a25357817535f7cc50594a58604)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Russell King (Oracle) <rmk+kernel@armlinux.org.uk> | 2024-11-12 10:16:13 +0000 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-22 15:39:50 +0100 |
| commit | [e6960a2ed49c9a25357817535f7cc50594a58604](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e6960a2ed49c9a25357817535f7cc50594a58604) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e6960a2ed49c9a25357817535f7cc50594a58604)) | |
| tree | [9673196e2216102c9f0735807b9a663c802ff9a8](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e6960a2ed49c9a25357817535f7cc50594a58604) | |
| parent | [08137f1bceca22aa874063d4484e55d533a03106](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=08137f1bceca22aa874063d4484e55d533a03106) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e6960a2ed49c9a25357817535f7cc50594a58604&id2=08137f1bceca22aa874063d4484e55d533a03106)) | |
| download | [linux-e6960a2ed49c9a25357817535f7cc50594a58604.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e6960a2ed49c9a25357817535f7cc50594a58604.tar.gz) | |

ARM: fix cacheflush with PAN[ Upstream commit ca29cfcc4a21083d671522ad384532e28a43f033 ]
It seems that the cacheflush syscall got broken when PAN for LPAE was
implemented. User access was not enabled around the cache maintenance
instructions, causing them to fault.
Fixes: 7af5b901e847 ("ARM: 9358/2: Implement PAN for LPAE by TTBR0 page table walks disablement")
Reported-by: Michał Pecio <michal.pecio@gmail.com>
Tested-by: Michał Pecio <michal.pecio@gmail.com>
Signed-off-by: Russell King (Oracle) <rmk+kernel@armlinux.org.uk>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e6960a2ed49c9a25357817535f7cc50594a58604)

| -rw-r--r-- | [arch/arm/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/arm/kernel/traps.c?id=e6960a2ed49c9a25357817535f7cc50594a58604) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/arch/arm/kernel/traps.c b/arch/arm/kernel/traps.cindex 480e307501bb4b..6ea645939573fb 100644--- a/[arch/arm/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/arm/kernel/traps.c?id=08137f1bceca22aa874063d4484e55d533a03106)+++ b/[arch/arm/kernel/traps.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/arm/kernel/traps.c?id=e6960a2ed49c9a25357817535f7cc50594a58604)@@ -570,6 +570,7 @@ static int bad\_syscall(int n, struct pt\_regs \*regs) static inline int \_\_do\_cache\_op(unsigned long start, unsigned long end) {+ unsigned int ua\_flags; int ret;  do {@@ -578,7 +579,9 @@ \_\_do\_cache\_op(unsigned long start, unsigned long end) if (fatal\_signal\_pending(current)) return 0; + ua\_flags = uaccess\_save\_and\_enable(); ret = flush\_icache\_user\_range(start, start + chunk);+ uaccess\_restore(ua\_flags); if (ret) return ret; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 18:27:18 +0000


