=== Content from git.kernel.org_2721484b_20250114_194433.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | André Almeida <andrealmeid@igalia.com> | 2024-09-02 19:55:03 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-09 10:32:12 +0100 |
| commit | [c4b6c1781f6cc4e2283120ac8d873864b8056f21](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21)) | |
| tree | [598a65cb72398fb8b2a57b585d53a101ca9c48aa](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21) | |
| parent | [da2bc8a0c8f3ac66fdf980fc59936f851a083561](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=da2bc8a0c8f3ac66fdf980fc59936f851a083561) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21&id2=da2bc8a0c8f3ac66fdf980fc59936f851a083561)) | |
| download | [linux-c4b6c1781f6cc4e2283120ac8d873864b8056f21.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c4b6c1781f6cc4e2283120ac8d873864b8056f21.tar.gz) | |

unicode: Fix utf8\_load() error path[ Upstream commit 156bb2c569cd869583c593d27a5bd69e7b2a4264 ]
utf8\_load() requests the symbol "utf8\_data\_table" and then checks if the
requested UTF-8 version is supported. If it's unsupported, it tries to
put the data table using symbol\_put(). If an unsupported version is
requested, symbol\_put() fails like this:
kernel BUG at kernel/module/main.c:786!
RIP: 0010:\_\_symbol\_put+0x93/0xb0
Call Trace:
<TASK>
? \_\_die\_body.cold+0x19/0x27
? die+0x2e/0x50
? do\_trap+0xca/0x110
? do\_error\_trap+0x65/0x80
? \_\_symbol\_put+0x93/0xb0
? exc\_invalid\_op+0x51/0x70
? \_\_symbol\_put+0x93/0xb0
? asm\_exc\_invalid\_op+0x1a/0x20
? \_\_pfx\_cmp\_name+0x10/0x10
? \_\_symbol\_put+0x93/0xb0
? \_\_symbol\_put+0x62/0xb0
utf8\_load+0xf8/0x150
That happens because symbol\_put() expects the unique string that
identify the symbol, instead of a pointer to the loaded symbol. Fix that
by using such string.
Fixes: 2b3d04787012 ("unicode: Add utf8-data module")
Signed-off-by: André Almeida <andrealmeid@igalia.com>
Reviewed-by: Theodore Ts'o <tytso@mit.edu>
Link: [https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid@igalia.com](https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid%40igalia.com)
Signed-off-by: Gabriel Krisman Bertazi <krisman@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21)

| -rw-r--r-- | [fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/unicode/utf8-core.c?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/fs/unicode/utf8-core.c b/fs/unicode/utf8-core.cindex 8395066341a437..0400824ef4936e 100644--- a/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=da2bc8a0c8f3ac66fdf980fc59936f851a083561)+++ b/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=c4b6c1781f6cc4e2283120ac8d873864b8056f21)@@ -198,7 +198,7 @@ struct unicode\_map \*utf8\_load(unsigned int version) return um;  out\_symbol\_put:- symbol\_put(um->tables);+ symbol\_put(utf8\_data\_table); out\_free\_um: kfree(um); return ERR\_PTR(-EINVAL); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:43:11 +0000



=== Content from git.kernel.org_d3745d02_20250114_194432.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=4387cef540f36c2c9297460758cc2438305a24a0)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4387cef540f36c2c9297460758cc2438305a24a0)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4387cef540f36c2c9297460758cc2438305a24a0)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4387cef540f36c2c9297460758cc2438305a24a0)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | André Almeida <andrealmeid@igalia.com> | 2024-09-02 19:55:03 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:53:35 +0100 |
| commit | [4387cef540f36c2c9297460758cc2438305a24a0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=4387cef540f36c2c9297460758cc2438305a24a0) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=4387cef540f36c2c9297460758cc2438305a24a0)) | |
| tree | [9e725ad6779fe560d921c6206a3b990f82873f68](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=4387cef540f36c2c9297460758cc2438305a24a0) | |
| parent | [386efa339e08563dd33e83bc951aea5d407fe578](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=386efa339e08563dd33e83bc951aea5d407fe578) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4387cef540f36c2c9297460758cc2438305a24a0&id2=386efa339e08563dd33e83bc951aea5d407fe578)) | |
| download | [linux-4387cef540f36c2c9297460758cc2438305a24a0.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-4387cef540f36c2c9297460758cc2438305a24a0.tar.gz) | |

unicode: Fix utf8\_load() error path[ Upstream commit 156bb2c569cd869583c593d27a5bd69e7b2a4264 ]
utf8\_load() requests the symbol "utf8\_data\_table" and then checks if the
requested UTF-8 version is supported. If it's unsupported, it tries to
put the data table using symbol\_put(). If an unsupported version is
requested, symbol\_put() fails like this:
kernel BUG at kernel/module/main.c:786!
RIP: 0010:\_\_symbol\_put+0x93/0xb0
Call Trace:
<TASK>
? \_\_die\_body.cold+0x19/0x27
? die+0x2e/0x50
? do\_trap+0xca/0x110
? do\_error\_trap+0x65/0x80
? \_\_symbol\_put+0x93/0xb0
? exc\_invalid\_op+0x51/0x70
? \_\_symbol\_put+0x93/0xb0
? asm\_exc\_invalid\_op+0x1a/0x20
? \_\_pfx\_cmp\_name+0x10/0x10
? \_\_symbol\_put+0x93/0xb0
? \_\_symbol\_put+0x62/0xb0
utf8\_load+0xf8/0x150
That happens because symbol\_put() expects the unique string that
identify the symbol, instead of a pointer to the loaded symbol. Fix that
by using such string.
Fixes: 2b3d04787012 ("unicode: Add utf8-data module")
Signed-off-by: André Almeida <andrealmeid@igalia.com>
Reviewed-by: Theodore Ts'o <tytso@mit.edu>
Link: [https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid@igalia.com](https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid%40igalia.com)
Signed-off-by: Gabriel Krisman Bertazi <krisman@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=4387cef540f36c2c9297460758cc2438305a24a0)

| -rw-r--r-- | [fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/unicode/utf8-core.c?id=4387cef540f36c2c9297460758cc2438305a24a0) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/fs/unicode/utf8-core.c b/fs/unicode/utf8-core.cindex 67aaadc3ab072e..c887edc4f527cc 100644--- a/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=386efa339e08563dd33e83bc951aea5d407fe578)+++ b/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=4387cef540f36c2c9297460758cc2438305a24a0)@@ -198,7 +198,7 @@ struct unicode\_map \*utf8\_load(unsigned int version) return um;  out\_symbol\_put:- symbol\_put(um->tables);+ symbol\_put(utf8\_data\_table); out\_free\_um: kfree(um); return ERR\_PTR(-EINVAL); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:43:09 +0000



=== Content from git.kernel.org_384b3bba_20250114_194432.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6504dd27123966dc455494cb55217c04ca479121)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6504dd27123966dc455494cb55217c04ca479121)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6504dd27123966dc455494cb55217c04ca479121)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6504dd27123966dc455494cb55217c04ca479121)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | André Almeida <andrealmeid@igalia.com> | 2024-09-02 19:55:03 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 13:53:29 +0100 |
| commit | [6504dd27123966dc455494cb55217c04ca479121](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6504dd27123966dc455494cb55217c04ca479121) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6504dd27123966dc455494cb55217c04ca479121)) | |
| tree | [843b78440ccd4a980a69afe9124d7a7d0076d9d7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6504dd27123966dc455494cb55217c04ca479121) | |
| parent | [01f1b88acfd79103da0610b45471f6c88ea98d72](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=01f1b88acfd79103da0610b45471f6c88ea98d72) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6504dd27123966dc455494cb55217c04ca479121&id2=01f1b88acfd79103da0610b45471f6c88ea98d72)) | |
| download | [linux-6504dd27123966dc455494cb55217c04ca479121.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6504dd27123966dc455494cb55217c04ca479121.tar.gz) | |

unicode: Fix utf8\_load() error path[ Upstream commit 156bb2c569cd869583c593d27a5bd69e7b2a4264 ]
utf8\_load() requests the symbol "utf8\_data\_table" and then checks if the
requested UTF-8 version is supported. If it's unsupported, it tries to
put the data table using symbol\_put(). If an unsupported version is
requested, symbol\_put() fails like this:
kernel BUG at kernel/module/main.c:786!
RIP: 0010:\_\_symbol\_put+0x93/0xb0
Call Trace:
<TASK>
? \_\_die\_body.cold+0x19/0x27
? die+0x2e/0x50
? do\_trap+0xca/0x110
? do\_error\_trap+0x65/0x80
? \_\_symbol\_put+0x93/0xb0
? exc\_invalid\_op+0x51/0x70
? \_\_symbol\_put+0x93/0xb0
? asm\_exc\_invalid\_op+0x1a/0x20
? \_\_pfx\_cmp\_name+0x10/0x10
? \_\_symbol\_put+0x93/0xb0
? \_\_symbol\_put+0x62/0xb0
utf8\_load+0xf8/0x150
That happens because symbol\_put() expects the unique string that
identify the symbol, instead of a pointer to the loaded symbol. Fix that
by using such string.
Fixes: 2b3d04787012 ("unicode: Add utf8-data module")
Signed-off-by: André Almeida <andrealmeid@igalia.com>
Reviewed-by: Theodore Ts'o <tytso@mit.edu>
Link: [https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid@igalia.com](https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid%40igalia.com)
Signed-off-by: Gabriel Krisman Bertazi <krisman@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6504dd27123966dc455494cb55217c04ca479121)

| -rw-r--r-- | [fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/unicode/utf8-core.c?id=6504dd27123966dc455494cb55217c04ca479121) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/fs/unicode/utf8-core.c b/fs/unicode/utf8-core.cindex 8395066341a437..0400824ef4936e 100644--- a/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=01f1b88acfd79103da0610b45471f6c88ea98d72)+++ b/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=6504dd27123966dc455494cb55217c04ca479121)@@ -198,7 +198,7 @@ struct unicode\_map \*utf8\_load(unsigned int version) return um;  out\_symbol\_put:- symbol\_put(um->tables);+ symbol\_put(utf8\_data\_table); out\_free\_um: kfree(um); return ERR\_PTR(-EINVAL); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:43:09 +0000



=== Content from git.kernel.org_d921d878_20250114_194433.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | André Almeida <andrealmeid@igalia.com> | 2024-09-02 19:55:03 -0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 14:02:01 +0100 |
| commit | [89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3)) | |
| tree | [2c8411a88d8f60b6f27661ed8e1b3171537f2e7c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3) | |
| parent | [f84c5ef6ca23cc2f72f3b830d74f67944684bb05](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f84c5ef6ca23cc2f72f3b830d74f67944684bb05) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3&id2=f84c5ef6ca23cc2f72f3b830d74f67944684bb05)) | |
| download | [linux-89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3.tar.gz) | |

unicode: Fix utf8\_load() error path[ Upstream commit 156bb2c569cd869583c593d27a5bd69e7b2a4264 ]
utf8\_load() requests the symbol "utf8\_data\_table" and then checks if the
requested UTF-8 version is supported. If it's unsupported, it tries to
put the data table using symbol\_put(). If an unsupported version is
requested, symbol\_put() fails like this:
kernel BUG at kernel/module/main.c:786!
RIP: 0010:\_\_symbol\_put+0x93/0xb0
Call Trace:
<TASK>
? \_\_die\_body.cold+0x19/0x27
? die+0x2e/0x50
? do\_trap+0xca/0x110
? do\_error\_trap+0x65/0x80
? \_\_symbol\_put+0x93/0xb0
? exc\_invalid\_op+0x51/0x70
? \_\_symbol\_put+0x93/0xb0
? asm\_exc\_invalid\_op+0x1a/0x20
? \_\_pfx\_cmp\_name+0x10/0x10
? \_\_symbol\_put+0x93/0xb0
? \_\_symbol\_put+0x62/0xb0
utf8\_load+0xf8/0x150
That happens because symbol\_put() expects the unique string that
identify the symbol, instead of a pointer to the loaded symbol. Fix that
by using such string.
Fixes: 2b3d04787012 ("unicode: Add utf8-data module")
Signed-off-by: André Almeida <andrealmeid@igalia.com>
Reviewed-by: Theodore Ts'o <tytso@mit.edu>
Link: [https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid@igalia.com](https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid%40igalia.com)
Signed-off-by: Gabriel Krisman Bertazi <krisman@suse.de>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3)

| -rw-r--r-- | [fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/unicode/utf8-core.c?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/fs/unicode/utf8-core.c b/fs/unicode/utf8-core.cindex 8395066341a437..0400824ef4936e 100644--- a/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=f84c5ef6ca23cc2f72f3b830d74f67944684bb05)+++ b/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=89933f8ab3b4cad5ac14ea56a39947d1ffe7d0e3)@@ -198,7 +198,7 @@ struct unicode\_map \*utf8\_load(unsigned int version) return um;  out\_symbol\_put:- symbol\_put(um->tables);+ symbol\_put(utf8\_data\_table); out\_free\_um: kfree(um); return ERR\_PTR(-EINVAL); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:43:10 +0000



=== Content from git.kernel.org_540256a6_20250114_194431.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | André Almeida <andrealmeid@igalia.com> | 2024-09-02 19:55:03 -0300 |
| --- | --- | --- |
| committer | Gabriel Krisman Bertazi <krisman@suse.de> | 2024-09-03 12:45:07 -0400 |
| commit | [156bb2c569cd869583c593d27a5bd69e7b2a4264](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264)) | |
| tree | [00857a526c3f6f9456b35900812a3af0fcc168e4](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264) | |
| parent | [43bf9d9755bd21970d8382dc88f071f74fc18fbf](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=43bf9d9755bd21970d8382dc88f071f74fc18fbf) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264&id2=43bf9d9755bd21970d8382dc88f071f74fc18fbf)) | |
| download | [linux-156bb2c569cd869583c593d27a5bd69e7b2a4264.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-156bb2c569cd869583c593d27a5bd69e7b2a4264.tar.gz) | |

unicode: Fix utf8\_load() error pathutf8\_load() requests the symbol "utf8\_data\_table" and then checks if the
requested UTF-8 version is supported. If it's unsupported, it tries to
put the data table using symbol\_put(). If an unsupported version is
requested, symbol\_put() fails like this:
kernel BUG at kernel/module/main.c:786!
RIP: 0010:\_\_symbol\_put+0x93/0xb0
Call Trace:
<TASK>
? \_\_die\_body.cold+0x19/0x27
? die+0x2e/0x50
? do\_trap+0xca/0x110
? do\_error\_trap+0x65/0x80
? \_\_symbol\_put+0x93/0xb0
? exc\_invalid\_op+0x51/0x70
? \_\_symbol\_put+0x93/0xb0
? asm\_exc\_invalid\_op+0x1a/0x20
? \_\_pfx\_cmp\_name+0x10/0x10
? \_\_symbol\_put+0x93/0xb0
? \_\_symbol\_put+0x62/0xb0
utf8\_load+0xf8/0x150
That happens because symbol\_put() expects the unique string that
identify the symbol, instead of a pointer to the loaded symbol. Fix that
by using such string.
Fixes: 2b3d04787012 ("unicode: Add utf8-data module")
Signed-off-by: André Almeida <andrealmeid@igalia.com>
Reviewed-by: Theodore Ts'o <tytso@mit.edu>
Link: [https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid@igalia.com](https://lore.kernel.org/r/20240902225511.757831-2-andrealmeid%40igalia.com)
Signed-off-by: Gabriel Krisman Bertazi <krisman@suse.de>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=156bb2c569cd869583c593d27a5bd69e7b2a4264)

| -rw-r--r-- | [fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/fs/unicode/utf8-core.c?id=156bb2c569cd869583c593d27a5bd69e7b2a4264) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/fs/unicode/utf8-core.c b/fs/unicode/utf8-core.cindex 8395066341a437..0400824ef4936e 100644--- a/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=43bf9d9755bd21970d8382dc88f071f74fc18fbf)+++ b/[fs/unicode/utf8-core.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/fs/unicode/utf8-core.c?id=156bb2c569cd869583c593d27a5bd69e7b2a4264)@@ -198,7 +198,7 @@ struct unicode\_map \*utf8\_load(unsigned int version) return um;  out\_symbol\_put:- symbol\_put(um->tables);+ symbol\_put(utf8\_data\_table); out\_free\_um: kfree(um); return ERR\_PTR(-EINVAL); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:43:08 +0000


