```
{
  "Root cause of vulnerability": "The vulnerability is due to the accidental removal of the authentication check on the GET Workflow endpoint's fallback to archived workflows. This occurred in pull requests #12736 and #13021, specifically when the code was modified to use a sqlite-based memory store for live workflows. The Workflow Archive does not interact with the k8s API server for authentication, and any token that appears valid is considered authenticated, even if it does not have the correct RBAC permissions for Argo.",
  "Weaknesses/vulnerabilities present": [
    "Inadequate authentication and authorization on the GET Workflow endpoint for archived workflows.",
    "The system relies on token validation rather than proper authentication against the k8s API server when accessing archived workflows in `client` mode.",
    "In `sso` mode, all archived workflows are accessible to users with a valid token regardless of prior access rights.",
        "Accidental removal of auth check in the code"

  ],
  "Impact of exploitation": "An attacker can retrieve archived workflows using a fake or spoofed token in `client` mode. In `sso` mode, users can access all archived workflows with a valid token, even if they did not have access before archiving. This leads to unauthorized information disclosure of workflow data.",
  "Attack vectors": "The vulnerability can be exploited through network access by sending a GET request to the `/api/v1/workflows/{namespace}/{name}` endpoint with an invalid or spoofed authorization token.",
  "Required attacker capabilities/position": "The attacker needs network access to the Argo Workflows server. No prior privileges are required. The attacker can exploit this vulnerability from a remote location with knowledge of the API endpoint. In `client` mode the attacker needs to be able to send requests with a fake token. In `sso` mode the attacker needs to have a valid token."
}
```