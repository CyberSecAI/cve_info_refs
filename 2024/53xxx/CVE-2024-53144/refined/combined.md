=== Content from git.kernel.org_5f4d5fb2_20250114_194610.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5291ff856d2c5177b4fe9c18828312be30213193)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5291ff856d2c5177b4fe9c18828312be30213193)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5291ff856d2c5177b4fe9c18828312be30213193)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5291ff856d2c5177b4fe9c18828312be30213193)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-09-12 12:17:00 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-10 12:04:09 +0200 |
| commit | [5291ff856d2c5177b4fe9c18828312be30213193](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5291ff856d2c5177b4fe9c18828312be30213193) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5291ff856d2c5177b4fe9c18828312be30213193)) | |
| tree | [34400919ce7be8a2bafff63fd7ef32498ab47eae](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5291ff856d2c5177b4fe9c18828312be30213193) | |
| parent | [2de33ba36756bfb7fb0692046943145dd20de8f4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2de33ba36756bfb7fb0692046943145dd20de8f4) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5291ff856d2c5177b4fe9c18828312be30213193&id2=2de33ba36756bfb7fb0692046943145dd20de8f4)) | |
| download | [linux-5291ff856d2c5177b4fe9c18828312be30213193.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5291ff856d2c5177b4fe9c18828312be30213193.tar.gz) | |

Bluetooth: hci\_event: Align BR/EDR JUST\_WORKS paring with LEcommit b25e11f978b63cb7857890edb3a698599cddb10e upstream.
This aligned BR/EDR JUST\_WORKS method with LE which since 92516cd97fd4
("Bluetooth: Always request for user confirmation for Just Works")
always request user confirmation with confirm\_hint set since the
likes of bluetoothd have dedicated policy around JUST\_WORKS method
(e.g. main.conf:JustWorksRepairing).
CVE: CVE-2024-8805
Cc: stable@vger.kernel.org
Fixes: ba15a58b179e ("Bluetooth: Fix SSP acceptor just-works confirmation without MITM")
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Tested-by: Kiran K <kiran.k@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5291ff856d2c5177b4fe9c18828312be30213193)

| -rw-r--r-- | [net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_event.c?id=5291ff856d2c5177b4fe9c18828312be30213193) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 8 deletions

| diff --git a/net/bluetooth/hci\_event.c b/net/bluetooth/hci\_event.cindex b87c0f1dab9e35..561c8cb87473ef 100644--- a/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=2de33ba36756bfb7fb0692046943145dd20de8f4)+++ b/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=5291ff856d2c5177b4fe9c18828312be30213193)@@ -5324,19 +5324,16 @@ static void hci\_user\_confirm\_request\_evt(struct hci\_dev \*hdev, void \*data, goto unlock; } - /\* If no side requires MITM protection; auto-accept \*/+ /\* If no side requires MITM protection; use JUST\_CFM method \*/ if ((!loc\_mitm || conn->remote\_cap == HCI\_IO\_NO\_INPUT\_OUTPUT) && (!rem\_mitm || conn->io\_capability == HCI\_IO\_NO\_INPUT\_OUTPUT)) { - /\* If we're not the initiators request authorization to- \* proceed from user space (mgmt\_user\_confirm with- \* confirm\_hint set to 1). The exception is if neither- \* side had MITM or if the local IO capability is- \* NoInputNoOutput, in which case we do auto-accept+ /\* If we're not the initiator of request authorization and the+ \* local IO capability is not NoInputNoOutput, use JUST\_WORKS+ \* method (mgmt\_user\_confirm with confirm\_hint set to 1). \*/ if (!test\_bit(HCI\_CONN\_AUTH\_PEND, &conn->flags) &&- conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT &&- (loc\_mitm || rem\_mitm)) {+ conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT) { bt\_dev\_dbg(hdev, "Confirming auto-accept as acceptor"); confirm\_hint = 1; goto confirm; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:44:47 +0000



=== Content from git.kernel.org_8a2e4292_20250114_194613.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-09-12 12:17:00 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-10 12:01:05 +0200 |
| commit | [ad7adfb95f64a761e4784381e47bee1a362eb30d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d)) | |
| tree | [80b58c884f069de1664c06ee1be37a59f7e45c47](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d) | |
| parent | [01feafd82a6878901e66494c6710635c4a0e81e0](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=01feafd82a6878901e66494c6710635c4a0e81e0) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d&id2=01feafd82a6878901e66494c6710635c4a0e81e0)) | |
| download | [linux-ad7adfb95f64a761e4784381e47bee1a362eb30d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-ad7adfb95f64a761e4784381e47bee1a362eb30d.tar.gz) | |

Bluetooth: hci\_event: Align BR/EDR JUST\_WORKS paring with LEcommit b25e11f978b63cb7857890edb3a698599cddb10e upstream.
This aligned BR/EDR JUST\_WORKS method with LE which since 92516cd97fd4
("Bluetooth: Always request for user confirmation for Just Works")
always request user confirmation with confirm\_hint set since the
likes of bluetoothd have dedicated policy around JUST\_WORKS method
(e.g. main.conf:JustWorksRepairing).
CVE: CVE-2024-8805
Cc: stable@vger.kernel.org
Fixes: ba15a58b179e ("Bluetooth: Fix SSP acceptor just-works confirmation without MITM")
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Tested-by: Kiran K <kiran.k@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=ad7adfb95f64a761e4784381e47bee1a362eb30d)

| -rw-r--r-- | [net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_event.c?id=ad7adfb95f64a761e4784381e47bee1a362eb30d) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 8 deletions

| diff --git a/net/bluetooth/hci\_event.c b/net/bluetooth/hci\_event.cindex b2053bbe226c8c..f47da4aa0d708c 100644--- a/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=01feafd82a6878901e66494c6710635c4a0e81e0)+++ b/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=ad7adfb95f64a761e4784381e47bee1a362eb30d)@@ -5325,19 +5325,16 @@ static void hci\_user\_confirm\_request\_evt(struct hci\_dev \*hdev, void \*data, goto unlock; } - /\* If no side requires MITM protection; auto-accept \*/+ /\* If no side requires MITM protection; use JUST\_CFM method \*/ if ((!loc\_mitm || conn->remote\_cap == HCI\_IO\_NO\_INPUT\_OUTPUT) && (!rem\_mitm || conn->io\_capability == HCI\_IO\_NO\_INPUT\_OUTPUT)) { - /\* If we're not the initiators request authorization to- \* proceed from user space (mgmt\_user\_confirm with- \* confirm\_hint set to 1). The exception is if neither- \* side had MITM or if the local IO capability is- \* NoInputNoOutput, in which case we do auto-accept+ /\* If we're not the initiator of request authorization and the+ \* local IO capability is not NoInputNoOutput, use JUST\_WORKS+ \* method (mgmt\_user\_confirm with confirm\_hint set to 1). \*/ if (!test\_bit(HCI\_CONN\_AUTH\_PEND, &conn->flags) &&- conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT &&- (loc\_mitm || rem\_mitm)) {+ conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT) { bt\_dev\_dbg(hdev, "Confirming auto-accept as acceptor"); confirm\_hint = 1; goto confirm; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:44:50 +0000



=== Content from git.kernel.org_1bcfb6be_20250114_194616.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-09-12 12:17:00 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:22:02 +0200 |
| commit | [d17c631ba04e960eb6f8728b10d585de20ac4f71](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71)) | |
| tree | [759ca240e7ae6c46ea9fd75efd3b2962b5bfc98d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71) | |
| parent | [3d7ecc91fe2d723cd4ddb150c9c44a96090c7aa5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3d7ecc91fe2d723cd4ddb150c9c44a96090c7aa5) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71&id2=3d7ecc91fe2d723cd4ddb150c9c44a96090c7aa5)) | |
| download | [linux-d17c631ba04e960eb6f8728b10d585de20ac4f71.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d17c631ba04e960eb6f8728b10d585de20ac4f71.tar.gz) | |

Bluetooth: hci\_event: Align BR/EDR JUST\_WORKS paring with LEcommit b25e11f978b63cb7857890edb3a698599cddb10e upstream.
This aligned BR/EDR JUST\_WORKS method with LE which since 92516cd97fd4
("Bluetooth: Always request for user confirmation for Just Works")
always request user confirmation with confirm\_hint set since the
likes of bluetoothd have dedicated policy around JUST\_WORKS method
(e.g. main.conf:JustWorksRepairing).
CVE: CVE-2024-8805
Cc: stable@vger.kernel.org
Fixes: ba15a58b179e ("Bluetooth: Fix SSP acceptor just-works confirmation without MITM")
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Tested-by: Kiran K <kiran.k@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d17c631ba04e960eb6f8728b10d585de20ac4f71)

| -rw-r--r-- | [net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_event.c?id=d17c631ba04e960eb6f8728b10d585de20ac4f71) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 8 deletions

| diff --git a/net/bluetooth/hci\_event.c b/net/bluetooth/hci\_event.cindex bc14223f66937a..0c0141c59fd1fe 100644--- a/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=3d7ecc91fe2d723cd4ddb150c9c44a96090c7aa5)+++ b/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=d17c631ba04e960eb6f8728b10d585de20ac4f71)@@ -5422,19 +5422,16 @@ static void hci\_user\_confirm\_request\_evt(struct hci\_dev \*hdev, void \*data, goto unlock; } - /\* If no side requires MITM protection; auto-accept \*/+ /\* If no side requires MITM protection; use JUST\_CFM method \*/ if ((!loc\_mitm || conn->remote\_cap == HCI\_IO\_NO\_INPUT\_OUTPUT) && (!rem\_mitm || conn->io\_capability == HCI\_IO\_NO\_INPUT\_OUTPUT)) { - /\* If we're not the initiators request authorization to- \* proceed from user space (mgmt\_user\_confirm with- \* confirm\_hint set to 1). The exception is if neither- \* side had MITM or if the local IO capability is- \* NoInputNoOutput, in which case we do auto-accept+ /\* If we're not the initiator of request authorization and the+ \* local IO capability is not NoInputNoOutput, use JUST\_WORKS+ \* method (mgmt\_user\_confirm with confirm\_hint set to 1). \*/ if (!test\_bit(HCI\_CONN\_AUTH\_PEND, &conn->flags) &&- conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT &&- (loc\_mitm || rem\_mitm)) {+ conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT) { bt\_dev\_dbg(hdev, "Confirming auto-accept as acceptor"); confirm\_hint = 1; goto confirm; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:44:53 +0000



=== Content from git.kernel.org_3146a0f1_20250114_194615.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b25e11f978b63cb7857890edb3a698599cddb10e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b25e11f978b63cb7857890edb3a698599cddb10e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b25e11f978b63cb7857890edb3a698599cddb10e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b25e11f978b63cb7857890edb3a698599cddb10e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-09-12 12:17:00 -0400 |
| --- | --- | --- |
| committer | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-09-27 10:52:20 -0400 |
| commit | [b25e11f978b63cb7857890edb3a698599cddb10e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b25e11f978b63cb7857890edb3a698599cddb10e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b25e11f978b63cb7857890edb3a698599cddb10e)) | |
| tree | [38f370000be12db52c8b2e99581af0bb7e4ff5c9](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b25e11f978b63cb7857890edb3a698599cddb10e) | |
| parent | [7b1ab460592ca818e7b52f27cd3ec86af79220d1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=7b1ab460592ca818e7b52f27cd3ec86af79220d1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b25e11f978b63cb7857890edb3a698599cddb10e&id2=7b1ab460592ca818e7b52f27cd3ec86af79220d1)) | |
| download | [linux-b25e11f978b63cb7857890edb3a698599cddb10e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b25e11f978b63cb7857890edb3a698599cddb10e.tar.gz) | |

Bluetooth: hci\_event: Align BR/EDR JUST\_WORKS paring with LEThis aligned BR/EDR JUST\_WORKS method with LE which since 92516cd97fd4
("Bluetooth: Always request for user confirmation for Just Works")
always request user confirmation with confirm\_hint set since the
likes of bluetoothd have dedicated policy around JUST\_WORKS method
(e.g. main.conf:JustWorksRepairing).
CVE: CVE-2024-8805
Cc: stable@vger.kernel.org
Fixes: ba15a58b179e ("Bluetooth: Fix SSP acceptor just-works confirmation without MITM")
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Tested-by: Kiran K <kiran.k@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b25e11f978b63cb7857890edb3a698599cddb10e)

| -rw-r--r-- | [net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_event.c?id=b25e11f978b63cb7857890edb3a698599cddb10e) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 8 deletions

| diff --git a/net/bluetooth/hci\_event.c b/net/bluetooth/hci\_event.cindex b87c0f1dab9e35..561c8cb87473ef 100644--- a/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=7b1ab460592ca818e7b52f27cd3ec86af79220d1)+++ b/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=b25e11f978b63cb7857890edb3a698599cddb10e)@@ -5324,19 +5324,16 @@ static void hci\_user\_confirm\_request\_evt(struct hci\_dev \*hdev, void \*data, goto unlock; } - /\* If no side requires MITM protection; auto-accept \*/+ /\* If no side requires MITM protection; use JUST\_CFM method \*/ if ((!loc\_mitm || conn->remote\_cap == HCI\_IO\_NO\_INPUT\_OUTPUT) && (!rem\_mitm || conn->io\_capability == HCI\_IO\_NO\_INPUT\_OUTPUT)) { - /\* If we're not the initiators request authorization to- \* proceed from user space (mgmt\_user\_confirm with- \* confirm\_hint set to 1). The exception is if neither- \* side had MITM or if the local IO capability is- \* NoInputNoOutput, in which case we do auto-accept+ /\* If we're not the initiator of request authorization and the+ \* local IO capability is not NoInputNoOutput, use JUST\_WORKS+ \* method (mgmt\_user\_confirm with confirm\_hint set to 1). \*/ if (!test\_bit(HCI\_CONN\_AUTH\_PEND, &conn->flags) &&- conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT &&- (loc\_mitm || rem\_mitm)) {+ conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT) { bt\_dev\_dbg(hdev, "Confirming auto-accept as acceptor"); confirm\_hint = 1; goto confirm; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:44:52 +0000



=== Content from www.zerodayinitiative.com_567e2ba9_20250114_194619.html ===

[![thezdi](/images/logo.svg)](/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
  [SIGN UP](/portal/register/)

Menu

* [PRIVACY](https://www.trendmicro.com/privacy/)
* [WHO WE ARE](/about/)
* [HOW IT WORKS](/about/benefits/)
* [BLOG](/blog/)
* [ADVISORIES](/advisories/)
* [LOG IN](/portal/)
* [SIGN UP](/portal/register/)

* [![thezdi](/images/logo.svg)](/)
* [Trend Micro](https://www.trendmicro.com/)

# Advisory Details

September 17th, 2024
## BlueZ HID over GATT Profile Improper Access Control Remote Code Execution Vulnerability

### ZDI-24-1229ZDI-CAN-25177

| CVE ID | [CVE-2024-8805](https://www.cve.org/CVERecord?id=CVE-2024-8805) |
| --- | --- |
| CVSS SCORE | 8.8, [AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](http://nvd.nist.gov/cvss.cfm?calculator&version=3.0&vector=AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H) |
| AFFECTED VENDORS | [BlueZ](http://www.bluez.org/) |
| AFFECTED PRODUCTS | [BlueZ](http://www.bluez.org/) |
| VULNERABILITY DETAILS | This vulnerability allows network-adjacent attackers to execute arbitrary code on affected installations of BlueZ. Authentication is not required to exploit this vulnerability.  The specific flaw exists within the implementation of the HID over GATT Profile. The issue results from the lack of authorization prior to allowing access to functionality. An attacker can leverage this vulnerability to execute code in the context of the current user. |
| ADDITIONAL DETAILS | [https://patchwork.kernel.org/project/bluetooth/patch/20240912204458.3037144-1-luiz.dentz@gmail.com/](https://patchwork.kernel.org/project/bluetooth/patch/20240912204458.3037144-1-luiz.dentz%40gmail.com/)  <https://git.kernel.org/pub/scm/linux/kernel/git/bluetooth/bluetooth-next.git/commit/?id=370e38c32529e0899bb387a70d5d92dfb5a2b3c5> |
| DISCLOSURE TIMELINE | * 2024-09-10 - Vulnerability reported to vendor * 2024-09-17 - Coordinated public release of advisory * 2024-10-09 - Advisory Updated |
| CREDIT | MICHAEL RANDRIANANTENAINA [https://elkamika.blogspot.com/] |

[BACK TO ADVISORIES](/advisories/)

### General Inquiries

zdi@trendmicro.com

### Find us on X

[@thezdi](https://twitter.com/thezdi)

### Find us on Mastodon

[Mastodon](https://infosec.exchange/%40thezdi)

### Media Inquiries

media\_relations@trendmicro.com

### Sensitive Email Communications

[PGP Key](https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc)

[WHO WE ARE](/about/)

* [Our Mission](/about/)
* [Trend Micro](https://www.trendmicro.com)
* [TippingPoint IPS](https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html)

[HOW IT WORKS](/about/benefits/)

* [Process](/about/benefits/#process)
* [Researcher Rewards](/about/benefits/#researcher-rewards)
* [FAQS](/about/faq/)
* [Privacy](https://www.trendmicro.com/privacy/)

[ADVISORIES](/advisories)

* [Published Advisories](/advisories/published)
* [Upcoming Advisories](/advisories/upcoming)
* [RSS Feeds](/rss)

[BLOG](/blog)

[![thezdi](/images/logo-footer.svg)](/)



=== Content from git.kernel.org_7ddb2ff1_20250114_194611.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=830c03e58beb70b99349760f822e505ecb4eeb7e)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=830c03e58beb70b99349760f822e505ecb4eeb7e)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=830c03e58beb70b99349760f822e505ecb4eeb7e)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=830c03e58beb70b99349760f822e505ecb4eeb7e)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Luiz Augusto von Dentz <luiz.von.dentz@intel.com> | 2024-09-12 12:17:00 -0400 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-10 11:57:59 +0200 |
| commit | [830c03e58beb70b99349760f822e505ecb4eeb7e](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=830c03e58beb70b99349760f822e505ecb4eeb7e) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=830c03e58beb70b99349760f822e505ecb4eeb7e)) | |
| tree | [09e170de471b174d76b4abf54226f13bcae7795d](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=830c03e58beb70b99349760f822e505ecb4eeb7e) | |
| parent | [2f4e3926bc507562bf0492d92c59918c33c77911](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2f4e3926bc507562bf0492d92c59918c33c77911) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=830c03e58beb70b99349760f822e505ecb4eeb7e&id2=2f4e3926bc507562bf0492d92c59918c33c77911)) | |
| download | [linux-830c03e58beb70b99349760f822e505ecb4eeb7e.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-830c03e58beb70b99349760f822e505ecb4eeb7e.tar.gz) | |

Bluetooth: hci\_event: Align BR/EDR JUST\_WORKS paring with LEcommit b25e11f978b63cb7857890edb3a698599cddb10e upstream.
This aligned BR/EDR JUST\_WORKS method with LE which since 92516cd97fd4
("Bluetooth: Always request for user confirmation for Just Works")
always request user confirmation with confirm\_hint set since the
likes of bluetoothd have dedicated policy around JUST\_WORKS method
(e.g. main.conf:JustWorksRepairing).
CVE: CVE-2024-8805
Cc: stable@vger.kernel.org
Fixes: ba15a58b179e ("Bluetooth: Fix SSP acceptor just-works confirmation without MITM")
Signed-off-by: Luiz Augusto von Dentz <luiz.von.dentz@intel.com>
Tested-by: Kiran K <kiran.k@intel.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=830c03e58beb70b99349760f822e505ecb4eeb7e)

| -rw-r--r-- | [net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/net/bluetooth/hci_event.c?id=830c03e58beb70b99349760f822e505ecb4eeb7e) | 13 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 5 insertions, 8 deletions

| diff --git a/net/bluetooth/hci\_event.c b/net/bluetooth/hci\_event.cindex b86a30c600a9ab..da056cca3edbcf 100644--- a/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=2f4e3926bc507562bf0492d92c59918c33c77911)+++ b/[net/bluetooth/hci\_event.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/net/bluetooth/hci_event.c?id=830c03e58beb70b99349760f822e505ecb4eeb7e)@@ -5324,19 +5324,16 @@ static void hci\_user\_confirm\_request\_evt(struct hci\_dev \*hdev, void \*data, goto unlock; } - /\* If no side requires MITM protection; auto-accept \*/+ /\* If no side requires MITM protection; use JUST\_CFM method \*/ if ((!loc\_mitm || conn->remote\_cap == HCI\_IO\_NO\_INPUT\_OUTPUT) && (!rem\_mitm || conn->io\_capability == HCI\_IO\_NO\_INPUT\_OUTPUT)) { - /\* If we're not the initiators request authorization to- \* proceed from user space (mgmt\_user\_confirm with- \* confirm\_hint set to 1). The exception is if neither- \* side had MITM or if the local IO capability is- \* NoInputNoOutput, in which case we do auto-accept+ /\* If we're not the initiator of request authorization and the+ \* local IO capability is not NoInputNoOutput, use JUST\_WORKS+ \* method (mgmt\_user\_confirm with confirm\_hint set to 1). \*/ if (!test\_bit(HCI\_CONN\_AUTH\_PEND, &conn->flags) &&- conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT &&- (loc\_mitm || rem\_mitm)) {+ conn->io\_capability != HCI\_IO\_NO\_INPUT\_OUTPUT) { bt\_dev\_dbg(hdev, "Confirming auto-accept as acceptor"); confirm\_hint = 1; goto confirm; |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:44:48 +0000


