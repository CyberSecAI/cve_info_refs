=== Content from xenbits.xen.org_df437bc2_20250114_203736.html ===

# Information

| Advisory | [XSA-466](advisory-466.html) |
| --- | --- |
| Public release | 2024-12-17 12:00 |
| Updated | 2024-12-17 12:17 |
| Version | 3 |
| CVE(s) | [CVE-2024-53241](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-53241) |
| Title | Xen hypercall page unsafe against speculative attacks |

# Files

<advisory-466.txt> (signed advisory file)

<xsa466-linux-01.patch>

<xsa466-linux-02.patch>

<xsa466-linux-03.patch>

<xsa466-linux-04.patch>

<xsa466-linux-05.patch>

<xsa466-linux-06.patch>

<xsa466-linux-07.patch>

<xsa466-xen.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

             Xen Security Advisory CVE-2024-53241 / XSA-466
                                version 3

         Xen hypercall page unsafe against speculative attacks

UPDATES IN VERSION 3
====================

Update of patch 5, public release.

ISSUE DESCRIPTION
=================

Xen guests need to use different processor instructions to make explicit
calls into the Xen hypervisor depending on guest type and/or CPU
vendor. In order to hide those differences, the hypervisor can fill a
hypercall page with the needed instruction sequences, allowing the guest
operating system to call into the hypercall page instead of having to
choose the correct instructions.

The hypercall page contains whole functions, which are written by the
hypervisor and executed by the guest. With the lack of an interface
between the guest OS and the hypervisor specifying how a potential
modification of those functions should look like, the Xen hypervisor has
no knowledge how any potential mitigation should look like or which
hardening features should be put into place.

This results in potential vulnerabilities if the guest OS is using any
speculative mitigation that performs a compiler transform on "ret"
instructions in order to work (e.g. the Linux kernel rethunk or safe-ret
mitigations).

Furthermore, the hypercall page has no provision for Control-flow
Integrity schemes (e.g. kCFI/CET-IBT/FineIBT), and will simply
malfunction in such configurations.

IMPACT
======

Some mitigations for hardware vulnerabilities the guest OS is relying on to
work might not be fully functional, resulting in e.g. guest user processes
being able to read data they ought not have access to.

VULNERABLE SYSTEMS
==================

Only x86 systems are potentially vulnerable, Arm systems are not vulnerable.

All guest types (PV, PVH and HVM) are potentially vulnerable.

Linux guests are known to be vulnerable, guests using other operating
systems might be vulnerable, too.

MITIGATION
==========

Running only Linux guest kernels not relying on "ret" assembler instruction
patching (kernel config option CONFIG_MITIGATION_RETHUNK/CONFIG_RETHUNK
disabled) will avoid the vulnerability, as long as this option isn't
required to be safe on the underlying hardware.

CREDITS
=======

This issue was discovered by Andrew Cooper of XenServer.

RESOLUTION
==========

Applying the set of attached patches resolves this issue.

The patch to Xen is simply a documentation update to clarify that an OS author
might not want to use a hypercall page.

xsa466-linux-*.patch    Linux
xsa466-xen.patch        xen-unstable

$ sha256sum xsa466*
[498fb2538f650d694bbd6b7d2333dcf9a12d0bdfcba65257a7d14c88f5b86801  xsa466-linux-01.patch](xsa466-linux-01.patch)
[1e0d5f68d1cb4a0ef8914ae6bdeb4e18bae94c6d19659708ad707da784c0aa5c  xsa466-linux-02.patch](xsa466-linux-02.patch)
[b3056b34c1565f901cb4ba11c03a51d4f045b5de7cd16c6e510e0bcee8cc6cd7  xsa466-linux-03.patch](xsa466-linux-03.patch)
[0215e56739ab5b0d0ec0125f3d1806c3a0a0dcb3f562014f59b5145184a41467  xsa466-linux-04.patch](xsa466-linux-04.patch)
[314e67060ab4f47883cf2b124d54ce3cd4b0363f0545ad907a7b754a4405aacd  xsa466-linux-05.patch](xsa466-linux-05.patch)
[adbef75416379d96ebb72463872f993e9d8b7d119091480ad1e70fd448481733  xsa466-linux-06.patch](xsa466-linux-06.patch)
[36874014cee5d5213610a6ffdd0e3e67d0258d28f2587b8470fdd0cef96e5013  xsa466-linux-07.patch](xsa466-linux-07.patch)
[367f981ef8adc11b99cc6999b784305bcdcd55db0358fd6a2171509bf7f64345  xsa466-xen.patch](xsa466-xen.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of patches or mitigations is NOT permitted (except where
all the affected systems and VMs are administered and used only by
organisations which are members of the Xen Project Security Issues
Predisclosure List).  Specifically, deployment on public cloud systems
is NOT permitted.

This is because the mitigation or patches need to be applied to the guests.

Deployment is permitted only AFTER the embargo ends.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmdhaxAMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZUeMH/0Qkn9G8iQWJ0fHMCxvd1lcr3RNWK5GfXqlAZvuJ
YRQMDslYCzuvzrkLnoe/P/zSSs+omEYMcOVsJCBkTqePs8yIdqwBvBfZ79I1htIu
IdyJt8SE5+b70ZlumQJ8ef1Za3lp8bxvEZVa8GIokOu0Ef1iqUKNl7tQgIoQjOUH
bV/1sFN5MNFsUshOW5DnLiRrE8j0/0nfbzHPu5H9S2B4eN38oPmTabvZG/IHky8R
VFyTvqFrKZONDDhdxyFE9PBOtP6Bu3EV+Emmxb3Q84l2oEIqgab0Xxj4QGBTuLMn
PPcU5/D6Giqx3jBMdrkMAXtBuXBYO/inqsX1IJLic9W13+A=
=wlOW
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from git.kernel.org_3af512ab_20250114_203738.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-10-16 10:40:26 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:11:36 +0100 |
| commit | [82c211ead1ec440dbf81727e17b03b5e3c44b93d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d)) | |
| tree | [b596fc6aaf88032109bc75322ee30023f0a35636](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d) | |
| parent | [cd95149561d582ecbcf29387b9c7ec4563084ada](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cd95149561d582ecbcf29387b9c7ec4563084ada) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d&id2=cd95149561d582ecbcf29387b9c7ec4563084ada)) | |
| download | [linux-82c211ead1ec440dbf81727e17b03b5e3c44b93d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-82c211ead1ec440dbf81727e17b03b5e3c44b93d.tar.gz) | |

x86/xen: don't do PV iret hypercall through hypercall pagecommit a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906 upstream.
Instead of jumping to the Xen hypercall page for doing the iret
hypercall, directly code the required sequence in xen-asm.S.
This is done in preparation of no longer using hypercall page at all,
as it has shown to cause problems with speculation mitigations.
This is part of XSA-466 / CVE-2024-53241.
Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
Signed-off-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d)

| -rw-r--r-- | [arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/xen/xen-asm.S?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d) | 27 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 18 insertions, 9 deletions

| diff --git a/arch/x86/xen/xen-asm.S b/arch/x86/xen/xen-asm.Sindex 1a9cd18dfbd312..72f61a69f72eb2 100644--- a/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=cd95149561d582ecbcf29387b9c7ec4563084ada)+++ b/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=82c211ead1ec440dbf81727e17b03b5e3c44b93d)@@ -176,7 +176,6 @@ SYM\_CODE\_START(xen\_early\_idt\_handler\_array) SYM\_CODE\_END(xen\_early\_idt\_handler\_array) \_\_FINIT -hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 /\* \* Xen64 iret frame: \*@@ -186,17 +185,28 @@ hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 \* cs \* rip <-- standard iret frame \*- \* flags+ \* flags <-- xen\_iret must push from here on \*- \* rcx }- \* r11 }<-- pushed by hypercall page- \* rsp->rax }+ \* rcx+ \* r11+ \* rsp->rax \*/+.macro xen\_hypercall\_iret+ pushq $0 /\* Flags \*/+ push %rcx+ push %r11+ push %rax+ mov $\_\_HYPERVISOR\_iret, %eax+ syscall /\* Do the IRET. \*/+#ifdef CONFIG\_MITIGATION\_SLS+ int3+#endif+.endm+ SYM\_CODE\_START(xen\_iret) UNWIND\_HINT\_UNDEFINED ANNOTATE\_NOENDBR- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_iret)  /\*@@ -301,8 +311,7 @@ SYM\_CODE\_START(xen\_entry\_SYSENTER\_compat) ENDBR lea 16(%rsp), %rsp /\* strip %rcx, %r11 \*/ mov $-ENOSYS, %rax- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_entry\_SYSENTER\_compat) SYM\_CODE\_END(xen\_entry\_SYSCALL\_compat) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:36:15 +0000



=== Content from git.kernel.org_d94c6cc6_20250114_203737.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-10-16 10:40:26 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:06:13 +0100 |
| commit | [05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5)) | |
| tree | [6c23c28559a0ace4baf23b20cfb1dad5bfdaad88](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5) | |
| parent | [bed5b6a6f207ebd2248c8381ff56ed1a009953d9](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bed5b6a6f207ebd2248c8381ff56ed1a009953d9) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5&id2=bed5b6a6f207ebd2248c8381ff56ed1a009953d9)) | |
| download | [linux-05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5.tar.gz) | |

x86/xen: don't do PV iret hypercall through hypercall pagecommit a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906 upstream.
Instead of jumping to the Xen hypercall page for doing the iret
hypercall, directly code the required sequence in xen-asm.S.
This is done in preparation of no longer using hypercall page at all,
as it has shown to cause problems with speculation mitigations.
This is part of XSA-466 / CVE-2024-53241.
Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
Signed-off-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5)

| -rw-r--r-- | [arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/xen/xen-asm.S?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5) | 27 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 18 insertions, 9 deletions

| diff --git a/arch/x86/xen/xen-asm.S b/arch/x86/xen/xen-asm.Sindex 3a33713cf449fb..94bed27f67291f 100644--- a/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=bed5b6a6f207ebd2248c8381ff56ed1a009953d9)+++ b/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=05df6e6cd9a76b778aee33c3c18c9f3b3566d4a5)@@ -198,7 +198,6 @@ SYM\_CODE\_START(xen\_early\_idt\_handler\_array) SYM\_CODE\_END(xen\_early\_idt\_handler\_array) \_\_FINIT -hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 /\* \* Xen64 iret frame: \*@@ -208,16 +207,27 @@ hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 \* cs \* rip <-- standard iret frame \*- \* flags+ \* flags <-- xen\_iret must push from here on \*- \* rcx }- \* r11 }<-- pushed by hypercall page- \* rsp->rax }+ \* rcx+ \* r11+ \* rsp->rax \*/+.macro xen\_hypercall\_iret+ pushq $0 /\* Flags \*/+ push %rcx+ push %r11+ push %rax+ mov $\_\_HYPERVISOR\_iret, %eax+ syscall /\* Do the IRET. \*/+#ifdef CONFIG\_MITIGATION\_SLS+ int3+#endif+.endm+ SYM\_CODE\_START(xen\_iret) UNWIND\_HINT\_EMPTY- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_iret)  /\*@@ -318,8 +328,7 @@ SYM\_CODE\_START(xen\_entry\_SYSENTER\_compat) UNWIND\_HINT\_ENTRY lea 16(%rsp), %rsp /\* strip %rcx, %r11 \*/ mov $-ENOSYS, %rax- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_entry\_SYSENTER\_compat) SYM\_CODE\_END(xen\_entry\_SYSCALL\_compat) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:36:14 +0000



=== Content from git.kernel.org_12433f65_20250114_203739.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=f7c3fdad0a474062d566aae3289d490d7e702d30)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f7c3fdad0a474062d566aae3289d490d7e702d30)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f7c3fdad0a474062d566aae3289d490d7e702d30)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f7c3fdad0a474062d566aae3289d490d7e702d30)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-10-16 10:40:26 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:13:23 +0100 |
| commit | [f7c3fdad0a474062d566aae3289d490d7e702d30](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f7c3fdad0a474062d566aae3289d490d7e702d30) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=f7c3fdad0a474062d566aae3289d490d7e702d30)) | |
| tree | [0a64c3df1c38d4b2ff1ce3323191156d68304267](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=f7c3fdad0a474062d566aae3289d490d7e702d30) | |
| parent | [fa0f23a60ea5c20e9e41bd2cf8bc049017c4f305](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fa0f23a60ea5c20e9e41bd2cf8bc049017c4f305) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f7c3fdad0a474062d566aae3289d490d7e702d30&id2=fa0f23a60ea5c20e9e41bd2cf8bc049017c4f305)) | |
| download | [linux-f7c3fdad0a474062d566aae3289d490d7e702d30.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-f7c3fdad0a474062d566aae3289d490d7e702d30.tar.gz) | |

x86/xen: don't do PV iret hypercall through hypercall pagecommit a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906 upstream.
Instead of jumping to the Xen hypercall page for doing the iret
hypercall, directly code the required sequence in xen-asm.S.
This is done in preparation of no longer using hypercall page at all,
as it has shown to cause problems with speculation mitigations.
This is part of XSA-466 / CVE-2024-53241.
Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
Signed-off-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=f7c3fdad0a474062d566aae3289d490d7e702d30)

| -rw-r--r-- | [arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/xen/xen-asm.S?id=f7c3fdad0a474062d566aae3289d490d7e702d30) | 27 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 18 insertions, 9 deletions

| diff --git a/arch/x86/xen/xen-asm.S b/arch/x86/xen/xen-asm.Sindex 83189cf5cdce93..ca6edfe4c14b17 100644--- a/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=fa0f23a60ea5c20e9e41bd2cf8bc049017c4f305)+++ b/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=f7c3fdad0a474062d566aae3289d490d7e702d30)@@ -176,7 +176,6 @@ SYM\_CODE\_START(xen\_early\_idt\_handler\_array) SYM\_CODE\_END(xen\_early\_idt\_handler\_array) \_\_FINIT -hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 /\* \* Xen64 iret frame: \*@@ -186,17 +185,28 @@ hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 \* cs \* rip <-- standard iret frame \*- \* flags+ \* flags <-- xen\_iret must push from here on \*- \* rcx }- \* r11 }<-- pushed by hypercall page- \* rsp->rax }+ \* rcx+ \* r11+ \* rsp->rax \*/+.macro xen\_hypercall\_iret+ pushq $0 /\* Flags \*/+ push %rcx+ push %r11+ push %rax+ mov $\_\_HYPERVISOR\_iret, %eax+ syscall /\* Do the IRET. \*/+#ifdef CONFIG\_MITIGATION\_SLS+ int3+#endif+.endm+ SYM\_CODE\_START(xen\_iret) UNWIND\_HINT\_UNDEFINED ANNOTATE\_NOENDBR- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_iret)  /\*@@ -301,8 +311,7 @@ SYM\_CODE\_START(xen\_entry\_SYSENTER\_compat) ENDBR lea 16(%rsp), %rsp /\* strip %rcx, %r11 \*/ mov $-ENOSYS, %rax- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_entry\_SYSENTER\_compat) SYM\_CODE\_END(xen\_entry\_SYSCALL\_compat) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:36:17 +0000



=== Content from www.openwall.com_1c9d83e5_20250114_203736.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2024/12/22/1) [[next>]](2) [[<thread-prev]](../../../2024/12/17/2) [[thread-next>]](../../../2025/01/05/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <54c892eded2b4ebdda8ee1085c383178f44414ad.camel@infradead.org>
Date: Mon, 23 Dec 2024 14:24:10 +0000
From: David Woodhouse <dwmw2@...radead.org>
To: "Xen.org security team" <security@....org>, xen-announce@...ts.xen.org,
	xen-devel@...ts.xen.org, xen-users@...ts.xen.org,
	oss-security@...ts.openwall.com
Cc: "Xen.org security team" <security-team-members@....org>
Subject: Re: Xen Security Advisory 466 v3 (CVE-2024-53241) - Xen hypercall
 page unsafe against speculative attacks

On Tue, 2024-12-17 at 12:18 +0000, Xen.org security team wrote:
>              Xen Security Advisory CVE-2024-53241 / XSA-466
>                                 version 3
>
>          Xen hypercall page unsafe against speculative attacks
>
> UPDATES IN VERSION 3
> ====================
>
> Update of patch 5, public release.

Can't we even use the hypercall page early in boot? Surely we have to
know whether we're running on an Intel or AMD CPU before we get to the
point where we can enable any of the new control-flow integrity
support? Do we need to jump through those hoops do do that early
detection and setup?

Enabling the hypercall page is also one of the two points where Xen
will 'latch' that the guest is 64-bit, which affects the layout of the
shared_info, vcpu_info and runstate structures.

The other such latching point is when the guest sets
HVM_PARAM_CALLBACK_IRQ, and I *think* that should work in all
implementations of the Xen ABI (including QEMU/KVM and EC2). But would
want to test.

But perhaps it wouldn't hurt for maximal compatibility for Linux to set
the hypercall page *anyway*, even if Linux doesn't then use it — or
only uses it during early boot?

Download attachment "[smime.p7s](1/1)" of type "application/pkcs7-signature" (5965 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from git.kernel.org_a48524d2_20250114_203739.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-10-16 10:40:26 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:07:23 +0100 |
| commit | [c7b4cfa6213a44fa48714186dfdf125072d036e3](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3)) | |
| tree | [978a11f0f3239c10a10f46cb0ca3409a691141c3](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3) | |
| parent | [8abab99114f1713914d833344e74a0944291a5fb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8abab99114f1713914d833344e74a0944291a5fb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3&id2=8abab99114f1713914d833344e74a0944291a5fb)) | |
| download | [linux-c7b4cfa6213a44fa48714186dfdf125072d036e3.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c7b4cfa6213a44fa48714186dfdf125072d036e3.tar.gz) | |

x86/xen: don't do PV iret hypercall through hypercall pagecommit a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906 upstream.
Instead of jumping to the Xen hypercall page for doing the iret
hypercall, directly code the required sequence in xen-asm.S.
This is done in preparation of no longer using hypercall page at all,
as it has shown to cause problems with speculation mitigations.
This is part of XSA-466 / CVE-2024-53241.
Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
Signed-off-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c7b4cfa6213a44fa48714186dfdf125072d036e3)

| -rw-r--r-- | [arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/xen/xen-asm.S?id=c7b4cfa6213a44fa48714186dfdf125072d036e3) | 27 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 18 insertions, 9 deletions

| diff --git a/arch/x86/xen/xen-asm.S b/arch/x86/xen/xen-asm.Sindex 1b757a1ee1bb62..427519d78bbf9d 100644--- a/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=8abab99114f1713914d833344e74a0944291a5fb)+++ b/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=c7b4cfa6213a44fa48714186dfdf125072d036e3)@@ -170,7 +170,6 @@ SYM\_CODE\_START(xen\_early\_idt\_handler\_array) SYM\_CODE\_END(xen\_early\_idt\_handler\_array) \_\_FINIT -hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 /\* \* Xen64 iret frame: \*@@ -180,16 +179,27 @@ hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 \* cs \* rip <-- standard iret frame \*- \* flags+ \* flags <-- xen\_iret must push from here on \*- \* rcx }- \* r11 }<-- pushed by hypercall page- \* rsp->rax }+ \* rcx+ \* r11+ \* rsp->rax \*/+.macro xen\_hypercall\_iret+ pushq $0 /\* Flags \*/+ push %rcx+ push %r11+ push %rax+ mov $\_\_HYPERVISOR\_iret, %eax+ syscall /\* Do the IRET. \*/+#ifdef CONFIG\_MITIGATION\_SLS+ int3+#endif+.endm+ SYM\_CODE\_START(xen\_iret) UNWIND\_HINT\_EMPTY- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_iret)  /\*@@ -290,8 +300,7 @@ SYM\_CODE\_START(xen\_entry\_SYSENTER\_compat) UNWIND\_HINT\_ENTRY lea 16(%rsp), %rsp /\* strip %rcx, %r11 \*/ mov $-ENOSYS, %rax- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_entry\_SYSENTER\_compat) SYM\_CODE\_END(xen\_entry\_SYSCALL\_compat) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:36:16 +0000



=== Content from www.openwall.com_4c84ea82_20250114_203735.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](../../../2024/12/23/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <E1tNWXG-00E268-2p@xenbits.xenproject.org>
Date: Tue, 17 Dec 2024 12:18:46 +0000
From: Xen.org security team <security@....org>
To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,
 xen-users@...ts.xen.org, oss-security@...ts.openwall.com
CC: Xen.org security team <security-team-members@....org>
Subject: Xen Security Advisory 466 v3 (CVE-2024-53241) - Xen hypercall
 page unsafe against speculative attacks

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

             Xen Security Advisory CVE-2024-53241 / XSA-466
                                version 3

         Xen hypercall page unsafe against speculative attacks

UPDATES IN VERSION 3
====================

Update of patch 5, public release.

ISSUE DESCRIPTION
=================

Xen guests need to use different processor instructions to make explicit
calls into the Xen hypervisor depending on guest type and/or CPU
vendor. In order to hide those differences, the hypervisor can fill a
hypercall page with the needed instruction sequences, allowing the guest
operating system to call into the hypercall page instead of having to
choose the correct instructions.

The hypercall page contains whole functions, which are written by the
hypervisor and executed by the guest. With the lack of an interface
between the guest OS and the hypervisor specifying how a potential
modification of those functions should look like, the Xen hypervisor has
no knowledge how any potential mitigation should look like or which
hardening features should be put into place.

This results in potential vulnerabilities if the guest OS is using any
speculative mitigation that performs a compiler transform on "ret"
instructions in order to work (e.g. the Linux kernel rethunk or safe-ret
mitigations).

Furthermore, the hypercall page has no provision for Control-flow
Integrity schemes (e.g. kCFI/CET-IBT/FineIBT), and will simply
malfunction in such configurations.

IMPACT
======

Some mitigations for hardware vulnerabilities the guest OS is relying on to
work might not be fully functional, resulting in e.g. guest user processes
being able to read data they ought not have access to.

VULNERABLE SYSTEMS
==================

Only x86 systems are potentially vulnerable, Arm systems are not vulnerable.

All guest types (PV, PVH and HVM) are potentially vulnerable.

Linux guests are known to be vulnerable, guests using other operating
systems might be vulnerable, too.

MITIGATION
==========

Running only Linux guest kernels not relying on "ret" assembler instruction
patching (kernel config option CONFIG_MITIGATION_RETHUNK/CONFIG_RETHUNK
disabled) will avoid the vulnerability, as long as this option isn't
required to be safe on the underlying hardware.

CREDITS
=======

This issue was discovered by Andrew Cooper of XenServer.

RESOLUTION
==========

Applying the set of attached patches resolves this issue.

The patch to Xen is simply a documentation update to clarify that an OS author
might not want to use a hypercall page.

xsa466-linux-*.patch    Linux
xsa466-xen.patch        xen-unstable

$ sha256sum xsa466*
498fb2538f650d694bbd6b7d2333dcf9a12d0bdfcba65257a7d14c88f5b86801  xsa466-linux-01.patch
1e0d5f68d1cb4a0ef8914ae6bdeb4e18bae94c6d19659708ad707da784c0aa5c  xsa466-linux-02.patch
b3056b34c1565f901cb4ba11c03a51d4f045b5de7cd16c6e510e0bcee8cc6cd7  xsa466-linux-03.patch
0215e56739ab5b0d0ec0125f3d1806c3a0a0dcb3f562014f59b5145184a41467  xsa466-linux-04.patch
314e67060ab4f47883cf2b124d54ce3cd4b0363f0545ad907a7b754a4405aacd  xsa466-linux-05.patch
adbef75416379d96ebb72463872f993e9d8b7d119091480ad1e70fd448481733  xsa466-linux-06.patch
36874014cee5d5213610a6ffdd0e3e67d0258d28f2587b8470fdd0cef96e5013  xsa466-linux-07.patch
367f981ef8adc11b99cc6999b784305bcdcd55db0358fd6a2171509bf7f64345  xsa466-xen.patch
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of patches or mitigations is NOT permitted (except where
all the affected systems and VMs are administered and used only by
organisations which are members of the Xen Project Security Issues
Predisclosure List).  Specifically, deployment on public cloud systems
is NOT permitted.

This is because the mitigation or patches need to be applied to the guests.

Deployment is permitted only AFTER the embargo ends.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmdhaxAMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZUeMH/0Qkn9G8iQWJ0fHMCxvd1lcr3RNWK5GfXqlAZvuJ
YRQMDslYCzuvzrkLnoe/P/zSSs+omEYMcOVsJCBkTqePs8yIdqwBvBfZ79I1htIu
IdyJt8SE5+b70ZlumQJ8ef1Za3lp8bxvEZVa8GIokOu0Ef1iqUKNl7tQgIoQjOUH
bV/1sFN5MNFsUshOW5DnLiRrE8j0/0nfbzHPu5H9S2B4eN38oPmTabvZG/IHky8R
VFyTvqFrKZONDDhdxyFE9PBOtP6Bu3EV+Emmxb3Q84l2oEIqgab0Xxj4QGBTuLMn
PPcU5/D6Giqx3jBMdrkMAXtBuXBYO/inqsX1IJLic9W13+A=
=wlOW
-----END PGP SIGNATURE-----

Download attachment "[xsa466-linux-01.patch](2/1)" of type "application/octet-stream" (3057 bytes)

Download attachment "[xsa466-linux-02.patch](2/2)" of type "application/octet-stream" (1281 bytes)

Download attachment "[xsa466-linux-03.patch](2/3)" of type "application/octet-stream" (6151 bytes)

Download attachment "[xsa466-linux-04.patch](2/4)" of type "application/octet-stream" (2067 bytes)

Download attachment "[xsa466-linux-05.patch](2/5)" of type "application/octet-stream" (9693 bytes)

Download attachment "[xsa466-linux-06.patch](2/6)" of type "application/octet-stream" (3982 bytes)

Download attachment "[xsa466-linux-07.patch](2/7)" of type "application/octet-stream" (5646 bytes)

Download attachment "[xsa466-xen.patch](2/8)" of type "application/octet-stream" (1944 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from git.kernel.org_c0bb3f02_20250114_203740.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=fa719857f613fed94a79da055b13ca51214c694f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fa719857f613fed94a79da055b13ca51214c694f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fa719857f613fed94a79da055b13ca51214c694f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fa719857f613fed94a79da055b13ca51214c694f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-10-16 10:40:26 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-19 18:08:58 +0100 |
| commit | [fa719857f613fed94a79da055b13ca51214c694f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fa719857f613fed94a79da055b13ca51214c694f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=fa719857f613fed94a79da055b13ca51214c694f)) | |
| tree | [721c78b3d9b6c4322a543b50edb14b2bf38d9331](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=fa719857f613fed94a79da055b13ca51214c694f) | |
| parent | [f8b1f5472b19e29439d58dc52cfb67cfeac18770](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=f8b1f5472b19e29439d58dc52cfb67cfeac18770) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fa719857f613fed94a79da055b13ca51214c694f&id2=f8b1f5472b19e29439d58dc52cfb67cfeac18770)) | |
| download | [linux-fa719857f613fed94a79da055b13ca51214c694f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-fa719857f613fed94a79da055b13ca51214c694f.tar.gz) | |

x86/xen: don't do PV iret hypercall through hypercall pagecommit a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906 upstream.
Instead of jumping to the Xen hypercall page for doing the iret
hypercall, directly code the required sequence in xen-asm.S.
This is done in preparation of no longer using hypercall page at all,
as it has shown to cause problems with speculation mitigations.
This is part of XSA-466 / CVE-2024-53241.
Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
Signed-off-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>
Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=fa719857f613fed94a79da055b13ca51214c694f)

| -rw-r--r-- | [arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/xen/xen-asm.S?id=fa719857f613fed94a79da055b13ca51214c694f) | 27 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 18 insertions, 9 deletions

| diff --git a/arch/x86/xen/xen-asm.S b/arch/x86/xen/xen-asm.Sindex dec5e03e7a2cf7..fd09c7301b3f9d 100644--- a/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=f8b1f5472b19e29439d58dc52cfb67cfeac18770)+++ b/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=fa719857f613fed94a79da055b13ca51214c694f)@@ -176,7 +176,6 @@ SYM\_CODE\_START(xen\_early\_idt\_handler\_array) SYM\_CODE\_END(xen\_early\_idt\_handler\_array) \_\_FINIT -hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 /\* \* Xen64 iret frame: \*@@ -186,17 +185,28 @@ hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 \* cs \* rip <-- standard iret frame \*- \* flags+ \* flags <-- xen\_iret must push from here on \*- \* rcx }- \* r11 }<-- pushed by hypercall page- \* rsp->rax }+ \* rcx+ \* r11+ \* rsp->rax \*/+.macro xen\_hypercall\_iret+ pushq $0 /\* Flags \*/+ push %rcx+ push %r11+ push %rax+ mov $\_\_HYPERVISOR\_iret, %eax+ syscall /\* Do the IRET. \*/+#ifdef CONFIG\_MITIGATION\_SLS+ int3+#endif+.endm+ SYM\_CODE\_START(xen\_iret) UNWIND\_HINT\_EMPTY ANNOTATE\_NOENDBR- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_iret)  /\*@@ -301,8 +311,7 @@ SYM\_CODE\_START(xen\_entry\_SYSENTER\_compat) ENDBR lea 16(%rsp), %rsp /\* strip %rcx, %r11 \*/ mov $-ENOSYS, %rax- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_entry\_SYSENTER\_compat) SYM\_CODE\_END(xen\_entry\_SYSCALL\_compat) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:36:17 +0000



=== Content from git.kernel.org_0a437267_20250114_203738.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Juergen Gross <jgross@suse.com> | 2024-10-16 10:40:26 +0200 |
| --- | --- | --- |
| committer | Juergen Gross <jgross@suse.com> | 2024-12-13 09:28:43 +0100 |
| commit | [a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906)) | |
| tree | [65ea0b02325283da4035014b83c5c7ff41816c72](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906) | |
| parent | [0ef8047b737d7480a5d4c46d956e97c190f13050](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=0ef8047b737d7480a5d4c46d956e97c190f13050) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906&id2=0ef8047b737d7480a5d4c46d956e97c190f13050)) | |
| download | [linux-a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906.tar.gz) | |

x86/xen: don't do PV iret hypercall through hypercall pageInstead of jumping to the Xen hypercall page for doing the iret
hypercall, directly code the required sequence in xen-asm.S.
This is done in preparation of no longer using hypercall page at all,
as it has shown to cause problems with speculation mitigations.
This is part of XSA-466 / CVE-2024-53241.
Reported-by: Andrew Cooper <andrew.cooper3@citrix.com>
Signed-off-by: Juergen Gross <jgross@suse.com>
Reviewed-by: Jan Beulich <jbeulich@suse.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906)

| -rw-r--r-- | [arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/diff/arch/x86/xen/xen-asm.S?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906) | 27 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 18 insertions, 9 deletions

| diff --git a/arch/x86/xen/xen-asm.S b/arch/x86/xen/xen-asm.Sindex 83189cf5cdce93..ca6edfe4c14b17 100644--- a/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=0ef8047b737d7480a5d4c46d956e97c190f13050)+++ b/[arch/x86/xen/xen-asm.S](/pub/scm/linux/kernel/git/stable/linux.git/tree/arch/x86/xen/xen-asm.S?id=a2796dff62d6c6bfc5fbebdf2bee0d5ac0438906)@@ -176,7 +176,6 @@ SYM\_CODE\_START(xen\_early\_idt\_handler\_array) SYM\_CODE\_END(xen\_early\_idt\_handler\_array) \_\_FINIT -hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 /\* \* Xen64 iret frame: \*@@ -186,17 +185,28 @@ hypercall\_iret = hypercall\_page + \_\_HYPERVISOR\_iret \* 32 \* cs \* rip <-- standard iret frame \*- \* flags+ \* flags <-- xen\_iret must push from here on \*- \* rcx }- \* r11 }<-- pushed by hypercall page- \* rsp->rax }+ \* rcx+ \* r11+ \* rsp->rax \*/+.macro xen\_hypercall\_iret+ pushq $0 /\* Flags \*/+ push %rcx+ push %r11+ push %rax+ mov $\_\_HYPERVISOR\_iret, %eax+ syscall /\* Do the IRET. \*/+#ifdef CONFIG\_MITIGATION\_SLS+ int3+#endif+.endm+ SYM\_CODE\_START(xen\_iret) UNWIND\_HINT\_UNDEFINED ANNOTATE\_NOENDBR- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_iret)  /\*@@ -301,8 +311,7 @@ SYM\_CODE\_START(xen\_entry\_SYSENTER\_compat) ENDBR lea 16(%rsp), %rsp /\* strip %rcx, %r11 \*/ mov $-ENOSYS, %rax- pushq $0- jmp hypercall\_iret+ xen\_hypercall\_iret SYM\_CODE\_END(xen\_entry\_SYSENTER\_compat) SYM\_CODE\_END(xen\_entry\_SYSCALL\_compat) |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:36:16 +0000


