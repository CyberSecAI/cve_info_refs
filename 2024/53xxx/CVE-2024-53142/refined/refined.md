### Root cause of vulnerability:
The vulnerability is caused by a missing null-termination check when extracting filenames from a cpio archive within the initramfs. The `do_name()` path handler in the kernel assumes a zero-terminated path at `@collected`. If a specially crafted cpio entry has a non-null-terminated filename, followed by uninitialized memory, the file may be created with trailing characters that are part of the uninitialized memory.

### Weaknesses/vulnerabilities present:
- **Missing Null-termination Check:** The kernel's `do_name()` handler does not verify that the filename in the cpio archive is null-terminated.
- **Buffer Overrun (potential):** Although the vulnerability isn't considered a security risk, since the attacker already has full control by the time the initramfs is used, a crafted cpio entry without a null terminator in the filename can lead to reading past the intended filename buffer, potentially incorporating uninitialized memory in file creation.

### Impact of exploitation:
- **File Creation with Unintended Names:** An attacker can create files with names that include uninitialized memory, which could lead to unexpected behavior or directory structures.

### Attack vectors:
- **Crafted CPIO Archive:** The attack vector involves creating a malicious cpio archive with a non-null-terminated filename. This archive would then be added to the initramfs.
- **Gzip Overflow:** The provided reproducer script uses gzip to overflow the heap allocated `@out_buf` in `__gunzip()`, rather than the `initrd_start+initrd_size` block, to observe the non-zero uninitialized memory more easily.

### Required attacker capabilities/position:
- To exploit this, the attacker needs to be able to modify or create the initramfs image, which typically requires root or administrative privileges on the system before it boots. The vulnerability can only be exploited during the early boot process when the initramfs is being parsed.

### Additional notes:
- The provided patches fix the vulnerability by adding an explicit null-termination check before passing the path to `filp_open()`, `init_mkdir()`, or `init_mknod()`. This check verifies if a cpio entry carries a zero-terminator at the expected (name\_len - 1) offset, and will cause the initramfs FSM to abort if the check fails. This prevents creation of files with unexpected names.
- The vulnerability is not considered a security issue because the attacker needs to control the initramfs, which means that the system is already fully compromised.