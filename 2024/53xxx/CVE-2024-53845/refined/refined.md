```
{
  "CVE-2024-53845": {
    "Description": "The ESPTouchV2 protocol, while allowing a custom AES key, lacks an option to set the Initialization Vector (IV). The IV is set to zero and remains constant, making the encrypted output deterministic in AES/CBC mode, leading to potential data leakage. This vulnerability affects multiple versions of ESP-IDF framework (v5.3.1, v5.2.3, v5.1.5, v5.0.7).",
    "Root cause": "The root cause is the use of a constant IV (set to zero) in the AES/CBC encryption of the ESPTouch v2 protocol. This was due to a missing option for IV configuration in the protocol implementation.",
    "Weaknesses": [
      "CWE-1204: Improper Initialization for Cryptographic Algorithm"
    ],
    "Impact": "The impact is potential data leakage due to the deterministic nature of the encryption. Since the IV is fixed, identical plaintexts will produce the same ciphertext, allowing an attacker to potentially identify patterns and deduce the data being transmitted. The risk applies to credentials for WiFi network and any custom data transmitted during the provisioning process.",
    "Attack vectors": "The attack vector involves intercepting and analyzing the wireless communication during the ESPTouch v2 provisioning process. An attacker within the range of the Wi-Fi communication can capture encrypted provisioning data and potentially decrypt it due to the weakness of the fixed IV in the AES encryption.",
      "Required attacker capabilities/position": "The attacker needs to be within the Wi-Fi communication range of the device undergoing provisioning. They need to be able to capture the wireless communication packets being transmitted using ESPTouch v2. No other special capabilities are required besides the ability to capture wireless packets."
  }
}
```