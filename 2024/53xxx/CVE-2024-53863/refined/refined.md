```
{
  "Root cause of vulnerability": "The Synapse server, in versions prior to 1.120.1, could be forced to generate thumbnails for a wide variety of file formats, including those that are uncommon or potentially untrustworthy. This was triggered by enabling the `dynamic_thumbnails` option or by processing a specially crafted request.",
  "Weaknesses/vulnerabilities present": "The primary vulnerability is the unrestricted processing of various image formats which can trigger external, potentially vulnerable tools like Ghostscript. This expands the attack surface and creates a risk due to the diverse range of supported formats handled by the Pillow library.",
  "Impact of exploitation": "Exploitation can lead to the server invoking potentially vulnerable external image processing tools. This could lead to a range of impacts, from denial-of-service (DoS) to more serious consequences depending on the vulnerabilities present in the invoked external tools.",
  "Attack vectors": "The attack vector involves either enabling the `dynamic_thumbnails` option or sending a specially crafted request to the Synapse server that would trigger thumbnail generation for uncommon file formats.",
  "Required attacker capabilities/position": "An attacker needs to be able to either enable the `dynamic_thumbnails` option or be able to send a crafted request to the Synapse server. Access to the Synapse server to make these requests is required."
}
```