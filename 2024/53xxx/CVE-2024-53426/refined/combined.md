=== Content from github.com_2d2db946_20250115_081732.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fissues%2F8793)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fissues%2F8793)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=ntop%2Fntopng)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ntop](/ntop)
/
**[ntopng](/ntop/ntopng)**
Public

* [Notifications](/login?return_to=%2Fntop%2Fntopng) You must be signed in to change notification settings
* [Fork
  659](/login?return_to=%2Fntop%2Fntopng)
* [Star
   6.4k](/login?return_to=%2Fntop%2Fntopng)

* [Code](/ntop/ntopng)
* [Issues
  213](/ntop/ntopng/issues)
* [Pull requests
  0](/ntop/ntopng/pulls)
* [Actions](/ntop/ntopng/actions)
* [Projects
  0](/ntop/ntopng/projects)
* [Wiki](/ntop/ntopng/wiki)
* [Security](/ntop/ntopng/security)
* [Insights](/ntop/ntopng/pulse)

Additional navigation options

* [Code](/ntop/ntopng)
* [Issues](/ntop/ntopng/issues)
* [Pull requests](/ntop/ntopng/pulls)
* [Actions](/ntop/ntopng/actions)
* [Projects](/ntop/ntopng/projects)
* [Wiki](/ntop/ntopng/wiki)
* [Security](/ntop/ntopng/security)
* [Insights](/ntop/ntopng/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fntop%2Fntopng%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fntop%2Fntopng%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Heap-buffer-overflow in `Flow::dissectMDNS` leading to crash in ntopng 6.2 #8793

Open

[cla7aye15I4nd](/cla7aye15I4nd) opened this issue
Nov 3, 2024
· 4 comments

Open

# [Heap-buffer-overflow in `Flow::dissectMDNS` leading to crash in ntopng 6.2](#top) #8793

[cla7aye15I4nd](/cla7aye15I4nd) opened this issue
Nov 3, 2024
· 4 comments

Labels
[To Be Confirmed](/ntop/ntopng/labels/To%20Be%20Confirmed)

## Comments

[![@cla7aye15I4nd](https://avatars.githubusercontent.com/u/17133261?s=80&v=4)](/cla7aye15I4nd)

Copy link

### **[cla7aye15I4nd](/cla7aye15I4nd)** commented [Nov 3, 2024](#issue-2630973082)

| **Description**:  A heap-buffer-overflow vulnerability has been identified in ntopng version 6.2, specifically in the `Flow::dissectMDNS` function located in `Flow.cpp` at line 6516. This issue can cause the application to crash, leading to a potential denial-of-service condition.  **Affected Version**:   * ntopng 6.2   **Steps to Reproduce**:   1. Build ntopng using the OSS-Fuzz configuration. 2. Run the `fuzz_dissect_packet` binary with a crafted input that triggers the vulnerability.    [poc-ntopng](https://private-user-images.githubusercontent.com/17133261/382548727-a03e8dd5-27f1-4092-a7ad-1f0baf9776ad.jpg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY5MjkzNTEsIm5iZiI6MTczNjkyOTA1MSwicGF0aCI6Ii8xNzEzMzI2MS8zODI1NDg3MjctYTAzZThkZDUtMjdmMS00MDkyLWE3YWQtMWYwYmFmOTc3NmFkLmpwZz9YLUFtei1BbGdvcml0aG09QVdTNC1ITUFDLVNIQTI1NiZYLUFtei1DcmVkZW50aWFsPUFLSUFWQ09EWUxTQTUzUFFLNFpBJTJGMjAyNTAxMTUlMkZ1cy1lYXN0LTElMkZzMyUyRmF3czRfcmVxdWVzdCZYLUFtei1EYXRlPTIwMjUwMTE1VDA4MTczMVomWC1BbXotRXhwaXJlcz0zMDAmWC1BbXotU2lnbmF0dXJlPWUzN2Y3MTE5OTFjMzNkZjZjMzRmNjdiYWNhZmJiYzQ0ZmViZWMzNzY2NTRiNGQxZWVjZDk3NWZjZGFjMzEwOTYmWC1BbXotU2lnbmVkSGVhZGVycz1ob3N0In0.B1TivDCPNCWzK-lM67oyj6bNcziCRIGilr6eXL1J_PQ) 3. Observe the heap-buffer-overflow error reported by AddressSanitizer.   **Crash Output**:  ``` ==24560==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x5160000005a0 at pc 0x5612f311f101 bp 0x7fff6a23d850 sp 0x7fff6a23d008 READ of size 42 at 0x5160000005a0 thread T0     #0 0x5612f311f100 in strncpy /src/llvm-project/compiler-rt/lib/asan/asan_interceptors.cpp:604:5     #1 0x5612f344bbba in Flow::dissectMDNS(unsigned char*, unsigned short) /src/ntopng/src/Flow.cpp:6516:8     #2 0x5612f334dcf0 in NetworkInterface::processPacket(int, unsigned int, int, bool*, timeval const*, unsigned long, ndpi_ethhdr*, unsigned short, ndpi_iphdr*, ndpi_ipv6hdr*, unsigned short, unsigned short, unsigned int, pcap_pkthdr const*, unsigned char const*, unsigned short*, Host**, Host**, Flow**) /src/ntopng/src/NetworkInterface.cpp:2294:13     #3 0x5612f335583e in NetworkInterface::dissectPacket(int, unsigned int, int, bool, unsigned char*, pcap_pkthdr const*, unsigned char const*, unsigned short*, Host**, Host**, Flow**) /src/ntopng/src/NetworkInterface.cpp:3004:17     #4 0x5612f3176a61 in LLVMFuzzerTestOneInput /src/ntopng/fuzz/fuzz_dissect_packet.cpp:200:12     #5 0x5612f302aa60 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerLoop.cpp:614:13     #6 0x5612f3015cd5 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:327:6     #7 0x5612f301b76f in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerDriver.cpp:862:9     #8 0x5612f3046a12 in main /src/llvm-project/compiler-rt/lib/fuzzer/FuzzerMain.cpp:20:10     #9 0x7efc6dd01082 in __libc_start_main (/lib/x86_64-linux-gnu/libc.so.6+0x24082) (BuildId: 0702430aef5fa3dda43986563e9ffcc47efbd75e)     #10 0x5612f300debd in _start (/out/fuzz_dissect_packet+0x309ebd)  0x5160000005a0 is located 0 bytes after 544-byte region [0x516000000380,0x5160000005a0) allocated by thread T0 here:     #0 0x5612f313682f in malloc /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3     #1 0x5612f35aca3c in pcap_check_header /src/libpcap-1.9.1/./sf-pcap.c:405:14  SUMMARY: AddressSanitizer: heap-buffer-overflow /src/ntopng/src/Flow.cpp:6516:8 in Flow::dissectMDNS(unsigned char*, unsigned short)  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@lucaderi](https://avatars.githubusercontent.com/u/4493366?s=80&u=16c6b281037608a7e846d99afb8b11eb6a5ca7a9&v=4)](/lucaderi)

Copy link

Member

### **[lucaderi](/lucaderi)** commented [Nov 4, 2024](#issuecomment-2453968010)

| Hi thanks for reporting the issue. I think you are using a different source code version as <https://github.com/ntop/ntopng/blob/6.2-stable/src/Flow.cpp#L6516> it is unlikely to have the issue you reported.  Can you please attach to this ticket the artefact that has been used to cause the crash ? |
| --- |

All reactions

Sorry, something went wrong.

[![@lucaderi](https://avatars.githubusercontent.com/u/4493366?s=40&u=16c6b281037608a7e846d99afb8b11eb6a5ca7a9&v=4)](/lucaderi)
[lucaderi](/lucaderi)
added
the
[To Be Confirmed](/ntop/ntopng/labels/To%20Be%20Confirmed)
label
[Nov 4, 2024](#event-15099061877)

[![@cla7aye15I4nd](https://avatars.githubusercontent.com/u/17133261?s=80&v=4)](/cla7aye15I4nd)

Copy link

Author

### **[cla7aye15I4nd](/cla7aye15I4nd)** commented [Nov 4, 2024](#issuecomment-2453991552)

| I've attached the PoC in the "Steps to Reproduce" section (item 2), which is a .jpg file (for bypassing the file type limitation of github). I'm currently using the dev branch, and the relevant commit is [3da6cfc](https://github.com/ntop/ntopng/commit/3da6cfca6a60733baacf392acf4cd4a6eda83e23). I suspect the version issue you're referring to may stem from an error in the asan symbolizer. |
| --- |

All reactions

Sorry, something went wrong.

[![@MatteoBiscosi](https://avatars.githubusercontent.com/u/49585191?s=80&v=4)](/MatteoBiscosi)

Copy link

Member

### **[MatteoBiscosi](/MatteoBiscosi)** commented [Nov 4, 2024](#issuecomment-2454924365)

| Hi [@cla7aye15I4nd](https://github.com/cla7aye15I4nd) could you please share how you started ntopng? (the exact command line) |
| --- |

All reactions

Sorry, something went wrong.

[![@cla7aye15I4nd](https://avatars.githubusercontent.com/u/17133261?s=80&v=4)](/cla7aye15I4nd)

Copy link

Author

### **[cla7aye15I4nd](/cla7aye15I4nd)** commented [Nov 4, 2024](#issuecomment-2455146254)

| Build the OSS docker and enter  ``` python3 oss-fuzz/infra/helper.py build_image --architecture x86_64 ntopng docker run --rm -it gcr.io/oss-fuzz/ntopng /bin/bash ```  Compile and reproduce in the container  ``` root@25a6e5d1095d:/src/ntopng# FUZZING_LANGUAGE=c compile root@25a6e5d1095d:/out# ./fuzz_dissect_packet <your poc path> ``` |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fntop%2Fntopng%2Fissues%2F8793)

Assignees

No one assigned

Labels

[To Be Confirmed](/ntop/ntopng/labels/To%20Be%20Confirmed)

Projects

None yet

Milestone

No milestone

Development

No branches or pull requests

3 participants

[![@lucaderi](https://avatars.githubusercontent.com/u/4493366?s=52&v=4)](/lucaderi) [![@cla7aye15I4nd](https://avatars.githubusercontent.com/u/17133261?s=52&v=4)](/cla7aye15I4nd) [![@MatteoBiscosi](https://avatars.githubusercontent.com/u/49585191?s=52&v=4)](/MatteoBiscosi)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


