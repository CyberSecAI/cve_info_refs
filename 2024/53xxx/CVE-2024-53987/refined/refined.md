Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from a namespace confusion issue within the `rails-html-sanitizer` library when using HTML5 sanitization. Specifically, if the `style` tag is explicitly allowed while `svg` or `math` tags are not, it creates a scenario where malicious content within a `<style>` tag nested inside a disallowed `svg` or `math` element is not properly sanitized. This allows the injection of arbitrary HTML and JavaScript, leading to XSS.

**Weaknesses/Vulnerabilities:**

*   **Improper Input Sanitization:** The sanitizer fails to correctly handle nested tags, particularly when a `style` tag is within a disallowed namespace (`svg` or `math`).
*   **Namespace Confusion:**  The sanitizer logic does not properly consider namespaces when pruning or sanitizing elements, which leads to unexpected behavior and the possibility of bypassing security measures.

**Impact of Exploitation:**

*   **Cross-Site Scripting (XSS):**  An attacker can inject malicious JavaScript code through the `style` tag. This could lead to:
    *   Session hijacking
    *   Data theft
    *   Redirecting users to malicious sites
    *   Other client-side attacks
*   **DOM Mutation:** The vulnerability also leads to DOM mutation issues, where unexpected changes occur in the Document Object Model of the page.

**Attack Vectors:**

*   **Malicious HTML Input:** An attacker provides specially crafted HTML content that includes a `<style>` tag within a disallowed `<svg>` or `<math>` element. The vulnerable code is when `style` tag is added to allowed tags, but `svg` and `math` tags are not allowed.
*   **Configuration Dependent:** The exploit is possible only when the application is configured to use HTML5 sanitization and has explicitly added `style` to the allowed tags, and omitted `svg` or `math`.

**Required Attacker Capabilities/Position:**

*   The attacker needs the ability to submit or inject HTML content that is processed by the vulnerable sanitization logic in Rails.
*   The application must be configured to use HTML5 sanitization and have explicitly allowed `style` tags while disallowing `svg` or `math` tags.

**Additional Notes**

*   The provided content references HackerOne reports ([https://hackerone.com/reports/2519936](https://hackerone.com/reports/2519936) and [https://hackerone.com/reports/2519941](https://hackerone.com/reports/2519941)) as the original source of the vulnerability.
*   The fix implemented in the commit `f02ffbb` addresses the namespace confusion by always pruning nodes within the `math` or `svg` namespace.
*   The provided content includes examples of vulnerable code configurations, and workarounds, which are very helpful in understanding the vulnerability.

The provided content gives more details about the vulnerability than the basic CVE description placeholder.