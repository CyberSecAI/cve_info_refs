=== Content from github.com_5474a382_20250115_100604.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabsai%2FEDDI%2Fsecurity%2Fadvisories%2FGHSA-49qh-39wc-4p8j)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabsai%2FEDDI%2Fsecurity%2Fadvisories%2FGHSA-49qh-39wc-4p8j)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=labsai%2FEDDI)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[labsai](/labsai)
/
**[EDDI](/labsai/EDDI)**
Public

* [Notifications](/login?return_to=%2Flabsai%2FEDDI) You must be signed in to change notification settings
* [Fork
  92](/login?return_to=%2Flabsai%2FEDDI)
* [Star
   260](/login?return_to=%2Flabsai%2FEDDI)

* [Code](/labsai/EDDI)
* [Issues
  1](/labsai/EDDI/issues)
* [Pull requests
  2](/labsai/EDDI/pulls)
* [Discussions](/labsai/EDDI/discussions)
* [Actions](/labsai/EDDI/actions)
* [Projects
  0](/labsai/EDDI/projects)
* [Security](/labsai/EDDI/security)
* [Insights](/labsai/EDDI/pulse)

Additional navigation options

* [Code](/labsai/EDDI)
* [Issues](/labsai/EDDI/issues)
* [Pull requests](/labsai/EDDI/pulls)
* [Discussions](/labsai/EDDI/discussions)
* [Actions](/labsai/EDDI/actions)
* [Projects](/labsai/EDDI/projects)
* [Security](/labsai/EDDI/security)
* [Insights](/labsai/EDDI/pulse)

# Improper Limitation of a Pathname to a Restricted Directory ('Path Traversal') in labsai/eddi

Moderate

[ginccc](/ginccc)
published
GHSA-49qh-39wc-4p8j
Nov 26, 2024

## Package

labsai/eddi
(Docker Container)

## Affected versions

4.3-5.3

## Patched versions

5.4

## Description

## Impact

A path traversal vulnerability exists in the backup export functionality of EDDI, as implemented in `RestExportService.java`. This vulnerability allows an attacker to access sensitive files on the server by manipulating the `botFilename` parameter in requests. The application fails to sanitize user input, enabling malicious inputs such as `..%2f..%2fetc%2fpasswd` to access arbitrary files.

However, the **severity of this vulnerability is significantly limited** because EDDI typically runs within a **Docker container**, which provides additional layers of isolation and restricted permissions.

Specifically:

* The application runs as a non-root user (`USER 185`), reducing the attacker's ability to access critical system files within the container
* The containerized environment isolates the application from the host system, preventing access to host-level files unless explicitly mounted as a volume
* The attacker can only access files that exist within the container and are readable by the application's user (`USER 185`)

As a result, while this vulnerability exposes files within the container, it does not inherently threaten the underlying host system or other containers.

This vulnerability can potentially lead to:

* Unauthorized access to sensitive files within the container (e.g., application configuration files, logs, or credentials stored in the container)
* Exposure of application secrets such as API keys, credentials, or encryption keys stored in the container
* Reconnaissance of the container’s structure, potentially aiding in further attacks on the application or its services
* Limited denial of service (DoS) if critical container files are tampered with or deleted

## Patches

A patch is required to sanitize and validate the botFilename input parameter. Users should ensure they are using the patched version once available. For temporary mitigation, access to the vulnerable endpoint should be restricted through firewall rules or authentication mechanisms.

## Workarounds

As a temporary workaround:

* Restrict access to the /backup/export endpoint using network or application-level firewalls.
* Use input validation middleware to reject malicious input patterns that include ../ or URL-encoded traversal sequences (..%2f).

## References

* Vulnerable Code: [RestExportService.java#L95](https://github.com/labsai/EDDI/blob/release/5.3.3/src/main/java/ai/labs/eddi/backup/impl/RestExportService.java#L95)
* Example Exploit: curl '[http://localhost:7070/backup/export/..%2f..%2f..%2fetc%2fpasswd](http://localhost:7070/backup/export/../../../etc/passwd)'
* Dockerfile: Demonstrates server configuration and default setup ([see here](https://github.com/labsai/EDDI/blob/release/5.3.3/src/main/docker/Dockerfile.jvm)).

### Severity

Moderate

6.3

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
Low

Integrity
Low

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L

### CVE ID

CVE-2024-53844

### Weaknesses

[CWE-22](/advisories?query=cwe%3A22)

### Credits

* [![@xbow-security](https://avatars.githubusercontent.com/u/189618963?s=40&v=4)](/xbow-security)
  [xbow-security](/xbow-security)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_ba7e4427_20250115_100602.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabsai%2FEDDI%2Fblob%2Frelease%2F5.3.3%2Fsrc%2Fmain%2Fjava%2Fai%2Flabs%2Feddi%2Fbackup%2Fimpl%2FRestExportService.java)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flabsai%2FEDDI%2Fblob%2Frelease%2F5.3.3%2Fsrc%2Fmain%2Fjava%2Fai%2Flabs%2Feddi%2Fbackup%2Fimpl%2FRestExportService.java)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=labsai%2FEDDI)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[labsai](/labsai)
/
**[EDDI](/labsai/EDDI)**
Public

* [Notifications](/login?return_to=%2Flabsai%2FEDDI) You must be signed in to change notification settings
* [Fork
  92](/login?return_to=%2Flabsai%2FEDDI)
* [Star
   260](/login?return_to=%2Flabsai%2FEDDI)

* [Code](/labsai/EDDI/tree/release/5.3.3)
* [Issues
  1](/labsai/EDDI/issues)
* [Pull requests
  2](/labsai/EDDI/pulls)
* [Discussions](/labsai/EDDI/discussions)
* [Actions](/labsai/EDDI/actions)
* [Projects
  0](/labsai/EDDI/projects)
* [Security](/labsai/EDDI/security)
* [Insights](/labsai/EDDI/pulse)

Additional navigation options

* [Code](/labsai/EDDI/tree/release/5.3.3)
* [Issues](/labsai/EDDI/issues)
* [Pull requests](/labsai/EDDI/pulls)
* [Discussions](/labsai/EDDI/discussions)
* [Actions](/labsai/EDDI/actions)
* [Projects](/labsai/EDDI/projects)
* [Security](/labsai/EDDI/security)
* [Insights](/labsai/EDDI/pulse)

## Files

 release/5.3.3
## Breadcrumbs

1. [EDDI](/labsai/EDDI/tree/release/5.3.3)
2. /[src](/labsai/EDDI/tree/release/5.3.3/src)
3. /[main](/labsai/EDDI/tree/release/5.3.3/src/main)
4. /[java](/labsai/EDDI/tree/release/5.3.3/src/main/java)
5. /[ai](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai)
6. /[labs](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs)
7. /[eddi](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs/eddi)
8. /[backup](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs/eddi/backup)
9. /[impl](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs/eddi/backup/impl)
/
# RestExportService.java

Copy path Blame  Blame
## Latest commit

## History

[History](/labsai/EDDI/commits/release/5.3.3/src/main/java/ai/labs/eddi/backup/impl/RestExportService.java)308 lines (268 loc) · 15.2 KB release/5.3.3
## Breadcrumbs

1. [EDDI](/labsai/EDDI/tree/release/5.3.3)
2. /[src](/labsai/EDDI/tree/release/5.3.3/src)
3. /[main](/labsai/EDDI/tree/release/5.3.3/src/main)
4. /[java](/labsai/EDDI/tree/release/5.3.3/src/main/java)
5. /[ai](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai)
6. /[labs](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs)
7. /[eddi](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs/eddi)
8. /[backup](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs/eddi/backup)
9. /[impl](/labsai/EDDI/tree/release/5.3.3/src/main/java/ai/labs/eddi/backup/impl)
/
# RestExportService.java

Top
## File metadata and controls

* Code
* Blame

308 lines (268 loc) · 15.2 KB[Raw](https://github.com/labsai/EDDI/raw/refs/heads/release/5.3.3/src/main/java/ai/labs/eddi/backup/impl/RestExportService.java)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308package ai.labs.eddi.backup.impl;
import ai.labs.eddi.backup.IRestExportService;import ai.labs.eddi.backup.IZipArchive;import ai.labs.eddi.configs.behavior.IBehaviorStore;import ai.labs.eddi.configs.bots.IBotStore;import ai.labs.eddi.configs.bots.model.BotConfiguration;import ai.labs.eddi.configs.documentdescriptor.IDocumentDescriptorStore;import ai.labs.eddi.configs.git.IGitCallsStore;import ai.labs.eddi.configs.http.IHttpCallsStore;import ai.labs.eddi.configs.langchain.ILangChainStore;import ai.labs.eddi.configs.output.IOutputStore;import ai.labs.eddi.configs.packages.IPackageStore;import ai.labs.eddi.configs.packages.model.PackageConfiguration;import ai.labs.eddi.configs.propertysetter.IPropertySetterStore;import ai.labs.eddi.configs.regulardictionary.IRegularDictionaryStore;import ai.labs.eddi.datastore.IResourceStore;import ai.labs.eddi.datastore.IResourceStore.IResourceId;import ai.labs.eddi.datastore.serialization.IJsonSerialization;import ai.labs.eddi.configs.documentdescriptor.model.DocumentDescriptor;import ai.labs.eddi.utils.FileUtilities;import ai.labs.eddi.utils.RestUtilities;import jakarta.ws.rs.NotFoundException;import org.jboss.logging.Logger;
import jakarta.enterprise.context.ApplicationScoped;import jakarta.inject.Inject;import jakarta.ws.rs.InternalServerErrorException;import jakarta.ws.rs.core.Response;import java.io.\*;import java.net.URI;import java.net.URLEncoder;import java.nio.charset.StandardCharsets;import java.nio.file.Files;import java.nio.file.Path;import java.nio.file.Paths;import java.text.MessageFormat;import java.util.LinkedHashMap;import java.util.List;import java.util.Map;import java.util.stream.Collectors;
import static ai.labs.eddi.utils.RuntimeUtilities.isNullOrEmpty;
/\*\* \* @author ginccc \*/
@ApplicationScopedpublic class RestExportService extends AbstractBackupService implements IRestExportService { private final IDocumentDescriptorStore documentDescriptorStore; private final IBotStore botStore; private final IPackageStore packageStore; private final IRegularDictionaryStore regularDictionaryStore; private final IBehaviorStore behaviorStore; private final IHttpCallsStore httpCallsStore; private final ILangChainStore langChainStore; private final IPropertySetterStore propertySetterStore; private final IOutputStore outputStore; private final IJsonSerialization jsonSerialization; private final IZipArchive zipArchive; private final IGitCallsStore gitCallsStore; private final Path tmpPath = Paths.get(FileUtilities.buildPath(System.getProperty("user.dir"), "tmp"));
 private static final Logger log = Logger.getLogger(RestExportService.class);
 @Inject public RestExportService(IDocumentDescriptorStore documentDescriptorStore, IBotStore botStore, IPackageStore packageStore, IRegularDictionaryStore regularDictionaryStore, IBehaviorStore behaviorStore, IHttpCallsStore httpCallsStore, ILangChainStore langChainStore, IPropertySetterStore propertySetterStore, IOutputStore outputStore, IJsonSerialization jsonSerialization, IZipArchive zipArchive, IGitCallsStore gitCallsStore) { this.documentDescriptorStore = documentDescriptorStore; this.botStore = botStore; this.packageStore = packageStore; this.regularDictionaryStore = regularDictionaryStore; this.behaviorStore = behaviorStore; this.httpCallsStore = httpCallsStore; this.langChainStore = langChainStore; this.propertySetterStore = propertySetterStore; this.outputStore = outputStore; this.jsonSerialization = jsonSerialization; this.zipArchive = zipArchive; this.gitCallsStore = gitCallsStore; }
 @Override public Response getBotZipArchive(String botFilename) { try { String zipFilePath = FileUtilities.buildPath(tmpPath.toString(), botFilename); return Response.ok(new BufferedInputStream(new FileInputStream(zipFilePath))).build(); } catch (FileNotFoundException e) { throw new NotFoundException(); } }
 @Override public Response exportBot(String botId, Integer botVersion) { try { BotConfiguration botConfiguration = botStore.read(botId, botVersion); Path botPath = writeDirAndDocument(botId, botVersion, jsonSerialization.serialize(botConfiguration), tmpPath, BOT\_EXT); Map<IResourceId, PackageConfiguration> packageConfigurations = readConfigs(packageStore, botConfiguration.getPackages());
 DocumentDescriptor botDocumentDescriptor = writeDocumentDescriptor(botPath, botId, botVersion);
 for (IResourceId resourceId : packageConfigurations.keySet()) { PackageConfiguration packageConfiguration = packageConfigurations.get(resourceId); String packageConfigurationString = jsonSerialization.serialize(packageConfiguration); Path packagePath = writeDirAndDocument(resourceId.getId(), resourceId.getVersion(), packageConfigurationString, botPath, PACKAGE\_EXT); writeDocumentDescriptor(packagePath, resourceId.getId(), resourceId.getVersion());
 writeConfigs(packagePath, convertConfigsToString(readConfigs(regularDictionaryStore, extractResourcesUris(packageConfigurationString, DICTIONARY\_URI\_PATTERN))), DICTIONARY\_EXT);
 writeConfigs(packagePath, convertConfigsToString(readConfigs(behaviorStore, extractResourcesUris(packageConfigurationString, BEHAVIOR\_URI\_PATTERN))), BEHAVIOR\_EXT);
 writeConfigs(packagePath, convertConfigsToString(readConfigs(httpCallsStore, extractResourcesUris(packageConfigurationString, HTTPCALLS\_URI\_PATTERN))), HTTPCALLS\_EXT);
 writeConfigs(packagePath, convertConfigsToString(readConfigs(langChainStore, extractResourcesUris(packageConfigurationString, LANGCHAIN\_URI\_PATTERN))), LANGCHAIN\_EXT);
 writeConfigs(packagePath, convertConfigsToString(readConfigs(propertySetterStore, extractResourcesUris(packageConfigurationString, PROPERTY\_URI\_PATTERN))), PROPERTY\_EXT);
 writeConfigs(packagePath, convertConfigsToString(readConfigs(outputStore, extractResourcesUris(packageConfigurationString, OUTPUT\_URI\_PATTERN))), OUTPUT\_EXT);
 writeConfigs(packagePath, convertConfigsToString(readConfigs(gitCallsStore, extractResourcesUris(packageConfigurationString, GITCALLS\_URI\_PATTERN))), GITCALLS\_EXT);
 Path unusedPath = Files.createDirectories(Paths.get(tmpPath.toString(), botId, "unused"));
 writeAllVersionsOfUris(unusedPath, regularDictionaryStore, extractResourcesUris(packageConfigurationString, DICTIONARY\_URI\_PATTERN), DICTIONARY\_EXT); writeAllVersionsOfUris(unusedPath, behaviorStore, extractResourcesUris(packageConfigurationString, BEHAVIOR\_URI\_PATTERN), BEHAVIOR\_EXT); writeAllVersionsOfUris(unusedPath, httpCallsStore, extractResourcesUris(packageConfigurationString, HTTPCALLS\_URI\_PATTERN), HTTPCALLS\_EXT); writeAllVersionsOfUris(unusedPath, langChainStore, extractResourcesUris(packageConfigurationString, LANGCHAIN\_URI\_PATTERN), LANGCHAIN\_EXT); writeAllVersionsOfUris(unusedPath, propertySetterStore, extractResourcesUris(packageConfigurationString, PROPERTY\_URI\_PATTERN), PROPERTY\_EXT); writeAllVersionsOfUris(unusedPath, outputStore, extractResourcesUris(packageConfigurationString, OUTPUT\_URI\_PATTERN), OUTPUT\_EXT); writeAllVersionsOfUris(unusedPath, gitCallsStore, extractResourcesUris(packageConfigurationString, GITCALLS\_URI\_PATTERN), GITCALLS\_EXT);
 }
 String zipFilename = prepareZipFilename(botDocumentDescriptor, botId, botVersion); String targetZipPath = FileUtilities.buildPath(tmpPath.toString(), zipFilename); this.zipArchive.createZip(botPath.toString(), targetZipPath); return Response.ok().location(URI.create("/backup/export/" + zipFilename)).build(); } catch (IResourceStore.ResourceNotFoundException e) { throw new NotFoundException(); } catch (IResourceStore.ResourceStoreException | IOException | CallbackMatcher.CallbackMatcherException e) { log.error(e.getLocalizedMessage(), e); throw new InternalServerErrorException(); } }
 private <T> void writeAllVersionsOfUris(Path unusedPath, IResourceStore<T> store, List<URI> dictionaryUris, String ext) { for (URI dictionaryUri : dictionaryUris) { Integer versionToExport = 1; IResourceId resourceIdUnused = RestUtilities.extractResourceId(dictionaryUri); final String strResId = resourceIdUnused.getId(); Map<IResourceId, T> toStore = new LinkedHashMap<>(); T config = null; try { config = store.readIncludingDeleted(resourceIdUnused.getId(), versionToExport); } catch (IResourceStore.ResourceNotFoundException | IResourceStore.ResourceStoreException e) { log.error(e.getLocalizedMessage(), e); } while (versionToExport < 10000) { try { toStore.put(resourceIdUnused, config); final Integer currentVersion = versionToExport; resourceIdUnused = new IResourceId() {
 @Override public String getId() { return strResId; }
 @Override public Integer getVersion() { return currentVersion; } }; config = store.readIncludingDeleted(resourceIdUnused.getId(), versionToExport); } catch (IResourceStore.ResourceNotFoundException | IBehaviorStore.ResourceStoreException ex) { break; } versionToExport++; } writeUnusedConfigs(unusedPath, convertConfigsToString(toStore), ext); }
 }
 private String prepareZipFilename(DocumentDescriptor botDocumentDescriptor, String botId, Integer botVersion) throws UnsupportedEncodingException { String zipFilename = ""; if (!isNullOrEmpty(botDocumentDescriptor.getName())) { zipFilename = URLEncoder.encode(botDocumentDescriptor.getName() + "-", StandardCharsets.UTF\_8); } zipFilename += botId + "-" + botVersion + ".zip"; return zipFilename; }
 private Map<IResourceId, String> convertConfigsToString(Map<IResourceId, ?> configurationMap) { return configurationMap.entrySet().stream().collect(Collectors.toMap( Map.Entry::getKey, e -> { try { return jsonSerialization.serialize(e.getValue()); } catch (IOException ex) { log.error(ex.getLocalizedMessage(), ex); return ""; } } )); }
 private void writeConfigs(Path path, Map<IResourceId, String> configs, String fileExtension) { configs.forEach((resourceId, value) -> { String filename = MessageFormat.format("{0}.{1}.json", resourceId.getId(), fileExtension); Path filePath = Paths.get(path.toString(), filename); try { deleteFileIfExists(filePath); try (BufferedWriter writer = Files.newBufferedWriter(filePath)) { writer.write(value); writeDocumentDescriptor(path, resourceId.getId(), resourceId.getVersion()); } } catch (IOException | IResourceStore.ResourceStoreException | IResourceStore.ResourceNotFoundException e) { log.error(e.getLocalizedMessage(), e); } }); }
 private void writeUnusedConfigs(Path path, Map<IResourceId, String> configs, String fileExtension) { configs.forEach((resourceId, value) -> { String filename = MessageFormat.format("{0}.{1}.{2}.json", resourceId.getId(), resourceId.getVersion(), fileExtension); Path filePath = Paths.get(path.toString(), filename); try { deleteFileIfExists(filePath); try (BufferedWriter writer = Files.newBufferedWriter(filePath)) { writer.write(value); writeDocumentDescriptor(path, resourceId.getId(), resourceId.getVersion()); } } catch (IOException | IResourceStore.ResourceStoreException | IResourceStore.ResourceNotFoundException e) { log.error(e.getLocalizedMessage(), e); } }); }
 private Path writeDirAndDocument(String documentId, Integer documentVersion, String configurationString, Path tmpPath, String fileExtension) throws IOException {
 Path dir = Files.createDirectories(Paths.get(tmpPath.toString(), documentId, String.valueOf(documentVersion)));
 String filename = MessageFormat.format("{0}.{1}.json", documentId, fileExtension); Path filePath = Paths.get(dir.toString(), filename); deleteFileIfExists(filePath); Path botConfigFilePath = Files.createFile(filePath); try (BufferedWriter writer = Files.newBufferedWriter(botConfigFilePath)) { writer.write(configurationString); }
 return dir; }
 private DocumentDescriptor writeDocumentDescriptor(Path path, String documentId, Integer documentVersion) throws IResourceStore.ResourceStoreException, IResourceStore.ResourceNotFoundException, IOException { DocumentDescriptor documentDescriptor = documentDescriptorStore.readDescriptorWithHistory(documentId, documentVersion); String filename = MessageFormat.format("{0}.descriptor.json", documentId); Path filePath = Paths.get(path.toString(), filename); deleteFileIfExists(filePath); try (BufferedWriter writer = Files.newBufferedWriter(filePath)) { writer.write(jsonSerialization.serialize(documentDescriptor)); }
 return documentDescriptor; }
 private static <T> Map<IResourceId, T> readConfigs(IResourceStore<T> store, List<URI> configUris) throws IResourceStore.ResourceNotFoundException, IResourceStore.ResourceStoreException { Map<IResourceId, T> ret = new LinkedHashMap<>(); for (URI uri : configUris) { IResourceId resourceId = RestUtilities.extractResourceId(uri); ret.put(resourceId, store.read(resourceId.getId(), resourceId.getVersion())); }
 return ret; }
 private void deleteFileIfExists(Path path) throws IOException { if (Files.exists(path)) { Files.delete(path); } }}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


