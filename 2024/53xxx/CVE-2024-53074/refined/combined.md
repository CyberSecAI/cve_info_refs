=== Content from git.kernel.org_151581a6_20250114_194108.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Emmanuel Grumbach <emmanuel.grumbach@intel.com> | 2024-10-10 14:04:59 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-08 16:30:46 +0100 |
| commit | [70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376)) | |
| tree | [fb7ddb3a436ae5952f01d6e0f74431888088e976](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376) | |
| parent | [047d192a03f338fbac981ad2ffc67e90187682e7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=047d192a03f338fbac981ad2ffc67e90187682e7) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376&id2=047d192a03f338fbac981ad2ffc67e90187682e7)) | |
| download | [linux-70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376.tar.gz) | |

wifi: iwlwifi: mvm: don't leak a link on AP removal[ Upstream commit 3ed092997a004d68a3a5b0eeb94e71b69839d0f7 ]
Release the link mapping resource in AP removal. This impacted devices
that do not support the MLD API (9260 and down).
On those devices, we couldn't start the AP again after the AP has been
already started and stopped.
Fixes: a8b5d4809b50 ("wifi: iwlwifi: mvm: Configure the link mapping for non-MLD FW")
Signed-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>
Signed-off-by: Miri Korenblit <miriam.rachel.korenblit@intel.com>
Link: [https://patch.msgid.link/20241010140328.c54c42779882.Ied79e0d6244dc5a372e8b6ffa8ee9c6e1379ec1d@changeid](https://patch.msgid.link/20241010140328.c54c42779882.Ied79e0d6244dc5a372e8b6ffa8ee9c6e1379ec1d%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376)

| -rw-r--r-- | [drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c b/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.cindex 1ebcc6417ecef1..e38cff6176dd3b 100644--- a/[drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c?id=047d192a03f338fbac981ad2ffc67e90187682e7)+++ b/[drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c?id=70ddf9ce1894c48dbbf10b0de51a95e4fb3dd376)@@ -1951,7 +1951,6 @@ static void iwl\_mvm\_mac\_remove\_interface(struct ieee80211\_hw \*hw, mvm->p2p\_device\_vif = NULL; } - iwl\_mvm\_unset\_link\_mapping(mvm, vif, &vif->bss\_conf); iwl\_mvm\_mac\_ctxt\_remove(mvm, vif);  RCU\_INIT\_POINTER(mvm->vif\_id\_to\_mac[mvmvif->id], NULL);@@ -1960,6 +1959,7 @@ static void iwl\_mvm\_mac\_remove\_interface(struct ieee80211\_hw \*hw, mvm->monitor\_on = false;  out:+ iwl\_mvm\_unset\_link\_mapping(mvm, vif, &vif->bss\_conf); if (vif->type == NL80211\_IFTYPE\_AP || vif->type == NL80211\_IFTYPE\_ADHOC) { iwl\_mvm\_dealloc\_int\_sta(mvm, &mvmvif->deflink.mcast\_sta); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:39:45 +0000



=== Content from git.kernel.org_8c64cffc_20250114_194108.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Emmanuel Grumbach <emmanuel.grumbach@intel.com> | 2024-10-10 14:04:59 +0300 |
| --- | --- | --- |
| committer | Johannes Berg <johannes.berg@intel.com> | 2024-10-25 17:53:24 +0200 |
| commit | [3ed092997a004d68a3a5b0eeb94e71b69839d0f7](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7)) | |
| tree | [c75bd95534a6fabb9cc237a8d830a5e4dffcf77c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7) | |
| parent | [e31a8219fbfcf9dc65ba1e1c10cade12b6754e00](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e31a8219fbfcf9dc65ba1e1c10cade12b6754e00) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7&id2=e31a8219fbfcf9dc65ba1e1c10cade12b6754e00)) | |
| download | [linux-3ed092997a004d68a3a5b0eeb94e71b69839d0f7.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3ed092997a004d68a3a5b0eeb94e71b69839d0f7.tar.gz) | |

wifi: iwlwifi: mvm: don't leak a link on AP removalRelease the link mapping resource in AP removal. This impacted devices
that do not support the MLD API (9260 and down).
On those devices, we couldn't start the AP again after the AP has been
already started and stopped.
Fixes: a8b5d4809b50 ("wifi: iwlwifi: mvm: Configure the link mapping for non-MLD FW")
Signed-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com>
Signed-off-by: Miri Korenblit <miriam.rachel.korenblit@intel.com>
Link: [https://patch.msgid.link/20241010140328.c54c42779882.Ied79e0d6244dc5a372e8b6ffa8ee9c6e1379ec1d@changeid](https://patch.msgid.link/20241010140328.c54c42779882.Ied79e0d6244dc5a372e8b6ffa8ee9c6e1379ec1d%40changeid)
Signed-off-by: Johannes Berg <johannes.berg@intel.com>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7)

| -rw-r--r-- | [drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7) | 2 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 1 insertions, 1 deletions

| diff --git a/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c b/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.cindex a327893c6dce47..39b8159045017b 100644--- a/[drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c?id=e31a8219fbfcf9dc65ba1e1c10cade12b6754e00)+++ b/[drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/intel/iwlwifi/mvm/mac80211.c?id=3ed092997a004d68a3a5b0eeb94e71b69839d0f7)@@ -1970,7 +1970,6 @@ static void iwl\_mvm\_mac\_remove\_interface(struct ieee80211\_hw \*hw, mvm->p2p\_device\_vif = NULL; } - iwl\_mvm\_unset\_link\_mapping(mvm, vif, &vif->bss\_conf); iwl\_mvm\_mac\_ctxt\_remove(mvm, vif);  RCU\_INIT\_POINTER(mvm->vif\_id\_to\_mac[mvmvif->id], NULL);@@ -1979,6 +1978,7 @@ static void iwl\_mvm\_mac\_remove\_interface(struct ieee80211\_hw \*hw, mvm->monitor\_on = false;  out:+ iwl\_mvm\_unset\_link\_mapping(mvm, vif, &vif->bss\_conf); if (vif->type == NL80211\_IFTYPE\_AP || vif->type == NL80211\_IFTYPE\_ADHOC) { iwl\_mvm\_dealloc\_int\_sta(mvm, &mvmvif->deflink.mcast\_sta); |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 19:39:45 +0000


