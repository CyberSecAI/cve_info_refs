```
{
  "vulnerability_details": {
    "root_cause": "The application uses an incorrect sanitization function when handling the `redirectTo` parameter in the login, register, and home pages. The `sanitizeRedirect` function in `registerLoginReset.vue` uses DOMPurify to sanitize the redirect parameter but fails to prevent javascript execution. Additionally, the sanitization logic in `home.vue` doesn't sanitize the `redirectTo` parameter, leading to XSS.",
    "weaknesses": [
      "Reflected Cross-Site Scripting (XSS)",
      "Inadequate input sanitization"
    ],
    "impact": "Successful exploitation of these vulnerabilities allows an attacker to execute arbitrary JavaScript code in the context of a victim's session. This can lead to account takeover by obtaining the victim's user ID and API key, which are stored in local storage. This can cause unauthorized access to a victim's account.",
    "attack_vectors": "The attack vector involves crafting a malicious link containing the `redirectTo` parameter with malicious JavaScript code, and tricking a user into clicking the link while logged in or registering. The attacker can send the crafted links to a user in the following form:\n\n`/login?redirectTo=javascript(alert(localStorage['habit-mobile-settings']))`\n\n`/register?redirectTo=javascript(alert(localStorage['habit-mobile-settings']))`\n\n`/static/home?redirectTo=javascript(alert(localStorage['habit-mobile-settings']))`",
    "attacker_capabilities": "The attacker needs to be able to craft malicious URLs and trick users into visiting them. No special privileges are required for the attack."
  },
  "affected_components": [
    "login functionality",
    "registration functionality",
    "home page"
  ],
    "additional_notes": "The provided content includes a patch for the vulnerability. The patch implements a proper sanitization logic in a mixin, `sanitizeRedirect.js`. The new logic checks if the redirect is a trusted domain or is a relative path within the application, effectively preventing XSS."
}
```