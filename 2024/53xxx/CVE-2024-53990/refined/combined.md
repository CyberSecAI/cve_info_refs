=== Content from github.com_ef28b4b6_20250115_113127.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-mfj5-cf8g-g2fv)

**CVE-2024-53990**

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fadvisories%2FGHSA-mfj5-cf8g-g2fv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2Fadvisories%2F%3Cid%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

1. [GitHub Advisory Database](/advisories)
2. [GitHub Reviewed](/advisories?query=type%3Areviewed)
3. [CVE-2024-53990](/advisories/GHSA-mfj5-cf8g-g2fv)

## AsyncHttpClient (AHC) library's `CookieStore` replaces explicitly defined `Cookie`s

Critical severity

GitHub Reviewed

Published
Dec 2, 2024
in
[AsyncHttpClient/async-http-client](/AsyncHttpClient/async-http-client)
•
Updated Dec 18, 2024

[Vulnerability details](/advisories/GHSA-mfj5-cf8g-g2fv)
[Dependabot alerts
0](/advisories/GHSA-mfj5-cf8g-g2fv/dependabot)

## Package

maven

org.asynchttpclient:async-http-client
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

>= 2.1.0, < 2.12.4
>= 3.0.0.Beta1, < 3.0.1

## Patched versions

2.12.4
3.0.1

## Description

### Summary

When making any HTTP request, the automatically enabled and self-managed `CookieStore` (aka cookie jar) will silently replace explicitly defined `Cookie`s with any that have the same name from the cookie jar. For services that operate with multiple users, this can result in one user's `Cookie` being used for another user's requests.

### Details

This issue is described without security warnings here:

[AsyncHttpClient/async-http-client#1964](https://github.com/AsyncHttpClient/async-http-client/issues/1964)

A PR to fix this issue has been made:

[AsyncHttpClient/async-http-client#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033)

### PoC

1. Add an auth `Cookie` to the `CookieStore`
   * This is identical to receiving an HTTP response that uses `Set-Cookie`, as shown in issue #1964 above.
2. Handle a different user's request where the same `Cookie` is provided as a passthrough, like a JWT, and attempt to use it by explicitly providing it.
3. Observe that the user's cookie in step 2 is passed as the Cookie in step 1.

### Impact

This is generally going to be a problem for developers of backend services that implement third party auth features and use other features like token refresh. The moment a third party service responds by *setting* a cookie in the response, the `CookieStore` will effectively break almost every follow-up request (hopefully by being rejected, but possibly by revealing a different user's information).

If your service sets cookies based on the response that happens here, it's possible to lead to even greater levels of exposure.

### Workaroud

You can avoid this issue by disabling the `CookieStore` during client creation:

```
DefaultAsyncHttpClientConfig.Builder clientBuilder = Dsl.config()
 .setCookieStore(null)
 // other configuration
 ;
```
### References

* [GHSA-mfj5-cf8g-g2fv](https://github.com/AsyncHttpClient/async-http-client/security/advisories/GHSA-mfj5-cf8g-g2fv "GHSA-mfj5-cf8g-g2fv")
* <https://nvd.nist.gov/vuln/detail/CVE-2024-53990>
* [AsyncHttpClient/async-http-client#1964](https://github.com/AsyncHttpClient/async-http-client/issues/1964)
* [AsyncHttpClient/async-http-client#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033)
* [AsyncHttpClient/async-http-client@d5a8336](https://github.com/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425)
* <https://github.com/AsyncHttpClient/async-http-client/blob/main/CHANGES.md#from-20-to-21>

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&v=4)](/hyperxpro)
[hyperxpro](/hyperxpro)
published to
[AsyncHttpClient/async-http-client](/AsyncHttpClient/async-http-client/security/advisories/GHSA-mfj5-cf8g-g2fv)
Dec 2, 2024

Published by the [National Vulnerability Database](https://nvd.nist.gov/vuln/detail/CVE-2024-53990)
Dec 2, 2024

Published to the GitHub Advisory Database
Dec 2, 2024

Reviewed
Dec 2, 2024

Last updated
Dec 18, 2024

### Severity

Critical

9.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector
Network

Attack Complexity
High

Attack Requirements
None

Privileges Required
None

User interaction
None
##### Vulnerable System Impact Metrics

Confidentiality
High

Integrity
High

Availability
High
##### Subsequent System Impact Metrics

Confidentiality
None

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v4 base metrics

##### Exploitability Metrics

Attack Vector:
This metric reflects the context by which vulnerability exploitation is possible. This metric value (and consequently the resulting severity) will be larger the more remote (logically, and physically) an attacker can be in order to exploit the vulnerable system. The assumption is that the number of potential attackers for a vulnerability that could be exploited from across a network is larger than the number of potential attackers that could exploit a vulnerability requiring physical access to a device, and therefore warrants a greater severity.

Attack Complexity:
This metric captures measurable actions that must be taken by the attacker to actively evade or circumvent existing built-in security-enhancing conditions in order to obtain a working exploit. These are conditions whose primary purpose is to increase security and/or increase exploit engineering complexity. A vulnerability exploitable without a target-specific variable has a lower complexity than a vulnerability that would require non-trivial customization. This metric is meant to capture security mechanisms utilized by the vulnerable system.

Attack Requirements:
This metric captures the prerequisite deployment and execution conditions or variables of the vulnerable system that enable the attack. These differ from security-enhancing techniques/technologies (ref Attack Complexity) as the primary purpose of these conditions is not to explicitly mitigate attacks, but rather, emerge naturally as a consequence of the deployment and execution of the vulnerable system.

Privileges Required:
This metric describes the level of privileges an attacker must possess prior to successfully exploiting the vulnerability. The method by which the attacker obtains privileged credentials prior to the attack (e.g., free trial accounts), is outside the scope of this metric. Generally, self-service provisioned accounts do not constitute a privilege requirement if the attacker can grant themselves privileges as part of the attack.

User interaction:
This metric captures the requirement for a human user, other than the attacker, to participate in the successful compromise of the vulnerable system. This metric determines whether the vulnerability can be exploited solely at the will of the attacker, or whether a separate user (or user-initiated process) must participate in some manner.
##### Vulnerable System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the VULNERABLE SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the VULNERABLE SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the VULNERABLE SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.
##### Subsequent System Impact Metrics

Confidentiality:
This metric measures the impact to the confidentiality of the information managed by the SUBSEQUENT SYSTEM due to a successfully exploited vulnerability. Confidentiality refers to limiting information access and disclosure to only authorized users, as well as preventing access by, or disclosure to, unauthorized ones.

Integrity:
This metric measures the impact to integrity of a successfully exploited vulnerability. Integrity refers to the trustworthiness and veracity of information. Integrity of the SUBSEQUENT SYSTEM is impacted when an attacker makes unauthorized modification of system data. Integrity is also impacted when a system user can repudiate critical actions taken in the context of the system (e.g. due to insufficient logging).

Availability:
This metric measures the impact to the availability of the SUBSEQUENT SYSTEM resulting from a successfully exploited vulnerability. While the Confidentiality and Integrity impact metrics apply to the loss of confidentiality or integrity of data (e.g., information, files) used by the system, this metric refers to the loss of availability of the impacted system itself, such as a networked service (e.g., web, database, email). Since availability refers to the accessibility of information resources, attacks that consume network bandwidth, processor cycles, or disk space all impact the availability of a system.

 CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N

### [EPSS score](https://www.first.org/epss/user-guide)

0.045%
 (18th percentile)

### Weaknesses

[CWE-287](/advisories?query=cwe%3A287)

### CVE ID

CVE-2024-53990

### GHSA ID

GHSA-mfj5-cf8g-g2fv

### Source code

[AsyncHttpClient/async-http-client](https://github.com/AsyncHttpClient/async-http-client)

### Credits

* [![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&v=4)](/pickypg)
  [pickypg](/pickypg)
  Reporter

 Loading

Checking history

See something to contribute?
[Suggest improvements for this vulnerability](/advisories/GHSA-mfj5-cf8g-g2fv/improve).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_58f1e5e0_20250114_184708.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fcommit%2Fd5a83362f7aed81b93ebca559746ac9be0f95425)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fcommit%2Fd5a83362f7aed81b93ebca559746ac9be0f95425)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=AsyncHttpClient%2Fasync-http-client)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[AsyncHttpClient](/AsyncHttpClient)
/
**[async-http-client](/AsyncHttpClient/async-http-client)**
Public

* [Notifications](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)
* [Star
   6.3k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)

* [Code](/AsyncHttpClient/async-http-client)
* [Issues
  96](/AsyncHttpClient/async-http-client/issues)
* [Pull requests
  18](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects
  0](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

Additional navigation options

* [Code](/AsyncHttpClient/async-http-client)
* [Issues](/AsyncHttpClient/async-http-client/issues)
* [Pull requests](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

## Commit

[Permalink](/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

[CookieStore] Only set `Cookie`s if they are not already set ([#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033))

[Browse files](/AsyncHttpClient/async-http-client/tree/d5a83362f7aed81b93ebca559746ac9be0f95425)
Browse the repository at this point in the history

```
This changes the behavior of the automatic usage of the `CookieStore` to
avoid overwriting already-set `Cookie`s and, instead only sets them if
they do not exist yet.

Closes [#1964](https://github.com/AsyncHttpClient/async-http-client/issues/1964)

Co-authored-by: Aayush Atharva <aayush@shieldblaze.com>
```

* Loading branch information

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&v=4)](/pickypg) [![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&v=4)](/hyperxpro)

[pickypg](/AsyncHttpClient/async-http-client/commits?author=pickypg "View all commits by pickypg")
and
[hyperxpro](/AsyncHttpClient/async-http-client/commits?author=hyperxpro "View all commits by hyperxpro")
authored
Dec 1, 2024

1 parent
[2af2715](/AsyncHttpClient/async-http-client/commit/2af27154ba181c49b762c7a4a68c12b6831de093)

commit d5a8336

 Show file tree

 Hide file tree

Showing
**4 changed files**
with
**55 additions**
and
**9 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* client/src

  + main/java/org/asynchttpclient

    - client/src/main/java/org/asynchttpclient/DefaultAsyncHttpClient.java
      [DefaultAsyncHttpClient.java](#diff-46492f5e6df98278b33307a77be74184170a6c36491b902cc6931cdb9e81c061)
    - client/src/main/java/org/asynchttpclient/RequestBuilderBase.java
      [RequestBuilderBase.java](#diff-b93b188fc1eb54ff862ad616314205285d5877c656e4a5fb3d9f6650c0a0587e)
    - netty/handler/intercept

      * client/src/main/java/org/asynchttpclient/netty/handler/intercept/Redirect30xInterceptor.java
        [Redirect30xInterceptor.java](#diff-87ac35b16332182a11ef31022ced078c748ec8d34ce26ee622bc046c359da55f)
  + test/java/org/asynchttpclient

    - client/src/test/java/org/asynchttpclient/RequestBuilderTest.java
      [RequestBuilderTest.java](#diff-8ee738c707e116527c6dc53202f76f78d79762ef1e07018c7ff9a2410a6c1bd4)

## There are no files selected for viewing

2 changes: 1 addition & 1 deletion

2
[client/src/main/java/org/asynchttpclient/DefaultAsyncHttpClient.java](#diff-46492f5e6df98278b33307a77be74184170a6c36491b902cc6931cdb9e81c061 "client/src/main/java/org/asynchttpclient/DefaultAsyncHttpClient.java")

Show comments

[View file](/AsyncHttpClient/async-http-client/blob/d5a83362f7aed81b93ebca559746ac9be0f95425/client/src/main/java/org/asynchttpclient/DefaultAsyncHttpClient.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -235,7 +235,7 @@ public <T> ListenableFuture<T> executeRequest(Request request, AsyncHandler<T> h |
|  |  | if (!cookies.isEmpty()) { |
|  |  | RequestBuilder requestBuilder = request.toBuilder(); |
|  |  | for (Cookie cookie : cookies) { |
|  |  | requestBuilder.addOrReplaceCookie(cookie); |
|  |  | requestBuilder.addCookieIfUnset(cookie); |
|  |  | } |
|  |  | request = requestBuilder.build(); |
|  |  | } |
| Expand Down | |  |

21 changes: 18 additions & 3 deletions

21
[client/src/main/java/org/asynchttpclient/RequestBuilderBase.java](#diff-b93b188fc1eb54ff862ad616314205285d5877c656e4a5fb3d9f6650c0a0587e "client/src/main/java/org/asynchttpclient/RequestBuilderBase.java")

Show comments

[View file](/AsyncHttpClient/async-http-client/blob/d5a83362f7aed81b93ebca559746ac9be0f95425/client/src/main/java/org/asynchttpclient/RequestBuilderBase.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -323,6 +323,21 @@ public T addCookie(Cookie cookie) { |
|  |  | \* @return this |
|  |  | \*/ |
|  |  | public T addOrReplaceCookie(Cookie cookie) { |
|  |  | return maybeAddOrReplaceCookie(cookie, true); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
|  |  | \* Add a cookie based on its name, if it does not exist yet. Cookies that |
|  |  | \* are already set will be ignored. |
|  |  | \* |
|  |  | \* @param cookie the new cookie |
|  |  | \* @return this |
|  |  | \*/ |
|  |  | public T addCookieIfUnset(Cookie cookie) { |
|  |  | return maybeAddOrReplaceCookie(cookie, false); |
|  |  | } |
|  |  |  |
|  |  | private T maybeAddOrReplaceCookie(Cookie cookie, boolean allowReplace) { |
|  |  | String cookieKey = cookie.name(); |
|  |  | boolean replace = false; |
|  |  | int index = 0; |
| Expand All | | @@ -335,10 +350,10 @@ public T addOrReplaceCookie(Cookie cookie) { |
|  |  |  |
|  |  | index++; |
|  |  | } |
|  |  | if (replace) { |
|  |  | cookies.set(index, cookie); |
|  |  | } else { |
|  |  | if (!replace) { |
|  |  | cookies.add(cookie); |
|  |  | } else if (allowReplace) { |
|  |  | cookies.set(index, cookie); |
|  |  | } |
|  |  | return asDerivedType(); |
|  |  | } |
| Expand Down | |  |

7 changes: 2 additions & 5 deletions

7
[client/src/main/java/org/asynchttpclient/netty/handler/intercept/Redirect30xInterceptor.java](#diff-87ac35b16332182a11ef31022ced078c748ec8d34ce26ee622bc046c359da55f "client/src/main/java/org/asynchttpclient/netty/handler/intercept/Redirect30xInterceptor.java")

Show comments

[View file](/AsyncHttpClient/async-http-client/blob/d5a83362f7aed81b93ebca559746ac9be0f95425/client/src/main/java/org/asynchttpclient/netty/handler/intercept/Redirect30xInterceptor.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -142,11 +142,8 @@ public boolean exitAfterHandlingRedirect(Channel channel, NettyResponseFuture<?> |
|  |  | CookieStore cookieStore = config.getCookieStore(); |
|  |  | if (cookieStore != null) { |
|  |  | // Update request's cookies assuming that cookie store is already updated by Interceptors |
|  |  | List<Cookie> cookies = cookieStore.get(newUri); |
|  |  | if (!cookies.isEmpty()) { |
|  |  | for (Cookie cookie : cookies) { |
|  |  | requestBuilder.addOrReplaceCookie(cookie); |
|  |  | } |
|  |  | for (Cookie cookie : cookieStore.get(newUri)) { |
|  |  | requestBuilder.addCookieIfUnset(cookie); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

34 changes: 34 additions & 0 deletions

34
[client/src/test/java/org/asynchttpclient/RequestBuilderTest.java](#diff-8ee738c707e116527c6dc53202f76f78d79762ef1e07018c7ff9a2410a6c1bd4 "client/src/test/java/org/asynchttpclient/RequestBuilderTest.java")

Show comments

[View file](/AsyncHttpClient/async-http-client/blob/d5a83362f7aed81b93ebca559746ac9be0f95425/client/src/test/java/org/asynchttpclient/RequestBuilderTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -166,6 +166,40 @@ public void testAddOrReplaceCookies() { |
|  |  | assertEquals(requestBuilder.cookies.size(), 2, "cookie size must be 2 after adding 1 more cookie i.e. cookie3"); |
|  |  | } |
|  |  |  |
|  |  | @RepeatedIfExceptionsTest(repeats = 5) |
|  |  | public void testAddIfUnsetCookies() { |
|  |  | RequestBuilder requestBuilder = new RequestBuilder(); |
|  |  | Cookie cookie = new DefaultCookie("name", "value"); |
|  |  | cookie.setDomain("google.com"); |
|  |  | cookie.setPath("/"); |
|  |  | cookie.setMaxAge(1000); |
|  |  | cookie.setSecure(true); |
|  |  | cookie.setHttpOnly(true); |
|  |  | requestBuilder.addCookieIfUnset(cookie); |
|  |  | assertEquals(requestBuilder.cookies.size(), 1, "cookies size should be 1 after adding one cookie"); |
|  |  | assertEquals(requestBuilder.cookies.get(0), cookie, "cookie does not match"); |
|  |  |  |
|  |  | Cookie cookie2 = new DefaultCookie("name", "value"); |
|  |  | cookie2.setDomain("google2.com"); |
|  |  | cookie2.setPath("/path"); |
|  |  | cookie2.setMaxAge(1001); |
|  |  | cookie2.setSecure(false); |
|  |  | cookie2.setHttpOnly(false); |
|  |  |  |
|  |  | requestBuilder.addCookieIfUnset(cookie2); |
|  |  | assertEquals(requestBuilder.cookies.size(), 1, "cookies size should remain 1 as we just ignored cookie2 because of a cookie with same name"); |
|  |  | assertEquals(requestBuilder.cookies.get(0), cookie, "cookie does not match"); |
|  |  |  |
|  |  | Cookie cookie3 = new DefaultCookie("name2", "value"); |
|  |  | cookie3.setDomain("google.com"); |
|  |  | cookie3.setPath("/"); |
|  |  | cookie3.setMaxAge(1000); |
|  |  | cookie3.setSecure(true); |
|  |  | cookie3.setHttpOnly(true); |
|  |  | requestBuilder.addCookieIfUnset(cookie3); |
|  |  | assertEquals(requestBuilder.cookies.size(), 2, "cookie size must be 2 after adding 1 more cookie i.e. cookie3"); |
|  |  | } |
|  |  |  |
|  |  | @RepeatedIfExceptionsTest(repeats = 5) |
|  |  | public void testSettingQueryParamsBeforeUrlShouldNotProduceNPE() { |
|  |  | RequestBuilder requestBuilder = new RequestBuilder(); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `d5a8336`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fcommit%2Fd5a83362f7aed81b93ebca559746ac9be0f95425) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_12fa191d_20250115_113125.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flhotari)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Flhotari)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@lhotari](https://avatars.githubusercontent.com/u/66864?s=64&v=4)

**lhotari**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Flhotari)

[Overview](/lhotari)
[Repositories
226](/lhotari?tab=repositories)
[Projects
0](/lhotari?tab=projects)
[Packages
0](/lhotari?tab=packages)
[Stars
157](/lhotari?tab=stars)

More

* [Overview](/lhotari)
* [Repositories](/lhotari?tab=repositories)
* [Projects](/lhotari?tab=projects)
* [Packages](/lhotari?tab=packages)
* [Stars](/lhotari?tab=stars)

![@lhotari](https://avatars.githubusercontent.com/u/66864?s=64&v=4)

**lhotari**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Flhotari)

[![View lhotari's full-sized avatar](https://avatars.githubusercontent.com/u/66864?v=4)](https://avatars.githubusercontent.com/u/66864?v=4)

# Lari Hotari lhotari

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Flhotari)

OSS contributor. Distributed Systems Engineer. Apache Pulsar PMC member. Apache Software Foundation member. Sr. Technologist, Office of CTO @ StreamNative
[236
followers](https://github.com/lhotari?tab=followers) · [5
following](https://github.com/lhotari?tab=following)

* [@streamnative](https://github.com/streamnative)
* Espoo, Finland
* 13:31
  (UTC +02:00)
* X
  [@lhotari](https://twitter.com/lhotari)
* LinkedIn

  [in/lari-hotari-898860](https://www.linkedin.com/in/lari-hotari-898860/)

## [Achievements](/lhotari?tab=achievements)

[![Achievement: Galaxy Brain](https://github.githubassets.com/assets/galaxy-brain-default-847262c21056.png)x3](/lhotari?achievement=galaxy-brain&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x4](/lhotari?achievement=pull-shark&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x3](/lhotari?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x2](/lhotari?achievement=starstruck&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/lhotari?achievement=yolo&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/lhotari?achievement=quickdraw&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/lhotari?achievement=arctic-code-vault-contributor&tab=achievements)
## [Achievements](/lhotari?tab=achievements)

[![Achievement: Galaxy Brain](https://github.githubassets.com/assets/galaxy-brain-default-847262c21056.png)x3](/lhotari?achievement=galaxy-brain&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x4](/lhotari?achievement=pull-shark&tab=achievements)[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x3](/lhotari?achievement=pair-extraordinaire&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)x2](/lhotari?achievement=starstruck&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/lhotari?achievement=yolo&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/lhotari?achievement=quickdraw&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/lhotari?achievement=arctic-code-vault-contributor&tab=achievements)
## Organizations

[![@apache](https://avatars.githubusercontent.com/u/47359?s=64&v=4)](/apache) [![@streamnative](https://avatars.githubusercontent.com/u/44651383?s=64&v=4)](/streamnative)

Block or Report

# Block or report lhotari

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=lhotari+%28user%29)

[Overview](/lhotari)
[Repositories
226](/lhotari?tab=repositories)
[Projects
0](/lhotari?tab=projects)
[Packages
0](/lhotari?tab=packages)
[Stars
157](/lhotari?tab=stars)

More

* [Overview](/lhotari)
* [Repositories](/lhotari?tab=repositories)
* [Projects](/lhotari?tab=projects)
* [Packages](/lhotari?tab=packages)
* [Stars](/lhotari?tab=stars)

## Pinned Loading

1. [apache/pulsar](/apache/pulsar) apache/pulsar Public

   Apache Pulsar - distributed pub-sub messaging system

   Java

   [14.4k](/apache/pulsar/stargazers)
   [3.6k](/apache/pulsar/forks)
2. [grails/grails-core](/grails/grails-core) grails/grails-core Public

   The Grails Web Application Framework

   HTML

   [2.8k](/grails/grails-core/stargazers)
   [952](/grails/grails-core/forks)
3. [reactor/reactor-core](/reactor/reactor-core) reactor/reactor-core Public

   Non-Blocking Reactive Foundation for the JVM

   Java

   [5k](/reactor/reactor-core/stargazers)
   [1.2k](/reactor/reactor-core/forks)
4. [gradle/gradle](/gradle/gradle) gradle/gradle Public

   Adaptable, fast automation for all

   Groovy

   [17.2k](/gradle/gradle/stargazers)
   [4.8k](/gradle/gradle/forks)
5. [spring-projects/spring-boot](/spring-projects/spring-boot) spring-projects/spring-boot Public

   Spring Boot helps you to create Spring-powered, production-grade applications and services with absolute minimum fuss.

   Java

   [75.9k](/spring-projects/spring-boot/stargazers)
   [40.9k](/spring-projects/spring-boot/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_9bf1b421_20250115_113127.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fpulsar%2Fpull%2F23725)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fpulsar%2Fpull%2F23725)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=apache%2Fpulsar)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[pulsar](/apache/pulsar)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fpulsar) You must be signed in to change notification settings
* [Fork
  3.6k](/login?return_to=%2Fapache%2Fpulsar)
* [Star
   14.4k](/login?return_to=%2Fapache%2Fpulsar)

* [Code](/apache/pulsar)
* [Issues
  1.1k](/apache/pulsar/issues)
* [Pull requests
  349](/apache/pulsar/pulls)
* [Discussions](/apache/pulsar/discussions)
* [Actions](/apache/pulsar/actions)
* [Projects
  2](/apache/pulsar/projects)
* [Wiki](/apache/pulsar/wiki)
* [Security](/apache/pulsar/security)
* [Insights](/apache/pulsar/pulse)

Additional navigation options

* [Code](/apache/pulsar)
* [Issues](/apache/pulsar/issues)
* [Pull requests](/apache/pulsar/pulls)
* [Discussions](/apache/pulsar/discussions)
* [Actions](/apache/pulsar/actions)
* [Projects](/apache/pulsar/projects)
* [Wiki](/apache/pulsar/wiki)
* [Security](/apache/pulsar/security)
* [Insights](/apache/pulsar/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fapache%2Fpulsar%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fapache%2Fpulsar%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore #23725

 Merged

[lhotari](/lhotari)
merged 1 commit into
[apache:master](/apache/pulsar/tree/master "apache/pulsar:master")
from
[lhotari:lh-disable-async-http-client-cookiestore](/lhotari/pulsar/tree/lh-disable-async-http-client-cookiestore "lhotari/pulsar:lh-disable-async-http-client-cookiestore")

Dec 13, 2024

 Merged

# [[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore](#top) #23725

[lhotari](/lhotari)
merged 1 commit into
[apache:master](/apache/pulsar/tree/master "apache/pulsar:master")
from
[lhotari:lh-disable-async-http-client-cookiestore](/lhotari/pulsar/tree/lh-disable-async-http-client-cookiestore "lhotari/pulsar:lh-disable-async-http-client-cookiestore")

Dec 13, 2024

[Conversation
1](/apache/pulsar/pull/23725)
[Commits
1](/apache/pulsar/pull/23725/commits)
[Checks
62](/apache/pulsar/pull/23725/checks)
[Files changed](/apache/pulsar/pull/23725/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![lhotari](https://avatars.githubusercontent.com/u/66864?s=60&v=4)](/lhotari)

Copy link

Member

### @lhotari **[lhotari](/lhotari)** commented [Dec 12, 2024](#issue-2737051386) • edited Loading

### Motivation

See [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990"). There aren't backend services in Pulsar that would use cookies, however since it's a high severity vulnerability, there's a need to mitigate it. Eventually we will need to upgrade to AsyncHttpClient 3.0.1 to get rid of the vulnerable dependency AsyncHttpClient 2.12.x.

### Modifications

* As a mitigation, disable CookieStore by setting it to null
* This PR doesn't upgrade to AsyncHttpClient 3.0.1
  + Upgrading to AsyncHttpClient 3.0.1 will be more work. It will be handled separately.

### Additional context

* dev mailing list thread:
  + [[DISCUSS] Strategy for addressing AsyncHttpClient CVE-2024-53990 in Pulsar Java clients while maintaining Java 8 compatibility](https://lists.apache.org/thread/fpg465pxytqkxbs57h7p3mckn9dwh3zq)

### Documentation

* `doc`
* `doc-required`
* `doc-not-needed`
* `doc-complete`

Sorry, something went wrong.

All reactions

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&v=4)](/lhotari)

`[[fix][sec] Mitigate](/apache/pulsar/pull/23725/commits/a838d3925c2a44d4ede350d2c8003b5fc21a7714 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore

- Disable CookieStore by setting it to null in all locations") [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") [by disabling AsyncHttpClient Cooki…](/apache/pulsar/pull/23725/commits/a838d3925c2a44d4ede350d2c8003b5fc21a7714 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore

- Disable CookieStore by setting it to null in all locations")`
 …

`[a838d39](/apache/pulsar/pull/23725/commits/a838d3925c2a44d4ede350d2c8003b5fc21a7714)`

```
…eStore

- Disable CookieStore by setting it to null in all locations
```

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
added
[release/3.0.9](/apache/pulsar/labels/release/3.0.9)
[release/3.3.4](/apache/pulsar/labels/release/3.3.4)
[release/4.0.2](/apache/pulsar/labels/release/4.0.2)
labels
[Dec 12, 2024](#event-15641560799)

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
added this to the [4.1.0](/apache/pulsar/milestone/40) milestone
[Dec 12, 2024](#event-15641560810)

 [![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
requested review from
[merlimat](/merlimat),
[Technoboy-](/Technoboy-),
[nodece](/nodece) and
[nicoloboschi](/nicoloboschi)
[December 12, 2024 23:14](#event-15641560829)

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
self-assigned this
[Dec 12, 2024](#event-15641560864)

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
added
the
[ready-to-test](/apache/pulsar/labels/ready-to-test)
label
[Dec 12, 2024](#event-15641561390)

[![@github-actions](https://avatars.githubusercontent.com/in/15368?s=40&v=4)](/apps/github-actions)
[github-actions](/apps/github-actions)
bot
added
the
[doc-not-needed](/apache/pulsar/labels/doc-not-needed)
Your PR changes do not impact docs
label
[Dec 12, 2024](#event-15641565752)

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
mentioned this pull request
[Dec 12, 2024](#ref-pullrequest-2736990398)

[Bump org.asynchttpclient:async-http-client from 2.12.1 to 3.0.1
#23724](/apache/pulsar/pull/23724)
 Closed

[![nodece](https://avatars.githubusercontent.com/u/16235121?s=60&v=4)](/nodece)

**[nodece](/nodece)**
approved these changes
[Dec 13, 2024](#pullrequestreview-2501185598)

 [View reviewed changes](/apache/pulsar/pull/23725/files/a838d3925c2a44d4ede350d2c8003b5fc21a7714)

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
mentioned this pull request
[Dec 13, 2024](#ref-pullrequest-2659545791)

[[CookieStore] Only set `Cookie`s if they are not already set
AsyncHttpClient/async-http-client#2033](/AsyncHttpClient/async-http-client/pull/2033)
 Merged

[![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=80&u=b7ee84d82e25b493051d810390e97b15f716d7ef&v=4)](/codecov-commenter)

Copy link

### **[codecov-commenter](/codecov-commenter)** commented [Dec 13, 2024](#issuecomment-2541346318) • edited Loading

|  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [Codecov](https://app.codecov.io/gh/apache/pulsar/pull/23725?dropdown=coverage&src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) Report All modified and coverable lines are covered by tests ✅  Project coverage is 74.38%. Comparing base [(`bbc6224`)](https://app.codecov.io/gh/apache/pulsar/commit/bbc62245c5ddba1de4b1e7cee4ab49334bc36277?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) to head [(`a838d39`)](https://app.codecov.io/gh/apache/pulsar/commit/a838d3925c2a44d4ede350d2c8003b5fc21a7714?dropdown=coverage&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache). Report is 789 commits behind head on master. Additional details and impacted files [Impacted file tree graph](https://app.codecov.io/gh/apache/pulsar/pull/23725?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache)  ``` @@             Coverage Diff              @@ ##             master   #23725      +/-   ## ============================================ + Coverage     73.57%   74.38%   +0.81%      - Complexity    32624    34559    +1935      ============================================   Files          1877     1945      +68        Lines        139502   147486    +7984        Branches      15299    16277     +978      ============================================ + Hits         102638   109713    +7075      - Misses        28908    29306     +398      - Partials       7956     8467     +511      ```  | [Flag](https://app.codecov.io/gh/apache/pulsar/pull/23725/flags?src=pr&el=flags&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | Coverage Δ |  | | --- | --- | --- | | [inttests](https://app.codecov.io/gh/apache/pulsar/pull/23725/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `27.29% <20.00%> (+2.70%)` | ⬆️ | | [systests](https://app.codecov.io/gh/apache/pulsar/pull/23725/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `24.35% <20.00%> (+0.03%)` | ⬆️ | | [unittests](https://app.codecov.io/gh/apache/pulsar/pull/23725/flags?src=pr&el=flag&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | `73.77% <100.00%> (+0.93%)` | ⬆️ |   Flags with carried forward coverage won't be shown. [Click here](https://docs.codecov.io/docs/carryforward-flags?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#carryforward-flags-in-the-pull-request-comment) to find out more.   | [Files with missing lines](https://app.codecov.io/gh/apache/pulsar/pull/23725?dropdown=coverage&src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) | Coverage Δ |  | | --- | --- | --- | | [...hentication/oidc/AuthenticationProviderOpenID.java](https://app.codecov.io/gh/apache/pulsar/pull/23725?src=pr&el=tree&filepath=pulsar-broker-auth-oidc%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fpulsar%2Fbroker%2Fauthentication%2Foidc%2FAuthenticationProviderOpenID.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-cHVsc2FyLWJyb2tlci1hdXRoLW9pZGMvc3JjL21haW4vamF2YS9vcmcvYXBhY2hlL3B1bHNhci9icm9rZXIvYXV0aGVudGljYXRpb24vb2lkYy9BdXRoZW50aWNhdGlvblByb3ZpZGVyT3BlbklELmphdmE=) | `73.65% <100.00%> (-3.14%)` | ⬇️ | | [...client/admin/internal/http/AsyncHttpConnector.java](https://app.codecov.io/gh/apache/pulsar/pull/23725?src=pr&el=tree&filepath=pulsar-client-admin%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fpulsar%2Fclient%2Fadmin%2Finternal%2Fhttp%2FAsyncHttpConnector.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-cHVsc2FyLWNsaWVudC1hZG1pbi9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcHVsc2FyL2NsaWVudC9hZG1pbi9pbnRlcm5hbC9odHRwL0FzeW5jSHR0cENvbm5lY3Rvci5qYXZh) | `85.21% <100.00%> (-1.21%)` | ⬇️ | | [.../pulsar/client/impl/ControlledClusterFailover.java](https://app.codecov.io/gh/apache/pulsar/pull/23725?src=pr&el=tree&filepath=pulsar-client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fpulsar%2Fclient%2Fimpl%2FControlledClusterFailover.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-cHVsc2FyLWNsaWVudC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcHVsc2FyL2NsaWVudC9pbXBsL0NvbnRyb2xsZWRDbHVzdGVyRmFpbG92ZXIuamF2YQ==) | `65.38% <100.00%> (+0.33%)` | ⬆️ | | [...java/org/apache/pulsar/client/impl/HttpClient.java](https://app.codecov.io/gh/apache/pulsar/pull/23725?src=pr&el=tree&filepath=pulsar-client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fpulsar%2Fclient%2Fimpl%2FHttpClient.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-cHVsc2FyLWNsaWVudC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcHVsc2FyL2NsaWVudC9pbXBsL0h0dHBDbGllbnQuamF2YQ==) | `80.76% <100.00%> (+2.57%)` | ⬆️ | | [.../client/impl/auth/oauth2/protocol/TokenClient.java](https://app.codecov.io/gh/apache/pulsar/pull/23725?src=pr&el=tree&filepath=pulsar-client%2Fsrc%2Fmain%2Fjava%2Forg%2Fapache%2Fpulsar%2Fclient%2Fimpl%2Fauth%2Foauth2%2Fprotocol%2FTokenClient.java&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache#diff-cHVsc2FyLWNsaWVudC9zcmMvbWFpbi9qYXZhL29yZy9hcGFjaGUvcHVsc2FyL2NsaWVudC9pbXBsL2F1dGgvb2F1dGgyL3Byb3RvY29sL1Rva2VuQ2xpZW50LmphdmE=) | `81.25% <100.00%> (+0.39%)` | ⬆️ |   ... and [667 files with indirect coverage changes](https://app.codecov.io/gh/apache/pulsar/pull/23725/indirect-changes?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=apache) |

All reactions

Sorry, something went wrong.

 Hide details
View details

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
merged commit [`51e8247`](/apache/pulsar/commit/51e8247e497626eee3ff83056f7ca24acf4cf57a)
into
apache:master

[Dec 13, 2024](https://github.com/apache/pulsar/pull/23725#event-15648657535)
57 of 59 checks passed

[lhotari](/lhotari)
added a commit
that referenced
this pull request
[Dec 13, 2024](#ref-commit-6e98d4a)
[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)

`[[fix][sec] Mitigate](/apache/pulsar/commit/6e98d4a50cdace2addecadd6dd90b7d8259f3e1d "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)") [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") [by disabling AsyncHttpClient Cooki…](/apache/pulsar/commit/6e98d4a50cdace2addecadd6dd90b7d8259f3e1d "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)")`
…

`[6e98d4a](/apache/pulsar/commit/6e98d4a50cdace2addecadd6dd90b7d8259f3e1d)`

```
…eStore ([#23725](https://github.com/apache/pulsar/pull/23725))

(cherry picked from commit [51e8247](https://github.com/apache/pulsar/commit/51e8247e497626eee3ff83056f7ca24acf4cf57a))
```

[lhotari](/lhotari)
added a commit
that referenced
this pull request
[Dec 13, 2024](#ref-commit-d92f42d)
[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)

`[[fix][sec] Mitigate](/apache/pulsar/commit/d92f42d13d825fc79037ee55a7a407d59540b5a0 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)") [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") [by disabling AsyncHttpClient Cooki…](/apache/pulsar/commit/d92f42d13d825fc79037ee55a7a407d59540b5a0 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)")`
…

`[d92f42d](/apache/pulsar/commit/d92f42d13d825fc79037ee55a7a407d59540b5a0)`

```
…eStore ([#23725](https://github.com/apache/pulsar/pull/23725))

(cherry picked from commit [51e8247](https://github.com/apache/pulsar/commit/51e8247e497626eee3ff83056f7ca24acf4cf57a))
```

[lhotari](/lhotari)
added a commit
that referenced
this pull request
[Dec 13, 2024](#ref-commit-78274a7)
[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)

`[[fix][sec] Mitigate](/apache/pulsar/commit/78274a7e90a3e4e1e204674f5bf76b0110a87a18 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)") [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") [by disabling AsyncHttpClient Cooki…](/apache/pulsar/commit/78274a7e90a3e4e1e204674f5bf76b0110a87a18 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)")`
…

`[78274a7](/apache/pulsar/commit/78274a7e90a3e4e1e204674f5bf76b0110a87a18)`

```
…eStore ([#23725](https://github.com/apache/pulsar/pull/23725))

(cherry picked from commit [51e8247](https://github.com/apache/pulsar/commit/51e8247e497626eee3ff83056f7ca24acf4cf57a))
```

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
added
[cherry-picked/branch-3.0](/apache/pulsar/labels/cherry-picked/branch-3.0)
[cherry-picked/branch-3.3](/apache/pulsar/labels/cherry-picked/branch-3.3)
[cherry-picked/branch-4.0](/apache/pulsar/labels/cherry-picked/branch-4.0)
labels
[Dec 13, 2024](#event-15648867328)

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)
[lhotari](/lhotari)
mentioned this pull request
[Dec 18, 2024](#ref-issue-2744759528)

[[Bug] Upgrade shaded org.asynchttpclient:async-http-client <3.0.1 due to CVE
#23745](/apache/pulsar/issues/23745)

Closed

3 tasks

[nikhil-ctds](/nikhil-ctds)
pushed a commit
to datastax/pulsar
that referenced
this pull request
[Dec 19, 2024](#ref-commit-105a598)
[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari) [![@nikhil-ctds](https://avatars.githubusercontent.com/u/151718832?s=40&v=4)](/nikhil-ctds)

`[[fix][sec] Mitigate](/datastax/pulsar/commit/105a598702f7c5e56354cbc1b0d3cb45953d6abc "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)
(cherry picked from commit 78274a7e90a3e4e1e204674f5bf76b0110a87a18)") [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") [by disabling AsyncHttpClient Cooki…](/datastax/pulsar/commit/105a598702f7c5e56354cbc1b0d3cb45953d6abc "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)
(cherry picked from commit 78274a7e90a3e4e1e204674f5bf76b0110a87a18)")`
…

`[105a598](/datastax/pulsar/commit/105a598702f7c5e56354cbc1b0d3cb45953d6abc)`

```
…eStore ([apache#23725](https://github.com/apache/pulsar/pull/23725))

(cherry picked from commit [51e8247](https://github.com/datastax/pulsar/commit/51e8247e497626eee3ff83056f7ca24acf4cf57a))
(cherry picked from commit [78274a7](https://github.com/datastax/pulsar/commit/78274a7e90a3e4e1e204674f5bf76b0110a87a18))
```

[srinath-ctds](/srinath-ctds)
pushed a commit
to datastax/pulsar
that referenced
this pull request
[Dec 23, 2024](#ref-commit-9bbbc22)
[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari) [![@srinath-ctds](https://avatars.githubusercontent.com/u/145680455?s=40&v=4)](/srinath-ctds)

`[[fix][sec] Mitigate](/datastax/pulsar/commit/9bbbc2264fb5c04d46245c6bcfb247ed59305002 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)
(cherry picked from commit 78274a7e90a3e4e1e204674f5bf76b0110a87a18)") [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") [by disabling AsyncHttpClient Cooki…](/datastax/pulsar/commit/9bbbc2264fb5c04d46245c6bcfb247ed59305002 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)
(cherry picked from commit 78274a7e90a3e4e1e204674f5bf76b0110a87a18)")`
…

`[9bbbc22](/datastax/pulsar/commit/9bbbc2264fb5c04d46245c6bcfb247ed59305002)`

```
…eStore ([apache#23725](https://github.com/apache/pulsar/pull/23725))

(cherry picked from commit [51e8247](https://github.com/datastax/pulsar/commit/51e8247e497626eee3ff83056f7ca24acf4cf57a))
(cherry picked from commit [78274a7](https://github.com/datastax/pulsar/commit/78274a7e90a3e4e1e204674f5bf76b0110a87a18))
```

[nodece](/nodece)
pushed a commit
to ascentstream/pulsar
that referenced
this pull request
[Dec 27, 2024](#ref-commit-1f7c296)
[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari) [![@nodece](https://avatars.githubusercontent.com/u/16235121?s=40&v=4)](/nodece)

`[[fix][sec] Mitigate](/ascentstream/pulsar/commit/1f7c2960f055146e5986516a9a5adf7e7d4d8e37 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)
Signed-off-by: Zixuan Liu <nodeces@gmail.com>") [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") [by disabling AsyncHttpClient Cooki…](/ascentstream/pulsar/commit/1f7c2960f055146e5986516a9a5adf7e7d4d8e37 "[fix][sec] Mitigate CVE-2024-53990 by disabling AsyncHttpClient CookieStore (#23725)

(cherry picked from commit 51e8247e497626eee3ff83056f7ca24acf4cf57a)
Signed-off-by: Zixuan Liu <nodeces@gmail.com>")`
…

`[1f7c296](/ascentstream/pulsar/commit/1f7c2960f055146e5986516a9a5adf7e7d4d8e37)`

```
…eStore ([apache#23725](https://github.com/apache/pulsar/pull/23725))

(cherry picked from commit [51e8247](https://github.com/ascentstream/pulsar/commit/51e8247e497626eee3ff83056f7ca24acf4cf57a))
Signed-off-by: Zixuan Liu <nodeces@gmail.com>
```

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fpulsar%2Fpull%2F23725)

Reviewers

[![@nodece](https://avatars.githubusercontent.com/u/16235121?s=40&v=4)](/nodece) [nodece](/nodece)

nodece approved these changes

[![@merlimat](https://avatars.githubusercontent.com/u/62500?s=40&v=4)](/merlimat) [merlimat](/merlimat)

 Awaiting requested review from merlimat

[![@Technoboy-](https://avatars.githubusercontent.com/u/6297296?s=40&v=4)](/Technoboy-) [Technoboy-](/Technoboy-)

 Awaiting requested review from Technoboy-

[![@nicoloboschi](https://avatars.githubusercontent.com/u/23314389?s=40&v=4)](/nicoloboschi) [nicoloboschi](/nicoloboschi)

 Awaiting requested review from nicoloboschi

Assignees

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=40&v=4)](/lhotari) [lhotari](/lhotari)

Labels

[cherry-picked/branch-3.0](/apache/pulsar/labels/cherry-picked/branch-3.0)
[cherry-picked/branch-3.3](/apache/pulsar/labels/cherry-picked/branch-3.3)
[cherry-picked/branch-4.0](/apache/pulsar/labels/cherry-picked/branch-4.0)
[doc-not-needed](/apache/pulsar/labels/doc-not-needed)
Your PR changes do not impact docs
[ready-to-test](/apache/pulsar/labels/ready-to-test)
[release/3.0.9](/apache/pulsar/labels/release/3.0.9)
[release/3.3.4](/apache/pulsar/labels/release/3.3.4)
[release/4.0.2](/apache/pulsar/labels/release/4.0.2)

Projects

None yet

Milestone

 [**4.1.0**](/apache/pulsar/milestone/40 "4.1.0")

Development

Successfully merging this pull request may close these issues.

3 participants

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=52&v=4)](/lhotari) [![@codecov-commenter](https://avatars.githubusercontent.com/u/65553080?s=52&v=4)](/codecov-commenter) [![@nodece](https://avatars.githubusercontent.com/u/16235121?s=52&v=4)](/nodece)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c23b40a3_20250114_184709.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fissues%2F1964)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fissues%2F1964)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=AsyncHttpClient%2Fasync-http-client)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[AsyncHttpClient](/AsyncHttpClient)
/
**[async-http-client](/AsyncHttpClient/async-http-client)**
Public

* [Notifications](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)
* [Star
   6.3k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)

* [Code](/AsyncHttpClient/async-http-client)
* [Issues
  96](/AsyncHttpClient/async-http-client/issues)
* [Pull requests
  18](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects
  0](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

Additional navigation options

* [Code](/AsyncHttpClient/async-http-client)
* [Issues](/AsyncHttpClient/async-http-client/issues)
* [Pull requests](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FAsyncHttpClient%2Fasync-http-client%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Cookie explicitly set on the request is getting discarded in favor of the one from the cookie jar #1964

Closed

[Spikhalskiy](/Spikhalskiy) opened this issue
Jun 17, 2024
· 3 comments
 · Fixed by [#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033)

Closed

# [Cookie explicitly set on the request is getting discarded in favor of the one from the cookie jar](#top) #1964

[Spikhalskiy](/Spikhalskiy) opened this issue
Jun 17, 2024
· 3 comments
 · Fixed by [#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033)

## Comments

[![@Spikhalskiy](https://avatars.githubusercontent.com/u/532108?s=80&u=2464983638afea8caf4cd9f0e4a7bc3e6a63bb0a&v=4)](/Spikhalskiy)

Copy link

Contributor

### **[Spikhalskiy](/Spikhalskiy)** commented [Jun 17, 2024](#issue-2358271765) • edited Loading

| Expected Behavior A cookie explicitly specified on a RequestBuilder should take precedence over a cookie stored in cookie jar. Actual Behavior ``` cookieStore = httpClient.getCookieStore(); cookieStore.add("some_url", new DefaultCookie("name", "value1")); BoundRequestBuilder requestBuilder = httpClient.prepareGet("some_url"); requestBuilder.addCookie(new DefaultCookie("name", "value2")); httpClient.executeRequest(requestBuilder.build())  ```  This code leads to a request being performed with cookie "name":"value1", which is not what is expected by a user when a user explicitly sets a cookie on a `RequestBuilder`. Root cause Cookies from cookie jar [are overriding cookies coming from the RequestBuilder here](https://github.com/AsyncHttpClient/async-http-client/blob/2200b2477c84d2517fcbdf5d42f71d459c09066f/client/src/main/java/org/asynchttpclient/DefaultAsyncHttpClient.java#L238) Affected version 2.12.3, 3.0 pre-releases |
| --- |
| The text was updated successfully, but these errors were encountered: |

 👍
2
 s-nel and pickypg reacted with thumbs up emoji
 👀
2
 RussiaVk and pickypg reacted with eyes emoji

All reactions

* 👍
  2 reactions
* 👀
  2 reactions

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=80&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)

Copy link

Contributor

### **[pickypg](/pickypg)** commented [Nov 13, 2024](#issuecomment-2474930032) • edited Loading

| The supplied link puts the commit hash in the wrong place, but the root cause is that it blindly overrides Cookies by using `addOrReplaceCookie(cookie)` from the `CookieStore`, but it should only be using `addCookie(cookie)`, which is even then dangerous if it's duplicating.  <https://github.com/AsyncHttpClient/async-http-client/blob/661ec72/client/src/main/java/org/asynchttpclient/DefaultAsyncHttpClient.java#L238> |
| --- |

 👍
2
 Spikhalskiy and s-nel reacted with thumbs up emoji

All reactions

* 👍
  2 reactions

Sorry, something went wrong.

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)
[pickypg](/pickypg)
mentioned this issue
[Nov 14, 2024](#ref-pullrequest-2659545791)

[[CookieStore] Only set `Cookie`s if they are not already set
#2033](/AsyncHttpClient/async-http-client/pull/2033)
 Merged

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=80&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)

Copy link

Contributor

### **[pickypg](/pickypg)** commented [Nov 14, 2024](#issuecomment-2477345958)

| I've added a PR that only uses `Cookie`s from the `CookieStore` if they're unset.  [#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033) |
| --- |

All reactions

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)
[hyperxpro](/hyperxpro)
closed this as [completed](/AsyncHttpClient/async-http-client/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#2033](/AsyncHttpClient/async-http-client/pull/2033)
[Dec 1, 2024](#event-15485097034)

[hyperxpro](/hyperxpro)
added a commit
that referenced
this issue
[Dec 1, 2024](#ref-commit-d5a8336)
[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg) [![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

`[[CookieStore] Only set](/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425 "[CookieStore] Only set `Cookie`s if they are not already set (#2033)

This changes the behavior of the automatic usage of the `CookieStore` to
avoid overwriting already-set `Cookie`s and, instead only sets them if
they do not exist yet.

Closes https://github.com/AsyncHttpClient/async-http-client/issues/1964

Co-authored-by: Aayush Atharva <aayush@shieldblaze.com>") [Cookie](/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425 "[CookieStore] Only set `Cookie`s if they are not already set (#2033)

This changes the behavior of the automatic usage of the `CookieStore` to
avoid overwriting already-set `Cookie`s and, instead only sets them if
they do not exist yet.

Closes https://github.com/AsyncHttpClient/async-http-client/issues/1964

Co-authored-by: Aayush Atharva <aayush@shieldblaze.com>")[s if they are not already set (](/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425 "[CookieStore] Only set `Cookie`s if they are not already set (#2033)

This changes the behavior of the automatic usage of the `CookieStore` to
avoid overwriting already-set `Cookie`s and, instead only sets them if
they do not exist yet.

Closes https://github.com/AsyncHttpClient/async-http-client/issues/1964

Co-authored-by: Aayush Atharva <aayush@shieldblaze.com>")[#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033)[)](/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425 "[CookieStore] Only set `Cookie`s if they are not already set (#2033)

This changes the behavior of the automatic usage of the `CookieStore` to
avoid overwriting already-set `Cookie`s and, instead only sets them if
they do not exist yet.

Closes https://github.com/AsyncHttpClient/async-http-client/issues/1964

Co-authored-by: Aayush Atharva <aayush@shieldblaze.com>")`
…

`[d5a8336](/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425)`

```
This changes the behavior of the automatic usage of the `CookieStore` to
avoid overwriting already-set `Cookie`s and, instead only sets them if
they do not exist yet.

Closes [#1964](https://github.com/AsyncHttpClient/async-http-client/issues/1964)

Co-authored-by: Aayush Atharva <aayush@shieldblaze.com>
```

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=80&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)

Copy link

Contributor

### **[pickypg](/pickypg)** commented [Dec 2, 2024](#issuecomment-2512636544)

| As a note, you can workaround this issue -- if you don't actually want the `CookieStore` -- by disabling it upon client creation:  ``` DefaultAsyncHttpClientConfig.Builder clientBuilder = Dsl.config()     .setCookieStore(null) ``` |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fissues%2F1964)

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [[CookieStore] Only set `Cookie`s if they are not already set](/AsyncHttpClient/async-http-client/pull/2033)
 [pickypg/async-http-client](/pickypg/async-http-client)

2 participants

[![@Spikhalskiy](https://avatars.githubusercontent.com/u/532108?s=52&v=4)](/Spikhalskiy) [![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=52&v=4)](/pickypg)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e4b1618c_20250115_113128.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperxpro)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperxpro)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=64&v=4)

**hyperxpro**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperxpro)

[Overview](/hyperxpro)
[Repositories
37](/hyperxpro?tab=repositories)
[Projects
0](/hyperxpro?tab=projects)
[Packages
13](/hyperxpro?tab=packages)
[Stars
59](/hyperxpro?tab=stars)

More

* [Overview](/hyperxpro)
* [Repositories](/hyperxpro?tab=repositories)
* [Projects](/hyperxpro?tab=projects)
* [Packages](/hyperxpro?tab=packages)
* [Stars](/hyperxpro?tab=stars)

![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=64&v=4)

**hyperxpro**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperxpro)

[![View hyperxpro's full-sized avatar](https://avatars.githubusercontent.com/u/24762260?v=4)](https://avatars.githubusercontent.com/u/24762260?v=4)
🙃

# Aayush Atharva hyperxpro

🙃

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fhyperxpro)

 [Sponsor](/sponsors/hyperxpro)

[47
followers](https://github.com/hyperxpro?tab=followers) · [1
following](https://github.com/hyperxpro?tab=following)

* [@shieldblaze](https://github.com/shieldblaze)
* New Delhi, India
* 17:01
  (UTC +05:30)
* X
  [@HyperXPro](https://twitter.com/HyperXPro)

## [Achievements](/hyperxpro?tab=achievements)

[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x3](/hyperxpro?achievement=pair-extraordinaire&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/hyperxpro?achievement=yolo&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default--light-8f798b35341a.png)](/hyperxpro?achievement=quickdraw&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default--light-a594e2a027e0.png)](/hyperxpro?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/hyperxpro?achievement=pull-shark&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/hyperxpro?achievement=arctic-code-vault-contributor&tab=achievements)
## [Achievements](/hyperxpro?tab=achievements)

[![Achievement: Pair Extraordinaire](https://github.githubassets.com/assets/pair-extraordinaire-default-579438a20e01.png)x3](/hyperxpro?achievement=pair-extraordinaire&tab=achievements)[![Achievement: YOLO](https://github.githubassets.com/assets/yolo-default-be0bbff04951.png)](/hyperxpro?achievement=yolo&tab=achievements)[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default--light-8f798b35341a.png)](/hyperxpro?achievement=quickdraw&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default--light-a594e2a027e0.png)](/hyperxpro?achievement=starstruck&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)x3](/hyperxpro?achievement=pull-shark&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/hyperxpro?achievement=arctic-code-vault-contributor&tab=achievements)
## Highlights

* [Developer Program Member](https://docs.github.com/developers/overview/github-developer-program)
* Pro

## Organizations

[![@AsyncHttpClient](https://avatars.githubusercontent.com/u/381412?s=64&v=4)](/AsyncHttpClient) [![@shieldblaze](https://avatars.githubusercontent.com/u/45304529?s=64&v=4)](/shieldblaze) [![@netty-contrib](https://avatars.githubusercontent.com/u/94126747?s=64&v=4)](/netty-contrib) [![@SecWrk](https://avatars.githubusercontent.com/u/107905121?s=64&v=4)](/SecWrk)

Block or Report

# Block or report hyperxpro

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=hyperxpro+%28user%29)

[Overview](/hyperxpro)
[Repositories
37](/hyperxpro?tab=repositories)
[Projects
0](/hyperxpro?tab=projects)
[Packages
13](/hyperxpro?tab=packages)
[Stars
59](/hyperxpro?tab=stars)

More

* [Overview](/hyperxpro)
* [Repositories](/hyperxpro?tab=repositories)
* [Projects](/hyperxpro?tab=projects)
* [Packages](/hyperxpro?tab=packages)
* [Stars](/hyperxpro?tab=stars)

## Pinned Loading

1. [netty/netty](/netty/netty) netty/netty Public

   Netty project - an event-driven asynchronous network application framework

   Java

   [33.7k](/netty/netty/stargazers)
   [16k](/netty/netty/forks)
2. [shieldblaze/ExpressGateway](/shieldblaze/ExpressGateway) shieldblaze/ExpressGateway Public

   ShieldBlaze ExpressGateway is a High-Performance, Scalable, and Highly-Available Load Balancer.

   Java

   [11](/shieldblaze/ExpressGateway/stargazers)
   [5](/shieldblaze/ExpressGateway/forks)
3. [Brotli4j](/hyperxpro/Brotli4j) Brotli4j Public

   Brotli4j provides Brotli compression and decompression for Java.

   Java

   [116](/hyperxpro/Brotli4j/stargazers)
   [38](/hyperxpro/Brotli4j/forks)
4. [AsyncHttpClient/async-http-client](/AsyncHttpClient/async-http-client) AsyncHttpClient/async-http-client Public

   Asynchronous Http and WebSocket Client library for Java

   Java

   [6.3k](/AsyncHttpClient/async-http-client/stargazers)
   [1.6k](/AsyncHttpClient/async-http-client/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_0cb49385_20250114_184712.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fsecurity%2Fadvisories%2FGHSA-mfj5-cf8g-g2fv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fsecurity%2Fadvisories%2FGHSA-mfj5-cf8g-g2fv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=AsyncHttpClient%2Fasync-http-client)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[AsyncHttpClient](/AsyncHttpClient)
/
**[async-http-client](/AsyncHttpClient/async-http-client)**
Public

* [Notifications](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)
* [Star
   6.3k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)

* [Code](/AsyncHttpClient/async-http-client)
* [Issues
  96](/AsyncHttpClient/async-http-client/issues)
* [Pull requests
  18](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects
  0](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

Additional navigation options

* [Code](/AsyncHttpClient/async-http-client)
* [Issues](/AsyncHttpClient/async-http-client/issues)
* [Pull requests](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

# `CookieStore` replaces explicitly defined `Cookie`s

Critical

[hyperxpro](/hyperxpro)
published
GHSA-mfj5-cf8g-g2fv
Dec 2, 2024

## Package

maven

org.asynchttpclient:async-http-client
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

3.0.0

## Patched versions

3.0.1

## Description

### Summary

When making any HTTP request, the automatically enabled and self-managed `CookieStore` (aka cookie jar) will silently replace explicitly defined `Cookie`s with any that have the same name from the cookie jar. For services that operate with multiple users, this can result in one user's `Cookie` being used for another user's requests.

### Details

This issue is described without security warnings here:

[#1964](https://github.com/AsyncHttpClient/async-http-client/issues/1964)

I already have a PR to fix this issue:

[#2033](https://github.com/AsyncHttpClient/async-http-client/pull/2033)

### PoC

1. Add an auth `Cookie` to the `CookieStore`
   * This is identical to receiving an HTTP response that uses `Set-Cookie`, as shown in issue [#1964](https://github.com/AsyncHttpClient/async-http-client/issues/1964) above.
2. Handle a different user's request where the same `Cookie` is provided as a passthrough, like a JWT, and attempt to use it by explicitly providing it.
3. Observe that the user's cookie in step 2 is passed as the Cookie in step 1.

### Impact

This is generally going to be a problem for developers of backend services that implement third party auth features and use other features like token refresh. The moment a third party service responds by *setting* a cookie in the response, the `CookieStore` will effectively break almost every follow-up request (hopefully by being rejected, but possibly by revealing a different user's information).

If your service sets cookies based on the response that happens here, it's possible to lead to even greater levels of exposure.

### Severity

Critical

### CVE ID

CVE-2024-53990

### Weaknesses

No CWEs

### Credits

* [![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&v=4)](/pickypg)
  [pickypg](/pickypg)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_505b9e31_20250114_184712.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fpull%2F2033)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fpull%2F2033)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=AsyncHttpClient%2Fasync-http-client)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[AsyncHttpClient](/AsyncHttpClient)
/
**[async-http-client](/AsyncHttpClient/async-http-client)**
Public

* [Notifications](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)
* [Star
   6.3k](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client)

* [Code](/AsyncHttpClient/async-http-client)
* [Issues
  96](/AsyncHttpClient/async-http-client/issues)
* [Pull requests
  18](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects
  0](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

Additional navigation options

* [Code](/AsyncHttpClient/async-http-client)
* [Issues](/AsyncHttpClient/async-http-client/issues)
* [Pull requests](/AsyncHttpClient/async-http-client/pulls)
* [Discussions](/AsyncHttpClient/async-http-client/discussions)
* [Actions](/AsyncHttpClient/async-http-client/actions)
* [Projects](/AsyncHttpClient/async-http-client/projects)
* [Wiki](/AsyncHttpClient/async-http-client/wiki)
* [Security](/AsyncHttpClient/async-http-client/security)
* [Insights](/AsyncHttpClient/async-http-client/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FAsyncHttpClient%2Fasync-http-client%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FAsyncHttpClient%2Fasync-http-client%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# [CookieStore] Only set `Cookie`s if they are not already set #2033

 Merged

[hyperxpro](/hyperxpro)
merged 3 commits into
[AsyncHttpClient:main](/AsyncHttpClient/async-http-client/tree/main "AsyncHttpClient/async-http-client:main")
from
[pickypg:cookie-store-only-add-unset-cookies](/pickypg/async-http-client/tree/cookie-store-only-add-unset-cookies "pickypg/async-http-client:cookie-store-only-add-unset-cookies")

Dec 1, 2024

 Merged

# [[CookieStore] Only set `Cookie`s if they are not already set](#top) #2033

[hyperxpro](/hyperxpro)
merged 3 commits into
[AsyncHttpClient:main](/AsyncHttpClient/async-http-client/tree/main "AsyncHttpClient/async-http-client:main")
from
[pickypg:cookie-store-only-add-unset-cookies](/pickypg/async-http-client/tree/cookie-store-only-add-unset-cookies "pickypg/async-http-client:cookie-store-only-add-unset-cookies")

Dec 1, 2024

+55

−9

[Conversation
20](/AsyncHttpClient/async-http-client/pull/2033)
[Commits
3](/AsyncHttpClient/async-http-client/pull/2033/commits)
[Checks
3](/AsyncHttpClient/async-http-client/pull/2033/checks)
[Files changed
4](/AsyncHttpClient/async-http-client/pull/2033/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![pickypg](https://avatars.githubusercontent.com/u/1501235?s=60&v=4)](/pickypg)

Copy link

Contributor

### @pickypg **[pickypg](/pickypg)** commented [Nov 14, 2024](#issue-2659545791)

This changes the behavior of the automatic usage of the `CookieStore` to avoid overwriting already-set `Cookie`s and, instead only sets them if they do not exist yet.

Closes [#1964](https://github.com/AsyncHttpClient/async-http-client/issues/1964)

Sorry, something went wrong.

All reactions

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&v=4)](/pickypg)

`[[CookieStore] Only set Cookies if they are not already set](/AsyncHttpClient/async-http-client/pull/2033/commits/1cc44f8ab339c1ad225b9e3d814332e9d784732f "[CookieStore] Only set `Cookie`s if they are not already set

This changes the behavior of the automatic usage of the
`CookieStore` to avoid overwriting already-set `Cookie`s and,
instead only sets them if they do not exist yet.")`
 …

`[1cc44f8](/AsyncHttpClient/async-http-client/pull/2033/commits/1cc44f8ab339c1ad225b9e3d814332e9d784732f)`

```
This changes the behavior of the automatic usage of the
`CookieStore` to avoid overwriting already-set `Cookie`s and,
instead only sets them if they do not exist yet.
```

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)
[pickypg](/pickypg)
mentioned this pull request
[Nov 14, 2024](#ref-issue-2358271765)

[Cookie explicitly set on the request is getting discarded in favor of the one from the cookie jar
#1964](/AsyncHttpClient/async-http-client/issues/1964)

Closed

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Nov 14, 2024](#issuecomment-2477370005)

| I'll take a look this weekend. |
| --- |

 ❤️
1
 pickypg reacted with heart emoji

All reactions

* ❤️
  1 reaction

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Nov 16, 2024](#issuecomment-2480756809)

| Sadly this is a breaking change. `RequestBuilderBase` is an abstract class and adding anything will break compatibility. Perhaps, you might want to take a different approach. |
| --- |

All reactions

Sorry, something went wrong.

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=80&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)

Copy link

Contributor

Author

### **[pickypg](/pickypg)** commented [Nov 16, 2024](#issuecomment-2480757563)

| I'm happy to if you have a suggestion? The current functionality is buggy given that it overrides explicitly provided cookies. |
| --- |

All reactions

Sorry, something went wrong.

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&v=4)](/pickypg)

`[Merge branch 'main' into cookie-store-only-add-unset-cookies](/AsyncHttpClient/async-http-client/pull/2033/commits/5ac6d1a92e2e065c2831a527d4ad61e0c888f331 "Merge branch 'main' into cookie-store-only-add-unset-cookies")`

`[5ac6d1a](/AsyncHttpClient/async-http-client/pull/2033/commits/5ac6d1a92e2e065c2831a527d4ad61e0c888f331)`

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Nov 20, 2024](#issuecomment-2489287011)

| Let me try something |
| --- |

All reactions

Sorry, something went wrong.

 [![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)
[hyperxpro](/hyperxpro)
requested a review
from [Copilot](/apps/copilot-pull-request-reviewer)
[November 23, 2024 16:51](#event-15408152470)

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Nov 23, 2024](#issuecomment-2495538439)

| I'd say change this directly in `RequestBuilder`. People extending `RequestBuilderBase` will be safe from this breaking change. |
| --- |

All reactions

Sorry, something went wrong.

[![Copilot](https://avatars.githubusercontent.com/in/946600?s=60&v=4)](/apps/copilot-pull-request-reviewer)

**[Copilot](/apps/copilot-pull-request-reviewer)
AI**
reviewed
[Nov 23, 2024](#pullrequestreview-2456440330)

 [View reviewed changes](/AsyncHttpClient/async-http-client/pull/2033/files/5ac6d1a92e2e065c2831a527d4ad61e0c888f331)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Copilot reviewed 4 out of 4 changed files in this pull request and generated no suggestions.

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=80&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)

Copy link

Contributor

Author

### **[pickypg](/pickypg)** commented [Nov 23, 2024](#issuecomment-2495538797)

| That's doable, but this breaking change is clearly necessary. |
| --- |

All reactions

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Nov 23, 2024](#issuecomment-2495539408)

| Yup, I do feel this but as a library maintainer, I cannot. I am at fault, I should have made that as `interface`. But doing with directly changing should be best because people extending `RequestBuilderBase` should always take extra care of their custom implementations. |
| --- |

All reactions

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Nov 23, 2024](#issuecomment-2495539473)

| Fire this up so I can merge and cut a release. |
| --- |

All reactions

Sorry, something went wrong.

[![hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=60&v=4)](/hyperxpro)

**[hyperxpro](/hyperxpro)**
approved these changes
[Nov 29, 2024](#pullrequestreview-2470433203)

 [View reviewed changes](/AsyncHttpClient/async-http-client/pull/2033/files/a487cd07083497742d9a7cba9895b8e8eac5c0a7)

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&v=4)](/hyperxpro)

`[Merge branch 'main' into cookie-store-only-add-unset-cookies](/AsyncHttpClient/async-http-client/pull/2033/commits/a487cd07083497742d9a7cba9895b8e8eac5c0a7 "Merge branch 'main' into cookie-store-only-add-unset-cookies")`

`[a487cd0](/AsyncHttpClient/async-http-client/pull/2033/commits/a487cd07083497742d9a7cba9895b8e8eac5c0a7)`

 Hide details
View details

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)
[hyperxpro](/hyperxpro)
merged commit [`d5a8336`](/AsyncHttpClient/async-http-client/commit/d5a83362f7aed81b93ebca559746ac9be0f95425)
into
AsyncHttpClient:main

[Dec 1, 2024](https://github.com/AsyncHttpClient/async-http-client/pull/2033#event-15485096998)
3 checks passed

 [![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)
[pickypg](/pickypg)
deleted the
cookie-store-only-add-unset-cookies

branch
[December 2, 2024 15:08](#event-15494562056)

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=80&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)

Copy link

### **[lhotari](/lhotari)** commented [Dec 13, 2024](#issuecomment-2541330573)

| Is there any way to backport this to 2.12.x to maintain Java 8 support?  We use AsyncHttpClient 2.12.x in the Apache Pulsar Admin client. Our challenge in Apache Pulsar is that the minimum Java requirement for clients is Java 8. Since AsyncHttpClient 3.0.x requires Java 11, we don't have a way to eliminate [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") from our dependencies. While it's possible to set the `CookieStore` to `null` in AHC 2.12.x (as we're doing in [apache/pulsar#23725](https://github.com/apache/pulsar/pull/23725)), the main issue for Apache Pulsar is that many users have security policies requiring the elimination of dependencies with high or critical vulnerabilities. Therefore, configuring the CookieStore isn't a sufficient mitigation for many of our users.  Any suggestions and recommendations for solving our use case in Apache Pulsar would be much appreciated. |
| --- |

 👍
1
 aidandempsey reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Dec 15, 2024](#issuecomment-2543985990)

| [@lhotari](https://github.com/lhotari) Sure, yes. I will push the emergency release for 2.12.x. |
| --- |

All reactions

Sorry, something went wrong.

[![@lhotari](https://avatars.githubusercontent.com/u/66864?s=80&u=bd0eeaff8102a33cead8c91a80312e35b455ae2e&v=4)](/lhotari)

Copy link

### **[lhotari](/lhotari)** commented [Dec 15, 2024](#issuecomment-2543991689) • edited Loading

| [@lhotari](https://github.com/lhotari) Sure, yes. I will push the emergency release for 2.12.x.  Thank you, [@hyperxpro](https://github.com/hyperxpro). After the release, it would be great to have [CVE-2024-53990](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "CVE-2024-53990") updated so that it would enlist the new release clear of the vulnerability so that vulnerability scanners would have the information too. |
| --- |

All reactions

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Dec 15, 2024](#issuecomment-2544009259)

| Released 2.12.4; it will sync to Maven Central in some time :)  [@pickypg](https://github.com/pickypg) Can you do PR in the advisory database to exclude 2.12.4? |
| --- |

 🎉
2
 lhotari and He-Pin reacted with hooray emoji

All reactions

* 🎉
  2 reactions

Sorry, something went wrong.

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=80&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)

Copy link

Contributor

Author

### **[pickypg](/pickypg)** commented [Dec 15, 2024](#issuecomment-2544009865)

| Can do! |
| --- |

 ❤️
3
 hyperxpro, lhotari, and AlvaroStream reacted with heart emoji

All reactions

* ❤️
  3 reactions

Sorry, something went wrong.

[![@xuwei-k](https://avatars.githubusercontent.com/u/389787?s=80&u=22e5eca939aaa26cb191c9ec03b328945f97c8ac&v=4)](/xuwei-k)

Copy link

### **[xuwei-k](/xuwei-k)** commented [Dec 16, 2024](#issuecomment-2544414658)

| missing 2.12.4 tag on GitHub? 👀 |
| --- |

 👀
1
 fmulero reacted with eyes emoji

All reactions

* 👀
  1 reaction

Sorry, something went wrong.

[![@xuwei-k](https://avatars.githubusercontent.com/u/389787?s=40&u=22e5eca939aaa26cb191c9ec03b328945f97c8ac&v=4)](/xuwei-k)
[xuwei-k](/xuwei-k)
mentioned this pull request
[Dec 16, 2024](#ref-pullrequest-2740934938)

[[3.0.x] update async-http-client to 2.12.4
playframework/play-ws#968](/playframework/play-ws/pull/968)
 Open

6 tasks

[![@aidandempsey](https://avatars.githubusercontent.com/u/111794971?s=80&v=4)](/aidandempsey)

Copy link

### **[aidandempsey](/aidandempsey)** commented [Dec 16, 2024](#issuecomment-2546251658)

| [@hyperxpro](https://github.com/hyperxpro) Thanks for the fix, is there any chance this will be back ported to `2.12.3`? Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Dec 16, 2024](#issuecomment-2546322992)

| [@hyperxpro](https://github.com/hyperxpro) Thanks for the fix, is there any chance this will be back ported to `2.12.3`? Thanks!  2.12.4 is out |
| --- |

 🎉
1
 aidandempsey reacted with hooray emoji

All reactions

* 🎉
  1 reaction

Sorry, something went wrong.

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=80&u=09d40986a37a05913dbe729e7504dea324eaf685&v=4)](/hyperxpro)

Copy link

Member

### **[hyperxpro](/hyperxpro)** commented [Dec 16, 2024](#issuecomment-2546324546)

| missing 2.12.4 tag on GitHub? 👀  Added `async-http-client-project-2.12.4` |
| --- |

All reactions

Sorry, something went wrong.

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=40&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)
[pickypg](/pickypg)
mentioned this pull request
[Dec 16, 2024](#ref-pullrequest-2743543489)

[[GHSA-mfj5-cf8g-g2fv] AsyncHttpClient (AHC) library's `CookieStore` replaces explicitly defined `Cookie`s
github/advisory-database#5089](/github/advisory-database/pull/5089)
 Merged

[![@xuwei-k](https://avatars.githubusercontent.com/u/389787?s=80&u=22e5eca939aaa26cb191c9ec03b328945f97c8ac&v=4)](/xuwei-k)

Copy link

### **[xuwei-k](/xuwei-k)** commented [Dec 16, 2024](#issuecomment-2547039478) • edited Loading

| thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=80&u=478675fa978ba5313d83b1cd4ca6b347634f8ba3&v=4)](/pickypg)

Copy link

Contributor

Author

### **[pickypg](/pickypg)** commented [Dec 16, 2024](#issuecomment-2547046512)

| Updated the GitHub Advisory: [GHSA-mfj5-cf8g-g2fv](https://github.com/advisories/GHSA-mfj5-cf8g-g2fv "GHSA-mfj5-cf8g-g2fv") |
| --- |

All reactions

Sorry, something went wrong.

[![@coffius](https://avatars.githubusercontent.com/u/2510890?s=40&v=4)](/coffius)
[coffius](/coffius)
mentioned this pull request
[Dec 30, 2024](#ref-issue-2762949658)

[Security vulnerability in `async-http-client:2.12.3`
softwaremill/sttp#2382](/softwaremill/sttp/issues/2382)

Closed

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FAsyncHttpClient%2Fasync-http-client%2Fpull%2F2033)

Reviewers

 [Copilot](/apps/copilot-pull-request-reviewer)

Copilot left review comments

[![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=40&v=4)](/hyperxpro) [hyperxpro](/hyperxpro)

hyperxpro approved these changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

 [Cookie explicitly set on the request is getting discarded in favor of the one from the cookie jar](https://github.com/AsyncHttpClient/async-http-client/issues/1964)

5 participants

[![@pickypg](https://avatars.githubusercontent.com/u/1501235?s=52&v=4)](/pickypg) [![@hyperxpro](https://avatars.githubusercontent.com/u/24762260?s=52&v=4)](/hyperxpro) [![@lhotari](https://avatars.githubusercontent.com/u/66864?s=52&v=4)](/lhotari) [![@xuwei-k](https://avatars.githubusercontent.com/u/389787?s=52&v=4)](/xuwei-k) [![@aidandempsey](https://avatars.githubusercontent.com/u/111794971?s=52&v=4)](/aidandempsey)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


