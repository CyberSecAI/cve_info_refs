- **Root cause of vulnerability:** The default configuration of home-gallery lacks TLS and user authentication, making it susceptible to DNS rebinding attacks. Additionally, a broad CORS policy allows cross-site requests.
- **Weaknesses/vulnerabilities present:**
    - **DNS rebinding:** The application does not validate the host header or implement proper authentication mechanisms, allowing an attacker to redirect DNS resolution to an internal IP address and access the application.
    - **Open CORS policy:** The application uses `cors()` middleware without specific origin restrictions, allowing any website to make cross-site requests.
- **Impact of exploitation:**
    - **DNS rebinding:** Information Disclosure. An attacker can leak photos from home-gallery instances located on the same intranet as the victim.
    - **Open CORS policy:** Information Disclosure (in rare cases). An attacker might be able to view images if they obtain the randomized path, and future sensitive information may become accessible if new static files/endpoints are introduced.
- **Attack vectors:**
    - **DNS rebinding:** The attacker hosts a website. When a user visits this website, a script changes the DNS record of the attacker's domain to the internal IP address of the home-gallery instance. An iframe on the attacker's website then loads the home-gallery page, allowing the attacker to extract data through the iframe's content.
    - **Open CORS policy:** The attacker can make cross-site requests from a malicious website to the home-gallery instance to potentially access resources.
- **Required attacker capabilities/position:**
    - **DNS rebinding:** The attacker needs to be able to host a website and change the DNS records of their domain. The victim must visit the attacker's website. The home-gallery instance must be on the same network as the victim.
    - **Open CORS policy:** The attacker needs to host a website and convince a user to visit it, or be able to inject script onto a website visited by the user. The home-gallery instance must be accessible from the user's browser.