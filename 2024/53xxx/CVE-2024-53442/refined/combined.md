=== Content from 1d8.github.io_7f6dcdc2_20250114_191548.html ===

[skip to content](#main)

W3C
SVG

[![Logo No Loado](/images/logo.svg)](https://1d8.github.io/)

The blog of a curious cybersecurity collegiate

## Main navigation

Menu

* [Cheatsheets](/cheatsheets/)
* [CVEs](/cves/)
* [Publications](/publications/)
* [Writeups/Walkthroughs](/writeups/)

# CVE-2024-53442 - Command Injection on Whapa

# Command Injection - Opening HTML Report Functionality

Repository URL: <https://github.com/B16f00t/whapa/tree/master>
Code URL: <https://github.com/B16f00t/whapa/blob/master/whapa-gui.py#L787>

```
def report(self):
        """Open the report"""

        self.path = filedialog.askopenfilename(title="Select file", filetypes=(("html files", "*.html"), ), initialdir = "report")
        if not self.path:
            return

        if system == "Linux":
            os.system('xdg-open "{}"'.format(self.path))
        else:
            os.startfile(self.path)

```

When opening HTML reports within Whapa, a specially crafted filename could be used to gain command injection on Linux systems due to how the filename is immediately passed to `os.system(xdg-open <filename>)` without sanitization.

## Proof of Concept

A specially crafted filename can be created via the following command: `touch 'report"; touch exploit.txt; ".html'`. Then within Whapa, select *Open Report* & open up the file we just created. After erroring out, our `exploit.txt` file will then be created.

dark theme:

Checkout my [Github!](https://github.com/1d8)



=== Content from github.com_1e8e2c8a_20250114_191549.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FB16f00t%2Fwhapa)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FB16f00t%2Fwhapa)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=B16f00t%2Fwhapa)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[B16f00t](/B16f00t)
/
**[whapa](/B16f00t/whapa)**
Public

* [Notifications](/login?return_to=%2FB16f00t%2Fwhapa) You must be signed in to change notification settings
* [Fork
  269](/login?return_to=%2FB16f00t%2Fwhapa)
* [Star
   1.2k](/login?return_to=%2FB16f00t%2Fwhapa)

WhatsApp Parser Toolset v1.59

[1.2k
stars](/B16f00t/whapa/stargazers) [269
forks](/B16f00t/whapa/forks) [Branches](/B16f00t/whapa/branches) [Tags](/B16f00t/whapa/tags) [Activity](/B16f00t/whapa/activity)
 [Star](/login?return_to=%2FB16f00t%2Fwhapa)

 [Notifications](/login?return_to=%2FB16f00t%2Fwhapa) You must be signed in to change notification settings

* [Code](/B16f00t/whapa)
* [Issues
  51](/B16f00t/whapa/issues)
* [Pull requests
  0](/B16f00t/whapa/pulls)
* [Actions](/B16f00t/whapa/actions)
* [Projects
  0](/B16f00t/whapa/projects)
* [Security](/B16f00t/whapa/security)
* [Insights](/B16f00t/whapa/pulse)

Additional navigation options

* [Code](/B16f00t/whapa)
* [Issues](/B16f00t/whapa/issues)
* [Pull requests](/B16f00t/whapa/pulls)
* [Actions](/B16f00t/whapa/actions)
* [Projects](/B16f00t/whapa/projects)
* [Security](/B16f00t/whapa/security)
* [Insights](/B16f00t/whapa/pulse)

# B16f00t/whapa

    master[Branches](/B16f00t/whapa/branches)[Tags](/B16f00t/whapa/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[379 Commits](/B16f00t/whapa/commits/master/) | | |
| [cfg](/B16f00t/whapa/tree/master/cfg "cfg") | | [cfg](/B16f00t/whapa/tree/master/cfg "cfg") |  |  |
| [doc](/B16f00t/whapa/tree/master/doc "doc") | | [doc](/B16f00t/whapa/tree/master/doc "doc") |  |  |
| [images](/B16f00t/whapa/tree/master/images "images") | | [images](/B16f00t/whapa/tree/master/images "images") |  |  |
| [libs](/B16f00t/whapa/tree/master/libs "libs") | | [libs](/B16f00t/whapa/tree/master/libs "libs") |  |  |
| [README.md](/B16f00t/whapa/blob/master/README.md "README.md") | | [README.md](/B16f00t/whapa/blob/master/README.md "README.md") |  |  |
| [whapa-gui.bat](/B16f00t/whapa/blob/master/whapa-gui.bat "whapa-gui.bat") | | [whapa-gui.bat](/B16f00t/whapa/blob/master/whapa-gui.bat "whapa-gui.bat") |  |  |
| [whapa-gui.py](/B16f00t/whapa/blob/master/whapa-gui.py "whapa-gui.py") | | [whapa-gui.py](/B16f00t/whapa/blob/master/whapa-gui.py "whapa-gui.py") |  |  |
| View all files | | |

## Repository files navigation

* README

[![](https://github.com/B16f00t/whapa/raw/master/doc/whapa.png)](https://github.com/B16f00t/whapa/blob/master/doc/whapa.png)

# Whatsapp Parser Toolset

Updated: May 2022

WhatsApp Messenger Version 2.21.9.14

Whapa is a set of graphical forensic tools to analyze whatsapp from Android and soon iOS devices. All the tools have been written in Python 3.8 and have been tested on linux, windows and macOS systems.

Note: Whapa provides 10x more performance and fewer bugs on linux systems than on windows.

Whapa is included as standard in distributions such as Tsurugi Linux (Digital Forensics) and BlackArch Linux (Penetration Testing).

Whapa toolset is divided in five tools:

# **Android**

* **Whapa** (Whatsapp Parser)(Only working with old database, Working in Progress...)
* **Whacipher** (Whatsapp Encryption/Decryption) \*\*\* Not support Crypt15 \*\*\*
* **Whagodri** (Whataspp Google Drive Extractor)
* **Whamerge** (Whatsapp Merger) (Only working with old database, Working in Progress...)
* **Whachat** (Whatsapp Chat Exporter)

# **IPhone**

* **Whacloud** (Whatsapp ICloud Extractor) (Not working)
* **Whachat** (Whatsapp Chat Exporter)

**Do you like this project? Support it by donating**

* [![Paypal](https://raw.githubusercontent.com/reek/anti-adblock-killer/gh-pages/images/paypal.png)](https://raw.githubusercontent.com/reek/anti-adblock-killer/gh-pages/images/paypal.png) Paypal: [Donate](https://paypal.me/b16f00t?locale.x=es_ES)

# Changelog

<https://github.com/B16f00t/whapa/blob/master/doc/CHANGELOG.md>

# Installation

You can download the latest version of whapa by cloning the GitHub repository:

```
git clone https://github.com/B16f00t/whapa.git && cd whapa

```

then (Linux or macOS):

```
pip3 install --upgrade -r ./doc/requirements.txt

```

or (Windows):

```
pip install --upgrade -r .\doc\requirements.txt

```

# Start

if you use Linux system:

```
python3 whapa-gui.py

```

Note that if you get the error `ModuleNotFoundError: No module named 'tkinter'`, you may want to run `sudo apt install python3-tk`

if you use Windows system:

```
python whapa-gui.py
or
click on whapa-gui.bat

```

if you use macOS system (2 install options):

1. Install (Thanks to XuluWarrior):

   ```
    brew install python-tk

   ```
2. Install a later version of TK (Thanks to FetchFast):

   ```
    brew install tcl-tk

   ```

* Uninstall python3 and then download and reinstall python 3.9x from python.org

  ```
    brew uninstall python3
    https://www.python.org/downloads/

  ```
* Install requirements

  ```
    pip3 install --upgrade -r ./doc/requirements.txt

  ```
* Run with python3.9x whapa-gui.py

And a window like this will be displayed on the screen:

[![](https://raw.githubusercontent.com/B16f00t/whapa/master/doc/software.png)](https://raw.githubusercontent.com/B16f00t/whapa/master/doc/software.png)

# WHAPA

whapa.py is an Android whatsapp database parser which automates the process and presents the data handled by the SQLite database in a way that is comprehensible to the analyst.
If you copy the "wa.db" database into the same directory as the script, the phone number will be displayed along with the name.

Please note that this project is an early stage. As such, you could find errors. Use it at your own risk!

# Reports

To create reports the first thing we need to do is to configure the file"./cfg/settings.cfg". For example:

```
[report]
company = Foo S.L
record = 1337
unit = Research group
examiner = B16f00t
notes = Chat maintained between the murderer and the victim

```

If we want to put the logo of our company, we must replace the file './cfg/logo.png' by the one of our choice.
In the file './cfg/settings.cfg', the name of the company or unit must be specified, as well as the assigned registration number, the unit or group we belong to, who the examiner is and we can also specify notes in the report.

To generate the report we must specify the option "English" whether we want the report in English, as well as "ES" whether we want the report in Spanish.

If you specify the "wa.db" database, the phone number will be displayed along with the name.
For the report to contains the images, videos, documents... you must copy the "WhatsApp/Media" folder of your phone to the report directory, otherwise the program will generate thumbnails.

If we want to print the document or create the report in pdf, It recommends in the print option -> scale the view <= 60% or 70%, otherwise the report will be displayed too large.

# WHACIPHER

whacipher.py is a tool which allows decrypt or encrypt WhatsApp database. You must have the key of your phone to decrypt, and additionally a encrypted database as reference to encrypt a new database.

# WHAMERGE

whamerge is a tool to joins backups in a new database, to be able to be analyzed and obtain more information, such as deleted groups, messages, etc...

Warning: Do not join restored databases with old copies, since they repeat the same ids and the copy will not be done correctly.

# WHAGODRI

whagodri.py is a tool which allows WhatsApp users on Android to extract their backed up WhatsApp data from Google Drive.

Make sure of:

* Download the latest version of whapa
* Install the requirements
* Settings:

Edit only the values of the./cfg/settings.cfg file

```
	[google-auth]
	gmail = alias@gmail.com
	# Optional. The account password or app password when using 2FA.
	password  =
	# Optional. The result of "adb shell settings get secure android_id".
	android_id = 0000000000000000
	# Optional. Enter the backup country code + phonenumber be synchronized, otherwise it synchronizes all backups.
	# You can specify a list of celnumbr = BackupNumber1, BackupNumber2, ...
	celnumbr =

```

* New Method: Login by OAuth, this method is not valid for accounts without a phone number or alternative email associated to the account.
* If you request it, log in to your browser and then click here. <https://accounts.google.com/b/0/DisplayUnlockCaptcha>
* If you want to use 2FA (Two Factor Authentication), you will have to go to the URL: <https://myaccount.google.com/apppasswords> Then select Application: Other. Write down: Whapa, and a password will be display, then you must write the password in your settings.cfg.
  (Thanks to YuriCosta) or Login by OAuth.

# WHACLOUD

whacloud.py is a tool which allows WhatsApp users on Iphone to extract their backed up WhatsApp data from ICloud.
BETA TOOL May contain bugs.

Make sure of:

* Download the latest version of whapa
* Install the requirements
* Settings:

Edit only the values of the./cfg/settings.cfg file

```
	[icloud-auth]
	icloud = alias@icloud.com
	passw = yourpassword

```

# WHACHAT

whachat.py is a tool to make an interactive report from whatsapp's export chat functionality.

To export chats on an Android phone, here are the steps:

1. Open the individual or group chat.
2. Press the Menu button.
3. Press More.
4. Select Export chat.
5. Choose Include or Exclude files.

To export chats on an iOS phone, here are the steps:

1. Open the individual or group chat.
2. Press on the name (Chat information).
3. Slide down.
4. Select Export chat.
5. Choose Include or Exclude files.

# Get in touch

Acknowledgements, suggestions, languages, improvements...

Telegram Channel and discuss group

```
https://t.me/bigfoot_whapa

```

# Disclaimer

The developer is not responsible, and expressly disclaims all liability for damages of any kind arising from the use, reference or reliance on the software. The information provided by the software is not guaranteed to be correct, complete and up-to-date.

## About

WhatsApp Parser Toolset v1.59

### Topics

[forensic-analysis](/topics/forensic-analysis "Topic: forensic-analysis")
[whatsapp-parser](/topics/whatsapp-parser "Topic: whatsapp-parser")
[whatsapp-encryption](/topics/whatsapp-encryption "Topic: whatsapp-encryption")

### Resources

[Readme](#readme-ov-file)

[Activity](/B16f00t/whapa/activity)
### Stars

[**1.2k**
stars](/B16f00t/whapa/stargazers)
### Watchers

[**80**
watching](/B16f00t/whapa/watchers)
### Forks

[**269**
forks](/B16f00t/whapa/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FB16f00t%2Fwhapa&report=B16f00t+%28user%29)

## [Releases](/B16f00t/whapa/releases)

No releases published

## [Packages 0](/users/B16f00t/packages?repo_name=whapa)

No packages published

## [Contributors 17](/B16f00t/whapa/graphs/contributors)

* [![@B16f00t](https://avatars.githubusercontent.com/u/33256758?s=64&v=4)](https://github.com/B16f00t)
* [![@Baneeishaque](https://avatars.githubusercontent.com/u/6133009?s=64&v=4)](https://github.com/Baneeishaque)
* [![@ElDavoo](https://avatars.githubusercontent.com/u/7345120?s=64&v=4)](https://github.com/ElDavoo)
* [![@trasba](https://avatars.githubusercontent.com/u/14924356?s=64&v=4)](https://github.com/trasba)
* [![@joonas-fi](https://avatars.githubusercontent.com/u/630151?s=64&v=4)](https://github.com/joonas-fi)
* [![@DLu](https://avatars.githubusercontent.com/u/1016143?s=64&v=4)](https://github.com/DLu)
* [![@willsheppard](https://avatars.githubusercontent.com/u/1519594?s=64&v=4)](https://github.com/willsheppard)
* [![@p4r4d0x86](https://avatars.githubusercontent.com/u/3404579?s=64&v=4)](https://github.com/p4r4d0x86)
* [![@tupini07](https://avatars.githubusercontent.com/u/3422347?s=64&v=4)](https://github.com/tupini07)
* [![@FreddieOliveira](https://avatars.githubusercontent.com/u/9597536?s=64&v=4)](https://github.com/FreddieOliveira)
* [![@iMonZ](https://avatars.githubusercontent.com/u/11319871?s=64&v=4)](https://github.com/iMonZ)
* [![@maiqueg](https://avatars.githubusercontent.com/u/20514789?s=64&v=4)](https://github.com/maiqueg)
* [![@xnumad](https://avatars.githubusercontent.com/u/34810600?s=64&v=4)](https://github.com/xnumad)
* [![@SHIFTABINKHALID](https://avatars.githubusercontent.com/u/44395679?s=64&v=4)](https://github.com/SHIFTABINKHALID)

[+ 3 contributors](/B16f00t/whapa/graphs/contributors)

## Languages

* [Python
  98.5%](/B16f00t/whapa/search?l=python)
* [CSS
  1.5%](/B16f00t/whapa/search?l=css)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


