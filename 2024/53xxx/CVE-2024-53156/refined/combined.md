=== Content from git.kernel.org_246678e1_20250114_202031.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 10:59:32 +0100 |
| commit | [5f177fb9d01355ac183e65ad8909ea8ef734e0cf](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf)) | |
| tree | [a2972005e67a65c6a85bb353c1a45c319110bcca](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf) | |
| parent | [97150a4ab088e3846212035708e9b008272aab1f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=97150a4ab088e3846212035708e9b008272aab1f) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf&id2=97150a4ab088e3846212035708e9b008272aab1f)) | |
| download | [linux-5f177fb9d01355ac183e65ad8909ea8ef734e0cf.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-5f177fb9d01355ac183e65ad8909ea8ef734e0cf.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex d5e5f9cf4ca868..762403dfbb36d9 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=97150a4ab088e3846212035708e9b008272aab1f)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=5f177fb9d01355ac183e65ad8909ea8ef734e0cf)@@ -297,6 +297,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:08 +0000



=== Content from git.kernel.org_f215735e_20250114_202034.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Kalle Valo <quic\_kvalo@quicinc.com> | 2024-09-14 14:46:27 +0300 |
| commit | [8619593634cbdf5abf43f5714df49b04e4ef09ab](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab)) | |
| tree | [65baed9f9edd0ccdd8de271fec599631afff06e0](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab) | |
| parent | [1d66430cc9afdc588f13897189565a08d5e518b1](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=1d66430cc9afdc588f13897189565a08d5e518b1) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab&id2=1d66430cc9afdc588f13897189565a08d5e518b1)) | |
| download | [linux-8619593634cbdf5abf43f5714df49b04e4ef09ab.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8619593634cbdf5abf43f5714df49b04e4ef09ab.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8619593634cbdf5abf43f5714df49b04e4ef09ab)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=8619593634cbdf5abf43f5714df49b04e4ef09ab) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex eb631fd3336d8d..b5257b2b4aa527 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=1d66430cc9afdc588f13897189565a08d5e518b1)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=8619593634cbdf5abf43f5714df49b04e4ef09ab)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:11 +0000



=== Content from git.kernel.org_45ef3fba_20250114_202039.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=c941af142200d975dd3be632aeb490f4cb91dae4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c941af142200d975dd3be632aeb490f4cb91dae4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c941af142200d975dd3be632aeb490f4cb91dae4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c941af142200d975dd3be632aeb490f4cb91dae4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:47:48 +0100 |
| commit | [c941af142200d975dd3be632aeb490f4cb91dae4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c941af142200d975dd3be632aeb490f4cb91dae4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=c941af142200d975dd3be632aeb490f4cb91dae4)) | |
| tree | [955f2cccac32f27203e87be1046bf694edb4be07](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=c941af142200d975dd3be632aeb490f4cb91dae4) | |
| parent | [ba35d3b212fb8b11bd6798907850b4a08aa38c91](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=ba35d3b212fb8b11bd6798907850b4a08aa38c91) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c941af142200d975dd3be632aeb490f4cb91dae4&id2=ba35d3b212fb8b11bd6798907850b4a08aa38c91)) | |
| download | [linux-c941af142200d975dd3be632aeb490f4cb91dae4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-c941af142200d975dd3be632aeb490f4cb91dae4.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=c941af142200d975dd3be632aeb490f4cb91dae4)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=c941af142200d975dd3be632aeb490f4cb91dae4) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex 99667aba289df0..00dc97ac53b9d8 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=ba35d3b212fb8b11bd6798907850b4a08aa38c91)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=c941af142200d975dd3be632aeb490f4cb91dae4)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:16 +0000



=== Content from git.kernel.org_58a4e1cf_20250114_202040.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:44:25 +0100 |
| commit | [cb480ae80fd4d0f1ac9e107ce799183beee5124b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b)) | |
| tree | [7973ffde74e9eace902275cc73879c0c55df2c70](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b) | |
| parent | [5665bb43719e83fb164c3cd952fca38a9dd20557](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=5665bb43719e83fb164c3cd952fca38a9dd20557) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b&id2=5665bb43719e83fb164c3cd952fca38a9dd20557)) | |
| download | [linux-cb480ae80fd4d0f1ac9e107ce799183beee5124b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-cb480ae80fd4d0f1ac9e107ce799183beee5124b.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex 99667aba289df0..00dc97ac53b9d8 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=5665bb43719e83fb164c3cd952fca38a9dd20557)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=cb480ae80fd4d0f1ac9e107ce799183beee5124b)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:17 +0000



=== Content from git.kernel.org_52d09a0a_20250114_202032.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:53:25 +0100 |
| commit | [70eae50d2156cb6e078d0d78809b49bf2f4c7540](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540)) | |
| tree | [a6f75ca276bb19343a6441edb8d69ce2beed0c8e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540) | |
| parent | [cd53f82a1da4ebea8241f30f799ad90091ae72cb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=cd53f82a1da4ebea8241f30f799ad90091ae72cb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540&id2=cd53f82a1da4ebea8241f30f799ad90091ae72cb)) | |
| download | [linux-70eae50d2156cb6e078d0d78809b49bf2f4c7540.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-70eae50d2156cb6e078d0d78809b49bf2f4c7540.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex 99667aba289df0..00dc97ac53b9d8 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=cd53f82a1da4ebea8241f30f799ad90091ae72cb)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=70eae50d2156cb6e078d0d78809b49bf2f4c7540)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:09 +0000



=== Content from git.kernel.org_41d8bf21_20250114_202035.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-14 19:50:51 +0100 |
| commit | [8965db7fe2e913ee0802b05fc94c6d6aa74e0596](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596)) | |
| tree | [f7d4c0b8db59c1f12babde7b0b4013dabd08a494](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596) | |
| parent | [6a806399e4f54b3ca5759a66d8c664fe53241e45](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6a806399e4f54b3ca5759a66d8c664fe53241e45) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596&id2=6a806399e4f54b3ca5759a66d8c664fe53241e45)) | |
| download | [linux-8965db7fe2e913ee0802b05fc94c6d6aa74e0596.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-8965db7fe2e913ee0802b05fc94c6d6aa74e0596.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex 99667aba289df0..00dc97ac53b9d8 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=6a806399e4f54b3ca5759a66d8c664fe53241e45)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=8965db7fe2e913ee0802b05fc94c6d6aa74e0596)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:12 +0000



=== Content from git.kernel.org_be804373_20250114_202037.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 14:01:37 +0100 |
| commit | [bc981179ab5d1a2715f35e3db4e4bb822bacc849](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849)) | |
| tree | [2ee0bbb84af850a926dd3192a9e592b9a95cfb07](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849) | |
| parent | [c68b874c06249f2b7717f521687c64b1d4968251](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c68b874c06249f2b7717f521687c64b1d4968251) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849&id2=c68b874c06249f2b7717f521687c64b1d4968251)) | |
| download | [linux-bc981179ab5d1a2715f35e3db4e4bb822bacc849.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-bc981179ab5d1a2715f35e3db4e4bb822bacc849.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex eb631fd3336d8d..b5257b2b4aa527 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=c68b874c06249f2b7717f521687c64b1d4968251)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=bc981179ab5d1a2715f35e3db4e4bb822bacc849)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:14 +0000



=== Content from git.kernel.org_ba67edbb_20250114_202036.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-09 10:31:59 +0100 |
| commit | [b6551479daf2bfa80bfd5d9016b02a810e508bfb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb)) | |
| tree | [c473a4ae1ead55cfb553679b2cac093686a7ed66](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb) | |
| parent | [9728b508b01a5eeeac79ceb676364c674dd951ac](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=9728b508b01a5eeeac79ceb676364c674dd951ac) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb&id2=9728b508b01a5eeeac79ceb676364c674dd951ac)) | |
| download | [linux-b6551479daf2bfa80bfd5d9016b02a810e508bfb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b6551479daf2bfa80bfd5d9016b02a810e508bfb.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex 99667aba289df0..00dc97ac53b9d8 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=9728b508b01a5eeeac79ceb676364c674dd951ac)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=b6551479daf2bfa80bfd5d9016b02a810e508bfb)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:13 +0000



=== Content from git.kernel.org_b6ce4ac5_20250114_202030.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Jeongjun Park <aha310510@gmail.com> | 2024-09-14 12:06:03 +0300 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-12-05 13:53:07 +0100 |
| commit | [3fe99b9690b99606d3743c9961ebee865cfa1ab8](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8)) | |
| tree | [e0a200ada1e5364714269f8cd7a49ea9b1201248](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8) | |
| parent | [c89e0a4cb649e43d8a9497d047f3bb9f49f346e2](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=c89e0a4cb649e43d8a9497d047f3bb9f49f346e2) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8&id2=c89e0a4cb649e43d8a9497d047f3bb9f49f346e2)) | |
| download | [linux-3fe99b9690b99606d3743c9961ebee865cfa1ab8.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-3fe99b9690b99606d3743c9961ebee865cfa1ab8.tar.gz) | |

wifi: ath9k: add range check for conn\_rsp\_epid in htc\_connect\_service()[ Upstream commit 8619593634cbdf5abf43f5714df49b04e4ef09ab ]
I found the following bug in my fuzzer:
UBSAN: array-index-out-of-bounds in drivers/net/wireless/ath/ath9k/htc\_hst.c:26:51
index 255 is out of range for type 'htc\_endpoint [22]'
CPU: 0 UID: 0 PID: 8 Comm: kworker/0:0 Not tainted 6.11.0-rc6-dirty #14
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
Workqueue: events request\_firmware\_work\_func
Call Trace:
<TASK>
dump\_stack\_lvl+0x180/0x1b0
\_\_ubsan\_handle\_out\_of\_bounds+0xd4/0x130
htc\_issue\_send.constprop.0+0x20c/0x230
? \_raw\_spin\_unlock\_irqrestore+0x3c/0x70
ath9k\_wmi\_cmd+0x41d/0x610
? mark\_held\_locks+0x9f/0xe0
...
Since this bug has been confirmed to be caused by insufficient verification
of conn\_rsp\_epid, I think it would be appropriate to add a range check for
conn\_rsp\_epid to htc\_connect\_service() to prevent the bug from occurring.
Fixes: fb9987d0f748 ("ath9k\_htc: Support for AR9271 chipset.")
Signed-off-by: Jeongjun Park <aha310510@gmail.com>
Acked-by: Toke Høiland-Jørgensen <toke@toke.dk>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240909103855.68006-1-aha310510@gmail.com](https://patch.msgid.link/20240909103855.68006-1-aha310510%40gmail.com)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/htc_hst.c?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8) | 3 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 3 insertions, 0 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/htc\_hst.c b/drivers/net/wireless/ath/ath9k/htc\_hst.cindex eb631fd3336d8d..b5257b2b4aa527 100644--- a/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=c89e0a4cb649e43d8a9497d047f3bb9f49f346e2)+++ b/[drivers/net/wireless/ath/ath9k/htc\_hst.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/htc_hst.c?id=3fe99b9690b99606d3743c9961ebee865cfa1ab8)@@ -294,6 +294,9 @@ int htc\_connect\_service(struct htc\_target \*target, return -ETIMEDOUT; } + if (target->conn\_rsp\_epid < 0 || target->conn\_rsp\_epid >= ENDPOINT\_MAX)+ return -EINVAL;+ \*conn\_rsp\_epid = target->conn\_rsp\_epid; return 0; err: |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 20:19:07 +0000


