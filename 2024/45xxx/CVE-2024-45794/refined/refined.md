- **Root cause of vulnerability:** The `CreateUser` API in Devtron is vulnerable to SQL Injection due to the lack of proper sanitization or parameterized queries when processing user-controlled input. Specifically, the `AccessType` field within `roleFilters` is directly concatenated into a SQL query without any validation.
- **Weaknesses/vulnerabilities present:**
  - SQL Injection (CWE-89)
  - Unsanitized user input in `UserRestHandler.go` is passed to the database query without proper encoding or parameterization.
- **Impact of exploitation:** An authenticated user with minimal permissions can execute arbitrary SQL queries on the database, potentially leading to:
  - Data exfiltration (retrieving sensitive database information, as demonstrated in the PoC by extracting the database name).
  - Data modification (altering or deleting records).
  - Potential for further system compromise depending on the database configuration.
- **Attack vectors:** Network-based, exploiting the `/orchestrator/user` API endpoint.
- **Required attacker capabilities/position:**
  - An authenticated user with the minimal necessary permissions to call the `CreateUser` API.
  - Ability to craft a malicious JSON payload with an injected SQL query in the `AccessType` field of `roleFilters`.