- **Root cause of vulnerability**: The vulnerability lies in the `natRule` function within `system.go` where the `nat` string is split into `protocol`, `lport`, and `dport`, and then these are directly inserted into a command string executed by the system without proper sanitization or validation.
- **Weaknesses/vulnerabilities present**: OS Command Injection (CWE-78). The lack of input validation and sanitization of the `protocol`, `lport`, and `dport` variables allows an attacker to inject arbitrary commands through these parameters when creating or removing a firewall rule.
- **Impact of exploitation**: Successful exploitation allows an attacker to execute arbitrary commands on the host system, leading to complete compromise of the system, data theft or modification.
- **Attack vectors**: The primary attack vector is through a crafted HTTP request to the GoCast API where the `nat` parameter is manipulated. However, the vulnerability could also be exploited through the configuration file or via Consul integration if these are used.
- **Required attacker capabilities/position**: An attacker can trigger the vulnerability through an unauthenticated HTTP request, meaning no authentication is needed if the HTTP API is exposed, which is the default configuration.