=== Content from github.com_6929f911_20250114_210327.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22567)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22567)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  849](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Initial import of our custom and safe r\_str\_scanf ##util #22567

 Merged

[trufae](/trufae)
merged 5 commits into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[scanf](/radareorg/radare2/tree/scanf "radareorg/radare2:scanf")

Feb 6, 2024

 Merged

# [Initial import of our custom and safe r\_str\_scanf ##util](#top) #22567

[trufae](/trufae)
merged 5 commits into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[scanf](/radareorg/radare2/tree/scanf "radareorg/radare2:scanf")

Feb 6, 2024

+372

−1

[Conversation
0](/radareorg/radare2/pull/22567)
[Commits
5](/radareorg/radare2/pull/22567/commits)
[Checks
40](/radareorg/radare2/pull/22567/checks)
[Files changed
5](/radareorg/radare2/pull/22567/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

Copy link

Collaborator

### @trufae **[trufae](/trufae)** commented [Feb 6, 2024](#issue-2121357197)

* %s requires length via %.s
* cant use %\*s for backward compat reasons (printf vs scanf inconsistencies)
* support %Lx as a portable ut64 modifier
* add some unit tests

* Mark this if you consider it ready to merge
* I've added tests (optional)
* I wrote some lines in the [book](https://github.com/radareorg/radare2book) (optional)

**Description**

Sorry, something went wrong.

All reactions

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[Initial import of our custom and safe r_str_scanf ##util](/radareorg/radare2/pull/22567/commits/92ad4dc83b0ea9f20820b5ee479d3b02003f6b96 "Initial import of our custom and safe r_str_scanf ##util

* %s requires length via %.s
* cant use %*s for backward compat reasons (printf vs scanf inconsistencies)
* support %Lx as a portable ut64 modifier
* add some unit tests")`
 …

`[92ad4dc](/radareorg/radare2/pull/22567/commits/92ad4dc83b0ea9f20820b5ee479d3b02003f6b96)`

```
* %s requires length via %.s
* cant use %*s for backward compat reasons (printf vs scanf inconsistencies)
* support %Lx as a portable ut64 modifier
* add some unit tests
```

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
mentioned this pull request
[Feb 6, 2024](#ref-pullrequest-2116520387)

[Use r\_str\_scanf as a safe alternative to fix gdb reg profile parsing bugs
#22562](/radareorg/radare2/pull/22562)
 Closed

 [radare](/radare)
added 4 commits
[February 6, 2024 18:46](#commits-pushed-ca3648c)

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[Implement wide string support](/radareorg/radare2/pull/22567/commits/ca3648cd0ad0aaa5dae326f73d2a8ca2271fba8c "Implement wide string support")`

`[ca3648c](/radareorg/radare2/pull/22567/commits/ca3648cd0ad0aaa5dae326f73d2a8ca2271fba8c)`

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[fi](/radareorg/radare2/pull/22567/commits/6560b112e16bafa1af19fad3ac7c8f8290359826 "fi")`

`[6560b11](/radareorg/radare2/pull/22567/commits/6560b112e16bafa1af19fad3ac7c8f8290359826)`

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[fil](/radareorg/radare2/pull/22567/commits/255e389f1c9554436f0135d591216e91417bf6d8 "fil")`

`[255e389](/radareorg/radare2/pull/22567/commits/255e389f1c9554436f0135d591216e91417bf6d8)`

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[fw](/radareorg/radare2/pull/22567/commits/e670262f06cc1f847a71ae17c4e2c9bb4b5ba2b4 "fw")`

`[e670262](/radareorg/radare2/pull/22567/commits/e670262f06cc1f847a71ae17c4e2c9bb4b5ba2b4)`

 Hide details
View details

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
merged commit [`0986695`](/radareorg/radare2/commit/098669591ca0327619fd2df572ca81d2dfe50ec0)
into
master

[Feb 6, 2024](https://github.com/radareorg/radare2/pull/22567#event-11723020041)
38 checks passed

 [![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
deleted the
scanf

branch
[February 14, 2024 16:52](#event-11804537417)

[![@Malayke](https://avatars.githubusercontent.com/u/4935500?s=40&v=4)](/Malayke)
[Malayke](/Malayke)
mentioned this pull request
[Dec 19, 2024](#ref-pullrequest-2749193577)

[[GHSA-6gq9-2wfh-4rj3] Buffer Overflow vulnerability in radarorg radare2 v.5.8.8...
github/advisory-database#5101](/github/advisory-database/pull/5101)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22567)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=52&v=4)](/trufae) [![@radare](https://avatars.githubusercontent.com/u/917142?s=52&v=4)](/radare)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_27271aed_20250114_210320.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCrispy-fried-chicken%2F0be4a204e7226fa2cea761c09f027690)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCrispy-fried-chicken%2F0be4a204e7226fa2cea761c09f027690&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2FCrispy-fried-chicken%2F0be4a204e7226fa2cea761c09f027690) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2FCrispy-fried-chicken%2F0be4a204e7226fa2cea761c09f027690&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=64&v=4)](/Crispy-fried-chicken)

# [Crispy-fried-chicken](/Crispy-fried-chicken)/**[CVE-2024-29646.txt](/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690)** Secret

Created
November 30, 2024 11:20

Show Gist options

* [Download ZIP](/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690/archive/d94e70c4781f56235c66632eccbfdc5d80ae6d35.zip)

* [Star
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCrispy-fried-chicken%2F0be4a204e7226fa2cea761c09f027690)You must be signed in to star a gist
* [Fork
  (0)
  0](/login?return_to=https%3A%2F%2Fgist.github.com%2FCrispy-fried-chicken%2F0be4a204e7226fa2cea761c09f027690)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690.js&quot;&gt;&lt;/script&gt;
* Save Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690 to your computer and use it in GitHub Desktop.

[Code](/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690)
[Revisions
1](/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690/revisions)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690.js&quot;&gt;&lt;/script&gt;

Save Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690 to your computer and use it in GitHub Desktop.

[Download ZIP](/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690/archive/d94e70c4781f56235c66632eccbfdc5d80ae6d35.zip)

CVE-2024-29646

 [Raw](/Crispy-fried-chicken/0be4a204e7226fa2cea761c09f027690/raw/d94e70c4781f56235c66632eccbfdc5d80ae6d35/CVE-2024-29646.txt)

[**CVE-2024-29646.txt**](#file-cve-2024-29646-txt)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | [CVE ID] |
| --- | --- |
|  | CVE-2024-29646 |
|  |  |
|  | [Product] |
|  | radare2 |
|  |  |
|  | [Version] |
|  | v5.8.8 |
|  |  |
|  | [Vulnerability Type] |
|  | Buffer Overflow |
|  |  |
|  | [Description] |
|  | Buffer Overflow vulnerability in radarorg radare2 v.5.8.8 allows an attacker to execute arbitrary code via the name, type, or group fields. |
|  |  |
|  | [Reference] |
|  | https://github.com/radareorg/radare2/pull/22562 |
|  | https://github.com/radareorg/radare2/pull/22567 |
|  | https://github.com/radareorg/radare2/pull/22572 |
|  | https://github.com/radareorg/radare2/pull/22578 |
|  | https://github.com/radareorg/radare2/pull/22599 |

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2FCrispy-fried-chicken%2F0be4a204e7226fa2cea761c09f027690)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_91794ae2_20250114_210325.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22562)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22562)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  849](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Use r\_str\_scanf as a safe alternative to fix gdb reg profile parsing bugs #22562

 Closed

[Crispy-fried-chicken](/Crispy-fried-chicken)
wants to merge
31
commits into
[radareorg:master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[Crispy-fried-chicken:patch-2](/Crispy-fried-chicken/radare2/tree/patch-2 "Crispy-fried-chicken/radare2:patch-2")

 Closed

# [Use r\_str\_scanf as a safe alternative to fix gdb reg profile parsing bugs](#top) #22562

[Crispy-fried-chicken](/Crispy-fried-chicken)
wants to merge
31
commits into
[radareorg:master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[Crispy-fried-chicken:patch-2](/Crispy-fried-chicken/radare2/tree/patch-2 "Crispy-fried-chicken/radare2:patch-2")

+28

−30

[Conversation
82](/radareorg/radare2/pull/22562)
[Commits
31](/radareorg/radare2/pull/22562/commits)
[Checks
40](/radareorg/radare2/pull/22562/checks)
[Files changed
7](/radareorg/radare2/pull/22562/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=60&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

### @Crispy-fried-chicken **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Feb 3, 2024](#issue-2116520387)

`scanf("%s")` uses are not safe, which may cause OOB, so we need to limit the number of characters read.

Sorry, something went wrong.

 👍
1
 trufae reacted with thumbs up emoji

All reactions

* 👍
  1 reaction

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[Fix conversion from GDB register profile to rizin profile](/radareorg/radare2/pull/22562/commits/7bc03499e96511da15846a4b9ca5a0596b0514e0 "Fix conversion from GDB register profile to rizin profile")`

`[7bc0349](/radareorg/radare2/pull/22562/commits/7bc03499e96511da15846a4b9ca5a0596b0514e0)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
requested changes
[Feb 4, 2024](#pullrequestreview-1861057466)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0)

[libr/include/r\_types\_base.h](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0#diff-6efa4e11ee919575028c2ce71b4699c49366e676d2a5e7b5975f114120714fe4)
Outdated

|  |  | @@ -293,4 +293,7 @@ static inline void \*untagged\_pointer\_check(void \*x) { | |
| --- | --- | --- | --- |
|  |  | } |
|  |  | #endif |
|  |  |  |
|  |  | #define RZ\_STR\_DEF(s) RZ\_STR(s) |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 3, 2024](#discussion_r1477085888)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Dont use rizinisms please

Sorry, something went wrong.

All reactions

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 5, 2024](#discussion_r1477769545)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

^ those macros don’t really provide much goodness and their name is from rizin so it should be removed

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | @@ -12,6 +12,13 @@ typedef struct { | |
| --- | --- | --- | --- |
|  |  | #define UNSUPPORTED 0 |
|  |  | #define SUPPORTED 1 |
|  |  |  |
|  |  | #define PROC\_NAME\_SZ 1024 |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 4, 2024](#discussion_r1477183346)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Are those constants actually coming from the kernel? If not i would prefer to have no limits on any of this

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @Crispy-fried-chicken **[Crispy-fried-chicken](/Crispy-fried-chicken)** [Feb 4, 2024](#discussion_r1477188591)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Yes, they all come from the kernel which add in the patch of CVE-2023-27590, that is [rizinorg/rizin@d619670](https://github.com/rizinorg/rizin/commit/d6196703d89c84467b600ba2692534579dc25ed4). So maybe it should be there?

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | #define PROC\_REGION\_SZ 100 |
| --- | --- | --- |
|  |  | // PROC\_REGION\_SZ - 2 (used for `0x`). Due to how RZ\_STR\_DEF works this can't be |
|  |  | // computed. |
|  |  | #define PROC\_REGION\_LEFT\_SZ 98 |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 4, 2024](#discussion_r1477183422)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Precomputed values and assumptions like this are prompt to become maintainance problems for later. Comments shouldnt be needed if the code is solid

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @Crispy-fried-chicken **[Crispy-fried-chicken](/Crispy-fried-chicken)** [Feb 4, 2024](#discussion_r1477188662)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

ok, maybe I should delete the comment?

Sorry, something went wrong.

All reactions

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 4, 2024](#discussion_r1477246438)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

The defines shouldnt exist either. Those constants are arbitrary and the value for that one can be computed from another one. Otherwise its a maintainance complication

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | @@ -240,8 +247,8 @@ static RList \*r\_debug\_gdb\_map\_get(RDebug\* dbg) { // TODO | |
| --- | --- | --- | --- |
|  |  | // 7ffff7dda000-7ffff7dfd000 r-xp 00000000 08:05 265428 /usr/lib/ld-2.25.so |
|  |  | // Android |
|  |  | // "12c00000-12c40000 rw-p 00000000 00:00 0 [anon:dalvik-main space (region space)]"; |
|  |  | ret = sscanf (ptr, "%s %s %"PFMT64x" %\*s %\*s %[^\n]", &region1[2], |
|  |  | perms, &offset, name); |
|  |  | ret = sscanf(ptr, "%" RZ\_STR\_DEF(PROC\_REGION\_LEFT\_SZ) "s %" RZ\_STR\_DEF(PROC\_PERM\_SZ) "s %" PFMT64x " %\*s %\*s %" RZ\_STR\_DEF(PROC\_NAME\_SZ) "[^\n]", |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 4, 2024](#discussion_r1477183545)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Dont use rizinisms

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_io.c](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0#diff-c94d207f8441bce2a29fdb83cec1dfbdf991f8d7ee0368028a1fc9aaec1a4b84)
Outdated

|  |  | @@ -22,8 +25,8 @@ static RList \*\_\_io\_maps(RDebug \*dbg) { | |
| --- | --- | --- | --- |
|  |  | } |
|  |  | char \*ostr = str; |
|  |  | ut64 map\_start, map\_end; |
|  |  | char perm[32]; |
|  |  | char name[512]; |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 4, 2024](#discussion_r1477183663)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Theres no need to have a define for a size that is tied to an array. Thats defined in the secure coding guidelines as a bad practice because it makes the code more xlobbered and harder to maintain and error probe

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_io.c](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0#diff-c94d207f8441bce2a29fdb83cec1dfbdf991f8d7ee0368028a1fc9aaec1a4b84)
Outdated

|  |  | @@ -47,7 +50,7 @@ static RList \*\_\_io\_maps(RDebug \*dbg) { | |
| --- | --- | --- | --- |
|  |  | if (\_s\_) { |
|  |  | memmove (\_s\_, \_s\_ + 2, strlen (\_s\_)); |
|  |  | } |
|  |  | sscanf (str, "0x%"PFMT64x" - 0x%"PFMT64x" %s %s", |
|  |  | sscanf(str, "0x%" PFMT64x " - 0x%" PFMT64x " %" RZ\_STR\_DEF(IO\_MAPS\_PERM\_SZ) "s %" RZ\_STR\_DEF(IO\_MAPS\_NAME\_SZ) "s", |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 4, 2024](#discussion_r1477183790)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Sscanf is an awful function and there are actually many other issues than the size of the data stored after parsing. The return value should be checked for example

Sorry, something went wrong.

All reactions

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 4, 2024](#discussion_r1477183896)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Better to just check for the space and use rnum to parse the string and strdup to catch the name. This way no limits in stack bounds are needed and will make it more flexible and simple

Sorry, something went wrong.

All reactions

 [Crispy-fried-chicken](/Crispy-fried-chicken)
added 2 commits
[February 4, 2024 19:36](#commits-pushed-666c94f)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[delete some defination as for the reviewer](/radareorg/radare2/pull/22562/commits/666c94ff83f11aff16b6b6e044bcfb26a06c0402 "delete some defination as for the reviewer")`

`[666c94f](/radareorg/radare2/pull/22562/commits/666c94ff83f11aff16b6b6e044bcfb26a06c0402)`

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[update for some foramt](/radareorg/radare2/pull/22562/commits/e9b636b5e72d709260538382f47cf10ebf6da66e "update for some foramt")`

`[e9b636b](/radareorg/radare2/pull/22562/commits/e9b636b5e72d709260538382f47cf10ebf6da66e)`

 [![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)
[Crispy-fried-chicken](/Crispy-fried-chicken)
requested a review
from [trufae](/trufae)
[February 4, 2024 12:03](#event-11695302830)

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
requested changes
[Feb 5, 2024](#pullrequestreview-1862048154)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/e9b636b5e72d709260538382f47cf10ebf6da66e)

[libr/include/r\_types\_base.h](/radareorg/radare2/pull/22562/files/7bc03499e96511da15846a4b9ca5a0596b0514e0#diff-6efa4e11ee919575028c2ce71b4699c49366e676d2a5e7b5975f114120714fe4)
Outdated

|  |  | @@ -293,4 +293,7 @@ static inline void \*untagged\_pointer\_check(void \*x) { | |
| --- | --- | --- | --- |
|  |  | } |
|  |  | #endif |
|  |  |  |
|  |  | #define RZ\_STR\_DEF(s) RZ\_STR(s) |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 5, 2024](#discussion_r1477769545)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

^ those macros don’t really provide much goodness and their name is from rizin so it should be removed

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files/e9b636b5e72d709260538382f47cf10ebf6da66e#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | @@ -194,7 +195,7 @@ static RList \*r\_debug\_gdb\_map\_get(RDebug\* dbg) { // TODO | |
| --- | --- | --- | --- |
|  |  | int unk = 0, perm, i; |
|  |  | char \*ptr, \*pos\_1; |
|  |  | size\_t line\_len; |
|  |  | char name[1024], region1[256], region2[100], perms[5]; |
|  |  | char name[1025], region1[101], region2[101], perms[6]; |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 5, 2024](#discussion_r1477892885)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

those extra unaligned bytes will make stack to have holes and wont optimize it properly, also as said those are arbitrary numbers. not tied to gdb definitions

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files/e9b636b5e72d709260538382f47cf10ebf6da66e#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | // "12c00000-12c40000 rw-p 00000000 00:00 0 [anon:dalvik-main space (region space)]"; |
| --- | --- | --- |
|  |  | ret = sscanf (ptr, "%s %s %"PFMT64x" %\*s %\*s %[^\n]", &region1[2], |
|  |  | perms, &offset, name); |
|  |  | ret = sscanf (ptr, "%" RZ\_STR\_DEF(98) "s %" RZ\_STR\_DEF(5) "s %" PFMT64x " %\*s %\*s %" RZ\_STR\_DEF(1024) "[^\n]", &region1[2], perms, &offset, name); |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 5, 2024](#discussion_r1477895157)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

dont use those ugly RZ\_ things, and dnot hardcode the sizes here, the proper way to use that is to use sizeof(varname) instead of using a define or duplicating the value, this way the final code is much easier to maintain. this is specified in <https://wiki.sei.cmu.edu/confluence/display/c> if you are curious, also makes the code more readable. But again, ideally i would prefer not to use sscanf, but im fine to merge the fix when complete

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_io.c](/radareorg/radare2/pull/22562/files/e9b636b5e72d709260538382f47cf10ebf6da66e#diff-c94d207f8441bce2a29fdb83cec1dfbdf991f8d7ee0368028a1fc9aaec1a4b84)
Outdated

|  |  | @@ -22,8 +22,8 @@ static RList \*\_\_io\_maps(RDebug \*dbg) { | |
| --- | --- | --- | --- |
|  |  | } |
|  |  | char \*ostr = str; |
|  |  | ut64 map\_start, map\_end; |
|  |  | char perm[32]; |
|  |  | char name[512]; |
|  |  | char perm[33]; |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 5, 2024](#discussion_r1477895540)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

keep the aligned values, 32 and 512

Sorry, something went wrong.

All reactions

[libr/reg/profile.c](/radareorg/radare2/pull/22562/files/e9b636b5e72d709260538382f47cf10ebf6da66e#diff-11f44a7e7df37f2e8c98a15a110c886f9133fadb98e9ae0bbdb42700b14a83d9)
Outdated

|  |  | @@ -3,6 +3,10 @@ | |
| --- | --- | --- | --- |
|  |  | #include <r\_reg.h> |
|  |  | #include <r\_lib.h> |
|  |  |  |
|  |  | #define GDB\_NAME\_SZ 16 |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 5, 2024](#discussion_r1477896674)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

same, those defines are arbitrary, and duplicate the logic below making the code harder to read.

Sorry, something went wrong.

All reactions

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 6, 2024](#issuecomment-1929326564)

| I had some time to check your PR in detail. and i think the only sane way to handle sscanf with dynamic string formating in a clean and maintainable way is to not use sscanf or build the format string at runtime, because %\*s is not supported by sscanf (this is printf-specific), and its not possible to use sizeof() and concat that result into the formatting string. Therefor this is probably the cleanest way I can think of right now:  ``` #include <stdio.h> #include <r_util.h> #include <stdlib.h>  int main() { 	char str[4]; 	char str2[4]; 	char buf[] = "hello world"; 	r_strf_var (format, 64, "%%%ds %%%ds", (int)sizeof (str), (int)sizeof (str2)); 	int ret = sscanf (buf, format, str, str2); 	printf ("FMT %s\n", format); 	printf ("RET %d == 2\n", ret); 	printf ("-> %s\n", str); 	return 0; }  ```  i dont like the fact that the sizeof and str are decoupled into separate statements, and that could be probably wrapped up with amacro that constructs the string and runs sscanf, also, considering modern compilers can do printf at compile time the final code should be as simple as the original, and the construction of the format string should be done outside any loop.  But again, if its possible i would prefer to avoid the use of sscanf, and just strchr or use r\_str to split the string by spaces and such instead of depending on it.  Also this PR raises concern for other bad usecases of sscanf:  ``` 0$ git grep sscanf| grep '%s' libr/debug/p/debug_gdb.c:		ret = sscanf (ptr, "%s %s %"PFMT64x" %*s %*s %[^\n]", &region1[2], libr/debug/p/debug_io.c:			sscanf (str, "0x%"PFMT64x" - 0x%"PFMT64x" %s %s", libr/debug/p/debug_native.c:		if (sscanf (line, "%s %s %d %d 0x%s %3s %d %d", libr/debug/p/debug_native.c:		i = sscanf (line, "%s %s %08"PFMT64x" %*s %*s %[^\n]", &region[2], perms, &offset, name); libr/debug/p/native/linux/linux_coredump.c:		sscanf (buff,  "%d %s %c %d %d %d %d %d %u %lu %lu %lu %lu" libr/debug/p/native/linux/linux_coredump.c:		sscanf (buff, "%d %s %c %d %d %d %d %d %u %lu %lu %lu %lu" libr/io/p/io_self.c:		sscanf (line, "%s %s %*s %*s %*s %[^\n]", region + 2, perms, path); libr/reg/profile.c:		ret = sscanf (ptr, " %s %d %d %d %d %s %s", name, &number, &rel, 0$  ```  and also:  ``` $ git grep sscanf| grep '%\*s' libr/debug/p/debug_gdb.c:		ret = sscanf (ptr, "%s %s %"PFMT64x" %*s %*s %[^\n]", &region1[2], libr/debug/p/debug_native.c:		i = sscanf (line, "%s %s %08"PFMT64x" %*s %*s %[^\n]", &region[2], perms, &offset, name); libr/io/p/io_self.c:		sscanf (line, "%s %s %*s %*s %*s %[^\n]", region + 2, perms, path);  ```  thanks f |
| --- |

All reactions

Sorry, something went wrong.

 [Crispy-fried-chicken](/Crispy-fried-chicken)
added 2 commits
[February 6, 2024 14:25](#commits-pushed-d9854e2)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[fix some bugs for sscanf and update for reviewer's suggestions](/radareorg/radare2/pull/22562/commits/d9854e29a86c1de7d4045c40ae729601565a62c9 "fix some bugs for sscanf and update for reviewer's suggestions")`

`[d9854e2](/radareorg/radare2/pull/22562/commits/d9854e29a86c1de7d4045c40ae729601565a62c9)`

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[fix redeclaration](/radareorg/radare2/pull/22562/commits/8e8a040ffda1c7d9e126b5a0783f5bd2b514a548 "fix redeclaration")`

`[8e8a040](/radareorg/radare2/pull/22562/commits/8e8a040ffda1c7d9e126b5a0783f5bd2b514a548)`

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 6, 2024](#issuecomment-1929979725)

| importing this <https://github.com/tusharjois/bscanf> is probably the best option :) ill look into that and get it as part of r\_util asap |
| --- |

All reactions

Sorry, something went wrong.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Feb 6, 2024](#issuecomment-1929990176) • edited Loading

| importing this <https://github.com/tusharjois/bscanf> is probably the best option :) ill look into that and get it as part of r\_util asap  OK, But why I can't pass the check, I don't kown how to fix it, can you tell me the reason so that I can update :) |
| --- |

All reactions

Sorry, something went wrong.

 [![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)
[Crispy-fried-chicken](/Crispy-fried-chicken)
[force-pushed](/radareorg/radare2/compare/0b17990b2d63c16256063f963018d0f440a5a2f4..267a94b3cec17f350bf5996fe4dc8a9f254f52b7)
the
patch-2

branch
from
[`0b17990`](/radareorg/radare2/commit/0b17990b2d63c16256063f963018d0f440a5a2f4) to
[`267a94b`](/radareorg/radare2/commit/267a94b3cec17f350bf5996fe4dc8a9f254f52b7)  [Compare](/radareorg/radare2/compare/0b17990b2d63c16256063f963018d0f440a5a2f4..267a94b3cec17f350bf5996fe4dc8a9f254f52b7)
[February 6, 2024 15:24](#event-11719969357)

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 6, 2024](#pullrequestreview-1865559495)

 [View reviewed changes](/radareorg/radare2/pull/22562/files)

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | // "12c00000-12c40000 rw-p 00000000 00:00 0 [anon:dalvik-main space (region space)]"; |
| --- | --- | --- |
|  |  | ret = sscanf (ptr, "%s %s %"PFMT64x" %\*s %\*s %[^\n]", &region1[2], |
|  |  | perms, &offset, name); |
|  |  | r\_strf\_var (format, 64, "%%%ds %%%ds %%PFMT64x %%\*s %%\*s %%%d [^\\n]", (int)sizeof (region1[2]), (int)sizeof (perms), (int)sizeof (offset), (int)sizeof (name)); |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 6, 2024](#discussion_r1480036479)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

PFMT64x is a define, and needs to be defined outside the string itself, so that wont work, also the %\*s is not supported in sscanf, so that wont work either because that seems to be a nonportable gnuism

Suggested change

|  | r\_strf\_var (format, 64, "%%%ds %%%ds %%PFMT64x %%\*s %%\*s %%%d [^\\n]", (int)sizeof (region1[2]), (int)sizeof (perms), (int)sizeof (offset), (int)sizeof (name)); |
| --- | --- |
|  | r\_strf\_var (format, 64, "%%%ds %%%ds %%PFMT64x %%\*s %%\*s %%%d [^\\n]", (int)sizeof (region1[2]), (int)sizeof (perms), (int)sizeof (offset), (int)sizeof (name)); |

Sorry, something went wrong.

All reactions

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
requested changes
[Feb 6, 2024](#pullrequestreview-1865561574)

 [View reviewed changes](/radareorg/radare2/pull/22562/files)

Copy link

Collaborator

### @trufae **[trufae](/trufae)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

wait for me to push the new sscanf implementaion, it will make things much cleaner and safe and i'll add unit tests for all that, so we wont need to use PFMT64x and such anymore and %\*s will work, and %s will be banned

Sorry, something went wrong.

All reactions

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 6, 2024](#issuecomment-1930054870)

| Thanks for the patience and time updating this PR. it's a good finding, but i want it to be addressed in the cleanest way as possible. Good work! |
| --- |

All reactions

Sorry, something went wrong.

 [![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)
[Crispy-fried-chicken](/Crispy-fried-chicken)
[force-pushed](/radareorg/radare2/compare/267a94b3cec17f350bf5996fe4dc8a9f254f52b7..8e8a040ffda1c7d9e126b5a0783f5bd2b514a548)
the
patch-2

branch
from
[`267a94b`](/radareorg/radare2/commit/267a94b3cec17f350bf5996fe4dc8a9f254f52b7) to
[`8e8a040`](/radareorg/radare2/commit/8e8a040ffda1c7d9e126b5a0783f5bd2b514a548)  [Compare](/radareorg/radare2/compare/267a94b3cec17f350bf5996fe4dc8a9f254f52b7..8e8a040ffda1c7d9e126b5a0783f5bd2b514a548)
[February 6, 2024 15:32](#event-11720083685)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[fix](/radareorg/radare2/pull/22562/commits/8ca150d6fd39945f3c505711a25537f3e7b31715 "fix")`

`[8ca150d](/radareorg/radare2/pull/22562/commits/8ca150d6fd39945f3c505711a25537f3e7b31715)`

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Feb 6, 2024](#issuecomment-1930065080) • edited Loading

| Thanks for the patience and time updating this PR. it's a good finding, but i want it to be addressed in the cleanest way as possible. Good work!  Thank you for your review and looking forward to your implementaion. Besides, due to the harm this vulnerability may cause, is it necessary to apply for a CVE for this vulnerability? |
| --- |

All reactions

Sorry, something went wrong.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[update for some fix](/radareorg/radare2/pull/22562/commits/197a3cccd4302586ffd002c91991f220828b3158 "update for some fix")`

`[197a3cc](/radareorg/radare2/pull/22562/commits/197a3cccd4302586ffd002c91991f220828b3158)`

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 6, 2024](#issuecomment-1930453959)

| Found a couple of bugs in their bscanf implementation. fixed them in my fork and extended it to support %.s (%\*s is kept for backward compat), so we cant use the attribute check sadly. added some tests that may probably be helpful for those cases :)  [#22567](https://github.com/radareorg/radare2/pull/22567)  let me know what do you think?  i still want to cleanup this code more, and add a lot of more tests. and probably integrate it with RNum, so we can use it properly with extended math operation expressions and other useful format strings |
| --- |

All reactions

Sorry, something went wrong.

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 6, 2024](#issuecomment-1930608635)

| The new `r_str_scanf` function is merged in, do you wanna give it a try to rewrite this function using the new API instead? will be good to test the patch and maybe add some more unit tests for it. thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[Merge branch 'master' into patch-2](/radareorg/radare2/pull/22562/commits/fa32abb2e17687079dc68d1ba8f096e5f563319b "Merge branch 'master' into patch-2")`

`[fa32abb](/radareorg/radare2/pull/22562/commits/fa32abb2e17687079dc68d1ba8f096e5f563319b)`

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Feb 7, 2024](#issuecomment-1931368740) • edited Loading

| [@trufae](https://github.com/trufae) hi, I've seen the implementation of `r_str_scanf`  and I can't find any implement of the `%[\n]`, and find there is a TODO in `r_str_scanf` function just like:  ``` /* TODO: '[': match a non-empty sequence of characters from a set. */ 				_BSCANF_CHECK(0);  				/* String conversion requires a width. */ 				_BSCANF_CHECK_STRING(); 				/* '[' conversion specifiers DO NOT consume whitespace. */  ```  so maybe the statement below can't rewrite by the api `r_str_scanf`? `ret = sscanf (ptr, "%s %s %"PFMT64x" %*s %*s %[^\n]", &region1[2],perms, &offset, name);` and Please tell me if my modifications are correct so that I can verify whether my understanding is accurate. the origin statement is  ``` r_strf_var (format, 64, "0x%%PFMT64x - 0x%%PFMT64x %%%ds %%%ds", (int)sizeof (perm), (int)sizeof (name)); 			sscanf (str, format, &map_start, &map_end, perm, name);  ```  the rewrite statement is  ``` r_str_scanf (str, "0x%I64x - 0x%I64x %.s %.s", &map_start, &map_end, sizeof (perm), perm, sizeof (name), name);  ```  Thank you! |
| --- |

All reactions

Sorry, something went wrong.

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
requested changes
[Feb 7, 2024](#pullrequestreview-1867202517)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b)

Copy link

Collaborator

### @trufae **[trufae](/trufae)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

see inline comments

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | @@ -1,6 +1,7 @@ | |
| --- | --- | --- | --- |
|  |  | /\* radare - LGPL - Copyright 2009-2023 - pancake, defragger \*/ |
|  |  |  |
|  |  | #include <r\_core.h> |
|  |  | #include <r\_util.h> |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 7, 2024](#discussion_r1481084020)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

r\_util is included by r\_core so its not necessary

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_gdb.c](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b#diff-e24b5ec395cc1111c7873536fddbbc1b87396b223b52261c33c42ef62e6d6c54)
Outdated

|  |  | // "12c00000-12c40000 rw-p 00000000 00:00 0 [anon:dalvik-main space (region space)]"; |
| --- | --- | --- |
|  |  | ret = sscanf (ptr, "%s %s %"PFMT64x" %\*s %\*s %[^\n]", &region1[2], |
|  |  | perms, &offset, name); |
|  |  | r\_strf\_var (format, 64, "%%%ds %%%ds %%PFMT64x %%\*s %%\*s %%%d [^\\n]", (int)sizeof (region1[2]), (int)sizeof (perms), (int)sizeof (offset), (int)sizeof (name)); |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 7, 2024](#discussion_r1481868426)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

uhm will be good to implement this [^\\n] part in r\_str\_scanf, or change the code to not make it depend on this.. for several reasons.

The code you should write to make this format string should be like this:

Suggested change

|  | r\_strf\_var (format, 64, "%%%ds %%%ds %%PFMT64x %%\*s %%\*s %%%d [^\\n]", (int)sizeof (region1[2]), (int)sizeof (perms), (int)sizeof (offset), (int)sizeof (name)); |
| --- | --- |
|  | r\_strf\_var (format, 64, "%%%ds %%%ds %%"PFMT64x" %%\*s %%\*s %%%d [^\\n]", (int)sizeof (region1[2]), (int)sizeof (perms), (int)sizeof (offset), (int)sizeof (name)); |

but still. scanf scansets introduce a bunch of issues

* output buffer is not size bounded (so it will cause overflows)
* not portable, not all libc implementations support this syntax
* even if portable, does not support wide strings and is affected by locales
* scanset size is not defined by the standard, and char ranges may vary depending on implementation

in other words, scanfs scansets are a bad idea because they introduce an unnecessary complexity to scanning strings.

After some thoughs and tries i end up implementing it in the new RStr.scanf() function you can find out the implementation+ test in here:

[#22572](https://github.com/radareorg/radare2/pull/22572)

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_io.c](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b#diff-c94d207f8441bce2a29fdb83cec1dfbdf991f8d7ee0368028a1fc9aaec1a4b84)
Outdated

|  |  | @@ -2,6 +2,7 @@ | |
| --- | --- | --- | --- |
|  |  |  |
|  |  | #include <r\_debug.h> |
|  |  | #include <r\_asm.h> |
|  |  | #include <r\_util.h> |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 7, 2024](#discussion_r1481868734)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

r\_util already included by r\_asm iirc

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_io.c](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b#diff-c94d207f8441bce2a29fdb83cec1dfbdf991f8d7ee0368028a1fc9aaec1a4b84)
Outdated

|  |  | sscanf (str, "0x%"PFMT64x" - 0x%"PFMT64x" %s %s", |
| --- | --- | --- |
|  |  | &map\_start, &map\_end, perm, name); |
|  |  | r\_strf\_var (format, 64, "0x%%PFMT64x - 0x%%PFMT64x %%%ds %%%ds", (int)sizeof (perm), (int)sizeof (name)); |
|  |  | sscanf (str, format, &map\_start, &map\_end, perm, name); |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 7, 2024](#discussion_r1481870319)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

just use r\_str\_scanf. some notes here:

* no need to cast (int)sizeof, because our scanf handles size\_t properly
* the 0x%PFMT64x thing is just 0x%Lx

please add tests for those strings before updating this, so we can be sure the formatting and parsing works well acrsoss all platforms, this is safer and cleaner than depending on libc

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_native.c](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b#diff-60c9ae032e939e1adb006889013918f6800ed7a5f010fe7ef0e55aa1a9002846)
Outdated

|  |  | @@ -3,6 +3,7 @@ | |
| --- | --- | --- | --- |
|  |  | #include <r\_userconf.h> |
|  |  | #include <r\_drx.h> |
|  |  | #include <r\_core.h> |
|  |  | #include <r\_util.h> |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 7, 2024](#discussion_r1481870438)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

not necessary

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_native.c](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b#diff-60c9ae032e939e1adb006889013918f6800ed7a5f010fe7ef0e55aa1a9002846)
Outdated

|  |  | &region[2], &region2[2], &ign, &ign, |
| --- | --- | --- |
|  |  | unkstr, perms, &ign, &ign) != 8) { |
|  |  | r\_strf\_var (format, 64, "%%%ds %%%ds %%d %%d 0x%%%ds %%%ds %%d %%d", (int)sizeof (region1[2]), (int)sizeof (region2[2]), (int)sizeof (unkstr), (int)sizeof (perms)); |
|  |  | if (sscanf (line, format, &region[2], &region2[2], &ign, &ign, unkstr, perms, &ign, &ign) != 8) { |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 7, 2024](#discussion_r1481870739)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

use r\_str\_scanf instead of rstrvar

Sorry, something went wrong.

All reactions

[libr/debug/p/debug\_native.c](/radareorg/radare2/pull/22562/files/fa32abb2e17687079dc68d1ba8f096e5f563319b#diff-60c9ae032e939e1adb006889013918f6800ed7a5f010fe7ef0e55aa1a9002846)
Outdated

|  |  | @@ -1109,7 +1109,8 @@ static RList \*r\_debug\_native\_map\_get(RDebug \*dbg) { | |
| --- | --- | --- | --- |
|  |  | #else |
|  |  | ut64 offset = 0; |
|  |  | // 7fc8124c4000-7fc81278d000 r--p 00000000 fc:00 17043921 /usr/lib/locale/locale-archive |
|  |  | i = sscanf (line, "%s %s %08"PFMT64x" %\*s %\*s %[^\n]", &region[2], perms, &offset, name); |
|  |  | r\_strf\_var (format, 64, "%%%ds %%%ds %%08PFMT64x %%\*s %%\*s %%%d[^\n]", (int)sizeof (region[2]), (int)sizeof (perms), (int)sizeof (name)); |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 7, 2024](#discussion_r1481870913)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

same here, use the new r\_str\_scanf

Sorry, something went wrong.

All reactions

 [Crispy-fried-chicken](/Crispy-fried-chicken)
added 2 commits
[February 8, 2024 11:28](#commits-pushed-c3c3ee3)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[Merge branch 'master' into patch-2](/radareorg/radare2/pull/22562/commits/c3c3ee356e4dc6db30f3723544c8a81323091ffb "Merge branch 'master' into patch-2")`

`[c3c3ee3](/radareorg/radare2/pull/22562/commits/c3c3ee356e4dc6db30f3723544c8a81323091ffb)`

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[change sscanf to r_str_scanf to fix OOB](/radareorg/radare2/pull/22562/commits/292fa8cf97a48b8254df5c44da7ab9c2e8bbc87e "change sscanf to r_str_scanf to fix OOB")`

`[292fa8c](/radareorg/radare2/pull/22562/commits/292fa8cf97a48b8254df5c44da7ab9c2e8bbc87e)`

 [![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)
[Crispy-fried-chicken](/Crispy-fried-chicken)
[force-pushed](/radareorg/radare2/compare/0ce53e27e36ef7a8d7aca2db46843ee09e669241..292fa8cf97a48b8254df5c44da7ab9c2e8bbc87e)
the
patch-2

branch
from
[`0ce53e2`](/radareorg/radare2/commit/0ce53e27e36ef7a8d7aca2db46843ee09e669241) to
[`292fa8c`](/radareorg/radare2/commit/292fa8cf97a48b8254df5c44da7ab9c2e8bbc87e)  [Compare](/radareorg/radare2/compare/0ce53e27e36ef7a8d7aca2db46843ee09e669241..292fa8cf97a48b8254df5c44da7ab9c2e8bbc87e)
[February 8, 2024 04:31](#event-11740656379)

 [Crispy-fried-chicken](/Crispy-fried-chicken)
added 2 commits
[February 8, 2024 04:32](#commits-pushed-b25fd13)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[fix](/radareorg/radare2/pull/22562/commits/b25fd137506ee577485e51fc460c9661c149d7a5 "fix")`

`[b25fd13](/radareorg/radare2/pull/22562/commits/b25fd137506ee577485e51fc460c9661c149d7a5)`

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[fix](/radareorg/radare2/pull/22562/commits/ecab0cc0512a0d8f2326ce7f9d8af432b9a599da "fix")`

`[ecab0cc](/radareorg/radare2/pull/22562/commits/ecab0cc0512a0d8f2326ce7f9d8af432b9a599da)`

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Feb 8, 2024](#issuecomment-1934038988)

| [@trufae](https://github.com/trufae) hi, I've modified it, but I don't know why it can't pass the linux-test, please tell me why so that I can fix it. Thank you! |
| --- |

All reactions

Sorry, something went wrong.

29 hidden items

Load more…

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880312177)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/0e34ceb768de347c53104c6fabcaf14bf8288dc5)

Copy link

Collaborator

### @trufae **[trufae](/trufae)** left a comment

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

the sizeof where wrong. i fixed them now. let's hope it passes the tests now. i may add more tests for the scanf thing to cover all those usecases

Sorry, something went wrong.

All reactions

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Feb 14, 2024](#issuecomment-1943819088)

| the sizeof where wrong. i fixed them now. let's hope it passes the tests now. i may add more tests for the scanf thing to cover all those usecases  thank you! but can you tell me why the sizeof should be `sizeof (region1)-2` but not `sizeof (region[2])` ? |
| --- |

All reactions

Sorry, something went wrong.

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 14, 2024](#issuecomment-1944014717)

| sizeof (region[2]) is 1 byte, which is clearly not enough to store a string, the argument expects to take sizeof(region1) substracting the "0x" which are the first two bytes written in that string |
| --- |

All reactions

Sorry, something went wrong.

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 14, 2024](#issuecomment-1944051863)

| let me jump into the linux machine and tryout your pr and see what else could be |
| --- |

All reactions

Sorry, something went wrong.

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880614035)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/0e34ceb768de347c53104c6fabcaf14bf8288dc5)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/0e34ceb768de347c53104c6fabcaf14bf8288dc5#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)

Show resolved

Hide resolved

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken) [![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[fix](/radareorg/radare2/pull/22562/commits/8793f0f0422b16e62b1e3208b6277ddae2caed0a "fix

Co-authored-by: pancake <pancake@nowsecure.com>")`
 …

`[8793f0f](/radareorg/radare2/pull/22562/commits/8793f0f0422b16e62b1e3208b6277ddae2caed0a)`

```
Co-authored-by: pancake <pancake@nowsecure.com>
```

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880638526)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/0e34ceb768de347c53104c6fabcaf14bf8288dc5)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/0e34ceb768de347c53104c6fabcaf14bf8288dc5#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Apply suggestions from code review](/radareorg/radare2/pull/22562/commits/4cc47693521758cb0a2a227d2747c16725270a44 "Apply suggestions from code review")`

`[4cc4769](/radareorg/radare2/pull/22562/commits/4cc47693521758cb0a2a227d2747c16725270a44)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880645890)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/4cc47693521758cb0a2a227d2747c16725270a44)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/4cc47693521758cb0a2a227d2747c16725270a44#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Update libr/debug/p/native/linux/linux_coredump.c](/radareorg/radare2/pull/22562/commits/6dcbd85ebe8781979846abb3d1f05402c7872108 "Update libr/debug/p/native/linux/linux_coredump.c")`

`[6dcbd85](/radareorg/radare2/pull/22562/commits/6dcbd85ebe8781979846abb3d1f05402c7872108)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880647496)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/6dcbd85ebe8781979846abb3d1f05402c7872108)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/6dcbd85ebe8781979846abb3d1f05402c7872108#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Update libr/debug/p/native/linux/linux_coredump.c](/radareorg/radare2/pull/22562/commits/97a28ad9429bdac2af8be6abfd26ff29a35bea85 "Update libr/debug/p/native/linux/linux_coredump.c")`

`[97a28ad](/radareorg/radare2/pull/22562/commits/97a28ad9429bdac2af8be6abfd26ff29a35bea85)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880651521)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/97a28ad9429bdac2af8be6abfd26ff29a35bea85)

[libr/debug/p/debug\_native.c](/radareorg/radare2/pull/22562/files/97a28ad9429bdac2af8be6abfd26ff29a35bea85#diff-60c9ae032e939e1adb006889013918f6800ed7a5f010fe7ef0e55aa1a9002846)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Update libr/debug/p/debug_native.c](/radareorg/radare2/pull/22562/commits/dbeadf15697b0f6385ce2a523258b671ae57ff5f "Update libr/debug/p/debug_native.c")`

`[dbeadf1](/radareorg/radare2/pull/22562/commits/dbeadf15697b0f6385ce2a523258b671ae57ff5f)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880654480)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/dbeadf15697b0f6385ce2a523258b671ae57ff5f)

[libr/debug/p/debug\_native.c](/radareorg/radare2/pull/22562/files/dbeadf15697b0f6385ce2a523258b671ae57ff5f#diff-60c9ae032e939e1adb006889013918f6800ed7a5f010fe7ef0e55aa1a9002846)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Update libr/debug/p/debug_native.c](/radareorg/radare2/pull/22562/commits/c193c46dbeda289c826cf711259b2a79a3a5e7ed "Update libr/debug/p/debug_native.c")`

`[c193c46](/radareorg/radare2/pull/22562/commits/c193c46dbeda289c826cf711259b2a79a3a5e7ed)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880664130)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/c193c46dbeda289c826cf711259b2a79a3a5e7ed)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/c193c46dbeda289c826cf711259b2a79a3a5e7ed#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880664386)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/c193c46dbeda289c826cf711259b2a79a3a5e7ed)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/c193c46dbeda289c826cf711259b2a79a3a5e7ed#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Apply suggestions from code review](/radareorg/radare2/pull/22562/commits/c3c09061087b45b7ed6c97547496b25adfd29c03 "Apply suggestions from code review")`

`[c3c0906](/radareorg/radare2/pull/22562/commits/c3c09061087b45b7ed6c97547496b25adfd29c03)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880668720)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/c3c09061087b45b7ed6c97547496b25adfd29c03)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/c3c09061087b45b7ed6c97547496b25adfd29c03#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)

|  |  | sscanf (buff, "%d %s %c %d %d %d %d %d %u %lu %lu %lu %lu" |
| --- | --- | --- |
|  |  | "%"PFMT64x" %"PFMT64x" %ld %lu", |
|  |  | &no\_num, no\_str, &no\_char, &no\_num, &no\_num, &no\_num, |
|  |  | r\_str\_scanf (buff, "%d %.s %c %d %d %d %d %d %u %lu %lu %lu %Lx %Lx %ld %lu", &no\_num, sizeof (no\_str), no\_str, &no\_char, &no\_num, &no\_num, &no\_num, |

Copy link

Collaborator

### @trufae **[trufae](/trufae)** [Feb 14, 2024](#discussion_r1489705308)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

we can get rid of all those no\* variables if we use %\*d in the arguments instead

Sorry, something went wrong.

All reactions

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880669892)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/c3c09061087b45b7ed6c97547496b25adfd29c03)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/c3c09061087b45b7ed6c97547496b25adfd29c03#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Update libr/debug/p/native/linux/linux_coredump.c](/radareorg/radare2/pull/22562/commits/8698e5adfa1d5ae51b302959f675763920eb8c99 "Update libr/debug/p/native/linux/linux_coredump.c")`

`[8698e5a](/radareorg/radare2/pull/22562/commits/8698e5adfa1d5ae51b302959f675763920eb8c99)`

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880725559)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/8698e5adfa1d5ae51b302959f675763920eb8c99)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/8698e5adfa1d5ae51b302959f675763920eb8c99#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

**[trufae](/trufae)**
reviewed
[Feb 14, 2024](#pullrequestreview-1880725756)

 [View reviewed changes](/radareorg/radare2/pull/22562/files/8698e5adfa1d5ae51b302959f675763920eb8c99)

[libr/debug/p/native/linux/linux\_coredump.c](/radareorg/radare2/pull/22562/files/8698e5adfa1d5ae51b302959f675763920eb8c99#diff-4b075a31af24e9fce39346f102f4eb4bef65ce19144bfd0a352135bb0206e922)
Outdated

Show resolved

Hide resolved

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae)

`[Apply suggestions from code review](/radareorg/radare2/pull/22562/commits/d4f2fba523174eb8b1a41dfd5c1fcc9fb5225f7d "Apply suggestions from code review")`

`[d4f2fba](/radareorg/radare2/pull/22562/commits/d4f2fba523174eb8b1a41dfd5c1fcc9fb5225f7d)`

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 15, 2024](#issuecomment-1945657150)

| i just tested your pr in local and i missed another wrong sizeof(region[2]). i have squahed the 32 commits into this separate PR and merged it under your name.  Thank you! |
| --- |

All reactions

Sorry, something went wrong.

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
closed this
[Feb 15, 2024](#event-11812471946)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Feb 15, 2024](#issuecomment-1945984340)

| i just tested your pr in local and i missed another wrong sizeof(region[2]). i have squahed the 32 commits into this separate PR and merged it under your name.  Thank you!  Can you tell me what the pr id is ? and due to the harm this vulnerability may cause, is it necessary to apply for a CVE for this vulnerability? |
| --- |

All reactions

Sorry, something went wrong.

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=80&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)

Copy link

Collaborator

### **[trufae](/trufae)** commented [Feb 15, 2024](#issuecomment-1946568009)

| This is the PR [#22599](https://github.com/radareorg/radare2/pull/22599) |
| --- |

All reactions

Sorry, something went wrong.

[![@Malayke](https://avatars.githubusercontent.com/u/4935500?s=40&v=4)](/Malayke)
[Malayke](/Malayke)
mentioned this pull request
[Dec 19, 2024](#ref-pullrequest-2749193577)

[[GHSA-6gq9-2wfh-4rj3] Buffer Overflow vulnerability in radarorg radare2 v.5.8.8...
github/advisory-database#5101](/github/advisory-database/pull/5101)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22562)

Reviewers

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&v=4)](/trufae) [trufae](/trufae)

trufae requested changes

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**5.9.0 - codename hyperborean**](/radareorg/radare2/milestone/73 "5.9.0 - codename hyperborean")

Development

Successfully merging this pull request may close these issues.

2 participants

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=52&v=4)](/Crispy-fried-chicken) [![@trufae](https://avatars.githubusercontent.com/u/6431515?s=52&v=4)](/trufae)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_bc175894_20250114_210332.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22599)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22599)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  849](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Safe #22599

 Merged

[trufae](/trufae)
merged 1 commit into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[safe](/radareorg/radare2/tree/safe "radareorg/radare2:safe")

Feb 15, 2024

 Merged

# [Safe](#top) #22599

[trufae](/trufae)
merged 1 commit into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[safe](/radareorg/radare2/tree/safe "radareorg/radare2:safe")

Feb 15, 2024

[Conversation
0](/radareorg/radare2/pull/22599)
[Commits
1](/radareorg/radare2/pull/22599/commits)
[Checks
40](/radareorg/radare2/pull/22599/checks)
[Files changed](/radareorg/radare2/pull/22599/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

Copy link

Collaborator

### @trufae **[trufae](/trufae)** commented [Feb 15, 2024](#issue-2135956496)

* Mark this if you consider it ready to merge
* I've added tests (optional)
* I wrote some lines in the [book](https://github.com/radareorg/radare2book) (optional)

**Description**

Sorry, something went wrong.

All reactions

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&v=4)](/Crispy-fried-chicken)

`[Use the safe r_str_scanf instead of scanf to parse gdb profile ##crash](/radareorg/radare2/pull/22599/commits/8bd69cacd973acac2f034bcaf2f75189d8f8c837 "Use the safe r_str_scanf instead of scanf to parse gdb profile ##crash")`

`[8bd69ca](/radareorg/radare2/pull/22599/commits/8bd69cacd973acac2f034bcaf2f75189d8f8c837)`

 [![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
[force-pushed](/radareorg/radare2/compare/980283d0b48323c22c0b850204f280574cd613e8..8bd69cacd973acac2f034bcaf2f75189d8f8c837)
the
safe

branch
from
[`980283d`](/radareorg/radare2/commit/980283d0b48323c22c0b850204f280574cd613e8) to
[`8bd69ca`](/radareorg/radare2/commit/8bd69cacd973acac2f034bcaf2f75189d8f8c837)  [Compare](/radareorg/radare2/compare/980283d0b48323c22c0b850204f280574cd613e8..8bd69cacd973acac2f034bcaf2f75189d8f8c837)
[February 15, 2024 09:08](#event-11812447150)

 Hide details
View details

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
merged commit [`38c8e5d`](/radareorg/radare2/commit/38c8e5ded67eed2c8a1f874e536d05fc3939fa29)
into
master

[Feb 15, 2024](https://github.com/radareorg/radare2/pull/22599#event-11812460784)
38 checks passed

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
mentioned this pull request
[Feb 15, 2024](#ref-pullrequest-2116520387)

[Use r\_str\_scanf as a safe alternative to fix gdb reg profile parsing bugs
#22562](/radareorg/radare2/pull/22562)
 Closed

 [![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
deleted the
safe

branch
[February 16, 2024 15:21](#event-11830252055)

[![@Malayke](https://avatars.githubusercontent.com/u/4935500?s=40&v=4)](/Malayke)
[Malayke](/Malayke)
mentioned this pull request
[Dec 19, 2024](#ref-pullrequest-2749193577)

[[GHSA-6gq9-2wfh-4rj3] Buffer Overflow vulnerability in radarorg radare2 v.5.8.8...
github/advisory-database#5101](/github/advisory-database/pull/5101)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22599)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=52&v=4)](/trufae) [![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=52&v=4)](/Crispy-fried-chicken)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_31c1f832_20250114_210330.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22572)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22572)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  849](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Implement scansets support in RStr.scanf ##util #22572

 Merged

[trufae](/trufae)
merged 1 commit into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[scanf-scanset](/radareorg/radare2/tree/scanf-scanset "radareorg/radare2:scanf-scanset")

Feb 7, 2024

 Merged

# [Implement scansets support in RStr.scanf ##util](#top) #22572

[trufae](/trufae)
merged 1 commit into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[scanf-scanset](/radareorg/radare2/tree/scanf-scanset "radareorg/radare2:scanf-scanset")

Feb 7, 2024

[Conversation
0](/radareorg/radare2/pull/22572)
[Commits
1](/radareorg/radare2/pull/22572/commits)
[Checks
40](/radareorg/radare2/pull/22572/checks)
[Files changed](/radareorg/radare2/pull/22572/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

Copy link

Collaborator

### @trufae **[trufae](/trufae)** commented [Feb 7, 2024](#issue-2123564556)

* Mark this if you consider it ready to merge
* I've added tests (optional)
* I wrote some lines in the [book](https://github.com/radareorg/radare2book) (optional)

**Description**

Sorry, something went wrong.

All reactions

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[Implement scansets support in RStr.scanf ##util](/radareorg/radare2/pull/22572/commits/54528e74f3e6500951b8e201b2244215732ef82b "Implement scansets support in RStr.scanf ##util")`

`[54528e7](/radareorg/radare2/pull/22572/commits/54528e74f3e6500951b8e201b2244215732ef82b)`

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
mentioned this pull request
[Feb 7, 2024](#ref-pullrequest-2116520387)

[Use r\_str\_scanf as a safe alternative to fix gdb reg profile parsing bugs
#22562](/radareorg/radare2/pull/22562)
 Closed

 Hide details
View details

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
merged commit [`c75ad89`](/radareorg/radare2/commit/c75ad89e5f4d1c53bb06f9c4dee174cc73aba30a)
into
master

[Feb 7, 2024](https://github.com/radareorg/radare2/pull/22572#event-11736159226)
40 checks passed

 [![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
deleted the
scanf-scanset

branch
[February 14, 2024 16:52](#event-11804537211)

[![@Malayke](https://avatars.githubusercontent.com/u/4935500?s=40&v=4)](/Malayke)
[Malayke](/Malayke)
mentioned this pull request
[Dec 19, 2024](#ref-pullrequest-2749193577)

[[GHSA-6gq9-2wfh-4rj3] Buffer Overflow vulnerability in radarorg radare2 v.5.8.8...
github/advisory-database#5101](/github/advisory-database/pull/5101)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22572)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=52&v=4)](/trufae) [![@radare](https://avatars.githubusercontent.com/u/917142?s=52&v=4)](/radare)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_846a82d1_20250114_210331.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22578)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22578)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=radareorg%2Fradare2)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[radareorg](/radareorg)
/
**[radare2](/radareorg/radare2)**
Public

* [Notifications](/login?return_to=%2Fradareorg%2Fradare2) You must be signed in to change notification settings
* [Fork
  3k](/login?return_to=%2Fradareorg%2Fradare2)
* [Star
   21k](/login?return_to=%2Fradareorg%2Fradare2)

* [Code](/radareorg/radare2)
* [Issues
  849](/radareorg/radare2/issues)
* [Pull requests
  26](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects
  0](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

Additional navigation options

* [Code](/radareorg/radare2)
* [Issues](/radareorg/radare2/issues)
* [Pull requests](/radareorg/radare2/pulls)
* [Discussions](/radareorg/radare2/discussions)
* [Actions](/radareorg/radare2/actions)
* [Projects](/radareorg/radare2/projects)
* [Security](/radareorg/radare2/security)
* [Insights](/radareorg/radare2/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fradareorg%2Fradare2%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Add tests and fix %c in r\_str\_scanf #22578

 Merged

[trufae](/trufae)
merged 2 commits into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[scanf2](/radareorg/radare2/tree/scanf2 "radareorg/radare2:scanf2")

Feb 8, 2024

 Merged

# [Add tests and fix %c in r\_str\_scanf](#top) #22578

[trufae](/trufae)
merged 2 commits into
[master](/radareorg/radare2/tree/master "radareorg/radare2:master")
from
[scanf2](/radareorg/radare2/tree/scanf2 "radareorg/radare2:scanf2")

Feb 8, 2024

[Conversation
0](/radareorg/radare2/pull/22578)
[Commits
2](/radareorg/radare2/pull/22578/commits)
[Checks
40](/radareorg/radare2/pull/22578/checks)
[Files changed](/radareorg/radare2/pull/22578/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![trufae](https://avatars.githubusercontent.com/u/6431515?s=60&v=4)](/trufae)

Copy link

Collaborator

### @trufae **[trufae](/trufae)** commented [Feb 8, 2024](#issue-2125573471)

* Mark this if you consider it ready to merge
* I've added tests (optional)
* I wrote some lines in the [book](https://github.com/radareorg/radare2book) (optional)

**Description**

Sorry, something went wrong.

All reactions

 [radare](/radare)
added 2 commits
[February 8, 2024 17:16](#commits-pushed-a9c1af3)

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[Add tests and fix %c in r_str_scanf](/radareorg/radare2/pull/22578/commits/a9c1af36ee1f5ed06c8e73465d5fa11e07972f8c "Add tests and fix %c in r_str_scanf")`

`[a9c1af3](/radareorg/radare2/pull/22578/commits/a9c1af36ee1f5ed06c8e73465d5fa11e07972f8c)`

[![@radare](https://avatars.githubusercontent.com/u/917142?s=40&v=4)](/radare)

`[add more tests](/radareorg/radare2/pull/22578/commits/eee850ffe08bec014bdd041e16465f00f7f53adf "add more tests")`

`[eee850f](/radareorg/radare2/pull/22578/commits/eee850ffe08bec014bdd041e16465f00f7f53adf)`

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
mentioned this pull request
[Feb 8, 2024](#ref-pullrequest-2116520387)

[Use r\_str\_scanf as a safe alternative to fix gdb reg profile parsing bugs
#22562](/radareorg/radare2/pull/22562)
 Closed

 Hide details
View details

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
merged commit [`f368c8c`](/radareorg/radare2/commit/f368c8ccdb03af307d37f1c6899b94b25a0306c7)
into
master

[Feb 8, 2024](https://github.com/radareorg/radare2/pull/22578#event-11748486249)
38 checks passed

 [![@trufae](https://avatars.githubusercontent.com/u/6431515?s=40&u=3cd535c1b15121d2a3faec6d57867b9d667cc696&v=4)](/trufae)
[trufae](/trufae)
deleted the
scanf2

branch
[February 14, 2024 16:52](#event-11804536214)

[![@Malayke](https://avatars.githubusercontent.com/u/4935500?s=40&v=4)](/Malayke)
[Malayke](/Malayke)
mentioned this pull request
[Dec 19, 2024](#ref-pullrequest-2749193577)

[[GHSA-6gq9-2wfh-4rj3] Buffer Overflow vulnerability in radarorg radare2 v.5.8.8...
github/advisory-database#5101](/github/advisory-database/pull/5101)
 Open

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fradareorg%2Fradare2%2Fpull%2F22578)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@trufae](https://avatars.githubusercontent.com/u/6431515?s=52&v=4)](/trufae) [![@radare](https://avatars.githubusercontent.com/u/917142?s=52&v=4)](/radare)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


