Based on the provided information, here's a breakdown of the vulnerability:

**Root Cause:**

*   The vulnerability stems from an integer overflow in the `freerdp_bitmap_planar_context_reset` function within the FreeRDP library.

**Weaknesses/Vulnerabilities:**

*   **Integer Overflow:** The calculation of `context->maxPlaneSize` involves multiplying `context->maxWidth` and `context->maxHeight`. These values are derived from the width and height parameters, respectively, of the bitmap being processed. If the resulting product exceeds the maximum value that can be stored in a `UINT32` (32 bit unsigned integer), an integer overflow occurs. This results in a smaller `maxPlaneSize` value than expected.
*   **Heap Overflow:** This incorrect `maxPlaneSize` is later used in `winpr_aligned_recalloc` to allocate memory. When the subsequent processing attempts to write data into the buffer, it can overflow due to the undersized buffer, leading to a heap-based buffer overflow.

**Impact of Exploitation:**

*   A malicious RDP server can exploit this vulnerability by sending a specially crafted `RDPGFX_RESET_GRAPHICS_PDU` that causes an integer overflow in the `freerdp_bitmap_planar_context_reset` function.
*   This can cause a heap buffer overflow, potentially allowing an attacker to overwrite memory and achieve arbitrary code execution on the client machine.
*   The data written to the overflowed buffer is image data, so it is only possible to display the data on the screen, it is not possible to extract data over the network.

**Attack Vectors:**

*   The attack vector is through a malicious RDP server. The server sends a crafted `RDPGFX_RESET_GRAPHICS_PDU` message to the client, triggering the vulnerability.

**Required Attacker Capabilities/Position:**

*   The attacker needs to control the RDP server and be able to send malicious RDP messages to the client. This requires a "man-in-the-middle" position.

**Additional Information:**

*   **Affected Software:** FreeRDP clients (xfreerdp & wlfreerdp).
*   **Unaffected:** FreeRDP server implementations and proxy (as the proxy only relays the gfx channel data and does not decode it.)
*   **Patched Versions:** The vulnerability is fixed in FreeRDP versions 2.11.5 and 3.2.0 and later.
*   **Fix:** The fix involves adding a check to ensure the result of the multiplication `(UINT64)context->maxWidth * context->maxHeight` does not overflow the `UINT32` type.
*   **CVE ID:** CVE-2024-22211
*   **Severity:** Low, as per GitHub security advisory.
*  **Reporter:** hareh4ru

The provided content gives more detail than the CVE description by explaining the root cause, how the integer overflow leads to a heap buffer overflow and provides a proof of concept.