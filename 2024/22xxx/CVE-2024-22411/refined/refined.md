Based on the provided information, here's an analysis of CVE-2024-22411:

**Root cause of vulnerability:**
- The vulnerability stems from the lack of sanitization of HTML content within action messages in the Avo framework. Specifically, when text containing HTML is passed to the `error` or `succeed` methods of an `Avo::BaseAction` subclass, it's rendered directly in the UI toast/notification without sanitization.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS): The primary vulnerability is XSS, which occurs because user-supplied input (in this case, within action messages) is not properly sanitized before being rendered in the browser.

**Impact of exploitation:**
- An attacker could inject malicious HTML and JavaScript code into action messages. When a user triggers an action, this code could be executed in the user's browser, potentially leading to:
    - Session hijacking
    - Stealing sensitive information
    - Defacing the web application
    - Performing actions on behalf of the user

**Attack vectors:**
- An attacker would need to be able to create or modify action messages within the Avo framework. This could be achieved by:
   -  Compromising a user account with permissions to define or modify actions
   -  Exploiting other vulnerabilities that allow code injection

**Required attacker capabilities/position:**
- An attacker needs the ability to influence the content of the messages displayed by the Avo framework's action system. They would need sufficient permissions to create or modify actions, or leverage another vulnerability to inject malicious code. The attacker's position can be that of an authenticated user with the ability to define or modify Avo actions.

**Additional Information:**
- The provided content contains a proof-of-concept (PoC) demonstrating the XSS vulnerability by injecting a script tag within an action message.
- The vulnerability is classified as "moderate" severity.
- The fix involves using `DOMPurify.sanitize` to sanitize the key and value in the key\_value\_controller.js, which is also reflected in the commits included in the content.
- The vulnerability was reported by stevegeek.
- The affected versions of the Avo framework include 3.0.0.pre12, with the patched version being 3.0.0.
- This vulnerability is related to CWE-80 (Improper Neutralization of Script-Related HTML Tags in a Web Page).