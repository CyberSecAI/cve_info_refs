=== Content from github.com_64041744_20250115_092307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fclerk%2Fjavascript%2Fsecurity%2Fadvisories%2FGHSA-q6w5-jg5q-47vg)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fclerk%2Fjavascript%2Fsecurity%2Fadvisories%2FGHSA-q6w5-jg5q-47vg)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=clerk%2Fjavascript)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[clerk](/clerk)
/
**[javascript](/clerk/javascript)**
Public

* [Notifications](/login?return_to=%2Fclerk%2Fjavascript) You must be signed in to change notification settings
* [Fork
  289](/login?return_to=%2Fclerk%2Fjavascript)
* [Star
   1.3k](/login?return_to=%2Fclerk%2Fjavascript)

* [Code](/clerk/javascript)
* [Issues
  31](/clerk/javascript/issues)
* [Pull requests
  37](/clerk/javascript/pulls)
* [Discussions](/clerk/javascript/discussions)
* [Actions](/clerk/javascript/actions)
* [Projects
  0](/clerk/javascript/projects)
* [Security](/clerk/javascript/security)
* [Insights](/clerk/javascript/pulse)

Additional navigation options

* [Code](/clerk/javascript)
* [Issues](/clerk/javascript/issues)
* [Pull requests](/clerk/javascript/pulls)
* [Discussions](/clerk/javascript/discussions)
* [Actions](/clerk/javascript/actions)
* [Projects](/clerk/javascript/projects)
* [Security](/clerk/javascript/security)
* [Insights](/clerk/javascript/pulse)

# @clerk/nextjs auth() and getAuth() methods vulnerable to insecure direct object reference (IDOR)

Critical

[zythosec](/zythosec)
published
GHSA-q6w5-jg5q-47vg
Jan 12, 2024

## Package

npm

@clerk/nextjs
([npm](/advisories?query=ecosystem%3Anpm))

## Affected versions

>= 4.7.0, < 4.29.3

## Patched versions

4.29.3

## Description

### Impact

Unauthorized access or privilege escalation due to a logic flaw in `auth()` in the App Router or `getAuth()` in the Pages Router.

### Affected Versions

All applications that that use `@clerk/nextjs` versions in the range of `>= 4.7.0`,`< 4.29.3` in a Next.js backend to authenticate API Routes, App Router, or Route handlers. Specifically, those that call `auth()` in the App Router or `getAuth()` in the Pages Router. Only the `@clerk/nextjs` SDK is impacted. Other SDKs, including other Javascript-based SDKs, are not impacted.

### Patches

Fix included in `@clerk/nextjs@4.29.3`.

### References

* <https://clerk.com/changelog/2024-01-12>
* [https://github.com/clerk/javascript/releases/tag/%40clerk%2Fnextjs%404.29.3](https://github.com/clerk/javascript/releases/tag/%40clerk/nextjs%404.29.3)

### Severity

Critical

### CVE ID

CVE-2024-22206

### Weaknesses

[CWE-284](/advisories?query=cwe%3A284) [CWE-287](/advisories?query=cwe%3A287) [CWE-639](/advisories?query=cwe%3A639)

### Credits

* [![@nikosdouvlis](https://avatars.githubusercontent.com/u/1811063?s=40&v=4)](/nikosdouvlis)
  [nikosdouvlis](/nikosdouvlis)
  Remediation developer
* [![@SokratisVidros](https://avatars.githubusercontent.com/u/1352422?s=40&v=4)](/SokratisVidros)
  [SokratisVidros](/SokratisVidros)
  Reporter
* [![@colinclerk](https://avatars.githubusercontent.com/u/51144033?s=40&v=4)](/colinclerk)
  [colinclerk](/colinclerk)
  Coordinator
* [![@agis](https://avatars.githubusercontent.com/u/827224?s=40&v=4)](/agis)
  [agis](/agis)
  Remediation developer
* [![@braden-clerk](https://avatars.githubusercontent.com/u/64913815?s=40&v=4)](/braden-clerk)
  [braden-clerk](/braden-clerk)
  Coordinator
* [![@brkalow](https://avatars.githubusercontent.com/u/1289701?s=40&v=4)](/brkalow)
  [brkalow](/brkalow)
  Remediation developer

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_85444e4d_20250115_092307.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fclerk%2Fjavascript%2Freleases%2Ftag%2F%2540clerk%252Fnextjs%25404.29.3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fclerk%2Fjavascript%2Freleases%2Ftag%2F%2540clerk%252Fnextjs%25404.29.3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Freleases%2Fshow&source=header-repo&source_repo=clerk%2Fjavascript)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[clerk](/clerk)
/
**[javascript](/clerk/javascript)**
Public

* [Notifications](/login?return_to=%2Fclerk%2Fjavascript) You must be signed in to change notification settings
* [Fork
  289](/login?return_to=%2Fclerk%2Fjavascript)
* [Star
   1.3k](/login?return_to=%2Fclerk%2Fjavascript)

* [Code](/clerk/javascript/tree/%40clerk/nextjs%404.29.3)
* [Issues
  31](/clerk/javascript/issues)
* [Pull requests
  37](/clerk/javascript/pulls)
* [Discussions](/clerk/javascript/discussions)
* [Actions](/clerk/javascript/actions)
* [Projects
  0](/clerk/javascript/projects)
* [Security](/clerk/javascript/security)
* [Insights](/clerk/javascript/pulse)

Additional navigation options

* [Code](/clerk/javascript/tree/%40clerk/nextjs%404.29.3)
* [Issues](/clerk/javascript/issues)
* [Pull requests](/clerk/javascript/pulls)
* [Discussions](/clerk/javascript/discussions)
* [Actions](/clerk/javascript/actions)
* [Projects](/clerk/javascript/projects)
* [Security](/clerk/javascript/security)
* [Insights](/clerk/javascript/pulse)

1. [Releases](/clerk/javascript/releases)
2. [@clerk/nextjs@4.29.3](/clerk/javascript/releases/tag/%40clerk/nextjs%404.29.3)

# @clerk/nextjs@4.29.3

 Compare

Choose a tag to compare

Could not load tags

Nothing to show

[{{ refName }}
default](/clerk/javascript/compare/%7B%7B%20urlEncodedRefName%20%7D%7D...%40clerk/nextjs%404.29.3)

 Loading

[View all tags](/clerk/javascript/tags)

![@clerk-cookie](https://avatars.githubusercontent.com/u/136073014?s=40&v=4)
[clerk-cookie](/clerk-cookie)
released this
12 Jan 17:32

·
[2251 commits](/clerk/javascript/compare/%40clerk/nextjs%404.29.3...main)
to main
since this release

[@clerk/nextjs@4.29.3](/clerk/javascript/tree/%40clerk/nextjs%404.29.3)

[`18aba58`](/clerk/javascript/commit/18aba588b53bf08a339ca890933c1e0b6a88c870)

This commit was created on GitHub.com and signed with GitHub’s **verified signature**.
The key has expired.

GPG key ID: 4AEE18F83AFDEB23
Expired

[Learn about vigilant mode](https://docs.github.com/github/authenticating-to-github/displaying-verification-statuses-for-all-of-your-commits).

### Patch Changes

* Replace the `Clerk-Backend-SDK` header with `User-Agent` in BAPI requests and update it's value to contain both the package name and the package version of the clerk package ([#2579](https://github.com/clerk/javascript/pull/2579)) by [@nikosdouvlis](https://github.com/nikosdouvlis)

  executing the request. Eg request from `@clerk/nextjs` to BAPI with append `User-Agent: @clerk/nextjs@5.0.0-alpha-v5.16` using the latest version.

  Miscellaneous changes: The backend test build changed to use tsup.
* Updated dependencies [[`c59a2d4a2`](https://github.com/clerk/javascript/commit/c59a2d4a22166076340b3c5c5e20c112a138acbe), [`2a615bf98`](https://github.com/clerk/javascript/commit/2a615bf98a22250c9105671ce72bf5374602802f)]:

  + @clerk/clerk-sdk-node@4.13.6
  + @clerk/backend@0.37.2

 Assets
2

 Loading

All reactions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from clerk.com_cfa79707_20250115_092306.html ===
[Skip to main content](#main)

* Product
* [Docs](/docs)
* [Changelog](/changelog)
* [Pricing](/pricing)
* Company
Sign in[Get started](https://dashboard.clerk.com/sign-up?redirect_url=https%3A%2F%2Fdashboard.clerk.com%2F)[Get started](https://dashboard.clerk.com/sign-up?redirect_url=https%3A%2F%2Fdashboard.clerk.com%2F)Sign out[Dashboard](https://dashboard.clerk.com)[Dashboard](https://dashboard.clerk.com)[Back to changelog](/changelog)Jan 12
# Critical security vulnerability in @clerk/nextjs

CategorySecurityPublishedJan 12

Please upgrade immediately to 4.29.3

![](/_next/image?url=%2F_next%2Fstatic%2Fmedia%2F_changelog%2F2024-01-12%2Fimage.jpg&w=3840&q=75&dpl=dpl_6UHPeNXLYyz1hdBGufJuD6fYX2av)

The Clerk team recently identified and patched a critical security vulnerability
in the **@clerk/nextjs** SDK that allows malicious actors to gain privileged
access or act-on-behalf-of other users.

**If you use @clerk/nextjs, please upgrade immediately to 4.29.3**

In addition to releasing this patch, we have collaborated with a number of cloud providers to mitigate attacks at the network layer. Below, you will find details about these mitigations, as well as additional details about the vulnerability, and our plans to prevent future reoccurrence.

## [Proactive network layer mitigation](#proactive-network-layer-mitigation)

Upon discovery of the vulnerability, we immediately recognized its severity and reached out to cloud infrastructure providers for help protecting our customers’ applications.

We are pleased to share that Vercel, Netlify, and Cloudflare have deployed mitigations at the network layer. **Applications using these providers are already protected.** We are incredibly grateful for their fast response and close collaboration to reach the best possible resolution.

It is important to understand that these mitigations are not permanent, and should not be seen as a substitute for immediately upgrading your SDK.

## [Additional details](#additional-details)

* The vulnerability was discovered on Tuesday, January 9 during an internal audit.
* The vulnerability impacts **@clerk/nextjs** version 4.7.0 to 4.29.2.
* The vulnerability impacts applications that use a Next.js backend. Specifically, those that call `auth()` in the App Router, or `getAuth()` in the Pages Router.
* Applications that only use Next.js for its frontend and middleware functionality are not impacted.
* Only the **@clerk/nextjs** SDK is impacted. Other SDKs, including other Javascript-based SDKs, are not impacted.
* While we are not aware of any exploit, we unfortunately cannot be sure without access to the server’s logs. Detailed instructions for inspecting logs for an attack will be made available to impacted customers who request them, but will not be published publicly. Please email security@clerk.dev if you would like those instructions.
* For the avoidance of doubt, the vulnerability does not grant unauthorized access to Clerk's systems.

## [Preventing reoccurrence](#preventing-reoccurrence)

Security is Clerk’s most important responsibility, and we are continually improving our processes to ensure your application and your users remain safe.

Along with releasing this patch, we have already updated our internal test suites to ensure this particular vulnerability will not be introduced again, or into any other Clerk framework SDK.

In the coming weeks, we will conduct a full post-mortem, which we expect to generate additional preventive measures.

These steps are in addition to our regular independent security audits of our codebase, regular penetration testing, and the continual reports we receive from external security researchers. If you believe you have found a security vulnerability, please report it to us through our [vulnerability disclosure program⁠](https://clerk.com/docs/security/vulnerability-disclosure-policy).

## [Additional support is available](#additional-support-is-available)

If you have questions or concerns, please do not hesitate to reach out to security@clerk.dev.

![](/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Fcolin-sidoti.7b63e682.png&w=48&q=75&dpl=dpl_6UHPeNXLYyz1hdBGufJuD6fYX2av)ContributorColin SidotiCopy linkCopied!

* Product
  + [Components](/docs/components/overview)
  + [Pricing](/pricing)
  + [Dashboard](https://dashboard.clerk.com)
  + [Feature requests](https://feedback.clerk.com)
* Developers
  + [Documentation](/docs)
  + [Discord server](https://clerk.com/discord)
  + [Support](/contact/support)
  + [Glossary](/glossary)
  + [Changelog](/changelog)
* Company
  + [About](/company)
  + [Careers](https://jobs.ashbyhq.com/clerk)
  + [Blog](/blog)
  + [Contact](/contact)
* Legal
  + [Terms and Conditions](/legal/terms)
  + [Privacy Policy](/legal/privacy)
  + [Data Processing Agreement](/legal/dpa)
  + Do Not Sell/Share My Info
  + Cookie manager

© 2025 Clerk, Inc.

Support
