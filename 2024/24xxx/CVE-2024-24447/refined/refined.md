```
{
  "vulnerability": {
    "CVE": "CVE-2024-24447",
    "CWE": "CWE-121",
    "description": "Stack-based memcpy buffer overflow in the ngap_handle_pdu_session_resource_setup_response routine in OpenAirInterface CN5G AMF <= 2.0.0 allows a remote attacker with access to the N2 interface to carry out denial of service against the AMF and potentially execute code by sending a PDU Session Resource Setup Response with a ResourceFailedToSetupList containing zero elements.",
    "affected_component": "OpenAirInterface CN5G AMF",
    "affected_versions": "<= 2.0.0",
    "root_cause": "The vulnerability lies in the `ngap_amf_handle_pdu_session_resource_setup_response` function where a `memcpy` is performed using data from `list_fail[0]`, without validating if `list_fail` has at least one element. This leads to an out-of-bounds read when accessing `list_fail[0]` if the list is empty.",
    "vulnerability": "Stack-based buffer overflow due to missing check for empty `FailedToSetupList` when handling PDU Session Resource Setup Response.",
    "impact": "An attacker can cause a denial-of-service (DoS) against the AMF and potentially execute code.",
    "attack_vector": "The attack vector is remote via the N2 interface. An attacker with access to the N2 interface can send a crafted PDU Session Resource Setup Response with a `ResourceFailedToSetupList` containing zero elements.",
    "attacker_capabilities": "The attacker requires network access to the N2 interface.",
    "additional_information": "The vulnerability is located in `src/ngap/ngap_app/ngap_message_callback.hpp`."
  }
}
```