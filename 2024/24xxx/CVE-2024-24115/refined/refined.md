- **Root cause of vulnerability**: Improper input sanitization when editing pages with the 'html' parser enabled, leading to stored XSS.
- **Weaknesses/vulnerabilities present**: Stored Cross-Site Scripting (XSS) vulnerability (CWE-79).
- **Impact of exploitation**: A malicious user with page editing privileges can inject malicious JavaScript code into a page. When another user, including an administrator, views the page, the script executes, allowing the attacker to steal session cookies. This can lead to full control of the CMS due to privilege escalation.
- **Attack vectors**: A user with page editing permissions injects malicious JavaScript into a page while the page parser is set to 'none'. Then, the attacker, or another user, edits the page and changes the parser to 'html' which renders the stored JavaScript. When a victim visits the page, the malicious script is executed in their browser.
- **Required attacker capabilities/position**: The attacker must be a member of a group that can edit Pages (e.g., moderator). They need access to the CMS to edit pages and change the parser settings.