The content is related to CVE-2024-24574.

**Root cause of vulnerability:**
The vulnerability stems from the unsafe rendering of attachment filenames in `phpMyFAQ\phpmyfaq\admin\attachments.php`. Specifically, the `$item->filename` was being directly echoed without any sanitization, allowing for the injection of malicious code.

**Weaknesses/vulnerabilities present:**
- Cross-Site Scripting (XSS): The application was vulnerable to stored XSS due to the lack of sanitization of the attachment filename before rendering it in HTML.

**Impact of exploitation:**
- An attacker with permission to upload attachments can inject malicious JavaScript code into the database via the attachment filename.
- This malicious code is then executed in the browsers of other users who view the attachments page, potentially leading to various attacks such as:
    - Stealing of user cookies (although HttpOnly mitigates this)
    - Crashing the application with a looping JavaScript payload
    - Other client-side attacks depending on the injected payload.

**Attack vectors:**
- An attacker with the necessary permissions uploads an attachment via `http://{base_url}/admin/?action=editentry`.
- During the upload process at the endpoint `/admin/index.php?action=ajax&ajax=att&ajaxaction=upload`, the attacker modifies the `filename` parameter to include an XSS payload.
- When the attachment is listed in the attachments page at `/admin/?action=attachments`, the stored XSS payload is executed.

**Required attacker capabilities/position:**
- The attacker needs to have the permission to upload attachments, which typically means having access to the admin interface and the required privileges.