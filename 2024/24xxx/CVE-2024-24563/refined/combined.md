=== Content from github.com_3b5bd924_20250114_231953.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fsecurity%2Fadvisories%2FGHSA-52xq-j7v9-v4v2)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fsecurity%2Fadvisories%2FGHSA-52xq-j7v9-v4v2)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=vyperlang%2Fvyper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vyperlang](/vyperlang)
/
**[vyper](/vyperlang/vyper)**
Public

* [Notifications](/login?return_to=%2Fvyperlang%2Fvyper) You must be signed in to change notification settings
* [Fork
  818](/login?return_to=%2Fvyperlang%2Fvyper)
* [Star
   5k](/login?return_to=%2Fvyperlang%2Fvyper)

* [Code](/vyperlang/vyper)
* [Issues
  407](/vyperlang/vyper/issues)
* [Pull requests
  82](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects
  0](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

Additional navigation options

* [Code](/vyperlang/vyper)
* [Issues](/vyperlang/vyper/issues)
* [Pull requests](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

# negative array index bounds checks

Moderate

[charles-cooper](/charles-cooper)
published
GHSA-52xq-j7v9-v4v2
Feb 7, 2024

## Package

pip

vyper
([pip](/advisories?query=ecosystem%3Apip))

## Affected versions

<=0.3.10

## Patched versions

0.4.0

## Description

### Summary

Arrays can be keyed by a signed integer, while they are defined for unsigned integers only. The typechecker doesn't throw when spotting the usage of an `int` as an index for an array. Typically, negative integers are filtered out at runtime by the bounds checker, but small enough (i.e. large in magnitude, ex. `-2**255 + 5`) quantities combined with large enough arrays (at least `2**255` in length) can pass the bounds checker, resulting in unexpected behavior.

A contract search was performed, and no production contracts were found to be impacted.

### Details

The typechecker allows the usage of signed integers to be used as indexes to arrays. The vulnerability is present in different forms in all versions. Here is an example from `0.3.10`:

[vyper/vyper/semantics/types/subscriptable.py](https://github.com/vyperlang/vyper/blob/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics/types/subscriptable.py#L127-L137)

Lines 127 to 137
in
[c150fc4](/vyperlang/vyper/commit/c150fc49ee9375a930d177044559b83cb95f7963)

|  | def validate\_index\_type(self, node): |
| --- | --- |
|  | # TODO break this cycle |
|  | from vyper.semantics.analysis.utils import validate\_expected\_type |
|  |  |
|  | if isinstance(node, vy\_ast.Int): |
|  | if node.value < 0: |
|  | raise ArrayIndexException("Vyper does not support negative indexing", node) |
|  | if node.value >= self.length: |
|  | raise ArrayIndexException("Index out of range", node) |
|  |  |
|  | validate\_expected\_type(node, IntegerT.any()) |

As can be seen, the validation is performed against `IntegerT.any()`.

### PoC

If the array is sufficiently large, it can be indexed with a negative value:

```
arr: public(uint256[MAX_UINT256])

@external
def set(idx: int256, num: uint256):
    self.arr[idx] = num
```

For signed integers, the 2's complement representation is used. Because the array was declared very large, the bounds checking will pass (negative values will simply be represented as very large numbers):

[vyper/vyper/codegen/core.py](https://github.com/vyperlang/vyper/blob/a1fd228cb9936c3e4bbca6f3ee3fb4426ef45490/vyper/codegen/core.py#L534-L541)

Lines 534 to 541
in
[a1fd228](/vyperlang/vyper/commit/a1fd228cb9936c3e4bbca6f3ee3fb4426ef45490)

|  | is\_darray = isinstance(parent.typ, DArrayT) |
| --- | --- |
|  | bound = get\_dyn\_array\_count(parent) if is\_darray else parent.typ.count |
|  | # uclamplt works, even for signed ints. since two's-complement |
|  | # is used, if the index is negative, (unsigned) LT will interpret |
|  | # it as a very large number, larger than any practical value for |
|  | # an array index, and the clamp will throw an error. |
|  | # NOTE: there are optimization rules for this when ix or bound is literal |
|  | ix = clamp("lt", ix, bound) |

### Patches

Patched in [#3817](https://github.com/vyperlang/vyper/pull/3817).

### Impact

There are two potential vulnerability classes: unpredictable behavior and accessing inaccessible elements.

1. If it is possible to index an array with a negative integer without reverting, this is most likely not anticipated by the developer and such accesses can cause unpredictable behavior for the contract.
2. If a contract has an invariant in the form `assert index < x` where both `index` and `x` are signed integers, the developer might suppose that no elements on indexes `y | y >= x` are accessible. However, by using negative indexes this can be bypassed.

The contract search found no production contracts impacted by these two classes of issues.

### Severity

Moderate

### CVE ID

CVE-2024-24563

### Weaknesses

No CWEs

### Credits

* [![@cyberthirst](https://avatars.githubusercontent.com/u/16179769?s=40&v=4)](/cyberthirst)
  [cyberthirst](/cyberthirst)
  Coordinator
* [![@iFrostizz](https://avatars.githubusercontent.com/u/51274081?s=40&v=4)](/iFrostizz)
  [iFrostizz](/iFrostizz)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_c83e882e_20250114_231951.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fblob%2Fc150fc49ee9375a930d177044559b83cb95f7963%2Fvyper%2Fsemantics%2Ftypes%2Fsubscriptable.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fblob%2Fc150fc49ee9375a930d177044559b83cb95f7963%2Fvyper%2Fsemantics%2Ftypes%2Fsubscriptable.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=vyperlang%2Fvyper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vyperlang](/vyperlang)
/
**[vyper](/vyperlang/vyper)**
Public

* [Notifications](/login?return_to=%2Fvyperlang%2Fvyper) You must be signed in to change notification settings
* [Fork
  818](/login?return_to=%2Fvyperlang%2Fvyper)
* [Star
   5k](/login?return_to=%2Fvyperlang%2Fvyper)

* [Code](/vyperlang/vyper)
* [Issues
  407](/vyperlang/vyper/issues)
* [Pull requests
  82](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects
  0](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

Additional navigation options

* [Code](/vyperlang/vyper)
* [Issues](/vyperlang/vyper/issues)
* [Pull requests](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

## Files

 c150fc4
## Breadcrumbs

1. [vyper](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963)
2. /[vyper](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963/vyper)
3. /[semantics](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics)
4. /[types](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics/types)
/
# subscriptable.py

Copy path Blame  Blame
## Latest commit

## History

[History](/vyperlang/vyper/commits/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics/types/subscriptable.py)379 lines (291 loc) · 11.8 KB c150fc4
## Breadcrumbs

1. [vyper](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963)
2. /[vyper](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963/vyper)
3. /[semantics](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics)
4. /[types](/vyperlang/vyper/tree/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics/types)
/
# subscriptable.py

Top
## File metadata and controls

* Code
* Blame

379 lines (291 loc) · 11.8 KB[Raw](https://github.com/vyperlang/vyper/raw/c150fc49ee9375a930d177044559b83cb95f7963/vyper/semantics/types/subscriptable.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379import warningsfrom typing import Any, Dict, Optional, Tuple
from vyper import ast as vy\_astfrom vyper.abi\_types import ABI\_DynamicArray, ABI\_StaticArray, ABI\_Tuple, ABITypefrom vyper.exceptions import ArrayIndexException, InvalidType, StructureExceptionfrom vyper.semantics.data\_locations import DataLocationfrom vyper.semantics.types.base import VyperTypefrom vyper.semantics.types.primitives import IntegerTfrom vyper.semantics.types.shortcuts import UINT256\_Tfrom vyper.semantics.types.utils import get\_index\_value, type\_from\_annotation
class \_SubscriptableT(VyperType): """ Base class for subscriptable types such as arrays and mappings.
 Attributes ---------- key\_type: VyperType Type representing the index for this object. value\_type : VyperType Type representing the value(s) contained in this object. """
 def \_\_init\_\_(self, key\_type: VyperType, value\_type: VyperType) -> None: super().\_\_init\_\_() self.key\_type = key\_type self.value\_type = value\_type
 @property def getter\_signature(self) -> Tuple[Tuple, Optional[VyperType]]: child\_keys, return\_type = self.value\_type.getter\_signature return (self.key\_type,) + child\_keys, return\_type
 def validate\_index\_type(self, node): # TODO: break this cycle from vyper.semantics.analysis.utils import validate\_expected\_type
 validate\_expected\_type(node, self.key\_type)
class HashMapT(\_SubscriptableT): \_id = "HashMap"
 \_equality\_attrs = ("key\_type", "value\_type")
 # disallow everything but storage \_invalid\_locations = ( DataLocation.UNSET, DataLocation.CALLDATA, DataLocation.CODE, DataLocation.MEMORY, )
 def \_\_repr\_\_(self): return f"HashMap[{self.key\_type}, {self.value\_type}]"
 # TODO not sure this is used? def compare\_type(self, other): return ( super().compare\_type(other) and self.key\_type == other.key\_type and self.value\_type == other.value\_type )
 def get\_subscripted\_type(self, node): return self.value\_type
 @classmethod def from\_annotation(cls, node: vy\_ast.Subscript) -> "HashMapT": if ( not isinstance(node, vy\_ast.Subscript) or not isinstance(node.slice, vy\_ast.Index) or not isinstance(node.slice.value, vy\_ast.Tuple) or len(node.slice.value.elements) != 2 ): raise StructureException( ( "HashMap must be defined with a key type and a value type, " "e.g. my\_hashmap: HashMap[k, v]" ), node, )
 k\_ast, v\_ast = node.slice.value.elements key\_type = type\_from\_annotation(k\_ast, DataLocation.STORAGE) if not key\_type.\_as\_hashmap\_key: raise InvalidType("can only use primitive types as HashMap key!", k\_ast)
 value\_type = type\_from\_annotation(v\_ast, DataLocation.STORAGE)
 return cls(key\_type, value\_type)
class \_SequenceT(\_SubscriptableT): """ Private base class for sequence types (i.e., index is an int)
 Arguments --------- length : int Number of items in the type. """
 \_equality\_attrs: tuple = ("value\_type", "length")
 \_is\_array\_type: bool = True
 def \_\_init\_\_(self, value\_type: VyperType, length: int): if not 0 < length < 2\*\*256: raise InvalidType("Array length is invalid")
 if length >= 2\*\*64: warnings.warn("Use of large arrays can be unsafe!", stacklevel=2)
 super().\_\_init\_\_(UINT256\_T, value\_type) self.length = length
 @property def count(self): """ Alias for API compatibility """ return self.length
 def validate\_index\_type(self, node): # TODO break this cycle from vyper.semantics.analysis.utils import validate\_expected\_type
 if isinstance(node, vy\_ast.Int): if node.value < 0: raise ArrayIndexException("Vyper does not support negative indexing", node) if node.value >= self.length: raise ArrayIndexException("Index out of range", node)
 validate\_expected\_type(node, IntegerT.any())
 def get\_subscripted\_type(self, node): return self.value\_type
# override value at `k` with `val`, but inserting it before other keys# for formatting reasons. besides insertion order, equivalent to# `{k: val, \*\*xs}`def \_set\_first\_key(xs: Dict[str, Any], k: str, val: Any) -> dict: xs.pop(k, None) return {k: val, \*\*xs}
class SArrayT(\_SequenceT): """ Static array type """
 def \_\_init\_\_(self, value\_type: VyperType, length: int) -> None: super().\_\_init\_\_(value\_type, length)
 def \_\_repr\_\_(self): return f"{self.value\_type}[{self.length}]"
 @property def \_as\_array(self): # a static array is arrayable if its value\_type is arrayble. return self.value\_type.\_as\_array
 @property def abi\_type(self) -> ABIType: return ABI\_StaticArray(self.value\_type.abi\_type, self.length)
 def to\_abi\_arg(self, name: str = "") -> Dict[str, Any]: ret = self.value\_type.to\_abi\_arg() # modify the child name in place ret["type"] += f"[{self.length}]" return \_set\_first\_key(ret, "name", name)
 # TODO rename to `memory\_bytes\_required` @property def size\_in\_bytes(self): return self.value\_type.size\_in\_bytes \* self.length
 @property def subtype(self): """ Alias for API compatibility with codegen """ return self.value\_type
 def get\_subscripted\_type(self, node): return self.value\_type
 def compare\_type(self, other): if not isinstance(self, type(other)): return False if self.length != other.length: return False return self.value\_type.compare\_type(other.value\_type)
 @classmethod def from\_annotation(cls, node: vy\_ast.Subscript) -> "SArrayT": if not isinstance(node, vy\_ast.Subscript) or not isinstance(node.slice, vy\_ast.Index): raise StructureException( "Arrays must be defined with base type and length, e.g. bool[5]", node )
 value\_type = type\_from\_annotation(node.value)
 if not value\_type.\_as\_array: raise StructureException(f"arrays of {value\_type} are not allowed!")
 # note: validates index is a vy\_ast.Int. length = get\_index\_value(node.slice) return cls(value\_type, length)
class DArrayT(\_SequenceT): """ Dynamic array type """
 \_valid\_literal = (vy\_ast.List,) \_as\_array = True \_id = "DynArray"
 def \_\_init\_\_(self, value\_type: VyperType, length: int) -> None: super().\_\_init\_\_(value\_type, length)
 from vyper.semantics.types.function import MemberFunctionT
 self.add\_member("append", MemberFunctionT(self, "append", [self.value\_type], None, True)) self.add\_member("pop", MemberFunctionT(self, "pop", [], self.value\_type, True))
 def \_\_repr\_\_(self): return f"DynArray[{self.value\_type}, {self.length}]"
 @property def subtype(self): """ Alias for backwards compatibility. """ return self.value\_type
 @property def count(self): """ Alias for backwards compatibility. """ return self.length
 @property def abi\_type(self) -> ABIType: return ABI\_DynamicArray(self.value\_type.abi\_type, self.length)
 def to\_abi\_arg(self, name: str = "") -> Dict[str, Any]: ret = self.value\_type.to\_abi\_arg() # modify the child name in place. ret["type"] += "[]" return \_set\_first\_key(ret, "name", name)
 # TODO rename me to memory\_bytes\_required @property def size\_in\_bytes(self): # one length word + size of the array items return 32 + self.value\_type.size\_in\_bytes \* self.length
 def compare\_type(self, other): # TODO allow static array to be assigned to dyn array? # if not isinstance(other, (DArrayT, SArrayT)): if not isinstance(self, type(other)): return False if self.length < other.length: return False return self.value\_type.compare\_type(other.value\_type)
 @classmethod def from\_annotation(cls, node: vy\_ast.Subscript) -> "DArrayT": # common error message, different ast locations err\_msg = "DynArray must be defined with base type and max length, e.g. DynArray[bool, 5]"
 if not isinstance(node, vy\_ast.Subscript): raise StructureException(err\_msg, node)
 if ( not isinstance(node.slice, vy\_ast.Index) or not isinstance(node.slice.value, vy\_ast.Tuple) or len(node.slice.value.elements) != 2 ): raise StructureException(err\_msg, node.slice)
 length\_node = node.slice.value.elements[1] if length\_node.has\_folded\_value: length\_node = length\_node.get\_folded\_value()
 if not isinstance(length\_node, vy\_ast.Int): raise StructureException(err\_msg, length\_node)
 length = length\_node.value
 value\_node = node.slice.value.elements[0] value\_type = type\_from\_annotation(value\_node) if not value\_type.\_as\_darray: raise StructureException(f"Arrays of {value\_type} are not allowed", value\_node)
 return cls(value\_type, length)
class TupleT(VyperType): """ Tuple type definition.
 This class is used to represent multiple return values from functions. """
 \_equality\_attrs = ("members",)
 # note: docs say that tuples are not instantiable but they # are in fact instantiable and the codegen works. if we # wanted to be stricter in the typechecker, we could # add \_invalid\_locations = everything but UNSET and RETURN\_VALUE. # (we would need to add a DataLocation.RETURN\_VALUE in order for # tuples to be instantiable as return values but not in memory). # \_invalid\_locations = ...
 def \_\_init\_\_(self, member\_types: Tuple[VyperType, ...]) -> None: super().\_\_init\_\_() self.member\_types = member\_types self.key\_type = UINT256\_T # API Compatibility
 def \_\_repr\_\_(self): return "(" + ", ".join(repr(t) for t in self.member\_types) + ")"
 @property def length(self): return len(self.member\_types)
 def tuple\_members(self): return [v for (\_k, v) in self.tuple\_items()]
 def tuple\_keys(self): return [k for (k, \_v) in self.tuple\_items()]
 def tuple\_items(self): return list(enumerate(self.member\_types))
 @classmethod def from\_annotation(cls, node: vy\_ast.Tuple) -> "TupleT": values = node.elements types = tuple(type\_from\_annotation(v) for v in values) return cls(types)
 @property def abi\_type(self) -> ABIType: return ABI\_Tuple([t.abi\_type for t in self.member\_types])
 def to\_abi\_arg(self, name: str = "") -> dict: components = [t.to\_abi\_arg() for t in self.member\_types] return {"name": name, "type": "tuple", "components": components}
 @property def size\_in\_bytes(self): return sum(i.size\_in\_bytes for i in self.member\_types)
 def validate\_index\_type(self, node): if not isinstance(node, vy\_ast.Int): raise InvalidType("Tuple indexes must be literals", node) if node.value < 0: raise ArrayIndexException("Vyper does not support negative indexing", node) if node.value >= self.length: raise ArrayIndexException("Index out of range", node)
 def get\_subscripted\_type(self, node): return self.member\_types[node.value]
 def compare\_type(self, other): if not isinstance(self, type(other)): return False if self.length != other.length: return False return all(a.compare\_type(b) for (a, b) in zip(self.member\_types, other.member\_types))

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_7dd87d9b_20250114_231949.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fblob%2Fa1fd228cb9936c3e4bbca6f3ee3fb4426ef45490%2Fvyper%2Fcodegen%2Fcore.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fvyperlang%2Fvyper%2Fblob%2Fa1fd228cb9936c3e4bbca6f3ee3fb4426ef45490%2Fvyper%2Fcodegen%2Fcore.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=vyperlang%2Fvyper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[vyperlang](/vyperlang)
/
**[vyper](/vyperlang/vyper)**
Public

* [Notifications](/login?return_to=%2Fvyperlang%2Fvyper) You must be signed in to change notification settings
* [Fork
  818](/login?return_to=%2Fvyperlang%2Fvyper)
* [Star
   5k](/login?return_to=%2Fvyperlang%2Fvyper)

* [Code](/vyperlang/vyper)
* [Issues
  407](/vyperlang/vyper/issues)
* [Pull requests
  82](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects
  0](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

Additional navigation options

* [Code](/vyperlang/vyper)
* [Issues](/vyperlang/vyper/issues)
* [Pull requests](/vyperlang/vyper/pulls)
* [Discussions](/vyperlang/vyper/discussions)
* [Actions](/vyperlang/vyper/actions)
* [Projects](/vyperlang/vyper/projects)
* [Wiki](/vyperlang/vyper/wiki)
* [Security](/vyperlang/vyper/security)
* [Insights](/vyperlang/vyper/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


