```
{
  "vulnerability": {
    "root_cause": "The Vyper typechecker allows signed integers to be used as indexes for arrays, which are intended to be indexed by unsigned integers. While runtime bounds checks are in place, sufficiently large negative integers can bypass these checks due to their two's complement representation, leading to unexpected behavior.",
    "weaknesses": [
      "Incorrect handling of signed integers as array indices.",
      "Insufficient validation of array index values during type checking.",
      "Bypassable runtime bounds checks with large magnitude negative numbers due to two's complement representation."
    ],
    "impact": "Unpredictable contract behavior due to out-of-bounds array access, and the possibility to bypass invariants set by developers by accessing elements that should not be accessible.",
    "attack_vectors": "By providing a contract with a large array and indexing it with a carefully chosen large negative integer, an attacker can bypass the bounds check and potentially access unintended memory locations.",
    "required_attacker_capabilities": "The attacker needs to be able to provide the input to the contract's functions which index an array. They need to craft a specific large negative integer as an index to bypass the bounds check and trigger the unexpected behavior."
  },
  "patches": [
    "https://github.com/vyperlang/vyper/pull/3817"
  ],
  "CVE_ID": "CVE-2024-24563"
}
```