- **Root cause of vulnerability:** Path Traversal vulnerability due to insufficient input sanitization in the `loadMessages` handler. The filename for reading JSON files is constructed using string interpolation without any checks for path traversal.
- **Weaknesses/vulnerabilities present:** CWE-35 Path Traversal. The application allows an attacker to manipulate the file path in a request, leading to the disclosure of arbitrary JSON files on the server.
- **Impact of exploitation:** An attacker can read arbitrary JSON files on the server that the webserver process has read privileges for. This can lead to unauthorized access to sensitive information, such as configuration files.
- **Attack vectors:** Sending a specially crafted HTTP GET request to `/api/json/messages/` with path traversal characters (e.g., `../`) in the ID parameter, allowing access to files outside of the intended directory.
- **Required attacker capabilities/position:** The attacker needs to be able to send HTTP requests to the affected server. The attacker also needs to have knowledge of the file system and the location of the files they wish to access. The attacker also needs to have an account with minimal privileges to access the vulnerable endpoint. The vulnerability is only exploitable when `JSON_STORAGE` is enabled.