=== Content from mender.io_fa033225_20250114_184029.html ===


* [Docs](https://docs.mender.io/)
* [Join the community](https://hub.mender.io/)
* [Contact us](https://mender.io/contact)
* [Log in](https://hosted.mender.io/)

* [Why Mender](https://mender.io/why-mender)
* Pricing

  + [Plans](https://mender.io/pricing/plans)
  + [Add-ons](https://mender.io/pricing/add-ons)
    - [Configure](https://mender.io/pricing/add-ons/configure)
    - [Monitor](https://mender.io/pricing/add-ons/monitor)
    - [Troubleshoot](https://mender.io/pricing/add-ons/troubleshoot)
  + [Extras](https://mender.io/pricing/mender-extras)
* Industries

  + [Automotive](https://mender.io/industries/automotive)
  + [Building Management Systems](https://mender.io/industries/building-management-systems)
  + [Consumer](https://mender.io/industries/consumer)
  + [Industrial & Manufacturing](https://mender.io/industries/industrial-and-manufacturing)
  + [Medical](https://mender.io/industries/medical)
  + [Security & Access Control](https://mender.io/industries/security-and-access-control)
  + [Smart Energy](https://mender.io/industries/smart-energy)
* Resources

  + [Resource Center](https://mender.io/resources)
  + [Mender Blog](https://mender.io/blog)
  + [Support](https://mender.io/support)
* Customers & Partners

  + [Customers](https://mender.io/customers)
  + [Partners](https://mender.io/partners)
* Engineers

  + [How Mender Works](https://mender.io/engineers/how-mender-works)
  + [Board Integrations](https://hub.mender.io/c/board-integrations/6)
  + [Technical FAQ](https://mender.io/engineers/faq)
  + [Documentation](https://docs.mender.io)
* [Try for free](https://hosted.mender.io/ui/#/signup)

[Mender blog](https://mender.io/blog)
[CVE](https://mender.io/blog/tag/cve)

# CVE-2024-46947 & CVE-2024-47190 - SSRF issues in Mender Enterprise Server

We recently discovered some potential security issues in Mender. Some APIs and integrations allow users to enter URLs of third party servers, and these lacked strict validation before the Mender Server makes requests to those servers.

![Ole Elgesem](https://mender.io/hubfs/Northerntech_June2023/Images/Ole%20Elgesem.jpeg)

[Ole Elgesem](https://mender.io/blog/author/ole-elgesem)
|
Nov 5, 2024
3 min read

There is no indication that these issues have been exploited or known outside of the Northern.tech team, and we have not found any effective ways these issues could be exploited (see explanation below), but still choose to be transparent about the security issues we've discovered and fixed. These issues have already been fixed for customers of hosted Mender. On-premise customers have already been notified and need to upgrade to version 3.7.7 or later versions to fix the issues.

## CVE-2024-46947 - SSRF issues in Mender LTS (on-prem)

The REST APIs for SAML and OIDC, require the backend to make HTTP requests based on the user input. These APIs would cause the backend to follow redirects and make HTTP requests based on the user supplied data, without implementing proper protections. This could allow a malicious user to make internal API GET requests inside the Mender backend, which they are not supposed to.

### Impact

In order to leverage this vulnerability, an attacker would need authenticated access to an admin level account, which has access to change SSO settings. If you use a Mender on-prem in a single-tenant setup, with a minimal number of administrators, there is limited concern here, as an attacker with access to an admin account would have access to a lot of damaging operations anyway. However, in a  multi-tenant setup (such as hosted Mender), it’s possible to gain admin level access in one tenant (organization), and attempt to use that to affect other tenants / organizations. Note that while it was possible to get the backend to make HTTP requests, we are not aware of any effective ways to exploit this, because:

* The backend would only send an HTTP GET request.
* There is no obvious way to get the response back for this GET request made by the backend.
* There is no obvious API to target, GET APIs are, by design, for getting information, not for making changes.

### Detection

To see if this issue has been exploited, simply open up the SSO configuration in the UI, and verify that the URLs are correct. In a multi-tenant environment, you can run the following `mongosh` script to dump all SSO configuration:

```
db.getSiblingDB("useradm").sso.
  find({}, {tenant_id: 1, idp_raw_xml: 1}).
  forEach(doc =>
    {doc.idp_raw_xml
     &&
print(`${doc.tenant_id} SSO config XML:\n${doc.idp_raw_xml}\n`)
  })
```
### Fix

If you are using hosted Mender, this issue has already been fixed and you do not have to take any action. For customers running Mender Enterprise on-prem, the issue was fixed in 3.6.6 and 3.7.7. Upgrading to these versions, or later versions, will resolve the issue.

## CVE-2024-47190 - SSRF issues in hosted Mender

Similar to the other issue, we also discovered some SSRF issues specific to hosted Mender. These issues have been fixed, and as a hosted Mender user, you do not need to take any action.

### Impact

An admin user with access to change SAML / OIDC settings, could affect what HTTP requests the Mender backend would make, without restricting it to the intended purpose, which was fetching SAML OIDC identity provider metadata from a URL. The most obvious way to try to exploit this is to target internal API endpoints, hoping to access / affect other tenants. However, we are not aware of any effective ways of exploiting this, for the same reasons as the CVE above (GET request only, no way to get response, no GET API to target for making changes).

### Detection

We have verified in the database that this issue was not being exploited in hosted Mender prior to being fixed.

### Fix

We have fixed the issue in hosted Mender and you do not have to take any action. This issue was specific to hosted Mender, not present in Mender LTS (on-prem).

## Contact

If you have any questions or need assistance, don’t hesitate to contact support:

<https://support.northern.tech>

If you believe you have discovered a security issue in one of our products, see our security.txt file for information about how to responsibly disclose security vulnerabilities:

<https://northern.tech/security.txt>

[CVE](https://mender.io/blog/tag/cve)

#### Recent articles

[CRA](https://mender.io/blog/tag/cra)

[![Challenges in complying with the EU Cyber Resilience Act (CRA)](https://mender.io/hs-fs/hubfs/shutterstock_1875500836%20%281%29.jpg?length=720&name=shutterstock_1875500836%20%281%29.jpg)](https://mender.io/blog/challenges-in-complying-with-the-eu-cyber-resilience-act)
## [Challenges in complying with the EU Cyber Resilience Act (CRA)](https://mender.io/blog/challenges-in-complying-with-the-eu-cyber-resilience-act)

Discover how manufacturers can achieve Cyber Resilience Act (CRA) compliance by tackling secure updates, SBOM management, and vulnerability tracking with robust OTA solutions.
Jan 8, 2025
|
8 min read

[CRA](https://mender.io/blog/tag/cra)

[![An overview of EU Cyber Resilience Act (CRA) compliance](https://mender.io/hs-fs/hubfs/Challenges%20in%20complying%20thumbnail.png?length=720&name=Challenges%20in%20complying%20thumbnail.png)](https://mender.io/blog/an-overview-of-the-eu-cyber-resilience-act-compliance)
## [An overview of EU Cyber Resilience Act (CRA) compliance](https://mender.io/blog/an-overview-of-the-eu-cyber-resilience-act-compliance)

Learn how the EU Cyber Resilience Act (CRA) enforces stringent cybersecurity requirements for PDEs. Explore compliance essentials in part 1 of a 4-part series.
Jan 8, 2025
|
5 min read

[CRA](https://mender.io/blog/tag/cra)

[![The scope of EU Cyber Resilience Act (CRA) compliance](https://mender.io/hs-fs/hubfs/Part%20two%20EU%20CRA%20SM%201.png?length=720&name=Part%20two%20EU%20CRA%20SM%201.png)](https://mender.io/blog/the-scope-of-eu-cyber-resilience-act-compliance)
## [The scope of EU Cyber Resilience Act (CRA) compliance](https://mender.io/blog/the-scope-of-eu-cyber-resilience-act-compliance)

Explore the scope of the EU Cyber Resilience Act (CRA). Learn about the CRA's scope, and why secure OTA updates are essential for compliance.
Jan 8, 2025
|
4 min read

[View more articles](https://mender.io/blog/page/1)

## Learn why leading companies choose Mender

Discover how Mender empowers both you and your customers with secure and reliable over-the-air updates for IoT devices. Focus on your product, and benefit from specialized OTA expertise and best practices.

[Why Mender](/why-mender)

![sales-pipeline_295756365](https://139765721.fs1.hubspotusercontent-eu1.net/hubfs/139765721/Mender%20Assets/Images/hero-howitworks.png)

* About Mender
  + [Plans](https://mender.io/pricing/plans)
  + [Features](https://mender.io/pricing/plans#features)
  + [Extras](https://mender.io/pricing/mender-extras)
  + [Our Customers](https://mender.io/customers)
  + [Our Partners](https://mender.io/partners)
* Engineers
  + [Mender Hub Forum](https://hub.mender.io/)
  + [Documentation](https://docs.mender.io/)
  + [API Documentation](https://docs.mender.io/api/)
  + [Github](https://github.com/mendersoftware)
  + [How Mender Works](https://mender.io/engineers/how-mender-works)
* Resources
  + [Resource Center](https://mender.io/resources)
  + [Reports & Guides](https://mender.io/resources/reports-and-guides)
  + [Ebooks](https://mender.io/resources/ebooks)
  + [Videos](https://mender.io/resources/videos)
  + [Mender Blog](https://mender.io/blog)
* Getting Started
  + [Sign Up for Free](https://hosted.mender.io/ui/#/signup)
  + [Raspberry Pi Quickstart](https://docs.mender.io/get-started/preparation/prepare-a-raspberry-pi-device)
  + [Tutorials](https://hub.mender.io/c/tutorials)
* Contact
  + [Contact Us](https://mender.io/contact)
  + [Support](https://mender.io/support)

##### Sign up for our newsletter

By signing up, you agree to your email address being stored and used to receive newsletters about Mender. We use tracking in our newsletter emails to improve our marketing content.

![European Commission Horizon 2020 project logo](https://mender.io/hubfs/european-commission.png)

Mender is developed and maintained by [Northern.tech](https://northern.tech).

* [Careers](https://northern.tech/careers)
* [Legal](https://northern.tech/legal)

|
© 2025 Northern.tech

Cookie Settings


