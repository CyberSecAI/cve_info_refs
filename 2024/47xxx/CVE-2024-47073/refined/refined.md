- **Root cause of vulnerability:** The vulnerability stems from the lack of signature verification of JWT (JSON Web Token) tokens within the `TokenUtils.java` file. Specifically, the `JWT.decode` method only processes the first two parts of the token, omitting the signature verification. This allows attackers to forge valid-looking JWTs with arbitrary user and organizational IDs.
- **Weaknesses/vulnerabilities present:** The primary vulnerability is the missing JWT signature verification. The `userBOByToken` method extracts claims from the decoded JWT but does not validate its authenticity. An attacker can therefore create a JWT with a manipulated user ID and organization ID, which the application will trust without proper validation.
- **Impact of exploitation:** By forging a JWT, an attacker can impersonate any user (including administrator). This grants unauthorized access to all interfaces, potentially leading to data breaches, unauthorized modifications, and full system control, as seen with the example API call to `/de2api/user/info`.
- **Attack vectors:** The attack vector involves crafting a JWT with desired user and organization IDs, without needing the actual signing key. This forged JWT is then sent in the `X-DE-TOKEN` header of an HTTP request to any API endpoint that relies on token validation, like `/de2api/user/info` in the example.
- **Required attacker capabilities/position:** The attacker requires the ability to craft a custom JWT token and knowledge of the target API. The attacker doesn't need to be authenticated, as the vulnerability is in how tokens are verified in the backend.