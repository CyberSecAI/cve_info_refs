=== Content from securitylab.github.com_4cfb8bb2_20250115_082521.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 11, 2024
# GHSL-2024-262: OOB-read in gst\_avi\_subtitle\_parse\_gab2\_chunk in GStreamer - CVE-2024-47774

[![Author avatar](https://avatars.githubusercontent.com/u/55253029)
Antonio Morales](https://github.com/antonio-morales)

## Coordinated Disclosure Timeline

* 2024-10-03: Issue reported at https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3890
* 2024-10-04: Issue acknowledged
* 2024-12-03: [Fixed and disclosed](https://gstreamer.freedesktop.org/security/sa-2024-0028.html)

## Project

Gstreamer

## Tested Version

* Development version (2024/09/25)

## Details

### OOB-read in gst\_avi\_subtitle\_parse\_gab2\_chunk (`GHSL-2024-262`)

An OOB-read vulnerability has been identified in the [gst\_avi\_subtitle\_parse\_gab2\_chunk](https://gitlab.freedesktop.org/gstreamer/gstreamer/-/blob/a8f8bbef99e28bbf62aeaa774814b5c3a665e9d6/subprojects/gst-plugins-good/gst/avi/gstavisubtitle.c#L183) function within `gstavisubtitle.c`

The function reads the `name_length` value directly from the input file without checking it properly:

```
  name_length = GST_READ_UINT32_LE (map.data + 5 + 2);

```

Then, the following condition, does not properly handle cases where `name_length` is greater than 0xFFFFFFFF - 17, causing an integer overflow:

```
  if (map.size <= 17 + name_length)
    goto wrong_name_length;

```

In such scenario, the function attempts to access memory beyond the buffer with

```
  GST_READ_UINT16_LE(map.data + 11 + name_length)

```

leading to an OOB-read.

#### Impact

This vulnerability results in an out-of-bounds read, which may lead to application crashes or an information leak.

## CVE

* CVE-2024-47774

## Credit

This issue was discovered and reported by GHSL team member [@antonio-morales (Antonio Morales)](https://github.com/antonio-morales).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2024-262` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. Â©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from gitlab.freedesktop.org_b2d8281d_20250115_082515.html ===
From 0870e87c7c02e28e22a09a7de0c5b1e5bed68c14 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 14:04:03 +0300
Subject: [PATCH] avisubtitle: Fix size checks and avoid overflows when
checking sizes
Thanks to Antonio Morales for finding and reporting the issue.
Fixes GHSL-2024-262
Fixes https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3890
Part-of:
---
subprojects/gst-plugins-good/gst/avi/gstavisubtitle.c | 5 +++--
1 file changed, 3 insertions(+), 2 deletions(-)
diff --git a/subprojects/gst-plugins-good/gst/avi/gstavisubtitle.c b/subprojects/gst-plugins-good/gst/avi/gstavisubtitle.c
index efc5f0405186..c816934da61c 100644
--- a/subprojects/gst-plugins-good/gst/avi/gstavisubtitle.c
+++ b/subprojects/gst-plugins-good/gst/avi/gstavisubtitle.c
@@ -196,7 +196,7 @@ gst\_avi\_subtitle\_parse\_gab2\_chunk (GstAviSubtitle \* sub, GstBuffer \* buf)
/\* read 'name' of subtitle \*/
name\_length = GST\_READ\_UINT32\_LE (map.data + 5 + 2);
GST\_LOG\_OBJECT (sub, "length of name: %u", name\_length);
- if (map.size <= 17 + name\_length)
+ if (G\_MAXUINT32 - 17 < name\_length || map.size < 17 + name\_length)
goto wrong\_name\_length;
name\_utf8 =
@@ -216,7 +216,8 @@ gst\_avi\_subtitle\_parse\_gab2\_chunk (GstAviSubtitle \* sub, GstBuffer \* buf)
file\_length = GST\_READ\_UINT32\_LE (map.data + 13 + name\_length);
GST\_LOG\_OBJECT (sub, "length srt/ssa file: %u", file\_length);
- if (map.size < (17 + name\_length + file\_length))
+ if (G\_MAXUINT32 - 17 - name\_length < file\_length
+ || map.size < 17 + name\_length + file\_length)
goto wrong\_total\_length;
/\* store this, so we can send it again after a seek; note that we shouldn't
--
GitLab

