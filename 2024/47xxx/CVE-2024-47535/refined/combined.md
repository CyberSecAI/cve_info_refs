=== Content from github.com_ffdb5a49_20250114_232016.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2Ffbf7a704a82e7449b48bd0bbb679f5661c6d61a3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2Ffbf7a704a82e7449b48bd0bbb679f5661c6d61a3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=netty%2Fnetty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netty](/netty)
/
**[netty](/netty/netty)**
Public

* [Notifications](/login?return_to=%2Fnetty%2Fnetty) You must be signed in to change notification settings
* [Fork
  16k](/login?return_to=%2Fnetty%2Fnetty)
* [Star
   33.7k](/login?return_to=%2Fnetty%2Fnetty)

* [Code](/netty/netty)
* [Issues
  572](/netty/netty/issues)
* [Pull requests
  38](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects
  0](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

Additional navigation options

* [Code](/netty/netty)
* [Issues](/netty/netty/issues)
* [Pull requests](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

## Commit

[Permalink](/netty/netty/commit/fbf7a704a82e7449b48bd0bbb679f5661c6d61a3)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge commit from fork

[Browse files](/netty/netty/tree/fbf7a704a82e7449b48bd0bbb679f5661c6d61a3)
Browse the repository at this point in the history

```
Motivation:

We didnt verify the amount of data buffered while reading files / streams during startup which could allow an attacker to cause an OMME if the attacker was able to create a massive file.

Modifications:

Decorate InputStream with own that will throw an exception once we reach the limit of data read.

Result:

No more risk of OOME
```

* Loading branch information

[![@normanmaurer](https://avatars.githubusercontent.com/u/439362?s=40&v=4)](/normanmaurer)

[normanmaurer](/netty/netty/commits?author=normanmaurer "View all commits by normanmaurer")
authored
Nov 12, 2024

1 parent
[7b4fe3d](/netty/netty/commit/7b4fe3d25c01576636985320ebf16393cd21c13c)

commit fbf7a70

 Show file tree

 Hide file tree

Showing
**5 changed files**
with
**142 additions**
and
**10 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* common/src

  + main/java/io/netty/util

    - common/src/main/java/io/netty/util/NetUtil.java
      [NetUtil.java](#diff-23e57529974868b5a8e673f043aa9a9a4b8b16069185dec49508443d25364670)
    - internal

      * common/src/main/java/io/netty/util/internal/BoundedInputStream.java
        [BoundedInputStream.java](#diff-84783776c27851d7944a8428dd24e5854ea4d913cc7b33843e4bfbe999ed2eaa)
      * common/src/main/java/io/netty/util/internal/PlatformDependent.java
        [PlatformDependent.java](#diff-e500fe6cdcd642c7929cdbb2bc118760d09f400093ff34d63d8272d35f80cf8b)
  + test/java/io/netty/util/internal

    - common/src/test/java/io/netty/util/internal/BoundedInputStreamTest.java
      [BoundedInputStreamTest.java](#diff-25e33eb3ed597fe36b0d4a9717fbaabeee7639c213b646757def511699f7484a)
* resolver-dns/src/main/java/io/netty/resolver/dns

  + resolver-dns/src/main/java/io/netty/resolver/dns/ResolvConf.java
    [ResolvConf.java](#diff-ca9a145086506aa61cb6edb37be9ef4456d5a0fbe63112ac2433b7dcd1806a8d)

## There are no files selected for viewing

8 changes: 5 additions & 3 deletions

8
[common/src/main/java/io/netty/util/NetUtil.java](#diff-23e57529974868b5a8e673f043aa9a9a4b8b16069185dec49508443d25364670 "common/src/main/java/io/netty/util/NetUtil.java")

Show comments

[View file](/netty/netty/blob/fbf7a704a82e7449b48bd0bbb679f5661c6d61a3/common/src/main/java/io/netty/util/NetUtil.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,7 @@ |
|  |  | package io.netty.util; |
|  |  |  |
|  |  | import io.netty.util.NetUtilInitializations.NetworkIfaceAndInetAddress; |
|  |  | import io.netty.util.internal.BoundedInputStream; |
|  |  | import io.netty.util.internal.PlatformDependent; |
|  |  | import io.netty.util.internal.StringUtil; |
|  |  | import io.netty.util.internal.SystemPropertyUtil; |
| Expand All | | @@ -24,7 +25,7 @@ |
|  |  |  |
|  |  | import java.io.BufferedReader; |
|  |  | import java.io.File; |
|  |  | import java.io.FileReader; |
|  |  | import java.io.FileInputStream; |
|  |  | import java.io.IOException; |
|  |  | import java.io.InputStream; |
|  |  | import java.io.InputStreamReader; |
| Expand Down  Expand Up | | @@ -190,7 +191,8 @@ public Integer run() { |
|  |  | // try / catch block. |
|  |  | // See https://github.com/netty/netty/issues/4936 |
|  |  | if (file.exists()) { |
|  |  | in = new BufferedReader(new FileReader(file)); |
|  |  | in = new BufferedReader(new InputStreamReader( |
|  |  | new BoundedInputStream(new FileInputStream(file)))); |
|  |  | somaxconn = Integer.parseInt(in.readLine()); |
|  |  | if (logger.isDebugEnabled()) { |
|  |  | logger.debug("{}: {}", file, somaxconn); |
| Expand Down  Expand Up | | @@ -243,7 +245,7 @@ private static Integer sysctlGetInt(String sysctlKey) throws IOException { |
|  |  | try { |
|  |  | // Suppress warnings about resource leaks since the buffered reader is closed below |
|  |  | InputStream is = process.getInputStream(); |
|  |  | InputStreamReader isr = new InputStreamReader(is); |
|  |  | InputStreamReader isr = new InputStreamReader(new BoundedInputStream(is)); |
|  |  | BufferedReader br = new BufferedReader(isr); |
|  |  | try { |
|  |  | String line = br.readLine(); |
| Expand Down | |  |

83 changes: 83 additions & 0 deletions

83
[common/src/main/java/io/netty/util/internal/BoundedInputStream.java](#diff-84783776c27851d7944a8428dd24e5854ea4d913cc7b33843e4bfbe999ed2eaa "common/src/main/java/io/netty/util/internal/BoundedInputStream.java")

Show comments

[View file](/netty/netty/blob/fbf7a704a82e7449b48bd0bbb679f5661c6d61a3/common/src/main/java/io/netty/util/internal/BoundedInputStream.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,83 @@ |
|  |  | /\* |
|  |  | \* Copyright 2024 The Netty Project |
|  |  | \* |
|  |  | \* The Netty Project licenses this file to you under the Apache License, |
|  |  | \* version 2.0 (the "License"); you may not use this file except in compliance |
|  |  | \* with the License. You may obtain a copy of the License at: |
|  |  | \* |
|  |  | \* https://www.apache.org/licenses/LICENSE-2.0 |
|  |  | \* |
|  |  | \* Unless required by applicable law or agreed to in writing, software |
|  |  | \* distributed under the License is distributed on an "AS IS" BASIS, WITHOUT |
|  |  | \* WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the |
|  |  | \* License for the specific language governing permissions and limitations |
|  |  | \* under the License. |
|  |  | \*/ |
|  |  | package io.netty.util.internal; |
|  |  |  |
|  |  | import org.jetbrains.annotations.NotNull; |
|  |  |  |
|  |  | import java.io.FilterInputStream; |
|  |  | import java.io.IOException; |
|  |  | import java.io.InputStream; |
|  |  |  |
|  |  | public final class BoundedInputStream extends FilterInputStream { |
|  |  |  |
|  |  | private final int maxBytesRead; |
|  |  | private int numRead; |
|  |  |  |
|  |  | public BoundedInputStream(@NotNull InputStream in, int maxBytesRead) { |
|  |  | super(in); |
|  |  | this.maxBytesRead = ObjectUtil.checkPositive(maxBytesRead, "maxRead"); |
|  |  | } |
|  |  |  |
|  |  | public BoundedInputStream(@NotNull InputStream in) { |
|  |  | this(in, 8 \* 1024); |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public int read() throws IOException { |
|  |  | checkMaxBytesRead(1); |
|  |  | try { |
|  |  | int b = super.read(); |
|  |  | if (b <= 0) { |
|  |  | // We couldn't read anything. |
|  |  | numRead--; |
|  |  | } |
|  |  | return b; |
|  |  | } catch (IOException e) { |
|  |  | numRead--; |
|  |  | throw e; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | @Override |
|  |  | public int read(byte[] buf, int off, int len) throws IOException { |
|  |  | // Calculate the maximum number of bytes that we should try to read. |
|  |  | int num = Math.min(len, maxBytesRead - numRead + 1); |
|  |  | checkMaxBytesRead(num); |
|  |  | try { |
|  |  | int b = super.read(buf, off, num); |
|  |  | if (b == -1) { |
|  |  | // We couldn't read anything. |
|  |  | numRead -= num; |
|  |  | } else if (b != num) { |
|  |  | // Correct numRead based on the actual amount we were able to read. |
|  |  | numRead -= num - b; |
|  |  | } |
|  |  | return b; |
|  |  | } catch (IOException e) { |
|  |  | numRead -= num; |
|  |  | throw e; |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | private void checkMaxBytesRead(int n) throws IOException { |
|  |  | int sum = numRead + n; |
|  |  | if (sum < 0 || sum > maxBytesRead) { |
|  |  | numRead = maxBytesRead + 1; |
|  |  | throw new IOException("Maximum number of bytes read: " + maxBytesRead); |
|  |  | } |
|  |  | numRead = sum; |
|  |  | } |
|  |  | } |

5 changes: 2 additions & 3 deletions

5
[common/src/main/java/io/netty/util/internal/PlatformDependent.java](#diff-e500fe6cdcd642c7929cdbb2bc118760d09f400093ff34d63d8272d35f80cf8b "common/src/main/java/io/netty/util/internal/PlatformDependent.java")

Show comments

[View file](/netty/netty/blob/fbf7a704a82e7449b48bd0bbb679f5661c6d61a3/common/src/main/java/io/netty/util/internal/PlatformDependent.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -239,9 +239,8 @@ public Boolean run() { |
|  |  | if (file.exists()) { |
|  |  | BufferedReader reader = null; |
|  |  | try { |
|  |  | reader = new BufferedReader( |
|  |  | new InputStreamReader( |
|  |  | new FileInputStream(file), CharsetUtil.UTF\_8)); |
|  |  | reader = new BufferedReader(new InputStreamReader( |
|  |  | new BoundedInputStream(new FileInputStream(file)), CharsetUtil.UTF\_8)); |
|  |  |  |
|  |  | String line; |
|  |  | while ((line = reader.readLine()) != null) { |
| Expand Down | |  |

44 changes: 44 additions & 0 deletions

44
[common/src/test/java/io/netty/util/internal/BoundedInputStreamTest.java](#diff-25e33eb3ed597fe36b0d4a9717fbaabeee7639c213b646757def511699f7484a "common/src/test/java/io/netty/util/internal/BoundedInputStreamTest.java")

Show comments

[View file](/netty/netty/blob/fbf7a704a82e7449b48bd0bbb679f5661c6d61a3/common/src/test/java/io/netty/util/internal/BoundedInputStreamTest.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,44 @@ |
|  |  | /\* |
|  |  | \* Copyright 2024 The Netty Project |
|  |  | \* |
|  |  | \* The Netty Project licenses this file to you under the Apache License, |
|  |  | \* version 2.0 (the "License"); you may not use this file except in compliance |
|  |  | \* with the License. You may obtain a copy of the License at: |
|  |  | \* |
|  |  | \* https://www.apache.org/licenses/LICENSE-2.0 |
|  |  | \* |
|  |  | \* Unless required by applicable law or agreed to in writing, software |
|  |  | \* distributed under the License is distributed on an "AS IS" BASIS, WITHOUT |
|  |  | \* WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the |
|  |  | \* License for the specific language governing permissions and limitations |
|  |  | \* under the License. |
|  |  | \*/ |
|  |  | package io.netty.util.internal; |
|  |  |  |
|  |  | import org.junit.jupiter.api.Test; |
|  |  | import org.junit.jupiter.api.function.Executable; |
|  |  |  |
|  |  | import java.io.ByteArrayInputStream; |
|  |  | import java.io.IOException; |
|  |  |  |
|  |  | import static org.junit.jupiter.api.Assertions.assertEquals; |
|  |  | import static org.junit.jupiter.api.Assertions.assertThrows; |
|  |  |  |
|  |  | public class BoundedInputStreamTest { |
|  |  |  |
|  |  | @Test |
|  |  | void testBoundEnforced() throws IOException { |
|  |  | final byte[] bytes = new byte[64]; |
|  |  | PlatformDependent.threadLocalRandom().nextBytes(bytes); |
|  |  | final BoundedInputStream reader = new BoundedInputStream(new ByteArrayInputStream(bytes), bytes.length - 1); |
|  |  | assertEquals(bytes[0], (byte) reader.read()); |
|  |  |  |
|  |  | assertThrows(IOException.class, new Executable() { |
|  |  | @Override |
|  |  | public void execute() throws Throwable { |
|  |  | reader.read(new byte[64], 0, 64); |
|  |  | } |
|  |  | }); |
|  |  | reader.close(); |
|  |  | } |
|  |  | } |

12 changes: 8 additions & 4 deletions

12
[resolver-dns/src/main/java/io/netty/resolver/dns/ResolvConf.java](#diff-ca9a145086506aa61cb6edb37be9ef4456d5a0fbe63112ac2433b7dcd1806a8d "resolver-dns/src/main/java/io/netty/resolver/dns/ResolvConf.java")

Show comments

[View file](/netty/netty/blob/fbf7a704a82e7449b48bd0bbb679f5661c6d61a3/resolver-dns/src/main/java/io/netty/resolver/dns/ResolvConf.java)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,9 +15,12 @@ |
|  |  | \*/ |
|  |  | package io.netty.resolver.dns; |
|  |  |  |
|  |  | import io.netty.util.internal.BoundedInputStream; |
|  |  |  |
|  |  | import java.io.BufferedReader; |
|  |  | import java.io.FileReader; |
|  |  | import java.io.FileInputStream; |
|  |  | import java.io.IOException; |
|  |  | import java.io.InputStreamReader; |
|  |  | import java.net.InetSocketAddress; |
|  |  | import java.util.ArrayList; |
|  |  | import java.util.Collections; |
| Expand Down  Expand Up | | @@ -45,12 +48,13 @@ static ResolvConf fromReader(BufferedReader reader) throws IOException { |
|  |  | \* {@code /etc/resolv.conf} file, see {@code man resolv.conf}. |
|  |  | \*/ |
|  |  | static ResolvConf fromFile(String file) throws IOException { |
|  |  | FileReader fileReader = new FileReader(file); |
|  |  | BufferedReader reader = new BufferedReader(new InputStreamReader( |
|  |  | // Use 1 MB to be a bit conservative |
|  |  | new BoundedInputStream(new FileInputStream(file), 1024 \* 1024))); |
|  |  | try { |
|  |  | BufferedReader reader = new BufferedReader(new FileReader(file)); |
|  |  | return fromReader(reader); |
|  |  | } finally { |
|  |  | fileReader.close(); |
|  |  | reader.close(); |
|  |  | } |
|  |  | } |
|  |  |  |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `fbf7a70`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fcommit%2Ffbf7a704a82e7449b48bd0bbb679f5661c6d61a3) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_49b2ac2a_20250114_232018.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fsecurity%2Fadvisories%2FGHSA-xq3w-v528-46rv)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fnetty%2Fnetty%2Fsecurity%2Fadvisories%2FGHSA-xq3w-v528-46rv)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=netty%2Fnetty)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[netty](/netty)
/
**[netty](/netty/netty)**
Public

* [Notifications](/login?return_to=%2Fnetty%2Fnetty) You must be signed in to change notification settings
* [Fork
  16k](/login?return_to=%2Fnetty%2Fnetty)
* [Star
   33.7k](/login?return_to=%2Fnetty%2Fnetty)

* [Code](/netty/netty)
* [Issues
  572](/netty/netty/issues)
* [Pull requests
  38](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects
  0](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

Additional navigation options

* [Code](/netty/netty)
* [Issues](/netty/netty/issues)
* [Pull requests](/netty/netty/pulls)
* [Discussions](/netty/netty/discussions)
* [Actions](/netty/netty/actions)
* [Projects](/netty/netty/projects)
* [Wiki](/netty/netty/wiki)
* [Security](/netty/netty/security)
* [Insights](/netty/netty/pulse)

# Denial of Service attack on windows app using netty

Moderate

[normanmaurer](/normanmaurer)
published
GHSA-xq3w-v528-46rv
Nov 12, 2024

## Package

maven

io.netty
([Maven](/advisories?query=ecosystem%3Amaven))

## Affected versions

<= 4.1.114

## Patched versions

 4.1.115

## Description

### Summary

An unsafe reading of environment file could potentially cause a denial of service in Netty.

When loaded on an Windows application, Netty attemps to load a file that does not exist. If an attacker creates such a large file, the Netty application crash.

### Details

When the library netty is loaded in a java windows application, the library tries to identify the system environnement in which it is executed.

At this stage, Netty tries to load both `/etc/os-release` and `/usr/lib/os-release` even though it is in a Windows environment.

[![1](https://private-user-images.githubusercontent.com/180937914/365588634-9466b181-9394-45a3-b0e3-1dcf105def59.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjM0LTk0NjZiMTgxLTkzOTQtNDVhMy1iMGUzLTFkY2YxMDVkZWY1OS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hZjZkNmFhZDk4ODYwMjYxODYwNmE3ZWFhOTcwNDJiZmVjMzE5MGZlYjE5ZjMxMjUzYzdkYzQ2NzM5YThkNzgyJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.fMsnOfY3A-IdJMmj99Nn0K0gLIVJVK4TAVDxcYwE8dc)](https://private-user-images.githubusercontent.com/180937914/365588634-9466b181-9394-45a3-b0e3-1dcf105def59.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjM0LTk0NjZiMTgxLTkzOTQtNDVhMy1iMGUzLTFkY2YxMDVkZWY1OS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hZjZkNmFhZDk4ODYwMjYxODYwNmE3ZWFhOTcwNDJiZmVjMzE5MGZlYjE5ZjMxMjUzYzdkYzQ2NzM5YThkNzgyJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.fMsnOfY3A-IdJMmj99Nn0K0gLIVJVK4TAVDxcYwE8dc)

If netty finds this files, it reads them and loads them into memory.

By default :

* The JVM maximum memory size is set to 1 GB,
* A non-privileged user can create a directory at `C:\` and create files within it.

[![2](https://private-user-images.githubusercontent.com/180937914/365588640-43b359a2-5871-4592-ae2b-ffc40ac76831.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjQwLTQzYjM1OWEyLTU4NzEtNDU5Mi1hZTJiLWZmYzQwYWM3NjgzMS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hNzMzZDM2ZTRhMjFhZDhiZDE3NDE1MWE0NTEwYjlkZmI4NzEwMWQ2M2JiN2M2ZTk2ZjRiMmIxYTZhM2M0Y2JmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.HPytEReNdSgcozkqUhKnDELA1dryrFPHiMCfd9U7mj0)](https://private-user-images.githubusercontent.com/180937914/365588640-43b359a2-5871-4592-ae2b-ffc40ac76831.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjQwLTQzYjM1OWEyLTU4NzEtNDU5Mi1hZTJiLWZmYzQwYWM3NjgzMS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hNzMzZDM2ZTRhMjFhZDhiZDE3NDE1MWE0NTEwYjlkZmI4NzEwMWQ2M2JiN2M2ZTk2ZjRiMmIxYTZhM2M0Y2JmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.HPytEReNdSgcozkqUhKnDELA1dryrFPHiMCfd9U7mj0)
[![3](https://private-user-images.githubusercontent.com/180937914/365588647-ad5c6eed-451c-4513-92d5-ba0eee7715c1.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjQ3LWFkNWM2ZWVkLTQ1MWMtNDUxMy05MmQ1LWJhMGVlZTc3MTVjMS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yYzhkZDcyNjMxNjllYWQ0MmU3ZmRkNThmNDc4ZWY2ODdmOTZmMTI3NzQwOThhNTYxODY3NmFiZjZjNzZhMGQxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.UccPZLLriKOZaNbYocF0ZXFj5d5FaBgnxDRcwHbeIV8)](https://private-user-images.githubusercontent.com/180937914/365588647-ad5c6eed-451c-4513-92d5-ba0eee7715c1.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjQ3LWFkNWM2ZWVkLTQ1MWMtNDUxMy05MmQ1LWJhMGVlZTc3MTVjMS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yYzhkZDcyNjMxNjllYWQ0MmU3ZmRkNThmNDc4ZWY2ODdmOTZmMTI3NzQwOThhNTYxODY3NmFiZjZjNzZhMGQxJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.UccPZLLriKOZaNbYocF0ZXFj5d5FaBgnxDRcwHbeIV8)

the source code identified :

<https://github.com/netty/netty/blob/4.1/common/src/main/java/io/netty/util/internal/PlatformDependent.java>

Despite the implementation of the function `normalizeOs()` the source code not verify the OS before reading `C:\etc\os-release` and `C:\usr\lib\os-release`.

### PoC

Create a file larger than 1 GB of data in `C:\etc\os-release` or `C:\usr\lib\os-release` on a Windows environnement and start your Netty application.

To observe what the application does with the file, the security analyst used "Process Monitor" from the "Windows SysInternals" suite. (<https://learn.microsoft.com/en-us/sysinternals/>)

```
cd C:\etc
fsutil file createnew os-release 3000000000

```

[![4](https://private-user-images.githubusercontent.com/180937914/365588648-39df22a3-462b-4fd0-af9a-aa30077ec08f.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjQ4LTM5ZGYyMmEzLTQ2MmItNGZkMC1hZjlhLWFhMzAwNzdlYzA4Zi5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00MmQ4Yzc2MGIyNDE5MTk0MjVlMTBmNjZjMTIzNTVjM2Q0ZTVmMGJjYWI3YmZkYTcyZjI5MzM3NTIyMmYwZTQ0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.pX8eUJa23hM8zutZUUgDg1bQ1ZxQ8zZLLMta-XZ-taY)](https://private-user-images.githubusercontent.com/180937914/365588648-39df22a3-462b-4fd0-af9a-aa30077ec08f.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjQ4LTM5ZGYyMmEzLTQ2MmItNGZkMC1hZjlhLWFhMzAwNzdlYzA4Zi5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00MmQ4Yzc2MGIyNDE5MTk0MjVlMTBmNjZjMTIzNTVjM2Q0ZTVmMGJjYWI3YmZkYTcyZjI5MzM3NTIyMmYwZTQ0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.pX8eUJa23hM8zutZUUgDg1bQ1ZxQ8zZLLMta-XZ-taY)
[![5](https://private-user-images.githubusercontent.com/180937914/365588651-129dbd50-fc36-4da5-8eb1-582123fb528f.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjUxLTEyOWRiZDUwLWZjMzYtNGRhNS04ZWIxLTU4MjEyM2ZiNTI4Zi5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04MTAxODFkZDcxNmNlMjlhYmNlNzdkNTk0NWNjMDEzNTIxMTQ5NDc1N2JlZDVlNTc4ODE4ZWMxY2YzMjI1YWJjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.SAUlmmrlEAmvmX81sZWxDZzCZVim4gXd4s9LoYnpu0w)](https://private-user-images.githubusercontent.com/180937914/365588651-129dbd50-fc36-4da5-8eb1-582123fb528f.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjUxLTEyOWRiZDUwLWZjMzYtNGRhNS04ZWIxLTU4MjEyM2ZiNTI4Zi5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT04MTAxODFkZDcxNmNlMjlhYmNlNzdkNTk0NWNjMDEzNTIxMTQ5NDc1N2JlZDVlNTc4ODE4ZWMxY2YzMjI1YWJjJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.SAUlmmrlEAmvmX81sZWxDZzCZVim4gXd4s9LoYnpu0w)

The source code used is the Netty website code example : [Echo ‐ the very basic client and server](https://netty.io/4.1/xref/io/netty/example/echo/package-summary.html).

The vulnerability was tested on the 4.1.112.Final version.

The security analyst tried the same technique for `C:\proc\sys\net\core\somaxconn` with a lot of values to impact Netty but the only things that works is the "larger than 1 GB file" technique.

[netty/common/src/main/java/io/netty/util/NetUtil.java](https://github.com/netty/netty/blob/c0fdb8e9f8f256990e902fcfffbbe10754d0f3dd/common/src/main/java/io/netty/util/NetUtil.java#L186)

Line 186
in
[c0fdb8e](/netty/netty/commit/c0fdb8e9f8f256990e902fcfffbbe10754d0f3dd)

|  | File file = new File("/proc/sys/net/core/somaxconn"); |
| --- | --- |

### Impact

By loading the "file larger than 1 GB" into the memory, the Netty library exceeds the JVM memory limit and causes a crash in the java Windows application.

This behaviour occurs 100% of the time in both Server mode and Client mode if the large file exists.

Client mode :

[![6](https://private-user-images.githubusercontent.com/180937914/365588657-f8fe1ed0-1a42-4490-b9ed-dbc9af7804be.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjU3LWY4ZmUxZWQwLTFhNDItNDQ5MC1iOWVkLWRiYzlhZjc4MDRiZS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1lZGQ1NDQ0NGQyOTBkOTM1NWJhNzlkMjE4MTQxYjY0ZmYxZGI5ZDNlOTI0NDUyOGQ3MGQ0MjkyYWVlZTQ1YWQ5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.sy4WKenUOrilwPPGjv_ugJDHs0HStHzptrbUQToa0uo)](https://private-user-images.githubusercontent.com/180937914/365588657-f8fe1ed0-1a42-4490-b9ed-dbc9af7804be.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjU3LWY4ZmUxZWQwLTFhNDItNDQ5MC1iOWVkLWRiYzlhZjc4MDRiZS5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1lZGQ1NDQ0NGQyOTBkOTM1NWJhNzlkMjE4MTQxYjY0ZmYxZGI5ZDNlOTI0NDUyOGQ3MGQ0MjkyYWVlZTQ1YWQ5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.sy4WKenUOrilwPPGjv_ugJDHs0HStHzptrbUQToa0uo)

Server mode :

[![7](https://private-user-images.githubusercontent.com/180937914/365588660-b34b42bd-4fbd-4170-b93a-d29ba87b88eb.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjYwLWIzNGI0MmJkLTRmYmQtNDE3MC1iOTNhLWQyOWJhODdiODhlYi5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zNGFhYWZmYzM1ZTc0OTQ3NTk4ZmFlZmMzZDA1ZmYyNzQyYTQzMzk3OTQyOTRmOTFhYmRkMjMzMTJjYjNhZWZiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.oUezz47Nv24RYCdLXmUdzsqbsmfdPR3oY5bA0Irlyfs)](https://private-user-images.githubusercontent.com/180937914/365588660-b34b42bd-4fbd-4170-b93a-d29ba87b88eb.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjYwLWIzNGI0MmJkLTRmYmQtNDE3MC1iOTNhLWQyOWJhODdiODhlYi5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0zNGFhYWZmYzM1ZTc0OTQ3NTk4ZmFlZmMzZDA1ZmYyNzQyYTQzMzk3OTQyOTRmOTFhYmRkMjMzMTJjYjNhZWZiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.oUezz47Nv24RYCdLXmUdzsqbsmfdPR3oY5bA0Irlyfs)

somaxconn :

[![8](https://private-user-images.githubusercontent.com/180937914/365588664-0656b3bb-32c6-4ae2-bff7-d93babba08a3.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjY0LTA2NTZiM2JiLTMyYzYtNGFlMi1iZmY3LWQ5M2JhYmJhMDhhMy5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05NGU3NWYwMmUyYTg1ZjdmYTM4ODQzNThjMTFjZTRlZWU1ZjJlZTM0YTk1YzMzYjY5NThjODQ1NGI5MTE3ZjQ5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.9QRkNAQPAoA5DBR_LXATnIMe8tKUGa2zNrEt8ppqIbs)](https://private-user-images.githubusercontent.com/180937914/365588664-0656b3bb-32c6-4ae2-bff7-d93babba08a3.PNG?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTcxMTcsIm5iZiI6MTczNjg5NjgxNywicGF0aCI6Ii8xODA5Mzc5MTQvMzY1NTg4NjY0LTA2NTZiM2JiLTMyYzYtNGFlMi1iZmY3LWQ5M2JhYmJhMDhhMy5QTkc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwMTE0JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDExNFQyMzIwMTdaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05NGU3NWYwMmUyYTg1ZjdmYTM4ODQzNThjMTFjZTRlZWU1ZjJlZTM0YTk1YzMzYjY5NThjODQ1NGI5MTE3ZjQ5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.9QRkNAQPAoA5DBR_LXATnIMe8tKUGa2zNrEt8ppqIbs)
### Severity

* Attack vector : "Local" because the attacker needs to be on the system where the Netty application is running.
* Attack complexity : "Low" because the attacker only need to create a massive file (regardless of its contents).
* Privileges required : "Low" because the attacker requires a user account to exploit the vulnerability.
* User intercation : "None" because the administrator don't need to accidentally click anywhere to trigger the vulnerability. Furthermore, the exploitation works with defaults windows/AD settings.
* Scope : "Unchanged" because only Netty is affected by the vulnerability.
* Confidentiality : "None" because no data is exposed through exploiting the vulnerability.
* Integrity : "None" because the explotation of the vulnerability does not allow editing, deleting or adding data elsewhere.
* Availability : "High" because the exploitation of this vulnerability crashes the entire java application.

### Severity

Moderate

5.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
Low

User interaction
None

Scope
Unchanged

Confidentiality
None

Integrity
None

Availability
High

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H

### CVE ID

CVE-2024-47535

### Weaknesses

No CWEs

### Credits

* [![@Amossys-PGR](https://avatars.githubusercontent.com/u/180937914?s=40&v=4)](/Amossys-PGR)
  [Amossys-PGR](/Amossys-PGR)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


