=== Content from floss.social_e017a45b_20250115_113642.html ===

![Mastodon](/packs/media/images/logo-d4b5dc90fd3e117d141ae7053b157f58.svg)
To use the Mastodon web application, please enable JavaScript. Alternatively, try one of the [native apps](https://joinmastodon.org/apps) for Mastodon for your platform.



=== Content from gitlab.freedesktop.org_5df6644d_20250115_113642.html ===


[Skip to content](#content-body)
GitLab
[![](data:image/gif;base64...)](/ "Homepage")

* [Explore](/explore)

* [Sign in](/users/sign_in?redirect_to_referer=yes)
* [Register](/users/sign_up)

## Admin message

Due to an influx of spam, we have had to impose restrictions on new accounts. Please see [this wiki page](https://gitlab.freedesktop.org/freedesktop/freedesktop/-/wikis/home) for instructions on how to get full permissions. Sorry for the inconvenience.

![GStreamer](/uploads/-/system/group/avatar/1152/gst-logo-small.png?width=48)
# GStreamer

GStreamer open-source multimedia framework

Read more



=== Content from gstreamer.freedesktop.org_6df139fc_20250115_113649.html ===


| | [GStreamer](/) |  | | --- | --- | |  | | | open source multimedia framework | | |
| --- | --- | --- | --- | --- | --- | --- |

| |  | | --- | | |  | | | --- | --- | | [Home](/) |  | |  | | | | [Features](/features/) |  | |  | | | | [News](/news/) |  | |  | | | | [Annual Conference](/conference/) |  | |  | | | | [Planet (Blogs)](/planet/) |  | |  | | | | [Download](/download/) |  | |  | | | | [Applications](/apps/) |  | |  | | | |  |  | |  | | | | [Security Center](/security/) |  | |  | | | | [GitLab](https://gitlab.freedesktop.org/gstreamer/) |  | |  | | | | [Developers](/dev/) |  | |  | | | | [Documentation](/documentation/) |  | |  | | | | [Forum](https://discourse.gstreamer.org) |  | |  | | | | [File a Bug](/documentation/contribute/index.html) |  | |  | | | |  |  | |  | | | | [Artwork](/artwork/) |  | |  | | | | [@gstreamer on Twitter](http://twitter.com/gstreamer) |  | |  | | | | [@gstreamer on Mastodon](https://floss.social/%40GStreamer) |  | |  | | | | [#gstreamer on Matrix](https://matrix.to/#/#gstreamer:gstreamer.org) |  | |  | | | | |  | | News - GStreamer 1.25.1 unstable development release | | | --- | --- | | The GStreamer team is pleased to announce the first development release in the unstable 1.25 release series.  The unstable 1.25 release series is for testing and development purposes in the lead-up to the stable 1.26 series which is scheduled for release ASAP. Any newly-added API can still change until that point.  This development release is primarily for developers and early adopters.  The plan is to get 1.26 out of the door as quickly as possible.  Binaries for Android, iOS, Mac OS X and Windows will be made available shortly at the [usual location](https://gstreamer.freedesktop.org/pkg/).  Release tarballs can be downloaded directly here:  * [gstreamer-1.25.1.tar.xz](/src/gstreamer/gstreamer-1.25.1.tar.xz) * [gst-plugins-base-1.25.1.tar.xz](/src/gst-plugins-base/gst-plugins-base-1.25.1.tar.xz) * [gst-plugins-good-1.25.1.tar.xz](/src/gst-plugins-good/gst-plugins-good-1.25.1.tar.xz) * [gst-plugins-ugly-1.25.1.tar.xz](/src/gst-plugins-ugly/gst-plugins-ugly-1.25.1.tar.xz) * [gst-plugins-bad-1.25.1.tar.xz](/src/gst-plugins-bad/gst-plugins-bad-1.25.1.tar.xz) * [gst-libav-1.25.1.tar.xz](/src/gst-libav/gst-libav-1.25.1.tar.xz) * [gst-rtsp-server-1.25.1.tar.xz](/src/gst-rtsp-server/gst-rtsp-server-1.25.1.tar.xz) * [gst-python-1.25.1.tar.xz](/src/gst-python/gst-python-1.25.1.tar.xz) * [gst-editing-services-1.25.1.tar.xz](/src/gst-editing-services/gst-editing-services-1.25.1.tar.xz) * [gst-devtools-1.25.1.tar.xz](/src/gst-devtools/gst-devtools-1.25.1.tar.xz), * [gstreamer-vaapi-1.25.1.tar.xz](/src/gstreamer-vaapi/gstreamer-vaapi-1.25.1.tar.xz) * [gstreamer-docs-1.25.1.tar.xz](/src/gstreamer-docs/gstreamer-docs-1.25.1.tar.xz)  As always, please give it a spin and let us know of any issues you run into by filing an issue in [GitLab](https://gitlab.freedesktop.org/gstreamer/gstreamer/). | 2025-01-14 17:00 | | Recent older news: | | | GStreamer 1.24.11 stable bug fix release | 2025-01-06 23:30 | | GStreamer 1.24.10 stable bug fix release | 2024-12-03 23:30 | | Click for [even older news](news/)... | | News feeds: [[RSS 1.0]](news/rss-1.0.xml) |  What is GStreamer?  | GStreamer is a library for constructing graphs of media-handling components. The applications it supports range from simple Ogg/Vorbis playback, audio/video streaming to complex audio (mixing) and video (non-linear editing) processing.  Applications can take advantage of advances in codec and filter technology transparently. Developers can add new codecs and filters by writing a simple plugin with a clean, generic interface. [Read more ...](features/index.html)  GStreamer is released under the LGPL. The 1.x series is API and ABI stable and supersedes the previous stable 0.10 series. Both can be installed in parallel. | [gst-player gtk+ backend playing Sintel](/data/images/gtk-play-sintel.png) | | --- | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|

|  |
|

| *Report [a problem](https://gitlab.freedesktop.org/gstreamer/www/issues/new?issue%5Btitle%5D=%0AIssue%20with%20page%20%22GStreamer:%20open%20source%20multimedia%20framework%22%0A%20%20%20%20%20%20%20%20%20%20%20%20) on this page.* |



=== Content from gstreamer.freedesktop.org_9d3b0285_20250114_190139.html ===


| | [GStreamer](/) |  | | --- | --- | |  | | | open source multimedia framework | | |
| --- | --- | --- | --- | --- | --- | --- |

| |  | | --- | | |  | | | --- | --- | | [Home](/) |  | |  | | | | [Features](/features/) |  | |  | | | | [News](/news/) |  | |  | | | | [Annual Conference](/conference/) |  | |  | | | | [Planet (Blogs)](/planet/) |  | |  | | | | [Download](/download/) |  | |  | | | | [Applications](/apps/) |  | |  | | | |  |  | |  | | | | [Security Center](/security/) |  | |  | | | | [GitLab](https://gitlab.freedesktop.org/gstreamer/) |  | |  | | | | [Developers](/dev/) |  | |  | | | | [Documentation](/documentation/) |  | |  | | | | [Forum](https://discourse.gstreamer.org) |  | |  | | | | [File a Bug](/documentation/contribute/index.html) |  | |  | | | |  |  | |  | | | | [Artwork](/artwork/) |  | |  | | | | [@gstreamer on Twitter](http://twitter.com/gstreamer) |  | |  | | | | [@gstreamer on Mastodon](https://floss.social/%40GStreamer) |  | |  | | | | [#gstreamer on Matrix](https://matrix.to/#/#gstreamer:gstreamer.org) |  | |  | | | | |  | Security Advisory 2024-0027 (GHSL-2024-261, GHSL-2024-260, GHSL-2024-259, GHSL-2024-258, CVE-2024-47778, CVE-2024-47777, CVE-2024-47776, CVE-2024-47775)  |  |  | | --- | --- | | Summary | Various out-of-bounds reads in WAV parser | | Date | 2024-12-03 20:00 | | Affected Versions | GStreamer gst-plugins-good < 1.24.10 | | IDs | GStreamer-SA-2024-0027GHSL-2024-261, GHSL-2024-260, GHSL-2024-259, GHSL-2024-258CVE-2024-47778, CVE-2024-47777, CVE-2024-47776, CVE-2024-47775 |  Details Various out-of-bounds reads in the WAV parser that can cause crashes for certain input files. Impact It is possible for a malicious third party to trigger out-of-bounds reads that can result in a crash of the application. Solution The gst-plugins-good 1.24.10 release addresses the issue. People using older branches of GStreamer should apply the patch and recompile. ReferencesThe GStreamer project  * <https://gstreamer.freedesktop.org>  CVE Database Entries  * [CVE-2024-47778](https://www.cve.org/CVERecord?id=CVE-2024-47778) * [CVE-2024-47777](https://www.cve.org/CVERecord?id=CVE-2024-47777) * [CVE-2024-47776](https://www.cve.org/CVERecord?id=CVE-2024-47776) * [CVE-2024-47775](https://www.cve.org/CVERecord?id=CVE-2024-47775)  GStreamer releases1.24 (current stable)  * [GStreamer 1.24.10 release notes](/releases/1.24/#1.24.10) * [GStreamer Plugins Good 1.24.10](/src/gst-plugins-good/gst-plugins-good-1.24.10.tar.xz)  Patches  * [Patch](https://gitlab.freedesktop.org/gstreamer/gstreamer/-/merge_requests/8042.patch) |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

|

|  |
|

| *Report [a problem](https://gitlab.freedesktop.org/gstreamer/www/issues/new?issue%5Btitle%5D=%0AIssue%20with%20page%20%22GStreamer%20Security%20Advisory%22%0A%20%20%20%20%20%20%20%20%20%20%20%20) on this page.* |



=== Content from discourse.gstreamer.org_0f4ef6e4_20250115_113644.html ===


![GStreamer Discourse](data:image/svg;base64...)
Loading

[GStreamer Discourse](/)

| Category | Topics |
| --- | --- |
| [News and Announcements](/c/news/5)New releases, events and project news | 35 |
| [Plugin and library development](/c/plugin-dev/6)Support and questions about developing GStreamer itself | 73 |
| [Application Development](/c/app-dev/7)Support and questions about using GStreamer | 558 |
| [Showcase and Tips](/c/showcase/10)Usage of GStreamer and tips | 1 |
| [General Discussion](/c/general/4)Discussion revolving around GStreamer which does’t fit in the other categories | 458 |
| [Newcomers](/c/newcomers/11)New to GStreamer ? This is your place | 87 |
| [Site Feedback](/c/site-feedback/2) Discussion about this site, its organization, how it works, and how we can improve it. | 4 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled



=== Content from gitlab.freedesktop.org_ba224fd4_20250115_113643.html ===
From 13b48016b3ef1e822c393c2871b0a561ce19ecb3 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 13:00:57 +0300
Subject: [PATCH 1/7] wavparse: Check for short reads when parsing headers in
pull mode
And also return the actual flow return to the caller instead of always returning
GST\_FLOW\_ERROR.
Thanks to Antonio Morales for finding and reporting the issue.
Fixes GHSL-2024-258, GHSL-2024-260
Fixes https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3886
Fixes https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3888
Part-of:
---
.../gst/wavparse/gstwavparse.c | 63 ++++++++++++++-----
1 file changed, 46 insertions(+), 17 deletions(-)
diff --git a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
index d074f273c501..97d5591fae8f 100644
--- a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
+++ b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
@@ -1097,6 +1097,24 @@ parse\_ds64 (GstWavParse \* wav, GstBuffer \* buf)
return TRUE;
}
+static GstFlowReturn
+gst\_wavparse\_pull\_range\_exact (GstWavParse \* wav, guint64 offset, guint size,
+ GstBuffer \*\* buffer)
+{
+ GstFlowReturn res;
+
+ res = gst\_pad\_pull\_range (wav->sinkpad, offset, size, buffer);
+ if (res != GST\_FLOW\_OK)
+ return res;
+
+ if (gst\_buffer\_get\_size (\*buffer) < size) {
+ gst\_clear\_buffer (buffer);
+ return GST\_FLOW\_EOS;
+ }
+
+ return res;
+}
+
static GstFlowReturn
gst\_wavparse\_stream\_headers (GstWavParse \* wav)
{
@@ -1292,9 +1310,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
buf = NULL;
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset, 8,
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset, 8,
&buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ goto header\_pull\_error;
gst\_buffer\_map (buf, ↦, GST\_MAP\_READ);
tag = GST\_READ\_UINT32\_LE (map.data);
size = GST\_READ\_UINT32\_LE (map.data + 4);
@@ -1397,9 +1415,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
gst\_buffer\_unref (buf);
buf = NULL;
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset + 8,
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset + 8,
data\_size, &buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ goto header\_pull\_error;
gst\_buffer\_extract (buf, 0, &wav->fact, 4);
wav->fact = GUINT32\_FROM\_LE (wav->fact);
gst\_buffer\_unref (buf);
@@ -1444,9 +1462,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
gst\_buffer\_unref (buf);
buf = NULL;
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset + 8,
- size, &buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset + 8, size,
+ &buf)) != GST\_FLOW\_OK)
+ goto header\_pull\_error;
gst\_buffer\_map (buf, ↦, GST\_MAP\_READ);
acid = (const gst\_riff\_acid \*) map.data;
tempo = acid->tempo;
@@ -1484,9 +1502,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
gst\_buffer\_unref (buf);
buf = NULL;
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset, 12,
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset, 12,
&buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ goto header\_pull\_error;
gst\_buffer\_extract (buf, 8, &ltag, 4);
ltag = GUINT32\_FROM\_LE (ltag);
}
@@ -1513,9 +1531,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
buf = NULL;
if (data\_size > 0) {
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset,
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset,
data\_size, &buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ goto header\_pull\_error;
}
}
if (data\_size > 0) {
@@ -1553,9 +1571,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
buf = NULL;
wav->offset += 12;
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset,
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset,
data\_size, &buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ goto header\_pull\_error;
gst\_buffer\_map (buf, ↦, GST\_MAP\_READ);
gst\_wavparse\_adtl\_chunk (wav, (const guint8 \*) map.data,
data\_size);
@@ -1599,9 +1617,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
gst\_buffer\_unref (buf);
buf = NULL;
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset,
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset,
data\_size, &buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ goto header\_pull\_error;
gst\_buffer\_map (buf, ↦, GST\_MAP\_READ);
if (!gst\_wavparse\_cue\_chunk (wav, (const guint8 \*) map.data,
data\_size)) {
@@ -1643,9 +1661,9 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
gst\_buffer\_unref (buf);
buf = NULL;
if ((res =
- gst\_pad\_pull\_range (wav->sinkpad, wav->offset,
+ gst\_wavparse\_pull\_range\_exact (wav, wav->offset,
data\_size, &buf)) != GST\_FLOW\_OK)
- goto header\_read\_error;
+ goto header\_pull\_error;
gst\_buffer\_map (buf, ↦, GST\_MAP\_READ);
if (!gst\_wavparse\_smpl\_chunk (wav, (const guint8 \*) map.data,
data\_size)) {
@@ -1797,6 +1815,17 @@ header\_read\_error:
("Couldn't read in header %d (%s)", res, gst\_flow\_get\_name (res)));
goto fail;
}
+header\_pull\_error:
+ {
+ if (res == GST\_FLOW\_EOS) {
+ GST\_WARNING\_OBJECT (wav, "Couldn't pull header %d (%s)", res,
+ gst\_flow\_get\_name (res));
+ } else {
+ GST\_ELEMENT\_ERROR (wav, STREAM, DEMUX, (NULL),
+ ("Couldn't pull header %d (%s)", res, gst\_flow\_get\_name (res)));
+ }
+ goto exit;
+ }
}
/\*
--
GitLab
From 4c198f4891cfabde868944d55ff98925e7beb757 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 13:09:43 +0300
Subject: [PATCH 2/7] wavparse: Make sure enough data for the tag list tag is
available before parsing
Thanks to Antonio Morales for finding and reporting the issue.
Fixes GHSL-2024-258
Fixes https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3886
Part-of:
---
subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c | 4 ++++
1 file changed, 4 insertions(+)
diff --git a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
index 97d5591fae8f..21cb48c07eb3 100644
--- a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
+++ b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
@@ -1489,6 +1489,10 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
case GST\_RIFF\_TAG\_LIST:{
guint32 ltag;
+ /\* Need at least the ltag \*/
+ if (size < 4)
+ goto exit;
+
if (wav->streaming) {
const guint8 \*data = NULL;
--
GitLab
From 296e17b4ea81e5c228bb853f6037b654fdca7d47 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 13:15:27 +0300
Subject: [PATCH 3/7] wavparse: Fix parsing of acid chunk
Simply casting the bytes to a struct can lead to crashes because of unaligned
reads, and is also missing the endianness swapping that is necessary on big
endian architectures.
Part-of:
---
.../gst-plugins-good/gst/wavparse/gstwavparse.c | 12 +++++-------
1 file changed, 5 insertions(+), 7 deletions(-)
diff --git a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
index 21cb48c07eb3..6a0c44638ea2 100644
--- a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
+++ b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
@@ -1434,8 +1434,7 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
break;
}
case GST\_RIFF\_TAG\_acid:{
- const gst\_riff\_acid \*acid = NULL;
- const guint data\_size = sizeof (gst\_riff\_acid);
+ const guint data\_size = 24;
gfloat tempo;
GST\_INFO\_OBJECT (wav, "Have acid chunk");
@@ -1449,13 +1448,13 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
break;
}
if (wav->streaming) {
+ const guint8 \*data;
if (!gst\_wavparse\_peek\_chunk (wav, &tag, &size)) {
goto exit;
}
gst\_adapter\_flush (wav->adapter, 8);
- acid = (const gst\_riff\_acid \*) gst\_adapter\_map (wav->adapter,
- data\_size);
- tempo = acid->tempo;
+ data = gst\_adapter\_map (wav->adapter, data\_size);
+ tempo = GST\_READ\_FLOAT\_LE (data + 20);
gst\_adapter\_unmap (wav->adapter);
} else {
GstMapInfo map;
@@ -1466,8 +1465,7 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
&buf)) != GST\_FLOW\_OK)
goto header\_pull\_error;
gst\_buffer\_map (buf, ↦, GST\_MAP\_READ);
- acid = (const gst\_riff\_acid \*) map.data;
- tempo = acid->tempo;
+ tempo = GST\_READ\_FLOAT\_LE (map.data + 20);
gst\_buffer\_unmap (buf, ↦);
}
/\* send data as tags \*/
--
GitLab
From c72025cabdfcb2fe30d24eda7bb9d1d01a1b6555 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 13:21:44 +0300
Subject: [PATCH 4/7] wavparse: Check that at least 4 bytes are available
before parsing cue chunks
Part-of:
---
subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c | 5 +++++
1 file changed, 5 insertions(+)
diff --git a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
index 6a0c44638ea2..5655ee3825ca 100644
--- a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
+++ b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
@@ -790,6 +790,11 @@ gst\_wavparse\_cue\_chunk (GstWavParse \* wav, const guint8 \* data, guint32 size)
return TRUE;
}
+ if (size < 4) {
+ GST\_WARNING\_OBJECT (wav, "broken file %d", size);
+ return FALSE;
+ }
+
ncues = GST\_READ\_UINT32\_LE (data);
if (size < 4 + ncues \* 24) {
--
GitLab
From 93d79c22a82604adc5512557c1238f72f41188c4 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 13:22:02 +0300
Subject: [PATCH 5/7] wavparse: Check that at least 32 bytes are available
before parsing smpl chunks
Thanks to Antonio Morales for finding and reporting the issue.
Fixes GHSL-2024-259
Fixes https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3887
Part-of:
---
subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c | 3 +++
1 file changed, 3 insertions(+)
diff --git a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
index 5655ee3825ca..8a04805ed427 100644
--- a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
+++ b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
@@ -894,6 +894,9 @@ gst\_wavparse\_smpl\_chunk (GstWavParse \* wav, const guint8 \* data, guint32 size)
{
guint32 note\_number;
+ if (size < 32)
+ return FALSE;
+
/\*
manufacturer\_id = GST\_READ\_UINT32\_LE (data);
product\_id = GST\_READ\_UINT32\_LE (data + 4);
--
GitLab
From 526d0eef0d850c8f2fa1bf0aef15a836797f1a67 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 13:27:27 +0300
Subject: [PATCH 6/7] wavparse: Fix clipping of size to the file size
The size does not include the 8 bytes tag and length, so an additional 8 bytes
must be removed here. 8 bytes are always available at this point because
otherwise the parsing of the tag and length right above would've failed.
Thanks to Antonio Morales for finding and reporting the issue.
Fixes GHSL-2024-260
Fixes https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3888
Part-of:
---
subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c | 5 +++--
1 file changed, 3 insertions(+), 2 deletions(-)
diff --git a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
index 8a04805ed427..998cbb276dbf 100644
--- a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
+++ b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
@@ -1338,10 +1338,11 @@ gst\_wavparse\_stream\_headers (GstWavParse \* wav)
}
/\* Clip to upstream size if known \*/
- if (upstream\_size > 0 && size + wav->offset > upstream\_size) {
+ if (upstream\_size > 0 && size + 8 + wav->offset > upstream\_size) {
GST\_WARNING\_OBJECT (wav, "Clipping chunk size to file size");
g\_assert (upstream\_size >= wav->offset);
- size = upstream\_size - wav->offset;
+ g\_assert (upstream\_size - wav->offset >= 8);
+ size = upstream\_size - wav->offset - 8;
}
/\* wav is a st00pid format, we don't know for sure where data starts.
--
GitLab
From 4f381d15014471b026020d0990a5f5a9f420a22b Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Sebastian=20Dr=C3=B6ge?=
Date: Fri, 4 Oct 2024 13:51:00 +0300
Subject: [PATCH 7/7] wavparse: Check size before reading ds64 chunk
Thanks to Antonio Morales for finding and reporting the issue.
Fixes GHSL-2024-261
Fixes https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3889
Part-of:
---
subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c | 5 +++++
1 file changed, 5 insertions(+)
diff --git a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
index 998cbb276dbf..958868de6d9e 100644
--- a/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
+++ b/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c
@@ -1088,6 +1088,11 @@ parse\_ds64 (GstWavParse \* wav, GstBuffer \* buf)
guint32 sampleCountLow, sampleCountHigh;
gst\_buffer\_map (buf, ↦, GST\_MAP\_READ);
+ if (map.size < 6 \* 4) {
+ GST\_WARNING\_OBJECT (wav, "Too small ds64 chunk (%" G\_GSIZE\_FORMAT ")",
+ map.size);
+ return FALSE;
+ }
dataSizeLow = GST\_READ\_UINT32\_LE (map.data + 2 \* 4);
dataSizeHigh = GST\_READ\_UINT32\_LE (map.data + 3 \* 4);
sampleCountLow = GST\_READ\_UINT32\_LE (map.data + 4 \* 4);
--
GitLab


=== Content from securitylab.github.com_a5c690e2_20250114_190139.html ===

[skip to content](#content)

 /
[Security Lab](/ "Security Lab")
[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Events](/events/ "Events")

[Get Involved](/get-involved/)

* Resources
* [Open Source Community](/open-source "Home")
* [Enterprise](/enterprise "Home")

 /
[Security Lab](/ "Security Lab")

[Research](https://github.blog/tag/github-security-lab/ "Research")
[Advisories](/advisories/ "Advisories")
[CodeQL Wall of Fame](/codeql-wall-of-fame/ "CodeQL Wall of Fame")
Resources

[Open Source Community](/open-source "Open Source Community")
[Enterprise](/enterprise "Enterprise")

[Events](/events/ "Events")
[Get Involved](/get-involved/ "Events")

December 11, 2024
# GHSL-2024-259: OOB-read in gst\_wavparse\_smpl\_chunk in GStreamer - CVE-2024-47777

[![Author avatar](https://avatars.githubusercontent.com/u/55253029)
Antonio Morales](https://github.com/antonio-morales)

## Coordinated Disclosure Timeline

* 2024-10-03: Issue reported at https://gitlab.freedesktop.org/gstreamer/gstreamer/-/issues/3887
* 2024-10-04: Issue acknowledged
* 2024-12-03: [Fixed and reported](https://gstreamer.freedesktop.org/security/sa-2024-0027.html)

## Project

Gstreamer

## Tested Version

* Development version (2024/09/25)

## Details

### OOB-read in gst\_wavparse\_smpl\_chunk (`GHSL-2024-259`)

An OOB-read vulnerability has been identified in the [gst\_wavparse\_smpl\_chunk](https://gitlab.freedesktop.org/gstreamer/gstreamer/-/blob/a8f8bbef99e28bbf62aeaa774814b5c3a665e9d6/subprojects/gst-plugins-good/gst/wavparse/gstwavparse.c#L888) function within `gstwavparse.c`.

This function attempts to read 4 bytes from the `data + 12` offset without checking if the size of the `data` buffer is sufficient. If the buffer is too small, the function reads beyond its bounds:

```
static gboolean gst_wavparse_smpl_chunk (GstWavParse * wav, const guint8 * data, guint32 size){
...
  note_number = GST_READ_UINT32_LE (data + 12);
...
}

```

As a result, an OOB-read can happen.

#### Impact

This vulnerability may result in reading 4 bytes out of the boundaries of the `data` buffer.

## CVE

* CVE-2024-47777

## Credit

This issue was discovered and reported by GHSL team member [@antonio-morales (Antonio Morales)](https://github.com/antonio-morales).

## Contact

You can contact the GHSL team at `securitylab@github.com`, please include a reference to `GHSL-2024-259` in any communication regarding this issue.

## Product

* [Features](https://github.com/features)
* [Security](https://github.com/security)
* [Team](https://github.com/team)
* [Enterprise](https://github.com/enterprise)
* [Customer stories](https://github.com/customer-stories?type=enterprise)
* [The ReadME Project](https://github.com/readme)
* [Pricing](https://github.com/pricing)
* [Resources](https://resources.github.com)
* [Roadmap](https://github.com/github/roadmap)
* [Compare GitHub](https://resources.github.com/devops/tools/compare/)

## Platform

* [Developer API](https://developer.github.com)
* [Partners](http://partner.github.com/)
* [Atom](https://atom.io)
* [Electron](http://electron.atom.io/)
* [GitHub Desktop](https://desktop.github.com/)

## Support

* [Docs](https://docs.github.com)
* [Community Forum](https://github.community)
* [Professional Services](https://services.github.com/)
* [GitHub Skills](https://skills.github.com/)
* [Status](https://githubstatus.com/)
* [Contact GitHub](https://support.github.com)

## Company

* [About](https://github.com/about)
* [Blog](https://github.blog)
* [Careers](https://github.com/about/careers)
* [Press](https://github.com/about/press)
* [Inclusion](https://github.com/about/careers)
* [Social Impact](https://github.com/about/press)
* [Shop](https://shop.github.com)

* GitHub Inc. ©
  2024
* [Terms](https://docs.github.com/en/github/site-policy/github-terms-of-service)
* [Privacy](https://docs.github.com/en/github/site-policy/github-privacy-statement)
* Sitemap
* [What is Git?](https://github.com/git-guides)
* Manage Cookies
* Do not share my personal information



=== Content from matrix.to_c585fbad_20250115_113639.html ===


# Please enable javascript

Matrix.to is a preview service from chat rooms, people and communities on [Matrix](https://matrix.org).

It preserves your privacy by only processing what you view on the client side. For this to work, it needs javascript.


