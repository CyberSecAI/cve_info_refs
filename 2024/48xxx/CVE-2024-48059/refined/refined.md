Based on the provided content, here's a breakdown of the vulnerability:

**Root cause of vulnerability:**
The root cause is the lack of proper input sanitization when handling WebSocket messages. This allows malicious JavaScript to be injected into the message and stored within session data.

**Weaknesses/vulnerabilities present:**
- Stored Cross-Site Scripting (XSS) vulnerability is present in the WebSocket session transmission mechanism.

**Impact of exploitation:**
- An attacker can achieve code execution in the victim's browser.
- An attacker can potentially hijack user sessions.
- An attacker can steal sensitive user information.
- An attacker can perform unauthorized actions on behalf of the victim.

**Attack vectors:**
- A remote attacker injects a malicious JavaScript payload into a WebSocket message.
- The malicious payload is stored in the session data.
- When a victim accesses the session, the malicious script executes within their browser.

**Required attacker capabilities/position:**
- The attacker must be able to send WebSocket messages to the vulnerable server.
- The attacker does not need to be on the same network as the victim.

**Additional details:**
- The vulnerable software is `gaizhenbiao/chuanhuchatgpt` version <= 20240802.
- The vulnerability lies within the WebSocket session transmission component.