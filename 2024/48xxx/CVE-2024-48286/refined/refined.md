The provided content describes a command execution vulnerability in a Linksys E3000 router.

**Root cause of vulnerability:** The vulnerability stems from insufficient input sanitization in the `diag_ping_start` function within the router's httpd server.

**Weaknesses/vulnerabilities present:**
- **Command Injection:** The `ping_ip` parameter, received from HTTP requests, is directly incorporated into a command executed by the router. Lack of sanitization allows an attacker to inject arbitrary commands through this parameter.

**Impact of exploitation:**
- **Remote Code Execution (RCE):** Successful exploitation allows an attacker to execute arbitrary commands on the router, potentially gaining full control.
- **Router compromise:** An attacker could use the vulnerability to compromise the router and potentially use it to access the local network or other connected devices.
- **Rebooting the router:** The provided PoC demonstrates the ability to reboot the router, causing a denial of service.

**Attack vectors:**
- **HTTP Requests:** The attack is performed via HTTP requests to the `/apply.cgi` endpoint.
- **`ping_ip` Parameter:** The malicious command is injected into the `ping_ip` parameter.

**Required attacker capabilities/position:**
- **Network Access:** The attacker must have network access to the router's web interface (e.g., being on the same network or having access through port forwarding).
- **No Authentication Bypass Required:** The attacker must be able to send a request with a valid `session_id` cookie, this PoC assumes that they already are authenticated.