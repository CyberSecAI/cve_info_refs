The provided content relates to CVE-2024-48986.

**Root cause of vulnerability:**
The `hciEvtProcessMsg` function in the Cordio BLE stack parses incoming HCI command packets. It reads the packet length from the header and then allocates a buffer based on the event type using a lookup table. However, it copies data into the allocated buffer using the packet-supplied length, which can be larger than the allocated buffer size leading to a buffer overflow. Specifically, the vendor-specific HCI event (`hciEvtParseVendorSpec`) copies the entire byte stream into a buffer that may be too small.

**Weaknesses/vulnerabilities present:**
- **Buffer Overflow:** The vulnerability is a buffer overflow in `hciEvtParseVendorSpec`. The code copies data based on the length field in the received packet header, without checking if the provided length exceeds the allocated buffer's capacity.
- **Insufficient input validation:** The code trusts the length field in the incoming packet without proper validation, making it susceptible to malicious manipulation.

**Impact of exploitation:**
- **Memory Corruption:** By sending a crafted HCI packet with an overlong length field, an attacker can overwrite memory beyond the intended buffer, leading to potential crashes, denial of service, or potentially arbitrary code execution.

**Attack vectors:**
- Sending a crafted HCI (Host Controller Interface) event packet with an overlong length field to trigger the `hciEvtProcessMsg` function and subsequently the vulnerable `hciEvtParseVendorSpec` function within the Cordio BLE stack.

**Required attacker capabilities/position:**
- The attacker needs to be able to send HCI packets to the vulnerable device, meaning the attacker would likely need to be within radio range of the device and have knowledge of the BLE protocol.