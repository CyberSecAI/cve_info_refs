=== Content from github.com_228aed11_20250114_225446.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fassimp%2Fassimp%2Fissues%2F5788)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fassimp%2Fassimp%2Fissues%2F5788)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=assimp%2Fassimp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[assimp](/assimp)
/
**[assimp](/assimp/assimp)**
Public

* [Notifications](/login?return_to=%2Fassimp%2Fassimp) You must be signed in to change notification settings
* [Fork
  2.9k](/login?return_to=%2Fassimp%2Fassimp)
* [Star
   11.2k](/login?return_to=%2Fassimp%2Fassimp)

* [Code](/assimp/assimp)
* [Issues
  715](/assimp/assimp/issues)
* [Pull requests
  14](/assimp/assimp/pulls)
* [Discussions](/assimp/assimp/discussions)
* [Actions](/assimp/assimp/actions)
* [Projects
  0](/assimp/assimp/projects)
* [Wiki](/assimp/assimp/wiki)
* [Security](/assimp/assimp/security)
* [Insights](/assimp/assimp/pulse)

Additional navigation options

* [Code](/assimp/assimp)
* [Issues](/assimp/assimp/issues)
* [Pull requests](/assimp/assimp/pulls)
* [Discussions](/assimp/assimp/discussions)
* [Actions](/assimp/assimp/actions)
* [Projects](/assimp/assimp/projects)
* [Wiki](/assimp/assimp/wiki)
* [Security](/assimp/assimp/security)
* [Insights](/assimp/assimp/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fassimp%2Fassimp%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fassimp%2Fassimp%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Bug:Use After Free in the `CallbackToLogRedirector` #5788

Closed

[cla7aye15I4nd](/cla7aye15I4nd) opened this issue
Sep 20, 2024
· 1 comment
 · Fixed by [#5918](https://github.com/assimp/assimp/pull/5918)

Closed

# [Bug:Use After Free in the `CallbackToLogRedirector`](#top) #5788

[cla7aye15I4nd](/cla7aye15I4nd) opened this issue
Sep 20, 2024
· 1 comment
 · Fixed by [#5918](https://github.com/assimp/assimp/pull/5918)

Labels
[Bug](/assimp/assimp/labels/Bug)
Global flag to mark a deviation from expected behaviour
[Fuzzer](/assimp/assimp/labels/Fuzzer)
Bugs found by a fuzzer

## Comments

[![@cla7aye15I4nd](https://avatars.githubusercontent.com/u/17133261?s=80&v=4)](/cla7aye15I4nd)

Copy link

Contributor

### **[cla7aye15I4nd](/cla7aye15I4nd)** commented [Sep 20, 2024](#issue-2539271300) • edited Loading

| Affected Projects assimp v5.4.3 (<https://github.com/assimp/assimp>) Problem Type CWE-122: Heap-based Buffer Overflow DecriptionSummary A heap-use-after-free (UAF) vulnerability has been identified in the `CallbackToLogRedirector` function within the Assimp library. This issue was discovered using AddressSanitizer during fuzzing and occurs due to a dangling pointer being accessed after the associated memory was freed. Details The heap-use-after-free vulnerability occurs in the `CallbackToLogRedirector` function in the Assimp library (`Assimp.cpp:359`). During the process of logging, a previously freed memory region is accessed, leading to a use-after-free condition. This vulnerability stems from incorrect memory management, specifically, freeing a log stream and then attempting to access it later on.  The bug can be reproduced by running the fuzzer on the Assimp library with specific inputs that trigger this issue in the log handling logic. The AddressSanitizer report clearly indicates that the freed memory at `0x602000000050` is accessed, resulting in a UAF vulnerability. PoCSteps to reproduce:  1. Clone the Assimp repository and checkout the latest version. 2. Build Assimp using the following commands:    ```    cmake CMakeLists.txt -G "Ninja" -DBUILD_SHARED_LIBS=OFF -DASSIMP_BUILD_ZLIB=ON \                                -DASSIMP_BUILD_TESTS=OFF -DASSIMP_BUILD_ASSIMP_TOOLS=OFF \                                -DASSIMP_BUILD_SAMPLES=OFF -DCMAKE_CXX_FLAGS="-g -fsanitize=address" -DCMAKE_C_FLAGS="-g -fsanitize=address"        cmake --build .    ``` 3. Compile the fuzzer:    ```    clang -fsanitize=address,fuzzer -std=c++11 -Iinclude fuzz/assimp_fuzzer.cc -o assimp_fuzzer ./lib/libassimp.a ./contrib/zlib/libzlibstatic.a    ``` 4. Run the fuzzer to trigger the UAF vulnerability:    ```    $ echo -n ZyAgICAgICAgICD/ICAgIA== | base64 -d > poc    $ ./assimp_fuzzer ./poc    ```        This will reproduce the heap-use-after-free issue, and AddressSanitizer will report the error.  Impact This vulnerability allows memory corruption due to the reuse of freed memory, which could potentially be exploited in scenarios where an attacker provides malicious input to the Assimp library. This issue could lead to unexpected behavior, crashes, or more severe consequences like arbitrary code execution in contexts that rely on Assimp for parsing and importing 3D models.  Maintainers should address this vulnerability by ensuring proper memory management, such as avoiding the use of memory after it has been freed or ensuring that log streams are properly detached before being accessed. Sanitizer Report ``` ================================================================= ==671866==ERROR: AddressSanitizer: heap-use-after-free on address 0x502000000050 at pc 0x55555586385a bp 0x7fffffffc7e0 sp 0x7fffffffc7d8 READ of size 8 at 0x502000000050 thread T0     #0 0x555555863859 in CallbackToLogRedirector(char const*, char*) /root/code/Common/Assimp.cpp:359:8     #1 0x5555558aab77 in LogToCallbackRedirector::write(char const*) /root/code/Common/Assimp.cpp:150:9     #2 0x55555590a4a9 in Assimp::DefaultLogger::WriteToStreams(char const*, Assimp::Logger::ErrorSeverity) /root/code/Common/DefaultLogger.cpp:412:31     #3 0x55555590a889 in Assimp::DefaultLogger::OnInfo(char const*) /root/code/Common/DefaultLogger.cpp:292:5     #4 0x5555559098b6 in Assimp::Logger::info(char const*) /root/code/Common/DefaultLogger.cpp:194:12     #5 0x5555558e0853 in void Assimp::Logger::info<char const (&) [6], std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&>(char const (&) [6], std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&) /root/include/assimp/Logger.hpp:126:9     #6 0x5555558d5cdc in WriteLogOpening(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char>> const&) /root/code/Common/Importer.cpp:528:5     #7 0x5555558d2c07 in Assimp::Importer::ReadFile(char const*, unsigned int) /root/code/Common/Importer.cpp:599:5     #8 0x5555558d1fd9 in Assimp::Importer::ReadFileFromMemory(void const*, unsigned long, unsigned int, char const*) /root/code/Common/Importer.cpp:507:9     #9 0x555555861fa9 in LLVMFuzzerTestOneInput /root/fuzz/assimp_fuzzer.cc:54:34     #10 0x555555847714 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/root/assimp_fuzzer+0x2f3714) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #11 0x5555558482cc in fuzzer::Fuzzer::TryDetectingAMemoryLeak(unsigned char const*, unsigned long, bool) (/root/assimp_fuzzer+0x2f42cc) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #12 0x55555583088e in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/root/assimp_fuzzer+0x2dc88e) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #13 0x5555558362fa in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/root/assimp_fuzzer+0x2e22fa) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #14 0x555555860ab6 in main (/root/assimp_fuzzer+0x30cab6) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #15 0x7ffff6f1b1c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16     #16 0x7ffff6f1b28a in __libc_start_main csu/../csu/libc-start.c:360:3     #17 0x55555582b414 in _start (/root/assimp_fuzzer+0x2d7414) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)  0x502000000050 is located 0 bytes inside of 16-byte region [0x502000000050,0x502000000060) freed by thread T0 here:     #0 0x7ffff731150a in free build-llvm/tools/clang/stage2-bins/runtimes/runtimes-bins/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3     #1 0x5555558cdfb4 in Assimp::Intern::AllocateFromAssimpHeap::operator delete(void*) /root/code/Common/Importer.cpp:128:12     #2 0x55555590ba91 in Assimp::StdOStreamLogStream::~StdOStreamLogStream() /root/code/Common/StdOStreamLogStream.h:86:52     #3 0x5555558aa9df in LogToCallbackRedirector::~LogToCallbackRedirector() /root/code/Common/Assimp.cpp:143:13     #4 0x5555558aaad8 in LogToCallbackRedirector::~LogToCallbackRedirector() /root/code/Common/Assimp.cpp:130:32     #5 0x555555864245 in aiDetachLogStream /root/code/Common/Assimp.cpp:417:5     #6 0x555555862066 in LLVMFuzzerTestOneInput /root/fuzz/assimp_fuzzer.cc:64:5     #7 0x555555847714 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/root/assimp_fuzzer+0x2f3714) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #8 0x555555830846 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/root/assimp_fuzzer+0x2dc846) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #9 0x5555558362fa in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/root/assimp_fuzzer+0x2e22fa) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #10 0x555555860ab6 in main (/root/assimp_fuzzer+0x30cab6) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #11 0x7ffff6f1b1c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16     #12 0x7ffff6f1b28a in __libc_start_main csu/../csu/libc-start.c:360:3     #13 0x55555582b414 in _start (/root/assimp_fuzzer+0x2d7414) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)  previously allocated by thread T0 here:     #0 0x7ffff73117a3 in malloc build-llvm/tools/clang/stage2-bins/runtimes/runtimes-bins/compiler-rt/lib/asan/asan_malloc_linux.cpp:68:3     #1 0x7ffff7df05db in operator new(unsigned long) /build/gcc-14-OQFzmN/gcc-14-14-20240412/build/x86_64-linux-gnu/libstdc++-v3/libsupc++/../../../../src/libstdc++-v3/libsupc++/new_op.cc:50:22     #2 0x555555909090 in Assimp::LogStream::createDefaultStream(aiDefaultLogStream, char const*, Assimp::IOSystem*) /root/code/Common/DefaultLogger.cpp:112:16     #3 0x555555863989 in aiGetPredefinedLogStream /root/code/Common/Assimp.cpp:370:25     #4 0x555555861f68 in LLVMFuzzerTestOneInput /root/fuzz/assimp_fuzzer.cc:50:26     #5 0x555555847714 in fuzzer::Fuzzer::ExecuteCallback(unsigned char const*, unsigned long) (/root/assimp_fuzzer+0x2f3714) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #6 0x555555830846 in fuzzer::RunOneTest(fuzzer::Fuzzer*, char const*, unsigned long) (/root/assimp_fuzzer+0x2dc846) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #7 0x5555558362fa in fuzzer::FuzzerDriver(int*, char***, int (*)(unsigned char const*, unsigned long)) (/root/assimp_fuzzer+0x2e22fa) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #8 0x555555860ab6 in main (/root/assimp_fuzzer+0x30cab6) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)     #9 0x7ffff6f1b1c9 in __libc_start_call_main csu/../sysdeps/nptl/libc_start_call_main.h:58:16     #10 0x7ffff6f1b28a in __libc_start_main csu/../csu/libc-start.c:360:3     #11 0x55555582b414 in _start (/root/assimp_fuzzer+0x2d7414) (BuildId: d5d78d74e38444c01ccdf8262a60ae2542bf365a)  SUMMARY: AddressSanitizer: heap-use-after-free /root/code/Common/Assimp.cpp:359:8 in CallbackToLogRedirector(char const*, char*) Shadow bytes around the buggy address:   0x501ffffffd80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x501ffffffe00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x501ffffffe80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x501fffffff00: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x501fffffff80: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x502000000000: fa fa 00 00 fa fa fd fd fa fa[fd]fd fa fa fd fd   0x502000000080: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fd   0x502000000100: fa fa fd fd fa fa fd fd fa fa fd fa fa fa fd fa   0x502000000180: fa fa fd fa fa fa fd fa fa fa fd fa fa fa fd fa   0x502000000200: fa fa fd fd fa fa fd fa fa fa fd fa fa fa fd fd   0x502000000280: fa fa fd fd fa fa fd fd fa fa fd fd fa fa fd fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07    Heap left redzone:       fa   Freed heap region:       fd   Stack left redzone:      f1   Stack mid redzone:       f2   Stack right redzone:     f3   Stack after return:      f5   Stack use after scope:   f8   Global redzone:          f9   Global init order:       f6   Poisoned by user:        f7   Container overflow:      fc   Array cookie:            ac   Intra object redzone:    bb   ASan internal:           fe   Left alloca redzone:     ca   Right alloca redzone:    cb ==671866==ABORTING  ``` |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@cla7aye15I4nd](https://avatars.githubusercontent.com/u/17133261?s=40&v=4)](/cla7aye15I4nd)
[cla7aye15I4nd](/cla7aye15I4nd)
added
the
[Bug](/assimp/assimp/labels/Bug)
Global flag to mark a deviation from expected behaviour
label
[Sep 20, 2024](#event-14343206223)

[![@kimkulling](https://avatars.githubusercontent.com/u/2323156?s=40&u=b9dbe9412e050771885a4438b0bbacf4850b217c&v=4)](/kimkulling)
[kimkulling](/kimkulling)
added
the
[Fuzzer](/assimp/assimp/labels/Fuzzer)
Bugs found by a fuzzer
label
[Oct 8, 2024](#event-14552265501)

[![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=80&v=4)](/abergmann)

Copy link

### **[abergmann](/abergmann)** commented [Oct 25, 2024](#issuecomment-2436996696)

| [CVE-2024-48423](https://www.cve.org/CVERecord?id=CVE-2024-48423) was assigned to this issue. |
| --- |

All reactions

Sorry, something went wrong.

[![@tyler92](https://avatars.githubusercontent.com/u/9139451?s=40&v=4)](/tyler92)
[tyler92](/tyler92)
mentioned this issue
[Dec 10, 2024](#ref-pullrequest-2731206278)

[Fix use after free in the CallbackToLogRedirector
#5918](/assimp/assimp/pull/5918)
 Merged

[![@kimkulling](https://avatars.githubusercontent.com/u/2323156?s=40&u=b9dbe9412e050771885a4438b0bbacf4850b217c&v=4)](/kimkulling)
[kimkulling](/kimkulling)
closed this as [completed](/assimp/assimp/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
[#5918](/assimp/assimp/pull/5918)
[Dec 11, 2024](#event-15615611370)

[![@kimkulling](https://avatars.githubusercontent.com/u/2323156?s=40&u=b9dbe9412e050771885a4438b0bbacf4850b217c&v=4)](/kimkulling)
[kimkulling](/kimkulling)
added this to [The Asset-Importer-Lib Kanban Board](/orgs/assimp/projects/2)
[Dec 11, 2024](#event-15615619417)

[![@kimkulling](https://avatars.githubusercontent.com/u/2323156?s=40&u=b9dbe9412e050771885a4438b0bbacf4850b217c&v=4)](/kimkulling)
[kimkulling](/kimkulling)
moved this to **✅ Done**
in [The Asset-Importer-Lib Kanban Board](/orgs/assimp/projects/2)
[Dec 11, 2024](#event-15615619573)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fassimp%2Fassimp%2Fissues%2F5788)

Assignees

No one assigned

Labels

[Bug](/assimp/assimp/labels/Bug)
Global flag to mark a deviation from expected behaviour
[Fuzzer](/assimp/assimp/labels/Fuzzer)
Bugs found by a fuzzer

Projects

[The Asset-Importer-Lib Kanban Board](/orgs/assimp/projects/2)

Status: ✅ Done

 +2 more

Milestone

No milestone

Development

Successfully merging a pull request may close this issue.

 [Fix use after free in the CallbackToLogRedirector](/assimp/assimp/pull/5918)
 [tyler92/assimp](/tyler92/assimp)

3 participants

[![@kimkulling](https://avatars.githubusercontent.com/u/2323156?s=52&v=4)](/kimkulling) [![@abergmann](https://avatars.githubusercontent.com/u/4102163?s=52&v=4)](/abergmann) [![@cla7aye15I4nd](https://avatars.githubusercontent.com/u/17133261?s=52&v=4)](/cla7aye15I4nd)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


