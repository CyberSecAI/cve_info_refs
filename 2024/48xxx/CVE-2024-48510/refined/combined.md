=== Content from github.com_00689063_20250115_091447.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhaf%2FDotNetZip.Semverd%2Fblob%2Fe487179b33a9a0f2631eed5fb04d2c952ea5377a%2Fsrc%2FZip.Shared%2FZipEntry.Extract.cs)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhaf%2FDotNetZip.Semverd%2Fblob%2Fe487179b33a9a0f2631eed5fb04d2c952ea5377a%2Fsrc%2FZip.Shared%2FZipEntry.Extract.cs)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=haf%2FDotNetZip.Semverd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 15, 2024. It is now read-only.

[haf](/haf)
/
**[DotNetZip.Semverd](/haf/DotNetZip.Semverd)**
Public archive

* [Notifications](/login?return_to=%2Fhaf%2FDotNetZip.Semverd) You must be signed in to change notification settings
* [Fork
  236](/login?return_to=%2Fhaf%2FDotNetZip.Semverd)
* [Star
   549](/login?return_to=%2Fhaf%2FDotNetZip.Semverd)

* [Code](/haf/DotNetZip.Semverd)
* [Issues
  103](/haf/DotNetZip.Semverd/issues)
* [Pull requests
  6](/haf/DotNetZip.Semverd/pulls)
* [Actions](/haf/DotNetZip.Semverd/actions)
* [Projects
  0](/haf/DotNetZip.Semverd/projects)
* [Wiki](/haf/DotNetZip.Semverd/wiki)
* [Security](/haf/DotNetZip.Semverd/security)
* [Insights](/haf/DotNetZip.Semverd/pulse)

Additional navigation options

* [Code](/haf/DotNetZip.Semverd)
* [Issues](/haf/DotNetZip.Semverd/issues)
* [Pull requests](/haf/DotNetZip.Semverd/pulls)
* [Actions](/haf/DotNetZip.Semverd/actions)
* [Projects](/haf/DotNetZip.Semverd/projects)
* [Wiki](/haf/DotNetZip.Semverd/wiki)
* [Security](/haf/DotNetZip.Semverd/security)
* [Insights](/haf/DotNetZip.Semverd/pulse)

## Files

 e487179
## Breadcrumbs

1. [DotNetZip.Semverd](/haf/DotNetZip.Semverd/tree/e487179b33a9a0f2631eed5fb04d2c952ea5377a)
2. /[src](/haf/DotNetZip.Semverd/tree/e487179b33a9a0f2631eed5fb04d2c952ea5377a/src)
3. /[Zip.Shared](/haf/DotNetZip.Semverd/tree/e487179b33a9a0f2631eed5fb04d2c952ea5377a/src/Zip.Shared)
/
# ZipEntry.Extract.cs

Copy path Blame  Blame
## Latest commit

## History

[History](/haf/DotNetZip.Semverd/commits/e487179b33a9a0f2631eed5fb04d2c952ea5377a/src/Zip.Shared/ZipEntry.Extract.cs)1424 lines (1276 loc) · 58 KB e487179
## Breadcrumbs

1. [DotNetZip.Semverd](/haf/DotNetZip.Semverd/tree/e487179b33a9a0f2631eed5fb04d2c952ea5377a)
2. /[src](/haf/DotNetZip.Semverd/tree/e487179b33a9a0f2631eed5fb04d2c952ea5377a/src)
3. /[Zip.Shared](/haf/DotNetZip.Semverd/tree/e487179b33a9a0f2631eed5fb04d2c952ea5377a/src/Zip.Shared)
/
# ZipEntry.Extract.cs

Top
## File metadata and controls

* Code
* Blame

1424 lines (1276 loc) · 58 KB[Raw](https://github.com/haf/DotNetZip.Semverd/raw/e487179b33a9a0f2631eed5fb04d2c952ea5377a/src/Zip.Shared/ZipEntry.Extract.cs)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012022032042052062072082092102112122132142152162172182192202212222232242252262272282292302312322332342352362372382392402412422432442452462472482492502512522532542552562572582592602612622632642652662672682692702712722732742752762772782792802812822832842852862872882892902912922932942952962972982993003013023033043053063073083093103113123133143153163173183193203213223233243253263273283293303313323333343353363373383393403413423433443453463473483493503513523533543553563573583593603613623633643653663673683693703713723733743753763773783793803813823833843853863873883893903913923933943953963973983994004014024034044054064074084094104114124134144154164174184194204214224234244254264274284294304314324334344354364374384394404414424434444454464474484494504514524534544554564574584594604614624634644654664674684694704714724734744754764774784794804814824834844854864874884894904914924934944954964974984995005015025035045055065075085095105115125135145155165175185195205215225235245255265275285295305315325335345355365375385395405415425435445455465475485495505515525535545555565575585595605615625635645655665675685695705715725735745755765775785795805815825835845855865875885895905915925935945955965975985996006016026036046056066076086096106116126136146156166176186196206216226236246256266276286296306316326336346356366376386396406416426436446456466476486496506516526536546556566576586596606616626636646656666676686696706716726736746756766776786796806816826836846856866876886896906916926936946956966976986997007017027037047057067077087097107117127137147157167177187197207217227237247257267277287297307317327337347357367377387397407417427437447457467477487497507517527537547557567577587597607617627637647657667677687697707717727737747757767777787797807817827837847857867877887897907917927937947957967977987998008018028038048058068078088098108118128138148158168178188198208218228238248258268278288298308318328338348358368378388398408418428438448458468478488498508518528538548558568578588598608618628638648658668678688698708718728738748758768778788798808818828838848858868878888898908918928938948958968978988999009019029039049059069079089099109119129139149159169179189199209219229239249259269279289299309319329339349359369379389399409419429439449459469479489499509519529539549559569579589599609619629639649659669679689699709719729739749759769779789799809819829839849859869879889899909919929939949959969979989991000// ZipEntry.Extract.cs// ------------------------------------------------------------------//// Copyright (c) 2009-2011 Dino Chiesa// All rights reserved.//// This code module is part of DotNetZip, a zipfile class library.//// ------------------------------------------------------------------//// This code is licensed under the Microsoft Public License.// See the file License.txt for the license details.// More info on: http://dotnetzip.codeplex.com//// ------------------------------------------------------------------//// last saved (in emacs):// Time-stamp: <2011-August-06 18:08:21>//// ------------------------------------------------------------------//// This module defines logic for Extract methods on the ZipEntry class.//// ------------------------------------------------------------------
using System;using System.IO;
namespace Ionic.Zip{
 public partial class ZipEntry { /// <summary> /// Extract the entry to the filesystem, starting at the current /// working directory. /// </summary> /// /// <overloads> /// This method has a bunch of overloads! One of them is sure to /// be the right one for you... If you don't like these, check /// out the <c>ExtractWithPassword()</c> methods. /// </overloads> /// /// <seealso cref="Ionic.Zip.ZipEntry.ExtractExistingFile"/> /// <seealso cref="ZipEntry.Extract(ExtractExistingFileAction)"/> /// /// <remarks> /// /// <para> /// This method extracts an entry from a zip file into the current /// working directory. The path of the entry as extracted is the full /// path as specified in the zip archive, relative to the current /// working directory. After the file is extracted successfully, the /// file attributes and timestamps are set. /// </para> /// /// <para> /// The action taken when extraction an entry would overwrite an /// existing file is determined by the <see cref="ExtractExistingFile" /// /> property. /// </para> /// /// <para> /// Within the call to <c>Extract()</c>, the content for the entry is /// written into a filesystem file, and then the last modified time of the /// file is set according to the <see cref="LastModified"/> property on /// the entry. See the remarks the <see cref="LastModified"/> property for /// some details about the last modified time. /// </para> /// /// </remarks> public void Extract() { InternalExtractToBaseDir(".", null, \_container, \_Source, FileName); }
 /// <summary> /// Extract the entry to a file in the filesystem, using the specified /// behavior when extraction would overwrite an existing file. /// </summary> /// /// <remarks> /// <para> /// See the remarks on the <see cref="LastModified"/> property, for some /// details about how the last modified time of the file is set after /// extraction. /// </para> /// </remarks> /// /// <param name="extractExistingFile"> /// The action to take if extraction would overwrite an existing file. /// </param> public void Extract(ExtractExistingFileAction extractExistingFile) { ExtractExistingFile = extractExistingFile; InternalExtractToBaseDir(".", null, \_container, \_Source, FileName); }
 /// <summary> /// Extracts the entry to the specified stream. /// </summary> /// /// <remarks> /// <para> /// The caller can specify any write-able stream, for example a <see /// cref="System.IO.FileStream"/>, a <see /// cref="System.IO.MemoryStream"/>, or ASP.NET's /// <c>Response.OutputStream</c>. The content will be decrypted and /// decompressed as necessary. If the entry is encrypted and no password /// is provided, this method will throw. /// </para> /// <para> /// The position on the stream is not reset by this method before it extracts. /// You may want to call stream.Seek() before calling ZipEntry.Extract(). /// </para> /// </remarks> /// /// <param name="stream"> /// the stream to which the entry should be extracted. /// </param> /// public void Extract(Stream stream) { InternalExtractToStream(stream, null, \_container, \_Source, FileName); }
 /// <summary> /// Extract the entry to the filesystem, starting at the specified base /// directory. /// </summary> /// /// <param name="baseDirectory">the pathname of the base directory</param> /// /// <seealso cref="Ionic.Zip.ZipEntry.ExtractExistingFile"/> /// <seealso cref="Ionic.Zip.ZipEntry.Extract(string, ExtractExistingFileAction)"/> /// /// <example> /// This example extracts only the entries in a zip file that are .txt files, /// into a directory called "textfiles". /// <code lang="C#"> /// using (ZipFile zip = ZipFile.Read("PackedDocuments.zip")) /// { /// foreach (string s1 in zip.EntryFilenames) /// { /// if (s1.EndsWith(".txt")) /// { /// zip[s1].Extract("textfiles"); /// } /// } /// } /// </code> /// <code lang="VB"> /// Using zip As ZipFile = ZipFile.Read("PackedDocuments.zip") /// Dim s1 As String /// For Each s1 In zip.EntryFilenames /// If s1.EndsWith(".txt") Then /// zip(s1).Extract("textfiles") /// End If /// Next /// End Using /// </code> /// </example> /// /// <remarks> /// /// <para> /// Using this method, existing entries in the filesystem will not be /// overwritten. If you would like to force the overwrite of existing /// files, see the <see cref="ExtractExistingFile"/> property, or call /// <see cref="Extract(string, ExtractExistingFileAction)"/>. /// </para> /// /// <para> /// See the remarks on the <see cref="LastModified"/> property, for some /// details about how the last modified time of the created file is set. /// </para> /// </remarks> public void Extract(string baseDirectory) { InternalExtractToBaseDir(baseDirectory, null, \_container, \_Source, FileName); }
 /// <summary> /// Extract the entry to the filesystem, starting at the specified base /// directory, and using the specified behavior when extraction would /// overwrite an existing file. /// </summary> /// /// <remarks> /// <para> /// See the remarks on the <see cref="LastModified"/> property, for some /// details about how the last modified time of the created file is set. /// </para> /// </remarks> /// /// <example> /// <code lang="C#"> /// String sZipPath = "Airborne.zip"; /// String sFilePath = "Readme.txt"; /// String sRootFolder = "Digado"; /// using (ZipFile zip = ZipFile.Read(sZipPath)) /// { /// if (zip.EntryFileNames.Contains(sFilePath)) /// { /// // use the string indexer on the zip file /// zip[sFileName].Extract(sRootFolder, /// ExtractExistingFileAction.OverwriteSilently); /// } /// } /// </code> /// /// <code lang="VB"> /// Dim sZipPath as String = "Airborne.zip" /// Dim sFilePath As String = "Readme.txt" /// Dim sRootFolder As String = "Digado" /// Using zip As ZipFile = ZipFile.Read(sZipPath) /// If zip.EntryFileNames.Contains(sFilePath) /// ' use the string indexer on the zip file /// zip(sFilePath).Extract(sRootFolder, \_ /// ExtractExistingFileAction.OverwriteSilently) /// End If /// End Using /// </code> /// </example> /// /// <param name="baseDirectory">the pathname of the base directory</param> /// <param name="extractExistingFile"> /// The action to take if extraction would overwrite an existing file. /// </param> public void Extract(string baseDirectory, ExtractExistingFileAction extractExistingFile) { ExtractExistingFile = extractExistingFile; InternalExtractToBaseDir(baseDirectory, null, \_container, \_Source, FileName); }
 /// <summary> /// Extract the entry to the filesystem, using the current working directory /// and the specified password. /// </summary> /// /// <overloads> /// This method has a bunch of overloads! One of them is sure to be /// the right one for you... /// </overloads> /// /// <seealso cref="Ionic.Zip.ZipEntry.ExtractExistingFile"/> /// <seealso cref="Ionic.Zip.ZipEntry.ExtractWithPassword(ExtractExistingFileAction, string)"/> /// /// <remarks> /// /// <para> /// Existing entries in the filesystem will not be overwritten. If you /// would like to force the overwrite of existing files, see the <see /// cref="Ionic.Zip.ZipEntry.ExtractExistingFile"/>property, or call /// <see /// cref="ExtractWithPassword(ExtractExistingFileAction,string)"/>. /// </para> /// /// <para> /// See the remarks on the <see cref="LastModified"/> property for some /// details about how the "last modified" time of the created file is /// set. /// </para> /// </remarks> /// /// <example> /// In this example, entries that use encryption are extracted using a /// particular password. /// <code> /// using (var zip = ZipFile.Read(FilePath)) /// { /// foreach (ZipEntry e in zip) /// { /// if (e.UsesEncryption) /// e.ExtractWithPassword("Secret!"); /// else /// e.Extract(); /// } /// } /// </code> /// <code lang="VB"> /// Using zip As ZipFile = ZipFile.Read(FilePath) /// Dim e As ZipEntry /// For Each e In zip /// If (e.UsesEncryption) /// e.ExtractWithPassword("Secret!") /// Else /// e.Extract /// End If /// Next /// End Using /// </code> /// </example> /// <param name="password">The Password to use for decrypting the entry.</param> public void ExtractWithPassword(string password) { InternalExtractToBaseDir(".", password, \_container, \_Source, FileName); }
 /// <summary> /// Extract the entry to the filesystem, starting at the specified base /// directory, and using the specified password. /// </summary> /// /// <seealso cref="Ionic.Zip.ZipEntry.ExtractExistingFile"/> /// <seealso cref="Ionic.Zip.ZipEntry.ExtractWithPassword(string, ExtractExistingFileAction, string)"/> /// /// <remarks> /// <para> /// Existing entries in the filesystem will not be overwritten. If you /// would like to force the overwrite of existing files, see the <see /// cref="Ionic.Zip.ZipEntry.ExtractExistingFile"/>property, or call /// <see /// cref="ExtractWithPassword(ExtractExistingFileAction,string)"/>. /// </para> /// /// <para> /// See the remarks on the <see cref="LastModified"/> property, for some /// details about how the last modified time of the created file is set. /// </para> /// </remarks> /// /// <param name="baseDirectory">The pathname of the base directory.</param> /// <param name="password">The Password to use for decrypting the entry.</param> public void ExtractWithPassword(string baseDirectory, string password) { InternalExtractToBaseDir(baseDirectory, password, \_container, \_Source, FileName); }
 /// <summary> /// Extract the entry to a file in the filesystem, relative to the /// current directory, using the specified behavior when extraction /// would overwrite an existing file. /// </summary> /// /// <remarks> /// <para> /// See the remarks on the <see cref="LastModified"/> property, for some /// details about how the last modified time of the created file is set. /// </para> /// </remarks> /// /// <param name="password">The Password to use for decrypting the entry.</param> /// /// <param name="extractExistingFile"> /// The action to take if extraction would overwrite an existing file. /// </param> public void ExtractWithPassword(ExtractExistingFileAction extractExistingFile, string password) { ExtractExistingFile = extractExistingFile; InternalExtractToBaseDir(".", password, \_container, \_Source, FileName); }
 /// <summary> /// Extract the entry to the filesystem, starting at the specified base /// directory, and using the specified behavior when extraction would /// overwrite an existing file. /// </summary> /// /// <remarks> /// See the remarks on the <see cref="LastModified"/> property, for some /// details about how the last modified time of the created file is set. /// </remarks> /// /// <param name="baseDirectory">the pathname of the base directory</param> /// /// <param name="extractExistingFile">The action to take if extraction would /// overwrite an existing file.</param> /// /// <param name="password">The Password to use for decrypting the entry.</param> public void ExtractWithPassword(string baseDirectory, ExtractExistingFileAction extractExistingFile, string password) { ExtractExistingFile = extractExistingFile; InternalExtractToBaseDir(baseDirectory, password, \_container, \_Source, FileName); }
 /// <summary> /// Extracts the entry to the specified stream, using the specified /// Password. For example, the caller could extract to Console.Out, or /// to a MemoryStream. /// </summary> /// /// <remarks> /// <para> /// The caller can specify any write-able stream, for example a <see /// cref="System.IO.FileStream"/>, a <see /// cref="System.IO.MemoryStream"/>, or ASP.NET's /// <c>Response.OutputStream</c>. The content will be decrypted and /// decompressed as necessary. If the entry is encrypted and no password /// is provided, this method will throw. /// </para> /// <para> /// The position on the stream is not reset by this method before it extracts. /// You may want to call stream.Seek() before calling ZipEntry.Extract(). /// </para> /// </remarks> /// /// /// <param name="stream"> /// the stream to which the entry should be extracted. /// </param> /// <param name="password"> /// The password to use for decrypting the entry. /// </param> public void ExtractWithPassword(Stream stream, string password) { InternalExtractToStream(stream, password, \_container, \_Source, FileName); }
 /// <summary> /// Opens a readable stream corresponding to the zip entry in the /// archive. The stream decompresses and decrypts as necessary, as it /// is read. /// </summary> /// /// <remarks> /// /// <para> /// DotNetZip offers a variety of ways to extract entries from a zip /// file. This method allows an application to extract an entry by /// reading a <see cref="System.IO.Stream"/>. /// </para> /// /// <para> /// The return value is of type <see /// cref="Ionic.Crc.CrcCalculatorStream"/>. Use it as you would any /// stream for reading. When an application calls <see /// cref="Stream.Read(byte[], int, int)"/> on that stream, it will /// receive data from the zip entry that is decrypted and decompressed /// as necessary. /// </para> /// /// <para> /// <c>CrcCalculatorStream</c> adds one additional feature: it keeps a /// CRC32 checksum on the bytes of the stream as it is read. The CRC /// value is available in the <see /// cref="Ionic.Crc.CrcCalculatorStream.Crc"/> property on the /// <c>CrcCalculatorStream</c>. When the read is complete, your /// application /// <em>should</em> check this CRC against the <see cref="ZipEntry.Crc"/> /// property on the <c>ZipEntry</c> to validate the content of the /// ZipEntry. You don't have to validate the entry using the CRC, but /// you should, to verify integrity. Check the example for how to do /// this. /// </para> /// /// <para> /// If the entry is protected with a password, then you need to provide /// a password prior to calling <see cref="OpenReader()"/>, either by /// setting the <see cref="Password"/> property on the entry, or the /// <see cref="ZipFile.Password"/> property on the <c>ZipFile</c> /// itself. Or, you can use <see cref="OpenReader(String)" />, the /// overload of OpenReader that accepts a password parameter. /// </para> /// /// <para> /// If you want to extract entry data into a write-able stream that is /// already opened, like a <see cref="System.IO.FileStream"/>, do not /// use this method. Instead, use <see cref="Extract(Stream)"/>. /// </para> /// /// <para> /// Your application may use only one stream created by OpenReader() at /// a time, and you should not call other Extract methods before /// completing your reads on a stream obtained from OpenReader(). This /// is because there is really only one source stream for the compressed /// content. A call to OpenReader() seeks in the source stream, to the /// beginning of the compressed content. A subsequent call to /// OpenReader() on a different entry will seek to a different position /// in the source stream, as will a call to Extract() or one of its /// overloads. This will corrupt the state for the decompressing stream /// from the original call to OpenReader(). /// </para> /// /// <para> /// The <c>OpenReader()</c> method works only when the ZipEntry is /// obtained from an instance of <c>ZipFile</c>. This method will throw /// an exception if the ZipEntry is obtained from a <see /// cref="ZipInputStream"/>. /// </para> /// </remarks> /// /// <example> /// This example shows how to open a zip archive, then read in a named /// entry via a stream. After the read loop is complete, the code /// compares the calculated during the read loop with the expected CRC /// on the <c>ZipEntry</c>, to verify the extraction. /// <code> /// using (ZipFile zip = new ZipFile(ZipFileToRead)) /// { /// ZipEntry e1= zip["Elevation.mp3"]; /// using (Ionic.Zlib.CrcCalculatorStream s = e1.OpenReader()) /// { /// byte[] buffer = new byte[4096]; /// int n, totalBytesRead= 0; /// do { /// n = s.Read(buffer,0, buffer.Length); /// totalBytesRead+=n; /// } while (n&gt;0); /// if (s.Crc32 != e1.Crc32) /// throw new Exception(string.Format("The Zip Entry failed the CRC Check. (0x{0:X8}!=0x{1:X8})", s.Crc32, e1.Crc32)); /// if (totalBytesRead != e1.UncompressedSize) /// throw new Exception(string.Format("We read an unexpected number of bytes. ({0}!={1})", totalBytesRead, e1.UncompressedSize)); /// } /// } /// </code> /// <code lang="VB"> /// Using zip As New ZipFile(ZipFileToRead) /// Dim e1 As ZipEntry = zip.Item("Elevation.mp3") /// Using s As Ionic.Zlib.CrcCalculatorStream = e1.OpenReader /// Dim n As Integer /// Dim buffer As Byte() = New Byte(4096) {} /// Dim totalBytesRead As Integer = 0 /// Do /// n = s.Read(buffer, 0, buffer.Length) /// totalBytesRead = (totalBytesRead + n) /// Loop While (n &gt; 0) /// If (s.Crc32 &lt;&gt; e1.Crc32) Then /// Throw New Exception(String.Format("The Zip Entry failed the CRC Check. (0x{0:X8}!=0x{1:X8})", s.Crc32, e1.Crc32)) /// End If /// If (totalBytesRead &lt;&gt; e1.UncompressedSize) Then /// Throw New Exception(String.Format("We read an unexpected number of bytes. ({0}!={1})", totalBytesRead, e1.UncompressedSize)) /// End If /// End Using /// End Using /// </code> /// </example> /// <seealso cref="Ionic.Zip.ZipEntry.Extract(System.IO.Stream)"/> /// <returns>The Stream for reading.</returns> public Crc.CrcCalculatorStream OpenReader() { // workitem 10923 if (\_container.ZipFile == null) throw new InvalidOperationException("Use OpenReader() only with ZipFile.");
 // use the entry password if it is non-null, // else use the zipfile password, which is possibly null return InternalOpenReader(\_Password ?? \_container.Password); }
 /// <summary> /// Opens a readable stream for an encrypted zip entry in the archive. /// The stream decompresses and decrypts as necessary, as it is read. /// </summary> /// /// <remarks> /// <para> /// See the documentation on the <see cref="OpenReader()"/> method for /// full details. This overload allows the application to specify a /// password for the <c>ZipEntry</c> to be read. /// </para> /// </remarks> /// /// <param name="password">The password to use for decrypting the entry.</param> /// <returns>The Stream for reading.</returns> public Ionic.Crc.CrcCalculatorStream OpenReader(string password) { // workitem 10923 if (\_container.ZipFile == null) throw new InvalidOperationException("Use OpenReader() only with ZipFile.");
 return InternalOpenReader(password); }
 internal Crc.CrcCalculatorStream InternalOpenReader(string password) { ValidateCompression(\_CompressionMethod\_FromZipFile, FileName, GetUnsupportedCompressionMethod(\_CompressionMethod)); ValidateEncryption(Encryption, FileName, \_UnsupportedAlgorithmId); SetupCryptoForExtract(password);
 // workitem 7958 if (this.\_Source != ZipEntrySource.ZipFile) throw new BadStateException("You must call ZipFile.Save before calling OpenReader");
 // LeftToRead is a count of bytes remaining to be read (out) // from the stream AFTER decompression and decryption. // It is the uncompressed size, unless ... there is no compression in which // case ...? :< I'm not sure why it's not always UncompressedSize var leftToRead = (\_CompressionMethod\_FromZipFile == (short)CompressionMethod.None) ? \_CompressedFileDataSize : UncompressedSize;
 this.ArchiveStream.Seek(this.FileDataPosition, SeekOrigin.Begin);
 \_inputDecryptorStream = GetExtractDecryptor(ArchiveStream); var input3 = GetExtractDecompressor(\_inputDecryptorStream);
 return new Crc.CrcCalculatorStream(input3, leftToRead); }
 void OnExtractProgress(Int64 bytesWritten, Int64 totalBytesToWrite) { if (\_container.ZipFile != null) \_ioOperationCanceled = \_container.ZipFile.OnExtractBlock(this, bytesWritten, totalBytesToWrite); }
 static void OnBeforeExtract(ZipEntry zipEntryInstance, string path, ZipFile zipFile) { // When in the context of a ZipFile.ExtractAll, the events are generated from // the ZipFile method, not from within the ZipEntry instance. (why?) // Therefore we suppress the events originating from the ZipEntry method. if (zipFile == null) return; if (zipFile.\_inExtractAll) return; // returned boolean is always ignored for all callers of OnBeforeExtract zipFile.OnSingleEntryExtract(zipEntryInstance, path, true); }
 private void OnAfterExtract(string path) { // When in the context of a ZipFile.ExtractAll, the events are generated from // the ZipFile method, not from within the ZipEntry instance. (why?) // Therefore we suppress the events originating from the ZipEntry method. if (\_container.ZipFile == null) return; if (\_container.ZipFile.\_inExtractAll) return; \_container.ZipFile.OnSingleEntryExtract(this, path, false); }
 private void OnExtractExisting(string path) { if (\_container.ZipFile != null) \_ioOperationCanceled = \_container.ZipFile.OnExtractExisting(this, path); }
 private static void ReallyDelete(string fileName) { // workitem 7881 // reset ReadOnly bit if necessary if ((File.GetAttributes(fileName) & FileAttributes.ReadOnly) == FileAttributes.ReadOnly) File.SetAttributes(fileName, FileAttributes.Normal); File.Delete(fileName); }
 void WriteStatus(string format, params Object[] args) { if (\_container.ZipFile != null && \_container.ZipFile.Verbose) \_container.ZipFile.StatusMessageTextWriter.WriteLine(format, args); }
 /// <summary> /// Pass in either basedir or s, but not both. /// In other words, you can extract to a stream or to a directory (filesystem), but not both! /// The Password param is required for encrypted entries. /// </summary> void InternalExtractToBaseDir(string baseDir, string password, ZipContainer zipContainer, ZipEntrySource zipEntrySource, string fileName) { if (baseDir == null) throw new ArgumentNullException("baseDir");
 // workitem 7958 if (zipContainer == null) throw new BadStateException("This entry is an orphan");
 // workitem 10355 if (zipContainer.ZipFile == null) throw new InvalidOperationException("Use Extract() only with ZipFile.");
 zipContainer.ZipFile.Reset(false);
 if (zipEntrySource != ZipEntrySource.ZipFile) throw new BadStateException("You must call ZipFile.Save before calling any Extract method");
 OnBeforeExtract(this, baseDir, zipContainer.ZipFile);
 \_ioOperationCanceled = false;
 var fileExistsBeforeExtraction = false; var checkLaterForResetDirTimes = false; string targetFileName = null; try { ValidateCompression(\_CompressionMethod\_FromZipFile, fileName, GetUnsupportedCompressionMethod(\_CompressionMethod)); ValidateEncryption(Encryption, fileName, \_UnsupportedAlgorithmId);
 if (IsDoneWithOutputToBaseDir(baseDir, out targetFileName)) { WriteStatus("extract dir {0}...", targetFileName); // if true, then the entry was a directory and has been created. // We need to fire the Extract Event. OnAfterExtract(baseDir); return; }
 // workitem 10639 // do we want to extract to a regular filesystem file?  // Check for extracting to a previously existing file. The user // can specify bejavior for that case: overwrite, don't // overwrite, and throw. Also, if the file exists prior to // extraction, it affects exception handling: whether to delete // the target of extraction or not. This check needs to be done // before the password check is done, because password check may // throw a BadPasswordException, which triggers the catch, // wherein the existing file may be deleted if not flagged as // pre-existing. if (File.Exists(targetFileName)) { fileExistsBeforeExtraction = true; int rc = CheckExtractExistingFile(baseDir, targetFileName); if (rc == 2) goto ExitTry; // cancel if (rc == 1) return; // do not overwrite }
 // If no password explicitly specified, use the password on the entry itself, // or on the zipfile itself. if (\_Encryption\_FromZipFile != EncryptionAlgorithm.None) EnsurePassword(password);
 // set up the output stream var tmpName = SharedUtilities.InternalGetTempFileName(); var tmpPath = Path.Combine(Path.GetDirectoryName(targetFileName), tmpName); WriteStatus("extract file {0}...", targetFileName);
 using (var output = OpenFileStream(tmpPath, ref checkLaterForResetDirTimes)) { if (ExtractToStream(ArchiveStream, output, Encryption, \_Crc32)) goto ExitTry;
 output.Close(); }
 MoveFileInPlace(fileExistsBeforeExtraction, targetFileName, tmpPath, checkLaterForResetDirTimes);
 OnAfterExtract(baseDir);
 ExitTry: ; } catch (Exception) { \_ioOperationCanceled = true; throw; } finally { if (\_ioOperationCanceled && targetFileName != null) { // An exception has occurred. If the file exists, check // to see if it existed before we tried extracting. If // it did not, attempt to remove the target file. There // is a small possibility that the existing file has // been extracted successfully, overwriting a previously // existing file, and an exception was thrown after that // but before final completion (setting times, etc). In // that case the file will remain, even though some // error occurred. Nothing to be done about it. if (File.Exists(targetFileName) && !fileExistsBeforeExtraction) File.Delete(targetFileName); } } }
 /// <summary> /// Extract to a stream /// In other words, you can extract to a stream or to a directory (filesystem), but not both! /// The Password param is required for encrypted entries. /// </summary> void InternalExtractToStream(Stream outStream, string password, ZipContainer zipContainer, ZipEntrySource zipEntrySource, string fileName) { // workitem 7958 if (zipContainer == null) throw new BadStateException("This entry is an orphan");
 // workitem 10355 if (zipContainer.ZipFile == null) throw new InvalidOperationException("Use Extract() only with ZipFile.");
 zipContainer.ZipFile.Reset(false);
 if (zipEntrySource != ZipEntrySource.ZipFile) throw new BadStateException("You must call ZipFile.Save before calling any Extract method");
 OnBeforeExtract(this, null, zipContainer.ZipFile);
 \_ioOperationCanceled = false;
 try { ValidateCompression(\_CompressionMethod\_FromZipFile, fileName, GetUnsupportedCompressionMethod(\_CompressionMethod)); ValidateEncryption(Encryption, fileName, \_UnsupportedAlgorithmId);
 if (IsDoneWithOutputToStream()) { WriteStatus("extract dir {0}...", null); // if true, then the entry was a directory and has been created. // We need to fire the Extract Event. OnAfterExtract(null); return; }
 // If no password explicitly specified, use the password on the entry itself, // or on the zipfile itself. if (\_Encryption\_FromZipFile != EncryptionAlgorithm.None) EnsurePassword(password);
 WriteStatus("extract entry {0} to stream...", fileName);
 var archiveStream = ArchiveStream;
 if (ExtractToStream(archiveStream, outStream, Encryption, \_Crc32)) goto ExitTry;
 OnAfterExtract(null);
 ExitTry: ; } catch (Exception) { \_ioOperationCanceled = true; throw; } }
 bool ExtractToStream(Stream archiveStream, Stream output, EncryptionAlgorithm encryptionAlgorithm, int expectedCrc32) { if (\_ioOperationCanceled) return true;
 try { var calculatedCrc32 = ExtractAndCrc(archiveStream, output, \_CompressionMethod\_FromZipFile, \_CompressedFileDataSize, UncompressedSize);
 if (\_ioOperationCanceled) return true;
 VerifyCrcAfterExtract(calculatedCrc32, encryptionAlgorithm, expectedCrc32, archiveStream, UncompressedSize); return false; } finally { var zss = archiveStream as ZipSegmentedStream; if (zss != null) { // need to dispose it zss.Dispose(); \_archiveStream = null; } } }
 void MoveFileInPlace( bool fileExistsBeforeExtraction, string targetFileName, string tmpPath, bool checkLaterForResetDirTimes) { // workitem 10639 // move file to permanent home string zombie = null;
 if (fileExistsBeforeExtraction) { // An AV program may hold the target file open, which means // File.Delete() will succeed, though the actual deletion // remains pending. This will prevent a subsequent // File.Move() from succeeding. To avoid this, when the file // already exists, we need to replace it in 3 steps: // // 1. rename the existing file to a zombie name; // 2. rename the extracted file from the temp name to // the target file name; // 3. delete the zombie. // zombie = targetFileName + Path.GetRandomFileName() + ".PendingOverwrite"; File.Move(targetFileName, zombie); }
 File.Move(tmpPath, targetFileName); \_SetTimes(targetFileName, true);
 if (zombie != null && File.Exists(zombie)) ReallyDelete(zombie);
 // workitem 8264 if (checkLaterForResetDirTimes) { // This is sort of a hack. What I do here is set the time on // the parent directory, every time a file is extracted into // it. If there is a directory with 1000 files, then I set // the time on the dir, 1000 times. This allows the directory // to have times that reflect the actual time on the entry in // the zip archive.
 if (FileName.Contains("/")) { var dirname = Path.GetDirectoryName(FileName); if (\_container.ZipFile[dirname] == null) \_SetTimes(Path.GetDirectoryName(targetFileName), false); } }
 // workitem 7071 // // We can only apply attributes if they are relevant to the NTFS // OS. Must do this LAST because it may involve a ReadOnly bit, // which would prevent us from setting the time, etc. // // workitem 7926 - version made by OS can be zero (FAT) or 10 // (NTFS) if ((\_VersionMadeBy & 0xFF00) == 0x0a00 || (\_VersionMadeBy & 0xFF00) == 0x0000) File.SetAttributes(targetFileName, (FileAttributes) \_ExternalFileAttrs); }
 void EnsurePassword(string password) { var p = password ?? \_Password ?? \_container.Password; if (p == null) throw new BadPasswordException(); SetupCryptoForExtract(p); }
 Stream OpenFileStream(string tmpPath, ref bool checkLaterForResetDirTimes) { var dirName = Path.GetDirectoryName(tmpPath); // ensure the target path exists if (!Directory.Exists(dirName)) { // we create the directory here, but we do not set the // create/modified/accessed times on it because it is being // created implicitly, not explcitly. There's no entry in the // zip archive for the directory. Directory.CreateDirectory(dirName); } else { // workitem 8264 if (\_container.ZipFile != null) checkLaterForResetDirTimes = \_container.ZipFile.\_inExtractAll; }
 // File.Create(CreateNew) will overwrite any existing file. return new FileStream(tmpPath, FileMode.CreateNew); }
#if NOT internal void CalcWinZipAesMac(Stream input) { if (Encryption == EncryptionAlgorithm.WinZipAes128 || Encryption == EncryptionAlgorithm.WinZipAes256) { if (input is WinZipAesCipherStream) wzs = input as WinZipAesCipherStream;
 else if (input is Ionic.Zlib.CrcCalculatorStream) { xxx; }
 } }#endif
 internal void VerifyCrcAfterExtract(Int32 calculatedCrc32, EncryptionAlgorithm encryptionAlgorithm, int expectedCrc32, Stream archiveStream, long uncompressedSize) {#if AESCRYPTO // After extracting, Validate the CRC32 if (calculatedCrc32 != expectedCrc32) { // CRC is not meaningful with WinZipAES and AES method 2 (AE-2) if ((encryptionAlgorithm != EncryptionAlgorithm.WinZipAes128 && encryptionAlgorithm != EncryptionAlgorithm.WinZipAes256) || \_WinZipAesMethod != 0x02) throw new BadCrcException("CRC error: the file being extracted appears to be corrupted. " + String.Format("Expected 0x{0:X8}, Actual 0x{1:X8}", expectedCrc32, calculatedCrc32)); }
 // ignore MAC if the size of the file is zero if (uncompressedSize == 0) return;
 // calculate the MAC if (encryptionAlgorithm == EncryptionAlgorithm.WinZipAes128 || encryptionAlgorithm == EncryptionAlgorithm.WinZipAes256) { var wzs = \_inputDecryptorStream as WinZipAesCipherStream;  // sometimes there are extra bytes in the WinZipAES stream that were not required to generate // the decryption output. Read and ignore these bytes, so that the CRC can be calculated: byte[] throwAwayBuffer = new byte[256]; wzs.Read(throwAwayBuffer, 0, 256);
 \_aesCrypto\_forExtract.CalculatedMac = wzs.FinalAuthentication;
 \_aesCrypto\_forExtract.ReadAndVerifyMac(archiveStream); // throws if MAC is bad // side effect: advances file position. }
#else if (calculatedCrc32 != expectedCrc32) throw new BadCrcException("CRC error: the file being extracted appears to be corrupted. " + String.Format("Expected 0x{0:X8}, Actual 0x{1:X8}", expectedCrc32, calculatedCrc32));#endif }
 int CheckExtractExistingFile(string baseDir, string targetFileName) { int loop = 0; // returns: 0 == extract, 1 = don't, 2 = cancel do[View remainder of file in raw view](https://github.com/haf/DotNetZip.Semverd/raw/e487179b33a9a0f2631eed5fb04d2c952ea5377a/src/Zip.Shared/ZipEntry.Extract.cs)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from gist.github.com_2d55dd50_20250115_091443.html ===

[Skip to content](#start-of-content)

[All gists](/discover)
[Back to GitHub](https://github.com)
[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fthomas-chauchefoin-bentley-systems%2F855218959116f870f08857cce2aec731)
[Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fthomas-chauchefoin-bentley-systems%2F855218959116f870f08857cce2aec731&source=header-gist)

[Sign in](https://gist.github.com/auth/github?return_to=https%3A%2F%2Fgist.github.com%2Fthomas-chauchefoin-bentley-systems%2F855218959116f870f08857cce2aec731) [Sign up](/join?return_to=https%3A%2F%2Fgist.github.com%2Fthomas-chauchefoin-bentley-systems%2F855218959116f870f08857cce2aec731&source=header-gist)

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

Instantly share code, notes, and snippets.

[![@thomas-chauchefoin-bentley-systems](https://avatars.githubusercontent.com/u/163005671?s=64&v=4)](/thomas-chauchefoin-bentley-systems)

# [thomas-chauchefoin-bentley-systems](/thomas-chauchefoin-bentley-systems)/**[CVE-2024-48510.md](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731)** Secret

Last active
January 9, 2025 16:40

Show Gist options

* [Download ZIP](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731/archive/46d07761129d2ac144a0260b99fede697df38475.zip)

* [Star
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2Fthomas-chauchefoin-bentley-systems%2F855218959116f870f08857cce2aec731)You must be signed in to star a gist
* [Fork
  (1)
  1](/login?return_to=https%3A%2F%2Fgist.github.com%2Fthomas-chauchefoin-bentley-systems%2F855218959116f870f08857cce2aec731)You must be signed in to fork a gist

* Embed

  + Embed
     Embed this gist in your website.
  + Share
     Copy sharable link for this gist.
  + Clone via HTTPS
     Clone using the web URL.
  + [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

  Clone this repository at &lt;script src=&quot;https://gist.github.com/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731.js&quot;&gt;&lt;/script&gt;
* Save thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731 to your computer and use it in GitHub Desktop.

[Code](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731)
[Revisions
4](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731/revisions)
[Stars
1](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731/stargazers)
[Forks
1](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731/forks)

Embed

* Embed
   Embed this gist in your website.
* Share
   Copy sharable link for this gist.
* Clone via HTTPS
   Clone using the web URL.
* [Learn more about clone URLs](https://docs.github.com/articles/which-remote-url-should-i-use)

Clone this repository at &lt;script src=&quot;https://gist.github.com/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731.js&quot;&gt;&lt;/script&gt;

Save thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731 to your computer and use it in GitHub Desktop.

[Download ZIP](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731/archive/46d07761129d2ac144a0260b99fede697df38475.zip)

CVE-2024-48510

 [Raw](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731/raw/46d07761129d2ac144a0260b99fede697df38475/CVE-2024-48510.md)

[**CVE-2024-48510.md**](#file-cve-2024-48510-md)

# CVE-2024-48510

Suggested CVSS : 8.6 / High ([CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N](https://www.first.org/cvss/calculator/4.0#CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N))

## Affected product and versions

DotNetZip >= 1.10.1 (May 2018), <= 1.16.0 (latest release) ([NuGet](https://www.nuget.org/packages/DotNetZip/), [GitHub](https://github.com/haf/DotNetZip.Semverd))

## Description

DotNetZip is affected by an absolute path traversal vulnerability. Despite the
protection in place during extraction, the destination path of the current ZIP
entry is mutated after its sanitization, breaking security guarantees. This is
effectively a bypass of the patch for CVE-2018-1002205.

Subsequently to our report to the upstream maintainer and Microsoft, the
repository was marked as read-only and the package legacy on NuGet.
The package is still available for download and will not receive a patch, making
it a "forever-day".

We recommend migrating code to [System.IO.Compression](https://learn.microsoft.com/en-us/dotnet/api/system.io.compression?view=net-8.0), and attached a patch for
DotNetZip to fix this bug during the transition period.

## Credits

Finder, Remediation Developer: Thomas Chauchefoin ([Bentley Systems](https://www.bentley.com/))

 [Raw](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731/raw/46d07761129d2ac144a0260b99fede697df38475/Prevent-absolute-path%2520traversal-bugs-when-extracting-ZIP-archives.patch)

[**Prevent-absolute-path traversal-bugs-when-extracting-ZIP-archives.patch**](#file-prevent-absolute-path-traversal-bugs-when-extracting-zip-archives-patch)

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

|  | From 67dcc283bc6a51833fb11fa0b1ac210c55f88ea4 Mon Sep 17 00:00:00 2001 |
| --- | --- |
|  | From: Thomas Chauchefoin <thomas.chauchefoin@bentley.com> |
|  | Date: Tue, 28 May 2024 00:12:55 +0200 |
|  | Subject: [PATCH] Prevent absolute path traversal bugs when extracting ZIP |
|  | archives |
|  |  |
|  | After constructing the path where to extract the current entry, get its fully |
|  | qualified form and ensure it stays below the intended base directory. |
|  | --- |
|  | src/Zip Tests/Compatibility.cs | 8 ++++++++ |
|  | src/Zip Tests/Zip Tests.csproj | 3 +++ |
|  | src/Zip Tests/zips/absolute-path-traversal.zip | Bin 0 -> 143 bytes |
|  | src/Zip.Shared/ZipEntry.Extract.cs | 9 +++++++++ |
|  | 4 files changed, 20 insertions(+) |
|  | create mode 100644 src/Zip Tests/zips/absolute-path-traversal.zip |
|  |  |
|  | diff --git a/src/Zip Tests/Compatibility.cs b/src/Zip Tests/Compatibility.cs |
|  | index d09e43f..4864843 100644 |
|  | --- a/src/Zip Tests/Compatibility.cs |
|  | +++ b/src/Zip Tests/Compatibility.cs |
|  | @@ -2605,6 +2605,14 @@ public void Extract\_ZipWithRelativePathsInSubdirOutside() |
|  | Assert.IsTrue(File.Exists(@"extract\Temp\evil.txt")); |
|  | } |
|  |  |
|  | + [TestMethod] |
|  | + [ExpectedException(typeof(IOException))] |
|  | + public void Extract\_ZipWithAbsolutePathsOutside() |
|  | + { |
|  | + \_Extract\_ZipFile("absolute-path-traversal.zip"); |
|  | + Assert.IsFalse(File.Exists(@"C:\Windows\Temp\foo")); |
|  | + } |
|  | + |
|  | private void \_Extract\_ZipFile(string fileName) |
|  | { |
|  | TestContext.WriteLine("Current Dir: {0}", CurrentDir); |
|  | diff --git a/src/Zip Tests/Zip Tests.csproj b/src/Zip Tests/Zip Tests.csproj |
|  | index 8c7be4b..d0fdfdc 100644 |
|  | --- a/src/Zip Tests/Zip Tests.csproj |
|  | +++ b/src/Zip Tests/Zip Tests.csproj |
|  | @@ -165,6 +165,9 @@ |
|  | <Content Include="zips\relative-paths-in-subdir-outside.zip"> |
|  | <CopyToOutputDirectory>Always</CopyToOutputDirectory> |
|  | </Content> |
|  | + <Content Include="zips\absolute-path-traversal.zip"> |
|  | + <CopyToOutputDirectory>Always</CopyToOutputDirectory> |
|  | + </Content> |
|  | </ItemGroup> |
|  | <ItemGroup> |
|  | <Content Include="zips\winzip-sfx.exe"> |
|  | diff --git a/src/Zip Tests/zips/absolute-path-traversal.zip b/src/Zip Tests/zips/absolute-path-traversal.zip |
|  | new file mode 100644 |
|  | index 0000000000000000000000000000000000000000..ac62b13709c1f4795e5d56502e763b983c46ee07 |
|  | GIT binary patch |
|  | literal 143 |
|  | zcmWIWW@Zs#0D+b%yCYWh{4Zk$vO!oBh@GvRt@Oh)^HTE5i}gcNa|`s-^7E4tivqkE |
|  | inM4?H>jP>9g9b(rh1HY\*Z&o&tBqI<y18Fl5hXDZol^o6h |
|  |  |
|  | literal 0 |
|  | HcmV?d00001 |
|  |  |
|  | diff --git a/src/Zip.Shared/ZipEntry.Extract.cs b/src/Zip.Shared/ZipEntry.Extract.cs |
|  | index 945de82..2131673 100644 |
|  | --- a/src/Zip.Shared/ZipEntry.Extract.cs |
|  | +++ b/src/Zip.Shared/ZipEntry.Extract.cs |
|  | @@ -1390,6 +1390,15 @@ bool IsDoneWithOutputToBaseDir(string baseDir, out string outFileName) |
|  | // workitem 10639 |
|  | outFileName = outFileName.Replace('/', Path.DirectorySeparatorChar); |
|  |  |
|  | + // Resolve any directory traversal sequence and compare the result with the intended base directory |
|  | + // where the file or folder will be created. |
|  | + var canonicalOutPath = Path.GetFullPath(outFileName); |
|  | + var canonicalBaseDir = Path.GetFullPath(baseDir); |
|  | + if (!canonicalOutPath.StartsWith(canonicalBaseDir, StringComparison.OrdinalIgnoreCase)) |
|  | + { |
|  | + throw new IOException(string.Format("Extracting {0} would write to {1}, outside of {2}; rejecting.", outFileName, canonicalOutPath, canonicalBaseDir)); |
|  | + } |
|  | + |
|  | // check if it is a directory |
|  | if (IsDirectory || FileName.EndsWith("/")) |
|  | { |
|  | -- |
|  | 2.39.2 |

[![@mgexo](https://avatars.githubusercontent.com/u/3912947?s=80&v=4)](/mgexo)

Copy link

### **[mgexo](/mgexo)** commented [Nov 14, 2024](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731?permalink_comment_id=5282552#gistcomment-5282552)

Regarding StartsWith for such purposes, it is recommended to use StringComparison.OrdinalIgnoreCase

<https://blog.mindedsecurity.com/2018/10/how-to-prevent-path-traversal-in-net.html>

<https://www.stackhawk.com/blog/net-path-traversal-guide-examples-and-prevention/>

It may not make difference here but potential utf-8 / encoding attacks would be avoided (some colleagues directly recommended that change when we reviewed the patch)

Sorry, something went wrong.

[![@thomas-chauchefoin-bentley-systems](https://avatars.githubusercontent.com/u/163005671?s=80&v=4)](/thomas-chauchefoin-bentley-systems)

Copy link

Author

### **[thomas-chauchefoin-bentley-systems](/thomas-chauchefoin-bentley-systems)** commented [Nov 14, 2024](/thomas-chauchefoin-bentley-systems/855218959116f870f08857cce2aec731?permalink_comment_id=5282567#gistcomment-5282567)

> Regarding StartsWith for such purposes, it is recommended to use StringComparison.OrdinalIgnoreCase <https://blog.mindedsecurity.com/2018/10/how-to-prevent-path-traversal-in-net.html> <https://www.stackhawk.com/blog/net-path-traversal-guide-examples-and-prevention/>
>
> It may not make difference here but potential utf-8 / encoding attacks would be avoided (some colleagues directly recommended that change when we reviewed the patch)

Good point; I updated the patch to include it. Thanks!

Sorry, something went wrong.

[Sign up for free](/join?source=comment-gist)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgist.github.com%2Fthomas-chauchefoin-bentley-systems%2F855218959116f870f08857cce2aec731)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.nuget.org_3d6264aa_20250115_091448.html ===


Skip To Content

Toggle navigation

* [Packages](/packages)
* [Upload](/packages/manage/upload)
* [Statistics](/stats)
* [Documentation](https://docs.microsoft.com/nuget/)
* [Downloads](/downloads)
* [Blog](https://blog.nuget.org/)

* [Sign in](/users/account/LogOn?returnUrl=%2Fpackages%2FDotNetZip%2F "Sign in to an existing NuGet.org account")

# DotNetZip 1.16.0

[.NET Standard 2.0

This package targets .NET Standard 2.0. The package is compatible with this framework or higher.](/packages/DotNetZip#supportedframeworks-body-tab)
[.NET Framework 4.0

This package targets .NET Framework 4.0. The package is compatible with this framework or higher.](/packages/DotNetZip#supportedframeworks-body-tab)

This package has at least one **vulnerability** with **high** severity. It may lead to specific problems in your project. Try updating the package version.

**Details**

| Advisory: <https://github.com/advisories/GHSA-xhg6-9j5j-w4vf> | Severity: high |
| --- | --- |

This package has been deprecated as it is **legacy** and is no longer maintained.

* [.NET CLI](#dotnet-cli "Switch to tab panel which contains package installation command for .NET CLI")
* [Package Manager](#package-manager "Switch to tab panel which contains package installation command for Package Manager")
* [PackageReference](#package-reference "Switch to tab panel which contains package installation command for PackageReference")
* [Paket CLI](#paket-cli "Switch to tab panel which contains package installation command for Paket CLI")
* [Script & Interactive](#script-interactive "Switch to tab panel which contains package installation command for Script & Interactive")
* [Cake](#cake "Switch to tab panel which contains package installation command for Cake")

```
dotnet add package DotNetZip --version 1.16.0

                        Copy

```

```
NuGet\Install-Package DotNetZip -Version 1.16.0

                        Copy

```

This command is intended to be used within the Package Manager Console in Visual Studio, as it uses the NuGet module's version of [Install-Package](https://docs.microsoft.com/nuget/reference/ps-reference/ps-ref-install-package).

```
<PackageReference Include="DotNetZip" Version="1.16.0" />

                        Copy

```

For projects that support [PackageReference](https://docs.microsoft.com/nuget/consume-packages/package-references-in-project-files), copy this XML node into the project file to reference the package.

```
paket add DotNetZip --version 1.16.0

                        Copy

```

 The NuGet Team does not provide support for this client. Please contact its [maintainers](https://fsprojects.github.io/Paket/contact.html) for support.

```
#r "nuget: DotNetZip, 1.16.0"

                        Copy

```

#r directive can be used in F# Interactive and Polyglot Notebooks. Copy this into the interactive tool or source code of the script to reference the package.

```
// Install DotNetZip as a Cake Addin
#addin nuget:?package=DotNetZip&version=1.16.0

// Install DotNetZip as a Cake Tool
#tool nuget:?package=DotNetZip&version=1.16.0

                        Copy

```

 The NuGet Team does not provide support for this client. Please contact its [maintainers](https://cakebuild.net/support/nuget) for support.

* [README](#readme-body-tab)
* [Frameworks](#supportedframeworks-body-tab)
* [Dependencies](#dependencies-body-tab)
* [Used By](#usedby-body-tab)
* [Versions](#versions-body-tab)
* [Release Notes](#releasenotes-body-tab)

A fork of the DotNetZip project without signing with a solution that compiles cleanly. This project aims to follow semver to avoid versioning conflicts. DotNetZip is a FAST, FREE class library and toolset for manipulating zip files. Use VB, C# or any .NET language to easily create, extract, or update zip files.

| **Product** | **Versions** Compatible and additional computed target framework versions. |
| --- | --- |
| .NET | net5.0 net5.0 was computed.  net5.0-windows net5.0-windows was computed.  net6.0 net6.0 was computed.  net6.0-android net6.0-android was computed.  net6.0-ios net6.0-ios was computed.  net6.0-maccatalyst net6.0-maccatalyst was computed.  net6.0-macos net6.0-macos was computed.  net6.0-tvos net6.0-tvos was computed.  net6.0-windows net6.0-windows was computed.  net7.0 net7.0 was computed.  net7.0-android net7.0-android was computed.  net7.0-ios net7.0-ios was computed.  net7.0-maccatalyst net7.0-maccatalyst was computed.  net7.0-macos net7.0-macos was computed.  net7.0-tvos net7.0-tvos was computed.  net7.0-windows net7.0-windows was computed.  net8.0 net8.0 was computed.  net8.0-android net8.0-android was computed.  net8.0-browser net8.0-browser was computed.  net8.0-ios net8.0-ios was computed.  net8.0-maccatalyst net8.0-maccatalyst was computed.  net8.0-macos net8.0-macos was computed.  net8.0-tvos net8.0-tvos was computed.  net8.0-windows net8.0-windows was computed.  net9.0 net9.0 was computed.  net9.0-android net9.0-android was computed.  net9.0-browser net9.0-browser was computed.  net9.0-ios net9.0-ios was computed.  net9.0-maccatalyst net9.0-maccatalyst was computed.  net9.0-macos net9.0-macos was computed.  net9.0-tvos net9.0-tvos was computed.  net9.0-windows net9.0-windows was computed. |
| .NET Core | netcoreapp2.0 netcoreapp2.0 was computed.  netcoreapp2.1 netcoreapp2.1 was computed.  netcoreapp2.2 netcoreapp2.2 was computed.  netcoreapp3.0 netcoreapp3.0 was computed.  netcoreapp3.1 netcoreapp3.1 was computed. |
| .NET Standard | netstandard2.0 netstandard2.0 is compatible.  netstandard2.1 netstandard2.1 was computed. |
| .NET Framework | net40 net40 is compatible.  net403 net403 was computed.  net45 net45 was computed.  net451 net451 was computed.  net452 net452 was computed.  net46 net46 was computed.  net461 net461 was computed.  net462 net462 was computed.  net463 net463 was computed.  net47 net47 was computed.  net471 net471 was computed.  net472 net472 was computed.  net48 net48 was computed.  net481 net481 was computed. |
| MonoAndroid | monoandroid monoandroid was computed. |
| MonoMac | monomac monomac was computed. |
| MonoTouch | monotouch monotouch was computed. |
| Tizen | tizen40 tizen40 was computed.  tizen60 tizen60 was computed. |
| Xamarin.iOS | xamarinios xamarinios was computed. |
| Xamarin.Mac | xamarinmac xamarinmac was computed. |
| Xamarin.TVOS | xamarintvos xamarintvos was computed. |
| Xamarin.WatchOS | xamarinwatchos xamarinwatchos was computed. |

Compatible target framework(s)

Included target framework(s) (in package)

*Learn more about [Target Frameworks](https://docs.microsoft.com/dotnet/standard/frameworks) and [.NET Standard](https://docs.microsoft.com/dotnet/standard/net-standard).*

* #### .NETFramework 4.0

  + No dependencies.
* #### .NETStandard 2.0

  + [System.Security.Permissions](/packages/System.Security.Permissions/)
    (>= 4.7.0)
  + [System.Text.Encoding.CodePages](/packages/System.Text.Encoding.CodePages/)
    (>= 4.7.1)

### **NuGet packages** (365)

Showing the top 5 NuGet packages that depend on DotNetZip:

| Package | Downloads |
| --- | --- |
| [WiseProgress.Framework](/packages/WiseProgress.Framework/)  .NET UI Controls, Advanced Grid Help, Advanced Help Control, UI Messages and Notifications, ... | 4.2M |
| [JetBrains.Platform.Core.Shell](/packages/JetBrains.Platform.Core.Shell/)  JetBrains Platform Core Shell Package Version 233.0.20240606.110126 | 2.6M |
| [JetBrains.Psi.Features.src](/packages/JetBrains.Psi.Features.src/)  JetBrains Psi Features src Package Version 233.0.20240606.112012 | 1.7M |
| [JetBrains.Platform.UIInteractive.Shell](/packages/JetBrains.Platform.UIInteractive.Shell/)  JetBrains Platform UIInteractive Shell Package Version 233.0.20240606.111243 | 1.0M |
| [QuantConnect.Compression](/packages/QuantConnect.Compression/)  QuantConnect LEAN Engine: Compression Project - A library with compression tools | 948.6K |

### **GitHub repositories** (90)

Showing the top 5 popular GitHub repositories that depend on DotNetZip:

| Repository | Stars |
| --- | --- |
| [QuantConnect/Lean](https://github.com/QuantConnect/Lean) Lean Algorithmic Trading Engine by QuantConnect (Python, C#) | 10.3K |
| [bchavez/Bogus](https://github.com/bchavez/Bogus) :card\_index: A simple fake data generator for C#, F#, and VB.NET. Based on and ported from the famed faker.js. | 9.0K |
| [subhra74/xdm](https://github.com/subhra74/xdm) Powerfull download accelerator and video downloader | 6.9K |
| [Codeusa/Borderless-Gaming](https://github.com/Codeusa/Borderless-Gaming) Play your favorite games in a borderless window; no more time consuming alt-tabs. | 5.7K |
| [projectkudu/kudu](https://github.com/projectkudu/kudu) Kudu is the engine behind git/hg deployments, WebJobs, and various other features in Azure Web Sites. It can also run outside of Azure. | 3.1K |

| Version | Downloads | Last updated |  |
| --- | --- | --- | --- |
| [1.16.0](/packages/DotNetZip/1.16.0 "1.16.0") | 19,300,159 | 11/16/2021 | 1.16.0 is deprecated because it is no longer maintained; 1.16.0 has at least one vulnerability with high severity. |
| [1.15.0](/packages/DotNetZip/1.15.0 "1.15.0") | 6,166,852 | 11/19/2020 | 1.15.0 is deprecated because it is no longer maintained; 1.15.0 has at least one vulnerability with high severity. |
| [1.14.0](/packages/DotNetZip/1.14.0 "1.14.0") | 700,177 | 10/19/2020 | 1.14.0 is deprecated because it is no longer maintained; 1.14.0 has at least one vulnerability with high severity. |
| [1.13.8](/packages/DotNetZip/1.13.8 "1.13.8") | 2,180,093 | 5/21/2020 | 1.13.8 is deprecated because it is no longer maintained; 1.13.8 has at least one vulnerability with high severity. |
| [1.13.7](/packages/DotNetZip/1.13.7 "1.13.7") | 1,603,929 | 3/17/2020 | 1.13.7 is deprecated because it is no longer maintained; 1.13.7 has at least one vulnerability with high severity. |
| [1.13.6](/packages/DotNetZip/1.13.6 "1.13.6") | 644,974 | 2/25/2020 | 1.13.6 is deprecated because it is no longer maintained; 1.13.6 has at least one vulnerability with high severity. |
| [1.13.5](/packages/DotNetZip/1.13.5 "1.13.5") | 727,081 | 12/23/2019 | 1.13.5 is deprecated because it is no longer maintained; 1.13.5 has at least one vulnerability with high severity. |
| [1.13.4](/packages/DotNetZip/1.13.4 "1.13.4") | 979,643 | 9/10/2019 | 1.13.4 is deprecated because it is no longer maintained; 1.13.4 has at least one vulnerability with high severity. |
| [1.13.3](/packages/DotNetZip/1.13.3 "1.13.3") | 6,641,429 | 2/19/2019 | 1.13.3 is deprecated because it is no longer maintained; 1.13.3 has at least one vulnerability with high severity. |
| [1.13.2](/packages/DotNetZip/1.13.2 "1.13.2") | 187,826 | 1/28/2019 | 1.13.2 is deprecated because it is no longer maintained; 1.13.2 has at least one vulnerability with high severity. |
| [1.13.1](/packages/DotNetZip/1.13.1 "1.13.1") | 17,366 | 1/28/2019 | 1.13.1 is deprecated because it is no longer maintained; 1.13.1 has at least one vulnerability with high severity. |
| [1.13.0](/packages/DotNetZip/1.13.0 "1.13.0") | 719,736 | 12/15/2018 | 1.13.0 is deprecated because it is no longer maintained; 1.13.0 has at least one vulnerability with high severity. |
| [1.12.0](/packages/DotNetZip/1.12.0 "1.12.0") | 488,126 | 11/9/2018 | 1.12.0 is deprecated because it is no longer maintained; 1.12.0 has at least one vulnerability with high severity. |
| [1.11.0](/packages/DotNetZip/1.11.0 "1.11.0") | 3,348,481 | 5/7/2018 | 1.11.0 is deprecated because it is no longer maintained; 1.11.0 has at least one vulnerability with high severity. |
| [1.10.1](/packages/DotNetZip/1.10.1 "1.10.1") | 6,969,381 | 6/22/2016 | 1.10.1 is deprecated because it is no longer maintained; 1.10.1 has at least one vulnerability with high severity. |
| [1.10.0](/packages/DotNetZip/1.10.0 "1.10.0") | 432,266 | 6/13/2016 | 1.10.0 is deprecated because it is no longer maintained; 1.10.0 has at least one vulnerability with high severity. |
| [1.9.9](/packages/DotNetZip/1.9.9 "1.9.9") | 106,116 | 6/7/2016 | 1.9.9 is deprecated because it is no longer maintained; 1.9.9 has at least one vulnerability with high severity. |
| [1.9.8](/packages/DotNetZip/1.9.8 "1.9.8") | 1,408,693 | 1/25/2016 | 1.9.8 is deprecated because it is no longer maintained; 1.9.8 has at least one vulnerability with high severity. |
| [1.9.7](/packages/DotNetZip/1.9.7 "1.9.7") | 870,261 | 11/6/2015 | 1.9.7 is deprecated because it is no longer maintained; 1.9.7 has at least one vulnerability with high severity. |
| [1.9.6](/packages/DotNetZip/1.9.6 "1.9.6") | 550,182 | 8/4/2015 | 1.9.6 is deprecated because it is no longer maintained; 1.9.6 has at least one vulnerability with high severity. |
| [1.9.5](/packages/DotNetZip/1.9.5 "1.9.5") | 86,933 | 7/29/2015 | 1.9.5 is deprecated because it is no longer maintained; 1.9.5 has at least one vulnerability with high severity. |
| [1.9.3](/packages/DotNetZip/1.9.3 "1.9.3") | 1,789,103 | 6/15/2014 | 1.9.3 is deprecated because it is no longer maintained; 1.9.3 has at least one vulnerability with high severity. |
| [1.9.2](/packages/DotNetZip/1.9.2 "1.9.2") | 670,931 | 1/6/2014 | 1.9.2 is deprecated because it is no longer maintained; 1.9.2 has at least one vulnerability with high severity. |
| [1.9.2-rc1](/packages/DotNetZip/1.9.2-rc1 "1.9.2-rc1") | 4,620 | 11/18/2013 | 1.9.2-rc1 is deprecated because it is no longer maintained; 1.9.2-rc1 has at least one vulnerability with high severity. |
| [1.9.1.8](/packages/DotNetZip/1.9.1.8 "1.9.1.8") | 3,206,888 | 8/18/2011 | 1.9.1.8 is deprecated because it is no longer maintained; 1.9.1.8 has at least one vulnerability with high severity. |
| [1.9.0](/packages/DotNetZip/1.9.0 "1.9.0") | 215,871 | 1/7/2011 | 1.9.0 is deprecated because it is no longer maintained; 1.9.0 has at least one vulnerability with high severity. |
| [1.0.0](/packages/DotNetZip/1.0.0 "1.0.0") | 769,904 | 2/4/2011 | 1.0.0 is deprecated because it is no longer maintained; 1.0.0 has at least one vulnerability with high severity. |

Full version: 1.16.0.4ab8c0.

Downloads

[Full stats →](/stats/packages/DotNetZip?groupby=Version "Package Statistics")

Total
60.8M

Current version
19.3M

Per day average
11.9K

About

* Last updated 11/16/2021
* [Project website](https://github.com/haf/DotNetZip.Semverd "Visit the project site to learn more about this package")
* [License Info](https://raw.githubusercontent.com/haf/DotNetZip.Semverd/master/LICENSE "Make sure you agree with the license")
* [Download package](https://www.nuget.org/api/v2/package/DotNetZip/1.16.0 "Download the raw nupkg file.")
   (916.86 KB)
* [Open in NuGet Package Explorer](https://nuget.info/packages/DotNetZip/1.16.0 "Explore additional package info on NuGet Package Explorer")
* ![](https://nuget.org/Content/gallery/img/nuget-trends.svg "nugettrends.com is a 3rd party website, not controlled by Microsoft. This link is made available to you per the NuGet Terms of Use.")
  [Open in NuGet Trends](https://nugettrends.com/packages?ids=DotNetZip "Explore download trends on nugettrends.com")
* [Report package](/packages/DotNetZip/1.16.0/ReportAbuse "Report the package as abusive")

Owners

[Contact owners →](/packages/DotNetZip/1.16.0/ContactOwners "Ask the package owners a question")

* [![henrik feldt gravatar](/profiles/henrik%20feldt/avatar?imageSize=64 "henrik feldt")](/profiles/henrik%20feldt "henrik feldt")
  [henrik feldt](/profiles/henrik%20feldt "henrik feldt")
* [![dotnetzip-appveyor-user gravatar](/profiles/dotnetzip-appveyor-user/avatar?imageSize=64 "dotnetzip-appveyor-user")](/profiles/dotnetzip-appveyor-user "dotnetzip-appveyor-user")
  [dotnetzip-appveyor-user](/profiles/dotnetzip-appveyor-user "dotnetzip-appveyor-user")

Dino Chiesa

[![Share this package on Facebook](https://nuget.org/Content/gallery/img/facebook.svg)](https://www.facebook.com/sharer/sharer.php?u=https://nuget.org/packages/DotNetZip/&t=Check+out+DotNetZip+on+%23NuGet.)
[![Tweet this package](https://nuget.org/Content/gallery/img/twitter.svg)](https://twitter.com/intent/tweet?url=https://nuget.org/packages/DotNetZip/&text=Check+out+DotNetZip+on+%23NuGet.)
[![Use the Atom feed to subscribe to new versions of DotNetZip](https://nuget.org/Content/gallery/img/rss.svg)](/packages/DotNetZip/atom.xml)

[Contact](/policies/Contact)

Got questions about NuGet or the NuGet Gallery?

[Status](https://status.nuget.org/)

Find out the service status of NuGet.org and its related services.

[FAQ](https://aka.ms/nuget-faq)

Read the Frequently Asked Questions about NuGet and see if your question made the list.

© Microsoft 2025 -
[About](/policies/About) -
[Terms of Use](/policies/Terms) -
[Privacy Statement](https://go.microsoft.com/fwlink/?LinkId=521839)
- [Trademarks](https://www.microsoft.com/trademarks)



=== Content from github.com_e4fa86de_20250115_091444.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhaf%2FDotNetZip.Semverd)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fhaf%2FDotNetZip.Semverd)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=haf%2FDotNetZip.Semverd)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on May 15, 2024. It is now read-only.

[haf](/haf)
/
**[DotNetZip.Semverd](/haf/DotNetZip.Semverd)**
Public archive

* [Notifications](/login?return_to=%2Fhaf%2FDotNetZip.Semverd) You must be signed in to change notification settings
* [Fork
  236](/login?return_to=%2Fhaf%2FDotNetZip.Semverd)
* [Star
   549](/login?return_to=%2Fhaf%2FDotNetZip.Semverd)

Please use System.IO.Compression! A fork of the DotNetZip project without signing with a solution that compiles cleanly. This project aims to follow semver to avoid versioning conflicts. DotNetZip is a FAST, FREE class library and toolset for manipulating zip files. Use VB, C# or any .NET language to easily create, extract, or update zip files.

### License

[View license](/haf/DotNetZip.Semverd/blob/master/LICENSE)

[549
stars](/haf/DotNetZip.Semverd/stargazers) [236
forks](/haf/DotNetZip.Semverd/forks) [Branches](/haf/DotNetZip.Semverd/branches) [Tags](/haf/DotNetZip.Semverd/tags) [Activity](/haf/DotNetZip.Semverd/activity)
 [Star](/login?return_to=%2Fhaf%2FDotNetZip.Semverd)

 [Notifications](/login?return_to=%2Fhaf%2FDotNetZip.Semverd) You must be signed in to change notification settings

* [Code](/haf/DotNetZip.Semverd)
* [Issues
  103](/haf/DotNetZip.Semverd/issues)
* [Pull requests
  6](/haf/DotNetZip.Semverd/pulls)
* [Actions](/haf/DotNetZip.Semverd/actions)
* [Projects
  0](/haf/DotNetZip.Semverd/projects)
* [Wiki](/haf/DotNetZip.Semverd/wiki)
* [Security](/haf/DotNetZip.Semverd/security)
* [Insights](/haf/DotNetZip.Semverd/pulse)

Additional navigation options

* [Code](/haf/DotNetZip.Semverd)
* [Issues](/haf/DotNetZip.Semverd/issues)
* [Pull requests](/haf/DotNetZip.Semverd/pulls)
* [Actions](/haf/DotNetZip.Semverd/actions)
* [Projects](/haf/DotNetZip.Semverd/projects)
* [Wiki](/haf/DotNetZip.Semverd/wiki)
* [Security](/haf/DotNetZip.Semverd/security)
* [Insights](/haf/DotNetZip.Semverd/pulse)

# haf/DotNetZip.Semverd

    master[Branches](/haf/DotNetZip.Semverd/branches)[Tags](/haf/DotNetZip.Semverd/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[299 Commits](/haf/DotNetZip.Semverd/commits/master/) | | |
| [.paket](/haf/DotNetZip.Semverd/tree/master/.paket ".paket") | | [.paket](/haf/DotNetZip.Semverd/tree/master/.paket ".paket") |  |  |
| [buildscripts](/haf/DotNetZip.Semverd/tree/master/buildscripts "buildscripts") | | [buildscripts](/haf/DotNetZip.Semverd/tree/master/buildscripts "buildscripts") |  |  |
| [src](/haf/DotNetZip.Semverd/tree/master/src "src") | | [src](/haf/DotNetZip.Semverd/tree/master/src "src") |  |  |
| [.gitattributes](/haf/DotNetZip.Semverd/blob/master/.gitattributes ".gitattributes") | | [.gitattributes](/haf/DotNetZip.Semverd/blob/master/.gitattributes ".gitattributes") |  |  |
| [.gitignore](/haf/DotNetZip.Semverd/blob/master/.gitignore ".gitignore") | | [.gitignore](/haf/DotNetZip.Semverd/blob/master/.gitignore ".gitignore") |  |  |
| [.semver](/haf/DotNetZip.Semverd/blob/master/.semver ".semver") | | [.semver](/haf/DotNetZip.Semverd/blob/master/.semver ".semver") |  |  |
| [Gemfile](/haf/DotNetZip.Semverd/blob/master/Gemfile "Gemfile") | | [Gemfile](/haf/DotNetZip.Semverd/blob/master/Gemfile "Gemfile") |  |  |
| [Gemfile.lock](/haf/DotNetZip.Semverd/blob/master/Gemfile.lock "Gemfile.lock") | | [Gemfile.lock](/haf/DotNetZip.Semverd/blob/master/Gemfile.lock "Gemfile.lock") |  |  |
| [LICENSE](/haf/DotNetZip.Semverd/blob/master/LICENSE "LICENSE") | | [LICENSE](/haf/DotNetZip.Semverd/blob/master/LICENSE "LICENSE") |  |  |
| [NOTICE](/haf/DotNetZip.Semverd/blob/master/NOTICE "NOTICE") | | [NOTICE](/haf/DotNetZip.Semverd/blob/master/NOTICE "NOTICE") |  |  |
| [README.md](/haf/DotNetZip.Semverd/blob/master/README.md "README.md") | | [README.md](/haf/DotNetZip.Semverd/blob/master/README.md "README.md") |  |  |
| [Rakefile](/haf/DotNetZip.Semverd/blob/master/Rakefile "Rakefile") | | [Rakefile](/haf/DotNetZip.Semverd/blob/master/Rakefile "Rakefile") |  |  |
| [appveyor.yml](/haf/DotNetZip.Semverd/blob/master/appveyor.yml "appveyor.yml") | | [appveyor.yml](/haf/DotNetZip.Semverd/blob/master/appveyor.yml "appveyor.yml") |  |  |
| [paket.dependencies](/haf/DotNetZip.Semverd/blob/master/paket.dependencies "paket.dependencies") | | [paket.dependencies](/haf/DotNetZip.Semverd/blob/master/paket.dependencies "paket.dependencies") |  |  |
| [paket.lock](/haf/DotNetZip.Semverd/blob/master/paket.lock "paket.lock") | | [paket.lock](/haf/DotNetZip.Semverd/blob/master/paket.lock "paket.lock") |  |  |
| View all files | | |

## Repository files navigation

* README
* License
## Repository archived

This repository was created before `System.IO.Compression` and the code is unmaintained
at this point. Please transition to `System.IO.Compression`.

## Introducing the DotNetZip Library and Tools

DotNetZip is the name of an open-source project that delivers a .NET
library for handling ZIP files, and some associated tools.

* The library allows .NET programmers to build applications
  that read, create and modify ZIP files.
* The tools are .NET programs that rely on the library, and can be used
  by anyone on any Windows machine to build or extract ZIP files.

## How to build?

`bundle && rake`

CI: <https://ci.appveyor.com/project/haf/dotnetzip-semverd>

## Why DotNetZip?

The Microsoft .NET Framework base class library lacks a good set of
built-in classes for creating and reading ZIP files, and Windows itself
lacks full-powered built-in ZIP tools. DotNetZip fills those needs.

There are other ZIP libraries available, but some of them have licenses
that may be unfriendly, some of them are too hard to use or not powerful
enough, and some of them are too expensive (not free). DotNetZip
provides one more alternative. The goals for this alternative:

* easy to adopt - low cost (Free), and a friendly license
* fully-featured
* good performance - in speed and compression
* easy to use.

## DotNetZip background

Many people seem to think, incorrectly, that the classes in the
System.IO.Compression namespace, like GZipStream or DeflateStream, can
create or read zip files. Not true.

The System.IO.Compression namespace, available starting with .NET v2.0
for the desktop Framework and v3.5 for the Compact Framework, includes
base class libraries supporting compression within streams - both the
Deflate and Gzip formats are supported. But these classes are not
directly useful for creating compressed ZIP archives. GZIP is not
ZIP. Deflate is not ZIP. The GZipStream in System.IO.Compression is
able to read and write GZIP streams, but that is not the same as reading
or writing a zip file. Also, these classes deliver poor compression in
practice, especially with binary data, or previously-compressed data.

Yes, it is possible to read and write zip files, using the classes in
the .NET Framework.

* You can do it with the System.IO.Packaging.ZipPackage class, added
  in .NET v3.0. Actually this class lets you create a package file,
  which is a zipfile with a particular internal structure. It includes
  a manifest and some other things. But the interface is odd and
  confusing if all you want is a regular-old ZIP file. Also, the
  classes in this namespace do not provide control for things like
  passwords, comments, AES encryption, ZIP64, Unicode, and so on.
* You can also create and read zip files with the J# runtime. This
  also has its drawbacks. First, J# is going out of support, or may
  be out of support now. Second, the J# runtime is huge, and you have
  to swallow the whole thing, even if all you want is zip file
  capability. Also, the J# runtime is based on the java.util.zip
  classes from Java v1.4, dating from 1998. The runtime hasn't been
  updated in years and still includes bugs in zip file handling. It
  lacks support for AES, for ZIP64, and Unicode. It is not accessible
  from COM. Finally, the zip classes in the J# runtime are decidedly
  un-dotnet. There's no support for events, or enumerators to let you
  do things like For Each in VB, or foreach in C#. The interface is
  clunky. It does not feel like a .NET class library, because it isn't
  a .NET class library. So for all those reasons, J# isn't ideal.
* You can also rely on P/Invoke to the shell32.dll, and the
  ShellClass. This works in a limited fashion. The drawbacks here: it
  isn't documented. It isn't a very intuitive or powerful programming
  interface. There are no events, so embedding it into a Winforms app
  with a progress bar would be difficult. Again it lacks an easy way
  to use or access many ZIP features, like encryption or ZIP64 or
  self-extracting archives. Also, the shell32.dll is designed for use
  within Windows Explorer, and presumes a user interface. In fact in
  some cases, calling into this DLL to perform a ZIP extraction can
  display a dialog box, so it may not be suitable for use within
  server or "headless" applications.

There are other libraries out there than do zip files for .NET. But
there are compromises with each one. Some are commercial and expensive.
Some are slow. Some are complicated to use. Some of these options lack
features. Some of them have more than one of these drawbacks.

DotNetZip provides another option. It's a very simple-to-use class
library that provides good ZIP file support. Using this library, you
can write .NET applications that read and write zip-format files,
including files with passwords, Unicode filenames, ZIP64, AES
encryption, and comments. The library also supports self-extracting
archives. It is well documented and provides good performance.

Though DotNetZip is implemented in .NET and was originally intended to
provide a managed-code library for ZIP files, you can now use it library
from any COM environment, including Javascript, VBScript, VB6, VBA, PHP,
Perl, and others. Using DotNetZip, you could generate an AES-encrypted
zip file from within the code of a macro running in MS-Excel, for example.

DotNetZip works with applications running on PCs with Windows. There is a
version of this library available for the .NET Compact Framework, too.

I have not tested DotNetZip for use with Mono, but I've heard reports
that people use the binary releases with Mono successfully, without
change.

## License

This software is open source. It is released under the Microsoft Public
License of October 2006. The use of the "Microsoft Public License" does
not mean it is licensed by Microsoft. See the License.txt file for
details.

DotNetZip is derived in part from ZLIB, the C-language library by Mark
Adler and Jean-loup Gailly . See the License.ZLIB.txt file included in
the DotNetZip download for details.

## What is DotNetZip? and How is it packaged?

DotNetZip is primarily a managed library for dealing with ZIP files.

It is packaged as a DLL that your application must reference:
Ionic.Zip.dll. In the "developer's kit" package, there is
documentation, code examples, and debug versions of the DLL.

The ZIP library depends on a set of supporting classes for doing
compression and decompression; these are exposed in other namespaces.

The classes in the ZIP library reside in these namespaces:

## namespace interesting classes

Ionic.Zip ZipFile, ZipEntry, ZipOutputStream, and
ZipInputStream.

Ionic.Zlib DeflateStream, GZipStream, ZlibStream

Ionic.BZip2 BZip2InputStream, BZip2OutputStream

Ionic.Crc CRC32

If you want only ZLIB (raw compression and decompression, RFC 1950,
1951, and 1952), the ZLIB classes are packaged independently, in
Ionic.Zlib.dll. Likewise, if you want to do BZIP2 compression, outside
the scope of a zip file, you can use the Ionic.BZip2.dll assembly.

If you want ZIP, or both ZIP and ZLIB, then your application should
depend soly on Ionic.Zip.dll; this assembly includes a superset of the
classes in Ionic.Zlib.dll and Ionic.BZip2.dll.

For each DLL, there is a version for the regular .NET Framework and
another for the Compact Framework.

DotNetZip also includes command-line and GUI tools for manipulating zip
files; these can be helpful to developers when building applications
that create or manipulate zip files. They also can be helpful as
end-user tools.

There are other downloads for DotNetZip - the source package, the
runtime-only package (DLLs and no helpfile or tools), the
documentation-only package, etc.

## Using the Zip Class Library: The Basics

The examples here provide just the basics.

There are many other examples available: some are included in the source
package, some in the class reference documentation in the help file, and
others on the web. Those examples provide many illustrate how to read
and write zip files, taking advantage of all the various features of zip
files exposed by the library. For a full set of examples, your best bet
is to see the documentation. Here's a basic primer:

The main type you will use to fiddle with zip files is the ZipFile
class. Full name: Ionic.Zip.ZipFile. You use this to create, read, or
update zip files. There is also a ZipOutputStream class, which offers a
Stream metaphor, for those who want it. You should choose one or the
other for your application.

The simplest way to create a ZIP file in C# looks like this:

```
  using(ZipFile zip= new ZipFile())
  {
    zip.AddFile(filename);
    zip.Save(NameOfZipFileTocreate);
  }

```

Or in VB.NET, like this:

```
 Using zip As ZipFile = New ZipFile
     zip.AddFile(filename)
     zip.Save("MyZipFile.zip")
 End Using

```

The using clause is important; don't leave it out.

The simplest way to Extract all the entries from a zipfile looks
like this:

```
  using (ZipFile zip = ZipFile.Read(NameOfExistingZipFile))
  {
    zip.ExtractAll(args[1]);
  }

```

But you could also do something like this:

```
  using (ZipFile zip = ZipFile.Read(NameOfExistingZipFile))
  {
    foreach (ZipEntry e in zip)
    {
      e.Extract();
    }
  }

```

Or in VB, extraction would be like this:
Using zip As ZipFile = ZipFile.Read(NameOfExistingZipFile)
zip.ExtractAll
End Using

Or this:
Using zip As ZipFile = ZipFile.Read(NameOfExistingZipFile)
Dim e As ZipEntry
For Each e In zip
e.Extract
Next
End Using

That covers the basics.

Notice that a using clause is always employed. DOn't forget this. Don't
leave it off. If you don't understand what it is, don't just skip it.
It's important.

There are a number of other options for using the class library. For
example, you can read zip archives from streams, or you can create
(write) zip archives to streams, or you can extract into streams. You
can apply passwords for weak encryption. You can specify a code page
for the filenames and metadata of entries in an archive. You can rename
entries in archives, and you can add or remove entries from archives.
You can set up save and read progress events. You can do LINQ queries on
the Entries collection. Check the documentation for complete
information, or use Visual Studio's intellisense to explore some of the
properties and methods on the ZipFile class.

Another type you will use is ZipEntry. This represents a single entry -
either a file or a directory - within a ZipFile. To add an entry to a
zip file, you call one of the AddEntry (or AddFile) methods on the
ZipFile class. You never directly instantiate a ZipEntry type. The
AddEntry/AddFile returns a ZipEntry type; you can then modify the
properties of the entry within the zip file, using that object.

For example, the following code adds a file as an entry into a ZipFile,
then renames the entry within the zip file:

```
  using(ZipFile zip= new ZipFile())
  {
    ZipEntry e = zip.AddFile(filename);
    e.FileName = "RenamedFile.txt";
    zip.Save(NameOfZipFileTocreate);
  }

```

Extracting a zip file that was created in this way will produce a file
called "RenamedFile.txt", regardless of the name of the file originally
added to the ZipFile.

As an alternative to using ZipFile type to create a zip file, you can
use the ZipOutputStream type to create zip files . To do so, wrap it
around a stream, and write to it.

```
  using (var fs = File.Create(filename))
  {
    using(var s = new ZipOutputStream(fs))
    {
      s.PutNextEntry("entry1.txt");
      byte[] buffer = Encoding.ASCII.GetBytes("This is the content for entry #1.");
      s.Write(buffer, 0, buffer.Length);
    }
  }

```

Unlike the ZipFile class, the ZipOutputStream class can only create zip
files. It cannot read or update zip files.

If you want to read zip files using a streaming metaphor, you can use
ZipInputStream. Think of ZipInputStream and ZipOutputStream as
alternatives to using ZipFile to manipulate zip files. The former is for
reading zip files; the latter is for writing them.

## About Directory Paths

One important note: the ZipFile.AddXxx methods add the file or
directory you specify, including the directory. In other words,
logic like this:
ZipFile zip = new ZipFile();
zip.AddFile("c:\a\b\c\Hello.doc");
zip.Save();

...will produce a zip archive that contains a single entry, or file, and
that file is stored with the relative directory information. When you
extract that file from the zip, either using this Zip library or winzip
or the built-in zip support in Windows, or some other package, all those
directories will be created, and the file will be written into that
directory hierarchy. At extraction time, if you were to extract that
file into a directory like c:\documents, then resulting file would be
named c:\documents\a\b\c\Hello.doc .

This is by design.

If you don't want that directory information in your archive,
then you need to use the overload of the AddFile() method that
allows you to explicitly specify the directory used for the entry
within the archive:

```
zip.AddFile("c:\\a\\b\\c\\Hello.doc", "files");
zip.Save();

```

This will create an archive with an entry called "files\Hello.doc",
which contains the contents of the on-disk file located at
c:\a\b\c\Hello.doc .

If you extract that file into a directory e:\documents, then the
resulting file will be called e:\documents\files\Hello.doc .

If you want no directory at all, specify "" (the empty string).
Specifying null (Nothing in VB) will include all the directory hierarchy
in the filename, as in the orginal case.

## Pre-requisites to run Applications that use DotNetZip

To run desktop applications that depend on DotNetZip:
.NET Framework 4.0 or later

## In more detail: The Zip Class Library

The Zip class library is packaged as Ionic.Zip.DLL for the regular .NET
Framework and Ionic.Zip.CF.dll for the Compact Framework. The Zip
library allows applications to create, read, and update zip files.

This library uses the DeflateStream class to compress file data,
and extends it to support reading and writing of the metadata -
the header, CRC, and other optional data - defined or required
by the zip format spec.

The key object in the class library is the ZipFile class. Some of the
important methods on it:

```
  - AddItem - adds a file or a directory to a zip archive
  - AddDirectory - adds a directory to a zip archive
  - AddFile - adds a file to a zip archive
  - AddFiles - adds a set of files to a zip archive
  - Extract - extract a single element from a zip file
  - Read - static methods to read in an existing zipfile, for
           later extraction
  - Save - save a zipfile to disk

```

There is also a supporting class, called ZipEntry. Applications can
enumerate the entries in a ZipFile, via ZipEntry. There are other
supporting classes as well. Typically, 80% of apps will use just the
ZipFile class, and will not need to directly interact with these other
classes. But they are there if you need them.

If you want to create or read zip files, the Ionic.Zip.DLL assembly is
the one you want.

When building applications that do zip stuff, you need to add a reference to
the Ionic.Zip.dll in Visual Studio, or specify Ionic.Zip.dll with the
/R flag on the CSC.exe or VB.exe compiler line.

## In more detail: The Zlib Class Library

The Zlib class library is packaged as Ionic.Zlib.DLL for the regular .NET
Framework and Ionic.Zlib.CF.dll for the Compact Framework. The ZLIB
library does compression and decompression according to IETF RFC's 1950 (ZLIB),
1951 (Deflate), and 1952 (GZIP).

See <http://www.ietf.org/rfc/rfc1950.txt>
<http://www.ietf.org/rfc/rfc1951.txt>
and <http://www.ietf.org/rfc/rfc1952.txt>

The key classes are:

ZlibCodec - a class for Zlib (RFC1950/1951/1952) encoding and decoding.
This low-level class does deflation and inflation on buffers.

DeflateStream - patterned after the DeflateStream in
System.IO.Compression, this class supports compression
levels and other options.

GZipStream - patterned after the GZipStream in
System.IO.Compression, this class supports compression
levels and other options.

ZlibStream - similar to the GZipStream in
System.IO.Compression, this class generates or consumes raw ZLIB
streams.

If you want to simply compress (deflate) raw block or stream data, this
library is the thing you want.

When building applications that do zlib things, you need to add a reference to
the Ionic.Zlib.dll in Visual Studio, or specify Ionic.Zlib.dll with the
/R flag on the CSC.exe or VB.exe compiler line.

NB: If your application does both Zlib and Zip stuff, you need only add
a reference to Ionic.Zip.dll. Ionic.Zip.dll includes all the capability
in Ionic.Zlib.dll. Ionic.Zip.dll is a superset.

## In more detail: The BZip2 Class Library

The BZip2 class library is packaged as Ionic.BZip2.DLL for the regular .NET
Framework and Ionic.BZip2.CF.dll for the Compact Framework. The BZip2
library does compression according to the bzip2 format created by
Julian Seward.
See <http://en.wikipedia.org/wiki/Bzip2>

NB: If your application does a combination of BZip2, Zlib and Zip stuff,
you need only add a reference to Ionic.Zip.dll. Ionic.Zip.dll includes
all the capability in Ionic.Zlib.dll and Ionic.BZip2.dll. Ionic.Zip.dll
is a superset.

If you try to link to more than one of these, you will get compiler
warnings about "duplicate types".

## Namespace changes for DotNetZip

The namespace for the DotNetZip classes is Ionic.Zip.
Classes are like:
Ionic.Zip.ZipFile
Ionic.Zip.ZipEntry
Ionic.Zip.ZipException
etc

(check the .chm file for the full list)

For the versions prior to v1.7, the namespace DotNetZip was Ionic.Utils.Zip.
The classes were like so:
Ionic.Utils.Zip.ZipFile
Ionic.Utils.Zip.ZipEntry
etc

If you have code that depends on an older version of the library, with
classes in the Ionic.Utils.Zip namespace), a simple namespace
replacement will allow your code to compile against the new version of
the library.

In addition to the Zip capability, DotNetZip includes capability (new
for v1.7). For Zlib, the classes are like this:
Ionic.Zlib.DeflateStream
Ionic.Zlib.ZlibStream
Ionic.Zlib.ZlibCodec
...

(again, check the .chm file for the full list)

For v1.9.1.6, the CRC class moved from the Ionic.Zlib namespace to the
Ionic.Crc namespace.

## Dependencies

Originally, this library was designed to depend upon the built-in
System.IO.Compression.DeflateStream class for the compression. This
proved to be less than satisfactory because the built-in compression
library did not support compression levels and also was not available on
.NET CF 2.0.

As of v1.7, the library includes a managed code version of zlib, the
library that produces RFC1950 and RFC1951 compressed streams. Within
that version of zlib, there is also a DeflateStream class which is
similar to the built-in System.IO.Compression.DeflateStream, but more
flexible, and often more effective as well.

## The Documentation

There is a single set of developer reference documentation for all of
the DotNetZip library features, including Zip and Zlib stuff. It is
packaged in two ways: As a .chm file, and as a Help Viewer 1.0 resource.
The latter is the new format suitable for viewing within VS2010.

If you only use the Zlib stuff, then you should focus on the doc in the
Ionic.Zlib namespace. Likewise BZip2. If you are building apps for
mobile devices running the Compact Framework, then ignore the pieces
that deal with SaveSelfExtractor() and AES.

Consult the help file for more specifics here.

In some cases, upon opening the .chm file for DotNetZip, the help
items tree loads, but the contents are empty. You may see an error:
"This program cannot display the webpage." or, "Address is invalid."
If this happens, it's likely that you've encountered a problem with Windows
protection of files downloaded from less trusted locations. To work around
this, within Windows Explorer, right-click on the CHM file, select properties,
and Unblock it, using the button in lower part of properties window.

The help is also packaged in a format that you can integrate into Visual
Studio 2008, or Visual Studio 2010. VS2008 requires MS Help 2.0, while
VS2010 requires a different, newer format, sometimes called MS Help 3,
and sometimes (confusingly) called "MS Help Viewer 1.0 format".

The DotNetZip "devkit" download includes help in all these formats.

## The Zip Format

The zip format is described by PKWare, at
<http://www.pkware.com/business_and_developers/developer/popups/appnote.txt>

Every valid zipfile conforms to this specification. For example, the
spec says that for each compressed file contained in the zip archive,
the zipfile contains a byte array of compressed data. (The byte array
is something the DeflateStream class can produce directly.) But the
zipfile also contains header and "directory" information - you might
call this "metadata". In other words, the zipfile must contain a list
of all the compressed files in the archive. The zipfile also contains
CRC checksums, and can also contain comments, and other optional
attributes for each file. These are things the DeflateStream class -
either the one included in the .NET Framework Class Library, or the one
embedded in this library - does not read or write.

Managing the metadata in a zip file is most of what DotNetZip does.

## Which DLL to use?

The binary releases of DotNetZip include multiple distinct DLLs or
assemblies. Which one should you use?

The likely answer is: use Ionic.Zip.dll.

That's the mainstream library, the full library, and it includes all the
capability. If you have particular requirements, like you want a
smaller library, or you want to exclude the Self-Extracting stuff, or
you only want the ZLIB capability, then you may want to choose a
different assembly.

Here's a summary of the options.

## Usage scenario Reference this DLL

reading or writing Zip files Ionic.Zip.dll

raw block or stream compression, ZLIB, GZIP, Ionic.Zlib.dll
or DEFLATE

raw block or stream compression, BZIP2 Ionic.BZip2.dll

both raw compression as well as reading Ionic.Zip.dll
or writing Zip files

reading or writing Zip files, using desktop Ionic.Zip.Reduced.dll
.NET framework but never creating a
self-extracting archive

Never reference both Ionic.Zlib.dll and Ionic.Zip.dll, or both
Ionic.BZip2.dll and Ionic.Zip.dll in the same application. If your
application does both Zlib and Zip stuff, you need only add a reference
to Ionic.Zip.dll. Ionic.Zip.dll includes all the capability in
Ionic.Zlib.dll and Ionic.BZip2.dll You always need to reference only a
single Ionic DLL, regardless whether you use Zlib or BZip2 or Zip or
some combination.

## Self-Extracting Archive support

The Self-Extracting Archive (SFX) support in the library allows you to
create a self-extracting zip archive. An SFX is both a standard EXE
file *and* a ZIP file. The exe contains boilerplate program logic to
unzip the embedded zip file. When the user executes the SFX runs, the
boilerplate application logic just reads the zip content and
then unzips itself. You can open an SFX in WinZip and other zip tools,
as well, if you want to view it.

Running the SFX (unpacking from the SFX) requires the .NET Framework
installed on the machine, but does not require the DotNetZip library.

There are two versions of the SFX - one that presents a GUI form, and
another that runs as a console (command line) application.

NB: Creation of SFX is not supported in the Compact Framework version of
the library.

Also, there is no way, currently, to produce an SFX file that can run on
the .NET Compact Framework.

## The Reduced ZIP library

The full DotNetZip library is currently about 400k in size. The SFX
(Self-Extracting Archive) support is responsible for more than half the
total size of the library. Some deployments may wish to omit the SFX
support in order to get a smaller DLL. For that you can rely on the
Ionic.Zip.Reduced.dll. It provides everything the normal library does,
except the SaveSelfExtractor() method on the ZipFile class.

For size comparisons...these approximate figures are for v1.9.1.6 of the
library:

#### Desktop Framework:

```
  assembly              ~size   comment
  -------------------------------------------------------
  Ionic.Zlib.dll         100k   {Deflate,GZip,Zlib}Stream and ZlibCodec

  Ionic.BZip2.dll         57k   BZip2{Input,Output}Stream

  Ionic.Zip.dll          460k   includes ZLIB and BZIP2 compression,
                                SFX, selector logic, WinZIP AES encryption,
                                and the ComHelper class

  Ionic.Zip.Reduced.dll  250k   includes everything in the main ZIP
                                library except SFX. (ability to save
                                Self-extracting archives)

```

## Support

There is no official support for this library. I try to make a good
effort to answer questions and monitor the work items raised on the
project portal at:

```
http://DotNetZip.codeplex.com.

```

## About Intellectual Property

I am no lawyer, but before using this library in your app, it
may be worth reviewing the various licenses.

The specification for the zip format, which PKWARE owns, includes a
paragraph that reads:

PKWARE is committed to the interoperability and advancement of the
.ZIP format. PKWARE offers a free license for certain technological
aspects described above under certain restrictions and conditions.
However, the use or implementation in a product of certain technological
aspects set forth in the current APPNOTE, including those with regard to
strong encryption or patching, requires a license from PKWARE. Please
contact PKWARE with regard to acquiring a license.

Contact pkware at: zipformat@pkware.com

This library does not do strong encryption as described by PKWare, nor
does it do patching. But again... I am no lawyer.

This library uses a ZLIB implementation that is based on a conversion of
the jzlib project <http://www.jcraft.com/jzlib/>. The license and
disclaimer required by the jzlib source license is referenced in the
relevant source files of DotNetZip, specifically in the sources for the
Zlib module.

This library uses a BZip2 implementation that is based on a conversion
of the bzip2 implementation in the Apache Commons compression library.
The Apache license is referenced in the relevant source files of
DotNetZip, specifically in the sources for the BZip2 module.

## Limitations

There are a few limitations to this library:

It does not do strong encryption.

The GUI tool for creating zips is functional but basic. This isn't a limitation
of the library per se.

...and, I'm sure, many others

But it is a good basic library for reading and writing zipfiles
in .NET applications.

# Building the Library

This section is mostly interesting to developers who will work on or
view the source code of DotNetZip, to extend or re-purpose it. If you
only plan to use DotNetZip in applications of your own, you probably
don't need to concern yourself with the information that follows.

## Pre-requisites to build DotNetZip

.NET Framework 4.0 SDK or later
-or-
Visual Studio 2010 or later

-and-

ILMerge - a tool from Microsoft that combines
multiple managed assemblies into a single DLL or image. It is in
similar in some respects to the lib tool in C toolkits.

You can get it here:
<http://www.microsoft.com/downloads/details.aspx?familyid=22914587-b4ad-4eae-87cf-b14ae6a939b0&displaylang=en>

## Building DotNetZip with the .NET SDK

To build the library using the .NET Framework SDK v4.0,

1. extract the contents of the source zip into a new directory.
2. be sure the .NET 4.0 SDK and runtime directories are on your
   path.
3. Modify the .csproj files in Zip and ZLIB and BZip2 to eliminate
   mention of the Ionic.pfx and Ionic.snk files.

   The various DLLs (Zip Partial, ZLIB, etc.) are signed with my private
   key. You will want to remove the mention of the private key in the
   project files. I cannot distribute my private key, so don't ask me!
   That would be silly. So you have to modify the project in order to
   build without the key.
4. open a CMD prompt and CD to the DotNetZip directory.
5. msbuild

   Be sure you are using the .NET 3.5 version of MSBuild.
   This builds the "Debug" version of the library. To build the
   "Release" version, do this:

   msbuild /t:Release
6. to clean and rebuild, do
   msbuild /t:clean
   msbuild
7. There are two setup directories, which contain the projects necessary
   to build the MSI file. Unfortunately msbuild does not include
   support for building setup projects (vdproj). You need Visual Studio
   to build the setup directories.

   I am in the process of converting these from .vdproj to .wixproj, so
   they can be built from the command line using msbuild. .

## Building DotNetZip with Visual Studio

To build DotNetZip using Visual Studio 2010,

1. Open the DotNetZip.sln file in VS2010.
2. If necessary, Remove the dependencies on Ionic.pfx and Ionic.snk.

   (References to these will have already been removed from the zipped
   source distributions, but if you get your source from the TFS server,
   then you will have to remove references to the keyfiles manually)

   The various DLLs (Zip, ZLIB, etc.) are signed with my (Dino
   Chiesa's) private key. I do not distribute that key for anyone
   else's use. If you build the DotNetZip library from source, You will
   want to remove the mention of the private key in the project files. I
   will not distribute my private key, that would be silly. So don't
   ask me!
3. Press F6 to build everything.

## The Project Structure and Build approach

The function here is grouped into three basic sets: Zip,
ZLIB/Deflate/GZIP, and BZip2. The Zip group is a superset of the ZLIB
and BZIP2 groups.

Each group of functionality is packaged into various assemblies, one
assembly per "platform". The platforms supported are: .NET (Desktop).

There is also a special "Zip Reduced" library, available only on the
Desktop platform; it is a reduced-function version of the regular
Desktop Framework zip library. It provides an option of using a smaller
library for those zip-handling applications that don't produce
Self-extracting archives.

In a previous guise, DotNetZip relied on the ILMerge tool to combine
distinct DLLs into a single package. This is no longer the case.

Because the ZIP projects include the ZLIB and BZIP2 function, the
appropriate source modules for the ZLIB and Bzip2 are "linked" into each
of the ZIP projects (Desktop).

## Regarding the missing Ionic.pfx and Ionic.snk files

The binary DLLs shipped in the codeplex project are signed by me, Dino
Chiesa. This provides a "strong name" for the assembly, which itself
provides some assurance as to the integrity of the library, and also
allows it to be run within restricted sites, like apps running inside
web hosters.

For more on strong names, see this article:
<http://msdn.microsoft.com/en-gb/magazine/cc163583.aspx>

Signing is done automatically at build time in the Visual Studio project or in
the msbuild build. There
is a .pfx file that holds the crypto stuff for signing the assembly, and
that pfx file is itself protected by a password. There is also an
Ionic.snk file which is referenced by the project, but which I do not
distribute.

People opening the project ask me: what's the password to this .pfx
file? Where's the .snk file?

Here's the problem; those files contain my private key. if I give
everyone the password to the PFX file or the .snk file, then anyone can
go and build a modified Ionic.Zip.dll, and sign it with my key, and
apply any version number they like. This means there could be multiple
distinct assemblies with the same signature. This is obviously not
good.

Since I don't release the ability to sign DLLs with my key, the DLL
signed with my key is guaranteed to be produced by me only, which is in
fact the exact intent of code signing in .NET.

If anyone wants to modify the project and re-compile it, they have a
couple options:

* sign the assembly themselves, using their own key.
* produce a modified, unsigned assembly

In either case it is not the same as the assembly I am shipping,
therefore it should not be signed with the same key.

All clear?

As for those options above, here is some more detail:

1. If you want a strong-named assembly, then create your own PFX file
   and .snk file and modify the appropriate projects to use those new
   files.
2. If you don't need a strong-named assembly, then remove all the
   signing from the various projects.

In either case, you will need to modify the "Zip", BZip, and the "Zlib"
projects.

## Building the Documentation

The documentation files are built using the Sandcastle Helpfile Builder
tool, also available on CodePlex at <http://www.codeplex.com/SHFB> . It
is built from in-code xml documentation, augmented with some additional
out-of-band html documentation.

If you want to build the help files yourself, you will need to have
Sandcastle from May 2008 (or later, I guess), and SHFB, from February
2009. Both are free tools available from <http://codeplex.com> . I think
you can get a package download of both of these by installing v1.9.3.0
of SHFB .

The helpfile projects are:

HtmlHelp1.shfbproj - to build the .chm file
MSHelp2.shfbproj - to build the MS Help 2.0 content
HelpViewer.shfbproj - to build the MS Help Viewer 1.0 content

(The MSHelp2 project is broken at the moment.)

To build the documentation in any of these formats, first build the "zip
Full DLL" project in the source (Ionic.Zip.dll), then run:

msbuild HtmlHelp1.shfbproj

```
-or-

```

msbuild HelpViewer.shfbproj

The Help Viewer 1.0 content can be viewed in the help viewer that is
integrated into VS 2010, or in an alternative viewer, such as
H3Viewer.exe. See <http://mshcmigrate.helpmvp.com/viewer> .

## Examples

The source solution also includes a number of example applications
showing how to use the DotNetZip library and all its features - creating
ZIPs, using Unicode, passwords, comments, streams, and so on. Most of
these will be built when you build the solution. Some of them do not -
you will need to build them independently.

## Tests

There are two source projects in the VS Solution that contain Unit
Tests: one for the zlib library, one for the bzip2 library, and another
for the Zip library. If you develop any new tests for DotNetZip, I'd be
glad to look at them.

# Origins

This library is mostly original code.

There is a GPL-licensed library called SharpZipLib that writes zip
files, it can be found at
<http://www.sharpdevelop.net/OpenSource/SharpZipLib/Default.aspx>

This library is not based on SharpZipLib.

I think there may be a Zip library shipped as part of the Mono
project. This library is also not based on that.

Now that the Java class library is open source, there is at least one
open-source Java implementation for zip. This implementation is not
based on a port of Sun's JDK code.

There is a zlib.net project from ComponentAce.com. This library is not
based on that code.

This library is all new code, written by me, with these exceptions:

* the CRC32 class - see above for credit.
* the zlib library - see above for credit.
* the bzip2 compressor - see above for credit.

## About

Please use System.IO.Compression! A fork of the DotNetZip project without signing with a solution that compiles cleanly. This project aims to follow semver to avoid versioning conflicts. DotNetZip is a FAST, FREE class library and toolset for manipulating zip files. Use VB, C# or any .NET language to easily create, extract, or update zip files.

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)

[Activity](/haf/DotNetZip.Semverd/activity)
### Stars

[**549**
stars](/haf/DotNetZip.Semverd/stargazers)
### Watchers

[**46**
watching](/haf/DotNetZip.Semverd/watchers)
### Forks

[**236**
forks](/haf/DotNetZip.Semverd/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fhaf%2FDotNetZip.Semverd&report=haf+%28user%29)

## [Releases](/haf/DotNetZip.Semverd/releases)

[3
tags](/haf/DotNetZip.Semverd/tags)

## [Packages 0](/users/haf/packages?repo_name=DotNetZip.Semverd)

No packages published

## [Used by 8.8k](/haf/DotNetZip.Semverd/network/dependents)

[* ![@raphaeIl](https://avatars.githubusercontent.com/u/91389854?s=64&v=4)
* ![@pOsdas](https://avatars.githubusercontent.com/u/125290150?s=64&v=4)
* ![@alex47exe](https://avatars.githubusercontent.com/u/17827464?s=64&v=4)
* ![@Shahryar-Anwer](https://avatars.githubusercontent.com/u/167057427?s=64&v=4)
* ![@jtesseract13f](https://avatars.githubusercontent.com/u/120721225?s=64&v=4)
* ![@chureerut](https://avatars.githubusercontent.com/u/69831250?s=64&v=4)
* ![@TortoiseFather](https://avatars.githubusercontent.com/u/60541661?s=64&v=4)
* ![@DevNumber19](https://avatars.githubusercontent.com/u/184462209?s=64&v=4)

+ 8,786](/haf/DotNetZip.Semverd/network/dependents)

## [Contributors 40](/haf/DotNetZip.Semverd/graphs/contributors)

* [![@haf](https://avatars.githubusercontent.com/u/193115?s=64&v=4)](https://github.com/haf)
* [![@darkms](https://avatars.githubusercontent.com/u/5042377?s=64&v=4)](https://github.com/darkms)
* [![@gbakeman](https://avatars.githubusercontent.com/u/842942?s=64&v=4)](https://github.com/gbakeman)
* [![@iainnicol](https://avatars.githubusercontent.com/u/2117362?s=64&v=4)](https://github.com/iainnicol)
* [![@Numpsy](https://avatars.githubusercontent.com/u/1178570?s=64&v=4)](https://github.com/Numpsy)
* [![@dosomder](https://avatars.githubusercontent.com/u/3040570?s=64&v=4)](https://github.com/dosomder)
* [![@chrfin](https://avatars.githubusercontent.com/u/1186179?s=64&v=4)](https://github.com/chrfin)
* [![@JaykeBird](https://avatars.githubusercontent.com/u/1905005?s=64&v=4)](https://github.com/JaykeBird)
* [![@silversj](https://avatars.githubusercontent.com/u/19177660?s=64&v=4)](https://github.com/silversj)
* [![@shana](https://avatars.githubusercontent.com/u/310137?s=64&v=4)](https://github.com/shana)
* [![@joelweiss](https://avatars.githubusercontent.com/u/2687785?s=64&v=4)](https://github.com/joelweiss)
* [![@EamonNerbonne](https://avatars.githubusercontent.com/u/803518?s=64&v=4)](https://github.com/EamonNerbonne)
* [![@AartBluestoke](https://avatars.githubusercontent.com/u/1892829?s=64&v=4)](https://github.com/AartBluestoke)
* [![@lanceheld](https://avatars.githubusercontent.com/u/9935733?s=64&v=4)](https://github.com/lanceheld)

[+ 26 contributors](/haf/DotNetZip.Semverd/graphs/contributors)

## Languages

* [C#
  72.3%](/haf/DotNetZip.Semverd/search?l=c%23)
* [Rich Text Format
  19.5%](/haf/DotNetZip.Semverd/search?l=rich-text-format)
* [HTML
  3.4%](/haf/DotNetZip.Semverd/search?l=html)
* [ASP.NET
  1.0%](/haf/DotNetZip.Semverd/search?l=asp.net)
* [Visual Basic .NET
  0.9%](/haf/DotNetZip.Semverd/search?l=visual-basic-.net)
* [Smalltalk
  0.7%](/haf/DotNetZip.Semverd/search?l=smalltalk)
* Other
  2.2%

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


