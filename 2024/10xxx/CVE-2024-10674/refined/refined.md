Based on the provided information, here's a breakdown of the vulnerability:

**CVE ID:** CVE-2024-10674

**Root Cause:**
The vulnerability stems from a missing authorization check in the `th_shop_mania_install_and_activate_callback()` function within the Th Shop Mania theme. This function is responsible for installing and activating plugins.

**Weaknesses/Vulnerabilities:**
- **Missing Authorization:** The primary weakness is the lack of proper capability checks within the `th_shop_mania_install_and_activate_callback()` function. This allows users with lower privileges than required to execute this function.
- **Arbitrary Plugin Installation/Activation:** Due to the missing authorization, any authenticated user, including those with subscriber-level access, can install and activate arbitrary plugins.

**Impact of Exploitation:**
- **Remote Code Execution:** By installing a malicious plugin, an attacker can achieve remote code execution on the server.
- **Privilege Escalation:** The attacker can potentially escalate their privileges by installing plugins that grant them higher access levels.
- **Complete System Compromise:** Successful exploitation can lead to a complete compromise of the affected WordPress site.

**Attack Vectors:**
- **Network:** The vulnerability can be exploited over the network.
- **Authenticated Users:** The attack vector requires the attacker to have an authenticated account on the WordPress site (Subscriber or higher role).

**Required Attacker Capabilities/Position:**
- **Authentication:** The attacker must be an authenticated user on the WordPress site.
- **Low-Level Access:**  The attacker requires only subscriber-level access or higher to exploit the vulnerability.

**Additional Details:**

*   The vulnerability exists in all versions of the Th Shop Mania theme up to and including 1.4.9.
*   The vulnerability was fixed in version 1.5.0.
*   The vulnerable code is located in the `lib/notification/notify.php` file.
*   The `th_shop_mania_install_and_activate_callback` function is called via an AJAX request.
*   The patch implemented a check within the vulnerable function to ensure only administrators can perform this action.