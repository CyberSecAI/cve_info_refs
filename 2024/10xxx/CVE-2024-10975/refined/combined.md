=== Content from discuss.hashicorp.com_6e0c6f2e_20250115_100459.html ===


[HashiCorp Discuss](/)

# [HCSEC-2024-27 - Nomad Vulnerable To Cross-Namespace Volume Creation Abusing CSI Write Permission](/t/hcsec-2024-27-nomad-vulnerable-to-cross-namespace-volume-creation-abusing-csi-write-permission/71212)

[Security](/c/security/52)

[security-nomad](https://discuss.hashicorp.com/tag/security-nomad)

[dduzgun-security](https://discuss.hashicorp.com/u/dduzgun-security)

November 7, 2024, 10:15pm

1

**Bulletin ID:** HCSEC-2024-27

**Affected Products / Versions:**

Nomad Community Edition from 1.3.0 up to 1.9.1, fixed in 1.9.2.

Nomad Enterprise from 1.3.0 up to 1.9.1, 1.8.6, 1.7.14, fixed in 1.9.2, 1.8.7, and 1.7.15.

**Publication Date:** November 7, 2024

**Summary**

Nomad Community and Nomad Enterprise (“Nomad”) volume specification is vulnerable to arbitrary cross-namespace volume creation through unauthorized Container Storage Interface (CSI) volume writes. This vulnerability, identified as CVE-2024-10975, is fixed in Nomad Community Edition 1.9.2 and Nomad Enterprise 1.9.2, 1.8.7, and 1.7.15.

**Background**

Nomad’s storage plugin allows scheduling tasks with externally created storage volumes. The Nomad [volume](https://developer.hashicorp.com/nomad/docs/other-specifications/volume) specification defines the schema for creating and registering volumes using the [volume create](https://developer.hashicorp.com/nomad/docs/commands/volume/create) and [volume register](https://developer.hashicorp.com/nomad/docs/commands/volume/register) commands. The [volume create](https://developer.hashicorp.com/nomad/docs/commands/volume/create) command creates external storage volumes with Nomad’s [Container Storage Interface (CSI)](https://github.com/container-storage-interface/spec) support for plugins that implement the [Controller](https://developer.hashicorp.com/nomad/docs/concepts/plugins/csi#csi-plugins) interface. When ACLs are enabled, this command requires a token with the [csi-write-volume](https://developer.hashicorp.com/nomad/docs/other-specifications/acl-policy#csi-write-volume) capability for the volume’s namespace.

**Details**

The vulnerability is exploitable when a user with [csi-write-volume](https://developer.hashicorp.com/nomad/docs/other-specifications/acl-policy#csi-write-volume) capability in a namespace attempts to create or register an external storage volume using the Nomad `volume create` or `volume register` command. A flaw in authorization checks as implemented allowed an attacker to create volumes across namespaces, bypassing intended ACLs by:

* setting the `namespace` field in the volume spec to the target namespace the user doesn’t have permissions to, while also
* setting the `-namespace` for the command line (or API) to the namespace the user does have permissions to

**Remediation**

Customers using the `volume create` or `volume register` commands should evaluate the risk associated with this issue and consider upgrading to Nomad 1.9.2, 1.8.7, 1.7.15, or newer.

Please refer to [Upgrading Nomad](https://developer.hashicorp.com/nomad/docs/upgrade) for general guidance and the [Upgrade Guides](https://developer.hashicorp.com/nomad/docs/upgrade/upgrade-specific) for version-specific upgrade notes.

**Acknowledgement**

This issue was identified by HashiCorp‘s Nomad engineering teams.

*We deeply appreciate any effort to coordinate disclosure of security vulnerabilities. For information about security at HashiCorp and the reporting of security vulnerabilities, please see <https://hashicorp.com/security>.*

1 Like

### Related topics

| Topic |  | Replies | Views | Activity |
| --- | --- | --- | --- | --- |
| [Could not create CSI volume](https://discuss.hashicorp.com/t/could-not-create-csi-volume/26189)  [Nomad](/c/nomad/28) | 2 | 568 | June 30, 2021 |
| [HCSEC-2020-23 - Nomad File Sandbox Escape via Container Volume Mount](https://discuss.hashicorp.com/t/hcsec-2020-23-nomad-file-sandbox-escape-via-container-volume-mount/18108)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 4337 | November 25, 2020 |
| [Unable to delete CSI NFS Volume in Nomad](https://discuss.hashicorp.com/t/unable-to-delete-csi-nfs-volume-in-nomad/71024)  [Nomad](/c/nomad/28) [csi](https://discuss.hashicorp.com/tag/csi) | 2 | 22 | November 1, 2024 |
| [Setting up democratic-csi volumes using nomad](https://discuss.hashicorp.com/t/setting-up-democratic-csi-volumes-using-nomad/29077)  [Nomad](/c/nomad/28) | 0 | 1152 | September 2, 2021 |
| [HCSEC-2024-29 - Nomad Allocations Vulnerable To Privilege Escalation Within A Namespace Using Unredacted Workload Identity Token](https://discuss.hashicorp.com/t/hcsec-2024-29-nomad-allocations-vulnerable-to-privilege-escalation-within-a-namespace-using-unredacted-workload-identity-token/72119)  [Security](/c/security/52) [security-nomad](https://discuss.hashicorp.com/tag/security-nomad) | 0 | 181 | December 20, 2024 |

* [Home](/)
* [Categories](/categories)
* [Guidelines](/guidelines)
* [Terms of Service](/tos)
* [Privacy Policy](https://meta.discourse.org/privacy)

Powered by [Discourse](https://www.discourse.org), best viewed with JavaScript enabled


