=== Content from www.postgresql.org_49c1a641_20250114_201904.html ===


[![PostgreSQL Elephant Logo](/media/img/about/press/elephant.png)](/)

* [Home](/ "Home")
* [About](/about/ "About")
* [Download](/download/ "Download")
* [Documentation](/docs/ "Documentation")
* [Community](/community/ "Community")
* [Developers](/developer/ "Developers")
* [Support](/support/ "Support")
* [Donate](/about/donate/ "Donate")
* [Your account](/account/ "Your account")

November 21, 2024: [PostgreSQL 17.2, 16.6, 15.10, 14.15, 13.18, and 12.22 Released!](/about/news/postgresql-172-166-1510-1415-1318-and-1222-released-2965/)

## Quick Links

* [Support](/support/)
* [Versioning Policy](/support/versioning/)
* [Security](/support/security/)
* [Professional Services](/support/professional_support/)
* [Hosting Solutions](/support/professional_hosting/)
* [Report a Bug](/account/submitbug/)

# CVE-2024-10976

### PostgreSQL row security below e.g. subqueries disregards user ID changes

Incomplete tracking in PostgreSQL of tables with row security allows a reused
query to view or change different rows from those intended.
[CVE-2023-2455](https://www.postgresql.org/support/security/CVE-2023-2455/) and
[CVE-2016-2193](https://www.postgresql.org/support/security/CVE-2016-2193/)
fixed most interaction between row security and user ID changes.
They missed cases where a subquery, WITH query, security invoker view, or
SQL-language function references a table with a row-level security policy.
This has the same consequences as the two earlier CVEs.
That is to say, it leads to potentially incorrect policies being applied in
cases where role-specific policies are used and a given query is planned under
one role and then executed under other roles. This scenario can happen under
security definer functions or when a common user and query is planned initially
and then re-used across multiple SET ROLEs.

Applying an incorrect policy may permit a user to complete otherwise-forbidden
reads and modifications. This affects only databases that have used
[`CREATE POLICY`](https://www.postgresql.org/docs/current/sql-createpolicy.html)
to define a row security policy. An attacker must tailor an attack to a
particular application's pattern of query plan reuse, user ID changes, and
role-specific row security policies. Versions before
PostgreSQL 17.1, 16.5, 15.9, 14.14, 13.17, and 12.21 are affected.

## Version Information

| Affected Version | Fixed In | Fix Published |
| --- | --- | --- |
| 17 | [17.1](/docs/release/17.1) | [Nov. 14, 2024](/about/news/postgresql-171-165-159-1414-1317-and-1221-released-2955/) |
| 16 | [16.5](/docs/release/16.5) | [Nov. 14, 2024](/about/news/postgresql-171-165-159-1414-1317-and-1221-released-2955/) |
| 15 | [15.9](/docs/release/15.9) | [Nov. 14, 2024](/about/news/postgresql-171-165-159-1414-1317-and-1221-released-2955/) |
| 14 | [14.14](/docs/release/14.14) | [Nov. 14, 2024](/about/news/postgresql-171-165-159-1414-1317-and-1221-released-2955/) |
| 13 | [13.17](/docs/release/13.17) | [Nov. 14, 2024](/about/news/postgresql-171-165-159-1414-1317-and-1221-released-2955/) |
| 12 | [12.21](/docs/release/12.21) | [Nov. 14, 2024](/about/news/postgresql-171-165-159-1414-1317-and-1221-released-2955/) |

For more information about [PostgreSQL versioning](/support/versioning/),
please visit the [versioning page](/support/versioning/).

## CVSS 3.0

| Overall Score | **4.2** |
| --- | --- |
| Component | core server |
| Vector | [AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N&version=3.0) |

## Reporting Security Vulnerabilities

If you wish to report a new security vulnerability in PostgreSQL, please
send an email to
security@postgresql.org.

For reporting non-security bugs, please see the [Report a Bug](/account/submitbug/) page.

* [![@postgresql](/media/img/atpostgresql.png)](https://twitter.com/postgresql)
* [![Git](/media/img/git.png)](https://git.postgresql.org/gitweb/?p=postgresql.git)

[Policies](/about/policies/) |
[Code of Conduct](/about/policies/coc/) |
[About PostgreSQL](/about/) |
[Contact](/about/contact/)

Copyright Â© 1996-2025 The PostgreSQL Global Development Group


