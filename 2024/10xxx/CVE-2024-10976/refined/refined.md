- **Root cause of vulnerability**: Incomplete tracking of tables with row-level security (RLS) policies in PostgreSQL, specifically when subqueries, WITH queries, security invoker views, or SQL-language functions reference such tables.
- **Weaknesses/vulnerabilities present**: Failure to properly account for user ID changes when reusing query plans, leading to incorrect application of RLS policies. This is a case of insufficient access control.
- **Impact of exploitation**: An attacker can potentially bypass RLS policies, leading to unauthorized reads and modifications of data. This can be done if role-specific policies are used, and a given query is planned under one role and then executed under other roles.
- **Attack vectors**: Exploitation requires tailoring an attack to a particular application's pattern of query plan reuse, user ID changes, and role-specific row security policies. The vulnerability is triggered by queries that involve subqueries, WITH queries, security invoker views, or SQL-language functions referencing tables with RLS policies in combination with query plan reuse and user ID changes via security definer functions or the use of SET ROLE across the same query.
- **Required attacker capabilities/position**: The attacker must have the ability to influence or control user ID changes within the application and be able to leverage query plan reuse. They also require knowledge of role-specific RLS policies defined in the system to tailor their attack. The CVSS score indicates that a low-privileged user can exploit it and there is no user interaction required.

This content provides more details than the official CVE description in terms of root cause, impacted scenarios, and the specific code constructs that are vulnerable. It also provides a more in-depth explanation of the attack vectors and required attacker capabilities.