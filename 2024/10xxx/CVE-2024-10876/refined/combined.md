=== Content from www.wordfence.com_b14a3787_20250115_090043.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Charitable – Donation Plugin for WordPress – Fundraising with Recurring Donations & More <= 1.8.3 - Reflected Cross-Site Scripting

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Charitable – Donation Plugin for WordPress – Fundraising with Recurring Donations & More <= 1.8.3 - Reflected Cross-Site Scripting

6.1

**Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N)

| CVE | [CVE-2024-10876](https://www.cve.org/CVERecord?id=CVE-2024-10876) |
| --- | --- |
| CVSS | 6.1 (Medium) |
| Publicly Published | November 8, 2024 |
| Last Updated | November 9, 2024 |
| Researcher | [Peter Thaleikis](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/spek) |

### Description

The Charitable – Donation Plugin for WordPress – Fundraising with Recurring Donations & More plugin for WordPress is vulnerable to Reflected Cross-Site Scripting due to the use of add\_query\_arg & remove\_query\_arg without appropriate escaping on the URL in all versions up to, and including, 1.8.3. This makes it possible for unauthenticated attackers to inject arbitrary web scripts in pages that execute if they can successfully trick a user into performing an action such as clicking on a link.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/charitable/tags/1.8.2/includes/admin/donations/class-charitable-donation-list-table.php#L318)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3183944/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcharitable%2Fcharitable-donation-plugin-for-wordpress-fundraising-with-recurring-donations-more-183-reflected-cross-site-scripting&t=Charitable%20%E2%80%93%20Donation%20Plugin%20for%20WordPress%20%E2%80%93%20Fundraising%20with%20Recurring%20Donations%20%26%20More%20%3C%3D%201.8.3%20-%20Reflected%20Cross-Site%20Scripting "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcharitable%2Fcharitable-donation-plugin-for-wordpress-fundraising-with-recurring-donations-more-183-reflected-cross-site-scripting&text=Charitable%20%E2%80%93%20Donation%20Plugin%20for%20WordPress%20%E2%80%93%20Fundraising%20with%20Recurring%20Donations%20%26%20More%20%3C%3D%201.8.3%20-%20Reflected%20Cross-Site%20Scripting "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcharitable%2Fcharitable-donation-plugin-for-wordpress-fundraising-with-recurring-donations-more-183-reflected-cross-site-scripting "LinkedIn")
Email

## Vulnerability Details for Charitable – Donation Plugin for WordPress – Fundraising with Recurring Donations & More

#### [Charitable – Donation Plugin for WordPress – Fundraising with Recurring Donations & More](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/charitable)

| Software Type | Plugin |
| --- | --- |
| Software Slug | charitable [(view on wordpress.org)](https://wordpress.org/plugins/charitable) |
| Patched? | Yes |
| Remediation | Update to version 1.8.3.1, or a newer patched version |
| Affected Version | * <= 1.8.3 |
| Patched Version | * 1.8.3.1 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_0b1fbfaa_20250115_090040.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fcharitable%2Ftags%2F1.8.2%2Fincludes%2Fadmin%2Fdonations%2Fclass-charitable-donation-list-table.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/charitable/tags/1.8.2/includes/admin/donations/class-charitable-donation-list-table.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/charitable/tags/1.8.2/includes/admin/donations/class-charitable-donation-list-table.php)

---

# [source:](/browser?order=name "Go to repository root") [charitable](/browser/charitable?order=name "View charitable")/[tags](/browser/charitable/tags?order=name "View tags")/[1.8.2](/browser/charitable/tags/1.8.2?order=name "View 1.8.2")/[includes](/browser/charitable/tags/1.8.2/includes?order=name "View includes")/[admin](/browser/charitable/tags/1.8.2/includes/admin?order=name "View admin")/[donations](/browser/charitable/tags/1.8.2/includes/admin/donations?order=name "View donations")/[class-charitable-donation-list-table.php](/browser/charitable/tags/1.8.2/includes/admin/donations/class-charitable-donation-list-table.php?order=name "View class-charitable-donation-list-table.php")

View diff against:

View revision:

| [Last change](/changeset/3170864/charitable/tags/1.8.2/includes/admin/donations/class-charitable-donation-list-table.php "View differences") on this file was [3170864](/changeset/3170864/ "View changeset 3170864"), checked in by dimensionmedia, [3 months ago](/timeline?from=2024-10-17T15%3A56%3A09Z&precision=second "See timeline at 10/17/2024 03:56:09 PM") |
| --- |
| Tagging version 1.8.2 |
| **File size:** 32.3 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Sets up the donations list table in the admin. |
| [4](#L4) | \* |
| [5](#L5) | \* @package   Charitable/Classes/Charitable\_Donation\_List\_Table |
| [6](#L6) | \* @author    David Bisset |
| [7](#L7) | \* @copyright Copyright (c) 2023, WP Charitable LLC |
| [8](#L8) | \* @license   http://opensource.org/licenses/gpl-2.0.php GNU Public License |
| [9](#L9) | \* @since     1.5.0 |
| [10](#L10) | \* @version   1.8.1.5 |
| [11](#L11) | \*/ |
| [12](#L12) |  |
| [13](#L13) | if ( ! defined( 'ABSPATH' ) ) { |
| [14](#L14) | exit; |
| [15](#L15) | } |
| [16](#L16) |  |
| [17](#L17) | if ( ! class\_exists( 'Charitable\_Donation\_List\_Table' ) ) : |
| [18](#L18) |  |
| [19](#L19) | /\*\* |
| [20](#L20) | \* Charitable\_Donation\_List\_Table class. |
| [21](#L21) | \* |
| [22](#L22) | \* @final |
| [23](#L23) | \* @since 1.5.0 |
| [24](#L24) | \*/ |
| [25](#L25) | final class Charitable\_Donation\_List\_Table { |
| [26](#L26) |  |
| [27](#L27) | /\*\* |
| [28](#L28) | \* The single instance of this class. |
| [29](#L29) | \* |
| [30](#L30) | \* @var Charitable\_Donation\_List\_Table|null |
| [31](#L31) | \*/ |
| [32](#L32) | private static $instance = null; |
| [33](#L33) |  |
| [34](#L34) | /\*\* |
| [35](#L35) | \* Post type. |
| [36](#L36) | \* |
| [37](#L37) | \* @var string |
| [38](#L38) | \*/ |
| [39](#L39) | protected $list\_table\_type = 'donation'; |
| [40](#L40) |  |
| [41](#L41) | /\*\* |
| [42](#L42) | \* Status counts. |
| [43](#L43) | \* |
| [44](#L44) | \* @var array |
| [45](#L45) | \*/ |
| [46](#L46) | private $status\_counts; |
| [47](#L47) |  |
| [48](#L48) | /\*\* |
| [49](#L49) | \* Create object instance. |
| [50](#L50) | \* |
| [51](#L51) | \* @since 1.5.0 |
| [52](#L52) | \*/ |
| [53](#L53) | public function \_\_construct() { |
| [54](#L54) | do\_action( 'charitable\_admin\_donation\_post\_type\_start', $this ); |
| [55](#L55) | } |
| [56](#L56) |  |
| [57](#L57) | /\*\* |
| [58](#L58) | \* Returns and/or create the single instance of this class. |
| [59](#L59) | \* |
| [60](#L60) | \* @since  1.5.0 |
| [61](#L61) | \* |
| [62](#L62) | \* @return Charitable\_Donation\_List\_Table |
| [63](#L63) | \*/ |
| [64](#L64) | public static function get\_instance() { |
| [65](#L65) | if ( is\_null( self::$instance ) ) { |
| [66](#L66) | self::$instance = new self(); |
| [67](#L67) | } |
| [68](#L68) |  |
| [69](#L69) | return self::$instance; |
| [70](#L70) | } |
| [71](#L71) |  |
| [72](#L72) | /\*\* |
| [73](#L73) | \* Customize donations columns. |
| [74](#L74) | \* |
| [75](#L75) | \* @see     get\_column\_headers |
| [76](#L76) | \* |
| [77](#L77) | \* @since   1.5.0 |
| [78](#L78) | \* |
| [79](#L79) | \* @return  array |
| [80](#L80) | \*/ |
| [81](#L81) | public function dashboard\_columns() { |
| [82](#L82) | /\*\* |
| [83](#L83) | \* Filter the columns shown in the donations list table. |
| [84](#L84) | \* |
| [85](#L85) | \* @since 1.0.0 |
| [86](#L86) | \* |
| [87](#L87) | \* @param array $columns The list of columns. |
| [88](#L88) | \*/ |
| [89](#L89) | return apply\_filters( |
| [90](#L90) | 'charitable\_donation\_dashboard\_column\_names', |
| [91](#L91) | array( |
| [92](#L92) | 'cb'            => '<input type="checkbox"/>', |
| [93](#L93) | 'id'            => \_\_( 'Donation', 'charitable' ), |
| [94](#L94) | 'amount'        => \_\_( 'Amount Donated', 'charitable' ), |
| [95](#L95) | 'campaigns'     => \_\_( 'Campaign(s)', 'charitable' ), |
| [96](#L96) | 'donation\_date' => \_\_( 'Date', 'charitable' ), |
| [97](#L97) | 'post\_status'   => \_\_( 'Status', 'charitable' ), |
| [98](#L98) | ) |
| [99](#L99) | ); |
| [100](#L100) | } |
| [101](#L101) |  |
| [102](#L102) | /\*\* |
| [103](#L103) | \* Add information to the dashboard donations table listing. |
| [104](#L104) | \* |
| [105](#L105) | \* @see    WP\_Posts\_List\_Table::single\_row() |
| [106](#L106) | \* |
| [107](#L107) | \* @since  1.5.0 |
| [108](#L108) | \* |
| [109](#L109) | \* @param  string $column\_name The name of the column to display. |
| [110](#L110) | \* @param  int    $post\_id     The current post ID. |
| [111](#L111) | \* @return void |
| [112](#L112) | \*/ |
| [113](#L113) | public function dashboard\_column\_item( $column\_name, $post\_id ) { |
| [114](#L114) | $donation = charitable\_get\_donation( $post\_id ); |
| [115](#L115) |  |
| [116](#L116) | switch ( $column\_name ) { |
| [117](#L117) |  |
| [118](#L118) | case 'id': |
| [119](#L119) | $title = esc\_attr\_\_( 'View Donation Details', 'charitable' ); |
| [120](#L120) | $name  = $donation->get\_donor()->get\_name(); |
| [121](#L121) | $email = $donation->get\_donor()->get\_email(); |
| [122](#L122) |  |
| [123](#L123) | if ( $name ) { |
| [124](#L124) | $text = sprintf( |
| [125](#L125) | \_x( '#%1$d by %2$s', 'number symbol', 'charitable' ), |
| [126](#L126) | $post\_id, |
| [127](#L127) | $name |
| [128](#L128) | ); |
| [129](#L129) | if ( $email ) { |
| [130](#L130) | $text .= '<br/>' . sprintf( |
| [131](#L131) | \_x( '%1$s', 'email', 'charitable' ), |
| [132](#L132) | $email |
| [133](#L133) | ); |
| [134](#L134) | } |
| [135](#L135) | } else { |
| [136](#L136) | $text = sprintf( |
| [137](#L137) | \_x( '#%d', 'number symbol', 'charitable' ), |
| [138](#L138) | $post\_id |
| [139](#L139) | ); |
| [140](#L140) | } |
| [141](#L141) |  |
| [142](#L142) | $url = esc\_url( |
| [143](#L143) | add\_query\_arg( |
| [144](#L144) | array( |
| [145](#L145) | 'post'   => $post\_id, |
| [146](#L146) | 'action' => 'edit', |
| [147](#L147) | ), |
| [148](#L148) | admin\_url( 'post.php' ) |
| [149](#L149) | ) |
| [150](#L150) | ); |
| [151](#L151) |  |
| [152](#L152) | $display = sprintf( '<a href="%s" aria-label="%s">%s</a>', $url, $title, $text ); |
| [153](#L153) | break; |
| [154](#L154) |  |
| [155](#L155) | case 'post\_status': |
| [156](#L156) | $display = sprintf( |
| [157](#L157) | '<mark class="status %s">%s</mark>', |
| [158](#L158) | esc\_attr( $donation->get\_status() ), |
| [159](#L159) | strtolower( $donation->get\_status\_label() ) |
| [160](#L160) | ); |
| [161](#L161) | break; |
| [162](#L162) |  |
| [163](#L163) | case 'amount': |
| [164](#L164) | $display  = charitable\_format\_money( $donation->get\_total\_donation\_amount(), false, false, $donation->get\_currency() ); |
| [165](#L165) | $display .= '<span class="meta">' . sprintf( \_x( 'via %s', 'charitable' ), $donation->get\_gateway\_label() ) . '</span>'; |
| [166](#L166) | break; |
| [167](#L167) |  |
| [168](#L168) | case 'campaigns': |
| [169](#L169) | $campaigns = array(); |
| [170](#L170) |  |
| [171](#L171) | foreach ( $donation->get\_campaign\_donations() as $cd ) { |
| [172](#L172) | $campaigns[] = sprintf( |
| [173](#L173) | '<a href="edit.php?post\_type=%s&campaign\_id=%s">%s</a>', |
| [174](#L174) | Charitable::DONATION\_POST\_TYPE, |
| [175](#L175) | $cd->campaign\_id, |
| [176](#L176) | $cd->campaign\_name |
| [177](#L177) | ); |
| [178](#L178) | } |
| [179](#L179) |  |
| [180](#L180) | $display = implode( ', ', $campaigns ); |
| [181](#L181) | break; |
| [182](#L182) |  |
| [183](#L183) | case 'donation\_date': |
| [184](#L184) | $display = $donation->get\_date(); |
| [185](#L185) | if ( ! defined( 'CHARITABLE\_DONATIONS\_LIST\_SHOW\_DONATION\_TIME' ) || ( defined( 'CHARITABLE\_DONATIONS\_LIST\_SHOW\_DONATION\_TIME' ) && CHARITABLE\_DONATIONS\_LIST\_SHOW\_DONATION\_TIME ) ) { |
| [186](#L186) | $display .= ' <span>' . $donation->get\_time() . '</span>'; |
| [187](#L187) | } |
| [188](#L188) | break; |
| [189](#L189) |  |
| [190](#L190) | default: |
| [191](#L191) | $display = ''; |
| [192](#L192) | break; |
| [193](#L193) |  |
| [194](#L194) | } |
| [195](#L195) |  |
| [196](#L196) | /\*\* |
| [197](#L197) | \* Filter the output of the cell. |
| [198](#L198) | \* |
| [199](#L199) | \* @since 1.0.0 |
| [200](#L200) | \* |
| [201](#L201) | \* @param string              $display     The content that will be displayed. |
| [202](#L202) | \* @param string              $column\_name The name of the column. |
| [203](#L203) | \* @param int                 $post\_id     The ID of the donation being shown. |
| [204](#L204) | \* @param Charitable\_Donation $donation    The Charitable\_Donation object. |
| [205](#L205) | \*/ |
| [206](#L206) | echo apply\_filters( 'charitable\_donation\_column\_display', $display, $column\_name, $post\_id, $donation ); |
| [207](#L207) | } |
| [208](#L208) |  |
| [209](#L209) | /\*\* |
| [210](#L210) | \* Make columns sortable. |
| [211](#L211) | \* |
| [212](#L212) | \* @since  1.5.0 |
| [213](#L213) | \* |
| [214](#L214) | \* @param  array $columns List of columns that are sortable by default. |
| [215](#L215) | \* @return array |
| [216](#L216) | \*/ |
| [217](#L217) | public function sortable\_columns( $columns ) { |
| [218](#L218) | $sortable\_columns = array( |
| [219](#L219) | 'id'            => 'ID', |
| [220](#L220) | 'amount'        => 'amount', |
| [221](#L221) | 'donation\_date' => 'date', |
| [222](#L222) | ); |
| [223](#L223) |  |
| [224](#L224) | return wp\_parse\_args( $sortable\_columns, $columns ); |
| [225](#L225) | } |
| [226](#L226) |  |
| [227](#L227) | /\*\* |
| [228](#L228) | \* Set list table primary column for donations. |
| [229](#L229) | \* |
| [230](#L230) | \* Support for WordPress 4.3. |
| [231](#L231) | \* |
| [232](#L232) | \* @since  1.5.0 |
| [233](#L233) | \* |
| [234](#L234) | \* @param  string $default |
| [235](#L235) | \* @param  string $screen\_id |
| [236](#L236) | \* @return string |
| [237](#L237) | \*/ |
| [238](#L238) | public function primary\_column( $default, $screen\_id ) { |
| [239](#L239) | if ( 'edit-donation' === $screen\_id ) { |
| [240](#L240) | return 'id'; |
| [241](#L241) | } |
| [242](#L242) |  |
| [243](#L243) | return $default; |
| [244](#L244) | } |
| [245](#L245) |  |
| [246](#L246) | /\*\* |
| [247](#L247) | \* Set row actions for donations. |
| [248](#L248) | \* |
| [249](#L249) | \* @since  1.5.0 |
| [250](#L250) | \* |
| [251](#L251) | \* @param  array   $actions |
| [252](#L252) | \* @param  WP\_Post $post |
| [253](#L253) | \* @return array |
| [254](#L254) | \*/ |
| [255](#L255) | public function row\_actions( $actions, $post ) { |
| [256](#L256) | if ( Charitable::DONATION\_POST\_TYPE !== $post->post\_type ) { |
| [257](#L257) | return $actions; |
| [258](#L258) | } |
| [259](#L259) |  |
| [260](#L260) | if ( isset( $actions['inline hide-if-no-js'] ) ) { |
| [261](#L261) | unset( $actions['inline hide-if-no-js'] ); |
| [262](#L262) | } |
| [263](#L263) |  |
| [264](#L264) | $actions['edit'] = sprintf( |
| [265](#L265) | '<a href="%s" aria-label="%s">%s</a>', |
| [266](#L266) | esc\_url( |
| [267](#L267) | add\_query\_arg( |
| [268](#L268) | array( |
| [269](#L269) | 'post'      => $post->ID, |
| [270](#L270) | 'action'    => 'edit', |
| [271](#L271) | 'show\_form' => true, |
| [272](#L272) | ), |
| [273](#L273) | admin\_url( 'post.php' ) |
| [274](#L274) | ) |
| [275](#L275) | ), |
| [276](#L276) | esc\_attr\_\_( 'Edit Donation', 'charitable' ), |
| [277](#L277) | \_\_( 'Edit', 'charitable' ) |
| [278](#L278) | ); |
| [279](#L279) |  |
| [280](#L280) | $actions = array\_merge( |
| [281](#L281) | array( |
| [282](#L282) | 'view' => sprintf( |
| [283](#L283) | '<a href="%s" aria-label="%s">%s</a>', |
| [284](#L284) | esc\_url( |
| [285](#L285) | add\_query\_arg( |
| [286](#L286) | array( |
| [287](#L287) | 'post'   => $post->ID, |
| [288](#L288) | 'action' => 'edit', |
| [289](#L289) | ), |
| [290](#L290) | admin\_url( 'post.php' ) |
| [291](#L291) | ) |
| [292](#L292) | ), |
| [293](#L293) | esc\_attr\_\_( 'View Details', 'charitable' ), |
| [294](#L294) | \_\_( 'View', 'charitable' ) |
| [295](#L295) | ), |
| [296](#L296) | ), |
| [297](#L297) | $actions |
| [298](#L298) | ); |
| [299](#L299) |  |
| [300](#L300) | return $actions; |
| [301](#L301) | } |
| [302](#L302) |  |
| [303](#L303) | /\*\* |
| [304](#L304) | \* Customize the output of the status views. |
| [305](#L305) | \* |
| [306](#L306) | \* @since  1.5.0 |
| [307](#L307) | \* |
| [308](#L308) | \* @param  string[] $views The default list of status views. |
| [309](#L309) | \* @return string[] |
| [310](#L310) | \*/ |
| [311](#L311) | public function set\_status\_views( $views ) { |
| [312](#L312) | $counts  = $this->get\_status\_counts(); |
| [313](#L313) | $current = array\_key\_exists( 'post\_status', $\_GET ) ? $\_GET['post\_status'] : ''; |
| [314](#L314) |  |
| [315](#L315) | foreach ( charitable\_get\_valid\_donation\_statuses() as $key => $label ) { |
| [316](#L316) | $views[ $key ] = sprintf( |
| [317](#L317) | '<a href="%s"%s>%s <span class="count">(%d)</span></a>', |
| [318](#L318) | add\_query\_arg( |
| [319](#L319) | array( |
| [320](#L320) | 'post\_status' => $key, |
| [321](#L321) | 'paged'       => false, |
| [322](#L322) | ) |
| [323](#L323) | ), |
| [324](#L324) | $current === $key ? ' class="current"' : '', |
| [325](#L325) | $label, |
| [326](#L326) | array\_key\_exists( $key, $counts ) ? $counts[ $key ] : '0' |
| [327](#L327) | ); |
| [328](#L328) | } |
| [329](#L329) |  |
| [330](#L330) | $views['all'] = sprintf( |
| [331](#L331) | '<a href="%s"%s>%s <span class="count">(%d)</span></a>', |
| [332](#L332) | remove\_query\_arg( array( 'post\_status', 'paged' ) ), |
| [333](#L333) | 'all' === $current || '' === $current ? ' class="current"' : '', |
| [334](#L334) | \_\_( 'All', 'charitable' ), |
| [335](#L335) | array\_sum( $counts ) |
| [336](#L336) | ); |
| [337](#L337) |  |
| [338](#L338) | unset( $views['mine'] ); |
| [339](#L339) |  |
| [340](#L340) | return $views; |
| [341](#L341) | } |
| [342](#L342) |  |
| [343](#L343) | /\*\* |
| [344](#L344) | \* Add Custom bulk actions |
| [345](#L345) | \* |
| [346](#L346) | \* @param   array $actions The list of bulk actions. |
| [347](#L347) | \* @return  array |
| [348](#L348) | \* @since   1.5.0 |
| [349](#L349) | \*/ |
| [350](#L350) | public function custom\_bulk\_actions( $actions ) { |
| [351](#L351) | if ( isset( $actions['edit'] ) ) { |
| [352](#L352) | unset( $actions['edit'] ); |
| [353](#L353) | } |
| [354](#L354) |  |
| [355](#L355) | return array\_merge( $actions, $this->get\_bulk\_actions() ); |
| [356](#L356) | } |
| [357](#L357) |  |
| [358](#L358) | /\*\* |
| [359](#L359) | \* Process bulk actions |
| [360](#L360) | \* |
| [361](#L361) | \* @param   int    $redirect\_to |
| [362](#L362) | \* @param   string $action |
| [363](#L363) | \* @param   int[]  $post\_ids |
| [364](#L364) | \* @return  string |
| [365](#L365) | \* @since   1.5.0 |
| [366](#L366) | \*/ |
| [367](#L367) | public function bulk\_action\_handler( $redirect\_to, $action, $post\_ids ) { |
| [368](#L368) | /\* Bail out if this is not a status-changing action. \*/ |
| [369](#L369) | if ( strpos( $action, 'set-' ) === false ) { |
| [370](#L370) | $sendback = remove\_query\_arg( array( 'trashed', 'untrashed', 'deleted', 'locked', 'ids' ), wp\_get\_referer() ); |
| [371](#L371) | wp\_redirect( esc\_url\_raw( $sendback ) ); |
| [372](#L372) |  |
| [373](#L373) | exit(); |
| [374](#L374) | } |
| [375](#L375) |  |
| [376](#L376) | $donation\_statuses = charitable\_get\_valid\_donation\_statuses(); |
| [377](#L377) |  |
| [378](#L378) | $new\_status    = str\_replace( 'set-', '', $action ); // get the status name from action. |
| [379](#L379) | $report\_action = 'bulk\_' . Charitable::DONATION\_POST\_TYPE . '\_status\_update'; |
| [380](#L380) |  |
| [381](#L381) | /\*\* |
| [382](#L382) | \* Sanity check: bail out if this is actually not a status, or is |
| [383](#L383) | \* not a registered status. |
| [384](#L384) | \*/ |
| [385](#L385) | if ( ! isset( $donation\_statuses[ $new\_status ] ) ) { |
| [386](#L386) | return $redirect\_to; |
| [387](#L387) | } |
| [388](#L388) |  |
| [389](#L389) | foreach ( $post\_ids as $post\_id ) { |
| [390](#L390) | $donation = charitable\_get\_donation( $post\_id ); |
| [391](#L391) | $donation->update\_status( $new\_status ); |
| [392](#L392) |  |
| [393](#L393) | do\_action( 'charitable\_donations\_table\_do\_bulk\_action', $post\_id, $new\_status ); |
| [394](#L394) | } |
| [395](#L395) |  |
| [396](#L396) | $redirect\_to = add\_query\_arg( $report\_action, count( $post\_ids ), $redirect\_to ); |
| [397](#L397) |  |
| [398](#L398) | return $redirect\_to; |
| [399](#L399) | } |
| [400](#L400) |  |
| [401](#L401) |  |
| [402](#L402) | /\*\* |
| [403](#L403) | \* Remove edit from the bulk actions. |
| [404](#L404) | \* |
| [405](#L405) | \* @since  1.5.0 |
| [406](#L406) | \* |
| [407](#L407) | \* @param  array $actions List of bulk actions. |
| [408](#L408) | \* @return array |
| [409](#L409) | \*/ |
| [410](#L410) | public function remove\_bulk\_actions( $actions ) { |
| [411](#L411) | if ( isset( $actions['edit'] ) ) { |
| [412](#L412) | unset( $actions['edit'] ); |
| [413](#L413) | } |
| [414](#L414) |  |
| [415](#L415) | return $actions; |
| [416](#L416) | } |
| [417](#L417) |  |
| [418](#L418) | /\*\* |
| [419](#L419) | \* Retrieve the bulk actions. |
| [420](#L420) | \* |
| [421](#L421) | \* @since  1.5.0 |
| [422](#L422) | \* |
| [423](#L423) | \* @return array $actions Array of the bulk actions |
| [424](#L424) | \*/ |
| [425](#L425) | public function get\_bulk\_actions() { |
| [426](#L426) | $actions = array(); |
| [427](#L427) |  |
| [428](#L428) | foreach ( charitable\_get\_valid\_donation\_statuses() as $status\_key => $label ) { |
| [429](#L429) | $actions[ 'set-' . $status\_key ] = sprintf( \_x( 'Set to %s', 'set donation status to x', 'charitable' ), $label ); |
| [430](#L430) | } |
| [431](#L431) |  |
| [432](#L432) | /\*\* |
| [433](#L433) | \* Filter the list of bulk actions for donations. |
| [434](#L434) | \* |
| [435](#L435) | \* @since 1.4.0 |
| [436](#L436) | \* |
| [437](#L437) | \* @param array $actions The list of bulk actions. |
| [438](#L438) | \*/ |
| [439](#L439) | return apply\_filters( 'charitable\_donations\_table\_bulk\_actions', $actions ); |
| [440](#L440) | } |
| [441](#L441) |  |
| [442](#L442) | /\*\* |
| [443](#L443) | \* Add extra bulk action options to mark orders as complete or processing. |
| [444](#L444) | \* |
| [445](#L445) | \* Using Javascript until WordPress core fixes: https://core.trac.wordpress.org/ticket/16031 |
| [446](#L446) | \* |
| [447](#L447) | \* @since  1.5.0 |
| [448](#L448) | \* |
| [449](#L449) | \* @global string $post\_type |
| [450](#L450) | \* |
| [451](#L451) | \* @return void |
| [452](#L452) | \*/ |
| [453](#L453) | public function bulk\_admin\_footer() { |
| [454](#L454) | global $post\_type; |
| [455](#L455) |  |
| [456](#L456) | if ( Charitable::DONATION\_POST\_TYPE == $post\_type ) { |
| [457](#L457) |  |
| [458](#L458) | $js  = '<script type="text/javascript">'; |
| [459](#L459) | $js .= '(function($) {'; |
| [460](#L460) | foreach ( $this->get\_bulk\_actions() as $status\_key => $label ) { |
| [461](#L461) | $js .= sprintf( "jQuery('<option>').val('%s').text('%s').appendTo( [ '#bulk-action-selector-top', '#bulk-action-selector-bottom' ] );", $status\_key, $label ); |
| [462](#L462) | } |
| [463](#L463) | $js .= '})(jQuery);'; |
| [464](#L464) | $js .= '</script>'; |
| [465](#L465) |  |
| [466](#L466) | echo $js; |
| [467](#L467) | } |
| [468](#L468) | } |
| [469](#L469) |  |
| [470](#L470) | /\*\* |
| [471](#L471) | \* Process the new bulk actions for changing order status. |
| [472](#L472) | \* |
| [473](#L473) | \* @since  1.5.0 |
| [474](#L474) | \* |
| [475](#L475) | \* @return void |
| [476](#L476) | \*/ |
| [477](#L477) | public function process\_bulk\_action() { |
| [478](#L478) | /\* We only want to deal with donations. In case any other CPTs have an 'active' action. \*/ |
| [479](#L479) | if ( ! isset( $\_REQUEST['post\_type'] ) || Charitable::DONATION\_POST\_TYPE !== $\_REQUEST['post\_type'] || ! isset( $\_REQUEST['post'] ) ) { |
| [480](#L480) | return; |
| [481](#L481) | } |
| [482](#L482) |  |
| [483](#L483) | check\_admin\_referer( 'bulk-posts' ); |
| [484](#L484) |  |
| [485](#L485) | /\* Get the action. \*/ |
| [486](#L486) | $action = ''; |
| [487](#L487) |  |
| [488](#L488) | if ( isset( $\_REQUEST['action'] ) && -1 != $\_REQUEST['action'] ) { |
| [489](#L489) | $action = $\_REQUEST['action']; |
| [490](#L490) | } elseif ( isset( $\_REQUEST['action2'] ) && -1 != $\_REQUEST['action2'] ) { |
| [491](#L491) | $action = $\_REQUEST['action2']; |
| [492](#L492) | } |
| [493](#L493) |  |
| [494](#L494) | $post\_ids    = array\_map( 'absint', (array) $\_REQUEST['post'] ); |
| [495](#L495) | $redirect\_to = add\_query\_arg( |
| [496](#L496) | array( |
| [497](#L497) | 'post\_type' => Charitable::DONATION\_POST\_TYPE, |
| [498](#L498) | ), |
| [499](#L499) | admin\_url( 'edit.php' ) |
| [500](#L500) | ); |
| [501](#L501) | $redirect\_to = $this->bulk\_action\_handler( $redirect\_to, $action, $post\_ids ); |
| [502](#L502) |  |
| [503](#L503) | wp\_redirect( esc\_url\_raw( $redirect\_to ) ); |
| [504](#L504) |  |
| [505](#L505) | exit(); |
| [506](#L506) | } |
| [507](#L507) |  |
| [508](#L508) | /\*\* |
| [509](#L509) | \* Show confirmation message that order status changed for number of orders. |
| [510](#L510) | \* |
| [511](#L511) | \* @since  1.5.0 |
| [512](#L512) | \* |
| [513](#L513) | \* @global string $post\_type |
| [514](#L514) | \* @global string $pagenow |
| [515](#L515) | \* |
| [516](#L516) | \* @return void |
| [517](#L517) | \*/ |
| [518](#L518) | public function bulk\_admin\_notices() { |
| [519](#L519) | global $post\_type, $pagenow; |
| [520](#L520) |  |
| [521](#L521) | /\* Bail out if not on shop order list page. \*/ |
| [522](#L522) | if ( 'edit.php' !== $pagenow || Charitable::DONATION\_POST\_TYPE !== $post\_type ) { |
| [523](#L523) | return; |
| [524](#L524) | } |
| [525](#L525) |  |
| [526](#L526) | /\* Check if any status changes happened. \*/ |
| [527](#L527) | $report\_action = 'bulk\_' . Charitable::DONATION\_POST\_TYPE . '\_status\_update'; |
| [528](#L528) |  |
| [529](#L529) | if ( ! empty( $\_REQUEST[ $report\_action ] ) ) { |
| [530](#L530) | $number  = absint( $\_REQUEST[ $report\_action ] ); |
| [531](#L531) | $message = sprintf( \_n( 'Donation status changed.', '%s donation statuses changed.', $number, 'charitable' ), number\_format\_i18n( $number ) ); |
| [532](#L532) | echo '<div class="updated"><p>' . $message . '</p></div>'; |
| [533](#L533) | } |
| [534](#L534) | } |
| [535](#L535) |  |
| [536](#L536) | /\*\* |
| [537](#L537) | \* Change messages when a post type is updated. |
| [538](#L538) | \* |
| [539](#L539) | \* @since  1.5.0 |
| [540](#L540) | \* @version 1.8.1.15 |
| [541](#L541) | \* |
| [542](#L542) | \* @global WP\_Post $post |
| [543](#L543) | \* @global int     $post\_ID |
| [544](#L544) | \* @param  array $messages The default list of messages. |
| [545](#L545) | \* @return array |
| [546](#L546) | \*/ |
| [547](#L547) | public function post\_messages( $messages ) { |
| [548](#L548) | global $post, $post\_ID; |
| [549](#L549) |  |
| [550](#L550) | $messages[ Charitable::DONATION\_POST\_TYPE ] = array( |
| [551](#L551) | 0  => '', // Unused. Messages start at index 1. |
| [552](#L552) | 1  => sprintf( \_\_( 'Donation updated. <a href="%s">View Donation</a>', 'charitable' ), esc\_url( get\_permalink( $post\_ID ) ) ), |
| [553](#L553) | 2  => \_\_( 'Custom field updated.', 'charitable' ), |
| [554](#L554) | 3  => \_\_( 'Custom field deleted.', 'charitable' ), |
| [555](#L555) | 4  => \_\_( 'Donation updated.', 'charitable' ), |
| [556](#L556) | 5  => isset( $\_GET['revision'] ) ? sprintf( \_\_( 'Donation restored to revision from %s', 'charitable' ), wp\_post\_revision\_title( (int) $\_GET['revision'], false ) ) : false, |
| [557](#L557) | 6  => sprintf( \_\_( 'Donation published. <a href="%s">View Donation</a>', 'charitable' ), esc\_url( get\_permalink( $post\_ID ) ) ), |
| [558](#L558) | 7  => \_\_( 'Donation saved.', 'charitable' ), |
| [559](#L559) | 8  => sprintf( |
| [560](#L560) | \_\_( 'Donation submitted. <a target="\_blank" href="%s">Preview Donation</a>', 'charitable' ), |
| [561](#L561) | esc\_url( add\_query\_arg( 'preview', 'true', get\_permalink( $post\_ID ) ) ) |
| [562](#L562) | ), |
| [563](#L563) | 9  => sprintf( |
| [564](#L564) | \_\_( 'Donation scheduled for: <strong>%1$s</strong>. <a target="\_blank" href="%2$s">Preview Donation</a>', 'charitable' ), |
| [565](#L565) | date\_i18n( 'M j, Y @ G:i', strtotime( $post->post\_date ) ), |
| [566](#L566) | esc\_url( get\_permalink( $post\_ID ) ) |
| [567](#L567) | ), |
| [568](#L568) | 10 => sprintf( |
| [569](#L569) | \_\_( 'Donation draft updated. <a target="\_blank" href="%s">Preview Donation</a>', 'charitable' ), |
| [570](#L570) | esc\_url( add\_query\_arg( 'preview', 'true', get\_permalink( $post\_ID ) ) ) |
| [571](#L571) | ), |
| [572](#L572) | 11 => \_\_( 'Donation updated and email sent.', 'charitable' ), |
| [573](#L573) | 12 => \_\_( 'Email could not be sent.', 'charitable' ), |
| [574](#L574) | ); |
| [575](#L575) |  |
| [576](#L576) | return $messages; |
| [577](#L577) | } |
| [578](#L578) |  |
| [579](#L579) | /\*\* |
| [580](#L580) | \* Modify bulk messages |
| [581](#L581) | \* |
| [582](#L582) | \* @since  1.5.0 |
| [583](#L583) | \* |
| [584](#L584) | \* @param  array $bulk\_messages |
| [585](#L585) | \* @param  array $bulk\_counts |
| [586](#L586) | \* @return array |
| [587](#L587) | \*/ |
| [588](#L588) | public function bulk\_messages( $bulk\_messages, $bulk\_counts ) { |
| [589](#L589) | $bulk\_messages[ Charitable::DONATION\_POST\_TYPE ] = array( |
| [590](#L590) | 'updated'   => \_n( '%d donation updated.', '%d donations updated.', $bulk\_counts['updated'], 'charitable' ), |
| [591](#L591) | 'locked'    => ( 1 == $bulk\_counts['locked'] ) ? \_\_( '1 donation not updated, somebody is editing it.' ) : |
| [592](#L592) | \_n( '%s donation not updated, somebody is editing it.', '%s donations not updated, somebody is editing them.', $bulk\_counts['locked'], 'charitable' ), |
| [593](#L593) | 'deleted'   => \_n( '%s donation permanently deleted.', '%s donations permanently deleted.', $bulk\_counts['deleted'], 'charitable' ), |
| [594](#L594) | 'trashed'   => \_n( '%s donation moved to the Trash.', '%s donations moved to the Trash.', $bulk\_counts['trashed'], 'charitable' ), |
| [595](#L595) | 'untrashed' => \_n( '%s donation restored from the Trash.', '%s donations restored from the Trash.', $bulk\_counts['untrashed'], 'charitable' ), |
| [596](#L596) | ); |
| [597](#L597) |  |
| [598](#L598) | return $bulk\_messages; |
| [599](#L599) | } |
| [600](#L600) |  |
| [601](#L601) | /\*\* |
| [602](#L602) | \* Disable the month's dropdown (will replace with custom range search). |
| [603](#L603) | \* |
| [604](#L604) | \* @since  1.5.0 |
| [605](#L605) | \* |
| [606](#L606) | \* @param  mixed  $public\_query\_vars Public query vars. Unused. |
| [607](#L607) | \* @param  string $post\_type         The current post type. |
| [608](#L608) | \* @return boolean |
| [609](#L609) | \*/ |
| [610](#L610) | public function disable\_months\_dropdown( $disable, $post\_type ) { |
| [611](#L611) | if ( Charitable::DONATION\_POST\_TYPE == $post\_type ) { |
| [612](#L612) | $disable = true; |
| [613](#L613) | } |
| [614](#L614) |  |
| [615](#L615) | return $disable; |
| [616](#L616) | } |
| [617](#L617) |  |
| [618](#L618) | /\*\* |
| [619](#L619) | \* Add date-based filters above the donations table. |
| [620](#L620) | \* |
| [621](#L621) | \* @since  1.5.0 |
| [622](#L622) | \* |
| [623](#L623) | \* @global string $typenow The current post type. |
| [624](#L624) | \* |
| [625](#L625) | \* @return void |
| [626](#L626) | \*/ |
| [627](#L627) | public function add\_filters() { |
| [628](#L628) | global $typenow; |
| [629](#L629) |  |
| [630](#L630) | /\* Show custom filters to filter orders by donor. \*/ |
| [631](#L631) | if ( in\_array( $typenow, array( Charitable::DONATION\_POST\_TYPE ) ) ) { |
| [632](#L632) | charitable\_admin\_view( 'donations-page/filters' ); |
| [633](#L633) | } |
| [634](#L634) | } |
| [635](#L635) |  |
| [636](#L636) | /\*\* |
| [637](#L637) | \* Add extra buttons after filters |
| [638](#L638) | \* |
| [639](#L639) | \* @since  1.5.0 |
| [640](#L640) | \* |
| [641](#L641) | \* @global string $typenow The current post type. |
| [642](#L642) | \* |
| [643](#L643) | \* @param  string $which The context where this is being called. |
| [644](#L644) | \* @return void |
| [645](#L645) | \*/ |
| [646](#L646) | public function add\_export( $which ) { |
| [647](#L647) | global $typenow; |
| [648](#L648) |  |
| [649](#L649) | if ( ! current\_user\_can( 'export\_charitable\_reports' ) ) { |
| [650](#L650) | return; |
| [651](#L651) | } |
| [652](#L652) |  |
| [653](#L653) | /\* Add the export button. \*/ |
| [654](#L654) | if ( 'top' == $which && in\_array( $typenow, array( Charitable::DONATION\_POST\_TYPE ) ) ) { |
| [655](#L655) | charitable\_admin\_view( 'donations-page/export' ); |
| [656](#L656) | } |
| [657](#L657) | } |
| [658](#L658) |  |
| [659](#L659) | /\*\* |
| [660](#L660) | \* Add modal template to footer. |
| [661](#L661) | \* |
| [662](#L662) | \* @since  1.5.0 |
| [663](#L663) | \* |
| [664](#L664) | \* @global string $typenow The current post type. |
| [665](#L665) | \* @global string $pagenow The current page. |
| [666](#L666) | \* |
| [667](#L667) | \* @return void |
| [668](#L668) | \*/ |
| [669](#L669) | public function modal\_forms() { |
| [670](#L670) | global $typenow, $pagenow; |
| [671](#L671) |  |
| [672](#L672) | /\* Add the modal form. \*/ |
| [673](#L673) | if ( 'edit.php' === $pagenow && in\_array( $typenow, array( Charitable::DONATION\_POST\_TYPE ), true ) ) { |
| [674](#L674) | charitable\_admin\_view( 'donations-page/export-form' ); |
| [675](#L675) | charitable\_admin\_view( 'donations-page/filter-form' ); |
| [676](#L676) | } |
| [677](#L677) | } |
| [678](#L678) |  |
| [679](#L679) | /\*\* |
| [680](#L680) | \* Admin scripts and styles. |
| [681](#L681) | \* |
| [682](#L682) | \* Set up the scripts & styles used for the modal. |
| [683](#L683) | \* |
| [684](#L684) | \* @since  1.5.0 |
| [685](#L685) | \* |
| [686](#L686) | \* @global string $typenow The current post type. |
| [687](#L687) | \* |
| [688](#L688) | \* @param  string $hook The current page hook. |
| [689](#L689) | \* @return void |
| [690](#L690) | \*/ |
| [691](#L691) | public function load\_scripts( $hook ) { |
| [692](#L692) | if ( 'edit.php' !== $hook ) { |
| [693](#L693) | return; |
| [694](#L694) | } |
| [695](#L695) |  |
| [696](#L696) | global $typenow; |
| [697](#L697) |  |
| [698](#L698) | /\* Enqueue the scripts for donation page \*/ |
| [699](#L699) | if ( in\_array( $typenow, array( Charitable::DONATION\_POST\_TYPE ), true ) ) { |
| [700](#L700) | wp\_enqueue\_style( 'lean-modal-css' ); |
| [701](#L701) | wp\_enqueue\_script( 'jquery' ); |
| [702](#L702) | wp\_enqueue\_script( 'lean-modal' ); |
| [703](#L703) | wp\_enqueue\_script( 'charitable-admin-tables' ); |
| [704](#L704) | } |
| [705](#L705) | } |
| [706](#L706) |  |
| [707](#L707) | /\*\* |
| [708](#L708) | \* Add custom filters to the query that returns the donations to be displayed. |
| [709](#L709) | \* |
| [710](#L710) | \* @since  1.5.0 |
| [711](#L711) | \* |
| [712](#L712) | \* @global string $typenow The current post type. |
| [713](#L713) | \* @global string $pagenow The current admin page. |
| [714](#L714) | \* |
| [715](#L715) | \* @param  array $vars The array of args to pass to WP\_Query. |
| [716](#L716) | \* @return array |
| [717](#L717) | \*/ |
| [718](#L718) | public function filter\_request\_query( $vars ) { |
| [719](#L719) | global $typenow, $pagenow; |
| [720](#L720) |  |
| [721](#L721) | if ( 'edit.php' !== $pagenow || Charitable::DONATION\_POST\_TYPE !== $typenow ) { |
| [722](#L722) | return $vars; |
| [723](#L723) | } |
| [724](#L724) |  |
| [725](#L725) | /\* No Status: fix WP's crappy handling of "all" post status. \*/ |
| [726](#L726) | if ( ! isset( $vars['post\_status'] ) || empty( $vars['post\_status'] ) ) { |
| [727](#L727) | $vars['post\_status'] = array\_keys( charitable\_get\_valid\_donation\_statuses() ); |
| [728](#L728) | } |
| [729](#L729) |  |
| [730](#L730) | if ( isset( $\_GET['charitable\_nonce'] ) && wp\_verify\_nonce( $\_GET['charitable\_nonce'], 'charitable\_filter\_campaigns' ) ) : |
| [731](#L731) |  |
| [732](#L732) | /\* Set up date query \*/ |
| [733](#L733) | if ( isset( $\_GET['start\_date'] ) && ! empty( $\_GET['start\_date'] ) ) { |
| [734](#L734) | $start\_date                  = $this->get\_parsed\_date( $\_GET['start\_date'] ); |
| [735](#L735) | $vars['date\_query']['after'] = array( |
| [736](#L736) | 'year'  => $start\_date['year'], |
| [737](#L737) | 'month' => $start\_date['month'], |
| [738](#L738) | 'day'   => $start\_date['day'], |
| [739](#L739) | ); |
| [740](#L740) | } |
| [741](#L741) |  |
| [742](#L742) | if ( isset( $\_GET['end\_date'] ) && ! empty( $\_GET['end\_date'] ) ) { |
| [743](#L743) | $end\_date                     = $this->get\_parsed\_date( $\_GET['end\_date'] ); |
| [744](#L744) | $vars['date\_query']['before'] = array( |
| [745](#L745) | 'year'  => $end\_date['year'], |
| [746](#L746) | 'month' => $end\_date['month'], |
| [747](#L747) | 'day'   => $end\_date['day'], |
| [748](#L748) | ); |
| [749](#L749) | } |
| [750](#L750) |  |
| [751](#L751) | if ( isset( $vars['date\_query'] ) ) { |
| [752](#L752) | $vars['date\_query']['inclusive'] = true; |
| [753](#L753) | } |
| [754](#L754) |  |
| [755](#L755) | endif; |
| [756](#L756) |  |
| [757](#L757) | /\* Filter by campaign. \*/ |
| [758](#L758) | if ( isset( $\_GET['campaign\_id'] ) && 'all' !== $\_GET['campaign\_id'] ) { |
| [759](#L759) | $vars['post\_\_in'] = charitable\_get\_table( 'campaign\_donations' )->get\_donation\_ids\_for\_campaign( $\_GET['campaign\_id'] ); |
| [760](#L760) | } |
| [761](#L761) |  |
| [762](#L762) | /\* If the user cannot view/edit others donations, filter by author. \*/ |
| [763](#L763) | if ( ! current\_user\_can( 'edit\_others\_donations' ) ) { |
| [764](#L764) | $vars['author'] = get\_current\_user\_id(); |
| [765](#L765) | } |
| [766](#L766) |  |
| [767](#L767) | return $vars; |
| [768](#L768) | } |
| [769](#L769) |  |
| [770](#L770) | /\*\* |
| [771](#L771) | \* Column sorting handler. |
| [772](#L772) | \* |
| [773](#L773) | \* @since  1.5.0 |
| [774](#L774) | \* |
| [775](#L775) | \* @global string $typenow The current post type. |
| [776](#L776) | \* @global WPDB $wpdb The WPDB object. |
| [777](#L777) | \* @param  array $clauses Array of SQL query clauses. |
| [778](#L778) | \* @return array |
| [779](#L779) | \*/ |
| [780](#L780) | public function sort\_donations( $clauses ) { |
| [781](#L781) | global $typenow, $wpdb; |
| [782](#L782) |  |
| [783](#L783) | if ( Charitable::DONATION\_POST\_TYPE != $typenow ) { |
| [784](#L784) | return $clauses; |
| [785](#L785) | } |
| [786](#L786) |  |
| [787](#L787) | if ( ! isset( $\_GET['orderby'] ) ) { |
| [788](#L788) | return $clauses; |
| [789](#L789) | } |
| [790](#L790) |  |
| [791](#L791) | /\* Sorting \*/ |
| [792](#L792) | $order = isset( $\_GET['order'] ) && strtoupper( $\_GET['order'] ) == 'ASC' ? 'ASC' : 'DESC'; |
| [793](#L793) |  |
| [794](#L794) | switch ( $\_GET['orderby'] ) { |
| [795](#L795) | case 'amount': |
| [796](#L796) | $clauses['join']    = "JOIN {$wpdb->prefix}charitable\_campaign\_donations cd ON cd.donation\_id = $wpdb->posts.ID "; |
| [797](#L797) | $clauses['orderby'] = 'cd.amount ' . $order; |
| [798](#L798) | break; |
| [799](#L799) | } |
| [800](#L800) |  |
| [801](#L801) | return $clauses; |
| [802](#L802) | } |
| [803](#L803) |  |
| [804](#L804) | /\*\* |
| [805](#L805) | \* Return the status counts, taking into account any current filters. |
| [806](#L806) | \* |
| [807](#L807) | \* @since  1.5.0 |
| [808](#L808) | \* |
| [809](#L809) | \* @return array |
| [810](#L810) | \*/ |
| [811](#L811) | protected function get\_status\_counts() { |
| [812](#L812) | if ( ! isset( $this->status\_counts ) ) { |
| [813](#L813) |  |
| [814](#L814) | $args = array(); |
| [815](#L815) |  |
| [816](#L816) | if ( isset( $\_GET['s'] ) && strlen( $\_GET['s'] ) ) { |
| [817](#L817) | $args['s'] = $\_GET['s']; |
| [818](#L818) | } |
| [819](#L819) |  |
| [820](#L820) | if ( isset( $\_GET['start\_date'] ) && strlen( $\_GET['start\_date'] ) ) { |
| [821](#L821) | $args['start\_date'] = $this->get\_parsed\_date( $\_GET['start\_date'] ); |
| [822](#L822) | } |
| [823](#L823) |  |
| [824](#L824) | if ( isset( $\_GET['end\_date'] ) && strlen( $\_GET['end\_date'] ) ) { |
| [825](#L825) | $args['end\_date'] = $this->get\_parsed\_date( $\_GET['end\_date'] ); |
| [826](#L826) | } |
| [827](#L827) |  |
| [828](#L828) | /\* If the user cannot view/edit others donations, filter by author. \*/ |
| [829](#L829) | if ( ! current\_user\_can( 'edit\_others\_donations' ) ) { |
| [830](#L830) | $args['author'] = get\_current\_user\_id(); |
| [831](#L831) | } |
| [832](#L832) |  |
| [833](#L833) | $status\_counts = Charitable\_Donations::count\_by\_status( $args ); |
| [834](#L834) |  |
| [835](#L835) | foreach ( charitable\_get\_valid\_donation\_statuses() as $key => $label ) { |
| [836](#L836) | $this->status\_counts[ $key ] = array\_key\_exists( $key, $status\_counts ) |
| [837](#L837) | ? $status\_counts[ $key ]->num\_donations |
| [838](#L838) | : 0; |
| [839](#L839) | } |
| [840](#L840) | } |
| [841](#L841) |  |
| [842](#L842) | return $this->status\_counts; |
| [843](#L843) | } |
| [844](#L844) |  |
| [845](#L845) | /\*\* |
| [846](#L846) | \* Given a date, returns an array containing the date, month and year. |
| [847](#L847) | \* |
| [848](#L848) | \* @since  1.5.0 |
| [849](#L849) | \* |
| [850](#L850) | \* @param  string $date A date as a string that can be parsed by strtotime. |
| [851](#L851) | \* @return string[] |
| [852](#L852) | \*/ |
| [853](#L853) | protected function get\_parsed\_date( $date ) { |
| [854](#L854) | $time = charitable\_sanitize\_date\_alt\_format( $date ); |
| [855](#L855) |  |
| [856](#L856) | return array( |
| [857](#L857) | 'year'  => date( 'Y', $time ), |
| [858](#L858) | 'month' => date( 'm', $time ), |
| [859](#L859) | 'day'   => date( 'd', $time ), |
| [860](#L860) | ); |
| [861](#L861) | } |
| [862](#L862) |  |
| [863](#L863) | /\*\* |
| [864](#L864) | \* Show blank slate. |
| [865](#L865) | \* |
| [866](#L866) | \* @since 1.8.1.5 |
| [867](#L867) | \* |
| [868](#L868) | \* @param string $which String which tablenav is being shown. |
| [869](#L869) | \* |
| [870](#L870) | \* @return void |
| [871](#L871) | \*/ |
| [872](#L872) | public function maybe\_render\_blank\_state( $which = '' ) { |
| [873](#L873) | global $post\_type; |
| [874](#L874) |  |
| [875](#L875) | if ( $post\_type === $this->list\_table\_type && 'bottom' === $which ) { |
| [876](#L876) | $counts = (array) wp\_count\_posts( $post\_type ); |
| [877](#L877) | unset( $counts['auto-draft'] ); |
| [878](#L878) | $count = array\_sum( $counts ); |
| [879](#L879) |  |
| [880](#L880) | if ( ! defined( 'CHARITABLE\_FORCE\_BLANK\_SLATE' ) ) : |
| [881](#L881) | if ( 0 < $count || ( defined( 'CHARITABLE\_DISABLE\_BLANK\_SLATE' ) && CHARITABLE\_DISABLE\_BLANK\_SLATE ) ) { |
| [882](#L882) | return; |
| [883](#L883) | } |
| [884](#L884) | endif; |
| [885](#L885) |  |
| [886](#L886) | $this->render\_blank\_state(); |
| [887](#L887) |  |
| [888](#L888) | echo '<style type="text/css">#posts-filter .wp-list-table, #posts-filter .tablenav.top, .tablenav.bottom .actions, .wrap .subsubsub, .wrap .search-box, .wrap .tablenav-pages  { display: none; } #posts-filter .tablenav.bottom { height: auto; } body.post-type-donation .page-title-action { display: inline-block; } </style>'; |
| [889](#L889) | } |
| [890](#L890) | } |
| [891](#L891) |  |
| [892](#L892) | /\*\* |
| [893](#L893) | \* Renders advice in the event that no orders exist yet. |
| [894](#L894) | \* |
| [895](#L895) | \* @since 1.8.1.5 |
| [896](#L896) | \* |
| [897](#L897) | \* @return void |
| [898](#L898) | \*/ |
| [899](#L899) | public function render\_blank\_state(): void { |
| [900](#L900) |  |
| [901](#L901) | $counts = (array) wp\_count\_posts( 'campaign' ); |
| [902](#L902) | unset( $counts['auto-draft'] ); |
| [903](#L903) | $campaign\_exists = array\_sum( $counts ) > 0 ? true : false; |
| [904](#L904) |  |
| [905](#L905) | ?> |
| [906](#L906) | <div class="charitable-blank-slate"> |
| [907](#L907) |  |
| [908](#L908) | <img class="charitable-blank-slate-hero-image" src="<?php echo charitable()->get\_path( 'directory', false ) . 'assets/images/icons/blank-slate-donations.svg'; ?>" alt=""  /> |
| [909](#L909) |  |
| [910](#L910) | <?php if ( $campaign\_exists ) : ?> |
| [911](#L911) | <h2 class="charitable-blank-slate-message"> |
| [912](#L912) | <?php esc\_html\_e( 'No Donations Yet!', 'charitable' ); ?> |
| [913](#L913) | </h2> |
| [914](#L914) | <div class="charitable-blank-slate-buttons"> |
| [915](#L915) | <a class="charitable-blank-slate-cta charitable-button" href="<?php echo admin\_url( 'post-new.php?post\_type=donation' ); ?>"><?php esc\_html\_e( 'Add A Manual Donation', 'charitable' ); ?></a> |
| [916](#L916) | <div class="charitable-blank-slate-buttons-legacy"> |
| [917](#L917) | <div><a target="\_blank" href="https://www.wpcharitable.com/documentation/learn-more-donations/"><?php esc\_html\_e( 'Learn More About Donations', 'charitable' ); ?></a></div> |
| [918](#L918) | </div> |
| [919](#L919) | </div> |
| [920](#L920) | <?php else : ?> |
| [921](#L921) | <h2 class="charitable-blank-slate-message"> |
| [922](#L922) | <?php esc\_html\_e( 'Create A Campaign To Start Accepting Donations!', 'charitable' ); ?> |
| [923](#L923) | </h2> |
| [924](#L924) | <div class="charitable-blank-slate-buttons"> |
| [925](#L925) | <a class="charitable-blank-slate-cta charitable-button" target="\_blank" href="<?php echo admin\_url( 'admin.php?page=charitable-campaign-builder&view=template' ); ?>"><?php esc\_html\_e( 'Create Campaign', 'charitable' ); ?></a> |
| [926](#L926) | <div class="charitable-blank-slate-buttons-legacy"> |
| [927](#L927) | <div><a href="<?php echo admin\_url( 'post-new.php?post\_type=donation' ); ?>"><?php esc\_html\_e( 'Create A Donation Manually', 'charitable' ); ?></a></div> |
| [928](#L928) | </div> |
| [929](#L929) | </div> |
| [930](#L930) | <?php endif; ?> |
| [931](#L931) |  |
| [932](#L932) | <?php |
| [933](#L933) | /\*\* |
| [934](#L934) | \* Renders after the 'blank state' message for the order list table has rendered. |
| [935](#L935) | \* |
| [936](#L936) | \* @since 1.8.1.5 |
| [937](#L937) | \*/ |
| [938](#L938) | do\_action( 'charitable\_marketplace\_suggestions\_donations\_empty\_state' ); // phpcs:ignore |
| [939](#L939) |  |
| [940](#L940) | $recommendations = $this->render\_blank\_slate\_recommendations(); |
| [941](#L941) |  |
| [942](#L942) | ?> |
| [943](#L943) |  |
| [944](#L944) | <div class="marketplace-suggestions-container showing-suggestion" data-marketplace-suggestions-context="orders-list-empty-header"> |
| [945](#L945) | <?php if ( false !== $recommendations ) : ?> |
| [946](#L946) | <div class="marketplace-suggestion-container" data-suggestion-slug="orders-empty-header"> |
| [947](#L947) | <h4><?php esc\_html\_e( 'Improve The Potential Of Your Campaigns:', 'charitable' ); ?></h4> |
| [948](#L948) | </div> |
| [949](#L949) | <?php endif; ?> |
| [950](#L950) | </div> |
| [951](#L951) | <?php if ( false !== $recommendations ) : ?> |
| [952](#L952) | <div class="charitable-intergration-steps"> |
| [953](#L953) | <?php echo $recommendations; ?> |
| [954](#L954) | </div> |
| [955](#L955) | <?php endif; ?> |
| [956](#L956) | <div class="marketplace-suggestions-container marketplace-suggestions-container-footer showing-suggestion"> |
| [957](#L957) | <div class="marketplace-suggestion-container marketplace-suggestion-container-footer"> |
| [958](#L958) | <div class="marketplace-suggestion-container-content"></div> |
| [959](#L959) | <div class="marketplace-suggestion-container-cta"> |
| [960](#L960) | <a href="<?php echo admin\_url( 'admin.php?page=charitable-addons' ); ?>" class="linkout"><?php esc\_html\_e( 'Browse all addons', 'charitable' ); ?></a> |
| [961](#L961) | <a href="<?php echo admin\_url( 'admin.php?page=charitable-growth-tools' ); ?>" target="\_blank" class="linkout"><?php esc\_html\_e( 'Growth Tools', 'charitable' ); ?></a> |
| [962](#L962) | </div> |
| [963](#L963) | </div> |
| [964](#L964) | </div> |
| [965](#L965) |  |
| [966](#L966) |  |
| [967](#L967) | </div> |
| [968](#L968) | <?php |
| [969](#L969) | } |
| [970](#L970) |  |
| [971](#L971) | /\*\* |
| [972](#L972) | \* Renders the blank slate recommendations. |
| [973](#L973) | \* |
| [974](#L974) | \* @since 1.8.1.5 |
| [975](#L975) | \* |
| [976](#L976) | \* @return string |
| [977](#L977) | \*/ |
| [978](#L978) | public function render\_blank\_slate\_recommendations() { |
| [979](#L979) |  |
| [980](#L980) | $charitable\_plugins\_third\_party = new Charitable\_Admin\_Plugins\_Third\_Party(); |
| [981](#L981) | $user\_recommended\_list          = $charitable\_plugins\_third\_party->get\_recommendations( 'campaign', 3 ); |
| [982](#L982) |  |
| [983](#L983) | if ( empty( $user\_recommended\_list ) ) { |
| [984](#L984) | return false; |
| [985](#L985) | } |
| [986](#L986) |  |
| [987](#L987) | ob\_start(); |
| [988](#L988) |  |
| [989](#L989) | if ( ! empty( $user\_recommended\_list ) ) { |
| [990](#L990) |  |
| [991](#L991) | foreach ( $user\_recommended\_list as $slug => $item ) { |
| [992](#L992) | echo $this->render\_blank\_slate\_recommendation( $slug ); |
| [993](#L993) | } |
| [994](#L994) |  |
| [995](#L995) | } else { |
| [996](#L996) |  |
| [997](#L997) | return; |
| [998](#L998) |  |
| [999](#L999) | } |
| [1000](#L1000) |  |
| [1001](#L1001) | $output = ob\_get\_clean(); |
| [1002](#L1002) |  |
| [1003](#L1003) | return $output; |
| [1004](#L1004) | } |
| [1005](#L1005) |  |
| [1006](#L1006) | /\*\* |
| [1007](#L1007) | \* Renders a blank slate recommendation. |
| [1008](#L1008) | \* |
| [1009](#L1009) | \* @since 1.8.1.5 |
| [1010](#L1010) | \* |
| [1011](#L1011) | \* @param string $slug The slug of the recommendation. |
| [1012](#L1012) | \* |
| [1013](#L1013) | \* @return string |
| [1014](#L1014) | \*/ |
| [1015](#L1015) | public function render\_blank\_slate\_recommendation( $slug = '' ) { |
| [1016](#L1016) |  |
| [1017](#L1017) | // check and see if the slug refers to a Charitable addon first. |
| [1018](#L1018) | $recommended\_addons = get\_transient( '\_charitable\_addons' ); // @codingStandardsIgnoreLine - testing. |
| [1019](#L1019) |  |
| [1020](#L1020) | // Get addons data from transient or perform API query if no transient. |
| [1021](#L1021) | if ( false === $recommended\_addons ) { |
| [1022](#L1022) | $recommended\_addons = charitable\_get\_addons\_data\_from\_server(); |
| [1023](#L1023) | } |
| [1024](#L1024) |  |
| [1025](#L1025) | $recommended\_addon = array(); |
| [1026](#L1026) | $addon\_slug        = $slug; |
| [1027](#L1027) |  |
| [1028](#L1028) | if ( $recommended\_addons ) { |
| [1029](#L1029) |  |
| [1030](#L1030) | foreach ( (array) $recommended\_addons as $i => $addon ) { |
| [1031](#L1031) |  |
| [1032](#L1032) | if ( ! empty( $addon['slug'] ) && (string) $addon\_slug === (string) $addon['slug'] ) { |
| [1033](#L1033) | $recommended\_addon = $addon; |
| [1034](#L1034) | break; |
| [1035](#L1035) | } |
| [1036](#L1036) |  |
| [1037](#L1037) | } |
| [1038](#L1038) |  |
| [1039](#L1039) | } |
| [1040](#L1040) |  |
| [1041](#L1041) | if ( ! empty( $recommended\_addon ) ) { |
| [1042](#L1042) |  |
| [1043](#L1043) | // this is a Chartiable addon. |
| [1044](#L1044) |  |
| [1045](#L1045) | $title       = str\_replace( 'Charitable', '', $recommended\_addon['name'] ); |
| [1046](#L1046) | $sections    = ! empty( $recommended\_addon['sections'] ) ? unserialize( $recommended\_addon['sections'] ) : false; |
| [1047](#L1047) | $description = is\_array( $sections ) && ! empty( $sections['description'] ) ? $sections['description'] : ''; |
| [1048](#L1048) |  |
| [1049](#L1049) | ob\_start(); |
| [1050](#L1050) |  |
| [1051](#L1051) | ?> |
| [1052](#L1052) |  |
| [1053](#L1053) | <div class="charitable-intergration-step charitable-addon charitable-plugin-suggestion" data-status="<?php echo esc\_attr( $slug ); ?>"> |
| [1054](#L1054) | <div class="instructions"> |
| [1055](#L1055) | <header class="charitable-intergration-step-header"> |
| [1056](#L1056) | <div class="sub-header"> |
| [1057](#L1057) | <h3><?php echo esc\_html( $title ); ?></h3> |
| [1058](#L1058) | <span class="badge"><a href="#">Pro</a></span> |
| [1059](#L1059) | </div> |
| [1060](#L1060) | </header> |
| [1061](#L1061) | <p class="description"><?php echo wp\_strip\_all\_tags( $description ); ?></p> |
| [1062](#L1062) | <a href="<?php echo admin\_url( 'admin.php?page=charitable-addons&search=' . esc\_attr( str\_replace( '-', ' ', $slug ) ) ); ?>" class="charitable-button button-link charitable-addons"><?php esc\_html\_e( 'View Addons', 'charitable' ); ?></a> |
| [1063](#L1063) | </div> |
| [1064](#L1064) | <div class="step"> |
| [1065](#L1065) | <div class="vertical-wrapper"> |
| [1066](#L1066) | <div class="step-image"><a class="suggestion-dismiss" title="<?php esc\_html\_e( 'Dismiss this suggestion', 'charitable' ); ?>" data-plugin-slug="<?php echo esc\_attr( $slug ); ?>" data-plugin-type="addon" href="#"><i class="" title="<?php esc\_html\_e( 'Dismiss this suggestion', 'charitable' ); ?>"></i></a></div> |
| [1067](#L1067) | </div> |
| [1068](#L1068) | </div> |
| [1069](#L1069) | </div> |
| [1070](#L1070) |  |
| [1071](#L1071) |  |
| [1072](#L1072) | <?php |
| [1073](#L1073) |  |
| [1074](#L1074) | $output = ob\_get\_clean(); |
| [1075](#L1075) |  |
| [1076](#L1076) | } else { |
| [1077](#L1077) |  |
| [1078](#L1078) | // this is a third party plugin. |
| [1079](#L1079) |  |
| [1080](#L1080) | $charitable\_plugins\_third\_party = new Charitable\_Admin\_Plugins\_Third\_Party(); |
| [1081](#L1081) | $plugin\_data                    = $charitable\_plugins\_third\_party->get\_plugin( esc\_attr( $slug ) ); |
| [1082](#L1082) |  |
| [1083](#L1083) | if ( ! $plugin\_data ) { |
| [1084](#L1084) | return ''; |
| [1085](#L1085) | } |
| [1086](#L1086) |  |
| [1087](#L1087) | ob\_start(); |
| [1088](#L1088) |  |
| [1089](#L1089) | ?> |
| [1090](#L1090) |  |
| [1091](#L1091) |  |
| [1092](#L1092) | <div class="charitable-intergration-step charitable-third-party charitable-plugin-suggestion" data-status="<?php echo esc\_attr( $slug ); ?>"> |
| [1093](#L1093) | <div class="instructions"> |
| [1094](#L1094) |  |
| [1095](#L1095) | <header class="charitable-intergration-step-header"> |
| [1096](#L1096) | <div class="sub-header"> |
| [1097](#L1097) | <h3><?php echo esc\_html( $plugin\_data['title'] ); ?></h3> |
| [1098](#L1098) | <span class="badge"><a href="#"><?php esc\_html\_e( 'Partner', 'charitable' ); ?></a></span> |
| [1099](#L1099) | </div> |
| [1100](#L1100) | </header> |
| [1101](#L1101) |  |
| [1102](#L1102) | <p class="description"><?php echo esc\_html( $plugin\_data['excerpt'] ); ?></p> |
| [1103](#L1103) | <?php |
| [1104](#L1104) | $plugin\_button\_html = $charitable\_plugins\_third\_party->get\_plugin\_button\_html( $slug, false, '' ); |
| [1105](#L1105) | echo $plugin\_button\_html; // phpcs:ignore |
| [1106](#L1106) | ?> |
| [1107](#L1107) | </div> |
| [1108](#L1108) | <div class="step"> |
| [1109](#L1109) | <div class="vertical-wrapper"> |
| [1110](#L1110) | <div class="step-image"><a class="suggestion-dismiss" title="Dismiss this suggestion" data-plugin-slug="<?php echo esc\_attr( $slug ); ?>" data-plugin-type="partner" href="#"><i class="" title="<?php esc\_html\_e( 'Dismiss this suggestion', 'charitable' ); ?>"></i></a></div> |
| [1111](#L1111) | </div> |
| [1112](#L1112) | </div> |
| [1113](#L1113) | </div> |
| [1114](#L1114) |  |
| [1115](#L1115) |  |
| [1116](#L1116) | <?php |
| [1117](#L1117) |  |
| [1118](#L1118) | $output = ob\_get\_clean(); |
| [1119](#L1119) |  |
| [1120](#L1120) | } |
| [1121](#L1121) |  |
| [1122](#L1122) | return $output; |
| [1123](#L1123) | } |
| [1124](#L1124) | } |
| [1125](#L1125) |  |
| [1126](#L1126) | endif; |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/charitable/tags/1.8.2/includes/admin/donations/class-charitable-donation-list-table.php?format=txt)
* [Original Format](/export/3222696/charitable/tags/1.8.2/includes/admin/donations/class-charitable-donation-list-table.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_4096dcde_20250115_090042.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3183944%2Fcharitable%2Ftrunk%2Fincludes%2Fadmin%2Fdonations%2Fclass-charitable-donation-list-table.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Change](/changeset/3179460/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php "Changeset 3179460 for charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php")
* [Next Change](/changeset/3188909/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php "Changeset 3188909 for charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php") →

---

# Changeset [3183944](/changeset/3183944 "Show full changeset") for [charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944 "Show entry in browser")

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/07/2024 03:30:43 PM
([2 months](/timeline?from=2024-11-07T15%3A30%3A43Z&precision=second "See timeline at 11/07/2024 03:30:43 PM") ago)

Author:
dimensionmedia
Message:

Update to v1.8.3.1

File:

1 edited

* [charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944 "Show entry in browser")
  (modified)
  ([20 diffs](#file0 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php](/changeset/3183944/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php "Show the changeset 3183944 restricted to charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php")

  | [r3179460](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L123 "Show revision 3179460 of this file in browser") | [r3183944](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L123 "Show revision 3183944 of this file in browser") |  |
  | --- | --- | --- |
  | 123 | 123 | if ( $name ) { |
  | 124 | 124 | $text = sprintf( |
  |  | 125 | /\* translators: %1$d is the donation ID, %2$s is the donor name \*/ |
  | 125 | 126 | \_x( '#%1$d by %2$s', 'number symbol', 'charitable' ), |
  | 126 | 127 | $post\_id, |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L129) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L130) |  |
  | 129 | 130 | if ( $email ) { |
  | 130 | 131 | $text .= '<br/>' . sprintf( |
  | 131 |  | \_x( '%1$s', 'email', 'charitable' ), |
  |  | 132 | /\* translators: %s is the donor email \*/ |
  |  | 133 | \_x( '%1$s', 'email', 'charitable' ), // phpcs:ignore |
  | 132 | 134 | $email |
  | 133 | 135 | ); |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L135) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L137) |  |
  | 135 | 137 | } else { |
  | 136 | 138 | $text = sprintf( |
  |  | 139 | /\* translators: %d is the donation ID \*/ |
  | 137 | 140 | \_x( '#%d', 'number symbol', 'charitable' ), |
  | 138 | 141 | $post\_id |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L162) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L165) |  |
  | 162 | 165 |  |
  | 163 | 166 | case 'amount': |
  | 164 |  | $display  = charitable\_format\_money( $donation->get\_total\_donation\_amount(), false, false, $donation->get\_currency() ); |
  |  | 167 | $display = charitable\_format\_money( $donation->get\_total\_donation\_amount(), false, false, $donation->get\_currency() ); |
  |  | 168 | // translators: %s is the gateway label. |
  | 165 | 169 | $display .= '<span class="meta">' . sprintf( \_x( 'via %s', 'charitable' ), $donation->get\_gateway\_label() ) . '</span>'; |
  | 166 | 170 | break; |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L204) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L208) |  |
  | 204 | 208 | \* @param Charitable\_Donation $donation    The Charitable\_Donation object. |
  | 205 | 209 | \*/ |
  | 206 |  | echo apply\_filters( 'charitable\_donation\_column\_display', $display, $column\_name, $post\_id, $donation ); |
  |  | 210 | echo apply\_filters( 'charitable\_donation\_column\_display', $display, $column\_name, $post\_id, $donation ); // phpcs:ignore |
  | 207 | 211 | } |
  | 208 | 212 |  |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L232) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L236) |  |
  | 232 | 236 | \* @since  1.5.0 |
  | 233 | 237 | \* |
  | 234 |  | \* @param  string $default |
  | 235 |  | \* @param  string $screen\_id |
  |  | 238 | \* @param  string $default  Default primary column. |
  |  | 239 | \* @param  string $screen\_id The current screen ID. |
  | 236 | 240 | \* @return string |
  | 237 | 241 | \*/ |
  | 238 |  | public function primary\_column( $default, $screen\_id ) { |
  |  | 242 | public function primary\_column( $default, $screen\_id ) { // phpcs:ignore |
  | 239 | 243 | if ( 'edit-donation' === $screen\_id ) { |
  | 240 | 244 | return 'id'; |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L249) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L253) |  |
  | 249 | 253 | \* @since  1.5.0 |
  | 250 | 254 | \* |
  | 251 |  | \* @param  array   $actions |
  | 252 |  | \* @param  WP\_Post $post |
  |  | 255 | \* @param  array   $actions List of row actions. |
  |  | 256 | \* @param  WP\_Post $post   The current post object. |
  | 253 | 257 | \* @return array |
  | 254 | 258 | \*/ |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L311) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L315) |  |
  | 311 | 315 | public function set\_status\_views( $views ) { |
  | 312 | 316 | $counts  = $this->get\_status\_counts(); |
  | 313 |  | $current = array\_key\_exists( 'post\_status', $\_GET ) ? ~~$\_GET['post\_status'] : '';~~ |
  |  | 317 | $current = array\_key\_exists( 'post\_status', $\_GET ) ? esc\_html( $\_GET['post\_status'] ) : ''; // phpcs:ignore |
  | 314 | 318 |  |
  | 315 | 319 | foreach ( charitable\_get\_valid\_donation\_statuses() as $key => $label ) { |
  | 316 | 320 | $views[ $key ] = sprintf( |
  | 317 | 321 | '<a href="%s"%s>%s <span class="count">(%d)</span></a>', |
  | 318 |  | add\_query\_arg( |
  | 319 |  | array( |
  | 320 |  | 'post\_status' => $key, |
  | 321 |  | 'paged'       => false, |
  |  | 322 | esc\_url( |
  |  | 323 | add\_query\_arg( |
  |  | 324 | array( |
  |  | 325 | 'post\_status' => $key, |
  |  | 326 | 'paged'       => false, |
  |  | 327 | ) |
  | 322 | 328 | ) |
  | 323 | 329 | ), |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L330) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L336) |  |
  | 330 | 336 | $views['all'] = sprintf( |
  | 331 | 337 | '<a href="%s"%s>%s <span class="count">(%d)</span></a>', |
  | 332 |  | ~~remove\_query\_arg( array( 'post\_status', 'paged'~~ ) ), |
  |  | 338 | esc\_url( remove\_query\_arg( array( 'post\_status', 'paged' ) ) ), |
  | 333 | 339 | 'all' === $current || '' === $current ? ' class="current"' : '', |
  | 334 | 340 | \_\_( 'All', 'charitable' ), |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L359) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L365) |  |
  | 359 | 365 | \* Process bulk actions |
  | 360 | 366 | \* |
  | 361 |  | \* @param   int    $redirect\_to |
  | 362 |  | \* @param   string $action |
  | 363 |  | \* @param   int[]  $post\_ids |
  |  | 367 | \* @param   int    $redirect\_to The URL to redirect to. |
  |  | 368 | \* @param   string $action  The action being performed. |
  |  | 369 | \* @param   int[]  $post\_ids    The list of post IDs. |
  | 364 | 370 | \* @return  string |
  | 365 | 371 | \* @since   1.5.0 |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L427) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L433) |  |
  | 427 | 433 |  |
  | 428 | 434 | foreach ( charitable\_get\_valid\_donation\_statuses() as $status\_key => $label ) { |
  |  | 435 | /\* translators: %s is the status label \*/ |
  | 429 | 436 | $actions[ 'set-' . $status\_key ] = sprintf( \_x( 'Set to %s', 'set donation status to x', 'charitable' ), $label ); |
  | 430 | 437 | } |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L454) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L461) |  |
  | 454 | 461 | global $post\_type; |
  | 455 | 462 |  |
  | 456 |  | if ( Charitable::DONATION\_POST\_TYPE == $post\_type ) { |
  |  | 463 | if ( Charitable::DONATION\_POST\_TYPE === $post\_type ) { |
  | 457 | 464 |  |
  | 458 | 465 | $js  = '<script type="text/javascript">'; |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L464) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L471) |  |
  | 464 | 471 | $js .= '</script>'; |
  | 465 | 472 |  |
  | 466 |  | echo $js; |
  |  | 473 | echo $js; // phpcs:ignore |
  | 467 | 474 | } |
  | 468 | 475 | } |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L487) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L494) |  |
  | 487 | 494 |  |
  | 488 | 495 | if ( isset( $\_REQUEST['action'] ) && -1 != $\_REQUEST['action'] ) { |
  | 489 |  | $action = ~~$\_REQUEST['action']~~; |
  |  | 496 | $action = sanitize\_text\_field( wp\_unslash( $\_REQUEST['action'] ) ); |
  | 490 | 497 | } elseif ( isset( $\_REQUEST['action2'] ) && -1 != $\_REQUEST['action2'] ) { |
  | 491 |  | $action = ~~$\_REQUEST['action2']~~; |
  |  | 498 | $action = sanitize\_text\_field( wp\_unslash( $\_REQUEST['action2'] ) ); |
  | 492 | 499 | } |
  | 493 | 500 |  |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L501) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L508) |  |
  | 501 | 508 | $redirect\_to = $this->bulk\_action\_handler( $redirect\_to, $action, $post\_ids ); |
  | 502 | 509 |  |
  | 503 |  | wp\_redirect( esc\_url\_raw( $redirect\_to ) ); |
  |  | 510 | wp\_safe\_redirect( esc\_url\_raw( $redirect\_to ) ); |
  | 504 | 511 |  |
  | 505 | 512 | exit(); |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L527) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L534) |  |
  | 527 | 534 | $report\_action = 'bulk\_' . Charitable::DONATION\_POST\_TYPE . '\_status\_update'; |
  | 528 | 535 |  |
  | 529 |  | if ( ! empty( $\_REQUEST[ $report\_action ] ) ) { |
  | 530 |  | $number  = absint( $\_REQUEST[ $report\_action ] ); |
  | 531 |  | $message = sprintf( \_n( 'Donation status changed.', '%s donation statuses changed.', $number, 'charitable' ), number\_format\_i18n( $number ) ); |
  | 532 |  | echo '<div class="updated"><p>' . $message . '</p></div>'; |
  |  | 536 | if ( ! empty( $\_REQUEST[ $report\_action ] ) ) { // phpcs:ignore |
  |  | 537 | $number  = absint( $\_REQUEST[ $report\_action ] ); // phpcs:ignore |
  |  | 538 | // translators: %s is the number of orders. |
  |  | 539 | $message = sprintf( \_n( '%s donation status changed.', '%s donation statuses changed.', $number, 'charitable' ), number\_format\_i18n( $number ) ); |
  |  | 540 | echo '<div class="updated"><p>' . esc\_html( $message ) . '</p></div>'; |
  | 533 | 541 | } |
  | 534 | 542 | } |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L550) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L558) |  |
  | 550 | 558 | $messages[ Charitable::DONATION\_POST\_TYPE ] = array( |
  | 551 | 559 | 0  => '', // Unused. Messages start at index 1. |
  |  | 560 | // translators: %s: the URL. |
  | 552 | 561 | 1  => sprintf( \_\_( 'Donation updated. <a href="%s">View Donation</a>', 'charitable' ), esc\_url( get\_permalink( $post\_ID ) ) ), |
  | 553 | 562 | 2  => \_\_( 'Custom field updated.', 'charitable' ), |
  | 554 | 563 | 3  => \_\_( 'Custom field deleted.', 'charitable' ), |
  | 555 | 564 | 4  => \_\_( 'Donation updated.', 'charitable' ), |
  |  | 565 | // translators: %s: post title. |
  | 556 | 566 | 5  => isset( $\_GET['revision'] ) ? sprintf( \_\_( 'Donation restored to revision from %s', 'charitable' ), wp\_post\_revision\_title( (int) $\_GET['revision'], false ) ) : false, |
  |  | 567 | // translators: %s: the URL. |
  | 557 | 568 | 6  => sprintf( \_\_( 'Donation published. <a href="%s">View Donation</a>', 'charitable' ), esc\_url( get\_permalink( $post\_ID ) ) ), |
  | 558 | 569 | 7  => \_\_( 'Donation saved.', 'charitable' ), |
  | 559 | 570 | 8  => sprintf( |
  |  | 571 | // translators: %s: the URL. |
  | 560 | 572 | \_\_( 'Donation submitted. <a target="\_blank" href="%s">Preview Donation</a>', 'charitable' ), |
  | 561 | 573 | esc\_url( add\_query\_arg( 'preview', 'true', get\_permalink( $post\_ID ) ) ) |
  | 562 | 574 | ), |
  | 563 | 575 | 9  => sprintf( |
  |  | 576 | // translators: %1$s is the date, %2$s is the preview link. |
  | 564 | 577 | \_\_( 'Donation scheduled for: <strong>%1$s</strong>. <a target="\_blank" href="%2$s">Preview Donation</a>', 'charitable' ), |
  | 565 | 578 | date\_i18n( 'M j, Y @ G:i', strtotime( $post->post\_date ) ), |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L567) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L580) |  |
  | 567 | 580 | ), |
  | 568 | 581 | 10 => sprintf( |
  |  | 582 | // translators: %s is the preview link. |
  | 569 | 583 | \_\_( 'Donation draft updated. <a target="\_blank" href="%s">Preview Donation</a>', 'charitable' ), |
  | 570 | 584 | esc\_url( add\_query\_arg( 'preview', 'true', get\_permalink( $post\_ID ) ) ) |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L588) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L602) |  |
  | 588 | 602 | public function bulk\_messages( $bulk\_messages, $bulk\_counts ) { |
  | 589 | 603 | $bulk\_messages[ Charitable::DONATION\_POST\_TYPE ] = array( |
  |  | 604 | // translators: %d: number of items. |
  | 590 | 605 | 'updated'   => \_n( '%d donation updated.', '%d donations updated.', $bulk\_counts['updated'], 'charitable' ), |
  | 591 |  | 'locked'    => ( 1 == $bulk\_counts['locked'] ) ? \_\_( '1 donation not updated, somebody is editing it.' ) : |
  |  | 606 | 'locked'    => ( 1 == $bulk\_counts['locked'] ) ? \_\_( '1 donation not updated, somebody is editing it.', 'charitable' ) : |
  |  | 607 | // translators: %d: number of items. |
  | 592 | 608 | \_n( '%s donation not updated, somebody is editing it.', '%s donations not updated, somebody is editing them.', $bulk\_counts['locked'], 'charitable' ), |
  |  | 609 | // translators: %s: number of items. |
  | 593 | 610 | 'deleted'   => \_n( '%s donation permanently deleted.', '%s donations permanently deleted.', $bulk\_counts['deleted'], 'charitable' ), |
  |  | 611 | // translators: %s: number of items. |
  | 594 | 612 | 'trashed'   => \_n( '%s donation moved to the Trash.', '%s donations moved to the Trash.', $bulk\_counts['trashed'], 'charitable' ), |
  |  | 613 | // translators: %s: number of items. |
  | 595 | 614 | 'untrashed' => \_n( '%s donation restored from the Trash.', '%s donations restored from the Trash.', $bulk\_counts['untrashed'], 'charitable' ), |
  | 596 | 615 | ); |
  | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3179460#L604) | […](/browser/charitable/trunk/includes/admin/donations/class-charitable-donation-list-table.php?rev=3183944#L623) |  |
  | 604 | 623 | \* @since  1.5.0 |
  | 605 | 624 | \* |
  | 606 |  | \* @param  mixed  $~~public\_query\_vars Public query vars. Unused~~. |
  |  | 625 | \* @param  mixed  $disable           Whether to disable the dropdown. |
  | 607 | 626 | \* @param  string $post\_type         The current post type. |
  | 608 | 627 | \* @return boolean |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3183944)
* [Zip Archive](?format=zip&new=3183944)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


