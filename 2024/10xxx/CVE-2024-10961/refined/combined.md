=== Content from wordpress.org_81cd2d2c_20250115_094400.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Social Login

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Foa-social-login&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Foa-social-login&locale=en_US)

Search plugins

![](https://ps.w.org/oa-social-login/assets/banner-772x250.png?rev=2507522)
![](https://ps.w.org/oa-social-login/assets/icon-256x256.gif?rev=2680668)
# Social Login

By [OneAll Social Login](https://www.oneall.com/services/social-network-integration/social-login/)

[Download](https://downloads.wordpress.org/plugin/oa-social-login.zip)

* [Details](https://wordpress.org/plugins/oa-social-login/#description)
* [Reviews](https://wordpress.org/plugins/oa-social-login/#reviews)
* [Installation](https://wordpress.org/plugins/oa-social-login/#installation)
* [Development](https://wordpress.org/plugins/oa-social-login/#developers)

[Support](https://wordpress.org/support/plugin/oa-social-login/)

## Description

#### Social Login Plugin

Social Login is a **professionally developed** and free WordPress plugin that allows your visitors to **comment, login and register with 40+ Social Networks** like for example Facebook, Twitter / X, TikTok, Google, LinkedIn, PayPal, LiveJournal, Instagram, Вконтакте or Yahoo amongst other.

**Data Protection Guarantee**

Social Login is fully compliant with all European and U.S. data protection laws. As required by the General Data Protection Regulation (GDPR) the OneAll Terms of Service include a Data Processing Agreement that we can countersign on request.

**Seamless Integration**

Social Login is fully customizable and seamlessly integrates with your existing login/registration system so that your users don’t have to start from scratch. Existing existing accounts can add/remove their social network accounts in their WordPress profile settings and then also use the linked social networks to login.

**Eliminates Spam and Bot Registrations**

Get rid of long and complicated forms, improve your data quality and instantly eliminate spam and bot registrations. Social Login increases registration rates by up to 50% and provides permission-based access to users’ social network profile data, allowing you to start delivering a personalized experience.

**Maintenance Free**

Do not take the risk of losing any users or customers due to outdated social network integrations. Unlike other Social Login providers we monitor the APIs and technologies of the different social networks and update our service as soon as changes arise.

By using OneAll you can be sure that your social media integration will always run smoothly and with the most up-to-date calls.

**Fully Customizable**

You can easily configure which social accounts to enable/disable for social login and on which areas of the website the social login icons should be displayed:

\* On the comment formular

\* On the login page

\* On the registration page

\* In your sidebar

\* With a shortcode

**Fully Compatible With Other Plugins**

Social Login uses standard WordPress hooks and is compatible with all plugins that follow WordPress coding conventions,

like per example BuddyPress or WooCommerce amongst others.

**Data Export**

Easily export your users or automatically push data of users that login using Social Login to Mailchimp or Campaign Monitor.

This feature is available in the premium version of Social Login and can be enabled in your OneAll account.

**45+ Social Networks**

* Apple
* Amazon
* Battle.net
* Blogger
* Discord
* Draugiem
* Dribbble
* Epic Games
* Facebook
* Foursquare
* Github.com
* Google
* Instagram
* Line
* LinkedIn
* LiveJournal
* Mail.ru
* Meetup
* Mixer
* Odnoklassniki
* OpenID
* Patreon
* PayPal
* Pinterest
* PixelPin
* Reddit
* Skyrock.com
* SoundCloud
* Spotify
* StackExchange
* Steam
* Strava
* TikTok
* Tumblr
* Twitch.tv
* Twitter / X
* Vimeo
* VKontakte
* Weibo
* Windows Live
* WordPress.com
* XING
* Yahoo
* Yandex
* YouTube

**Social Login Features**

* **GDPR compliant**
* **Social Link** – Users can use social login to link multiple social network accounts to their WordPress account.
* **Woocommerce Connect** – Automatic integration of the social login icons on the Woocommerce checkout, login and registration pages.
* **Woocommerce Profile** – Fill the user’s billing address with the first name, last name and email address received from the social network.
* **BuddyPress Connect** – Automatic integration of the social login icons on the BuddyPress account and registration pages.
* **BuddyPress Profile** – Use the social network avatar as BuddyPress avatar and fill out custom fields.
* **User Insights** – Access the analytics dashboard to discover which social networks your users prefer.
* **Automatic Emails** – Send emails to users that register using social login.
* **Automatic Notifications** – Send notifications to admins for every users that registers using social login.
* **Comment Approval** – Automatically approve comments left by users that connected by using social login.
* **Email Retrieval** – Ask users to enter their email when social login did not receive it from the social network.
* **Custom Redirections** – Fully customize the page to redirect user to after having connected using social login.
* **Integrated Widget** – Simply use the social login widget to display the icons wherever you want.
* **ShortCodes** – Easily embed social login anywhere by using the available shortcodes.
* **Hook** – Customize the social login behaviour by using the integrated hooks.
* **Icon Themes** – Choose amongst three different social login icon themes.
* **Documentation** – Access a [complete documentation](https://docs.oneall.com/plugins/guide/social-login-wordpress/) on the available Social Login hooks and filters for WordPress.
* **Support** – Any questions about Social Login? Our support team is there to assist you.

**Social Login Premium Features**

* **Authentication Filters** – Use customisable filters to restrict which users may login with social login.
* **Data Export** – Automatically export social login data to Campaign Monitor or MailChimp or export as CSV.
* **User Insights** – Access analytics and get demographic information about your social login users.
* **Icon Themes** – Choose amongst twenty different social login icon themes or use you own icons.

**Professionally Developed and Maintained**

Social Login is maintained by [OneAll](https://www.oneall.com), a technology company offering a set of web-delivered tools to simplify the integration of 40+ social networks into business and personal websites and apps.

The OneAll API unifies 40+ Social Networks and consolidates the most powerful social network features in a single solution. You can work with multiple social networks at once and you will obtain a standardized field structure for data received from any of the social networks. Save time and development resources and focus on your core business.

### Testimonials

**Used by thousands of users around the world!**

*The plugin in is one of the best I’ve seen so far. Extremely easy to implement and run. The support is great too.

No concerns on my side. Keep it up!*

**livia**

*Loving the service, seen a massive increase in painless signups to my blog. Thanks!*

**Richard B.**

*You have no idea how it THRILLED me to integrate oneall. It was SO amazingly easy, your team has simplified the whole process of signing up for

authorization on multiple social media sites. I HAD NO QUESTIONS/STEPS THAT YOU HADN’T ALREADY ANTICIPATED. It saved me HOURS of work!*

**Kelly C.**

*This is cool. Nice work. I’m VERY impressed. You’ve made this about as painless as it gets and the value it adds is incredible.*

**Jason M.**

*This service is simply remarkable, I’ve tried integrating logins before and it has never been this easy!*

**Andrew C.**

*I found it extremely straightforward. I just figured it out easily and make my website capable of connecting

to many social networks by your plugin.*

**Deha K.**

*Just wanted to let you know how happy i am that i stumbled onto your service. This was the 6 Facebook/Twitter integration

i tried and was starting to lose hope that i could actually find one that worked for me.*

**Kyle L.**

*I would like to thank YOU! Seriously, the WordPress plugin has been a huge life saver for me.*

**Piero B.**

*Thank you for the wonderful plugin*

**Martin P.**

*The service is excellent for what i need, simple to set up. All situations about seting up are well explained, so

there are no difficulties*

**Facundo S.**

*I really like the plugin, the capabilities you provide for management and your prompt reply for support.*

**Tom B.**

*It was extremely easy to set up and use. The documentation to set up the FB and twitter API

was easy to follow and implement. I was struggling with a couple of other plugins till I stumbled on this one.*

**Deepa V.**

*Works like a charm!*

**Fredrik L.**

*Not sure how you can improve it’s a Damn! Good product. 100% User friendly easy to setup. Thanks!*

**Cody L.**

*So far oneall.com is the perfect solution for my site and works flawlessly. I am extremely impressed and grateful.*

**Terry P.**

*I’ve gone in and tweaked it, tested it and it’s good to go now! Wonderful, I feel like a grown up blogger now.*

**Brian J.**

*I am really impressed with your product! Its very dynamic and its gives me the flexibility I need for integration into my own business.*

**Braxton D.**

*Your delivery is superb. You should change your name to WONall because you won it all with me. You are awesome, stay that way please.*

**Nicholas L.**

*I especially enjoy the step by step process that guides you through the Social website App creation process. In the end I would like to thank you

for putting together such a great product that so many users can implement with ease.*

**Stefan C.**

*Thanks for a such a great plugin! I was really impressed with the simplicity of the installation directions and the clean design.*

**Janae S.**

*I love your service the way it is, it’s amazing how easy the logging-in-via-social-network is integrated into a wordpress website!*

**Martin S.**

*The site and the plugin are working magnificently. Thank you one million times for making your products/services available in the manner that you have.*

**Herman G.**

*Very user friendly, there are guides and screenshot on how to set things up. Thank you so much for this awesome plugin!*

**Cebututs**

## Screenshots

* [![](https://ps.w.org/oa-social-login/trunk/screenshot-1.png?rev=3201049)](https://ps.w.org/oa-social-login/trunk/screenshot-1.png?rev=3201049)

  **Comment** – Comment formular (Social Network Buttons are included)
* [![](https://ps.w.org/oa-social-login/trunk/screenshot-2.png?rev=3201049)](https://ps.w.org/oa-social-login/trunk/screenshot-2.png?rev=3201049)

  **Login** – Login formular (Social Network Buttons are included)
* [![](https://ps.w.org/oa-social-login/trunk/screenshot-3.png?rev=3201049)](https://ps.w.org/oa-social-login/trunk/screenshot-3.png?rev=3201049)

  **Plugin Settings** – Plugin Settings in the Wordpress Administration Area
* [![](https://ps.w.org/oa-social-login/trunk/screenshot-4.png?rev=3201049)](https://ps.w.org/oa-social-login/trunk/screenshot-4.png?rev=3201049)

  **Widget Settings** – Widget Settings in the Wordpress Administration Area
* [![](https://ps.w.org/oa-social-login/trunk/screenshot-5.png?rev=3201049)](https://ps.w.org/oa-social-login/trunk/screenshot-5.png?rev=3201049)

  **Login** – Login formular with small buttons (Social Network Buttons are included)

## Installation

#### Plugin Installation

1. Upload the plugin folder to the following directory of your WordPress site: `/wp-content/plugins/`,
2. Login to your WordPress admin area, go to the **Plugins** page and activate **Social Login** there,
3. Go to the **Settings\Social Login** page in your WordPress admin area and setup the plugin,
4. Click on the **Autodetect** and **Verify** buttons to make sure that the API connection is working properly.

#### API Connection

The social network APIs are constantly changing and being updated. We monitor these changes and automatically update our APIs, so that you can be sure that Social Login will always run smoothly and with the most up-to-date API calls.

In order to enable the plugin you must connect with the OneAll API and create a free account at [OneAll](https://app.oneall.com).

More information is available in our [Social Login Documentation](https://docs.oneall.com/plugins/guide/social-login-wordpress/).

## FAQ

### Do I have to add template tags to my theme?

You should not have to change your templates.

The Social Login plugin seamlessly integrates into your blog by using standard WordPress hooks.

### Can Social Login be embedded through a shortcode?

The Social Login shortcode `[oa_social_login]` can be used in any page or post within your WordPress blog.

The shortcode will automatically be replaced by the icons of the social networks that you have

enabled in the Social Login settings in your WordPress administration area.

### I have a custom template and the plugin is not displayed correctly

Social Login uses standard WordPress hooks. If your theme does not support these hooks,

you can add the Social Login form manually to your theme by inserting the following code

in your template (at the location where it should be displayed, i.e. above the comments).

```
<?php do_action('oa_social_login'); ?>

```

Do not hesitate to contact us if you need further assistance.

### My users cannot login or leave comment with VKontakte (Вконтакте)

Per default WordPress does not allow the use of special characters in usernames.

If you encounter any problems with users having cyrillic characters in their

usernames, please consider installing the following plugin to fix the problem:

[WordPress Special Characters In Usernames](https://wordpress.org/extend/plugins/wordpress-special-characters-in-usernames/)

### Do I have to change my Rewrite Settings?

Social Login does not rely on mod\_rewrite and does not need any additional rules.

It should work out of the box.

### Where can I report bugs, leave my feedback and get support?

Our team answers your questions at:

http://support.oneall.com/forums/

The plugin documentation is available at:

http://docs.oneall.com/plugins/guide/social-login-wordpress/

## Reviews

![](https://secure.gravatar.com/avatar/df81e61df3c701c45206df1fefccd329865a2264ea7a88ae9b0258876335dc85?s=60&d=retro&r=g)
### [Excellent plugging](https://wordpress.org/support/topic/excellent-plugging-2/)

[imilice](https://profiles.wordpress.org/imilice/ "Posts by imilice")
January 6, 2025

For now I just using free version because I developing my portal.

![](https://secure.gravatar.com/avatar/ad2ed95fae919a7a0fc4d0cba4c2c009e8e3abcfa7143309de2f7bec5512c946?s=60&d=retro&r=g)
### [Works, but could use updates](https://wordpress.org/support/topic/works-but-could-use-updates/)

[kontext](https://profiles.wordpress.org/kontext/ "Posts by kontext")
August 26, 2024
1 reply

After trying out another free WooCommerce compatible social login plugin, which didn’t work with X, OA Social Login seems to work well. Could use some small updates like for the social login icons though (still using the old Twitter logo).

![](https://secure.gravatar.com/avatar/97689728ed1cf384106cad42560d44a9d0015c674a10393594dd28b3b493bd05?s=60&d=retro&r=g)
### [Never a problem](https://wordpress.org/support/topic/never-a-problem-9/)

[dfl1955](https://profiles.wordpress.org/dfl1955/ "Posts by dfl1955")
August 15, 2024

It just works

![](https://secure.gravatar.com/avatar/d5a0370b98a2960a26c29a4c16f4c603b75747bd533187b5064f972a9a311ffc?s=60&d=retro&r=g)
### [Всё супер](https://wordpress.org/support/topic/%D0%B2%D1%81%D1%91-%D1%81%D1%83%D0%BF%D0%B5%D1%80-4/)

[demento](https://profiles.wordpress.org/demento/ "Posts by demento")
April 26, 2024

Плагин очень прост в настройке

![](https://secure.gravatar.com/avatar/7a27c21daad71a92ef6b39bfd6632c712cd24896b27d886e88f8b85382839705?s=60&d=retro&r=g)
### [Works!](https://wordpress.org/support/topic/works-2159/)

[rbuschmeyer](https://profiles.wordpress.org/rbuschmeyer/ "Posts by rbuschmeyer")
February 20, 2024

The plugin works flawlessly and is pretty easy to set up.

![](https://secure.gravatar.com/avatar/28cefe7a6e34ca5f5220e98c4d65794f4e956d748e01e5b240cabf9a4d494423?s=60&d=retro&r=g)
### [Using good](https://wordpress.org/support/topic/using-good/)

[vohungvi](https://profiles.wordpress.org/vohungvi/ "Posts by vohungvi")
November 14, 2023

I’m using on my site

[Read all 363 reviews](https://wordpress.org/support/plugin/oa-social-login/reviews/)
## Contributors & Developers

“Social Login” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/32ed5925a8d66b9b572d8ec6ceae8ebb342da06704cf93c1dc18a860846379d0?s=32&d=mm&r=g) [OneAll](https://profiles.wordpress.org/oneallcom/)
* ![](https://secure.gravatar.com/avatar/fc786c6f6751428fa7c731a09411be24519302db6a619ef376dfbcc4dc8c2ae9?s=32&d=mm&r=g) [Claude](https://profiles.wordpress.org/claudeschlesser/)
* ![](https://secure.gravatar.com/avatar/8ddd79e27987dc4af8beeb3596c531a384617f547c698e35ad50ea41423ce9aa?s=32&d=mm&r=g) [Social Login](https://profiles.wordpress.org/socialloginoneall/)

“Social Login” has been translated into 4 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/oa-social-login/contributors) for their contributions.

[Translate “Social Login” into your language.](https://translate.wordpress.org/projects/wp-plugins/oa-social-login)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/oa-social-login/), check out the [SVN repository](https://plugins.svn.wordpress.org/oa-social-login/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/oa-social-login/) by [RSS](https://plugins.trac.wordpress.org/log/oa-social-login/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 5.10.0

* Fix vulnerability

#### 5.9.0

* Social Network “X” added
* Twitter renamed to X

#### 5.8.1

* User Register hook fixed

#### 5.8.0

* Social Network “Epic Games” added
* Social Network “Spotify” added
* Social Network “Strava” added
* Social Network “Yandex” added

#### 5.7.0

* Social Network “Apple” added
* Social Network “Patreon” added

#### 5.6.1

* Direct Connect compatibily fixed

#### 5.6

* Responsive admin interface
* CSS Tweaks for better integration
* Default icons changed
* Linked social networks in user list
* Tested with WordPress 5.3

#### 5.5.1

* Notice fixed

#### 5.5.0

* Text domain fixed
* German translations updated

#### 5.4.4

* Social Network “Draugiem” added
* Social Network “Mixer” added
* Comment approval fixed
* New hooks added
* PHP 7.2 fixes

#### 5.4.3

* Warning missing quotes fixed

#### 5.4.2

* PHP 7.2+ compatibility added

#### 5.4.1

* User website URL truncated (WordPress restriction)

#### 5.4.0

* Social Network “Discord” added
* Social Network “Line” added
* Social Network “Meetup” added
* Social Network “SoundCloud” added
* Social Network “Tumblr” added
* Social Network “Weibo” added
* Social Network “XING” added

#### 5.3

* New icon set added
* Social Login interface improved
* Social Network avatar removed when unlinking account
* Social Link reviewed and improved
* Undefined index fixed

#### 5.2

* Buddypress avatar bugfix
* Do not create users without email addresses when plugin set to request emails
* Support for WP\_PROXY\_HOST added
* Filter for callback uri added
* More pannel added

#### 5.0

* Social Network “Battle.net” added
* Social Link Hooks/Nonce added
* WooCommerce Actions added
* Login/Registration URL filters added
* Cache bug fixed
* WooCommerce Social Login Twice on Register Form
* Some minor bugs fixed

#### 4.6

* Asynchronous JavaScript
* Social Network “Instagram” added
* Social Network “Vimeo” added
* Social Network “Reddit” added
* Social Network “Amazon” added
* French Translation Added
* Missing text domains added
* BuddyPress Avatars fixed
* Better WPEngine compatibility
* Email filter fixed

#### 4.5

* Social Network “Twitch” added
* User Biography is now imported
* Better API Connection detection
* Many hooks and filters added
* Port detection improved
* WP Nonce added for Social Link

#### 4.4

* Social Network “Xing” added

#### 4.3

* Social Network Avatars improved
* Social Link shortcode/hook/action added
* Administration: Tabs for Social Login added
* Administration: Column Registration in the user list fixed
* Redirection filters added
* Settings security improved
* Button to cancel email confirmation added

#### 4.0

* Social Link Service added
* Optimized for WordPress 3.5
* Meta “oa\_social\_login\_identity\_id” no longer used and removed
* German translations improved
* Social Network “YouTube” added
* Social Network “Odnoklassniki.ru” added
* Hook “after\_signup\_form” added

#### 3.7

* Hook for BuddyPress Registration added
* Hook for BuddyPress Sidebar added
* Hook for Appthemes Vantage Theme added
* Filter for email addresses of new users added
* Admin page width fixed
* Minor text changes
* Social Network “Blogger” added
* Social Network “Disqus” added

#### 3.6

* Debug Output Removed

#### 3.5

* Social Network “Foursquare.com” added
* Github 16x16px icon fixed
* Optionally get an email when a users registers with Social Login
* Redirection settings improved
* Hook for Thesis Theme added
* Hook for WordPress Profile Builder added
* Select to use Port 80 or 443
* Custom CSS filter added

#### 3.2

* Social Network “Skyrock.com” added
* Social Network “Github.com” added
* German translations improved

#### 3.1

* SSL detection improved
* Buddypress avatars improved

#### 3.0

* SSL detection with nginx load-balancer fixed
* CDN path bug fixed
* Table width in administration area fixed
* Administration split to two pages
* Optionally disable Social Login in comments
* Optionally request email from user
* Optionally show social networks in user list
* Social Network “Windows Mail” added
* Social Network “Mail.ru” added
* Error message if no social networks selected
* Class for Social Login label added
* Small icons fixed
* API settings verification fixed

#### 2.5

* API Connection improved
* API Connection function moved to separate file
* Contact us link fixed
* Social Network Avatars fixed
* HTML for administration area fixed
* FSOCKOPEN Handler Added
* CURL/FSOCKOPEN selector added
* Social Network “Steam Community” added
* Social Network “StackExchange” added
* CSS served from CDN
* Optionally disable comment moderation

#### 2.0

* WC3 Compliant callback uri
* HTTP/HTTPS Check for CSS files
* Shortcode handler fixed
* WordPress Cookie now set for 14 days
* WordPress display\_name is now populated
* Redirection improved
* Now Buddypress compatible
* Link to settings page after installation
* Caching for socialize library improved
* Small buttons added as option
* Localization added
* German translation

#### 1.6.1

* Provider unselect bug fixed
* Sanitize user strict added
* Custom namespace for add\_settings\_link

#### 1.6

* LiveJournal added
* PayPal added
* Settings link added
* API Communication Check added
* Cyrillic character support

#### 1.5

* Social Network Avatars fixed
* Social Buttons no longer displayed for customs hooks if logged in
* KISS for API Settings Setup

#### 1.4

* Social Network Avatars can be displayed in comments
* Social Login can be disabled below the login form
* Social Login can be disabled below the registration form
* Select redirection target after login
* Select redirection target after registration
* Enable account linking

#### 1.3.5

* Administration area redirection fixed
* Automatic email creation added
* Email verification added

#### 1.3.4

* Multisite issues with Widget fixed

#### 1.3.2

* Stable Version

#### 1.0.2

* Version numbers fixed

#### 1.0.1

* Hook oa\_social\_login fixed
* Plugin description changed

#### 1.0

* Initial release

## Meta

* Version **5.10.0**
* Last updated **1 month ago**
* Active installations **7,000+**
* WordPress version **3.0 or higher**
* Tested up to **6.7.1**
* PHP version **5.4 or higher**
* Languages
  See all 5

  Close

  [English (US)](https://wordpress.org/plugins/oa-social-login/), [French (Canada)](https://fr-ca.wordpress.org/plugins/oa-social-login/), [French (France)](https://fr.wordpress.org/plugins/oa-social-login/), [German](https://de.wordpress.org/plugins/oa-social-login/), and [Russian](https://ru.wordpress.org/plugins/oa-social-login/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/oa-social-login)
* Tags [Facebook login](https://wordpress.org/plugins/tags/facebook-login/)[linkedin login](https://wordpress.org/plugins/tags/linkedin-login/)[social login](https://wordpress.org/plugins/tags/social-login/)[twitter login](https://wordpress.org/plugins/tags/twitter-login/)
* [Advanced View](https://wordpress.org/plugins/oa-social-login/advanced/)

## Ratings

4.3 out of 5 stars.

* [287 5-star reviews
  5 stars

  287](https://wordpress.org/support/plugin/oa-social-login/reviews/?filter=5)
* [13 4-star reviews
  4 stars

  13](https://wordpress.org/support/plugin/oa-social-login/reviews/?filter=4)
* [7 3-star reviews
  3 stars

  7](https://wordpress.org/support/plugin/oa-social-login/reviews/?filter=3)
* [4 2-star reviews
  2 stars

  4](https://wordpress.org/support/plugin/oa-social-login/reviews/?filter=2)
* [52 1-star reviews
  1 star

  52](https://wordpress.org/support/plugin/oa-social-login/reviews/?filter=1)

[Add my review](https://wordpress.org/support/plugin/oa-social-login/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/oa-social-login/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/32ed5925a8d66b9b572d8ec6ceae8ebb342da06704cf93c1dc18a860846379d0?s=32&d=mm&r=g) [OneAll](https://profiles.wordpress.org/oneallcom/)
* ![](https://secure.gravatar.com/avatar/fc786c6f6751428fa7c731a09411be24519302db6a619ef376dfbcc4dc8c2ae9?s=32&d=mm&r=g) [Claude](https://profiles.wordpress.org/claudeschlesser/)
* ![](https://secure.gravatar.com/avatar/8ddd79e27987dc4af8beeb3596c531a384617f547c698e35ad50ea41423ce9aa?s=32&d=mm&r=g) [Social Login](https://profiles.wordpress.org/socialloginoneall/)
## Support

Issues resolved in last two months:

0 out of 1

[View support forum](https://wordpress.org/support/plugin/oa-social-login/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_cac18a79_20250115_094403.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Social Login <= 5.9.0 - Authentication Bypass

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Social Login <= 5.9.0 - Authentication Bypass

9.8

**Authentication Bypass Using an Alternate Path or Channel**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-10961](https://www.cve.org/CVERecord?id=CVE-2024-10961) |
| --- | --- |
| CVSS | 9.8 (Critical) |
| Publicly Published | November 22, 2024 |
| Last Updated | December 6, 2024 |
| Researcher | [wesley (wcraft)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/wesley-jhon) |

### Description

The Social Login plugin for WordPress is vulnerable to authentication bypass in all versions up to, and including, 5.9.0. This is due to insufficient verification on the user being returned by the social login token. This makes it possible for unauthenticated attackers to log in as any existing user on the site, such as an administrator, if they have access to the email and the user does not have an already-existing account for the service returning the token.

#### References

* [wordpress.org](https://wordpress.org/plugins/oa-social-login/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3201046/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Foa-social-login%2Fsocial-login-590-authentication-bypass&t=Social%20Login%20%3C%3D%205.9.0%20-%20Authentication%20Bypass "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Foa-social-login%2Fsocial-login-590-authentication-bypass&text=Social%20Login%20%3C%3D%205.9.0%20-%20Authentication%20Bypass "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Foa-social-login%2Fsocial-login-590-authentication-bypass "LinkedIn")
Email

## Vulnerability Details for Social Login

#### [Social Login](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/oa-social-login)

| Software Type | Plugin |
| --- | --- |
| Software Slug | oa-social-login [(view on wordpress.org)](https://wordpress.org/plugins/oa-social-login) |
| Patched? | Yes |
| Remediation | Update to version 5.10.0, or a newer patched version |
| Affected Version | * <= 5.9.0 |
| Patched Version | * 5.10.0 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_a47591ae_20250115_094357.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3201046)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3201045 "Changeset 3201045")
* [Next Changeset](/changeset/3201047 "Changeset 3201047") →

---

# Changeset 3201046

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
12/02/2024 03:57:01 PM
([6 weeks](/timeline?from=2024-12-02T15%3A57%3A01Z&precision=second "See timeline at 12/02/2024 03:57:01 PM") ago)

Author:
ClaudeSchlesser
Message:

Fix vulnerability + PCP checks

Location:
[oa-social-login/trunk](/browser/oa-social-login/trunk?rev=3201046)
Files:

9 edited

* [assets/css/admin.css](/browser/oa-social-login/trunk/assets/css/admin.css?rev=3201046 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [includes/admin.php](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046 "Show entry in browser")
  (modified)
  ([18 diffs](#file1 "Show differences"))
* [includes/communication.php](/browser/oa-social-login/trunk/includes/communication.php?rev=3201046 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [includes/settings.php](/browser/oa-social-login/trunk/includes/settings.php?rev=3201046 "Show entry in browser")
  (modified)
  ([1 diff](#file3 "Show differences"))
* [includes/toolbox.php](/browser/oa-social-login/trunk/includes/toolbox.php?rev=3201046 "Show entry in browser")
  (modified)
  ([5 diffs](#file4 "Show differences"))
* [includes/user\_interface.php](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046 "Show entry in browser")
  (modified)
  ([21 diffs](#file5 "Show differences"))
* [includes/widget.php](/browser/oa-social-login/trunk/includes/widget.php?rev=3201046 "Show entry in browser")
  (modified)
  ([6 diffs](#file6 "Show differences"))
* [oa-social-login.php](/browser/oa-social-login/trunk/oa-social-login.php?rev=3201046 "Show entry in browser")
  (modified)
  ([4 diffs](#file7 "Show differences"))
* [readme.txt](/browser/oa-social-login/trunk/readme.txt?rev=3201046 "Show entry in browser")
  (modified)
  ([3 diffs](#file8 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [oa-social-login/trunk/assets/css/admin.css](/changeset/3201046/oa-social-login/trunk/assets/css/admin.css "Show the changeset 3201046 restricted to oa-social-login/trunk/assets/css/admin.css")

  | [r3153096](/browser/oa-social-login/trunk/assets/css/admin.css?rev=3153096#L395 "Show revision 3153096 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/assets/css/admin.css?rev=3201046#L395 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 395 | 395 | } |
  | 396 | 396 |  |
  | 397 |  | ~~.oa\_social\_login\_provider\_disqus {~~ |
  | 398 |  | ~~background-position: -964px -1px;~~ |
  | 399 |  | ~~}~~ |
  | 400 |  |  |
  | 401 | 397 | .oa\_social\_login\_provider\_draugiem { |
  | 402 | 398 | background-position: -446px -1px; |
* ## [oa-social-login/trunk/includes/admin.php](/changeset/3201046/oa-social-login/trunk/includes/admin.php "Show the changeset 3201046 restricted to oa-social-login/trunk/includes/admin.php")

  | [r3153096](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L4 "Show revision 3153096 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L4 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Admin User List: Add header column |
  | 5 | 5 | \*\*/ |
  | 6 |  | function oa\_social\_login\_admin\_user\_column\_add($columns) |
  |  | 6 | function oa\_social\_login\_admin\_user\_column\_add($columns) |
  | 7 | 7 | { |
  | 8 |  | //Read settings |
  | 9 |  | ~~$settings = get\_option~~ ('oa\_social\_login\_settings'); |
  | 10 |  |  |
  | 11 |  | //Add column if enabled |
  | 12 |  | if (!empty ($settings ['plugin\_add\_column\_user\_list'])) |
  | 13 |  | { |
  | 14 |  | ~~$columns ['social\_networks'] = \_\_~~ ('Linked social networks', 'oa-social-login'); |
  | 15 |  | } |
  | 16 |  | return $columns; |
  |  | 8 | //Read settings |
  |  | 9 | $settings = get\_option('oa\_social\_login\_settings'); |
  |  | 10 |  |
  |  | 11 | //Add column if enabled |
  |  | 12 | if (!empty ($settings ['plugin\_add\_column\_user\_list'])) |
  |  | 13 | { |
  |  | 14 | $columns ['social\_networks'] = \_\_('Linked social networks', 'oa-social-login'); |
  |  | 15 | } |
  |  | 16 | return $columns; |
  | 17 | 17 | } |
  | 18 |  | add\_filter ('manage\_users\_columns', 'oa\_social\_login\_admin\_user\_column\_add'); |
  |  | 18 |  |
  |  | 19 | add\_filter('manage\_users\_columns', 'oa\_social\_login\_admin\_user\_column\_add'); |
  | 19 | 20 |  |
  | 20 | 21 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L22) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L23) |  |
  | 22 | 23 | \* Admin User List: Add column content. |
  | 23 | 24 | \*\*/ |
  | 24 |  | function oa\_social\_login\_admin\_user\_colum\_display($value, $column\_name, $user\_id) |
  |  | 25 | function oa\_social\_login\_admin\_user\_colum\_display($value, $column\_name, $user\_id) |
  | 25 | 26 | { |
  | 26 |  | //Check if it is our own column |
  | 27 |  | if ($column\_name <> 'social\_networks') |
  | 28 |  | { |
  | 29 |  | return $value; |
  | 30 |  | } |
  | 31 |  |  |
  | 32 |  | // Read identity providers. |
  | 33 |  | ~~$identity\_providers = trim (strval (get\_user\_meta~~ ($user\_id, 'oa\_social\_login\_identity\_provider', true))); |
  | 34 |  |  |
  | 35 |  | // Read user\_token. |
  | 36 |  | ~~$user\_token = trim (strval (get\_user\_meta~~ ($user\_id, 'oa\_social\_login\_user\_token', true))); |
  | 37 |  |  |
  | 38 |  | // Some have been found. |
  | 39 |  | ~~if ( !~~ empty ($identity\_providers)) |
  | 40 |  | { |
  | 41 |  | ~~$identity\_providers = array\_unique (explode~~ ("|", $identity\_providers)); |
  | 42 |  | $identity\_providers = array\_map("ucwords", $identity\_providers); |
  | 43 |  | } |
  | 44 |  | // None found. |
  | 45 |  | else |
  | 46 |  | { |
  | 47 |  | ~~$identity\_providers = array~~ (); |
  | 48 |  | } |
  | 49 |  |  |
  | 50 |  | // Social Login Registration. |
  | 51 |  | ~~if (count~~ ($identity\_providers) > 0) |
  | 52 |  | { |
  | 53 |  | ~~sort~~ ($identity\_providers); |
  | 54 |  |  |
  | 55 |  | // Link to app. |
  | 56 |  | $app\_link = 'https://app.oneall.com/user-explorer/'; |
  | 57 |  |  |
  | 58 |  | // Add token. |
  | 59 |  | ~~if ( !~~ empty ($user\_token)) |
  | 60 |  | { |
  | 61 |  | ~~$app\_link .= '?user\_token='.~~$user\_token; |
  | 62 |  | } |
  | 63 |  |  |
  | 64 |  | // Build label. |
  | 65 |  | ~~return '<a href="'.$app\_link.'" target="\_blank">'. implode ('</a>, <a href="'.$app\_link.'" target="\_blank">', $identity\_providers).~~'</a>'; |
  | 66 |  |  |
  | 67 |  | } |
  | 68 |  | // Traditional Registration. |
  | 69 |  | else |
  | 70 |  | { |
  | 71 |  | return '—'; |
  | 72 |  | } |
  |  | 27 | //Check if it is our own column |
  |  | 28 | if ($column\_name <> 'social\_networks') |
  |  | 29 | { |
  |  | 30 | return $value; |
  |  | 31 | } |
  |  | 32 |  |
  |  | 33 | // Read identity providers. |
  |  | 34 | $identity\_providers = trim(strval(get\_user\_meta($user\_id, 'oa\_social\_login\_identity\_provider', true))); |
  |  | 35 |  |
  |  | 36 | // Read user\_token. |
  |  | 37 | $user\_token = trim(strval(get\_user\_meta($user\_id, 'oa\_social\_login\_user\_token', true))); |
  |  | 38 |  |
  |  | 39 | // Some have been found. |
  |  | 40 | if (!empty ($identity\_providers)) |
  |  | 41 | { |
  |  | 42 | $identity\_providers = array\_unique(explode("|", $identity\_providers)); |
  |  | 43 | $identity\_providers = array\_map("ucwords", $identity\_providers); |
  |  | 44 | } |
  |  | 45 | // None found. |
  |  | 46 | else |
  |  | 47 | { |
  |  | 48 | $identity\_providers = array(); |
  |  | 49 | } |
  |  | 50 |  |
  |  | 51 | // Social Login Registration. |
  |  | 52 | if (count($identity\_providers) > 0) |
  |  | 53 | { |
  |  | 54 | sort($identity\_providers); |
  |  | 55 |  |
  |  | 56 | // Link to app. |
  |  | 57 | $app\_link = 'https://app.oneall.com/user-explorer/'; |
  |  | 58 |  |
  |  | 59 | // Add token. |
  |  | 60 | if (!empty ($user\_token)) |
  |  | 61 | { |
  |  | 62 | $app\_link .= '?user\_token=' . $user\_token; |
  |  | 63 | } |
  |  | 64 |  |
  |  | 65 | // Build label. |
  |  | 66 | return '<a href="' . $app\_link . '" target="\_blank">' . implode('</a>, <a href="' . $app\_link . '" target="\_blank">', $identity\_providers) . '</a>'; |
  |  | 67 |  |
  |  | 68 | } |
  |  | 69 | // Traditional Registration. |
  |  | 70 | else |
  |  | 71 | { |
  |  | 72 | return '—'; |
  |  | 73 | } |
  | 73 | 74 | } |
  |  | 75 |  |
  | 74 | 76 | /\*\* |
  | 75 | 77 | \* Admin User List: Sort column content. |
  | 76 | 78 | \*\*/ |
  | 77 |  | function oa\_social\_login\_admin\_user\_colum\_sort($columns) |
  |  | 79 | function oa\_social\_login\_admin\_user\_colum\_sort($columns) |
  | 78 | 80 | { |
  | 79 | 81 | $columns['social\_networks'] = 'oa\_social\_login\_registration'; |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L81) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L83) |  |
  | 81 | 83 | } |
  | 82 | 84 |  |
  | 83 |  | add\_action ('manage\_users\_custom\_column', 'oa\_social\_login\_admin\_user\_colum\_display', 10, 3); |
  | 84 |  | add\_filter ('manage\_users\_sortable\_columns', 'oa\_social\_login\_admin\_user\_colum\_sort'); |
  | 85 |  |  |
  |  | 85 | add\_action('manage\_users\_custom\_column', 'oa\_social\_login\_admin\_user\_colum\_display', 10, 3); |
  |  | 86 | add\_filter('manage\_users\_sortable\_columns', 'oa\_social\_login\_admin\_user\_colum\_sort'); |
  | 86 | 87 |  |
  | 87 | 88 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L89) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L90) |  |
  | 89 | 90 | \* Add administration area links |
  | 90 | 91 | \*\*/ |
  | 91 |  | function oa\_social\_login\_admin\_menu() |
  |  | 92 | function oa\_social\_login\_admin\_menu() |
  | 92 | 93 | { |
  | 93 |  | //Setup |
  | 94 |  | ~~$page = add\_menu\_page ('OneAll Social Login ' . \_\_~~ ('Setup', 'oa-social-login'), 'Social Login', 'manage\_options', 'oa\_social\_login\_setup', 'oa\_display\_social\_login\_setup'); |
  | 95 |  | ~~add\_action~~ ('admin\_print\_styles-' . $page, 'oa\_social\_login\_admin\_css'); |
  | 96 |  |  |
  | 97 |  | //Settings |
  | 98 |  | ~~$page = add\_submenu\_page ('oa\_social\_login\_setup', 'OneAll Social Login ' . \_\_ ('Settings'), \_\_ ('Settings~~'), 'manage\_options', 'oa\_social\_login\_settings', 'oa\_display\_social\_login\_settings'); |
  | 99 |  | ~~add\_action~~ ('admin\_print\_styles-' . $page, 'oa\_social\_login\_admin\_css'); |
  | 100 |  |  |
  | 101 |  | //Sharing |
  | 102 |  | ~~$page = add\_submenu\_page ('oa\_social\_login\_setup', 'OneAll Social Login ' . \_\_ ('+More'), \_\_ ('+More~~'), 'manage\_options', 'oa\_social\_login\_more', 'oa\_display\_social\_login\_more'); |
  | 103 |  | ~~add\_action~~ ('admin\_print\_styles-' . $page, 'oa\_social\_login\_admin\_css'); |
  | 104 |  |  |
  | 105 |  | //Fix Setup title |
  | 106 |  | global $submenu; |
  | 107 |  | ~~if (is\_array ($submenu) AND~~ isset ($submenu ['oa\_social\_login\_setup'])) |
  | 108 |  | { |
  | 109 |  | ~~$submenu ['oa\_social\_login\_setup'] [0] [0] = \_\_~~ ('Setup', 'oa-social-login'); |
  | 110 |  | } |
  | 111 |  | ~~add\_action~~ ('admin\_enqueue\_scripts', 'oa\_social\_login\_admin\_js'); |
  | 112 |  | ~~add\_action~~ ('admin\_init', 'oa\_register\_social\_login\_settings'); |
  | 113 |  | ~~add\_action~~ ('admin\_notices', 'oa\_social\_login\_admin\_message'); |
  | 114 |  | ~~add\_action~~ ('admin\_notices', 'oa\_social\_login\_admin\_ask\_review'); |
  |  | 94 | //Setup |
  |  | 95 | $page = add\_menu\_page('OneAll Social Login ' . \_\_('Setup', 'oa-social-login'), 'Social Login', 'manage\_options', 'oa\_social\_login\_setup', 'oa\_display\_social\_login\_setup'); |
  |  | 96 | add\_action('admin\_print\_styles-' . $page, 'oa\_social\_login\_admin\_css'); |
  |  | 97 |  |
  |  | 98 | //Settings |
  |  | 99 | $page = add\_submenu\_page('oa\_social\_login\_setup', 'OneAll Social Login ' . \_\_('Settings', 'oa-social-login'), \_\_('Settings', 'oa-social-login'), 'manage\_options', 'oa\_social\_login\_settings', 'oa\_display\_social\_login\_settings'); |
  |  | 100 | add\_action('admin\_print\_styles-' . $page, 'oa\_social\_login\_admin\_css'); |
  |  | 101 |  |
  |  | 102 | //Sharing |
  |  | 103 | $page = add\_submenu\_page('oa\_social\_login\_setup', 'OneAll Social Login ' . \_\_('+More', 'oa-social-login'), \_\_('+More', 'oa-social-login'), 'manage\_options', 'oa\_social\_login\_more', 'oa\_display\_social\_login\_more'); |
  |  | 104 | add\_action('admin\_print\_styles-' . $page, 'oa\_social\_login\_admin\_css'); |
  |  | 105 |  |
  |  | 106 | //Fix Setup title |
  |  | 107 | global $submenu; |
  |  | 108 | if (is\_array($submenu) and isset ($submenu ['oa\_social\_login\_setup'])) |
  |  | 109 | { |
  |  | 110 | $submenu ['oa\_social\_login\_setup'] [0] [0] = \_\_('Setup', 'oa-social-login'); |
  |  | 111 | } |
  |  | 112 | add\_action('admin\_enqueue\_scripts', 'oa\_social\_login\_admin\_js'); |
  |  | 113 | add\_action('admin\_init', 'oa\_register\_social\_login\_settings'); |
  |  | 114 | add\_action('admin\_notices', 'oa\_social\_login\_admin\_message'); |
  |  | 115 | add\_action('admin\_notices', 'oa\_social\_login\_admin\_ask\_review'); |
  | 115 | 116 | } |
  | 116 |  | add\_action ('admin\_menu', 'oa\_social\_login\_admin\_menu'); |
  |  | 117 |  |
  |  | 118 | add\_action('admin\_menu', 'oa\_social\_login\_admin\_menu'); |
  | 117 | 119 |  |
  | 118 | 120 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L120) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L122) |  |
  | 120 | 122 | \* Automatically approve comments if option enabled |
  | 121 | 123 | \*\*/ |
  | 122 |  | function oa\_social\_login\_admin\_pre\_comment\_approved($approved) |
  |  | 124 | function oa\_social\_login\_admin\_pre\_comment\_approved($approved) |
  | 123 | 125 | { |
  | 124 |  | // No need to do the check if the comment has already been approved. |
  | 125 |  | if (empty ($approved)) |
  | 126 |  | { |
  | 127 |  | // Read settings. |
  | 128 |  | ~~$settings = get\_option~~ ('oa\_social\_login\_settings'); |
  | 129 |  |  |
  | 130 |  | // Check if pre approval is enabled. |
  | 131 |  | if (!empty ($settings ['plugin\_comment\_auto\_approve'])) |
  | 132 |  | { |
  | 133 |  | // Read comment user. |
  | 134 |  | ~~$user\_id = get\_current\_user\_id~~ (); |
  | 135 |  | ~~if (is\_numeric~~ ($user\_id)) |
  | 136 |  | { |
  | 137 |  | // Read user token. |
  | 138 |  | ~~$user\_token = trim (get\_user\_meta~~ ($user\_id, 'oa\_social\_login\_user\_token', true)); |
  | 139 |  |  |
  | 140 |  | // If not empty, it's a social login user. |
  | 141 |  | ~~if ( !~~ empty ($user\_token)) |
  | 142 |  | { |
  | 143 |  | $approved = 1; |
  | 144 |  | } |
  | 145 |  | } |
  | 146 |  | } |
  | 147 |  | } |
  | 148 |  | return $approved; |
  |  | 126 | // No need to do the check if the comment has already been approved. |
  |  | 127 | if (empty ($approved)) |
  |  | 128 | { |
  |  | 129 | // Read settings. |
  |  | 130 | $settings = get\_option('oa\_social\_login\_settings'); |
  |  | 131 |  |
  |  | 132 | // Check if pre approval is enabled. |
  |  | 133 | if (!empty ($settings ['plugin\_comment\_auto\_approve'])) |
  |  | 134 | { |
  |  | 135 | // Read comment user. |
  |  | 136 | $user\_id = get\_current\_user\_id(); |
  |  | 137 | if (is\_numeric($user\_id)) |
  |  | 138 | { |
  |  | 139 | // Read user token. |
  |  | 140 | $user\_token = trim(get\_user\_meta($user\_id, 'oa\_social\_login\_user\_token', true)); |
  |  | 141 |  |
  |  | 142 | // If not empty, it's a social login user. |
  |  | 143 | if (!empty ($user\_token)) |
  |  | 144 | { |
  |  | 145 | $approved = 1; |
  |  | 146 | } |
  |  | 147 | } |
  |  | 148 | } |
  |  | 149 | } |
  |  | 150 | return $approved; |
  | 149 | 151 | } |
  | 150 |  | add\_action ('pre\_comment\_approved', 'oa\_social\_login\_admin\_pre\_comment\_approved'); |
  |  | 152 |  |
  |  | 153 | add\_action('pre\_comment\_approved', 'oa\_social\_login\_admin\_pre\_comment\_approved'); |
  | 151 | 154 |  |
  | 152 | 155 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L154) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L157) |  |
  | 154 | 157 | \* Add an activation message to be displayed once. |
  | 155 | 158 | \*/ |
  | 156 |  | function oa\_social\_login\_admin\_message() |
  |  | 159 | function oa\_social\_login\_admin\_message() |
  | 157 | 160 | { |
  | 158 |  | if (get\_option ('oa\_social\_login\_activation\_message') !== '1') |
  | 159 |  | { |
  | 160 |  | echo '<div class="updated"><p><strong>' . \_\_ ('Thank you for using Social Login!', 'oa-social-login') . '</strong> ' . sprintf (\_\_ ('Please complete the <strong><a href="%s">Social Login Setup</a></strong> to enable the plugin.', 'oa-social-login'), 'admin.php?page=oa\_social\_login\_setup') . '</p></div>'; |
  | 161 |  | update\_option ('oa\_social\_login\_activation\_message', '1'); |
  | 162 |  | } |
  |  | 161 | if (get\_option('oa\_social\_login\_activation\_message') !== '1') |
  |  | 162 | { |
  |  | 163 | /\* translators: %s: website link \*/ |
  |  | 164 | $message = sprintf(\_\_('Please complete the <strong><a href="%s">Social Login Setup</a></strong> to enable the plugin.', 'oa-social-login'), 'admin.php?page=oa\_social\_login\_setup'); |
  |  | 165 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 166 | echo '<div class="updated"><p><strong>' . \_\_('Thank you for using Social Login!', 'oa-social-login') . '</strong> ' . $message . '</p></div>'; |
  |  | 167 | update\_option('oa\_social\_login\_activation\_message', '1'); |
  |  | 168 | } |
  | 163 | 169 | } |
  | 164 | 170 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L166) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L172) |  |
  | 166 | 172 | \* Add a request to review the plugin. |
  | 167 | 173 | \*/ |
  | 168 |  | function oa\_social\_login\_admin\_ask\_review() |
  |  | 174 | function oa\_social\_login\_admin\_ask\_review() |
  | 169 | 175 | { |
  | 170 | 176 | // Treshhold. |
  | 171 | 177 | $user\_treshold = 10; |
  | 172 |  |  |
  |  | 178 |  |
  | 173 | 179 | // Postpone duration. |
  | 174 | 180 | $postpone\_duration = (24 \* 60 \* 60 \* 7); |
  | 175 |  |  |
  |  | 181 |  |
  | 176 | 182 | // Make sure the message is not disabled. |
  | 177 |  | if (get\_option('oa\_social\_login\_hide\_rate\_message') !== '1') |
  |  | 183 | if (get\_option('oa\_social\_login\_hide\_rate\_message') !== '1') |
  | 178 | 184 | { |
  | 179 | 185 | // Make sure the message has not been postponed. |
  | 180 |  | if (get\_option('oa\_social\_login\_postpone\_rate\_message', 0) < time()) |
  |  | 186 | if (get\_option('oa\_social\_login\_postpone\_rate\_message', 0) < time()) |
  | 181 | 187 | { |
  | 182 | 188 | // Action. |
  | 183 |  | $action = (!~~empty ($\_GET['oa\_social\_login\_rate']) ? strtolower(trim~~ ($\_GET['oa\_social\_login\_rate'])) : ''); |
  | 184 |  |  |
  |  | 189 | $action = (!empty ($\_GET['oa\_social\_login\_rate']) ? strtolower(trim($\_GET['oa\_social\_login\_rate'])) : ''); |
  |  | 190 |  |
  | 185 | 191 | // Postpone message. |
  | 186 | 192 | if ($action == 'later') |
  | 187 | 193 | { |
  | 188 |  | update\_option('oa\_social\_login\_postpone\_rate\_message', (time() + $postpone\_duration)); |
  |  | 194 | update\_option('oa\_social\_login\_postpone\_rate\_message', (time() + $postpone\_duration)); |
  | 189 | 195 | } |
  | 190 | 196 | // Mark done. |
  | 191 | 197 | elseif ($action == 'done') |
  | 192 | 198 | { |
  | 193 |  | update\_option('oa\_social\_login\_hide\_rate\_message', 1); |
  |  | 199 | update\_option('oa\_social\_login\_hide\_rate\_message', 1); |
  | 194 | 200 | } |
  | 195 | 201 | // Display message. |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L197) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L203) |  |
  | 197 | 203 | { |
  | 198 | 204 | // Don't display for POST requests, as we can't compute the required url arguments. |
  | 199 |  | if (!isset ($\_SERVER['REQUEST\_METHOD']) || strtoupper(trim($\_SERVER['REQUEST\_METHOD'])) != 'POST') |
  |  | 205 | if (!isset ($\_SERVER['REQUEST\_METHOD']) || strtoupper(trim($\_SERVER['REQUEST\_METHOD'])) != 'POST') |
  | 200 | 206 | { |
  | 201 | 207 | // Make sure we have enough users. |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L204) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L210) |  |
  | 204 | 210 | // Current url. |
  | 205 | 211 | $url = oa\_social\_login\_get\_current\_url(); |
  | 206 |  |  |
  |  | 212 |  |
  | 207 | 213 | // Build message. |
  | 208 |  | $message = array(); |
  |  | 214 | $message = array(); |
  | 209 | 215 | $message[] = '<div class="updated">'; |
  | 210 | 216 | $message[] = ' <p style="font-size:16px; margin: 5px 0 0 0;color: #218029">'; |
  | 211 |  | $message[] = '  <strong>' . sprintf (\_\_ ("Hey, I noticed that more than %s users have already connected using Social Login - that's awesome!", 'oa-social-login'), $user\_treshold) .'</strong>'; |
  |  | 217 | /\* translators: %s: user numbers \*/ |
  |  | 218 | $message[] = '  <strong>' . sprintf(\_\_("Hey, I noticed that more than %s users have already connected using Social Login - that's awesome!", 'oa-social-login'), $user\_treshold) . '</strong>'; |
  | 212 | 219 | $message[] = ' </p>'; |
  | 213 | 220 | $message[] = ' <p style="font-size:14px; margin: 0 0 5px 0;">'; |
  | 214 |  | $message[] = '  '~~.\_\_("It's great to see that the plugin works for you! Could you please do me a BIG favor and give it a 5-star rating on WordPress? ", 'oa-social-login') .~~'<br>'; |
  | 215 |  | $message[] = '  '~~.~~\_\_("Just to help us spread the word and boost our motivation. Thank you so much!", 'oa-social-login'); |
  |  | 221 | $message[] = '  ' . \_\_("It's great to see that the plugin works for you! Could you please do me a BIG favor and give it a 5-star rating on WordPress? ", 'oa-social-login') . '<br>'; |
  |  | 222 | $message[] = '  ' . \_\_("Just to help us spread the word and boost our motivation. Thank you so much!", 'oa-social-login'); |
  | 216 | 223 | $message[] = ' </p>'; |
  | 217 | 224 | $message[] = ' <p style="font-size:14px; margin: 0 0 10px 0;">'; |
  | 218 |  | $message[] = '  <a class="button-primary" href="https://wordpress.org/support/plugin/oa-social-login/reviews/?filter=5#new-post" target="\_blank">'~~. \_\_ ("Ok, you deserve it", 'oa-social-login').~~'</a>'; |
  | 219 |  | $message[] = '  <a class="button-secondary" href="'~~.add\_query\_arg ('oa\_social\_login\_rate', 'later', $url).'">'. \_\_ ("Not now, maybe later", 'oa-social-login').~~'</a>'; |
  | 220 |  | $message[] = '  <a class="button-secondary" href="'~~.add\_query\_arg ('oa\_social\_login\_rate', 'done', $url).'">'. \_\_ ("I already did", 'oa-social-login').~~'</a>'; |
  |  | 225 | $message[] = '  <a class="button-primary" href="https://wordpress.org/support/plugin/oa-social-login/reviews/?filter=5#new-post" target="\_blank">' . \_\_("Ok, you deserve it", 'oa-social-login') . '</a>'; |
  |  | 226 | $message[] = '  <a class="button-secondary" href="' . add\_query\_arg('oa\_social\_login\_rate', 'later', $url) . '">' . \_\_("Not now, maybe later", 'oa-social-login') . '</a>'; |
  |  | 227 | $message[] = '  <a class="button-secondary" href="' . add\_query\_arg('oa\_social\_login\_rate', 'done', $url) . '">' . \_\_("I already did", 'oa-social-login') . '</a>'; |
  | 221 | 228 | $message[] = ' </p>'; |
  | 222 | 229 | $message[] = '</div>'; |
  | 223 |  |  |
  | 224 |  | /~~/ Display message.~~ |
  | 225 |  | echo implode("\n", $message); |
  |  | 230 |  |
  |  | 231 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 232 | echo implode("\n", $message); |
  | 226 | 233 | } |
  | 227 | 234 | } |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L234) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L241) |  |
  | 234 | 241 | \* Autodetect API Connection Handler |
  | 235 | 242 | \*/ |
  | 236 |  | function oa\_social\_login\_admin\_autodetect\_api\_connection\_handler() |
  |  | 243 | function oa\_social\_login\_admin\_autodetect\_api\_connection\_handler() |
  | 237 | 244 | { |
  | 238 |  | //Check AJAX Nonce |
  | 239 |  | ~~check\_ajax\_referer~~ ('oa\_social\_login\_ajax\_nonce'); |
  | 240 |  |  |
  | 241 |  | //Check if CURL is available |
  | 242 |  | ~~if (oa\_social\_login\_check\_curl\_available~~ ()) |
  | 243 |  | { |
  | 244 |  | //Check CURL HTTPS - Port 443 |
  | 245 |  | ~~if (oa\_social\_login\_check\_curl~~ (true) === true) |
  | 246 |  | { |
  | 247 |  | echo 'success\_autodetect\_api\_curl\_https'; |
  | 248 |  | die (); |
  | 249 |  | } |
  | 250 |  | //Check CURL HTTP - Port 80 |
  | 251 |  | ~~elseif (oa\_social\_login\_check\_curl~~ (false) === true) |
  | 252 |  | { |
  | 253 |  | echo 'success\_autodetect\_api\_curl\_http'; |
  | 254 |  | die (); |
  | 255 |  | } |
  | 256 |  | else |
  | 257 |  | { |
  | 258 |  | echo 'error\_autodetect\_api\_curl\_ports\_blocked'; |
  | 259 |  | die (); |
  | 260 |  | } |
  | 261 |  | } |
  | 262 |  | //Check if FSOCKOPEN is available |
  | 263 |  | elseif (oa\_social\_login\_check\_fsockopen\_available()) |
  | 264 |  | { |
  | 265 |  | //Check FSOCKOPEN HTTPS - Port 443 |
  | 266 |  | ~~if (oa\_social\_login\_check\_fsockopen~~ (true) == true) |
  | 267 |  | { |
  | 268 |  | echo 'success\_autodetect\_api\_fsockopen\_https'; |
  | 269 |  | die (); |
  | 270 |  | } |
  | 271 |  | //Check FSOCKOPEN HTTP - Port 80 |
  | 272 |  | ~~elseif (oa\_social\_login\_check\_fsockopen~~ (false) == true) |
  | 273 |  | { |
  | 274 |  | echo 'success\_autodetect\_api\_fsockopen\_http'; |
  | 275 |  | die (); |
  | 276 |  | } |
  | 277 |  | else |
  | 278 |  | { |
  | 279 |  | echo 'error\_autodetect\_api\_fsockopen\_ports\_blocked'; |
  | 280 |  | die (); |
  | 281 |  | } |
  | 282 |  | } |
  | 283 |  |  |
  | 284 |  | //No working handler found |
  | 285 |  | echo 'error\_autodetect\_api\_no\_handler'; |
  | 286 |  | die (); |
  |  | 245 | //Check AJAX Nonce |
  |  | 246 | check\_ajax\_referer('oa\_social\_login\_ajax\_nonce'); |
  |  | 247 |  |
  |  | 248 | //Check if CURL is available |
  |  | 249 | if (oa\_social\_login\_check\_curl\_available()) |
  |  | 250 | { |
  |  | 251 | //Check CURL HTTPS - Port 443 |
  |  | 252 | if (oa\_social\_login\_check\_curl(true) === true) |
  |  | 253 | { |
  |  | 254 | echo 'success\_autodetect\_api\_curl\_https'; |
  |  | 255 | die (); |
  |  | 256 | } |
  |  | 257 | //Check CURL HTTP - Port 80 |
  |  | 258 | elseif (oa\_social\_login\_check\_curl(false) === true) |
  |  | 259 | { |
  |  | 260 | echo 'success\_autodetect\_api\_curl\_http'; |
  |  | 261 | die (); |
  |  | 262 | } |
  |  | 263 | else |
  |  | 264 | { |
  |  | 265 | echo 'error\_autodetect\_api\_curl\_ports\_blocked'; |
  |  | 266 | die (); |
  |  | 267 | } |
  |  | 268 | } |
  |  | 269 | //Check if FSOCKOPEN is available |
  |  | 270 | elseif (oa\_social\_login\_check\_fsockopen\_available()) |
  |  | 271 | { |
  |  | 272 | //Check FSOCKOPEN HTTPS - Port 443 |
  |  | 273 | if (oa\_social\_login\_check\_fsockopen(true) == true) |
  |  | 274 | { |
  |  | 275 | echo 'success\_autodetect\_api\_fsockopen\_https'; |
  |  | 276 | die (); |
  |  | 277 | } |
  |  | 278 | //Check FSOCKOPEN HTTP - Port 80 |
  |  | 279 | elseif (oa\_social\_login\_check\_fsockopen(false) == true) |
  |  | 280 | { |
  |  | 281 | echo 'success\_autodetect\_api\_fsockopen\_http'; |
  |  | 282 | die (); |
  |  | 283 | } |
  |  | 284 | else |
  |  | 285 | { |
  |  | 286 | echo 'error\_autodetect\_api\_fsockopen\_ports\_blocked'; |
  |  | 287 | die (); |
  |  | 288 | } |
  |  | 289 | } |
  |  | 290 |  |
  |  | 291 | //No working handler found |
  |  | 292 | echo 'error\_autodetect\_api\_no\_handler'; |
  |  | 293 | die (); |
  | 287 | 294 | } |
  | 288 |  | add\_action ('wp\_ajax\_oa\_social\_login\_autodetect\_api\_connection\_handler', 'oa\_social\_login\_admin\_autodetect\_api\_connection\_handler'); |
  |  | 295 |  |
  |  | 296 | add\_action('wp\_ajax\_oa\_social\_login\_autodetect\_api\_connection\_handler', 'oa\_social\_login\_admin\_autodetect\_api\_connection\_handler'); |
  | 289 | 297 |  |
  | 290 | 298 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L292) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L300) |  |
  | 292 | 300 | \* Check API Settings through an Ajax Call |
  | 293 | 301 | \*/ |
  | 294 |  | function oa\_social\_login\_admin\_check\_api\_settings() |
  |  | 302 | function oa\_social\_login\_admin\_check\_api\_settings() |
  | 295 | 303 | { |
  | 296 |  | ~~check\_ajax\_referer~~ ('oa\_social\_login\_ajax\_nonce'); |
  | 297 |  |  |
  | 298 |  | //Check if all fields have been filled out |
  | 299 |  | ~~if (empty ($\_POST ['api\_subdomain']) OR empty ($\_POST ['api\_key']) OR~~ empty ($\_POST ['api\_secret'])) |
  | 300 |  | { |
  | 301 |  | echo 'error\_not\_all\_fields\_filled\_out'; |
  | 302 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 303 |  | die (); |
  | 304 |  | } |
  | 305 |  |  |
  | 306 |  | //Check the handler |
  | 307 |  | ~~$api\_connection\_handler = ((!empty ($\_POST ['api\_connection\_handler']) AND~~ $\_POST ['api\_connection\_handler'] == 'fsockopen') ? 'fsockopen' : 'curl'); |
  | 308 |  | ~~$api\_connection\_use\_https = ((!isset ($\_POST ['api\_connection\_use\_https']) OR~~ $\_POST ['api\_connection\_use\_https'] == '1') ? true : false); |
  | 309 |  |  |
  | 310 |  | //FSOCKOPEN |
  | 311 |  | if ($api\_connection\_handler == 'fsockopen') |
  | 312 |  | { |
  | 313 |  | ~~if (!oa\_social\_login\_check\_fsockopen~~ ($api\_connection\_use\_https)) |
  | 314 |  | { |
  | 315 |  | echo 'error\_selected\_handler\_faulty'; |
  | 316 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 317 |  | die (); |
  | 318 |  | } |
  | 319 |  | } |
  | 320 |  | //CURL |
  | 321 |  | else |
  | 322 |  | { |
  | 323 |  | ~~if (!oa\_social\_login\_check\_curl~~ ($api\_connection\_use\_https)) |
  | 324 |  | { |
  | 325 |  | echo 'error\_selected\_handler\_faulty'; |
  | 326 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 327 |  | die (); |
  | 328 |  | } |
  | 329 |  | } |
  | 330 |  |  |
  | 331 |  | ~~$api\_subdomain = trim (strtolower~~ ($\_POST ['api\_subdomain'])); |
  | 332 |  | ~~$api\_key = trim~~ ($\_POST ['api\_key']); |
  | 333 |  | ~~$api\_secret = trim~~ ($\_POST ['api\_secret']); |
  | 334 |  |  |
  | 335 |  | //Full domain entered |
  | 336 |  | ~~if (preg\_match~~ ("/([a-z0-9\-]+)\.api\.oneall\.com/i", $api\_subdomain, $matches)) |
  | 337 |  | { |
  | 338 |  | $api\_subdomain = $matches [1]; |
  | 339 |  | } |
  | 340 |  |  |
  | 341 |  | //Check subdomain format |
  | 342 |  | ~~if (!preg\_match~~ ("/^[a-z0-9\-]+$/i", $api\_subdomain)) |
  | 343 |  | { |
  | 344 |  | echo 'error\_subdomain\_wrong\_syntax'; |
  | 345 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 346 |  | die (); |
  | 347 |  | } |
  | 348 |  |  |
  | 349 |  | //Domain |
  | 350 |  | $api\_domain = $api\_subdomain . '.api.oneall.com'; |
  | 351 |  |  |
  | 352 |  | //Connection to |
  | 353 |  | $api\_resource\_url = ($api\_connection\_use\_https ? 'https' : 'http') . '://' . $api\_domain . '/tools/ping.json'; |
  | 354 |  |  |
  | 355 |  | //Get connection details |
  | 356 |  | ~~$result = oa\_social\_login\_do\_api\_request ($api\_connection\_handler, $api\_resource\_url, array~~ ('api\_key' => $api\_key, 'api\_secret' => $api\_secret), 15); |
  | 357 |  |  |
  | 358 |  | //Parse result |
  | 359 |  | ~~if (is\_object ($result) AND property\_exists ($result, 'http\_code') AND property\_exists~~ ($result, 'http\_data')) |
  | 360 |  | { |
  | 361 |  | switch ($result->http\_code) |
  | 362 |  | { |
  | 363 |  | //Success |
  | 364 |  | case 200: |
  | 365 |  | echo 'success'; |
  | 366 |  | ~~update\_option~~ ('oa\_social\_login\_api\_settings\_verified', '1'); |
  | 367 |  | break; |
  | 368 |  |  |
  | 369 |  | //Authentication Error |
  | 370 |  | case 401: |
  | 371 |  | echo 'error\_authentication\_credentials\_wrong'; |
  | 372 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 373 |  | break; |
  | 374 |  |  |
  | 375 |  | //Wrong Subdomain |
  | 376 |  | case 404: |
  | 377 |  | echo 'error\_subdomain\_wrong'; |
  | 378 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 379 |  | break; |
  | 380 |  |  |
  | 381 |  | //Other error |
  | 382 |  | default: |
  | 383 |  | echo 'error\_communication'; |
  | 384 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 385 |  | break; |
  | 386 |  | } |
  | 387 |  | } |
  | 388 |  | else |
  | 389 |  | { |
  | 390 |  | echo 'error\_communication'; |
  | 391 |  | ~~delete\_option~~ ('oa\_social\_login\_api\_settings\_verified'); |
  | 392 |  | } |
  | 393 |  | die (); |
  |  | 304 | check\_ajax\_referer('oa\_social\_login\_ajax\_nonce'); |
  |  | 305 |  |
  |  | 306 | //Check if all fields have been filled out |
  |  | 307 | if (empty ($\_POST ['api\_subdomain']) or empty ($\_POST ['api\_key']) or empty ($\_POST ['api\_secret'])) |
  |  | 308 | { |
  |  | 309 | echo 'error\_not\_all\_fields\_filled\_out'; |
  |  | 310 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 311 | die (); |
  |  | 312 | } |
  |  | 313 |  |
  |  | 314 | //Check the handler |
  |  | 315 | $api\_connection\_handler = ((!empty ($\_POST ['api\_connection\_handler']) and $\_POST ['api\_connection\_handler'] == 'fsockopen') ? 'fsockopen' : 'curl'); |
  |  | 316 | $api\_connection\_use\_https = ((!isset ($\_POST ['api\_connection\_use\_https']) or $\_POST ['api\_connection\_use\_https'] == '1') ? true : false); |
  |  | 317 |  |
  |  | 318 | //FSOCKOPEN |
  |  | 319 | if ($api\_connection\_handler == 'fsockopen') |
  |  | 320 | { |
  |  | 321 | if (!oa\_social\_login\_check\_fsockopen($api\_connection\_use\_https)) |
  |  | 322 | { |
  |  | 323 | echo 'error\_selected\_handler\_faulty'; |
  |  | 324 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 325 | die (); |
  |  | 326 | } |
  |  | 327 | } |
  |  | 328 | //CURL |
  |  | 329 | else |
  |  | 330 | { |
  |  | 331 | if (!oa\_social\_login\_check\_curl($api\_connection\_use\_https)) |
  |  | 332 | { |
  |  | 333 | echo 'error\_selected\_handler\_faulty'; |
  |  | 334 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 335 | die (); |
  |  | 336 | } |
  |  | 337 | } |
  |  | 338 |  |
  |  | 339 | $api\_subdomain = trim(strtolower($\_POST ['api\_subdomain'])); |
  |  | 340 | $api\_key = trim($\_POST ['api\_key']); |
  |  | 341 | $api\_secret = trim($\_POST ['api\_secret']); |
  |  | 342 |  |
  |  | 343 | //Full domain entered |
  |  | 344 | if (preg\_match("/([a-z0-9\-]+)\.api\.oneall\.com/i", $api\_subdomain, $matches)) |
  |  | 345 | { |
  |  | 346 | $api\_subdomain = $matches [1]; |
  |  | 347 | } |
  |  | 348 |  |
  |  | 349 | //Check subdomain format |
  |  | 350 | if (!preg\_match("/^[a-z0-9\-]+$/i", $api\_subdomain)) |
  |  | 351 | { |
  |  | 352 | echo 'error\_subdomain\_wrong\_syntax'; |
  |  | 353 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 354 | die (); |
  |  | 355 | } |
  |  | 356 |  |
  |  | 357 | //Domain |
  |  | 358 | $api\_domain = $api\_subdomain . '.api.oneall.com'; |
  |  | 359 |  |
  |  | 360 | //Connection to |
  |  | 361 | $api\_resource\_url = ($api\_connection\_use\_https ? 'https' : 'http') . '://' . $api\_domain . '/tools/ping.json'; |
  |  | 362 |  |
  |  | 363 | //Get connection details |
  |  | 364 | $result = oa\_social\_login\_do\_api\_request($api\_connection\_handler, $api\_resource\_url, array('api\_key' => $api\_key, 'api\_secret' => $api\_secret), 15); |
  |  | 365 |  |
  |  | 366 | //Parse result |
  |  | 367 | if (is\_object($result) and property\_exists($result, 'http\_code') and property\_exists($result, 'http\_data')) |
  |  | 368 | { |
  |  | 369 | switch ($result->http\_code) |
  |  | 370 | { |
  |  | 371 | //Success |
  |  | 372 | case 200: |
  |  | 373 | echo 'success'; |
  |  | 374 | update\_option('oa\_social\_login\_api\_settings\_verified', '1'); |
  |  | 375 | break; |
  |  | 376 |  |
  |  | 377 | //Authentication Error |
  |  | 378 | case 401: |
  |  | 379 | echo 'error\_authentication\_credentials\_wrong'; |
  |  | 380 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 381 | break; |
  |  | 382 |  |
  |  | 383 | //Wrong Subdomain |
  |  | 384 | case 404: |
  |  | 385 | echo 'error\_subdomain\_wrong'; |
  |  | 386 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 387 | break; |
  |  | 388 |  |
  |  | 389 | //Other error |
  |  | 390 | default: |
  |  | 391 | echo 'error\_communication'; |
  |  | 392 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 393 | break; |
  |  | 394 | } |
  |  | 395 | } |
  |  | 396 | else |
  |  | 397 | { |
  |  | 398 | echo 'error\_communication'; |
  |  | 399 | delete\_option('oa\_social\_login\_api\_settings\_verified'); |
  |  | 400 | } |
  |  | 401 | die (); |
  | 394 | 402 | } |
  | 395 |  | add\_action ('wp\_ajax\_oa\_social\_login\_check\_api\_settings', 'oa\_social\_login\_admin\_check\_api\_settings'); |
  |  | 403 |  |
  |  | 404 | add\_action('wp\_ajax\_oa\_social\_login\_check\_api\_settings', 'oa\_social\_login\_admin\_check\_api\_settings'); |
  | 396 | 405 |  |
  | 397 | 406 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L399) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L408) |  |
  | 399 | 408 | \* Add Settings JS |
  | 400 | 409 | \*\*/ |
  | 401 |  | function oa\_social\_login\_admin\_js($hook) |
  |  | 410 | function oa\_social\_login\_admin\_js($hook) |
  | 402 | 411 | { |
  | 403 |  | if (stripos ($hook, 'oa\_social\_login') !== false) |
  | 404 |  | { |
  | 405 |  | if (!wp\_script\_is ('oa\_social\_login\_admin\_js', 'registered')) |
  | 406 |  | { |
  | 407 |  | wp\_register\_script ('oa\_social\_login\_admin\_js', OA\_SOCIAL\_LOGIN\_PLUGIN\_URL . "/assets/js/admin.js"); |
  | 408 |  | } |
  | 409 |  |  |
  | 410 |  | $oa\_social\_login\_ajax\_nonce = wp\_create\_nonce ('oa\_social\_login\_ajax\_nonce'); |
  | 411 |  |  |
  | 412 |  | wp\_enqueue\_script ('oa\_social\_login\_admin\_js'); |
  | 413 |  | wp\_enqueue\_script ('jquery'); |
  | 414 |  |  |
  | 415 |  | wp\_localize\_script ('oa\_social\_login\_admin\_js', 'objectL10n', |
  | 416 |  | array ( |
  | 417 |  | 'oa\_social\_login\_ajax\_nonce' => $oa\_social\_login\_ajax\_nonce, |
  | 418 |  | 'oa\_admin\_js\_1' => \_\_ ('Contacting API - please wait this may take a few minutes ...', 'oa-social-login'), |
  | 419 |  | 'oa\_admin\_js\_101' => \_\_ ('The settings are correct - do not forget to save your changes!', 'oa-social-login'), |
  | 420 |  | 'oa\_admin\_js\_111' => \_\_ ('Please fill out each of the fields above.', 'oa-social-login'), |
  | 421 |  | 'oa\_admin\_js\_112' => \_\_ ('The subdomain does not exist. Have you filled it out correctly?', 'oa-social-login'), |
  | 422 |  | 'oa\_admin\_js\_113' => \_\_ ('The subdomain has a wrong syntax!', 'oa-social-login'), |
  | 423 |  | 'oa\_admin\_js\_114' => \_\_ ('Could not contact API. Are outbound requests on port 443 allowed?', 'oa-social-login'), |
  | 424 |  | 'oa\_admin\_js\_115' => \_\_ ('The API subdomain is correct, but one or both keys are invalid', 'oa-social-login'), |
  | 425 |  | 'oa\_admin\_js\_116' => \_\_ ('Connection handler does not work, try using the Autodetection', 'oa-social-login'), |
  | 426 |  | 'oa\_admin\_js\_201a' => \_\_ ('Detected CURL on Port 443 - do not forget to save your changes!', 'oa-social-login'), |
  | 427 |  | 'oa\_admin\_js\_201b' => \_\_ ('Detected CURL on Port 80 - do not forget to save your changes!', 'oa-social-login'), |
  | 428 |  | 'oa\_admin\_js\_201c' => \_\_ ('CURL is available but both ports (80, 443) are blocked for outbound requests', 'oa-social-login'), |
  | 429 |  | 'oa\_admin\_js\_202a' => \_\_ ('Detected FSOCKOPEN on Port 443 - do not forget to save your changes!', 'oa-social-login'), |
  | 430 |  | 'oa\_admin\_js\_202b' => \_\_ ('Detected FSOCKOPEN on Port 80 - do not forget to save your changes!', 'oa-social-login'), |
  | 431 |  | 'oa\_admin\_js\_202c' => \_\_ ('FSOCKOPEN is available but both ports (80, 443) are blocked for outbound requests', 'oa-social-login'), |
  | 432 |  | 'oa\_admin\_js\_211' => sprintf (\_\_ ('Autodetection Error - our <a href="%s" target="\_blank">documentation</a> helps you fix this issue.', 'oa-social-login'), 'http://docs.oneall.com/plugins/guide/social-login-wordpress/#help') |
  | 433 |  | )); |
  | 434 |  | } |
  |  | 412 | if (stripos($hook, 'oa\_social\_login') !== false) |
  |  | 413 | { |
  |  | 414 | if (!wp\_script\_is('oa\_social\_login\_admin\_js', 'registered')) |
  |  | 415 | { |
  |  | 416 | wp\_register\_script('oa\_social\_login\_admin\_js', OA\_SOCIAL\_LOGIN\_PLUGIN\_URL . "/assets/js/admin.js"); |
  |  | 417 | } |
  |  | 418 |  |
  |  | 419 | $oa\_social\_login\_ajax\_nonce = wp\_create\_nonce('oa\_social\_login\_ajax\_nonce'); |
  |  | 420 |  |
  |  | 421 | wp\_enqueue\_script('oa\_social\_login\_admin\_js'); |
  |  | 422 | wp\_enqueue\_script('jquery'); |
  |  | 423 |  |
  |  | 424 | wp\_localize\_script('oa\_social\_login\_admin\_js', 'objectL10n', |
  |  | 425 | array( |
  |  | 426 | 'oa\_social\_login\_ajax\_nonce' => $oa\_social\_login\_ajax\_nonce, |
  |  | 427 | 'oa\_admin\_js\_1'              => \_\_('Contacting API - please wait this may take a few minutes ...', 'oa-social-login'), |
  |  | 428 | 'oa\_admin\_js\_101'            => \_\_('The settings are correct - do not forget to save your changes!', 'oa-social-login'), |
  |  | 429 | 'oa\_admin\_js\_111'            => \_\_('Please fill out each of the fields above.', 'oa-social-login'), |
  |  | 430 | 'oa\_admin\_js\_112'            => \_\_('The subdomain does not exist. Have you filled it out correctly?', 'oa-social-login'), |
  |  | 431 | 'oa\_admin\_js\_113'            => \_\_('The subdomain has a wrong syntax!', 'oa-social-login'), |
  |  | 432 | 'oa\_admin\_js\_114'            => \_\_('Could not contact API. Are outbound requests on port 443 allowed?', 'oa-social-login'), |
  |  | 433 | 'oa\_admin\_js\_115'            => \_\_('The API subdomain is correct, but one or both keys are invalid', 'oa-social-login'), |
  |  | 434 | 'oa\_admin\_js\_116'            => \_\_('Connection handler does not work, try using the Autodetection', 'oa-social-login'), |
  |  | 435 | 'oa\_admin\_js\_201a'           => \_\_('Detected CURL on Port 443 - do not forget to save your changes!', 'oa-social-login'), |
  |  | 436 | 'oa\_admin\_js\_201b'           => \_\_('Detected CURL on Port 80 - do not forget to save your changes!', 'oa-social-login'), |
  |  | 437 | 'oa\_admin\_js\_201c'           => \_\_('CURL is available but both ports (80, 443) are blocked for outbound requests', 'oa-social-login'), |
  |  | 438 | 'oa\_admin\_js\_202a'           => \_\_('Detected FSOCKOPEN on Port 443 - do not forget to save your changes!', 'oa-social-login'), |
  |  | 439 | 'oa\_admin\_js\_202b'           => \_\_('Detected FSOCKOPEN on Port 80 - do not forget to save your changes!', 'oa-social-login'), |
  |  | 440 | 'oa\_admin\_js\_202c'           => \_\_('FSOCKOPEN is available but both ports (80, 443) are blocked for outbound requests', 'oa-social-login'), |
  |  | 441 | /\* translators: %s: website link name \*/ |
  |  | 442 | 'oa\_admin\_js\_211'            => sprintf(\_\_('Autodetection Error - our <a href="%s" target="\_blank">documentation</a> helps you fix this issue.', 'oa-social-login'), 'http://docs.oneall.com/plugins/guide/social-login-wordpress/#help') |
  |  | 443 | )); |
  |  | 444 | } |
  | 435 | 445 | } |
  | 436 | 446 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L439) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L449) |  |
  | 439 | 449 | \* Add Settings CSS |
  | 440 | 450 | \*\*/ |
  | 441 |  | function oa\_social\_login\_admin\_css($hook = '') |
  |  | 451 | function oa\_social\_login\_admin\_css($hook = '') |
  | 442 | 452 | { |
  | 443 |  | ~~if (!wp\_style\_is~~ ('oa\_social\_login\_admin\_css', 'registered')) |
  | 444 |  | { |
  | 445 |  | ~~wp\_register\_style~~ ('oa\_social\_login\_admin\_css', OA\_SOCIAL\_LOGIN\_PLUGIN\_URL . "/assets/css/admin.css"); |
  | 446 |  | } |
  | 447 |  |  |
  | 448 |  | ~~if (did\_action~~ ('wp\_print\_styles')) |
  | 449 |  | { |
  | 450 |  | ~~wp\_print\_styles~~ ('oa\_social\_login\_admin\_css'); |
  | 451 |  | } |
  | 452 |  | else |
  | 453 |  | { |
  | 454 |  | ~~wp\_enqueue\_style~~ ('oa\_social\_login\_admin\_css'); |
  | 455 |  | } |
  |  | 453 | if (!wp\_style\_is('oa\_social\_login\_admin\_css', 'registered')) |
  |  | 454 | { |
  |  | 455 | wp\_register\_style('oa\_social\_login\_admin\_css', OA\_SOCIAL\_LOGIN\_PLUGIN\_URL . "/assets/css/admin.css"); |
  |  | 456 | } |
  |  | 457 |  |
  |  | 458 | if (did\_action('wp\_print\_styles')) |
  |  | 459 | { |
  |  | 460 | wp\_print\_styles('oa\_social\_login\_admin\_css'); |
  |  | 461 | } |
  |  | 462 | else |
  |  | 463 | { |
  |  | 464 | wp\_enqueue\_style('oa\_social\_login\_admin\_css'); |
  |  | 465 | } |
  | 456 | 466 | } |
  | 457 | 467 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L460) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L470) |  |
  | 460 | 470 | \* Register plugin settings and their sanitization callback |
  | 461 | 471 | \*/ |
  | 462 |  | function oa\_register\_social\_login\_settings() |
  |  | 472 | function oa\_register\_social\_login\_settings() |
  | 463 | 473 | { |
  | 464 |  | ~~register\_setting~~ ('oa\_social\_login\_settings\_group', 'oa\_social\_login\_settings', 'oa\_social\_login\_settings\_validate'); |
  |  | 474 | register\_setting('oa\_social\_login\_settings\_group', 'oa\_social\_login\_settings', 'oa\_social\_login\_settings\_validate'); |
  | 465 | 475 | } |
  | 466 | 476 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L469) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L479) |  |
  | 469 | 479 | \*  Plugin settings sanitization callback |
  | 470 | 480 | \*/ |
  | 471 |  | function oa\_social\_login\_settings\_validate($settings) |
  |  | 481 | function oa\_social\_login\_settings\_validate($settings) |
  | 472 | 482 | { |
  | 473 |  | //Import providers |
  | 474 |  | ~~GLOBAL~~ $oa\_social\_login\_providers; |
  | 475 |  |  |
  | 476 |  | //Settings page? |
  | 477 |  | ~~$page = (!empty ($\_POST ['page']) ? strtolower~~ ($\_POST ['page']) : ''); |
  | 478 |  |  |
  | 479 |  | //Store the sanitzed settings |
  | 480 |  | ~~$sanitzed\_settings = get\_option~~ ('oa\_social\_login\_settings'); |
  | 481 |  |  |
  | 482 |  | //Check format |
  | 483 |  | ~~if (!is\_array~~ ($sanitzed\_settings)) |
  | 484 |  | { |
  | 485 |  | ~~$sanitzed\_settings = array~~ (); |
  | 486 |  | } |
  | 487 |  |  |
  | 488 |  | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  | 489 |  | //Setup |
  | 490 |  | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  | 491 |  | if ($page == 'setup') |
  | 492 |  | { |
  | 493 |  |  |
  | 494 |  | //Extract fields |
  | 495 |  | ~~foreach (array~~ ( |
  | 496 |  | 'api\_connection\_handler', |
  | 497 |  | 'api\_connection\_use\_https', |
  | 498 |  | 'api\_subdomain', |
  | 499 |  | 'asynchronous\_javascript', |
  | 500 |  | 'css\_tweaks', |
  | 501 |  | 'api\_key', |
  | 502 |  | 'api\_secret', |
  | 503 |  | 'providers' |
  | 504 |  | ~~) AS~~ $key) |
  | 505 |  | { |
  | 506 |  | //Value is given |
  | 507 |  | if (isset ($settings [$key])) |
  | 508 |  | { |
  | 509 |  | //Provider tickboxes |
  | 510 |  | if ($key == 'providers') |
  | 511 |  | { |
  | 512 |  | //Resest providers |
  | 513 |  | ~~$sanitzed\_settings ['providers'] = array~~ (); |
  | 514 |  |  |
  | 515 |  | //Loop through new values |
  | 516 |  | ~~if (is\_array~~ ($settings ['providers'])) |
  | 517 |  | { |
  | 518 |  | //Loop through valid values |
  | 519 |  | ~~foreach ($oa\_social\_login\_providers AS~~ $key => $name) |
  | 520 |  | { |
  | 521 |  | ~~if (isset ($settings ['providers'] [$key]) AND~~ $settings ['providers'] [$key] == '1') |
  | 522 |  | { |
  | 523 |  | $sanitzed\_settings ['providers'] [$key] = 1; |
  | 524 |  | } |
  | 525 |  | } |
  | 526 |  | } |
  | 527 |  | } |
  | 528 |  | //Other field |
  | 529 |  | else |
  | 530 |  | { |
  | 531 |  | ~~$sanitzed\_settings [$key] = trim~~ ($settings [$key]); |
  | 532 |  | } |
  | 533 |  | } |
  | 534 |  | } |
  | 535 |  | //Sanitize API Use HTTPS |
  | 536 |  | $sanitzed\_settings ['api\_connection\_use\_https'] = (empty ($sanitzed\_settings ['api\_connection\_use\_https']) ? 0 : 1); |
  | 537 |  |  |
  | 538 |  | //Sanitize API Connection handler |
  | 539 |  | ~~if (isset ($sanitzed\_settings ['api\_connection\_handler']) AND in\_array (strtolower ($sanitzed\_settings ['api\_connection\_handler']), array ('curl',~~'fsockopen'))) |
  | 540 |  | { |
  | 541 |  | ~~$sanitzed\_settings ['api\_connection\_handler'] = strtolower~~ ($sanitzed\_settings ['api\_connection\_handler']); |
  | 542 |  | } |
  | 543 |  | else |
  | 544 |  | { |
  | 545 |  | $sanitzed\_settings ['api\_connection\_handler'] = 'curl'; |
  | 546 |  | } |
  | 547 |  |  |
  | 548 |  | //Sanitize API Subdomain |
  | 549 |  | if (isset ($sanitzed\_settings ['api\_subdomain'])) |
  | 550 |  | { |
  | 551 |  | //Subdomain is always in lowercase |
  | 552 |  | ~~$api\_subdomain = strtolower~~ ($sanitzed\_settings ['api\_subdomain']); |
  | 553 |  |  |
  | 554 |  | //Full domain entered |
  | 555 |  | ~~if (preg\_match~~ ("/([a-z0-9\-]+)\.api\.oneall\.com/i", $api\_subdomain, $matches)) |
  | 556 |  | { |
  | 557 |  | $api\_subdomain = $matches [1]; |
  | 558 |  | } |
  | 559 |  |  |
  | 560 |  | $sanitzed\_settings ['api\_subdomain'] = $api\_subdomain; |
  | 561 |  | } |
  | 562 |  |  |
  | 563 |  | // Sanitize flags. |
  | 564 |  | $sanitzed\_settings ['asynchronous\_javascript'] = (empty ($sanitzed\_settings ['asynchronous\_javascript']) ? 0 : 1); |
  | 565 |  | $sanitzed\_settings ['css\_tweaks'] = (empty ($sanitzed\_settings ['css\_tweaks']) ? 0 : 1); |
  | 566 |  |  |
  | 567 |  | //Done |
  | 568 |  | return $sanitzed\_settings; |
  | 569 |  | } |
  | 570 |  | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  | 571 |  | //Setup |
  | 572 |  | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  | 573 |  | elseif ($page == 'settings') |
  | 574 |  | { |
  | 575 |  | //Extract fields |
  | 576 |  | ~~foreach (array~~ ( |
  | 577 |  | 'plugin\_add\_column\_user\_list', |
  | 578 |  | 'plugin\_require\_email', |
  | 579 |  | 'plugin\_require\_email\_text', |
  | 580 |  | 'plugin\_caption', |
  | 581 |  | 'plugin\_link\_verified\_accounts', |
  | 582 |  | 'plugin\_show\_avatars\_in\_comments', |
  | 583 |  | 'plugin\_icon\_theme', |
  | 584 |  | 'plugin\_display\_in\_login\_form', |
  | 585 |  | 'plugin\_login\_form\_redirect', |
  | 586 |  | 'plugin\_login\_form\_redirect\_custom\_url', |
  | 587 |  | 'plugin\_protect\_login\_redirect\_url', |
  | 588 |  | 'plugin\_display\_in\_registration\_form', |
  | 589 |  | 'plugin\_registration\_form\_redirect', |
  | 590 |  | 'plugin\_registration\_form\_redirect\_custom\_url', |
  | 591 |  | 'plugin\_protect\_registration\_redirect\_url', |
  | 592 |  | 'plugin\_comment\_show\_if\_members\_only', |
  | 593 |  | 'plugin\_comment\_auto\_approve', |
  | 594 |  | 'plugin\_comment\_show', |
  | 595 |  | 'plugin\_profile\_show', |
  | 596 |  | 'plugin\_shortcode\_login\_redirect', |
  | 597 |  | 'plugin\_shortcode\_login\_redirect\_url', |
  | 598 |  | 'plugin\_shortcode\_register\_redirect', |
  | 599 |  | 'plugin\_shortcode\_register\_redirect\_url', |
  | 600 |  | 'plugin\_notify\_admin' |
  | 601 |  | ~~) AS~~ $key) |
  | 602 |  | { |
  | 603 |  | if (isset ($settings [$key])) |
  | 604 |  | { |
  | 605 |  | ~~$sanitzed\_settings [$key] = trim~~ ($settings [$key]); |
  | 606 |  | } |
  | 607 |  | else |
  | 608 |  | { |
  | 609 |  | $sanitzed\_settings [$key] = ''; |
  | 610 |  | } |
  | 611 |  | } |
  | 612 |  |  |
  | 613 |  | // Flag settings. |
  | 614 |  | $sanitzed\_settings ['plugin\_add\_column\_user\_list'] = ($sanitzed\_settings ['plugin\_add\_column\_user\_list'] == '0' ? 0 : 1); |
  | 615 |  | $sanitzed\_settings ['plugin\_profile\_show'] = ($sanitzed\_settings ['plugin\_profile\_show'] == '0' ? 0 : 1); |
  | 616 |  | $sanitzed\_settings ['plugin\_notify\_admin'] = ($sanitzed\_settings ['plugin\_notify\_admin'] == '0' ? 0 : 1); |
  | 617 |  | $sanitzed\_settings ['plugin\_require\_email'] = ($sanitzed\_settings ['plugin\_require\_email'] == '1' ? 1 : 0); |
  | 618 |  | $sanitzed\_settings ['plugin\_comment\_show'] = ($sanitzed\_settings ['plugin\_comment\_show'] == '0' ? 0 : 1); |
  | 619 |  | $sanitzed\_settings ['plugin\_comment\_show\_if\_members\_only'] = ($sanitzed\_settings ['plugin\_comment\_show\_if\_members\_only'] == '0' ? 0 : 1); |
  | 620 |  | ~~$sanitzed\_settings ['plugin\_icon\_theme'] = (in\_array ($sanitzed\_settings ['plugin\_icon\_theme'], array~~ (0, 1, 2)) ? $sanitzed\_settings ['plugin\_icon\_theme'] : OA\_SOCIAL\_LOGIN\_DEFAULT\_THEME); |
  | 621 |  | $sanitzed\_settings ['plugin\_display\_in\_login\_form'] = ($sanitzed\_settings ['plugin\_display\_in\_login\_form'] == '0' ? 0 : 1); |
  | 622 |  | $sanitzed\_settings ['plugin\_display\_in\_registration\_form'] = ($sanitzed\_settings ['plugin\_display\_in\_registration\_form'] == '0' ? 0 : 1); |
  | 623 |  | $sanitzed\_settings ['plugin\_link\_verified\_accounts'] = ($sanitzed\_settings ['plugin\_link\_verified\_accounts'] == '0' ? 0 : 1); |
  | 624 |  | $sanitzed\_settings ['plugin\_comment\_auto\_approve'] = ($sanitzed\_settings ['plugin\_comment\_auto\_approve'] == '1' ? 1 : 0); |
  | 625 |  | $sanitzed\_settings ['plugin\_protect\_registration\_redirect\_url'] = ($sanitzed\_settings ['plugin\_protect\_registration\_redirect\_url'] == '1' ? 1 : 0); |
  | 626 |  | $sanitzed\_settings ['plugin\_protect\_login\_redirect\_url'] = ($sanitzed\_settings ['plugin\_protect\_login\_redirect\_url'] == '1' ? 1 : 0); |
  | 627 |  |  |
  | 628 |  |  |
  | 629 |  | // Multiple settings. |
  | 630 |  | ~~$sanitzed\_settings ['plugin\_show\_avatars\_in\_comments'] = (in\_array ($sanitzed\_settings ['plugin\_show\_avatars\_in\_comments'], array~~ (0, 1, 2)) ? $sanitzed\_settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  | 631 |  |  |
  | 632 |  | //Redirection Settings: Widget & Shortcode Login |
  | 633 |  | ~~$sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] = (in\_array ($sanitzed\_settings ['plugin\_shortcode\_login\_redirect'], array ('current','dashboard','homepage',~~'custom')) ? $sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] : 'current'); |
  | 634 |  | if ($sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] == 'custom') |
  | 635 |  | { |
  | 636 |  | if (empty ($sanitzed\_settings ['plugin\_shortcode\_login\_redirect\_url'])) |
  | 637 |  | { |
  | 638 |  | $sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] = 'current'; |
  | 639 |  | } |
  | 640 |  | } |
  | 641 |  | else |
  | 642 |  | { |
  | 643 |  | $sanitzed\_settings ['plugin\_shortcode\_login\_redirect\_url'] = ''; |
  | 644 |  | } |
  | 645 |  |  |
  | 646 |  | //Redirection Settings: Widget & Shortcode Registration |
  | 647 |  | ~~$sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] = (in\_array ($sanitzed\_settings ['plugin\_shortcode\_register\_redirect'], array ('current','dashboard','homepage',~~'custom')) ? $sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] : 'current'); |
  | 648 |  | if ($sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] == 'custom') |
  | 649 |  | { |
  | 650 |  | if (empty ($sanitzed\_settings ['plugin\_shortcode\_register\_redirect\_url'])) |
  | 651 |  | { |
  | 652 |  | $sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] = 'current'; |
  | 653 |  | } |
  | 654 |  | } |
  | 655 |  | else |
  | 656 |  | { |
  | 657 |  | $sanitzed\_settings ['plugin\_shortcode\_register\_redirect\_url'] = ''; |
  | 658 |  | } |
  | 659 |  |  |
  | 660 |  | //Redirection Settings: Form Login |
  | 661 |  | ~~$sanitzed\_settings ['plugin\_login\_form\_redirect'] = (in\_array ($sanitzed\_settings ['plugin\_login\_form\_redirect'], array ('current','dashboard','homepage',~~'custom')) ? $sanitzed\_settings ['plugin\_login\_form\_redirect'] : 'homepage'); |
  | 662 |  | if ($sanitzed\_settings ['plugin\_login\_form\_redirect'] == 'custom') |
  | 663 |  | { |
  | 664 |  | if (empty ($sanitzed\_settings ['plugin\_login\_form\_redirect\_custom\_url'])) |
  | 665 |  | { |
  | 666 |  | $sanitzed\_settings ['plugin\_login\_form\_redirect'] = 'homepage'; |
  | 667 |  | } |
  | 668 |  | } |
  | 669 |  | else |
  | 670 |  | { |
  | 671 |  | $sanitzed\_settings ['plugin\_login\_form\_redirect\_custom\_url'] = ''; |
  | 672 |  | } |
  | 673 |  |  |
  | 674 |  |  |
  | 675 |  | //Redirection Settings: Form Registration |
  | 676 |  | ~~$sanitzed\_settings ['plugin\_registration\_form\_redirect'] = (in\_array ($sanitzed\_settings ['plugin\_registration\_form\_redirect'], array ('current','dashboard','homepage',~~'custom')) ? $sanitzed\_settings ['plugin\_registration\_form\_redirect'] : 'dashboard'); |
  | 677 |  | if ($sanitzed\_settings ['plugin\_registration\_form\_redirect'] == 'custom') |
  | 678 |  | { |
  | 679 |  | if (empty ($sanitzed\_settings ['plugin\_registration\_form\_redirect\_custom\_url'])) |
  | 680 |  | { |
  | 681 |  | $sanitzed\_settings ['plugin\_registration\_form\_redirect'] = 'dashboard'; |
  | 682 |  | } |
  | 683 |  | } |
  | 684 |  | else |
  | 685 |  | { |
  | 686 |  | $sanitzed\_settings ['plugin\_registration\_form\_redirect\_custom\_url'] = ''; |
  | 687 |  | } |
  | 688 |  |  |
  | 689 |  | //Done |
  | 690 |  | return $sanitzed\_settings; |
  | 691 |  | } |
  | 692 |  |  |
  | 693 |  | //Error |
  | 694 |  | ~~return array~~ (); |
  |  | 483 | //Import providers |
  |  | 484 | global $oa\_social\_login\_providers; |
  |  | 485 |  |
  |  | 486 | //Settings page? |
  |  | 487 | $page = (!empty ($\_POST ['page']) ? strtolower($\_POST ['page']) : ''); |
  |  | 488 |  |
  |  | 489 | //Store the sanitzed settings |
  |  | 490 | $sanitzed\_settings = get\_option('oa\_social\_login\_settings'); |
  |  | 491 |  |
  |  | 492 | //Check format |
  |  | 493 | if (!is\_array($sanitzed\_settings)) |
  |  | 494 | { |
  |  | 495 | $sanitzed\_settings = array(); |
  |  | 496 | } |
  |  | 497 |  |
  |  | 498 | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  |  | 499 | //Setup |
  |  | 500 | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  |  | 501 | if ($page == 'setup') |
  |  | 502 | { |
  |  | 503 |  |
  |  | 504 | //Extract fields |
  |  | 505 | foreach (array( |
  |  | 506 | 'api\_connection\_handler', |
  |  | 507 | 'api\_connection\_use\_https', |
  |  | 508 | 'api\_subdomain', |
  |  | 509 | 'asynchronous\_javascript', |
  |  | 510 | 'css\_tweaks', |
  |  | 511 | 'api\_key', |
  |  | 512 | 'api\_secret', |
  |  | 513 | 'providers' |
  |  | 514 | ) as $key) |
  |  | 515 | { |
  |  | 516 | //Value is given |
  |  | 517 | if (isset ($settings [$key])) |
  |  | 518 | { |
  |  | 519 | //Provider tickboxes |
  |  | 520 | if ($key == 'providers') |
  |  | 521 | { |
  |  | 522 | //Resest providers |
  |  | 523 | $sanitzed\_settings ['providers'] = array(); |
  |  | 524 |  |
  |  | 525 | //Loop through new values |
  |  | 526 | if (is\_array($settings ['providers'])) |
  |  | 527 | { |
  |  | 528 | //Loop through valid values |
  |  | 529 | foreach ($oa\_social\_login\_providers as $key => $name) |
  |  | 530 | { |
  |  | 531 | if (isset ($settings ['providers'] [$key]) and $settings ['providers'] [$key] == '1') |
  |  | 532 | { |
  |  | 533 | $sanitzed\_settings ['providers'] [$key] = 1; |
  |  | 534 | } |
  |  | 535 | } |
  |  | 536 | } |
  |  | 537 | } |
  |  | 538 | //Other field |
  |  | 539 | else |
  |  | 540 | { |
  |  | 541 | $sanitzed\_settings [$key] = trim($settings [$key]); |
  |  | 542 | } |
  |  | 543 | } |
  |  | 544 | } |
  |  | 545 | //Sanitize API Use HTTPS |
  |  | 546 | $sanitzed\_settings ['api\_connection\_use\_https'] = (empty ($sanitzed\_settings ['api\_connection\_use\_https']) ? 0 : 1); |
  |  | 547 |  |
  |  | 548 | //Sanitize API Connection handler |
  |  | 549 | if (isset ($sanitzed\_settings ['api\_connection\_handler']) and in\_array(strtolower($sanitzed\_settings ['api\_connection\_handler']), array('curl', 'fsockopen'))) |
  |  | 550 | { |
  |  | 551 | $sanitzed\_settings ['api\_connection\_handler'] = strtolower($sanitzed\_settings ['api\_connection\_handler']); |
  |  | 552 | } |
  |  | 553 | else |
  |  | 554 | { |
  |  | 555 | $sanitzed\_settings ['api\_connection\_handler'] = 'curl'; |
  |  | 556 | } |
  |  | 557 |  |
  |  | 558 | //Sanitize API Subdomain |
  |  | 559 | if (isset ($sanitzed\_settings ['api\_subdomain'])) |
  |  | 560 | { |
  |  | 561 | //Subdomain is always in lowercase |
  |  | 562 | $api\_subdomain = strtolower($sanitzed\_settings ['api\_subdomain']); |
  |  | 563 |  |
  |  | 564 | //Full domain entered |
  |  | 565 | if (preg\_match("/([a-z0-9\-]+)\.api\.oneall\.com/i", $api\_subdomain, $matches)) |
  |  | 566 | { |
  |  | 567 | $api\_subdomain = $matches [1]; |
  |  | 568 | } |
  |  | 569 |  |
  |  | 570 | $sanitzed\_settings ['api\_subdomain'] = $api\_subdomain; |
  |  | 571 | } |
  |  | 572 |  |
  |  | 573 | // Sanitize flags. |
  |  | 574 | $sanitzed\_settings ['asynchronous\_javascript'] = (empty ($sanitzed\_settings ['asynchronous\_javascript']) ? 0 : 1); |
  |  | 575 | $sanitzed\_settings ['css\_tweaks'] = (empty ($sanitzed\_settings ['css\_tweaks']) ? 0 : 1); |
  |  | 576 |  |
  |  | 577 | //Done |
  |  | 578 | return $sanitzed\_settings; |
  |  | 579 | } |
  |  | 580 | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  |  | 581 | //Setup |
  |  | 582 | //////////////////////////////////////////////////////////////////////////////////////////////////////////// |
  |  | 583 | elseif ($page == 'settings') |
  |  | 584 | { |
  |  | 585 | //Extract fields |
  |  | 586 | foreach (array( |
  |  | 587 | 'plugin\_add\_column\_user\_list', |
  |  | 588 | 'plugin\_require\_email', |
  |  | 589 | 'plugin\_require\_email\_text', |
  |  | 590 | 'plugin\_caption', |
  |  | 591 | 'plugin\_link\_verified\_accounts', |
  |  | 592 | 'plugin\_show\_avatars\_in\_comments', |
  |  | 593 | 'plugin\_icon\_theme', |
  |  | 594 | 'plugin\_display\_in\_login\_form', |
  |  | 595 | 'plugin\_login\_form\_redirect', |
  |  | 596 | 'plugin\_login\_form\_redirect\_custom\_url', |
  |  | 597 | 'plugin\_protect\_login\_redirect\_url', |
  |  | 598 | 'plugin\_display\_in\_registration\_form', |
  |  | 599 | 'plugin\_registration\_form\_redirect', |
  |  | 600 | 'plugin\_registration\_form\_redirect\_custom\_url', |
  |  | 601 | 'plugin\_protect\_registration\_redirect\_url', |
  |  | 602 | 'plugin\_comment\_show\_if\_members\_only', |
  |  | 603 | 'plugin\_comment\_auto\_approve', |
  |  | 604 | 'plugin\_comment\_show', |
  |  | 605 | 'plugin\_profile\_show', |
  |  | 606 | 'plugin\_shortcode\_login\_redirect', |
  |  | 607 | 'plugin\_shortcode\_login\_redirect\_url', |
  |  | 608 | 'plugin\_shortcode\_register\_redirect', |
  |  | 609 | 'plugin\_shortcode\_register\_redirect\_url', |
  |  | 610 | 'plugin\_notify\_admin' |
  |  | 611 | ) as $key) |
  |  | 612 | { |
  |  | 613 | if (isset ($settings [$key])) |
  |  | 614 | { |
  |  | 615 | $sanitzed\_settings [$key] = trim($settings [$key]); |
  |  | 616 | } |
  |  | 617 | else |
  |  | 618 | { |
  |  | 619 | $sanitzed\_settings [$key] = ''; |
  |  | 620 | } |
  |  | 621 | } |
  |  | 622 |  |
  |  | 623 | // Flag settings. |
  |  | 624 | $sanitzed\_settings ['plugin\_add\_column\_user\_list'] = ($sanitzed\_settings ['plugin\_add\_column\_user\_list'] == '0' ? 0 : 1); |
  |  | 625 | $sanitzed\_settings ['plugin\_profile\_show'] = ($sanitzed\_settings ['plugin\_profile\_show'] == '0' ? 0 : 1); |
  |  | 626 | $sanitzed\_settings ['plugin\_notify\_admin'] = ($sanitzed\_settings ['plugin\_notify\_admin'] == '0' ? 0 : 1); |
  |  | 627 | $sanitzed\_settings ['plugin\_require\_email'] = ($sanitzed\_settings ['plugin\_require\_email'] == '1' ? 1 : 0); |
  |  | 628 | $sanitzed\_settings ['plugin\_comment\_show'] = ($sanitzed\_settings ['plugin\_comment\_show'] == '0' ? 0 : 1); |
  |  | 629 | $sanitzed\_settings ['plugin\_comment\_show\_if\_members\_only'] = ($sanitzed\_settings ['plugin\_comment\_show\_if\_members\_only'] == '0' ? 0 : 1); |
  |  | 630 | $sanitzed\_settings ['plugin\_icon\_theme'] = (in\_array($sanitzed\_settings ['plugin\_icon\_theme'], array(0, 1, 2)) ? $sanitzed\_settings ['plugin\_icon\_theme'] : OA\_SOCIAL\_LOGIN\_DEFAULT\_THEME); |
  |  | 631 | $sanitzed\_settings ['plugin\_display\_in\_login\_form'] = ($sanitzed\_settings ['plugin\_display\_in\_login\_form'] == '0' ? 0 : 1); |
  |  | 632 | $sanitzed\_settings ['plugin\_display\_in\_registration\_form'] = ($sanitzed\_settings ['plugin\_display\_in\_registration\_form'] == '0' ? 0 : 1); |
  |  | 633 | $sanitzed\_settings ['plugin\_link\_verified\_accounts'] = ($sanitzed\_settings ['plugin\_link\_verified\_accounts'] == '0' ? 0 : 1); |
  |  | 634 | $sanitzed\_settings ['plugin\_comment\_auto\_approve'] = ($sanitzed\_settings ['plugin\_comment\_auto\_approve'] == '1' ? 1 : 0); |
  |  | 635 | $sanitzed\_settings ['plugin\_protect\_registration\_redirect\_url'] = ($sanitzed\_settings ['plugin\_protect\_registration\_redirect\_url'] == '1' ? 1 : 0); |
  |  | 636 | $sanitzed\_settings ['plugin\_protect\_login\_redirect\_url'] = ($sanitzed\_settings ['plugin\_protect\_login\_redirect\_url'] == '1' ? 1 : 0); |
  |  | 637 |  |
  |  | 638 |  |
  |  | 639 | // Multiple settings. |
  |  | 640 | $sanitzed\_settings ['plugin\_show\_avatars\_in\_comments'] = (in\_array($sanitzed\_settings ['plugin\_show\_avatars\_in\_comments'], array(0, 1, 2)) ? $sanitzed\_settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  |  | 641 |  |
  |  | 642 | //Redirection Settings: Widget & Shortcode Login |
  |  | 643 | $sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] = (in\_array($sanitzed\_settings ['plugin\_shortcode\_login\_redirect'], array('current', 'dashboard', 'homepage', 'custom')) ? $sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] : 'current'); |
  |  | 644 | if ($sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] == 'custom') |
  |  | 645 | { |
  |  | 646 | if (empty ($sanitzed\_settings ['plugin\_shortcode\_login\_redirect\_url'])) |
  |  | 647 | { |
  |  | 648 | $sanitzed\_settings ['plugin\_shortcode\_login\_redirect'] = 'current'; |
  |  | 649 | } |
  |  | 650 | } |
  |  | 651 | else |
  |  | 652 | { |
  |  | 653 | $sanitzed\_settings ['plugin\_shortcode\_login\_redirect\_url'] = ''; |
  |  | 654 | } |
  |  | 655 |  |
  |  | 656 | //Redirection Settings: Widget & Shortcode Registration |
  |  | 657 | $sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] = (in\_array($sanitzed\_settings ['plugin\_shortcode\_register\_redirect'], array('current', 'dashboard', 'homepage', 'custom')) ? $sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] : 'current'); |
  |  | 658 | if ($sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] == 'custom') |
  |  | 659 | { |
  |  | 660 | if (empty ($sanitzed\_settings ['plugin\_shortcode\_register\_redirect\_url'])) |
  |  | 661 | { |
  |  | 662 | $sanitzed\_settings ['plugin\_shortcode\_register\_redirect'] = 'current'; |
  |  | 663 | } |
  |  | 664 | } |
  |  | 665 | else |
  |  | 666 | { |
  |  | 667 | $sanitzed\_settings ['plugin\_shortcode\_register\_redirect\_url'] = ''; |
  |  | 668 | } |
  |  | 669 |  |
  |  | 670 | //Redirection Settings: Form Login |
  |  | 671 | $sanitzed\_settings ['plugin\_login\_form\_redirect'] = (in\_array($sanitzed\_settings ['plugin\_login\_form\_redirect'], array('current', 'dashboard', 'homepage', 'custom')) ? $sanitzed\_settings ['plugin\_login\_form\_redirect'] : 'homepage'); |
  |  | 672 | if ($sanitzed\_settings ['plugin\_login\_form\_redirect'] == 'custom') |
  |  | 673 | { |
  |  | 674 | if (empty ($sanitzed\_settings ['plugin\_login\_form\_redirect\_custom\_url'])) |
  |  | 675 | { |
  |  | 676 | $sanitzed\_settings ['plugin\_login\_form\_redirect'] = 'homepage'; |
  |  | 677 | } |
  |  | 678 | } |
  |  | 679 | else |
  |  | 680 | { |
  |  | 681 | $sanitzed\_settings ['plugin\_login\_form\_redirect\_custom\_url'] = ''; |
  |  | 682 | } |
  |  | 683 |  |
  |  | 684 |  |
  |  | 685 | //Redirection Settings: Form Registration |
  |  | 686 | $sanitzed\_settings ['plugin\_registration\_form\_redirect'] = (in\_array($sanitzed\_settings ['plugin\_registration\_form\_redirect'], array('current', 'dashboard', 'homepage', 'custom')) ? $sanitzed\_settings ['plugin\_registration\_form\_redirect'] : 'dashboard'); |
  |  | 687 | if ($sanitzed\_settings ['plugin\_registration\_form\_redirect'] == 'custom') |
  |  | 688 | { |
  |  | 689 | if (empty ($sanitzed\_settings ['plugin\_registration\_form\_redirect\_custom\_url'])) |
  |  | 690 | { |
  |  | 691 | $sanitzed\_settings ['plugin\_registration\_form\_redirect'] = 'dashboard'; |
  |  | 692 | } |
  |  | 693 | } |
  |  | 694 | else |
  |  | 695 | { |
  |  | 696 | $sanitzed\_settings ['plugin\_registration\_form\_redirect\_custom\_url'] = ''; |
  |  | 697 | } |
  |  | 698 |  |
  |  | 699 | //Done |
  |  | 700 | return $sanitzed\_settings; |
  |  | 701 | } |
  |  | 702 |  |
  |  | 703 | //Error |
  |  | 704 | return array(); |
  | 695 | 705 | } |
  | 696 | 706 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L699) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L709) |  |
  | 699 | 709 | \* Display More Page |
  | 700 | 710 | \*\*/ |
  | 701 |  | function oa\_display\_social\_login\_more() |
  |  | 711 | function oa\_display\_social\_login\_more() |
  | 702 | 712 | { |
  | 703 |  | ?> |
  | 704 |  | <div class="wrap"> |
  | 705 |  | <div id="oa\_social\_login\_page" class="oa\_social\_login\_more"> |
  | 706 |  | <h2> |
  | 707 |  | OneAll Social Login <?php echo (defined ('OA\_SOCIAL\_LOGIN\_VERSION') ? OA\_SOCIAL\_LOGIN\_VERSION : ''); ?> \ <?php \_e ('+More', 'oa-social-login'); ?> |
  | 708 |  | <span class="oa\_social\_login\_header\_links"> |
  | 709 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">About Us</a>', 'oa-social-login'), 'https://www.oneall.com/'); ?> |
  | 710 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">FAQ - Hooks - Filters</a>', 'oa-social-login'), 'https://docs.oneall.com/plugins/guide/social-login-wordpress/'); ?> |
  | 711 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">Contact Support Team</a>', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); ?> |
  |  | 713 | ?> |
  |  | 714 | <div class="wrap"> |
  |  | 715 | <div id="oa\_social\_login\_page" class="oa\_social\_login\_more"> |
  |  | 716 | <h2> |
  |  | 717 | OneAll Social Login <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 718 | echo(defined('OA\_SOCIAL\_LOGIN\_VERSION') ? OA\_SOCIAL\_LOGIN\_VERSION : ''); ?> \ <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('+More', 'oa-social-login'); ?> |
  |  | 719 | <span class="oa\_social\_login\_header\_links"> |
  |  | 720 | <?php /\* translators: %s: website link \*/ |
  |  | 721 | $message = sprintf(\_\_('<a target="\_blank" href="%s">About Us</a>', 'oa-social-login'), 'https://www.oneall.com/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message ?> |
  |  | 722 | <?php /\* translators: %s: website link \*/ |
  |  | 723 | $message = sprintf(\_\_('<a target="\_blank" href="%s">FAQ - Hooks - Filters</a>', 'oa-social-login'), 'https://docs.oneall.com/plugins/guide/social-login-wordpress/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message ?> |
  |  | 724 | <?php /\* translators: %s: website link \*/ |
  |  | 725 | $message = sprintf(\_\_('<a target="\_blank" href="%s">Contact Support Team</a>', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message ?> |
  | 712 | 726 | </span> |
  | 713 |  | </h2> |
  | 714 |  |  |
  | 715 |  | <h2 class="nav-tab-wrapper"> |
  | 716 |  | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_setup"><?php \_e ('Setup', 'oa-social-login'); ?></a> |
  | 717 |  | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_settings"><?php \_e ('Settings', 'oa-social-login'); ?></a> |
  | 718 |  | <a class="nav-tab nav-tab-active" href="admin.php?page=oa\_social\_login\_more"><?php \_e ('+More', 'oa-social-login'); ?></a> |
  | 719 |  | </h2> |
  | 720 |  |  |
  | 721 |  | <div class="oa\_social\_login\_box oa\_social\_login\_box\_success"> |
  | 722 |  | <ul> |
  | 723 |  | <li><?php printf (\_\_ ('<a target="\_blank" href="%s">Follow us on X</a> to stay informed about updates', 'oa-social-login'), 'https://x.com/oneall'); ?></li> |
  | 724 |  | <li><?php printf (\_\_ ('<a target="\_blank" href="%s">Read the online documentation</a> for more information about this plugin', 'oa-social-login'), 'http://docs.oneall.com/plugins/guide/social-login-wordpress/'); ?></li> |
  | 725 |  | <li><?php printf (\_\_ ('<a target="\_blank" href="%s">Contact us</a> if you have feedback or need assistance', 'oa-social-login'), 'http://www.oneall.com/company/contact-us/'); ?> |
  | 726 |  | <li><?php printf (\_\_ ('We also have <a target="\_blank" href="%s">turnkey plugins</a> for Drupal, PrestaShop, Joomla, phpBB andy many others ...', 'oa-social-login'), 'http://docs.oneall.com/plugins/'); ?> |
  | 727 |  | </li> |
  | 728 |  | </ul> |
  | 729 |  | </div> |
  | 730 |  |  |
  | 731 |  | <?php |
  | 732 |  | $more\_url = admin\_url('plugin-install.php?s=share+buttons+oneall&tab=search&type=term'); |
  | 733 |  | ?> |
  | 734 |  | <div class="oa\_social\_login\_plugin"> |
  | 735 |  | <div class="oa\_social\_login\_plugin\_img"> |
  | 736 |  | <a href="<?php echo $more\_url; ?>"><img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ ) . '../assets/img/social\_sharing.png' ?>" alt="<?php \_e ('Social Login', 'oa-social-login') ?>" /></a> |
  | 737 |  | </div> |
  | 738 |  | <div class="oa\_social\_login\_plugin\_desc"> |
  | 739 |  | <?php \_e ('Allow your visitors to comment, login and register with 40+ social networks like for example Twitter, Facebook, Pinterest, Instagram, Paypal, LinkedIn, OpenID, VKontakte or Google+. Easy to use and 100% FREE.', 'oa-social-login'); ?> |
  | 740 |  | <a href="<?php echo $more\_url; ?>"><?php \_e ('Click here for more information.', 'oa-social-login'); ?></a> |
  | 741 |  | </div> |
  | 742 |  | </div> |
  | 743 |  |  |
  | 744 |  | <?php |
  | 745 |  | $more\_url = admin\_url('plugin-install.php?s=loudvoice+oneall&tab=search&type=term'); |
  | 746 |  | ?> |
  | 747 |  | <div class="oa\_social\_login\_plugin"> |
  | 748 |  | <div class="oa\_social\_login\_plugin\_img"> |
  | 749 |  | <a href="<?php echo $more\_url; ?>"><img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ ) . '../assets/img/loudvoice.png' ?>" alt="<?php \_e ('LoudVoice Comment System', 'oa-social-login') ?>" /></a> |
  | 750 |  | </div> |
  | 751 |  | <div class="oa\_social\_login\_plugin\_desc"> |
  | 752 |  | <?php \_e ('LoudVoice replaces the basic WordPress comments by a powerful comment system that includes logging in with 40+ social networks, spam filters and more. Easy to use and 100% FREE. Existing comments can be imported!', 'oa-social-login'); ?> |
  | 753 |  | <a href="<?php echo $more\_url; ?>"><?php \_e ('Click here for more information.', 'oa-social-login'); ?></a> |
  | 754 |  | </div> |
  | 755 |  | </div> |
  | 756 |  |  |
  | 757 |  | <?php |
  | 758 |  | $more\_url = admin\_url('plugin-install.php?s=sso+oneall&tab=search&type=term'); |
  | 759 |  | ?> |
  | 760 |  | <div class="oa\_social\_login\_plugin"> |
  | 761 |  | <div class="oa\_social\_login\_plugin\_img"> |
  | 762 |  | <a href="<?php echo $more\_url; ?>"><img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ ) . '../assets/img/single-sign-on.png' ?>" alt="<?php \_e ('Single Sign-On', 'oa-social-login') ?>" /></a> |
  | 763 |  | </div> |
  | 764 |  | <div class="oa\_social\_login\_plugin\_desc"> |
  | 765 |  | <?php \_e ('Automatically creates accounts and signs users in as they browse between multiple and independent WordPress blogs or websites in your network. Take away the need for your users to create new accounts or re-enter their authentication credentials on every of your websites.', 'oa-social-login'); ?> |
  | 766 |  | <a href="<?php echo $more\_url; ?>"><?php \_e ('Click here for more information.', 'oa-social-login'); ?></a> |
  | 767 |  | </div> |
  | 768 |  | </div> |
  | 769 |  | </div> |
  | 770 |  | </div> |
  | 771 |  | <?php |
  |  | 727 | </h2> |
  |  | 728 |  |
  |  | 729 | <h2 class="nav-tab-wrapper"> |
  |  | 730 | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_setup"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Setup', 'oa-social-login'); ?></a> |
  |  | 731 | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_settings"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Settings', 'oa-social-login'); ?></a> |
  |  | 732 | <a class="nav-tab nav-tab-active" href="admin.php?page=oa\_social\_login\_more"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('+More', 'oa-social-login'); ?></a> |
  |  | 733 | </h2> |
  |  | 734 |  |
  |  | 735 | <div class="oa\_social\_login\_box oa\_social\_login\_box\_success"> |
  |  | 736 | <ul> |
  |  | 737 | <li><?php /\* translators: %s: website link \*/ $message = sprintf(\_\_('<a target="\_blank" href="%s">Follow us on X</a> to stay informed about updates', 'oa-social-login'), 'https://x.com/oneall'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message; ?></li> |
  |  | 738 | <li><?php /\* translators: %s: website link \*/ $message = sprintf(\_\_('<a target="\_blank" href="%s">Read the online documentation</a> for more information about this plugin', 'oa-social-login'), 'http://docs.oneall.com/plugins/guide/social-login-wordpress/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message; ?></li> |
  |  | 739 | <li><?php /\* translators: %s: website link \*/ $message = sprintf(\_\_('<a target="\_blank" href="%s">Contact us</a> if you have feedback or need assistance', 'oa-social-login'), 'http://www.oneall.com/company/contact-us/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message; ?> |
  |  | 740 | <li><?php /\* translators: %s: website link \*/ $message = sprintf(\_\_('We also have <a target="\_blank" href="%s">turnkey plugins</a> for Drupal, PrestaShop, Joomla, phpBB andy many others ...', 'oa-social-login'), 'http://docs.oneall.com/plugins/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message; ?> |
  |  | 741 | </li> |
  |  | 742 | </ul> |
  |  | 743 | </div> |
  |  | 744 |  |
  |  | 745 | <?php |
  |  | 746 | $more\_url = admin\_url('plugin-install.php?s=share+buttons+oneall&tab=search&type=term'); |
  |  | 747 | ?> |
  |  | 748 | <div class="oa\_social\_login\_plugin"> |
  |  | 749 | <div class="oa\_social\_login\_plugin\_img"> |
  |  | 750 | <a href="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 751 | echo $more\_url; ?>"><img src="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 752 | echo plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/social\_sharing.png' ?>" alt="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Social Login', 'oa-social-login') ?>"/></a> |
  |  | 753 | </div> |
  |  | 754 | <div class="oa\_social\_login\_plugin\_desc"> |
  |  | 755 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Allow your visitors to comment, login and register with 40+ social networks like for example Twitter, Facebook, Pinterest, Instagram, Paypal, LinkedIn, OpenID, VKontakte or Google+. Easy to use and 100% FREE.', 'oa-social-login'); ?> |
  |  | 756 | <a href="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 757 | echo $more\_url; ?>"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Click here for more information.', 'oa-social-login'); ?></a> |
  |  | 758 | </div> |
  |  | 759 | </div> |
  |  | 760 |  |
  |  | 761 | <?php |
  |  | 762 | $more\_url = admin\_url('plugin-install.php?s=loudvoice+oneall&tab=search&type=term'); |
  |  | 763 | ?> |
  |  | 764 | <div class="oa\_social\_login\_plugin"> |
  |  | 765 | <div class="oa\_social\_login\_plugin\_img"> |
  |  | 766 | <a href="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 767 | echo $more\_url; ?>"><img src="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 768 | echo plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/loudvoice.png' ?>" alt="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('LoudVoice Comment System', 'oa-social-login') ?>"/></a> |
  |  | 769 | </div> |
  |  | 770 | <div class="oa\_social\_login\_plugin\_desc"> |
  |  | 771 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('LoudVoice replaces the basic WordPress comments by a powerful comment system that includes logging in with 40+ social networks, spam filters and more. Easy to use and 100% FREE. Existing comments can be imported!', 'oa-social-login'); ?> |
  |  | 772 | <a href="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 773 | echo $more\_url; ?>"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Click here for more information.', 'oa-social-login'); ?></a> |
  |  | 774 | </div> |
  |  | 775 | </div> |
  |  | 776 |  |
  |  | 777 | <?php |
  |  | 778 | $more\_url = admin\_url('plugin-install.php?s=sso+oneall&tab=search&type=term'); |
  |  | 779 | ?> |
  |  | 780 | <div class="oa\_social\_login\_plugin"> |
  |  | 781 | <div class="oa\_social\_login\_plugin\_img"> |
  |  | 782 | <a href="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 783 | echo $more\_url; ?>"><img src="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 784 | echo plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/single-sign-on.png' ?>" alt="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Single Sign-On', 'oa-social-login') ?>"/></a> |
  |  | 785 | </div> |
  |  | 786 | <div class="oa\_social\_login\_plugin\_desc"> |
  |  | 787 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Automatically creates accounts and signs users in as they browse between multiple and independent WordPress blogs or websites in your network. Take away the need for your users to create new accounts or re-enter their authentication credentials on every of your websites.', 'oa-social-login'); ?> |
  |  | 788 | <a href="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 789 | echo $more\_url; ?>"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Click here for more information.', 'oa-social-login'); ?></a> |
  |  | 790 | </div> |
  |  | 791 | </div> |
  |  | 792 | </div> |
  |  | 793 | </div> |
  |  | 794 | <?php |
  | 772 | 795 | } |
  | 773 | 796 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L776) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L799) |  |
  | 776 | 799 | \* Display Settings Page |
  | 777 | 800 | \*\*/ |
  | 778 |  | function oa\_display\_social\_login\_setup() |
  |  | 801 | function oa\_display\_social\_login\_setup() |
  | 779 | 802 | { |
  | 780 |  | //Import providers |
  | 781 |  | GLOBAL $oa\_social\_login\_providers; |
  | 782 |  | ?> |
  | 783 |  | <div class="wrap"> |
  | 784 |  | <div id="oa\_social\_login\_page" class="oa\_social\_login\_setup"> |
  | 785 |  | <h2> |
  | 786 |  | OneAll Social Login <?php echo (defined ('OA\_SOCIAL\_LOGIN\_VERSION') ? OA\_SOCIAL\_LOGIN\_VERSION : ''); ?> \ <?php \_e ('Setup', 'oa-social-login'); ?> |
  | 787 |  | <span class="oa\_social\_login\_header\_links"> |
  | 788 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">About Us</a>', 'oa-social-login'), 'https://www.oneall.com/'); ?> |
  | 789 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">FAQ - Hooks - Filters</a>', 'oa-social-login'), 'https://docs.oneall.com/plugins/guide/social-login-wordpress/'); ?> |
  | 790 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">Contact Support Team</a>', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); ?> |
  |  | 803 | //Import providers |
  |  | 804 | global $oa\_social\_login\_providers; |
  |  | 805 | ?> |
  |  | 806 | <div class="wrap"> |
  |  | 807 | <div id="oa\_social\_login\_page" class="oa\_social\_login\_setup"> |
  |  | 808 | <h2> |
  |  | 809 | OneAll Social Login <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 810 | echo(defined('OA\_SOCIAL\_LOGIN\_VERSION') ? OA\_SOCIAL\_LOGIN\_VERSION : ''); ?> \ <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Setup', 'oa-social-login'); ?> |
  |  | 811 | <span class="oa\_social\_login\_header\_links"> |
  |  | 812 | <?php /\* translators: %s: website link \*/ |
  |  | 813 | $message = sprintf(\_\_('<a target="\_blank" href="%s">About Us</a>', 'oa-social-login'), 'https://www.oneall.com/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message;?> |
  |  | 814 | <?php /\* translators: %s: website link \*/ |
  |  | 815 | $message = sprintf(\_\_('<a target="\_blank" href="%s">FAQ - Hooks - Filters</a>', 'oa-social-login'), 'https://docs.oneall.com/plugins/guide/social-login-wordpress/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message;?> |
  |  | 816 | <?php /\* translators: %s: website link \*/ |
  |  | 817 | $message = sprintf(\_\_('<a target="\_blank" href="%s">Contact Support Team</a>', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message;?> |
  | 791 | 818 | </span> |
  | 792 |  | </h2> |
  | 793 |  | <h2 class="nav-tab-wrapper"> |
  | 794 |  | <a class="nav-tab nav-tab-active" href="admin.php?page=oa\_social\_login\_setup"><?php \_e ('Setup', 'oa-social-login'); ?></a> |
  | 795 |  | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_settings"><?php \_e ('Settings', 'oa-social-login'); ?></a> |
  | 796 |  | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_more"><?php \_e ('+More', 'oa-social-login'); ?></a> |
  | 797 |  | </h2> |
  | 798 |  | <?php |
  | 799 |  | if (!empty ($\_REQUEST ['settings-updated']) AND strtolower ($\_REQUEST ['settings-updated']) == 'true') |
  | 800 |  | { |
  | 801 |  | ?> |
  | 802 |  | <div class="oa\_social\_login\_box oa\_social\_login\_box\_notice"> |
  | 803 |  | <p> |
  | 804 |  | <?php \_e ('Your modifications have been saved successfully!', 'oa-social-login'); ?> |
  | 805 |  | </p> |
  | 806 |  | </div> |
  | 807 |  | <?php |
  | 808 |  | } |
  | 809 |  | else |
  | 810 |  | { |
  | 811 |  | if (get\_option ('oa\_social\_login\_api\_settings\_verified') !== '1') |
  | 812 |  | { |
  | 813 |  | ?> |
  | 814 |  |  |
  | 815 |  | <div class="oa\_social\_login\_box oa\_social\_login\_box\_success"> |
  | 816 |  | <div class="oa\_social\_login\_box\_title"> |
  | 817 |  | <?php \_e ('Thank you for using Social Login', 'oa-social-login'); ?> |
  | 818 |  | </div> |
  | 819 |  | <p> |
  | 820 |  | <?php \_e ('Unlike other Social Login providers we monitor the APIs and technologies of the different social networks and update our service as soon as changes arise.', 'oa-social-login'); ?><br /> |
  | 821 |  | <strong> <?php \_e ('By using OneAll you can be sure that your social media integration will always run smoothly and with the most up-to-date calls.', 'oa-social-login'); ?></strong> |
  | 822 |  | </p> |
  | 823 |  | <p></p> |
  | 824 |  | <p> |
  | 825 |  | <?php printf (\_\_ ('To be able to use this plugin you first of all need to create a free account at %s.', 'oa-social-login'), '<a href="https://app.oneall.com/signup/wp" target="\_blank">http://www.oneall.com</a>'); ?><br /> |
  | 826 |  |  |
  | 827 |  | <?php \_e ('After having created your account and setup a Site, simply enter your Site settings below.', 'oa-social-login'); ?><br /> |
  | 828 |  | <?php \_e ("The setup is free and takes only a few minutes!", 'oa-social-login'); ?> |
  | 829 |  | <?php printf (\_\_ ('Do not hesitate to <a target="\_blank" href="%s">contact us</a> if you have any questions.', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); ?> |
  | 830 |  | </p> |
  | 831 |  | <p> |
  | 832 |  | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_success" href="https://app.oneall.com/signup/wp" target="\_blank"><?php \_e ('Click here to setup your free account', 'oa-social-login'); ?></a> |
  | 833 |  | </p> |
  | 834 |  | </div> |
  | 835 |  | <?php |
  | 836 |  | } |
  | 837 |  | else |
  | 838 |  | { |
  | 839 |  | ?> |
  | 840 |  | <p></p> |
  | 841 |  | <div class="oa\_social\_login\_box oa\_social\_login\_box\_info"> |
  | 842 |  | <p class="oa\_social\_login\_box\_title"> |
  | 843 |  | <?php \_e ('Login to your OneAll account to manage your social networks and to access your Social Analytics, Graphs &amp; Statistics.', 'oa-social-login'); ?> |
  | 844 |  | </p> |
  | 845 |  | <p class="oa\_social\_login\_buttons"> |
  | 846 |  | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_info" href="https://app.oneall.com/signin/" target="\_blank"><?php \_e ('Login to my OneAll account', 'oa-social-login'); ?></a> |
  | 847 |  | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_info" href="https://app.oneall.com/insights/connections/" target="\_blank"><?php \_e ('Access my Social Analytics', 'oa-social-login'); ?></a> |
  | 848 |  | </p> |
  | 849 |  | </div> |
  | 850 |  | <?php |
  | 851 |  | } |
  | 852 |  | } |
  | 853 |  | ?> |
  | 854 |  |  |
  | 855 |  | <form method="post" action="options.php"> |
  | 856 |  | <?php |
  | 857 |  | settings\_fields ('oa\_social\_login\_settings\_group'); |
  | 858 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 859 |  | ?> |
  | 860 |  | <table class="form-table oa\_social\_login\_table"> |
  | 861 |  | <tr class="row\_head"> |
  | 862 |  | <th> |
  | 863 |  | <?php \_e ('API Connection Handler', 'oa-social-login'); ?> |
  | 864 |  | </th> |
  | 865 |  | <th> |
  | 866 |  | &nbsp; |
  | 867 |  | </th> |
  | 868 |  | </tr> |
  | 869 |  | <?php |
  | 870 |  | $api\_connection\_handler = ((empty ($settings ['api\_connection\_handler']) OR $settings ['api\_connection\_handler'] <> 'fsockopen') ? 'curl' : 'fsockopen'); |
  | 871 |  | ?> |
  | 872 |  | <tr class="row\_even row\_multi"> |
  | 873 |  | <td rowspan="2" class="col\_center col\_br"> |
  | 874 |  | <label for="oa\_social\_login\_api\_connection\_handler\_curl"><?php \_e ('API Connection Handler', 'oa-social-login'); ?></label> |
  | 875 |  | </td> |
  | 876 |  | <td> |
  | 877 |  | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_curl" name="oa\_social\_login\_settings[api\_connection\_handler]" value="curl" <?php echo (($api\_connection\_handler <> 'fsockopen') ? 'checked="checked"' : ''); ?> /> |
  | 878 |  | <label for="oa\_social\_login\_api\_connection\_handler\_curl"><?php \_e ('Use PHP CURL to communicate with the API', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 879 |  | <span class="description"><?php \_e ('Using CURL is recommended but it might be disabled on some servers.', 'oa-social-login'); ?></span> |
  | 880 |  | </td> |
  | 881 |  | </tr> |
  | 882 |  | <tr class="row\_even"> |
  | 883 |  | <td class="col\_pt\_0"> |
  | 884 |  | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_fsockopen" name="oa\_social\_login\_settings[api\_connection\_handler]" value="fsockopen" <?php echo (($api\_connection\_handler == 'fsockopen') ? 'checked="checked"' : ''); ?> /> |
  | 885 |  | <label for="oa\_social\_login\_api\_connection\_handler\_fsockopen"><?php \_e ('Use PHP FSOCKOPEN to communicate with the API', 'oa-social-login'); ?> </label><br /> |
  | 886 |  | <span class="description"><?php \_e ('Try using FSOCKOPEN if you encounter any problems with CURL.', 'oa-social-login'); ?></span> |
  | 887 |  | </td> |
  | 888 |  | </tr> |
  | 889 |  | <?php |
  | 890 |  | $api\_connection\_use\_https = ((!isset ($settings ['api\_connection\_use\_https']) OR $settings ['api\_connection\_use\_https'] == '1') ? true : false); |
  | 891 |  | ?> |
  | 892 |  | <tr class="row\_odd"> |
  | 893 |  | <td rowspan="2" class="col\_center col\_br"> |
  | 894 |  | <label for="oa\_social\_login\_api\_connection\_handler\_use\_https\_1"><?php \_e ('API Connection Port', 'oa-social-login'); ?></label> |
  | 895 |  | </td> |
  | 896 |  | <td> |
  | 897 |  | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_use\_https\_1" name="oa\_social\_login\_settings[api\_connection\_use\_https]" value="1" <?php echo ($api\_connection\_use\_https ? 'checked="checked"' : ''); ?> /> |
  | 898 |  | <label for="oa\_social\_login\_api\_connection\_handler\_use\_https\_1"><?php \_e ('Communication via HTTPS on port 443', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 899 |  | <span class="description"><?php \_e ('Using port 443 is secure but you might need OpenSSL', 'oa-social-login'); ?></span> |
  | 900 |  | </td> |
  | 901 |  | </tr> |
  | 902 |  | <tr class="row\_odd"> |
  | 903 |  | <td class="col\_pt\_0"> |
  | 904 |  | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_use\_https\_0" name="oa\_social\_login\_settings[api\_connection\_use\_https]" value="0" <?php echo (!$api\_connection\_use\_https ? 'checked="checked"' : ''); ?> /> |
  | 905 |  | <label for="oa\_social\_login\_api\_connection\_handler\_use\_https\_0"><?php \_e ('Communication via HTTP on port 80', 'oa-social-login'); ?> </label><br /> |
  | 906 |  | <span class="description"><?php \_e ("Using port 80 is a bit faster, doesn't need OpenSSL but is less secure", 'oa-social-login'); ?></span> |
  | 907 |  | </td> |
  | 908 |  | </tr> |
  | 909 |  | <tr class="row\_foot"> |
  | 910 |  | <td class="col\_center"> |
  | 911 |  | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_success" id="oa\_social\_login\_autodetect\_api\_connection\_handler" href="#"><?php \_e ('Autodetect API Connection', 'oa-social-login'); ?></a> |
  | 912 |  | </td> |
  | 913 |  | <td> |
  | 914 |  | <div id="oa\_social\_login\_api\_connection\_handler\_result"></div> |
  | 915 |  | </td> |
  | 916 |  | </tr> |
  | 917 |  | </table> |
  | 918 |  |  |
  | 919 |  | <table class="form-table oa\_social\_login\_table"> |
  | 920 |  | <tr class="row\_head"> |
  | 921 |  | <th class="col\_label"> |
  | 922 |  | <?php \_e ('API Settings', 'oa-social-login'); ?> |
  | 923 |  | </th> |
  | 924 |  | <th> |
  | 925 |  | <a href="https://app.oneall.com/applications/" target="\_blank"><?php \_e ('Click here to create and view your API Credentials', 'oa-social-login'); ?></a> |
  | 926 |  | </th> |
  | 927 |  | </tr> |
  | 928 |  | <tr class="row\_even"> |
  | 929 |  | <td class="col\_center col\_br"> |
  | 930 |  | <label for="oa\_social\_login\_settings\_api\_subdomain"><?php \_e ('API Subdomain', 'oa-social-login'); ?></label> |
  | 931 |  | </td> |
  | 932 |  | <td> |
  | 933 |  | <input type="text" id="oa\_social\_login\_settings\_api\_subdomain" name="oa\_social\_login\_settings[api\_subdomain]" size="65" value="<?php echo (isset ($settings ['api\_subdomain']) ? htmlspecialchars ($settings ['api\_subdomain']) : ''); ?>" /> |
  | 934 |  | </td> |
  | 935 |  | </tr> |
  | 936 |  | <tr class="row\_odd"> |
  | 937 |  | <td class="col\_center col\_br"> |
  | 938 |  | <label for="oa\_social\_login\_settings\_api\_key"><?php \_e ('API Public Key', 'oa-social-login'); ?></label> |
  | 939 |  | </td> |
  | 940 |  | <td> |
  | 941 |  | <input type="text" id="oa\_social\_login\_settings\_api\_key" name="oa\_social\_login\_settings[api\_key]" size="65" value="<?php echo (isset ($settings ['api\_key']) ? htmlspecialchars ($settings ['api\_key']) : ''); ?>" /> |
  | 942 |  | </td> |
  | 943 |  | </tr> |
  | 944 |  | <tr class="row\_even"> |
  | 945 |  | <td class="col\_center col\_br"> |
  | 946 |  | <label for="oa\_social\_login\_settings\_api\_secret"><?php \_e ('API Private Key', 'oa-social-login'); ?></label> |
  | 947 |  | </td> |
  | 948 |  | <td> |
  | 949 |  | <input type="text" id="oa\_social\_login\_settings\_api\_secret" name="oa\_social\_login\_settings[api\_secret]" size="65" value="<?php echo (isset ($settings ['api\_secret']) ? htmlspecialchars ($settings ['api\_secret']) : ''); ?>" /> |
  | 950 |  | </td> |
  | 951 |  | </tr> |
  | 952 |  | <tr class="row\_foot"> |
  | 953 |  | <td class="col\_center"> |
  | 954 |  | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_success" id="oa\_social\_login\_test\_api\_settings" href="#"><?php \_e ('Verify API Settings', 'oa-social-login'); ?> </a> |
  | 955 |  | </td> |
  | 956 |  | <td> |
  | 957 |  | <div id="oa\_social\_login\_api\_test\_result"></div> |
  | 958 |  | </td> |
  | 959 |  | </tr> |
  | 960 |  | </table> |
  | 961 |  |  |
  | 962 |  | <table class="form-table oa\_social\_login\_table"> |
  | 963 |  | <tr class="row\_head"> |
  | 964 |  | <th> |
  | 965 |  | <?php \_e ('Render Settings', 'oa-social-login'); ?> |
  | 966 |  | </th> |
  | 967 |  | <th> |
  | 968 |  | &nbsp; |
  | 969 |  | </th> |
  | 970 |  | </tr> |
  | 971 |  | <?php |
  | 972 |  |  |
  | 973 |  | // We dont have a value yet. |
  | 974 |  | if ( ! isset ($settings['asynchronous\_javascript'])) |
  | 975 |  | { |
  | 976 |  | //No subdomain, this is probably a new installation. |
  | 977 |  | if ( ! isset ($settings ['api\_subdomain'])) |
  | 978 |  | { |
  | 979 |  | //Enable asynchronous JavaScript. |
  | 980 |  | $asynchronous\_javascript = 1; |
  | 981 |  | } |
  | 982 |  | //We have a subdomain, this is probably an updated version of the plugin. |
  | 983 |  | else |
  | 984 |  | { |
  | 985 |  | //Disable asynchronous JavaScript. |
  | 986 |  | $asynchronous\_javascript = 0; |
  | 987 |  | } |
  | 988 |  | } |
  | 989 |  | //We have a value. |
  | 990 |  | else |
  | 991 |  | { |
  | 992 |  | $asynchronous\_javascript = ( ! empty ($settings ['asynchronous\_javascript']) ? 1 : 0); |
  | 993 |  | } |
  | 994 |  |  |
  | 995 |  | // We dont have a value yet. |
  | 996 |  | if ( ! isset ($settings['css\_tweaks'])) |
  | 997 |  | { |
  | 998 |  | // No subdomain, this is probably a new installation. |
  | 999 |  | if ( ! isset ($settings ['api\_subdomain'])) |
  | 1000 |  | { |
  | 1001 |  | $css\_tweaks = 1; |
  | 1002 |  | } |
  | 1003 |  | //We have a subdomain, this is probably an updated version of the plugin. |
  | 1004 |  | else |
  | 1005 |  | { |
  | 1006 |  | $css\_tweaks = 0; |
  | 1007 |  | } |
  | 1008 |  | } |
  | 1009 |  | // We have a value. |
  | 1010 |  | else |
  | 1011 |  | { |
  | 1012 |  | $css\_tweaks = ( ! empty ($settings ['css\_tweaks']) ? 1 : 0); |
  | 1013 |  | } |
  | 1014 |  |  |
  | 1015 |  | ?> |
  | 1016 |  | <tr class="row\_even"> |
  | 1017 |  | <td rowspan="2" class="col\_center col\_br"> |
  | 1018 |  | <label  for="oa\_social\_login\_asynchronous\_javascript\_1"><?php \_e ('JavaScript', 'oa-social-login'); ?></label> |
  | 1019 |  | </td> |
  | 1020 |  | <td> |
  | 1021 |  | <input type="radio" id="oa\_social\_login\_asynchronous\_javascript\_1" name="oa\_social\_login\_settings[asynchronous\_javascript]" value="1" <?php echo ( ! empty ($asynchronous\_javascript) ? 'checked="checked"' : ''); ?> /> |
  | 1022 |  | <label for="oa\_social\_login\_asynchronous\_javascript\_1"><?php \_e ('Asynchronous JavaScript', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1023 |  | <span class="description"><?php \_e ('Background loading without interfering with the display and behavior of the existing page.', 'oa-social-login'); ?></span> |
  | 1024 |  | </td> |
  | 1025 |  | </tr> |
  | 1026 |  | <tr class="row\_even"> |
  | 1027 |  | <td> |
  | 1028 |  | <input type="radio" id="oa\_social\_login\_asynchronous\_javascript\_0" name="oa\_social\_login\_settings[asynchronous\_javascript]" value="0" <?php echo (empty ($asynchronous\_javascript) ? 'checked="checked"' : ''); ?> /> |
  | 1029 |  | <label for="oa\_social\_login\_asynchronous\_javascript\_0"><?php \_e ('Synchronous JavaScript', 'oa-social-login'); ?> </label><br /> |
  | 1030 |  | <span class="description"><?php \_e ('Real-time loading when the page is being rendered by the browser.', 'oa-social-login'); ?></span> |
  | 1031 |  | </td> |
  | 1032 |  | </tr> |
  | 1033 |  | <tr class="row\_odd"> |
  | 1034 |  | <td rowspan="2" class="col\_center col\_br"> |
  | 1035 |  | <label  for="oa\_social\_login\_css\_tweaks\_1"><?php \_e ('CSS Tweaks', 'oa-social-login'); ?></label> |
  | 1036 |  | </td> |
  | 1037 |  | <td> |
  | 1038 |  | <input type="radio" id="oa\_social\_login\_css\_tweaks\_1" name="oa\_social\_login\_settings[css\_tweaks]" value="1" <?php echo ( ! empty ($css\_tweaks) ? 'checked="checked"' : ''); ?> /> |
  | 1039 |  | <label for="oa\_social\_login\_css\_tweaks\_1"><?php \_e ('Enable CSS Tweaks', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1040 |  | <span class="description"><?php \_e ('Enables various CSS tweaks for a better integration of Social Login.', 'oa-social-login'); ?></span> |
  | 1041 |  | </td> |
  | 1042 |  | </tr> |
  | 1043 |  | <tr class="row\_odd"> |
  | 1044 |  | <td> |
  | 1045 |  | <input type="radio" id="oa\_social\_login\_css\_tweaks\_0" name="oa\_social\_login\_settings[css\_tweaks]" value="0" <?php echo (empty ($css\_tweaks) ? 'checked="checked"' : ''); ?> /> |
  | 1046 |  | <label for="oa\_social\_login\_css\_tweaks\_0"><?php \_e ('Disable CSS Tweaks', 'oa-social-login'); ?> </label><br /> |
  | 1047 |  | <span class="description"><?php \_e ('Disables additional CSS tweaks and only displays the Social Login buttons.', 'oa-social-login'); ?></span> |
  | 1048 |  | </td> |
  | 1049 |  | </tr> |
  | 1050 |  | </table> |
  | 1051 |  |  |
  | 1052 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1053 |  | <tr class="row\_head"> |
  | 1054 |  | <th> |
  | 1055 |  | <?php \_e ('Social Networks', 'oa-social-login'); ?> |
  | 1056 |  | </th> |
  | 1057 |  | <th> |
  | 1058 |  | &nbsp; |
  | 1059 |  | </th> |
  | 1060 |  | </tr> |
  | 1061 |  | <?php |
  | 1062 |  |  |
  | 1063 |  |  |
  | 1064 |  | $i = 0; |
  | 1065 |  | foreach ($oa\_social\_login\_providers AS $key => $provider\_data) |
  | 1066 |  | { |
  | 1067 |  | // Provider enabled? |
  | 1068 |  | $is\_enabled = false; |
  | 1069 |  |  |
  | 1070 |  | // We have no settings at all, probably fresh installation. |
  | 1071 |  | if ($settings === false) |
  | 1072 |  | { |
  | 1073 |  | if ( ! empty ($provider\_data ['is\_default'])) |
  | 1074 |  | { |
  | 1075 |  | $is\_enabled = true; |
  | 1076 |  | } |
  | 1077 |  | } |
  | 1078 |  | else |
  | 1079 |  | { |
  | 1080 |  | if (! empty ($settings ['providers'] [$key])) |
  | 1081 |  | { |
  | 1082 |  | $is\_enabled = true; |
  | 1083 |  | } |
  | 1084 |  | } |
  | 1085 |  |  |
  | 1086 |  |  |
  | 1087 |  |  |
  | 1088 |  | ?> |
  | 1089 |  | <tr class="<?php echo ((($i++) % 2) == 0) ? 'row\_even' : 'row\_odd' ?>"> |
  | 1090 |  | <td class="col\_center"> |
  | 1091 |  | <label for="oneall\_social\_login\_provider\_<?php echo $key; ?>"> |
  | 1092 |  | <span class="oa\_social\_login\_provider oa\_social\_login\_provider\_<?php echo $key; ?>" title="<?php echo htmlspecialchars ($provider\_data ['name']); ?>"><?php echo htmlspecialchars ($provider\_data ['name']); ?> </span> |
  | 1093 |  | </label> |
  | 1094 |  | </td> |
  | 1095 |  | <td class="col\_provider"> |
  | 1096 |  | <input type="checkbox" id="oneall\_social\_login\_provider\_<?php echo $key; ?>" name="oa\_social\_login\_settings[providers][<?php echo $key; ?>]" value="1" <?php checked ('1', $is\_enabled); ?> /> |
  | 1097 |  | <label for="oneall\_social\_login\_provider\_<?php echo $key; ?>"><?php echo htmlspecialchars ($provider\_data ['name']); ?> </label> |
  | 1098 |  | <?php |
  | 1099 |  | if (in\_array ($key, array ('vkontakte', 'mailru', 'odnoklassniki'))) |
  | 1100 |  | { |
  | 1101 |  | echo ' - ' . sprintf (\_\_ ('To enable cyrillic usernames, you might need <a target="\_blank" href="%s">this plugin</a>', 'oa-social-login'), 'http://wordpress.org/extend/plugins/wordpress-special-characters-in-usernames/'); |
  | 1102 |  | } |
  | 1103 |  | ?> |
  | 1104 |  | </td> |
  | 1105 |  | </tr> |
  | 1106 |  | <?php |
  | 1107 |  | } |
  | 1108 |  | ?> |
  | 1109 |  | </table> |
  | 1110 |  | <p class="oa\_social\_login\_buttons"> |
  | 1111 |  | <input type="hidden" name="page" value="setup" /> |
  | 1112 |  | <input type="submit" class="oa\_social\_login\_btn oa\_social\_login\_btn\_success oa\_social\_login\_btn\_large" value="<?php \_e ('Save Changes', 'oa-social-login') ?>" /> |
  | 1113 |  | </p> |
  | 1114 |  | </form> |
  | 1115 |  | </div> |
  | 1116 |  | </div> |
  | 1117 |  | <?php |
  |  | 819 | </h2> |
  |  | 820 | <h2 class="nav-tab-wrapper"> |
  |  | 821 | <a class="nav-tab nav-tab-active" href="admin.php?page=oa\_social\_login\_setup"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Setup', 'oa-social-login'); ?></a> |
  |  | 822 | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_settings"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Settings', 'oa-social-login'); ?></a> |
  |  | 823 | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_more"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('+More', 'oa-social-login'); ?></a> |
  |  | 824 | </h2> |
  |  | 825 | <?php |
  |  | 826 | if (!empty ($\_REQUEST ['settings-updated']) and strtolower($\_REQUEST ['settings-updated']) == 'true') |
  |  | 827 | { |
  |  | 828 | ?> |
  |  | 829 | <div class="oa\_social\_login\_box oa\_social\_login\_box\_notice"> |
  |  | 830 | <p> |
  |  | 831 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Your modifications have been saved successfully!', 'oa-social-login'); ?> |
  |  | 832 | </p> |
  |  | 833 | </div> |
  |  | 834 | <?php |
  |  | 835 | } |
  |  | 836 | else |
  |  | 837 | { |
  |  | 838 | if (get\_option('oa\_social\_login\_api\_settings\_verified') !== '1') |
  |  | 839 | { |
  |  | 840 | ?> |
  |  | 841 |  |
  |  | 842 | <div class="oa\_social\_login\_box oa\_social\_login\_box\_success"> |
  |  | 843 | <div class="oa\_social\_login\_box\_title"> |
  |  | 844 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Thank you for using Social Login', 'oa-social-login'); ?> |
  |  | 845 | </div> |
  |  | 846 | <p> |
  |  | 847 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Unlike other Social Login providers we monitor the APIs and technologies of the different social networks and update our service as soon as changes arise.', 'oa-social-login'); ?><br/> |
  |  | 848 | <strong> <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('By using OneAll you can be sure that your social media integration will always run smoothly and with the most up-to-date calls.', 'oa-social-login'); ?></strong> |
  |  | 849 | </p> |
  |  | 850 | <p></p> |
  |  | 851 | <p> |
  |  | 852 | <?php /\* translators: %s: website link \*/ $message = sprintf(\_\_('To be able to use this plugin you first of all need to create a free account at %s.', 'oa-social-login'), '<a href="https://app.oneall.com/signup/wp" target="\_blank">http://www.oneall.com</a>'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message; ?><br/> |
  |  | 853 |  |
  |  | 854 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('After having created your account and setup a Site, simply enter your Site settings below.', 'oa-social-login'); ?><br/> |
  |  | 855 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("The setup is free and takes only a few minutes!", 'oa-social-login'); ?> |
  |  | 856 | <?php /\* translators: %s: website link \*/ $message = sprintf(\_\_('Do not hesitate to <a target="\_blank" href="%s">contact us</a> if you have any questions.', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message; ?> |
  |  | 857 | </p> |
  |  | 858 | <p> |
  |  | 859 | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_success" href="https://app.oneall.com/signup/wp" target="\_blank"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Click here to setup your free account', 'oa-social-login'); ?></a> |
  |  | 860 | </p> |
  |  | 861 | </div> |
  |  | 862 | <?php |
  |  | 863 | } |
  |  | 864 | else |
  |  | 865 | { |
  |  | 866 | ?> |
  |  | 867 | <p></p> |
  |  | 868 | <div class="oa\_social\_login\_box oa\_social\_login\_box\_info"> |
  |  | 869 | <p class="oa\_social\_login\_box\_title"> |
  |  | 870 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Login to your OneAll account to manage your social networks and to access your Social Analytics, Graphs &amp; Statistics.', 'oa-social-login'); ?> |
  |  | 871 | </p> |
  |  | 872 | <p class="oa\_social\_login\_buttons"> |
  |  | 873 | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_info" href="https://app.oneall.com/signin/" target="\_blank"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Login to my OneAll account', 'oa-social-login'); ?></a> |
  |  | 874 | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_info" href="https://app.oneall.com/insights/connections/" target="\_blank"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Access my Social Analytics', 'oa-social-login'); ?></a> |
  |  | 875 | </p> |
  |  | 876 | </div> |
  |  | 877 | <?php |
  |  | 878 | } |
  |  | 879 | } |
  |  | 880 | ?> |
  |  | 881 |  |
  |  | 882 | <form method="post" action="options.php"> |
  |  | 883 | <?php |
  |  | 884 | settings\_fields('oa\_social\_login\_settings\_group'); |
  |  | 885 | $settings = get\_option('oa\_social\_login\_settings'); |
  |  | 886 | ?> |
  |  | 887 | <table class="form-table oa\_social\_login\_table"> |
  |  | 888 | <tr class="row\_head"> |
  |  | 889 | <th> |
  |  | 890 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('API Connection Handler', 'oa-social-login'); ?> |
  |  | 891 | </th> |
  |  | 892 | <th> |
  |  | 893 | &nbsp; |
  |  | 894 | </th> |
  |  | 895 | </tr> |
  |  | 896 | <?php |
  |  | 897 | $api\_connection\_handler = ((empty ($settings ['api\_connection\_handler']) or $settings ['api\_connection\_handler'] <> 'fsockopen') ? 'curl' : 'fsockopen'); |
  |  | 898 | ?> |
  |  | 899 | <tr class="row\_even row\_multi"> |
  |  | 900 | <td rowspan="2" class="col\_center col\_br"> |
  |  | 901 | <label for="oa\_social\_login\_api\_connection\_handler\_curl"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('API Connection Handler', 'oa-social-login'); ?></label> |
  |  | 902 | </td> |
  |  | 903 | <td> |
  |  | 904 | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_curl" name="oa\_social\_login\_settings[api\_connection\_handler]" value="curl" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 905 | echo(($api\_connection\_handler <> 'fsockopen') ? 'checked="checked"' : ''); ?> /> |
  |  | 906 | <label for="oa\_social\_login\_api\_connection\_handler\_curl"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Use PHP CURL to communicate with the API', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 907 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Using CURL is recommended but it might be disabled on some servers.', 'oa-social-login'); ?></span> |
  |  | 908 | </td> |
  |  | 909 | </tr> |
  |  | 910 | <tr class="row\_even"> |
  |  | 911 | <td class="col\_pt\_0"> |
  |  | 912 | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_fsockopen" name="oa\_social\_login\_settings[api\_connection\_handler]" value="fsockopen" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 913 | echo(($api\_connection\_handler == 'fsockopen') ? 'checked="checked"' : ''); ?> /> |
  |  | 914 | <label for="oa\_social\_login\_api\_connection\_handler\_fsockopen"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Use PHP FSOCKOPEN to communicate with the API', 'oa-social-login'); ?> </label><br/> |
  |  | 915 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Try using FSOCKOPEN if you encounter any problems with CURL.', 'oa-social-login'); ?></span> |
  |  | 916 | </td> |
  |  | 917 | </tr> |
  |  | 918 | <?php |
  |  | 919 | $api\_connection\_use\_https = ((!isset ($settings ['api\_connection\_use\_https']) or $settings ['api\_connection\_use\_https'] == '1') ? true : false); |
  |  | 920 | ?> |
  |  | 921 | <tr class="row\_odd"> |
  |  | 922 | <td rowspan="2" class="col\_center col\_br"> |
  |  | 923 | <label for="oa\_social\_login\_api\_connection\_handler\_use\_https\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('API Connection Port', 'oa-social-login'); ?></label> |
  |  | 924 | </td> |
  |  | 925 | <td> |
  |  | 926 | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_use\_https\_1" name="oa\_social\_login\_settings[api\_connection\_use\_https]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 927 | echo($api\_connection\_use\_https ? 'checked="checked"' : ''); ?> /> |
  |  | 928 | <label for="oa\_social\_login\_api\_connection\_handler\_use\_https\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Communication via HTTPS on port 443', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 929 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Using port 443 is secure but you might need OpenSSL', 'oa-social-login'); ?></span> |
  |  | 930 | </td> |
  |  | 931 | </tr> |
  |  | 932 | <tr class="row\_odd"> |
  |  | 933 | <td class="col\_pt\_0"> |
  |  | 934 | <input type="radio" id="oa\_social\_login\_api\_connection\_handler\_use\_https\_0" name="oa\_social\_login\_settings[api\_connection\_use\_https]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 935 | echo(!$api\_connection\_use\_https ? 'checked="checked"' : ''); ?> /> |
  |  | 936 | <label for="oa\_social\_login\_api\_connection\_handler\_use\_https\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Communication via HTTP on port 80', 'oa-social-login'); ?> </label><br/> |
  |  | 937 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("Using port 80 is a bit faster, doesn't need OpenSSL but is less secure", 'oa-social-login'); ?></span> |
  |  | 938 | </td> |
  |  | 939 | </tr> |
  |  | 940 | <tr class="row\_foot"> |
  |  | 941 | <td class="col\_center"> |
  |  | 942 | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_success" id="oa\_social\_login\_autodetect\_api\_connection\_handler" href="#"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Autodetect API Connection', 'oa-social-login'); ?></a> |
  |  | 943 | </td> |
  |  | 944 | <td> |
  |  | 945 | <div id="oa\_social\_login\_api\_connection\_handler\_result"></div> |
  |  | 946 | </td> |
  |  | 947 | </tr> |
  |  | 948 | </table> |
  |  | 949 |  |
  |  | 950 | <table class="form-table oa\_social\_login\_table"> |
  |  | 951 | <tr class="row\_head"> |
  |  | 952 | <th class="col\_label"> |
  |  | 953 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('API Settings', 'oa-social-login'); ?> |
  |  | 954 | </th> |
  |  | 955 | <th> |
  |  | 956 | <a href="https://app.oneall.com/applications/" target="\_blank"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Click here to create and view your API Credentials', 'oa-social-login'); ?></a> |
  |  | 957 | </th> |
  |  | 958 | </tr> |
  |  | 959 | <tr class="row\_even"> |
  |  | 960 | <td class="col\_center col\_br"> |
  |  | 961 | <label for="oa\_social\_login\_settings\_api\_subdomain"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('API Subdomain', 'oa-social-login'); ?></label> |
  |  | 962 | </td> |
  |  | 963 | <td> |
  |  | 964 | <input type="text" id="oa\_social\_login\_settings\_api\_subdomain" name="oa\_social\_login\_settings[api\_subdomain]" size="65" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo(isset ($settings ['api\_subdomain']) ? htmlspecialchars($settings ['api\_subdomain']) : ''); ?>"/> |
  |  | 965 | </td> |
  |  | 966 | </tr> |
  |  | 967 | <tr class="row\_odd"> |
  |  | 968 | <td class="col\_center col\_br"> |
  |  | 969 | <label for="oa\_social\_login\_settings\_api\_key"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('API Public Key', 'oa-social-login'); ?></label> |
  |  | 970 | </td> |
  |  | 971 | <td> |
  |  | 972 | <input type="text" id="oa\_social\_login\_settings\_api\_key" name="oa\_social\_login\_settings[api\_key]" size="65" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo(isset ($settings ['api\_key']) ? htmlspecialchars($settings ['api\_key']) : ''); ?>"/> |
  |  | 973 | </td> |
  |  | 974 | </tr> |
  |  | 975 | <tr class="row\_even"> |
  |  | 976 | <td class="col\_center col\_br"> |
  |  | 977 | <label for="oa\_social\_login\_settings\_api\_secret"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('API Private Key', 'oa-social-login'); ?></label> |
  |  | 978 | </td> |
  |  | 979 | <td> |
  |  | 980 | <input type="text" id="oa\_social\_login\_settings\_api\_secret" name="oa\_social\_login\_settings[api\_secret]" size="65" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo(isset ($settings ['api\_secret']) ? htmlspecialchars($settings ['api\_secret']) : ''); ?>"/> |
  |  | 981 | </td> |
  |  | 982 | </tr> |
  |  | 983 | <tr class="row\_foot"> |
  |  | 984 | <td class="col\_center"> |
  |  | 985 | <a class="oa\_social\_login\_btn oa\_social\_login\_btn\_success" id="oa\_social\_login\_test\_api\_settings" href="#"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Verify API Settings', 'oa-social-login'); ?> </a> |
  |  | 986 | </td> |
  |  | 987 | <td> |
  |  | 988 | <div id="oa\_social\_login\_api\_test\_result"></div> |
  |  | 989 | </td> |
  |  | 990 | </tr> |
  |  | 991 | </table> |
  |  | 992 |  |
  |  | 993 | <table class="form-table oa\_social\_login\_table"> |
  |  | 994 | <tr class="row\_head"> |
  |  | 995 | <th> |
  |  | 996 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Render Settings', 'oa-social-login'); ?> |
  |  | 997 | </th> |
  |  | 998 | <th> |
  |  | 999 | &nbsp; |
  |  | 1000 | </th> |
  |  | 1001 | </tr> |
  |  | 1002 | <?php |
  |  | 1003 |  |
  |  | 1004 | // We dont have a value yet. |
  |  | 1005 | if (!isset ($settings['asynchronous\_javascript'])) |
  |  | 1006 | { |
  |  | 1007 | //No subdomain, this is probably a new installation. |
  |  | 1008 | if (!isset ($settings ['api\_subdomain'])) |
  |  | 1009 | { |
  |  | 1010 | //Enable asynchronous JavaScript. |
  |  | 1011 | $asynchronous\_javascript = 1; |
  |  | 1012 | } |
  |  | 1013 | //We have a subdomain, this is probably an updated version of the plugin. |
  |  | 1014 | else |
  |  | 1015 | { |
  |  | 1016 | //Disable asynchronous JavaScript. |
  |  | 1017 | $asynchronous\_javascript = 0; |
  |  | 1018 | } |
  |  | 1019 | } |
  |  | 1020 | //We have a value. |
  |  | 1021 | else |
  |  | 1022 | { |
  |  | 1023 | $asynchronous\_javascript = (!empty ($settings ['asynchronous\_javascript']) ? 1 : 0); |
  |  | 1024 | } |
  |  | 1025 |  |
  |  | 1026 | // We dont have a value yet. |
  |  | 1027 | if (!isset ($settings['css\_tweaks'])) |
  |  | 1028 | { |
  |  | 1029 | // No subdomain, this is probably a new installation. |
  |  | 1030 | if (!isset ($settings ['api\_subdomain'])) |
  |  | 1031 | { |
  |  | 1032 | $css\_tweaks = 1; |
  |  | 1033 | } |
  |  | 1034 | //We have a subdomain, this is probably an updated version of the plugin. |
  |  | 1035 | else |
  |  | 1036 | { |
  |  | 1037 | $css\_tweaks = 0; |
  |  | 1038 | } |
  |  | 1039 | } |
  |  | 1040 | // We have a value. |
  |  | 1041 | else |
  |  | 1042 | { |
  |  | 1043 | $css\_tweaks = (!empty ($settings ['css\_tweaks']) ? 1 : 0); |
  |  | 1044 | } |
  |  | 1045 |  |
  |  | 1046 | ?> |
  |  | 1047 | <tr class="row\_even"> |
  |  | 1048 | <td rowspan="2" class="col\_center col\_br"> |
  |  | 1049 | <label for="oa\_social\_login\_asynchronous\_javascript\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('JavaScript', 'oa-social-login'); ?></label> |
  |  | 1050 | </td> |
  |  | 1051 | <td> |
  |  | 1052 | <input type="radio" id="oa\_social\_login\_asynchronous\_javascript\_1" name="oa\_social\_login\_settings[asynchronous\_javascript]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1053 | echo(!empty ($asynchronous\_javascript) ? 'checked="checked"' : ''); ?> /> |
  |  | 1054 | <label for="oa\_social\_login\_asynchronous\_javascript\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Asynchronous JavaScript', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1055 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Background loading without interfering with the display and behavior of the existing page.', 'oa-social-login'); ?></span> |
  |  | 1056 | </td> |
  |  | 1057 | </tr> |
  |  | 1058 | <tr class="row\_even"> |
  |  | 1059 | <td> |
  |  | 1060 | <input type="radio" id="oa\_social\_login\_asynchronous\_javascript\_0" name="oa\_social\_login\_settings[asynchronous\_javascript]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1061 | echo(empty ($asynchronous\_javascript) ? 'checked="checked"' : ''); ?> /> |
  |  | 1062 | <label for="oa\_social\_login\_asynchronous\_javascript\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Synchronous JavaScript', 'oa-social-login'); ?> </label><br/> |
  |  | 1063 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Real-time loading when the page is being rendered by the browser.', 'oa-social-login'); ?></span> |
  |  | 1064 | </td> |
  |  | 1065 | </tr> |
  |  | 1066 | <tr class="row\_odd"> |
  |  | 1067 | <td rowspan="2" class="col\_center col\_br"> |
  |  | 1068 | <label for="oa\_social\_login\_css\_tweaks\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('CSS Tweaks', 'oa-social-login'); ?></label> |
  |  | 1069 | </td> |
  |  | 1070 | <td> |
  |  | 1071 | <input type="radio" id="oa\_social\_login\_css\_tweaks\_1" name="oa\_social\_login\_settings[css\_tweaks]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1072 | echo(!empty ($css\_tweaks) ? 'checked="checked"' : ''); ?> /> |
  |  | 1073 | <label for="oa\_social\_login\_css\_tweaks\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Enable CSS Tweaks', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1074 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Enables various CSS tweaks for a better integration of Social Login.', 'oa-social-login'); ?></span> |
  |  | 1075 | </td> |
  |  | 1076 | </tr> |
  |  | 1077 | <tr class="row\_odd"> |
  |  | 1078 | <td> |
  |  | 1079 | <input type="radio" id="oa\_social\_login\_css\_tweaks\_0" name="oa\_social\_login\_settings[css\_tweaks]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1080 | echo(empty ($css\_tweaks) ? 'checked="checked"' : ''); ?> /> |
  |  | 1081 | <label for="oa\_social\_login\_css\_tweaks\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Disable CSS Tweaks', 'oa-social-login'); ?> </label><br/> |
  |  | 1082 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Disables additional CSS tweaks and only displays the Social Login buttons.', 'oa-social-login'); ?></span> |
  |  | 1083 | </td> |
  |  | 1084 | </tr> |
  |  | 1085 | </table> |
  |  | 1086 |  |
  |  | 1087 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1088 | <tr class="row\_head"> |
  |  | 1089 | <th> |
  |  | 1090 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Social Networks', 'oa-social-login'); ?> |
  |  | 1091 | </th> |
  |  | 1092 | <th> |
  |  | 1093 | &nbsp; |
  |  | 1094 | </th> |
  |  | 1095 | </tr> |
  |  | 1096 | <?php |
  |  | 1097 |  |
  |  | 1098 |  |
  |  | 1099 | $i = 0; |
  |  | 1100 | foreach ($oa\_social\_login\_providers as $key => $provider\_data) |
  |  | 1101 | { |
  |  | 1102 | // Provider enabled? |
  |  | 1103 | $is\_enabled = false; |
  |  | 1104 |  |
  |  | 1105 | // We have no settings at all, probably fresh installation. |
  |  | 1106 | if ($settings === false) |
  |  | 1107 | { |
  |  | 1108 | if (!empty ($provider\_data ['is\_default'])) |
  |  | 1109 | { |
  |  | 1110 | $is\_enabled = true; |
  |  | 1111 | } |
  |  | 1112 | } |
  |  | 1113 | else |
  |  | 1114 | { |
  |  | 1115 | if (!empty ($settings ['providers'] [$key])) |
  |  | 1116 | { |
  |  | 1117 | $is\_enabled = true; |
  |  | 1118 | } |
  |  | 1119 | } |
  |  | 1120 |  |
  |  | 1121 |  |
  |  | 1122 | ?> |
  |  | 1123 | <tr class="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1124 | echo ((($i++) % 2) == 0) ? 'row\_even' : 'row\_odd' ?>"> |
  |  | 1125 | <td class="col\_center"> |
  |  | 1126 | <label for="oneall\_social\_login\_provider\_<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $key; ?>"> |
  |  | 1127 | <span class="oa\_social\_login\_provider oa\_social\_login\_provider\_<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $key; ?>" title="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/                                     echo htmlspecialchars($provider\_data ['name']); ?>"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo htmlspecialchars($provider\_data ['name']); ?> </span> |
  |  | 1128 | </label> |
  |  | 1129 | </td> |
  |  | 1130 | <td class="col\_provider"> |
  |  | 1131 | <input type="checkbox" id="oneall\_social\_login\_provider\_<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $key; ?>" name="oa\_social\_login\_settings[providers][<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $key; ?>]" value="1" <?php checked('1', $is\_enabled); ?> /> |
  |  | 1132 | <label for="oneall\_social\_login\_provider\_<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $key; ?>"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo htmlspecialchars($provider\_data ['name']); ?> </label> |
  |  | 1133 | <?php |
  |  | 1134 | if (in\_array($key, array('vkontakte', 'mailru', 'odnoklassniki'))) |
  |  | 1135 | { |
  |  | 1136 | /\* translators: %s: website link \*/ |
  |  | 1137 | $message = sprintf(\_\_('To enable cyrillic usernames, you might need <a target="\_blank" href="%s">this plugin</a>', 'oa-social-login'), 'http://wordpress.org/extend/plugins/wordpress-special-characters-in-usernames/'); |
  |  | 1138 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1139 | echo ' - ' .$message; |
  |  | 1140 | } |
  |  | 1141 | ?> |
  |  | 1142 | </td> |
  |  | 1143 | </tr> |
  |  | 1144 | <?php |
  |  | 1145 | } |
  |  | 1146 | ?> |
  |  | 1147 | </table> |
  |  | 1148 | <p class="oa\_social\_login\_buttons"> |
  |  | 1149 | <input type="hidden" name="page" value="setup"/> |
  |  | 1150 | <input type="submit" class="oa\_social\_login\_btn oa\_social\_login\_btn\_success oa\_social\_login\_btn\_large" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Save Changes', 'oa-social-login') ?>"/> |
  |  | 1151 | </p> |
  |  | 1152 | </form> |
  |  | 1153 | </div> |
  |  | 1154 | </div> |
  |  | 1155 | <?php |
  | 1118 | 1156 | } |
  | 1119 | 1157 |  |
  | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3153096#L1122) | […](/browser/oa-social-login/trunk/includes/admin.php?rev=3201046#L1160) |  |
  | 1122 | 1160 | \* Display Settings Page |
  | 1123 | 1161 | \*\*/ |
  | 1124 |  | function oa\_display\_social\_login\_settings() |
  |  | 1162 | function oa\_display\_social\_login\_settings() |
  | 1125 | 1163 | { |
  | 1126 |  | ?> |
  | 1127 |  | <div class="wrap"> |
  | 1128 |  | <div id="oa\_social\_login\_page" class="oa\_social\_login\_settings"> |
  | 1129 |  | <h2> |
  | 1130 |  | OneAll Social Login <?php echo (defined ('OA\_SOCIAL\_LOGIN\_VERSION') ? OA\_SOCIAL\_LOGIN\_VERSION : ''); ?> \ <?php \_e ('Settings', 'oa-social-login'); ?> |
  | 1131 |  | <span class="oa\_social\_login\_header\_links"> |
  | 1132 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">About Us</a>', 'oa-social-login'), 'https://www.oneall.com/'); ?> |
  | 1133 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">FAQ - Hooks - Filters</a>', 'oa-social-login'), 'http://docs.oneall.com/plugins/guide/social-login-wordpress/'); ?> |
  | 1134 |  | <?php printf (\_\_ ('<a target="\_blank" href="%s">Contact Support Team</a>', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); ?> |
  |  | 1164 | ?> |
  |  | 1165 | <div class="wrap"> |
  |  | 1166 | <div id="oa\_social\_login\_page" class="oa\_social\_login\_settings"> |
  |  | 1167 | <h2> |
  |  | 1168 | OneAll Social Login <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo(defined('OA\_SOCIAL\_LOGIN\_VERSION') ? OA\_SOCIAL\_LOGIN\_VERSION : ''); ?> \ <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Settings', 'oa-social-login'); ?> |
  |  | 1169 | <span class="oa\_social\_login\_header\_links"> |
  |  | 1170 | <?php /\* translators: %s: website link \*/ |
  |  | 1171 | $message = sprintf(\_\_('<a target="\_blank" href="%s">About Us</a>', 'oa-social-login'), 'https://www.oneall.com/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message;?> |
  |  | 1172 | <?php /\* translators: %s: website link \*/ |
  |  | 1173 | $message = sprintf(\_\_('<a target="\_blank" href="%s">FAQ - Hooks - Filters</a>', 'oa-social-login'), 'http://docs.oneall.com/plugins/guide/social-login-wordpress/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message;?> |
  |  | 1174 | <?php /\* translators: %s: website link \*/ |
  |  | 1175 | $message = sprintf(\_\_('<a target="\_blank" href="%s">Contact Support Team</a>', 'oa-social-login'), 'https://app.oneall.com/open-support-ticket/'); /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message;?> |
  | 1135 | 1176 | </span> |
  | 1136 |  | </h2> |
  | 1137 |  | <h2 class="nav-tab-wrapper"> |
  | 1138 |  | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_setup"><?php \_e ('Setup', 'oa-social-login'); ?></a> |
  | 1139 |  | <a class="nav-tab nav-tab-active" href="admin.php?page=oa\_social\_login\_settings"><?php \_e ('Settings', 'oa-social-login'); ?></a> |
  | 1140 |  | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_more"><?php \_e ('+More', 'oa-social-login'); ?></a> |
  | 1141 |  | </h2> |
  | 1142 |  |  |
  | 1143 |  | <form method="post" action="options.php"> |
  | 1144 |  | <?php |
  | 1145 |  | settings\_fields ('oa\_social\_login\_settings\_group'); |
  | 1146 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 1147 |  |  |
  | 1148 |  | if (!empty ($\_REQUEST ['settings-updated']) AND strtolower ($\_REQUEST ['settings-updated']) == 'true') |
  | 1149 |  | { |
  | 1150 |  | ?> |
  | 1151 |  | <div class="oa\_social\_login\_box oa\_social\_login\_box\_notice"> |
  | 1152 |  | <p> |
  | 1153 |  | <?php \_e ('Your modifications have been saved successfully!', 'oa-social-login'); ?> |
  | 1154 |  | </p> |
  | 1155 |  | </div> |
  | 1156 |  | <?php |
  | 1157 |  | } |
  | 1158 |  | else |
  | 1159 |  | { |
  | 1160 |  | ?> |
  | 1161 |  | <div class="oa\_social\_login\_box oa\_social\_login\_box\_warning"> |
  | 1162 |  | <div class="oa\_social\_login\_box\_title"> |
  | 1163 |  | <?php \_e ('Logout to see the plugin in action!', 'oa-social-login'); ?> |
  | 1164 |  | </div> |
  | 1165 |  | <p> |
  | 1166 |  | <?php |
  | 1167 |  | \_e ('Social Login is a plugin that allows your users to comment, login and register with their existing Social Network accounts. If a user is already logged in, the plugin will not be displayed. There is no need to give the user the possibility to connect with a social network if he is already connected.', 'oa-social-login'); |
  | 1168 |  | ?> |
  | 1169 |  | <strong><?php \_e ('You therefore have to logout to see the plugin in action.', 'oa-social-login'); ?> </strong> |
  | 1170 |  | </p> |
  | 1171 |  | </div> |
  | 1172 |  | <?php |
  | 1173 |  | } |
  | 1174 |  | ?> |
  | 1175 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1176 |  | <tr class="row\_head"> |
  | 1177 |  | <th> |
  | 1178 |  | <?php \_e ('General Settings', 'oa-social-login'); ?> |
  | 1179 |  | </th> |
  | 1180 |  | </tr> |
  | 1181 |  | <tr class="row\_odd"> |
  | 1182 |  | <td> |
  | 1183 |  | <strong><?php \_e ('Enter the description to be displayed above the Social Login buttons (leave empty for none):', 'oa-social-login'); ?></strong> |
  | 1184 |  | </td> |
  | 1185 |  | </tr> |
  | 1186 |  | <tr class="row\_even"> |
  | 1187 |  | <td> |
  | 1188 |  | <?php |
  | 1189 |  | $plugin\_caption = (isset ($settings ['plugin\_caption']) ? $settings ['plugin\_caption'] : \_\_ ('Connect with:', 'oa-social-login')); |
  | 1190 |  | ?> |
  | 1191 |  | <input type="text" name="oa\_social\_login\_settings[plugin\_caption]" size="90" value="<?php echo htmlspecialchars ($plugin\_caption); ?>" /> |
  | 1192 |  | </td> |
  | 1193 |  | </tr> |
  | 1194 |  | <tr class="row\_odd"> |
  | 1195 |  | <td> |
  | 1196 |  | <strong><?php \_e ("Select the icon theme to use per default:", 'oa-social-login'); ?></strong> |
  | 1197 |  | </td> |
  | 1198 |  | </tr> |
  | 1199 |  | <tr class="row\_even"> |
  | 1200 |  | <td> |
  | 1201 |  | <?php |
  | 1202 |  | $plugin\_icon\_theme = ((isset ($settings ['plugin\_icon\_theme']) AND in\_array ($settings ['plugin\_icon\_theme'], array (0, 1, 2))) ? $settings ['plugin\_icon\_theme'] : OA\_SOCIAL\_LOGIN\_DEFAULT\_THEME); |
  | 1203 |  | ?> |
  | 1204 |  | <input type="radio" id="plugin\_icon\_theme\_0" name="oa\_social\_login\_settings[plugin\_icon\_theme]" value="0" <?php echo ($plugin\_icon\_theme == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_icon\_theme\_0"><img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ ) . '../assets/img/theme\_classic.png' ?>" alt="<?php \_e('Classic', 'oa-social-login'); ?>" /></label> |
  | 1205 |  | <input type="radio" id="plugin\_icon\_theme\_1" name="oa\_social\_login\_settings[plugin\_icon\_theme]" value="1" <?php echo ($plugin\_icon\_theme == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_icon\_theme\_1"><img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ ) . '../assets/img/theme\_modern.png' ?>" alt="<?php \_e('Modern', 'oa-social-login'); ?>" /></label> |
  | 1206 |  | <input type="radio" id="plugin\_icon\_theme\_2" name="oa\_social\_login\_settings[plugin\_icon\_theme]" value="2" <?php echo ($plugin\_icon\_theme == 2 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_icon\_theme\_2"><img src="<?php echo plugin\_dir\_url( \_\_FILE\_\_ ) . '../assets/img/theme\_small.png' ?>" alt="<?php \_e('Small', 'oa-social-login'); ?>" /></label> |
  | 1207 |  | </td> |
  | 1208 |  | </tr> |
  | 1209 |  | <tr class="row\_odd"> |
  | 1210 |  | <td> |
  | 1211 |  | <strong><?php \_e ('Do you want to display the social networks used to connect in the user list of the administration area ?', 'oa-social-login'); ?></strong> |
  | 1212 |  | </td> |
  | 1213 |  | </tr> |
  | 1214 |  | <tr class="row\_even"> |
  | 1215 |  | <td> |
  | 1216 |  | <?php |
  | 1217 |  | $plugin\_add\_column\_user\_list = ((isset ($settings ['plugin\_add\_column\_user\_list']) AND in\_array ($settings ['plugin\_add\_column\_user\_list'], array (0, 1))) ? $settings ['plugin\_add\_column\_user\_list'] : 1); |
  | 1218 |  | ?> |
  | 1219 |  | <input type="radio" id="plugin\_add\_column\_user\_list\_1" name="oa\_social\_login\_settings[plugin\_add\_column\_user\_list]" value="1" <?php echo ($plugin\_add\_column\_user\_list == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_add\_column\_user\_list\_1"><?php \_e ('Yes, add a new column to the user list and display the social network that the user connected with', 'oa-social-login'); ?><strong> (<?php \_e ('Default', 'oa-social-login') ?>)</strong></label> <br /> |
  | 1220 |  | <input type="radio" id="plugin\_add\_column\_user\_list\_0" name="oa\_social\_login\_settings[plugin\_add\_column\_user\_list]" value="0" <?php echo ($plugin\_add\_column\_user\_list == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_add\_column\_user\_list\_0"><?php \_e ('No, do not display the social networks in the user list', 'oa-social-login'); ?></label> |
  | 1221 |  | </td> |
  | 1222 |  | </tr> |
  | 1223 |  | <tr class="row\_odd"> |
  | 1224 |  | <td> |
  | 1225 |  | <strong><?php \_e ('Do you want to receive an email whenever a new user registers with Social Login ?', 'oa-social-login'); ?></strong> |
  | 1226 |  | </td> |
  | 1227 |  | </tr> |
  | 1228 |  | <tr class="row\_even"> |
  | 1229 |  | <td> |
  | 1230 |  | <?php |
  | 1231 |  | $plugin\_notify\_admin = ((isset ($settings ['plugin\_notify\_admin']) AND in\_array ($settings ['plugin\_notify\_admin'], array (0, 1))) ? $settings ['plugin\_notify\_admin'] : 1); |
  | 1232 |  | ?> |
  | 1233 |  | <input type="radio" id="plugin\_notify\_admin\_1" name="oa\_social\_login\_settings[plugin\_notify\_admin]" value="1" <?php echo ($plugin\_notify\_admin == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_notify\_admin\_1"><?php \_e ('Yes, send me an email whenever a new user registers with Social Login', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1234 |  | <input type="radio" id="plugin\_notify\_admin\_0" name="oa\_social\_login\_settings[plugin\_notify\_admin]" value="0" <?php echo ($plugin\_notify\_admin == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_notify\_admin\_0"><?php \_e ('No, do not send me any emails', 'oa-social-login'); ?></label> |
  | 1235 |  | </td> |
  | 1236 |  | </tr> |
  | 1237 |  | </table> |
  | 1238 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1239 |  | <tr class="row\_head"> |
  | 1240 |  | <th> |
  | 1241 |  | <?php \_e ('User Settings', 'oa-social-login'); ?> |
  | 1242 |  | </th> |
  | 1243 |  | </tr> |
  | 1244 |  | <tr class="row\_odd"> |
  | 1245 |  | <td> |
  | 1246 |  | <strong><?php \_e ("If the user's social network profile has no email address, should we ask the user to enter it manually?", 'oa-social-login'); ?></strong> |
  | 1247 |  | </td> |
  | 1248 |  | </tr> |
  | 1249 |  | <tr class="row\_even"> |
  | 1250 |  | <td> |
  | 1251 |  | <?php |
  | 1252 |  | $plugin\_require\_email = ((isset ($settings ['plugin\_require\_email']) AND in\_array ($settings ['plugin\_require\_email'], array (0, 1))) ? $settings ['plugin\_require\_email'] : 0); |
  | 1253 |  | ?> |
  | 1254 |  | <input type="radio" id="plugin\_require\_email\_0" name="oa\_social\_login\_settings[plugin\_require\_email]" value="0" <?php echo ($plugin\_require\_email == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_require\_email\_0"><?php \_e ('No, simplify the registration by automatically creating a placeholder email', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1255 |  | <input type="radio" id="plugin\_require\_email\_1" name="oa\_social\_login\_settings[plugin\_require\_email]" value="1" <?php echo ($plugin\_require\_email == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_require\_email\_1"><?php \_e ('Yes, require the user to enter his email address manually and display this message:', 'oa-social-login'); ?></label> <br /> |
  | 1256 |  | <textarea name="oa\_social\_login\_settings[plugin\_require\_email\_text]" cols="100" rows="3"><?php echo (isset ($settings ['plugin\_require\_email\_text']) ? htmlspecialchars ($settings ['plugin\_require\_email\_text']) : \_e ('<strong>We unfortunately could not retrieve your email address from %s.</strong> Please enter your email address in the form below in order to continue.', 'oa-social-login')); ?></textarea> |
  | 1257 |  | <span class="description"><?php \_e ('HTML is allowed, the placeholder %s is replaced by the name of the social network used to connect.', 'oa-social-login'); ?></span> |
  | 1258 |  | </td> |
  | 1259 |  | </tr> |
  | 1260 |  | <tr class="row\_odd"> |
  | 1261 |  | <td> |
  | 1262 |  | <strong><?php \_e ("If the user's social network profile has a verified email, should we try to link it to an existing account?", 'oa-social-login'); ?></strong> |
  | 1263 |  | </td> |
  | 1264 |  | </tr> |
  | 1265 |  | <tr class="row\_even"> |
  | 1266 |  | <td> |
  | 1267 |  | <?php |
  | 1268 |  | $plugin\_link\_verified\_accounts = ((isset ($settings ['plugin\_link\_verified\_accounts']) AND in\_array ($settings ['plugin\_link\_verified\_accounts'], array (0, 1))) ? $settings ['plugin\_link\_verified\_accounts'] : 1); |
  | 1269 |  | ?> |
  | 1270 |  | <input type="radio" id="plugin\_link\_verified\_accounts\_1" name="oa\_social\_login\_settings[plugin\_link\_verified\_accounts]" value="1" <?php echo ($plugin\_link\_verified\_accounts == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_link\_verified\_accounts\_1"><?php \_e ('Yes, try to link verified social network profiles to existing blog accounts', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1271 |  | <input type="radio" id="plugin\_link\_verified\_accounts\_0" name="oa\_social\_login\_settings[plugin\_link\_verified\_accounts]" value="0" <?php echo ($plugin\_link\_verified\_accounts == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_link\_verified\_accounts\_0"><?php \_e ('No, disable account linking', 'oa-social-login'); ?></label> |
  | 1272 |  | </td> |
  | 1273 |  | </tr> |
  | 1274 |  | <tr class="row\_odd"> |
  | 1275 |  | <td> |
  | 1276 |  | <strong><?php \_e ("If the user's social network profile has an avatar, should this avatar be used as default avatar for the user?", 'oa-social-login'); ?></strong> |
  | 1277 |  | </td> |
  | 1278 |  | </tr> |
  | 1279 |  | <tr class="row\_even"> |
  | 1280 |  | <td> |
  | 1281 |  | <?php |
  | 1282 |  | $plugin\_show\_avatars\_in\_comments = ((isset ($settings ['plugin\_show\_avatars\_in\_comments']) AND in\_array ($settings ['plugin\_show\_avatars\_in\_comments'], array (0, 1, 2))) ? $settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  | 1283 |  | ?> |
  | 1284 |  | <input type="radio" id="plugin\_show\_avatars\_in\_comments\_0" name="oa\_social\_login\_settings[plugin\_show\_avatars\_in\_comments]" value="0" <?php echo ($plugin\_show\_avatars\_in\_comments == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_show\_avatars\_in\_comments\_0"><?php \_e ('No, do not use avatars from social networks', 'oa-social-login'); ?></label><br /> |
  | 1285 |  | <input type="radio" id="plugin\_show\_avatars\_in\_comments\_1" name="oa\_social\_login\_settings[plugin\_show\_avatars\_in\_comments]" value="1" <?php echo ($plugin\_show\_avatars\_in\_comments == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_show\_avatars\_in\_comments\_1"><?php \_e ('Yes, use small avatars from social networks if available', 'oa-social-login'); ?></label><br /> |
  | 1286 |  | <input type="radio" id="plugin\_show\_avatars\_in\_comments\_2" name="oa\_social\_login\_settings[plugin\_show\_avatars\_in\_comments]" value="2" <?php echo ($plugin\_show\_avatars\_in\_comments == 2 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_show\_avatars\_in\_comments\_2"><?php \_e ('Yes, use large avatars from social networks if available', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label> |
  | 1287 |  | </td> |
  | 1288 |  | </tr> |
  | 1289 |  | </table> |
  | 1290 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1291 |  | <tr class="row\_head"> |
  | 1292 |  | <th> |
  | 1293 |  | <?php \_e ('Comment Settings', 'oa-social-login'); ?> |
  | 1294 |  | </th> |
  | 1295 |  | </tr> |
  | 1296 |  | <tr class="row\_odd"> |
  | 1297 |  | <td> |
  | 1298 |  | <strong><?php \_e ("Show the Social Login buttons in the comment area?", 'oa-social-login'); ?></strong> |
  | 1299 |  | </td> |
  | 1300 |  | </tr> |
  | 1301 |  | <tr class="row\_even"> |
  | 1302 |  | <td> |
  | 1303 |  | <?php |
  | 1304 |  | $plugin\_comment\_show = ((isset ($settings ['plugin\_comment\_show']) AND in\_array ($settings ['plugin\_comment\_show'], array (0, 1))) ? $settings ['plugin\_comment\_show'] : 1); |
  | 1305 |  | ?> |
  | 1306 |  | <input type="radio" id="plugin\_comment\_show\_1" name="oa\_social\_login\_settings[plugin\_comment\_show]" value="1" <?php echo ($plugin\_comment\_show == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_1"><?php \_e ('Yes, show the Social Login buttons', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1307 |  | <input type="radio" id="plugin\_comment\_show\_0" name="oa\_social\_login\_settings[plugin\_comment\_show]" value="0" <?php echo ($plugin\_comment\_show == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_0"><?php \_e ('No, do not show the Social Login buttons', 'oa-social-login'); ?></label><br /> |
  | 1308 |  | </td> |
  | 1309 |  | </tr> |
  | 1310 |  | <tr class="row\_odd"> |
  | 1311 |  | <td> |
  | 1312 |  | <strong><?php \_e ("Show the Social Login buttons in the comment area if comments are disabled for guests?", 'oa-social-login'); ?></strong> |
  | 1313 |  | </td> |
  | 1314 |  | </tr> |
  | 1315 |  | <tr class="row\_even"> |
  | 1316 |  | <td> |
  | 1317 |  | <?php |
  | 1318 |  | $plugin\_comment\_show\_if\_members\_only = ((isset ($settings ['plugin\_comment\_show\_if\_members\_only']) AND in\_array ($settings ['plugin\_comment\_show\_if\_members\_only'], array (0, 1))) ? $settings ['plugin\_comment\_show\_if\_members\_only'] : 1); |
  | 1319 |  | ?> |
  | 1320 |  | <span class="description"><?php \_e ('The buttons will be displayed below the "You must be logged in to leave a comment" notice.', 'oa-social-login'); ?> </span><br /> |
  | 1321 |  | <input type="radio" id="plugin\_comment\_show\_if\_members\_only\_1" name="oa\_social\_login\_settings[plugin\_comment\_show\_if\_members\_only]" value="1" <?php echo ($plugin\_comment\_show\_if\_members\_only == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_if\_members\_only\_1"><?php \_e ('Yes, show the Social Login buttons', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1322 |  | <input type="radio" id="plugin\_comment\_show\_if\_members\_only\_0" name="oa\_social\_login\_settings[plugin\_comment\_show\_if\_members\_only]" value="0" <?php echo ($plugin\_comment\_show\_if\_members\_only == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_if\_members\_only\_0"><?php \_e ('No, do not show the Social Login buttons', 'oa-social-login'); ?></label> |
  | 1323 |  | </td> |
  | 1324 |  | </tr> |
  | 1325 |  | <tr class="row\_odd"> |
  | 1326 |  | <td> |
  | 1327 |  | <strong><?php \_e ("Automatically approve comments left by users that connected by using Social Login?", 'oa-social-login'); ?></strong> |
  | 1328 |  | </td> |
  | 1329 |  | </tr> |
  | 1330 |  | <tr class="row\_even"> |
  | 1331 |  | <td> |
  | 1332 |  | <?php |
  | 1333 |  | $plugin\_comment\_auto\_approve = ((isset ($settings ['plugin\_comment\_auto\_approve']) AND in\_array ($settings ['plugin\_comment\_auto\_approve'], array (0, 1))) ? $settings ['plugin\_comment\_auto\_approve'] : 0); |
  | 1334 |  | ?> |
  | 1335 |  | <input type="radio" id="plugin\_comment\_auto\_approve\_1" name="oa\_social\_login\_settings[plugin\_comment\_auto\_approve]" value="1" <?php echo ($plugin\_comment\_auto\_approve == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_auto\_approve\_1"><?php \_e ('Yes, automatically approve comments made by users that connected with Social Login', 'oa-social-login'); ?></label><br /> |
  | 1336 |  | <input type="radio" id="plugin\_comment\_auto\_approve\_0" name="oa\_social\_login\_settings[plugin\_comment\_auto\_approve]" value="0" <?php echo ($plugin\_comment\_auto\_approve == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_auto\_approve\_0"><?php \_e ('No, do not automatically approve', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</label> |
  | 1337 |  | </strong><br /> |
  | 1338 |  | </td> |
  | 1339 |  | </tr> |
  | 1340 |  | </table> |
  | 1341 |  |  |
  | 1342 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1343 |  | <tr class="row\_head"> |
  | 1344 |  | <th> |
  | 1345 |  | <?php \_e ('Profile Settings', 'oa-social-login'); ?> |
  | 1346 |  | </th> |
  | 1347 |  | </tr> |
  | 1348 |  | <tr class="row\_odd"> |
  | 1349 |  | <td> |
  | 1350 |  | <strong><?php \_e ("Show the Social Link buttons in the user profile?", 'oa-social-login'); ?></strong> |
  | 1351 |  | </td> |
  | 1352 |  | </tr> |
  | 1353 |  | <tr class="row\_even"> |
  | 1354 |  | <td> |
  | 1355 |  | <span class="description"><?php \_e ('Keep this option enabled to allow each user to connect multiple social networks to his own profile.', 'oa-social-login'); ?> </span><br /> |
  | 1356 |  | <?php |
  | 1357 |  | $plugin\_profile\_show = ((isset ($settings ['plugin\_profile\_show']) AND in\_array ($settings ['plugin\_profile\_show'], array (0, 1))) ? $settings ['plugin\_profile\_show'] : 1); |
  | 1358 |  | ?> |
  | 1359 |  | <input type="radio" id="plugin\_profile\_show\_1" name="oa\_social\_login\_settings[plugin\_profile\_show]" value="1" <?php echo ($plugin\_profile\_show == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_profile\_show\_1"><?php \_e ('Yes, show the Social Link buttons', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1360 |  | <input type="radio" id="plugin\_profile\_show\_0" name="oa\_social\_login\_settings[plugin\_profile\_show]" value="0" <?php echo ($plugin\_profile\_show == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_profile\_show\_0"><?php \_e ('No, do not show the Social Link buttons', 'oa-social-login'); ?></label><br /> |
  | 1361 |  | </td> |
  | 1362 |  | </tr> |
  | 1363 |  | </table> |
  | 1364 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1365 |  | <tr class="row\_head"> |
  | 1366 |  | <th> |
  | 1367 |  | <?php \_e ('Login Page Settings', 'oa-social-login'); ?> |
  | 1368 |  | </th> |
  | 1369 |  | </tr> |
  | 1370 |  | <tr class="row\_odd"> |
  | 1371 |  | <td> |
  | 1372 |  | <strong><?php \_e ('Do you want to display Social Login on the login form of your blog?', 'oa-social-login'); ?></strong> |
  | 1373 |  | </td> |
  | 1374 |  | </tr> |
  | 1375 |  | <tr class="row\_even"> |
  | 1376 |  | <td> |
  | 1377 |  | <?php |
  | 1378 |  | $plugin\_display\_in\_login\_form = ((isset ($settings ['plugin\_display\_in\_login\_form']) AND in\_array ($settings ['plugin\_display\_in\_login\_form'], array (0, 1))) ? $settings ['plugin\_display\_in\_login\_form'] : 1); |
  | 1379 |  | ?> |
  | 1380 |  | <input type="radio" id="plugin\_display\_in\_login\_form\_1" name="oa\_social\_login\_settings[plugin\_display\_in\_login\_form]" value="1" <?php echo ($plugin\_display\_in\_login\_form == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_login\_form\_1"><?php \_e ('Yes, display the social network buttons below the login form', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1381 |  | <input type="radio" id="plugin\_display\_in\_login\_form\_0" name="oa\_social\_login\_settings[plugin\_display\_in\_login\_form]" value="0" <?php echo ($plugin\_display\_in\_login\_form == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_login\_form\_0"><?php \_e ('No, disable social network buttons in the login form', 'oa-social-login'); ?></label> |
  | 1382 |  | </td> |
  | 1383 |  | </tr> |
  | 1384 |  | <tr class="row\_odd"> |
  | 1385 |  | <td> |
  | 1386 |  | <strong><?php \_e ('Where should users be redirected to after having logged in with Social Login on the login page?', 'oa-social-login'); ?></strong> |
  | 1387 |  | </td> |
  | 1388 |  | </tr> |
  | 1389 |  | <tr class="row\_even"> |
  | 1390 |  | <td> |
  | 1391 |  | <?php |
  | 1392 |  | $plugin\_login\_form\_redirect = ((isset ($settings ['plugin\_login\_form\_redirect']) AND in\_array ($settings ['plugin\_login\_form\_redirect'], array ('current','homepage','dashboard','custom'))) ? $settings ['plugin\_login\_form\_redirect'] : 'homepage'); |
  | 1393 |  | $plugin\_login\_form\_redirect\_custom\_url = (isset ($settings ['plugin\_login\_form\_redirect\_custom\_url']) ? $settings ['plugin\_login\_form\_redirect\_custom\_url'] : ''); |
  | 1394 |  | ?> |
  | 1395 |  | <input type="radio" id="plugin\_login\_form\_redirect\_current" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="current" <?php echo ($plugin\_login\_form\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_current"><?php \_e ('Redirect users back to the current page', 'oa-social-login'); ?></label><br /> |
  | 1396 |  | <input type="radio" id="plugin\_login\_form\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="homepage" <?php echo ($plugin\_login\_form\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_homepage"><?php \_e ('Redirect users to the homepage of my blog', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1397 |  | <input type="radio" id="plugin\_login\_form\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="dashboard" <?php echo ($plugin\_login\_form\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_dashboard"><?php \_e ('Redirect users to their account dashboard', 'oa-social-login'); ?></label><br /> |
  | 1398 |  | <input type="radio" id="plugin\_login\_form\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="custom" <?php echo ($plugin\_login\_form\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_custom"><?php \_e ('Redirect users to the following url', 'oa-social-login'); ?>:</label><br /> |
  | 1399 |  | <input type="text" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect\_custom\_url]" size="90" value="<?php echo htmlspecialchars ($plugin\_login\_form\_redirect\_custom\_url); ?>" /> |
  | 1400 |  | </td> |
  | 1401 |  | </tr> |
  | 1402 |  | <tr class="row\_odd"> |
  | 1403 |  | <td> |
  | 1404 |  | <strong><?php \_e ('Allow other plugins to change the redirection url that you have chosen by using a hook/filter?', 'oa-social-login'); ?></strong> |
  | 1405 |  | </td> |
  | 1406 |  | </tr> |
  | 1407 |  | <tr class="row\_even"> |
  | 1408 |  | <td> |
  | 1409 |  | <?php |
  | 1410 |  | $plugin\_protect\_login\_redirect\_url = (empty ($settings ['plugin\_protect\_login\_redirect\_url']) ? 0 : 1); |
  | 1411 |  | ?> |
  | 1412 |  | <input type="radio" id="plugin\_protect\_login\_redirect\_url\_0" name="oa\_social\_login\_settings[plugin\_protect\_login\_redirect\_url]" value="0" <?php echo ($plugin\_protect\_login\_redirect\_url == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_login\_redirect\_url\_0"><?php \_e ('Yes, allow plugins to change the redirection url', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1413 |  | <input type="radio" id="plugin\_protect\_login\_redirect\_url\_1" name="oa\_social\_login\_settings[plugin\_protect\_login\_redirect\_url]" value="1" <?php echo ($plugin\_protect\_login\_redirect\_url == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_login\_redirect\_url\_1"><?php \_e ('No, protect the redirection url (Use this option if the redirection does not work correctly)', 'oa-social-login'); ?></label> |
  | 1414 |  | </td> |
  | 1415 |  | </tr> |
  | 1416 |  | </table> |
  | 1417 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1418 |  | <tr class="row\_head"> |
  | 1419 |  | <th> |
  | 1420 |  | <?php \_e ('Registration Page Settings', 'oa-social-login'); ?> |
  | 1421 |  | </th> |
  | 1422 |  | </tr> |
  | 1423 |  | <tr class="row\_odd"> |
  | 1424 |  | <td> |
  | 1425 |  | <strong><?php \_e ('Do you want to display Social Login on the registration form of your blog?', 'oa-social-login'); ?></strong> |
  | 1426 |  | </td> |
  | 1427 |  | </tr> |
  | 1428 |  | <tr class="row\_even"> |
  | 1429 |  | <td> |
  | 1430 |  | <?php |
  | 1431 |  | $plugin\_display\_in\_registration\_form = ((isset ($settings ['plugin\_display\_in\_registration\_form']) AND in\_array ($settings ['plugin\_display\_in\_registration\_form'], array (0, 1))) ? $settings ['plugin\_display\_in\_registration\_form'] : 1); |
  | 1432 |  | ?> |
  | 1433 |  | <input type="radio" id="plugin\_display\_in\_registration\_form\_1" name="oa\_social\_login\_settings[plugin\_display\_in\_registration\_form]" value="1" <?php echo ($plugin\_display\_in\_registration\_form == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_registration\_form\_1"><?php \_e ('Yes, display the social network buttons below the registration form', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1434 |  | <input type="radio" id="plugin\_display\_in\_registration\_form\_0" name="oa\_social\_login\_settings[plugin\_display\_in\_registration\_form]" value="0" <?php echo ($plugin\_display\_in\_registration\_form == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_registration\_form\_0"><?php \_e ('No, disable social network buttons in the registration form', 'oa-social-login'); ?></label> |
  | 1435 |  | </td> |
  | 1436 |  | </tr> |
  | 1437 |  | <tr class="row\_odd"> |
  | 1438 |  | <td> |
  | 1439 |  | <strong><?php \_e ('Where should users be redirected to after having registered with Social Login on the registration page?', 'oa-social-login'); ?></strong> |
  | 1440 |  | </td> |
  | 1441 |  | </tr> |
  | 1442 |  | <tr class="row\_even"> |
  | 1443 |  | <td> |
  | 1444 |  | <?php |
  | 1445 |  | $plugin\_registration\_form\_redirect = ((isset ($settings ['plugin\_registration\_form\_redirect']) AND in\_array ($settings ['plugin\_registration\_form\_redirect'], array ('current','homepage','dashboard','custom'))) ? $settings ['plugin\_registration\_form\_redirect'] : 'dashboard'); |
  | 1446 |  | $plugin\_registration\_form\_redirect\_custom\_url = (isset ($settings ['plugin\_registration\_form\_redirect\_custom\_url']) ? $settings ['plugin\_registration\_form\_redirect\_custom\_url'] : ''); |
  | 1447 |  | ?> |
  | 1448 |  | <input type="radio" id="plugin\_registration\_form\_redirect\_current" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="current" <?php echo ($plugin\_registration\_form\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_current"><?php \_e ('Redirect users back to the current page', 'oa-social-login'); ?></label><br /> |
  | 1449 |  | <input type="radio" id="plugin\_registration\_form\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="homepage" <?php echo ($plugin\_registration\_form\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_homepage"><?php \_e ('Redirect users to the homepage of my blog', 'oa-social-login'); ?></label><br /> |
  | 1450 |  | <input type="radio" id="plugin\_registration\_form\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="dashboard" <?php echo ($plugin\_registration\_form\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_dashboard"><?php \_e ('Redirect users to their account dashboard', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1451 |  | <input type="radio" id="plugin\_registration\_form\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="custom" <?php echo ($plugin\_registration\_form\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_custom"><?php \_e ('Redirect users to the following url', 'oa-social-login'); ?>:</label><br /> |
  | 1452 |  | <input type="text" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect\_custom\_url]" size="90" value="<?php echo htmlspecialchars ($plugin\_registration\_form\_redirect\_custom\_url); ?>" /> |
  | 1453 |  | </td> |
  | 1454 |  | </tr> |
  | 1455 |  | <tr class="row\_odd"> |
  | 1456 |  | <td> |
  | 1457 |  | <strong><?php \_e ('Allow other plugins to change the redirection url that you have chosen by using a hook/filter?', 'oa-social-login'); ?></strong> |
  | 1458 |  | </td> |
  | 1459 |  | </tr> |
  | 1460 |  | <tr class="row\_even"> |
  | 1461 |  | <td> |
  | 1462 |  | <?php |
  | 1463 |  | $plugin\_protect\_registration\_redirect\_url = (empty ($settings ['plugin\_protect\_registration\_redirect\_url']) ? 0 : 1); |
  | 1464 |  | ?> |
  | 1465 |  | <input type="radio" id="plugin\_protect\_registration\_redirect\_url\_0" name="oa\_social\_login\_settings[plugin\_protect\_registration\_redirect\_url]" value="0" <?php echo ($plugin\_protect\_registration\_redirect\_url == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_registration\_redirect\_url\_0"><?php \_e ('Yes, allow plugins to change the redirection url', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1466 |  | <input type="radio" id="plugin\_protect\_registration\_redirect\_url\_1" name="oa\_social\_login\_settings[plugin\_protect\_registration\_redirect\_url]" value="1" <?php echo ($plugin\_protect\_registration\_redirect\_url == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_registration\_redirect\_url\_1"><?php \_e ('No, protect the redirection url (Use this option if the redirection does not work correctly)', 'oa-social-login'); ?></label> |
  | 1467 |  | </td> |
  | 1468 |  | </tr> |
  | 1469 |  | </table> |
  | 1470 |  | <table class="form-table oa\_social\_login\_table"> |
  | 1471 |  | <tr class="row\_head"> |
  | 1472 |  | <th> |
  | 1473 |  | <?php \_e ('Widget &amp; Shortcode Settings', 'oa-social-login'); ?> |
  | 1474 |  | </th> |
  | 1475 |  | </tr> |
  | 1476 |  | <tr class="row\_odd"> |
  | 1477 |  | <td> |
  | 1478 |  | <strong><?php \_e ('Redirect users to this page after they have logged in with Social Login embedded by Widget/Shortcode:', 'oa-social-login'); ?></strong> |
  | 1479 |  | </td> |
  | 1480 |  | </tr> |
  | 1481 |  | <tr class="row\_even"> |
  | 1482 |  | <td> |
  | 1483 |  | <?php |
  | 1484 |  | $plugin\_shortcode\_login\_redirect = ((isset ($settings ['plugin\_shortcode\_login\_redirect']) AND in\_array ($settings ['plugin\_shortcode\_login\_redirect'], array ('current', 'dashboard', 'homepage', 'custom'))) ? $settings ['plugin\_shortcode\_login\_redirect'] : 'current'); |
  | 1485 |  | $plugin\_shortcode\_login\_redirect\_url = (isset ($settings ['plugin\_shortcode\_login\_redirect\_url']) ? $settings ['plugin\_shortcode\_login\_redirect\_url'] : ''); |
  | 1486 |  | ?> |
  | 1487 |  | <input type="radio" id="plugin\_shortcode\_login\_redirect\_current" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="current" <?php echo ($plugin\_shortcode\_login\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_current"><?php \_e ('Redirect users back to the current page', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1488 |  | <input type="radio" id="plugin\_shortcode\_login\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="homepage" <?php echo ($plugin\_shortcode\_login\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_homepage"><?php \_e ('Redirect users to the homepage of my blog', 'oa-social-login'); ?></label><br /> |
  | 1489 |  | <input type="radio" id="plugin\_shortcode\_login\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="dashboard" <?php echo ($plugin\_shortcode\_login\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_dashboard"><?php \_e ('Redirect users to their account dashboard', 'oa-social-login'); ?></label><br /> |
  | 1490 |  | <input type="radio" id="plugin\_shortcode\_login\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="custom" <?php echo ($plugin\_shortcode\_login\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_custom"><?php \_e ('Redirect users to the following url', 'oa-social-login'); ?>:</label><br /> |
  | 1491 |  | <input type="text" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect\_url]" size="90" value="<?php echo htmlspecialchars ($plugin\_shortcode\_login\_redirect\_url); ?>" /> |
  | 1492 |  | </td> |
  | 1493 |  | </tr> |
  | 1494 |  | <tr class="row\_odd"> |
  | 1495 |  | <td> |
  | 1496 |  | <strong><?php \_e ('Redirect users to this page after they have registered with Social Login embedded by Widget/Shortcode:', 'oa-social-login'); ?></strong> |
  | 1497 |  | </td> |
  | 1498 |  | </tr> |
  | 1499 |  | <tr class="row\_even"> |
  | 1500 |  | <td> |
  | 1501 |  | <?php |
  | 1502 |  | $plugin\_shortcode\_register\_redirect = ((isset ($settings ['plugin\_shortcode\_register\_redirect']) AND in\_array ($settings ['plugin\_shortcode\_register\_redirect'], array ('current', 'dashboard', 'homepage', 'custom'))) ? $settings ['plugin\_shortcode\_register\_redirect'] : 'current'); |
  | 1503 |  | $plugin\_shortcode\_register\_redirect\_url = (isset ($settings ['plugin\_shortcode\_register\_redirect\_url']) ? $settings ['plugin\_shortcode\_register\_redirect\_url'] : ''); |
  | 1504 |  | ?> |
  | 1505 |  | <input type="radio" id="plugin\_shortcode\_register\_redirect\_current" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="current" <?php echo ($plugin\_shortcode\_register\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_current"><?php \_e ('Redirect users back to the current page', 'oa-social-login'); ?> <strong>(<?php \_e ('Default', 'oa-social-login') ?>)</strong></label><br /> |
  | 1506 |  | <input type="radio" id="plugin\_shortcode\_register\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="homepage" <?php echo ($plugin\_shortcode\_register\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_homepage"><?php \_e ('Redirect users to the homepage of my blog', 'oa-social-login'); ?></label><br /> |
  | 1507 |  | <input type="radio" id="plugin\_shortcode\_register\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="dashboard" <?php echo ($plugin\_shortcode\_register\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_dashboard"><?php \_e ('Redirect users to their account dashboard', 'oa-social-login'); ?></label><br /> |
  | 1508 |  | <input type="radio" id="plugin\_shortcode\_register\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="custom" <?php echo ($plugin\_shortcode\_register\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_custom"><?php \_e ('Redirect users to the following url', 'oa-social-login'); ?>:</label><br /> |
  | 1509 |  | <input type="text" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect\_url]" size="90" value="<?php echo htmlspecialchars ($plugin\_shortcode\_register\_redirect\_url); ?>" /> |
  | 1510 |  | </td> |
  | 1511 |  | </tr> |
  | 1512 |  | </table> |
  | 1513 |  | <p class="oa\_social\_login\_buttons"> |
  | 1514 |  | <input type="hidden" name="page" value="settings" /> |
  | 1515 |  | <input type="submit" class="oa\_social\_login\_btn oa\_social\_login\_btn\_success oa\_social\_login\_btn\_large" value="<?php \_e ('Save Changes', 'oa-social-login') ?>" /> |
  | 1516 |  | </p> |
  | 1517 |  | </form> |
  | 1518 |  | </div> |
  | 1519 |  | </div> |
  | 1520 |  | <?php |
  |  | 1177 | </h2> |
  |  | 1178 | <h2 class="nav-tab-wrapper"> |
  |  | 1179 | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_setup"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Setup', 'oa-social-login'); ?></a> |
  |  | 1180 | <a class="nav-tab nav-tab-active" href="admin.php?page=oa\_social\_login\_settings"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Settings', 'oa-social-login'); ?></a> |
  |  | 1181 | <a class="nav-tab" href="admin.php?page=oa\_social\_login\_more"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('+More', 'oa-social-login'); ?></a> |
  |  | 1182 | </h2> |
  |  | 1183 |  |
  |  | 1184 | <form method="post" action="options.php"> |
  |  | 1185 | <?php |
  |  | 1186 | settings\_fields('oa\_social\_login\_settings\_group'); |
  |  | 1187 | $settings = get\_option('oa\_social\_login\_settings'); |
  |  | 1188 |  |
  |  | 1189 | if (!empty ($\_REQUEST ['settings-updated']) and strtolower($\_REQUEST ['settings-updated']) == 'true') |
  |  | 1190 | { |
  |  | 1191 | ?> |
  |  | 1192 | <div class="oa\_social\_login\_box oa\_social\_login\_box\_notice"> |
  |  | 1193 | <p> |
  |  | 1194 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Your modifications have been saved successfully!', 'oa-social-login'); ?> |
  |  | 1195 | </p> |
  |  | 1196 | </div> |
  |  | 1197 | <?php |
  |  | 1198 | } |
  |  | 1199 | else |
  |  | 1200 | { |
  |  | 1201 | ?> |
  |  | 1202 | <div class="oa\_social\_login\_box oa\_social\_login\_box\_warning"> |
  |  | 1203 | <div class="oa\_social\_login\_box\_title"> |
  |  | 1204 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Logout to see the plugin in action!', 'oa-social-login'); ?> |
  |  | 1205 | </div> |
  |  | 1206 | <p> |
  |  | 1207 | <?php |
  |  | 1208 | esc\_html\_e('Social Login is a plugin that allows your users to comment, login and register with their existing Social Network accounts. If a user is already logged in, the plugin will not be displayed. There is no need to give the user the possibility to connect with a social network if he is already connected.', 'oa-social-login'); |
  |  | 1209 | ?> |
  |  | 1210 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('You therefore have to logout to see the plugin in action.', 'oa-social-login'); ?> </strong> |
  |  | 1211 | </p> |
  |  | 1212 | </div> |
  |  | 1213 | <?php |
  |  | 1214 | } |
  |  | 1215 | ?> |
  |  | 1216 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1217 | <tr class="row\_head"> |
  |  | 1218 | <th> |
  |  | 1219 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('General Settings', 'oa-social-login'); ?> |
  |  | 1220 | </th> |
  |  | 1221 | </tr> |
  |  | 1222 | <tr class="row\_odd"> |
  |  | 1223 | <td> |
  |  | 1224 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Enter the description to be displayed above the Social Login buttons (leave empty for none):', 'oa-social-login'); ?></strong> |
  |  | 1225 | </td> |
  |  | 1226 | </tr> |
  |  | 1227 | <tr class="row\_even"> |
  |  | 1228 | <td> |
  |  | 1229 | <?php |
  |  | 1230 | $plugin\_caption = (isset ($settings ['plugin\_caption']) ? $settings ['plugin\_caption'] : \_\_('Connect with:', 'oa-social-login')); |
  |  | 1231 | ?> |
  |  | 1232 | <input type="text" name="oa\_social\_login\_settings[plugin\_caption]" size="90" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo htmlspecialchars($plugin\_caption); ?>"/> |
  |  | 1233 | </td> |
  |  | 1234 | </tr> |
  |  | 1235 | <tr class="row\_odd"> |
  |  | 1236 | <td> |
  |  | 1237 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("Select the icon theme to use per default:", 'oa-social-login'); ?></strong> |
  |  | 1238 | </td> |
  |  | 1239 | </tr> |
  |  | 1240 | <tr class="row\_even"> |
  |  | 1241 | <td> |
  |  | 1242 | <?php |
  |  | 1243 | $plugin\_icon\_theme = ((isset ($settings ['plugin\_icon\_theme']) and in\_array($settings ['plugin\_icon\_theme'], array(0, 1, 2))) ? $settings ['plugin\_icon\_theme'] : OA\_SOCIAL\_LOGIN\_DEFAULT\_THEME); |
  |  | 1244 | ?> |
  |  | 1245 | <input type="radio" id="plugin\_icon\_theme\_0" name="oa\_social\_login\_settings[plugin\_icon\_theme]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1246 | echo($plugin\_icon\_theme == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_icon\_theme\_0"><img src="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1247 | echo plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/theme\_classic.png' ?>" alt="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Classic', 'oa-social-login'); ?>"/></label> |
  |  | 1248 | <input type="radio" id="plugin\_icon\_theme\_1" name="oa\_social\_login\_settings[plugin\_icon\_theme]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1249 | echo($plugin\_icon\_theme == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_icon\_theme\_1"><img src="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1250 | echo plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/theme\_modern.png' ?>" alt="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Modern', 'oa-social-login'); ?>"/></label> |
  |  | 1251 | <input type="radio" id="plugin\_icon\_theme\_2" name="oa\_social\_login\_settings[plugin\_icon\_theme]" value="2" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1252 | echo($plugin\_icon\_theme == 2 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_icon\_theme\_2"><img src="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1253 | echo plugin\_dir\_url(\_\_FILE\_\_) . '../assets/img/theme\_small.png' ?>" alt="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Small', 'oa-social-login'); ?>"/></label> |
  |  | 1254 | </td> |
  |  | 1255 | </tr> |
  |  | 1256 | <tr class="row\_odd"> |
  |  | 1257 | <td> |
  |  | 1258 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Do you want to display the social networks used to connect in the user list of the administration area ?', 'oa-social-login'); ?></strong> |
  |  | 1259 | </td> |
  |  | 1260 | </tr> |
  |  | 1261 | <tr class="row\_even"> |
  |  | 1262 | <td> |
  |  | 1263 | <?php |
  |  | 1264 | $plugin\_add\_column\_user\_list = ((isset ($settings ['plugin\_add\_column\_user\_list']) and in\_array($settings ['plugin\_add\_column\_user\_list'], array(0, 1))) ? $settings ['plugin\_add\_column\_user\_list'] : 1); |
  |  | 1265 | ?> |
  |  | 1266 | <input type="radio" id="plugin\_add\_column\_user\_list\_1" name="oa\_social\_login\_settings[plugin\_add\_column\_user\_list]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1267 | echo($plugin\_add\_column\_user\_list == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_add\_column\_user\_list\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, add a new column to the user list and display the social network that the user connected with', 'oa-social-login'); ?><strong> (<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label> <br/> |
  |  | 1268 | <input type="radio" id="plugin\_add\_column\_user\_list\_0" name="oa\_social\_login\_settings[plugin\_add\_column\_user\_list]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1269 | echo($plugin\_add\_column\_user\_list == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_add\_column\_user\_list\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, do not display the social networks in the user list', 'oa-social-login'); ?></label> |
  |  | 1270 | </td> |
  |  | 1271 | </tr> |
  |  | 1272 | <tr class="row\_odd"> |
  |  | 1273 | <td> |
  |  | 1274 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Do you want to receive an email whenever a new user registers with Social Login ?', 'oa-social-login'); ?></strong> |
  |  | 1275 | </td> |
  |  | 1276 | </tr> |
  |  | 1277 | <tr class="row\_even"> |
  |  | 1278 | <td> |
  |  | 1279 | <?php |
  |  | 1280 | $plugin\_notify\_admin = ((isset ($settings ['plugin\_notify\_admin']) and in\_array($settings ['plugin\_notify\_admin'], array(0, 1))) ? $settings ['plugin\_notify\_admin'] : 1); |
  |  | 1281 | ?> |
  |  | 1282 | <input type="radio" id="plugin\_notify\_admin\_1" name="oa\_social\_login\_settings[plugin\_notify\_admin]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1283 | echo($plugin\_notify\_admin == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_notify\_admin\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, send me an email whenever a new user registers with Social Login', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1284 | <input type="radio" id="plugin\_notify\_admin\_0" name="oa\_social\_login\_settings[plugin\_notify\_admin]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1285 | echo($plugin\_notify\_admin == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_notify\_admin\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, do not send me any emails', 'oa-social-login'); ?></label> |
  |  | 1286 | </td> |
  |  | 1287 | </tr> |
  |  | 1288 | </table> |
  |  | 1289 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1290 | <tr class="row\_head"> |
  |  | 1291 | <th> |
  |  | 1292 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('User Settings', 'oa-social-login'); ?> |
  |  | 1293 | </th> |
  |  | 1294 | </tr> |
  |  | 1295 | <tr class="row\_odd"> |
  |  | 1296 | <td> |
  |  | 1297 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("If the user's social network profile has no email address, should we ask the user to enter it manually?", 'oa-social-login'); ?></strong> |
  |  | 1298 | </td> |
  |  | 1299 | </tr> |
  |  | 1300 | <tr class="row\_even"> |
  |  | 1301 | <td> |
  |  | 1302 | <?php |
  |  | 1303 | $plugin\_require\_email = ((isset ($settings ['plugin\_require\_email']) and in\_array($settings ['plugin\_require\_email'], array(0, 1))) ? $settings ['plugin\_require\_email'] : 0); |
  |  | 1304 | ?> |
  |  | 1305 | <input type="radio" id="plugin\_require\_email\_0" name="oa\_social\_login\_settings[plugin\_require\_email]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_require\_email == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_require\_email\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, simplify the registration by automatically creating a placeholder email', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1306 | <input type="radio" id="plugin\_require\_email\_1" name="oa\_social\_login\_settings[plugin\_require\_email]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_require\_email == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_require\_email\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, require the user to enter his email address manually and display this message:', 'oa-social-login'); ?></label> <br/> |
  |  | 1307 |  |
  |  | 1308 | <?php |
  |  | 1309 | /\* translators: %s: email address \*/ |
  |  | 1310 | if (isset($settings['plugin\_require\_email\_text'])) { |
  |  | 1311 | $message = htmlspecialchars($settings['plugin\_require\_email\_text']); |
  |  | 1312 | } else { |
  |  | 1313 | /\* translators: %s: email address \*/ |
  |  | 1314 | $message = esc\_html\_\_('<strong>We unfortunately could not retrieve your email address from %s.</strong> Please enter your email address in the form below in order to continue.', 'oa-social-login'); |
  |  | 1315 | } |
  |  | 1316 | ?> |
  |  | 1317 | <textarea name="oa\_social\_login\_settings[plugin\_require\_email\_text]" cols="100" rows="3"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo$message; ?></textarea> |
  |  | 1318 | <span class="description"><?php /\* translators: %s: text \*/ esc\_html\_e('HTML is allowed, the placeholder %s is replaced by the name of the social network used to connect.', 'oa-social-login'); ?></span> |
  |  | 1319 | </td> |
  |  | 1320 | </tr> |
  |  | 1321 | <tr class="row\_odd"> |
  |  | 1322 | <td> |
  |  | 1323 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("If the user's social network profile has a verified email, should we try to link it to an existing account?", 'oa-social-login'); ?></strong> |
  |  | 1324 | </td> |
  |  | 1325 | </tr> |
  |  | 1326 | <tr class="row\_even"> |
  |  | 1327 | <td> |
  |  | 1328 | <?php |
  |  | 1329 | $plugin\_link\_verified\_accounts = ((isset ($settings ['plugin\_link\_verified\_accounts']) and in\_array($settings ['plugin\_link\_verified\_accounts'], array(0, 1))) ? $settings ['plugin\_link\_verified\_accounts'] : 1); |
  |  | 1330 | ?> |
  |  | 1331 | <input type="radio" id="plugin\_link\_verified\_accounts\_1" name="oa\_social\_login\_settings[plugin\_link\_verified\_accounts]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_link\_verified\_accounts == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_link\_verified\_accounts\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, try to link verified social network profiles to existing blog accounts', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1332 | <input type="radio" id="plugin\_link\_verified\_accounts\_0" name="oa\_social\_login\_settings[plugin\_link\_verified\_accounts]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_link\_verified\_accounts == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_link\_verified\_accounts\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, disable account linking', 'oa-social-login'); ?></label> |
  |  | 1333 | </td> |
  |  | 1334 | </tr> |
  |  | 1335 | <tr class="row\_odd"> |
  |  | 1336 | <td> |
  |  | 1337 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("If the user's social network profile has an avatar, should this avatar be used as default avatar for the user?", 'oa-social-login'); ?></strong> |
  |  | 1338 | </td> |
  |  | 1339 | </tr> |
  |  | 1340 | <tr class="row\_even"> |
  |  | 1341 | <td> |
  |  | 1342 | <?php |
  |  | 1343 | $plugin\_show\_avatars\_in\_comments = ((isset ($settings ['plugin\_show\_avatars\_in\_comments']) and in\_array($settings ['plugin\_show\_avatars\_in\_comments'], array(0, 1, 2))) ? $settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  |  | 1344 | ?> |
  |  | 1345 | <input type="radio" id="plugin\_show\_avatars\_in\_comments\_0" name="oa\_social\_login\_settings[plugin\_show\_avatars\_in\_comments]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1346 | echo($plugin\_show\_avatars\_in\_comments == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_show\_avatars\_in\_comments\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, do not use avatars from social networks', 'oa-social-login'); ?></label><br/> |
  |  | 1347 | <input type="radio" id="plugin\_show\_avatars\_in\_comments\_1" name="oa\_social\_login\_settings[plugin\_show\_avatars\_in\_comments]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1348 | echo($plugin\_show\_avatars\_in\_comments == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_show\_avatars\_in\_comments\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, use small avatars from social networks if available', 'oa-social-login'); ?></label><br/> |
  |  | 1349 | <input type="radio" id="plugin\_show\_avatars\_in\_comments\_2" name="oa\_social\_login\_settings[plugin\_show\_avatars\_in\_comments]" value="2" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1350 | echo($plugin\_show\_avatars\_in\_comments == 2 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_show\_avatars\_in\_comments\_2"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, use large avatars from social networks if available', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label> |
  |  | 1351 | </td> |
  |  | 1352 | </tr> |
  |  | 1353 | </table> |
  |  | 1354 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1355 | <tr class="row\_head"> |
  |  | 1356 | <th> |
  |  | 1357 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Comment Settings', 'oa-social-login'); ?> |
  |  | 1358 | </th> |
  |  | 1359 | </tr> |
  |  | 1360 | <tr class="row\_odd"> |
  |  | 1361 | <td> |
  |  | 1362 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("Show the Social Login buttons in the comment area?", 'oa-social-login'); ?></strong> |
  |  | 1363 | </td> |
  |  | 1364 | </tr> |
  |  | 1365 | <tr class="row\_even"> |
  |  | 1366 | <td> |
  |  | 1367 | <?php |
  |  | 1368 | $plugin\_comment\_show = ((isset ($settings ['plugin\_comment\_show']) and in\_array($settings ['plugin\_comment\_show'], array(0, 1))) ? $settings ['plugin\_comment\_show'] : 1); |
  |  | 1369 | ?> |
  |  | 1370 | <input type="radio" id="plugin\_comment\_show\_1" name="oa\_social\_login\_settings[plugin\_comment\_show]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1371 | echo($plugin\_comment\_show == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, show the Social Login buttons', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1372 | <input type="radio" id="plugin\_comment\_show\_0" name="oa\_social\_login\_settings[plugin\_comment\_show]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1373 | echo($plugin\_comment\_show == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, do not show the Social Login buttons', 'oa-social-login'); ?></label><br/> |
  |  | 1374 | </td> |
  |  | 1375 | </tr> |
  |  | 1376 | <tr class="row\_odd"> |
  |  | 1377 | <td> |
  |  | 1378 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("Show the Social Login buttons in the comment area if comments are disabled for guests?", 'oa-social-login'); ?></strong> |
  |  | 1379 | </td> |
  |  | 1380 | </tr> |
  |  | 1381 | <tr class="row\_even"> |
  |  | 1382 | <td> |
  |  | 1383 | <?php |
  |  | 1384 | $plugin\_comment\_show\_if\_members\_only = ((isset ($settings ['plugin\_comment\_show\_if\_members\_only']) and in\_array($settings ['plugin\_comment\_show\_if\_members\_only'], array(0, 1))) ? $settings ['plugin\_comment\_show\_if\_members\_only'] : 1); |
  |  | 1385 | ?> |
  |  | 1386 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('The buttons will be displayed below the "You must be logged in to leave a comment" notice.', 'oa-social-login'); ?> </span><br/> |
  |  | 1387 | <input type="radio" id="plugin\_comment\_show\_if\_members\_only\_1" name="oa\_social\_login\_settings[plugin\_comment\_show\_if\_members\_only]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1388 | echo($plugin\_comment\_show\_if\_members\_only == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_if\_members\_only\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, show the Social Login buttons', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1389 | <input type="radio" id="plugin\_comment\_show\_if\_members\_only\_0" name="oa\_social\_login\_settings[plugin\_comment\_show\_if\_members\_only]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1390 | echo($plugin\_comment\_show\_if\_members\_only == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_show\_if\_members\_only\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, do not show the Social Login buttons', 'oa-social-login'); ?></label> |
  |  | 1391 | </td> |
  |  | 1392 | </tr> |
  |  | 1393 | <tr class="row\_odd"> |
  |  | 1394 | <td> |
  |  | 1395 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("Automatically approve comments left by users that connected by using Social Login?", 'oa-social-login'); ?></strong> |
  |  | 1396 | </td> |
  |  | 1397 | </tr> |
  |  | 1398 | <tr class="row\_even"> |
  |  | 1399 | <td> |
  |  | 1400 | <?php |
  |  | 1401 | $plugin\_comment\_auto\_approve = ((isset ($settings ['plugin\_comment\_auto\_approve']) and in\_array($settings ['plugin\_comment\_auto\_approve'], array(0, 1))) ? $settings ['plugin\_comment\_auto\_approve'] : 0); |
  |  | 1402 | ?> |
  |  | 1403 | <input type="radio" id="plugin\_comment\_auto\_approve\_1" name="oa\_social\_login\_settings[plugin\_comment\_auto\_approve]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1404 | echo($plugin\_comment\_auto\_approve == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_auto\_approve\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, automatically approve comments made by users that connected with Social Login', 'oa-social-login'); ?></label><br/> |
  |  | 1405 | <input type="radio" id="plugin\_comment\_auto\_approve\_0" name="oa\_social\_login\_settings[plugin\_comment\_auto\_approve]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1406 | echo($plugin\_comment\_auto\_approve == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_comment\_auto\_approve\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, do not automatically approve', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</label> |
  |  | 1407 | </strong><br/> |
  |  | 1408 | </td> |
  |  | 1409 | </tr> |
  |  | 1410 | </table> |
  |  | 1411 |  |
  |  | 1412 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1413 | <tr class="row\_head"> |
  |  | 1414 | <th> |
  |  | 1415 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Profile Settings', 'oa-social-login'); ?> |
  |  | 1416 | </th> |
  |  | 1417 | </tr> |
  |  | 1418 | <tr class="row\_odd"> |
  |  | 1419 | <td> |
  |  | 1420 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e("Show the Social Link buttons in the user profile?", 'oa-social-login'); ?></strong> |
  |  | 1421 | </td> |
  |  | 1422 | </tr> |
  |  | 1423 | <tr class="row\_even"> |
  |  | 1424 | <td> |
  |  | 1425 | <span class="description"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Keep this option enabled to allow each user to connect multiple social networks to his own profile.', 'oa-social-login'); ?> </span><br/> |
  |  | 1426 | <?php |
  |  | 1427 | $plugin\_profile\_show = ((isset ($settings ['plugin\_profile\_show']) and in\_array($settings ['plugin\_profile\_show'], array(0, 1))) ? $settings ['plugin\_profile\_show'] : 1); |
  |  | 1428 | ?> |
  |  | 1429 | <input type="radio" id="plugin\_profile\_show\_1" name="oa\_social\_login\_settings[plugin\_profile\_show]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1430 | echo($plugin\_profile\_show == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_profile\_show\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, show the Social Link buttons', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1431 | <input type="radio" id="plugin\_profile\_show\_0" name="oa\_social\_login\_settings[plugin\_profile\_show]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1432 | echo($plugin\_profile\_show == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_profile\_show\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, do not show the Social Link buttons', 'oa-social-login'); ?></label><br/> |
  |  | 1433 | </td> |
  |  | 1434 | </tr> |
  |  | 1435 | </table> |
  |  | 1436 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1437 | <tr class="row\_head"> |
  |  | 1438 | <th> |
  |  | 1439 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Login Page Settings', 'oa-social-login'); ?> |
  |  | 1440 | </th> |
  |  | 1441 | </tr> |
  |  | 1442 | <tr class="row\_odd"> |
  |  | 1443 | <td> |
  |  | 1444 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Do you want to display Social Login on the login form of your blog?', 'oa-social-login'); ?></strong> |
  |  | 1445 | </td> |
  |  | 1446 | </tr> |
  |  | 1447 | <tr class="row\_even"> |
  |  | 1448 | <td> |
  |  | 1449 | <?php |
  |  | 1450 | $plugin\_display\_in\_login\_form = ((isset ($settings ['plugin\_display\_in\_login\_form']) and in\_array($settings ['plugin\_display\_in\_login\_form'], array(0, 1))) ? $settings ['plugin\_display\_in\_login\_form'] : 1); |
  |  | 1451 | ?> |
  |  | 1452 | <input type="radio" id="plugin\_display\_in\_login\_form\_1" name="oa\_social\_login\_settings[plugin\_display\_in\_login\_form]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1453 | echo($plugin\_display\_in\_login\_form == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_login\_form\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, display the social network buttons below the login form', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1454 | <input type="radio" id="plugin\_display\_in\_login\_form\_0" name="oa\_social\_login\_settings[plugin\_display\_in\_login\_form]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1455 | echo($plugin\_display\_in\_login\_form == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_login\_form\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, disable social network buttons in the login form', 'oa-social-login'); ?></label> |
  |  | 1456 | </td> |
  |  | 1457 | </tr> |
  |  | 1458 | <tr class="row\_odd"> |
  |  | 1459 | <td> |
  |  | 1460 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Where should users be redirected to after having logged in with Social Login on the login page?', 'oa-social-login'); ?></strong> |
  |  | 1461 | </td> |
  |  | 1462 | </tr> |
  |  | 1463 | <tr class="row\_even"> |
  |  | 1464 | <td> |
  |  | 1465 | <?php |
  |  | 1466 | $plugin\_login\_form\_redirect = ((isset ($settings ['plugin\_login\_form\_redirect']) and in\_array($settings ['plugin\_login\_form\_redirect'], array('current', 'homepage', 'dashboard', 'custom'))) ? $settings ['plugin\_login\_form\_redirect'] : 'homepage'); |
  |  | 1467 | $plugin\_login\_form\_redirect\_custom\_url = (isset ($settings ['plugin\_login\_form\_redirect\_custom\_url']) ? $settings ['plugin\_login\_form\_redirect\_custom\_url'] : ''); |
  |  | 1468 | ?> |
  |  | 1469 | <input type="radio" id="plugin\_login\_form\_redirect\_current" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="current" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_login\_form\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_current"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users back to the current page', 'oa-social-login'); ?></label><br/> |
  |  | 1470 | <input type="radio" id="plugin\_login\_form\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="homepage" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_login\_form\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_homepage"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the homepage of my blog', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1471 | <input type="radio" id="plugin\_login\_form\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="dashboard" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_login\_form\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_dashboard"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to their account dashboard', 'oa-social-login'); ?></label><br/> |
  |  | 1472 | <input type="radio" id="plugin\_login\_form\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect]" value="custom" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_login\_form\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_login\_form\_redirect\_custom"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the following url', 'oa-social-login'); ?>:</label><br/> |
  |  | 1473 | <input type="text" name="oa\_social\_login\_settings[plugin\_login\_form\_redirect\_custom\_url]" size="90" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo htmlspecialchars($plugin\_login\_form\_redirect\_custom\_url); ?>"/> |
  |  | 1474 | </td> |
  |  | 1475 | </tr> |
  |  | 1476 | <tr class="row\_odd"> |
  |  | 1477 | <td> |
  |  | 1478 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Allow other plugins to change the redirection url that you have chosen by using a hook/filter?', 'oa-social-login'); ?></strong> |
  |  | 1479 | </td> |
  |  | 1480 | </tr> |
  |  | 1481 | <tr class="row\_even"> |
  |  | 1482 | <td> |
  |  | 1483 | <?php |
  |  | 1484 | $plugin\_protect\_login\_redirect\_url = (empty ($settings ['plugin\_protect\_login\_redirect\_url']) ? 0 : 1); |
  |  | 1485 | ?> |
  |  | 1486 | <input type="radio" id="plugin\_protect\_login\_redirect\_url\_0" name="oa\_social\_login\_settings[plugin\_protect\_login\_redirect\_url]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1487 | echo($plugin\_protect\_login\_redirect\_url == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_login\_redirect\_url\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, allow plugins to change the redirection url', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1488 | <input type="radio" id="plugin\_protect\_login\_redirect\_url\_1" name="oa\_social\_login\_settings[plugin\_protect\_login\_redirect\_url]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1489 | echo($plugin\_protect\_login\_redirect\_url == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_login\_redirect\_url\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, protect the redirection url (Use this option if the redirection does not work correctly)', 'oa-social-login'); ?></label> |
  |  | 1490 | </td> |
  |  | 1491 | </tr> |
  |  | 1492 | </table> |
  |  | 1493 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1494 | <tr class="row\_head"> |
  |  | 1495 | <th> |
  |  | 1496 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Registration Page Settings', 'oa-social-login'); ?> |
  |  | 1497 | </th> |
  |  | 1498 | </tr> |
  |  | 1499 | <tr class="row\_odd"> |
  |  | 1500 | <td> |
  |  | 1501 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Do you want to display Social Login on the registration form of your blog?', 'oa-social-login'); ?></strong> |
  |  | 1502 | </td> |
  |  | 1503 | </tr> |
  |  | 1504 | <tr class="row\_even"> |
  |  | 1505 | <td> |
  |  | 1506 | <?php |
  |  | 1507 | $plugin\_display\_in\_registration\_form = ((isset ($settings ['plugin\_display\_in\_registration\_form']) and in\_array($settings ['plugin\_display\_in\_registration\_form'], array(0, 1))) ? $settings ['plugin\_display\_in\_registration\_form'] : 1); |
  |  | 1508 | ?> |
  |  | 1509 | <input type="radio" id="plugin\_display\_in\_registration\_form\_1" name="oa\_social\_login\_settings[plugin\_display\_in\_registration\_form]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1510 | echo($plugin\_display\_in\_registration\_form == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_registration\_form\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, display the social network buttons below the registration form', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1511 | <input type="radio" id="plugin\_display\_in\_registration\_form\_0" name="oa\_social\_login\_settings[plugin\_display\_in\_registration\_form]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1512 | echo($plugin\_display\_in\_registration\_form == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_display\_in\_registration\_form\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, disable social network buttons in the registration form', 'oa-social-login'); ?></label> |
  |  | 1513 | </td> |
  |  | 1514 | </tr> |
  |  | 1515 | <tr class="row\_odd"> |
  |  | 1516 | <td> |
  |  | 1517 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Where should users be redirected to after having registered with Social Login on the registration page?', 'oa-social-login'); ?></strong> |
  |  | 1518 | </td> |
  |  | 1519 | </tr> |
  |  | 1520 | <tr class="row\_even"> |
  |  | 1521 | <td> |
  |  | 1522 | <?php |
  |  | 1523 | $plugin\_registration\_form\_redirect = ((isset ($settings ['plugin\_registration\_form\_redirect']) and in\_array($settings ['plugin\_registration\_form\_redirect'], array('current', 'homepage', 'dashboard', 'custom'))) ? $settings ['plugin\_registration\_form\_redirect'] : 'dashboard'); |
  |  | 1524 | $plugin\_registration\_form\_redirect\_custom\_url = (isset ($settings ['plugin\_registration\_form\_redirect\_custom\_url']) ? $settings ['plugin\_registration\_form\_redirect\_custom\_url'] : ''); |
  |  | 1525 | ?> |
  |  | 1526 | <input type="radio" id="plugin\_registration\_form\_redirect\_current" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="current" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_registration\_form\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_current"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users back to the current page', 'oa-social-login'); ?></label><br/> |
  |  | 1527 | <input type="radio" id="plugin\_registration\_form\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="homepage" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_registration\_form\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_homepage"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the homepage of my blog', 'oa-social-login'); ?></label><br/> |
  |  | 1528 | <input type="radio" id="plugin\_registration\_form\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="dashboard" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_registration\_form\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_dashboard"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to their account dashboard', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1529 | <input type="radio" id="plugin\_registration\_form\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect]" value="custom" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_registration\_form\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_registration\_form\_redirect\_custom"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the following url', 'oa-social-login'); ?>:</label><br/> |
  |  | 1530 | <input type="text" name="oa\_social\_login\_settings[plugin\_registration\_form\_redirect\_custom\_url]" size="90" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo htmlspecialchars($plugin\_registration\_form\_redirect\_custom\_url); ?>"/> |
  |  | 1531 | </td> |
  |  | 1532 | </tr> |
  |  | 1533 | <tr class="row\_odd"> |
  |  | 1534 | <td> |
  |  | 1535 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Allow other plugins to change the redirection url that you have chosen by using a hook/filter?', 'oa-social-login'); ?></strong> |
  |  | 1536 | </td> |
  |  | 1537 | </tr> |
  |  | 1538 | <tr class="row\_even"> |
  |  | 1539 | <td> |
  |  | 1540 | <?php |
  |  | 1541 | $plugin\_protect\_registration\_redirect\_url = (empty ($settings ['plugin\_protect\_registration\_redirect\_url']) ? 0 : 1); |
  |  | 1542 | ?> |
  |  | 1543 | <input type="radio" id="plugin\_protect\_registration\_redirect\_url\_0" name="oa\_social\_login\_settings[plugin\_protect\_registration\_redirect\_url]" value="0" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1544 | echo($plugin\_protect\_registration\_redirect\_url == 0 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_registration\_redirect\_url\_0"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Yes, allow plugins to change the redirection url', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1545 | <input type="radio" id="plugin\_protect\_registration\_redirect\_url\_1" name="oa\_social\_login\_settings[plugin\_protect\_registration\_redirect\_url]" value="1" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1546 | echo($plugin\_protect\_registration\_redirect\_url == 1 ? 'checked="checked"' : ''); ?> /> <label for="plugin\_protect\_registration\_redirect\_url\_1"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('No, protect the redirection url (Use this option if the redirection does not work correctly)', 'oa-social-login'); ?></label> |
  |  | 1547 | </td> |
  |  | 1548 | </tr> |
  |  | 1549 | </table> |
  |  | 1550 | <table class="form-table oa\_social\_login\_table"> |
  |  | 1551 | <tr class="row\_head"> |
  |  | 1552 | <th> |
  |  | 1553 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Widget &amp; Shortcode Settings', 'oa-social-login'); ?> |
  |  | 1554 | </th> |
  |  | 1555 | </tr> |
  |  | 1556 | <tr class="row\_odd"> |
  |  | 1557 | <td> |
  |  | 1558 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to this page after they have logged in with Social Login embedded by Widget/Shortcode:', 'oa-social-login'); ?></strong> |
  |  | 1559 | </td> |
  |  | 1560 | </tr> |
  |  | 1561 | <tr class="row\_even"> |
  |  | 1562 | <td> |
  |  | 1563 | <?php |
  |  | 1564 | $plugin\_shortcode\_login\_redirect = ((isset ($settings ['plugin\_shortcode\_login\_redirect']) and in\_array($settings ['plugin\_shortcode\_login\_redirect'], array('current', 'dashboard', 'homepage', 'custom'))) ? $settings ['plugin\_shortcode\_login\_redirect'] : 'current'); |
  |  | 1565 | $plugin\_shortcode\_login\_redirect\_url = (isset ($settings ['plugin\_shortcode\_login\_redirect\_url']) ? $settings ['plugin\_shortcode\_login\_redirect\_url'] : ''); |
  |  | 1566 | ?> |
  |  | 1567 | <input type="radio" id="plugin\_shortcode\_login\_redirect\_current" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="current" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1568 | echo($plugin\_shortcode\_login\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_current"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users back to the current page', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1569 | <input type="radio" id="plugin\_shortcode\_login\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="homepage" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1570 | echo($plugin\_shortcode\_login\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_homepage"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the homepage of my blog', 'oa-social-login'); ?></label><br/> |
  |  | 1571 | <input type="radio" id="plugin\_shortcode\_login\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="dashboard" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1572 | echo($plugin\_shortcode\_login\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_dashboard"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to their account dashboard', 'oa-social-login'); ?></label><br/> |
  |  | 1573 | <input type="radio" id="plugin\_shortcode\_login\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect]" value="custom" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1574 | echo($plugin\_shortcode\_login\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_login\_redirect\_custom"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the following url', 'oa-social-login'); ?>:</label><br/> |
  |  | 1575 | <input type="text" name="oa\_social\_login\_settings[plugin\_shortcode\_login\_redirect\_url]" size="90" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo htmlspecialchars($plugin\_shortcode\_login\_redirect\_url); ?>"/> |
  |  | 1576 | </td> |
  |  | 1577 | </tr> |
  |  | 1578 | <tr class="row\_odd"> |
  |  | 1579 | <td> |
  |  | 1580 | <strong><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to this page after they have registered with Social Login embedded by Widget/Shortcode:', 'oa-social-login'); ?></strong> |
  |  | 1581 | </td> |
  |  | 1582 | </tr> |
  |  | 1583 | <tr class="row\_even"> |
  |  | 1584 | <td> |
  |  | 1585 | <?php |
  |  | 1586 | $plugin\_shortcode\_register\_redirect = ((isset ($settings ['plugin\_shortcode\_register\_redirect']) and in\_array($settings ['plugin\_shortcode\_register\_redirect'], array('current', 'dashboard', 'homepage', 'custom'))) ? $settings ['plugin\_shortcode\_register\_redirect'] : 'current'); |
  |  | 1587 | $plugin\_shortcode\_register\_redirect\_url = (isset ($settings ['plugin\_shortcode\_register\_redirect\_url']) ? $settings ['plugin\_shortcode\_register\_redirect\_url'] : ''); |
  |  | 1588 | ?> |
  |  | 1589 | <input type="radio" id="plugin\_shortcode\_register\_redirect\_current" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="current" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_shortcode\_register\_redirect == 'current' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_current"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users back to the current page', 'oa-social-login'); ?> <strong>(<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Default', 'oa-social-login') ?>)</strong></label><br/> |
  |  | 1590 | <input type="radio" id="plugin\_shortcode\_register\_redirect\_homepage" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="homepage" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_shortcode\_register\_redirect == 'homepage' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_homepage"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the homepage of my blog', 'oa-social-login'); ?></label><br/> |
  |  | 1591 | <input type="radio" id="plugin\_shortcode\_register\_redirect\_dashboard" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="dashboard" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_shortcode\_register\_redirect == 'dashboard' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_dashboard"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to their account dashboard', 'oa-social-login'); ?></label><br/> |
  |  | 1592 | <input type="radio" id="plugin\_shortcode\_register\_redirect\_custom" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect]" value="custom" <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo($plugin\_shortcode\_register\_redirect == 'custom' ? 'checked="checked"' : ''); ?> /> <label for="plugin\_shortcode\_register\_redirect\_custom"><?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Redirect users to the following url', 'oa-social-login'); ?>:</label><br/> |
  |  | 1593 | <input type="text" name="oa\_social\_login\_settings[plugin\_shortcode\_register\_redirect\_url]" size="90" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo htmlspecialchars($plugin\_shortcode\_register\_redirect\_url); ?>"/> |
  |  | 1594 | </td> |
  |  | 1595 | </tr> |
  |  | 1596 | </table> |
  |  | 1597 | <p class="oa\_social\_login\_buttons"> |
  |  | 1598 | <input type="hidden" name="page" value="settings"/> |
  |  | 1599 | <input type="submit" class="oa\_social\_login\_btn oa\_social\_login\_btn\_success oa\_social\_login\_btn\_large" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ esc\_html\_e('Save Changes', 'oa-social-login') ?>"/> |
  |  | 1600 | </p> |
  |  | 1601 | </form> |
  |  | 1602 | </div> |
  |  | 1603 | </div> |
  |  | 1604 | <?php |
  | 1521 | 1605 | } |
* ## [oa-social-login/trunk/includes/communication.php](/changeset/3201046/oa-social-login/trunk/includes/communication.php "Show the changeset 3201046 restricted to oa-social-login/trunk/includes/communication.php")

  | [r3153096](/browser/oa-social-login/trunk/includes/communication.php?rev=3153096#L680 "Show revision 3153096 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/includes/communication.php?rev=3201046#L680 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 680 | 680 | //HTTP Headers |
  | 681 | 681 | $headers = array(); |
  | 682 |  |  |
  | 683 |  | // We are using a proxy |
  | 684 |  | if (!empty($options['proxy\_url']) && !empty($options['proxy\_port'])) |
  | 685 |  | { |
  | 686 |  | // Open Socket |
  | 687 |  | $fp = @fsockopen($options['proxy\_url'], $options['proxy\_port'], $errno, $errstr, $timeout); |
  | 688 |  |  |
  | 689 |  | //Make sure that the socket has been opened properly |
  | 690 |  | if (!$fp) |
  | 691 |  | { |
  | 692 |  | $result->http\_error = trim($errstr); |
  | 693 |  |  |
  | 694 |  | return $result; |
  |  | 682 |  |
  |  | 683 | // Build the arguments for the request |
  |  | 684 | $args = [ |
  |  | 685 | 'timeout' => $timeout, |
  |  | 686 | 'headers' => [], |
  |  | 687 | 'sslverify' => false, // Disable SSL verification if needed |
  |  | 688 | ]; |
  |  | 689 |  |
  |  | 690 | // Proxy settings |
  |  | 691 | if (!empty($options['proxy\_url']) && !empty($options['proxy\_port'])) { |
  |  | 692 | // Set proxy location |
  |  | 693 | $args['proxy'] = $options['proxy\_url'] . ':' . $options['proxy\_port']; |
  |  | 694 |  |
  |  | 695 | // Proxy authentication |
  |  | 696 | if (!empty($options['proxy\_username']) && !empty($options['proxy\_password'])) { |
  |  | 697 | $args['headers']['Proxy-Authorization'] = 'Basic ' . base64\_encode($options['proxy\_username'] . ':' . $options['proxy\_password']); |
  | 695 | 698 | } |
  | 696 |  |  |
  | 697 |  | // HTTP Headers |
  | 698 |  | $headers[] = "GET " . $url\_protocol . $url . $path . " HTTP/1.0"; |
  | 699 |  | $headers[] = "Host: " . $url . ":" . $port; |
  | 700 |  |  |
  | 701 |  | // Proxy Authentication |
  | 702 |  | if (!empty($options['proxy\_username']) && !empty($options['proxy\_password'])) |
  | 703 |  | { |
  | 704 |  | $headers[] = 'Proxy-Authorization: Basic ' . base64\_encode($options['proxy\_username'] . ":" . $options['proxy\_password']); |
  | 705 |  | } |
  | 706 |  | } |
  | 707 |  | // We are not using a proxy |
  | 708 |  | else |
  | 709 |  | { |
  | 710 |  | // Open Socket |
  | 711 |  | $fp = @fsockopen($url\_prefix . $url, $port, $errno, $errstr, $timeout); |
  | 712 |  |  |
  | 713 |  | //Make sure that the socket has been opened properly |
  | 714 |  | if (!$fp) |
  | 715 |  | { |
  | 716 |  | $result->http\_error = trim($errstr); |
  | 717 |  |  |
  | 718 |  | return $result; |
  | 719 |  | } |
  | 720 |  |  |
  | 721 |  | // HTTP Headers |
  | 722 |  | $headers[] = "GET " . $path . " HTTP/1.0"; |
  | 723 |  | $headers[] = "Host: " . $url; |
  | 724 |  | } |
  | 725 |  |  |
  | 726 |  | //Enable basic authentication |
  | 727 |  | if (isset($options['api\_key']) and isset($options['api\_secret'])) |
  | 728 |  | { |
  | 729 |  | $headers[] = 'Authorization: Basic ' . base64\_encode($options['api\_key'] . ":" . $options['api\_secret']); |
  | 730 |  | } |
  | 731 |  |  |
  | 732 |  | //Build and send request |
  | 733 |  | fwrite($fp, (implode("\r\n", $headers) . "\r\n\r\n")); |
  | 734 |  |  |
  | 735 |  | //Fetch response |
  | 736 |  | $response = ''; |
  | 737 |  | while (!feof($fp)) |
  | 738 |  | { |
  | 739 |  | $response .= fread($fp, 1024); |
  | 740 |  | } |
  | 741 |  |  |
  | 742 |  | //Close connection |
  | 743 |  | fclose($fp); |
  | 744 |  |  |
  | 745 |  | //Parse response |
  | 746 |  | list($response\_header, $response\_body) = explode("\r\n\r\n", $response, 2); |
  | 747 |  |  |
  | 748 |  | //Parse header |
  | 749 |  | $response\_header = preg\_split("/\r\n|\n|\r/", $response\_header); |
  | 750 |  | list($header\_protocol, $header\_code, $header\_status\_message) = explode(' ', trim(array\_shift($response\_header)), 3); |
  | 751 |  |  |
  | 752 |  | //Build result |
  | 753 |  | $result->http\_code = $header\_code; |
  | 754 |  | $result->http\_data = $response\_body; |
  | 755 |  |  |
  | 756 |  | //Done |
  |  | 699 | } |
  |  | 700 |  |
  |  | 701 | // Enable basic authentication |
  |  | 702 | if (!empty($options['api\_key']) && !empty($options['api\_secret'])) { |
  |  | 703 | $args['headers']['Authorization'] = 'Basic ' . base64\_encode($options['api\_key'] . ':' . $options['api\_secret']); |
  |  | 704 | } |
  |  | 705 |  |
  |  | 706 | // Build the full URL |
  |  | 707 | $full\_url = $url\_protocol . $url . $path; |
  |  | 708 |  |
  |  | 709 | // Make the GET request |
  |  | 710 | $response = wp\_remote\_get($full\_url, $args); |
  |  | 711 |  |
  |  | 712 | // Ensure the request was successful |
  |  | 713 | if (is\_wp\_error($response)) { |
  |  | 714 | // Capture the error message |
  |  | 715 | $result->http\_error = $response->get\_error\_message(); |
  |  | 716 | return $result; |
  |  | 717 | } |
  |  | 718 |  |
  |  | 719 | // Retrieve the response data |
  |  | 720 | $result->http\_code = wp\_remote\_retrieve\_response\_code($response); // HTTP status code |
  |  | 721 | $result->http\_data = wp\_remote\_retrieve\_body($response); // Response body content |
  |  | 722 | $result->http\_error = null; // No error |
  | 757 | 723 |  |
  | 758 | 724 | return $result; |
  | […](/browser/oa-social-login/trunk/includes/communication.php?rev=3153096#L818) | […](/browser/oa-social-login/trunk/includes/communication.php?rev=3201046#L784) |  |
  | 818 | 784 | //Store the result |
  | 819 | 785 | $result = new stdClass(); |
  | 820 |  |  |
  | 821 |  | //Send request |
  | 822 |  | $curl = curl\_init(); |
  | 823 |  | curl\_setopt($curl, CURLOPT\_URL, $url); |
  | 824 |  | curl\_setopt($curl, CURLOPT\_HEADER, 0); |
  | 825 |  | curl\_setopt($curl, CURLOPT\_TIMEOUT, $timeout); |
  | 826 |  | curl\_setopt($curl, CURLOPT\_VERBOSE, 0); |
  | 827 |  | curl\_setopt($curl, CURLOPT\_RETURNTRANSFER, 1); |
  | 828 |  | curl\_setopt($curl, CURLOPT\_SSL\_VERIFYPEER, 0); |
  | 829 |  | curl\_setopt($curl, CURLOPT\_SSL\_VERIFYHOST, 0); |
  | 830 |  | curl\_setopt($curl, CURLOPT\_USERAGENT, 'SocialLogin/' . OA\_SOCIAL\_LOGIN\_VERSION . ' WordPress/' . oa\_social\_login\_get\_wp\_version() . ' (+http://www.oneall.com/)'); |
  | 831 |  |  |
  |  | 786 |  |
  |  | 787 | $args = [ |
  |  | 788 | 'timeout' => $timeout, |
  |  | 789 | 'sslverify' => false, |
  |  | 790 | 'user-agent' => 'SocialLogin/' . OA\_SOCIAL\_LOGIN\_VERSION . ' WordPress/' . oa\_social\_login\_get\_wp\_version() . ' (+http://www.oneall.com/)' |
  |  | 791 | ]; |
  |  | 792 |  |
  | 832 | 793 | // BASIC AUTH? |
  | 833 |  | if (isset($options['api\_key']) and isset($options['api\_secret'])) |
  | 834 |  | { |
  | 835 |  | curl\_setopt($curl, CURLOPT\_USERPWD, $options['api\_key'] . ":" . $options['api\_secret']); |
  | 836 |  | } |
  | 837 |  |  |
  |  | 794 | if (isset($options['api\_key']) && isset($options['api\_secret'])) { |
  |  | 795 | $args['headers'] = [ |
  |  | 796 | 'Authorization' => 'Basic ' . base64\_encode($options['api\_key'] . ':' . $options['api\_secret']), |
  |  | 797 | ]; |
  |  | 798 | } |
  |  | 799 |  |
  | 838 | 800 | // Proxy Settings |
  | 839 |  | if (!empty($options['proxy\_url']) && !empty($options['proxy\_port'])) |
  | 840 |  | { |
  | 841 |  | // Proxy Location |
  | 842 |  | curl\_setopt($curl, CURLOPT\_PROXYTYPE, CURLPROXY\_HTTP); |
  | 843 |  | curl\_setopt($curl, CURLOPT\_PROXY, $options['proxy\_url']); |
  | 844 |  |  |
  | 845 |  | // Proxy Port |
  | 846 |  | curl\_setopt($curl, CURLOPT\_PROXYPORT, $options['proxy\_port']); |
  | 847 |  |  |
  |  | 801 | if (!empty($options['proxy\_url']) && !empty($options['proxy\_port'])) { |
  |  | 802 | $args['proxy'] = $options['proxy\_url'] . ':' . $options['proxy\_port']; |
  |  | 803 |  |
  | 848 | 804 | // Proxy Authentication |
  | 849 |  | if (!empty($options['proxy\_username']) && !empty($options['proxy\_password'])) |
  | 850 |  | { |
  | 851 |  | curl\_setopt($curl, CURLOPT\_PROXYAUTH, CURLAUTH\_ANY); |
  | 852 |  | curl\_setopt($curl, CURLOPT\_PROXYUSERPWD, $options['proxy\_username'] . ':' . $options['proxy\_password']); |
  |  | 805 | if (!empty($options['proxy\_username']) && !empty($options['proxy\_password'])) { |
  |  | 806 | $args['headers']['Proxy-Authorization'] = 'Basic ' . base64\_encode($options['proxy\_username'] . ':' . $options['proxy\_password']); |
  | 853 | 807 | } |
  | 854 | 808 | } |
  | 855 |  |  |
  | 856 |  | //Make request |
  | 857 |  | if (($http\_data = curl\_exec($curl)) !== false) |
  | 858 |  | { |
  | 859 |  | $result->http\_code = curl\_getinfo($curl, CURLINFO\_HTTP\_CODE); |
  | 860 |  | $result->http\_data = $http\_data; |
  | 861 |  | $result->http\_error = null; |
  | 862 |  | } |
  | 863 |  | else |
  | 864 |  | { |
  |  | 809 |  |
  |  | 810 | // Make the request |
  |  | 811 | $response =  wp\_remote\_get($url, $args); |
  |  | 812 |  |
  |  | 813 | // Process the response |
  |  | 814 | if (is\_wp\_error($response)) { |
  | 865 | 815 | $result->http\_code = -1; |
  | 866 | 816 | $result->http\_data = null; |
  | 867 |  | $result->http\_error = curl\_error($curl); |
  | 868 |  | } |
  | 869 |  |  |
  | 870 |  | //Done |
  |  | 817 | $result->http\_error = $response->get\_error\_message(); |
  |  | 818 | } else { |
  |  | 819 | $result->http\_code = wp\_remote\_retrieve\_response\_code($response); |
  |  | 820 | $result->http\_data = wp\_remote\_retrieve\_body($response); |
  |  | 821 | $result->http\_error = null; |
  |  | 822 | } |
  | 871 | 823 |  |
  | 872 | 824 | return $result; |
* ## [oa-social-login/trunk/includes/settings.php](/changeset/3201046/oa-social-login/trunk/includes/settings.php "Show the changeset 3201046 restricted to oa-social-login/trunk/includes/settings.php")

  | [r3153096](/browser/oa-social-login/trunk/includes/settings.php?rev=3153096#L19 "Show revision 3153096 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/includes/settings.php?rev=3201046#L19 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 19 | 19 | 'discord' => array( |
  | 20 | 20 | 'name' => 'Discord' |
  | 21 |  | ~~),~~ |
  | 22 |  | ~~'disqus' => array(~~ |
  | 23 |  | ~~'name' => 'Disqus'~~ |
  | 24 | 21 | ), |
  | 25 | 22 | 'dribbble' => array( |
* ## [oa-social-login/trunk/includes/toolbox.php](/changeset/3201046/oa-social-login/trunk/includes/toolbox.php "Show the changeset 3201046 restricted to oa-social-login/trunk/includes/toolbox.php")

  | [r2223378](/browser/oa-social-login/trunk/includes/toolbox.php?rev=2223378#L85 "Show revision 2223378 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/includes/toolbox.php?rev=3201046#L85 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 85 | 85 | // Setup Mail Header. |
  | 86 | 86 | $recipient = get\_bloginfo ('admin\_email'); |
  |  | 87 |  |
  |  | 88 | /\* translators: %s: blog name \*/ |
  | 87 | 89 | $subject = '[Social Login] ' . sprintf (\_\_ ('[%s] New User Registration', 'oa-social-login'), $blogname); |
  | 88 |  |  |
  | 89 |  | //Setup Mail Body |
  |  | 90 |  |
  |  | 91 | /\* translators: %s: blog name \*/ |
  | 90 | 92 | $body = sprintf (\_\_ ('New user registration on your site %s:', 'oa-social-login'), $blogname) . "\r\n\r\n"; |
  |  | 93 |  |
  |  | 94 | /\* translators: %s: username \*/ |
  | 91 | 95 | $body .= sprintf (\_\_ ('Username: %s', 'oa-social-login'), $user\_login) . "\r\n\r\n"; |
  |  | 96 |  |
  |  | 97 | /\* translators: %s: provider name \*/ |
  | 92 | 98 | $body .= sprintf (\_\_ ('Social Network: %s', 'oa-social-login'), $user\_identity\_provider) . "\r\n"; |
  | 93 | 99 |  |
  | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=2223378#L236) | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=3201046#L242) |  |
  | 236 | 242 | elseif (function\_exists ('attribute\_escape')) |
  | 237 | 243 | { |
  | 238 |  | return ~~attribute\_escape~~ ($string); |
  |  | 244 | return esc\_attr ($string); |
  | 239 | 245 | } |
  | 240 | 246 | return htmlspecialchars ($string); |
  | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=2223378#L259) | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=3201046#L265) |  |
  | 259 | 265 |  |
  | 260 | 266 | // Read user for this token. |
  | 261 |  | $sql = "SELECT u.ID FROM " . $wpdb->usermeta . " AS um  INNER JOIN " . $wpdb->users . " AS u ON (um.user\_id=u.ID) WHERE um.meta\_key = 'oa\_social\_login\_user\_token' AND um.meta\_value=%s"; |
  | 262 |  | return $wpdb->get\_var ($wpdb->prepare ($sql, $token)); |
  |  | 267 | return $wpdb->get\_var ($wpdb->prepare ("SELECT u.ID FROM " . $wpdb->usermeta . " AS um  INNER JOIN " . $wpdb->users . " AS u ON (um.user\_id=u.ID) WHERE um.meta\_key = 'oa\_social\_login\_user\_token' AND um.meta\_value=%s", $token)); |
  | 263 | 268 | } |
  | 264 | 269 |  |
  | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=2223378#L270) | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=3201046#L275) |  |
  | 270 | 275 | { |
  | 271 | 276 | GLOBAL $wpdb; |
  | 272 |  | $sql = "SELECT um.meta\_value FROM " . $wpdb->usermeta . " AS um INNER JOIN " . $wpdb->users . " AS u ON (um.user\_id=u.ID) WHERE um.meta\_key = 'oa\_social\_login\_user\_token' AND u.ID=%d"; |
  | 273 |  | return $wpdb->get\_var ($wpdb->prepare ($sql, $userid)); |
  |  | 277 | return $wpdb->get\_var ($wpdb->prepare ("SELECT um.meta\_value FROM " . $wpdb->usermeta . " AS um INNER JOIN " . $wpdb->users . " AS u ON (um.user\_id=u.ID) WHERE um.meta\_key = 'oa\_social\_login\_user\_token' AND u.ID=%d", $userid)); |
  | 274 | 278 | } |
  | 275 | 279 |  |
  | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=2223378#L280) | […](/browser/oa-social-login/trunk/includes/toolbox.php?rev=3201046#L284) |  |
  | 280 | 284 | { |
  | 281 | 285 | GLOBAL $wpdb; |
  | 282 |  | $sql = "SELECT COUNT(user\_id) AS tot FROM " . $wpdb->usermeta . " AS um WHERE um.meta\_key = 'oa\_social\_login\_user\_token'"; |
  | 283 |  | return $wpdb->get\_var ($sql); |
  |  | 286 | return $wpdb->get\_var ($wpdb->prepare ("SELECT COUNT(user\_id) AS tot FROM " . $wpdb->usermeta . " AS um WHERE um.meta\_key = 'oa\_social\_login\_user\_token'")); |
  | 284 | 287 | } |
  | 285 | 288 |  |
* ## [oa-social-login/trunk/includes/user\_interface.php](/changeset/3201046/oa-social-login/trunk/includes/user_interface.php "Show the changeset 3201046 restricted to oa-social-login/trunk/includes/user_interface.php")

  | [r2223378](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L8 "Show revision 2223378 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L8 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 8 | 8 | // Read the plugin settings. |
  | 9 | 9 | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 10 |  |  |
  |  | 10 |  |
  | 11 | 11 | // Without the subdomain the plugin won't work. |
  | 12 | 12 | if (!empty ($settings ['api\_subdomain'])) |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L24) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L24) |  |
  | 24 | 24 | function oa\_social\_login\_add\_javascripts () |
  | 25 | 25 | { |
  | 26 |  | // Read the plugin settings. |
  | 27 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 28 |  |  |
  | 29 |  | // Without the subdomain we can't include the libary. |
  | 30 |  | if (!empty ($settings ['api\_subdomain'])) |
  | 31 |  | { |
  | 32 |  | // Forge library path. |
  | 33 |  | $oneall\_js\_library = ((oa\_social\_login\_https\_on () ? 'https' : 'http') . '://' . $settings ['api\_subdomain'] . '.api.oneall.com/socialize/library.js'); |
  | 34 |  |  |
  | 35 |  | // Synchronous JavaScript: This is the default to stay compatible with existing installations. |
  | 36 |  | if (empty ($settings ['asynchronous\_javascript'])) |
  | 37 |  | { |
  | 38 |  | //Make sure the library has not yet been included. |
  | 39 |  | if (!wp\_script\_is ('oa\_social\_library', 'registered')) |
  | 40 |  | { |
  | 41 |  | //Include in header, without having the version appended |
  | 42 |  | wp\_register\_script ('oa\_social\_library', $oneall\_js\_library, array (), null, false); |
  | 43 |  | } |
  | 44 |  | wp\_print\_scripts ('oa\_social\_library'); |
  | 45 |  | } |
  | 46 |  | // Asynchronous JavaScript. |
  | 47 |  | else |
  | 48 |  | { |
  | 49 |  | //JavaScript Method Reference: http://docs.oneall.com/api/javascript/library/methods/ |
  | 50 |  | $output = array (); |
  | 51 |  | $output [] = ''; |
  | 52 |  | $output [] = " <!-- OneAll.com / Social Login for WordPress / v" . constant ('OA\_SOCIAL\_LOGIN\_VERSION') . " -->"; |
  | 53 |  | $output [] = '<script data-cfasync="false" type="text/javascript">'; |
  | 54 |  | $output [] = " (function() {"; |
  | 55 |  | $output [] = "  var oa = document.createElement('script'); oa.type = 'text/javascript';"; |
  | 56 |  | $output [] = "  oa.async = true; oa.src = '" . $oneall\_js\_library . "';"; |
  | 57 |  | $output [] = "  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(oa, s);"; |
  | 58 |  | $output [] = " })();"; |
  | 59 |  | $output [] = "</script>"; |
  | 60 |  | $output [] = ''; |
  | 61 |  |  |
  | 62 |  | // Display |
  | 63 |  | echo implode ("\n", $output); |
  | 64 |  | } |
  | 65 |  | } |
  |  | 26 | // Read the plugin settings. |
  |  | 27 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 28 |  |
  |  | 29 | // Without the subdomain we can't include the libary. |
  |  | 30 | if (!empty ($settings ['api\_subdomain'])) |
  |  | 31 | { |
  |  | 32 | // Forge library path. |
  |  | 33 | $oneall\_js\_library = ((oa\_social\_login\_https\_on () ? 'https' : 'http') . '://' . $settings ['api\_subdomain'] . '.api.oneall.com/socialize/library.js'); |
  |  | 34 |  |
  |  | 35 | // Synchronous JavaScript: This is the default to stay compatible with existing installations. |
  |  | 36 | if (empty ($settings ['asynchronous\_javascript'])) |
  |  | 37 | { |
  |  | 38 | //Make sure the library has not yet been included. |
  |  | 39 | if (!wp\_script\_is ('oa\_social\_library', 'registered')) |
  |  | 40 | { |
  |  | 41 | //Include in header, without having the version appended |
  |  | 42 | wp\_register\_script ('oa\_social\_library', $oneall\_js\_library, array (), null, false); |
  |  | 43 | } |
  |  | 44 | wp\_print\_scripts ('oa\_social\_library'); |
  |  | 45 | } |
  |  | 46 | // Asynchronous JavaScript. |
  |  | 47 | else |
  |  | 48 | { |
  |  | 49 | //JavaScript Method Reference: http://docs.oneall.com/api/javascript/library/methods/ |
  |  | 50 | $output = array (); |
  |  | 51 | $output [] = ''; |
  |  | 52 | $output [] = " <!-- OneAll.com / Social Login for WordPress / v" . constant ('OA\_SOCIAL\_LOGIN\_VERSION') . " -->"; |
  |  | 53 | $output [] = '<script data-cfasync="false" type="text/javascript">'; |
  |  | 54 | $output [] = " (function() {"; |
  |  | 55 | $output [] = "  var oa = document.createElement('script'); oa.type = 'text/javascript';"; |
  |  | 56 | $output [] = "  oa.async = true; oa.src = '" . $oneall\_js\_library . "';"; |
  |  | 57 | $output [] = "  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(oa, s);"; |
  |  | 58 | $output [] = " })();"; |
  |  | 59 | $output [] = "</script>"; |
  |  | 60 | $output [] = ''; |
  |  | 61 |  |
  |  | 62 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 63 | echo implode ("\n", $output); |
  |  | 64 | } |
  |  | 65 | } |
  | 66 | 66 | } |
  | 67 | 67 |  |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L89) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L89) |  |
  | 89 | 89 | function oa\_social\_login\_render\_link\_form ($source, $user) |
  | 90 | 90 | { |
  | 91 |  | //Store the data being returned. |
  | 92 |  | $output = ''; |
  | 93 |  |  |
  | 94 |  | if (is\_object ($user) AND property\_exists ($user, 'data') AND !empty ($user->data->ID)) |
  | 95 |  | { |
  | 96 |  | //Only show Social Link if the user is viewing his own profile. |
  | 97 |  | if ($user->data->ID == get\_current\_user\_id ()) |
  | 98 |  | { |
  | 99 |  | //Identifier of the current user. |
  | 100 |  | $userid = $user->data->ID; |
  | 101 |  |  |
  | 102 |  | //Read Social Login settings. |
  | 103 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 104 |  |  |
  | 105 |  | //Is Social Link enabled? |
  | 106 |  | if (!isset ($settings ['plugin\_profile\_show']) OR !empty ($settings ['plugin\_profile\_show'])) |
  | 107 |  | { |
  | 108 |  | //Parse API Settings. |
  | 109 |  | $api\_connection\_handler = ((!empty ($settings ['api\_connection\_handler']) AND $settings ['api\_connection\_handler'] == 'fsockopen') ? 'fsockopen' : 'curl'); |
  | 110 |  | $api\_connection\_use\_https = ((!isset ($settings ['api\_connection\_use\_https']) OR $settings ['api\_connection\_use\_https'] == '1') ? true : false); |
  | 111 |  | $api\_subdomain = (!empty ($settings ['api\_subdomain']) ? $settings ['api\_subdomain'] : ''); |
  | 112 |  | $api\_key = (!empty ($settings ['api\_key']) ? $settings ['api\_key'] : ''); |
  | 113 |  | $api\_secret = (!empty ($settings ['api\_secret']) ? $settings ['api\_secret'] : ''); |
  | 114 |  |  |
  | 115 |  | //Import the available social networks. |
  | 116 |  | GLOBAL $oa\_social\_login\_providers; |
  | 117 |  |  |
  | 118 |  | //Setup the selected social networks. |
  | 119 |  | $api\_providers = array (); |
  | 120 |  | if (is\_array ($settings ['providers'])) |
  | 121 |  | { |
  | 122 |  | foreach ($settings ['providers'] AS $settings\_provider\_key => $settings\_provider\_name) |
  | 123 |  | { |
  | 124 |  | if (isset ($oa\_social\_login\_providers [$settings\_provider\_key])) |
  | 125 |  | { |
  | 126 |  | $api\_providers [] = $settings\_provider\_key; |
  | 127 |  | } |
  | 128 |  | } |
  | 129 |  | } |
  | 130 |  |  |
  | 131 |  | //The API subdomain is required. |
  | 132 |  | if (!empty ($api\_subdomain)) |
  | 133 |  | { |
  | 134 |  | //No providers have been selected. |
  | 135 |  | if (count ($api\_providers) == 0) |
  | 136 |  | { |
  | 137 |  | $output = '<div style="color:white;background-color:red;">[Social Login] ' . \_\_ ('Please enable at least one social network!', 'oa-social-login') . '</div>'; |
  | 138 |  | } |
  | 139 |  | //At least one providers has been selected. |
  | 140 |  | else |
  | 141 |  | { |
  | 142 |  | //Message Storage. |
  | 143 |  | $error\_message = ''; |
  | 144 |  | $success\_message = ''; |
  | 145 |  |  |
  | 146 |  | //Callback Handler. |
  | 147 |  | if (isset ($\_POST) AND !empty ($\_POST ['oa\_action']) AND $\_POST ['oa\_action'] == 'social\_link' AND !empty ($\_POST ['connection\_token'])) |
  | 148 |  | { |
  | 149 |  | //More info here: https://docs.oneall.com/api/resources/connections/read-connection-details/ |
  | 150 |  | $api\_resource\_url = ($api\_connection\_use\_https ? 'https' : 'http') . '://' . $api\_subdomain . '.api.oneall.com/connections/' . $\_POST ['connection\_token'] . '.json'; |
  | 151 |  |  |
  | 152 |  | //Get connection details |
  | 153 |  | $result = oa\_social\_login\_do\_api\_request ($api\_connection\_handler, $api\_resource\_url, array ('api\_key' => $api\_key, 'api\_secret' => $api\_secret)); |
  | 154 |  |  |
  | 155 |  | //Parse result |
  | 156 |  | if (is\_object ($result) AND property\_exists ($result, 'http\_code') AND property\_exists ($result, 'http\_data')) |
  | 157 |  | { |
  | 158 |  | //Decode |
  | 159 |  | $json\_decoded = json\_decode ($result->http\_data); |
  | 160 |  |  |
  | 161 |  | //User Data |
  | 162 |  | if (is\_object ($json\_decoded) AND property\_exists ($json\_decoded, 'response')) |
  | 163 |  | { |
  | 164 |  | //Extract data |
  | 165 |  | $data = $json\_decoded->response->result->data; |
  | 166 |  |  |
  | 167 |  |  |
  | 168 |  | //Check for plugin status |
  | 169 |  | if (is\_object ($data) AND property\_exists ($data, 'plugin') AND $data->plugin->key == 'social\_link') |
  | 170 |  | { |
  | 171 |  | if ($data->plugin->data->status == 'success') |
  | 172 |  | { |
  | 173 |  | //Get the id of the linked user - Can be empty |
  | 174 |  | $userid\_by\_token = oa\_social\_login\_get\_userid\_by\_token ($data->user->user\_token); |
  | 175 |  |  |
  | 176 |  | //Link identity |
  | 177 |  | if ($data->plugin->data->action == 'link\_identity') |
  | 178 |  | { |
  | 179 |  | //Hook for other plugins |
  | 180 |  | do\_action ('oa\_social\_login\_action\_before\_user\_link', $user->data, $data->user->identity, $userid\_by\_token); |
  | 181 |  |  |
  | 182 |  | // The user already has a user\_token |
  | 183 |  | if (is\_numeric ($userid\_by\_token)) |
  | 184 |  | { |
  | 185 |  | //Already connected to this user |
  | 186 |  | if ($userid\_by\_token == $userid) |
  | 187 |  | { |
  | 188 |  | $success\_message = sprintf (\_\_ ('You have successfully linked your %s account.', 'oa-social-login'), $data->user->identity->source->name); |
  | 189 |  |  |
  | 190 |  | // Linked Social Network |
  | 191 |  | $linked\_social\_networks = array (); |
  | 192 |  | if (isset ($data->user->identities) && is\_array ($data->user->identities)) |
  | 193 |  | { |
  | 194 |  | foreach ($data->user->identities AS $identity) |
  | 195 |  | { |
  | 196 |  | $linked\_social\_networks[] = $identity->provider; |
  | 197 |  | } |
  | 198 |  | $linked\_social\_networks = array\_unique ($linked\_social\_networks); |
  | 199 |  | } |
  | 200 |  |  |
  | 201 |  | // Update |
  | 202 |  | update\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider', implode ("|", $linked\_social\_networks)); |
  | 203 |  | } |
  | 204 |  | //Connected to a different user |
  | 205 |  | else |
  | 206 |  | { |
  | 207 |  | $error\_message = sprintf (\_\_ ('This %s account is already used by another user of this website.', 'oa-social-login'), $data->user->identity->source->name); |
  | 208 |  | } |
  | 209 |  | } |
  | 210 |  | // The user does not have a user\_token yet |
  | 211 |  | else |
  | 212 |  | { |
  | 213 |  | $success\_message = sprintf (\_\_ ('You have successfully linked your %s account.', 'oa-social-login'), $data->user->identity->source->name); |
  | 214 |  |  |
  | 215 |  | //Clean Cache |
  | 216 |  | wp\_cache\_delete ($userid, 'users'); |
  | 217 |  |  |
  | 218 |  | //User Meta Data |
  | 219 |  | update\_user\_meta ($userid, 'oa\_social\_login\_user\_token', $data->user->user\_token); |
  | 220 |  |  |
  | 221 |  |  |
  | 222 |  | // Linked Social Network |
  | 223 |  | $linked\_social\_networks = array (); |
  | 224 |  | if (isset ($data->user->identities) && is\_array ($data->user->identities)) |
  | 225 |  | { |
  | 226 |  | foreach ($data->user->identities AS $identity) |
  | 227 |  | { |
  | 228 |  | $linked\_social\_networks[] = $identity->provider; |
  | 229 |  | } |
  | 230 |  | $linked\_social\_networks = array\_unique ($linked\_social\_networks); |
  | 231 |  | } |
  | 232 |  |  |
  | 233 |  | // Update |
  | 234 |  | update\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider', implode ("|", $linked\_social\_networks)); |
  | 235 |  | } |
  | 236 |  |  |
  | 237 |  | // Thumbnail |
  | 238 |  | if (!empty ($data->user->identity->thumbnailUrl)) |
  | 239 |  | { |
  | 240 |  | update\_user\_meta ($userid, 'oa\_social\_login\_user\_thumbnail', $data->user->identity->thumbnailUrl); |
  | 241 |  | } |
  | 242 |  |  |
  | 243 |  | // Picture |
  | 244 |  | if (!empty ($data->user->identity->pictureUrl)) |
  | 245 |  | { |
  | 246 |  | update\_user\_meta ($userid, 'oa\_social\_login\_user\_picture', $data->user->identity->pictureUrl); |
  | 247 |  | } |
  | 248 |  |  |
  | 249 |  | //Hook for other plugins |
  | 250 |  | do\_action ('oa\_social\_login\_action\_after\_user\_link', $user->data, $data->user->identity, $userid\_by\_token); |
  | 251 |  | } |
  | 252 |  | //UnLink identity |
  | 253 |  | elseif ($data->plugin->data->action == 'unlink\_identity') |
  | 254 |  | { |
  | 255 |  | //Hook for other plugins |
  | 256 |  | do\_action ('oa\_social\_login\_action\_before\_user\_unlink', $user->data, $data->user->identity, $userid\_by\_token); |
  | 257 |  |  |
  | 258 |  | //The user already has a user\_token |
  | 259 |  | if (is\_numeric ($userid\_by\_token)) |
  | 260 |  | { |
  | 261 |  | //Was connected to this user |
  | 262 |  | if ($userid\_by\_token == $userid) |
  | 263 |  | { |
  | 264 |  | $success\_message = sprintf (\_\_ ('You have successfully unlinked your %s account.', 'oa-social-login'), $data->user->identity->source->name); |
  | 265 |  |  |
  | 266 |  | //Remove avatar |
  | 267 |  | delete\_user\_meta ($userid, 'oa\_social\_login\_user\_thumbnail'); |
  | 268 |  | delete\_user\_meta ($userid, 'oa\_social\_login\_user\_picture'); |
  | 269 |  |  |
  | 270 |  | // Linked Social Network |
  | 271 |  | $linked\_social\_networks = array (); |
  | 272 |  |  |
  | 273 |  | if (isset ($data->user->identities) && is\_array ($data->user->identities)) |
  | 274 |  | { |
  | 275 |  | foreach ($data->user->identities AS $identity) |
  | 276 |  | { |
  | 277 |  | $linked\_social\_networks[] = $identity->provider; |
  | 278 |  | } |
  | 279 |  | $linked\_social\_networks = array\_unique ($linked\_social\_networks); |
  | 280 |  | } |
  | 281 |  |  |
  | 282 |  | //No providers linked |
  | 283 |  | if (count ($linked\_social\_networks) == 0) |
  | 284 |  | { |
  | 285 |  | $error\_message = \_\_ ("You might no longer be able to login to this website if you don't link at least one social network.", 'oa-social-login'); |
  | 286 |  | delete\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider'); |
  | 287 |  | } |
  | 288 |  | else |
  | 289 |  | { |
  | 290 |  | update\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider', implode ("|", $linked\_social\_networks)); |
  | 291 |  | } |
  | 292 |  | } |
  | 293 |  | //Connected to a different user |
  | 294 |  | else |
  | 295 |  | { |
  | 296 |  | $error\_message = sprintf (\_\_ ('This %s account is already used by another user of this website.', 'oa-social-login'), $data->user->identity->source->name); |
  | 297 |  | } |
  | 298 |  | } |
  | 299 |  |  |
  | 300 |  | //Hook for other plugins |
  | 301 |  | do\_action ('oa\_social\_login\_action\_after\_user\_unlink', $user->data, $data->user->identity, $userid\_by\_token); |
  | 302 |  | } |
  | 303 |  | } |
  | 304 |  | else |
  | 305 |  | { |
  | 306 |  | if ($data->plugin->data->status == 'error' && $data->plugin->data->reason = 'identity\_is\_linked\_to\_another\_user') |
  | 307 |  | { |
  | 308 |  | $error\_message = \_\_ ('This social network account is already used by another user.', 'oa-social-login'); |
  | 309 |  | } |
  | 310 |  | } |
  | 311 |  | } |
  | 312 |  | } |
  | 313 |  | } |
  | 314 |  | } |
  | 315 |  |  |
  | 316 |  | //Button Theme |
  | 317 |  | $theme\_id = (array\_key\_exists ('plugin\_icon\_theme', $settings) ? $settings['plugin\_icon\_theme'] : null); |
  | 318 |  |  |
  | 319 |  | // Grab theme URI |
  | 320 |  | $css\_theme\_uri = oa\_social\_login\_get\_theme\_css\_url ($theme\_id); |
  | 321 |  |  |
  | 322 |  | // Apply filters |
  | 323 |  | $css\_theme\_uri = apply\_filters ('oa\_social\_login\_link\_css', $css\_theme\_uri); |
  | 324 |  |  |
  | 325 |  | //OneAll user\_token |
  | 326 |  | $token = strval (oa\_social\_login\_get\_token\_by\_userid ($userid)); |
  | 327 |  |  |
  | 328 |  | //Random integer |
  | 329 |  | $rand = mt\_rand (99999, 9999999); |
  | 330 |  |  |
  | 331 |  | //Callback URI |
  | 332 |  | $callback\_uri = oa\_social\_login\_get\_current\_url (); |
  | 333 |  | $callback\_uri .= (strlen (parse\_url ($callback\_uri, PHP\_URL\_QUERY)) == 0 ? '?' : '&') . 'oa\_social\_login\_source=' . $source . '#oa\_social\_link'; |
  | 334 |  | $callback\_uri = wp\_nonce\_url($callback\_uri, 'update-user\_' . $userid); |
  | 335 |  |  |
  | 336 |  | //Setup Social Container |
  | 337 |  | $containerid = 'oneall\_social\_login\_providers\_' . mt\_rand (99999, 9999999); |
  | 338 |  |  |
  | 339 |  | //Setup Social Link |
  | 340 |  | $social\_link = array (); |
  | 341 |  | $social\_link [] = '<div class="oneall\_social\_link">'; |
  | 342 |  | $social\_link [] = ' <div class="oneall\_social\_login\_providers" id="' . $containerid . '"></div>'; |
  | 343 |  | $social\_link [] = ' <script data-cfasync="false" type="text/javascript">'; |
  | 344 |  |  |
  | 345 |  | //Synchronous JavaScript: This is the default to stay compatible with existing installations. |
  | 346 |  | if (empty ($settings ['asynchronous\_javascript'])) |
  | 347 |  | { |
  | 348 |  | $social\_link [] = '  oneall.api.plugins.social\_link.build("' . $containerid . '", {'; |
  | 349 |  | $social\_link [] = '   "providers": ["' . implode ('","', $api\_providers) . '"], '; |
  | 350 |  | $social\_link [] = '   "user\_token": "' . $token . '", '; |
  | 351 |  | $social\_link [] = '   "callback\_uri": "' . $callback\_uri . '", '; |
  | 352 |  | $social\_link [] = '  });'; |
  | 353 |  | } |
  | 354 |  | //Asynchronous JavaScript. |
  | 355 |  | else |
  | 356 |  | { |
  | 357 |  | //JavaScript Method Reference: http://docs.oneall.com/api/javascript/library/methods/ |
  | 358 |  | $social\_link [] = "  var \_oneall = \_oneall || [];"; |
  | 359 |  | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_providers', ['" . implode ("','", $api\_providers) . "']]);"; |
  | 360 |  | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_user\_token', '" . $token . "']);"; |
  | 361 |  | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_callback\_uri', '" . $callback\_uri . "']);"; |
  | 362 |  | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_custom\_css\_uri', '" . $css\_theme\_uri . "']);"; |
  | 363 |  | $social\_link [] = "  \_oneall.push(['social\_link', 'do\_render\_ui', '" . $containerid . "']);"; |
  | 364 |  | } |
  | 365 |  |  |
  | 366 |  | $social\_link [] = " </script>"; |
  | 367 |  | $social\_link [] = '</div>'; |
  | 368 |  | $social\_link = implode ("\n", $social\_link); |
  | 369 |  |  |
  | 370 |  |  |
  | 371 |  | //Setup Output |
  | 372 |  | $output .= '<h3 id="oa\_social\_link"> ' . \_\_ ('Connect your account to one or more social networks', 'oa-social-login') . '</h3>'; |
  | 373 |  | $output .= '<table class="form-table">'; |
  | 374 |  | $output .= (empty ($success\_message) ? '' : '<tr><td><span style="color:green;font-weight:bold"> ' . $success\_message . '</span></td></tr>'); |
  | 375 |  | $output .= (empty ($error\_message) ? '' : '<tr><td><span style="color:red;font-weight:bold">' . $error\_message . '</span></td></tr>'); |
  | 376 |  | $output .= '<tr><td>' . $social\_link . '</td></tr>'; |
  | 377 |  | $output .= '</table>'; |
  | 378 |  | } |
  | 379 |  | } |
  | 380 |  | } |
  | 381 |  | } |
  | 382 |  | } |
  | 383 |  | return $output; |
  |  | 91 | //Store the data being returned. |
  |  | 92 | $output = ''; |
  |  | 93 |  |
  |  | 94 | if (is\_object ($user) AND property\_exists ($user, 'data') AND !empty ($user->data->ID)) |
  |  | 95 | { |
  |  | 96 | //Only show Social Link if the user is viewing his own profile. |
  |  | 97 | if ($user->data->ID == get\_current\_user\_id ()) |
  |  | 98 | { |
  |  | 99 | //Identifier of the current user. |
  |  | 100 | $userid = $user->data->ID; |
  |  | 101 |  |
  |  | 102 | //Read Social Login settings. |
  |  | 103 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 104 |  |
  |  | 105 | //Is Social Link enabled? |
  |  | 106 | if (!isset ($settings ['plugin\_profile\_show']) OR !empty ($settings ['plugin\_profile\_show'])) |
  |  | 107 | { |
  |  | 108 | //Parse API Settings. |
  |  | 109 | $api\_connection\_handler = ((!empty ($settings ['api\_connection\_handler']) AND $settings ['api\_connection\_handler'] == 'fsockopen') ? 'fsockopen' : 'curl'); |
  |  | 110 | $api\_connection\_use\_https = ((!isset ($settings ['api\_connection\_use\_https']) OR $settings ['api\_connection\_use\_https'] == '1') ? true : false); |
  |  | 111 | $api\_subdomain = (!empty ($settings ['api\_subdomain']) ? $settings ['api\_subdomain'] : ''); |
  |  | 112 | $api\_key = (!empty ($settings ['api\_key']) ? $settings ['api\_key'] : ''); |
  |  | 113 | $api\_secret = (!empty ($settings ['api\_secret']) ? $settings ['api\_secret'] : ''); |
  |  | 114 |  |
  |  | 115 | //Import the available social networks. |
  |  | 116 | GLOBAL $oa\_social\_login\_providers; |
  |  | 117 |  |
  |  | 118 | //Setup the selected social networks. |
  |  | 119 | $api\_providers = array (); |
  |  | 120 | if (is\_array ($settings ['providers'])) |
  |  | 121 | { |
  |  | 122 | foreach ($settings ['providers'] AS $settings\_provider\_key => $settings\_provider\_name) |
  |  | 123 | { |
  |  | 124 | if (isset ($oa\_social\_login\_providers [$settings\_provider\_key])) |
  |  | 125 | { |
  |  | 126 | $api\_providers [] = $settings\_provider\_key; |
  |  | 127 | } |
  |  | 128 | } |
  |  | 129 | } |
  |  | 130 |  |
  |  | 131 | //The API subdomain is required. |
  |  | 132 | if (!empty ($api\_subdomain)) |
  |  | 133 | { |
  |  | 134 | //No providers have been selected. |
  |  | 135 | if (count ($api\_providers) == 0) |
  |  | 136 | { |
  |  | 137 | $output = '<div style="color:white;background-color:red;">[Social Login] ' . \_\_ ('Please enable at least one social network!', 'oa-social-login') . '</div>'; |
  |  | 138 | } |
  |  | 139 | //At least one providers has been selected. |
  |  | 140 | else |
  |  | 141 | { |
  |  | 142 | //Message Storage. |
  |  | 143 | $error\_message = ''; |
  |  | 144 | $success\_message = ''; |
  |  | 145 |  |
  |  | 146 | //Callback Handler. |
  |  | 147 | if (isset ($\_POST) AND !empty ($\_POST ['oa\_action']) AND $\_POST ['oa\_action'] == 'social\_link' AND !empty ($\_POST ['connection\_token'])) |
  |  | 148 | { |
  |  | 149 | //More info here: https://docs.oneall.com/api/resources/connections/read-connection-details/ |
  |  | 150 | $api\_resource\_url = ($api\_connection\_use\_https ? 'https' : 'http') . '://' . $api\_subdomain . '.api.oneall.com/connections/' . $\_POST ['connection\_token'] . '.json'; |
  |  | 151 |  |
  |  | 152 | //Get connection details |
  |  | 153 | $result = oa\_social\_login\_do\_api\_request ($api\_connection\_handler, $api\_resource\_url, array ('api\_key' => $api\_key, 'api\_secret' => $api\_secret)); |
  |  | 154 |  |
  |  | 155 | //Parse result |
  |  | 156 | if (is\_object ($result) AND property\_exists ($result, 'http\_code') AND property\_exists ($result, 'http\_data')) |
  |  | 157 | { |
  |  | 158 | //Decode |
  |  | 159 | $json\_decoded = json\_decode ($result->http\_data); |
  |  | 160 |  |
  |  | 161 | //User Data |
  |  | 162 | if (is\_object ($json\_decoded) AND property\_exists ($json\_decoded, 'response')) |
  |  | 163 | { |
  |  | 164 | //Extract data |
  |  | 165 | $data = $json\_decoded->response->result->data; |
  |  | 166 |  |
  |  | 167 |  |
  |  | 168 | //Check for plugin status |
  |  | 169 | if (is\_object ($data) AND property\_exists ($data, 'plugin') AND $data->plugin->key == 'social\_link') |
  |  | 170 | { |
  |  | 171 | if ($data->plugin->data->status == 'success') |
  |  | 172 | { |
  |  | 173 | //Get the id of the linked user - Can be empty |
  |  | 174 | $userid\_by\_token = oa\_social\_login\_get\_userid\_by\_token ($data->user->user\_token); |
  |  | 175 |  |
  |  | 176 | //Link identity |
  |  | 177 | if ($data->plugin->data->action == 'link\_identity') |
  |  | 178 | { |
  |  | 179 | //Hook for other plugins |
  |  | 180 | do\_action ('oa\_social\_login\_action\_before\_user\_link', $user->data, $data->user->identity, $userid\_by\_token); |
  |  | 181 |  |
  |  | 182 | // The user already has a user\_token |
  |  | 183 | if (is\_numeric ($userid\_by\_token)) |
  |  | 184 | { |
  |  | 185 | //Already connected to this user |
  |  | 186 | if ($userid\_by\_token == $userid) |
  |  | 187 | { |
  |  | 188 | /\* translators: %s: provider name \*/ |
  |  | 189 | $success\_message = sprintf (\_\_ ('You have successfully linked your %s account.', 'oa-social-login'), $data->user->identity->source->name); |
  |  | 190 |  |
  |  | 191 | // Linked Social Network |
  |  | 192 | $linked\_social\_networks = array (); |
  |  | 193 | if (isset ($data->user->identities) && is\_array ($data->user->identities)) |
  |  | 194 | { |
  |  | 195 | foreach ($data->user->identities AS $identity) |
  |  | 196 | { |
  |  | 197 | $linked\_social\_networks[] = $identity->provider; |
  |  | 198 | } |
  |  | 199 | $linked\_social\_networks = array\_unique ($linked\_social\_networks); |
  |  | 200 | } |
  |  | 201 |  |
  |  | 202 | // Update |
  |  | 203 | update\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider', implode ("|", $linked\_social\_networks)); |
  |  | 204 | } |
  |  | 205 | //Connected to a different user |
  |  | 206 | else |
  |  | 207 | { |
  |  | 208 | /\* translators: %s: provider name \*/ |
  |  | 209 | $error\_message = sprintf (\_\_ ('This %s account is already used by another user of this website.', 'oa-social-login'), $data->user->identity->source->name); |
  |  | 210 | } |
  |  | 211 | } |
  |  | 212 | // The user does not have a user\_token yet |
  |  | 213 | else |
  |  | 214 | { |
  |  | 215 | /\* translators: %s: provider name \*/ |
  |  | 216 | $success\_message = sprintf (\_\_ ('You have successfully linked your %s account.', 'oa-social-login'), $data->user->identity->source->name); |
  |  | 217 |  |
  |  | 218 | //Clean Cache |
  |  | 219 | wp\_cache\_delete ($userid, 'users'); |
  |  | 220 |  |
  |  | 221 | //User Meta Data |
  |  | 222 | update\_user\_meta ($userid, 'oa\_social\_login\_user\_token', $data->user->user\_token); |
  |  | 223 |  |
  |  | 224 |  |
  |  | 225 | // Linked Social Network |
  |  | 226 | $linked\_social\_networks = array (); |
  |  | 227 | if (isset ($data->user->identities) && is\_array ($data->user->identities)) |
  |  | 228 | { |
  |  | 229 | foreach ($data->user->identities AS $identity) |
  |  | 230 | { |
  |  | 231 | $linked\_social\_networks[] = $identity->provider; |
  |  | 232 | } |
  |  | 233 | $linked\_social\_networks = array\_unique ($linked\_social\_networks); |
  |  | 234 | } |
  |  | 235 |  |
  |  | 236 | // Update |
  |  | 237 | update\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider', implode ("|", $linked\_social\_networks)); |
  |  | 238 | } |
  |  | 239 |  |
  |  | 240 | // Thumbnail |
  |  | 241 | if (!empty ($data->user->identity->thumbnailUrl)) |
  |  | 242 | { |
  |  | 243 | update\_user\_meta ($userid, 'oa\_social\_login\_user\_thumbnail', $data->user->identity->thumbnailUrl); |
  |  | 244 | } |
  |  | 245 |  |
  |  | 246 | // Picture |
  |  | 247 | if (!empty ($data->user->identity->pictureUrl)) |
  |  | 248 | { |
  |  | 249 | update\_user\_meta ($userid, 'oa\_social\_login\_user\_picture', $data->user->identity->pictureUrl); |
  |  | 250 | } |
  |  | 251 |  |
  |  | 252 | //Hook for other plugins |
  |  | 253 | do\_action ('oa\_social\_login\_action\_after\_user\_link', $user->data, $data->user->identity, $userid\_by\_token); |
  |  | 254 | } |
  |  | 255 | //UnLink identity |
  |  | 256 | elseif ($data->plugin->data->action == 'unlink\_identity') |
  |  | 257 | { |
  |  | 258 | //Hook for other plugins |
  |  | 259 | do\_action ('oa\_social\_login\_action\_before\_user\_unlink', $user->data, $data->user->identity, $userid\_by\_token); |
  |  | 260 |  |
  |  | 261 | //The user already has a user\_token |
  |  | 262 | if (is\_numeric ($userid\_by\_token)) |
  |  | 263 | { |
  |  | 264 | //Was connected to this user |
  |  | 265 | if ($userid\_by\_token == $userid) |
  |  | 266 | { |
  |  | 267 | /\* translators: %s: provider name \*/ |
  |  | 268 | $success\_message = sprintf (\_\_ ('You have successfully unlinked your %s account.', 'oa-social-login'), $data->user->identity->source->name); |
  |  | 269 |  |
  |  | 270 | //Remove avatar |
  |  | 271 | delete\_user\_meta ($userid, 'oa\_social\_login\_user\_thumbnail'); |
  |  | 272 | delete\_user\_meta ($userid, 'oa\_social\_login\_user\_picture'); |
  |  | 273 |  |
  |  | 274 | // Linked Social Network |
  |  | 275 | $linked\_social\_networks = array (); |
  |  | 276 |  |
  |  | 277 | if (isset ($data->user->identities) && is\_array ($data->user->identities)) |
  |  | 278 | { |
  |  | 279 | foreach ($data->user->identities AS $identity) |
  |  | 280 | { |
  |  | 281 | $linked\_social\_networks[] = $identity->provider; |
  |  | 282 | } |
  |  | 283 | $linked\_social\_networks = array\_unique ($linked\_social\_networks); |
  |  | 284 | } |
  |  | 285 |  |
  |  | 286 | //No providers linked |
  |  | 287 | if (count ($linked\_social\_networks) == 0) |
  |  | 288 | { |
  |  | 289 | $error\_message = \_\_ ("You might no longer be able to login to this website if you don't link at least one social network.", 'oa-social-login'); |
  |  | 290 | delete\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider'); |
  |  | 291 | } |
  |  | 292 | else |
  |  | 293 | { |
  |  | 294 | update\_user\_meta ($userid, 'oa\_social\_login\_identity\_provider', implode ("|", $linked\_social\_networks)); |
  |  | 295 | } |
  |  | 296 | } |
  |  | 297 | //Connected to a different user |
  |  | 298 | else |
  |  | 299 | { |
  |  | 300 | /\* translators: %s: provider name \*/ |
  |  | 301 | $error\_message = sprintf (\_\_ ('This %s account is already used by another user of this website.', 'oa-social-login'), $data->user->identity->source->name); |
  |  | 302 | } |
  |  | 303 | } |
  |  | 304 |  |
  |  | 305 | //Hook for other plugins |
  |  | 306 | do\_action ('oa\_social\_login\_action\_after\_user\_unlink', $user->data, $data->user->identity, $userid\_by\_token); |
  |  | 307 | } |
  |  | 308 | } |
  |  | 309 | else |
  |  | 310 | { |
  |  | 311 | if ($data->plugin->data->status == 'error' && $data->plugin->data->reason = 'identity\_is\_linked\_to\_another\_user') |
  |  | 312 | { |
  |  | 313 | $error\_message = \_\_ ('This social network account is already used by another user.', 'oa-social-login'); |
  |  | 314 | } |
  |  | 315 | } |
  |  | 316 | } |
  |  | 317 | } |
  |  | 318 | } |
  |  | 319 | } |
  |  | 320 |  |
  |  | 321 | //Button Theme |
  |  | 322 | $theme\_id = (array\_key\_exists ('plugin\_icon\_theme', $settings) ? $settings['plugin\_icon\_theme'] : null); |
  |  | 323 |  |
  |  | 324 | // Grab theme URI |
  |  | 325 | $css\_theme\_uri = oa\_social\_login\_get\_theme\_css\_url ($theme\_id); |
  |  | 326 |  |
  |  | 327 | // Apply filters |
  |  | 328 | $css\_theme\_uri = apply\_filters ('oa\_social\_login\_link\_css', $css\_theme\_uri); |
  |  | 329 |  |
  |  | 330 | //OneAll user\_token |
  |  | 331 | $token = strval (oa\_social\_login\_get\_token\_by\_userid ($userid)); |
  |  | 332 |  |
  |  | 333 | //Random integer |
  |  | 334 | $rand = wp\_rand (99999, 9999999); |
  |  | 335 |  |
  |  | 336 | //Callback URI |
  |  | 337 | $callback\_uri = oa\_social\_login\_get\_current\_url (); |
  |  | 338 | $callback\_uri .= (strlen (parse\_url ($callback\_uri, PHP\_URL\_QUERY)) == 0 ? '?' : '&') . 'oa\_social\_login\_source=' . $source . '#oa\_social\_link'; |
  |  | 339 | $callback\_uri = wp\_nonce\_url($callback\_uri, 'update-user\_' . $userid); |
  |  | 340 |  |
  |  | 341 | //Setup Social Container |
  |  | 342 | $containerid = 'oneall\_social\_login\_providers\_' . wp\_rand (99999, 9999999); |
  |  | 343 |  |
  |  | 344 | //Setup Social Link |
  |  | 345 | $social\_link = array (); |
  |  | 346 | $social\_link [] = '<div class="oneall\_social\_link">'; |
  |  | 347 | $social\_link [] = ' <div class="oneall\_social\_login\_providers" id="' . $containerid . '"></div>'; |
  |  | 348 | $social\_link [] = ' <script data-cfasync="false" type="text/javascript">'; |
  |  | 349 |  |
  |  | 350 | //Synchronous JavaScript: This is the default to stay compatible with existing installations. |
  |  | 351 | if (empty ($settings ['asynchronous\_javascript'])) |
  |  | 352 | { |
  |  | 353 | $social\_link [] = '  oneall.api.plugins.social\_link.build("' . $containerid . '", {'; |
  |  | 354 | $social\_link [] = '   "providers": ["' . implode ('","', $api\_providers) . '"], '; |
  |  | 355 | $social\_link [] = '   "user\_token": "' . $token . '", '; |
  |  | 356 | $social\_link [] = '   "callback\_uri": "' . $callback\_uri . '", '; |
  |  | 357 | $social\_link [] = '  });'; |
  |  | 358 | } |
  |  | 359 | //Asynchronous JavaScript. |
  |  | 360 | else |
  |  | 361 | { |
  |  | 362 | //JavaScript Method Reference: http://docs.oneall.com/api/javascript/library/methods/ |
  |  | 363 | $social\_link [] = "  var \_oneall = \_oneall || [];"; |
  |  | 364 | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_providers', ['" . implode ("','", $api\_providers) . "']]);"; |
  |  | 365 | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_user\_token', '" . $token . "']);"; |
  |  | 366 | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_callback\_uri', '" . $callback\_uri . "']);"; |
  |  | 367 | $social\_link [] = "  \_oneall.push(['social\_link', 'set\_custom\_css\_uri', '" . $css\_theme\_uri . "']);"; |
  |  | 368 | $social\_link [] = "  \_oneall.push(['social\_link', 'do\_render\_ui', '" . $containerid . "']);"; |
  |  | 369 | } |
  |  | 370 |  |
  |  | 371 | $social\_link [] = " </script>"; |
  |  | 372 | $social\_link [] = '</div>'; |
  |  | 373 | $social\_link = implode ("\n", $social\_link); |
  |  | 374 |  |
  |  | 375 |  |
  |  | 376 | //Setup Output |
  |  | 377 | $output .= '<h3 id="oa\_social\_link"> ' . \_\_ ('Connect your account to one or more social networks', 'oa-social-login') . '</h3>'; |
  |  | 378 | $output .= '<table class="form-table">'; |
  |  | 379 | $output .= (empty ($success\_message) ? '' : '<tr><td><span style="color:green;font-weight:bold"> ' . $success\_message . '</span></td></tr>'); |
  |  | 380 | $output .= (empty ($error\_message) ? '' : '<tr><td><span style="color:red;font-weight:bold">' . $error\_message . '</span></td></tr>'); |
  |  | 381 | $output .= '<tr><td>' . $social\_link . '</td></tr>'; |
  |  | 382 | $output .= '</table>'; |
  |  | 383 | } |
  |  | 384 | } |
  |  | 385 | } |
  |  | 386 | } |
  |  | 387 | } |
  |  | 388 | return $output; |
  | 384 | 389 | } |
  | 385 | 390 |  |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L390) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L395) |  |
  | 390 | 395 | function oa\_social\_login\_add\_social\_link ($user) |
  | 391 | 396 | { |
  | 392 |  | echo oa\_social\_login\_render\_link\_form ('profile', $user); |
  |  | 397 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 398 | echo oa\_social\_login\_render\_link\_form ('profile', $user); |
  | 393 | 399 | } |
  | 394 | 400 | add\_action ('show\_user\_profile', 'oa\_social\_login\_add\_social\_link'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L400) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L406) |  |
  | 400 | 406 | function oa\_social\_login\_link\_shortcode\_handler ($args) |
  | 401 | 407 | { |
  | 402 |  | if (is\_user\_logged\_in ()) |
  | 403 |  | { |
  | 404 |  | $user = wp\_get\_current\_user (); |
  | 405 |  | if (!empty ($user->data->ID)) |
  | 406 |  | { |
  | 407 |  | return oa\_social\_login\_render\_link\_form ('shortcode', $user); |
  | 408 |  | } |
  | 409 |  | } |
  | 410 |  | return ''; |
  |  | 408 | if (is\_user\_logged\_in ()) |
  |  | 409 | { |
  |  | 410 | $user = wp\_get\_current\_user (); |
  |  | 411 | if (!empty ($user->data->ID)) |
  |  | 412 | { |
  |  | 413 | return oa\_social\_login\_render\_link\_form ('shortcode', $user); |
  |  | 414 | } |
  |  | 415 | } |
  |  | 416 | return ''; |
  | 411 | 417 | } |
  | 412 | 418 | add\_shortcode ('oa\_social\_link', 'oa\_social\_login\_link\_shortcode\_handler'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L418) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L424) |  |
  | 418 | 424 | function oa\_social\_login\_link\_action\_handler () |
  | 419 | 425 | { |
  | 420 |  | //Social Link works only with logged in users |
  | 421 |  | if (is\_user\_logged\_in ()) |
  | 422 |  | { |
  | 423 |  | $user = wp\_get\_current\_user (); |
  | 424 |  | if (is\_object ($user) AND !empty ($user->data->ID)) |
  | 425 |  | { |
  | 426 |  | echo oa\_social\_login\_render\_link\_form ('custom', $user); |
  | 427 |  | } |
  | 428 |  | } |
  |  | 426 | //Social Link works only with logged in users |
  |  | 427 | if (is\_user\_logged\_in ()) |
  |  | 428 | { |
  |  | 429 | $user = wp\_get\_current\_user (); |
  |  | 430 | if (is\_object ($user) AND !empty ($user->data->ID)) |
  |  | 431 | { |
  |  | 432 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 433 | echo oa\_social\_login\_render\_link\_form ('custom', $user); |
  |  | 434 | } |
  |  | 435 | } |
  | 429 | 436 | } |
  | 430 | 437 | add\_action ('oa\_social\_link', 'oa\_social\_login\_link\_action\_handler'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L443) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L450) |  |
  | 443 | 450 | function oa\_social\_login\_shortcode\_handler ($args) |
  | 444 | 451 | { |
  | 445 |  | if (!is\_user\_logged\_in ()) |
  | 446 |  | { |
  | 447 |  | return oa\_social\_login\_render\_login\_form ('shortcode'); |
  | 448 |  | } |
  | 449 |  | return ''; |
  |  | 452 | if (!is\_user\_logged\_in ()) |
  |  | 453 | { |
  |  | 454 | return oa\_social\_login\_render\_login\_form ('shortcode'); |
  |  | 455 | } |
  |  | 456 | return ''; |
  | 450 | 457 | } |
  | 451 | 458 | add\_shortcode ('oa\_social\_login', 'oa\_social\_login\_shortcode\_handler'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L466) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L473) |  |
  | 466 | 473 | function oa\_social\_login\_shortcode\_test ($args, $content = null) |
  | 467 | 474 | { |
  | 468 |  | if (is\_array ($args)) |
  | 469 |  | { |
  | 470 |  | $user = wp\_get\_current\_user (); |
  | 471 |  | $is\_social\_login\_user = false; |
  | 472 |  |  |
  | 473 |  | if (!empty ($user->data->ID)) |
  | 474 |  | { |
  | 475 |  | $identity\_providers = trim (strval (get\_user\_meta ($user->data->ID, 'oa\_social\_login\_identity\_provider', true))); |
  | 476 |  | $is\_social\_login\_user = (strlen ($identity\_providers) > 0); |
  | 477 |  | } |
  | 478 |  |  |
  | 479 |  | if (!empty ($args ['is\_social\_login\_user'])) |
  | 480 |  | { |
  | 481 |  | if ($args ['is\_social\_login\_user'] == 'true') |
  | 482 |  | { |
  | 483 |  | if ($is\_social\_login\_user) |
  | 484 |  | { |
  | 485 |  | return do\_shortcode ($content); |
  | 486 |  | } |
  | 487 |  | } |
  | 488 |  | elseif ($args ['is\_social\_login\_user'] == 'false') |
  | 489 |  | { |
  | 490 |  | if (!$is\_social\_login\_user) |
  | 491 |  | { |
  | 492 |  | return do\_shortcode ($content); |
  | 493 |  | } |
  | 494 |  | } |
  | 495 |  | } |
  | 496 |  | } |
  |  | 475 | if (is\_array ($args)) |
  |  | 476 | { |
  |  | 477 | $user = wp\_get\_current\_user (); |
  |  | 478 | $is\_social\_login\_user = false; |
  |  | 479 |  |
  |  | 480 | if (!empty ($user->data->ID)) |
  |  | 481 | { |
  |  | 482 | $identity\_providers = trim (strval (get\_user\_meta ($user->data->ID, 'oa\_social\_login\_identity\_provider', true))); |
  |  | 483 | $is\_social\_login\_user = (strlen ($identity\_providers) > 0); |
  |  | 484 | } |
  |  | 485 |  |
  |  | 486 | if (!empty ($args ['is\_social\_login\_user'])) |
  |  | 487 | { |
  |  | 488 | if ($args ['is\_social\_login\_user'] == 'true') |
  |  | 489 | { |
  |  | 490 | if ($is\_social\_login\_user) |
  |  | 491 | { |
  |  | 492 | return do\_shortcode ($content); |
  |  | 493 | } |
  |  | 494 | } |
  |  | 495 | elseif ($args ['is\_social\_login\_user'] == 'false') |
  |  | 496 | { |
  |  | 497 | if (!$is\_social\_login\_user) |
  |  | 498 | { |
  |  | 499 | return do\_shortcode ($content); |
  |  | 500 | } |
  |  | 501 | } |
  |  | 502 | } |
  |  | 503 | } |
  | 497 | 504 | } |
  | 498 | 505 | add\_shortcode ('oa\_social\_login\_test', 'oa\_social\_login\_shortcode\_test'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L504) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L511) |  |
  | 504 | 511 | function oa\_social\_login\_bp\_custom\_fetch\_avatar ($text, $args) |
  | 505 | 512 | { |
  | 506 |  | //The social login settings |
  | 507 |  | static $oa\_social\_login\_avatars = null; |
  | 508 |  | if (is\_null ($oa\_social\_login\_avatars)) |
  | 509 |  | { |
  | 510 |  | $oa\_social\_login\_settings = get\_option ('oa\_social\_login\_settings'); |
  | 511 |  | $oa\_social\_login\_avatars = (isset ($oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments']) ? $oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  | 512 |  | } |
  | 513 |  |  |
  | 514 |  | //Check if avatars are enabled |
  | 515 |  | if (!empty ($oa\_social\_login\_avatars)) |
  | 516 |  | { |
  | 517 |  | //Check arguments |
  | 518 |  | if (is\_array ($args)) |
  | 519 |  | { |
  | 520 |  | //User Object |
  | 521 |  | if (!empty ($args ['object']) AND strtolower ($args ['object']) == 'user') |
  | 522 |  | { |
  | 523 |  | //User Identifier |
  | 524 |  | if (!empty ($args ['item\_id']) AND is\_numeric ($args ['item\_id'])) |
  | 525 |  | { |
  | 526 |  | //Retrieve user |
  | 527 |  | if (($user\_data = get\_userdata ($args ['item\_id'])) !== false) |
  | 528 |  | { |
  | 529 |  | //Only replace if the user has the default avatar (this will keep uploaded avatars) |
  | 530 |  | if (oa\_social\_login\_has\_bp\_user\_uploaded\_avatar ($args ['item\_id']) == false) |
  | 531 |  | { |
  | 532 |  | //Read the avatar |
  | 533 |  | $user\_meta\_thumbnail = get\_user\_meta ($args ['item\_id'], 'oa\_social\_login\_user\_thumbnail', true); |
  | 534 |  | $user\_meta\_picture = get\_user\_meta ($args ['item\_id'], 'oa\_social\_login\_user\_picture', true); |
  | 535 |  |  |
  | 536 |  | //Use the picture if possible |
  | 537 |  | if ($oa\_social\_login\_avatars == 2) |
  | 538 |  | { |
  | 539 |  | $user\_picture = (!empty ($user\_meta\_picture) ? $user\_meta\_picture : $user\_meta\_thumbnail); |
  | 540 |  | } |
  | 541 |  | //Use the thumbnail if possible |
  | 542 |  | else |
  | 543 |  | { |
  | 544 |  | $user\_picture = (!empty ($user\_meta\_thumbnail) ? $user\_meta\_thumbnail : $user\_meta\_picture); |
  | 545 |  | } |
  | 546 |  |  |
  | 547 |  | //Avatar found? |
  | 548 |  | if ($user\_picture !== false AND strlen (trim ($user\_picture)) > 0) |
  | 549 |  | { |
  | 550 |  | //Build Image tags |
  | 551 |  | $img\_alt = (!empty ($args ['alt']) ? 'alt="' . oa\_social\_login\_esc\_attr ($args ['alt']) . '" ' : ''); |
  | 552 |  | $img\_alt = sprintf ($img\_alt, htmlspecialchars ($user\_data->user\_login)); |
  | 553 |  | $img\_class = ('class="' . (!empty ($args ['class']) ? ($args ['class'] . ' ') : '') . 'avatar-social-login" '); |
  | 554 |  | $img\_width = (!empty ($args ['width']) ? 'width="' . $args ['width'] . '" ' : ''); |
  | 555 |  | $img\_height = (!empty ($args ['height']) ? 'height="' . $args ['height'] . '" ' : ''); |
  | 556 |  |  |
  | 557 |  | //Replace |
  | 558 |  | $text = preg\_replace ('#<img[^>]+>#i', '<img data-social-login="bp-d1" src="' . $user\_picture . '" ' . $img\_alt . $img\_class . $img\_height . $img\_width . '/>', $text); |
  | 559 |  | } |
  | 560 |  | } |
  | 561 |  | } |
  | 562 |  | } |
  | 563 |  | } |
  | 564 |  | } |
  | 565 |  | } |
  | 566 |  | return $text; |
  |  | 513 | //The social login settings |
  |  | 514 | static $oa\_social\_login\_avatars = null; |
  |  | 515 | if (is\_null ($oa\_social\_login\_avatars)) |
  |  | 516 | { |
  |  | 517 | $oa\_social\_login\_settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 518 | $oa\_social\_login\_avatars = (isset ($oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments']) ? $oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  |  | 519 | } |
  |  | 520 |  |
  |  | 521 | //Check if avatars are enabled |
  |  | 522 | if (!empty ($oa\_social\_login\_avatars)) |
  |  | 523 | { |
  |  | 524 | //Check arguments |
  |  | 525 | if (is\_array ($args)) |
  |  | 526 | { |
  |  | 527 | //User Object |
  |  | 528 | if (!empty ($args ['object']) AND strtolower ($args ['object']) == 'user') |
  |  | 529 | { |
  |  | 530 | //User Identifier |
  |  | 531 | if (!empty ($args ['item\_id']) AND is\_numeric ($args ['item\_id'])) |
  |  | 532 | { |
  |  | 533 | //Retrieve user |
  |  | 534 | if (($user\_data = get\_userdata ($args ['item\_id'])) !== false) |
  |  | 535 | { |
  |  | 536 | //Only replace if the user has the default avatar (this will keep uploaded avatars) |
  |  | 537 | if (oa\_social\_login\_has\_bp\_user\_uploaded\_avatar ($args ['item\_id']) == false) |
  |  | 538 | { |
  |  | 539 | //Read the avatar |
  |  | 540 | $user\_meta\_thumbnail = get\_user\_meta ($args ['item\_id'], 'oa\_social\_login\_user\_thumbnail', true); |
  |  | 541 | $user\_meta\_picture = get\_user\_meta ($args ['item\_id'], 'oa\_social\_login\_user\_picture', true); |
  |  | 542 |  |
  |  | 543 | //Use the picture if possible |
  |  | 544 | if ($oa\_social\_login\_avatars == 2) |
  |  | 545 | { |
  |  | 546 | $user\_picture = (!empty ($user\_meta\_picture) ? $user\_meta\_picture : $user\_meta\_thumbnail); |
  |  | 547 | } |
  |  | 548 | //Use the thumbnail if possible |
  |  | 549 | else |
  |  | 550 | { |
  |  | 551 | $user\_picture = (!empty ($user\_meta\_thumbnail) ? $user\_meta\_thumbnail : $user\_meta\_picture); |
  |  | 552 | } |
  |  | 553 |  |
  |  | 554 | //Avatar found? |
  |  | 555 | if ($user\_picture !== false AND strlen (trim ($user\_picture)) > 0) |
  |  | 556 | { |
  |  | 557 | //Build Image tags |
  |  | 558 | $img\_alt = (!empty ($args ['alt']) ? 'alt="' . oa\_social\_login\_esc\_attr ($args ['alt']) . '" ' : ''); |
  |  | 559 | $img\_alt = sprintf ($img\_alt, htmlspecialchars ($user\_data->user\_login)); |
  |  | 560 | $img\_class = ('class="' . (!empty ($args ['class']) ? ($args ['class'] . ' ') : '') . 'avatar-social-login" '); |
  |  | 561 | $img\_width = (!empty ($args ['width']) ? 'width="' . $args ['width'] . '" ' : ''); |
  |  | 562 | $img\_height = (!empty ($args ['height']) ? 'height="' . $args ['height'] . '" ' : ''); |
  |  | 563 |  |
  |  | 564 | //Replace |
  |  | 565 | $text = preg\_replace ('#<img[^>]+>#i', '<img data-social-login="bp-d1" src="' . $user\_picture . '" ' . $img\_alt . $img\_class . $img\_height . $img\_width . '/>', $text); |
  |  | 566 | } |
  |  | 567 | } |
  |  | 568 | } |
  |  | 569 | } |
  |  | 570 | } |
  |  | 571 | } |
  |  | 572 | } |
  |  | 573 | return $text; |
  | 567 | 574 | } |
  | 568 | 575 | add\_filter ('bp\_core\_fetch\_avatar', 'oa\_social\_login\_bp\_custom\_fetch\_avatar', 10, 2); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L574) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L581) |  |
  | 574 | 581 | function oa\_social\_login\_custom\_avatar ($avatar, $mixed, $size, $default, $alt = '') |
  | 575 | 582 | { |
  | 576 |  | //The social login settings |
  | 577 |  | static $oa\_social\_login\_avatars = null; |
  | 578 |  | if (is\_null ($oa\_social\_login\_avatars)) |
  | 579 |  | { |
  | 580 |  | $oa\_social\_login\_settings = get\_option ('oa\_social\_login\_settings'); |
  | 581 |  | $oa\_social\_login\_avatars = (isset ($oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments']) ? $oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  | 582 |  | } |
  | 583 |  |  |
  | 584 |  | //Check if social avatars are enabled |
  | 585 |  | if (!empty ($oa\_social\_login\_avatars)) |
  | 586 |  | { |
  | 587 |  | //Check if we have an user identifier |
  | 588 |  | if (is\_numeric ($mixed) AND $mixed > 0) |
  | 589 |  | { |
  | 590 |  | $user\_id = $mixed; |
  | 591 |  | } |
  | 592 |  | //Check if we have an user email |
  | 593 |  | elseif (is\_string ($mixed) AND ($user = get\_user\_by ('email', $mixed))) |
  | 594 |  | { |
  | 595 |  | $user\_id = $user->ID; |
  | 596 |  | } |
  | 597 |  | //Check if we have an user object |
  | 598 |  | elseif (is\_object ($mixed) AND property\_exists ($mixed, 'user\_id') AND is\_numeric ($mixed->user\_id)) |
  | 599 |  | { |
  | 600 |  | $user\_id = $mixed->user\_id; |
  | 601 |  | } |
  | 602 |  | //None found |
  | 603 |  | else |
  | 604 |  | { |
  | 605 |  | $user\_id = null; |
  | 606 |  | } |
  | 607 |  |  |
  | 608 |  | //User found? |
  | 609 |  | if (!empty ($user\_id)) |
  | 610 |  | { |
  | 611 |  | //Override current avatar ? |
  | 612 |  | $override\_avatar = true; |
  | 613 |  |  |
  | 614 |  | //BuddyPress (Thumbnails in the default WordPress toolbar) |
  | 615 |  | if (oa\_social\_login\_has\_bp\_user\_uploaded\_avatar ($user\_id) === true) |
  | 616 |  | { |
  | 617 |  | // Keep avatar is user has uploaded one |
  | 618 |  | $override\_avatar = false; |
  | 619 |  | } |
  | 620 |  |  |
  | 621 |  | //Override if no avatar, from Buddypress: |
  | 622 |  | if ($override\_avatar) |
  | 623 |  | { |
  | 624 |  | //Read the avatar |
  | 625 |  | $user\_meta\_thumbnail = get\_user\_meta ($user\_id, 'oa\_social\_login\_user\_thumbnail', true); |
  | 626 |  | $user\_meta\_picture = get\_user\_meta ($user\_id, 'oa\_social\_login\_user\_picture', true); |
  | 627 |  |  |
  | 628 |  | //Use the picture if possible |
  | 629 |  | if ($oa\_social\_login\_avatars == 2) |
  | 630 |  | { |
  | 631 |  | $user\_picture = (!empty ($user\_meta\_picture) ? $user\_meta\_picture : $user\_meta\_thumbnail); |
  | 632 |  | } |
  | 633 |  | //Use the thumbnail if possible |
  | 634 |  | else |
  | 635 |  | { |
  | 636 |  | $user\_picture = (!empty ($user\_meta\_thumbnail) ? $user\_meta\_thumbnail : $user\_meta\_picture); |
  | 637 |  | } |
  | 638 |  |  |
  | 639 |  | //Avatar found? |
  | 640 |  | if ($user\_picture !== false AND strlen (trim ($user\_picture)) > 0) |
  | 641 |  | { |
  | 642 |  | return '<img alt="' . oa\_social\_login\_esc\_attr ($alt) . '" src="' . $user\_picture . '" class="avatar avatar-social-login avatar-' . $size . ' photo" height="' . $size . '" width="' . $size . '" />'; |
  | 643 |  | } |
  | 644 |  | } |
  | 645 |  | } |
  | 646 |  | } |
  | 647 |  |  |
  | 648 |  | //Default |
  | 649 |  | return $avatar; |
  |  | 583 | //The social login settings |
  |  | 584 | static $oa\_social\_login\_avatars = null; |
  |  | 585 | if (is\_null ($oa\_social\_login\_avatars)) |
  |  | 586 | { |
  |  | 587 | $oa\_social\_login\_settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 588 | $oa\_social\_login\_avatars = (isset ($oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments']) ? $oa\_social\_login\_settings ['plugin\_show\_avatars\_in\_comments'] : 2); |
  |  | 589 | } |
  |  | 590 |  |
  |  | 591 | //Check if social avatars are enabled |
  |  | 592 | if (!empty ($oa\_social\_login\_avatars)) |
  |  | 593 | { |
  |  | 594 | //Check if we have an user identifier |
  |  | 595 | if (is\_numeric ($mixed) AND $mixed > 0) |
  |  | 596 | { |
  |  | 597 | $user\_id = $mixed; |
  |  | 598 | } |
  |  | 599 | //Check if we have an user email |
  |  | 600 | elseif (is\_string ($mixed) AND ($user = get\_user\_by ('email', $mixed))) |
  |  | 601 | { |
  |  | 602 | $user\_id = $user->ID; |
  |  | 603 | } |
  |  | 604 | //Check if we have an user object |
  |  | 605 | elseif (is\_object ($mixed) AND property\_exists ($mixed, 'user\_id') AND is\_numeric ($mixed->user\_id)) |
  |  | 606 | { |
  |  | 607 | $user\_id = $mixed->user\_id; |
  |  | 608 | } |
  |  | 609 | //None found |
  |  | 610 | else |
  |  | 611 | { |
  |  | 612 | $user\_id = null; |
  |  | 613 | } |
  |  | 614 |  |
  |  | 615 | //User found? |
  |  | 616 | if (!empty ($user\_id)) |
  |  | 617 | { |
  |  | 618 | //Override current avatar ? |
  |  | 619 | $override\_avatar = true; |
  |  | 620 |  |
  |  | 621 | //BuddyPress (Thumbnails in the default WordPress toolbar) |
  |  | 622 | if (oa\_social\_login\_has\_bp\_user\_uploaded\_avatar ($user\_id) === true) |
  |  | 623 | { |
  |  | 624 | // Keep avatar is user has uploaded one |
  |  | 625 | $override\_avatar = false; |
  |  | 626 | } |
  |  | 627 |  |
  |  | 628 | //Override if no avatar, from Buddypress: |
  |  | 629 | if ($override\_avatar) |
  |  | 630 | { |
  |  | 631 | //Read the avatar |
  |  | 632 | $user\_meta\_thumbnail = get\_user\_meta ($user\_id, 'oa\_social\_login\_user\_thumbnail', true); |
  |  | 633 | $user\_meta\_picture = get\_user\_meta ($user\_id, 'oa\_social\_login\_user\_picture', true); |
  |  | 634 |  |
  |  | 635 | //Use the picture if possible |
  |  | 636 | if ($oa\_social\_login\_avatars == 2) |
  |  | 637 | { |
  |  | 638 | $user\_picture = (!empty ($user\_meta\_picture) ? $user\_meta\_picture : $user\_meta\_thumbnail); |
  |  | 639 | } |
  |  | 640 | //Use the thumbnail if possible |
  |  | 641 | else |
  |  | 642 | { |
  |  | 643 | $user\_picture = (!empty ($user\_meta\_thumbnail) ? $user\_meta\_thumbnail : $user\_meta\_picture); |
  |  | 644 | } |
  |  | 645 |  |
  |  | 646 | //Avatar found? |
  |  | 647 | if ($user\_picture !== false AND strlen (trim ($user\_picture)) > 0) |
  |  | 648 | { |
  |  | 649 | return '<img alt="' . oa\_social\_login\_esc\_attr ($alt) . '" src="' . $user\_picture . '" class="avatar avatar-social-login avatar-' . $size . ' photo" height="' . $size . '" width="' . $size . '" />'; |
  |  | 650 | } |
  |  | 651 | } |
  |  | 652 | } |
  |  | 653 | } |
  |  | 654 |  |
  |  | 655 | //Default |
  |  | 656 | return $avatar; |
  | 650 | 657 | } |
  | 651 | 658 | add\_filter ('get\_avatar', 'oa\_social\_login\_custom\_avatar', 10, 5); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L657) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L664) |  |
  | 657 | 664 | function oa\_social\_login\_filter\_comment\_form\_defaults ($default\_fields) |
  | 658 | 665 | { |
  | 659 |  | //No need to go further if comments disabled or user loggedin |
  | 660 |  | if (is\_array ($default\_fields) AND comments\_open () AND !is\_user\_logged\_in ()) |
  | 661 |  | { |
  | 662 |  | //Read settings |
  | 663 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 664 |  |  |
  | 665 |  | //Display buttons if option not set or disabled |
  | 666 |  | if (!empty ($settings ['plugin\_comment\_show\_if\_members\_only'])) |
  | 667 |  | { |
  | 668 |  | if (!isset ($default\_fields ['must\_log\_in'])) |
  | 669 |  | { |
  | 670 |  | $default\_fields ['must\_log\_in'] = ''; |
  | 671 |  | } |
  | 672 |  | $default\_fields ['must\_log\_in'] .= oa\_social\_login\_render\_login\_form ('comments'); |
  | 673 |  | } |
  | 674 |  | } |
  | 675 |  | return $default\_fields; |
  |  | 666 | //No need to go further if comments disabled or user loggedin |
  |  | 667 | if (is\_array ($default\_fields) AND comments\_open () AND !is\_user\_logged\_in ()) |
  |  | 668 | { |
  |  | 669 | //Read settings |
  |  | 670 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 671 |  |
  |  | 672 | //Display buttons if option not set or disabled |
  |  | 673 | if (!empty ($settings ['plugin\_comment\_show\_if\_members\_only'])) |
  |  | 674 | { |
  |  | 675 | if (!isset ($default\_fields ['must\_log\_in'])) |
  |  | 676 | { |
  |  | 677 | $default\_fields ['must\_log\_in'] = ''; |
  |  | 678 | } |
  |  | 679 | $default\_fields ['must\_log\_in'] .= oa\_social\_login\_render\_login\_form ('comments'); |
  |  | 680 | } |
  |  | 681 | } |
  |  | 682 | return $default\_fields; |
  | 676 | 683 | } |
  | 677 | 684 | add\_filter ('comment\_form\_defaults', 'oa\_social\_login\_filter\_comment\_form\_defaults'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L683) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L690) |  |
  | 683 | 690 | function oa\_social\_login\_render\_login\_form\_comments () |
  | 684 | 691 | { |
  | 685 |  | //Comments are open and the user is not logged in |
  | 686 |  | if (comments\_open () && !is\_user\_logged\_in ()) |
  | 687 |  | { |
  | 688 |  | //Read settings |
  | 689 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 690 |  |  |
  | 691 |  | //Display buttons if option not set or not disabled |
  | 692 |  | if (!isset ($settings ['plugin\_comment\_show']) OR !empty ($settings ['plugin\_comment\_show'])) |
  | 693 |  | { |
  | 694 |  | echo oa\_social\_login\_render\_login\_form ('comments'); |
  | 695 |  | } |
  | 696 |  | } |
  |  | 692 | //Comments are open and the user is not logged in |
  |  | 693 | if (comments\_open () && !is\_user\_logged\_in ()) |
  |  | 694 | { |
  |  | 695 | //Read settings |
  |  | 696 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 697 |  |
  |  | 698 | //Display buttons if option not set or not disabled |
  |  | 699 | if (!isset ($settings ['plugin\_comment\_show']) OR !empty ($settings ['plugin\_comment\_show'])) |
  |  | 700 | { |
  |  | 701 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 702 | echo oa\_social\_login\_render\_login\_form ('comments'); |
  |  | 703 | } |
  |  | 704 | } |
  | 697 | 705 | } |
  | 698 | 706 | //WordPress Comments |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L708) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L716) |  |
  | 708 | 716 | function oa\_social\_login\_render\_login\_form\_registration () |
  | 709 | 717 | { |
  | 710 |  | //Users may register |
  | 711 |  | if (get\_option ('users\_can\_register') === '1') |
  | 712 |  | { |
  | 713 |  | //Read settings |
  | 714 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 715 |  |  |
  | 716 |  | //Display buttons if option not set or enabled |
  | 717 |  | if (!isset ($settings ['plugin\_display\_in\_registration\_form']) OR !empty ($settings ['plugin\_display\_in\_registration\_form'])) |
  | 718 |  | { |
  | 719 |  | echo oa\_social\_login\_render\_login\_form ('registration'); |
  | 720 |  | } |
  | 721 |  | } |
  |  | 718 | //Users may register |
  |  | 719 | if (get\_option ('users\_can\_register') === '1') |
  |  | 720 | { |
  |  | 721 | //Read settings |
  |  | 722 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 723 |  |
  |  | 724 | //Display buttons if option not set or enabled |
  |  | 725 | if (!isset ($settings ['plugin\_display\_in\_registration\_form']) OR !empty ($settings ['plugin\_display\_in\_registration\_form'])) |
  |  | 726 | { |
  |  | 727 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 728 | echo oa\_social\_login\_render\_login\_form ('registration'); |
  |  | 729 | } |
  |  | 730 | } |
  | 722 | 731 | } |
  | 723 | 732 |  |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L740) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L749) |  |
  | 740 | 749 | function oa\_social\_login\_render\_login\_form\_login () |
  | 741 | 750 | { |
  | 742 |  | //Read settings |
  | 743 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 744 |  |  |
  | 745 |  | //Display buttons only if option not set or enabled |
  | 746 |  | if (!isset ($settings ['plugin\_display\_in\_login\_form']) OR $settings ['plugin\_display\_in\_login\_form'] == '1') |
  | 747 |  | { |
  | 748 |  | echo oa\_social\_login\_render\_login\_form ('login'); |
  | 749 |  | } |
  |  | 751 | //Read settings |
  |  | 752 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 753 |  |
  |  | 754 | //Display buttons only if option not set or enabled |
  |  | 755 | if (!isset ($settings ['plugin\_display\_in\_login\_form']) OR $settings ['plugin\_display\_in\_login\_form'] == '1') |
  |  | 756 | { |
  |  | 757 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 758 | echo oa\_social\_login\_render\_login\_form ('login'); |
  |  | 759 | } |
  | 750 | 760 | } |
  | 751 | 761 |  |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L771) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L781) |  |
  | 771 | 781 | function oa\_social\_login\_render\_login\_form\_wp\_login () |
  | 772 | 782 | { |
  | 773 |  | //Read settings |
  | 774 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 775 |  |  |
  | 776 |  | //Display buttons only if option not set or enabled |
  | 777 |  | if (!isset ($settings ['plugin\_display\_in\_login\_form']) OR !empty ($settings ['plugin\_display\_in\_login\_form'])) |
  | 778 |  | { |
  | 779 |  | //Additional arguments for the login icons |
  | 780 |  | $args = array (); |
  | 781 |  |  |
  | 782 |  | //Only on the login page |
  | 783 |  | if (strpos (oa\_social\_login\_get\_current\_url (), 'wp-login.php') !== false) |
  | 784 |  | { |
  | 785 |  | //This is the default WordPress login url |
  | 786 |  | $args ['callback\_uri'] = site\_url ('wp-login.php', 'login\_post'); |
  | 787 |  |  |
  | 788 |  | //Add our query argument |
  | 789 |  | $args ['callback\_uri'] = add\_query\_arg (array ('oa\_social\_login\_source' => 'login'), $args ['callback\_uri']); |
  | 790 |  |  |
  | 791 |  | //Add redirect\_to |
  | 792 |  | if ( ! empty ($\_REQUEST['redirect\_to'])) |
  | 793 |  | { |
  | 794 |  | $args ['callback\_uri'] = add\_query\_arg (array ('redirect\_to' => urlencode ($\_REQUEST['redirect\_to'])), $args ['callback\_uri']); |
  | 795 |  | } |
  | 796 |  |  |
  | 797 |  | //Hook to customize the callback uri |
  | 798 |  | $args ['callback\_uri'] = apply\_filters ('oa\_social\_login\_filter\_wp\_login\_callback\_uri', $args ['callback\_uri']); |
  | 799 |  | } |
  | 800 |  |  |
  | 801 |  | //Include it as parameter |
  | 802 |  | echo oa\_social\_login\_render\_login\_form ('login', $args); |
  | 803 |  | } |
  |  | 783 | //Read settings |
  |  | 784 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 785 |  |
  |  | 786 | //Display buttons only if option not set or enabled |
  |  | 787 | if (!isset ($settings ['plugin\_display\_in\_login\_form']) OR !empty ($settings ['plugin\_display\_in\_login\_form'])) |
  |  | 788 | { |
  |  | 789 | //Additional arguments for the login icons |
  |  | 790 | $args = array (); |
  |  | 791 |  |
  |  | 792 | //Only on the login page |
  |  | 793 | if (strpos (oa\_social\_login\_get\_current\_url (), 'wp-login.php') !== false) |
  |  | 794 | { |
  |  | 795 | //This is the default WordPress login url |
  |  | 796 | $args ['callback\_uri'] = site\_url ('wp-login.php', 'login\_post'); |
  |  | 797 |  |
  |  | 798 | //Add our query argument |
  |  | 799 | $args ['callback\_uri'] = add\_query\_arg (array ('oa\_social\_login\_source' => 'login'), $args ['callback\_uri']); |
  |  | 800 |  |
  |  | 801 | //Add redirect\_to |
  |  | 802 | if ( ! empty ($\_REQUEST['redirect\_to'])) |
  |  | 803 | { |
  |  | 804 | $args ['callback\_uri'] = add\_query\_arg (array ('redirect\_to' => urlencode ($\_REQUEST['redirect\_to'])), $args ['callback\_uri']); |
  |  | 805 | } |
  |  | 806 |  |
  |  | 807 | //Hook to customize the callback uri |
  |  | 808 | $args ['callback\_uri'] = apply\_filters ('oa\_social\_login\_filter\_wp\_login\_callback\_uri', $args ['callback\_uri']); |
  |  | 809 | } |
  |  | 810 |  |
  |  | 811 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 812 | echo oa\_social\_login\_render\_login\_form ('login', $args); |
  |  | 813 | } |
  | 804 | 814 | } |
  | 805 | 815 | //WordPress Login Form |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L812) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L822) |  |
  | 812 | 822 | function oa\_social\_login\_render\_login\_form\_wp\_registration () |
  | 813 | 823 | { |
  | 814 |  | //Users may register |
  | 815 |  | if (get\_option ('users\_can\_register') === '1') |
  | 816 |  | { |
  | 817 |  | //Read settings |
  | 818 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 819 |  |  |
  | 820 |  | //Display buttons if option not set or enabled |
  | 821 |  | if (!isset ($settings ['plugin\_display\_in\_registration\_form']) OR !empty ($settings ['plugin\_display\_in\_registration\_form'])) |
  | 822 |  | { |
  | 823 |  | // Bugfix for Social Login being displayed twice on the WooCommerce Registration Form |
  | 824 |  | if ( ! did\_action ('woocommerce\_register\_form')) |
  | 825 |  | { |
  | 826 |  | //Additional arguments for the icon builder |
  | 827 |  | $args = array (); |
  | 828 |  |  |
  | 829 |  | //Only on the registration page |
  | 830 |  | if (strpos (oa\_social\_login\_get\_current\_url (), 'wp-login.php') !== false) |
  | 831 |  | { |
  | 832 |  | //This is the default WordPress registration url |
  | 833 |  | $args ['callback\_uri'] = site\_url ('wp-login.php?action=register', 'login\_post'); |
  | 834 |  |  |
  | 835 |  | //Add our query argument |
  | 836 |  | $args ['callback\_uri'] = add\_query\_arg (array ('oa\_social\_login\_source' => 'registration'), $args ['callback\_uri']); |
  | 837 |  |  |
  | 838 |  | //Add redirect\_to |
  | 839 |  | if ( ! empty ($\_REQUEST['redirect\_to'])) |
  | 840 |  | { |
  | 841 |  | $args ['callback\_uri'] = add\_query\_arg (array ('redirect\_to' => urlencode ($\_REQUEST['redirect\_to'])), $args ['callback\_uri']); |
  | 842 |  | } |
  | 843 |  |  |
  | 844 |  | //Hook to customize the callback uri |
  | 845 |  | $args ['callback\_uri'] = apply\_filters ('oa\_social\_login\_filter\_wp\_registration\_callback\_uri', $args ['callback\_uri']); |
  | 846 |  | } |
  | 847 |  |  |
  | 848 |  | echo oa\_social\_login\_render\_login\_form ('registration', $args); |
  | 849 |  | } |
  | 850 |  | } |
  | 851 |  | } |
  |  | 824 | //Users may register |
  |  | 825 | if (get\_option ('users\_can\_register') === '1') |
  |  | 826 | { |
  |  | 827 | //Read settings |
  |  | 828 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 829 |  |
  |  | 830 | //Display buttons if option not set or enabled |
  |  | 831 | if (!isset ($settings ['plugin\_display\_in\_registration\_form']) OR !empty ($settings ['plugin\_display\_in\_registration\_form'])) |
  |  | 832 | { |
  |  | 833 | // Bugfix for Social Login being displayed twice on the WooCommerce Registration Form |
  |  | 834 | if ( ! did\_action ('woocommerce\_register\_form')) |
  |  | 835 | { |
  |  | 836 | //Additional arguments for the icon builder |
  |  | 837 | $args = array (); |
  |  | 838 |  |
  |  | 839 | //Only on the registration page |
  |  | 840 | if (strpos (oa\_social\_login\_get\_current\_url (), 'wp-login.php') !== false) |
  |  | 841 | { |
  |  | 842 | //This is the default WordPress registration url |
  |  | 843 | $args ['callback\_uri'] = site\_url ('wp-login.php?action=register', 'login\_post'); |
  |  | 844 |  |
  |  | 845 | //Add our query argument |
  |  | 846 | $args ['callback\_uri'] = add\_query\_arg (array ('oa\_social\_login\_source' => 'registration'), $args ['callback\_uri']); |
  |  | 847 |  |
  |  | 848 | //Add redirect\_to |
  |  | 849 | if ( ! empty ($\_REQUEST['redirect\_to'])) |
  |  | 850 | { |
  |  | 851 | $args ['callback\_uri'] = add\_query\_arg (array ('redirect\_to' => urlencode ($\_REQUEST['redirect\_to'])), $args ['callback\_uri']); |
  |  | 852 | } |
  |  | 853 |  |
  |  | 854 | //Hook to customize the callback uri |
  |  | 855 | $args ['callback\_uri'] = apply\_filters ('oa\_social\_login\_filter\_wp\_registration\_callback\_uri', $args ['callback\_uri']); |
  |  | 856 | } |
  |  | 857 |  |
  |  | 858 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 859 | echo oa\_social\_login\_render\_login\_form ('registration', $args); |
  |  | 860 | } |
  |  | 861 | } |
  |  | 862 | } |
  | 852 | 863 | } |
  | 853 | 864 | //WordPress Registration Form |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L860) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L871) |  |
  | 860 | 871 | function oa\_social\_login\_render\_custom\_form\_login () |
  | 861 | 872 | { |
  | 862 |  | if (!is\_user\_logged\_in ()) |
  | 863 |  | { |
  | 864 |  | echo oa\_social\_login\_render\_login\_form ('custom'); |
  | 865 |  | } |
  |  | 873 | if (!is\_user\_logged\_in ()) |
  |  | 874 | { |
  |  | 875 | // phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped |
  |  | 876 | echo oa\_social\_login\_render\_login\_form ('custom'); |
  |  | 877 | } |
  | 866 | 878 | } |
  | 867 | 879 | add\_action ('oa\_social\_login', 'oa\_social\_login\_render\_custom\_form\_login'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L874) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L886) |  |
  | 874 | 886 | function oa\_social\_login\_filter\_login\_form\_custom ($value = 'custom') |
  | 875 | 887 | { |
  | 876 |  | return (is\_user\_logged\_in () ? '' : oa\_social\_login\_render\_login\_form ($value)); |
  |  | 888 | return (is\_user\_logged\_in () ? '' : oa\_social\_login\_render\_login\_form ($value)); |
  | 877 | 889 | } |
  | 878 | 890 | add\_filter ('oa\_social\_login\_custom', 'oa\_social\_login\_filter\_login\_form\_custom'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L884) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L896) |  |
  | 884 | 896 | function oa\_social\_login\_render\_login\_form ($source, $args = array ()) |
  | 885 | 897 | { |
  | 886 |  | //Import providers |
  | 887 |  | GLOBAL $oa\_social\_login\_providers; |
  | 888 |  |  |
  | 889 |  | //Parse args |
  | 890 |  | $args = (is\_array ($args) ? $args : array ()); |
  | 891 |  |  |
  | 892 |  | //Container for returned value |
  | 893 |  | $output = ''; |
  | 894 |  |  |
  | 895 |  | //Read settings |
  | 896 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 897 |  |  |
  | 898 |  | //API Subdomain |
  | 899 |  | $api\_subdomain = (!empty ($settings ['api\_subdomain']) ? $settings ['api\_subdomain'] : ''); |
  | 900 |  |  |
  | 901 |  | //API Subdomain Required |
  | 902 |  | if (!empty ($api\_subdomain)) |
  | 903 |  | { |
  | 904 |  | //Build providers |
  | 905 |  | $providers = array (); |
  | 906 |  | if (is\_array ($settings ['providers'])) |
  | 907 |  | { |
  | 908 |  | foreach ($settings ['providers'] AS $settings\_provider\_key => $settings\_provider\_name) |
  | 909 |  | { |
  | 910 |  | if (isset ($oa\_social\_login\_providers [$settings\_provider\_key])) |
  | 911 |  | { |
  | 912 |  | $providers [] = $settings\_provider\_key; |
  | 913 |  | } |
  | 914 |  | } |
  | 915 |  | } |
  | 916 |  |  |
  | 917 |  | //Widget |
  | 918 |  | if ($source == 'widget') |
  | 919 |  | { |
  | 920 |  | //Read widget settings |
  | 921 |  | $widget\_settings = (is\_array ($args) ? $args : array ()); |
  | 922 |  |  |
  | 923 |  | //Don't show the title - this is handled insided the widget |
  | 924 |  | $plugin\_caption = ''; |
  | 925 |  |  |
  | 926 |  | //Button Theme |
  | 927 |  | $theme\_id = (array\_key\_exists ('widget\_icon\_theme', $widget\_settings) ? $widget\_settings['widget\_icon\_theme'] : null); |
  | 928 |  |  |
  | 929 |  | // Grab theme URI |
  | 930 |  | $css\_theme\_uri = oa\_social\_login\_get\_theme\_css\_url ($theme\_id); |
  | 931 |  |  |
  | 932 |  | // Apply filters |
  | 933 |  | $css\_theme\_uri = apply\_filters ('oa\_social\_login\_widget\_css', $css\_theme\_uri); |
  | 934 |  | } |
  | 935 |  | //Other places |
  | 936 |  | else |
  | 937 |  | { |
  | 938 |  | //Show title if set |
  | 939 |  | $plugin\_caption = (!empty ($settings ['plugin\_caption']) ? $settings ['plugin\_caption'] : ''); |
  | 940 |  |  |
  | 941 |  | //Button Theme |
  | 942 |  | $theme\_id = (array\_key\_exists ('plugin\_icon\_theme', $settings) ? $settings['plugin\_icon\_theme'] : null); |
  | 943 |  |  |
  | 944 |  | // Grab theme URI |
  | 945 |  | $css\_theme\_uri = oa\_social\_login\_get\_theme\_css\_url ($theme\_id); |
  | 946 |  |  |
  | 947 |  | // Apply filters |
  | 948 |  | $css\_theme\_uri = apply\_filters ('oa\_social\_login\_default\_css', $css\_theme\_uri); |
  | 949 |  | } |
  | 950 |  |  |
  | 951 |  | //Build Callback URI |
  | 952 |  | if (array\_key\_exists ('callback\_uri', $args) AND !empty ($args ['callback\_uri'])) |
  | 953 |  | { |
  | 954 |  | $callback\_uri = "'" . $args ['callback\_uri'] . "'"; |
  | 955 |  | } |
  | 956 |  | else |
  | 957 |  | { |
  | 958 |  | $callback\_uri = "(window.location.href + ((window.location.href.split('?')[1] ? '&amp;': '?') + \"oa\_social\_login\_source=" . $source . "\"))"; |
  | 959 |  | } |
  | 960 |  |  |
  | 961 |  | // Filter for callback uri |
  | 962 |  | $callback\_uri = apply\_filters ('oa\_social\_login\_filter\_callback\_uri', $callback\_uri, $source); |
  | 963 |  |  |
  | 964 |  | //No providers selected |
  | 965 |  | if (count ($providers) == 0) |
  | 966 |  | { |
  | 967 |  | $output = '<div style="color:white;background-color:red;">[Social Login] ' . \_\_ ('Please enable at least one social network!', 'oa-social-login') . '</div>'; |
  | 968 |  | } |
  | 969 |  | //Providers selected |
  | 970 |  | else |
  | 971 |  | { |
  | 972 |  |  |
  | 973 |  | //Setup output |
  | 974 |  | $output = array (); |
  | 975 |  | $output [] = " <!-- OneAll.com / Social Login for WordPress / v" . constant ('OA\_SOCIAL\_LOGIN\_VERSION') . " -->"; |
  | 976 |  | $output [] = '<div class="oneall\_social\_login">'; |
  | 977 |  |  |
  | 978 |  | //Add the caption? |
  | 979 |  | if (!empty ($plugin\_caption)) |
  | 980 |  | { |
  | 981 |  | ~~$output [] = ' <div class="oneall\_social\_login\_label" style="margin-bottom: 3px;"><label>' . \_\_ ($plugin\_caption)~~ . '</label></div>'; |
  | 982 |  | } |
  | 983 |  |  |
  | 984 |  | //Add the Plugin |
  | 985 |  | ~~$containerid = 'oneall\_social\_login\_providers\_' . mt~~\_rand (99999, 9999999); |
  | 986 |  | $output [] = ' <div class="oneall\_social\_login\_providers" id="' . $containerid . '"></div>'; |
  | 987 |  | $output [] = ' <script data-cfasync="false" type="text/javascript">'; |
  | 988 |  |  |
  | 989 |  | //Synchronous JavaScript: This is the default to stay compatible with existing installations. |
  | 990 |  | if (empty ($settings ['asynchronous\_javascript'])) |
  | 991 |  | { |
  | 992 |  | $output [] = "  oneall.api.plugins.social\_login.build('" . $containerid . "', {"; |
  | 993 |  | $output [] = "   'providers': ['" . implode ("','", $providers) . "'], "; |
  | 994 |  | $output [] = "   'callback\_uri': " . $callback\_uri . ", "; |
  | 995 |  | $output [] = "   'css\_theme\_uri': '" . $css\_theme\_uri . "' "; |
  | 996 |  | $output [] = "  });"; |
  | 997 |  | } |
  | 998 |  | //Asynchronous JavaScript. |
  | 999 |  | else |
  | 1000 |  | { |
  | 1001 |  | //JavaScript Method Reference: http://docs.oneall.com/api/javascript/library/methods/ |
  | 1002 |  | $output [] = "  var \_oneall = \_oneall || [];"; |
  | 1003 |  | $output [] = "  \_oneall.push(['social\_login', 'set\_providers', ['" . implode ("','", $providers) . "']]);"; |
  | 1004 |  | $output [] = "  \_oneall.push(['social\_login', 'set\_callback\_uri', " . $callback\_uri . "]);"; |
  | 1005 |  | $output [] = "  \_oneall.push(['social\_login', 'set\_custom\_css\_uri', '" . $css\_theme\_uri . "']);"; |
  | 1006 |  | $output [] = "  \_oneall.push(['social\_login', 'do\_render\_ui', '" . $containerid . "']);"; |
  | 1007 |  | } |
  | 1008 |  |  |
  | 1009 |  | $output [] = " </script>"; |
  | 1010 |  | $output [] = '</div>'; |
  | 1011 |  |  |
  | 1012 |  | //Done |
  | 1013 |  | $output = implode ("\n", $output); |
  | 1014 |  | } |
  | 1015 |  |  |
  | 1016 |  | //Return a string and let the calling function do the actual outputting |
  | 1017 |  | return $output; |
  | 1018 |  | } |
  |  | 898 | //Import providers |
  |  | 899 | GLOBAL $oa\_social\_login\_providers; |
  |  | 900 |  |
  |  | 901 | //Parse args |
  |  | 902 | $args = (is\_array ($args) ? $args : array ()); |
  |  | 903 |  |
  |  | 904 | //Container for returned value |
  |  | 905 | $output = ''; |
  |  | 906 |  |
  |  | 907 | //Read settings |
  |  | 908 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 909 |  |
  |  | 910 | //API Subdomain |
  |  | 911 | $api\_subdomain = (!empty ($settings ['api\_subdomain']) ? $settings ['api\_subdomain'] : ''); |
  |  | 912 |  |
  |  | 913 | //API Subdomain Required |
  |  | 914 | if (!empty ($api\_subdomain)) |
  |  | 915 | { |
  |  | 916 | //Build providers |
  |  | 917 | $providers = array (); |
  |  | 918 | if (is\_array ($settings ['providers'])) |
  |  | 919 | { |
  |  | 920 | foreach ($settings ['providers'] AS $settings\_provider\_key => $settings\_provider\_name) |
  |  | 921 | { |
  |  | 922 | if (isset ($oa\_social\_login\_providers [$settings\_provider\_key])) |
  |  | 923 | { |
  |  | 924 | $providers [] = $settings\_provider\_key; |
  |  | 925 | } |
  |  | 926 | } |
  |  | 927 | } |
  |  | 928 |  |
  |  | 929 | //Widget |
  |  | 930 | if ($source == 'widget') |
  |  | 931 | { |
  |  | 932 | //Read widget settings |
  |  | 933 | $widget\_settings = (is\_array ($args) ? $args : array ()); |
  |  | 934 |  |
  |  | 935 | //Don't show the title - this is handled insided the widget |
  |  | 936 | $plugin\_caption = ''; |
  |  | 937 |  |
  |  | 938 | //Button Theme |
  |  | 939 | $theme\_id = (array\_key\_exists ('widget\_icon\_theme', $widget\_settings) ? $widget\_settings['widget\_icon\_theme'] : null); |
  |  | 940 |  |
  |  | 941 | // Grab theme URI |
  |  | 942 | $css\_theme\_uri = oa\_social\_login\_get\_theme\_css\_url ($theme\_id); |
  |  | 943 |  |
  |  | 944 | // Apply filters |
  |  | 945 | $css\_theme\_uri = apply\_filters ('oa\_social\_login\_widget\_css', $css\_theme\_uri); |
  |  | 946 | } |
  |  | 947 | //Other places |
  |  | 948 | else |
  |  | 949 | { |
  |  | 950 | //Show title if set |
  |  | 951 | $plugin\_caption = (!empty ($settings ['plugin\_caption']) ? $settings ['plugin\_caption'] : ''); |
  |  | 952 |  |
  |  | 953 | //Button Theme |
  |  | 954 | $theme\_id = (array\_key\_exists ('plugin\_icon\_theme', $settings) ? $settings['plugin\_icon\_theme'] : null); |
  |  | 955 |  |
  |  | 956 | // Grab theme URI |
  |  | 957 | $css\_theme\_uri = oa\_social\_login\_get\_theme\_css\_url ($theme\_id); |
  |  | 958 |  |
  |  | 959 | // Apply filters |
  |  | 960 | $css\_theme\_uri = apply\_filters ('oa\_social\_login\_default\_css', $css\_theme\_uri); |
  |  | 961 | } |
  |  | 962 |  |
  |  | 963 | //Build Callback URI |
  |  | 964 | if (array\_key\_exists ('callback\_uri', $args) AND !empty ($args ['callback\_uri'])) |
  |  | 965 | { |
  |  | 966 | $callback\_uri = "'" . $args ['callback\_uri'] . "'"; |
  |  | 967 | } |
  |  | 968 | else |
  |  | 969 | { |
  |  | 970 | $callback\_uri = "(window.location.href + ((window.location.href.split('?')[1] ? '&amp;': '?') + \"oa\_social\_login\_source=" . $source . "\"))"; |
  |  | 971 | } |
  |  | 972 |  |
  |  | 973 | // Filter for callback uri |
  |  | 974 | $callback\_uri = apply\_filters ('oa\_social\_login\_filter\_callback\_uri', $callback\_uri, $source); |
  |  | 975 |  |
  |  | 976 | //No providers selected |
  |  | 977 | if (count ($providers) == 0) |
  |  | 978 | { |
  |  | 979 | $output = '<div style="color:white;background-color:red;">[Social Login] ' . \_\_ ('Please enable at least one social network!', 'oa-social-login') . '</div>'; |
  |  | 980 | } |
  |  | 981 | //Providers selected |
  |  | 982 | else |
  |  | 983 | { |
  |  | 984 |  |
  |  | 985 | //Setup output |
  |  | 986 | $output = array (); |
  |  | 987 | $output [] = " <!-- OneAll.com / Social Login for WordPress / v" . constant ('OA\_SOCIAL\_LOGIN\_VERSION') . " -->"; |
  |  | 988 | $output [] = '<div class="oneall\_social\_login">'; |
  |  | 989 |  |
  |  | 990 | //Add the caption? |
  |  | 991 | if (!empty ($plugin\_caption)) |
  |  | 992 | { |
  |  | 993 | $output [] = ' <div class="oneall\_social\_login\_label" style="margin-bottom: 3px;"><label>' . $plugin\_caption . '</label></div>'; |
  |  | 994 | } |
  |  | 995 |  |
  |  | 996 | //Add the Plugin |
  |  | 997 | $containerid = 'oneall\_social\_login\_providers\_' . wp\_rand (99999, 9999999); |
  |  | 998 | $output [] = ' <div class="oneall\_social\_login\_providers" id="' . $containerid . '"></div>'; |
  |  | 999 | $output [] = ' <script data-cfasync="false" type="text/javascript">'; |
  |  | 1000 |  |
  |  | 1001 | //Synchronous JavaScript: This is the default to stay compatible with existing installations. |
  |  | 1002 | if (empty ($settings ['asynchronous\_javascript'])) |
  |  | 1003 | { |
  |  | 1004 | $output [] = "  oneall.api.plugins.social\_login.build('" . $containerid . "', {"; |
  |  | 1005 | $output [] = "   'providers': ['" . implode ("','", $providers) . "'], "; |
  |  | 1006 | $output [] = "   'callback\_uri': " . $callback\_uri . ", "; |
  |  | 1007 | $output [] = "   'css\_theme\_uri': '" . $css\_theme\_uri . "' "; |
  |  | 1008 | $output [] = "  });"; |
  |  | 1009 | } |
  |  | 1010 | //Asynchronous JavaScript. |
  |  | 1011 | else |
  |  | 1012 | { |
  |  | 1013 | //JavaScript Method Reference: http://docs.oneall.com/api/javascript/library/methods/ |
  |  | 1014 | $output [] = "  var \_oneall = \_oneall || [];"; |
  |  | 1015 | $output [] = "  \_oneall.push(['social\_login', 'set\_providers', ['" . implode ("','", $providers) . "']]);"; |
  |  | 1016 | $output [] = "  \_oneall.push(['social\_login', 'set\_callback\_uri', " . $callback\_uri . "]);"; |
  |  | 1017 | $output [] = "  \_oneall.push(['social\_login', 'set\_custom\_css\_uri', '" . $css\_theme\_uri . "']);"; |
  |  | 1018 | $output [] = "  \_oneall.push(['social\_login', 'do\_render\_ui', '" . $containerid . "']);"; |
  |  | 1019 | } |
  |  | 1020 |  |
  |  | 1021 | $output [] = " </script>"; |
  |  | 1022 | $output [] = '</div>'; |
  |  | 1023 |  |
  |  | 1024 | //Done |
  |  | 1025 | $output = implode ("\n", $output); |
  |  | 1026 | } |
  |  | 1027 |  |
  |  | 1028 | //Return a string and let the calling function do the actual outputting |
  |  | 1029 | return $output; |
  |  | 1030 | } |
  | 1019 | 1031 | } |
  | 1020 | 1032 |  |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L1025) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L1037) |  |
  | 1025 | 1037 | function oa\_social\_login\_request\_email () |
  | 1026 | 1038 | { |
  | 1027 |  | //Get the current user |
  | 1028 |  | $current\_user = wp\_get\_current\_user (); |
  | 1029 |  |  |
  | 1030 |  | //Check if logged in |
  | 1031 |  | if (!empty ($current\_user->ID) AND is\_numeric ($current\_user->ID)) |
  | 1032 |  | { |
  | 1033 |  | //Current user |
  | 1034 |  | $user\_id = $current\_user->ID; |
  | 1035 |  |  |
  | 1036 |  | //Check if email has to be requested |
  | 1037 |  | $oa\_social\_login\_request\_email = get\_user\_meta ($user\_id, 'oa\_social\_login\_request\_email', true); |
  | 1038 |  | if (!empty ($oa\_social\_login\_request\_email)) |
  | 1039 |  | { |
  | 1040 |  | //Display modal dialog? |
  | 1041 |  | $display\_modal = true; |
  | 1042 |  |  |
  | 1043 |  | //Messaging |
  | 1044 |  | $message = ''; |
  | 1045 |  |  |
  | 1046 |  | //Read settings |
  | 1047 |  | $settings = get\_option ('oa\_social\_login\_settings'); |
  | 1048 |  |  |
  | 1049 |  | //Make sure that the email is still required |
  | 1050 |  | if (empty ($settings ['plugin\_require\_email'])) |
  | 1051 |  | { |
  | 1052 |  | //Do not display the modal dialog |
  | 1053 |  | $display\_modal = false; |
  | 1054 |  |  |
  | 1055 |  | //Stop asking for the email |
  | 1056 |  | delete\_user\_meta ($user\_id, 'oa\_social\_login\_request\_email'); |
  | 1057 |  | } |
  | 1058 |  |  |
  | 1059 |  | //Form submitted |
  | 1060 |  | if (isset ($\_POST) AND !empty ($\_POST ['oa\_social\_login\_action'])) |
  | 1061 |  | { |
  | 1062 |  | if ($\_POST ['oa\_social\_login\_action'] == 'confirm\_email') |
  | 1063 |  | { |
  | 1064 |  | $user\_email = (empty ($\_POST ['oa\_social\_login\_email']) ? '' : trim ($\_POST ['oa\_social\_login\_email'])); |
  | 1065 |  | $user\_email = apply\_filters ('oa\_social\_login\_filter\_user\_request\_email', $user\_email, $user\_id); |
  | 1066 |  |  |
  | 1067 |  | if (empty ($user\_email)) |
  | 1068 |  | { |
  | 1069 |  | $message = \_\_ ('Please enter your email address', 'oa-social-login'); |
  | 1070 |  | } |
  | 1071 |  | else |
  | 1072 |  | { |
  | 1073 |  | if (!is\_email ($user\_email)) |
  | 1074 |  | { |
  | 1075 |  | $message = \_\_ ('This email is not valid', 'oa-social-login'); |
  | 1076 |  | } |
  | 1077 |  | elseif (email\_exists ($user\_email)) |
  | 1078 |  | { |
  | 1079 |  |  |
  | 1080 |  | $message = \_\_ ('This email is already used by another account', 'oa-social-login'); |
  | 1081 |  | } |
  | 1082 |  | else |
  | 1083 |  | { |
  | 1084 |  | //Read user |
  | 1085 |  | $user\_data = get\_userdata ($user\_id); |
  | 1086 |  | if ($user\_data !== false) |
  | 1087 |  | { |
  | 1088 |  | //Store old email |
  | 1089 |  | $old\_user\_email = $user\_data->user\_email; |
  | 1090 |  |  |
  | 1091 |  | //Update user |
  | 1092 |  | wp\_update\_user (array ('ID' => $user\_data->ID, 'user\_email' => $user\_email)); |
  | 1093 |  | delete\_user\_meta ($user\_data->ID, 'oa\_social\_login\_request\_email'); |
  | 1094 |  |  |
  | 1095 |  | //Set new email for hook |
  | 1096 |  | $user\_data->user\_email = $user\_email; |
  | 1097 |  |  |
  | 1098 |  | //Hook after having updated the email |
  | 1099 |  | do\_action ('oa\_social\_login\_action\_on\_user\_enter\_email', $user\_id, $user\_data, $old\_user\_email); |
  | 1100 |  |  |
  | 1101 |  | //No longer needed |
  | 1102 |  | $display\_modal = false; |
  | 1103 |  | } |
  | 1104 |  | } |
  | 1105 |  | } |
  | 1106 |  | } |
  | 1107 |  | } |
  | 1108 |  |  |
  | 1109 |  | //Display modal dialog? |
  | 1110 |  | if ($display\_modal === true) |
  | 1111 |  | { |
  | 1112 |  | //Read Settings |
  | 1113 |  | $oa\_social\_login\_settings = get\_option ('oa\_social\_login\_settings'); |
  | 1114 |  |  |
  | 1115 |  | //Read the social network |
  | 1116 |  | $oa\_social\_login\_identity\_provider = get\_user\_meta ($user\_id, 'oa\_social\_login\_identity\_provider', true); |
  | 1117 |  |  |
  | 1118 |  | //Caption |
  | 1119 |  | $caption = (isset ($oa\_social\_login\_settings ['plugin\_require\_email\_text']) ? $oa\_social\_login\_settings ['plugin\_require\_email\_text'] : \_\_ ('<strong>We unfortunately could not retrieve your email address from %s.</strong> Please enter your email address in the form below in order to continue.', 'oa-social-login')); |
  | 1120 |  |  |
  | 1121 |  | // Create Nonce |
  | 1122 |  | $oa\_nonce = wp\_create\_nonce ('request\_email\_cancel-'.$user\_id); |
  | 1123 |  |  |
  | 1124 |  | // Compute logout url |
  | 1125 |  | $logout\_url = wp\_logout\_url (oa\_social\_login\_get\_current\_url ()); |
  | 1126 |  | $logout\_url .= ((parse\_url ($logout\_url, PHP\_URL\_QUERY) ? '&' : '?') . 'oa\_action=request\_email\_cancel&oa\_nonce='.$oa\_nonce); |
  | 1127 |  |  |
  | 1128 |  | //Add CSS |
  | 1129 |  | oa\_social\_login\_add\_site\_css (); |
  | 1130 |  |  |
  | 1131 |  | //Show email request form |
  | 1132 |  | ?> |
  | 1133 |  | <div id="oa\_social\_login\_overlay"></div> |
  | 1134 |  | <div id="oa\_social\_login\_modal"> |
  | 1135 |  | <div class="oa\_social\_login\_modal\_outer"> |
  | 1136 |  | <div class="oa\_social\_login\_modal\_inner"> |
  | 1137 |  | <div class="oa\_social\_login\_modal\_title"> |
  | 1138 |  | <?php |
  | 1139 |  | printf (\_\_ ('You have successfully connected with %s!', 'oa-social-login'), '<strong>' . $oa\_social\_login\_identity\_provider . '</strong>'); |
  | 1140 |  | ?> |
  | 1141 |  | </div> |
  | 1142 |  | <?php |
  | 1143 |  | if (strlen (trim ($caption)) > 0) |
  | 1144 |  | { |
  | 1145 |  | ?> |
  | 1146 |  | <div class="oa\_social\_login\_modal\_notice"><?php echo str\_replace ('%s', $oa\_social\_login\_identity\_provider, $caption); ?></div> |
  | 1147 |  | <?php |
  | 1148 |  | } |
  | 1149 |  | ?> |
  | 1150 |  | <div class="oa\_social\_login\_modal\_body"> |
  | 1151 |  | <div class="oa\_social\_login\_modal\_subtitle"> |
  | 1152 |  | <?php \_e ('Please enter your email address', 'oa-social-login'); ?>: |
  | 1153 |  | </div> |
  | 1154 |  | <form method="post" action=""> |
  | 1155 |  | <fieldset> |
  | 1156 |  | <div class="oa\_social\_login\_input"> |
  | 1157 |  | <input type="text" name="oa\_social\_login\_email" class="oa\_social\_login\_confirm\_text" value="<?php echo (!empty ($\_POST ['oa\_social\_login\_email']) ? oa\_social\_login\_esc\_attr ($\_POST ['oa\_social\_login\_email']) : ''); ?>" /> |
  | 1158 |  | <input type="hidden" name="oa\_social\_login\_action" value="confirm\_email" size="30" /> |
  | 1159 |  | </div> |
  | 1160 |  | <div class="oa\_social\_login\_modal\_error"> |
  | 1161 |  | <?php echo $message; ?> |
  | 1162 |  | </div> |
  | 1163 |  | <div class="oa\_social\_login\_buttons"> |
  | 1164 |  | <input class="oa\_social\_login\_button" id="oa\_social\_login\_button\_confirm" name="oa\_social\_login\_confirm\_btn" type="submit" value="<?php \_e ('Confirm', 'oa-social-login'); ?>" /> |
  | 1165 |  | <a href="<?php echo esc\_url ($logout\_url); ?>" class="oa\_social\_login\_button" id="oa\_social\_login\_button\_cancel"><?php \_e ('Cancel', 'oa-social-login'); ?></a> |
  | 1166 |  | </div> |
  | 1167 |  | </fieldset> |
  | 1168 |  | </form> |
  | 1169 |  | </div> |
  | 1170 |  | </div> |
  | 1171 |  | </div> |
  | 1172 |  | </div> |
  | 1173 |  | <?php |
  | 1174 |  | } |
  | 1175 |  | } |
  | 1176 |  | } |
  |  | 1039 | //Get the current user |
  |  | 1040 | $current\_user = wp\_get\_current\_user (); |
  |  | 1041 |  |
  |  | 1042 | //Check if logged in |
  |  | 1043 | if (!empty ($current\_user->ID) AND is\_numeric ($current\_user->ID)) |
  |  | 1044 | { |
  |  | 1045 | //Current user |
  |  | 1046 | $user\_id = $current\_user->ID; |
  |  | 1047 |  |
  |  | 1048 | //Check if email has to be requested |
  |  | 1049 | $oa\_social\_login\_request\_email = get\_user\_meta ($user\_id, 'oa\_social\_login\_request\_email', true); |
  |  | 1050 | if (!empty ($oa\_social\_login\_request\_email)) |
  |  | 1051 | { |
  |  | 1052 | //Display modal dialog? |
  |  | 1053 | $display\_modal = true; |
  |  | 1054 |  |
  |  | 1055 | //Messaging |
  |  | 1056 | $message = ''; |
  |  | 1057 |  |
  |  | 1058 | //Read settings |
  |  | 1059 | $settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 1060 |  |
  |  | 1061 | //Make sure that the email is still required |
  |  | 1062 | if (empty ($settings ['plugin\_require\_email'])) |
  |  | 1063 | { |
  |  | 1064 | //Do not display the modal dialog |
  |  | 1065 | $display\_modal = false; |
  |  | 1066 |  |
  |  | 1067 | //Stop asking for the email |
  |  | 1068 | delete\_user\_meta ($user\_id, 'oa\_social\_login\_request\_email'); |
  |  | 1069 | } |
  |  | 1070 |  |
  |  | 1071 | //Form submitted |
  |  | 1072 | if (isset ($\_POST) AND !empty ($\_POST ['oa\_social\_login\_action'])) |
  |  | 1073 | { |
  |  | 1074 | if ($\_POST ['oa\_social\_login\_action'] == 'confirm\_email') |
  |  | 1075 | { |
  |  | 1076 | $user\_email = (empty ($\_POST ['oa\_social\_login\_email']) ? '' : trim ($\_POST ['oa\_social\_login\_email'])); |
  |  | 1077 | $user\_email = apply\_filters ('oa\_social\_login\_filter\_user\_request\_email', $user\_email, $user\_id); |
  |  | 1078 |  |
  |  | 1079 | if (empty ($user\_email)) |
  |  | 1080 | { |
  |  | 1081 | $message = \_\_ ('Please enter your email address', 'oa-social-login'); |
  |  | 1082 | } |
  |  | 1083 | else |
  |  | 1084 | { |
  |  | 1085 | if (!is\_email ($user\_email)) |
  |  | 1086 | { |
  |  | 1087 | $message = \_\_ ('This email is not valid', 'oa-social-login'); |
  |  | 1088 | } |
  |  | 1089 | elseif (email\_exists ($user\_email)) |
  |  | 1090 | { |
  |  | 1091 |  |
  |  | 1092 | $message = \_\_ ('This email is already used by another account', 'oa-social-login'); |
  |  | 1093 | } |
  |  | 1094 | else |
  |  | 1095 | { |
  |  | 1096 | //Read user |
  |  | 1097 | $user\_data = get\_userdata ($user\_id); |
  |  | 1098 | if ($user\_data !== false) |
  |  | 1099 | { |
  |  | 1100 | //Store old email |
  |  | 1101 | $old\_user\_email = $user\_data->user\_email; |
  |  | 1102 |  |
  |  | 1103 | //Update user |
  |  | 1104 | wp\_update\_user (array ('ID' => $user\_data->ID, 'user\_email' => $user\_email)); |
  |  | 1105 | delete\_user\_meta ($user\_data->ID, 'oa\_social\_login\_request\_email'); |
  |  | 1106 |  |
  |  | 1107 | //Set new email for hook |
  |  | 1108 | $user\_data->user\_email = $user\_email; |
  |  | 1109 |  |
  |  | 1110 | //Hook after having updated the email |
  |  | 1111 | do\_action ('oa\_social\_login\_action\_on\_user\_enter\_email', $user\_id, $user\_data, $old\_user\_email); |
  |  | 1112 |  |
  |  | 1113 | //No longer needed |
  |  | 1114 | $display\_modal = false; |
  |  | 1115 | } |
  |  | 1116 | } |
  |  | 1117 | } |
  |  | 1118 | } |
  |  | 1119 | } |
  |  | 1120 |  |
  |  | 1121 | //Display modal dialog? |
  |  | 1122 | if ($display\_modal === true) |
  |  | 1123 | { |
  |  | 1124 | //Read Settings |
  |  | 1125 | $oa\_social\_login\_settings = get\_option ('oa\_social\_login\_settings'); |
  |  | 1126 |  |
  |  | 1127 | //Read the social network |
  |  | 1128 | $oa\_social\_login\_identity\_provider = get\_user\_meta ($user\_id, 'oa\_social\_login\_identity\_provider', true); |
  |  | 1129 |  |
  |  | 1130 | /\* translators: %s: provider name \*/ |
  |  | 1131 | $caption = (isset ($oa\_social\_login\_settings ['plugin\_require\_email\_text']) ? $oa\_social\_login\_settings ['plugin\_require\_email\_text'] : \_\_ ('<strong>We unfortunately could not retrieve your email address from %s.</strong> Please enter your email address in the form below in order to continue.', 'oa-social-login')); |
  |  | 1132 |  |
  |  | 1133 | // Create Nonce |
  |  | 1134 | $oa\_nonce = wp\_create\_nonce ('request\_email\_cancel-'.$user\_id); |
  |  | 1135 |  |
  |  | 1136 | // Compute logout url |
  |  | 1137 | $logout\_url = wp\_logout\_url (oa\_social\_login\_get\_current\_url ()); |
  |  | 1138 | $logout\_url .= ((parse\_url ($logout\_url, PHP\_URL\_QUERY) ? '&' : '?') . 'oa\_action=request\_email\_cancel&oa\_nonce='.$oa\_nonce); |
  |  | 1139 |  |
  |  | 1140 | //Add CSS |
  |  | 1141 | oa\_social\_login\_add\_site\_css (); |
  |  | 1142 |  |
  |  | 1143 | //Show email request form |
  |  | 1144 | ?> |
  |  | 1145 | <div id="oa\_social\_login\_overlay"></div> |
  |  | 1146 | <div id="oa\_social\_login\_modal"> |
  |  | 1147 | <div class="oa\_social\_login\_modal\_outer"> |
  |  | 1148 | <div class="oa\_social\_login\_modal\_inner"> |
  |  | 1149 | <div class="oa\_social\_login\_modal\_title"> |
  |  | 1150 | <?php |
  |  | 1151 | /\* translators: %s: provider name \*/ |
  |  | 1152 | $message = sprintf (\_\_ ('You have successfully connected with %s!', 'oa-social-login'), '<strong>' . $oa\_social\_login\_identity\_provider . '</strong>'); |
  |  | 1153 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1154 | echo $message; |
  |  | 1155 | ?> |
  |  | 1156 | </div> |
  |  | 1157 | <?php |
  |  | 1158 | if (strlen (trim ($caption)) > 0) |
  |  | 1159 | { |
  |  | 1160 | ?> |
  |  | 1161 | <div class="oa\_social\_login\_modal\_notice"> |
  |  | 1162 | <?php |
  |  | 1163 | /\* translators: %s: provider name \*/ |
  |  | 1164 | $message = str\_replace ('%s', $oa\_social\_login\_identity\_provider, $caption); |
  |  | 1165 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 1166 | echo $message; |
  |  | 1167 | ?> |
  |  | 1168 | </div> |
  |  | 1169 | <?php |
  |  | 1170 | } |
  |  | 1171 | ?> |
  |  | 1172 | <div class="oa\_social\_login\_modal\_body"> |
  |  | 1173 | <div class="oa\_social\_login\_modal\_subtitle"> |
  |  | 1174 | <?php \_esc\_attr\_e ('Please enter your email address', 'oa-social-login'); ?>: |
  |  | 1175 | </div> |
  |  | 1176 | <form method="post" action=""> |
  |  | 1177 | <fieldset> |
  |  | 1178 | <div class="oa\_social\_login\_input"> |
  |  | 1179 | <input type="text" name="oa\_social\_login\_email" class="oa\_social\_login\_confirm\_text" value="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo (!empty ($\_POST ['oa\_social\_login\_email']) ? oa\_social\_login\_esc\_attr ($\_POST ['oa\_social\_login\_email']) : ''); ?>" /> |
  |  | 1180 | <input type="hidden" name="oa\_social\_login\_action" value="confirm\_email" size="30" /> |
  |  | 1181 | </div> |
  |  | 1182 | <div class="oa\_social\_login\_modal\_error"> |
  |  | 1183 | <?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $message; ?> |
  |  | 1184 | </div> |
  |  | 1185 | <div class="oa\_social\_login\_buttons"> |
  |  | 1186 | <input class="oa\_social\_login\_button" id="oa\_social\_login\_button\_confirm" name="oa\_social\_login\_confirm\_btn" type="submit" value="<?php \_esc\_attr\_e ('Confirm', 'oa-social-login'); ?>" /> |
  |  | 1187 | <a href="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo esc\_url ($logout\_url); ?>" class="oa\_social\_login\_button" id="oa\_social\_login\_button\_cancel"><?php \_esc\_attr\_e ('Cancel', 'oa-social-login'); ?></a> |
  |  | 1188 | </div> |
  |  | 1189 | </fieldset> |
  |  | 1190 | </form> |
  |  | 1191 | </div> |
  |  | 1192 | </div> |
  |  | 1193 | </div> |
  |  | 1194 | </div> |
  |  | 1195 | <?php |
  |  | 1196 | } |
  |  | 1197 | } |
  |  | 1198 | } |
  | 1177 | 1199 | } |
  | 1178 | 1200 | add\_action ('wp\_footer', 'oa\_social\_login\_request\_email'); |
  | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=2223378#L1185) | […](/browser/oa-social-login/trunk/includes/user_interface.php?rev=3201046#L1207) |  |
  | 1185 | 1207 | function oa\_social\_login\_request\_email\_cancel () |
  | 1186 | 1208 | { |
  | 1187 |  | // Email Request Cancelled |
  | 1188 |  | if (isset ($\_GET) && !empty ($\_GET ['oa\_action']) && $\_GET ['oa\_action'] == 'request\_email\_cancel' && !empty ($\_GET ['oa\_nonce'])) |
  | 1189 |  | { |
  | 1190 |  | require\_once(ABSPATH.'wp-admin/includes/user.php' ); |
  | 1191 |  |  |
  | 1192 |  | // Works only for logged in users |
  | 1193 |  | if (is\_user\_logged\_in()) |
  | 1194 |  | { |
  | 1195 |  | //Get the current user |
  | 1196 |  | $current\_user = wp\_get\_current\_user (); |
  | 1197 |  |  |
  | 1198 |  | // Check Nonce |
  | 1199 |  | if (wp\_verify\_nonce ($\_GET ['oa\_nonce'], 'request\_email\_cancel-'.$current\_user->ID)) |
  | 1200 |  | { |
  | 1201 |  | // Check if email was requested |
  | 1202 |  | $oa\_social\_login\_request\_email = get\_user\_meta ($current\_user->ID, 'oa\_social\_login\_request\_email', true); |
  | 1203 |  |  |
  | 1204 |  | // Yes, email was requested |
  | 1205 |  | if (!empty ($oa\_social\_login\_request\_email)) |
  | 1206 |  | { |
  | 1207 |  | // Make sure it was our placeholder email |
  | 1208 |  | if (preg\_match ('/example\.com$/i', $current\_user->user\_email)) |
  | 1209 |  | { |
  | 1210 |  | wp\_delete\_user ($current\_user->ID); |
  | 1211 |  | } |
  | 1212 |  | else |
  | 1213 |  | { |
  | 1214 |  | delete\_user\_meta ($current\_user->ID, 'oa\_social\_login\_request\_email'); |
  | 1215 |  | } |
  | 1216 |  | } |
  | 1217 |  | } |
  | 1218 |  | } |
  | 1219 |  | } |
  |  | 1209 | // Email Request Cancelled |
  |  | 1210 | if (isset ($\_GET) && !empty ($\_GET ['oa\_action']) && $\_GET ['oa\_action'] == 'request\_email\_cancel' && !empty ($\_GET ['oa\_nonce'])) |
  |  | 1211 | { |
  |  | 1212 | require\_once(ABSPATH.'wp-admin/includes/user.php' ); |
  |  | 1213 |  |
  |  | 1214 | // Works only for logged in users |
  |  | 1215 | if (is\_user\_logged\_in()) |
  |  | 1216 | { |
  |  | 1217 | //Get the current user |
  |  | 1218 | $current\_user = wp\_get\_current\_user (); |
  |  | 1219 |  |
  |  | 1220 | // Check Nonce |
  |  | 1221 | if (wp\_verify\_nonce ($\_GET ['oa\_nonce'], 'request\_email\_cancel-'.$current\_user->ID)) |
  |  | 1222 | { |
  |  | 1223 | // Check if email was requested |
  |  | 1224 | $oa\_social\_login\_request\_email = get\_user\_meta ($current\_user->ID, 'oa\_social\_login\_request\_email', true); |
  |  | 1225 |  |
  |  | 1226 | // Yes, email was requested |
  |  | 1227 | if (!empty ($oa\_social\_login\_request\_email)) |
  |  | 1228 | { |
  |  | 1229 | // Make sure it was our placeholder email |
  |  | 1230 | if (preg\_match ('/example\.com$/i', $current\_user->user\_email)) |
  |  | 1231 | { |
  |  | 1232 | wp\_delete\_user ($current\_user->ID); |
  |  | 1233 | } |
  |  | 1234 | else |
  |  | 1235 | { |
  |  | 1236 | delete\_user\_meta ($current\_user->ID, 'oa\_social\_login\_request\_email'); |
  |  | 1237 | } |
  |  | 1238 | } |
  |  | 1239 | } |
  |  | 1240 | } |
  |  | 1241 | } |
  | 1220 | 1242 | } |
  | 1221 | 1243 | add\_action ('wp\_loaded', 'oa\_social\_login\_request\_email\_cancel'); |
* ## [oa-social-login/trunk/includes/widget.php](/changeset/3201046/oa-social-login/trunk/includes/widget.php "Show the changeset 3201046 restricted to oa-social-login/trunk/includes/widget.php")

  | [r2111930](/browser/oa-social-login/trunk/includes/widget.php?rev=2111930#L24 "Show revision 2111930 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/includes/widget.php?rev=3201046#L24 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 24 | 24 | if (empty ($instance ['widget\_hide\_for\_logged\_in\_users']) OR !is\_user\_logged\_in ()) |
  | 25 | 25 | { |
  | 26 |  | //Before Widget |
  |  | 26 | // Before widget |
  |  | 27 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  | 27 | 28 | echo $args ['before\_widget']; |
  | 28 | 29 |  |
  | […](/browser/oa-social-login/trunk/includes/widget.php?rev=2111930#L30) | […](/browser/oa-social-login/trunk/includes/widget.php?rev=3201046#L31) |  |
  | 30 | 31 | if (!empty ($instance ['widget\_title'])) |
  | 31 | 32 | { |
  |  | 33 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  | 32 | 34 | echo $args ['before\_title'] . apply\_filters ('widget\_title', $instance ['widget\_title']) . $args ['after\_title']; |
  | 33 | 35 | } |
  | […](/browser/oa-social-login/trunk/includes/widget.php?rev=2111930#L36) | […](/browser/oa-social-login/trunk/includes/widget.php?rev=3201046#L38) |  |
  | 36 | 38 | if (!empty ($instance ['widget\_content\_before'])) |
  | 37 | 39 | { |
  |  | 40 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  | 38 | 41 | echo $instance ['widget\_content\_before']; |
  | 39 | 42 | } |
  | 40 | 43 |  |
  | 41 | 44 | //Content |
  |  | 45 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  | 42 | 46 | echo oa\_social\_login\_render\_login\_form ('widget', $instance); |
  | 43 | 47 |  |
  | […](/browser/oa-social-login/trunk/includes/widget.php?rev=2111930#L45) | […](/browser/oa-social-login/trunk/includes/widget.php?rev=3201046#L49) |  |
  | 45 | 49 | if (!empty ($instance ['widget\_content\_after'])) |
  | 46 | 50 | { |
  |  | 51 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  | 47 | 52 | echo $instance ['widget\_content\_after']; |
  | 48 | 53 | } |
  | 49 | 54 |  |
  | 50 | 55 | //After Widget |
  |  | 56 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  | 51 | 57 | echo $args ['after\_widget']; |
  | 52 | 58 | } |
  | […](/browser/oa-social-login/trunk/includes/widget.php?rev=2111930#L75) | […](/browser/oa-social-login/trunk/includes/widget.php?rev=3201046#L81) |  |
  | 75 | 81 | ?> |
  | 76 | 82 | <p> |
  | 77 |  | <label for="<?php ~~echo $this->get\_field\_id ('widget\_title'); ?>"><?php~~ \_e ('Title', 'oa-social-login'); ?>:</label> |
  | 78 |  | <input class="widefat" id="<?php ~~echo $this->get\_field\_id ('widget\_title'); ?>" name="<?php~~ echo $this->get\_field\_name ('widget\_title'); ?>" type="text" value="<?php echo $instance ['widget\_title']; ?>" /> |
  |  | 83 | <label for="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_title'); ?>"><?php esc\_html\_e ('Title', 'oa-social-login'); ?>:</label> |
  |  | 84 | <input class="widefat" id="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_title'); ?>" name="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_name ('widget\_title'); ?>" type="text" value="<?php echo $instance ['widget\_title']; ?>" /> |
  | 79 | 85 | </p> |
  | 80 | 86 | <p> |
  | 81 |  | <label for="<?php ~~echo $this->get\_field\_id ('widget\_icon\_theme'); ?>"><?php~~ \_e ('Icon Theme', 'oa-social-login'); ?>:</label> |
  | 82 |  | <select class="widefat" id="<?php ~~echo $this->get\_field\_id ('widget\_icon\_theme'); ?>" name="<?php~~ echo $this->get\_field\_name ('widget\_icon\_theme'); ?>"> |
  | 83 |  | <option value="0"<?php echo ($instance ['widget\_icon\_theme'] == 0 ? ' selected="selected"' : ''); ?>><?php \_e ('Classic Icons', 'oa-social-login'); ?></option> |
  | 84 |  | <option value="1"<?php echo ($instance ['widget\_icon\_theme'] == 1 ? ' selected="selected"' : ''); ?>><?php \_e ('Modern Icons', 'oa-social-login'); ?></option> |
  | 85 |  | <option value="2"<?php echo ($instance ['widget\_icon\_theme'] == 2 ? ' selected="selected"' : ''); ?>><?php \_e ('Small Icons', 'oa-social-login'); ?></option> |
  |  | 87 | <label for="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_icon\_theme'); ?>"><?php esc\_html\_e ('Icon Theme', 'oa-social-login'); ?>:</label> |
  |  | 88 | <select class="widefat" id="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_icon\_theme'); ?>" name="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_name ('widget\_icon\_theme'); ?>"> |
  |  | 89 | <option value="0"<?php echo ($instance ['widget\_icon\_theme'] == 0 ? ' selected="selected"' : ''); ?>><?php esc\_html\_e ('Classic Icons', 'oa-social-login'); ?></option> |
  |  | 90 | <option value="1"<?php echo ($instance ['widget\_icon\_theme'] == 1 ? ' selected="selected"' : ''); ?>><?php esc\_html\_e ('Modern Icons', 'oa-social-login'); ?></option> |
  |  | 91 | <option value="2"<?php echo ($instance ['widget\_icon\_theme'] == 2 ? ' selected="selected"' : ''); ?>><?php esc\_html\_e ('Small Icons', 'oa-social-login'); ?></option> |
  | 86 | 92 | </select> |
  | 87 | 93 | </p> |
  | 88 | 94 | <p> |
  | 89 |  | <label for="<?php ~~echo $this->get\_field\_id ('widget\_content\_before'); ?>"><?php~~ \_e ('Insert text/html to add before the widget', 'oa-social-login'); ?>:</label> |
  | 90 |  | <textarea class="widefat" id="<?php echo $this->get\_field\_id ('widget\_content\_before'); ?>" name="<?php echo $this->get\_field\_name ('widget\_content\_before'); ?>"><?php echo $instance ['widget\_content\_before']; ?></textarea> |
  |  | 95 | <label for="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_content\_before'); ?>"><?php esc\_html\_e ('Insert text/html to add before the widget', 'oa-social-login'); ?>:</label> |
  |  | 96 | <textarea class="widefat" id="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_content\_before'); ?>" name="<?php echo $this->get\_field\_name ('widget\_content\_before'); ?>"><?php echo $instance ['widget\_content\_before']; ?></textarea> |
  | 91 | 97 | </p> |
  | 92 | 98 | <p> |
  | 93 |  | <label for="<?php ~~echo $this->get\_field\_id ('widget\_content\_after'); ?>"><?php~~ \_e ('Insert text/html to add after the widget', 'oa-social-login'); ?>:</label> |
  | 94 |  | <textarea class="widefat" id="<?php echo $this->get\_field\_id ('widget\_content\_after'); ?>" name="<?php echo $this->get\_field\_name ('widget\_content\_after'); ?>"><?php echo $instance ['widget\_content\_after']; ?></textarea> |
  |  | 99 | <label for="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_content\_after'); ?>"><?php esc\_html\_e ('Insert text/html to add after the widget', 'oa-social-login'); ?>:</label> |
  |  | 100 | <textarea class="widefat" id="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_content\_after'); ?>" name="<?php echo $this->get\_field\_name ('widget\_content\_after'); ?>"><?php echo $instance ['widget\_content\_after']; ?></textarea> |
  | 95 | 101 | </p> |
  | 96 | 102 | <p> |
  | 97 |  | <input type="checkbox" id="<?php echo $this->get\_field\_id ('widget\_hide\_for\_logged\_in\_users', 'oa-social-login'); ?>" name="<?php echo $this->get\_field\_name ('widget\_hide\_for\_logged\_in\_users'); ?>" type="text" value="1" <?php echo (!empty ($instance ['widget\_hide\_for\_logged\_in\_users']) ? 'checked="checked"' : ''); ?> /> |
  | 98 |  | <label for="<?php ~~echo $this->get\_field\_id ('widget\_hide\_for\_logged\_in\_users'); ?>"><?php~~ \_e ('Tick to hide the widget for logged-in users', 'oa-social-login'); ?></label> |
  |  | 103 | <input type="checkbox" id="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_hide\_for\_logged\_in\_users', 'oa-social-login'); ?>" name="<?php echo $this->get\_field\_name ('widget\_hide\_for\_logged\_in\_users'); ?>" type="text" value="1" <?php echo (!empty ($instance ['widget\_hide\_for\_logged\_in\_users']) ? 'checked="checked"' : ''); ?> /> |
  |  | 104 | <label for="<?php /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ echo $this->get\_field\_id ('widget\_hide\_for\_logged\_in\_users'); ?>"><?php esc\_html\_e ('Tick to hide the widget for logged-in users', 'oa-social-login'); ?></label> |
  | 99 | 105 | </p> |
  | 100 | 106 | <?php |
  | […](/browser/oa-social-login/trunk/includes/widget.php?rev=2111930#L108) | […](/browser/oa-social-login/trunk/includes/widget.php?rev=3201046#L114) |  |
  | 108 | 114 | { |
  | 109 | 115 | $instance = $old\_instance; |
  | 110 |  | $instance ['widget\_title'] = trim (~~strip~~\_tags ($new\_instance ['widget\_title'])); |
  |  | 116 | $instance ['widget\_title'] = trim (wp\_strip\_all\_tags ($new\_instance ['widget\_title'])); |
  | 111 | 117 | $instance ['widget\_content\_before'] = trim ($new\_instance ['widget\_content\_before']); |
  | 112 | 118 | $instance ['widget\_content\_after'] = trim ($new\_instance ['widget\_content\_after']); |
* ## [oa-social-login/trunk/oa-social-login.php](/changeset/3201046/oa-social-login/trunk/oa-social-login.php "Show the changeset 3201046 restricted to oa-social-login/trunk/oa-social-login.php")

  | [r3153096](/browser/oa-social-login/trunk/oa-social-login.php?rev=3153096#L4 "Show revision 3153096 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/oa-social-login.php?rev=3201046#L4 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | \* Plugin URI: http://www.oneall.com/ |
  | 5 | 5 | \* Description: Social Login allows your users to <strong>comment, login and register with 40+ social networks</strong> like Twitter, Facebook, LinkedIn, Instagram, Вконтакте, Google or Yahoo. |
  | 6 |  | \* Version: 5.~~9~~.0 |
  |  | 6 | \* Version: 5.10.0 |
  | 7 | 7 | \* Author: OneAll Social Login <support@oneall.com> |
  | 8 | 8 | \* Author URI: https://www.oneall.com/services/social-network-integration/social-login/ |
  | […](/browser/oa-social-login/trunk/oa-social-login.php?rev=3153096#L13) | […](/browser/oa-social-login/trunk/oa-social-login.php?rev=3201046#L13) |  |
  | 13 | 13 | define('OA\_SOCIAL\_LOGIN\_PLUGIN\_URL', plugins\_url() . '/' . basename(dirname(\_\_FILE\_\_))); |
  | 14 | 14 | define('OA\_SOCIAL\_LOGIN\_BASE\_PATH', dirname(plugin\_basename(\_\_FILE\_\_))); |
  | 15 |  | define('OA\_SOCIAL\_LOGIN\_VERSION', '5.~~9~~.0'); |
  |  | 15 | define('OA\_SOCIAL\_LOGIN\_VERSION', '5.10.0'); |
  | 16 | 16 | define('OA\_SOCIAL\_LOGIN\_DEFAULT\_THEME', 1); |
  | 17 | 17 |  |
  | […](/browser/oa-social-login/trunk/oa-social-login.php?rev=3153096#L24) | […](/browser/oa-social-login/trunk/oa-social-login.php?rev=3201046#L24) |  |
  | 24 | 24 | { |
  | 25 | 25 | deactivate\_plugins(basename(dirname(\_\_FILE\_\_)) . '/' . basename(\_\_FILE\_\_)); |
  | 26 |  | echo sprintf(\_\_('This plugin requires WordPress %s or newer. Please update your WordPress installation to activate this plugin.', 'oa-social-login'), '3.0'); |
  |  | 26 | /\* translators: %s: plugin version \*/ |
  |  | 27 | $message = sprintf(\_\_('This plugin requires WordPress %s or newer. Please update your WordPress installation to activate this plugin.', 'oa-social-login'), '3.0'); |
  |  | 28 |  |
  |  | 29 | /\* phpcs:ignore WordPress.Security.EscapeOutput.OutputNotEscaped \*/ |
  |  | 30 | echo $message; |
  | 27 | 31 | exit; |
  | 28 | 32 | } |
  | […](/browser/oa-social-login/trunk/oa-social-login.php?rev=3153096#L62) | […](/browser/oa-social-login/trunk/oa-social-login.php?rev=3201046#L66) |  |
  | 62 | 66 | if (defined('WP\_DEBUG\_LOG') && WP\_DEBUG\_LOG) |
  | 63 | 67 | { |
  | 64 |  | error\_log('[OneAll Social Login] ' . date("d.m.Y G:i") . ' : ' . print\_r($message, true)); |
  |  | 68 | error\_log('[OneAll Social Login] ' . gmdate("d.m.Y G:i") . ' : ' . print\_r($message, true)); |
  | 65 | 69 | } |
  | 66 | 70 | } |
* ## [oa-social-login/trunk/readme.txt](/changeset/3201046/oa-social-login/trunk/readme.txt "Show the changeset 3201046 restricted to oa-social-login/trunk/readme.txt")

  | [r3153105](/browser/oa-social-login/trunk/readme.txt?rev=3153105#L3 "Show revision 3153105 of this file in browser") | [r3201046](/browser/oa-social-login/trunk/readme.txt?rev=3201046#L3 "Show revision 3201046 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Tags: social login, facebook login, twitter login, linkedin login, tiktok login |
  | 4 | 4 | Requires at least: 3.0 |
  | 5 |  | Tested up to: 6.~~6.1~~ |
  | 6 |  | Stable tag: 5.~~9~~.0 |
  |  | 5 | Tested up to: 6.7 |
  |  | 6 | Stable tag: 5.10.0 |
  | 7 | 7 | Requires PHP: 5.4 |
  | 8 | 8 | License: GPLv2 or later |
  | […](/browser/oa-social-login/trunk/readme.txt?rev=3153105#L54) | […](/browser/oa-social-login/trunk/readme.txt?rev=3201046#L54) |  |
  | 54 | 54 | \* Battle.net |
  | 55 | 55 | \* Blogger |
  | 56 |  | \* Discord |
  | 57 |  | \* Disqus |
  |  | 56 | \* Discord |
  | 58 | 57 | \* Draugiem |
  | 59 | 58 | \* Dribbble |
  | […](/browser/oa-social-login/trunk/readme.txt?rev=3153105#L204) | […](/browser/oa-social-login/trunk/readme.txt?rev=3201046#L203) |  |
  | 204 | 203 | == Changelog == |
  | 205 | 204 |  |
  |  | 205 | = 5.10.0 = |
  |  | 206 | \* Fix vulnerability |
  |  | 207 |  |
  | 206 | 208 | = 5.9.0 = |
  | 207 | 209 | \* Social Network "X" added |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3201046)
* [Zip Archive](?format=zip&new=3201046)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


