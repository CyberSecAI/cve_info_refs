Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The vulnerability stems from the improper use of `add_query_arg` and `remove_query_arg` functions within the WPAdverts plugin. These functions are used to manipulate URLs but lack proper escaping. Specifically, the `add_query_arg` function was used to generate a "go back" link without sanitizing the generated URL.

**Weaknesses/Vulnerabilities:**

- **Reflected Cross-Site Scripting (XSS):** The core vulnerability is a reflected XSS. This means that an attacker can inject malicious JavaScript code into a URL, and when a user clicks on that link, the script will be executed in their browser.

**Impact of Exploitation:**

- **Arbitrary Script Execution:** An attacker can inject and execute arbitrary web scripts in a user's browser.
- **Session Hijacking:** An attacker can potentially hijack user sessions.
- **Malicious Actions:** An attacker could perform unauthorized actions on behalf of the user, such as modifying data, redirecting to malicious sites, or stealing sensitive information.
- **Compromise User Accounts:** By exploiting XSS, attackers can compromise user accounts leading to data breaches.

**Attack Vectors:**

- **Malicious Link:** An attacker crafts a malicious URL containing JavaScript code.
- **Social Engineering:** The attacker tricks a user into clicking on the malicious link.
- **Email/Messaging:** The malicious link can be sent via email, instant messaging, or social media platforms.

**Required Attacker Capabilities/Position:**

- **No Authentication Required:** The attacker does not need to be authenticated on the target WordPress site.
- **Social Engineering Skills:** The attacker must be able to trick a user into clicking a malicious link.
- **Ability to Craft a Malicious URL:** The attacker needs to craft a URL with malicious JavaScript code injected in the query parameters.

**Additional Notes:**

- The vulnerability exists in all versions of the WPAdverts plugin up to and including version 2.1.7.
- The vulnerability was fixed in version 2.1.8 by implementing `esc_url()` to sanitize the URL before displaying it.
- The vulnerable code was located in `/includes/shortcodes.php` file
- The fix was introduced by adding `esc_url()` to the `sprintf` function that uses the `$go_back` URL.