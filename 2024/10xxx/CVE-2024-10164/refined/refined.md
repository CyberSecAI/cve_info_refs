Based on the provided information, here's an analysis of CVE-2024-10164:

**Root Cause of Vulnerability:**

*   The vulnerability stems from insufficient input sanitization and output escaping within the `wpdmpp_pay_link` shortcode of the "Premium Packages â€“ Sell Digital Products Securely" WordPress plugin. User-supplied attributes within this shortcode are not properly processed, allowing for the injection of malicious code.

**Weaknesses/Vulnerabilities Present:**

*   **Stored Cross-Site Scripting (XSS):**  The primary vulnerability is a stored XSS flaw. This means that malicious scripts are injected into the database and are executed when a user accesses the affected page.

**Impact of Exploitation:**

*   An attacker can inject arbitrary web scripts. When a user views a page containing the crafted shortcode, the injected scripts will execute within their browser. This could lead to various malicious activities, including:
    *   Redirecting users to phishing sites.
    *   Stealing session cookies or other sensitive information.
    *   Modifying page content or injecting malicious advertisements.
    *   Performing actions on behalf of the user.

**Attack Vectors:**

*   The attack vector is through the `wpdmpp_pay_link` shortcode. An attacker crafts a malicious shortcode with a payload, such as javascript code, in its attributes. They then insert this shortcode into a page/post/widget that will be rendered to users.

**Required Attacker Capabilities/Position:**

*   **Authenticated Access:** An attacker needs to have an authenticated account with at least "contributor" level access to inject the malicious shortcode into a page.
*   **Ability to Create/Modify Content:** The attacker must be able to create or modify content (e.g., pages, posts, widgets) where shortcodes can be used.
*   **No User Interaction:** The XSS is triggered when a user views a page containing the malicious shortcode, requiring no further direct interaction from the user beyond loading the page.

**Additional Notes**

*   The vulnerability affects all versions of the plugin up to and including 5.9.3.
*   The vulnerability was reported by Peter Thaleikis of Wordfence.
*   The Wordfence article mentions that there is no patch available for this vulnerability, and users should consider removing the plugin.
*   The CVSS score is 6.4, indicating a medium severity vulnerability.