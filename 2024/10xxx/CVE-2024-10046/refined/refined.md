Based on the provided content, here's an analysis of the vulnerability:

**CVE ID:** CVE-2024-10046

**Root Cause of Vulnerability:**
The vulnerability stems from the improper use of the `remove_query_arg` function within the افزونه پیامک ووکامرس Persian WooCommerce SMS plugin. Specifically, the plugin uses this function to remove query arguments from URLs without proper sanitization or escaping of the URL. This allows for the injection of malicious scripts into the URL.

**Weaknesses/Vulnerabilities Present:**
*   **Reflected Cross-Site Scripting (XSS):** The core issue is a reflected XSS vulnerability. User-supplied input (malicious script in a URL) is reflected back in the response without proper sanitization/encoding, which allows the injected script to execute in the victim's browser.

**Impact of Exploitation:**
*   **Arbitrary Script Execution:** Successful exploitation allows an attacker to inject and execute arbitrary JavaScript in the victim's browser. This can lead to various malicious activities.
*   **Session Hijacking:** The attacker could potentially steal session cookies, leading to account compromise.
*   **Data Theft:** Malicious scripts can be used to steal sensitive data from the victim's browser.
*   **Redirection to Malicious Sites:** The attacker might redirect users to phishing pages or other malicious websites.
*   **Defacement:** The attacker could alter the visual appearance of the page.

**Attack Vectors:**
*   **Malicious URL:** The primary attack vector is through a crafted URL containing the malicious script.
*   **Social Engineering:** The attacker needs to trick the victim into clicking on the malicious URL. This could involve various social engineering techniques like phishing emails, malicious links on forums, etc.

**Required Attacker Capabilities/Position:**
*   **No Authentication Required:** The attacker does not need any prior authentication to exploit this vulnerability.
*   **Social Engineering:** The attacker needs the ability to trick users into clicking on the malicious URL.
*   **URL Manipulation:** The attacker should be able to create and modify URLs.

**Additional Notes:**
*   The vulnerability affects all versions of the plugin up to and including 7.0.5.
*   Version 7.0.6 of the plugin contains the fix for the vulnerability.
*   The fix likely involves properly escaping the URL when using the `remove_query_arg` function.

This information provides more details than the official CVE description, detailing the vulnerable function, attack vector, and impact.