=== Content from www.wordfence.com_3a693cec_20250114_230932.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Loginizer Security and Loginizer <= 1.9.2 - Authentication Bypass

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Loginizer Security and Loginizer <= 1.9.2 - Authentication Bypass

8.1

**Improper Authentication**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-10097](https://www.cve.org/CVERecord?id=CVE-2024-10097) |
| --- | --- |
| CVSS | 8.1 (High) |
| Publicly Published | November 4, 2024 |
| Last Updated | November 5, 2024 |
| Researcher | [wesley (wcraft)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/wesley-jhon) |

### Description

The Loginizer Security and Loginizer plugins for WordPress are vulnerable to authentication bypass in all versions up to, and including, 1.9.2. This is due to insufficient verification on the user being returned by the social login token. This makes it possible for unauthenticated attackers to log in as any existing user on the site, such as an administrator, if they have access to the email and the user does not have an already-existing account for the service returning the token.

#### References

* [loginizer.com](https://loginizer.com/)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/loginizer/trunk/main/social-login.php?rev=3108779#L127)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3173657/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fdetail%2Floginizer-security-and-loginizer-192-authentication-bypass&t=Loginizer%20Security%20and%20Loginizer%20%3C%3D%201.9.2%20-%20Authentication%20Bypass "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fdetail%2Floginizer-security-and-loginizer-192-authentication-bypass&text=Loginizer%20Security%20and%20Loginizer%20%3C%3D%201.9.2%20-%20Authentication%20Bypass "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fdetail%2Floginizer-security-and-loginizer-192-authentication-bypass "LinkedIn")
Email

## 2 affected software packages

#### [Loginizer](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/loginizer)

| Software Type | Plugin |
| --- | --- |
| Software Slug | loginizer [(view on wordpress.org)](https://wordpress.org/plugins/loginizer) |
| Patched? | Yes |
| Remediation | Update to version 1.9.3, or a newer patched version |
| Affected Version | * <= 1.9.2 |
| Patched Version | * 1.9.3 |

#### [Loginizer Security](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/loginizer-security)

| Software Type | Plugin |
| --- | --- |
| Software Slug | loginizer-security |
| Patched? | Yes |
| Remediation | Update to version 1.9.3, or a newer patched version |
| Affected Version | * <= 1.9.2 |
| Patched Version | * 1.9.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_815717f2_20250114_230930.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Floginizer%2Ftrunk%2Fmain%2Fsocial-login.php%3Frev%3D3108779)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← Previous Revision
* [Latest Revision](/browser/loginizer/trunk/main/social-login.php)
* [Next Revision](/browser/loginizer/trunk/main/social-login.php?rev=3173657 "Revision 3173657") →
* [Blame](/browser/loginizer/trunk/main/social-login.php?annotate=blame&rev=3108779 "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/loginizer/trunk/main/social-login.php?rev=3108779)

---

# [source:](/browser?rev=3108779&order=name "Go to repository root") [loginizer](/browser/loginizer?rev=3108779&order=name "View loginizer")/[trunk](/browser/loginizer/trunk?rev=3108779&order=name "View trunk")/[main](/browser/loginizer/trunk/main?rev=3108779&order=name "View main")/[social-login.php](/browser/loginizer/trunk/main/social-login.php?rev=3108779&order=name "View social-login.php") @ [3108779](/changeset/3108779/ "View changeset 3108779")

View diff against:

View revision:

| [Last change](/changeset/3108779/loginizer/trunk/main/social-login.php "View differences") on this file since 3108779 was [3108779](/changeset/3108779/ "View changeset 3108779"), checked in by softaculous, [7 months ago](/timeline?from=2024-06-27T14%3A05%3A26Z&precision=second "See timeline at 06/27/2024 02:05:26 PM") |
| --- |
| Social Login |
| **File size:** 16.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | if(!defined('ABSPATH')){ |
| [4](#L4) | die('Hacking Attempt!'); |
| [5](#L5) | } |
| [6](#L6) |  |
| [7](#L7) | include\_once dirname(\_\_FILE\_\_, 2) . '/lib/hybridauth/autoload.php'; |
| [8](#L8) |  |
| [9](#L9) | use Hybridauth\Exception\Exception; |
| [10](#L10) | use Hybridauth\Hybridauth; |
| [11](#L11) | use Hybridauth\HttpClient; |
| [12](#L12) | use Hybridauth\Storage\Session; |
| [13](#L13) |  |
| [14](#L14) | class Loginizer\_Social\_Login{ |
| [15](#L15) |  |
| [16](#L16) | public static $error = []; |
| [17](#L17) | public static $test = false; |
| [18](#L18) | public static $ref = ''; |
| [19](#L19) | public static $interim\_login = ''; |
| [20](#L20) | public static $provider = ''; |
| [21](#L21) | public static $storage; |
| [22](#L22) |  |
| [23](#L23) | // Process all the requests from here. |
| [24](#L24) | static function login\_init(){ |
| [25](#L25) | global $loginizer; |
| [26](#L26) |  |
| [27](#L27) | self::$storage = new Session(); |
| [28](#L28) |  |
| [29](#L29) | // Security check here. |
| [30](#L30) | $lz\_social\_nonce = ''; |
| [31](#L31) | if(!empty($\_GET['social\_security'])){ |
| [32](#L32) | $lz\_social\_nonce = sanitize\_text\_field(wp\_unslash($\_GET['social\_security'])); |
| [33](#L33) | } elseif(!empty(self::$storage) && !empty(self::$storage->get('social\_security'))){ |
| [34](#L34) | $lz\_social\_nonce = sanitize\_text\_field(self::$storage->get('social\_security')); |
| [35](#L35) | } |
| [36](#L36) |  |
| [37](#L37) | if(!wp\_verify\_nonce($lz\_social\_nonce, 'loginizer\_social\_check')){ |
| [38](#L38) | self::$error['security-check'] = \_\_('Security check failed when trying to login', 'loginizer'); |
| [39](#L39) | self::trigger\_error(); |
| [40](#L40) | return; |
| [41](#L41) | } |
| [42](#L42) |  |
| [43](#L43) | $providers = self::build\_provider\_arr(); |
| [44](#L44) |  |
| [45](#L45) | if(empty($providers)){ |
| [46](#L46) | self::$error['login\_error'] = \_\_('No Provider is configured, please contact the admin about this issue', 'loginizer'); |
| [47](#L47) | self::trigger\_error(); |
| [48](#L48) | return; |
| [49](#L49) | } |
| [50](#L50) |  |
| [51](#L51) | $callback\_query = []; |
| [52](#L52) | $callback\_query['lz\_social\_provider'] = lz\_optget('lz\_social\_provider'); |
| [53](#L53) |  |
| [54](#L54) | try { |
| [55](#L55) | $config = [ |
| [56](#L56) | // Location where to redirect users once they authenticate with a provider |
| [57](#L57) | 'callback' => wp\_login\_url().'?'.http\_build\_query($callback\_query), |
| [58](#L58) |  |
| [59](#L59) | // Providers specifics |
| [60](#L60) | 'providers' => $providers |
| [61](#L61) | ]; |
| [62](#L62) |  |
| [63](#L63) | $hybridauth = new Hybridauth($config); |
| [64](#L64) |  |
| [65](#L65) | //Step 1: Here we will be redirected to the App Auth page |
| [66](#L66) | if(!empty($\_GET['lz\_social\_provider'])){ |
| [67](#L67) | if(is\_array($hybridauth->getProviders()) && in\_array($\_GET['lz\_social\_provider'], $hybridauth->getProviders())) { |
| [68](#L68) | // Store the provider for the callback event |
| [69](#L69) | self::$storage->set('provider', lz\_optget('lz\_social\_provider')); |
| [70](#L70) |  |
| [71](#L71) | if(!empty($\_REQUEST['test'])){ |
| [72](#L72) | self::$storage->set('test', true); |
| [73](#L73) | } |
| [74](#L74) |  |
| [75](#L75) | self::$storage->set('social\_security', wp\_create\_nonce('loginizer\_social\_check')); |
| [76](#L76) |  |
| [77](#L77) | if(!empty($\_REQUEST['ref']) && wp\_http\_validate\_url(sanitize\_url(wp\_unslash($\_REQUEST['ref'])))){ |
| [78](#L78) | self::$storage->set('ref', rawurlencode(sanitize\_url(wp\_unslash($\_REQUEST['ref'])))); |
| [79](#L79) | } |
| [80](#L80) |  |
| [81](#L81) | if(isset($\_REQUEST['interim-login'])){ |
| [82](#L82) | self::$storage->set('interim\_login', 'lz'); |
| [83](#L83) | } |
| [84](#L84) |  |
| [85](#L85) | } else { |
| [86](#L86) | self::$error['provider\_error'] = esc\_html\_\_('The app you are trying to login through is not configured', 'loginizer'); |
| [87](#L87) | self::trigger\_error(); |
| [88](#L88) | return; |
| [89](#L89) | } |
| [90](#L90) | } |
| [91](#L91) |  |
| [92](#L92) | // Step 2: After we are back from the Apps auth page. |
| [93](#L93) | if($provider = self::$storage->get('provider')){ |
| [94](#L94) | if(!is\_array($hybridauth->getProviders()) || !in\_array($provider, $hybridauth->getProviders())) { |
| [95](#L95) | self::$error['provider\_error'] = esc\_html\_\_('The app you are trying to login through is not configured', 'loginizer'); |
| [96](#L96) | self::trigger\_error(); |
| [97](#L97) | return; |
| [98](#L98) | } |
| [99](#L99) |  |
| [100](#L100) | $hybridauth->authenticate($provider); |
| [101](#L101) |  |
| [102](#L102) | self::$storage->set('provider', null); // Cleaning |
| [103](#L103) | self::$storage->delete('social\_security'); |
| [104](#L104) |  |
| [105](#L105) | self::$provider = $provider; |
| [106](#L106) |  |
| [107](#L107) | if(self::$storage->get('test')){ |
| [108](#L108) | self::$storage->delete('test'); |
| [109](#L109) | self::$test = true; |
| [110](#L110) | } |
| [111](#L111) |  |
| [112](#L112) | if(self::$storage->get('ref')){ |
| [113](#L113) | self::$ref = rawurldecode(self::$storage->get('ref')); |
| [114](#L114) | self::$storage->delete('ref'); |
| [115](#L115) | } |
| [116](#L116) |  |
| [117](#L117) | if(self::$storage->get('interim\_login')){ |
| [118](#L118) | self::$interim\_login = self::$storage->get('interim\_login'); |
| [119](#L119) | self::$storage->delete('interim\_login'); |
| [120](#L120) | } |
| [121](#L121) |  |
| [122](#L122) | // Retrieve the provider record |
| [123](#L123) | $adapter = $hybridauth->getAdapter($provider); |
| [124](#L124) | $userProfile = $adapter->getUserProfile(); |
| [125](#L125) | $accessToken = $adapter->getAccessToken(); |
| [126](#L126) |  |
| [127](#L127) | $data = [ |
| [128](#L128) | 'access\_token' => $accessToken, |
| [129](#L129) | 'identifier' => $userProfile->identifier, |
| [130](#L130) | 'email' => $userProfile->email, |
| [131](#L131) | 'first\_name' => $userProfile->firstName, |
| [132](#L132) | 'last\_name' => $userProfile->lastName, |
| [133](#L133) | 'photoURL' => strtok($userProfile->photoURL, '?'), |
| [134](#L134) | ]; |
| [135](#L135) |  |
| [136](#L136) | $adapter->disconnect(); |
| [137](#L137) |  |
| [138](#L138) | if(empty($data['email'])){ |
| [139](#L139) | self::$error['login\_failed'] = \_\_('No email details were returned !', 'loginizer'); |
| [140](#L140) | self::trigger\_error(); |
| [141](#L141) | return; |
| [142](#L142) | } |
| [143](#L143) |  |
| [144](#L144) | // If it is a test then, we are satisfied that the Provider is returning data |
| [145](#L145) | // As this verifies the provider is working. |
| [146](#L146) | if(self::$test === true){ |
| [147](#L147) | self::close\_tab(); |
| [148](#L148) | return; |
| [149](#L149) | } |
| [150](#L150) |  |
| [151](#L151) | // Create an account if it does not exists. |
| [152](#L152) | if(empty(email\_exists(sanitize\_email($data['email'])))){ |
| [153](#L153) | if(self::$test === true){ |
| [154](#L154) | self::$error['test\_error'] = \_\_('The email you are using for the test is not registered on this website. So register this email first.', 'loginizer'); |
| [155](#L155) | self::trigger\_error(); |
| [156](#L156) | return; |
| [157](#L157) | } |
| [158](#L158) |  |
| [159](#L159) | if(defined('LOGINIZER\_PREMIUM') && !empty($loginizer['social\_settings']['general']['register\_new'])){ |
| [160](#L160) | self::register\_account($data); |
| [161](#L161) | echo 'Register Acount'; |
| [162](#L162) | return; |
| [163](#L163) | } |
| [164](#L164) |  |
| [165](#L165) | self::$error['login\_error'] = \_\_('You can not register through Social Login', 'loginizer'); |
| [166](#L166) | self::trigger\_error(); |
| [167](#L167) | return; |
| [168](#L168) | } |
| [169](#L169) |  |
| [170](#L170) | $user = get\_user\_by('email', sanitize\_email($data['email'])); |
| [171](#L171) | if(empty($user)){ |
| [172](#L172) | self::$error['login\_error'] = \_\_('User with this email does not exists.', 'loginizer'); |
| [173](#L173) | self::trigger\_error(); |
| [174](#L174) | return; |
| [175](#L175) | } |
| [176](#L176) |  |
| [177](#L177) | $authenticated = loginizer\_wp\_authenticate($user, $user->user\_login, $user->user\_pass); |
| [178](#L178) | if(is\_wp\_error($authenticated)){ |
| [179](#L179) | return; |
| [180](#L180) | } |
| [181](#L181) |  |
| [182](#L182) | self::login\_user($user); |
| [183](#L183) | self::close\_tab(); |
| [184](#L184) | } |
| [185](#L185) |  |
| [186](#L186) | }catch(\Exception $e){ |
| [187](#L187) | @error\_log('Loginizer Logs(Social): '. esc\_html($e->getMessage())); |
| [188](#L188) | self::$error['login\_error'] = \_\_('Oops, we ran into an issue! ', 'loginizer') . $e->getMessage(); |
| [189](#L189) | self::trigger\_error(); |
| [190](#L190) | //wp\_safe\_redirect(wp\_login\_url()); |
| [191](#L191) | return; |
| [192](#L192) | } |
| [193](#L193) | } |
| [194](#L194) |  |
| [195](#L195) | private static function login\_user($user, $username = '', $password = ''){ |
| [196](#L196) |  |
| [197](#L197) | if(isset($user) && is\_object($user) && property\_exists($user, 'ID') && empty(self::$test)){ |
| [198](#L198) | clean\_user\_cache(get\_current\_user\_id()); |
| [199](#L199) | clean\_user\_cache($user->ID); |
| [200](#L200) | wp\_clear\_auth\_cookie(); |
| [201](#L201) | wp\_set\_current\_user($user->ID, $user->user\_login); |
| [202](#L202) | wp\_set\_auth\_cookie($user->ID, true, is\_ssl()); |
| [203](#L203) | do\_action('wp\_login', $user->user\_login, $user); |
| [204](#L204) | update\_user\_caches($user); |
| [205](#L205) |  |
| [206](#L206) | return true; |
| [207](#L207) | } |
| [208](#L208) | } |
| [209](#L209) |  |
| [210](#L210) | /\*\* |
| [211](#L211) | \* Creates a User account |
| [212](#L212) | \* |
| [213](#L213) | \* @param  mixed[] $data Data we get from the Social App |
| [214](#L214) | \* @return void |
| [215](#L215) | \*/ |
| [216](#L216) | static function register\_account($data){ |
| [217](#L217) | global $loginizer; |
| [218](#L218) |  |
| [219](#L219) | $username = $data['first\_name'] . $data['last\_name']; |
| [220](#L220) |  |
| [221](#L221) | if(empty($username)){ |
| [222](#L222) | $parsed\_email = explode('@', $data['email']); |
| [223](#L223) |  |
| [224](#L224) | if(!empty($parsed\_email[0])){ |
| [225](#L225) | $username = preg\_replace('/[^A-Za-z0-9\-]/', '', $parsed\_email[0]); |
| [226](#L226) | } |
| [227](#L227) | } |
| [228](#L228) |  |
| [229](#L229) | $username = str\_replace(' ', '', strtolower($username)); |
| [230](#L230) | $username = sanitize\_user($username, true); |
| [231](#L231) |  |
| [232](#L232) | $i = 1; |
| [233](#L233) | while(username\_exists($username)){ |
| [234](#L234) | $username .= $i; |
| [235](#L235) | $i++; |
| [236](#L236) | } |
| [237](#L237) |  |
| [238](#L238) | $password = wp\_generate\_password(12); |
| [239](#L239) | $userdata = [ |
| [240](#L240) | 'user\_login' => sanitize\_text\_field($username), |
| [241](#L241) | 'user\_pass' => $password, |
| [242](#L242) | 'user\_email' => sanitize\_email($data['email']), |
| [243](#L243) | 'role' => (!empty($loginizer['social\_settings']['general']['default\_role']) ? sanitize\_text\_field($loginizer['social\_settings']['general']['default\_role']) : 'subscriber'), |
| [244](#L244) | 'show\_admin\_bar\_front' => (!empty($loginizer['social\_settings']['general']['hide\_admin\_bar']) ? false  : true), |
| [245](#L245) | ]; |
| [246](#L246) |  |
| [247](#L247) | $user\_id = wp\_insert\_user($userdata); |
| [248](#L248) |  |
| [249](#L249) | // TODO: Handle Error here. |
| [250](#L250) | if(is\_wp\_error($user\_id)){ |
| [251](#L251) | self::$error['registration\_failed'] = \_\_('Something went wrong while creating the user', 'loginizer'). $user\_id->get\_error\_message(); |
| [252](#L252) | return; |
| [253](#L253) | } |
| [254](#L254) |  |
| [255](#L255) | if(empty($user\_id)){ |
| [256](#L256) | self::$error['registration\_failed'] =  \_\_('Unable to register your account, try again later!', 'loginizer'); |
| [257](#L257) | self::close\_tab(); |
| [258](#L258) | return; |
| [259](#L259) | } |
| [260](#L260) |  |
| [261](#L261) | update\_user\_option($user\_id, 'default\_password\_nag', true, true); // This will show alert to user to change the password. |
| [262](#L262) | $user = get\_user\_by('ID', $user\_id); |
| [263](#L263) |  |
| [264](#L264) | // Save avatar if possible. |
| [265](#L265) | $tried\_to\_download = get\_user\_meta($user->ID, 'loginizer\_avatar\_download', true); |
| [266](#L266) | if(!empty($data['photoURL']) && !empty($loginizer['social\_settings']['general']['save\_avatar']) && empty($tried\_to\_download)){ |
| [267](#L267) | self::save\_avatar($data['photoURL'], $user->ID); |
| [268](#L268) | } |
| [269](#L269) |  |
| [270](#L270) | // Logging In the new user. |
| [271](#L271) | self::login\_user($user); |
| [272](#L272) |  |
| [273](#L273) | // Closing the tab and redirecting to the admin. |
| [274](#L274) | $redirect\_to = admin\_url(); |
| [275](#L275) |  |
| [276](#L276) | self::close\_tab(); |
| [277](#L277) |  |
| [278](#L278) | } |
| [279](#L279) |  |
| [280](#L280) | /\*\* |
| [281](#L281) | \* Creates an array of Config which is valid for HybridAuth using the setting of the provider. |
| [282](#L282) | \* |
| [283](#L283) | \* @return mixed[] |
| [284](#L284) | \*/ |
| [285](#L285) | private static function build\_provider\_arr(){ |
| [286](#L286) | $config = []; |
| [287](#L287) | $providers = get\_option('loginizer\_provider\_settings', []); |
| [288](#L288) |  |
| [289](#L289) | if(empty($providers)){ |
| [290](#L290) | return $config; |
| [291](#L291) | } |
| [292](#L292) |  |
| [293](#L293) | foreach($providers as $key => $provider){ |
| [294](#L294) |  |
| [295](#L295) | if(empty($provider['enabled']) || empty($provider['client\_id']) || empty($provider['client\_secret'])){ |
| [296](#L296) | continue; |
| [297](#L297) | } |
| [298](#L298) |  |
| [299](#L299) | $config\_index = ucfirst($key); |
| [300](#L300) |  |
| [301](#L301) | $config[$config\_index] = [ |
| [302](#L302) | 'enabled' => true, |
| [303](#L303) | 'keys' => [ |
| [304](#L304) | 'id' => $provider['client\_id'], |
| [305](#L305) | 'secret' => $provider['client\_secret'] |
| [306](#L306) | ] |
| [307](#L307) | ]; |
| [308](#L308) | } |
| [309](#L309) |  |
| [310](#L310) | return $config; |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | /\*\* |
| [314](#L314) | \* Close the Tab or redirects back to the Login Page. |
| [315](#L315) | \* |
| [316](#L316) | \* @param  string $redirect\_to URL where the user should be redirected, leave empty if want to redirect to admin. |
| [317](#L317) | \* @return void |
| [318](#L318) | \*/ |
| [319](#L319) | protected static function close\_tab(){ |
| [320](#L320) | global $loginizer; |
| [321](#L321) |  |
| [322](#L322) | // Check if the URL is safe to use. |
| [323](#L323) | if(!empty(self::$ref)){ |
| [324](#L324) | $redirect\_to = self::handle\_redirect(self::$ref); |
| [325](#L325) | } |
| [326](#L326) |  |
| [327](#L327) | $target\_window = 'same'; // If to redirect or to close the poup |
| [328](#L328) | $is\_interim = ''; // If interim add query string as a identifier |
| [329](#L329) | if(self::$interim\_login == 'lz'){ |
| [330](#L330) | $target\_window = 'popup'; |
| [331](#L331) | $is\_interim = '?interim\_login=lz'; |
| [332](#L332) | } else if(!empty(self::$test)){ |
| [333](#L333) | $target\_window = 'popup'; |
| [334](#L334) |  |
| [335](#L335) | $redirect\_to .= '&provider='.self::$provider.'&test=1'; |
| [336](#L336) | }else if(!empty($loginizer['social\_settings']['general']['target\_window'])){ |
| [337](#L337) | $target\_window = $loginizer['social\_settings']['general']['target\_window']; |
| [338](#L338) | } |
| [339](#L339) |  |
| [340](#L340) | if(empty($redirect\_to) || $redirect\_to == admin\_url()){ |
| [341](#L341) | $redirect\_to = admin\_url($is\_interim); |
| [342](#L342) | } |
| [343](#L343) |  |
| [344](#L344) | if($target\_window === 'same'){ |
| [345](#L345) | wp\_safe\_redirect($redirect\_to); |
| [346](#L346) | die(); |
| [347](#L347) | } |
| [348](#L348) |  |
| [349](#L349) | if(isset(self::$interim\_login) && self::$interim\_login === 'lz' && is\_user\_logged\_in()){ |
| [350](#L350) | echo esc\_html\_\_('Login Successful', 'loginizer'); |
| [351](#L351) | } |
| [352](#L352) |  |
| [353](#L353) | echo '<script> |
| [354](#L354) | window.opener.location.href="'.wp\_validate\_redirect(wp\_sanitize\_redirect($redirect\_to)).'"; |
| [355](#L355) | window.close(); |
| [356](#L356) | </script>'; |
| [357](#L357) |  |
| [358](#L358) | die(); |
| [359](#L359) | } |
| [360](#L360) |  |
| [361](#L361) | // Download the avatar and returns Image ID |
| [362](#L362) | protected static function save\_avatar($url, $user\_id){ |
| [363](#L363) |  |
| [364](#L364) | update\_user\_meta($user\_id, 'loginizer\_avatar\_download', true); |
| [365](#L365) |  |
| [366](#L366) | $tmp\_file = self::download\_avatar($url); |
| [367](#L367) |  |
| [368](#L368) | if(is\_wp\_error($tmp\_file) || empty($tmp\_file)){ |
| [369](#L369) | return $tmp\_file; |
| [370](#L370) | } |
| [371](#L371) |  |
| [372](#L372) | $mime = wp\_get\_image\_mime($tmp\_file); |
| [373](#L373) |  |
| [374](#L374) | $allowed\_mime = [ |
| [375](#L375) | 'image/webp' => 'webp', |
| [376](#L376) | 'image/tiff' => 'tif', |
| [377](#L377) | 'image/gif'  => 'gif', |
| [378](#L378) | 'image/jpeg' => 'jpg', |
| [379](#L379) | 'image/bmp'  => 'bmp', |
| [380](#L380) | 'image/png'  => 'png', |
| [381](#L381) | ]; |
| [382](#L382) |  |
| [383](#L383) | if(!array\_key\_exists($mime, $allowed\_mime)){ |
| [384](#L384) | error\_log('Loginizer Error: ' . \_\_('The avatar has unsupported mime type.', 'loginizer')); |
| [385](#L385) | return; |
| [386](#L386) | } |
| [387](#L387) |  |
| [388](#L388) | $upload\_dir = wp\_upload\_dir(); |
| [389](#L389) | $avatar\_upload\_dir = trailingslashit($upload\_dir['basedir']) . 'lz\_avatars'; |
| [390](#L390) |  |
| [391](#L391) | if(!wp\_mkdir\_p($avatar\_upload\_dir)){ |
| [392](#L392) | error\_log('Loginizer Error: ' . \_\_('Unable to create Directory to save avatars', 'loginizer')); |
| [393](#L393) | return; |
| [394](#L394) | } |
| [395](#L395) |  |
| [396](#L396) | $avatar\_file = wp\_hash($user\_id) .'.'. $allowed\_mime[$mime]; |
| [397](#L397) | $avatar\_file = wp\_unique\_filename($avatar\_upload\_dir, $avatar\_file); |
| [398](#L398) | $avatar\_file\_path = trailingslashit($avatar\_upload\_dir) . $avatar\_file; |
| [399](#L399) |  |
| [400](#L400) | $new\_file = copy($tmp\_file, $avatar\_file\_path); |
| [401](#L401) | unlink($tmp\_file); |
| [402](#L402) |  |
| [403](#L403) | if(empty($new\_file)){ |
| [404](#L404) | error\_log('Loginizer Error: ' . \_\_('Unable to copy the avatar from the tmp file', 'loginizer')); |
| [405](#L405) | return; |
| [406](#L406) | } |
| [407](#L407) |  |
| [408](#L408) | $avatar\_url = $upload\_dir['baseurl'] . '/lz\_avatars/' . basename($avatar\_file); |
| [409](#L409) |  |
| [410](#L410) | $attachment = [ |
| [411](#L411) | 'guid' => $avatar\_url, |
| [412](#L412) | 'post\_title' => '', |
| [413](#L413) | 'post\_content' => '', |
| [414](#L414) | 'post\_author' => $user\_id, |
| [415](#L415) | 'post\_status' => 'private', |
| [416](#L416) | 'post\_mime\_type' => $mime, |
| [417](#L417) | ]; |
| [418](#L418) |  |
| [419](#L419) | $attachment\_id = wp\_insert\_attachment($attachment, $avatar\_file\_path); |
| [420](#L420) |  |
| [421](#L421) | if(is\_wp\_error($attachment\_id)){ |
| [422](#L422) | unlink($avatar\_file\_path); |
| [423](#L423) | error\_log('Loginizer Error: ' . \_\_('Unable to create an attachment of the Avatar', 'loginizer')); |
| [424](#L424) | return; |
| [425](#L425) | } |
| [426](#L426) |  |
| [427](#L427) | global $wpdb, $blog\_id; |
| [428](#L428) |  |
| [429](#L429) | include\_once(ABSPATH . 'wp-admin/includes/image.php'); |
| [430](#L430) |  |
| [431](#L431) | wp\_update\_attachment\_metadata($attachment\_id, wp\_generate\_attachment\_metadata($attachment\_id, $avatar\_file\_path)); |
| [432](#L432) |  |
| [433](#L433) | update\_post\_meta($attachment\_id, '\_wp\_attachment\_wp\_user\_avatar', $user\_id); |
| [434](#L434) | update\_user\_meta($user\_id, $wpdb->get\_blog\_prefix($blog\_id) . 'lz\_avatar', $attachment\_id); |
| [435](#L435) |  |
| [436](#L436) | } |
| [437](#L437) |  |
| [438](#L438) | private static function download\_avatar($url){ |
| [439](#L439) |  |
| [440](#L440) | if(empty($url)){ |
| [441](#L441) | error\_log('Loginizer Error: ' . \_\_('The URL provided to download avatar is empty', 'loginizer')); |
| [442](#L442) | return; |
| [443](#L443) | } |
| [444](#L444) |  |
| [445](#L445) | $tmp\_file = uniqid(); |
| [446](#L446) |  |
| [447](#L447) | if(empty($tmp\_file)){ |
| [448](#L448) | error\_log('Loginizer Error: ' . \_\_('Unable to create a tmp file!', 'loginizer')); |
| [449](#L449) | return; |
| [450](#L450) | } |
| [451](#L451) |  |
| [452](#L452) | $response = wp\_remote\_get($url, [ |
| [453](#L453) | 'timeout' => 30, |
| [454](#L454) | 'stream' => true, |
| [455](#L455) | 'filename' => $tmp\_file, |
| [456](#L456) | ]); |
| [457](#L457) |  |
| [458](#L458) | if(is\_wp\_error($response)){ |
| [459](#L459) | unlink($tmp\_file); |
| [460](#L460) | error\_log('Loginizer Error: ' . \_\_('Download of the avatar failed!', 'loginizer')); |
| [461](#L461) | return; |
| [462](#L462) | } |
| [463](#L463) |  |
| [464](#L464) | $code = wp\_remote\_retrieve\_response\_code($response); |
| [465](#L465) |  |
| [466](#L466) | if($code != 200){ |
| [467](#L467) | unlink($tmp\_file); |
| [468](#L468) | error\_log('Loginizer Error: ' . sprintf(\_\_('Download of the avatar failed with error code %s!', 'loginizer'), esc\_html($code))); |
| [469](#L469) | return; |
| [470](#L470) | } |
| [471](#L471) |  |
| [472](#L472) | $content\_md5 = wp\_remote\_retrieve\_header($response, 'content-md5'); |
| [473](#L473) | if(!empty($content\_md5)){ |
| [474](#L474) | if(!function\_exists('verify\_file\_md5')){ |
| [475](#L475) | include\_once ABSPATH . 'wp-admin/includes/file.php'; |
| [476](#L476) | } |
| [477](#L477) |  |
| [478](#L478) | $md5\_check = verify\_file\_md5($tmp\_file, $content\_md5); |
| [479](#L479) | if(is\_wp\_error($md5\_check)){ |
| [480](#L480) | unlink($tmpfname); |
| [481](#L481) | return $md5\_check; |
| [482](#L482) | } |
| [483](#L483) | } |
| [484](#L484) |  |
| [485](#L485) | return $tmp\_file; |
| [486](#L486) | } |
| [487](#L487) |  |
| [488](#L488) | protected static function handle\_redirect($url){ |
| [489](#L489) |  |
| [490](#L490) | $redirect = ''; |
| [491](#L491) | if(empty($url)){ |
| [492](#L492) | return $redirect; |
| [493](#L493) | } |
| [494](#L494) |  |
| [495](#L495) | $url = rawurldecode($url); |
| [496](#L496) | $parsed\_url = parse\_url($url); |
| [497](#L497) |  |
| [498](#L498) | // If we have something in redirect to, then redirect to that page |
| [499](#L499) | if(!empty($parsed\_url['query'])){ |
| [500](#L500) | preg\_match('/(redirect\_to|redirect)=([^&]\*)/', $parsed\_url['query'], $redirect\_url); |
| [501](#L501) |  |
| [502](#L502) | if(!empty($redirect\_url[2])){ |
| [503](#L503) | return rawurldecode($redirect\_url[2]); |
| [504](#L504) | } |
| [505](#L505) | } |
| [506](#L506) |  |
| [507](#L507) | // Reloading the page wont show the admin page so we need to redirect it to the admin page. |
| [508](#L508) | if($parsed\_url['scheme'].'://'.$parsed\_url['host'] . $parsed\_url['path'] == wp\_login\_url()){ |
| [509](#L509) | return $redirect; |
| [510](#L510) | } |
| [511](#L511) |  |
| [512](#L512) | if(strpos(wp\_login\_url(), $parsed\_url['path']) !== FALSE){ |
| [513](#L513) | return $redirect; |
| [514](#L514) | } |
| [515](#L515) |  |
| [516](#L516) | // If none of the above happens then we will just make the page reload. |
| [517](#L517) | return $url; |
| [518](#L518) | } |
| [519](#L519) |  |
| [520](#L520) | static function trigger\_error(){ |
| [521](#L521) | if(empty(self::$error)){ |
| [522](#L522) | return; |
| [523](#L523) | } |
| [524](#L524) |  |
| [525](#L525) | // If we are testing we can just die, |
| [526](#L526) | // becuase we don't want the user to be redirected anywhere |
| [527](#L527) | if(!empty(self::$test) || (!empty(self::$storage) && self::$storage->get('test'))){ |
| [528](#L528) | wp\_die(wp\_kses\_post(current(self::$error))); |
| [529](#L529) | } |
| [530](#L530) |  |
| [531](#L531) | do\_action('wp\_login\_failed', ''); |
| [532](#L532) |  |
| [533](#L533) | self::error\_state(); |
| [534](#L534) | self::close\_tab(); // This will redirect to the appropriate page. |
| [535](#L535) | } |
| [536](#L536) |  |
| [537](#L537) | // Stores the errors to be used once redirected. |
| [538](#L538) | static function error\_state(){ |
| [539](#L539) | global $loginizer; |
| [540](#L540) |  |
| [541](#L541) | $data = [ |
| [542](#L542) | 'errors' => self::$error, |
| [543](#L543) | 'retries\_left' => $loginizer['retries\_left'] |
| [544](#L544) | ]; |
| [545](#L545) |  |
| [546](#L546) | $identifier = uniqid('lz\_social', true); |
| [547](#L547) | set\_site\_transient($identifier, $data, 300); |
| [548](#L548) |  |
| [549](#L549) | setcookie('lz\_social\_error', $identifier, time() + 300, COOKIEPATH, COOKIE\_DOMAIN, is\_ssl(), true); |
| [550](#L550) | } |
| [551](#L551) | } |
| [552](#L552) |  |
| [553](#L553) | Loginizer\_Social\_Login::login\_init(); |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/loginizer/trunk/main/social-login.php?rev=3108779&format=txt)
* [Original Format](/export/3108779/loginizer/trunk/main/social-login.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from loginizer.com_e08552b2_20250114_230925.html ===


![bannertest3](https://loginizer.com/sitepad-data/uploads/2022/01/bannertest3.png "bannertest3")

### Subscribe to Newsletter

Subscribe to get latest article or newsletter of our products

Subscribe

By entering your email, you agree to our [Terms of Service](./tos) and [Privacy Policy](./privacy).

Note: If a Loginizer account does not exist it will be created.

[Loginizer](https://loginizer.com)

* [Home](https://loginizer.com/)
* [Features](https://loginizer.com/features/)
* [Plugin](https://loginizer.com/plugin/)
* [Pricing](https://loginizer.com/pricing/)
* [Docs](https://loginizer.com/docs/)
* [About](https://loginizer.com/about/)
* [Blog](https://loginizer.com/blog/)
* [Contact](https://loginizer.com/contact/)

[Buy Now](https://www.softaculous.com/clients?ca=loginizer_buy)

# Protect your WordPress website from unauthorized access and malware

Loginizer is a simple and effortless solution that takes care of all your security problems. It comes with default optimal configuration to protect your site from Brute Force attacks.

[Explore Features](https://loginizer.com/features/)

![Loginizer banner](https://loginizer.com/sitepad-data/uploads/2024/08/banner-security-1024x622.png "Loginizer banner")

## Secure your websites with best security plugin

Add a much needed layer of security to your WordPress site. Loginizer is built to secure the core of your WordPress with multiple features like Bruteforce protection, 2FA, Captcha, MD5 Checksum and much more...

BruteForce Protection

Get protection from hackers' repeated attempts to gain access to your account with Loginizer brute force protection.

reCaptcha

reCAPTCHA protects your website from fraud and abuse using complex challenges to block malicious activities on websites.

LockOut

Set up Auto LOCKOUT for IPs after a max number of failed attempts. Optimal settings are pre-configured which you can change.

Two Factor Authentication

Configure a two-factor authentication on email, mobile, or authenticator apps for more secure logins.

Black/Whitelist IP

Create a list of trusted/untrusted IP addresses such as users and websites are allowed/blocked to login to the website .

Detailed Logs

Get detailed logs of failed attempts and all other suspicious activity with Loginizer and easily monitor them on the go.

[View All Features](https://loginizer.com/features/)

## Is your website secure enough to face security threats?

Your years of work perfecting your site and getting regular traffic to it. You have worked so hard to build an identity and a brand with your customers.

And it could all get in vain due to lack of security.

[Secure Website](https://loginizer.com/pricing/)

###### A single security fail can decrease your business.

* Getting Blacklisted by SEO

* Unable to access website

* Loss of Important data

* Hub for spreading Malware

* and much worse

![bannertest1new-1](https://loginizer.com/sitepad-data/uploads/2022/01/bannertest1new-1.png "bannertest1new-1")

## Free WordPress Plugin

Loginizer comes with a Free WordPress plugin which can be installed for instant brute force protection. Just install the plugin and your site is protected from the very first minute.

[Download](https://downloads.wordpress.org/plugin/loginizer.zip)

## Over 1 Million+ active installations on WordPress

Loginizer WordPress plugin is trusted by more than a Million active sites. Over 800+ 5 Star Reviews on wordpress.org

[Loginizer on WordPress](https://wordpress.org/plugins/loginizer/)

## Pricing

We have plans available for all types of users from 1 website personal user to 100+ websites agencies.

##### Free

# $0

Lifetime

[Get Started](https://loginizer.com/plugin/)

##### Personal

# $24

Per Year

[Get Started](https://www.softaculous.com/clients?ca=loginizer_buy&plan=personal)

##### Blogger

# $40

Per Year

[Get Started](https://www.softaculous.com/clients?ca=loginizer_buy&plan=blogger)

##### Professional

# $90

Per Year

[Get Started](https://www.softaculous.com/clients?ca=loginizer_buy&plan=professional)

##### Business

# $150

Per Year

[Get Started](https://www.softaculous.com/clients?ca=loginizer_buy&plan=business)

![bannertest2NEW-1](https://loginizer.com/sitepad-data/uploads/2022/01/bannertest2NEW-1.png "bannertest2NEW-1")

## Suggest a Feature

We are always open to suggestions.

Drop us an email with the details and we will definitely look into it.

[Contact Us](https://loginizer.com/contact/)

### Subscribe to Newsletter

Subscribe

By entering your email, you agree to our [Terms of Service](./terms) and [Privacy Policy](./privacy).

Note: If a Loginizer account does not exist it will be created.

[Loginizer](https://loginizer.com)

Loginizer is a simple and effortless solution that takes care of all
your security problems. It comes with default optimal configuration to
protect your site from Brute Force attacks.

##### About

* [About Us](https://loginizer.com/about/)

* [Features](https://loginizer.com/features/)

* [Pricing](https://loginizer.com/pricing/)

* [Blog](https://loginizer.com/blog/)

* [Contact](https://loginizer.com/contact/)

##### Support

* [Contact us](https://loginizer.com/contact/)

* [Documentation](https://loginizer.com/docs/)

* Support

* Sales Support

##### Links

* [Privacy Policy](https://loginizer.com/privacy/)

* [Terms of Service](https://loginizer.com/tos/)

##### Our Products

* [Softaculous](https://www.softaculous.com/)

* [Virtualizor](https://virtualizor.com/)

* [SitePad](https://sitepad.com/)

* [Webuzo](https://webuzo.com/)

* [PopularFX](https://popularfx.com/)

* [PageLayer](https://pagelayer.com/)

* [wpCentral](https://wpcentral.co/)

* [AMPPS](https://ampps.com/)

* [Pinguzo](https://pinguzo.com/)

* [Repositery](https://repositery.com/)

[© 2025 Loginizer](https://loginizer.com)

Open Modal Box

Newsletter Subscription
Subscribing you to the mailing list



=== Content from plugins.trac.wordpress.org_614c6fb9_20250114_230931.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3173657)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3173656 "Changeset 3173656")
* [Next Changeset](/changeset/3173658 "Changeset 3173658") →

---

# Changeset 3173657

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
10/22/2024 01:02:54 PM
([3 months](/timeline?from=2024-10-22T13%3A02%3A54Z&precision=second "See timeline at 10/22/2024 01:02:54 PM") ago)

Author:
softaculous
Message:

New version

Location:
[loginizer/trunk](/browser/loginizer/trunk?rev=3173657)
Files:

4 edited

* [init.php](/browser/loginizer/trunk/init.php?rev=3173657 "Show entry in browser")
  (modified)
  ([1 diff](#file0 "Show differences"))
* [loginizer.php](/browser/loginizer/trunk/loginizer.php?rev=3173657 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [main/social-login.php](/browser/loginizer/trunk/main/social-login.php?rev=3173657 "Show entry in browser")
  (modified)
  ([1 diff](#file2 "Show differences"))
* [readme.txt](/browser/loginizer/trunk/readme.txt?rev=3173657 "Show entry in browser")
  (modified)
  ([2 diffs](#file3 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [loginizer/trunk/init.php](/changeset/3173657/loginizer/trunk/init.php "Show the changeset 3173657 restricted to loginizer/trunk/init.php")

  | [r3160540](/browser/loginizer/trunk/init.php?rev=3160540#L6 "Show revision 3160540 of this file in browser") | [r3173657](/browser/loginizer/trunk/init.php?rev=3173657#L6 "Show revision 3173657 of this file in browser") |  |
  | --- | --- | --- |
  | 6 | 6 | } |
  | 7 | 7 |  |
  | 8 |  | define('LOGINIZER\_VERSION', '1.9.~~2~~'); |
  |  | 8 | define('LOGINIZER\_VERSION', '1.9.3'); |
  | 9 | 9 | define('LOGINIZER\_DIR', dirname(LOGINIZER\_FILE)); |
  | 10 | 10 | define('LOGINIZER\_URL', plugins\_url('', LOGINIZER\_FILE)); |
* ## [loginizer/trunk/loginizer.php](/changeset/3173657/loginizer/trunk/loginizer.php "Show the changeset 3173657 restricted to loginizer/trunk/loginizer.php")

  | [r3160540](/browser/loginizer/trunk/loginizer.php?rev=3160540#L4 "Show revision 3160540 of this file in browser") | [r3173657](/browser/loginizer/trunk/loginizer.php?rev=3173657#L4 "Show revision 3173657 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Plugin URI: https://wordpress.org/extend/plugins/loginizer/ |
  | 5 | 5 | Description: Loginizer is a WordPress plugin which helps you fight against bruteforce attack by blocking login for the IP after it reaches maximum retries allowed. You can blacklist or whitelist IPs for login using Loginizer. |
  | 6 |  | Version: 1.9.~~2~~ |
  |  | 6 | Version: 1.9.3 |
  | 7 | 7 | Text Domain: loginizer |
  | 8 | 8 | Author: Softaculous |
* ## [loginizer/trunk/main/social-login.php](/changeset/3173657/loginizer/trunk/main/social-login.php "Show the changeset 3173657 restricted to loginizer/trunk/main/social-login.php")

  | [r3108779](/browser/loginizer/trunk/main/social-login.php?rev=3108779#L124 "Show revision 3108779 of this file in browser") | [r3173657](/browser/loginizer/trunk/main/social-login.php?rev=3173657#L124 "Show revision 3173657 of this file in browser") |  |
  | --- | --- | --- |
  | 124 | 124 | $userProfile = $adapter->getUserProfile(); |
  | 125 | 125 | $accessToken = $adapter->getAccessToken(); |
  |  | 126 |  |
  |  | 127 | // Check if the user have account which is verified |
  |  | 128 | if(empty($userProfile->emailVerified)){ |
  |  | 129 | self::$error['login\_failed'] = \_\_('The social account you are using does not have a verified email.', 'loginizer'); |
  |  | 130 | $adapter->disconnect(); |
  |  | 131 | self::trigger\_error(); |
  |  | 132 | return; |
  |  | 133 | } |
  | 126 | 134 |  |
  | 127 | 135 | $data = [ |
* ## [loginizer/trunk/readme.txt](/changeset/3173657/loginizer/trunk/readme.txt "Show the changeset 3173657 restricted to loginizer/trunk/readme.txt")

  | [r3160540](/browser/loginizer/trunk/readme.txt?rev=3160540#L5 "Show revision 3160540 of this file in browser") | [r3173657](/browser/loginizer/trunk/readme.txt?rev=3173657#L5 "Show revision 3173657 of this file in browser") |  |
  | --- | --- | --- |
  | 5 | 5 | Tested up to: 6.6 |
  | 6 | 6 | Requires PHP: 5.5 |
  | 7 |  | Stable tag: 1.9.~~2~~ |
  |  | 7 | Stable tag: 1.9.3 |
  | 8 | 8 | License: LGPLv2.1 |
  | 9 | 9 | License URI: http://www.gnu.org/licenses/lgpl-2.1.html |
  | […](/browser/loginizer/trunk/readme.txt?rev=3160540#L86) | […](/browser/loginizer/trunk/readme.txt?rev=3173657#L86) |  |
  | 86 | 86 | == Changelog == |
  | 87 | 87 |  |
  |  | 88 | = 1.9.3 = |
  |  | 89 | \* [Security] There was a security issue in the Pro version of the plugin which has been fixed, was reported by wesley (wcraft)[Wordfence] |
  |  | 90 | \* [Task] Improved Compatibility with Softaculous Plugin. |
  |  | 91 |  |
  | 88 | 92 | = 1.9.2 = |
  | 89 | 93 | \* [Task] Improved license handling. |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3173657)
* [Zip Archive](?format=zip&new=3173657)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


