=== Content from www.wordfence.com_b25fafed_20250115_095009.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Pubnews <= 1.0.7 - Unauthenticated Arbitrary Plugin Installation

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Pubnews <= 1.0.7 - Unauthenticated Arbitrary Plugin Installation

8.8

**Unrestricted Upload of File with Dangerous Type**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-10578](https://www.cve.org/CVERecord?id=CVE-2024-10578) |
| --- | --- |
| CVSS | 8.8 (High) |
| Publicly Published | December 5, 2024 |
| Last Updated | December 6, 2024 |
| Researcher | [Kevin Murphy (knmurphy)](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/kevin-murphy-knmurphy) |

### Description

The Pubnews theme for WordPress is vulnerable to unauthorized arbitrary plugin installation due to a missing capability check on the pubnews\_importer\_plugin\_action\_for\_notice() function in all versions up to, and including, 1.0.7. This makes it possible for authenticated attackers, with Subscriber-level access and above, to install arbitrary plugins that can be leveraged to exploit other vulnerabilities.

#### References

* [themes.trac.wordpress.org](https://themes.trac.wordpress.org/browser/pubnews/1.0.7/inc/admin/admin.php#L1017)
* [themes.trac.wordpress.org](https://themes.trac.wordpress.org/changeset/250743/pubnews/1.0.8?contextall=1&old=245552&old_path=%2Fpubnews%2F1.0.7)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-themes%2Fpubnews%2Fpubnews-107-unauthenticated-arbitrary-plugin-installation&t=Pubnews%20%3C%3D%201.0.7%20-%20Unauthenticated%20Arbitrary%20Plugin%20Installation "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-themes%2Fpubnews%2Fpubnews-107-unauthenticated-arbitrary-plugin-installation&text=Pubnews%20%3C%3D%201.0.7%20-%20Unauthenticated%20Arbitrary%20Plugin%20Installation "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-themes%2Fpubnews%2Fpubnews-107-unauthenticated-arbitrary-plugin-installation "LinkedIn")
Email

## Vulnerability Details for Pubnews

#### [Pubnews](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-themes/pubnews)

| Software Type | Theme |
| --- | --- |
| Software Slug | pubnews [(view on wordpress.org)](https://wordpress.org/themes/pubnews) |
| Patched? | Yes |
| Remediation | Update to version 1.0.8, or a newer patched version |
| Affected Version | * <= 1.0.7 |
| Patched Version | * 1.0.8 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from themes.trac.wordpress.org_397fea8c_20250115_094958.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Make WordPress Themes](//make.wordpress.org/themes/)

* [Blog](//make.wordpress.org/themes/)
* [Trac (Theme Reviews)](//themes.trac.wordpress.org/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fthemes.trac.wordpress.org%2Fbrowser%2Fpubnews%2F1.0.7%2Finc%2Fadmin%2Fadmin.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)
* [Ticket Graph](/ticketgraph)

## Context Navigation

* [Blame](/browser/pubnews/1.0.1/inc/admin/admin.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/pubnews/1.0.7/inc/admin/admin.php)

---

# [source:](/browser?order=name "Go to repository root") [pubnews](/browser/pubnews?order=name "View pubnews")/[1.0.7](/browser/pubnews/1.0.7?order=name "View 1.0.7")/[inc](/browser/pubnews/1.0.7/inc?order=name "View inc")/[admin](/browser/pubnews/1.0.7/inc/admin?order=name "View admin")/[admin.php](/browser/pubnews/1.0.7/inc/admin/admin.php?order=name "View admin.php")

View diff against:

View revision:

| [Last change](/changeset/236191/pubnews/1.0.1/inc/admin/admin.php "View differences") on this file was [236191](/changeset/236191/ "View changeset 236191"), checked in by themedropbox, [6 months ago](/timeline?from=2024-07-24T11%3A12%3A42Z&precision=second "See timeline at 07/24/2024 11:12:42 AM") |
| --- |
| New version of Pubnews - 1.0.1 |
| * Property **svn:eol-style** set to   *`native`* | |
| **File size:** 53.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | /\*\* |
| [3](#L3) | \* Admin page |
| [4](#L4) | \* |
| [5](#L5) | \* @package Pubnews |
| [6](#L6) | \* @since 1.0.0 |
| [7](#L7) | \*/ |
| [8](#L8) |  |
| [9](#L9) | namespace Pubnews\_Admin; |
| [10](#L10) |  |
| [11](#L11) | if( ! class\_exists( 'Admin\_Page' ) ) : |
| [12](#L12) | /\*\* |
| [13](#L13) | \* Handles everything going on in the admin |
| [14](#L14) | \* |
| [15](#L15) | \* @package Pubnews |
| [16](#L16) | \* @since 1.0.0 |
| [17](#L17) | \*/ |
| [18](#L18) | class Admin\_Page { |
| [19](#L19) |  |
| [20](#L20) | /\*\* |
| [21](#L21) | \* has demo data |
| [22](#L22) | \* |
| [23](#L23) | \* @since 1.0.0 |
| [24](#L24) | \*/ |
| [25](#L25) | public $demos; |
| [26](#L26) |  |
| [27](#L27) | public $ajax\_response = []; |
| [28](#L28) |  |
| [29](#L29) | /\*\* |
| [30](#L30) | \* directory and file name of importer plugin relative to plugins directory in wp-content |
| [31](#L31) | \* |
| [32](#L32) | \* @since 1.0.0 |
| [33](#L33) | \*/ |
| [34](#L34) | public $importer\_plugin\_file = 'blaze-demo-importer/blaze-demo-importer.php'; |
| [35](#L35) |  |
| [36](#L36) | /\*\* |
| [37](#L37) | \* Zip file of importer plugin |
| [38](#L38) | \*/ |
| [39](#L39) | public $importer\_file = 'https://downloads.wordpress.org/plugin/blaze-demo-importer.zip'; |
| [40](#L40) |  |
| [41](#L41) | /\*\* |
| [42](#L42) | \* Check if theme is premium version or not |
| [43](#L43) | \*/ |
| [44](#L44) | public $is\_premium; |
| [45](#L45) |  |
| [46](#L46) | /\*\* |
| [47](#L47) | \* Get id of current user |
| [48](#L48) | \*/ |
| [49](#L49) | public $current\_user\_id; |
| [50](#L50) |  |
| [51](#L51) | /\*\* |
| [52](#L52) | \* Store the instance of class |
| [53](#L53) | \* |
| [54](#L54) | \* @since 1.0.0 |
| [55](#L55) | \*/ |
| [56](#L56) | private static $\_instance = null; |
| [57](#L57) |  |
| [58](#L58) | /\*\* |
| [59](#L59) | \* Ensures only one instance of the class is loaded or can be loaded |
| [60](#L60) | \* |
| [61](#L61) | \* @access public |
| [62](#L62) | \* @static |
| [63](#L63) | \*/ |
| [64](#L64) | public static function instance() { |
| [65](#L65) | if( is\_null( self::$\_instance ) ) { |
| [66](#L66) | self::$\_instance = new self(); |
| [67](#L67) | } |
| [68](#L68) | return self::$\_instance; |
| [69](#L69) | } |
| [70](#L70) |  |
| [71](#L71) | /\*\* |
| [72](#L72) | \* Function that runs when the class is instantiated. |
| [73](#L73) | \*/ |
| [74](#L74) | public function \_\_construct() { |
| [75](#L75) | $this->demos = include get\_template\_directory() . '/inc/admin/assets/demos.php'; |
| [76](#L76) | $this->is\_premium = preg\_match( '/-pro/', wp\_get\_theme()->get( 'TextDomain' ) ); |
| [77](#L77) | $this->current\_user\_id = get\_current\_user\_id(); |
| [78](#L78) | add\_action( 'admin\_menu', [ $this, 'pubnews\_info\_page' ], 10 ); |
| [79](#L79) | add\_action( 'admin\_enqueue\_scripts', [ $this, 'admin\_scripts' ] ); |
| [80](#L80) | add\_action( 'wp\_ajax\_pubnews\_importer\_plugin\_action', array( $this, 'pubnews\_importer\_plugin\_action' ) ); |
| [81](#L81) | new Admin\_Notices(); |
| [82](#L82) | } |
| [83](#L83) |  |
| [84](#L84) | /\*\* |
| [85](#L85) | \* Function to enqueue scripts in admin page |
| [86](#L86) | \*/ |
| [87](#L87) | public function admin\_scripts( $hook ) { |
| [88](#L88) | if( $hook == 'toplevel\_page\_pubnews-info' ) { |
| [89](#L89) | wp\_enqueue\_style( 'pubnews-info', get\_template\_directory\_uri() . '/inc/admin/assets/admin-page.css', [], PUBNEWS\_VERSION, 'all' ); |
| [90](#L90) | wp\_enqueue\_script( 'pubnews-info', get\_template\_directory\_uri() . '/inc/admin/assets/admin-page.js', [], PUBNEWS\_VERSION, true ); |
| [91](#L91) | } |
| [92](#L92) | wp\_enqueue\_script( 'pubnews-notice', get\_template\_directory\_uri() . '/inc/admin/assets/admin-notice.js', [], PUBNEWS\_VERSION, true ); |
| [93](#L93) | wp\_enqueue\_style( 'pubnews-info-notice', get\_template\_directory\_uri() . '/inc/admin/assets/admin-notice.css', [], PUBNEWS\_VERSION, 'all' ); |
| [94](#L94) | wp\_localize\_script( 'pubnews-info', 'pubnewsThemeInfoObject', array( |
| [95](#L95) | 'ajaxUrl'   => admin\_url( 'admin-ajax.php' ), |
| [96](#L96) | '\_wpnonce'  => wp\_create\_nonce( 'pubnews-theme-info-nonce' ) |
| [97](#L97) | )); |
| [98](#L98) | wp\_localize\_script( 'pubnews-notice', 'pubnewsNoticeOject', array( |
| [99](#L99) | 'ajaxUrl'   => admin\_url( 'admin-ajax.php' ), |
| [100](#L100) | '\_wpnonce'  => wp\_create\_nonce( 'pubnews-notice-nonce' ), |
| [101](#L101) | 'welcomeOption' =>  'pubnews\_welcome\_notice\_dismiss', |
| [102](#L102) | 'themeReviewOption' =>  'pubnews\_theme\_review\_notice\_dismiss', |
| [103](#L103) | 'themeReviewTempDismiss'    =>  'pubnews\_theme\_review\_notice\_temporary\_dismiss', |
| [104](#L104) | 'upsellNoticeTempDismiss'    =>  'pubnews\_upsell\_notice\_temporary\_dismiss', |
| [105](#L105) | 'themeReviewTempCount'  =>  get\_user\_meta( get\_current\_user\_id(), 'pubnews\_theme\_review\_temporary\_dismiss\_count', true ), |
| [106](#L106) | 'upsellTempCount'  =>  get\_user\_meta( get\_current\_user\_id(), 'pubnews\_upsell\_temporary\_dismiss\_count', true ), |
| [107](#L107) | 'themeReviewCountId'    =>  'pubnews\_theme\_review\_temporary\_dismiss\_count', |
| [108](#L108) | 'upsellTempCountId' =>  'pubnews\_upsell\_temporary\_dismiss\_count' |
| [109](#L109) | )); |
| [110](#L110) | } |
| [111](#L111) |  |
| [112](#L112) | /\*\* |
| [113](#L113) | \* Function to Pubnews Info admin menu page |
| [114](#L114) | \* |
| [115](#L115) | \* @since 1.0.0 |
| [116](#L116) | \*/ |
| [117](#L117) | public function pubnews\_info\_page() { |
| [118](#L118) | add\_menu\_page( |
| [119](#L119) | esc\_html\_\_( 'Pubnews Info', 'pubnews' ), |
| [120](#L120) | esc\_html\_\_( 'Pubnews Info', 'pubnews' ), |
| [121](#L121) | 'manage\_options', |
| [122](#L122) | 'pubnews-info', |
| [123](#L123) | [ $this, 'pubnews\_info\_callback' ], |
| [124](#L124) | '', |
| [125](#L125) | 59 |
| [126](#L126) | ); |
| [127](#L127) | } |
| [128](#L128) |  |
| [129](#L129) | /\*\* |
| [130](#L130) | \* Callback function when registering Pubnews Info admin menu page |
| [131](#L131) | \* |
| [132](#L132) | \* @since 1.0.0 |
| [133](#L133) | \*/ |
| [134](#L134) | public function pubnews\_info\_callback() { |
| [135](#L135) | ?> |
| [136](#L136) | <div class="pubnews-info-page" id="pubnews-info-page"> |
| [137](#L137) | <div class="pubnews-info-page-inner box-container"> |
| [138](#L138) | <div class="link-and-recommended-section"> |
| [139](#L139) | <?php |
| [140](#L140) | $this->internal\_links\_section(); |
| [141](#L141) | $this->external\_links\_section(); |
| [142](#L142) | $this->recommended\_section(); |
| [143](#L143) | ?> |
| [144](#L144) | </div> |
| [145](#L145) | <div class="starter-sites-section-wrap"> |
| [146](#L146) | <?php |
| [147](#L147) | $this->starter\_sites(); |
| [148](#L148) | $this->importer\_modal(); |
| [149](#L149) | ?> |
| [150](#L150) | </div> |
| [151](#L151) | </div> |
| [152](#L152) | </div> |
| [153](#L153) | <?php |
| [154](#L154) | } |
| [155](#L155) |  |
| [156](#L156) | /\*\* |
| [157](#L157) | \* Internal links section html |
| [158](#L158) | \* Customizer links |
| [159](#L159) | \* |
| [160](#L160) | \* @since 1.0.0 |
| [161](#L161) | \*/ |
| [162](#L162) | public function internal\_links\_section() { |
| [163](#L163) | $theme\_name = wp\_get\_theme()->get( 'Name' ); |
| [164](#L164) | $theme\_version = wp\_get\_theme()->get( 'Version' ); |
| [165](#L165) | ?> |
| [166](#L166) | <div class="internal-links-section admin--card"> |
| [167](#L167) | <div class="card-header"> |
| [168](#L168) | <h2 class="card-title"><?php echo esc\_html( 'Thank you for using '. $theme\_name . ' : ' . $theme\_version ); ?></h2> |
| [169](#L169) | <div class="card-description"><?php echo esc\_html\_\_( 'Theme provides handy customizer that allows you to modify the site looks. You can click on the below links to navigate to the particular sections.', 'pubnews' ); ?></div> |
| [170](#L170) | </div> |
| [171](#L171) | <ul class="internal-links-section-list"> |
| [172](#L172) | <li class="list-item"> |
| [173](#L173) | <span class="dashicons dashicons-admin-customizer"></span> |
| [174](#L174) | <a href="<?php echo admin\_url( 'customize.php' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'Customize Site', 'pubnews' ); ?></a> |
| [175](#L175) | </li> |
| [176](#L176) | <li class="list-item"> |
| [177](#L177) | <span class="dashicons dashicons-heading"></span> |
| [178](#L178) | <a href="<?php echo admin\_url( 'customize.php?autofocus[control]=main\_header\_section\_tab' ); ?>" target="\_blank"> |
| [179](#L179) | <?php echo esc\_html\_\_( 'Edit Header', 'pubnews' ); ?> |
| [180](#L180) | </a> |
| [181](#L181) | </li> |
| [182](#L182) | <li class="list-item"> |
| [183](#L183) | <span class="dashicons dashicons-edit"></span> |
| [184](#L184) | <a href="<?php echo admin\_url( 'customize.php?autofocus[control]=single\_post\_section\_tab' ); ?>" target="\_blank"> |
| [185](#L185) | <?php echo esc\_html\_\_( 'Edit Single Post', 'pubnews' ); ?> |
| [186](#L186) | </a> |
| [187](#L187) | </li> |
| [188](#L188) | <li class="list-item"> |
| [189](#L189) | <span class="dashicons dashicons-edit"></span> |
| [190](#L190) | <a href="<?php echo admin\_url( 'customize.php?autofocus[control]=single\_page\_width\_layout\_header' ); ?>" target="\_blank"> |
| [191](#L191) | <?php echo esc\_html\_\_( 'Edit Single Page', 'pubnews' ); ?> |
| [192](#L192) | </a> |
| [193](#L193) | </li> |
| [194](#L194) | <li class="list-item"> |
| [195](#L195) | <span class="dashicons dashicons-editor-ul"></span> |
| [196](#L196) | <a href="<?php echo admin\_url( 'customize.php?autofocus[control]=archive\_page\_layout' ); ?>" target="\_blank"> |
| [197](#L197) | <?php echo esc\_html\_\_( 'Edit Archive', 'pubnews' ); ?> |
| [198](#L198) | </a> |
| [199](#L199) | </li> |
| [200](#L200) | <li class="list-item"> |
| [201](#L201) | <span class="dashicons dashicons-hammer"></span> |
| [202](#L202) | <a href="<?php echo admin\_url( 'customize.php?autofocus[control]=footer\_option' ); ?>" target="\_blank"> |
| [203](#L203) | <?php echo esc\_html\_\_( 'Edit Footer', 'pubnews' ); ?> |
| [204](#L204) | </a> |
| [205](#L205) | </li> |
| [206](#L206) | </ul> |
| [207](#L207) | </div> |
| [208](#L208) | <?php |
| [209](#L209) | } |
| [210](#L210) |  |
| [211](#L211) | /\*\* |
| [212](#L212) | \* External links section html |
| [213](#L213) | \* Author site, documentation, demo page, etc. |
| [214](#L214) | \* |
| [215](#L215) | \* @since 1.0.0 |
| [216](#L216) | \*/ |
| [217](#L217) | public function external\_links\_section() { |
| [218](#L218) | ?> |
| [219](#L219) | <div class="external-links-section admin--card"> |
| [220](#L220) | <div class="card-header"> |
| [221](#L221) | <h2 class="card-title"><?php echo esc\_html\_\_( 'Several outside resources to help you fully understand the theme.', 'pubnews' ); ?></h2> |
| [222](#L222) | <div class="card-description"><?php echo esc\_html\_\_( 'We offer blogs, demos, documentation, and support forums for quick assistance. We hope this makes it easier for you.', 'pubnews' ); ?></div> |
| [223](#L223) | </div> |
| [224](#L224) | <ul class="external-links-section-list"> |
| [225](#L225) | <li class="list-item"> |
| [226](#L226) | <span class="dashicons dashicons-star-filled"></span> |
| [227](#L227) | <a href="<?php echo esc\_url( '//wordpress.org/support/theme/pubnews/reviews/?filter=5' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'Leave a review', 'pubnews' ); ?></a> |
| [228](#L228) | </li> |
| [229](#L229) | <li class="list-item"> |
| [230](#L230) | <span class="dashicons dashicons-media-document"></span> |
| [231](#L231) | <a href="<?php echo esc\_url( '//doc.blazethemes.com/pubnews/' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'Documentation', 'pubnews' ); ?></a> |
| [232](#L232) | </li> |
| [233](#L233) | <li class="list-item"> |
| [234](#L234) | <span class="dashicons dashicons-visibility"></span> |
| [235](#L235) | <a href="<?php echo esc\_url( '//preview.blazethemes.com/pubnews-one/' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'View demo', 'pubnews' ); ?></a> |
| [236](#L236) | </li> |
| [237](#L237) | <li class="list-item"> |
| [238](#L238) | <span class="dashicons dashicons-admin-site"></span> |
| [239](#L239) | <a href="<?php echo esc\_url( '//www.blazethemes.com' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'Official site', 'pubnews' ); ?></a> |
| [240](#L240) | </li> |
| [241](#L241) | <li class="list-item"> |
| [242](#L242) | <span class="dashicons dashicons-welcome-write-blog"></span> |
| [243](#L243) | <a href="<?php echo esc\_url( '//blazethemes.com/blog/ ' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'Blog', 'pubnews' ); ?></a> |
| [244](#L244) | </li> |
| [245](#L245) | </ul> |
| [246](#L246) | </div> |
| [247](#L247) | <?php |
| [248](#L248) | } |
| [249](#L249) |  |
| [250](#L250) | public function recommended\_section() { |
| [251](#L251) | ?> |
| [252](#L252) | <div class="recommended-section admin--card"> |
| [253](#L253) | <div class="card-header"> |
| [254](#L254) | <h2 class="card-title"><?php echo esc\_html\_\_( 'Recommended Plugins', 'pubnews' ); ?></h2> |
| [255](#L255) | <div class="card-description"><?php echo esc\_html\_\_( 'We recommend different useful plugins that can boost functionality, security, and user experience on your site.', 'pubnews' ); ?></div> |
| [256](#L256) | </div> |
| [257](#L257) | <ul class="recommended-section-list"> |
| [258](#L258) | <?php |
| [259](#L259) | /\*\* |
| [260](#L260) | \* Function - get\_plugins\_details |
| [261](#L261) | \* get plugin details like name, version, logo, etc. |
| [262](#L262) | \*/ |
| [263](#L263) | $plugin\_information = $this->get\_plugins\_details(); |
| [264](#L264) | if( ! empty( $plugin\_information ) && is\_array( $plugin\_information ) ) : |
| [265](#L265) | foreach( $plugin\_information as $key => $plugin ) : |
| [266](#L266) | ?> |
| [267](#L267) | <li class="list-item"> |
| [268](#L268) | <figure class="item-thumb"> |
| [269](#L269) | <img src="<?php echo esc\_url( $plugin['icons']['1x'] ); ?>" alt="Plugin image"> |
| [270](#L270) | </figure> |
| [271](#L271) | <div class="item-content"> |
| [272](#L272) | <h2 class="item-title"><?php echo esc\_html( $plugin['name'] ); ?></h2> |
| [273](#L273) | <span class="item-version"> |
| [274](#L274) | <?php |
| [275](#L275) | echo esc\_html\_\_( 'Version: ', 'pubnews' ); |
| [276](#L276) | echo '<strong>' . esc\_html( $plugin['version'] ) . '</strong>'; |
| [277](#L277) | ?> |
| [278](#L278) | </span> |
| [279](#L279) | <?php |
| [280](#L280) | /\*\* |
| [281](#L281) | \* Check if plugin is active, installed or inactive |
| [282](#L282) | \*/ |
| [283](#L283) | $status = $this->check\_plugin\_status( $plugin['directory'] . '/'. $plugin['file'] ); |
| [284](#L284) |  |
| [285](#L285) | /\*\* |
| [286](#L286) | \* Render plugin status button |
| [287](#L287) | \*/ |
| [288](#L288) | $button\_args = [ |
| [289](#L289) | 'link' =>  $plugin['download\_link'], |
| [290](#L290) | 'directory' =>  $plugin['directory'], |
| [291](#L291) | 'file' =>  $plugin['file'] |
| [292](#L292) | ]; |
| [293](#L293) | $this->plugin\_status\_button( $status, false, $button\_args ); |
| [294](#L294) | ?> |
| [295](#L295) | <div class="external-links"> |
| [296](#L296) | <a class="view-on-org external-link" href="<?php echo esc\_url( '//wordpress.org/plugins/' . $plugin['slug'] ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'View on Wordpress.org', 'pubnews' ); ?></a> |
| [297](#L297) | <?php |
| [298](#L298) | if( array\_key\_exists( 'dependency', $plugin ) ) echo '<span class="depedency-message">'. esc\_html( 'This plugin is an addons of ' . $plugin\_information[ $plugin['dependency'] ]['name'] ) .'</span>'; |
| [299](#L299) | if( $plugin['homepage'] ) echo '<a class="official-site external-link" href="'. esc\_url( $plugin['homepage'] ) .'" target="\_blank">'. esc\_html\_\_( 'Official site', 'pubnews' ) .'</a>'; |
| [300](#L300) | ?> |
| [301](#L301) | </div> |
| [302](#L302) | </div> |
| [303](#L303) | </li> |
| [304](#L304) | <?php |
| [305](#L305) | endforeach; |
| [306](#L306) | endif; |
| [307](#L307) | ?> |
| [308](#L308) | </ul> |
| [309](#L309) | </div> |
| [310](#L310) | <?php |
| [311](#L311) | } |
| [312](#L312) |  |
| [313](#L313) | /\*\* |
| [314](#L314) | \* All starter sites ( Demo ) |
| [315](#L315) | \* |
| [316](#L316) | \* @since 1.0.0 |
| [317](#L317) | \*/ |
| [318](#L318) | public function starter\_sites() { |
| [319](#L319) | ?> |
| [320](#L320) | <div class="starter-sites-section off-canvas"> |
| [321](#L321) | <div class="canvas-header"> |
| [322](#L322) | <h2 class="canvas-title"><?php echo esc\_html\_\_( 'All starter sites', 'pubnews' ); ?></h2> |
| [323](#L323) | <div class="canvas-description"><?php echo esc\_html\_\_( 'Lorem Ipsum is simply dummy text of the printing and typesetting industry.', 'pubnews' ); ?></div> |
| [324](#L324) | </div> |
| [325](#L325) | <div class="canvas-header is-open"> |
| [326](#L326) | <?php $this->get\_filter\_tabs(); ?> |
| [327](#L327) | <div class="canvas-search"> |
| [328](#L328) | <input type="search" name="demo\_search" id="demo\_search" placeholder="Search . . ."> |
| [329](#L329) | <span class="dashicons dashicons-search"></span> |
| [330](#L330) | </div> |
| [331](#L331) | </div> |
| [332](#L332) | <div class="demo-listing canvas-body"> |
| [333](#L333) | <?php |
| [334](#L334) | if( ! empty( $this->demos ) && is\_array( $this->demos ) ) : |
| [335](#L335) | echo '<div class="demo-items-wrap">'; |
| [336](#L336) | foreach( $this->demos as $demo\_slug => $demo ) : |
| [337](#L337) | $category = ( ! empty( $demo['tags'] ) && is\_array( $demo['tags'] ) ) ? array\_keys( $demo['tags'] ) : []; |
| [338](#L338) | ?> |
| [339](#L339) | <div class="demo-item<?php echo esc\_attr( ' ' . implode( ' ', $category ) ); ?>"> |
| [340](#L340) | <figure class="demo-thumb"> |
| [341](#L341) | <a href="<?php echo esc\_url( $demo['preview\_url'] ); ?>" target="\_blank"> |
| [342](#L342) | <img src="<?php echo esc\_url( $demo['image'] ); ?>" alt="<?php echo esc\_attr( $demo['name'] ); ?>"> |
| [343](#L343) | </a> |
| [344](#L344) | </figure> |
| [345](#L345) | <div class="demo-label-wrap"> |
| [346](#L346) | <h2 class="demo-label"><?php echo esc\_html( $demo['name'] ); ?></h2> |
| [347](#L347) | <?php $this->get\_demo\_button( $demo\_slug, $demo['preview\_url'], $demo['type'] ); ?> |
| [348](#L348) | </div> |
| [349](#L349) | </div> |
| [350](#L350) | <?php |
| [351](#L351) | endforeach; |
| [352](#L352) | echo '</div>'; |
| [353](#L353) | endif; |
| [354](#L354) | ?> |
| [355](#L355) | </div> |
| [356](#L356) | <?php |
| [357](#L357) | $status = $this->check\_plugin\_status( $this->importer\_plugin\_file ); |
| [358](#L358) | $elementClass = 'canvas-footer'; |
| [359](#L359) | $elementClass .= ' importer--' . $status; |
| [360](#L360) |  |
| [361](#L361) | ?> |
| [362](#L362) | <div class="<?php echo esc\_attr( $elementClass ); ?>"> |
| [363](#L363) | <div class="footer-inner"> |
| [364](#L364) | <span class="status-message"> |
| [365](#L365) | <?php |
| [366](#L366) | if( in\_array( $status, [ 'not-installed', 'inactive' ] ) ) : |
| [367](#L367) |  |
| [368](#L368) | $prefix = ( $status == 'not-installed' ) ? esc\_html\_\_( ' to install and activate one click demo importer plugin', 'pubnews' ) : esc\_html\_\_( ' to activate one click demo importer plugin', 'pubnews' ) ; |
| [369](#L369) | echo esc\_html\_\_( 'Click', 'pubnews' ); |
| [370](#L370) | $importer\_args = [ |
| [371](#L371) | 'link' =>  $this->importer\_file, |
| [372](#L372) | 'directory' =>  'blaze-demo-importer', |
| [373](#L373) | 'file' =>  'blaze-demo-importer.php' |
| [374](#L374) | ]; |
| [375](#L375) | $this->plugin\_status\_button( $status, true, $importer\_args ); |
| [376](#L376) | echo esc\_html( $prefix ); |
| [377](#L377) | else: |
| [378](#L378) | echo esc\_html\_\_( 'You are all set to install the demo.', 'pubnews' ); |
| [379](#L379) | endif; |
| [380](#L380) | ?> |
| [381](#L381) | </span> |
| [382](#L382) | </div> |
| [383](#L383) | </div> |
| [384](#L384) | <div class="canvas-expand"> |
| [385](#L385) | <span class="button-icon dashicons dashicons-arrow-left-alt2"></span> |
| [386](#L386) | <span class="button-label"><?php echo esc\_html\_\_( 'View all', 'pubnews' ); ?></span> |
| [387](#L387) | </div> |
| [388](#L388) | </div> |
| [389](#L389) | <?php |
| [390](#L390) | } |
| [391](#L391) |  |
| [392](#L392) | /\*\* |
| [393](#L393) | \* Render demo buttons |
| [394](#L394) | \* |
| [395](#L395) | \* @since 1.0.0 |
| [396](#L396) | \*/ |
| [397](#L397) | public function get\_demo\_button( $slug, $preview\_url = '', $type = 'pro' ) { |
| [398](#L398) | $status = $this->check\_plugin\_status( $this->importer\_plugin\_file ); |
| [399](#L399) | if( ! in\_array( $status, [ 'not-installed', 'inactive' ] ) ) : |
| [400](#L400) | ?> |
| [401](#L401) | <div class="demo-buttons"> |
| [402](#L402) | <a href="<?php echo esc\_url( $preview\_url ); ?>" target="\_blank" class="demo-preview demo-button"><?php echo esc\_html\_\_( 'Preview', 'pubnews' ); ?></a> |
| [403](#L403) | <?php |
| [404](#L404) | if( $this->is\_premium || $type == 'free' ): |
| [405](#L405) | ?> |
| [406](#L406) | <a href="#blaze-demo-importer-modal-<?php echo esc\_attr( $slug ) ?>" class="blaze-demo-importer-modal-button"> |
| [407](#L407) | <?php echo esc\_html\_\_( 'Install', 'pubnews' ); ?> |
| [408](#L408) | </a> |
| [409](#L409) | <?php |
| [410](#L410) | else: |
| [411](#L411) | ?> |
| [412](#L412) | <a href="//blazethemes.com/theme/pubnews/" class="purchase-pro" target="\_blank"> |
| [413](#L413) | <?php echo esc\_html\_\_( 'Buy Pro', 'pubnews' ); ?> |
| [414](#L414) | </a> |
| [415](#L415) | <?php |
| [416](#L416) | endif; |
| [417](#L417) | ?> |
| [418](#L418) | </div> |
| [419](#L419) | <?php |
| [420](#L420) | endif; |
| [421](#L421) | } |
| [422](#L422) |  |
| [423](#L423) | /\*\* |
| [424](#L424) | \* Function to list filter tabs |
| [425](#L425) | \* |
| [426](#L426) | \* @since 1.0.0 |
| [427](#L427) | \*/ |
| [428](#L428) | public function get\_filter\_tabs(){ |
| [429](#L429) | $list\_items = [ |
| [430](#L430) | 'all'  =>  esc\_html\_\_( 'All', 'pubnews' ) |
| [431](#L431) | ]; |
| [432](#L432) | if( ! empty( $this->demos ) && is\_array( $this->demos ) ) : |
| [433](#L433) | // for type |
| [434](#L434) | if( ! $this->is\_premium ) : |
| [435](#L435) | foreach( $this->demos as $demo ) : |
| [436](#L436) | $list\_items = array\_merge( $list\_items, [ $demo['type'] => $this->get\_demo\_label( $demo['type'] ) ] ); |
| [437](#L437) | endforeach; |
| [438](#L438) | endif; |
| [439](#L439) | // for category |
| [440](#L440) | foreach( $this->demos as $demo ) : |
| [441](#L441) | $list\_items = array\_merge( $list\_items, $demo['tags'] ); |
| [442](#L442) | endforeach; |
| [443](#L443) | endif; |
| [444](#L444) | if( ! empty( $list\_items ) && is\_array( $list\_items ) ) : |
| [445](#L445) | echo '<ul class="filter-tabs">'; |
| [446](#L446) | $count = 0; |
| [447](#L447) | foreach( $list\_items as $item\_key => $item\_value ) : |
| [448](#L448) | $tabClass = ( $count == 0 ) ? 'tab active' : 'tab'; |
| [449](#L449) | echo '<li class="' . esc\_attr( $tabClass . ' ' . $item\_key ) . '">' . esc\_html( $item\_value ) . '</li>'; |
| [450](#L450) | $count++; |
| [451](#L451) | endforeach; |
| [452](#L452) | echo '</ul>'; |
| [453](#L453) | endif; |
| [454](#L454) | } |
| [455](#L455) |  |
| [456](#L456) | /\*\* |
| [457](#L457) | \* Get demo type label |
| [458](#L458) | \* |
| [459](#L459) | \* @since 1.0.0 |
| [460](#L460) | \*/ |
| [461](#L461) | public function get\_demo\_label( $type ) { |
| [462](#L462) | if( ! $type ) return; |
| [463](#L463) | switch( $type ) : |
| [464](#L464) | case 'free': |
| [465](#L465) | return esc\_html\_\_( 'Free', 'pubnews' ); |
| [466](#L466) | break; |
| [467](#L467) | case 'pro': |
| [468](#L468) | return esc\_html\_\_( 'Pro', 'pubnews' ); |
| [469](#L469) | break; |
| [470](#L470) | default: |
| [471](#L471) | return esc\_html\_\_( 'Default', 'pubnews' ); |
| [472](#L472) | break; |
| [473](#L473) | endswitch; |
| [474](#L474) | } |
| [475](#L475) |  |
| [476](#L476) | /\*\* |
| [477](#L477) | \* Function to get plugins details using REST API |
| [478](#L478) | \* |
| [479](#L479) | \* @since 1.0.0 |
| [480](#L480) | \*/ |
| [481](#L481) | public function get\_plugins\_details() { |
| [482](#L482) | $plugins\_to\_add\_args = [ |
| [483](#L483) | [ |
| [484](#L484) | 'author'    =>  'elemntor', |
| [485](#L485) | 'slug'  =>  [ 'elementor' ], |
| [486](#L486) | 'directory' =>  [ |
| [487](#L487) | 'elementor'    =>  'elementor' |
| [488](#L488) | ], |
| [489](#L489) | 'file'  =>  [ |
| [490](#L490) | 'elementor' =>  'elementor.php' |
| [491](#L491) | ] |
| [492](#L492) | ], |
| [493](#L493) | [ |
| [494](#L494) | 'author'    =>  'blazethemes', |
| [495](#L495) | 'slug'  =>  [ 'news-kit-elementor-addons' ], |
| [496](#L496) | 'directory' =>  [ |
| [497](#L497) | 'news-kit-elementor-addons'  =>  'news-kit-elementor-addons' |
| [498](#L498) | ], |
| [499](#L499) | 'file'  =>  [ |
| [500](#L500) | 'news-kit-elementor-addons'  =>  'news-kit-elementor-addons.php', |
| [501](#L501) | ], |
| [502](#L502) | 'dependency'    =>  [ |
| [503](#L503) | 'news-kit-elementor-addons' =>  'elementor' |
| [504](#L504) | ] |
| [505](#L505) | ] |
| [506](#L506) | ]; |
| [507](#L507) | $plugin\_information = []; |
| [508](#L508) | if( ! empty( array\_column( $plugins\_to\_add\_args, 'author' ) ) && count( array\_column( $plugins\_to\_add\_args, 'author' ) ) > 0 ) : |
| [509](#L509) | if( ! empty( $plugins\_to\_add\_args ) && is\_array( $plugins\_to\_add\_args ) ) : |
| [510](#L510) | foreach( $plugins\_to\_add\_args as $plugin ) : |
| [511](#L511) | $base\_url = 'https://api.wordpress.org/plugins/info/1.2/?action=query\_plugins&request[author]='. $plugin['author']; |
| [512](#L512) | $response = wp\_remote\_get( $base\_url ); |
| [513](#L513) | if ( is\_array( $response ) && ! is\_wp\_error( $response ) ) : |
| [514](#L514) | $headers = $response['headers']; // array of http header lines |
| [515](#L515) | $body = json\_decode( $response['body'], true ); // use the content |
| [516](#L516) | if( ! empty( $body['plugins'] ) && is\_array( $body['plugins'] ) ) : |
| [517](#L517) | foreach( $body['plugins'] as $body\_key => $body\_value ) : |
| [518](#L518) | if( in\_array( $body\_value['slug'], $plugin['slug'] ) ) : |
| [519](#L519) | $body\_value['directory'] = $plugin['directory'][ $body\_value['slug'] ]; |
| [520](#L520) | $body\_value['file'] = $plugin['file'][ $body\_value['slug'] ]; |
| [521](#L521) | if( array\_key\_exists( 'dependency', $plugin ) ) $body\_value['dependency'] = $plugin['dependency'][ $body\_value['slug'] ]; |
| [522](#L522) | $plugin\_information[ $body\_value['slug'] ] = $body\_value; |
| [523](#L523) | endif; |
| [524](#L524) | endforeach; |
| [525](#L525) | endif; |
| [526](#L526) | endif; |
| [527](#L527) | endforeach; |
| [528](#L528) | endif; |
| [529](#L529) | endif; |
| [530](#L530) | return $plugin\_information; |
| [531](#L531) | } |
| [532](#L532) |  |
| [533](#L533) | /\*\* |
| [534](#L534) | \* check plugin installation and activation |
| [535](#L535) | \* |
| [536](#L536) | \* @since 1.0.0 |
| [537](#L537) | \*/ |
| [538](#L538) | public function check\_plugin\_status( $plugin\_file ) { |
| [539](#L539) | /\*\* |
| [540](#L540) | \* Gives path to plugins folder |
| [541](#L541) | \*/ |
| [542](#L542) | $status = 'not-installed'; |
| [543](#L543) | $path\_to\_plugin = WP\_PLUGIN\_DIR . '/' . esc\_attr( $plugin\_file ); |
| [544](#L544) | if( file\_exists( $path\_to\_plugin ) ) $status = ( is\_plugin\_active( $plugin\_file ) ) ? 'active' : 'inactive'; |
| [545](#L545) | return $status; |
| [546](#L546) | } |
| [547](#L547) |  |
| [548](#L548) | /\*\* |
| [549](#L549) | \* Render plugin status button |
| [550](#L550) | \* |
| [551](#L551) | \* @since 1.0.0 |
| [552](#L552) | \*/ |
| [553](#L553) | public function plugin\_status\_button( $status, $importer = false, $args = [] ) { |
| [554](#L554) | if( ! $status ) return; |
| [555](#L555) | $label = $property = $button\_property = $file = ''; |
| [556](#L556) | $class = 'nexus-status'; |
| [557](#L557) | switch( $status ) : |
| [558](#L558) | case 'not-installed' : |
| [559](#L559) | $label = $importer ? esc\_html\_\_( 'Here', 'pubnews' ) : esc\_html\_\_( 'Install and Activate', 'pubnews' ); |
| [560](#L560) | $class .= ' action-trigger not-installed'; |
| [561](#L561) | break; |
| [562](#L562) | case 'active' : |
| [563](#L563) | $class .= ' active'; |
| [564](#L564) | $property = ' disabled'; |
| [565](#L565) | $label = esc\_html\_\_( 'Installed & Activated', 'pubnews' ); |
| [566](#L566) | if( $importer ) : |
| [567](#L567) | $property = ''; |
| [568](#L568) | $class .= ' importer'; |
| [569](#L569) | $label = esc\_html\_\_( 'Import', 'pubnews' ); |
| [570](#L570) | endif; |
| [571](#L571) | break; |
| [572](#L572) | case 'inactive' : |
| [573](#L573) | $label = $importer ? esc\_html\_\_( 'activate', 'pubnews' ) : esc\_html\_\_( 'Activate', 'pubnews' ); |
| [574](#L574) | $class .= ' inactive'; |
| [575](#L575) | if( ! $importer ) $class .= ' action-trigger'; |
| [576](#L576) | break; |
| [577](#L577) | endswitch; |
| [578](#L578) | if( ! empty( $args ) && is\_array( $args ) ) : |
| [579](#L579) | $file = $args['directory'] . '/' . $args['file']; |
| [580](#L580) | $button\_property = "data-link=". esc\_url( $args['link'] ) ." data-file=". esc\_attr( $file ) .""; |
| [581](#L581) | endif; |
| [582](#L582) | echo '<button class="'. esc\_attr( $class ) .'"'. esc\_attr( $button\_property . $property ) .'>'. esc\_html( $label ) .'</button>'; |
| [583](#L583) | } |
| [584](#L584) |  |
| [585](#L585) | /\*\* |
| [586](#L586) | \* Activate or install plugins ajax call |
| [587](#L587) | \* |
| [588](#L588) | \* @since 1.0.0 |
| [589](#L589) | \*/ |
| [590](#L590) | public function pubnews\_importer\_plugin\_action() { |
| [591](#L591) | $this->plugin\_active\_install\_action( 'pubnews-theme-info-nonce' ); |
| [592](#L592) | } |
| [593](#L593) |  |
| [594](#L594) | /\*\* |
| [595](#L595) | \* Activate or install plugins |
| [596](#L596) | \* |
| [597](#L597) | \* @since 1.0.0 |
| [598](#L598) | \*/ |
| [599](#L599) | public function plugin\_active\_install\_action( $nonce = '' ) { |
| [600](#L600) | check\_ajax\_referer( $nonce, '\_wpnonce' ); |
| [601](#L601) | $\_plugin\_action = isset( $\_POST['plugin\_action'] ) ? sanitize\_text\_field( $\_POST['plugin\_action'] ) : ''; |
| [602](#L602) | $importer\_or\_not = isset( $\_POST['importer\_or\_not'] ) ? $\_POST['importer\_or\_not'] : ''; |
| [603](#L603) | $link = isset( $\_POST['link'] ) ? esc\_url( $\_POST['link'] ) : ''; |
| [604](#L604) | $file\_path = isset( $\_POST['file'] ) ? sanitize\_text\_field( $\_POST['file'] ) : ''; |
| [605](#L605) | if( $\_plugin\_action === 'inactive' ) { |
| [606](#L606) | if( $file\_path ) { |
| [607](#L607) | activate\_plugin( $file\_path, '', false, true ); |
| [608](#L608) | } |
| [609](#L609) | $this->ajax\_response['status'] = true; |
| [610](#L610) | $this->ajax\_response['message'] = ( $importer\_or\_not == 'true' ) ? esc\_html\_\_( 'Plugin activated', 'pubnews' ) : esc\_html\_\_( 'Demo importer plugin activated', 'pubnews' ); |
| [611](#L611) | $this->send\_ajax\_response(); |
| [612](#L612) | } else if( $\_plugin\_action === 'not-installed' ) { |
| [613](#L613) | $download\_link = esc\_url( $link ); |
| [614](#L614) | // Include required libs for installation |
| [615](#L615) | require\_once ABSPATH . 'wp-admin/includes/class-wp-upgrader.php'; |
| [616](#L616) | require\_once ABSPATH . 'wp-admin/includes/class-wp-ajax-upgrader-skin.php'; |
| [617](#L617) | require\_once ABSPATH . 'wp-admin/includes/class-plugin-upgrader.php'; |
| [618](#L618) | $skin = new \WP\_Ajax\_Upgrader\_Skin(); |
| [619](#L619) | $upgrader = new \Plugin\_Upgrader( $skin ); |
| [620](#L620) | $upgrader->install( $download\_link ); |
| [621](#L621) | activate\_plugin( $file\_path, '', false, true ); |
| [622](#L622) | $this->ajax\_response['status'] = true; |
| [623](#L623) | $this->ajax\_response['message'] = ( $importer\_or\_not == 'true' ) ? esc\_html\_\_( 'Plugin activated', 'pubnews' ) : esc\_html\_\_( 'Demo importer plugin activated', 'pubnews' ); |
| [624](#L624) | $this->send\_ajax\_response(); |
| [625](#L625) | } |
| [626](#L626) | $this->ajax\_response['status'] = false; |
| [627](#L627) | $this->ajax\_response['message'] = esc\_html\_\_( 'Error while trying to install or active the plugin.', 'pubnews' ); |
| [628](#L628) | $this->send\_ajax\_response(); |
| [629](#L629) | } |
| [630](#L630) |  |
| [631](#L631) | /\*\* |
| [632](#L632) | \* send ajax response to ajax call in js file |
| [633](#L633) | \* |
| [634](#L634) | \* @since 1.0.0 |
| [635](#L635) | \*/ |
| [636](#L636) | public function send\_ajax\_response() { |
| [637](#L637) | $json = wp\_json\_encode( $this->ajax\_response ); |
| [638](#L638) | echo $json; |
| [639](#L639) | die(); |
| [640](#L640) | } |
| [641](#L641) |  |
| [642](#L642) | /\*\* |
| [643](#L643) | \* Importer model |
| [644](#L644) | \* |
| [645](#L645) | \* @since 1.0.0 |
| [646](#L646) | \*/ |
| [647](#L647) | public function importer\_modal() { |
| [648](#L648) | ?> |
| [649](#L649) | <div class="wrap blaze-demo-importer-demo-importer-wrap"> |
| [650](#L650) | <?php |
| [651](#L651) | /\* Demo Modals \*/ |
| [652](#L652) | if ( is\_array( $this->demos ) && ! is\_null( $this->demos ) ) : |
| [653](#L653) | foreach ( $this->demos as $demo\_slug => $demo\_pack ) : |
| [654](#L654) | ?> |
| [655](#L655) | <div id="blaze-demo-importer-modal-<?php echo esc\_attr( $demo\_slug ) ?>" class="blaze-demo-importer-modal" style="display: none;"> |
| [656](#L656) |  |
| [657](#L657) | <div class="blaze-demo-importer-modal-header"> |
| [658](#L658) | <h2><?php printf( esc\_html( 'Import %s Demo', 'pubnews' ), esc\_html( $demo\_pack['name'] ) ); ?></h2> |
| [659](#L659) | <div class="blaze-demo-importer-modal-back"><span class="dashicons dashicons-no-alt"></span></div> |
| [660](#L660) | </div> |
| [661](#L661) |  |
| [662](#L662) | <div class="blaze-demo-importer-modal-wrap"> |
| [663](#L663) | <p><?php echo sprintf( esc\_html\_\_('We recommend you backup your website content before attempting to import the demo so that you can recover your website if something goes wrong. You can use %s plugin for it.', 'pubnews' ), '<a href="https://wordpress.org/plugins/all-in-one-wp-migration/" target="\_blank">' . esc\_html\_\_( 'All in one migration', 'pubnews' ) . '</a>' ); ?></p> |
| [664](#L664) |  |
| [665](#L665) | <p><?php echo esc\_html\_\_( 'This process will install all the required plugins, import contents and setup customizer and theme options.', 'pubnews' ); ?></p> |
| [666](#L666) |  |
| [667](#L667) | <div class="blaze-demo-importer-modal-recommended-plugins"> |
| [668](#L668) | <h4><?php esc\_html\_e( 'Required Plugins', 'pubnews' ); ?></h4> |
| [669](#L669) | <p><?php esc\_html\_e( 'For your website to look exactly like the demo,the import process will install and activate the following plugin if they are not installed or activated.', 'pubnews' ); ?></p> |
| [670](#L670) | <?php |
| [671](#L671) | $plugins = isset( $demo\_pack['plugins'] ) ? $demo\_pack['plugins'] : ''; |
| [672](#L672) |  |
| [673](#L673) | if ( is\_array( $plugins ) ) : |
| [674](#L674) | ?> |
| [675](#L675) | <ul class="blaze-demo-importer-plugin-status"> |
| [676](#L676) | <?php |
| [677](#L677) | foreach ( $plugins as $plugin\_slug => $plugin ) : |
| [678](#L678) | $name = isset( $plugin['name'] ) ? $plugin['name'] : ''; |
| [679](#L679) | $required = isset( $plugin['required'] ) ? $plugin['required'] : ''; |
| [680](#L680) | $status = $this->check\_plugin\_status( $plugin['file\_path'] ); |
| [681](#L681) | if ( $status == 'active' ) : |
| [682](#L682) | $plugin\_class = '<span class="dashicons dashicons-yes-alt"></span>'; |
| [683](#L683) | elseif ( $status == 'inactive' ) : |
| [684](#L684) | $plugin\_class = '<span class="dashicons dashicons-warning"></span>'; |
| [685](#L685) | else : |
| [686](#L686) | $plugin\_class = '<span class="dashicons dashicons-dismiss"></span>'; |
| [687](#L687) | endif; |
| [688](#L688) | ?> |
| [689](#L689) | <li class="blaze-demo-importer-<?php echo esc\_attr( $status ); ?>" data-pluginSlug="<?php echo esc\_attr( $plugin\_slug ); ?>"> |
| [690](#L690) | <input type="checkbox" name="<?php echo esc\_attr( $name ); ?>" checked <?php if( $required ) echo 'disabled'; ?>> |
| [691](#L691) | <?php echo $plugin\_class . ' ' . esc\_html( $name ) . ' - <i>' . esc\_html( $status ) . '</i>'; ?> |
| [692](#L692) | </li> |
| [693](#L693) | <?php |
| [694](#L694) | endforeach; |
| [695](#L695) | ?> |
| [696](#L696) | </ul> |
| [697](#L697) | <?php |
| [698](#L698) | else : |
| [699](#L699) | ?> |
| [700](#L700) | <ul> |
| [701](#L701) | <li><?php esc\_html\_e( 'No Required Plugins Found.', 'pubnews' ); ?></li> |
| [702](#L702) | </ul> |
| [703](#L703) | <?php |
| [704](#L704) | endif; |
| [705](#L705) | ?> |
| [706](#L706) | </div> |
| [707](#L707) |  |
| [708](#L708) | <ul class="blaze-demo-importer-reset-checkbox"> |
| [709](#L709) | <h4><?php esc\_html\_e( 'Files', 'pubnews' ) ?></h4> |
| [710](#L710) | <li> |
| [711](#L711) | <label class="blaze-demo-importer-files-checkbox"> |
| [712](#L712) | <input id="checkbox-customizer-<?php echo esc\_attr( $demo\_slug ); ?>" type="checkbox" checked="checked" /> |
| [713](#L713) | <?php echo esc\_html( 'Customizer.dat', 'pubnews' ); ?> |
| [714](#L714) | </label> |
| [715](#L715) | </li> |
| [716](#L716) | <li> |
| [717](#L717) | <label class="blaze-demo-importer-files-checkbox"> |
| [718](#L718) | <input id="checkbox-widget-<?php echo esc\_attr( $demo\_slug ); ?>" type="checkbox" checked="checked" /> |
| [719](#L719) | <?php echo esc\_html( 'Widget.wie', 'pubnews' ); ?> |
| [720](#L720) | </label> |
| [721](#L721) | </li> |
| [722](#L722) | <li> |
| [723](#L723) | <label class="blaze-demo-importer-files-checkbox"> |
| [724](#L724) | <input id="checkbox-content-<?php echo esc\_attr( $demo\_slug ); ?>" type="checkbox" checked="checked" /> |
| [725](#L725) | <?php echo esc\_html( 'Content.xml.', 'pubnews' ); ?> |
| [726](#L726) | </label> |
| [727](#L727) | </li> |
| [728](#L728) | <li> |
| [729](#L729) | <label class="blaze-demo-importer-files-checkbox"> |
| [730](#L730) | <input id="checkbox-attachment-<?php echo esc\_attr( $demo\_slug ); ?>" type="checkbox" /> |
| [731](#L731) | <?php echo esc\_html( 'Attachments like images, audios, videos, etc.', 'pubnews' ); ?> |
| [732](#L732) | </label> |
| [733](#L733) | </li> |
| [734](#L734) | </ul> |
| [735](#L735) | <a href="javascript:void(0)" class="button blaze-demo-importer-modal-cancel"><?php esc\_html\_e ( 'Cancel', 'pubnews' ); ?></a> |
| [736](#L736) | <a href="javascript:void(0)" data-demo-slug="<?php echo esc\_attr( $demo\_slug ) ?>" class="button button-primary blaze-demo-importer-import-demo"><?php esc\_html\_e( 'Import Demo', 'pubnews' ); ?></a> |
| [737](#L737) | </div> |
| [738](#L738) | </div> |
| [739](#L739) | <?php |
| [740](#L740) | endforeach; |
| [741](#L741) | endif; |
| [742](#L742) | ?> |
| [743](#L743) | <div id="blaze-demo-importer-import-progress" style="display: none"> |
| [744](#L744) | <h2 class="blaze-demo-importer-import-progress-header"><?php echo esc\_html\_\_( 'Demo Import Progress', 'pubnews' ); ?></h2> |
| [745](#L745) |  |
| [746](#L746) | <div class="blaze-demo-importer-import-progress-wrap"> |
| [747](#L747) | <div class="blaze-demo-importer-import-progress-message"><div class="message-item"></div></div> |
| [748](#L748) | <span class="progress-bar-health">0<span>%</span></span> |
| [749](#L749) | <div class="blaze-demo-importer-import-loader"> |
| [750](#L750) | <div class="loaderBar"></div> |
| [751](#L751) | </div> |
| [752](#L752) | <div class="blaze-demo-importer-import-progress-bar"> |
| [753](#L753) | <div class="loaderBar"></div> |
| [754](#L754) | </div> |
| [755](#L755) | <span class="progress-bar-note"><?php esc\_html\_e( 'Demo import success', 'pubnews' ); ?></span> |
| [756](#L756) | </div> |
| [757](#L757) | </div> |
| [758](#L758) | </div> |
| [759](#L759) | <?php |
| [760](#L760) | } |
| [761](#L761) | } |
| [762](#L762) | endif; |
| [763](#L763) |  |
| [764](#L764) |  |
| [765](#L765) | // namespace Pubnews\_Admin; |
| [766](#L766) |  |
| [767](#L767) | if( ! class\_exists( 'Admin\_Notices' ) ) : |
| [768](#L768) | /\*\* |
| [769](#L769) | \* Handles everything going on in the admin |
| [770](#L770) | \* |
| [771](#L771) | \* @package Pubnews |
| [772](#L772) | \* @since 1.0.0 |
| [773](#L773) | \*/ |
| [774](#L774) | class Admin\_Notices extends Admin\_Page { |
| [775](#L775) | /\*\* |
| [776](#L776) | \* has permission to preview notice |
| [777](#L777) | \* This is customizer option |
| [778](#L778) | \* |
| [779](#L779) | \* @since 1.0.0 |
| [780](#L780) | \*/ |
| [781](#L781) | public $notices\_permission; |
| [782](#L782) |  |
| [783](#L783) | /\*\* |
| [784](#L784) | \* ajax reponses |
| [785](#L785) | \* |
| [786](#L786) | \* @since 10.0 |
| [787](#L787) | \*/ |
| [788](#L788) | public $ajax\_response = []; |
| [789](#L789) |  |
| [790](#L790) | /\*\* |
| [791](#L791) | \* if uses does not have the required capability show this message |
| [792](#L792) | \* |
| [793](#L793) | \* @since 1.0.0 |
| [794](#L794) | \*/ |
| [795](#L795) | public $restriction\_message; |
| [796](#L796) |  |
| [797](#L797) | /\*\* |
| [798](#L798) | \* has theme activation date |
| [799](#L799) | \* |
| [800](#L800) | \* @since 1.0.0 |
| [801](#L801) | \*/ |
| [802](#L802) | public $theme\_activation\_date; |
| [803](#L803) |  |
| [804](#L804) | /\*\* |
| [805](#L805) | \* stores how long the theme has been active for |
| [806](#L806) | \* |
| [807](#L807) | \* @since 1.0.0 |
| [808](#L808) | \*/ |
| [809](#L809) | public $days\_since\_activation; |
| [810](#L810) |  |
| [811](#L811) | public function \_\_construct() { |
| [812](#L812) | $this->theme\_activation\_date = get\_option( 'pubnews\_theme\_activation\_date\_timestamp' ); |
| [813](#L813) | $this->restriction\_message = esc\_html\_\_( "You dont have permission to perform this action", "pubnews" ); |
| [814](#L814) | $this->notices\_permission = get\_theme\_mod( 'pubnews\_disable\_admin\_notices', false ); |
| [815](#L815) | $this->days\_since\_activation = round( ( current\_time( 'timestamp' ) - $this->theme\_activation\_date ) / 86400 ); |
| [816](#L816) |  |
| [817](#L817) | if( ! $this->notices\_permission ) : |
| [818](#L818) | add\_action( 'admin\_notices', [ $this, 'admin\_welcome\_notice' ] ); |
| [819](#L819) | add\_action( 'admin\_notices', [ $this, 'admin\_theme\_review\_notice' ] ); |
| [820](#L820) | add\_action( 'admin\_notices', [ $this, 'admin\_upsell\_notice' ] ); |
| [821](#L821) | endif; |
| [822](#L822) |  |
| [823](#L823) | add\_action( 'wp\_ajax\_pubnews\_admin\_notice\_ajax\_call', [ $this, 'admin\_notice\_ajax\_call' ] ); |
| [824](#L824) | add\_action( 'wp\_ajax\_pubnews\_importer\_plugin\_action\_for\_notice', [ $this, 'pubnews\_importer\_plugin\_action\_for\_notice' ] ); |
| [825](#L825) | } |
| [826](#L826) |  |
| [827](#L827) | /\*\* |
| [828](#L828) | \* Admin Welcome notice |
| [829](#L829) | \* |
| [830](#L830) | \* @since 1.0.0 |
| [831](#L831) | \*/ |
| [832](#L832) | public function admin\_welcome\_notice() { |
| [833](#L833) | if( ! current\_user\_can( 'manage\_options' ) ) return; |
| [834](#L834) |  |
| [835](#L835) | if( isset( $\_GET['page'] ) && in\_array( $\_GET['page'], [ 'pubnews-info', 'blaze-system-info' ] ) ) return; |
| [836](#L836) |  |
| [837](#L837) | if( get\_option( 'pubnews\_welcome\_notice\_dismiss' ) ) return; |
| [838](#L838) |  |
| [839](#L839) | $this->notice\_wrapper\_open('pubnews-welcome-notice notice-info'); |
| [840](#L840) | ?> |
| [841](#L841) | <div class="notice-content"> |
| [842](#L842) | <div class="notice-header"> |
| [843](#L843) | <h2 class="notice-title"><?php echo esc\_html\_\_( 'Thank you for activating Pubnews Free Version!!', 'pubnews' ); ?></h2> |
| [844](#L844) | </div> |
| [845](#L845) | <p class="notice-description"><?php echo esc\_html\_\_( 'Get started with multipurpose news theme and give your site a new look. We recommend you to please go through the documentation to get started with theme and setup homepage quicky.', 'pubnews' ); ?></p> |
| [846](#L846) | <div class="notice-actions"> |
| [847](#L847) | <a class="action-button importer" href="<?php echo admin\_url( 'admin.php?page=pubnews-info' ); ?>"><?php echo esc\_html\_\_( 'Install Demos', 'pubnews' ); ?></a> |
| [848](#L848) | <a class="action-button" href="<?php echo admin\_url( 'customize.php' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'Customize Site', 'pubnews' ); ?></a> |
| [849](#L849) | <a class="action-button" href="<?php echo esc\_url( '//doc.blazethemes.com/pubnews/' ); ?>" target="\_blank"><?php echo esc\_html\_\_( 'Documentation', 'pubnews' ); ?></a> |
| [850](#L850) | </div> |
| [851](#L851) | </div> |
| [852](#L852) | <?php $this->get\_notice\_preview(); ?> |
| [853](#L853) | <button class="alert-dismiss"><?php echo esc\_html\_\_( 'Dismiss this notice', 'pubnews' ); ?></button> |
| [854](#L854) | <?php |
| [855](#L855) | $this->notice\_wrapper\_close(); |
| [856](#L856) | } |
| [857](#L857) |  |
| [858](#L858) | /\*\* |
| [859](#L859) | \* Theme Review notice |
| [860](#L860) | \* |
| [861](#L861) | \* @since 1.0.0 |
| [862](#L862) | \*/ |
| [863](#L863) | public function admin\_theme\_review\_notice() { |
| [864](#L864) | if( ! current\_user\_can( 'manage\_options' ) ) return; |
| [865](#L865) |  |
| [866](#L866) | if( ! $this->theme\_activation\_date ) return; |
| [867](#L867) | if( $this->days\_since\_activation <= 7 ) return; |
| [868](#L868) |  |
| [869](#L869) | if( isset( $\_GET['page'] ) && in\_array( $\_GET['page'], [ 'pubnews-info', 'blaze-system-info' ] ) ) return; |
| [870](#L870) |  |
| [871](#L871) | if( get\_option( 'pubnews\_theme\_review\_notice\_dismiss' ) ) return; |
| [872](#L872) |  |
| [873](#L873) | if( get\_user\_meta( get\_current\_user\_id(), 'pubnews\_theme\_review\_temporary\_dismiss\_count', true ) == '' ) : |
| [874](#L874) | update\_user\_meta( get\_current\_user\_id(), 'pubnews\_theme\_review\_temporary\_dismiss\_count', 0 ); |
| [875](#L875) | else: |
| [876](#L876) | $temp\_dismiss\_timestamp = get\_user\_meta( get\_current\_user\_id(), 'pubnews\_theme\_review\_notice\_temporary\_dismiss', true ); |
| [877](#L877) | if( time() <= $temp\_dismiss\_timestamp ) return; |
| [878](#L878) | endif; |
| [879](#L879) |  |
| [880](#L880) | $this->notice\_wrapper\_open( 'pubnews-theme-review-notice notice-info' ); |
| [881](#L881) | ?> |
| [882](#L882) | <div class="notice-content"> |
| [883](#L883) | <div class="notice-header"> |
| [884](#L884) | <h2 class="notice-title"><?php echo esc\_html\_\_( 'We value your feedback', 'pubnews' ); ?></h2> |
| [885](#L885) | </div> |
| [886](#L886) | <p class="notice-description"><?php echo esc\_html\_\_( 'Hi, Admin. You have been using Pubnews for a while. I hope you enjoy using it. Please leave a review. It would be greateful and significant.', 'pubnews' ); ?></p> |
| [887](#L887) | <div class="notice-actions"> |
| [888](#L888) | <a class="action-button review-now" href="//wordpress.org/support/theme/pubnews/reviews/?filter=5" target="\_blank"> |
| [889](#L889) | <span class="dashicons dashicons-star-filled"></span> |
| [890](#L890) | <?php echo esc\_html\_\_( 'Review Now' , 'pubnews' ); ?> |
| [891](#L891) | </a> |
| [892](#L892) | <button class="action-button action-button-secondary may-be-later"> |
| [893](#L893) | <span class="dashicons dashicons-clock"></span> |
| [894](#L894) | <?php echo esc\_html\_\_( 'May be later' , 'pubnews' ); ?> |
| [895](#L895) | </button> |
| [896](#L896) | <button class="action-button action-button-reject review-never"><span class="dashicons dashicons-no-alt"></span><?php echo esc\_html\_\_( 'Never' , 'pubnews' ); ?></button> |
| [897](#L897) | <button class="action-button action-button-secondary already-reviewed"><span class="dashicons dashicons-thumbs-up"></span><?php echo esc\_html\_\_( 'Already did' , 'pubnews' ); ?></button> |
| [898](#L898) | </div> |
| [899](#L899) | </div> |
| [900](#L900) | <?php |
| [901](#L901) | $this->notice\_wrapper\_close(); |
| [902](#L902) | } |
| [903](#L903) |  |
| [904](#L904) | /\*\* |
| [905](#L905) | \* Theme Upsell notice |
| [906](#L906) | \* |
| [907](#L907) | \* @since 1.0.0 |
| [908](#L908) | \*/ |
| [909](#L909) | public function admin\_upsell\_notice() { |
| [910](#L910) | if( ! current\_user\_can( 'manage\_options' ) ) return; |
| [911](#L911) |  |
| [912](#L912) | if( ! $this->theme\_activation\_date ) return; |
| [913](#L913) | if( $this->days\_since\_activation <= 14 ) return; |
| [914](#L914) |  |
| [915](#L915) | if( isset( $\_GET['page'] ) && in\_array( $\_GET['page'], [ 'pubnews-info', 'blaze-system-info' ] ) ) return; |
| [916](#L916) |  |
| [917](#L917) | if( get\_user\_meta( get\_current\_user\_id(), 'pubnews\_upsell\_temporary\_dismiss\_count', true ) == '' ) : |
| [918](#L918) | update\_user\_meta( get\_current\_user\_id(), 'pubnews\_upsell\_temporary\_dismiss\_count', 0 ); |
| [919](#L919) | else: |
| [920](#L920) | $temp\_dismiss\_timestamp = get\_user\_meta( get\_current\_user\_id(), 'pubnews\_upsell\_notice\_temporary\_dismiss', true ); |
| [921](#L921) | if( time() <= $temp\_dismiss\_timestamp ) return; |
| [922](#L922) | endif; |
| [923](#L923) |  |
| [924](#L924) | $this->notice\_wrapper\_open( 'pubnews-upsell-notice notice-info' ); |
| [925](#L925) | ?> |
| [926](#L926) | <div class="notice-content"> |
| [927](#L927) | <div class="notice-header"> |
| [928](#L928) | <h2 class="notice-title"><?php echo esc\_html\_\_( 'Get the best out of Pubnews Theme', 'pubnews' ); ?></h2> |
| [929](#L929) | </div> |
| [930](#L930) | <p class="notice-description"><?php echo esc\_html\_\_( 'Upgrade to Pubnews Pro today and experience a whole new level of Pubnews Theme. With exclusive features tailored to power up your experience, the Pro subscription is your ticket to unlocking limitless possibilities.', 'pubnews' ); ?></p> |
| [931](#L931) | <div class="notice-actions"> |
| [932](#L932) | <a class="action-button upgrade-to-pro" href="//blazethemes.com/theme/pubnews-pro/" target="\_blank"> |
| [933](#L933) | <span class="dashicons dashicons-money-alt"></span><?php echo esc\_html\_\_( 'Upgrade to pro', 'pubnews' ); ?> |
| [934](#L934) | </a> |
| [935](#L935) | <button class="action-button action-button-secondary may-be-later"> |
| [936](#L936) | <span class="dashicons dashicons-clock"></span> |
| [937](#L937) | <?php echo esc\_html\_\_( 'May be later', 'pubnews' ); ?> |
| [938](#L938) | </button> |
| [939](#L939) | <button class="action-button copiable"> |
| [940](#L940) | <span class="dashicons dashicons-admin-page"></span> |
| [941](#L941) | <span class="coupon-code" data-code="PUBNEWS10"><?php echo esc\_html\_\_( 'Coupon code: PUBNEWS10', 'pubnews' ); ?></span> |
| [942](#L942) | </button> |
| [943](#L943) | </div> |
| [944](#L944) | </div> |
| [945](#L945) | <?php $this->get\_notice\_preview(); ?> |
| [946](#L946) | <?php |
| [947](#L947) | $this->notice\_wrapper\_close(); |
| [948](#L948) | } |
| [949](#L949) |  |
| [950](#L950) | /\*\* |
| [951](#L951) | \* Notice wrapper open |
| [952](#L952) | \* |
| [953](#L953) | \* @since 1.0.0 |
| [954](#L954) | \*/ |
| [955](#L955) | public function notice\_wrapper\_open( $classes = '' ) { |
| [956](#L956) | if( $classes != '' ) { |
| [957](#L957) | echo '<div class="pubnews-admin-notice notice is-dismissible ' .esc\_attr( $classes ). '">'; |
| [958](#L958) | } else { |
| [959](#L959) | echo '<div class="pubnews-admin-notice notice is-dismissible">'; |
| [960](#L960) | } |
| [961](#L961) | echo '<div class="admin-notice-inner">'; |
| [962](#L962) | } |
| [963](#L963) |  |
| [964](#L964) | /\*\* |
| [965](#L965) | \* Notice wrapper open |
| [966](#L966) | \* |
| [967](#L967) | \* @since 1.0.0 |
| [968](#L968) | \*/ |
| [969](#L969) | public function notice\_wrapper\_close() { |
| [970](#L970) | echo '</div><!-- .admin-notice-inner -->'; |
| [971](#L971) | echo '</div><!-- .pubnews-admin-notice -->'; |
| [972](#L972) | } |
| [973](#L973) |  |
| [974](#L974) | /\*\* |
| [975](#L975) | \* Notice Preview |
| [976](#L976) | \* |
| [977](#L977) | \* @since 1.0.0 |
| [978](#L978) | \*/ |
| [979](#L979) | public function get\_notice\_preview() { |
| [980](#L980) | ?> |
| [981](#L981) | <figure class="notice-preview notice-thumb"> |
| [982](#L982) | <img src="<?php echo esc\_url( get\_template\_directory\_uri() . '/screenshot.png' ); ?>" alt="Welcome" height="100" width="100"> |
| [983](#L983) | </figure> |
| [984](#L984) | <?php |
| [985](#L985) | } |
| [986](#L986) |  |
| [987](#L987) | /\*\* |
| [988](#L988) | \* Welcome notice ajax call function |
| [989](#L989) | \* |
| [990](#L990) | \* @since 1.0.0 |
| [991](#L991) | \*/ |
| [992](#L992) | public function admin\_notice\_ajax\_call() { |
| [993](#L993) | check\_ajax\_referer( 'pubnews-notice-nonce', '\_wpnonce' ); |
| [994](#L994) | if( ! current\_user\_can( 'manage\_options' ) ) wp\_die( $this->restriction\_message );  // check if user role is admin, if not display restriction message |
| [995](#L995) | $dismiss\_option = isset( $\_POST['dismiss\_option'] ) ? sanitize\_text\_field( $\_POST['dismiss\_option'] ) : ''; |
| [996](#L996) | $is\_temporary = isset( $\_POST['is\_temporary'] ) ? $\_POST['is\_temporary'] : false; |
| [997](#L997) | if( $is\_temporary ) : |
| [998](#L998) | $duration = isset( $\_POST['duration'] ) ? absint( $\_POST['duration'] ) : 7; |
| [999](#L999) | $count = isset( $\_POST['count'] ) ? absint( $\_POST['count'] ) : 1; |
| [1000](#L1000) | $count\_id = isset( $\_POST['count\_id'] ) ? sanitize\_text\_field( $\_POST['count\_id'] ) : ''; |
| [1001](#L1001) | update\_user\_meta( get\_current\_user\_id(), $dismiss\_option, time() + $duration \* 24 \* 60 \* 60 ); |
| [1002](#L1002) | update\_user\_meta( get\_current\_user\_id(), $count\_id, $count ); |
| [1003](#L1003) | else: |
| [1004](#L1004) | update\_option( $dismiss\_option, true ); |
| [1005](#L1005) | endif; |
| [1006](#L1006) | $this->ajax\_response['status'] = true; |
| [1007](#L1007) | $this->ajax\_response['message'] = esc\_html\_\_( 'Welcome notice hidden', 'pubnews' ); |
| [1008](#L1008) | $this->send\_ajax\_response(); |
| [1009](#L1009) | wp\_die(); |
| [1010](#L1010) | } |
| [1011](#L1011) |  |
| [1012](#L1012) | /\*\* |
| [1013](#L1013) | \* Activate or install plugins |
| [1014](#L1014) | \* |
| [1015](#L1015) | \* @since 1.0.0 |
| [1016](#L1016) | \*/ |
| [1017](#L1017) | public function pubnews\_importer\_plugin\_action\_for\_notice() { |
| [1018](#L1018) | $this->plugin\_active\_install\_action( 'pubnews-notice-nonce' ); |
| [1019](#L1019) | } |
| [1020](#L1020) | } |
| [1021](#L1021) | endif; |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/pubnews/1.0.7/inc/admin/admin.php?format=txt)
* [Original Format](/export/256093/pubnews/1.0.7/inc/admin/admin.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


