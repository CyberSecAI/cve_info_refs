=== Content from www.wordfence.com_65f5f27a_20250115_092147.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Category Ajax Filter <= 2.8.2 - Unauthenticated Local File Inclusion

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Category Ajax Filter <= 2.8.2 - Unauthenticated Local File Inclusion

9.8

**Improper Control of Filename for Include/Require Statement in PHP Program ('PHP Remote File Inclusion')**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H)

| CVE | [CVE-2024-10871](https://www.cve.org/CVERecord?id=CVE-2024-10871) |
| --- | --- |
| CVSS | 9.8 (Critical) |
| Publicly Published | November 8, 2024 |
| Last Updated | November 9, 2024 |
| Researcher | [Le Ngoc Anh - sun\*inc](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/le-ngoc-anh) |

### Description

The Category Ajax Filter plugin for WordPress is vulnerable to Local File Inclusion in all versions up to, and including, 2.8.2 via the 'params[caf-post-layout]' parameter. This makes it possible for unauthenticated attackers to include and execute arbitrary files on the server, allowing the execution of any PHP code in those files. This can be used to bypass access controls, obtain sensitive data, or achieve code execution in cases where files with a .php extension can be uploaded and included.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/category-ajax-filter/tags/2.8.2/includes/functions.php#L180)
* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/changeset/3183800/)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcategory-ajax-filter%2Fcategory-ajax-filter-282-unauthenticated-local-file-inclusion&t=Category%20Ajax%20Filter%20%3C%3D%202.8.2%20-%20Unauthenticated%20Local%20File%20Inclusion "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcategory-ajax-filter%2Fcategory-ajax-filter-282-unauthenticated-local-file-inclusion&text=Category%20Ajax%20Filter%20%3C%3D%202.8.2%20-%20Unauthenticated%20Local%20File%20Inclusion "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcategory-ajax-filter%2Fcategory-ajax-filter-282-unauthenticated-local-file-inclusion "LinkedIn")
Email

## Vulnerability Details for Category Ajax Filter

#### [Category Ajax Filter](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/category-ajax-filter)

| Software Type | Plugin |
| --- | --- |
| Software Slug | category-ajax-filter [(view on wordpress.org)](https://wordpress.org/plugins/category-ajax-filter) |
| Patched? | Yes |
| Remediation | Update to version 2.8.3, or a newer patched version |
| Affected Version | * <= 2.8.2 |
| Patched Version | * 2.8.3 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation



=== Content from plugins.trac.wordpress.org_a7230fca_20250115_092146.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fchangeset%2F3183800)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Changeset](/changeset/3183799 "Changeset 3183799")
* [Next Changeset](/changeset/3183801 "Changeset 3183801") →

---

# Changeset 3183800

View differences
inline
side by side

Show
lines around each change

Show the changes in full context

Ignore:

Blank lines

Case changes

White space changes

Timestamp:
11/07/2024 12:00:58 PM
([2 months](/timeline?from=2024-11-07T12%3A00%3A58Z&precision=second "See timeline at 11/07/2024 12:00:58 PM") ago)

Author:
trustyplugins
Message:

updated

Location:
[category-ajax-filter/trunk](/browser/category-ajax-filter/trunk?rev=3183800)
Files:

6 edited

* [admin/functions.php](/browser/category-ajax-filter/trunk/admin/functions.php?rev=3183800 "Show entry in browser")
  (modified)
  ([3 diffs](#file0 "Show differences"))
* [admin/tabs/appearance.php](/browser/category-ajax-filter/trunk/admin/tabs/appearance.php?rev=3183800 "Show entry in browser")
  (modified)
  ([1 diff](#file1 "Show differences"))
* [admin/tabs/variables.php](/browser/category-ajax-filter/trunk/admin/tabs/variables.php?rev=3183800 "Show entry in browser")
  (modified)
  ([2 diffs](#file2 "Show differences"))
* [category-ajax-filter.php](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3183800 "Show entry in browser")
  (modified)
  ([4 diffs](#file3 "Show differences"))
* [includes/functions.php](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3183800 "Show entry in browser")
  (modified)
  ([6 diffs](#file4 "Show differences"))
* [readme.txt](/browser/category-ajax-filter/trunk/readme.txt?rev=3183800 "Show entry in browser")
  (modified)
  ([2 diffs](#file5 "Show differences"))

### Legend:

Unmodified
Added
Removed

* ## [category-ajax-filter/trunk/admin/functions.php](/changeset/3183800/category-ajax-filter/trunk/admin/functions.php "Show the changeset 3183800 restricted to category-ajax-filter/trunk/admin/functions.php")

  | [r3089379](/browser/category-ajax-filter/trunk/admin/functions.php?rev=3089379#L15 "Show revision 3089379 of this file in browser") | [r3183800](/browser/category-ajax-filter/trunk/admin/functions.php?rev=3183800#L15 "Show revision 3183800 of this file in browser") |  |
  | --- | --- | --- |
  | 15 | 15 | register\_post\_type(self::post\_type, array( |
  | 16 | 16 | 'labels' => array( |
  | 17 |  | 'name' => \_\_('Category Filter', 'cat~~geory~~-filter'), |
  | 18 |  | 'singular\_name' => \_\_('Category Filter', 'category-filter'), |
  |  | 17 | 'name' => \_\_('Category Filter', 'category-ajax-filter'), |
  |  | 18 | 'singular\_name' => \_\_('Category Filter', 'category-ajax-filter'), |
  | 19 | 19 | ), |
  | 20 | 20 | 'public' => false, |
  | […](/browser/category-ajax-filter/trunk/admin/functions.php?rev=3089379#L24) | […](/browser/category-ajax-filter/trunk/admin/functions.php?rev=3183800#L24) |  |
  | 24 | 24 | 'show\_in\_admin\_bar' => false, |
  | 25 | 25 | 'menu\_position' => 7, |
  | 26 |  | ~~//'menu\_icon'     => TC\_CAF\_URL.'admin/images/tp icon CAF.svg',~~ |
  | 27 | 26 | 'menu\_icon' => 'dashicons-layout', |
  | 28 | 27 | 'rewrite' => false, |
  | […](/browser/category-ajax-filter/trunk/admin/functions.php?rev=3089379#L105) | […](/browser/category-ajax-filter/trunk/admin/functions.php?rev=3183800#L104) |  |
  | 105 | 104 |  |
  | 106 | 105 | update\_post\_meta($post\_id, 'caf\_terms', $terms); |
  |  | 106 | } |
  |  | 107 | if (isset($\_POST['caf-post-orders-by'])) { |
  |  | 108 | $caf\_post\_orders\_by = sanitize\_text\_field($\_POST['caf-post-orders-by']); |
  |  | 109 | update\_post\_meta($post\_id, 'caf\_post\_orders\_by', $caf\_post\_orders\_by); |
  |  | 110 | } |
  |  | 111 | if (isset($\_POST['caf-posts-order-type'])) { |
  |  | 112 | $caf\_post\_order\_type = sanitize\_text\_field($\_POST['caf-posts-order-type']); |
  |  | 113 | update\_post\_meta($post\_id, 'caf\_post\_order\_type', $caf\_post\_order\_type); |
  | 107 | 114 | } |
  | 108 | 115 | if (isset($\_POST['caf-sec-bg-color'])) { |
* ## [category-ajax-filter/trunk/admin/tabs/appearance.php](/changeset/3183800/category-ajax-filter/trunk/admin/tabs/appearance.php "Show the changeset 3183800 restricted to category-ajax-filter/trunk/admin/tabs/appearance.php")

  | [r3089379](/browser/category-ajax-filter/trunk/admin/tabs/appearance.php?rev=3089379#L225 "Show revision 3089379 of this file in browser") | [r3183800](/browser/category-ajax-filter/trunk/admin/tabs/appearance.php?rev=3183800#L225 "Show revision 3183800 of this file in browser") |  |
  | --- | --- | --- |
  | 225 | 225 | </div> |
  | 226 | 226 | <!---- END PAGINATION TOGGLE ----> |
  |  | 227 |  |
  |  | 228 |  |
  |  | 229 |  |
  |  | 230 |  |
  |  | 231 |  |
  |  | 232 | <!---- START SORTING TOGGLE ----> |
  |  | 233 |  |
  |  | 234 | <div class="tab-panel post-sorting"> |
  |  | 235 |  |
  |  | 236 | <div class="tab-header" data-content="post-sorting"><i class="fa fa-sort-numeric-asc left" aria-hidden="true"></i><?php echo esc\_html\_\_('Sorting', 'category-ajax-filter'); ?><i class="fa fa-angle-down" aria-hidden="true"></i></div> |
  |  | 237 |  |
  |  | 238 | <div class="tab-content post-sorting"> |
  |  | 239 |  |
  |  | 240 | <div class='app-tab-content' id="app-extra"> |
  |  | 241 | <!-- START POST ORDERS BY ROW GROUP --> |
  |  | 242 | <div class="col-sm-12 row-bottom"> |
  |  | 243 | <div class="form-group row"> |
  |  | 244 | <label for="caf-post-orders-by" class='col-sm-12 bold-span-title'><?php echo esc\_html\_\_('Posts Order By', 'category-ajax-filter'); ?><span class='info'><?php echo esc\_html\_\_('Set posts order by setting.', 'category-ajax-filter'); ?></span></label> |
  |  | 245 | <div class="col-sm-12"> |
  |  | 246 | <select class="form-control caf\_orders\_by" data-import="caf\_post\_orders\_by" id="caf-post-orders-by" name="caf-post-orders-by"> |
  |  | 247 | <option value="author" <?php if ($caf\_post\_orders\_by == 'author') {echo "selected";}?>>Author</option> |
  |  | 248 | <option value="title" <?php if ($caf\_post\_orders\_by == 'title') {echo "selected";}?>>Title</option> |
  |  | 249 | <option value="ID" <?php if ($caf\_post\_orders\_by == 'ID') {echo "selected";}?>>Post ID</option> |
  |  | 250 | <option value="date" <?php if ($caf\_post\_orders\_by == 'date') {echo "selected";}?>>Date</option> |
  |  | 251 | <option value="rand" <?php if ($caf\_post\_orders\_by == 'rand') {echo "selected";}?>>Random</option> |
  |  | 252 | </select> |
  |  | 253 | </div> |
  |  | 254 | </div> |
  |  | 255 | </div> |
  |  | 256 | <!-- END POST ORDERS BY ROW GROUP --> |
  |  | 257 | <!-- START POST ORDERS BY ROW GROUP --> |
  |  | 258 | <div class="col-sm-12 row-bottom"> |
  |  | 259 | <div class="form-group row"> |
  |  | 260 | <label for="caf-posts-order-type" class='col-sm-12 bold-span-title'><?php echo esc\_html\_\_('Posts Order Type', 'category-ajax-filter'); ?><span class='info'><?php echo esc\_html\_\_('Set posts order Type.', 'category-ajax-filter'); ?></span></label> |
  |  | 261 | <div class="col-sm-12"> |
  |  | 262 | <select class="form-control caf\_import" data-import="caf\_posts\_orders\_type" id="caf-posts-order-type" name="caf-posts-order-type"> |
  |  | 263 | <option value="asc" <?php if ($caf\_post\_order\_type == 'asc') {echo "selected";}?>>Asc</option> |
  |  | 264 | <option value="desc" <?php if ($caf\_post\_order\_type == 'desc') {echo "selected";}?>>Desc</option> |
  |  | 265 | </select> |
  |  | 266 | </div> |
  |  | 267 | </div> |
  |  | 268 | </div> |
  |  | 269 | <!-- END POST ORDERS BY ROW GROUP --> |
  |  | 270 |  |
  |  | 271 |  |
  |  | 272 | </div> |
  |  | 273 | </div> |
  |  | 274 | </div> |
  |  | 275 | <!---- END Sorting TOGGLE ----> |
  |  | 276 |  |
  |  | 277 |  |
  |  | 278 |  |
  |  | 279 |  |
  |  | 280 |  |
  | 227 | 281 | <?php do\_action("tc\_caf\_after\_caf\_post\_pagi\_tab");?> |
  | 228 | 282 | <!---- START POST ANIMATION TOGGLE ----> |
* ## [category-ajax-filter/trunk/admin/tabs/variables.php](/changeset/3183800/category-ajax-filter/trunk/admin/tabs/variables.php "Show the changeset 3183800 restricted to category-ajax-filter/trunk/admin/tabs/variables.php")

  | [r2915609](/browser/category-ajax-filter/trunk/admin/tabs/variables.php?rev=2915609#L23 "Show revision 2915609 of this file in browser") | [r3183800](/browser/category-ajax-filter/trunk/admin/tabs/variables.php?rev=3183800#L23 "Show revision 3183800 of this file in browser") |  |
  | --- | --- | --- |
  | 23 | 23 | $terms\_sel = array(); |
  | 24 | 24 | /\*---- APPEARANCE TAB USED DEFAULT VARIABLES ----\*/ |
  |  | 25 | $caf\_post\_orders\_by = 'title'; |
  |  | 26 | $caf\_post\_order\_type = 'asc'; |
  | 25 | 27 | $caf\_sec\_bg\_color = "#ffffff00"; |
  | 26 | 28 | $caf\_filter\_status = 'on'; |
  | […](/browser/category-ajax-filter/trunk/admin/tabs/variables.php?rev=2915609#L80) | […](/browser/category-ajax-filter/trunk/admin/tabs/variables.php?rev=3183800#L82) |  |
  | 80 | 82 | } |
  | 81 | 83 | /\*---- APPEARANCE TAB SUBMITTED VARIABLE VALUES ----\*/ |
  |  | 84 | if (get\_post\_meta($post->ID, 'caf\_post\_orders\_by')) { |
  |  | 85 | $caf\_post\_orders\_by = get\_post\_meta($post->ID, 'caf\_post\_orders\_by', true); |
  |  | 86 | } |
  |  | 87 | if (get\_post\_meta($post->ID, 'caf\_post\_order\_type')) { |
  |  | 88 | $caf\_post\_order\_type = get\_post\_meta($post->ID, 'caf\_post\_order\_type', true); |
  |  | 89 | } |
  | 82 | 90 | if (get\_post\_meta($post->ID, 'caf\_sec\_bg\_color')) { |
  | 83 | 91 | $caf\_sec\_bg\_color = get\_post\_meta($post->ID, 'caf\_sec\_bg\_color', true); |
* ## [category-ajax-filter/trunk/category-ajax-filter.php](/changeset/3183800/category-ajax-filter/trunk/category-ajax-filter.php "Show the changeset 3183800 restricted to category-ajax-filter/trunk/category-ajax-filter.php")

  | [r3089379](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3089379#L3 "Show revision 3089379 of this file in browser") | [r3183800](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3183800#L3 "Show revision 3183800 of this file in browser") |  |
  | --- | --- | --- |
  | 3 | 3 | Plugin Name: Category Ajax Filter |
  | 4 | 4 | Description: Filter posts/custom post types by category without page reload.Easy to sort/filter and display posts on page with Ajax. It Supports Divi, Elementor and other page builders. |
  | 5 |  | Version: 2.8.~~2~~ |
  |  | 5 | Version: 2.8.3 |
  | 6 | 6 | Author: Trusty Plugins |
  | 7 | 7 | Author URI: https://trustyplugins.com |
  | 8 | 8 | License: GPL3 |
  | 9 |  | License URI: http~~://www.gnu.org/licenses/gpl~~.html |
  |  | 9 | License URI: https://www.gnu.org/licenses/gpl-3.0.html |
  | 10 | 10 | Text Domain: category-ajax-filter |
  | 11 | 11 | Domain Path: /languages |
  | […](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3089379#L17) | […](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3183800#L17) |  |
  | 17 | 17 | /\*---- CONFIGURATION >>>> DEFINE CURRENT VERSION ----\*/ |
  | 18 | 18 | if (!defined('CAF\_CURRENT\_VERSION')) { |
  | 19 |  | define('CAF\_CURRENT\_VERSION', '2.8.~~2~~'); |
  |  | 19 | define('CAF\_CURRENT\_VERSION', '2.8.3'); |
  | 20 | 20 | } |
  | 21 | 21 | if (!defined('CAF\_OPTIONS')) { |
  | […](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3089379#L76) | […](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3183800#L76) |  |
  | 76 | 76 | { |
  | 77 | 77 | /\* translators: %1$s is replaced with "string" \*/ |
  | 78 |  | $message = sprintf(esc\_html\_\_('The %1$sCategory Ajax Filter PRO %2$s should be updated atleast to %1$s8.6%2$s to run properly. Please update %1$s PRO Version%2$s now or download latest version from official website.', 'category-ajax-filter~~-pro~~'), '<strong>', '</strong>'); |
  |  | 78 | $message = sprintf(esc\_html\_\_('The %1$sCategory Ajax Filter PRO %2$s should be updated atleast to %1$s8.6%2$s to run properly. Please update %1$s PRO Version%2$s now or download latest version from official website.', 'category-ajax-filter'), '<strong>', '</strong>'); |
  | 79 | 79 | printf('<div class="notice notice-error"><p>%1$s</p></div>', wp\_kses\_post($message)); |
  | 80 | 80 | } |
  | […](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3089379#L94) | […](/browser/category-ajax-filter/trunk/category-ajax-filter.php?rev=3183800#L94) |  |
  | 94 | 94 | } |
  | 95 | 95 | if (!defined('TC\_CAF\_PLUGIN\_VERSION')) { |
  | 96 |  | define('TC\_CAF\_PLUGIN\_VERSION', '2.8.~~2~~'); |
  |  | 96 | define('TC\_CAF\_PLUGIN\_VERSION', '2.8.3'); |
  | 97 | 97 | } |
  | 98 | 98 | } |
* ## [category-ajax-filter/trunk/includes/functions.php](/changeset/3183800/category-ajax-filter/trunk/includes/functions.php "Show the changeset 3183800 restricted to category-ajax-filter/trunk/includes/functions.php")

  | [r3089379](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3089379#L36 "Show revision 3089379 of this file in browser") | [r3183800](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3183800#L36 "Show revision 3183800 of this file in browser") |  |
  | --- | --- | --- |
  | 36 | 36 | $id = $atts['id']; |
  | 37 | 37 | if (!get\_post\_meta($id, 'caf\_taxonomy')) { |
  | 38 |  | return "<h2 style='background: #333348;color: #fff;font-size: 14px;line-height: 18px;padding: 10px;margin: 0;width: 100%;display: inline-block;text-align: center;border: none;text-shadow: none;box-shadow: none;'>" . esc\_html\_\_('Please select Taxonomy from specific CAF Filter. It is required to properly work for your Filter.', 'category-ajax-filter~~-pro~~') . "</h2>"; |
  |  | 38 | return "<h2 style='background: #333348;color: #fff;font-size: 14px;line-height: 18px;padding: 10px;margin: 0;width: 100%;display: inline-block;text-align: center;border: none;text-shadow: none;box-shadow: none;'>" . esc\_html\_\_('Please select Taxonomy from specific CAF Filter. It is required to properly work for your Filter.', 'category-ajax-filter') . "</h2>"; |
  | 39 | 39 | } |
  | 40 | 40 | if (!get\_post\_meta($id, 'caf\_terms')) { |
  | 41 |  | return "<h2 style='background: #333348;color: #fff;font-size: 14px;line-height: 18px;padding: 10px;margin: 0;width: 100%;display: inline-block;text-align: center;border: none;text-shadow: none;box-shadow: none;'>" . esc\_html\_\_('Please select Categories/Terms from specific CAF Filter. It is required to properly work for your Filter.', 'category-ajax-filter~~-pro~~') . "</h2>"; |
  |  | 41 | return "<h2 style='background: #333348;color: #fff;font-size: 14px;line-height: 18px;padding: 10px;margin: 0;width: 100%;display: inline-block;text-align: center;border: none;text-shadow: none;box-shadow: none;'>" . esc\_html\_\_('Please select Categories/Terms from specific CAF Filter. It is required to properly work for your Filter.', 'category-ajax-filter') . "</h2>"; |
  | 42 | 42 | } |
  | 43 | 43 | include TC\_CAF\_PATH . 'includes/front-variables.php'; |
  | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3089379#L71) | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3183800#L71) |  |
  | 71 | 71 | include $filepath; |
  | 72 | 72 | } else { |
  | 73 |  | echo "<div class='error-of-filter-layout error-caf'>" . esc\_html('Filter Layout is not Available.', '~~tc\_caf~~') . "</div>"; |
  |  | 73 | echo "<div class='error-of-filter-layout error-caf'>" . esc\_html('Filter Layout is not Available.', 'category-ajax-filter') . "</div>"; |
  | 74 | 74 | } |
  | 75 | 75 | } |
  | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3089379#L85) | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3183800#L85) |  |
  | 85 | 85 | } else { |
  | 86 | 86 | if (empty($id)) { |
  | 87 |  | echo "<div class='error-of-missing-id error-caf'>" . esc\_html\_\_('Nothing Found, Missing id as an argument.', '~~tc\_caf') . ' <a href="https://caf.trustyplugins.com/docs/documentation/getting-started/" target="\_blank">' . esc\_html\_\_('See Documentation', 'tc\_caf~~') . "</a></div>"; |
  |  | 87 | echo "<div class='error-of-missing-id error-caf'>" . esc\_html\_\_('Nothing Found, Missing id as an argument.', 'category-ajax-filter') . ' <a href="https://caf.trustyplugins.com/docs/documentation/getting-started/" target="\_blank">' . esc\_html\_\_('See Documentation', 'category-ajax-filter') . "</a></div>"; |
  | 88 | 88 | } else { |
  | 89 |  | echo "<div class='error-of-missing-id error-caf'>" . esc\_html\_\_('Nothing Found, ID Mismatched.', '~~tc\_caf') . ' <a href="https://caf.trustyplugins.com/docs/documentation/getting-started/" target="\_blank">' . esc\_html\_\_('See Documentation', 'tc\_caf~~') . "</a></div>"; |
  |  | 89 | echo "<div class='error-of-missing-id error-caf'>" . esc\_html\_\_('Nothing Found, ID Mismatched.', 'category-ajax-filter') . ' <a href="https://caf.trustyplugins.com/docs/documentation/getting-started/" target="\_blank">' . esc\_html\_\_('See Documentation', 'category-ajax-filter') . "</a></div>"; |
  | 90 | 90 | } |
  | 91 | 91 | } |
  | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3089379#L161) | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3183800#L161) |  |
  | 161 | 161 | endif; |
  | 162 | 162 | $default\_order\_by = 'title'; |
  |  | 163 | if (get\_post\_meta($filter\_id, "caf\_post\_orders\_by", true)) { |
  |  | 164 | $default\_order\_by = get\_post\_meta($filter\_id, "caf\_post\_orders\_by", true); |
  |  | 165 | } |
  | 163 | 166 | $default\_order\_by = apply\_filters('tc\_caf\_filter\_posts\_order\_by', $default\_order\_by); |
  | 164 | 167 | $default\_order = "asc"; |
  |  | 168 | if (get\_post\_meta($filter\_id, "caf\_post\_order\_type", true)) { |
  |  | 169 | $default\_order = get\_post\_meta($filter\_id, "caf\_post\_order\_type", true); |
  |  | 170 | } |
  | 165 | 171 | $default\_order = apply\_filters('tc\_caf\_filter\_posts\_order', $default\_order); |
  | 166 | 172 | /\*\*\* Setup query \*\*\*/ |
  | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3089379#L178) | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3183800#L184) |  |
  | 178 | 184 | ob\_start(); |
  | 179 | 185 | echo '<div class="status"></div>'; |
  |  | 186 | $caf\_post\_layout=sanitize\_file\_name($caf\_post\_layout); |
  | 180 | 187 | if ($caf\_post\_layout && strlen($caf\_post\_layout) > 11) { |
  | 181 | 188 | $filepath = TC\_CAF\_PATH . "includes/layouts/post/" . $caf\_post\_layout . ".php"; |
  | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3089379#L183) | […](/browser/category-ajax-filter/trunk/includes/functions.php?rev=3183800#L190) |  |
  | 183 | 190 | include\_once $filepath; |
  | 184 | 191 | } else { |
  | 185 |  | echo "<div class='error-of-post-layout error-caf'>" . esc\_html('Post Layout is not Available.', '~~tc\_caf~~') . "</div>"; |
  |  | 192 | echo "<div class='error-of-post-layout error-caf'>" . esc\_html('Post Layout is not Available.', 'category-ajax-filter') . "</div>"; |
  | 186 | 193 | $response = [ |
  | 187 | 194 | 'status' => 404, |
* ## [category-ajax-filter/trunk/readme.txt](/changeset/3183800/category-ajax-filter/trunk/readme.txt "Show the changeset 3183800 restricted to category-ajax-filter/trunk/readme.txt")

  | [r3120084](/browser/category-ajax-filter/trunk/readme.txt?rev=3120084#L4 "Show revision 3120084 of this file in browser") | [r3183800](/browser/category-ajax-filter/trunk/readme.txt?rev=3183800#L4 "Show revision 3183800 of this file in browser") |  |
  | --- | --- | --- |
  | 4 | 4 | Tags: Filter, elementor, divi, category-filter, post-filter |
  | 5 | 5 | Requires at least: 6.0 |
  | 6 |  | Tested up to: 6.~~6~~ |
  | 7 |  | Stable tag: 2.8.~~2~~ |
  |  | 6 | Tested up to: 6.7 |
  |  | 7 | Stable tag: 2.8.3 |
  | 8 | 8 | Requires PHP: 7.0 |
  | 9 |  | License: GPL~~v2 or later~~ |
  | 10 |  | License URI: https://www.gnu.org/licenses/gpl-~~2~~.0.html |
  |  | 9 | License: GPL3 |
  |  | 10 | License URI: https://www.gnu.org/licenses/gpl-3.0.html |
  | 11 | 11 |  |
  | 12 | 12 | Filter blog posts/custom post types by custom taxonomy/category without page reload and with pagination too. It has different filter and post layouts. |
  | […](/browser/category-ajax-filter/trunk/readme.txt?rev=3120084#L106) | […](/browser/category-ajax-filter/trunk/readme.txt?rev=3183800#L106) |  |
  | 106 | 106 | == Changelog == |
  | 107 | 107 |  |
  |  | 108 | = 2.8.3 = (07/11/2024) |
  |  | 109 | \* Sorting feature added at the admin settings panel. |
  |  | 110 | \* vulnerability fixed mentioned by wordfence. |
  |  | 111 |  |
  |  | 112 |  |
  | 108 | 113 | = 2.8.2 = (20/05/2024) |
  | 109 |  | \* Plugin scan~~e~~ed with 'plugin-check' and fixed all security warnings |
  |  | 114 | \* Plugin scanned with 'plugin-check' and fixed all security warnings |
  | 110 | 115 |  |
  | 111 | 116 | = 2.8.1 = (11/04/2024) |

**Note:** See [TracChangeset](/wiki/TracChangeset)
for help on using the changeset viewer.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Unified Diff](?format=diff&new=3183800)
* [Zip Archive](?format=zip&new=3183800)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from plugins.trac.wordpress.org_1a6283e9_20250115_092143.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fcategory-ajax-filter%2Ftags%2F2.8.2%2Fincludes%2Ffunctions.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* [Blame](/browser/category-ajax-filter/tags/2.8.2/includes/functions.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/category-ajax-filter/tags/2.8.2/includes/functions.php)

---

# [source:](/browser?order=name "Go to repository root") [category-ajax-filter](/browser/category-ajax-filter?order=name "View category-ajax-filter")/[tags](/browser/category-ajax-filter/tags?order=name "View tags")/[2.8.2](/browser/category-ajax-filter/tags/2.8.2?order=name "View 2.8.2")/[includes](/browser/category-ajax-filter/tags/2.8.2/includes?order=name "View includes")/[functions.php](/browser/category-ajax-filter/tags/2.8.2/includes/functions.php?order=name "View functions.php")

View diff against:

View revision:

| [Last change](/changeset/3089378/category-ajax-filter/tags/2.8.2/includes/functions.php "View differences") on this file was [3089378](/changeset/3089378/ "View changeset 3089378"), checked in by trustyplugins, [8 months ago](/timeline?from=2024-05-20T11%3A21%3A22Z&precision=second "See timeline at 05/20/2024 11:21:22 AM") |
| --- |
| readme.txt |
| **File size:** 14.2 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) | if (!defined('ABSPATH')) { |
| [3](#L3) | exit; // Exit if accessed directly |
| [4](#L4) | } |
| [5](#L5) | class CAF\_shortcode\_render |
| [6](#L6) | { |
| [7](#L7) | public function \_\_construct() |
| [8](#L8) | { |
| [9](#L9) | add\_shortcode("caf\_filter", array($this, "caf\_filter\_call")); |
| [10](#L10) | add\_filter('tc\_caf\_post\_layout\_read\_more', array($this, 'tc\_caf\_post\_layout\_read\_more'), 5, 2); |
| [11](#L11) | } |
| [12](#L12) | public function tc\_caf\_post\_layout\_read\_more($text, $id) |
| [13](#L13) | { |
| [14](#L14) | $text = \_\_('Read More', 'category-ajax-filter'); |
| [15](#L15) | return $text; |
| [16](#L16) | } |
| [17](#L17) | public function caf\_filter\_call($atts) |
| [18](#L18) | { |
| [19](#L19) | ob\_start(); |
| [20](#L20) | if (class\_exists('TC\_CAF\_PRO')) { |
| [21](#L21) | $caf\_pro\_class=new TC\_CAF\_PRO(); |
| [22](#L22) | if($caf\_pro\_class->check\_license()=='Deactivated') { |
| [23](#L23) | echo "<center style='color:red'>Error : CAF PRO's license is not activated. Please activate the license from admin panel or deactivate the PRO version.</center>"; |
| [24](#L24) | $output = ob\_get\_contents(); |
| [25](#L25) | ob\_end\_clean(); |
| [26](#L26) | return $output; |
| [27](#L27) | } |
| [28](#L28) | } |
| [29](#L29) | else { |
| [30](#L30) |  |
| [31](#L31) | $caf\_filter = new CAF\_front\_filter(); |
| [32](#L32) | static $b = 1; |
| [33](#L33) | $atts = shortcode\_atts(array( |
| [34](#L34) | 'id' => '', |
| [35](#L35) | ), $atts); |
| [36](#L36) | $id = $atts['id']; |
| [37](#L37) | if (!get\_post\_meta($id, 'caf\_taxonomy')) { |
| [38](#L38) | return "<h2 style='background: #333348;color: #fff;font-size: 14px;line-height: 18px;padding: 10px;margin: 0;width: 100%;display: inline-block;text-align: center;border: none;text-shadow: none;box-shadow: none;'>" . esc\_html\_\_('Please select Taxonomy from specific CAF Filter. It is required to properly work for your Filter.', 'category-ajax-filter-pro') . "</h2>"; |
| [39](#L39) | } |
| [40](#L40) | if (!get\_post\_meta($id, 'caf\_terms')) { |
| [41](#L41) | return "<h2 style='background: #333348;color: #fff;font-size: 14px;line-height: 18px;padding: 10px;margin: 0;width: 100%;display: inline-block;text-align: center;border: none;text-shadow: none;box-shadow: none;'>" . esc\_html\_\_('Please select Categories/Terms from specific CAF Filter. It is required to properly work for your Filter.', 'category-ajax-filter-pro') . "</h2>"; |
| [42](#L42) | } |
| [43](#L43) | include TC\_CAF\_PATH . 'includes/front-variables.php'; |
| [44](#L44) | if (get\_post\_meta($id, 'caf\_cpt\_value')) { |
| [45](#L45) | $caf\_cpt\_value = get\_post\_meta($id, 'caf\_cpt\_value', true); |
| [46](#L46) | } |
| [47](#L47) | $pt = get\_post\_type($id); |
| [48](#L48) | wp\_enqueue\_script("jquery"); |
| [49](#L49) | wp\_enqueue\_script('tc-caf-frontend-scripts'); |
| [50](#L50) | $post\_style = ("tc-caf-" . $caf\_post\_layout); |
| [51](#L51) | $filter\_style = ("tc-caf-" . $caf\_filter\_layout); |
| [52](#L52) | wp\_enqueue\_style('tc-caf-common-style'); |
| [53](#L53) | wp\_enqueue\_style($filter\_style); |
| [54](#L54) | wp\_enqueue\_style($post\_style); |
| [55](#L55) | wp\_enqueue\_style('tc-caf-font-awesome-style'); |
| [56](#L56) | $handle = "tc-caf-dynamic-style-" . $caf\_filter\_layout; |
| [57](#L57) | wp\_enqueue\_style($handle, TC\_CAF\_URL . '/assets/css/dynamic-styles.css', '', TC\_CAF\_PLUGIN\_VERSION); |
| [58](#L58) | setDynamicFilterCssFree($id, $handle, $caf\_filter\_layout, $b, 'shortcode'); |
| [59](#L59) | if (($id && !empty($id) && get\_post\_type($id) == 'caf\_posts')) { |
| [60](#L60) | if ($caf\_filter\_layout == 'filter-layout3') {$cl = 'sidebar';} else { $cl = '';} |
| [61](#L61) | //var\_dump($tax); |
| [62](#L62) | if (is\_array($tax)) { |
| [63](#L63) | $tax = implode(",", $tax); |
| [64](#L64) | } |
| [65](#L65) | //var\_dump($tax); |
| [66](#L66) | echo '<div id="caf-post-layout-container" class="caf-post-layout-container ' . esc\_attr($cl) . ' ' . esc\_attr($caf\_filter\_layout) . ' ' . esc\_attr($caf\_post\_layout) . ' data-target-div' . esc\_attr($b) . '" data-post-type="' . esc\_attr($caf\_cpt\_value) . '" data-tax="' . esc\_attr($tax) . '" data-terms="' . esc\_attr($trm) . '" data-per-page="' . esc\_attr($caf\_per\_page) . '" data-selected-terms="' . esc\_attr($trm) . '" data-filter-id="' . esc\_attr($id) . '" data-post-layout="' . esc\_attr($caf\_post\_layout) . '" data-target-div="data-target-div' . esc\_attr($b) . '">'; |
| [67](#L67) | if ($caf\_filter\_status == 'on') { |
| [68](#L68) | if ($caf\_filter\_layout && strlen($caf\_filter\_layout) > 13) { |
| [69](#L69) | $filepath = TC\_CAF\_PATH . "includes/layouts/filter/" . $caf\_filter\_layout . ".php"; |
| [70](#L70) | if (file\_exists($filepath)) { |
| [71](#L71) | include $filepath; |
| [72](#L72) | } else { |
| [73](#L73) | echo "<div class='error-of-filter-layout error-caf'>" . esc\_html('Filter Layout is not Available.', 'tc\_caf') . "</div>"; |
| [74](#L74) | } |
| [75](#L75) | } |
| [76](#L76) | } |
| [77](#L77) | setDynamicFilterCssFree($id, $handle, $caf\_post\_layout, $b, 'shortcode'); |
| [78](#L78) | echo "<div id='manage-ajax-response' class='caf-row'>"; |
| [79](#L79) | if ($caf\_post\_layout && strlen($caf\_post\_layout) > 11) { |
| [80](#L80) | echo '<div class="status"><i class="fa fa-spinner" aria-hidden="true"></i></div>'; |
| [81](#L81) | echo '<div class="content"></div>'; |
| [82](#L82) | } |
| [83](#L83) | echo "</div>"; |
| [84](#L84) | echo "</div>"; |
| [85](#L85) | } else { |
| [86](#L86) | if (empty($id)) { |
| [87](#L87) | echo "<div class='error-of-missing-id error-caf'>" . esc\_html\_\_('Nothing Found, Missing id as an argument.', 'tc\_caf') . ' <a href="https://caf.trustyplugins.com/docs/documentation/getting-started/" target="\_blank">' . esc\_html\_\_('See Documentation', 'tc\_caf') . "</a></div>"; |
| [88](#L88) | } else { |
| [89](#L89) | echo "<div class='error-of-missing-id error-caf'>" . esc\_html\_\_('Nothing Found, ID Mismatched.', 'tc\_caf') . ' <a href="https://caf.trustyplugins.com/docs/documentation/getting-started/" target="\_blank">' . esc\_html\_\_('See Documentation', 'tc\_caf') . "</a></div>"; |
| [90](#L90) | } |
| [91](#L91) | } |
| [92](#L92) | $output = ob\_get\_contents(); |
| [93](#L93) | ob\_end\_clean(); |
| [94](#L94) | $b++; |
| [95](#L95) | return $output; |
| [96](#L96) | } |
| [97](#L97) | } |
| [98](#L98) |  |
| [99](#L99) |  |
| [100](#L100) | } |
| [101](#L101) | class CAF\_get\_filter\_posts |
| [102](#L102) | { |
| [103](#L103) | public function \_\_construct() |
| [104](#L104) | { |
| [105](#L105) | add\_action('wp\_ajax\_get\_filter\_posts', array($this, 'get\_filter\_posts')); |
| [106](#L106) | add\_action('wp\_ajax\_nopriv\_get\_filter\_posts', array($this, 'get\_filter\_posts')); |
| [107](#L107) | } |
| [108](#L108) | public function get\_filter\_posts() |
| [109](#L109) | { |
| [110](#L110) | $filter\_id = sanitize\_text\_field($\_POST['params']['filter-id']); |
| [111](#L111) | $caf\_security = 'disable'; |
| [112](#L112) | if (get\_post\_meta($filter\_id, "caf\_special\_security", true)) { |
| [113](#L113) | $caf\_security = get\_post\_meta($filter\_id, "caf\_special\_security", true); |
| [114](#L114) | } |
| [115](#L115) | if ($caf\_security == 'enable') { |
| [116](#L116) | if (!isset($\_POST['nonce']) || !wp\_verify\_nonce($\_POST['nonce'], 'tc\_caf\_ajax\_nonce')) { |
| [117](#L117) | die('Permission denied'); |
| [118](#L118) | } |
| [119](#L119) |  |
| [120](#L120) | } |
| [121](#L121) | /\*\*\* Default response \*\*\*/ |
| [122](#L122) | $response = [ |
| [123](#L123) | 'status' => 500, |
| [124](#L124) | 'message' => 'Something is wrong, please try again later ...', |
| [125](#L125) | 'content' => false, |
| [126](#L126) | 'found' => 0, |
| [127](#L127) | ]; |
| [128](#L128) | $tax = sanitize\_text\_field($\_POST['params']['tax']); |
| [129](#L129) | $post\_type = sanitize\_text\_field($\_POST['params']['post-type']); |
| [130](#L130) |  |
| [131](#L131) | $term = sanitize\_text\_field($\_POST['params']['term']); |
| [132](#L132) | $page = intval($\_POST['params']['page']); |
| [133](#L133) | $per\_page = intval($\_POST['params']['per-page']); |
| [134](#L134) | $caf\_post\_layout = sanitize\_text\_field($\_POST['params']['caf-post-layout']); |
| [135](#L135) | $target\_div = sanitize\_text\_field($\_POST['params']['data-target-div']); |
| [136](#L136) | if ($per\_page == '-1') {$per\_page = '5';} |
| [137](#L137) | /\*\*\* Check if term exists \*\*\*/ |
| [138](#L138) | $terms = explode(',', $term); |
| [139](#L139) | if (!is\_array($terms)): |
| [140](#L140) | $response = [ |
| [141](#L141) | 'status' => 501, |
| [142](#L142) | 'message' => 'Term doesn\'t exist', |
| [143](#L143) | 'content' => 0, |
| [144](#L144) | ]; |
| [145](#L145) | die(wp\_json\_encode($response)); |
| [146](#L146) | else: |
| [147](#L147) | if ($terms == 'all'): |
| [148](#L148) | $tax\_qry[] = [ |
| [149](#L149) | 'taxonomy' => $tax, |
| [150](#L150) | 'field' => 'term\_id', |
| [151](#L151) | 'terms' => $terms, |
| [152](#L152) | 'operator' => 'IN', |
| [153](#L153) | ]; |
| [154](#L154) | else: |
| [155](#L155) | $tax\_qry[] = [ |
| [156](#L156) | 'taxonomy' => $tax, |
| [157](#L157) | 'field' => 'term\_id', |
| [158](#L158) | 'terms' => $terms, |
| [159](#L159) | ]; |
| [160](#L160) | endif; |
| [161](#L161) | endif; |
| [162](#L162) | $default\_order\_by = 'title'; |
| [163](#L163) | $default\_order\_by = apply\_filters('tc\_caf\_filter\_posts\_order\_by', $default\_order\_by); |
| [164](#L164) | $default\_order = "asc"; |
| [165](#L165) | $default\_order = apply\_filters('tc\_caf\_filter\_posts\_order', $default\_order); |
| [166](#L166) | /\*\*\* Setup query \*\*\*/ |
| [167](#L167) | $args = [ |
| [168](#L168) | 'paged' => $page, |
| [169](#L169) | 'post\_type' => $post\_type, |
| [170](#L170) | 'post\_status' => 'publish', |
| [171](#L171) | 'posts\_per\_page' => $per\_page, |
| [172](#L172) | // phpcs:ignore WordPress.DB.SlowDBQuery.slow\_db\_query\_tax\_query |
| [173](#L173) | 'tax\_query' => $tax\_qry, |
| [174](#L174) | 'orderby' => $default\_order\_by, |
| [175](#L175) | 'order' => $default\_order, |
| [176](#L176) | ]; |
| [177](#L177) | $qry = new WP\_Query($args); |
| [178](#L178) | ob\_start(); |
| [179](#L179) | echo '<div class="status"></div>'; |
| [180](#L180) | if ($caf\_post\_layout && strlen($caf\_post\_layout) > 11) { |
| [181](#L181) | $filepath = TC\_CAF\_PATH . "includes/layouts/post/" . $caf\_post\_layout . ".php"; |
| [182](#L182) | if (file\_exists($filepath)) { |
| [183](#L183) | include\_once $filepath; |
| [184](#L184) | } else { |
| [185](#L185) | echo "<div class='error-of-post-layout error-caf'>" . esc\_html('Post Layout is not Available.', 'tc\_caf') . "</div>"; |
| [186](#L186) | $response = [ |
| [187](#L187) | 'status' => 404, |
| [188](#L188) | 'message' => 'No posts found', |
| [189](#L189) | //'content' =>'ok', |
| [190](#L190) | ]; |
| [191](#L191) | } |
| [192](#L192) | } |
| [193](#L193) | //include\_once TC\_CAF\_PATH.'includes/layouts/post/post-layout1.php'; |
| [194](#L194) | $response['content'] = ob\_get\_clean(); |
| [195](#L195) | die(wp\_json\_encode($response)); |
| [196](#L196) | //die(); |
| [197](#L197) | } |
| [198](#L198) | } |
| [199](#L199) |  |
| [200](#L200) | class CAF\_content\_length |
| [201](#L201) | { |
| [202](#L202) | public $caf\_post\_id, $words; |
| [203](#L203) | public function get\_caf\_content($caf\_post\_id) |
| [204](#L204) | { |
| [205](#L205) | $content = get\_the\_content(); |
| [206](#L206) | $content = preg\_replace('#\[[^\]]+\]#', '', $content); |
| [207](#L207) | $content = wp\_trim\_words($content, '40'); |
| [208](#L208) | return $content; |
| [209](#L209) | } |
| [210](#L210) |  |
| [211](#L211) | public function get\_caf\_content2($caf\_post\_id, $words) |
| [212](#L212) | { |
| [213](#L213) | $content = get\_the\_content(); |
| [214](#L214) | $content = preg\_replace('#\[[^\]]+\]#', '', $content); |
| [215](#L215) | $content = wp\_trim\_words($content, $words); |
| [216](#L216) | return $content; |
| [217](#L217) | } |
| [218](#L218) | } |
| [219](#L219) |  |
| [220](#L220) | class CAF\_front\_filter |
| [221](#L221) | { |
| [222](#L222) | public function \_\_construct() |
| [223](#L223) | { |
| [224](#L224) |  |
| [225](#L225) | add\_filter('tc\_caf\_add\_custom\_list\_before\_filter', array($this, 'tc\_caf\_add\_custom\_list\_before\_filter'), 5); |
| [226](#L226) | add\_filter('tc\_caf\_add\_custom\_span\_before\_filter', array($this, 'tc\_caf\_add\_custom\_span\_before\_filter'), 5); |
| [227](#L227) | add\_filter('tc\_caf\_custom\_title\_before\_sidebar\_filter', array($this, 'tc\_caf\_custom\_title\_before\_sidebar\_filter'), 5); |
| [228](#L228) | add\_filter('tc\_caf\_filter\_order\_by', array($this, 'tc\_caf\_filter\_order\_by'), 5, 1); |
| [229](#L229) | add\_filter('tc\_caf\_filter\_all\_text', array($this, 'tc\_caf\_filter\_all\_text'), 5, 1); |
| [230](#L230) | add\_filter('tc\_caf\_filter\_posts\_order\_by', array($this, 'tc\_caf\_filter\_posts\_order\_by'), 5, 1); |
| [231](#L231) | add\_filter('tc\_caf\_filter\_posts\_order', array($this, 'tc\_caf\_filter\_posts\_order'), 5, 1); |
| [232](#L232) | } |
| [233](#L233) |  |
| [234](#L234) | public function tc\_caf\_add\_custom\_span\_before\_filter() |
| [235](#L235) | { |
| [236](#L236) | return esc\_html\_\_('I want to check out ', 'category-ajax-filter'); |
| [237](#L237) | } |
| [238](#L238) | public function tc\_caf\_add\_custom\_list\_before\_filter() |
| [239](#L239) | { |
| [240](#L240) | return esc\_html\_\_('Everything', 'category-ajax-filter'); |
| [241](#L241) | } |
| [242](#L242) | public function tc\_caf\_custom\_title\_before\_sidebar\_filter() |
| [243](#L243) | { |
| [244](#L244) | return esc\_html\_e('Categories', 'category-ajax-filter'); |
| [245](#L245) |  |
| [246](#L246) | } |
| [247](#L247) | public function tc\_caf\_filter\_order\_by($terms\_sel) |
| [248](#L248) | { |
| [249](#L249) | return $terms\_sel; |
| [250](#L250) | } |
| [251](#L251) | public function tc\_caf\_filter\_posts\_order\_by($default) |
| [252](#L252) | { |
| [253](#L253) | return 'title'; |
| [254](#L254) | } |
| [255](#L255) | public function tc\_caf\_filter\_posts\_order($default) |
| [256](#L256) | { |
| [257](#L257) | return 'asc'; |
| [258](#L258) | } |
| [259](#L259) | public function tc\_caf\_filter\_all\_text($all\_text) |
| [260](#L260) | { |
| [261](#L261) | return \_\_('All', 'category-ajax-filter'); |
| [262](#L262) | } |
| [263](#L263) | } |
| [264](#L264) | class CAF\_ajax\_pagination |
| [265](#L265) | { |
| [266](#L266) | public function caf\_ajax\_pager($query, $paged, $caf\_post\_layout, $caf\_pagi\_type, $filter\_id) |
| [267](#L267) | { |
| [268](#L268) | //echo $caf\_pagi\_type; |
| [269](#L269) | // $filter\_id |
| [270](#L270) | if (class\_exists("TC\_CAF\_PRO")) { |
| [271](#L271) | $caf\_pagination\_status = 'on'; |
| [272](#L272) | if (get\_post\_meta($filter\_id, 'caf\_pagination\_status')) { |
| [273](#L273) | $caf\_pagination\_status = get\_post\_meta($filter\_id, 'caf\_pagination\_status', true); |
| [274](#L274) | } |
| [275](#L275) | if ($caf\_pagination\_status == "off") { |
| [276](#L276) | return; |
| [277](#L277) | } |
| [278](#L278) | } |
| [279](#L279) | if ($caf\_pagi\_type == 'number') { |
| [280](#L280) | $this->caf\_number\_pagination($query, $paged, $caf\_post\_layout, $caf\_pagi\_type, $filter\_id); |
| [281](#L281) | } else { |
| [282](#L282) | if (class\_exists("TC\_CAF\_PRO")) { |
| [283](#L283) | include TC\_CAF\_PRO\_PATH . "includes/pagination.php"; |
| [284](#L284) | } else { |
| [285](#L285) | $this->caf\_number\_pagination($query, $paged, $caf\_post\_layout, $caf\_pagi\_type, $filter\_id); |
| [286](#L286) | } |
| [287](#L287) | } |
| [288](#L288) | } |
| [289](#L289) | public function caf\_number\_pagination($query, $paged, $caf\_post\_layout, $caf\_pagi\_type, $filter\_id) |
| [290](#L290) | { |
| [291](#L291) | if (!$query) { |
| [292](#L292) | return; |
| [293](#L293) | } |
| [294](#L294) |  |
| [295](#L295) | $prev\_text = 'Prev'; |
| [296](#L296) | $next\_text = 'Next'; |
| [297](#L297) | $prev\_text = apply\_filters('tc\_caf\_filter\_prev\_text', $prev\_text, $filter\_id); |
| [298](#L298) | $next\_text = apply\_filters('tc\_caf\_filter\_next\_text', $next\_text, $filter\_id); |
| [299](#L299) |  |
| [300](#L300) | $paginate = paginate\_links([ |
| [301](#L301) | 'base' => '%\_%', |
| [302](#L302) | 'type' => 'array', |
| [303](#L303) | 'total' => $query->max\_num\_pages, |
| [304](#L304) | 'format' => '#page=%#%', |
| [305](#L305) | 'current' => max(1, $paged), |
| [306](#L306) | 'prev\_text' => $prev\_text, |
| [307](#L307) | 'next\_text' => $next\_text, |
| [308](#L308) | ]); |
| [309](#L309) | if ($query->max\_num\_pages > 1): ?> |
| [310](#L310) | <ul id="caf-layout-pagination" class="caf-pagination <?php echo esc\_attr($caf\_post\_layout); ?>"> |
| [311](#L311) | <?php foreach ($paginate as $page): ?> |
| [312](#L312) | <li><?php echo wp\_kses\_post($page); ?></li> |
| [313](#L313) | <?php endforeach;?> |
| [314](#L314) | </ul> |
| [315](#L315) | <?php endif; |
| [316](#L316) | } |
| [317](#L317) | } |
| [318](#L318) | new CAF\_get\_filter\_posts(); |
| [319](#L319) | if (class\_exists("TC\_CAF\_PRO")) { |
| [320](#L320) | if (!defined('TC\_CAF\_PRO\_PATH')) { |
| [321](#L321) | $caf\_pr=new TC\_CAF\_PRO(); |
| [322](#L322) | $caf\_pr->tc\_caf\_plugin\_constants(); |
| [323](#L323) | if(file\_exists(TC\_CAF\_PRO\_PATH.'/admin/post-class.php')) { |
| [324](#L324) | include TC\_CAF\_PRO\_PATH.'/admin/post-class.php'; |
| [325](#L325) | } |
| [326](#L326) | } |
| [327](#L327) | else { |
| [328](#L328) | if(file\_exists(TC\_CAF\_PRO\_PATH.'/admin/post-class.php')) { |
| [329](#L329) | include TC\_CAF\_PRO\_PATH.'/admin/post-class.php'; |
| [330](#L330) | } |
| [331](#L331) | } |
| [332](#L332) | } |
| [333](#L333) | else { |
| [334](#L334) | //echo "no"; |
| [335](#L335) | include TC\_CAF\_PATH.'/includes/post-class.php'; |
| [336](#L336) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/category-ajax-filter/tags/2.8.2/includes/functions.php?format=txt)
* [Original Format](/export/3222710/category-ajax-filter/tags/2.8.2/includes/functions.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


