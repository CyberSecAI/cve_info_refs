=== Content from bugzilla.mozilla.org_87db2f5b_20250114_181702.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1880879)
* [XML](/show_bug.cgi?ctype=xml&id=1880879)

Closed
[Bug 1880879](/show_bug.cgi?id=1880879)
(CVE-2024-10941)

Opened 11 months ago
Closed 8 months ago

# Parent process crash with iframe with src=file:. or src=file:..

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Parent process crash with iframe with src=file:. or src=file:..

## Categories

### (Core :: DOM: Security, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Security#DOM%3A%20Security)

DOM: Security
▾

Core :: DOM: Security
Native content-based security features including: Content Security Policy (CSP), Mixed Content Blocker (MCB), and Safe Browsing.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Security&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Security)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Firefox 122

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Desktop

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S2

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr115 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix) |
| firefox123 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix) |
| firefox124 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix) |
| firefox125 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix) |
| firefox126 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | wontfix |
| firefox-esr128 | --- | --- |
| firefox123 |  | wontfix |
| firefox124 |  | wontfix |
| firefox125 |  | wontfix |
| firefox126 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: malware0x0, Assigned: tschuster)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/bea8610031d37382d80ff1cc78a063c6?d=mm&size=40)  [malware0x0](/user_profile?user_id=743601)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/1f41f3ef916e1c1fc9401cf3212a6708?d=mm&size=40)  [freddy](/user_profile?user_id=428608)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1887614](/show_bug.cgi?id=1887614 "RESOLVED FIXED - Incorrect parsing of <file:.> URL")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")

Dependency [tree](/showdependencytree.cgi?id=1880879&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1880879)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (6 keywords, Whiteboard: [domsecurity-active][crash fixed in v126 by 1887614])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2024-10941

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-low](/buglist.cgi?keywords=sec-low&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[domsecurity-active][crash fixed in v126 by 1887614]

QA Whiteboard:

[post-critsmash-triage]

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a22552094_1689 "3 months ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [sec-bounty-hof](#a22552094_1689 "2 months ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty-hof | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file, 1 obsolete file)

| [bug.png](/attachment.cgi?id=9380886)  [11 months ago](#c0)  [malware0x0](/user_profile?user_id=743601)   89.88 KB, image/png |  | [Details](/attachment.cgi?id=9380886&action=edit) |
| --- | --- | --- |
| [Bug 1880879 - Diagnostic patch for bad principal URI. r?nika](/attachment.cgi?id=9391782)  [10 months ago](#c9)  [Tom Schuster](/user_profile?user_id=703078)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9391782&action=edit) | [Review](/attachment.cgi?id=9391782) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [malware0x0](/user_profile?user_id=743601)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1880879#c0)• 11 months ago |
|  | |

Attached image
[bug.png](attachment.cgi?id=9380886)
— [Details](attachment.cgi?id=9380886&action=edit)

Steps to reproduce:

A remote attacker could create a specially-crafted Web page containing

<iframe src=file:.></iframe> or <iframe src=file:..></iframe>

which would cause a segmentation fault error.

Actual results:

When you open the file (<http://localhost/file.php>), this causes the browser to crash.

If someone hosts a website with this and sends the link to another person, it would cause the victim's Web browser to crash once the website tries to get the value from "file:.".

I can reproduce the bug on Windows, Linux, and Android.

the report id: [bp-b979de7a-388f-489a-ab4d-468df0240219](https://crash-stats.mozilla.org/report/index/b979de7a-388f-489a-ab4d-468df0240219)

|  | [malware0x0](/user_profile?user_id=743601)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1880879#c1)• 11 months ago |
|  | |

Similar bug reference:

<https://exchange.xforce.ibmcloud.com/vulnerabilities/18401>

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a4915_159069)• 11 months ago |

Group: firefox-core-security → dom-core-securityStatus: UNCONFIRMED → NEWComponent: Untriaged → DOM: NavigationEver confirmed: trueKeywords: [csectype-dos](/buglist.cgi?keywords=csectype-dos&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---)OS: Unspecified → AllProduct: Firefox → CoreHardware: Unspecified → Desktop

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1880879#c2)• 11 months ago |
|  | |

<https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=6f6e201853c8f5053d6f8837acf89e76f5a334c5&tochange=3bc0d683a41cb63c83cb115d1b6a85d50013d59e>

Surprisingly this appears to have been broken for a long time.

The regression window is for when this started hanging for a bit (and then crashing) on Windows, as opposed to crashing immediately (not 100% sure what's going on there given I used mozregression).

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=affected)
[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected)
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected)Summary: Firefox are vulnerable to a denial of service attack when a website has an iframe with src=file:. or src=file:.. → Firefox are vulnerable to a denial of service attack when a website has an iframe with src=file:. or src=file:.. (MOZ\_CRASH(IPC FatalError in the parent process!))

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1880879#c3)• 11 months ago |
|  | |

We started crashing more quickly (instead of hanging) in <https://hg.mozilla.org/mozilla-central/pushloghtml?fromchange=f8ec5d8b4718a6456446b56c40ea32c50c631d48&tochange=ea48938d4cf677c4e00e093c2c92d7da5b52b0eb> .

Anyway, off-hand it seems we're breaking in principal deserialization, in the middle of feature policy deserialization, which somewhat suggests that the child process has managed to send a principal that we don't know how to deserialize, which is bad. Considering time of day and the fact that the US/Canada are out today, perhaps when it's morning over here, Christoph has ideas?

Flags: needinfo?(fbraun)Flags: needinfo?(ckerschb)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a70903_406194)• 11 months ago |

Component: DOM: Navigation → DOM: Security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a71143_406194)• 11 months ago |

Keywords: [sec-low](/buglist.cgi?keywords=sec-low&resolution=---)Summary: Firefox are vulnerable to a denial of service attack when a website has an iframe with src=file:. or src=file:.. (MOZ\_CRASH(IPC FatalError in the parent process!)) → Parent process crash with iframe with src=file:. or src=file:..

|  | [Christoph Kerschbaumer [:ckerschb]](/user_profile?user_id=363267) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1880879#c4)• 11 months ago |
|  | |

I don't really have a clue right now. Looking at the [DomTypes.ipdl](https://searchfox.org/mozilla-central/source/dom/ipc/DOMTypes.ipdlh#138) and comparing that with the error message of `"Error deserializing 'defaultOrigin' (nsIPrincipal) member of 'FeaturePolicyInfo'"` I could imagine that we generate a have baked URI within the principal based on `file:`?

Though someone would need to actually debug that.

Flags: needinfo?(fbraun)Flags: needinfo?(ckerschb)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a683093_75935)• 11 months ago |

[status-firefox123](/buglist.cgi?f1=cf_status_firefox123&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox123&o1=equals&v1=wontfix)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a741448_703078)• 11 months ago |

Flags: needinfo?(tschuster)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1880879#c5)• 11 months ago |
|  | |

(In reply to malware0x0 from [comment #1](/show_bug.cgi?id=1880879#c1 "RESOLVED FIXED - Parent process crash with iframe with src=file:. or src=file:.."))

> Similar bug reference:
>
> <https://exchange.xforce.ibmcloud.com/vulnerabilities/18401>

That was a null-pointer deref that was fixed in 2004 ([bug 272381](/show_bug.cgi?id=272381 "RESOLVED FIXED - Crash when printing a iframe [PoC included][@ GlobalWindowImpl::Print] GlobalWindowImpl::GetInterface is broken")) -- completely unrelated. We didn't have multiple processes then so no need for "IPC" functionality or any of this code.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a1282334_1689)• 11 months ago |

Blocks: [eviltraps](/show_bug.cgi?id=432687 "NEW - [meta] Protect users from websites that trap them or destroy their experience")Severity: -- → S2Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---) → [crash](/buglist.cgi?keywords=crash&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a1784314_703078)• 10 months ago |

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1880879#c6)• 10 months ago |
|  | |

We fail to de-serialize the principal due to a parsing difference in [PrincipalInfoToPrincipal](https://searchfox.org/mozilla-central/rev/b60cb73160843adb5a5a3ec8058e75a69b46acf7/ipc/glue/BackgroundUtils.cpp#44). In particular this expression: `info.originNoSuffix().Equals(originNoSuffix)` fails.

When crashing: `info.originNoSuffix() = "file:///."` vs `originNoSuffix = "file:///"`. We create the `originNoSuffix` from parsing `info.spec() = "file:///."` as an URI, but that results in an URI that is just `"file:///"` (probably because the `.` is meaningless here?)

I feel like I might have investigated a similar issue before.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a2386920_703078)• 10 months ago |

Assignee: nobody → tschuster

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1880879#c7)• 10 months ago |
|  | |

So. I think this comes down to our URL parser for `file` URL not following the spec.

| Input | URL.href (in Firefox) | [According to Live URL Viewer](https://jsdom.github.io/whatwg-url/) |
| --- | --- | --- |
| `file:.` | `file:///.` | `file:///` |
| `file:///` | `file:///` | `file:///` |
| `file:///.` | `file:///` | `file:///` |

We don't correctly round trip in this case. So we parse `file.` in the child and produce `file:///.`, and then parse `file:///.` in the parent and produce `file:///`.

I am not sure if this kind of round tripping for parsing is supposed to work according to the URL spec at all, but at least in this case we are clearly doing something wrong. Valentin is this something that we could try to fix, or is that just not worth it?

I guess if this round trip problem was more common we would see a lot more crashes like this? Sadly the signature `mozilla::ipc::FatalError | mozilla::ipc::IProtocol::HandleFatalError | IPC::MessageReader::FatalError` is somewhat useless, because it's very generic. Including the next frame `IPC::ParamTraits<mozilla::dom::FeaturePolicyInfo>::Read(IPC::MessageReader*)` would have been a lot more useful.

Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1880879#c8)• 10 months ago |
|  | |

(In reply to [OOO] Tom Schuster (MoCo) from [comment #7](/show_bug.cgi?id=1880879#c7 "RESOLVED FIXED - Parent process crash with iframe with src=file:. or src=file:.."))

> So. I think this comes down to our URL parser for `file` URL not following the spec.
>
> | Input | URL.href (in Firefox) | [According to Live URL Viewer](https://jsdom.github.io/whatwg-url/) |
> | --- | --- | --- |
> | `file:.` | `file:///.` | `file:///` |
> | `file:///` | `file:///` | `file:///` |
> | `file:///.` | `file:///` | `file:///` |
>
> We don't correctly round trip in this case. So we parse `file.` in the child and produce `file:///.`, and then parse `file:///.` in the parent and produce `file:///`.
>
> I am not sure if this kind of round tripping for parsing is supposed to work according to the URL spec at all, but at least in this case we are clearly doing something wrong. Valentin is this something that we could try to fix, or is that just not worth it?

Yup, that's a bug, and we should try to fix it. Probably doesn't have much effect on interop, but round-tripping is important for cases like this.

> I guess if this round trip problem was more common we would see a lot more crashes like this? Sadly the signature `mozilla::ipc::FatalError | mozilla::ipc::IProtocol::HandleFatalError | IPC::MessageReader::FatalError` is somewhat useless, because it's very generic. Including the next frame `IPC::ParamTraits<mozilla::dom::FeaturePolicyInfo>::Read(IPC::MessageReader*)` would have been a lot more useful.

Since this mismatch seems to cause issues later, I'm thinking we should add the round-tripping check we do [here](https://searchfox.org/mozilla-central/rev/529f04f4cd2ae68a0f729ba91cf8985edb23e9d3/ipc/glue/BackgroundUtils.cpp#89-107) to [PrincipalToPrincipalInfo](https://searchfox.org/mozilla-central/rev/529f04f4cd2ae68a0f729ba91cf8985edb23e9d3/ipc/glue/BackgroundUtils.cpp#349) too. That way we crash immediately and don't have to hunt down the cause.

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1880879#c9)• 10 months ago |
|  | |

Attached file
[Bug 1880879 - Diagnostic patch for bad principal URI. r?nika](attachment.cgi?id=9391782) (obsolete)
— [Details](attachment.cgi?id=9391782&action=edit)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a2992028_703078)• 10 months ago |

Depends on: [1887614](/show_bug.cgi?id=1887614 "RESOLVED FIXED - Incorrect parsing of <file:.> URL")

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a2992471_600971)• 10 months ago |

[Attachment #9391782](/attachment.cgi?id=9391782&action=edit "Bug 1880879 - Diagnostic patch for bad principal URI. r?nika") -
Attachment description: WIP: Bug 1880879 - Diagnostic patch for bad principal URI → Bug 1880879 - Diagnostic patch for bad principal URI. r?nika

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a3095392_1689)• 10 months ago |

Priority: -- → P2Whiteboard: [domsecurity-active]

|  | [BugBot [:suhaib / :marco/ :calixte]](/user_profile?user_id=575867) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1880879#c10)• 10 months ago |
|  | |

Based on [comment #2](/show_bug.cgi?id=1880879#c2 "RESOLVED FIXED - Parent process crash with iframe with src=file:. or src=file:.."), this bug contains a bisection range found by mozregression. However, the `Regressed by` field is still not filled.

:tschuster, if possible, could you fill the `Regressed by` field and investigate this regression?

For more information, please visit [BugBot documentation](https://wiki.mozilla.org/BugBot#bisection_without_regressed_by.py).

Flags: needinfo?(tschuster)Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a3804513_75935)• 10 months ago |

[status-firefox124](/buglist.cgi?f1=cf_status_firefox124&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox124&o1=equals&v1=wontfix)
[status-firefox125](/buglist.cgi?f1=cf_status_firefox125&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox125&o1=equals&v1=wontfix)
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a3862217_415378)• 10 months ago |

Flags: needinfo?(valentin.gosu)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1880879#c11)• 9 months ago |
|  | |

The root cause of this crash will be fixed by [bug 1887614](/show_bug.cgi?id=1887614 "RESOLVED FIXED - Incorrect parsing of <file:.> URL"). In the meantime I am waiting for feedback on D204932, which is trying to move this crash (and potentially other similar crashes) from the parent into the child.

Flags: needinfo?(tschuster)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a5003586_703078)• 9 months ago |

Flags: needinfo?(nika)

|  | [Nika Layzell [:nika] (ni? for response)](/user_profile?user_id=534482) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a5437380_534482)• 9 months ago |

Flags: needinfo?(nika)

|  | [Donal Meehan [:dmeehan]](/user_profile?user_id=695136) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a6115055_695136)• 9 months ago |

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=wontfix)
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1880879#c12)• 8 months ago |
|  | |

This crash has been fixed by [bug 1887614](/show_bug.cgi?id=1887614 "RESOLVED FIXED - Incorrect parsing of <file:.> URL").

[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
[wontfix](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=wontfix) → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)
[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed)

|  | [Tom Schuster](/user_profile?user_id=703078)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1880879#c13)• 8 months ago |
|  | |

See previous comment. I originally kept this bug open to find some way to move other similar potential crashes from the parent to the child, but we consider this to have too much of an perfomance overhead.

Status: NEW → RESOLVEDClosed: 8 months agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a7343784_1689)• 8 months ago |

Group: dom-core-security → core-security-release

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a7399537_488993)• 8 months ago |

QA Whiteboard: [post-critsmash-triage]

|  | [Phabricator Automation](/user_profile?user_id=600971) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a7405802_600971)• 8 months ago |

[Attachment #9391782](/attachment.cgi?id=9391782&action=edit "Bug 1880879 - Diagnostic patch for bad principal URI. r?nika") -
Attachment is obsolete: true

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a7422879_75935)• 8 months ago |

[status-firefox127](/buglist.cgi?f1=cf_status_firefox127&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox127&o1=equals&v1=fixed) → ---
[status-firefox-esr115](/buglist.cgi?f1=cf_status_firefox_esr115&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox_esr115&o1=equals&v1=wontfix)Target Milestone: --- → 126 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1880879#c14)• 8 months ago |
|  | |

Sorry for the burst of bugspam: filter on tinkling-glitter-filtrate

Adding `reporter-external` keyword to security bugs found by non-employees for accounting reasons

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a18343547_1689)• 4 months ago |

Group: core-security-release

|  | [malware0x0](/user_profile?user_id=743601)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1880879#c15)• 3 months ago |
|  | |

Could you please confirm if this bug qualifies for a CVE assignment? If so, would it be possible for you to initiate the process or guide me on how to proceed with the CVE request?

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1880879#c16)• 3 months ago |
|  | |

While this bug does not qualify for a bounty, I'm flagging it as such so we can discuss it at the next meeting.

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a22552094_1689)• 2 months ago |

Flags: sec-bounty?Flags: sec-bounty-hof+Flags: sec-bounty-Whiteboard: [domsecurity-active] → [domsecurity-active][crash fixed in v126 by 1887614]

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1880879#c17)• 2 months ago |
|  | |

We discussed this and while we do not always assign CVEs for crashes, in this instance we will issue one and include it in the historical advisory.

Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1880879#a22553090_578488)• 2 months ago |

Alias: CVE-2024-10941Flags: needinfo?(tom)

|  | [Tom Ritter [:tjr]](/user_profile?user_id=578488) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1880879#c18)• 2 months ago |
|  | |

<https://github.com/mozilla/foundation-security-advisories/commit/b9f0167cf9102ce7b430346634554f5631ffa8f1>

You need to [log in](/show_bug.cgi?id=1880879&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [malware0x0](/user_profile?user_id=743601)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_dcea50fb_20250114_181703.html ===


![](/static/v20250108.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1887614)
* [XML](/show_bug.cgi?ctype=xml&id=1887614)

Closed
[Bug 1887614](/show_bug.cgi?id=1887614)

Opened 10 months ago
Closed 9 months ago

# Incorrect parsing of <file:.> URL

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Incorrect parsing of <file:.> URL

## Categories

### (Core :: Networking, defect, P2)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P2

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

S3

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

126 Branch

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox126 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox126 |  | fixed |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: tschuster, Assigned: valentin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40)  [valentin](/user_profile?user_id=415378)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/643f0847a3bf01b6ac23263f1661d14e?d=mm&size=40)  [tschuster](/user_profile?user_id=703078)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

2 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[CVE-2024-10941](/show_bug.cgi?id=1880879 "RESOLVED FIXED - Parent process crash with iframe with src=file:. or src=file:..")

[url](/show_bug.cgi?id=906714 "NEW - [meta] Implement URL parser per URL Standard")

Dependency [tree](/showdependencytree.cgi?id=1887614&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1887614)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

[1890346](/show_bug.cgi?id=1890346 "RESOLVED FIXED - Hit MOZ_CRASH(nsStandardURL::SanityCheck failed) at /netwerk/base/nsStandardURL.cpp:298")

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Whiteboard: [necko-triaged], [wptsync upstream])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-triaged], [wptsync upstream]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Bug 1887614 - Incorrect parsing of <file:.> URL r=#necko,edgul](/attachment.cgi?id=9394994)  [10 months ago](#c3)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   48 bytes, text/x-phabricator-request |  | [Details](/attachment.cgi?id=9394994&action=edit) | [Review](/attachment.cgi?id=9394994) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Tom Schuster](/user_profile?user_id=703078)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1887614#c0)• 10 months ago |
|  | |

Parsing `file:.` should produce `file:///` instead of `file:///.` (Parsing `file:///.` correctly results in `file:///` however). The same applies to to `file:..` (two dots)

|  | [Tom Schuster](/user_profile?user_id=703078)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887614#a64_703078)• 10 months ago |

Blocks: [CVE-2024-10941](/show_bug.cgi?id=1880879 "RESOLVED FIXED - Parent process crash with iframe with src=file:. or src=file:..")

|  | [edgul](/user_profile?user_id=701256) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1887614#c1)• 10 months ago |
|  | |

I believe this is a dupe of [Bug 1873976](/show_bug.cgi?id=1873976 "RESOLVED FIXED - Incorrect parsing: <file:c:\foo\bar.html> against <file:///tmp/mock/path>"). Please, re-open if I am wrong.

Status: NEW → RESOLVEDClosed: 10 months agoDuplicate of bug: [1873976](/show_bug.cgi?id=1873976 "RESOLVED FIXED - Incorrect parsing: <file:c:\foo\bar.html> against <file:///tmp/mock/path>")Resolution: --- → DUPLICATE

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1887614#c2)• 10 months ago |
|  | |

The other bug also deals with <..> against <file:///C:/>

Let's only handle this one here.

Assignee: nobody → valentin.gosuSeverity: -- → S3Status: RESOLVED → REOPENEDNo longer duplicate of bug: [1873976](/show_bug.cgi?id=1873976 "RESOLVED FIXED - Incorrect parsing: <file:c:\foo\bar.html> against <file:///tmp/mock/path>")Priority: -- → P2Resolution: DUPLICATE → ---Whiteboard: [necko-triaged]

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1887614#c3)• 10 months ago |
|  | |

Attached file
[Bug 1887614 - Incorrect parsing of <file:.> URL r=#necko,edgul](attachment.cgi?id=9394994)
— [Details](attachment.cgi?id=9394994&action=edit)

|  | [Pulsebot](/user_profile?user_id=510726) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1887614#c4)• 9 months ago |
|  | |

Pushed by valentin.gosu@gmail.com:
<https://hg.mozilla.org/integration/autoland/rev/09da7de564b7>
Incorrect parsing of <file:.> URL r=edgul,tschuster

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1887614#c5)• 9 months ago |
|  | |

Created web-platform-tests PR <https://github.com/web-platform-tests/wpt/pull/45584> for changes under testing/web-platform/tests

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887614#a988026_611017)• 9 months ago |

Whiteboard: [necko-triaged] → [necko-triaged], [wptsync upstream]

|  | [Serban Stanca [:SerbanS]](/user_profile?user_id=713502) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1887614#c6)• 9 months ago |
| bugherder | |

<https://hg.mozilla.org/mozilla-central/rev/09da7de564b7>

Status: REOPENED → RESOLVEDClosed: 10 months ago → 9 months ago
[status-firefox126](/buglist.cgi?f1=cf_status_firefox126&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox126&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → 126 Branch

|  | [Web Platform Test Sync Bot [:wpt-sync] (Matrix: #interop:mozilla.org)](/user_profile?user_id=611017) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1887614#c7)• 9 months ago |
|  | |

Upstream PR merged by moz-wptsync-bot

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1887614#a1237382_415378)• 9 months ago |

Regressions: [1890346](/show_bug.cgi?id=1890346 "RESOLVED FIXED - Hit MOZ_CRASH(nsStandardURL::SanityCheck failed) at /netwerk/base/nsStandardURL.cpp:298")
You need to [log in](/show_bug.cgi?id=1887614&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_0af25c4f_20250114_181704.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2024-21

## Security Vulnerabilities fixed in Firefox 126

Announced
May 14, 2024
Impact
high
Products
Firefox
Fixed in

* Firefox 126

*Updated November 6, 2024 to add CVE-2024-10941 which was fixed in Firefox 126 but not included in the original advisory.*

#### [#CVE-2024-4764: Use-after-free when audio input connected with multiple consumers](#CVE-2024-4764)

Reporter
Jan-Ivar Bruaroey
Impact
high
##### Description

Multiple WebRTC threads could have claimed a newly connected audio input leading to use-after-free.

##### References

* [Bug 1879093](https://bugzilla.mozilla.org/show_bug.cgi?id=1879093)

#### [#CVE-2024-4367: Arbitrary JavaScript execution in PDF.js](#CVE-2024-4367)

Reporter
Thomas Rinsma of Codean Labs
Impact
high
##### Description

A type check was missing when handling fonts in PDF.js, which would allow arbitrary JavaScript execution in the PDF.js context.

##### References

* [Bug 1893645](https://bugzilla.mozilla.org/show_bug.cgi?id=1893645)

#### [#CVE-2024-4765: Web application manifests could have been overwritten via hash collision](#CVE-2024-4765)

Reporter
Dana Keeler
Impact
moderate
##### Description

Web application manifests were stored by using an insecure MD5 hash which allowed for a hash collision to overwrite another application's manifest. This could have been exploited to run arbitrary code in another application's context.
*This issue only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871109](https://bugzilla.mozilla.org/show_bug.cgi?id=1871109)

#### [#CVE-2024-4766: Fullscreen notification could have been obscured on Firefox for Android](#CVE-2024-4766)

Reporter
Hafiizh
Impact
moderate
##### Description

Different techniques existed to obscure the fullscreen notification in Firefox for Android. These could have led to potential user confusion and spoofing attacks.
*This bug only affects Firefox for Android. Other versions of Firefox are unaffected.*

##### References

* [Bug 1871214](https://bugzilla.mozilla.org/show_bug.cgi?id=1871214)
* [Bug 1871217](https://bugzilla.mozilla.org/show_bug.cgi?id=1871217)

#### [#CVE-2024-4767: IndexedDB files retained in private browsing mode](#CVE-2024-4767)

Reporter
Kim Do Hun via Tor Browser
Impact
moderate
##### Description

If the `browser.privatebrowsing.autostart` preference is enabled, IndexedDB files were not properly deleted when the window was closed. This preference is disabled by default in Firefox.

##### References

* [Bug 1878577](https://bugzilla.mozilla.org/show_bug.cgi?id=1878577)

#### [#CVE-2024-4768: Potential permissions request bypass via clickjacking](#CVE-2024-4768)

Reporter
Hafiizh
Impact
moderate
##### Description

A bug in popup notifications' interaction with WebAuthn made it easier for an attacker to trick a user into granting permissions.

##### References

* [Bug 1886082](https://bugzilla.mozilla.org/show_bug.cgi?id=1886082)

#### [#CVE-2024-4769: Cross-origin responses could be distinguished between script and non-script content-types](#CVE-2024-4769)

Reporter
Shaheen Fazim
Impact
moderate
##### Description

When importing resources using Web Workers, error messages would distinguish the difference between `application/javascript` responses and non-script responses. This could have been abused to learn information cross-origin.

##### References

* [Bug 1886108](https://bugzilla.mozilla.org/show_bug.cgi?id=1886108)

#### [#CVE-2024-4770: Use-after-free could occur when printing to PDF](#CVE-2024-4770)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

When saving a page to PDF, certain font styles could have led to a potential use-after-free crash.

##### References

* [Bug 1893270](https://bugzilla.mozilla.org/show_bug.cgi?id=1893270)

#### [#CVE-2024-4771: Failed allocation could lead to use-after-free](#CVE-2024-4771)

Reporter
Irvan Kurniawan
Impact
moderate
##### Description

A memory allocation check was missing which would lead to a use-after-free if the allocation failed. This could have triggered a crash or potentially be leveraged to achieve code execution.

##### References

* [Bug 1893891](https://bugzilla.mozilla.org/show_bug.cgi?id=1893891)

#### [#CVE-2024-4772: Use of insecure rand() function to generate nonce](#CVE-2024-4772)

Reporter
Hanno Böck
Impact
low
##### Description

An HTTP digest authentication nonce value was generated using `rand()` which could lead to predictable values.

##### References

* [Bug 1870579](https://bugzilla.mozilla.org/show_bug.cgi?id=1870579)

#### [#CVE-2024-4773: URL bar could be cleared after network error](#CVE-2024-4773)

Reporter
Islam
Impact
low
##### Description

When a network error occurred during page load, the prior content could have remained in view with a blank URL bar. This could have been used to obfuscate a spoofed web site.

##### References

* [Bug 1875248](https://bugzilla.mozilla.org/show_bug.cgi?id=1875248)

#### [#CVE-2024-4774: Undefined behavior in ShmemCharMapHashEntry()](#CVE-2024-4774)

Reporter
Ronald Crane
Impact
low
##### Description

The `ShmemCharMapHashEntry()` code was susceptible to potentially undefined behavior by bypassing the move semantics for one of its data members.

##### References

* [Bug 1886598](https://bugzilla.mozilla.org/show_bug.cgi?id=1886598)

#### [#CVE-2024-4775: Invalid memory access in the built-in profiler](#CVE-2024-4775)

Reporter
Lukas Bernhard
Impact
low
##### Description

An iterator stop condition was missing when handling WASM code in the built-in profiler, potentially leading to invalid memory access and undefined behavior. *Note:* This issue only affects the application when the profiler is running.

##### References

* [Bug 1887332](https://bugzilla.mozilla.org/show_bug.cgi?id=1887332)

#### [#CVE-2024-4776: Window may remain disabled after file dialog is shown in full-screen](#CVE-2024-4776)

Reporter
Raphael
Impact
low
##### Description

A file dialog shown while in full-screen mode could have resulted in the window remaining disabled.

##### References

* [Bug 1887343](https://bugzilla.mozilla.org/show_bug.cgi?id=1887343)

#### [#CVE-2024-10941: Browser crash from invalid URI](#CVE-2024-10941)

Reporter
Anthony De Los Santos
Impact
low
##### Description

A malicious website could have included an iframe with an malformed URI resulting in a non-exploitable browser crash.

##### References

* [Bug 1880879](https://bugzilla.mozilla.org/show_bug.cgi?id=1880879)
* [Bug 1887614](https://bugzilla.mozilla.org/show_bug.cgi?id=1887614)

#### [#CVE-2024-4777: Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](#CVE-2024-4777)

Reporter
Daniel Holbert and the Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125, Firefox ESR 115.10, and Thunderbird 115.10. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126, Firefox ESR 115.11, and Thunderbird 115.11](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1878199%2C1893340)

#### [#CVE-2024-4778: Memory safety bugs fixed in Firefox 126](#CVE-2024-4778)

Reporter
Mozilla Fuzzing Team
Impact
moderate
##### Description

Memory safety bugs present in Firefox 125. Some of these bugs showed evidence of memory corruption and we presume that with enough effort some of these could have been exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 126](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1838834%2C1889291%2C1889595%2C1890204%2C1891545)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.1/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)


