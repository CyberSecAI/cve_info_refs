=== Content from plugins.trac.wordpress.org_3444bd0f_20250114_224609.html ===


[Skip to content](#main)

[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Download & Extend](https://wordpress.org/download/)
  + [Get WordPress](https://wordpress.org/download/)
  + [Themes](https://wordpress.org/themes/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Mobile](https://wordpress.org/mobile/)
  + [Hosting](https://wordpress.org/hosting/)
  + [Openverse ↗︎](https://openverse.org/)
* [Learn](https://learn.wordpress.org/)
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* [Community](https://make.wordpress.org/)
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [WordCamp ↗︎](https://central.wordcamp.org/)
  + [Meetups ↗︎](https://www.meetup.com/pro/wordpress/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* [About](https://wordpress.org/about/)
  + [About WordPress](https://wordpress.org/about/)
  + [Showcase](https://wordpress.org/showcase/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
  + [WordPress Swag Store ↗︎](https://mercantile.wordpress.org/)
* [Get WordPress](https://wordpress.org/download/)

Search Trac

[Get WordPress](https://wordpress.org/download/)

## [Plugin Directory](//wordpress.org/plugins/)

Search:

* [Login](https://login.wordpress.org/?redirect_to=http%3A%2F%2Fplugins.trac.wordpress.org%2Fbrowser%2Fcontact-form-7-dynamic-text-extension%2Ftags%2F4.5.0%2Fincludes%2Fshortcodes.php)

* [Timeline](/timeline)
* [View Tickets](/report)
* [Browse Source](/browser)

## Context Navigation

* ← [Previous Revision](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?rev=3051230 "Revision 3051230")
* [Next Revision](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?rev=3175251 "Revision 3175251") →
* [Blame](/browser/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php?annotate=blame "Annotate each line with the last changed revision (this can be time consuming...)")
* [Revision Log](/log/contact-form-7-dynamic-text-extension/tags/4.5.0/includes/shortcodes.php)

---

# [source:](/browser?order=name "Go to repository root") [contact-form-7-dynamic-text-extension](/browser/contact-form-7-dynamic-text-extension?order=name "View contact-form-7-dynamic-text-extension")/[tags](/browser/contact-form-7-dynamic-text-extension/tags?order=name "View tags")/[4.5.0](/browser/contact-form-7-dynamic-text-extension/tags/4.5.0?order=name "View 4.5.0")/[includes](/browser/contact-form-7-dynamic-text-extension/tags/4.5.0/includes?order=name "View includes")/[shortcodes.php](/browser/contact-form-7-dynamic-text-extension/tags/4.5.0/includes/shortcodes.php?order=name "View shortcodes.php")

View diff against:

View revision:

| [Last change](/changeset/3053904/contact-form-7-dynamic-text-extension/trunk/includes/shortcodes.php "View differences") on this file was [3053904](/changeset/3053904/ "View changeset 3053904"), checked in by tessawatkinsllc, [10 months ago](/timeline?from=2024-03-18T20%3A53%3A52Z&precision=second "See timeline at 03/18/2024 08:53:52 PM") |
| --- |
| Committing 4.3.1 to trunk |
| **File size:** 25.6 KB | |

| Line |  |
| --- | --- |
| [1](#L1) | <?php |
| [2](#L2) |  |
| [3](#L3) | /\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* |
| [4](#L4) | \* Included Shortcodes |
| [5](#L5) | \* |
| [6](#L6) | \* See documentation for usage: |
| [7](#L7) | \* https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/ |
| [8](#L8) | \* |
| [9](#L9) | \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*/ |
| [10](#L10) |  |
| [11](#L11) | /\*\* |
| [12](#L12) | \* Initialise DTX included shortcodes |
| [13](#L13) | \* |
| [14](#L14) | \* Hooked to `init` |
| [15](#L15) | \* |
| [16](#L16) | \* @return void |
| [17](#L17) | \*/ |
| [18](#L18) | function wpcf7dtx\_init\_shortcodes() |
| [19](#L19) | { |
| [20](#L20) | add\_shortcode('CF7\_GET', 'wpcf7dtx\_get', 10, 1); |
| [21](#L21) | add\_shortcode('CF7\_POST', 'wpcf7dtx\_post', 10, 1); |
| [22](#L22) | add\_shortcode('CF7\_URL', 'wpcf7dtx\_url', 10, 1); |
| [23](#L23) | add\_shortcode('CF7\_referrer', 'wpcf7dtx\_referrer', 10, 1); |
| [24](#L24) | add\_shortcode('CF7\_bloginfo', 'wpcf7dtx\_bloginfo', 10, 1); |
| [25](#L25) | add\_shortcode('CF7\_get\_post\_var', 'wpcf7dtx\_get\_post\_var', 10, 1); |
| [26](#L26) | add\_shortcode('CF7\_get\_custom\_field', 'wpcf7dtx\_get\_custom\_field', 10, 1); |
| [27](#L27) | add\_shortcode('CF7\_get\_current\_var', 'wpcf7dtx\_get\_current\_var', 10, 1); |
| [28](#L28) | add\_shortcode('CF7\_get\_current\_user', 'wpcf7dtx\_get\_current\_user', 10, 1); |
| [29](#L29) | add\_shortcode('CF7\_get\_attachment', 'wpcf7dtx\_get\_attachment', 10, 1); |
| [30](#L30) | add\_shortcode('CF7\_get\_cookie', 'wpcf7dtx\_get\_cookie', 10, 1); |
| [31](#L31) | add\_shortcode('CF7\_get\_taxonomy', 'wpcf7dtx\_get\_taxonomy', 10, 1); |
| [32](#L32) | add\_shortcode('CF7\_get\_theme\_option', 'wpcf7dtx\_get\_theme\_option', 10, 1); |
| [33](#L33) | add\_shortcode('CF7\_guid', 'wpcf7dtx\_guid', 10, 0); |
| [34](#L34) | } |
| [35](#L35) | add\_action('init', 'wpcf7dtx\_init\_shortcodes'); //Add init hook to add shortcodes |
| [36](#L36) |  |
| [37](#L37) | /\*\* |
| [38](#L38) | \* Get Variable from $\_GET Array |
| [39](#L39) | \* |
| [40](#L40) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-php-get-variables/ |
| [41](#L41) | \* |
| [42](#L42) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [43](#L43) | \* |
| [44](#L44) | \* @return string Output of the shortcode |
| [45](#L45) | \*/ |
| [46](#L46) | function wpcf7dtx\_get($atts = array()) |
| [47](#L47) | { |
| [48](#L48) | $atts = shortcode\_atts(array( |
| [49](#L49) | 'key' => 0, |
| [50](#L50) | 'default' => '', |
| [51](#L51) | 'obfuscate' => '' |
| [52](#L52) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [53](#L53) | $raw = wpcf7dtx\_array\_has\_key($atts['key'], $\_GET, $atts['default']); |
| [54](#L54) | return apply\_filters( |
| [55](#L55) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [56](#L56) | apply\_filters( |
| [57](#L57) | 'wpcf7dtx\_escape', |
| [58](#L58) | apply\_filters('wpcf7dtx\_sanitize', $raw), |
| [59](#L59) | $atts['obfuscate'] |
| [60](#L60) | ), // Sanitized & escaped value to output |
| [61](#L61) | $raw, // Raw value |
| [62](#L62) | 'GET', // Shortcode tag |
| [63](#L63) | $atts // Shortcode attributes |
| [64](#L64) | ); |
| [65](#L65) | } |
| [66](#L66) |  |
| [67](#L67) | /\*\* |
| [68](#L68) | \* Get Variable from $\_POST Array |
| [69](#L69) | \* |
| [70](#L70) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-php-post-variables/ |
| [71](#L71) | \* |
| [72](#L72) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [73](#L73) | \* |
| [74](#L74) | \* @return string Output of the shortcode |
| [75](#L75) | \*/ |
| [76](#L76) | function wpcf7dtx\_post($atts = array()) |
| [77](#L77) | { |
| [78](#L78) | $atts = shortcode\_atts(array( |
| [79](#L79) | 'key' => '', |
| [80](#L80) | 'default' => '', |
| [81](#L81) | 'obfuscate' => '' |
| [82](#L82) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [83](#L83) | $raw = wpcf7dtx\_array\_has\_key($atts['key'], $\_POST, $atts['default']); |
| [84](#L84) | return apply\_filters( |
| [85](#L85) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [86](#L86) | apply\_filters('wpcf7dtx\_escape', apply\_filters( |
| [87](#L87) | 'wpcf7dtx\_sanitize', |
| [88](#L88) | apply\_filters('wpcf7dtx\_sanitize', $raw) |
| [89](#L89) | ), $atts['obfuscate']), // Sanitized & escaped value to output |
| [90](#L90) | $raw, // Raw value |
| [91](#L91) | 'POST', // Shortcode tag |
| [92](#L92) | $atts // Shortcode attributes |
| [93](#L93) | ); |
| [94](#L94) | } |
| [95](#L95) |  |
| [96](#L96) | /\*\* |
| [97](#L97) | \* Get Current URL or Part |
| [98](#L98) | \* |
| [99](#L99) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-current-url/ |
| [100](#L100) | \* |
| [101](#L101) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [102](#L102) | \* |
| [103](#L103) | \* @return string Output of the shortcode |
| [104](#L104) | \*/ |
| [105](#L105) | function wpcf7dtx\_url($atts = array()) |
| [106](#L106) | { |
| [107](#L107) | $atts = shortcode\_atts(array( |
| [108](#L108) | 'allowed\_protocols' => '', |
| [109](#L109) | 'part' => '', |
| [110](#L110) | 'obfuscate' => '' |
| [111](#L111) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [112](#L112) | $atts['allowed\_protocols'] = explode(',', sanitize\_text\_field($atts['allowed\_protocols'])); |
| [113](#L113) | extract($atts); |
| [114](#L114) |  |
| [115](#L115) | // Get the absolute URL |
| [116](#L116) | if (is\_multisite() && !is\_subdomain\_install()) { |
| [117](#L117) | // Network installs not using subdomains |
| [118](#L118) | $url = apply\_filters('wpcf7dtx\_sanitize', network\_home\_url($\_SERVER['REQUEST\_URI']), 'url', $allowed\_protocols); |
| [119](#L119) | } else { |
| [120](#L120) | // Single installs and network installs using subdomains |
| [121](#L121) | $url = apply\_filters('wpcf7dtx\_sanitize', home\_url($\_SERVER['REQUEST\_URI']), 'url', $allowed\_protocols); |
| [122](#L122) | } |
| [123](#L123) | if ($url && !empty($part = sanitize\_key(strtolower($part)))) { |
| [124](#L124) | // If an individual part is requested, get that specific value using parse\_url() |
| [125](#L125) | $part\_constant\_map = [ |
| [126](#L126) | 'scheme' => PHP\_URL\_SCHEME, // e.g. `http` |
| [127](#L127) | 'host'  => PHP\_URL\_HOST, // the domain (or subdomain) of the current website |
| [128](#L128) | 'path'  => PHP\_URL\_PATH, // e.g. `/path/to/current/page/` |
| [129](#L129) | 'query' => PHP\_URL\_QUERY // after the question mark ? |
| [130](#L130) | ]; |
| [131](#L131) | $value = ''; |
| [132](#L132) | if (array\_key\_exists($part, $part\_constant\_map)) { |
| [133](#L133) | $value = strval(wp\_parse\_url($url, $part\_constant\_map[$part])); |
| [134](#L134) | } |
| [135](#L135) | return apply\_filters( |
| [136](#L136) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [137](#L137) | apply\_filters( |
| [138](#L138) | 'wpcf7dtx\_escape', |
| [139](#L139) | apply\_filters('wpcf7dtx\_sanitize', $value, 'text'), |
| [140](#L140) | $obfuscate, |
| [141](#L141) | 'text' |
| [142](#L142) | ), // Sanitized & escaped value to output |
| [143](#L143) | $value, // Raw value |
| [144](#L144) | 'URL', // Shortcode tag |
| [145](#L145) | $atts // Shortcode attributes |
| [146](#L146) | ); |
| [147](#L147) | } |
| [148](#L148) | // No part requested, return the absolute URL |
| [149](#L149) | return apply\_filters( |
| [150](#L150) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [151](#L151) | apply\_filters('wpcf7dtx\_escape', $url, $obfuscate, 'url', $allowed\_protocols), // Sanitized & escaped value to output |
| [152](#L152) | $url, // Raw value |
| [153](#L153) | 'URL', // Shortcode tag |
| [154](#L154) | $atts // Shortcode attributes |
| [155](#L155) | ); |
| [156](#L156) | } |
| [157](#L157) |  |
| [158](#L158) | /\*\* |
| [159](#L159) | \* Get Referrering URL |
| [160](#L160) | \* |
| [161](#L161) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-referrer-url/ |
| [162](#L162) | \* |
| [163](#L163) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [164](#L164) | \* |
| [165](#L165) | \* @return string Output of the shortcode |
| [166](#L166) | \*/ |
| [167](#L167) | function wpcf7dtx\_referrer($atts = array()) |
| [168](#L168) | { |
| [169](#L169) | $atts = shortcode\_atts(array( |
| [170](#L170) | 'allowed\_protocols' => '', |
| [171](#L171) | 'obfuscate' => '' |
| [172](#L172) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [173](#L173) | $url = wpcf7dtx\_array\_has\_key('HTTP\_REFERER', $\_SERVER); |
| [174](#L174) | return apply\_filters( |
| [175](#L175) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [176](#L176) | apply\_filters('wpcf7dtx\_escape', apply\_filters( |
| [177](#L177) | 'wpcf7dtx\_sanitize', |
| [178](#L178) | $url, |
| [179](#L179) | 'url', |
| [180](#L180) | $atts['allowed\_protocols'] |
| [181](#L181) | ), $atts['obfuscate'], 'url'), // Sanitized & escaped value to output |
| [182](#L182) | $url, // Raw value |
| [183](#L183) | 'referrer', // Shortcode tag |
| [184](#L184) | $atts // Shortcode attributes |
| [185](#L185) | ); |
| [186](#L186) | } |
| [187](#L187) |  |
| [188](#L188) | /\*\* |
| [189](#L189) | \* Get Variable from Bloginfo |
| [190](#L190) | \* |
| [191](#L191) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-post-page-variables/ |
| [192](#L192) | \* |
| [193](#L193) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [194](#L194) | \* |
| [195](#L195) | \* @return string Output of the shortcode |
| [196](#L196) | \*/ |
| [197](#L197) | function wpcf7dtx\_bloginfo($atts = array()) |
| [198](#L198) | { |
| [199](#L199) | $atts = shortcode\_atts(array( |
| [200](#L200) | 'show' => 'name', //Backwards compatibility |
| [201](#L201) | 'key' => 'name', |
| [202](#L202) | 'obfuscate' => '' |
| [203](#L203) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [204](#L204) | extract($atts); |
| [205](#L205) | $key = $show != $key && $show != 'name' ? $show : $key; // Use old value of "show" if not set to default value |
| [206](#L206) | $raw = get\_bloginfo($key); |
| [207](#L207) | return apply\_filters( |
| [208](#L208) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [209](#L209) | apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate), // Sanitized & escaped value to output |
| [210](#L210) | $raw, // Raw value |
| [211](#L211) | 'bloginfo', // Shortcode tag |
| [212](#L212) | $atts // Shortcode attributes |
| [213](#L213) | ); |
| [214](#L214) | } |
| [215](#L215) |  |
| [216](#L216) | /\*\* |
| [217](#L217) | \* Get Variable from a Post Object |
| [218](#L218) | \* |
| [219](#L219) | \* @link https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-post-page-variables/ |
| [220](#L220) | \* |
| [221](#L221) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [222](#L222) | \* |
| [223](#L223) | \* @return string Output of the shortcode |
| [224](#L224) | \*/ |
| [225](#L225) | function wpcf7dtx\_get\_post\_var($atts = array()) |
| [226](#L226) | { |
| [227](#L227) | $atts = shortcode\_atts(array( |
| [228](#L228) | 'key' => 'post\_title', |
| [229](#L229) | 'post\_id' => '', |
| [230](#L230) | 'obfuscate' => '' |
| [231](#L231) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [232](#L232) | $key = strtolower(apply\_filters('wpcf7dtx\_sanitize', $atts['key'])); |
| [233](#L233) | switch ($key) { |
| [234](#L234) | case 'acf\_id': // If requesting the handle for ACF, return the post ID |
| [235](#L235) | case 'id': |
| [236](#L236) | $key = 'ID'; |
| [237](#L237) | break; |
| [238](#L238) | case 'slug': // Alias |
| [239](#L239) | $key = 'post\_name'; |
| [240](#L240) | break; |
| [241](#L241) | case 'title': // Alias |
| [242](#L242) | $key = 'post\_title'; |
| [243](#L243) | break; |
| [244](#L244) | default: |
| [245](#L245) | break; |
| [246](#L246) | } |
| [247](#L247) | $atts['post\_id'] = wpcf7dtx\_get\_post\_id($atts['post\_id']); |
| [248](#L248) | $raw = $atts['post\_id'] ? get\_post\_field($key, $atts['post\_id']) : ''; |
| [249](#L249) | return apply\_filters( |
| [250](#L250) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [251](#L251) | apply\_filters('wpcf7dtx\_escape', $raw, $atts['obfuscate']), // Sanitized & escaped value to output |
| [252](#L252) | $raw, // Raw value |
| [253](#L253) | 'get\_post\_var', // Shortcode tag |
| [254](#L254) | $atts // Shortcode attributes |
| [255](#L255) | ); |
| [256](#L256) | } |
| [257](#L257) |  |
| [258](#L258) | /\*\* |
| [259](#L259) | \* Get Value from Post Meta Field |
| [260](#L260) | \* |
| [261](#L261) | \* @see  https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-post-meta-custom-fields/ |
| [262](#L262) | \* |
| [263](#L263) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [264](#L264) | \* |
| [265](#L265) | \* @return string Output of the shortcode |
| [266](#L266) | \*/ |
| [267](#L267) | function wpcf7dtx\_get\_custom\_field($atts = array()) |
| [268](#L268) | { |
| [269](#L269) | $atts = shortcode\_atts(array( |
| [270](#L270) | 'key' => '', |
| [271](#L271) | 'post\_id' => '', |
| [272](#L272) | 'obfuscate' => '' |
| [273](#L273) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [274](#L274) |  |
| [275](#L275) | // If this key can't be accessed |
| [276](#L276) | if (!wpcf7dtx\_post\_meta\_key\_access\_is\_allowed($atts['key'])) { |
| [277](#L277) | // Trigger a warning if a denied key is in use |
| [278](#L278) | wpcf7dtx\_access\_denied\_alert($atts['key'], 'post\_meta'); |
| [279](#L279) | return ''; |
| [280](#L280) | } |
| [281](#L281) |  |
| [282](#L282) | $key = apply\_filters('wpcf7dtx\_sanitize', $atts['key'], 'text'); |
| [283](#L283) | $atts['post\_id'] = wpcf7dtx\_get\_post\_id($atts['post\_id']); |
| [284](#L284) | $raw = $atts['post\_id'] && $key ? get\_post\_meta($atts['post\_id'], $key, true) : ''; |
| [285](#L285) | return apply\_filters( |
| [286](#L286) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [287](#L287) | apply\_filters('wpcf7dtx\_escape', $raw, $atts['obfuscate']), // Sanitized & escaped value to output |
| [288](#L288) | $raw, // Raw value |
| [289](#L289) | 'get\_custom\_field', // Shortcode tag |
| [290](#L290) | $atts // Shortcode attributes |
| [291](#L291) | ); |
| [292](#L292) | } |
| [293](#L293) |  |
| [294](#L294) | /\*\* |
| [295](#L295) | \* Get Variable from the Current Object |
| [296](#L296) | \* |
| [297](#L297) | \* @since 3.4.0 |
| [298](#L298) | \* |
| [299](#L299) | \* @link https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-current-variables/ |
| [300](#L300) | \* |
| [301](#L301) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [302](#L302) | \* |
| [303](#L303) | \* @return string Output of the shortcode |
| [304](#L304) | \*/ |
| [305](#L305) | function wpcf7dtx\_get\_current\_var($atts = array()) |
| [306](#L306) | { |
| [307](#L307) | $atts = shortcode\_atts(array( |
| [308](#L308) | 'key' => 'title', |
| [309](#L309) | 'obfuscate' => '' |
| [310](#L310) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [311](#L311) | extract($atts); |
| [312](#L312) | $key = apply\_filters('wpcf7dtx\_sanitize', $key); |
| [313](#L313) | $temp\_key = str\_replace('-', '\_', sanitize\_key($key)); |
| [314](#L314) | $raw = ''; |
| [315](#L315) | $value = ''; |
| [316](#L316) | if ($temp\_key === 'url') { |
| [317](#L317) | return wpcf7dtx\_url($atts); // Getting the current URL is the same for all WordPress pages |
| [318](#L318) | } elseif (!empty($key)) { |
| [319](#L319) | $type = ''; |
| [320](#L320) | $obj = null; |
| [321](#L321) | if (!wp\_doing\_ajax()) { |
| [322](#L322) | $obj = get\_queried\_object(); // Get the current WordPress queried object |
| [323](#L323) | if (!is\_null($obj)) { |
| [324](#L324) | if ($obj instanceof WP\_User) { |
| [325](#L325) | $type = 'user'; |
| [326](#L326) | } elseif (property\_exists($obj, 'ID')) { |
| [327](#L327) | $type = 'post'; |
| [328](#L328) | } elseif (property\_exists($obj, 'term\_id')) { |
| [329](#L329) | $type = 'term'; |
| [330](#L330) | } |
| [331](#L331) | } elseif (is\_archive()) { |
| [332](#L332) | $type = 'archive'; |
| [333](#L333) | } |
| [334](#L334) | } |
| [335](#L335) | switch ($type) { |
| [336](#L336) | case 'user': // This is an author page |
| [337](#L337) | switch ($temp\_key) { |
| [338](#L338) | case 'acf\_id': // Get handle for Advanced Custom Fields |
| [339](#L339) | $raw = 'user\_' . $obj->ID; |
| [340](#L340) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [341](#L341) | break; |
| [342](#L342) | case 'image': |
| [343](#L343) | case 'featured\_image': // Get the profile picture of the user being displayed on the page |
| [344](#L344) | $raw = get\_avatar\_url($obj->ID); |
| [345](#L345) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate, 'url'); |
| [346](#L346) | break; |
| [347](#L347) | case 'title': // Get author's display name |
| [348](#L348) | $raw = $obj->display\_name; |
| [349](#L349) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [350](#L350) | break; |
| [351](#L351) | case 'slug': // Not all author pages use the `user\_login` variable for security reasons, so get what is currently displayed as slug |
| [352](#L352) | $raw = basename(wpcf7dtx\_url(array('part' => 'path'))); |
| [353](#L353) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [354](#L354) | break; |
| [355](#L355) | default: // Get user value by key should it exist |
| [356](#L356) | $raw = $obj->get($key); |
| [357](#L357) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [358](#L358) | break; |
| [359](#L359) | } |
| [360](#L360) | case 'post': // This is a post object |
| [361](#L361) | switch ($temp\_key) { |
| [362](#L362) | case 'image': |
| [363](#L363) | case 'featured\_image': // Get the current post's featured image |
| [364](#L364) | return wpcf7dtx\_get\_attachment(array\_merge($atts, array('post\_id' => $obj->ID))); |
| [365](#L365) | case 'terms': // Get the current post's assigned terms |
| [366](#L366) | return wpcf7dtx\_get\_taxonomy(array\_merge($atts, array('post\_id' => $obj->ID))); |
| [367](#L367) | default: |
| [368](#L368) | // Use the post object shortcode should it exist as a post variable |
| [369](#L369) | $value = wpcf7dtx\_get\_post\_var(array\_merge($atts, array('post\_id' => $obj->ID))); |
| [370](#L370) | if (empty($value)) { |
| [371](#L371) | // Try post meta if post object variable failed |
| [372](#L372) | $value = wpcf7dtx\_get\_custom\_field(array\_merge($atts, array('post\_id' => $obj->ID))); |
| [373](#L373) | } |
| [374](#L374) | return $value; |
| [375](#L375) | } |
| [376](#L376) | case 'term': // This is a taxonomy with a term ID |
| [377](#L377) | switch ($key) { |
| [378](#L378) | case 'id': // Get term ID |
| [379](#L379) | $raw = $obj->term\_id; |
| [380](#L380) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [381](#L381) | break; |
| [382](#L382) | case 'acf\_id': // Get handle for Advanced Custom Fields |
| [383](#L383) | $raw = $obj->taxonomy . '\_' . $obj->term\_id; |
| [384](#L384) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [385](#L385) | break; |
| [386](#L386) | case 'title': // Get term name |
| [387](#L387) | $raw = $obj->name; |
| [388](#L388) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [389](#L389) | break; |
| [390](#L390) | default: |
| [391](#L391) | if (property\_exists($obj, $key)) { |
| [392](#L392) | // Get any property if it exists |
| [393](#L393) | $raw = $obj->{$key}; |
| [394](#L394) | } else { |
| [395](#L395) | // Otherwise, try meta data if the property doesn't exist |
| [396](#L396) | $raw = get\_metadata('term', $obj->ID, $key, true); |
| [397](#L397) | } |
| [398](#L398) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [399](#L399) | break; |
| [400](#L400) | } |
| [401](#L401) | case 'archive': // Possibly a date or formats archive |
| [402](#L402) | switch ($temp\_key) { |
| [403](#L403) | case 'title': // Get archive title |
| [404](#L404) | $raw = get\_the\_archive\_title(); |
| [405](#L405) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [406](#L406) | break; |
| [407](#L407) | default: |
| [408](#L408) | break; |
| [409](#L409) | } |
| [410](#L410) | default: // Possibly a search or 404 page at this point |
| [411](#L411) | if ($temp\_key == 'slug') { |
| [412](#L412) | // no idea what else to get except the slug maybe |
| [413](#L413) | $raw = basename(wpcf7dtx\_url(array('part' => 'path'))); |
| [414](#L414) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $obfuscate); |
| [415](#L415) | } |
| [416](#L416) | break; |
| [417](#L417) | } |
| [418](#L418) | } |
| [419](#L419) | return apply\_filters( |
| [420](#L420) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [421](#L421) | $value, // Sanitized & escaped value to output |
| [422](#L422) | $raw, // Raw value |
| [423](#L423) | 'get\_current\_var', // Shortcode tag |
| [424](#L424) | $atts // Shortcode attributes |
| [425](#L425) | ); |
| [426](#L426) | } |
| [427](#L427) |  |
| [428](#L428) | /\*\* |
| [429](#L429) | \* Get Value from Current User |
| [430](#L430) | \* |
| [431](#L431) | \* Retreives data from the `users` and `usermeta` tables. |
| [432](#L432) | \* |
| [433](#L433) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-current-user-user-meta/ |
| [434](#L434) | \* |
| [435](#L435) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [436](#L436) | \* |
| [437](#L437) | \* @return string Output of the shortcode |
| [438](#L438) | \*/ |
| [439](#L439) | function wpcf7dtx\_get\_current\_user($atts = array()) |
| [440](#L440) | { |
| [441](#L441) | $atts = shortcode\_atts(array( |
| [442](#L442) | 'key' => 'user\_login', |
| [443](#L443) | 'obfuscate' => '' |
| [444](#L444) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [445](#L445) | $raw = ''; |
| [446](#L446) | if (is\_user\_logged\_in()) { |
| [447](#L447) |  |
| [448](#L448) | // If this key can't be accessed |
| [449](#L449) | if (!wpcf7dtx\_user\_data\_access\_is\_allowed($atts['key'])) { |
| [450](#L450) | // Trigger a warning if a denied key is in use |
| [451](#L451) | wpcf7dtx\_access\_denied\_alert($atts['key'], 'user\_data'); |
| [452](#L452) | return ''; |
| [453](#L453) | } |
| [454](#L454) |  |
| [455](#L455) | $raw = wp\_get\_current\_user()->get($atts['key']); |
| [456](#L456) | } |
| [457](#L457) | return apply\_filters( |
| [458](#L458) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [459](#L459) | apply\_filters('wpcf7dtx\_escape', $raw, $atts['obfuscate']), // Sanitized & escaped value to output |
| [460](#L460) | $raw, // Raw value |
| [461](#L461) | 'get\_current\_user', // Shortcode tag |
| [462](#L462) | $atts // Shortcode attributes |
| [463](#L463) | ); |
| [464](#L464) | } |
| [465](#L465) |  |
| [466](#L466) | /\*\* |
| [467](#L467) | \* Get Attachment |
| [468](#L468) | \* |
| [469](#L469) | \* Retreives an attachment ID or absolute URL depending on attributes |
| [470](#L470) | \* |
| [471](#L471) | \* @since 3.1.0 |
| [472](#L472) | \* |
| [473](#L473) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-media-attachment/ |
| [474](#L474) | \* |
| [475](#L475) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [476](#L476) | \* |
| [477](#L477) | \* @return string Output of the shortcode |
| [478](#L478) | \*/ |
| [479](#L479) | function wpcf7dtx\_get\_attachment($atts = array()) |
| [480](#L480) | { |
| [481](#L481) | $atts = shortcode\_atts(array( |
| [482](#L482) | 'id' => '', // Get attachment by ID |
| [483](#L483) | 'size' => 'full', // Define attachment size |
| [484](#L484) | 'post\_id' => '', // If attachment ID is empty but post ID is not, get the featured image |
| [485](#L485) | 'return' => 'url', // Options are `id` or `url` |
| [486](#L486) | 'obfuscate' => '' |
| [487](#L487) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [488](#L488) |  |
| [489](#L489) | // No attachment ID was provided, check for post ID to get it's featured image |
| [490](#L490) | if (empty($atts['id'])) { |
| [491](#L491) | if ($atts['post\_id'] = wpcf7dtx\_get\_post\_id($atts['post\_id'])) { |
| [492](#L492) | //If a post ID was provided, get it's featured image |
| [493](#L493) | $atts['id'] = get\_post\_thumbnail\_id($atts['post\_id']); |
| [494](#L494) | } |
| [495](#L495) | } |
| [496](#L496) |  |
| [497](#L497) | //Get the value |
| [498](#L498) | $value = ''; |
| [499](#L499) | $raw = ''; |
| [500](#L500) | if ($atts['id']) { |
| [501](#L501) | $atts['id'] = intval(sanitize\_text\_field(strval($atts['id']))); |
| [502](#L502) | switch ($atts['return']) { |
| [503](#L503) | case 'id': //Return the attachment ID |
| [504](#L504) | $raw = $atts['id']; |
| [505](#L505) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $atts['obfuscate']); |
| [506](#L506) | break; |
| [507](#L507) | default: //Return attachment URL |
| [508](#L508) | $raw = wp\_get\_attachment\_image\_url(intval($atts['id']), sanitize\_text\_field(strval($atts['size']))); |
| [509](#L509) | $value = apply\_filters('wpcf7dtx\_escape', $raw, $atts['obfuscate'], 'url'); |
| [510](#L510) | break; |
| [511](#L511) | } |
| [512](#L512) | } |
| [513](#L513) | return apply\_filters( |
| [514](#L514) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [515](#L515) | $value, // Sanitized & escaped value to output |
| [516](#L516) | $raw, // Raw value |
| [517](#L517) | 'get\_attachment', // Shortcode tag |
| [518](#L518) | $atts // Shortcode attributes |
| [519](#L519) | ); |
| [520](#L520) | } |
| [521](#L521) |  |
| [522](#L522) | /\*\* |
| [523](#L523) | \* Get Cookie Value |
| [524](#L524) | \* |
| [525](#L525) | \* Retreives the value of a cookie |
| [526](#L526) | \* |
| [527](#L527) | \* @since 3.3.0 |
| [528](#L528) | \* |
| [529](#L529) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-cookie/ |
| [530](#L530) | \* |
| [531](#L531) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [532](#L532) | \* |
| [533](#L533) | \* @return string Output of the shortcode |
| [534](#L534) | \*/ |
| [535](#L535) | function wpcf7dtx\_get\_cookie($atts = array()) |
| [536](#L536) | { |
| [537](#L537) | $atts = shortcode\_atts(array( |
| [538](#L538) | 'key' => '', |
| [539](#L539) | 'default' => '', |
| [540](#L540) | 'obfuscate' => '' // Optionally obfuscate returned value |
| [541](#L541) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [542](#L542) | $raw = wpcf7dtx\_array\_has\_key(apply\_filters('wpcf7dtx\_sanitize', $atts['key']), $\_COOKIE, $atts['default']); |
| [543](#L543) | return apply\_filters( |
| [544](#L544) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [545](#L545) | apply\_filters('wpcf7dtx\_escape', $raw, $atts['obfuscate']), // Sanitized & escaped value to output |
| [546](#L546) | $raw, // Raw value |
| [547](#L547) | 'get\_cookie', // Shortcode tag |
| [548](#L548) | $atts // Shortcode attributes |
| [549](#L549) | ); |
| [550](#L550) | } |
| [551](#L551) |  |
| [552](#L552) | /\*\* |
| [553](#L553) | \* Get Taxonomy |
| [554](#L554) | \* |
| [555](#L555) | \* Retreives a list of taxonomy values |
| [556](#L556) | \* |
| [557](#L557) | \* @since 3.3.0 |
| [558](#L558) | \* |
| [559](#L559) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-taxonomy/ |
| [560](#L560) | \* @see https://developer.wordpress.org/reference/classes/wp\_term\_query/get\_terms/ |
| [561](#L561) | \* |
| [562](#L562) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [563](#L563) | \* |
| [564](#L564) | \* @return string Output of the shortcode |
| [565](#L565) | \*/ |
| [566](#L566) | function wpcf7dtx\_get\_taxonomy($atts = array()) |
| [567](#L567) | { |
| [568](#L568) | $atts = shortcode\_atts(array( |
| [569](#L569) | 'post\_id' => '', |
| [570](#L570) | 'taxonomy' => 'category', // Default taxonomy is `category` |
| [571](#L571) | 'fields' => 'names', // Return an array of term names |
| [572](#L572) | 'obfuscate' => '' // Optionally obfuscate returned value |
| [573](#L573) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [574](#L574) | $atts['post\_id'] = wpcf7dtx\_get\_post\_id($atts['post\_id']); |
| [575](#L575) | $fields = apply\_filters('wpcf7dtx\_sanitize', $atts['fields'], 'key'); |
| [576](#L576) | $raw = ''; |
| [577](#L577) | $value = ''; |
| [578](#L578) | if ($atts['post\_id'] && in\_array($fields, array('names', 'slugs', 'ids'))) { |
| [579](#L579) | $terms = wp\_get\_object\_terms( |
| [580](#L580) | $atts['post\_id'], // Get only the ones assigned to this post |
| [581](#L581) | apply\_filters('wpcf7dtx\_sanitize', $atts['taxonomy'], 'slug'), |
| [582](#L582) | array('fields' => $fields) |
| [583](#L583) | ); |
| [584](#L584) | if (is\_array($terms) && count($raw = array\_values($terms)) && (is\_string($raw[0]) || is\_numeric($raw[0]))) { |
| [585](#L585) | //return apply\_filters('wpcf7dtx\_escape', implode(', ', $values), $obfuscate, 'text'); |
| [586](#L586) | $value = implode(', ', $raw); |
| [587](#L587) | } |
| [588](#L588) | } |
| [589](#L589) | return apply\_filters( |
| [590](#L590) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [591](#L591) | apply\_filters('wpcf7dtx\_escape', $value, $atts['obfuscate'], 'text'), // Sanitized & escaped value to output |
| [592](#L592) | $raw, // Raw value |
| [593](#L593) | 'get\_taxonomy', // Shortcode tag |
| [594](#L594) | $atts // Shortcode attributes |
| [595](#L595) | ); |
| [596](#L596) | } |
| [597](#L597) |  |
| [598](#L598) | /\*\* |
| [599](#L599) | \* Get Theme Customization Option |
| [600](#L600) | \* |
| [601](#L601) | \* Retreives theme modification value for the active theme |
| [602](#L602) | \* |
| [603](#L603) | \* @since 3.3.0 |
| [604](#L604) | \* |
| [605](#L605) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-theme-option/ |
| [606](#L606) | \* @see https://developer.wordpress.org/reference/functions/get\_theme\_mod/ |
| [607](#L607) | \* |
| [608](#L608) | \* @param array $atts Optional. An associative array of shortcode attributes. Default is an empty array. |
| [609](#L609) | \* |
| [610](#L610) | \* @return string Output of the shortcode |
| [611](#L611) | \*/ |
| [612](#L612) | function wpcf7dtx\_get\_theme\_option($atts = array()) |
| [613](#L613) | { |
| [614](#L614) | $atts = shortcode\_atts(array( |
| [615](#L615) | 'key' => '', |
| [616](#L616) | 'default' => '', // Optional default value |
| [617](#L617) | 'obfuscate' => '' // Optionally obfuscate returned value |
| [618](#L618) | ), array\_change\_key\_case((array)$atts, CASE\_LOWER)); |
| [619](#L619) | $default = apply\_filters('wpcf7dtx\_sanitize', $atts['default']); |
| [620](#L620) | $raw = $default; |
| [621](#L621) | if ($key = apply\_filters('wpcf7dtx\_sanitize', $atts['key'], 'text')) { |
| [622](#L622) | $raw = get\_theme\_mod($key, $default); |
| [623](#L623) | } |
| [624](#L624) | return apply\_filters( |
| [625](#L625) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [626](#L626) | apply\_filters('wpcf7dtx\_escape', $raw, $atts['obfuscate']), // Sanitized & escaped value to output |
| [627](#L627) | $raw, // Raw value |
| [628](#L628) | 'get\_theme\_option', // Shortcode tag |
| [629](#L629) | $atts // Shortcode attributes |
| [630](#L630) | ); |
| [631](#L631) | } |
| [632](#L632) |  |
| [633](#L633) | /\*\* |
| [634](#L634) | \* GUID Field |
| [635](#L635) | \* |
| [636](#L636) | \* Generate a random GUID (globally unique identifier) |
| [637](#L637) | \* |
| [638](#L638) | \* @since 3.1.0 |
| [639](#L639) | \* |
| [640](#L640) | \* @see https://aurisecreative.com/docs/contact-form-7-dynamic-text-extension/shortcodes/dtx-shortcode-guid/ |
| [641](#L641) | \* |
| [642](#L642) | \* @return string a randomly generated 128-bit text string. |
| [643](#L643) | \*/ |
| [644](#L644) | function wpcf7dtx\_guid() |
| [645](#L645) | { |
| [646](#L646) | if (function\_exists('com\_create\_guid')) { |
| [647](#L647) | $raw = trim(com\_create\_guid(), '{}'); |
| [648](#L648) | } else { |
| [649](#L649) | $raw = sprintf('%04X%04X-%04X-%04X-%04X-%04X%04X%04X', mt\_rand(0, 65535), mt\_rand(0, 65535), mt\_rand(0, 65535), mt\_rand(16384, 20479), mt\_rand(32768, 49151), mt\_rand(0, 65535), mt\_rand(0, 65535), mt\_rand(0, 65535)); |
| [650](#L650) | } |
| [651](#L651) | return apply\_filters( |
| [652](#L652) | 'wpcf7dtx\_shortcode', // DTX built-in shortcode hook |
| [653](#L653) | esc\_attr($raw), // Sanitized & escaped value to output |
| [654](#L654) | $raw, // Raw value |
| [655](#L655) | 'guid', // Shortcode tag |
| [656](#L656) | array() // Shortcode attributes |
| [657](#L657) | ); |
| [658](#L658) | } |

**Note:** See [TracBrowser](/wiki/TracBrowser)
for help on using the repository browser.

[Trac UI Preferences](/prefs)
### Download in other formats:

* [Plain Text](/browser/contact-form-7-dynamic-text-extension/tags/4.5.0/includes/shortcodes.php?format=txt)
* [Original Format](/export/3222502/contact-form-7-dynamic-text-extension/tags/4.5.0/includes/shortcodes.php)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Donate](https://wordpressfoundation.org/donate/)
* [Swag](https://mercantile.wordpress.org/)

* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [Get Involved](https://make.wordpress.org/)
* [Learn](https://learn.wordpress.org/)

* [Showcase](https://wordpress.org/showcase/)
* [Plugins](https://wordpress.org/plugins/)
* [Themes](https://wordpress.org/themes/)
* [Patterns](https://wordpress.org/patterns/)

* [WordCamp](https://central.wordcamp.org/)
* [WordPress.TV](https://wordpress.tv/)
* [BuddyPress](https://buddypress.org/)
* [bbPress](https://bbpress.org/)

* [WordPress.com](https://wordpress.com/?ref=wporg-footer)
* [Matt](https://ma.tt/)
* [Privacy](https://wordpress.org/about/privacy/)
* [Public Code](https://publiccode.eu/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our Twitter account](https://twitter.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.wordfence.com_da2d4df1_20250114_224610.html ===


[![](https://www.wordfence.com/img/wordfence-intelligence-logo.svg)](/threat-intel/)

Have you found a vulnerability in a WordPress plugin or theme? Report vulnerabilities in WordPress plugins and themes through our [bug bounty program](https://www.wordfence.com/threat-intel/bug-bounty-program) and earn a bounty on all in-scope submissions, while we handle the responsible disclosure process on your behalf.

As a reminder, the Wordfence Intelligence Vulnerability Database API is completely free to query and utilize, both personally and commercially, and contains all the same vulnerability data as the user interface. Please review the API documentation and Webhook documentation for more information on how to query the vulnerability API endpoints and configure webhooks utilizing all the same data present in the Wordfence Intelligence user interface.

# Contact Form 7 – Dynamic Text Extension <= 4.5 - Information Disclosure via Shortcode

 [Wordfence Intelligence](https://www.wordfence.com/threat-intel)   >    [Vulnerability Database](https://www.wordfence.com/threat-intel/vulnerabilities)   >   Contact Form 7 – Dynamic Text Extension <= 4.5 - Information Disclosure via Shortcode

4.3

**Exposure of Sensitive Information to an Unauthorized Actor**
**CVSS Vector**
[CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N)

| CVE | [CVE-2024-10084](https://www.cve.org/CVERecord?id=CVE-2024-10084) |
| --- | --- |
| CVSS | 4.3 (Medium) |
| Publicly Published | November 5, 2024 |
| Last Updated | November 5, 2024 |
| Researcher | [Francesco Carlucci](https://www.wordfence.com/threat-intel/vulnerabilities/researchers/francesco-carlucci) |

### Description

The Contact Form 7 – Dynamic Text Extension plugin for WordPress is vulnerable to Basic Information Disclosure in all versions up to, and including, 4.5 via the CF7\_get\_post\_var shortcode. This makes it possible for authenticated attackers, with Contributor-level access and above, to extract the titles and text contents of private and password-protected posts, they do not own.

#### References

* [plugins.trac.wordpress.org](https://plugins.trac.wordpress.org/browser/contact-form-7-dynamic-text-extension/tags/4.5.0/includes/shortcodes.php#L225)

#### Share

[Facebook](https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7-dynamic-text-extension%2Fcontact-form-7-dynamic-text-extension-45-information-disclosure-via-shortcode&t=Contact%20Form%207%20%E2%80%93%20Dynamic%20Text%20Extension%20%3C%3D%204.5%20-%20Information%20Disclosure%20via%20Shortcode "Facebook")
[Twitter](https://twitter.com/share?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7-dynamic-text-extension%2Fcontact-form-7-dynamic-text-extension-45-information-disclosure-via-shortcode&text=Contact%20Form%207%20%E2%80%93%20Dynamic%20Text%20Extension%20%3C%3D%204.5%20-%20Information%20Disclosure%20via%20Shortcode "Twitter")
[LinkedIn](https://www.linkedin.com/shareArticle?url=http%3A%2F%2Fwww.wordfence.com%2Fthreat-intel%2Fvulnerabilities%2Fwordpress-plugins%2Fcontact-form-7-dynamic-text-extension%2Fcontact-form-7-dynamic-text-extension-45-information-disclosure-via-shortcode "LinkedIn")
Email

## Vulnerability Details for Contact Form 7 – Dynamic Text Extension

#### [Contact Form 7 – Dynamic Text Extension](https://www.wordfence.com/threat-intel/vulnerabilities/wordpress-plugins/contact-form-7-dynamic-text-extension)

| Software Type | Plugin |
| --- | --- |
| Software Slug | contact-form-7-dynamic-text-extension [(view on wordpress.org)](https://wordpress.org/plugins/contact-form-7-dynamic-text-extension) |
| Patched? | Yes |
| Remediation | Update to version 4.5.1, or a newer patched version |
| Affected Version | * <= 4.5 |
| Patched Version | * 4.5.1 |

This record contains material that is subject to copyright.

**Copyright 2012-2025 Defiant Inc.**

**License:**
Defiant hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute this software vulnerability information. Any copy of the software vulnerability information you make for such purposes is authorized provided that you include a hyperlink to this vulnerability record and reproduce Defiant's copyright designation and this license in any such copy.
**[Read more.](https://www.wordfence.com/wordfence-intelligence-terms-and-conditions/)**

**Copyright 1999-2025 The MITRE Corporation**

**License:**
CVE Usage: MITRE hereby grants you a perpetual, worldwide, non-exclusive, no-charge, royalty-free, irrevocable copyright license to reproduce, prepare derivative works of, publicly display, publicly perform, sublicense, and distribute Common Vulnerabilities and Exposures (CVE®). Any copy you make for such purposes is authorized provided that you reproduce MITRE's copyright designation and this license in any such copy.
**[Read more.](https://www.cve.org/Legal/TermsOfUse)**

Have information to add, or spot any errors? Contact us at wfi-support@wordfence.com so we can make any appropriate adjustments.

Did you know Wordfence Intelligence provides free personal and commercial API access to our comprehensive WordPress vulnerability database, along with a free webhook integration to stay on top of the latest vulnerabilities added and updated in the database? Get started today!

Learn more

Want to get notified of the latest vulnerabilities that may affect your WordPress site?
 Install Wordfence on your site today to get notified immediately if your site is affected by a vulnerability that has been added to our database.

Get Wordfence

The Wordfence Intelligence WordPress vulnerability database is completely free to access and query via API. Please review the documentation on how to access and consume the vulnerability data via API.

Documentation


