=== Content from git.kernel.org_8c427889_20250114_230636.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=012ae530afa0785102360de452745d33c99a321b)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=012ae530afa0785102360de452745d33c99a321b)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=012ae530afa0785102360de452745d33c99a321b)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=012ae530afa0785102360de452745d33c99a321b)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:11:24 +0200 |
| commit | [012ae530afa0785102360de452745d33c99a321b](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=012ae530afa0785102360de452745d33c99a321b) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=012ae530afa0785102360de452745d33c99a321b)) | |
| tree | [cc9266a7742a99889c9b3a7b9e8921e85bee517c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=012ae530afa0785102360de452745d33c99a321b) | |
| parent | [08a24438fa138773984c91d1fdbf5d2a2d7d8390](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=08a24438fa138773984c91d1fdbf5d2a2d7d8390) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=012ae530afa0785102360de452745d33c99a321b&id2=08a24438fa138773984c91d1fdbf5d2a2d7d8390)) | |
| download | [linux-012ae530afa0785102360de452745d33c99a321b.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-012ae530afa0785102360de452745d33c99a321b.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=012ae530afa0785102360de452745d33c99a321b)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=012ae530afa0785102360de452745d33c99a321b) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex e0130beb304dfe..6c73c0c0b82a99 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=08a24438fa138773984c91d1fdbf5d2a2d7d8390)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=012ae530afa0785102360de452745d33c99a321b)@@ -718,8 +718,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -756,8 +755,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:13 +0000



=== Content from git.kernel.org_c0b134e5_20250114_230646.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-08 16:19:11 +0100 |
| commit | [e6b9bf32e0695e4f374674002de0527d2a6768eb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb)) | |
| tree | [05d9fd976aea8791da54be23840c2fa85242757c](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb) | |
| parent | [600f668453be81b25dcc2f20096eac2243aebdaa](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=600f668453be81b25dcc2f20096eac2243aebdaa) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb&id2=600f668453be81b25dcc2f20096eac2243aebdaa)) | |
| download | [linux-e6b9bf32e0695e4f374674002de0527d2a6768eb.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e6b9bf32e0695e4f374674002de0527d2a6768eb.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e6b9bf32e0695e4f374674002de0527d2a6768eb)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=e6b9bf32e0695e4f374674002de0527d2a6768eb) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex 3aa915d2155455..24059a5178a9d9 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=600f668453be81b25dcc2f20096eac2243aebdaa)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=e6b9bf32e0695e4f374674002de0527d2a6768eb)@@ -718,8 +718,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -756,8 +755,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:23 +0000



=== Content from git.kernel.org_450fffc0_20250114_230646.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=e37e348835032d6940ec89308cc8996ded691d2d)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e37e348835032d6940ec89308cc8996ded691d2d)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e37e348835032d6940ec89308cc8996ded691d2d)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e37e348835032d6940ec89308cc8996ded691d2d)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-10 11:57:21 +0200 |
| commit | [e37e348835032d6940ec89308cc8996ded691d2d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=e37e348835032d6940ec89308cc8996ded691d2d) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=e37e348835032d6940ec89308cc8996ded691d2d)) | |
| tree | [7d14966d25963a46aa5cec1c354b90292ca5c382](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=e37e348835032d6940ec89308cc8996ded691d2d) | |
| parent | [fdc73f2cfbe897f4733156df211d79ced649b23c](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=fdc73f2cfbe897f4733156df211d79ced649b23c) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e37e348835032d6940ec89308cc8996ded691d2d&id2=fdc73f2cfbe897f4733156df211d79ced649b23c)) | |
| download | [linux-e37e348835032d6940ec89308cc8996ded691d2d.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-e37e348835032d6940ec89308cc8996ded691d2d.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=e37e348835032d6940ec89308cc8996ded691d2d)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=e37e348835032d6940ec89308cc8996ded691d2d) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex e5414435b14140..ab728a70ed2796 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=fdc73f2cfbe897f4733156df211d79ced649b23c)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=e37e348835032d6940ec89308cc8996ded691d2d)@@ -716,8 +716,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -754,8 +753,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:22 +0000



=== Content from git.kernel.org_04155335_20250114_230644.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-11-08 16:20:36 +0100 |
| commit | [d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77)) | |
| tree | [5805e35e96a7bb92f95ff280d12a19e71e7556c7](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77) | |
| parent | [d96512bfeee51ff4f50768c085b235012791cf5d](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=d96512bfeee51ff4f50768c085b235012791cf5d) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77&id2=d96512bfeee51ff4f50768c085b235012791cf5d)) | |
| download | [linux-d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex 3aa915d2155455..24059a5178a9d9 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=d96512bfeee51ff4f50768c085b235012791cf5d)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=d1f2fbc6a769081503f6ffedbb5cd1ac497f0e77)@@ -718,8 +718,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -756,8 +755,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:21 +0000



=== Content from git.kernel.org_dddaf351_20250114_230643.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:08:09 +0200 |
| commit | [b02eb7c86ff2ef1411c3095ec8a52b13f68db04f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f)) | |
| tree | [3dc40d059caeeddf80e92d2ce1e3d974594c0b6e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f) | |
| parent | [2171e1d750012035ba95879f2f6d60d9b7f69c62](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2171e1d750012035ba95879f2f6d60d9b7f69c62) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f&id2=2171e1d750012035ba95879f2f6d60d9b7f69c62)) | |
| download | [linux-b02eb7c86ff2ef1411c3095ec8a52b13f68db04f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-b02eb7c86ff2ef1411c3095ec8a52b13f68db04f.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex e0130beb304dfe..6c73c0c0b82a99 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=2171e1d750012035ba95879f2f6d60d9b7f69c62)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=b02eb7c86ff2ef1411c3095ec8a52b13f68db04f)@@ -718,8 +718,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -756,8 +755,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:20 +0000



=== Content from git.kernel.org_854343c2_20250114_230641.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=94745807f3ebd379f23865e6dab196f220664179)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=94745807f3ebd379f23865e6dab196f220664179)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=94745807f3ebd379f23865e6dab196f220664179)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=94745807f3ebd379f23865e6dab196f220664179)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Kalle Valo <quic\_kvalo@quicinc.com> | 2024-08-16 13:10:47 +0300 |
| commit | [94745807f3ebd379f23865e6dab196f220664179](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=94745807f3ebd379f23865e6dab196f220664179) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=94745807f3ebd379f23865e6dab196f220664179)) | |
| tree | [e370bb661f59c264c5175b3d42d2ba8b5113e9c8](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=94745807f3ebd379f23865e6dab196f220664179) | |
| parent | [6274df2530e35193ebac311d492d276a73162b57](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6274df2530e35193ebac311d492d276a73162b57) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=94745807f3ebd379f23865e6dab196f220664179&id2=6274df2530e35193ebac311d492d276a73162b57)) | |
| download | [linux-94745807f3ebd379f23865e6dab196f220664179.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-94745807f3ebd379f23865e6dab196f220664179.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmitSyzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=94745807f3ebd379f23865e6dab196f220664179)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=94745807f3ebd379f23865e6dab196f220664179) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex 0c7841f952287f..a3733c9b484e46 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=6274df2530e35193ebac311d492d276a73162b57)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=94745807f3ebd379f23865e6dab196f220664179)@@ -716,8 +716,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -754,8 +753,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:18 +0000



=== Content from git.kernel.org_26657e22_20250114_230642.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-10 12:03:06 +0200 |
| commit | [a9f4e28e8adaf0715bd4e01462af0a52ee46b01f](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f)) | |
| tree | [dc31615d74deaa0dc2781c5392b59eb3c3e89c2e](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f) | |
| parent | [490eddc836b2a6ec286e5df14bed4c7cf5e1f475](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=490eddc836b2a6ec286e5df14bed4c7cf5e1f475) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f&id2=490eddc836b2a6ec286e5df14bed4c7cf5e1f475)) | |
| download | [linux-a9f4e28e8adaf0715bd4e01462af0a52ee46b01f.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-a9f4e28e8adaf0715bd4e01462af0a52ee46b01f.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex 0c7841f952287f..a3733c9b484e46 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=490eddc836b2a6ec286e5df14bed4c7cf5e1f475)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=a9f4e28e8adaf0715bd4e01462af0a52ee46b01f)@@ -716,8 +716,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -754,8 +753,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:19 +0000



=== Content from git.kernel.org_20cd36eb_20250114_230640.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=6a875220670475d9247e576c15dc29823100a4e4)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6a875220670475d9247e576c15dc29823100a4e4)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6a875220670475d9247e576c15dc29823100a4e4)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6a875220670475d9247e576c15dc29823100a4e4)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-17 15:21:35 +0200 |
| commit | [6a875220670475d9247e576c15dc29823100a4e4](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=6a875220670475d9247e576c15dc29823100a4e4) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=6a875220670475d9247e576c15dc29823100a4e4)) | |
| tree | [bdaa02559cff53d4781fef55650ee4659ec9fc71](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=6a875220670475d9247e576c15dc29823100a4e4) | |
| parent | [83793aa9b18fcf4abf9cef8027d4ad5708b0a3ef](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=83793aa9b18fcf4abf9cef8027d4ad5708b0a3ef) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6a875220670475d9247e576c15dc29823100a4e4&id2=83793aa9b18fcf4abf9cef8027d4ad5708b0a3ef)) | |
| download | [linux-6a875220670475d9247e576c15dc29823100a4e4.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-6a875220670475d9247e576c15dc29823100a4e4.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=6a875220670475d9247e576c15dc29823100a4e4)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=6a875220670475d9247e576c15dc29823100a4e4) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex e0130beb304dfe..6c73c0c0b82a99 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=83793aa9b18fcf4abf9cef8027d4ad5708b0a3ef)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=6a875220670475d9247e576c15dc29823100a4e4)@@ -718,8 +718,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -756,8 +755,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:16 +0000



=== Content from git.kernel.org_79834270_20250114_230638.html ===


| [cgit logo](/) | [index](/) : [kernel/git/stable/linux.git](/pub/scm/linux/kernel/git/stable/linux.git/) | linux-2.6.11.y linux-2.6.12.y linux-2.6.13.y linux-2.6.14.y linux-2.6.15.y linux-2.6.16.y linux-2.6.17.y linux-2.6.18.y linux-2.6.19.y linux-2.6.20.y linux-2.6.21.y linux-2.6.22.y linux-2.6.23.y linux-2.6.24.y linux-2.6.25.y linux-2.6.26.y linux-2.6.27.y linux-2.6.28.y linux-2.6.29.y linux-2.6.30.y linux-2.6.31.y linux-2.6.32.y linux-2.6.33.y linux-2.6.34.y linux-2.6.35.y linux-2.6.36.y linux-2.6.37.y linux-2.6.38.y linux-2.6.39.y linux-3.0.y linux-3.1.y linux-3.10.y linux-3.11.y linux-3.12.y linux-3.13.y linux-3.14.y linux-3.15.y linux-3.16.y linux-3.17.y linux-3.18.y linux-3.19.y linux-3.2.y linux-3.3.y linux-3.4.y linux-3.5.y linux-3.6.y linux-3.7.y linux-3.8.y linux-3.9.y linux-4.0.y linux-4.1.y linux-4.10.y linux-4.11.y linux-4.12.y linux-4.13.y linux-4.14.y linux-4.15.y linux-4.16.y linux-4.17.y linux-4.18.y linux-4.19.y linux-4.2.y linux-4.20.y linux-4.3.y linux-4.4.y linux-4.5.y linux-4.6.y linux-4.7.y linux-4.8.y linux-4.9.y linux-5.0.y linux-5.1.y linux-5.10.y linux-5.11.y linux-5.12.y linux-5.13.y linux-5.14.y linux-5.15.y linux-5.16.y linux-5.17.y linux-5.18.y linux-5.19.y linux-5.2.y linux-5.3.y linux-5.4.y linux-5.5.y linux-5.6.y linux-5.7.y linux-5.8.y linux-5.9.y linux-6.0.y linux-6.1.y linux-6.10.y linux-6.11.y linux-6.12.y linux-6.2.y linux-6.3.y linux-6.4.y linux-6.5.y linux-6.6.y linux-6.7.y linux-6.8.y linux-6.9.y linux-rolling-lts linux-rolling-stable master |
| --- | --- | --- |
| Linux kernel stable tree | Stable Group |

| [about](/pub/scm/linux/kernel/git/stable/linux.git/about/)[summary](/pub/scm/linux/kernel/git/stable/linux.git/)[refs](/pub/scm/linux/kernel/git/stable/linux.git/refs/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95)[log](/pub/scm/linux/kernel/git/stable/linux.git/log/)[tree](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95)[commit](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95)[diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95)[stats](/pub/scm/linux/kernel/git/stable/linux.git/stats/) | log msg author committer range |
| --- | --- |

**diff options**

|  | |
| --- | --- |
| context: | 12345678910152025303540 |
| space: | includeignore |
| mode: | unifiedssdiffstat only |
|  |  |

| author | Toke Høiland-Jørgensen <toke@redhat.com> | 2024-08-12 16:24:46 +0200 |
| --- | --- | --- |
| committer | Greg Kroah-Hartman <gregkh@linuxfoundation.org> | 2024-10-10 12:00:13 +0200 |
| commit | [2c230210ec0ae6ed08306ac70dc21c24b817bb95](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95) ([patch](/pub/scm/linux/kernel/git/stable/linux.git/patch/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95)) | |
| tree | [5af85a917bd0fc62b77df6ae3ae3c87be980a9cc](/pub/scm/linux/kernel/git/stable/linux.git/tree/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95) | |
| parent | [37c319503023de49a4c87301c8998c8d928112cb](/pub/scm/linux/kernel/git/stable/linux.git/commit/?id=37c319503023de49a4c87301c8998c8d928112cb) ([diff](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95&id2=37c319503023de49a4c87301c8998c8d928112cb)) | |
| download | [linux-2c230210ec0ae6ed08306ac70dc21c24b817bb95.tar.gz](/pub/scm/linux/kernel/git/stable/linux.git/snapshot/linux-2c230210ec0ae6ed08306ac70dc21c24b817bb95.tar.gz) | |

wifi: ath9k\_htc: Use \_\_skb\_set\_length() for resetting urb before resubmit[ Upstream commit 94745807f3ebd379f23865e6dab196f220664179 ]
Syzbot points out that skb\_trim() has a sanity check on the existing length of
the skb, which can be uninitialised in some error paths. The intent here is
clearly just to reset the length to zero before resubmitting, so switch to
calling \_\_skb\_set\_length(skb, 0) directly. In addition, \_\_skb\_set\_length()
already contains a call to skb\_reset\_tail\_pointer(), so remove the redundant
call.
The syzbot report came from ath9k\_hif\_usb\_reg\_in\_cb(), but there's a similar
usage of skb\_trim() in ath9k\_hif\_usb\_rx\_cb(), change both while we're at it.
Reported-by: syzbot+98afa303be379af6cdb2@syzkaller.appspotmail.com
Signed-off-by: Toke Høiland-Jørgensen <toke@redhat.com>
Signed-off-by: Kalle Valo <quic\_kvalo@quicinc.com>
Link: [https://patch.msgid.link/20240812142447.12328-1-toke@toke.dk](https://patch.msgid.link/20240812142447.12328-1-toke%40toke.dk)
Signed-off-by: Sasha Levin <sashal@kernel.org>
[Diffstat](/pub/scm/linux/kernel/git/stable/linux.git/diff/?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95)

| -rw-r--r-- | [drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/diff/drivers/net/wireless/ath/ath9k/hif_usb.c?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95) | 6 | |  |  |  | | --- | --- | --- | |
| --- | --- | --- | --- | --- | --- | --- |

1 files changed, 2 insertions, 4 deletions

| diff --git a/drivers/net/wireless/ath/ath9k/hif\_usb.c b/drivers/net/wireless/ath/ath9k/hif\_usb.cindex 0c7841f952287f..a3733c9b484e46 100644--- a/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=37c319503023de49a4c87301c8998c8d928112cb)+++ b/[drivers/net/wireless/ath/ath9k/hif\_usb.c](/pub/scm/linux/kernel/git/stable/linux.git/tree/drivers/net/wireless/ath/ath9k/hif_usb.c?id=2c230210ec0ae6ed08306ac70dc21c24b817bb95)@@ -716,8 +716,7 @@ static void ath9k\_hif\_usb\_rx\_cb(struct urb \*urb) }  resubmit:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  usb\_anchor\_urb(urb, &hif\_dev->rx\_submitted); ret = usb\_submit\_urb(urb, GFP\_ATOMIC);@@ -754,8 +753,7 @@ static void ath9k\_hif\_usb\_reg\_in\_cb(struct urb \*urb) case -ESHUTDOWN: goto free\_skb; default:- skb\_reset\_tail\_pointer(skb);- skb\_trim(skb, 0);+ \_\_skb\_set\_length(skb, 0);  goto resubmit; } |
| --- |

generated by [cgit 1.2.3-korg](https://git.zx2c4.com/cgit/about/) ([git 2.43.0](https://git-scm.com/)) at 2025-01-14 23:05:14 +0000


