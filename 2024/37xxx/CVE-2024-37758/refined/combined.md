=== Content from medium.com_a875225a_20250115_102244.html ===
[Open in app](https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Fc3e3282e9053&%7Efeature=LoOpenInAppButton&%7Echannel=ShowPostUnderUser&source=---top_nav_layout_nav----------------------------------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40hamzanadeem1337%2Funauthorized-full-vertical-privilege-escalation-in-digiteam-sales-gamification-portal-version-4-21-0-c3e3282e9053&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

[Write](/m/signin?operation=register&redirect=https%3A%2F%2Fmedium.com%2Fnew-story&source=---top_nav_layout_nav-----------------------new_post_topnav-----------)

Sign up

[Sign in](/m/signin?operation=login&redirect=https%3A%2F%2Fmedium.com%2F%40hamzanadeem1337%2Funauthorized-full-vertical-privilege-escalation-in-digiteam-sales-gamification-portal-version-4-21-0-c3e3282e9053&source=post_page---top_nav_layout_nav-----------------------global_nav-----------)

![](https://miro.medium.com/v2/resize:fill:64:64/1*dmbNkD5D-u45r44go_cf0g.png)
# Unauthorized full vertical privilege escalation in digiteam sales gamification portal version 4.21.0.0 (**CVE-2024–37758)**

[![Hamza Nadeem](https://miro.medium.com/v2/da:true/resize:fill:88:88/0*UnePKdMiYUhoR_Ei)](/%40hamzanadeem1337?source=post_page---byline--c3e3282e9053--------------------------------)

[Hamza Nadeem](/%40hamzanadeem1337?source=post_page---byline--c3e3282e9053--------------------------------)

·

[Follow](/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F0440702b89b4&operation=register&redirect=https%3A%2F%2Fmedium.com%2F%40hamzanadeem1337%2Funauthorized-full-vertical-privilege-escalation-in-digiteam-sales-gamification-portal-version-4-21-0-c3e3282e9053&user=Hamza+Nadeem&userId=0440702b89b4&source=post_page-0440702b89b4--byline--c3e3282e9053---------------------post_header-----------)

3 min read·Dec 20, 2024

--

Listen

Share

This post explains a vulnerability having ID **CVE-2024–37758** that I discovered in digiteam sales gamification crm portal version 4.21.0.0. This vulnerability can cause a low privilege authenticated user to fully escalate privileges and become super administrator by exploiting broken access control vulnerability.

**Product website**: www.digiteam.com

# Prerequisites:

1. Access of low privilege user account

![]()

You can notice, that user can only login but cannot access even single feature of the portal.

# Exploitation:

Consider a threat actor or malicious insider has access to low privilege account in digiteam sales gamification portal version v4.21.0.0 and by proxying traffic through the Burp Suite, threat actor would be able to see the session cookies and CSRF token provided by application server as shown below:

![]()

Now there was an API endpoint **/Role/GetGridItems** that was vulnerable with broken access control issue. It was supposed to be only accessible for admin users. But by sending following POST request using low privilege account session cookies and CSRF token a threat actor could fetch all the information about available roles including RoleID, Name, Status etc. as shown below:

![]()

After fetching role ids of information threat actor could send the following API request to **/RoleMenuMapping/AddRoleMenu** to escalate to full privileges by mentioning its own role id in RoleID and ItemRoleID parameter of POST body and then mentioning all the permission ids as shown in request below:

![]()

After sending the above request, just refresh the browser and it will load all features and functionality confirming successful full vertical privilege escalation as shown below:

![]()![]()![]()

Following showing that the Role ‘Low level accounts’ that threat actor belongs to, now has all the permissions and roles assigned.

![]()
# Conclusion

Developers should ensure the authorization checks at each endpoint level, it can be done by passing all the requests through a middleware as well.

--

--

[![Hamza Nadeem](https://miro.medium.com/v2/resize:fill:96:96/0*UnePKdMiYUhoR_Ei)](/%40hamzanadeem1337?source=post_page---post_author_info--c3e3282e9053--------------------------------)[![Hamza Nadeem](https://miro.medium.com/v2/resize:fill:128:128/0*UnePKdMiYUhoR_Ei)](/%40hamzanadeem1337?source=post_page---post_author_info--c3e3282e9053--------------------------------)Follow[## Written by Hamza Nadeem](/%40hamzanadeem1337?source=post_page---post_author_info--c3e3282e9053--------------------------------)0 Followers·[1 Following](/%40hamzanadeem1337/following?source=post_page---post_author_info--c3e3282e9053--------------------------------)

Senior Offensive Security Engineer | OSWE | OSCP | CREST CRT | CREST CPSA | eWPTX v2 | eCPPT v2 | CRTP | CEH (Practical)

Follow
## No responses yet

[Help](https://help.medium.com/hc/en-us?source=post_page-----c3e3282e9053--------------------------------)[Status](https://medium.statuspage.io/?source=post_page-----c3e3282e9053--------------------------------)[About](/about?autoplay=1&source=post_page-----c3e3282e9053--------------------------------)[Careers](/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----c3e3282e9053--------------------------------)[Press](pressinquiries%40medium.com?source=post_page-----c3e3282e9053--------------------------------)[Blog](https://blog.medium.com/?source=post_page-----c3e3282e9053--------------------------------)[Privacy](https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----c3e3282e9053--------------------------------)[Terms](https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----c3e3282e9053--------------------------------)[Text to speech](https://speechify.com/medium?source=post_page-----c3e3282e9053--------------------------------)[Teams](/business?source=post_page-----c3e3282e9053--------------------------------)


