=== Content from github.com_1b78b1a1_20250114_190525.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fweechat%2Fweechat%2Fissues%2F2178)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fweechat%2Fweechat%2Fissues%2F2178)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=weechat%2Fweechat)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[weechat](/weechat)
/
**[weechat](/weechat/weechat)**
Public

* [Notifications](/login?return_to=%2Fweechat%2Fweechat) You must be signed in to change notification settings
* [Fork
  333](/login?return_to=%2Fweechat%2Fweechat)
* [Star
   3k](/login?return_to=%2Fweechat%2Fweechat)

* [Code](/weechat/weechat)
* [Issues
  383](/weechat/weechat/issues)
* [Pull requests
  45](/weechat/weechat/pulls)
* [Actions](/weechat/weechat/actions)
* [Projects
  0](/weechat/weechat/projects)
* [Wiki](/weechat/weechat/wiki)
* [Security](/weechat/weechat/security)
* [Insights](/weechat/weechat/pulse)

Additional navigation options

* [Code](/weechat/weechat)
* [Issues](/weechat/weechat/issues)
* [Pull requests](/weechat/weechat/pulls)
* [Actions](/weechat/weechat/actions)
* [Projects](/weechat/weechat/projects)
* [Wiki](/weechat/weechat/wiki)
* [Security](/weechat/weechat/security)
* [Insights](/weechat/weechat/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2Fweechat%2Fweechat%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2Fweechat%2Fweechat%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Integer Overflow to Buffer Overflow vulnerability in "string\_free\_split" functions #2178

Closed

[Crispy-fried-chicken](/Crispy-fried-chicken) opened this issue
Sep 3, 2024
· 15 comments

Closed

# [Integer Overflow to Buffer Overflow vulnerability in "string\_free\_split" functions](#top) #2178

[Crispy-fried-chicken](/Crispy-fried-chicken) opened this issue
Sep 3, 2024
· 15 comments

Assignees
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

Labels
[bug](/weechat/weechat/labels/bug)
Unexpected problem or unintended behavior

Milestone
[4.5.0](/weechat/weechat/milestone/50 "4.5.0")

## Comments

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Sep 3, 2024](#issue-2502293887)

| Question Hi, we have detected that your project may be vulnerable to Integer Overflow to Buffer Overflow in the function of `string_free_split_shared` , `string_free_split`, `string_free_split_command` and `string_free_split_tags` in the file of `src/core/core-string.c` . It shares similarities to a recent CVE disclosure [CVE-2024-6381](https://nvd.nist.gov/vuln/detail/CVE-2024-6381) in the [mongo-c-driver](https://github.com/mongodb/mongo-c-driver).  **The source vulnerability information is as follows:**  Vulnerability Detail: CVE Identifier: CVE-2024-6381 Description: The bson\_strfreev function in the MongoDB C driver library may be susceptible to an integer overflow where the function will try to free memory at a negative offset. This may result in memory corruption. This issue affected libbson versions prior to 1.26.2 Reference: <https://nvd.nist.gov/vuln/detail/CVE-2024-6381> Patch: [mongodb/mongo-c-driver@effd95c](https://github.com/mongodb/mongo-c-driver/commit/effd95c34ad421df94eec7c69236f0e4172552d0)  Would you help to check if this bug is true? If it's true, I'd like to open a PR for that if necessary. Thank you for your effort and patience! |
| --- |
| The text was updated successfully, but these errors were encountered: |

All reactions

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)
[Crispy-fried-chicken](/Crispy-fried-chicken)
added
the
[question](/weechat/weechat/labels/question)
General question
label
[Sep 3, 2024](#event-14111630767)

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 3, 2024](#issuecomment-2326048403)

| Hi,  Thanks for the issue, I confirm there can be an integer overflow here, and at least these functions must be fixed (I'm checking if other functions could be affected as well).  Did you find this manually or automatically with a tool? If yes, which one? I make regular scans of the source code for such issues, and it was not reported.  This issue should not really happen in practice, because INT\_MAX is 2,147,483,647, so the integer overflow happens with this number of split items, that means with the separator between each item, the source string was at least 4,294,967,294 bytes long.  **Important note:** for any security issue found in WeeChat (even if you're not sure it's one), please do not post in the public tracker, see file [CONTRIBUTING.md](https://github.com/weechat/weechat/blob/master/CONTRIBUTING.md#security-reports). This allows time to properly fix the issue in all versions, then announce the vulnerability publicly. Thanks! |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)
[flashcode](/flashcode)
self-assigned this
[Sep 3, 2024](#event-14112184672)

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)
[flashcode](/flashcode)
added
[bug](/weechat/weechat/labels/bug)
Unexpected problem or unintended behavior
and removed
[question](/weechat/weechat/labels/question)
General question
labels
[Sep 3, 2024](#event-14112186007)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Sep 3, 2024](#issuecomment-2326206136)

| I'm sorry I didn't see the [CONTRIBUTING.md](https://github.com/weechat/weechat/blob/master/CONTRIBUTING.md#security-reports) before. Is there any need to send an email again?  Did you find this manually or automatically with a tool? If yes, which one? I make regular scans of the source code for such issues, and it was not reported.  Besides, I find this automatically with a tool which developed by our team. It is now under testing, Maybe after our tools are stable, we can scan your projects regularly. :)  This issue should not really happen in practice, because INT\_MAX is 2,147,483,647, so the integer overflow happens with this number of split items, that means with the separator between each item, the source string was at least 4,294,967,294 bytes long.  So is there any need to fix it? I'm willing to open a PR for that if necessary. |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 3, 2024](#issuecomment-2326238863)

| No e-mail needed, we can go on here, as this has a minor impact on users (should not happen in practice).  Yes, a fix is welcome. I see in mongodb they just use a pointer without index variable ([mongodb/mongo-c-driver#1552](https://github.com/mongodb/mongo-c-driver/pull/1552)), which is fine to me. |
| --- |

All reactions

Sorry, something went wrong.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Sep 3, 2024](#issuecomment-2326258032)

| Hi, I've already open a pr for it, which is [#2179](https://github.com/weechat/weechat/pull/2179). Please review it. Besides, is there need to backport it to the branch 4.4 and 4.3? |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 3, 2024](#issuecomment-2326285381)

| Hi, I've already open a pr for it, which is [#2179](https://github.com/weechat/weechat/pull/2179). Please review it.  Thanks.  Besides, is there need to backport it to the branch 4.4 and 4.3?  Yes, I'll do it myself once this is merged in master branch. At least on branch 4.4. |
| --- |

All reactions

Sorry, something went wrong.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Sep 3, 2024](#issuecomment-2326306459) • edited Loading

| Yes, I'll do it myself once this is merged in master branch. At least on branch 4.4.  Thanks, and is there any need to request a CVEID for this vulnerability due to the potential affects on your weechat? |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 3, 2024](#issuecomment-2326315742)

| Thanks, and is there any need to request a CVEID for this vulnerability due to the potential affects on your weechat?  It's better to have one yes, and I'll link it on the security page: <https://weechat.org/doc/weechat/security/>  But please wait a bit so I can investigate if other functions are affected and require a similar fix. |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)
[flashcode](/flashcode)
added this to the [4.5.0](/weechat/weechat/milestone/50) milestone
[Sep 3, 2024](#event-14113920726)

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Sep 4, 2024](#issuecomment-2327755573)

| Thanks, and is there any need to request a CVEID for this vulnerability due to the potential affects on your weechat?  It's better to have one yes, and I'll link it on the security page: <https://weechat.org/doc/weechat/security/>  But please wait a bit so I can investigate if other functions are affected and require a similar fix.  Thanks, and please inform me about the follow-up progress。 Thank you for your patience! |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)
[flashcode](/flashcode)
changed the title
~~Security Vulnerability - Action Required: Integer Overflow to Buffer Overflow vulnerability may in your project~~
Integer Overflow to Buffer Overflow vulnerability in "string\_free\_split" functions
[Sep 4, 2024](#event-14126155843)

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 4, 2024](#issuecomment-2329504176)

| I found the same problem in other functions, I'm fixing them all.  Does your tool detect them? I would be interested by such tool, or a similar one, to catch such issues during the development. Is GitHub CodeQL (used in this project) able to detect such issues? |
| --- |

All reactions

Sorry, something went wrong.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Sep 5, 2024](#issuecomment-2330435988)

| I found the same problem in other functions, I'm fixing them all.  Does your tool detect them? I would be interested by such tool, or a similar one, to catch such issues during the development. Is GitHub CodeQL (used in this project) able to detect such issues?  I don't use CodeQL to detect it, but I try to compare CodeQL with our tool in our groundtruth, it has lower precision than ours. |
| --- |

All reactions

Sorry, something went wrong.

[flashcode](/flashcode)
pushed a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-315f769)
[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken) [![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: fix integer overflow in string_free_split functions (issue](/weechat/weechat/commit/315f769ab25643cf501a4bf8deb8025d92654303 "core: fix integer overflow in string_free_split functions (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/315f769ab25643cf501a4bf8deb8025d92654303 "core: fix integer overflow in string_free_split functions (issue #2178)")`

`[315f769](/weechat/weechat/commit/315f769ab25643cf501a4bf8deb8025d92654303)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-5564baf)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: fix integer overflow in loops (issue](/weechat/weechat/commit/5564baf424d847144f13ee50f0988e4f3407e638 "core: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/5564baf424d847144f13ee50f0988e4f3407e638 "core: fix integer overflow in loops (issue #2178)")`

`[5564baf](/weechat/weechat/commit/5564baf424d847144f13ee50f0988e4f3407e638)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-62d0347)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[irc: fix integer overflow in loops (issue](/weechat/weechat/commit/62d0347d4bdee63694354184611b0b6af5028ff2 "irc: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/62d0347d4bdee63694354184611b0b6af5028ff2 "irc: fix integer overflow in loops (issue #2178)")`

`[62d0347](/weechat/weechat/commit/62d0347d4bdee63694354184611b0b6af5028ff2)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-970f20a)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[relay: fix integer overflow in loops (issue](/weechat/weechat/commit/970f20af31cbcce02a99368eb633e8c4082dfe64 "relay: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/970f20af31cbcce02a99368eb633e8c4082dfe64 "relay: fix integer overflow in loops (issue #2178)")`

`[970f20a](/weechat/weechat/commit/970f20af31cbcce02a99368eb633e8c4082dfe64)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-9aa0a94)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[trigger: fix integer overflow in loop (issue](/weechat/weechat/commit/9aa0a94156c7cc367d52c31e60d8b03239d4dbd4 "trigger: fix integer overflow in loop (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/9aa0a94156c7cc367d52c31e60d8b03239d4dbd4 "trigger: fix integer overflow in loop (issue #2178)")`

`[9aa0a94](/weechat/weechat/commit/9aa0a94156c7cc367d52c31e60d8b03239d4dbd4)`

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)
[flashcode](/flashcode)
closed this as [completed](/weechat/weechat/issues?q=is%3Aissue+is%3Aclosed+archived%3Afalse+reason%3Acompleted)
in
`[9196143](/weechat/weechat/commit/91961433e3d84c635c38f6179e811e70e47cb5fc)`
[Sep 7, 2024](#event-14169389048)

[flashcode](/flashcode)
pushed a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-db65071)
[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken) [![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: fix integer overflow in string_free_split functions (issue](/weechat/weechat/commit/db65071db5a99035ffa525ba30e86d9b0e27bf4c "core: fix integer overflow in string_free_split functions (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/db65071db5a99035ffa525ba30e86d9b0e27bf4c "core: fix integer overflow in string_free_split functions (issue #2178)")`

`[db65071](/weechat/weechat/commit/db65071db5a99035ffa525ba30e86d9b0e27bf4c)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-0973fe0)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: fix integer overflow in loops (issue](/weechat/weechat/commit/0973fe0ad458fe7c5ad2216ca882d07740b44e3f "core: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/0973fe0ad458fe7c5ad2216ca882d07740b44e3f "core: fix integer overflow in loops (issue #2178)")`

`[0973fe0](/weechat/weechat/commit/0973fe0ad458fe7c5ad2216ca882d07740b44e3f)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-70cd508)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[irc: fix integer overflow in loops (issue](/weechat/weechat/commit/70cd508cf00077259a9b23734820ee4d6e2a6eb7 "irc: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/70cd508cf00077259a9b23734820ee4d6e2a6eb7 "irc: fix integer overflow in loops (issue #2178)")`

`[70cd508](/weechat/weechat/commit/70cd508cf00077259a9b23734820ee4d6e2a6eb7)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-de30a87)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[relay: fix integer overflow in loops (issue](/weechat/weechat/commit/de30a87a21c3ad5aa7b01117910bba2bc5c93bee "relay: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/de30a87a21c3ad5aa7b01117910bba2bc5c93bee "relay: fix integer overflow in loops (issue #2178)")`

`[de30a87](/weechat/weechat/commit/de30a87a21c3ad5aa7b01117910bba2bc5c93bee)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-172d383)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[trigger: fix integer overflow in loop (issue](/weechat/weechat/commit/172d383fd1521cb53b9e852f38470e5ea94a5ca6 "trigger: fix integer overflow in loop (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/172d383fd1521cb53b9e852f38470e5ea94a5ca6 "trigger: fix integer overflow in loop (issue #2178)")`

`[172d383](/weechat/weechat/commit/172d383fd1521cb53b9e852f38470e5ea94a5ca6)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 7, 2024](#ref-commit-1abeb71)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: update ChangeLog (issue](/weechat/weechat/commit/1abeb71603d3f54faf487280b5eb30675e5f54ae "core: update ChangeLog (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/1abeb71603d3f54faf487280b5eb30675e5f54ae "core: update ChangeLog (issue #2178)")`

`[1abeb71](/weechat/weechat/commit/1abeb71603d3f54faf487280b5eb30675e5f54ae)`

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 7, 2024](#issuecomment-2335194571)

| I fixed similar problems and backported everything on branch 4.4.  I'll release version 4.4.2 after some tests. |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 7, 2024](#issuecomment-2335286005)

| I also added the vulnerability in the list: <https://weechat.org/doc/weechat/security/WSA-2024-1/> |
| --- |

All reactions

Sorry, something went wrong.

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Sep 8, 2024](#issuecomment-2336532441)

| I also added the vulnerability in the list: <https://weechat.org/doc/weechat/security/WSA-2024-1/>  Thank you for your notification, and will it have a CVE-ID? or shall I request a CVEID? |
| --- |

All reactions

Sorry, something went wrong.

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=80&v=4)](/flashcode)

Copy link

Member

### **[flashcode](/flashcode)** commented [Sep 8, 2024](#issuecomment-2336564742)

| Yes, I'm requesting one and I'll add it in the list and in the ChangeLog once attributed. |
| --- |

All reactions

Sorry, something went wrong.

[flashcode](/flashcode)
pushed a commit
that referenced
this issue
[Sep 8, 2024](#ref-commit-d165594)
[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=40&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken) [![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: fix integer overflow in string_free_split functions (issue](/weechat/weechat/commit/d1655945cd513e99a4964887ef41f78c124366a5 "core: fix integer overflow in string_free_split functions (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/d1655945cd513e99a4964887ef41f78c124366a5 "core: fix integer overflow in string_free_split functions (issue #2178)")`

`[d165594](/weechat/weechat/commit/d1655945cd513e99a4964887ef41f78c124366a5)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 8, 2024](#ref-commit-64eee89)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: fix integer overflow in loops (issue](/weechat/weechat/commit/64eee892b2d14e1a86f00db55dbb5da928249d14 "core: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/64eee892b2d14e1a86f00db55dbb5da928249d14 "core: fix integer overflow in loops (issue #2178)")`

`[64eee89](/weechat/weechat/commit/64eee892b2d14e1a86f00db55dbb5da928249d14)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 8, 2024](#ref-commit-d8c9544)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[irc: fix integer overflow in loops (issue](/weechat/weechat/commit/d8c954472c43e7745758c8ea38b0a268fb210921 "irc: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/d8c954472c43e7745758c8ea38b0a268fb210921 "irc: fix integer overflow in loops (issue #2178)")`

`[d8c9544](/weechat/weechat/commit/d8c954472c43e7745758c8ea38b0a268fb210921)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 8, 2024](#ref-commit-9a0bd7c)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[relay: fix integer overflow in loops (issue](/weechat/weechat/commit/9a0bd7c753b8d74af399e7d35128112bde56dd7a "relay: fix integer overflow in loops (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/9a0bd7c753b8d74af399e7d35128112bde56dd7a "relay: fix integer overflow in loops (issue #2178)")`

`[9a0bd7c](/weechat/weechat/commit/9a0bd7c753b8d74af399e7d35128112bde56dd7a)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 8, 2024](#ref-commit-4a63d88)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[trigger: fix integer overflow in loop (issue](/weechat/weechat/commit/4a63d88895e577ba804a8f11bac886fc1255c714 "trigger: fix integer overflow in loop (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/4a63d88895e577ba804a8f11bac886fc1255c714 "trigger: fix integer overflow in loop (issue #2178)")`

`[4a63d88](/weechat/weechat/commit/4a63d88895e577ba804a8f11bac886fc1255c714)`

[flashcode](/flashcode)
added a commit
that referenced
this issue
[Sep 8, 2024](#ref-commit-3ece5bd)
[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode)

`[core: update ChangeLog (issue](/weechat/weechat/commit/3ece5bd8a9ba423aa50957d6c47fe265dca5951b "core: update ChangeLog (issue #2178)") [#2178](https://github.com/weechat/weechat/issues/2178)[)](/weechat/weechat/commit/3ece5bd8a9ba423aa50957d6c47fe265dca5951b "core: update ChangeLog (issue #2178)")`

`[3ece5bd](/weechat/weechat/commit/3ece5bd8a9ba423aa50957d6c47fe265dca5951b)`

[![@wahjava](https://avatars.githubusercontent.com/u/2255192?s=40&v=4)](/wahjava)
[wahjava](/wahjava)
mentioned this issue
[Sep 9, 2024](#ref-pullrequest-2512325714)

[weechat: 4.4.1 -> 4.4.2
NixOS/nixpkgs#340494](/NixOS/nixpkgs/pull/340494)
 Merged

13 tasks

[![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=80&u=28d045cef8423a93b01acb7a4ffe5f4f094b0bd0&v=4)](/Crispy-fried-chicken)

Copy link

Contributor

Author

### **[Crispy-fried-chicken](/Crispy-fried-chicken)** commented [Dec 24, 2024](#issuecomment-2561110832)

| Hey [@flashcode](https://github.com/flashcode) , Thank you for your reply about this issue which is detected by our tools. Now I really want to know your thoughts about our tool. When you have a chance, could you please take a look at our tool? Specifically, we're interested in understanding:   1. Do you feel the detection results from our tool help enhance the security of your project? 2. Would you be willing to let us regularly scan your project in the future to identify potential vulnerabilities? 3. Our tool works by collecting patches from existing publicly disclosed vulnerabilities in real time and scanning target projects for the presence of identical code or similar logic. Do you have any suggestions for improving this vulnerability detection approach?    Please feel free to tell me your thoughts, it's really important for us to improve our tool. Thank you! |
| --- |

All reactions

Sorry, something went wrong.

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2Fweechat%2Fweechat%2Fissues%2F2178)

Assignees

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=40&v=4)](/flashcode) [flashcode](/flashcode)

Labels

[bug](/weechat/weechat/labels/bug)
Unexpected problem or unintended behavior

Projects

None yet

Milestone

 [**4.5.0**](/weechat/weechat/milestone/50 "4.5.0")

Development

No branches or pull requests

2 participants

[![@flashcode](https://avatars.githubusercontent.com/u/1776783?s=52&v=4)](/flashcode) [![@Crispy-fried-chicken](https://avatars.githubusercontent.com/u/65160922?s=52&v=4)](/Crispy-fried-chicken)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from weechat.org_550a87a7_20250114_190525.html ===

[![WeeChat](/media/images/weechat_logo_small.png)](/)

[Home](/)
[About](/about/)
[Documentation](/doc/)
[Download](/download/)
[Scripts](/scripts/)
[Development](/dev/)

[Donate](/donate/ "Donate")

English
Français
Deutsch
Italiano
Polski
Portugues (Brasil)
日本語

* [WeeChat](/doc/weechat/stable/)
* [WeeChat Relay](/doc/weechat-relay/stable/)
* [QWeeChat](/doc/qweechat/stable/)

* [Stable](/doc/weechat/stable/)
* [Development](/doc/weechat/devel/)
* [Security](/doc/weechat/security/)

* [All vulnerabilities](/doc/weechat/security/)
* [Vulnerabilities by version](/doc/weechat/security/version/)

#### Overview: 1 vulnerability

| WSA | CVE | Score | Severity | Issue | Vulnerability type | Scope | Versions | Fix Release date | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [WSA-2024-1](#WSA-2024-1) | CVE-2024-46613 | 3.8 |  | Integer overflow in loops on lists. | Integer Overflow or Wraparound | Core, Plugins | 0.1.6 → 4.4.1 | 4.4.2 | Sep 8, 2024 |

#### [WSA-2024-1](/doc/weechat/security/WSA-2024-1/): [Core, Plugins] Integer overflow in loops on lists.

##### Vulnerability

CVE

CVE-2024-46613
[
[MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-46613) /
[NVD](https://nvd.nist.gov/vuln/detail/CVE-2024-46613)
]

CVSS vector

AV:P/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:X/RL:O/RC:C
([detail](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator?vector=AV:P/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:L/E:X/RL:O/RC:C&version=3.1))

CVSS score

3.8
 / 10

Severity

low

Vulnerability type

Integer Overflow or Wraparound

Scope

Core, Plugins

Affected versions

0.1.6 → 4.4.1

Fixed version

4.4.2

(Sep 8, 2024)
-
[ChangeLog](https://github.com/weechat/weechat/releases/tag/v4.4.2)

Tracker

[issue #2178](https://github.com/weechat/weechat/issues/2178)

Commits

[Commit](https://github.com/weechat/weechat/commit/315f769ab25643cf501a4bf8deb8025d92654303) [Commit](https://github.com/weechat/weechat/commit/5564baf424d847144f13ee50f0988e4f3407e638) [Commit](https://github.com/weechat/weechat/commit/62d0347d4bdee63694354184611b0b6af5028ff2) [Commit](https://github.com/weechat/weechat/commit/970f20af31cbcce02a99368eb633e8c4082dfe64) [Commit](https://github.com/weechat/weechat/commit/9aa0a94156c7cc367d52c31e60d8b03239d4dbd4)

##### Description

An integer overflow can happen when looping over items in a list.

This can only happen in rare conditions on 32 and 64-bit systems, as the list must contain more than 2,147,483,647 elements.

On 16-bit systems, this happens with a list that contains more than 32,767 elements.
##### Mitigation

There is no known mitigation.

The upgrade to the latest stable version is highly recommended.
##### Credit

The issue was discovered by Yiheng Cao.

* [Home](/)
* [Latest news](/news/)
* [Upcoming events](/events/)
* [Make a donation](/donate/)

* [About](/about/)
* [Features](/about/features/)
* [Interfaces](/about/interfaces/)
* [Screenshots](/about/screenshots/)
* [History](/about/history/)
* [Support](/about/support/)
* [WeeChat.org](/about/weechat.org/)

* [Documentation](/doc/)
* [WeeChat](/doc/weechat/stable/)
* [WeeChat Relay](/doc/weechat-relay/stable/)
* [QWeeChat](/doc/qweechat/stable/)

* [Download](/download/)
* [WeeChat](/download/weechat/stable/)
* [WeeChat Relay](/download/weechat-relay/stable/)
* [QWeeChat](/download/qweechat/stable/)
* [Debian/Ubuntu repositories](/download/debian/)

* [Scripts](/scripts/)
* [Browse scripts](/scripts/)
* [Unofficial scripts](/files/scripts/unofficial/)
* [Python 3](/scripts/python3/)

* [Development](/dev/)
* [Roadmap](/dev/roadmap/)
* [Statistics](/dev/stats/)
* [Info](/dev/info/)
* [Development blog](https://blog.weechat.org/)

[GitHub](https://github.com/weechat "GitHub")
[Mastodon](https://hostux.social/%40weechat "Mastodon")
[Diaspora](https://diasp.eu/u/weechat "Diaspora")
[X](https://x.com/WeeChatClient "X")

Copyright © 2003-2025 Sébastien Helleu
—
[About WeeChat.org](/about/weechat.org/)
— Theme: **dark**
([light](?theme=light))


