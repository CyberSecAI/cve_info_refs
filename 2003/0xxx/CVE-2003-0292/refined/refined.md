The content is related to CVE-2003-0292.

**Root cause of vulnerability:**
The Inktomi Traffic-Server generates dynamic error pages that are vulnerable to Cross-Site Scripting (XSS).

**Weaknesses/vulnerabilities present:**
- The Traffic-Server does not properly sanitize user-supplied input (specifically, the URL) when generating error pages.
- The error page is generated by the proxy server, but the client cannot distinguish that the response did not come from the spoofed domain.

**Impact of exploitation:**
- An attacker can inject arbitrary JavaScript into the error page.
- The injected JavaScript code executes in the context of any domain accessed through the vulnerable proxy, enabling the attacker to steal cookies and potentially compromise user sessions.
- The vulnerability allows for a "man-in-the-middle" style attack, where the attacker can impersonate any server.
- Potential compromise of e-commerce and home banking sites due to cookie theft

**Attack vectors:**
- The attacker crafts a special URL that contains malicious JavaScript code.
- The attacker forces a client to use a vulnerable Traffic-Server proxy and sends a crafted request to a spoofed domain using a port other than 80 (specifically 443).
- When the Traffic-Server encounters an error, it generates an error page containing the attacker's injected script.
- The client's browser then executes the injected script because it believes that the error page is from the spoofed domain.

**Required attacker capabilities/position:**
- The attacker needs to know that the client is using a vulnerable Inktomi Traffic-Server proxy.
- The attacker needs to be able to send a crafted HTTP request with a spoofed domain to the client's proxy.
- The attacker needs to be able to trick the client into accessing this crafted URL.