=== Content from marc.info_34f8e94d_20250125_012153.html ===

```
[[prev in list](?l=bugtraq&m=106062111412674&w=2)] [[next in list](?l=bugtraq&m=106062056212016&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    phpWebSite SQL Injection & DoS & XSS Vulnerabilities
From:       ["Lorenzo Hernandez Garcia-Hierro" <novappc () novappc ! com>](?a=105074873000001&r=1&w=2)
Date:       [2003-08-10 23:16:44](?l=bugtraq&r=1&w=2&b=200308)
[Download RAW [message](?l=bugtraq&m=106062021711496&q=mbox) or [body](?l=bugtraq&m=106062021711496&q=raw)]

phpWebSite SQL Injection & DoS & XSS Vulnerabilities
------
PRODUCT: phpWebSite
VENDOR: Appalachian State University
VULNERABLE VERSIONS:

       - 0.9.x
       - 0.8.x
       - 0.7.x
       - And older versions.

NO VULNERABLE VERSIONS

- ?
---------------------

Description:

phpWebSite provides a complete web site content management system. Web-
based administration allows for easy maintenance of interactive,
community-driven web sites.

---------------------------------------------
|SECURITY HOLES FOUND and PROOFS OF CONCEPT:|
---------------------------------------------

I encountered SQL Injection vulnerabilities in some of the phpWebSite
modules , XSS ( Cross Site Scripting ) , Path Disclosures and a Denial
of Service attack.

-------------
| SQL       |
| INJECTION |
-------------

I encountered SQL Injection vulnerabilities in the Calendar module ,
active in default configurations , that allows you
to execute SQL queries in the target server with the privileges of the
application user.

When you send a special-crafted command url to the Calendar script you
get a SQL error flag like this:
__________________________________________________________________
DB Error: syntax error
select * from mod_calendar_events where ((startDate >= 2003\0[CRAFTED
VALUE]0110 and startDate <= 2003\0[CRAFTED VALUE]0110) or
(endDate >= 2003\0[CRAFTED VALUE]0110 and endDate <= 2003\0[CRAFTED
VALUE]0110)) and active=1 [nativecode=1064
** You have an error in your SQL syntax near
'\0[CRAFTED VALUE]0110 and startDate <= 2003\0[CRAFTED VALUE]0110) or
(endDate >= 2003\0[CRAFTED VALUE]0110 and endDate ' at line 1]
___________________________________________________________________

This is an example error flag:
___________________________________________________________________
DB Error: syntax error
select * from mod_calendar_events where ((startDate >= 2003\0-10110 and
startDate <= 2003\0-10110) or
(endDate >= 2003\0-10110 and endDate <= 2003\0-10110)) and active=1
[nativecode=1064
** You have an error in your SQL syntax near
'\0-10110 and startDate <= 2003\0-10110) or (endDate >= 2003\0-10110
and endDate ' at line 1]
___________________________________________________________________

For get this you must use this simple url:

http://[HOST]/[PATH]/index.php?module=calendar&calendar[view]
=day&year=2003%00-1&month=

And you get the SQL Error flag. The error occurs when the query
includes the crafted value 2003[%00 = null]-1 .
You can design a successful query for get configuration values or
authentication data.
I desgined an url that makes a successful query ( no hostile query ) :

http://[HOST]/[PATH]/index.php?module=calendar&calendar[view]
=month&month=11&year=2003%20and%20startDate%20%3c%3d%2020071205%29%20or%
20%28%20endDate%20%3e%3d031101%20and%20endDate%20%3c%3d%2020071205%29%
29%20and%20active%3d1

it is ( without url encoding ) :

2003 and startDate <= 20071205) or ( endDate >=031101 and endDate <=
20071205)) and active=1

It is needed to have a little knowledge of SQL ( in this case , MySQL )
for make a successful attack.

Other scripts of the Calendar module are affected by this hole , when
you send a crafted request like a + symbol at critical url variable
value
you get the "pure" sql server error flag and you can imagine ( i like
this word ) a sql query for view private information of the application
by
looking at the error pages , like an try-error method.

Another urls for probe are:

http://[HOST]/[PATH]/index.php?module=calendar&calendar[view]
=day&month=0&year=<

http://[HOST]/[PATH]/index.php?module=calendar&calendar[view]
=day&month=1%00&year=)SQL_INJECTION_FAKU

------------------
| XSS            |
| vulnerabilities|
------------------

I encountered XSS security holes in some scripts of phpWebSite :

http://[HOST]/[PATH]/index.php?module=calendar&calendar[view]
=day&month=2&year=2003&day=1+%00">[XSS ATTACK CODE]

http://[HOST]/[PATH]/index.php?module=fatcat&fatcat[user]
=viewCategory&fatcat_id=1%00+">[XSS ATTACK CODE]

http://[HOST]/[PATH]/index.php?
module=pagemaster&PAGE_user_op=view_page&PAGE_id=10">[XSS ATTACK CODE]
&MMN_position=[X:X]

http://[HOST]/[PATH]/index.php?
module=search&SEA_search_op=continue&PDA_limit=10">[XSS ATTACK CODE]

Note that the Calendar & PageMaster & Fatcat modules are affected
COMPLETLY and all the script variables that are passed by url are
affected too by this.

When you access a hostile link with a xss attack in those scripts youur
browser will execute the script commands.
This can be use for steal cookies , authentication tokens and other
private information.
If your browser is vulnerable to other holes ( like MSIE ;-) you can
have more problems...

XSS AT SQL ERRORS:

If you send a crafted url command with a XSS attack code to some of the
scripts that are vulnerable against sql injection vulnerabilities , the
xss attack code will be executed
in the error page.

-----------------
| PATH          |
|  DISCLOSURES  |
-----------------

I tested this in a Win2K ( Windows 2000 Professional ) with SP3 and
versions:

- Sambar Server 5.2 beta
- PHP 4.2.3 running as ISPAI module
- MySQL NT [normal service] 3.23.56
- Include_Path to the pear folder of phpwebsite

Sending this:

<http://127.0.0.1/index.php?module=calendar&calendar>[view]
=month&month=11&year=9 # You can try other things and get the same #

you get this:

Warning: localtime(): invalid local time in
C:\ws\phpws\lib\pear\Date\TimeZone.php on line 252

Warning: localtime(): invalid local time in
C:\ws\phpws\lib\pear\Date\TimeZone.php on line 252

<- more than fifty repetitions of this warning ->

It is a strange error , i think that it only occurs in MSWindows
installations.
Possible it occurs when the Pear library TimeZone.php script tries to
convert the localdate in unix time stamp format.

------------------
| DENIAL OF      |
|  SERVICE       |
------------------

There is a DoS/Buffer Overflow Attack in a script inside the Calendar
module that allows you to crash the host running
the MySQL server and the phpWebSite scripts ( must be the same
computer ).

This is a basic proof of concept for this vulnerability :

http://[HOST]/[PATH]/index.php?index.php?module=calendar&calendar[view]=
[VIEW FORM]&month=11&year=91+92+93...( more than 4000 bytes )

An attack like this causes a system global crash including the server
service and the mysql service.

-----------------
|   SoLuTiOnS   |
-----------------

1.- Be sure that the user of the phpWebSite database has only SELECT ,
INSERT and UPDATE privileges in only the phpWebSite
    database.

2.- Use the php function eregi_replace for prevent XSS attacks.

3.- Turn php_error_flags to Off .

4.- Use in addition an external module if you are using apache like
mod_security .

5.- If you are paranoic don't use PHP , MySQL , Windows , Linux ,
computers , tcp/ip ,  netbios , games , asp ,
    Apache......  nothing !
    WARNING ;-) : ( paranoic solution... )

-----------
| CONTACT |
-----------

Lorenzo Hernandez Garcia-Hierro
--- Computer Security Analyzer ---
--Nova Projects Professional Coding--
PGP: Keyfingerprint
B6D7 5FCC 78B4 97C1 4010 56BC 0E5F 2AB2
ID: 0x9C38E1D7
**********************************
[www.novappc.com](http://www.novappc.com)
security.novappc.com
[www.lorenzohgh.com](http://www.lorenzohgh.com)
______________________

NSRG-20-7
[[prev in list](?l=bugtraq&m=106062111412674&w=2)] [[next in list](?l=bugtraq&m=106062056212016&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_dc04a586_20250125_012225.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#925166

## PhpWebSite calendar module contains a SQL injection vulnerability

#### Vulnerability Note VU#925166

Original Release Date: 2004-10-19 | Last Revised: 2004-10-19

---

### Overview

The PhpWebSite contains an SQL injection vulnerability that may allow malicious users to execute SQL queries on a server with the privileges of the PhpWebSite administrator.

### Description

| PhpWebSite is an open-source web content management system that includes a web-based calendar module to let users to create, post, and view events on a PhpWebSite managed site. By default users must have requests for new events approved by a site administrator before they are added to the calendar. However, lack of input validation of the cal\_template variable may allow malicious users to inject a SQL query into the new event. If a site administrator approves the event the SQL query will be executed. |
| --- |

### Impact

| A remote attacker may be able to execute SQL queries on a server with the privileges of a PhpWebSite administrator. |
| --- |

### Solution

| **Apply a Patch**  PhpWebsite has released a patch to address this issue available at: <http://www.phpwebsite.appstate.edu/downloads/security/phpwebsite-core-security-patch.tar.gz>. |
| --- |

### Vendor Information

925166
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23925166/) to view vendors.**
### [Appalachian State University](#JGEI-64LJTA) Affected

Updated:  October 19, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Appalachian State University released an announcement regarding this issue available at:

<http://www.phpwebsite.appstate.edu/index.php?module=announce&ANN_user_op=view&ANN_id=822>

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.gulftech.org/?node=research&article_id=00048-08312004>
* <http://www.securitytracker.com/alerts/2004/Aug/1011120.html>
* <http://www.securityfocus.com/archive/1/332561>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0735>
* <http://marc.theaimsgroup.com/?l=bugtraq&m=106062021711496&w=2>
* <http://www.osvdb.org/displayvuln.php?osvdb_id=9444>
* [http://www.phpwebsite.appstate.edu/index.php?module=announce&ANN\_user\_op=view&ANN\_id=822](http://www.phpwebsite.appstate.edu/index.php?module=announce&ANN_user_op=view&ANN_id=822 )
### Acknowledgements

This vulnerability was publicly reported by GulfTech Security.

This document was written by Jeff Gennari.

### Other Information

| **CVE IDs:** | [CVE-2003-0735](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0735) |
| --- | --- |
| **Severity Metric:** | 0.20 |
| **Date Public:** | 2004-08-31 |
| **Date First Published:** | 2004-10-19 |
| **Date Last Updated:** | 2004-10-19 20:44 UTC |
| **Document Revision:** | 131 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_b5f42b63_20250125_012224.html ===

```
[[prev in list](?l=bugtraq&m=106256529600929&w=2)] [[next in list](?l=bugtraq&m=106262113529592&w=2)] [[prev in thread](?l=gentoo-announce&m=106249254924303&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [GLSA:  phpwebsite (200309-03)](?t=106249268700003&r=1&w=2)
From:       [aliz () gentoo ! org (Daniel Ahlberg)](?a=105793199000003&r=1&w=2)
Date:       [2003-09-02 8:54:31](?l=bugtraq&r=1&w=2&b=200309)
[Download RAW [message](?l=bugtraq&m=106252188522715&q=mbox) or [body](?l=bugtraq&m=106252188522715&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- - - ---------------------------------------------------------------------
GENTOO LINUX SECURITY ANNOUNCEMENT 200309-03
- - - ---------------------------------------------------------------------

          PACKAGE : phpwebsite
          SUMMARY : SQL Injection, DoS and XSS Vulnerabilities
             DATE : 2003-09-02 08:54 UTC
          EXPLOIT : remote
VERSIONS AFFECTED : <phpwebsite-0.9.3_p1
    FIXED VERSION : >=phpwebsite-0.9.3_p1
              CVE :

- - - ---------------------------------------------------------------------

phpwebsite contains an sql injection vulnerability in the calendar
module which allows the attacker to execute sql queries.

In addition phpwebsite is also vulnerable to XSS, more information
can be found in the full advisory.

Read the full advisory at:
<http://marc.theaimsgroup.com/?l=bugtraq&m=106062021711496&w=2>

SOLUTION

It is recommended that all Gentoo Linux users who are running
net-www/phpwebsite upgrade to phpwebsite-0.9.3_p1 as follows:

emerge sync
emerge phpwebsite
emerge clean

- - - ---------------------------------------------------------------------
aliz@gentoo.org - GnuPG key is available at <http://dev.gentoo.org/~aliz>
- - - ---------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.3 (GNU/Linux)

iD8DBQE/VFrGfT7nyhUpoZMRAoFSAKChf1ZjKu8R0JwnRbE3DEkFP4SJ5ACfQCnY
XXjTcnVEuUXTG4YTF8EGpJ4=
=JhXo
-----END PGP SIGNATURE-----
[[prev in list](?l=bugtraq&m=106256529600929&w=2)] [[next in list](?l=bugtraq&m=106262113529592&w=2)] [[prev in thread](?l=gentoo-announce&m=106249254924303&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


