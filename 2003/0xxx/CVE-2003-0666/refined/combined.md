=== Content from docs.microsoft.com_a40e70d4_20250125_050038.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-036.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-036 - Important

## Buffer Overrun in WordPerfect Converter Could Allow Code Execution (827103)

Published: September 03, 2003 | Updated: November 24, 2003

**Version:** 1.2

**Originally posted:** September 03, 2003

**Updated:** November 24, 2003

#### Summary

**Who should read this bulletin:**
Customers who are using MicrosoftÂ® Office, Microsoft FrontPageÂ®, Microsoft Publisher, or Microsoft Works Suite

**Impact of vulnerability:**
Run code of attacker's choice

**Maximum Severity Rating:**
Important

**Recommendation:**
Customers who use any of the affected products that are listed below should apply the security patch at their earliest opportunity

**End User Bulletin:**

An end user version of this bulletin is available at:

[https:](https://).

**Affected Software:**

* Microsoft Office 97
* Microsoft Office 2000
* Microsoft Office XP
* Microsoft Word 98 (J)
* Microsoft FrontPage 2000
* Microsoft FrontPage 2002
* Microsoft Publisher 2000
* Microsoft Publisher 2002
* Microsoft Works Suite 2001
* Microsoft Works Suite 2002
* Microsoft Works Suite 2003
* Microsoft Works Suite 2004

### General Information

## Technical details

**Technical description:**

Microsoft Office provides a number of converters that allow users to import and edit files that use formats that are not native to Office. These converters are available as part of the default installation of Office and are also available separately in the Microsoft Office Converter Pack. These converters can be useful to organizations that use Office in a mixed environment with earlier versions of Office and other applications, including Office for the Macintosh and third-party productivity applications.

There is a flaw in the way that the Microsoft WordPerfect converter handles CorelÂ® WordPerfect documents. A security vulnerability results because the converter does not correctly validate certain parameters when it opens a WordPerfect document, which results in an unchecked buffer. As a result, an attacker could craft a malicious WordPerfect document that could allow code of their choice to be executed if an application that used the WordPerfect converter opened the document. Microsoft Word and Microsoft PowerPoint (which are part of the Office suite), FrontPage (which is available as part of the Office suite or separately), Publisher, and Microsoft Works Suite can all use the Microsoft Office WordPerfect converter.

The vulnerability could only be exploited by an attacker who persuaded a user to open a malicious WordPerfect document-there is no way for an attacker to force a malicious document to be opened or to trigger an attack automatically by sending an e-mail message.

**Mitigating factors:**

* The user must open the malicious document for an attacker to be successful. An attacker cannot force the document to be opened automatically.
* The vulnerability cannot be exploited automatically through e-mail. A user must open an attachment that is sent in an e-mail message for an e-mail-borne attack to be successful.

**Severity Rating:**

|  |  |
| --- | --- |
| **Microsoft Office (all versions)** | Important |
| **Microsoft FrontPage (all versions)** | Important |
| **Microsoft Publisher (all versions)** | Important |
| **Microsoft Works Suite (all versions)** | Important |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2003-0666](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0666)

**Tested Versions:**

Microsoft tested Word 97, Word 98 (J), Word 2000, Word 2002, FrontPage 2000, FrontPage 2002, PowerPoint 97, PowerPoint 2000, PowerPoint 2002, Publisher 2000, Publisher 2002, Works Suite 2001, Works Suite 2002, and Works Suite 2003 to assess whether they are affected by this vulnerability. Previous versions are no longer supported and may or may not be affected by this vulnerability.

## Frequently asked questions

**What's the scope of the vulnerability?**

This is a [buffer overrun](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. An attacker who successfully exploited this vulnerability could run the code of their choice on a user's system in the same security context as the user. An attacker's code could take any action that the system's owner could take, such as adding, changing, or deleting any data or configuration information. For example, the code could lower the security settings in the browser or write a file to the hard disk. Because the code would run as the user and not as the operating system, any security limitations on the user's account would also apply to any code that the attacker could run by successfully exploiting this vulnerability. In environments where user accounts are restricted, such as in enterprise environments, the actions that an attacker's code could take would be limited by these restrictions

**What is the Microsoft Office WordPerfect converter?**

The Microsoft Office WordPerfect converter helps users convert documents from Corel WordPerfect file formats to Microsoft Word file formats. The WordPerfect converter is included in all versions of Office and is also available separately in the Microsoft Office Converter Pack.

**What is the Microsoft Office Converter Pack?**

The Microsoft Office Converter Pack combines file converters and filters that were not included in earlier versions of Office. The converters and filters allow Office to work with additional document formats that are not natively supported. The Converter Pack is available as a Web download.

**What causes the vulnerability?**

The vulnerability results because the Microsoft Office WordPerfect converter does not correctly validate parameters that are passed to it when a WordPerfect document is opened, which results in an unchecked buffer.

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to run code of their choice on a user's system. This could allow an attacker to take any action on a user's system that the user had permissions to carry out.

**How could an attacker exploit this vulnerability?**

An attacker could seek to exploit this vulnerability by sending a malicious file to the user and by persuading the user to open the file. If the user opened the file, the application that used the WordPerfect converter could fail and could allow the attacker to execute code of their choice in the security context of the user.

**Can the vulnerability be exploited automatically through an e-mail message?**

No - a user must open a malicious document that an attacker sent to them by for the vulnerability to be exploited. Simply viewing an e-mail message-even if Microsoft Word has been selected as the default e-mail editor for Microsoft Outlook-would not expose the vulnerability.

**Is the Microsoft Office WordPerfect converter installed by default in all the products that are listed in the "Affected Software" section of this bulletin?**

Yes - by default, the WordPerfect converter is installed in all supported versions of the products that are listed in the "Affected Software" section of this bulletin. However, the user can choose not to install the converter during the setup process.

**What does the patch do?**

The patch corrects the vulnerability by making sure that the WordPerfect converter correctly validates parameters when it opens a document.

## Patch availability

**Download locations for this patch**

* Office XP, FrontPage 2002, Publisher 2002, Works 2002, and Works 2003:

  [https://www.microsoft.com/download/details.aspx?FamilyId=EC563DEE-6BFB-431D-B39E-2D672C0C223F&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=ec563dee-6bfb-431d-b39e-2d672c0c223f&displaylang;=en)

  Administrative update only:

  </https:>[https:](https://)
* Office 2000, FrontPage 2000, Publisher 2000, and Works 2001:

  [https://www.microsoft.com/download/details.aspx?FamilyId=D3ED4189-315A-411A-A739-F7181310FBA7&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=d3ed4189-315a-411a-a739-f7181310fba7&displaylang;=en)
* Office 97 and Word 98(J): For information about how to receive support for Word 97 and for Word 98(J) see the following Microsoft Knowledge Base article: [827656](https://support.microsoft.com/default.aspx?scid=kb;en-us;827656)
* Microsoft recommends users visit Office Update at [https://www.office.microsoft.com/ProductUpdates/default.aspx](https://www.office.microsoft.com/productupdates/default.aspx) to detect and install this security patch and all other public updates to Office family products (note: Office Update does not support Office 97 or Visio 2000).

#### Additional information about this patch

**Installation platforms:**

* The Office XP patch can be installed on systems that are running Office XP Service Pack 2, Microsoft Works 2002, and Microsoft Works 2003. The [administrative update](https://www.microsoft.com/office/ork/xp/journ/wpft1001a.htm) can also be installed on systems that are running Office XP [Service Pack 1](https://office.microsoft.com/downloads/2002/oxpsp1.aspx).
* The Office 2000 patch can be installed on systems that are running Office 2000 [Service Pack 3](https://office.microsoft.com/downloads/2000/o2ksp3.aspx) and Works 2001.
* For information about how to receive support for Office 97 and for Word 98(J) see the following Microsoft Knowledge Base article:

  [827656](https://support.microsoft.com/default.aspx?scid=kb;en-us;827656)

**Inclusion in future service packs:**

The fix for this issue will be included in any future service packs that are released for the affected products.

**Reboot needed:** No

**Patch can be uninstalled:** No

**Superseded patches:** None.

**Verifying patch installation:**

For all affected products, verify that the version number of the wpft532.cnv file is 2002.1100.5510.0.

**Caveats:**

None

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) [eEye Digital Security](https://www.eeye.com/) for reporting this issue to us and working with us to protect customers.

**Support:**

* Microsoft Knowledge Base article [827103](https://support.microsoft.com/default.aspx?scid=kb;en-us;827103) discusses this issue. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (September 03, 2003): Bulletin Created.
* V1.1 (September 04, 2003): Added link to Office XP Administrative Update.
* V1.2 (November 24, 2003): Added Microsoft Works Suite 2004 to affected products.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from marc.info_37935ddf_20250125_050006.html ===

```
[[prev in list](?l=bugtraq&m=106262044628732&w=2)] [[next in list](?l=bugtraq&m=106262017028309&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=106262413500696&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [EEYE: Microsoft WordPerfect Document Converter Buffer Overflow](?t=106261962200005&r=1&w=2)
From:       ["Marc Maiffret" <marc () eeye ! com>](?a=96537280300005&r=1&w=2)
Date:       [2003-09-03 19:19:41](?l=bugtraq&r=1&w=2&b=200309)
[Download RAW [message](?l=bugtraq&m=106261952827573&q=mbox) or [body](?l=bugtraq&m=106261952827573&q=raw)]

Microsoft WordPerfect Document Converter Buffer Overflow

Release Date:
September 3, 2003

Reported Date:
May 6, 2003

Severity:
Medium (Code Execution with User Interaction)

Systems Affected:
Microsoft Office 97, 2000, XP
Microsoft Word 98 (J)
Microsoft FrontPage 2000, 2002
Microsoft Publisher 2000, 2002
Microsoft Works Suite 2001, 2002, 2003

Description:

The Microsoft Word "WordPerfect" document converter included in Microsoft
Word has a buffer overflow bug. If the WordPerfect document converter is
installed (by default it is in Office 2000) and a malicious .doc file is
opened, there exists the ability for an attacker to execute arbitrary code.

This buffer overflow bug can also happen within Internet Explorer, because
Microsoft Word is executed automatically as a helper-application when a .doc
file is received.

This buffer overflow overwrites the return address in the stack area. We
confirmed that arbitrary code can be executed by using this buffer overflow
bug.

Technical Description:

While parsing a WordPerfect file, the WordPerfect converter copies data
stored in the .doc file to a local buffer. If we modify some bytes of the
.doc file, we can specify the data offset and data size. The WordPerfect
converter doesn't properly check the size of the data contained in the .doc
file, and tries to copy all of the data from the file to the local buffer
allocated in the stack area. This results in a typical buffer overflow
vulnerability in which we can set any value for EIP.

The process for making the .doc file to confirm this buffer overflow is as
follows:

[Technical data may wrap in eMail, please visit our website.]

1. Open Word and save an empty document as wordPerfect 5.0 file.
2. Open the .doc file in a binary editor. You'll be able to confirm the
following dump image:

 ADDRESS   00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
0123456789ABCDEF
----------------------------------------------------------------------------
--
 00000000  FF 57 50 43 6D 02 00 00 01 0A 00 00 00 00 00 00
.WPCm...........
  ...
 00000130  00 00 00 00 CD 01 00 00 08 00 02 00 00 00 CD 01
................
  ...
 000001C0  61 75 74 68 6F 72 00 65 45 79 65 00 00 00 00 FB
author.eEye.....
 000001D0  FF 05 00 32 00 00 00 00 00 01 01 6C 00 00 00 01
...2.......l....
 000001E0  02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
................
 000001F0  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
................

3. Modify 0x00 to 0x01 in offset 0x00000139.
4. Modify 0x00 to the value more than 0x80 in offset 0x000001D8.
5. Modify 0x00 to the value more than 0x01 in offset 0x000001E1 to
0x000001FF.
6. Append garbage data (e.g., a long string of A's) onto the end of this
file.

Protection:
Retina Network Security Scanner has been updated to identify this
vulnerability.

Vendor Status:
Microsoft was notified on May 6, 2003, and has released a patch for this
vulnerability. The patch is available at:
<http://www.microsoft.com/technet/security/bulletin/MS03-036.asp>

Credit:
Yuji "The Ninja" Ukai, eEye Digital Security

Related Links:
Retina Network Security Scanner - Free 15 Day Trial
<http://www.eeye.com/html/Products/Retina/index.html>

Greetings:
Shanti, Yukkie, TEX, Sakuranamiki people, AD200X people

Copyright (c) 1998-2003 eEye Digital Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without express consent of
eEye. If you wish to reprint the whole or any part of this alert in any
other medium excluding electronic medium, please e-mail alert@eEye.com for
permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There are
NO warranties with regard to this information. In no event shall the author
be liable for any damages whatsoever arising out of or in connection with
the use or spread of this information. Any use of this information is at the
user's own risk.

Feedback
Please send suggestions, updates, and comments to:

eEye Digital Security
<http://www.eEye.com>
info@eEye.com

[[prev in list](?l=bugtraq&m=106262044628732&w=2)] [[next in list](?l=bugtraq&m=106262017028309&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=106262413500696&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_c362fe31_20250125_050037.html ===

```
[[prev in list](?l=bugtraq&m=106289003203843&w=2)] [[next in list](?l=bugtraq&m=106288967203671&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Microsoft WordPerfect Document Converter Exploit
From:       ["Valgasu" <valgasu () rstack ! org>](?a=104204443200002&r=1&w=2)
Date:       [2003-09-05 21:49:30](?l=bugtraq&r=1&w=2&b=200309)
[Download RAW [message](?l=bugtraq&m=106279971612961&q=mbox) or [body](?l=bugtraq&m=106279971612961&q=raw)]

You can find a simple exploit for the Eeye vulnerability on
Microsoft WordPerfect Document Converter Buffer Overflow :
<http://valgasu.rstack.org/word.zip>

Modify the source and add new targets OS. This exploit works
on several french Windows NT/2K with Word 2000 9.0.2812
but it's trivial to modify exploit for Word 2000 SR1 for example
(offset in file of eip isn't the same). Read source code and test
your own system.

Valgasu

[[prev in list](?l=bugtraq&m=106289003203843&w=2)] [[next in list](?l=bugtraq&m=106288967203671&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


