=== Content from marc.info_892ead20_20250125_182602.html ===

```
[[prev in list](?l=bugtraq&m=104428689506537&w=2)] [[next in list](?l=bugtraq&m=104428977111416&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Bladeenc 0.94.2 code execution
From:       [Auriemma Luigi <aluigi () pivx ! com>](?a=102951177100002&r=1&w=2)
Date:       [2003-02-02 19:53:50](?l=bugtraq&r=1&w=2&b=200302)
[Download RAW [message](?l=bugtraq&m=104428700106672&q=mbox) or [body](?l=bugtraq&m=104428700106672&q=raw)]

######################################################################

Applications: Blade encoder (<http://bladeenc.mp3.no>)
Versions:     0.94.2 and previous versions
Platforms:    All the platforms supported by the program
Bug:          Usage of an integer number for seeking the file
Risk (high):  A wave file let the attacker to execute all the code he
              want on the victim
Author:       Auriemma Luigi, Security Researcher, PivX Solutions, LLC
              e-mail: aluigi@pivx.com
              web:    <http://www.pivx.com/luigi/>

######################################################################

1) Introduction
2) Bug
3) The Code
4) Fix
5) Philosophy

######################################################################

===============
1) Introduction
===============

Blade encoder is an excellent OpenSource mp3 encoder that run in
console and is multiplatform.
Unfortunally now it is not more supported by its author, so take a
look to my patch in the "Fix" section of this advisory.

######################################################################

======
2) Bug
======

The bug is caused by the usage of an integer value with sign for
seeking the wave file after that the program read the size of the
"fmt " wave chunk.

Exactly the problem is located in the usage of the integer var
"offset" in myFseek function at the end of the samplein.c file.

######################################################################

===========
3) The Code
===========

I have written a very simple wave file that show a message in the
console when the program is launched (bladeenc blade586-942.wav).
The exploit has been coded for run ONLY on the precompiled version of
the program for Windows on i586
(<http://www2.arnes.si/~mmilut/BEnc-0942-Win-i586.zip>).
The proof-of-concept has been written for Windows98 ONLY.

<http://www.pivx.com/luigi/poc/blade586-942.wav>

######################################################################

======
4) Fix
======

As I have said in the Introduction this good program is not more
supported, however the patch is very very simple and is easy to apply
to all the versions of Bladeenc simply because the function to patch
is the last in the samplein.c file.

bladeenc/samplein.c
-------------------
...
619        char                                    dummy[256];
620 //PATCH
621        offset = abs(offset);
622 //PATCH
623
624        while (offset >= 256)
...
-------------------

Any other ideas about patch?

######################################################################

=============
5) Philosophy
=============

I'm really hopeful about the FULL-DISCLOSURE policy, because with it
"everyone" can know the real effects of an attack, the real danger of
a bug, someone can learn a bit of creative programming (I have learned
a bit of interesting C from the source code of some published
exploits) and it's useful for all the people that are hopeful in this
type of disclosure.
No secrets!

######################################################################

====================
About PivX Solutions
====================

PivX Solutions, is a premier network security consultancy offering a
myriad of network security services to our clients, the most notable
being our proprietary StrikeFirst Security Assessments
(<http://www.pivx.com/sf.html>).

For more information go to <http://www.PivX.com>

######################################################################

Any type of feedback is really welcome!

Byez

---
PivX Security Researcher
<http://www.pivx.com/luigi/>

[[prev in list](?l=bugtraq&m=104428689506537&w=2)] [[next in list](?l=bugtraq&m=104428977111416&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_ea3c7501_20250125_182608.html ===

```
[[prev in list](?l=bugtraq&m=104447238510361&w=2)] [[next in list](?l=bugtraq&m=104446318326935&w=2)] [[prev in thread](?l=gentoo-announce&m=104446242625808&w=2)] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [GLSA:  bladeenc](?t=104445718200006&r=1&w=2)
From:       [Daniel Ahlberg <aliz () gentoo ! org>](?a=102804217900002&r=1&w=2)
Date:       [2003-02-05 12:55:45](?l=bugtraq&r=1&w=2&b=200302)
[Download RAW [message](?l=bugtraq&m=104446346127432&q=mbox) or [body](?l=bugtraq&m=104446346127432&q=raw)]

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- - --------------------------------------------------------------------
GENTOO LINUX SECURITY ANNOUNCEMENT 200302-04
- - --------------------------------------------------------------------

PACKAGE : bladeenc
SUMMARY : arbitrary code execution
DATE    : 2003-02-05 12:55 UTC
EXPLOIT : local

- - --------------------------------------------------------------------

- From advisory:

"A wave file let the attacker to execute all the code he want on the
victim"

Read the full advisory at:
<http://www.pivx.com/luigi/adv/blade942-adv.txt>

SOLUTION

It is recommended that all Gentoo Linux users who are running
media-sound/bladeenc upgrade to bladeenc-0.94.2-r1 as follows:

emerge sync
emerge -u bladeenc
emerge clean

- - --------------------------------------------------------------------
aliz@gentoo.org - GnuPG key is available at [www.gentoo.org/~aliz](http://www.gentoo.org/~aliz)
styx@gentoo.org
- - --------------------------------------------------------------------
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.2.1 (GNU/Linux)

iD8DBQE+QQnMfT7nyhUpoZMRAj4gAKCysKGdI94DM7FfPu24xfxjhPPNSgCgowXK
b+MxfjWXGIiJs2VVyA848RM=
=Z9lw
-----END PGP SIGNATURE-----
[[prev in list](?l=bugtraq&m=104447238510361&w=2)] [[next in list](?l=bugtraq&m=104446318326935&w=2)] [[prev in thread](?l=gentoo-announce&m=104446242625808&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


