=== Content from www.kb.cert.org_eefcffc5_20250124_141347.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#422156

## Microsoft Exchange Server fails to properly handle specially crafted SMTP extended verb requests

#### Vulnerability Note VU#422156

Original Release Date: 2003-10-16 | Last Revised: 2003-10-22

---

### Overview

Microsoft Exchange fails to handle certain SMTP extended verbs correctly. In Exchange 5.5, this can lead to a denial-of-service condition. In Exchange 2000, this could permit an attacker to run arbitrary code.

### Description

| Microsoft Exchange is a popular collaboration product which includes extensive support for electronic mail, including support for SMTP. SMTP is a standard protocol for exchanging electronic mail over the internet. Exchange uses SMTP to communicate special handling instructions from one Exchange server to another through the use of SMTP extended verbs. Exchange fails to process some of these commands correctly. On Exchange 5.5, the failure can result in a denial of service condition, and on Exchange 2000, it could result in an attacker running arbitrary code. For more information, see [Microsoft Security Bulletin MS03-046](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-046.asp?frame=true&hidetoc=true). |
| --- |

### Impact

| An attacked could cause a denial of service condition against Exchange 5.5 or execute arbitrary code against Exchange 2000. |
| --- |

### Solution

| Apply a patch as described in Microsoft Security Bulletin MS03-046. |
| --- |

### Vendor Information

422156
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23422156/) to view vendors.**
### [Microsoft Corporation](#SVHN-5SD5QA) Affected

Updated:  October 15, 2003

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

See [Microsoft Security Bulletin MS03-046](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-046.asp?frame=true&hidetoc=true).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.securityfocus.com/archive/1/341978>
* <http://www.microsoft.com/technet/security/bulletin/MS03-046.asp>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;829436>
### Acknowledgements

Thanks to Microsoft for reporting this vulnerability. Microsoft has credited João Gouveia for reporting this vulnerability.

This document was written by Shawn Hernan based on information contained in Microsoft Security Bulletin MS03-046.

### Other Information

| **CVE IDs:** | [CVE-2003-0714](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0714) |
| --- | --- |
| **CERT Advisory:** | [CA-2003-27](http://www.cert.org/advisories/CA-2003-27.html) |
| **Severity Metric:** | 40.08 |
| **Date Public:** | 2003-10-15 |
| **Date First Published:** | 2003-10-16 |
| **Date Last Updated:** | 2003-10-22 15:34 UTC |
| **Document Revision:** | 5 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.cert.org_fdb4f397_20250124_141346.html ===


search

icon-carat-right

cmu-wordmark

[Carnegie Mellon University](https://www.cmu.edu)

# [Software Engineering Institute](/)

##

1. [SEI](/)
2. [About](/about/)
3. [Divisions](/about/divisions/)
4. The CERT Division

## The CERT Division

The CERT Division is a leader in cybersecurity. We partner with government, industry, law enforcement, and academia to improve the security and resilience of computer systems and networks. We study problems that have widespread cybersecurity implications and develop advanced methods and tools to counter large-scale, sophisticated cyber threats.

* [Leadership](/about/divisions/cert/index.cfm#leadership)
* [What We Do](/about/divisions/cert/index.cfm#cert-division-what-we-do)
* [Careers in the CERT Division](/about/divisions/cert/index.cfm#careers)
* [Recent Vulnerabilities](/about/divisions/cert/index.cfm#CERTRecentlyPublishedVulnerabilityNotes)
* [Case Studies](/about/divisions/cert/index.cfm#case-studies)
* [History](/about/divisions/cert/index.cfm#history)

## Leadership

[![Gregory J. Touhill](/sei-images/images/Touhill_Greg_393_2023_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=314857)
#### [Gregory J. Touhill](/about/leadership/display.cfm?customel_datapageid_2623=314857)

Director, CERT Division

[![William Wilson](/sei-images/images/Wilson_William_324_200113_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=3871)
#### [William Wilson](/about/leadership/display.cfm?customel_datapageid_2623=3871)

Deputy Director, CERT Division

[![Chris Inacio](/sei-images/images/inacio-chris-96_2622.jpg)](/about/leadership/display.cfm?customel_datapageid_2623=494689)
#### [Chris Inacio](/about/leadership/display.cfm?customel_datapageid_2623=494689)

Chief Engineer, CERT Division

## What We Do

CERT experts are a diverse group of researchers, software engineers, security analysts, and digital intelligence specialists working together to research security vulnerabilities in software products, contribute to long-term changes in networked systems, and develop cutting-edge information and training to improve the practice of cybersecurity.

Our connection to the internationally known [Carnegie Mellon University](https://www.cmu.edu/) creates multidisciplinary collaboration opportunities and amplifies our research abilities.

#### Autonomy Security and Resilience

Develop and sustain security, resilience, and assurance best practices for the development, construction, and employment of machine learning systems.

#### [Cybersecurity Center Development](https://www.sei.cmu.edu/our-work/cybersecurity-center-development/index.cfm)

Develop measurable and repeatable practices to prepare CSIRTs and other operational security organizations.

#### [Cybersecurity Engineering](https://www.sei.cmu.edu/our-work/cybersecurity-engineering/index.cfm)

Develop methods for engineering mission-essential capabilities that balance security and resiliency with mission performance.

#### [Cyber Workforce Development](https://www.sei.cmu.edu/our-work/cyber-workforce-development/index.cfm)

Develop and maintain a well-equipped cyber workforce that is immediately able to support the cybersecurity needs of organizations.

#### [Enterprise Risk and Resilience Management](https://www.sei.cmu.edu/our-work/enterprise-risk-resilience-management/index.cfm)

Develop measurable practices and frameworks that enable organizations to measure and mitigate risks.

#### [Insider Threat](https://www.sei.cmu.edu/our-work/insider-threat/index.cfm)

Detect and mitigate the impact of insider threats and reduce their occurrence in organizations.

#### [Reverse Engineering for Malware Analysis](https://www.sei.cmu.edu/our-work/reverse-engineering-for-malware-analysis/index.cfm)

Develop tools and methods to identify and mitigate code that causes unintended effects in software systems.

#### [Situational Awareness](https://www.sei.cmu.edu/our-work/situational-awareness/index.cfm)

Analyze the cyber terrain as it evolves to characterize assets at risk, measure adversary activity, and prioritize responses to threat.

#### [Secure Development](https://www.sei.cmu.edu/our-work/secure-development/index.cfm)

Assess platforms through the analysis of source code to assure they adhere to security best practices.

#### [System and Platform Evaluation](https://www.sei.cmu.edu/our-work/projects/display.cfm?customel_datapageid_4050=21361)

Assess software, devices, systems, and platforms of unknown design or origin to find vulnerabilities and strategies for defending against possible attacks.

#### [Security Vulnerabilities](https://www.sei.cmu.edu/our-work/security-vulnerabilities/index.cfm)

Reduce exposure to known vulnerabilities in systems.

* ## Careers in the CERT Division

#### [Cyber Risk Intern](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cyber-Risk-Intern_2022294-1)

Pittsburgh, PA

#### [Senior Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Software-Engineer_2020922-1)

Pittsburgh, PA

#### [Associate Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Associate-Research-Scientist---Quantum_2021979)

Pittsburgh, PA

#### [Documentation Specialist and Content Strategist](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Documentation-Specialist-and-Content-Strategist_2022203-1)

Pittsburgh, PA

#### [Senior Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Communications-Engineer_2022179-1)

Pittsburgh, PA

#### [Senior AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-AI-Security-Researcher_2021569-1)

Pittsburgh, PA

#### [Technical Manager - Cybersecurity Assurance Team](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Technical-Manager---Cybersecurity-Assurance-Team_2022101-1)

2 Locations

#### [Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/System-Designer_2017276)

Pittsburgh, PA

#### [AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/AI-Security-Researcher_2020107)

Pittsburgh, PA

#### [Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Vulnerability-Researcher_2019726-1)

Pittsburgh, PA

#### [Senior Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Vulnerability-Researcher_2020002-1)

Pittsburgh, PA

#### [Assistant Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Assistant-Communications-Engineer_2021848-2)

Pittsburgh, PA

#### [Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Research-Scientist---Quantum_2021633-1)

Pittsburgh, PA

#### [Senior Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Research-Scientist---Quantum_2021632)

Pittsburgh, PA

#### [Cybersecurity Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cybersecurity-Engineer_2020646-1)

2 Locations

[SEE ALL SEI JOB OPENINGS](https://cmu.wd5.myworkdayjobs.com/en-US/SEI/)

## Recently Published Vulnerabilities

#### [VU#199397: Insecure Implementation of Tunneling Protocols (GRE/IPIP/4in6/6in4)](https://kb.cert.org/vuls/id/199397)

###### January 17, 2025

#### [VU#952657: Rsync contains six vulnerabilities](https://kb.cert.org/vuls/id/952657)

###### January 14, 2025

#### [VU#529659: Howyar Reloader UEFI bootloader vulnerable to unsigned software execution](https://kb.cert.org/vuls/id/529659)

###### January 14, 2025

[More Vulnerabilities](https://www.kb.cert.org/vuls)
[Report a Vulnerability](https://www.kb.cert.org/vuls/report/)

## Case Studies

[![Cyber Lightning Case Study](/sei-images/images/thumb_mid_thumb_cyber-lightning_380x380_1_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)
#### [Cyber Lightning Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

The SEI hosted Cyber Lightning, a three-day joint training exercise involving Air National Guard and Air Force Reserve units from western Pennsylvania and eastern Ohio.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

[![SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/sei-images/images/thumb_mid_thumb_crisis-simulation_380x380_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)
#### [SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

In SEI crisis simulation exercises, participants use scenarios that present fictitious malicious actors and environmental factors based on real-world events.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

[![USPS Case Study](/sei-images/images/thumb_standard_thumb_usps-improves-its-cybersecurity-and-resilience_260x260_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)
#### [USPS Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

The SEI teamed with the U.S. Postal Service to help it improve its cybersecurity and resilience and collaborated on a program to develop a strong cybersecurity workforce.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

## History

The CERT Division is the birthplace of cybersecurity. For nearly 30 years, the CERT Division of the SEI has partnered with government, industry, law enforcement, and academia to advance cybersecurity and improve the security and resilience of computer systems and networks.

Originally focused on incident response, we have expanded into cybersecurity areas such as network situational awareness, malicious code analysis, secure coding, resilience management, insider threats, digital investigations and intelligence, workforce development, DevOps, forensics, software assurance, vulnerability discovery and analysis, and risk management.

     ![The CERT Division - Barbara Fraser and Ed DeHart](/sei-images/images/about-divisions-cert-history-aside-144-2_2134.jpg "The CERT Division - Barbara Fraser and Ed DeHart")   Barbara Fraser and Ed DeHart, part of the SEI’s CERT/CC in the early 1990s

## Former Director Richard Pethia

[Richard Pethia](/about/leadership/display.cfm?customel_datapageid_2623=3545) was founding director of the SEI's CERT Division. Pethia, who served as director of CERT from 1988 to 2016, guided the organization through tremendous growth and change. Under Pethia's leadership, the unit expanded and evolved from the CERT Coordination Center—a small group focused on computer incident response—to a research organization of more than 200 professionals dedicated to solving problems with widespread cybersecurity implications.

[SEE FULL PROFILE](/about/leadership/display.cfm?customel_datapageid_2623=3545)

     ![Former Director Richard Pethia](/sei-images/images/about-divisions-cert-pethia-aside-144-2_2159.jpg "Former Director Richard Pethia")

## Related Links

* [CERT Podcast Series](http://www.cert.org/podcasts/index.cfm)
* [CERT/CC Blog Series](http://insights.sei.cmu.edu/cert)
* [Computer Security Incident Response Teams](/education-outreach/computer-security-incident-response-teams/index.cfm)

* [FloCon](https://resources.sei.cmu.edu/news-events/events/flocon)
* [Insider Threat Blog Series](https://insights.sei.cmu.edu/insider-threat)
* [Insider Threat Symposium](https://www.eventbrite.com/e/2017-cert-insider-threat-symposium-registration-31893497309)

* [NatCSIRT Meeting](https://resources.sei.cmu.edu/news-events/events/natcsirt/index.cfm)
* [Vulnerability Database](https://www.kb.cert.org/vuls)

[Report a Vulnerability to CERT/CC](https://www.kb.cert.org/vuls/report/)
[Subscribe to SEI Bulletin](/subscribe-to-sei-bulletin/)
[Request Permission to Use SEI Materials](/legal/request-permission-to-use-sei-material)

Carnegie Mellon University
 Software Engineering Institute
 4500 Fifth Avenue
 Pittsburgh, PA 15213-2612
 412-268-5800

 [  [Facebook](https://www.facebook.com/SEICMU/)  |  [Twitter](https://twitter.com/SEI_CMU)  |  [LinkedIn](https://www.linkedin.com/company/software-engineering-institute)  |  [YouTube](https://www.youtube.com/user/TheSEICMU)  |  [iTunes](https://itunes.apple.com/us/podcast/software-engineering-institute-sei-podcast-series/id566573552?mt=2)  ]

[Contact Us](/contact-us/)

 [  [Office Locations](/locations/index.cfm)  |  [Additional Sites Directory](/additional-sites-directory/index.cfm)  |  [Legal](/legal/index.cfm)  |  [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm)  |  [CMU Ethics Hotline](https://www.cmu.edu/hr/resources/ethics-hotline.html)  |  [www.sei.cmu.edu](/index.cfm)  ]

©2025 Carnegie Mellon University



=== Content from docs.microsoft.com_4eabc66a_20250124_141347.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-046.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-046 - Critical

## Vulnerability in Exchange Server Could Allow Arbitrary Code Execution (829436)

Published: October 15, 2003 | Updated: April 13, 2004

**Version:** 2.0

**Issued:** October 15, 2003

**Updated:** April 13, 2004

**Version Number:** 2.0

[See all Exchange Server bulletins released October, 2003](https://technet.microsoft.com/security/bulletin/excoct03)

#### Summary

**Who Should Read This Document:**
System administrators who have servers running MicrosoftÂ® Exchange Server

**Impact of Vulnerability:**
Remote Code Execution

**Maximum Severity Rating:**
Critical

**Recommendation:**
System administrators should apply the security patch to Exchange servers immediately

**Patch Replacement:**
None

**Caveats:**
None

**Tested Software and Patch Download Locations:**

**Affected Software:**

* Microsoft Exchange Server 5.0, Service Pack 2 -[Download the patch](https://www.microsoft.com/download/details.aspx?familyid=164610a4-aafc-40ac-85ca-349dbdbe1731&displaylang;=en)
* Microsoft Exchange Server 5.5, Service Pack 4 - [Download the patch](https://www.microsoft.com/download/details.aspx?familyid=a9e872ea-54b0-4179-8ae9-5648bfb46459&displaylang;=en)
* Microsoft Exchange 2000 Server, Service Pack 3 - [Download the patch](https://www.microsoft.com/download/details.aspx?familyid=7baf5394-1b4e-4937-a570-9f232ae49f01&displaylang;=en)

**Non Affected Software:**

* Microsoft Exchange Server 2003

The software listed above has been tested to determine if the versions are affected. Other versions are no longer [supported](https://support.microsoft.com/default.aspx?scid=fh;en-us;lifecycle), and may or may not be affected.

### General Information

## Technical Details

**Technical Description:**

Subsequent to the release of this bulletin, it was determined that the vulnerability addressed also affects Exchange Server 5.0. Microsoft has updated the bulletin with additional information about Exchange Server 5.0 and also to direct users to a security update for this additional affected platform. This security update for Exchange 5.0 is a cumulative rollup package that also addresses the vulnerabilities discussed in [MS00-082](https://technet.microsoft.com/security/bulletin/ms00-082) and [MS01-041](https://technet.microsoft.com/security/bulletin/ms01-041). You need only install this security update once to be protected against all three vulnerabilities.

In Exchange Server 5.0 and Exchange Server 5.5, a security vulnerability exists in the Internet Mail Service that could allow an unauthenticated attacker to connect to the SMTP port on an Exchange server and issue a specially-crafted extended verb request that could allocate a large amount of memory. This could shut down the Internet Mail Service or could cause the server to stop responding because of a low memory condition.

In Exchange 2000 Server, a security vulnerability exists that could allow an unauthenticated attacker to connect to the SMTP port on an Exchange server and issue a specially-crafted extended verb request. That request could cause a denial of service that is similar to the one that could occur on Exchange Server 5.0 and Exchange Server 5.5. Additionally, if an attacker issues the request with carefully chosen data, the attacker could cause a buffer overrun that could allow the attacker to run malicious programs of their choice in the security context of the SMTP service.

**Mitigating Factors:**

* Microsoft ISA Server 2000, or third-party products that relay and filter SMTP traffic before forwarding it to Exchange, could be used to prevent this attack over the Internet.

  Customers who use ISA Server 2000 to publish Exchange SMTP services with the default SMTP publishing rules are at reduced risk from this attack over the Internet. The Workarounds section below discusses these ISA publishing rules.

**Severity Rating:**

|  |  |  |
| --- | --- | --- |
| **Exchange Server 5.0** | Important |  |
| **Exchange Server 5.5** | Important |  |
| **Exchange 2000 Server** | Critical |  |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability Identifier:** [CAN-2003-0714](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0714)

## Workarounds

Microsoft has tested the following workarounds. These workarounds will not correct the underlying vulnerability however they help block **known** attack vectors. Workarounds may cause a reduction in functionality in some cases - in such situations this is identified below.

* **Use SMTP protocol inspection to filter out SMTP protocol extensions.**

  There are default ISA publishing rules for Exchange for filtering out any SMTP protocol extensions from traffic that passes the firewall. Other third-party products may offer similar functionality. More information on how to publish an Exchange server computer with ISA Server can be found at:

  [https:](https://).
* **Only accept authenticated SMTP sessions.**

  If practical, accept only connections from SMTP servers that authenticate themselves by using the SMTP AUTH command.

  **To require SMTP authentication on an Exchange 2000 server:**

  1. Start Exchange System Manager.
  2. Locate the server in the organization tree.
  3. Expand the Protocols container for the server.
  4. Expand the SMTP container.
  5. For each SMTP virtual server:
     + Open the properties and of the virtual server object.
     + Click the Access properties page.
     + Click the Authentication button.
     + Clear the "Anonymous Access" checkbox.
     + Click OK to accept the change.

  **To require SMTP authentication on an Exchange 5.5 server:**

  To require authentication for inbound connections:

  1. Click the Connections page.
  2. In the "Accept Connections" Section, mark the radio button for "Only from hosts using Authentication."

  **Impact of Workaround:** Typically, inbound SMTP mail is accepted without requiring authentication from the sender. If you require authentication, only senders that can present authentication credentials will be able to send mail to you.

  The Exchange 5.0 Internet Mail Service does not support mandatory authentication for inbound connections. However, it is possible to configure the Internet Mail Connector to accept mail only from designated IP addresses. If you do this, you will only be able to receive inbound mail from the servers you have specifically allowed.

  To configure Exchange 5.0 to accept mail only from designated hosts:

  + Start Exchange Administrator and open the properties of the Internet Mail Service object.
  + On the Connections page, select "Accept or reject by host" and then specify the hosts from which you will accept mail.
* **Use a firewall to block the port that SMTP uses.**

  Use a firewall to block the port that SMTP uses. Typically, that is port 25.

  **Impact of Workaround :** This workaround should only be used as a last resort to help protect you from this vulnerability. This workaround may directly affect the ability to communicate with external parties by e-mail.

  For additional information about how to help make your Exchange environment more secure, visit the [Security Resources for Exchange 5.5](https://www.microsoft.com/technet/archive/exchangeserver55/maintain/secure.mspx) and [Security Resources for Exchange 2000](https://technet.microsoft.com/exchange/bb330835.aspx) Web sites.

## Frequently Asked Questions

**Why is Microsoft reissuing this bulletin?**

Subsequent to the release of this bulletin, it was determined that the vulnerability addressed also affects Exchange Server 5.0. Microsoft has updated the bulletin with additional information about Exchange Server 5.0 and also to direct users to an update for this additional affected platform. This update for Exchange 5.0 is a cumulative rollup package that also addresses the vulnerabilities in discussed in [MS00-082](https://technet.microsoft.com/security/bulletin/ms00-082) and [MS01-041](https://technet.microsoft.com/security/bulletin/ms01-041). You need only install this security update once to be protected against all three vulnerabilities.

**What is the scope of this vulnerability?**

In Exchange Server 5.0 and Exchange Server 5.5, this is a [denial of service](https://technet.microsoft.com/security/bulletin/glossary) vulnerability because an unauthenticated attacker could exhaust large amounts of memory on the server or could cause the Internet Mail Service to shut down. There is no buffer that is overrun in this version of Exchange.
In Exchange 2000 Server, this is a [buffer overrun](https://technet.microsoft.com/security/bulletin/glossary) vulnerability that could allow an unauthenticated attacker to exhaust large amounts of memory on the server or, at worst, run arbitrary code of their choice on the affected system in the security context of the Local System account.

**What causes the vulnerability?**

In Exchange Server 5.0 and Exchange Server 5.5, an unauthenticated attacker could issue a specially crafted SMTP extended verb request to allocate large amounts of memory.
In Exchange 2000 Server, an unauthenticated attacker could issue a specially crafted SMTP extended verb request to exploit an unchecked buffer.

**What is SMTP?**

SMTP (Simple Mail Transfer Protocol) is an industry standard for delivering e-mail over the Internet, as defined in [RFC 2821](https://www.ietf.org/rfc/rfc2821.txt?number=2821) and in [RFC 2822](https://www.ietf.org/rfc/rfc2821.txt?number=2822). The protocol defines the format of e-mail messages, the fields that are in e-mail messages, the contents of e-mail messages, and the handling procedures for e-mail messages.

**What are SMTP extended verbs?**

SMTP extended verbs are defined by the extension model that is defined in [RFC 2821](https://www.ietf.org/rfc/rfc2821.txt?number=2821). They allow addition of new functionality to the SMTP protocol. Microsoft Exchange uses an extended verb to communicate routing and other Exchange-specific information among Exchange servers in an Exchange environment.

**What is wrong with the way that Exchange handles SMTP extended verbs?**

In Exchange Server 5.0 and Exchange Server 5.5, the Internet Mail Service does not require the authentication used between Exchange servers within an Exchange organization before it allows the use of an extended verb to transfer certain information among Exchange servers in the Exchange organization.
In Exchange 2000 Server, the SMTP service does not require the authentication used between Exchange servers within an Exchange organization before it allows the use of an extended verb to transfer certain information among Exchange servers in the Exchange organization. Additionally, the SMTP service does not correctly allocate a buffer for this information.

**What would this vulnerability enable an attacker to do?**

The vulnerability could allow an unauthenticated attacker to exhaust large amounts of memory on the server. This could cause a state where the server would stop responding to requests. In Exchange 2000 Server, the attacker could also, in the worst case, be able to cause remote code execution.

**How could an attacker exploit this vulnerability?**

An unauthenticated attacker could seek to exploit this vulnerability by connecting to an SMTP port on the Exchange server and by issuing a specially-crafted extended verb request. These requests can allocate memory on the server and can cause a denial of service. In Exchange 2000 Server, it is also possible to craft the request causing the SMTP service to fail in such a way that an attacker could execute code. This could allow an attacker to take any action on the system in the security context of the SMTP service. By default, the SMTP service runs as Local System.

**Because Exchange 2000 Server uses the Windows 2000 SMTP service, does the vulnerability affect the SMTP service in Windows 2000?**

No. The vulnerability does not affect the Microsoft SMTP service on systems that are running Windows 2000 that do not have Exchange 2000 Server installed.
The vulnerability also does not affect the Microsoft SMTP services that can be installed on Windows NTÂ® Server 4.0 or on Windows XP.

**Does the vulnerability affect the SMTP service in Exchange Server 2003?**

No. The SMTP service in Exchange Server 2003 only accepts the SMTP extended verb request from Exchange servers within the same Exchange organization.

**Can this be exploited directly by using e-mail?**

No. This vulnerability could not be exploited by sending a specially-crafted e-mail message to a mailbox that is hosted on an Exchange server. An attacker would have to connect directly to the SMTP port on an Exchange server.

**What does this patch do?**

For Exchange Server 5.0 and Exchange Server 5.5 the patch removes the vulnerability by requiring that the authentication used between Exchange servers within an Exchange organization is used before an Exchange server accepts the SMTP extended verb requests.
For Exchange 2000 Server the patch removes the vulnerability by requiring that the authentication used between Exchange servers within an Exchange organization is used before an Exchange server accepts the SMTP extended verb requests. Additionally, this patch implements correct input validation in the affected buffer.

**Does this patch introduce any behavioral changes?**

Yes. In order to use the Exchange extended verb, the patch requires authenticated SMTP connections between Exchange servers within an Exchange organization.
Exchange servers automatically authenticate to other Exchange servers that are in the same Exchange organization. Therefore, Exchange servers typically do not require configuration changes.

## Security Patch Information

#### Exchange 2000 Server Service Pack 3

**Prerequisites:**

This security patch requires Exchange 2000 Server [Service Pack 3](https://technet.microsoft.com/exchange/bb288480.aspx).

**Inclusion in service packs:**

The fix for this issue is included in the [Exchange 2000 Post-Service Pack 3 (SP3) Rollup Patch](https://www.microsoft.com/download/details.aspx?familyid=e7aaa113-1403-4262-8269-4b2ab9ae5476&displaylang;=en).

**Installation Information:**

This security patch supports the following Setup switches:

**/?:** Show the list of installation switches.

**/u:** Use Unattended mode.

**/f:** Force other programs to quit when the computer shuts down.

**/n:** Do not back up files for removal.

**/o:** Overwrite OEM files without prompting.

**/z:** Do not restart when the installation is complete.

**/q:** Use Quiet mode (no user interaction).

**/l:** List the installed hotfixes.

**/x:** Extract the files without running Setup.

**Deployment Information**

To install the security patch without any user intervention, use the following command line:

**Exchange2000-KB829436-x86-enu /u /q /z**

**Restart Requirement:**

No reboot is required provided all applications are closed before installation (including applications opened via a terminal server session). However, the security patch will restart the IIS, SMTP, and the Exchange Server Information Store Service.

System managers should therefore carefully plan applying this patch to cause minimal impact on normal operations.

**Removal Information:**

To remove this update, use the Add or Remove Programs tool in Control Panel.

System administrators can use the Spuninst.exe utility to remove this security patch. The Spuninst.exe utility is located in the %Windir%\$ExchUninstall829436$\Spuninst folder, and it supports the following Setup switches:

**/?:** Show the list of installation switches.

**/f:** Force other programs to quit when the computer shuts down.

**/z:** Do not restart when the installation is complete.

**/q:** Use Quiet mode (no user interaction).

**File Information:**

The English version of this fix has the file attributes (or later) that are listed in the following table. The dates and times for these files are listed in coordinated universal time (UTC). When you view the file information, it is converted to local time. To find the difference between UTC and local time, use the **Time Zone** tab in the Date and Time tool in Control Panel.

| Date | Time | Version | Size | File Name | Folder |
| --- | --- | --- | --- | --- | --- |
| 15-Jul-2003 | 22:49 | 6.0.6487.1 | 131072 | drviis.dll | %EXSRVROOT%\bin |
| 15-Jul-2003 | 22:55 | 6.0.6487.1 | 307200 | exsmtp.dll | %EXSRVROOT%\bin |
| 15-Jul-2003 | 22:48 | 6.0.6487.1 | 94208 | peexch50.dll | %EXSRVROOT%\bin |
| 15-Jul-2003 | 22:48 | 6.0.6487.1 | 393216 | phatcat.dll | %EXSRVROOT%\bin |

**Verifying Patch Installation:**

To verify that the security patch is installed on your computer use the Microsoft Baseline Security Analyzer (MBSA) tool. For additional information about MBSA, click the following article number to view the article in the Microsoft Knowledge Base:

[320454](https://support.microsoft.com/default.aspx?kbid=320454) Microsoft Baseline Security Analyzer Version 1.1.1 Is Available

You may also be able to verify the files that this security patch installed by reviewing the following registry key:

HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Exchange Server 2000\SP4\829436

**Note:** This registry key may not be not created properly when an administrator or an OEM integrates or slipstreams the 829436 security patch into the installation source files.

#### Exchange Server 5.5 Service Pack 4

**Prerequisites:**

This security patch requires Exchange Server 5.5 [Service Pack 4](https://www.microsoft.com/technet/prodtechnol/exchange/downloads/55/sp4.mspx).

**Installation Information:**

For additional information about the command options that you can use to apply this update, click the article number below to view the article in the Microsoft Knowledge Base:

[257946](https://support.microsoft.com/default.aspx?scid=kb;en-us;257946) XGEN: GUI Hotfix Utility Switches /x /m /s /z

For example, the following command line installs the update without any user intervention, and does not force the computer to restart:

**Exchange5.5-KB829436-x86-enu /s**

**Deployment Information**

To install the security patch without any user intervention, use the following command line:

**xchange5.5-KB829436-x86-enu /s**

**Restart Requirement:**

The Microsoft Exchange Internet Mail Connector and all dependent services will be stopped to apply this hotfix and will be restarted before finishing. After the installation is complete, verify that all necessary Exchange services have been restarted.

System managers should therefore carefully plan applying this patch to cause minimal impact on normal operations.

**Removal Information:**

To remove this update, use the Add or Remove Programs tool in Control Panel or issue the following command in a console window:

%EXCHSRVR%\829436\UNINSTALL\UNINST.EXE

**File Information:**

The English version of this fix has the file attributes (or later) that are listed in the following table. The dates and times for these files are listed in coordinated universal time (UTC). When you view the file information, it is converted to local time. To find the difference between UTC and local time, use the **Time Zone** tab in the Date and Time tool in Control Panel.

| Date | Time | Version | Size | File Name | Folder |
| --- | --- | --- | --- | --- | --- |
| 01-Oct-2003 | 20:03 | 5.5.2657.72 | 504080 | msexcimc.exe | %EXSRVROOT%\connect\msexcimc\bin |
| 01-Oct-2003 | 20:04 | 5.5.2657.72 | 209680 | imcmsg.dll | %EXSRVROOT%\res |

**Verifying Patch Installation:**

To verify that the security patch is installed on your computer use the Microsoft Baseline Security Analyzer (MBSA) tool. For additional information about MBSA, click the following article number to view the article in the Microsoft Knowledge Base:

[320454](https://support.microsoft.com/default.aspx?kbid=320454) Microsoft Baseline Security Analyzer Version 1.1.1 Is Available

You may also be able to verify the files that this security patch installed by reviewing the following registry key:

HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Exchange Server 5.5\SP5\829436

**Note:** This registry key may not be not created properly when an administrator or an OEM integrates or slipstreams the 829436 security patch into the installation source files.

#### Exchange Server 5.0 Service Pack 2

**Prerequisites:**

This security patch requires Exchange Server 5.0 [Service Pack 2](https://support.microsoft.com/default.aspx?kbid=168858).

**Installation Information:**

For additional information about the command options that you can use to apply this update, click the article number below to view the article in the Microsoft Knowledge Base:

257946 XGEN: GUI Hotfix Utility Switches /x /m /s /z

For example, the following command line installs the update without any user intervention, and does not force the computer to restart:

**Exchange5.0-KB834130-x86-enu /s**

**Deployment Information**

To install the security patch without any user intervention, use the following command line:

**Exchange5.0-KB834130-x86-enu /s**

**Restart Requirement:**

All Exchange services will be stopped to apply this hotfix and will be restarted before finishing. After the installation is complete, verify that all necessary Exchange services have been restarted.

System managers should therefore carefully plan applying this patch to cause minimal impact on normal operations.

**Removal Information:**

To remove this update, use the Add or Remove Programs tool in Control Panel or issue the following command in a console window:

%EXCHSRVR%\834130\UNINSTALL\UNINST.EXE

**File Information:**

The English version of this fix has the file attributes (or later) that are listed in the following table. The dates and times for these files are listed in coordinated universal time (UTC). When you view the file information, it is converted to local time. To find the difference between UTC and local time, use the **Time Zone** tab in the Date and Time tool in Control Panel.

| Date | Time | Version | Size | file name | Folder |
| --- | --- | --- | --- | --- | --- |
| 01-Jan-2004 | 21:05 | 0.0.0.0 | 21832 | address.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 21:05 | 5.0.1462.21 | 26384 | address.dll | %EXSRVROOT%\connect\msexcimc\bin |
| 01-Jan-2004 | 21:05 | 5.0.1462.21 | 26384 | address.dll | %EXSRVROOT%\bin |
| 01-Jan-2004 | 20:51 | 0.0.0.0 | 31560 | edbback.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 20:51 | 5.0.1462.21 | 29456 | edbback.dll | %EXSRVROOT%\bin |
| 01-Jan-2004 | 21:06 | 0.0.0.0 | 41916 | ems\_rid.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 21:06 | 5.0.1462.21 | 66320 | ems\_rid.dll | %EXSRVROOT%\bin |
| 01-Jan-2004 | 21:21 | 0.0.0.0 | 1315112 | emsmta.dbg | %SYSTEMROOT%\symbols\exe |
| 01-Jan-2004 | 21:21 | 5.0.1462.21 | 2022672 | emsmta.exe | %EXSRVROOT%\bin |
| 01-Jan-2004 | 21:45 | 0.0.0.0 | 542060 | mad.dbg | %SYSTEMROOT%\symbols\exe |
| 01-Jan-2004 | 21:45 | 5.0.1462.21 | 574736 | mad.exe | %EXSRVROOT%\bin |
| 01-Jan-2004 | 20:23 | 0.0.0.0 | 684 | mdbmsg.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 20:23 | 5.0.1462.21 | 451856 | mdbmsg.dll | %EXSRVROOT%\res |
| 01-Jan-2004 | 21:24 | 0.0.0.0 | 122152 | mtacheck.dbg | %SYSTEMROOT%\symbols\exe |
| 01-Jan-2004 | 21:24 | 5.0.1462.21 | 179472 | Mtacheck.exe | %EXSRVROOT%\bin |
| 01-Jan-2004 | 21:06 | 0.0.0.0 | 2268 | mtamsg.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 21:06 | 5.0.1462.21 | 707856 | mtamsg.dll | %EXSRVROOT%\res |
| 01-Jan-2004 | 20:04 | 0.0.0.0 | 2259228 | store.dbg | %SYSTEMROOT%\symbols\exe |
| 01-Jan-2004 | 20:04 | 5.0.1462.21 | 2476816 | store.exe | %EXSRVROOT%\bin |
| 01-Jan-2004 | 21:05 | 0.0.0.0 | 236352 | x400om.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 21:05 | 5.0.1462.21 | 319248 | x400om.dll | %EXSRVROOT%\bin |
| 01-Jan-2004 | 21:05 | 0.0.0.0 | 32552 | x400omv1.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 21:05 | 5.0.1462.21 | 39184 | x400omv1.dll | %EXSRVROOT%\bin |
| 01-Jan-2004 | 20:41 | 0.0.0.0 | 2268 |  | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 20:41 | 5.0.1462.21 | 153872 | imcmsg.dll | %EXSRVROOT%\res |
| 01-Jan-2004 | 21:06 | 0.0.0.0 | 31480 | mmiext.dbg | %SYSTEMROOT%\symbols\dll |
| 01-Jan-2004 | 21:06 | 5.0.1462.21 | 33040 | mmiext.dll | %EXSRVROOT%\bin |
| 01-Jan-2004 | 20:47 | 0.0.0.0 | 415516 | msexcimc.dbg | %SYSTEMROOT%\symbols\exe |
| 01-Jan-2004 | 20:47 | 5.0.1462.12 | 478480 | msexcimc.exe | %EXSRVROOT%\connect\msexcimc\bin |

**Verifying Patch Installation:**

To verify that the security patch is installed on your computer verify the files that this security patch installed by reviewing the following registry key:

HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Exchange Server 5.0\SP3\834130

**Note:** This registry key may not be not created properly when an administrator or an OEM integrates or slipstreams the 834130 security patch into the installation source files.

### Other Information

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) the following for working with us to protect customers:

* JoÃ£o Gouveia for reporting the issue described in MS03-046.

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [Windows Update](https://windowsupdate.microsoft.com/) web site

**Support:**

* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/default.aspx?scid=/directory/question.asp&sd;=gn) at 1-866-PCSAFETY. There is no charge for support calls associated with security patches.

**Security Resources:**

* The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.
* Microsoft Software Update Services: </https:>[https:](https://)
* Microsoft Baseline Security Analyzer (MBSA) details: [https://www.microsoft.com/mbsa](https://www.microsoft.com/mbsa/). Please see [https://support.microsoft.com/default.aspx?scid=kb;EN-US;306460](https://support.microsoft.com/default.aspx?scid=kb;en-us;306460) for list of security patches that have detection limitations with MBSA tool.
* Windows Update Catalog: [https://support.microsoft.com/default.aspx?scid=kb;EN-US;323166](https://support.microsoft.com/default.aspx?scid=kb;en-us;323166)
* Windows Update: [https://windowsupdate.microsoft.com](https://windowsupdate.microsoft.com/)
* Office Update: </https:>[https:](https://)

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 October 15, 2003: First Published.
* V1.1 October 22, 2003: Removed unnecessary information from "Deployment" in the "Exchange Server 5.5 Service Pack 4" section of "Security Patch Information."
* V1.2 November 11, 2003: Corrected file sizes under "Security Patch Information" "Exchange Server 5.5 Service Pack 4". Added information about Exchange 2000 Post-Service Pack 3 (SP3) Rollup Patch.
* V2.0 April 13, 2004: Bulletin updated to advise of the availability of an update for Exchange Server 5.0

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


