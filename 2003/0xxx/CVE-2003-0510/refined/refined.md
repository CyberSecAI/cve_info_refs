The provided content details a format string vulnerability in ezbounce versions 1.0 up to 1.04a-stable and 1.50-pre6-beta.

**Root cause of vulnerability:**
The vulnerability lies within the `sessions` command in `commands.cpp`. The `sprintf` function is used to format a string that includes user-controlled data (`c->uinfo.irc->nick` and `c->uinfo.server`) without proper sanitization. This formatted string is then passed to `cprintf`, which is vulnerable to format string exploits.

**Weaknesses/vulnerabilities present:**
- **Format string vulnerability:** The use of `sprintf` with user-controlled input being passed to `cprintf` allows an attacker to inject format string specifiers, enabling them to read and write arbitrary memory locations.
- **Lack of input sanitization:** The application does not sanitize user-supplied data in the nickname field for format string specifiers.

**Impact of exploitation:**
- **Arbitrary memory read/write:** By injecting format string specifiers, an attacker can read arbitrary memory locations and overwrite specific memory addresses, leading to arbitrary code execution.
- **Remote code execution:** The exploit demonstrates how to overwrite the sscanf() GOT entry to redirect execution flow to injected shellcode.
- **Privilege escalation:** Although the exploit is run as root in the example, the vulnerability can be used to escalate privileges if the ezbounce process itself has elevated privileges.

**Attack vectors:**
- **Network:** The vulnerability is triggered via a network connection to the ezbounce server.
- **Specific command:** The vulnerability is triggered when the "sessions" command is invoked, typically upon user login.

**Required attacker capabilities/position:**
- **Network access:** The attacker needs network access to the vulnerable ezbounce server.
- **Valid credentials:** The attacker needs valid user credentials (username/password) to log into the ezbounce service.
- **"enable-detach-command" enabled:** The user's settings must have the "enable-detach-command" feature enabled which is typical, as it is a main feature of ezbounce.
- **Ability to connect to an open port:** The attacker must be able to connect to an open port on a server other than the bnc port as part of the exploit sequence.

**Exploit details:**
The exploit works by:
1. Sending specially crafted nicknames containing format string specifiers to overwrite the GOT entry of `sscanf` with a return address.
2. Injecting shellcode into the memory buffer `__mbuffer`.
3. Triggering the execution of the overwritten `sscanf` GOT entry by calling `LOG FIND`, resulting in execution of the injected shellcode.

The exploit uses a two-step process to write a full memory address, due to limitations in the buffer sizes. The exploit uses the `sscanf` GOT entry as a target to overwrite. It uses a connect/detach command sequence to trigger the format string vulnerability in `cprintf` by sending commands in a specific order: USER, NICK (with format string), PASS, CONN, EZB detach.