=== Content from marc.info_69bd2e4c_20250124_231547.html ===

```
[[prev in list](?l=bugtraq&m=104326783301113&w=2)] [[next in list](?l=bugtraq&m=104326484428707&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    Entercept Ricochet Advisory: Sun Solaris KCMS Library Service Daemon Arbitrary File Retrieval Vulner
From:       ["Entercept Ricochet Team" <Ricochet () entercept ! com>](?a=102321133300003&r=1&w=2)
Date:       [2003-01-22 18:50:30](?l=bugtraq&r=1&w=2&b=200301)
[Download RAW [message](?l=bugtraq&m=104326556329850&q=mbox) or [body](?l=bugtraq&m=104326556329850&q=raw)]

*******ENTERCEPT RICOCHET ADVISORY*******

Date: Wednesday, January 22, 2003
Issue: KCMS Library Service Daemon Arbitrary File Retrieval Vulnerability
<http://www.entercept.com/news/uspr/01-22-03.asp>

Vulnerability Description:

Kodak Color Management System (KCMS) is an API that provides color management
functions for different devices and color spaces. The kcms_server is a daemon
that allows the KCMS library functions to access profiles on remote machines.
The profiles can be remotely read and are located under the directories
/etc/openwin/devdata/profiles and /usr/openwin/etc/devdata/profiles.

There exists a directory traversal condition within the KCS_OPEN_PROFILE
procedure that can lead to remote retrieval of any file on the operating
system since the kcms_server runs with root privileges. Although certain
checks to prevent directory traversal attempts are present in the open
profile procedure call, they are inadequate and can be bypassed by utilizing
the ToolTalk Database Server's TT_ISBUILD procedure call.

Vendors Affected:
- Sun Microsystems Inc.

Vulnerable Platforms:
- Sun Solaris/Sparc 2.5, 2.6, 7, 8, 9
- Sun Solaris/x86 2.5, 2.6, 7, 8, 9

Vendor Information/CERT Information:

Entercept worked directly with Sun Microsystems Inc. and CERT (Computer
Emergency Response Team), providing the technical details necessary to develop
patches and coordinate security advisories. The CERT advisory will be available
at: <http://www.kb.cert.org/vuls/id/850785>

Acknowledgement/Information Resources:

This vulnerability was discovered and researched by Sinan Eren of the Entercept
Ricochet Team.

ABOUT ENTERCEPT RICOCHET:
Entercept's Ricochet team is a specialized group of security researchers
dedicated to identifying, assessing, and evaluating intelligence regarding
server threats.
The Ricochet team researches current and future avenues of attack and builds
this knowledge into Entercept's intrusion prevention solution. Ricochet is
dedicated to providing critical, viable security content via security
advisories and technical briefs. This content is designed to educate
organizations and security professionals about the nature and severity of
Internet security threats, vulnerabilities and exploits. Copyright Entercept
Security Technologies. All rights reserved. Entercept and the Entercept logo
are trademarks of Entercept Security Technologies. All other trademarks, trade
names or service marks are the property of their respective owners.

DISCLAIMER STATEMENT:
The information in this bulletin is provided by Entercept Security Technologies,
Inc. ("Entercept") and is intended to provide information on a particular
security issue or incident. Given that each exploitation technique is unique,
Entercept makes no claim to prevent any specific exploit related to the
vulnerability discussed in this bulletin. Entercept expressly disclaims any and
all warranties with respect to the information provided in this bulletin,
express or implied or otherwise, including, but not limited to, warranty of
fitness for a particular purpose. Under no circumstances may this information
be used to exploit vulnerabilities in any other environment.
<http://www.entercept.com/news/uspr/01-22-03.asp>
###

[[prev in list](?l=bugtraq&m=104326783301113&w=2)] [[next in list](?l=bugtraq&m=104326484428707&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_7e705ddf_20250124_231549.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#850785

## Sun KCMS library service daemon does not adequately validate location of KCMS profiles

#### Vulnerability Note VU#850785

Original Release Date: 2003-01-22 | Last Revised: 2003-04-14

---

### Overview

The Sun KCMS library service daemon, kcms\_server, does not adequately validate the location of KCMS profile files. This could allow a remote attacker to read arbitrary files on a vulnerable system.

### Description

| Sun Solaris contains support for the Kodak Color Management System (KCMS), an application programming interface (API) that provides color management functions for different devices and color spaces. From the [*KCMS Application Developer's Guide*](http://docs.sun.com/db/doc/816-1325/6m7oiipa2?a=view): "The KCMS framework enables the accurate reproduction, and improves the appearance of, digital color images on desktop computers and associated peripherals." [KCMS profiles](http://docs.sun.com/db/doc/816-1325/6m7oiipag?a=view#intro-6) contain information that "tell[s] the KCMS framework how to convert input color data to the appropriate color-corrected output color data." The [KCMS framework](http://docs.sun.com/db/doc/816-1325/6m7oiipag?a=view#intro-5) "loads and saves profiles, gets and sets KCMS profile attributes, and directs requests for color management to the right CMM at the right time."  From the man page for kcms\_server(1):  ``` DESCRIPTION     The kcms_server is a daemon that allows the KCMS library  to     access  profiles on remote machines. The KCMS library is its     only client. Profiles can be accessed read only and must  be     located  in  the following directories. This is for security     reasons.        /usr/openwin/etc/devdata/profiles        /etc/openwin/devdata/profiles     kcms_server will be automatically started by inetd(1M)  when     a  request  to use the server is generated by a remote host.     An entry has been added to /etc/inet/inetd.conf  correspond-     ing to kcms_server that makes this possible. ```  As part of the KCMS framework, the KCMS library service daemon ([kcms\_server](http://docs.sun.com/db/doc/816-1325/6m7oiipat?q=kcms_server&a=view#datastructs-18)) provides a way to serve KCMS profiles to remote clients. The daemon is implemented as a Sun remote procedure call (RPC) service that is managed by the Internet services daemon ([inetd(1M))](http://docs.sun.com/db/doc/816-0211/6m6nc66se?q=inetd&a=view) and the RPC portmapper service ([rpcbind(1M)](http://docs.sun.com/db/doc/816-0211/6m6nc6759?q=rpcbind&a=view)). The KCMS library service daemon listens for network requests and serves read-only KCMS profiles from /etc/openwin/devdata/profiles and /usr/openwin/etc/devdata/profiles. A typical request for a KCMS profile specifies the name of the file (fileName) and optionally, its location (hostName).When opening a profile, the KCMS library service daemon does not adequately validate the fileName argument. According to a [report](http://www.entercept.com/news/uspr/01-22-03.asp) published by Entercept, the checks performed by the KCS\_OPEN\_PROFILE procedure are not complete in that they do not account for the case of a sub-directory within the KCMS profile directories. If an attacker is able to create a sub-directory within either of the directories searched by the KCMS library service daemon, the attacker could use a specially crafted fileName argument that would bypass the directory traversal checks and allow the attacker to read any file on a vulnerable system. As noted by Entercept, the ToolTalk database server (rpc.ttdbserverd(1M)) procedure \_TT\_ISBUILD() can be used to create a directory named TT\_DB in an arbitrary location on a remote system.The KCMS library service daemon runs with root privileges, and both it and the ToolTalk database server are typically installed and enabled by default on Solaris systems. |
| --- |

### Impact

| A remote attacker could read any file on a vulnerable system. In the example described by Entercept, an attacker would first need to create a directory under /etc/openwin/devdata/profiles or /usr/openwin/etc/devdata/profiles. |
| --- |

### Solution

| **Apply Patch**When available, apply the appropriate patch as referenced by Sun. |
| --- |

| **Disable kcms\_server**Until patches are available and can be applied, disable the KCMS library service daemon by commenting out the appropriate entry in /etc/inetd.conf, terminating any currently running kcms\_server processes, and restarting the Internet services daemon inetd(1M). The rpcinfo(1M), netstat(1M), and ps(1) commands may be useful in determining if the KCMS library service daemon is enabled.The following examples are from a SunOS 5.8 (Solaris 8) system:[/etc/inetd.conf]## Sun KCMS Profile Server#100221/1        tli     rpc/tcp wait root /usr/openwin/bin/kcms\_server  kcms\_serverThe KCMS library service is assigned RPC program number 100221.$ rpcinfo -p |grep 100221    100221    1   tcp  32781$ netstat -a |grep 32781      \*.32781                               Idle      \*.32781              \*.\*                0      0 24576      0 LISTEN$ ps -ef |grep kcms\_server    root   484   156  0 15:12:01 ?        0:00 kcms\_serverAs a general best practice, the CERT/CC recommends disabling any services that are not explicitly required.**Block or Restrict Access**Until patches are available and can be applied, block or restrict access to the RPC portmapper service and the KCMS library service daemon from untrusted networks such as the Internet. The RPC portmapper service typically runs on ports 111/tcp and 111/udp. In the above example, the KCMS library service daemon is configured to run on 32781/tcp, however, this port number may vary. Also, consider blocking or restricting access to the ToolTalk database server (RPC program number 100083). Keep in mind that blocking ports at a network perimeter does not protect the vulnerable service from the internal network. It is important to understand your network configuration and service requirements before deciding what changes are appropriate. |
| --- |

### Vendor Information

850785
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23850785/) to view vendors.**
### [Sun Microsystems Inc.](#AAMN-5HRNV5) Affected

Notified:  November 04, 2002  Updated: January 17, 2003

### Status

Affected

### Vendor Statement

Sun confirms that this kcms\_server(1) vulnerability does affect all currently supported versions of Solaris:

Solaris 2.6, 7, 8, and 9
Sun will be releasing a Sun Alert which describes two possible workarounds until a final resolution is reached which will be available from the following location shortly:

<http://sunsolve.Sun.COM/pub-cgi/retrieve.pl?doc=fsalert/50104>

The Sun Alert will be updated once a final resolution is available.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Kodak](#AAMN-5HVULQ) Not Affected

Notified:  December 19, 2002  Updated: January 20, 2003

### Status

Not Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Based in information from Sun and Kodak, this vulnerability exists only in the Solaris KCMS implementation (kcms\_server). No other KCMS implementation is affected.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.entercept.com/news/uspr/01-22-03.asp>
* <http://docs.sun.com/db/doc/816-1325/6m7oiipal?q=kcms_server&a=view#profiles-2>
* <http://docs.sun.com/db/doc/816-1325/6m7oiipat?q=kcms_server&a=view#datastructs-18>
* <http://www.iana.org/assignments/sun-rpc-numbers>
### Acknowledgements

This vulnerability was reported by Sinan Eren of Entercept.

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2003-0027](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0027) |
| --- | --- |
| **Severity Metric:** | 2.05 |
| **Date Public:** | 2003-01-22 |
| **Date First Published:** | 2003-01-22 |
| **Date Last Updated:** | 2003-04-14 16:04 UTC |
| **Document Revision:** | 56 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


