- **Root cause of vulnerability**: The `lsadmin` binary uses the `LSF_SERVERDIR` variable specified in a configuration file to locate the `lim` binary. The `lsadmin` binary is setuid root. A user can manipulate the configuration file used by `lsadmin` to point `LSF_SERVERDIR` to a malicious `lim` binary that will then be executed with root privileges.
- **Weaknesses/vulnerabilities present**:
    - Unvalidated path for external executable lookup
    - Execution of an external binary specified via user controlled environment variables with setuid privileges
- **Impact of exploitation**: An attacker can gain root privileges by executing arbitrary code through the malicious `lim` binary.
- **Attack vectors**: A local user can craft a malicious `lsf.conf` file with a modified `LSF_SERVERDIR` variable, and by using the `LSF_ENVDIR` variable can force `lsadmin` to use this malicious configuration file. Then by executing the `ckconfig` command, the malicious `lim` binary will be executed with root privileges.
- **Required attacker capabilities/position**: The attacker needs to be a local user on the system where LSF 5.1 is installed and be able to create files and execute commands.