=== Content from docs.microsoft.com_5642d3f7_20250124_155732.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-007.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-007 - Critical

## Unchecked Buffer In Windows Component Could Cause Server Compromise (815021)

Published: March 17, 2003 | Updated: September 18, 2003

**Version:** 3.4

**Originally posted:** March 17, 2003

**Updated:** May 30, 2003

#### Summary

**Who should read this bulletin:**
Systems administrators running Microsoft Â® Windows Â® NT 4.0, Windows 2000, and Windows XP.

**Impact of vulnerability:**
Run code of attacker's choice

**Maximum Severity Rating:**
Critical

**Recommendation:**
Systems administrators should apply the patch immediately

**End User Bulletin**:
An end user version of this bulletin is available at: [https:](https://)

**Affected Software:**

* Microsoft Windows NT 4.0
* Microsoft Windows NT 4.0 Terminal Server Edition
* Microsoft Windows 2000
* Microsoft Windows XP

**Not Affected Software:**

* Microsoft Windows Server 2003

### General Information

## Technical details

**Technical description:**

Microsoft originally released this security bulletin on March 17, 2003. At that time, Microsoft was aware of a publicly available exploit that was being used to attack Windows 2000 Servers running IIS 5.0. The attack vector in this case was WebDAV although the underlying vulnerability was in a core operating system component, ntdll.dll. Microsoft issued a patch to protect Windows 2000 customers shortly afterwards, but also continued to investigate the underlying vulnerability. During the course of that investigation, Microsoft found that Windows NT 4.0 also contains the underlying vulnerability in ntdll.dll, however it does not support WebDAV and therefore the known exploit was not effective against Windows NT 4.0. In addition, Microsoft has recently been made aware of this vulnerability as well in Windows XP. However, like Windows NT 4.0, Windows XP does not install Internet Information Services (IIS) by default. Microsoft has now released patches for Windows NT 4.0 and Windows XP.

Microsoft Windows 2000 supports the World Wide Web Distributed Authoring and Versioning (WebDAV) protocol. WebDAV, defined in RFC 2518, is a set of extensions to the Hyper Text Transfer Protocol (HTTP) that provide a standard for editing and file management between computers on the Internet. A security vulnerability is present in a Windows component used by WebDAV and results because a core operating system component, ntdll.dll, contains an unchecked buffer.

An attacker could exploit the vulnerability by sending a specially formed HTTP request to a machine running Internet Information Server (IIS). The request could cause the server to fail or to execute code of the attacker's choice. The code would run in the security context of the IIS service (which, by default, runs in the LocalSystem context).

Although Microsoft has supplied a patch for this vulnerability and recommends all affected customers install the patch immediately, additional tools and preventive measures have been provided that customers can use to block the exploitation of this vulnerability while they are assessing the impact and compatibility of the patch. These temporary workarounds and tools are discussed in the "Workarounds" section in the FAQ below.

**Mitigating factors:**

* URLScan, which is a part of the IIS Lockdown Tool will block this attack in its default configuration
* The vulnerability can only be exploited remotely if an attacker can establish a web session with an affected server
* Windows NT 4.0 and Windows XP do not install Internet Information Services by default.
* Windows NT 4.0 does not support WebDAV

**Severity Rating:**

|  |  |
| --- | --- |
| **Windows NT 4.0** | Important |
| **Windows NT 4.0 Terminal Server Edition** | Important |
| **Windows 2000** | Critical |
| **Windows XP** | Important |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2003-0109](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0109)

**Tested Versions:**

Microsoft tested Windows NT 4.0, Windows 2000, Windows XP and Windows Server 2003, to assess whether they are affected by this vulnerability. Previous versions are no longer [supported](https://go.microsoft.com/fwlink/?linkid=21742), and may or may not be affected by these vulnerabilities.

## Frequently asked questions

**Why has Microsoft reissued this bulletin?**

Microsoft first issued this bulletin on March 17, 2003. At that time, Microsoft was aware of a publicly available exploit that was being targeted against Windows 2000 servers running IIS. The underlying vulnerability was in a core operating system component, ntdll.dll, but WebDAV was being used as the attack vector. Microsoft responded and issued this bulletin and a patch to protect Windows 2000 customers. Microsoft continued to investigate the issue and determined that the underlying vulnerability in ntdll.dll also existed in Windows NT 4.0. Subsequent to this bulletin first being issued, Microsoft updated the bulletin to provide a fix for the underlying vulnerability in Windows NT 4.0. Further investigations identified that the underlying vulnerability in ntdll.dll also exists in Windows XP and Microsoft has now released a Windows XP patch with this bulletin.
WebDAV is not supported in Windows NT 4.0 and therefore could not be used as an attack vector, and both Windows NT 4.0 and Windows XP do not install IIS by default. However Windows NT 4.0 and Windows XP are still vulnerable to other attacks, in particular in cases where an attacker could log on interactively to the system.

**Why has Microsoft changed the information in the Caveats section of this bulletin?**

Microsoft was made aware that some Windows 2000 customers who had received a hotfix from Product Support Services experienced stop errors on boot after applying the patch released for this bulletin.
We've assessed this issue and now know that it only occurs under a specific set of circumstances. A series of Windows 2000 hotfixes that were only available through Product Support Services and were issued between December 2001 and February 2002 were incompatible with the patch for this vulnerability. Customers who are running one of those 12 hotfixes on Windows 2000 Service Pack 2 will experience a stop error on reboot after applying this patch. More information on how to determine if you have installed a hotfix that is incompatible with this patch is available in the Addition Information section under Caveats. Customers who are running Windows 2000 Service Pack 3 or are not running one of these hotfixes will not encounter this problem.

**I'm concerned about the failure described above that affects certain Windows 2000 Service Pack 2 systems, but I still need to apply the patch. What can I do?**

There are a number of options:

* Apply the Windows 2000 patch from MS03-013 - that patch supercedes the patch in this bulletin as well as removing the file dependency that was causing the failure described above. If you have not already applied the MS03-007 patch from this bulletin, Microsoft recommends you apply the MS03-013 patch as it also corrects an additional vulnerability.
* Apply Windows 2000 Service Pack 3 before apply the patch. Windows 2000 SP3 does not contain the file dependency that cause the failure discussed above.
* Contact Microsoft Product Support Services. The failure described above can only be encountered on Windows 2000 Service Pack 2 systems that are also running a series of Post-SP2 hotifxes that were only available through Product Support Services.

**The** [**MS03-013**](https://technet.microsoft.com/security/bulletin/ms03-013) **Security Bulletin discusses a performance issue with the Windows XP SP1 version of that patch. Does that performance issue affect the Windows 2000 patch for MS03-013 also?**

No, the performance issue discussed in MS03-013 only affects Windows XP SP1 systems. The Windows 2000 patch for MS03-013 corrects the file dependency problem that caused the failure described above with the MS03-007 patch as well as correcting an additional security vulnerability described in [MS03-013](https://technet.microsoft.com/security/bulletin/ms03-013). It is not affected by the same performance problem as the Windows XP SP1 patch in [MS03-013](https://technet.microsoft.com/security/bulletin/ms03-013).

**What's the scope of the vulnerability?**

This is a [buffer overrun](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. An attacker who successfully exploited this vulnerability could gain complete control over an affected web server. This would give the attacker the ability to take any desired action on the server, including changing web pages, reformatting the hard drive or adding new users to the local administrators group.

**What causes the vulnerability?**

The vulnerability results because of an unchecked buffer in a component of Windows, Ntdll.dll, that can be called using WebDAV or can be accessed locally. By sending a specially constructed request through WebDAV, an attacker could cause code to run on a web server in the Local System security context. In the case of Windows NT 4.0, an attacker would need to use another attack vector such as one that involved logging on to the system interactively.

**What is WebDAV?**

WebDAV is an industry standard extension to the HTTP specification. The "DAV" in "WebDAV" stands for "distributed authoring and versioning." WebDAV adds a capability for authorized users to remotely add and manage content on a web server. WebDAV is supported in Windows 2000.

**What's wrong with the way IIS 5.0 handles WebDAV requests?**

WebDAV uses IIS to pass requests to and from Windows 2000. When IIS receives a WebDAV request, it typically processes the request and then acts on it. However, if the request is formed in a particular way, a buffer overrun can result because one of the Windows components called by WebDAV does not correctly check parameters.

**Can the vulnerability be exploited on Windows NT 4.0 through IIS 4.0?**

No. WebDAV isn't supported in IIS 4.0, so the ability for an attacker to exploit the vulnerability doesn't exist. An attacker could however exploit the underlying vulnerability through another attack vector such as one that required logging on to the system interactively

**Can the vulnerability be exploited on Windows XP through IIS 5.1?**

No. Although WebDAV is supported in IIS 5.1 if it is installed by a user, the underlying Windows XP version of ntdll.dll is not susceptible to the WebDAV attack vector, so the ability for an attacker to exploit the vulnerability is not present. However, even if IIS were not installed, an attacker could exploit the underlying vulnerability through another attack vector such as one that required logging on to the system interactively.

**If I have confirmed I am not running IIS 5.0 should I still install the patch?**

Yes. Disabling or modifying IIS 5.0 will still leave the vulnerable Windows component on the system. All customers running Windows 2000 should install the patch.

**How could an attacker exploit this vulnerability?**

An attacker could seek to exploit this vulnerability by sending a specially formed WebDAV request to a web server running IIS 5.0. An attacker could also look to exploit this vulnerability by logging onto the system interactively and accessing the affected component, ntdll.dll locally.

**Who could exploit the vulnerability?**

In the case of the WebDAV attacker vector, any user who could deliver a WebDAV request to an affected web server could attempt to exploit the vulnerability. Because WebDAV requests travel over the same port as HTTP (normally port 80), this in essence means that any user who could establish a connection with an affected server could attempt to exploit the vulnerability.
It could also be possible to access the affected component through another vector, such as one that would involve logging onto the system interactively or by using another application similar to WebDAV that passed parameters to the vulnerable component either locally or remotely.

**What would this allow an attacker to do?**

If an attacker were able to run code with Local System privileges on an affected system, the attacker would be able to take any action on the system, including installing programs, viewing changing or deleting data, or creating new accounts with full privileges.

**How do I know if I am running IIS?**

IIS 5.0 is installed by default on all server versions of Windows 2000. It is not installed on Windows 2000 Professional by default.
To check if IIS is installed on your system, carry out the following: Go to "Start | Settings | Control Panel | Administrative Tools | Services". If the "World Wide Web Publishing" service is listed then IIS is installed.

**What products does IIS 5.0 ship with?**

Internet Information Services 5.0 ships as part of Windows 2000 Datacenter Server, Advanced Server, Server and Professional.

**Does IIS 5.0 run by default?**

IIS 5.0 runs by default on all Windows 2000 server products. It does not run by default on Windows 2000 Professional.

**Is WebDAV enabled by default on IIS 5.0?**

Yes, although it can be disabled by following the steps mentioned in the Workarounds section below.

**Workarounds**

**Are there any workarounds that can be used to block exploitation of this vulnerability while I am testing or evaluating the patch?**

Yes. Although Microsoft urges all customers to apply the patch at the earliest possible opportunity, there are a number of workarounds that can be applied to block the WebDAV request used to exploit this vulnerability in the interim. In addition, Microsoft is providing tools and documentation to deploy these workarounds more easily.
It should be noted that these workarounds should be considered temporary measures as they simply block the path of attack rather than correcting the underlying vulnerability.
The following sections are intended to provide you with information to protect your computer from attack. Each section describes the workarounds that you may wish to use depending on your computer's configuration.

* **If you do not require IIS on your computer:**

  IIS can be disabled by running IIS lockdown tool. To download the IIS lockdown tool go to the following website, [IIS Lockdown Tool](https://www.microsoft.com/technet/security/tools/locktool.mspx).

  Alternatively, you can also remove IIS by performing the steps listed in [Knowledge Base Article 321141](https://support.microsoft.com/default.aspx?scid=kb%3ben-us%3b321141).
* **If you require IIS but do not need WebDAV enabled:**

  WebDAV provides a standard for editing and file management between computers on the Internet. If you are not using WebDAV, you can disable it by running the IIS Lockdown tool and specifying to the tool that you do not use WebDAV. To download the IIS lockdown tool go to the following website, [IIS Lockdown Tool](https://www.microsoft.com/technet/security/tools/locktool.mspx).

  Note that while the IIS Lockdown tool prevents the successful execution of this and many other attacks, it may interfere with the functioning of your web server under certain circumstances. While it is possible to limit your use of the IIS Lockdown tool to disabling WebDAV, you should consider applying all of the lockdown including URLScan. Information on using the IIS lockdown tool is provided at the following location:

  [https://support.microsoft.com/default.aspx?scid=kb;EN-US;325864](https://support.microsoft.com/default.aspx?scid=kb;en-us;325864)

  You may also disable WebDAV by following the instructions listed in the Microsoft Knowledge Base article at:

  </https:>[https:](https://)
* **If you require the use of WebDAV on your computer:**

  There are a number of workarounds that can be applied to block the request used to exploit this vulnerability and retain WebDAV functionality if you are using it.

  + Customers that cannot deploy the IIS lockdown tool or URLScan to their web servers, can restrict the buffer used by IIS to receive the request that can be used to exploit this vulnerability. Microsoft has provided the URL Buffer Size Registry Tool to automatically set the registry key that will restrict the buffer. This tool can be run on Web Servers running Windows 2000 to protect against attacks that would attempt to exploit this vulnerability. The tool can be run locally on the web server to be protected, or it can be applied remotely to multiple web servers by a user who has administrative access to the servers. Information on the URL Buffer Size Registry Tool as well as additional workaround tools is located in the following Knowledge Base Article:

    </https:>[https:](https://)

    The URL Buffer Size Registry tool can be run on systems running Windows 2000 [Service Pack 2](https://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx) or [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx). In addition, the registry change can be made manually by following the instructions in the following Knowledge Base article:

    </https:>[https:](https://)

    Note that Customers should evaluate the maximum buffer size that is practical for their environment and set that maximum value, but in any case the buffer should be set to a size less than 64K bytes. Microsoft recommends 16K as a reasonable value. 16k is the limit that will automatically be set by the URL Buffer Size Registry tool.
  + URLScan, which is installed by the IIS Lockdown tool, will also block the web request that can be used to exploit this vulnerability. You can obtain the URLScan tool from:

    </https:>[https:](https://)

    Note that while the IIS Lockdown tool prevents the successful execution of this and many other attacks, it may interfere with the functioning of your web server under certain circumstances. While it is possible to limit your use of the IIS Lockdown tool to installation of URLScan, you should consider applying all of the lockdown including URLScan.

    Information on customizing and configuring URLScan can be found at the following location:

    [https://support.microsoft.com/default.aspx?scid=kb;[LN];326444](https://support.microsoft.com/default.aspx?scid=kb;%5bln%5d;326444)

    Information on using the IIS lockdown tool is provided at the following location:

    [https://support.microsoft.com/default.aspx?scid=kb;EN-US;325864](https://support.microsoft.com/default.aspx?scid=kb;en-us;325864)

**What does the patch do?**

The patch corrects the issue by changing the method by which the affected Windows component accepts requests.

## Patch availability

**Download locations for this patch**

* Microsoft Windows NT 4.0:
  + [All except NEC and Chinese - Hong Kong](https://www.microsoft.com/download/details.aspx?familyid=9a64851a-05ae-4912-9967-3aa3b4d5a76f&displaylang;=en)
  + [Japanese NEC](https://www.microsoft.com/download/details.aspx?familyid=e20a695d-977d-4247-af3b-4b58850b1795&displaylang;=ja)
  + [Chinese - Hong Kong](https://www.microsoft.com/download/details.aspx?familyid=55483a84-a8c7-48af-bd83-9ec4b99f87cd&displaylang;=zh-tw)
* Windows NT 4.0, Terminal Server Edition:
  + [All](https://www.microsoft.com/download/details.aspx?familyid=ae57f47f-dc4d-40e9-8879-41a09767111f&displaylang;=en)
* Microsoft Windows 2000:
  + [All except Japanese NEC](https://www.microsoft.com/download/details.aspx?familyid=c9a38d45-5145-4844-b62e-c69d32ac929b&displaylang;=en)
  + [Japanese NEC](https://www.microsoft.com/download/details.aspx?familyid=fbcf9847-d3d6-4493-8dcf-9ba29263c49f&displaylang;=ja)
* Microsoft Windows XP:
  + [32-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=84fc577d-f2d5-47b8-ab98-77ba7501b00b&displaylang;=en)
  + [64-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=97945a5d-db0b-40f8-9a2e-de93cbb5cb3a&displaylang;=en)

#### Additional information about this patch

**Installation platforms:**

Windows NT 4.0:

This patch can be installed on systems running Windows NT 4.0 Service Pack 6a.

Windows 2000:

This patch can be installed on systems running Windows 2000 [Service Pack 2](https://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx) or [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx).

Windows XP:

This patch can be installed on systems running Windows XP Gold or [Service Pack 1](https://www.microsoft.com/technet/archive/security/news/wxpsp1s.mspx).

**Inclusion in future service packs:**

The fix for this issue will be included in Windows 2000 Service Pack 4 and Windows XP Service pack 2.

**Reboot needed:** Yes

**Patch can be uninstalled:** Yes

**Superseded patches:** None.

**Verifying patch installation:**

* Windows NT 4.0:

  To verify that the patch has been installed on the machine, confirm that all files listed in the file manifest in Knowledge Base article 815021 are present on the system.
* Windows NT 4.0 Terminal Server Edition:

  To verify that the patch has been installed on the machine, confirm that all files listed in the file manifest in Knowledge Base article 815021 are present on the system.
* Windows 2000:

  To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q815021.

  To verify the individual files, use the date/time and version information provided in the following registry key:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q815021\Filelist.
* Windows XP Gold:

  To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q815021.

  To verify the individual files, use the date/time and version information provided in the following registry key:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q815021\Filelist.
* Windows XP SP1:

  To verify that the patch has been installed on the system confirm that the following registry key has been created on the system:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP2\Q815021. To verify the individual files, use the date/time and version information provided in the following registry key:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP2\Q815021\Filelist.

**Caveats:**

If you are running Windows 2000 SP2, before installing this patch please check the version of ntoskrnl.exe on your system. To verify the version of ntoskrnl.exe on your system, perform the following steps:

1. Browse to the %windir%\system32 directory
2. Right-click ntoskrnl.exe
3. Choose properties.

The version information is located on the 'version' tab.

Versions of ntoskrnl.exe between 5.0.2195.4797 and 5.0.2195.4928 (inclusive) are not compatible with this patch. These versions were only distributed with Product Support Services hotfixes.

If the patch for this issue is installed on a system with one of these versions of ntoskrnl.exe, the machine will fail on the first reboot with a Stop 0x00000071 message and will have to be recovered using the Windows 2000 recovery console and the backup copy of ntdll.dll stored in the "\winnt\$NTUninstallQ815021$" directory.

To update a system with a version of ntoskrnl.exe distributed from Product Support Services, you must first contact PSS before applying this patch. Information on contacting Product Support Services can be found at:

[https://support.microsoft.com](https://support.microsoft.com/)

Alternatively you can upgrade to Windows 2000 SP3 prior to installing this patch **or** apply the Windows 2000 patch from [MS03-013](https://technet.microsoft.com/security/bulletin/ms03-013), which superceeds this patch and corrects the problem described above.

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) nesumin from [:: Operash ::](https://opera.rainyblue.org/) for reporting the Windows XP vulnerability to us and working with us to protect customers.

**Support:**

* Microsoft Knowledge Base article [815021](https://support.microsoft.com/default.aspx?scid=kb;en-us;815021) discusses this issue. Additional Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (March 17, 2003): Bulletin Created.
* V1.1 (March 18, 2003): Added new information in the Caveats under in the Additional Information section, clarified affected Windows component throughout the bulletin, added a question regarding IIS 5.0 to the Frequently Asked Questions section, added a question regarding changes to the Caveats in the Additional Information section to the Frequently Asked Questions section.
* V2.0 (April 23, 2003): Updated to include details of NT 4.0 patch.
* V2.1 (April 24, 2003): Updated to include download link for NT4 package for Japanese NEC
* V2.2 (April 24, 2003): Provided additional clarification in FAQ regarding supercedence of Windows 2000 patch by the patch in MS03-013.
* V3.0 (May 28, 2003): Updated to include details of Windows XP patch.
* V3.1 (May 28, 2003): Updated to include correct Windows NT 4.0 and Windows XP verification keys.
* V3.2 (May 28, 2003): Updated frequently asked questions section regarding IIS 5.1
* V3.3 (May 30, 2003): Updated acknowledgments section.
* V3.4 (September 18, 2003): Updated to include Windows XP SP1 verification keys.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.nextgenss.com_0d85a35e_20250124_155731.html ===

[Click here to enter](http://www.nextgenss.com/papers/ms03-007-ntdll.pdf?fp=-3)



=== Content from www.kb.cert.org_e118e2f0_20250124_155730.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#117394

## Buffer Overflow in Core Microsoft Windows DLL

#### Vulnerability Note VU#117394

Original Release Date: 2003-03-17 | Last Revised: 2003-05-30

---

### Overview

A buffer overflow vulnerability exists in the Win32 API libraries shipped with all versions of Microsoft Windows XP, Microsoft Windows 2000, Microsoft Windows NT 4.0, and Microsoft Windows NT 4.0 Terminal Server Edition. This vulnerability, which is being actively exploited on WebDAV-enabled IIS 5.0 servers, will allow a remote attacker to execute arbitrary code on unpatched systems. Sites running Microsoft Windows should apply a patch or disable WebDAV services as soon as possible.

### Description

| Microsoft Windows contains a dynamic link library (DLL) named ntdll.dll. This DLL is a core operating system component used to interact with the Windows kernel. A buffer overflow vulnerability exists in ntdll.dll, which is utilized by many different components in the Windows operating system.   | The WebDAV ([RFC2518](http://www.ietf.org/rfc/rfc2518.txt)) component of [Microsoft IIS](http://www.microsoft.com/windows2000/technologies/web/default.asp) 5.0 is an example of one Windows component that uses ntdll.dll. The IIS WebDAV component utilizes ntdll.dll when processing incoming WebDAV requests. By sending a specially crafted WebDAV request to an IIS 5.0 server, an attacker may be able to execute arbitrary code in the Local System security context, essentially giving the attacker complete control of the system. Because the vulnerable Win32 API component is utilized by many other applications, it is possible other exploit vectors exist. However, we have only been told of systems compromised running IIS 5.0 with WebDAV enabled. Sites using Windows but not running IIS 5.0 with WebDAV need to carefully weigh the trade-offs before applying patches to systems where the core vulnerability exists but may not be exploitable. | | --- | |
| --- | --- |

### Impact

| Any attacker who can reach a vulnerable web server can gain complete control of the system and execute arbitrary code in the Local System security context. Note that this may be significantly more serious than a simple "web defacement." |
| --- |

### Solution

| **Apply a patch from your vendor**   | A patch is available from Microsoft at    <http://microsoft.com/downloads/details.aspx?FamilyId=C9A38D45-5145-4844-B62E-C69D32AC929B&displaylang=en> Note that, according to [MS03-007](http://www.microsoft.com/technet/treeview/?url=/technet/security/bulletin/MS03-007.asp), "Microsoft was made aware that some customers who had received a hotfix from Product Support Services experienced stop errors on boot after applying the patch released for this bulletin." For more information, see the "Frequently asked questions" section of MS03-007. | | --- | |
| --- | --- |

| **Workarounds**  **Disable vulnerable service**  Until a patch can be applied, you may wish to disable IIS: <http://support.microsoft.com/default.aspx?scid=kb;en-us;321141> If you cannot disable IIS, consider using the IIS lockdown tool to disable WebDAV (removing WebDAV can be specified when running the IIS lockdown tool). Alternatively, you can disable WebDAV by following the instructions located in Microsoft's Knowledgebase Article 241520, "How to Disable WebDAV for IIS 5.0": <http://support.microsoft.com/default.aspx?scid=kb;en-us;241520> **Restrict buffer size**If you cannot use the IIS lockdown tool, consider restricting the size of the buffer IIS utilizes to process requests by using Microsoft's URL Buffer Size Registry Tool. This tool can be run against a local or remote Windows 2000 system running Windows 2000 Service Pack 2 or Service Pack 3. The tool, instructions on how to use it, and instructions on how to manually make changes to the registry are available here: URL Buffer Size Registry Tool - <http://go.microsoft.com/fwlink/?LinkId=14875>Microsoft Knowledge Base Article 816930 - <http://support.microsoft.com/default.aspx?scid=kb;en-us;816930>Microsoft Knowledge Base Article 260694 - <http://support.microsoft.com/default.aspx?scid=kb;en-us;260694> You may also wish to use URLScan, which will block web requests that attempt to exploit this vulnerability. Information about URLScan is available at [http://support.microsoft.com/default.aspx?scid=kb;[LN];326444](http://support.microsoft.com/default.aspx?scid=kb;%5BLN%5D;326444) |
| --- |

### Vendor Information

117394
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23117394/) to view vendors.**
### [Microsoft Corporation](#IAFY-5KQQRE) Affected

Updated:  March 17, 2003

### Status

Affected

### Vendor Statement

See <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/ms03-007.asp>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/windows2000/technologies/web/default.asp>
* <http://www.ietf.org/rfc/rfc2518.txt>
* <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/ms03-007.asp>
* <http://microsoft.com/downloads/details.aspx?FamilyId=C9A38D45-5145-4844-B62E-C69D32AC929B&displaylang=en>
* <http://www.nextgenss.com/papers/ms03-007-ntdll.pdf>
* <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/ms03-007.asp>
* <http://www.microsoft.com/downloads/release.asp?ReleaseID=43955>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;241520>
* <http://support.microsoft.com/default.aspx?scid=kb;%5BLN%5D;326444>
* <http://go.microsoft.com/fwlink/?LinkId=14875>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;816930>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;260694>
* <http://www.lurhq.com/webdav.html>
### Acknowledgements

This document was written by Ian A Finlay.

### Other Information

| **CVE IDs:** | [CVE-2003-0109](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0109) |
| --- | --- |
| **CERT Advisory:** | [CA-2003-09](http://www.cert.org/advisories/CA-2003-09.html) |
| **Severity Metric:** | 78.00 |
| **Date Public:** | 2003-03-17 |
| **Date First Published:** | 2003-03-17 |
| **Date Last Updated:** | 2003-05-30 14:15 UTC |
| **Document Revision:** | 18 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.cert.org_2462b81c_20250124_155629.html ===


search

icon-carat-right

cmu-wordmark

[Carnegie Mellon University](https://www.cmu.edu)

# [Software Engineering Institute](/)

##

1. [SEI](/)
2. [About](/about/)
3. [Divisions](/about/divisions/)
4. The CERT Division

## The CERT Division

The CERT Division is a leader in cybersecurity. We partner with government, industry, law enforcement, and academia to improve the security and resilience of computer systems and networks. We study problems that have widespread cybersecurity implications and develop advanced methods and tools to counter large-scale, sophisticated cyber threats.

* [Leadership](/about/divisions/cert/index.cfm#leadership)
* [What We Do](/about/divisions/cert/index.cfm#cert-division-what-we-do)
* [Careers in the CERT Division](/about/divisions/cert/index.cfm#careers)
* [Recent Vulnerabilities](/about/divisions/cert/index.cfm#CERTRecentlyPublishedVulnerabilityNotes)
* [Case Studies](/about/divisions/cert/index.cfm#case-studies)
* [History](/about/divisions/cert/index.cfm#history)

## Leadership

[![Gregory J. Touhill](/sei-images/images/Touhill_Greg_393_2023_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=314857)
#### [Gregory J. Touhill](/about/leadership/display.cfm?customel_datapageid_2623=314857)

Director, CERT Division

[![William Wilson](/sei-images/images/Wilson_William_324_200113_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=3871)
#### [William Wilson](/about/leadership/display.cfm?customel_datapageid_2623=3871)

Deputy Director, CERT Division

[![Chris Inacio](/sei-images/images/inacio-chris-96_2622.jpg)](/about/leadership/display.cfm?customel_datapageid_2623=494689)
#### [Chris Inacio](/about/leadership/display.cfm?customel_datapageid_2623=494689)

Chief Engineer, CERT Division

## What We Do

CERT experts are a diverse group of researchers, software engineers, security analysts, and digital intelligence specialists working together to research security vulnerabilities in software products, contribute to long-term changes in networked systems, and develop cutting-edge information and training to improve the practice of cybersecurity.

Our connection to the internationally known [Carnegie Mellon University](https://www.cmu.edu/) creates multidisciplinary collaboration opportunities and amplifies our research abilities.

#### Autonomy Security and Resilience

Develop and sustain security, resilience, and assurance best practices for the development, construction, and employment of machine learning systems.

#### [Cybersecurity Center Development](https://www.sei.cmu.edu/our-work/cybersecurity-center-development/index.cfm)

Develop measurable and repeatable practices to prepare CSIRTs and other operational security organizations.

#### [Cybersecurity Engineering](https://www.sei.cmu.edu/our-work/cybersecurity-engineering/index.cfm)

Develop methods for engineering mission-essential capabilities that balance security and resiliency with mission performance.

#### [Cyber Workforce Development](https://www.sei.cmu.edu/our-work/cyber-workforce-development/index.cfm)

Develop and maintain a well-equipped cyber workforce that is immediately able to support the cybersecurity needs of organizations.

#### [Enterprise Risk and Resilience Management](https://www.sei.cmu.edu/our-work/enterprise-risk-resilience-management/index.cfm)

Develop measurable practices and frameworks that enable organizations to measure and mitigate risks.

#### [Insider Threat](https://www.sei.cmu.edu/our-work/insider-threat/index.cfm)

Detect and mitigate the impact of insider threats and reduce their occurrence in organizations.

#### [Reverse Engineering for Malware Analysis](https://www.sei.cmu.edu/our-work/reverse-engineering-for-malware-analysis/index.cfm)

Develop tools and methods to identify and mitigate code that causes unintended effects in software systems.

#### [Situational Awareness](https://www.sei.cmu.edu/our-work/situational-awareness/index.cfm)

Analyze the cyber terrain as it evolves to characterize assets at risk, measure adversary activity, and prioritize responses to threat.

#### [Secure Development](https://www.sei.cmu.edu/our-work/secure-development/index.cfm)

Assess platforms through the analysis of source code to assure they adhere to security best practices.

#### [System and Platform Evaluation](https://www.sei.cmu.edu/our-work/projects/display.cfm?customel_datapageid_4050=21361)

Assess software, devices, systems, and platforms of unknown design or origin to find vulnerabilities and strategies for defending against possible attacks.

#### [Security Vulnerabilities](https://www.sei.cmu.edu/our-work/security-vulnerabilities/index.cfm)

Reduce exposure to known vulnerabilities in systems.

* ## Careers in the CERT Division

#### [Cyber Risk Intern](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cyber-Risk-Intern_2022294-1)

Pittsburgh, PA

#### [Senior Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Software-Engineer_2020922-1)

Pittsburgh, PA

#### [Associate Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Associate-Research-Scientist---Quantum_2021979)

Pittsburgh, PA

#### [Documentation Specialist and Content Strategist](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Documentation-Specialist-and-Content-Strategist_2022203-1)

Pittsburgh, PA

#### [Senior Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Communications-Engineer_2022179-1)

Pittsburgh, PA

#### [Senior AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-AI-Security-Researcher_2021569-1)

Pittsburgh, PA

#### [Technical Manager - Cybersecurity Assurance Team](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Technical-Manager---Cybersecurity-Assurance-Team_2022101-1)

2 Locations

#### [Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/System-Designer_2017276)

Pittsburgh, PA

#### [AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/AI-Security-Researcher_2020107)

Pittsburgh, PA

#### [Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Vulnerability-Researcher_2019726-1)

Pittsburgh, PA

#### [Senior Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Vulnerability-Researcher_2020002-1)

Pittsburgh, PA

#### [Assistant Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Assistant-Communications-Engineer_2021848-2)

Pittsburgh, PA

#### [Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Research-Scientist---Quantum_2021633-1)

Pittsburgh, PA

#### [Senior Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Research-Scientist---Quantum_2021632)

Pittsburgh, PA

#### [Cybersecurity Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cybersecurity-Engineer_2020646-1)

2 Locations

[SEE ALL SEI JOB OPENINGS](https://cmu.wd5.myworkdayjobs.com/en-US/SEI/)

## Recently Published Vulnerabilities

#### [VU#199397: Insecure Implementation of Tunneling Protocols (GRE/IPIP/4in6/6in4)](https://kb.cert.org/vuls/id/199397)

###### January 17, 2025

#### [VU#952657: Rsync contains six vulnerabilities](https://kb.cert.org/vuls/id/952657)

###### January 14, 2025

#### [VU#529659: Howyar Reloader UEFI bootloader vulnerable to unsigned software execution](https://kb.cert.org/vuls/id/529659)

###### January 14, 2025

[More Vulnerabilities](https://www.kb.cert.org/vuls)
[Report a Vulnerability](https://www.kb.cert.org/vuls/report/)

## Case Studies

[![Cyber Lightning Case Study](/sei-images/images/thumb_mid_thumb_cyber-lightning_380x380_1_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)
#### [Cyber Lightning Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

The SEI hosted Cyber Lightning, a three-day joint training exercise involving Air National Guard and Air Force Reserve units from western Pennsylvania and eastern Ohio.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

[![SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/sei-images/images/thumb_mid_thumb_crisis-simulation_380x380_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)
#### [SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

In SEI crisis simulation exercises, participants use scenarios that present fictitious malicious actors and environmental factors based on real-world events.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

[![USPS Case Study](/sei-images/images/thumb_standard_thumb_usps-improves-its-cybersecurity-and-resilience_260x260_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)
#### [USPS Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

The SEI teamed with the U.S. Postal Service to help it improve its cybersecurity and resilience and collaborated on a program to develop a strong cybersecurity workforce.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

## History

The CERT Division is the birthplace of cybersecurity. For nearly 30 years, the CERT Division of the SEI has partnered with government, industry, law enforcement, and academia to advance cybersecurity and improve the security and resilience of computer systems and networks.

Originally focused on incident response, we have expanded into cybersecurity areas such as network situational awareness, malicious code analysis, secure coding, resilience management, insider threats, digital investigations and intelligence, workforce development, DevOps, forensics, software assurance, vulnerability discovery and analysis, and risk management.

     ![The CERT Division - Barbara Fraser and Ed DeHart](/sei-images/images/about-divisions-cert-history-aside-144-2_2134.jpg "The CERT Division - Barbara Fraser and Ed DeHart")   Barbara Fraser and Ed DeHart, part of the SEI’s CERT/CC in the early 1990s

## Former Director Richard Pethia

[Richard Pethia](/about/leadership/display.cfm?customel_datapageid_2623=3545) was founding director of the SEI's CERT Division. Pethia, who served as director of CERT from 1988 to 2016, guided the organization through tremendous growth and change. Under Pethia's leadership, the unit expanded and evolved from the CERT Coordination Center—a small group focused on computer incident response—to a research organization of more than 200 professionals dedicated to solving problems with widespread cybersecurity implications.

[SEE FULL PROFILE](/about/leadership/display.cfm?customel_datapageid_2623=3545)

     ![Former Director Richard Pethia](/sei-images/images/about-divisions-cert-pethia-aside-144-2_2159.jpg "Former Director Richard Pethia")

## Related Links

* [CERT Podcast Series](http://www.cert.org/podcasts/index.cfm)
* [CERT/CC Blog Series](http://insights.sei.cmu.edu/cert)
* [Computer Security Incident Response Teams](/education-outreach/computer-security-incident-response-teams/index.cfm)

* [FloCon](https://resources.sei.cmu.edu/news-events/events/flocon)
* [Insider Threat Blog Series](https://insights.sei.cmu.edu/insider-threat)
* [Insider Threat Symposium](https://www.eventbrite.com/e/2017-cert-insider-threat-symposium-registration-31893497309)

* [NatCSIRT Meeting](https://resources.sei.cmu.edu/news-events/events/natcsirt/index.cfm)
* [Vulnerability Database](https://www.kb.cert.org/vuls)

[Report a Vulnerability to CERT/CC](https://www.kb.cert.org/vuls/report/)
[Subscribe to SEI Bulletin](/subscribe-to-sei-bulletin/)
[Request Permission to Use SEI Materials](/legal/request-permission-to-use-sei-material)

Carnegie Mellon University
 Software Engineering Institute
 4500 Fifth Avenue
 Pittsburgh, PA 15213-2612
 412-268-5800

 [  [Facebook](https://www.facebook.com/SEICMU/)  |  [Twitter](https://twitter.com/SEI_CMU)  |  [LinkedIn](https://www.linkedin.com/company/software-engineering-institute)  |  [YouTube](https://www.youtube.com/user/TheSEICMU)  |  [iTunes](https://itunes.apple.com/us/podcast/software-engineering-institute-sei-podcast-series/id566573552?mt=2)  ]

[Contact Us](/contact-us/)

 [  [Office Locations](/locations/index.cfm)  |  [Additional Sites Directory](/additional-sites-directory/index.cfm)  |  [Legal](/legal/index.cfm)  |  [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm)  |  [CMU Ethics Hotline](https://www.cmu.edu/hr/resources/ethics-hotline.html)  |  [www.sei.cmu.edu](/index.cfm)  ]

©2025 Carnegie Mellon University


