Based on the provided content, here's an analysis of CVE-2003-0136:

**Root Cause of Vulnerability:**

The vulnerability stems from the insecure creation of a temporary file `/tmp/before` by the `psbanner` program, a component of the LPRng printing system. This file is created every time the filter is run, and it's owned by the `daemon` user and `lp` group. The program writes its current environment and called arguments to this file without any checks.

**Weaknesses/Vulnerabilities Present:**

*   **Insecure Temporary File Creation:** The `psbanner` program creates a temporary file in `/tmp` with predictable naming (`/tmp/before`) and without proper checks, making it vulnerable to symlink attacks.
*   **Uncontrolled Data Write:** The program unconditionally writes its environment variables and arguments to the temporary file without any sanitization.
*   **Privileged Execution:** The `psbanner` filter is executed with the privileges of the `daemon` user, potentially allowing the attacker to overwrite files owned by this user through symlink manipulation.

**Impact of Exploitation:**

*   **Arbitrary File Overwrite:** An attacker can create a symbolic link from `/tmp/before` to a file owned by the `daemon` user (e.g., `/var/spool/lpd/lp/acct`). When a print job is processed, `psbanner` overwrites the content of the target file with the program's environment variables and arguments.
*   **Potential for Privilege Escalation or System Compromise:** Overwriting sensitive system files owned by the `daemon` user could lead to privilege escalation or other forms of system compromise, depending on the nature of the target file.

**Attack Vectors:**

*   **Local Access:** The attacker needs local access to the system to create the symlink in `/tmp`.
*   **Printer Configuration:** The vulnerability is exploitable only if the printer is configured to use `psbanner` for printing banner pages (typically configured using the `bp` parameter in `/etc/printcap`).
*   **Symlink Creation:** The attacker creates a symbolic link from `/tmp/before` to a target file they wish to overwrite.
*   **Trigger a print job:** The attacker or another user would need to initiate a print job that utilizes psbanner.

**Required Attacker Capabilities/Position:**

*   The attacker must have local access to the system to create a symbolic link.
*   The attacker needs to know (or guess) that the target system uses `psbanner` for banner pages and have the ability to trigger a print job.
*   The attacker needs to know the location of a file they want to overwrite that is owned by the daemon user or group.

**Additional Notes:**

*   The vulnerability was reported and fixed in LPRng versions 3.8.20-4 (for sid/sarge) and 3.8.10-2 (for woody).
*   The fix involved removing the insecure creation of the `/tmp/before` file, therefore, resolving the issue of predictable file naming and the ability to perform a symlink attack.
*   The report mentions that this issue was previously fixed in LPRng-3.8.7, suggesting a possible regression in later versions up to 3.8.10.
* The provided content provides significantly more detail than a standard CVE description, including the specific vulnerable program, attack steps, and the fix.

**Summary**

The vulnerability lies in the `psbanner` program's insecure file creation in `/tmp` with predictable naming. This allowed a local attacker to overwrite arbitrary files owned by the `daemon` user by creating a symbolic link to a target file prior to a print job being processed. The fix was to remove the insecure file creation in `/tmp` altogether.