=== Content from www.kb.cert.org_a9e5e5e0_20250124_163133.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#471084

## Linux kernel IP stack incorrectly calculates size of an ICMP citation for ICMP errors

#### Vulnerability Note VU#471084

Original Release Date: 2003-06-09 | Last Revised: 2003-10-14

---

### Overview

The Linux 2.0 kernel contains a vulnerability in the way it processes ICMP errors. This could lead to portions of memory being leaked to a malicious user.

### Description

| The Linux 2.0 kernel (versions 2.0 through 2.0.39 inclusive) contains an error in the calculation of the size for an ICMP citation. A citation is created for ICMP error responses. This miscalculation may lead to random data stored in memory being returned in the response.  This vulnerability could be used by an attacker to gain sensitive information about the system, which may aid in an attack. |
| --- |

### Impact

| Sensitive information may be leaked to an attacker. |
| --- |

### Solution

| Upgrade or apply a patch as necessary. Please see the vendor Section to determine if your product is vulnerable. |
| --- |

### Vendor Information

471084
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23471084/) to view vendors.**
### [WatchGuard](#JARL-5N6KFB) Affected

Updated:  October 14, 2003

### Status

Affected

### Vendor Statement

We have done further analysis in conjunction w/ the reporter and have found the following.

Our earlier tests conducted with a tool supplied by the reporter indicated that the information leak was limited to 18 bytes every 30 seconds. We have done further analysis in conjunction w/ the reporter using a different tool and have found the following:

Each instance of an attack would generate a copy of whatever was in the effected buffer. Unless the size of the ICMP payload changes from request to request it'll copy the same address in memory over and over again sending out whatever happens to be in that buffer at that instant. In our testing we observed that much of the data being leaked is the same. As the size of the payload changes, so does the address range within this buffer that the vulnerability effects.

We expect to have the fix available to customers by August 6th through WatchGuard's regular software distribution channels.

Please direct any questions regarding this or any other security issue with WatchGuard products to

steve.fallin@watchguard.com

Steve Fallin
Director, Rapid Response Team
WatchGuard Technologies, Inc.
++++++++++++++++++++++++++

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Check Point](#JARL-5N6KDX) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

Check Point Software does not and has never supported the Linux 2.0 kernel, thus no versions of Check Point products are affected by this advisory.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Clavister](#JARL-5N6K8A) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

Clavister Firewall: Not vulnerable

Clavister Firewall uses its own self-contained operating system and is, as such, not affected by Linux bugs.

It can, however, protect vulnerable linux machines by blocking ICMP errors and stripping the "Don't Fragment" bit of all packets that pass through it to avoid the Path MTU Discovery "black holes" that otherwise result from blocking ICMP errors.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Fujitsu](#JARL-5NCJ4M) Not Affected

Updated:  June 26, 2003

### Status

Not Affected

### Vendor Statement

Fujitsu's UXP/V o.s. is not affected by the problem in VU#471084.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Hitachi](#JARL-5NEJGP) Not Affected

Updated:  June 11, 2003

### Status

Not Affected

### Vendor Statement

NOT Vulnerable to this issue.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Ingrian Networks](#JARL-5N6K8V) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

Ingrian Networks products are not vulnerable to VU#471084.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Netscreen](#JARL-5N6K7K) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

NetScreen is not vulnerable to this issue.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Novell](#JARL-5N6KAS) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

Novell has no products supported on the affected Linux kernel versions.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Secure Computing Corporation](#JARL-5NVKTD) Not Affected

Updated:  June 26, 2003

### Status

Not Affected

### Vendor Statement

The Sidewinder, Sidewinder G2, and Gauntlet firewalls are not based on Linux, and are thus not affected by this vulnerability.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Stonesoft](#JARL-5N6KBB) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

Stonesoft's StoneGate high availability firewall and VPN product does not use the vulnerable version of Linux kernel and is thus not vulnerable.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Sun Microsystems Inc.](#JARL-5N6KAE) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

Sun is not vulnerable to this issue. None of our currently supported products use the 2.0.x series of Linux kernels. All of our current products use the 2.2.x or 2.4.x series of kernels.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Symantec Corporation](#JARL-5N6KBR) Not Affected

Updated:  June 03, 2003

### Status

Not Affected

### Vendor Statement

We have evaluated our products and determined that none embed or has dependances on the vulnerable Linux kernel versions.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

View all 12 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.cartel-securite.fr/pbiondi/adv/CARTSA-20030314-icmpleak.txt>
* <http://www.secunia.com/advisories/8991/>
* <http://www.iss.net/security_center/static/12223.php>
### Acknowledgements

Thanks to Philippe Biondi of Cartel Security for reporting this vulnerability.

This document was written by Jason A Rafail.

### Other Information

| **CVE IDs:** | [None](http://web.nvd.nist.gov/vuln/detail/None) |
| --- | --- |
| **Severity Metric:** | 1.37 |
| **Date Public:** | 2003-06-09 |
| **Date First Published:** | 2003-06-09 |
| **Date Last Updated:** | 2003-10-14 17:40 UTC |
| **Document Revision:** | 5 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_dfe2597a_20250124_163102.html ===

```
[[prev in list](?l=bugtraq&m=105519076304027&w=2)] [[next in list](?l=bugtraq&m=105516406106622&w=2)] [prev in thread] [[next in thread](?l=vuln-dev&m=105527852924695&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Linux 2.0 remote info leak from too big icmp citation](?t=105519183100002&r=1&w=2)
From:       [Philippe Biondi <biondi () cartel-securite ! fr>](?a=102088522900001&r=1&w=2)
Date:       [2003-06-09 6:56:55](?l=bugtraq&r=1&w=2&b=200306)
[Download RAW [message](?l=bugtraq&m=105519179005065&q=mbox) or [body](?l=bugtraq&m=105519179005065&q=raw)]

----------------------------------------------------------------------
               Cartel Sécurité --- Security Advisory

Advisory Number: CARTSA-20030314
Subject:         Linux 2.0 remote info leak from too big icmp citation
Author:		 Philippe Biondi <biondi@cartel-securite.fr>
Discovered:      March 14, 2003
Published:       June 9, 2003
CERT reference:  VU#471084 (<http://www.kb.cert.org/vuls/id/471084>)
----------------------------------------------------------------------

You can use this URL to link this document :
<http://www.cartel-securite.fr/pbiondi/adv/CARTSA-20030314-icmpleak.txt>

Problem description
===================

There is a bug in the way linux 2.0 kernel IP stack computes the size of an
ICMP citation for almost every ICMP errors. This leads to too much data being
sent on the network, coming from anywhere in the memory.

This is a very important leak. Experiments show that even passwords can
be stolen. Moreover, you can do this from anywere on the internet, as soon
as you can send IP packets to the vulnerable host (except special firewalling).

The typical case is when you use a linux 2.0 box (or, more probably,
any appliance that uses it) as a masquerading gateway for internet and
DMZ. In this configuration, the gateway can be used to leak potentially
all your traffic from your LAN, even your POP passwords for
the mail server in the DMZ.

Vulnerable products
===================

Any 2.0 linux kernel before 2.0.39 (2.0.39 included)
Watchguard Firebox II

Any appliance (firewall, proxy, etc.) that uses linux 2.0 <= 2.0.39

A tester can be found here (no guarantee though) :
<http://www.cartel-securite.fr/pbiondi/python/icmpleaktest.py>

Vulnerable:
# ./icmpleaktest.py  192.168.11.2
Packet sent. Answer should take 31s. Interrupt with C-c
Got '\x95\x03\x1a\x10Ji\xfb\xba\xd0\xc5Q\x14\x877\xbd\x8a;\xb3^\x7f'

Not vulnerable:
# ./icmpleaktest.py  172.16.1.40
Packet sent. Answer should take 31s. Interrupt with C-c
Got ''

Vendor status
=============

Linux 2.0.40 should be out soon.
Watchguard said updated releases will follow.

These vendors said they are not vulnerable :
* Netscreen
* Symantec
* Novell
* Clavister
* Ingrian
* StoneSoft
* Sun

Solutions
=========

* patch at <http://www.cartel-securite.fr/pbiondi/patches/icmpleak.patch>
  (No guarantee)
* exchange your old appliance by a brand new linux 2.4/netfilter

Workarounds
===========

No good workarrounds. But you can at least carefully try these :
* truncate ICMP errors at the RFC limit,
* filter out icmp errors

Example
=======

We can send an IP packet with the MF flag :

15:41:05  192.168.0.12.80 > 192.168.0.10.80:  udp 4 (frag 52007:12@0+)
0x0000   4500 0020 cb27 2000 4011 0e3f c0a8 000c        E....'..@..?....
0x0010   c0a8 000a 0050 0050 000c cd1e 5858 5858        .....P.P....XXXX

we wait 30s for the reassembly to timeout :

15:41:35  192.168.0.10 > 192.168.0.12: icmp: ip reassembly time exceeded [tos 0xc0]
0x0000   45c0 0050 dcca 0000 4001 1bbc c0a8 000a        E..P....@.......
0x0010   c0a8 000c 0b01 aa24 0000 0000 4500 0020        .......$....E...
0x0020   cb27 2000 4011 0e3f c0a8 000c c0a8 000a        .'..@..?........
0x0030   0050 0050 000c cd1e 5858 5858                  .P.P....XXXX
                                       0050 0050                    .P.P
0x0040   000c cd1e 5858 5858 207b 2d68 0000 0000        ....XXXX.{-h....

Bytes at offsets 0x3c to 0x4f are bonus.
It works with every ICMP errors except the port unreachable error.
It is possible to increase the size of data leaked by adding IP options.

Examples of bonus bytes :

98 EA CD 03 10 58 CD 03 31 32 33 34 AA FF 55 00   .....X..1234..U.
98 86 0C 03 98 EC CD 03 10 58 CD 03 00 00 00 00   .........X......
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
58 EE CD 03 98 86 0C 03 98 EE CD 03 10 58 CD 03   X............X..
69 6E 66 6F 72 6D 61 74 69 6F 6E 00 4D 49 4E 46   information.MINF
00 00 00 00 00 00 00 00 AA FF 55 00 90 88 CC 03   ..........U.....
00 50 00 50 00 0C CD 1E 58 58 58 58 00 00 00 00   .P.P....XXXX....
2E 30 2E 25 75 2E 69 6E 2D 61 64 64 72 2E 61 72   .0.%u.in-addr.ar
90 12 CC 03 00 00 00 00 98 C0 B5 02 00 00 00 00   ................
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
43 5F 4D 4F 4E 45 54 41 52 59 00 4C 43 5F 43 4F   C_MONETARY.LC_CO
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
90 E2 CA 03 00 00 00 00 98 A0 CC 03 00 00 00 00   ................
00 50 00 50 00 0C CD 1E 58 58 58 58 00 00 00 00   .P.P....XXXX....
00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................
00 00 00 00 18 5F FF 00 00 00 00 00 14 00 00 00   ....._..........
73 69 6E 6C 00 2E 67 6E 75 2E 77 61 72 6E 69 6E   sinl..gnu.warnin
70 9E 09 40 60 9E 09 40 E0 9A 08 40 A0 9F 08 40   p..@`..@...@...@
68 01 00 00 41 46 00 00 67 01 00 00 41 4C 00 00   h...AF..g...AL..
FF FF FF FF FF FF FF FF E2 00 00 00 4A 00 00 00   ............J...
61 67 65 2D 72 65 74 75 72 6E 00 53 49 00 53 4F   age-return.SI.SO
61 73 68 00 7A 65 72 6F 00 6F 6E 65 00 74 77 6F   ash.zero.one.two
0D 00 00 00 01 00 00 00 0E 00 00 00 01 00 00 00   ................
01 00 00 00 2D 00 00 00 01 00 00 00 2E 00 00 00   ....-...........
4C 00 00 00 01 00 00 00 4D 00 00 00 01 00 00 00   L.......M.......
01 00 00 00 6C 00 00 00 01 00 00 00 6D 00 00 00   ....l.......m...
4C 43 5F 41 4C 4C 00 4C 43 5F 4D 45 53 53 41 47   LC_ALL.LC_MESSAG

----------------------------------------------------------------------
Copyright (c) Cartel Sécurité
This document is copyrighted. It can't be edited nor republished
without explicit consent of Cartel Sécurité.
For more informations, feel free to contact us.
<http://www.cartel-securite.fr/>
----------------------------------------------------------------------

--
Philippe Biondi <biondi@ cartel-securite.fr> Cartel Sécurité
Security Consultant/R&D                      <http://www.cartel-securite.fr>
Phone: +33 1 44 06 97 94                     Fax: +33 1 44 06 97 99
PGP KeyID:3D9A43E2  FingerPrint:C40A772533730E39330DC0985EE8FF5F3D9A43E2

[[prev in list](?l=bugtraq&m=105519076304027&w=2)] [[next in list](?l=bugtraq&m=105516406106622&w=2)] [prev in thread] [[next in thread](?l=vuln-dev&m=105527852924695&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


