```
Subject: UPB: Discussion Board/Web-Site Takeover
Product: Ultimate PHP Board v1.9
Vendor: www.myupb.com
Risk: high
Date: 05/24/2k3
Discovered by: euronymous /F0KP
Advisory URLs: http://f0kp.iplus.ru/bz/024.en.txt, http://f0kp.iplus.ru/bz/024.ru.txt
Contact email: euronymous@iplus.ru

Description:
The vulnerability allows an attacker to execute arbitrary PHP code. The UPB logs visitor information (REMOTE_ADDR and HTTP_USER_AGENT) in a text file named 'iplog' under the 'db' directory. The admin panel includes a script called admin_iplog.php that includes the 'iplog' file.
By injecting PHP code into the HTTP_USER_AGENT header, the attacker's code will be executed when the administrator views the admin_iplog.php page.

Attack Vectors:
- The attacker injects PHP code within the User-Agent HTTP header.
- The administrator must then access the admin_iplog.php page for the code to be executed.

Impact:
- Arbitrary PHP code execution, leading to potential web-site defacement or full server control.

Vulnerabilities:
- Unsanitized logging of user-supplied input (HTTP_USER_AGENT) into a log file.
- Direct inclusion of the log file (iplog) by the admin_iplog.php script, enabling code execution of the injected PHP code.
- The admin interface does not sanitize user data from log file before using.

Required Attacker Capabilities:
- Ability to make HTTP requests to the UPB server.
- Knowledge of the vulnerability location.

Additional Information:
- The advisory mentions prior vulnerabilities in older versions of UPB that may still be present in version 1.9.
```