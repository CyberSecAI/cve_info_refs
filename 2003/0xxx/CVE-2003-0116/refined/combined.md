=== Content from www.kb.cert.org_d974c450_20250125_171859.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#244729

## Microsoft Internet Explorer does not adequately validate window ornament parameters in dialog frames

#### Vulnerability Note VU#244729

Original Release Date: 2003-05-05 | Last Revised: 2003-05-06

---

### Overview

A vulnerability in the way Microsoft Internet Explorer (IE) handles window ornament parameters in dialog frames allows script from a dialog frame in one domain to execute in a different domain, including the Local Machine Zone. The script could read certain local files and data (i.e. cookies) from other web sites. In the presence of other vulnerabilities ([VU#626395](http://www.kb.cert.org/vuls/id/626395), [VU#25249](http://www.kb.cert.org/vuls/id/25249)), the script could execute arbitrary commands.

### Description

| Microsoft Internet Explorer provides two methods ([showModalDialog](http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/showmodaldialog.asp) and [showModelessDialog](http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/showmodelessdialog.asp)) that can be used to display dialog box frames. Both methods require a URI parameter that specifies the source of the dialog frame's content. The methods may optionally specify "windows ornaments" that control different aspects of the dialog frame's appearance (position, dimensions, font settings, etc.).  A dialog frame is subject to the security restrictions of the [DHTML Object Model](http://msdn.microsoft.com/workshop/author/om/xframe_scripting_security.asp): script executing in one frame cannot access data in a frame from a different domain or across a different protocol. The dialog methods may specify source URIs in a different domain than the parent frame, however the security restrictions should prevent script in one frame from accessing data in the other.IE does not adequately validate window ornament parameters in dialog frames. Script included in windows ornament parameters in a dialog frame called from one domain is permitted to access data in a different domain as specified by the dialog frame's source URI.Internet Explorer, Outlook, Outlook Express, MSN Messenger, Eudora, Lotus Notes, Adobe PhotoDeluxe, AOL, and any other software that hosts the [WebBrowser](http://msdn.microsoft.com/workshop/browser/webbrowser/browser_control_ovw_entry.asp) ActiveX control could be affected by this vulnerability.Further information is available in examples by Thor Larholm ([dialog style XSS](http://jscript.dk/2002/11/sec/diemodalstyleXSS.html)) and Liu Die Yu ([Poisonous Style](http://www.securityfocus.com/archive/1/301945)). |
| --- |

### Impact

| An attacker who is able to convince a user to access a specially crafted HTML document, such as an Internet web page or HTML email message, could read data from a different domain, including the [Local Machine Zone](http://msdn.microsoft.com/workshop/security/szone/overview/overview.asp#local). The attacker could read cookies from other web sites and certain types of local files. The attacker's HTML document would need to reside in a [zone](http://msdn.microsoft.com/workshop/security/szone/overview/overview.asp) in which Active scripting was enabled.In conjunction with other vulnerabilities ([VU#626395](http://www.kb.cert.org/vuls/id/626395), [VU#25249](http://www.kb.cert.org/vuls/id/25249)), the attacker could execute arbitrary commands on the user's system. |
| --- |

### Solution

| **Apply Patch**Apply [Q813489](http://www.microsoft.com/windows/ie/downloads/critical/813489/default.asp) or a more recent cumulative patch. See Microsoft Security Bulletin [MS03-015](http://www.microsoft.com/technet/security/bulletin/ms03-015.asp) for more information. |
| --- |

| **Disable Active scripting**Active scripting is required to open a modal dialog frame. At a minimum, disable Active scripting in the Internet zone and the zone used by Outlook, Outlook Express, or any other email client that uses Internet Explorer or the WebBrowser control to render HTML. Instructions for disabling Active scripting can be found in the [CERT/CC Malicious Web Scripts FAQ](http://www.cert.org/tech_tips/malicious_code_FAQ.html#steps).**Apply the Outlook Email Security Update**Another way to effectively disable Active scripting in Outlook is to install the Outlook Email Security Update. The update configures Outlook to open email messages in the Restricted Sites Zone, where Active scripting is disabled by default. In addition, the update provides further protection against malicious code that attempts to propagate via Outlook. The Outlook Email Security Update is available for [Outlook 98](http://office.microsoft.com/downloads/9798/Out98sec.aspx) and [Outlook 2000](http://office.microsoft.com/downloads/2000/Out2ksec.aspx). The functionality of the Outlook Email Security Update is included in Outlook 2002 and Outlook Express 6.**Update HTML Help**To protect against arbitrary command execution, install an updated version of HTML Help ([811630](http://support.microsoft.com/?kbid=811630)). As described in Microsoft Security Bulletin [MS03-015](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-015.asp), the updated HHCtrl ActiveX control disables the Shortcut command in a compiled help file that has been opened with the showHelp method:     + *Only supported protocols [[http:](http://), [https:](https://), [file:](file://), ftp:, ms-its:, or mk:@MSITStore:] can be used with showHelp to open a web page or help (chm) file.* + *The* [*shortcut*](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/htmlhelp/html/vsconshortcutov.asp) *function supported by HTML Help will be disabled when the help file is opened with showHelp This will not affect the shortcut functionality if the same CHM file is opened by the user manually by double-clicking on the help file, or by through an application on the local system using the HTMLHELP( ) API.*  Note that the patches referenced in MS03-004 and MS03-015 completely disable the showHelp method. After installing either one of these patches, Internet Explorer will not be able to open help files.**Restrict HTML Help commands**Restrict the execution of the *Shortcut* and *WinHelp* HTML Help commands to specified folders, or disable the commands entirely. As in the previous recommendation, this technique will protect against arbitrary command execution via HTML Help. Details are available in Microsoft Knowledge Base Article [810687](http://support.microsoft.com/?kbid=810687). |
| --- |

### Vendor Information

244729
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23244729/) to view vendors.**
### [Microsoft Corporation](#AAMN-5M9S27) Affected

Updated:  May 05, 2003

### Status

Affected

### Vendor Statement

Please see Microsoft Security Bulletin [MS03-015](http://microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-015.asp).

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://liudieyuinchina.vip.sina.com/PoisonousSTYLEforDialog/PoisonousSTYLEforDialog-Content.txt>
* <http://liudieyuinchina.vip.sina.com/PoisonousSTYLEforDialog/PoisonousSTYLEforDialog-MyPage.htm>
* <http://www16.brinkster.com/liudieyu/PoisonousSTYLEforDialog/PoisonousSTYLEforDialog-Content.txt>
* <http://www16.brinkster.com/liudieyu/PoisonousSTYLEforDialog/PoisonousSTYLEforDialog-MyPage.htm>
* <http://www.securityfocus.com/archive/1/301945/2002-11-29/2002-12-05/0>
* <http://jscript.dk/2002/11/sec/diemodalstyleXSS.html>
* <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-015.asp>
* <http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/showmodaldialog.asp>
* <http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/showmodelessdialog.asp>
### Acknowledgements

This vulnerability was publicly reported by Liu Die Yu.

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2003-0116](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0116) |
| --- | --- |
| **Severity Metric:** | 16.73 |
| **Date Public:** | 2002-12-03 |
| **Date First Published:** | 2003-05-05 |
| **Date Last Updated:** | 2003-05-06 20:24 UTC |
| **Document Revision:** | 31 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from docs.microsoft.com_ec5d009a_20250125_171900.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-015.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-015 - Critical

## Cumulative Patch for Internet Explorer (813489)

Published: April 23, 2003 | Updated: May 01, 2003

**Version:** 1.1

**Originally posted:** April 23, 2003

#### Summary

**Who should read this bulletin:**
Customers using MicrosoftÂ® Internet Explorer.

**Impact of vulnerability:**
Four new vulnerabilities, the most serious of which could enable an attacker to execute arbitrary code on a user's system if the user either browsed to a hostile web site or opened a specially crafted HTML email message.

**Maximum Severity Rating:**
Critical

**Recommendation:**
System administrators should install the patch immediately

**Affected Software:**

* Microsoft Internet Explorer 5.01
* Microsoft Internet Explorer 5.5
* Microsoft Internet Explorer 6.0

### General Information

## Technical details

**Technical description:**

This is a cumulative patch that includes the functionality of all previously released patches for Internet Explorer 5.01, 5.5 and 6.0. In addition, it eliminates the following four newly discovered vulnerabilities:

* A buffer overrun vulnerability in URLMON.DLL that occurs because Internet Explorer does not correctly check the parameters of information being received from a web server. It could be possible for an attacker to exploit this vulnerability to run arbitrary code on a user's system. A user simply visiting an attacker's website could allow the attacker to exploit the vulnerability without any other user action.
* A vulnerability in the Internet Explorer file upload control that allows input from a script to be passed to the upload control. This vulnerability could allow an attacker to supply a file name to the file upload control and automatically upload a file from the user's system to a web server.
* A flaw in the way Internet Explorer handles the rendering of third party files. The vulnerability results because the Internet Explorer method for rendering third party file types does not properly check parameters passed to it. An attacker could create a specially formed URL that would inject script during the rendering of a third party file format and cause the script to execute in the security context of the user.
* A flaw in the way modal dialogs are treated by Internet Explorer that occurs because an input parameter is not properly checked. This flaw could allow an attacker to use an injected script to provide access to files stored on a user's computer. Although a user who visited the attacker's website could allow the attacker to exploit the vulnerability without any other user action, an attacker would have no way to force the user to visit the website.

In addition to eliminating the above vulnerabilities, this patch also includes a fix for Internet Explorer 6.0 SP1 that corrects the method by which Internet Explorer displays help information in the local computer zone. While we are not aware of a method to exploit this vulnerability by itself, if it were possible to exploit it, it could allow an attacker to read local files on a visiting user's system.

This patch also sets the [Kill Bit](https://support.microsoft.com/default.aspx?scid=kb;en-us;q240797&id;=kb;en-us;q240797) on the Plugin.ocx ActiveX control which has a security vulnerability. This killbit has been set in order to ensure that the vulnerable control cannot be reintroduced onto users' systems and to ensure that users who already have the vulnerable control on their system are protected. This issue is discussed further in Microsoft Knowledge Base Article 813489.

Like the previous Internet Explorer cumulative patch released with bulletin [MS03-004](https://technet.microsoft.com/security/bulletin/ms03-004), this cumulative patch will cause window.showHelp( ) to cease to function if you have not applied the HTML Help update. If you have installed the updated HTML Help control from Knowledge Base article 811630, you will still be able to use HTML Help functionality after applying this patch.

**Mitigating factors:**

There are common mitigating factors across several of the vulnerabilities:

* The attacker would have to host a web site that contained a web page used to exploit the particular vulnerability.
* By default, Outlook Express 6.0 and Outlook 2002 open HTML mails in the Restricted Sites Zone. In addition, Outlook 98 and 2000 open HTML mails in the Restricted Sites Zone if the [Outlook Email Security Update](https://office.microsoft.com/downloads/2000/out2ksec.aspx) has been installed. With the exception of the URLMON.DLL buffer overrun vulnerability, customers who use any of these products would be at no risk from an e-mail borne attack that attempted to automatically exploit these vulnerabilities. The attacker would have no way to force users to visit a malicious web site. Instead, the attacker would need to lure them there, typically by getting them to click on a link that would take them to the attacker's site.

In addition to the common factors, there are a number of individual mitigating factors:

**URLMON.DLL Buffer Overrun:**

* Code that executed on the system would only run under the privileges of the locally logged in user.

**File Upload Control vulnerability:**

* The attacker would have to know the explicit path and name of the file to be uploaded in advance.

**Third Party plug-in rendering:**

* The third party plugin would have to be present on the user's system in order for it to be exploited

**Severity Rating:**

|  | Internet Explorer 5.01 SP3 | Internet Explorer 5.5 SP2 | Internet Explorer 6.0 Gold | Internet Explorer 6.0 SP1 |
| --- | --- | --- | --- | --- |
| **URLMON.DLL** | Critical | Critical | Critical | Critical |
| **File Upload Control Vulnerability** | Moderate | Moderate | Moderate | Moderate |
| **Third Party Plugin Rendering** | Critical | Critical | Critical | Critical |
| **Model Dialog Script Execution** | Critical | Critical | Critical | Critical |
| **Aggregate Severity of all issues included in this patch** | Critical | Critical | Critical | Critical |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:**

* URLMON.DLL Buffer Overrun: [CAN-2003-0113](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0113)
* File Upload Control vulnerability: [CAN-2003-0114](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0114)
* Third Party plug-in rendering: [CAN-2003-0115](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0115)
* Model Dialog script execution: [CAN-2003-0116](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0116)

**Tested Versions:**

Internet Explorer versions 5.01 Service Pack 3, Internet Explorer 5.5 SP2, Internet Explorer 6.0 and Internet Explorer 6.0 SP1 were tested for these vulnerabilities. Previous versions are no longer [supported](https://go.microsoft.com/fwlink/?linkid=21742), and may or may not be affected by these vulnerabilities.

More information is available from the [Windows Operating System Components Lifecycles Web site](https://go.microsoft.com/fwlink/?linkid=21136)

## Frequently asked questions

**What vulnerabilities are eliminated by this patch?**

This is a cumulative patch that incorporates the functionality of all previously released patches for Internet Explorer. In addition, the patch eliminates four newly reported vulnerabilities:

* One vulnerability that could allow an attacker to cause arbitrary code to run on the user's system.
* One vulnerability that could allow an attacker to cause script code to run on the user's system.
* Two vulnerabilities that could allow an attacker to cause script code to run on the user's system and whose impact would be limited to disclosure of information stored on the local computer including, potentially, personal information.

**Does the patch include any other security changes?**

Yes. The patch ensures that an ActiveX control, Plugin.ocx, cannot be used. The Plugin.ocx control implemented support for third party web browser plugins, which are no longer supported by Internet Explorer. The control has been found to contain a security vulnerability, and in order to protect customers who have this control installed, the patch prevents the control from running or from being reintroduced onto users' systems by setting the Kill Bit for this control. More details on this change are available in Microsoft Knowledge Base Article [240797](https://support.microsoft.com/default.aspx?scid=kb;en-us;q240797&id;=kb;en-us;q240797&)
The patch also refines a change made in Internet Explorer 6 Service Pack 1, which prevents web pages in the Internet Security zone from navigating to the local computer zone. This change was introduced to mitigate the effects of potential new cross domain vulnerabilities. The change introduced in this patch is a further enhancement of the Internet Explorer 6 Service Pack 1 restrictions.

**Is there a way to prevent a possible attack via email?**

Yes. By default, Outlook Express 6.0 and Outlook 2002 open HTML mails in the Restricted Sites Zone. In addition, Outlook 98 and 2000 open HTML mails in the Restricted Sites Zone if the [Outlook Email Security Update](https://office.microsoft.com/downloads/2000/out2ksec.aspx) has been installed. With the exception of the URLMON.DLL buffer overrun vulnerability, Customers who use any of these products would be at no risk from an e-mail borne attack that attempted to exploit these vulnerabilities.

**Why does this patch affect HTML Help Functionality?**

Because this is a cumulative patch, it includes a fix from a previous patch for Internet Explorer that addressed a vulnerability by ensuring that the correct cross domain security checks take place whenever showHelp functionality is used. This fix caused the HTML Help functionality to fail unless a subsequent update was applied as described in Knowledge Base article 811630. In order to restore HTML Help functionality, users who apply this patch are encouraged to download and install the update to HTML Help after applying this cumulative patch if they have not already done so.

**I installed the update from Knowledge Base article 811630. After installing this patch will HTML Help function properly?**

Yes - If you previously installed the HTML Help update from Knowledge Base article 811630 when you applied the IE cumulative update from MS03-004, you do not need to reinstall the HTML Help update.

**What is HTML Help shortcut functionality?**

When a user browses help files, it is possible for HTML Help to create a shortcut when a user clicks a specific word, phrase, or graphic in a help topic. While this functionality is not a vulnerability in itself, when combined with this or other cross domain security vulnerabilities, this functionality could allow an attacker to run code of the attacker's choice on a user's system. HTML Help has been updated to reduce the risk from this attack vector and to provide defense in depth against this type of attack. To learn more about this functionality, please see:
[https:](https://).

**If I only apply this patch, will I be protected from the HTML Help shortcut vulnerability?**

Yes, you will be protected from the vulnerability affecting the use of showHelp in Internet Explorer. However, it's important to note this patch disables showHelp in order to block the attack vector that might allow a malicious web site operator to launch an executable file already on a user's local system. In order to restore the full functionality of showHelp, users must install the latest version of HTML Help that is discussed in Microsoft Knowledge Base article 811630.

**Will HTML Help functionality change when I download the new version of HTML Help?**

When the latest version of HTML Help is installed, the following limitations will be encountered when a help file is opened with the showHelp method:

* Only supported protocols can be used with showHelp to open a web page or help (chm) file.
* The shortcut function supported by HTML Help will be disabled when the help file is opened with showHelp This change will not affect the shortcut function if the user opens the same CHM file manually by double-clicking on it, or by invoking an application on the local system that uses the HTMLHELP( ) API.

**Where is the updated HTML Help located?**

Users can find the updated HTML Help on Windows Update or by following the link included in Microsoft Knowledge Base article 811630.

**Does the patch for this vulnerability include the updated HTML Help?**

No - Users should download and install the HTML Help update (811630) separately from from one of the locations discussed above.

**Buffer Overrun in URLMON.DLL (CAN-2003-0113):**

**What's the scope of the first vulnerability?**

This is a [buffer overrun](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. A successful attack that exploited this vulnerability could cause Internet Explorer to execute arbitrary code if a user were to visit a site under an attacker's control.

**What causes the vulnerability?**

The vulnerability results because of an unchecked buffer in URLMON.DLL

**What is URLMON.DLL?**

URLMON.DLL is the component of Internet Explorer responsible for handling the processing of URLs and information returned from web site communication.

**What's wrong with the way URLMON.DLL handles information returned from a web site?**

There is a flaw in the way Internet Explorer checks parameters when handling information returned from a remote web server. Internet Explorer does not conduct these checks properly on certain parameters returned from a web site, and it is therefore possible to cause a buffer overrun. The resulting buffer overrun could cause Internet Explorer to fail or could allow an attacker to run arbitrary code on a user's machine.

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to cause Internet Explorer to fail in such a way that it would execute code of the attacker's choice. This would allow an attacker to take any action on a user's machine in the security context of the currently logged in user.

**How could an attacker exploit this vulnerability?**

An attacker could seek to exploit this vulnerability by hosting a specially constructed web page, or by sending a specially crafted HTML email to the user. If the user visited this web page, or previewed or viewed the HTML email, Internet Explorer could fail and could allow arbitrary code to execute.

**What does the patch do?**

The patch addresses the vulnerability by ensuring that the correct parameter checks are performed when information is returned from a web page.

**File Upload Control vulnerability: (CAN-2003-0114):**

**What's the scope of this vulnerability?**

This is an [information disclosure](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. A successful attack that exploited this vulnerabilty could allow an attacker access to files on a user's hard drive. An attacker who exploited this vulnerability could cause files from a user's hard drive to be uploaded to a remote computer.

**How could an attacker exploit this vulnerability?**

An attacker could exploit this vulnerability by enticing a user to visit a web page and click on a specially crafted link that would launch the Internet Explorer file upload control. The control would then execute script that would populate the control's upload parameter with a file name. The control would then close and upload the file without any user interaction.
In order to successfully exploit this vulnerability, the attacker would have to know the exact location on the user's hard drive of the file as well as the file name. In addition only a file that was not currently in use could be uploaded - for example, e-mail files could not be uploaded if the user had his or her mail application open at the time of the attack.

**What causes the vulnerability?**

The vulnerability results because an unchecked parameter in the File Upload control for Internet Explorer allows input by the attacker to be passed to it without action by the user.

**What is the Internet Explorer File Upload control?**

The Internet Explorer File Upload control is the portion of Internet Explorer that provides the user interface to upload a file from a local computer to a website.

**What's wrong with the way the File Upload control handles uploads?**

There is a flaw in the way the File upload Control handles incoming requests to upload files. The Upload Control contains an unsafe function that allows automatic input to pre-populate the upload path information and automatically upload a file without any user intervention.

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to upload a file from a user's hard drive to an attacker's website, provided the file was not in use by the user or the operating system, and provided the attacker knew the full path and file name. This could occur without providing any visible notice to the user.

**How could an attacker exploit this vulnerability?**

An attacker could create a webpage that would cause the file upload control to upload a specific file from the user's hard drive to a website when a user visited the page. The attacker would have to know the exact name of the file to be uploaded once the user had visited the site.

**What does the patch do?**

The patch addresses the vulnerability by ensuring that the File Upload Control does not allow input to be supplied by a website.

**Third Party Plug-in Rendering: (CAN-2003-0115):**

**What's the scope of this vulnerability?**

This vulnerability could allow a malicious web site to supply a visiting user with script that would run in the local computer zone on a user's computer. In order for this vulnerability to be exploited, the attacker would have to attempt to exploit a third party plugin that was installed on the visitng user's system. If the user had not installed third party plugins, or had removed all of them from the system, the vulnerability could not be exploited.

**What causes the vulnerability?**

The vulnerability results because Internet Explorer does not correctly parse a URL that invokes a third party plugin. When certain characters are included in a URL, the correct security checks can be evaded.

**What are third party plug-ins?**

Internet Explorer has the capability to render several different file types within the browser window. For instance, Internet Explorer has the ability to render Microsoft Word Document files within a browser windows without the user having to open the Word application itself. This capability is also available for third parties to provide plug-ins to Internet Explorer so that Internet Explorer will recognize file types and display them within a browser window.

**Does Internet Explorer ship any third party plug-ins by default?**

Yes, Internet Explorer installs support for Macromedia Flash files by default.

**What's wrong with the way Internet Explorer handles third party plug-ins?**

There is a flaw in the way Internet Explorer checks parameters when rendering third party file types in the browser window. Before the file type itself is actually rendered in the browser window, Internet Explorer performs a loading operation for the new window. This loading operation does not properly check the parameters of the URL used to reference the third party file type.

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to cause Internet Explorer to run script in the local computer zone.

**How could an attacker exploit this vulnerability?**

An attacker could exploit this vulnerability by hosting a website, constructing a specially formed page, and enticing a user to visit the website If the user visited this web page and clicked on a specially formed link referencing a third party file type, Internet Explorer could allow script to run in the local computer zone.

**Are any third party file types vulnerable?**

No - the flaw actually occurs in the method by which Internet Explorer renders the file types, not in any specific plug-in. However this vulnerability only affects plugins that use the EnableFullPage feature. Microsoft recommends that all Internet Explorer users install the patch to ensure that they are protected if any third party plugins are present on their systems or are installed in the future.

**What does the patch do?**

The patch addresses the vulnerability by ensuring that the correct checks are performed when a third party file type is rendered in the browser.

**Modal Dialog Script Execution: (CAN-2003-0116):**

**What's the scope of this vulnerability?**

This is an [information disclosure](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. This vulnerability could allow an attacker to read files on a visiting user's hard drive.

**What causes the vulnerability?**

The vulnerability results because of an unchecked parameter in the [Cascading Style Sheet](https://msdn2.microsoft.com/library/ms670186.aspx) input parameter for Modal dialogs.

**What is a modal dialog?**

A Modal Dialog is a dialog presented by the user interface that asks the user to make a decision before carrying out any other actions, such as invoking an application or opening a document.

**What's wrong with the way Internet Explorer handles modal dialogs?**

There is a flaw in the way that Internet Explorer renders modal dialogs. A specific parameter used in the creation of the dialog could contain code that Internet Explorer could execute. Execution of this code could allow the remote server to read information from the user's hard drive.

**How could an attacker exploit this vulnerability?**

An attacker could exploit this vulnerability by hosting a website, constructing a specially formed page, and enticing a user to visit the website. If the user then visited the page, it could execute a specific command to create a dialog, which could then automatically execute script that would access files on the local computer.

In order to successfully exploit this vulnerability however, the attacker would have to know the exact location on the user's hard drive of the file as well as the file name.

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to read files from the user's hard drive.

**What does the patch do?**

The patch addresses the vulnerability by ensuring that the modal dialog parameter only accepts the specific input it needs, and rejects script supplied by a web site.

## Patch availability

**Download locations for this patch**

</https:>[https:](https://)

#### Additional information about this patch

**Installation platforms:**

* IE5.01 running on Windows 2000 systems with Service Pack 3 installed.
* The IE 5.5 patch can be installed on systems running [Internet Explorer 5.5 Service Pack 2](https://www.microsoft.com/windows/ie/ie6/support/ie5xsupport.mspx).
* The IE 6.0 patch can be installed on systems running IE 6.0 Gold or [Internet Explorer 6.0 Service Pack 1](https://www.microsoft.com/windows/ie/ie6/downloads/critical/ie6sp1/default.mspx).

**Inclusion in future service packs:**

The fix for this issue will be included in Internet Explorer 6.0 Service Pack 2.

**Reboot needed:** Yes

**Patch can be uninstalled:** Yes

**Superseded patches:** This patch supersedes the one provided in Microsoft Security Bulletin MS03-004, which is itself a cumulative patch.

**Verifying patch installation:**

* To verify that the patch has been installed on the machine, open IE, select Help, then select About Internet Explorer and confirm that Q813489 is listed in the Update Versions field.
* To verify the individual files, use the patch manifest provided in Knowledge Base article 813489.

**Caveats:**

If you have not installed the updated HTML Help control from Knowledge Base article 811630, you will not be able to use some HTML Help functionality after applying this update. In order to restore that functionality, users need to download the updated HTML Help control (811630). Users should also note that when the latest version of HTML Help is installed, the following limitations will occur when a help file is opened with the showHelp method:

* Only supported protocols can be used with showHelp to open a web page or help (chm) file.
* The shortcut function supported by HTML Help will be disabled when the help file is opened with showHelp This will not affect the shortcut functionality if the same CHM file is opened by the user manually by double-clicking on the help file, or by through an application on the local system using the HTMLHELP( ) API.

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) the following for working with us to protect customers:

Mark Litchfield of [Next Generation Security Software Ltd.](https://www.nextgenss.com/) for reporting the PLUGIN.OCX issue to us.

Andreas Sandblad, Sweden for reporting the showhelp issue to us.

[Jouko PynnÃ¶nen](https://technet.microsoft.com/mailto%3Ajouko%40solutions.fi) of Oy Online Solutions Ltd, Finland for reporting the URLMON.DLL Buffer Overrun issue to us.

**Support:**

* Microsoft Knowledge Base article [813489](https://support.microsoft.com/?id=813489) discusses this issue. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 April 23, 2003: Bulletin Created.
* V1.1 May 1, 2003: Updated mitigating factors and Frequently Asked Questions to note that the URLMON.DLL buffer overrun vulnerability is not blocked from the HTML email vector by the Outlook Email Security Update or the default settings of Outlook 2002 and Outlook Express 6.0.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


