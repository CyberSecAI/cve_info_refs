=== Content from docs.microsoft.com_10c0753c_20250125_230349.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-013.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-013 - Important

## Buffer Overrun in Windows Kernel Message Handling could Lead to Elevated Privileges (811493)

Published: April 16, 2003 | Updated: August 25, 2003

**Version:** 2.1

**Originally posted:** April 16, 2003

**Updated:** August 25, 2003

#### Summary

**Who should read this bulletin:**
Administrators of MicrosoftÂ® Windows NTÂ® 4.0, WindowsÂ® 2000 and WindowsÂ® XP systems.

**Impact of vulnerability:**
Local Elevation of Privilege

**Maximum Severity Rating:**
Important

**Recommendation:**
Customers should install the patch at the earliest opportunity.

**Affected Software:**

* Microsoft Windows NT 4.0
* Microsoft Windows NT 4.0 Server, Terminal Server Edition
* Microsoft Windows 2000
* Microsoft Windows XP

**Non Affected Software:**

* Windows Server 2003

**End User Bulletin:**
An end user version of this bulletin is available at: [https:](https://).

### General Information

## Technical details

**Technical description:**

Microsoft re-issued this bulletin on May 28, 2003 to advise on the availability of an updated Windows XP Service Pack 1 patch. This revised patch corrects the performance issues that some customers experienced with the original Windows XP Service Pack 1 patch.

Microsoft originally issued this bulletin on April 16, 2003. Subsequent to that date, Microsoft received reports of performance problems with the patch from some Windows XP Service Pack 1 customers. This original Windows XP Service Pack 1 patch did address the security vulnerability discussed in this security bulletin. Microsoft investigated this performance issue and confirmed that there could be performance problems when the original patch was applied to Windows XP Service Pack 1 systems. Microsoft has published a Knowledge Base article, [819634](https://support.microsoft.com/?kbid=819634), that describes the known circumstances that can cause the performance problems to manifest themselves with the original patch. Microsoft has subsequentially re-issued the Windows XP Service Pack 1 patch to correct the performance problems. This revised patch can be downloaded from the locations described later in this bulletin.

The Windows kernel is the core of the operating system. It provides system level services such as device and memory management, allocates processor time to processes and manages error handling. There is a flaw in the way the kernel passes error messages to a debugger. A vulnerability results because an attacker could write a program to exploit this flaw and run code of their choice. An attacker could exploit this vulnerability to take any action on the system including deleting data, adding accounts with administrative access, or reconfiguring the system.

For an attack to be successful, an attacker would need to be able to logon [interactively](https://technet.microsoft.com/security/bulletin/glossary) to the system, either at the console or through a terminal session. Also, a successful attack would require the introduction of code in order to exploit this vulnerability. Because best practices recommends restricting the ability to logon interactively on servers, this issue most directly affects client systems and terminal servers.

**Mitigating factors:**

* A successful attack requires the ability to logon interactively to the target machine, either directly at the console or through a terminal session.
* Properly secured servers would be at little risk from this vulnerability. Standard best practices recommend only allowing trusted administrators to log onto such systems interactively; without such privileges, an attacker could not exploit the vulnerability.

**Severity Rating:**

|  |  |
| --- | --- |
| **Windows NT 4.0** | Important |
| **Windows NT 4.0, Terminal Server Edition** | Important |
| **Windows 2000** | Important |
| **Windows XP** | Important |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2003-0112](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0112)

**Tested Versions:**

Microsoft tested Windows NT4, Windows 2000 and Windows XP to assess whether they are affected by these vulnerabilities. Previous versions are no longer [supported](https://go.microsoft.com/fwlink/?linkid=21742), and may or may not be affected by these vulnerabilities.

## Frequently asked questions

**Why has Microsoft reissued this bulletin?**

Subsequent to the release of this bulletin and the associated patches, a performance related problem was identified with the Windows XP Service Pack 1 version of the patch. This problem is unrelated to the security vulnerability discussed in this bulletin, however the problem has caused some customers to notice performance degradation on Windows XP SP1 systems after applying the patch.
Microsoft has corrected this problem and re-issued this bulletin on May 28, 2003 to advise on the availability of a revised patch for Windows XP Service Pack 1.

**What's the scope of the vulnerability?**

This is a [privilege elevation](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. An attacker who has the ability to interactively log on to a system and run code of their choice could seek to exploit this vulnerability and run code of their choice with higher privileges. This could allow an attacker to carry out any action on the system including creating administrative accounts or modifying or deleting data.
Because a successful attack would require the ability for the attacker to logon interactively and run a program, the systems most likely to be affected by this vulnerability are client systems and terminal servers, which regularly allow end-users access to the system directly. Servers such as mail servers, database servers, application servers and file servers are normally configured to restrict the ability of users to log on interactively and therefore are less likely to be affected by this vulnerability.

**What causes the vulnerability?**

The vulnerability results because of an unchecked buffer used by the Windows kernel for passing error messages to a debugger.

**What is the Windows Kernel?**

The Windows kernel is the core of the Windows operating system. It provides basic services, such as memory and device management, which all other applications depend upon.

**What is a debugger?**

A debugger is a software program that provides a way for system administrators and developers to troubleshoot programs running on Windows by interrogating the code that is running on the system directly.
A debugger works by "attaching" to a particular process and then listening for error messages from that process. When an error message is detected, the debugger then displays the error message to allow analysis. The kernel manages the passage of messages to and from a debugger. Windows NT, Windows 2000 and Windows XP include a debugger.

**What's wrong with the way the Kernel handles debug messages in Windows?**

There is a flaw in the Windows kernel caused by a difference in the permitted size of an outgoing error message, and the size of the buffer that can receive that error message. This means that if an overly large message is passed between the kernel and the debugger, the buffer can be caused to overflow.
The flaw is in the Windows kernel and how it passes messages to the debugger, and not in the debugger itself.

**What could this vulnerability enable an attacker to do?**

An attacker with sufficient rights to logon interactively could use this vulnerability to run code of their choice. For example, the attacker could execute code that could allow adding accounts with administrative privileges, deleting critical system files, or changing security settings.
It is important to note that an attacker would need to be able to logon interactively to the system. This vulnerability could not be exploited by a remote or an anonymous user.

**How could an attacker exploit this vulnerability?**

An attacker could seek to exploit this vulnerability by writing a program that would send a number of specially malformed debugger messages to and from the Windows kernel in such a way as to overflow the affected buffer. This could allow the attacker to run code of their choice, which could be used to elevate privilege.
For an attack to be successful, the attacker would need to be able to logon interactively and to introduce hostile code to the system. Best practices suggest that users' ability to logon and load programs should be limited in accordance with the rule of [least privilege](https://technet.microsoft.com/security/bulletin/glossary), which would mitigate the chances for a successful attack.

**What does the patch do?**

The patch addresses the vulnerability by correctly handling information sent from the Windows kernel to the debugger.

**In the Additional Information section below you state that the Windows 2000 patch supercedes the Windows 2000 Patch for** [**MS03-007**](https://technet.microsoft.com/security/bulletin/ms03-007)**. Does this patch correct the problem discussed in the Caveats section of** [**MS03-007**](https://technet.microsoft.com/security/bulletin/ms03-007)**?**

Yes - the problem with [MS03-007](https://technet.microsoft.com/security/bulletin/ms03-007) was caused by a dependent file not being present in the patch. This file dependency only manifested itself under very specific circumstances - the system needed to be running Windows 2000 Service Pack 2 **and** also have had one of a small number of non-security hotfixes installed - which had to have been obtained from Microsoft Product Support Services.
The Windows 2000 patch for this security vulnerability includes the dependent file, and also includes the fix for [MS03-007](https://technet.microsoft.com/security/bulletin/ms03-007). This means that the patch will install on the systems described above without causing the same issue as the [MS03-007](https://technet.microsoft.com/security/bulletin/ms03-007) patch.

## Patch availability

**Download locations for this patch**

* Windows NT 4.0:
  + [All except Japanese NEC and Chinese - Hong Kong](https://www.microsoft.com/download/details.aspx?familyid=c3596ed1-596f-416c-8be5-91ae65619a1a&displaylang;=en)
  + [Japanese NEC](https://www.microsoft.com/download/details.aspx?familyid=6d83f8ba-bf16-4ec5-9187-9b03e9ae825f&displaylang;=ja)
  + [Chinese - Hong Kong](https://www.microsoft.com/download/details.aspx?familyid=0ff5c348-f7a0-44e8-8d82-557389fb4590&displaylang;=zh-tw)
* Windows NT 4.0, Terminal Server Edition:
  + [All](https://www.microsoft.com/download/details.aspx?familyid=910a0015-3723-4a4e-9049-99a4ce52b5f8&displaylang;=en)
* Windows 2000:
  + [All except Japanese NEC](https://www.microsoft.com/download/details.aspx?familyid=cacac8c0-81e9-413e-b565-5d7b3257a733&displaylang;=en)
  + [Japanese NEC](https://www.microsoft.com/download/details.aspx?familyid=81e6e80c-5e56-4466-98c1-4ddf6cf3893f&displaylang;=ja)
* Windows XP:
  + [32-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=9f81e615-3dec-4a4b-826a-4e0feab42323&displaylang;=en)
  + [64-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=dbc47904-51c8-475a-9900-3df363a51a3a&displaylang;=en)

#### Additional information about this patch

**Installation platforms:**

* The Windows NT 4.0 patch can be installed on systems running [Service Pack 6a](https://support.microsoft.com/kb/241211).
* The Windows NT 4.0, Terminal Server Edition patch can be installed on systems running Windows NT 4.0, Terminal Server Edition [Service Pack 6](https://www.microsoft.com/technet/archive/winntas/downloads/ts4sp6.mspx).
* The Windows 2000 patch can be installed on systems running Windows 2000 [Service Pack 2](https://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx) or [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx).
* The patch for Windows XP can be installed on systems running Windows XP Gold or [Service Pack 1](https://www.microsoft.com/technet/archive/security/news/wxpsp1s.mspx).

**Inclusion in future service packs:**

The fix for this issue will be included in Windows 2000 Service Pack 4 and Windows XP Service Pack 2.

**Reboot needed:** Yes

**Patch can be uninstalled:** Yes

**Superseded patches:**

* The Windows 2000 patch supersedes the Windows 2000 patch discussed in Microsoft Security Bulletin [MS03-007](https://technet.microsoft.com/security/bulletin/ms03-007).
* The Windows NT 4.0 and Windows XP patches do not supersede any other patches.

**Verifying patch installation:**

* Windows NT 4.0:

  To verify that the patch has been installed on the machine, confirm that all files listed in the file manifest in Knowledge Base article 811493 are present on the system.
* Windows NT 4.0 Terminal Server Edition:

  To verify that the patch has been installed on the machine, confirm that all files listed in the file manifest in Knowledge Base article 811493 are present on the system.
* Windows 2000:

  To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q811493.

  To verify the individual files, use the date/time and version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP4\Q811493\Filelist.
* Windows XP:

  + If installed on Windows XP Gold:

    To verify that the patch has been installed, confirm that the following registry key has been created on the machine: HKLM\Software\Microsoft\Updates\Windows XP\SP1\Q811493.

    To verify the individual files, use the date/time and version information provided in the following registry key: HKLM\Software\Microsoft\Updates\Windows XP\SP1\Q811493\Filelist.
  + If installed on Windows XP Service Pack 1:

    To verify that the patch has been installed, confirm that the following registry key has been created on the machine: HKLM\Software\Microsoft\Updates\Windows XP\SP2\Q811493.

    To verify the individual files, use the date/time and version information provided in the following registry key: HKLM\Software\Microsoft\Updates\Windows XP\SP2\Q811493\Filelist.

**Caveats:**

None.

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) Oded Horovitz of [Enterceptâ¢ Security Technologies](https://www.entercept.com/) for reporting this issue to us and working with us to protect customers.

**Support:**

* Microsoft Knowledge Base article [811493](https://support.microsoft.com/default.aspx?scid=kb;en-us;811493) discusses this issue. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 April 16, 2003: Bulletin Created.
* V1.1 April 17, 2003: Included correct patch supercedence information for Windows 2000.
* V1.2 April 23, 2003: Added information regarding performance related issues with Windows XP SP1 patch
* V1.3 April 23, 2003: Added link to KB article that discusses performance related issues with Windows XP SP1 patch
* V2.0 May 28, 2003: Re-issued to advise of availability of revised Windows XP SP1 patch to correct performance issues
* V2.1 August 25, 2003: Corrected duplicate version numbers

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_fd86b37f_20250125_230348.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#446338

## Microsoft Windows kernel contains stack overflow

#### Vulnerability Note VU#446338

Original Release Date: 2003-04-15 | Last Revised: 2003-04-16

---

### Overview

A stack overflow vulnerability exists in the Microsoft Windows kernel.

### Description

| The kernel is the core or "heart" of any operating system and is responsible for a variety of things, such as managing memory and allocating hardware resources. [Entercept's Ricochet Team](http://www.entercept.com/ricochet/) has discovered a stack buffer overflow in the Microsoft Windows kernel (ntoskrnl.exe). This vulnerability is present in Windows NT 4.0, Windows 2000, and Windows XP.  The overflow exists in the portion of the kernel responsible for handling debugging. Specifically, LpcRequestWaitReplyPort(), which is called from the kernel, inappropriately trusts a user space process to correctly report the size of a message passed back to the kernel. By exploiting this vulnerability, an attacker may be able to execute code with the privileges of the operating system kernel. For further technical details, please see the following documents:[Microsoft Security Bulletin MS03-013](http://microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-013.asp)[Entercept Security Alert](http://www.entercept.com/news/uspr/04-16-03.asp) |
| --- |

### Impact

| Exploitation of this vulnerability may allow an attacker to execute code in the context of the kernel. As a result, an attacker could do anything the kernel is capable of doing, such as reading protected areas of system memory, writing to disk, and communicating with the network. |
| --- |

### Solution

| Apply a patch when one becomes available. |
| --- |

### Vendor Information

446338
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23446338/) to view vendors.**
### [Microsoft Corporation](#IAFY-5G9KEV) Affected

Updated:  April 16, 2003

### Status

Affected

### Vendor Statement

<http://microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-013.asp>

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.entercept.com/news/uspr/04-16-03.asp>
* <http://microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-013.asp>
### Acknowledgements

This vulnerability was discovered by Oded Horovitz of Entercept Security Technologies. The CERT/CC thanks both Entercept Security Technologies and Microsoft for providing information that served as a basis for this document.

This document was written by Ian A Finlay.

### Other Information

| **CVE IDs:** | [CVE-2003-0112](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0112) |
| --- | --- |
| **Severity Metric:** | 10.13 |
| **Date Public:** | 2003-04-16 |
| **Date First Published:** | 2003-04-15 |
| **Date Last Updated:** | 2003-04-16 17:57 UTC |
| **Document Revision:** | 36 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


