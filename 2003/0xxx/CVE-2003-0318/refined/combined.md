=== Content from marc.info_015afb1b_20250125_223603.html ===

```
[[prev in list](?l=bugtraq&m=105319553808930&w=2)] [[next in list](?l=bugtraq&m=105319299407291&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    PHP-Nuke code injection in Yearly Stats at Statistics module
From:       [Lorenzo Manuel Hernandez Garcia-Hierro <security () lorenzohgh ! com>](?a=104925143800005&r=1&w=2)
Date:       [2003-05-17 10:33:39](?l=bugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=bugtraq&m=105319538308834&q=mbox) or [body](?l=bugtraq&m=105319538308834&q=raw)]

-------
Product: PHP-Nuke
Vendor: Francisco Burci
Versions Vulnerable:
6.0 without patches ,
6.0 with index.php and mainfile.php patches.
5.5 with patches ( all resting script tags)
No vulnerable:
6.0 with mainfile.php patch for block url tags inclusions ( not all ).
5.5 with script tags but with the other all.
------
DESCRIPTION:
------
i'm working now in nuke based portals , searching modules that use an URL
based query i found in the Statistics module some bugs:
when you put a string in the url behind the &year variable the module
prints you the character that you put.
i probe iframe and works , script tags works , object works,applet
works,meta works,style works,form works too,img works,comments and ssi
works.
--------
SOLUTION:
--------
Put this code in your mainfile.php :
/*
foreach ($HTTP_GET_VARS as $secvalue) {
    if ((eregi("<[^>]*script*\"?[^>]*>", $secvalue)) ||
	(eregi("<[^>]*object*\"?[^>]*>", $secvalue)) ||
	(eregi("<[^>]*iframe*\"?[^>]*>", $secvalue)) ||
	(eregi("<[^>]*applet*\"?[^>]*>", $secvalue)) ||
	(eregi("<[^>]*meta*\"?[^>]*>", $secvalue)) ||
	(eregi("<[^>]*style*\"?[^>]*>", $secvalue)) ||
	(eregi("<[^>]*form*\"?[^>]*>", $secvalue)) ||
	(eregi("<[^>]*img*\"?[^>]*>", $secvalue)) ||
	(eregi("\"", $secvalue))) {
	die ("Oh! .");
    }
}
*/
NOTE: Remove comment /* and */.
-----
WHAT CAN BE HAPPEN?
-----
Script and binary objects inclusion. Normally it isn't a problem but
there are many viruses written in vbscript and javascript/JS . Iframe can
be used for a link that an user visits and there is and attack to the
user trough known iframe vulns.
With the code that i provide your'e sure by this little bug.
-----
CONTACT INFO :
---------------------------------------
Lorenzo Manuel Hernandez Garcia-Hierro
--- Computer Security Analyzer ---
--www.novappc.com --
PGP: Keyfingerprint
B6D7 5FCC 78B4 97C1  4010 56BC 0E5F 2AB2
ID: 0x9C38E1D7
**********************************
[[prev in list](?l=bugtraq&m=105319553808930&w=2)] [[next in list](?l=bugtraq&m=105319299407291&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


