=== Content from marc.info_903e804a_20250125_221357.html ===

```
[[prev in list](?l=bugtraq&m=104636091913230&w=2)] [[next in list](?l=bugtraq&m=104636153214262&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=104637524605811&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [MS-Windows ME IE/Outlook/HelpCenter critical vulnerability](?t=104636391000008&r=1&w=2)
From:       [Fozzy () securityfocus ! com,](?a=104636384300001&r=1&w=2)
Date:       [2003-02-27 5:06:08](?l=bugtraq&r=1&w=2&b=200302)
[Download RAW [message](?l=bugtraq&m=104636383018686&q=mbox) or [body](?l=bugtraq&m=104636383018686&q=raw)]

--[ Summary ]--

From the Microsoft Security Bulletin MS03-006:
" A security vulnerability is present in the Windows Me version of Help
and Support Center [...]. An attacker could exploit the vulnerability by
constructing a URL that, when clicked on by the user, would execute code
of the attacker's choice in the Local Computer security context. The URL
could be hosted on a web page, or sent directly to the user in email. "
This issue can also be triggered automatically in some cases, without the
need for the victim to click on a link. It leads to total remote compromise of
the victim's computer.

Microsoft rates this issue as "Critical".

--[ Affected Systems ]--

- Windows ME (any version)
- Windows XP without SP1

Not vulnerable :
- Windows XP with SP1

Status of Windows 2000 was not tested but is believed to be the same as
Windows XP.

--[ Details]--

When an URL beginning with hcp:// is opened in Internet Explorer or
Outlook, the Help Center is launched. The URL is supplied to this
application without any additional check. The Help center will handle
the URL by opening the specified HTML help page (which is on the local
computer). Arguments, like the help topic name, can be given in the URL
and will be handled by javascript codes in the HTML page.

What happens if the victim follows this kind of link ?
  hcp://vulnerable_help_page.htm?topic=javascript:alert('Malicious
script here can read, delete and execute any file')
The malicious topic we supplied will be used internally by scripts on
the page, will be inserted into the page, etc. So, the malicious script
will finally be executed in the Local Computer zone.

Exploitation has been confirmed on Windows ME and Windows XP without
SP1. When the malicious URL is opened into IE or Outlook, the Help
Center fires and execute the script crafted into the URL. Privileged
scripts actions and ActiveX controls can be run without any warning.
That allows an attacker to take total control over the victim's
computer.

We believe the Microsoft Security Bulletin issued about this issue is a
bit misleading. The problem was flagged as an "unchecked buffer in the
hcp:// URL handler leading to a buffer overrun vulnerability". We asked
Microsoft if they fixed a different problem than the one we reported,
but they told us it was the same.
We see it as a cross-site scripting vulnerability allowing an attacker
to execute arbitrary scripts in the relaxed security context of the Help
Center. This is much easier to exploit than a classical buffer overrun.
An attacker does not need to craft assembler code into the URL to
exploit this bug, he only needs to know a bit about client side
scripting languages and work around a weird triple-URL-decoding.

--[ Disclosure Timeline ]--

- "Warning" from The Hackademy Audit team found this vulnerability at the
end of November, 2002.
- Microsoft was notified early December.
- Readers of "The Hackademy Journal" were warned early December of
critical security issues in Windows ME and KDE ([www.kde.org](http://www.kde.org))
- KDE fixed its vulnerabilities early January.
- Microsoft fixed the Windows ME issue at the end of February (26/02)

--[ Solution ]--

Apply the patch provided by Microsoft in Security Bulletin MS03-006 :
<http://www.microsoft.com/technet/security/bulletin/MS03-006.asp>

-- Fozzy

The Hackademy School, Journal & Audit  - Paris
<http://www.thehackademy.net>
[[prev in list](?l=bugtraq&m=104636091913230&w=2)] [[next in list](?l=bugtraq&m=104636153214262&w=2)] [prev in thread] [[next in thread](?l=bugtraq&m=104637524605811&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from www.kb.cert.org_dd5416a7_20250125_221433.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#489721

## Microsoft Windows Me and XP Help and Support Center does not adequately validate hcp:// URI parameters

#### Vulnerability Note VU#489721

Original Release Date: 2003-03-04 | Last Revised: 2003-05-08

---

### Overview

The Help and Support Center included with Microsoft Windows Millennium Edition and XP does not adequately validate parameters provided in an "hcp://" [URI](http://www.w3.org/Addressing/). As a result, an attacker could construct a URI that could cause the Help and Support Center to execute arbitrary script, effectively giving the attacker full control over a vulnerable system.

### Description

| Microsoft Windows Millennium Edition (Me) and XP contain a feature called the Help and Support Center (HSC). From Microsoft Security Bulletin [MS03-006](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-006.asp): "Help and Support Center (HSC) is a feature in Windows that provides help on a variety of topics. For instance, HSC enables users to learn about Windows features, download and install software updates, determine whether a particular hardware device is compatible with Windows, get assistance from Microsoft, and so forth." HSC can be invoked from Internet Explorer using the custom URI handler prefix "hcp://".  HSC does not adequately validate parameters provided in an "hcp://" URI and will execute arbitrary script contained in the parameters. Outlook, Outlook Express, or any other installed application that is aware of the hcp:// URI handler could be exploited to run arbitrary script via HSC. In particular, Outlook Express prior to version 6.0 and Outlook 98 or 2000 without the [Outlook Email Security Update](http://office.microsoft.com/downloads/2000/Out2ksec.aspx) automatically parse "hcp://" URIs within email messages without user interaction. Windows XP is also vulnerable, however a patch is available in MS02-060 or as part of Service Pack 1a.The FAQ section of MS03-006 refers to this issue as "...a buffer overrun vulnerability." After some discussion with Microsoft, the CERT/CC does not believe that a typical "buffer overrun" or "buffer overflow" vulnerability is present. A memory buffer is not overflowed, CPU registers are not overwritten, and HSC executes arbitrary script, not shell code or machine instructions. |
| --- |

### Impact

| An attacker who is able to convince a user to click on a specially crafted URI could execute arbitrary script to "...add, delete or modify data on the system, or take any other action of the attacker's choice." An attacker could read or execute any file in a known location on a vulnerable system. Windows Me does not have a security model that manages multiple users and privileges, so any local user has complete control over the operating system. |
| --- |

### Solution

| **Apply Patch**For Windows Me, use [Windows Update](http://windowsupdate.microsoft.com/) to install the "812709: Security Update (Windows Me)" package.For Windows XP, apply [Service Pack 1a](http://www.microsoft.com/WindowsXP/pro/downloads/servicepacks/sp1/default.asp), apply the patch referenced in [MS02-060](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-060.asp) ([Q328940](http://support.microsoft.com/default.aspx?scid=kb;en-us;328940)), or use [Windows Update](http://windowsupdate.microsoft.com/). |
| --- |

| **Apply Outlook Email Security Update**The Outlook Email Security Update prevents Outlook 98 and Outlook 2000 from automatically parsing "hcp://" URIs when email messages are viewed. This update does not address the actual vulnerability, but it does require a user to actively click on an "hcp://" URI in order to execute script via HSC. |
| --- |

### Vendor Information

489721
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23489721/) to view vendors.**
### [Microsoft Corporation](#AAMN-5KB2GY) Affected

Notified:  February 27, 2003  Updated: March 03, 2003

### Status

Affected

### Vendor Statement

Please see Microsoft Security Bulletins [MS03-006](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-006.asp) (Me) and [MS02-060](http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-060.asp) (XP).

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

The CERT/CC has no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/security/security_bulletins/ms03-006.asp>
* <http://www.microsoft.com/technet/treeview/?url=/technet/security/bulletin/MS03-006.asp>
* <http://www.securityfocus.com/archive/1/313362/2003-02-24/2003-03-02/0>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;Q812709>
* <http://msdn.microsoft.com/library/default.asp?url=/library/en-us/script56/html/vtoriVBScript.asp>
* <http://msdn.microsoft.com/library/default.asp?url=/library/en-us/script56/html/js56jsoriJScript.asp>
* <http://msdn.microsoft.com/workshop/browser/webbrowser/browser_control_ovw_entry.asp>
* <http://office.microsoft.com/downloads/2000/Out2ksec.aspx>
* <http://office.microsoft.com/downloads/9798/Out98sec.aspx>
* <http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS02-060.asp>
* <http://www.microsoft.com/WindowsXP/pro/downloads/servicepacks/sp1/default.asp>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;328940>
* <http://www.w3.org/Addressing/>
* <http://www.securityfocus.com/bid/6966>
### Acknowledgements

This vulnerability was reported by the Microsoft Security Team. Microsoft credits members of The Hackademy. The CERT/CC thanks Fozzy of The Hackademy for providing feedback on information used in this document.

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2003-0009](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0009) |
| --- | --- |
| **Severity Metric:** | 28.80 |
| **Date Public:** | 2003-02-26 |
| **Date First Published:** | 2003-03-04 |
| **Date Last Updated:** | 2003-05-08 20:10 UTC |
| **Document Revision:** | 30 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from docs.microsoft.com_75fb6a2f_20250125_221435.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-006.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

# Microsoft Security Bulletin MS03-006 - Critical

* Article
* 03/01/2023
* 7 contributors

Feedback

## In this article

## Flaw in Windows Me Help and Support Center Could Enable Code Execution (812709)

Published: February 26, 2003

**Version:** 1.0

**Originally posted:** February 26, 2003

### Summary

**Who should read this bulletin:**
Customers using MicrosoftÂ® WindowsÂ® Me.

**Impact of vulnerability:**
Run Code of Attacker's Choice

**Maximum Severity Rating:**
Critical

**Recommendation:**
Customers should install the patch immediately.

**End User Bulletin:**
An end user version of this bulletin is available at: [https:](https://)

**Affected Software:**

* Microsoft Windows Me

### General Information

## Technical details

**Technical description:**

Help and Support Center provides a centralized facility through which users can obtain assistance on a variety of topics. For instance, it provides product documentation, assistance in determining hardware compatibility, access to Windows Update, online help from Microsoft, and other assistance. Users and programs can execute URL links to Help and Support Center by using the "hcp://" prefix in a URL link instead of "https://".

A security vulnerability is present in the Windows Me version of Help and Support Center, and results because the URL Handler for the "hcp://" prefix contains an unchecked buffer.

An attacker could exploit the vulnerability by constructing a URL that, when clicked on by the user, would execute code of the attacker's choice in the Local Computer security context. The URL could be hosted on a web page, or sent directly to the user in email. In the web based scenario, where a user then clicked on the URL hosted on a website, an attacker could have the ability to read or launch files already present on the local machine. In the case of an e-mail borne attack, if the user was using Outlook Express 6.0 or Outlook 2002 in their default configurations, or Outlook 98 or 2000 in conjunction with the [Outlook Email Security Update](https://www.microsoft.com/download/details.aspx?familyid=5c011c70-47d0-4306-9fa4-8e92d36332fe&displaylang;=en), then an attack could not be automated and the user would still need to click on a URL sent in e-mail. However if the user was not using Outlook Express 6.0 or Outlook 2002 in their default configurations, or Outlook 98 or 2000 in conjunction with the [Outlook Email Security Update](https://www.microsoft.com/download/details.aspx?familyid=5c011c70-47d0-4306-9fa4-8e92d36332fe&displaylang;=en), the attacker could cause an attack to trigger automatically without the user having to click on a URL contained in an e-mail.

**Mitigating factors:**

* The Help and Support Center function could not be started automatically in Outlook Express or Outlook if the user is running Internet Explorer 6.0 Service Pack 1.
* For an attack to be successful, the user would need to visit a website under the attacker's control or receive an HTML e-mail from the attacker.
* Automatic exploitation of the vulnerability by an HTML email would be blocked by Outlook Express 6.0 and Outlook 2002 in their default configurations, and by Outlook 98 and 2000 if used in conjunction with the [Outlook Email Security Update](https://www.microsoft.com/download/details.aspx?familyid=5c011c70-47d0-4306-9fa4-8e92d36332fe&displaylang;=en).

**Severity Rating:**

|  |  |
| --- | --- |
| **Windows Me** | Critical |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2003-0009](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0009)

**Tested Versions:**

Microsoft tested Windows Me and Windows XP to assess whether they are affected by these vulnerabilities. Previous versions of Windows do not contain the code in question and are not affected by this vulnerability.

## Frequently asked questions

**What's the scope of the vulnerability?**

This is a [buffer overrun](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. An attacker who successfully exploited this vulnerability could cause code of his or her choice to be executed as though it originated on the local machine. Such code could provide the attacker with the ability to take any desired action on the machine, including adding, deleting or modifying data on the system or running any code of the attacker's choice.

**What causes the vulnerability?**

The vulnerability results because of an unchecked buffer in the URL Handler for Help and Support Center.

**What's Help and** **SupportCenter?**

Help and Support Center (HSC) is a feature in Windows that provides help on a variety of topics. For instance, HSC enables users to learn about Windows features, download and install software updates, determine whether a particular hardware device is compatible with Windows, get assistance from Microsoft, and so forth.

**What's wrong with Help and** **SupportCenter?**

The HSC URL Handler has a function that allows pages to be opened using the "hcp://" prefix. However, this function does not properly check the parameters of the input it receives. As a result, a buffer is unchecked, and could allow an attacker to craft a URL that could allow code execution.

**What is a URL handler?**

A URL handler lets an application register a new URL type that, when invoked by a web page, starts the application automatically. For example, when Outlook 2002 is installed on a system, it registers "outlook://" as a custom URL handler. Outlook can then be invoked by typing this URL in IE, in the "Run" box, or by clicking on a hyperlink.
In the case of Help and Support Center, the custom URL prefix is "hcp://".

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to cause code of the attacker's choice to run with additional privileges on the system. This could allow the attacker to add, delete or modify data on the system, or take any other action of the attacker's choice.

**How could an attacker exploit this vulnerability?**

The attacker would need to construct a web page that launches a specially crafted URL. The attack could then proceed via either of two vectors. In the first, the attacker could host the web page on a web site; when a user visited the site, the web page would attempt to launch the URL and exploit the vulnerability. In the second, the attacker could send the web page as an HTML mail. Upon being opened by the recipient, the web page could attempt to invoke the function and exploit the vulnerability.
In the HTML mail scenario, if the user was using Outlook Express 6.0 or Outlook 2002 in their default configurations, or Outlook 98 or 2000 in conjunction with the Outlook Email Security Update, then an attack could not be automated and the user would still need to click on a URL send in e-mail. However if the user was not using Outlook Express 6.0 or Outlook 2002 in their default configurations, or Outlook 98 or 2000 in conjunction with the Outlook Email Security Update, the attacker could cause an attack to trigger automatically without the user having to click on a URL contained in an e-mail.

**What does the patch do?**

The patch addresses the vulnerability by correcting the unchecked buffer in the URL handler.

## Patch availability

**Download locations for this patch**

* Microsoft Windows Me:

  [https://windowsupdate.microsoft.com](https://windowsupdate.microsoft.com/)

### Additional information about this patch

**Installation platforms:**

This patch can be installed on systems running Windows Me Gold

**Reboot needed:** Yes

**Patch can be uninstalled:** No

**Superseded patches:** None.

**Verifying patch installation:**

* To verify that the patch has been installed on the machine, use the [Qfecheck.exe](https://support.microsoft.com/default.aspx?scid=kb;en-us;295413) tool and confirm that the display includes the following information:

  UPD812709 Windows Me Q812709 Update

  To verify the individual files, consult the file manifest in Knowledge Base article 812709.

**Caveats:**

None

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) [Warning and Fozzy](https://www.thehackademy.net/) from The Hackademy for reporting this issue to us and working with us to protect customers.

**Support:**

* Microsoft Knowledge Base article 812709 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (February 26, 2003): Bulletin Created.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025


