=== Content from marc.info_089e244c_20250125_135447.html ===

```
[[prev in list](?l=ntbugtraq&m=105233587624464&w=2)] [[next in list](?l=ntbugtraq&m=105235141408409&w=2)] [[prev in thread](?l=bugtraq&m=105232913516488&w=2)] [next in thread]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    [Windows Media Player directory traversal vulnerability](?t=105232926400004&r=1&w=2)
From:       [Jouko Pynnonen <jouko () SOLUTIONS ! FI>](?a=97640797500002&r=1&w=2)
Date:       [2003-05-07 20:05:17](?l=ntbugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=ntbugtraq&m=105233960728901&q=mbox) or [body](?l=ntbugtraq&m=105233960728901&q=raw)]

OVERVIEW
========

Windows Media Player versions 7 and 8 are vulnerable to a directory
traversal attack when skin files (*.WMZ) are downloaded from Internet.
The vulnerability allows malicious users to upload an arbitrary file to
an arbitrary location when a victim user views a web page.

When Media Player 7 or 8 is installed, Internet Explorer opens skin files
without confirmation from the user. Thus, an attacker can exploit the
vulnerability when the victim visits a malicious web page. The ability to
upload files can be used to run arbitrary code on the victim system in
several ways.

As most other Internet Explorer vulnerabilites, this one can be exploited
via Outlook (Express) e-mail if the security zone setting is set to
"Internet zone". In recent versions, this is not the default case.

DETAILS
=======

When Internet Explorer encounters a document having the MIME type
"application/x-ms-wmz", it starts up wmplayer.exe with the "/layout"
command line switch which instructs Media Player to download a skin file
from the specified URL to the Media Player's Skins folder. To prevent
certain Internet based attacks, the program uses a random element in the
download path so that the exact file name of the downloaded skin file
can't be guessed by a potential attacker.

Due to a flaw in Media Player this measure can be circumvented with
hex-encoded backslashes in the URL. If an appropriate URL is crafted,
the exact download folder can be chosen.

If the filename doesn't end with ".WMZ", Media Player normally adds this
extension to the file. However, if the Content-disposition HTTP header is
used in a certain way, this restriction can be circumvented and also the
extension can be freely chosen. The attacker may thus place files with any
name and extension to any location on the local disks (and network shares
the user has access write access to). The attacker can not automatically
overwrite previously existing files; in this case a confirmation is asked
from the user.

There are numerous ways of exploiting this vulnerability to run arbitrary
code:

  * codebase related attacks can be done by placing a HTML help, Java
    applet, a script, or similar file to the local filesystem and
    redirect Internet Explorer to its location

  * a configuration file with malicious content might be uploaded for a
    program which by default doesn't have a configuration file

  * uploading a DLL or EXE file to a carefully chosen folder might cause
    Internet Explorer or other program to use the attacker-supplied DLL
    or EXE instead of the original file - e.g. a program might use a DLL
    uploaded to C:\WINNT instead of C:\WINNT\SYSTEM32 and vice versa.

  * the attacker may place programs in the Startup folder so that it
    would be started on the next reboot

Finding other attack vectors is left as an excercise to the reader. The
demonstration I set up for the vendor uploads a Java class file to
%SYSTEMROOT\Java\Trustlib\ and uses an applet tag to start it. The class
becomes "trusted" due to its location and is allowed to contain native
DLL calls. Now it can e.g. download an EXE program from Internet and
start it.

Windows Media Player version 9 doesn't seem to contain the flaw.

If Windows Media Player is not installed and a WMZ file is encountered,
Internet Explorer will usually suggest an automatic installation of
version 7 (Install on Demand).

SOLUTION
========

Microsoft was notified about the vulnerability on March 14, 2003. A
bulletin and patch correcting the issue has been released. They are
available at

  <http://www.microsoft.com/technet/security/bulletin/MS03-017.asp>

Microsoft has classified this vulnerability as critical.

It should be noted that changing File Types settings at My Computer ->
Tools -> Folder Options doesn't seem to work as an workaround. WMZ files
are opened automatically regardless of them. Disabling this behavior
can probably be done by manually editing the registry.

CREDITS
=======

The vulnerability was discovered by Jouko Pynnönen of Online Solutions
Ltd, Finland.

--
Jouko Pynnonen          Online Solutions Ltd       Secure your Linux -
jouko@solutions.fi      <http://www.solutions.fi>    <http://www.secmod.com>

oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
Delivery co-sponsored by IP3 Inc.
oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
SECURITY QUESTIONS? We've got answers...Apply for a scholarship and become
TICSA certified.

Do not miss your opportunity to discover solutions to what our participants
have identified as their top 5 IT Security Challenges. You will return to
work better prepared to put into place an effective security strategy
utilizing the latest security tools, bookmarks and URL's.

<<http://www.ip3seminars.com>>

oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
[[prev in list](?l=ntbugtraq&m=105233587624464&w=2)] [[next in list](?l=ntbugtraq&m=105235141408409&w=2)] [[prev in thread](?l=bugtraq&m=105232913516488&w=2)] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from marc.info_7829ed80_20250125_135445.html ===

```
[[prev in list](?l=bugtraq&m=105249565405242&w=2)] [[next in list](?l=bugtraq&m=105240402617651&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    why i love xs4all + mediaplayer thingie
From:       ["jelmer" <jelmer () kuperus ! xs4all ! nl>](?a=100378863800001&r=1&w=2)
Date:       [2003-05-08 0:57:19](?l=bugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=bugtraq&m=105240528419389&q=mbox) or [body](?l=bugtraq&m=105240528419389&q=raw)]

Why i love xs4all rant (you'll probably wanna skip this but i need to get
this out of my system):

    a few weeks back i was unpleasantly suprised by the fact that my
internet wasn't working
    the support desk employee after making me reset my modem a dozen times
and tripple checking
    my settings finaly found out that i had an abuse ticket.
    I supposedly portscanned (a harmless process) :S some poor guy who felt
the need to complain about it. They wouldn't tell me who
    it was when it happened or anything. being the second warning (over a 2
year!! period) they descided they
    had no other alternative then to shut me down. I am not aware of
anything i have done wrong, but i am not
    given any option to defend myself against the allergations, I dont just
randomly portscan people.

    In essense you are conficted without even hearing the evidence or being
apointed a lawyer.
    This is a really scary thought because in essence any of the following
situations will lead to cancelation of
    your account

    You activly seek out flaws in a website, you report them to a website
owner, he doesn't like this and rather than
    fix the problem notifies your ISP xs4all to complain about it. resulting
in cancelation of your account.
    You wont even know who complained because and explain the whole thing
because xs4all grants the complaining
    party anonimity

    You get hacked and someone uses your machine to do something nasty

    An online chatbuddy asks you to nmap his machine to see if the firewall
he set up is working properly
    after a while the friendship goes sour and just to piss you off he
reports the scanning.

    someone sends you an email containing all sorts of
    <img src="<http://www.mysite.com/login.asp?username=a>'or 1=1;--">
    kinda stuff, look xs4all!! he hacked my site , just look at my logs and
xs4all's connection logs
    will show the connections where made from your ip matching the
timestamps in the log

    probably a dozen other ways are possible, and there's no way to find out
what has been going on
    this shielding of the sources is ridiculous, what will i do tell the
world i nmapped him?
    well whoopdiedoo call out the witness protection program

    Particularly cute is the other day i see an interview with cor bosman
telling how xs4all
    founders where titled the hacker thread from holland etc
    I have a 4 letter acronym for him, you figure it out

Description :

    Windows Media Player allows you to play audio and video files
    locally stored and streamed from the Internet.
    It includes a visualizer, a jukebox, a media guide,
    an Internet radio tuner, and support for
    countless media formats and various external devices.
    There is is a flaw in Windows media player 7 and 8 that allows
    execution of arbitrary code
    Vulnerable versions are shipped by default with
    all recent windows distributions including 98 and 2000 and xp

Details :

    Windows media player skin (.WMZ) files are automaticly opened by
internet explorer
    As a security precaution they are placed in a folder with a random name
similar to this :

    C:\Program Files\Windows Media Player\Skins\004B1813

    However this can be trivially defeated by setting the following http
headers.

    Content-Disposition: filename=%2e%2e%5cjelmer.wmz
    Content-Type: application/download

    <content follows>

    %2e%2e%5cjelmer.wmz is the url encoded path ..\jelmer.wmz , windows
media player urldecodes this and the
    path becomes :

    C:\Program Files\Windows Media Player\Skins\004B1813\..\jelmer.wmz

    witch is equivilent to

    C:\Program Files\Windows Media Player\Skins\jelmer.wmz

    witch is a known location on the filesystem, witch is a "very bad thing"
(tm)
    to make matters worse we could append an urlencoded null byte to the
file name and "spoof" the extention
    like this

"%2e%2e%5c%2e%2e%5c%2e%2e%5c%2e%2e%5cDocuments%20and%20Settings%5CAll%20User
s%5CStart%20Menu%5CPrograms%5CStartup%5csomefile.exe%00.wmz

    witch drops an executable in the windows startup folder (on an english
xp system)

Systems affected :

    Both media player 7.1 and 8 are affected by the flaw, 9 proofed
unaffected

Example :

    I should have attached a sample exploit

Vendor status :

    Microsoft was notified 23-03-2003 and has issued a fix the details are
available at

<http://www.microsoft.com/technet/treeview/default.asp?url=/technet/security/bulletin/MS03-017.asp>
    Credit was shared because apperently Jouko reported the same issue at
aproximatly the same time

Solution :

    Update to the latest version of media player

[["MediaPlayerExploit.java" (application/octet-stream)]](?l=bugtraq&m=105240528419389&q=p3)

[[prev in list](?l=bugtraq&m=105249565405242&w=2)] [[next in list](?l=bugtraq&m=105240402617651&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from docs.microsoft.com_05c2ac75_20250125_135448.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-017.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-017 - Critical

## Flaw in Windows Media Player Skins Downloading could allow Code Execution (817787)

Published: May 07, 2003 | Updated: May 09, 2003

**Version:** 1.2

**Originally posted:** May 7, 2003

**Updated:** May 9, 2003

#### Summary

**Who should read this bulletin:**
Customers running Windows Media Player 7.1 and Windows Media Player for Windows XP (Version 8.0)

**Impact of vulnerability:**
Arbitrary code execution

**Maximum Severity Rating:**
Critical

**Recommendation:**
Customers running Windows Media Player 7.1 and Windows Media Player for Windows XP (Version 8) should apply the patch.

**Affected Software:**

* Microsoft Windows Media Player 7.1
* Microsoft Windows Media Player for Windows XP (Version 8.0)

### General Information

## Technical details

**Technical description:**

Microsoft Windows Media Player provides functionality to change the overall appearance of the player itself through the use of "skins". Skins are custom overlays that consist of collections of one or more files of computer art, organized by an XML file. The XML file tells Windows Media Player how to use these files to display a skin as the user interface. In this manner, the user can choose from a variety of standard skins, each one providing an additional visual experience. Windows Media Player comes with several skins to choose from, but it is relatively easy to create and distribute custom skins.

A flaw exists in the way Windows Media Player 7.1 and Windows Media Player for Windows XP handle the download of skin files. The flaw means that an attacker could force a file masquerading as a skin file into a known location on a user's machine. This could allow an attacker to place a malicious executable on the system.

In order to exploit this flaw, an attacker would have to host a malicious web site that contained a web page designed to exploit this particular vulnerability and then persuade a user to visit that site - an attacker would have no way to force a user to the site. An attacker could also embed the link in an HTML e-mail and send it to the user.

In the case of an e-mail borne attack, if the user was using Outlook Express 6.0 or Outlook 2002 in their default configurations, or Outlook 98 or 2000 in conjunction with the [Outlook Email Security Update](https://office.microsoft.com/downloads/2000/out2ksec.aspx), then an attack could not be automated and the user would still need to click on a URL sent in the e-mail. However if the user was not using Outlook Express 6.0 or Outlook 2002 in their default configurations, or Outlook 98 or 2000 in conjunction with the [Outlook Email Security Update](https://office.microsoft.com/downloads/2000/out2ksec.aspx), the attacker could cause an attack that could both place, then launch the malicious executable without the user having to click on a URL contained in an e-mail.

The attacker's code would run with the same privileges as the user: any restrictions on the user's ability to change the system would apply to the attacker's code.

**Mitigating factors:**

* Windows Media Player 9 Series is not affected by this issue.
* Windows Media Player 6.4 is not affected by this issue.
* By default, Outlook Express 6.0 and Outlook 2002 open HTML mails in the Restricted Sites Zone. In addition, Outlook 98 and 2000 open HTML mails in the Restricted Sites Zone if the [Outlook Email Security Update](https://office.microsoft.com/downloads/2000/out2ksec.aspx), has been installed. Customers who use any of these products would be at no risk from an e-mail borne attack that attempted to automatically exploit these vulnerabilities.
* The attacker would have no way to force users to visit a malicious web site. Instead, the attacker would need to lure them there, typically by getting them to click on a link that would take them to the attacker's site.

**Severity Rating:**

|  |  |
| --- | --- |
| **Windows Media Player 7.1** | **Critical** |
| **Windows Media Player for Windows XP** | **Critical** |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2003-0228](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0228)

**Tested Versions:**

Microsoft tested Windows Media Player 6.4, Windows Media Player 7.1, Windows Media Player for Windows XP and Windows Media Player 9.0 Series to assess whether they are affected by this vulnerability. Previous versions are no longer [supported](https://go.microsoft.com/fwlink/?linkid=21742), and may or may not be affected by these vulnerabilities.

## Frequently asked questions

**What's the scope of this vulnerability?**

This vulnerability, by itself, could allow an attacker to place a malicious file in a known location on the computer. However, if the user was not using Outlook Express 6.0 or Outlook 2002 in their default configurations, or Outlook 98 or 2000 in conjunction with the [Outlook Email Security Update](https://office.microsoft.com/downloads/2000/out2ksec.aspx), the attacker could cause an attack that could both place, then launch the malicious executable without the user having to click on a URL contained in an e-mail. This that could enable an attacker to run code on the system of a user. The code could then be able to take any actions on the system that the user was capable of.
The attacker's code would run with the same privileges as the user: any restrictions on the user's ability to change the system would apply to the attacker's code. For example, if the user were prevented from deleting files on the hard drive, the attacker's code would similarly be prevented. Conversely, if a user were using an account with high privileges such as an administrator's account, the attacker's code would also run the same high privileges.

**Does this vulnerability affect all versions on Windows Media Player?**

No, only Windows Media Player 7.1 and Windows Media Player for XP are affected. Windows Media Player 9.0 Series is not affected by this vulnerability, and versions prior to 7.1--such as Windows Media Player 6.4-- did not support skins.

**What causes the vulnerability?**

The vulnerability results because Windows Media Player 7.1 and Windows Media Player for XP do not correctly validate inputs when a skin file is being downloaded. Normally a skin file is downloaded to the Temporary Internet Files Folder and then copied into another non-predictable location. However the flaw permits a skin file - or a file masquerading as a skin - to be downloaded and copied into a predictable location.

**What is the Temporary Internet Files folder, and what is it used for?**

The Temporary Internet Files folder is the location on your hard disk where Web pages and files (such as graphics) are cached as you view them. This speeds up the display of pages you frequently visit or have already seen, because Internet Explorer can open them from your hard disk instead of from the Web. Obfuscation plays a vital role in ensuring that this cache is stored in a non-predictable location. By design, if a web site knows the physical location of a web page, then the web site operator could be able to learn more information about the user visiting their site. The cache prevents a web site from learning this information, thereby forcing it to submit to the Internet Explorer security model.

**What is the problem with a skin file being copied to a known location?**

The problem with this is that it would allow an attacker to place a malicious program into a known location. This could allow an attacker to subsequently execute that program as he or she would know were the program was located.

**What are "Skins"?**

[Skins](https://msdn2.microsoft.com/library/aa384824.aspx) are sets of scripts, art, media, and text files that can be combined to create a new appearance for Windows Media Player. Using skins, it is possible to change not only the way Windows Media Player looks, but how it functions.

**Is there a problem with "Skins"?**

No, the vulnerability does not lie in skin files. The flaw lies in the way skin files are downloaded.

**What's wrong with the way that Windows Media Player 7.1 and Windows Media Player for XP download skin files?**

There is a flaw in way that Windows Media Player 7.1 and Windows Media Player for XP download skins files. They do not correctly check URLs that is passed to them to initiate the download of a skin. As a result, a URL can be maliciously crafted that allows a file masquerading as a skin file to be copied to a location known to an attacker, rather than the Temporary Internet Files folder.

**What could this vulnerability enable an attacker to do?**

This vulnerability could enable an attacker to place a file of their choice into a known or predetermined location on the user's machine. If the file was then made to run, it could take any action desired by the attacker, in the context of the user's privileges on that machine.
Any limitation of the user's permissions on the machine would also be applied to the attackers program.

**How could an attacker exploit this vulnerability?**

An attacker could seek to exploit this vulnerability by creating a specially crafted URL that, when accessed, would cause a file to be downloaded and copied to a location of the attacker's choosing.
For example, if an attacker knew the location of the "Startup" folder on a user's machine, he may be able to cause the file to be downloaded directly into that folder. Because programs contained in the "Startup" folder automatically run when the machine starts up, an attacker could use this method to cause a malicious program or script to run on the machine.

**What does the patch do?**

The patch ensures that Windows Media Player 7.1 and Windows Media Player for Windows XP correctly validate URL's passed to it when downloading skins.

## Patch availability

**Download locations for this patch**

* Microsoft Windows Media Player 7.1:

  [https://www.microsoft.com/download/details.aspx?FamilyId=012F143A-
  77D1-4F6F-9338-5A6332614532&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=012f143a-77d1-4f6f-9338-5a6332614532&displaylang;=en)
* Microsoft Windows Media Player for Windows XP (Version 8.0):

  [https://www.microsoft.com/download/details.aspx?FamilyId=E311DF50-
  0633-4100-AB37-D7A68D51182F&displaylang;=en](https://www.microsoft.com/download/details.aspx?familyid=e311df50-0633-4100-ab37-d7a68d51182f&displaylang;=en)

#### Additional information about this patch

**Installation platforms:**

This patch can be installed on systems running

* Windows Media Player 7.1 on Win98, Win98SE, WinME, Win2k
* Windows Media Player for XP, WinXP

**Inclusion in future service packs:**

The fix for this issue will be included in Windows XP SP2.

**Reboot needed:** Reboot is not needed, unless the user has Windows Media Player loaded in the background when installing the patch.

**Patch can be uninstalled:** No

**Superseded patches:** None

**Verifying patch installation:**

* To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Media Player\wm817787
* To verify the individual files, use the date/time and version information provided in the following registry key:

  HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Media Player\wm817787\FileList

**Caveats:**

None

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) [Jouko Pynnonen](https://technet.microsoft.com/mailto%3Ajouko%40solutions.fi) of [Oy Online Solutions Ltd, Finland](https://www.solutions.fi/) and [Jelmer](https://technet.microsoft.com/mailto%3Ajelmer%40kuperus.xs4all.nl) for reporting this issue to us and working with us to protect customers.

**Support:**

* Microsoft Knowledge Base article 817787 discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/?scid=fh;en-us;kbhowto) web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 May 07, 2003 Bulletin Created.
* V1.2 May 09, 2003 Bulletin updated to clarify tested versions included Media Player 6.4, and specify that it is not affected by this vulnerability.

*Built at 2014-04-18T13:49:36Z-07:00*

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_b10910a2_20250125_135448.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#384932

## Microsoft Windows Media Player fails to properly evaluate URLs when downloading skin files

#### Vulnerability Note VU#384932

Original Release Date: 2003-05-07 | Last Revised: 2003-05-15

---

### Overview

Microsoft Media Player contains a vulnerability in the parsing of "Skin Files" that may permit a remote attacker to download arbitrary files to a known location on the local system.

### Description

| Microsoft Media Player is an application that plays various types of media files. The user can customize the appearance of Microsoft's Media Player through the use of skin files. Skin files can be created and downloaded from the Internet. Microsoft's Media Player uses XML to determine the location of these files.  A directory traversal vulnerability exists in Microsoft Media Player 7.1 (for Windows 98, 98SE, ME, 2000) and 8.0 (Windows XP) when parsing of an XML file specifying the location of a skin file. The XML parser fails to recognize hex encoded characters that can permit an attacker to exit the temporary directory, and place files in a known location on the system. Exploitation of this vulnerability may permit a remote attacker to download a malicious file to a known location on the local system or any mounted network drives that the current user has access to. These files may be programs, configuration files, or various other types of files. The attacker must trick the user into visiting the malicious website in order to exploit this vulnerability.For more details, please see Microsoft's Advisory [MS03-017](http://www.microsoft.com/technet/security/bulletin/MS03-017.asp). |
| --- |

### Impact

| A remote attacker may be able to download arbitrary files to the system in a known location. If the file is placed in the "Start Up" folder, or used in conjunction with other vulnerabilities (such as [VU#626395](http://www.kb.cert.org/vuls/id/626395), [VU#25249](http://www.kb.cert.org/vuls/id/25249) or [VU#489721](http://www.kb.cert.org/vuls/id/489721)), the attacker may then be able to execute arbitrary code on the system. |
| --- |

### Solution

| Microsoft has released patches for versions 7.1 and 8.0 in [MS03-017](http://www.microsoft.com/technet/security/bulletin/MS03-017.asp) to address this issue. |
| --- |

| Microsoft Media Player 9 is not affected by this vulnerability. |
| --- |

### Vendor Information

384932
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23384932/) to view vendors.**
### [Microsoft Corporation](#JARL-5MBQJS) Affected

Updated:  May 07, 2003

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

For more details, please see Microsoft's Advisory [MS03-017](http://www.microsoft.com/technet/security/bulletin/MS03-017.asp).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/MS03-017.asp>
* <http://www.microsoft.com/security/security_bulletins/ms03-017.asp>
* <http://www.securityfocus.com/archive/1/320811/2003-05-05/2003-05-11/0>
* <http://www.securityfocus.com/archive/1/320714/2003-05-05/2003-05-11/0>
* <http://www.iss.net/security_center/static/11953.php>
### Acknowledgements

Thanks to Jouko Pynnonen for reporting this vulnerability and Microsoft for addressing this issue.

This document was written by Jason A Rafail.

### Other Information

| **CVE IDs:** | [CVE-2003-0228](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0228) |
| --- | --- |
| **Severity Metric:** | 18.98 |
| **Date Public:** | 2003-05-07 |
| **Date First Published:** | 2003-05-07 |
| **Date Last Updated:** | 2003-05-15 15:57 UTC |
| **Document Revision:** | 21 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_ab4e88c2_20250125_135444.html ===

```
[[prev in list](?l=bugtraq&m=105232797614945&w=2)] [[next in list](?l=bugtraq&m=105233954728808&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=105233960728901&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [Windows Media Player directory traversal vulnerability](?t=105232926400004&r=1&w=2)
From:       [Jouko Pynnonen <jouko () solutions ! fi>](?a=97640797500002&r=1&w=2)
Date:       [2003-05-07 17:33:37](?l=bugtraq&r=1&w=2&b=200305)
[Download RAW [message](?l=bugtraq&m=105232913516488&q=mbox) or [body](?l=bugtraq&m=105232913516488&q=raw)]

OVERVIEW
========

Windows Media Player versions 7 and 8 are vulnerable to a directory
traversal attack when skin files (*.WMZ) are downloaded from Internet.
The vulnerability allows malicious users to upload an arbitrary file to
an arbitrary location when a victim user views a web page.

When Media Player 7 or 8 is installed, Internet Explorer opens skin files
without confirmation from the user. Thus, an attacker can exploit the
vulnerability when the victim visits a malicious web page. The ability to
upload files can be used to run arbitrary code on the victim system in
several ways.

As most other Internet Explorer vulnerabilites, this one can be exploited
via Outlook (Express) e-mail if the security zone setting is set to
"Internet zone". In recent versions, this is not the default case.

DETAILS
=======

When Internet Explorer encounters a document having the MIME type
"application/x-ms-wmz", it starts up wmplayer.exe with the "/layout"
command line switch which instructs Media Player to download a skin file
from the specified URL to the Media Player's Skins folder. To prevent
certain Internet based attacks, the program uses a random element in the
download path so that the exact file name of the downloaded skin file
can't be guessed by a potential attacker.

Due to a flaw in Media Player this measure can be circumvented with
hex-encoded backslashes in the URL. If an appropriate URL is crafted,
the exact download folder can be chosen.

If the filename doesn't end with ".WMZ", Media Player normally adds this
extension to the file. However, if the Content-disposition HTTP header is
used in a certain way, this restriction can be circumvented and also the
extension can be freely chosen. The attacker may thus place files with any
name and extension to any location on the local disks (and network shares
the user has access write access to). The attacker can not automatically
overwrite previously existing files; in this case a confirmation is asked
from the user.

There are numerous ways of exploiting this vulnerability to run arbitrary
code:

  * codebase related attacks can be done by placing a HTML help, Java
    applet, a script, or similar file to the local filesystem and
    redirect Internet Explorer to its location

  * a configuration file with malicious content might be uploaded for a
    program which by default doesn't have a configuration file

  * uploading a DLL or EXE file to a carefully chosen folder might cause
    Internet Explorer or other program to use the attacker-supplied DLL
    or EXE instead of the original file - e.g. a program might use a DLL
    uploaded to C:\WINNT instead of C:\WINNT\SYSTEM32 and vice versa.

  * the attacker may place programs in the Startup folder so that it
    would be started on the next reboot

Finding other attack vectors is left as an excercise to the reader. The
demonstration I set up for the vendor uploads a Java class file to
%SYSTEMROOT\Java\Trustlib\ and uses an applet tag to start it. The class
becomes "trusted" due to its location and is allowed to contain native
DLL calls. Now it can e.g. download an EXE program from Internet and
start it.

Windows Media Player version 9 doesn't seem to contain the flaw.

If Windows Media Player is not installed and a WMZ file is encountered,
Internet Explorer will usually suggest an automatic installation of
version 7 (Install on Demand).

SOLUTION
========

Microsoft was notified about the vulnerability on March 14, 2003. A
bulletin and patch correcting the issue has been released. They are
available at

  <http://www.microsoft.com/technet/security/bulletin/MS03-017.asp>

Microsoft has classified this vulnerability as critical.

It should be noted that changing File Types settings at My Computer ->
Tools -> Folder Options doesn't seem to work as an workaround. WMZ files
are opened automatically regardless of them. Disabling this behavior
can probably be done by manually editing the registry.

CREDITS
=======

The vulnerability was discovered by Jouko Pynnönen of Online Solutions
Ltd, Finland.

--
Jouko Pynnonen          Online Solutions Ltd       Secure your Linux -
jouko@solutions.fi      <http://www.solutions.fi>    <http://www.secmod.com>

[[prev in list](?l=bugtraq&m=105232797614945&w=2)] [[next in list](?l=bugtraq&m=105233954728808&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=105233960728901&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


