=== Content from www.kb.cert.org_2ab6283e_20250125_055808.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#561284

## Microsoft Windows DirectX MIDI library does not adequately validate Text or Copyright parameters in MIDI files

#### Vulnerability Note VU#561284

Original Release Date: 2003-07-24 | Last Revised: 2003-07-30

---

### Overview

A Microsoft Windows DirectX library, quartz.dll, does not properly validate certain parameters in Musical Instrument Digital Interface (MIDI) files. An attacker could exploit this vulnerability to execute arbitrary code or crash any application using the library, causing a denial of service.

### Description

| Microsoft Windows operating systems includes multimedia technologies called DirectX and DirectShow. From [MS03-030](http://www.microsoft.com/technet/security/bulletin/MS03-030.asp),  *DirectX consists of a set of low-level Application Programming Interfaces (APIs) that are used by Windows programs for multimedia support. Within DirectX, the DirectShow technology performs client-side audio and video sourcing, manipulation, and rendering.*DirectShow support for MIDI files is implemented in a library called quartz.dll. This library does not adequately validate the Text or Copyright parameters in MIDI files. As a result, a specially crafted MIDI file could cause an integer overflow, leading to heap memory corruption. Further technical details are available in eEye Digital Security advisory [AD20030723](http://www.eeye.com/html/Research/Advisories/AD20030723.html).Any application that uses DirectX/DirectShow to process MIDI files could be affected by this vulnerability. Of particular concern, Internet Explorer (IE) loads the vulnerable library to process MIDI files embedded in HTML documents. An attacker could therefore exploit this vulnerability by convincing a victim to view an HTML document (web page, HTML email message) containing an embedded MIDI file. Note that a number of applications (Outlook, Outlook Express, Eudora, AOL, Lotus Notes, Adobe PhotoDeluxe, others) use the IE HTML rendering engine (WebBrowser ActiveX control) to interpret HTML documents.A similar vulnerability in quartz.dll is documented in VU#265232. |
| --- |

### Impact

| By convincing a victim to access a specially crafted MIDI or HTML file, an attacker could execute arbitrary code with the privileges of the victim. The attacker could also cause a denial of service in anyapplication that uses the vulnerable library. |
| --- |

### Solution

| **Apply a patch or upgrade**Apply the appropriate patch as referenced in Microsoft Security Bulletin [MS03-030](http://www.microsoft.com/technet/security/bulletin/MS03-030.asp). The updated library (quartz.dll) is included in DirectX 9.0b and Service Pack 4 for Windows 2000. |
| --- |

| **Modify IE settings**It is possible to significantly limit the ability of IE to automatically load MIDI files from HTML documents by making all of the following modifications:     + Disable Active scripting + Disable Run ActiveX controls and plug-ins (stops <EMBED src=x.mid>) + Disable Play sounds in web pages (stops <BGSOUND src=x.mid>) + Disable Play videos in web pages (stops <IMG dynsrc=x.mid>)  The only complete solution for these vulnerabilities is to apply the patch. For example, Outlook Express 6 SP1 will play a MIDI file in an HTML email message regardless of the settings for audio and video in web pages. There may be other methods to automatically load a MIDI file from an HTML document. Also, these modifications will prevent some web pages from functioning properly. |
| --- |

### Vendor Information

561284
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23561284/) to view vendors.**
### [Microsoft Corporation](#AAMN-5PRTQR) Affected

Updated:  July 25, 2003

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Please see Microsoft Security Bulletin [MS03-030](http://www.microsoft.com/technet/security/bulletin/MS03-030.asp).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.eeye.com/html/Research/Advisories/AD20030723.html>
* <http://www.microsoft.com/technet/security/bulletin/MS03-030.asp>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;819696>
### Acknowledgements

This vulnerability was reported by eEye Digital Security. Information from eEye Digital Security advisory AD20030723 and Microsoft Security Bulletin MS03-030 was used to write this document.

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2003-0346](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0346) |
| --- | --- |
| **CERT Advisory:** | [CA-2003-18](http://www.cert.org/advisories/CA-2003-18.html) |
| **Severity Metric:** | 29.84 |
| **Date Public:** | 2003-07-23 |
| **Date First Published:** | 2003-07-24 |
| **Date Last Updated:** | 2003-07-30 17:12 UTC |
| **Document Revision:** | 33 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from docs.microsoft.com_9ca9ad29_20250125_055809.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-030.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-030 - Critical

## Unchecked Buffer in DirectX Could Enable System Compromise (819696)

Published: July 23, 2003 | Updated: June 16, 2004

**Version:** 2.2

**Originally posted:** July 23, 2003

**Updated:** June 16, 2004

#### Summary

**Who should read this bulletin:**
Customers using MicrosoftÂ® WindowsÂ®

**Impact of vulnerability:**
Allow an attacker to execute code on a user's system

**Maximum Severity Rating:**
Critical

**Recommendation:**
Customers should apply the security patch immediately

**Affected Software:**

* Microsoft DirectXÂ® 5.2 on Windows 98
* Microsoft DirectX 6.1 on Windows 98 SE
* Microsoft DirectX 7.1 on Windows Millennium Edition
* Microsoft DirectX 7.0 on Windows 2000
* Microsoft DirectX 8.0, 8.0a, 8.1, 8.1a, and 8.1b when installed on Windows 98, Windows 98 SE, Windows Millennium Edition or Windows 2000
* Microsoft DirectX 8.1 on Windows XP or Windows Server 2003
* Microsoft DirectX 9.0a when installed on Windows 98, Windows 98 SE, Windows Millennium Edition (Windows Me), Windows 2000, Windows XP, or Windows Server 2003
* Microsoft Windows NT 4.0 with either Windows Media Player 6.4 or Internet Explorer 6 Service Pack 1 installed
* Microsoft Windows NT 4.0, Terminal Server Edition with either Windows Media Player 6.4 or Internet Explorer 6 Service Pack 1 installed

An End User version of the bulletin is available at:
[https:](https://).

### General Information

## Technical details

**Technical description:**

Subsequent to the original release of this bulletin, customers requested that we support additional versions of DirectX that were not covered by the original patches. This bulletin has been updated to provide information about a new patch, which is intended for customers using Windows 98, Windows 98 SE, Windows Millennium Edition, or Windows 2000 who have upgraded to Microsoft DirectX 8.0, 8.0a, 8.1, 8.1a, or 8.1b.

DirectX consists of a set of low-level Application Programming Interfaces (APIs) that are used by Windows programs for multimedia support. Within DirectX, the DirectShow technology performs client-side audio and video sourcing, manipulation, and rendering.

There are two buffer overruns with identical effects in the function used by DirectShow to check parameters in a Musical Instrument Digital Interface (MIDI) file. A security vulnerability results because it could be possible for a malicious user to attempt to exploit these flaws and execute code in the security context of the logged-on user.

An attacker could seek to exploit this vulnerability by creating a specially crafted MIDI file designed to exploit this vulnerability and then host it on a Web site or on a network share, or send it by using an HTML-based e-mail. In the case where the file was hosted on a Web site or network share, the user would need to open the specially crafted file. If the file was embedded in a page the vulnerability could be exploited when a user visited the Web page. In the HTML-based e-mail case, the vulnerability could be exploited when a user opened or previewed the HTML-based e-mail. A successful attack could cause DirectShow, or an application making use of DirectShow, to fail. A successful attack could also cause an attacker's code to run on the user's computer in the security context of the user.

**Mitigating factors:**

* By default, Internet Explorer on Windows Server 2003 runs in [Enhanced Security Configuration](https://www.microsoft.com/download/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang;=en). This default configuration of Internet Explorer blocks the e-mail-based vector of this attack because Microsoft Outlook Express running on Windows Server 2003 by default reads e-mail in plain text. If Internet Explorer Enhanced Security Configuration were disabled, the protections put in place that prevent this vulnerability from being exploited would be removed.
* In the Web-based attack scenario, the attacker would have to host a Web site that contained a Web page used to exploit these vulnerabilities. An attacker would have no way to force users to visit a malicious Web site outside the HTML-based e-mail vector. Instead, the attacker would need to lure them there, typically by getting them to click a link that would take them to the attacker's site.
* The combination of the above means that on Windows Server 2003 an administrator browsing only to trusted sites should be safe from this vulnerability.
* Code executed on the system would only run under the privileges of the logged-on user.

**Severity Rating:**

|  |  |
| --- | --- |
| **Microsoft DirectX 9.0a** | Critical |
| **Microsoft DirectX 9.0a when installed on Windows Server 2003** | Important |
| **Microsoft DirectX 8.0, 8.0a, 8.1, 8.1a, and 8.1b, all versions except DirectX 8.1 on Windows Server 2003** | Critical |
| **Microsoft DirectX 8.1 on Windows Server 2003** | Important |
| **Microsoft DirectX 7.1 on Windows Millennium Edition** | Critical |
| **Microsoft DirectX 7.0 on Windows 2000** | Critical |
| **Microsoft Windows Media Player 6.4 or Internet Explorer 6 Service Pack 1 when installed on Windows NT 4.0** | Critical |
| **Microsoft Windows Media Player 6.4 or Internet Explorer 6 Service Pack 1 when installed on Windows NT 4.0, Terminal Server Edition** | Critical |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2003-0346](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0346)

**Tested Versions:**

Microsoft tested Microsoft DirectX 9.0a, Microsoft DirectX 8.1, Microsoft DirectX 7.0, Microsoft DirectX 7.0a on Windows Millennium Edition, DirectX 6.1 on Windows 98 SE, DirectX 5.2 on Windows 98, Microsoft Windows NT 4.0 with Windows Media Player 6.4 and Internet Explorer 6 Service Pack 1 installed, Microsoft Windows NT 4.0, Terminal Server Edition with Windows Media Player 6.4 and Internet Explorer 6 Service Pack 1 installed to assess whether they are affected by this vulnerability. Previous versions are no longer supported and may or may not be affected by this vulnerability

## Frequently asked questions

**Microsoft has issued a new patch for additional DirectX versions. Why?**

Subsequent to the original release of this bulletin, customers requested that we support additional versions of DirectX that were not covered by the original patches. Microsoft has updated the bulletin to provide details of these additional versions, which are listed in the "Affected Products" section of this bulletin, and to include download locations, which are listed in the "Patch availability" section of this bulletin.

**I have already installed the original patch. Do I need to install the new patch?**

No - the original patch is still effective in removing the security vulnerability. The new patch adds support for additional versions of DirectX and does not alter the original patch.

**What's the scope of this vulnerability?**

This is a [buffer overrun](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. An attacker who successfully exploited the vulnerability could, in the worst case, run code of his or her choice on a user's system. The attacker's code would run with the same privileges as the user: any restrictions on the user's ability to change the system would apply to the attacker's code. For example, if the user were prevented from deleting files on the hard disk, the attacker's code would similarly be prevented. Conversely, if a user were using an account with high privileges, such as an administrator's account, the attacker's code would also run with the same high privileges. The vulnerability exists in the component responsible for parsing MIDI files. This function is included in a component of DirectX known as DirectShow.

**What is DirectX?**

Microsoft DirectX is a software component that contains a set of APIs that provide access to graphics acceleration chips and sound cards and other types of media hardware. These APIs control low-level functions including: graphics acceleration, support for input devices (such as joysticks, keyboards, and mice) and control of sound mixing and sound output. One of the technologies included in DirectX is called DirectShow.

**What is DirectShow?**

The DirectShow technology included in DirectX performs client-side audio and video sourcing, manipulation and rendering. It supports several common media formats in addition to the affected MIDI file type, including Advanced Systems Format (ASF), Motion Picture Experts Group (MPEG), Audio-Video Interleaved (AVI), MPEG Audio Layer-3 (MP3), and WAV sound files.

**What are** **MIDI** **files?**

A MIDI file is a special type of media file that outlines how the music is produced (for example, on a digital synthesizer) instead of representing the musical sound directly as other media files do. This makes MIDI files much smaller than other audio files.

**Are other media file formats affected by this vulnerability?**

No. The vulnerability can only result when parsing specially crafted MIDI files. Other media files such as MPEG, MP3, WMV and AVI files are unaffected by this vulnerability.

**What's wrong with DirectShow?**

There are two buffer overruns with identical effects in the function used by DirectShow to check parameters in a MIDI (.MID) file. A security vulnerability results because it is possible for a malicious user to attempt to exploit this flaw to execute code in the security context of the logged-on user.

**If** **MIDI** **files are used by Windows Media and other technologies, does that mean there is a problem with Windows Media Player?**

No - The flaw is not in Windows Media Player. The flaw exists in DirectShow, and the way it checks the parameters of MIDI files. However, in the case of Windows NT 4.0, this technology was shipped in either Windows Media Player 6.4 or Internet Explorer 6 Service Pack 1.

**How could an attacker exploit this vulnerability?**

An attacker could seek to exploit this vulnerability by creating a specially crafted MIDI file and then taking one of several actions with it:

* Host the file on a Web site or network share. In this case, if a user were to click the link or file, the vulnerability could be exploited.
* If a user were to visit a Web site that had an embedded MIDI file, this could cause the vulnerability to be exploited.
* Create an HTML-based e-mail message with a link to a Web page or a share that contained the file. If the user viewed the message in the preview pane or opened the message, the vulnerability could be exploited. In addition, an attacker could create an e-mail message with a link to a Web page or a share that contained the file, along with a suggestion that the user click the link.
* Finally, an attacker could send a malformed MIDI file by using e-mail. An attacker could attach the file to an e-mail message and send it to a user with a suggestion that the user save the file on their system and then play it.

**What could this vulnerability enable an attacker to do?**

Successfully exploiting this vulnerability could, in the worst case, enable an attacker to run code of his or her choice on the user's system. Because DirectX runs in the context of the user, the attacker's code would also run as the user. Any limitations on the user's ability to delete, add, or modify data or configuration information would also be applied to the attacker's code.

**Why is Windows NT 4.0 vulnerable only when either Windows Media Player 6.4 or Internet Explorer 6 Service Pack 1 have been installed?**

The file that contains the vulnerability is not installed, by default, on Windows NT 4.0. However, this file is installed when either Windows Media Player 6.4 or Internet Explorer 6 Service Pack 1 are installed on Windows NT 4.0.

**I am running Internet Explorer on Windows Server 2003. Does this mitigate this vulnerability?**

Yes. By default, Internet Explorer on Windows Server 2003 runs in a restricted mode known as Enhanced Security Configuration. In this configuration, Internet Explorer prevents the automatic exploitation of this vulnerability through Outlook Express without user interaction. This is done by setting Outlook Express to read e-mail as plain text as the default.

**What is Internet Explorer Enhanced Security Configuration?**

Internet Explorer Enhanced Security Configuration is a group of preconfigured Internet Explorer settings that reduce the likelihood of a user or an administrator downloading and running malicious Web content on a server. Internet Explorer Enhanced Security Configuration reduces this risk by modifying numerous security-related settings, including **Security** tab and **Advanced** tab settings in the **Internet Options** dialog box.
Disabling Internet Explorer Enhanced Security Configuration would remove the protections put in place that prevent these vulnerabilities from being exploited. For more information regarding Internet Explorer Enhanced Security Configuration, please consult the Managing Internet Explorer Enhanced Security Configuration guide, which can be found at the following location: [https://www.microsoft.com/download/details.aspx?FamilyID=d41b036c-e2e1-4960-99bb-9757f7e9e31b&DisplayLang;=en](https://www.microsoft.com/download/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang;=en)

**Is there any configuration of Windows Server 2003 that is likely to have Internet Explorer Enhanced Security Configuration disabled?**

Yes. Systems administrators who have deployed Windows Server 2003 as a Terminal Server would likely disable Internet Explorer Enhanced Security Configuration to allow users of the Terminal Server to use Internet Explorer in an unrestricted mode.

**How do I know which version of DirectX I have installed?**

To check which version of DirectX that is installed on you system you need to run the Dxdiag.exe command-line utility.

1. On the taskbar at the bottom of your screen, click **Start**, and then click **Run**.
2. In the **Run** dialog box, type **dxdiag**
3. Click **OK**.
4. On the **System** tab of the dialog box that appears, under **System Information**, the version of DirectX appears.

**I am running Windows NT 4.0. How do I know if I need to apply the patch?**

For Windows NT 4.0, the patch should be applied if the following key is present and equal to 1: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\ActiveSetup\InstalledComponents\{22d6f312-b0f6-11d0-94ab-0080c74c7e95}\IsInstalled

**What does the patch do?**

The patch eliminates the vulnerability by ensuring that DirectX correctly validates parameters when opening a MIDI file.

## Patch availability

**Download locations for this patch**

* Microsoft DirectX 5.2, DirectX 6.1 and DirectX 7.1 on [Windows 98, Windows 98 SE and Windows Millennium Edition](https://www.microsoft.com/windows/directx/) respectively
* Microsoft DirectX 7.0 on [Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=7d0e4787-a993-4c49-a5a7-9a6de8efdb9e&displaylang;=en)
* Microsoft DirectX 8.0, Direct X8.0a, DirectX 8.1, DirectX 8.1a, and DirectX 8.1b on [Windows 98, Windows 98 SE, Windows Millennium Edition, or Windows 2000](https://www.microsoft.com/download/details.aspx?familyid=49552d6a-4a62-48ba-a2ac-0b237cd5f732&displaylang;=en)

  **Note:** This update will be available via Windows Update at a later date.
* Microsoft DirectX 8.1 on [Windows XP 32-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=5aba6a3b-f67b-4b18-b4b5-62e69a0104ce&displaylang;=en)
* Microsoft DirectX 8.1 on [Windows XP 64-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=8f23f7af-5317-4502-8b17-7c1a2139ebdc&displaylang;=en)
* Microsoft DirectX 8.1 on [Windows Server 2003 32-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=a5156ff8-1812-4db4-9175-bf9ca370279d&displaylang;=en)
* Microsoft DirectX 8.1 on [Windows Server 2003 64-bit Edition](https://www.microsoft.com/download/details.aspx?familyid=59732fcf-993a-45e8-8ba4-064575055d86&displaylang;=en)
* Microsoft DirectX 9.0a: [All Windows versions except Windows NT 4.0](https://www.microsoft.com/download/details.aspx?familyid=22f990cb-e9f9-4670-8b4f-ac4f6f66c3a2&displaylang;=en)
* [Microsoft Windows NT 4.0](https://www.microsoft.com/download/details.aspx?familyid=b42c5bcb-6d36-437d-a07e-053b72b1c652&displaylang;=en)
* [Microsoft Windows NT 4.0, Terminal Server Edition](https://www.microsoft.com/download/details.aspx?familyid=14290ad7-ee7d-4736-8322-bca4cbd7d7c5&displaylang;=en)

  **Note:** DirectX 9.0b has been released at the same time as this security bulletin and contains the security fix discussed in the security bulletin. DirectX 9.0b, or later, can be installed on all supported versions of Windows except Windows NT 4.0 and can be downloaded from the following location:
* [All Windows versions except Windows NT 4.0](https://www.microsoft.com/windows/directx/)

#### Additional information about this patch

**Installation platforms:**

DirectX 9.0b can be installed on systems running:

* Windows 98
* Windows 98 SE
* Windows Millennium Edition
* Windows 2000 [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx)
* Windows XP Gold
* Windows XP [Service Pack 1](https://www.microsoft.com/technet/archive/security/news/wxpsp1s.mspx)
* Windows Server 2003

The patch for DirectX 9.0a can be installed on systems running:

* Windows 98
* Windows 98 SE
* Windows Millennium Edition
* Windows 2000 [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx)
* Windows XP Gold
* Windows XP [Service Pack 1](https://www.microsoft.com/technet/archive/security/news/wxpsp1s.mspx)
* Windows Server 2003

The patch for DirectX 8.1 can be installed on systems running:

* Windows XP Gold
* Windows XP [Service Pack 1](https://www.microsoft.com/technet/archive/security/news/wxpsp1s.mspx)
* Windows Server 2003 Gold

The patch for Direct X8.0a, DirectX 8.1, DirectX 8.1a, and DirectX 8.1b can be installed on systems running:

* Windows 98
* Windows 98 SE
* Windows Millennium Edition
* Windows 2000 [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx) and [Service Pack 2](https://www.microsoft.com/windows2000/downloads/servicepacks/sp2/default.mspx)

The patch for DirectX 7.0 can be installed on systems running:

* Windows 2000 [Service Pack 3](https://www.microsoft.com/windows2000/downloads/servicepacks/sp3/default.mspx)

The patch for Windows NT 4.0 can be installed on systems running:

* Windows NT 4 [Service Pack 6a](https://support.microsoft.com/kb/241211)
* Windows NT 4 [Service Pack 6](https://www.microsoft.com/download/details.aspx?familyid=7ad5e590-56c5-49c2-bfb9-e5bb988f1ac7&displaylang;=en?lnk=1), Terminal Server Edition

**Inclusion in future service packs:**

The fix for this issue is included in Windows 2000 [Service Pack 4](https://www.microsoft.com/windows2000/downloads/servicepacks/sp4/default.mspx).

**Note** The Quartz.dll file included in Windows 2000 Service Pack 4, versioned 6.1.9.728, contains the update for MS03-030. It is the same file as version 6.1.9.729 included in the security update.

The fix for this issue will be included in the following Service Packs:

* Windows XP Service Pack 2
* Windows Server 2003 Service Pack 1

**Reboot needed:** Yes

**Patch can be uninstalled:**

* DirectX 9.0b: No
* DirectX 9.0a patch: No
* DirectX 8.1 patch on Windows XP or Windows Server 2003: Yes
* DirectX 8.0, DirectX 8.0a, DirectX 8.1, DirectX 8.1a, and DirectX 8.1b patch on Windows 98, Windows 98 SE, Windows Millennium Edition or Windows 2000: No
* DirectX 7.1 patch: Yes
* Windows NT 4.0 patch: Yes

**Superseded patches:** None.

**Verifying patch installation:**

* Windows Server 2003: To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP1\KB819696 To verify the individual files, use the date/time and version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows Server 2003\SP1\KB819696\Filelist
* Windows XP Gold: To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q819696 To verify the individual files, use the date/time and version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP1\Q819696\Filelist
* Windows XP Service Pack 1: To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP2\Q819696 To verify the individual files, use the date/time and version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows XP\SP2\Q819696\Filelist
* Windows 2000 Service Pack 2: To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB819696 To verify the individual files, use the date/time and version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB819696\Filelist
* Windows 2000 Service Pack 3: To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB819696 To verify the individual files, use the date/time and version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB819696\Filelist
* Windows NT 4.0 Service Pack 6a: To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\Q819696
* Windows NT 4.0 Service Pack 6 Terminal Server Edition: To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Hotfix\Q819696
* Windows Server 2003, Windows XP Gold, Windows XP Service Pack 1, Windows 2000 Service Pack 3, Windows Millennium Edition, Windows 98, or Windows 98 Second Edition with DirectX 9.0a: To verify that the DirectX 9.0a patch has been installed on the machine, confirm that the following registry key has been created and has a value of 1: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\DirectX\dx819696\IsInstalled To verify the individual files, use the version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\DirectX\dx819696\Filelist
* Windows 2000 Service Pack 3, Windows Millennium Edition, Windows 98, or Windows 98 Second Edition with DirectX 8.0 through DirectX 8.1b: To verify that the DirectX 8 patch has been installed on the machine, confirm that the following registry key has been created and has a value of 1: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\DirectX\dx819696\IsInstalled To verify the individual files, use the version information provided in the following registry key: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\DirectX\dx819696\Filelist
* For all DirectX 9.0b updates:

  To verify that the patch has been installed on the machine, confirm that the following registry key has been created on the machine: HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\DirectX\Version If 9.0b is actually installed, the value will be 4.09.00.0902.

  To verify the individual files, use the **File List** tab of the Dxdiag.exe command-line utility.

  1. On the taskbar at the bottom of your screen, click **Start**, and then click **Run**.
  2. In the **Run** dialog box, type **dxdiag**
  3. Click **OK**.
  4. Click the **DirectX Files** tab of the dialog box that appears to display the file manifest of DirectX.

**Caveats:**

None

**Localization:**

Localized versions of this patch are available at the locations discussed in "Patch Availability".

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [WindowsUpdate](https://windowsupdate.microsoft.com/) web site

#### Other information:

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) [eEye Digital Security](https://www.eeye.com/) for reporting this issue to us and working with us to help protect customers

**Support:**

* Microsoft Knowledge Base article [819696](https://support.microsoft.com/default.aspx?scid=kb;en-us;819696) discusses this issue and will be available approximately 24 hours after the release of this bulletin. Knowledge Base articles can be found on the [Microsoft Online Support](https://support.microsoft.com/default.aspx?scid=fh;en-us;kbhowto&sd;=gn&ln;=en-us) Web site.
* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0). There is no charge for support calls associated with security patches.

**Security Resources:** The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 (July 23, 2003): Bulletin Created.
* V1.1 (July 23, 2003): Fixed Download Link for Windows NT 4.
* V1.2 (July 23, 2003): Updated Download Links in Patch Availability section.
* V2.0 (August 20, 2003): Updated to include details of an additional patch for versions of DirectX.
* V2.1 (August 20, 2003): Added clarification regarding additional patch in Technical description section.
* V2.2 (June 16, 2004): Added clarification regarding file versions in Windows 2000 Service Pack 4 in the Patch Availability section.

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.cert.org_3836aeb5_20250125_055807.html ===


search

icon-carat-right

cmu-wordmark

[Carnegie Mellon University](https://www.cmu.edu)

# [Software Engineering Institute](/)

##

1. [SEI](/)
2. [About](/about/)
3. [Divisions](/about/divisions/)
4. The CERT Division

## The CERT Division

The CERT Division is a leader in cybersecurity. We partner with government, industry, law enforcement, and academia to improve the security and resilience of computer systems and networks. We study problems that have widespread cybersecurity implications and develop advanced methods and tools to counter large-scale, sophisticated cyber threats.

* [Leadership](/about/divisions/cert/index.cfm#leadership)
* [What We Do](/about/divisions/cert/index.cfm#cert-division-what-we-do)
* [Careers in the CERT Division](/about/divisions/cert/index.cfm#careers)
* [Recent Vulnerabilities](/about/divisions/cert/index.cfm#CERTRecentlyPublishedVulnerabilityNotes)
* [Case Studies](/about/divisions/cert/index.cfm#case-studies)
* [History](/about/divisions/cert/index.cfm#history)

## Leadership

[![Gregory J. Touhill](/sei-images/images/Touhill_Greg_393_2023_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=314857)
#### [Gregory J. Touhill](/about/leadership/display.cfm?customel_datapageid_2623=314857)

Director, CERT Division

[![William Wilson](/sei-images/images/Wilson_William_324_200113_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=3871)
#### [William Wilson](/about/leadership/display.cfm?customel_datapageid_2623=3871)

Deputy Director, CERT Division

[![Chris Inacio](/sei-images/images/inacio-chris-96_2622.jpg)](/about/leadership/display.cfm?customel_datapageid_2623=494689)
#### [Chris Inacio](/about/leadership/display.cfm?customel_datapageid_2623=494689)

Chief Engineer, CERT Division

## What We Do

CERT experts are a diverse group of researchers, software engineers, security analysts, and digital intelligence specialists working together to research security vulnerabilities in software products, contribute to long-term changes in networked systems, and develop cutting-edge information and training to improve the practice of cybersecurity.

Our connection to the internationally known [Carnegie Mellon University](https://www.cmu.edu/) creates multidisciplinary collaboration opportunities and amplifies our research abilities.

#### Autonomy Security and Resilience

Develop and sustain security, resilience, and assurance best practices for the development, construction, and employment of machine learning systems.

#### [Cybersecurity Center Development](https://www.sei.cmu.edu/our-work/cybersecurity-center-development/index.cfm)

Develop measurable and repeatable practices to prepare CSIRTs and other operational security organizations.

#### [Cybersecurity Engineering](https://www.sei.cmu.edu/our-work/cybersecurity-engineering/index.cfm)

Develop methods for engineering mission-essential capabilities that balance security and resiliency with mission performance.

#### [Cyber Workforce Development](https://www.sei.cmu.edu/our-work/cyber-workforce-development/index.cfm)

Develop and maintain a well-equipped cyber workforce that is immediately able to support the cybersecurity needs of organizations.

#### [Enterprise Risk and Resilience Management](https://www.sei.cmu.edu/our-work/enterprise-risk-resilience-management/index.cfm)

Develop measurable practices and frameworks that enable organizations to measure and mitigate risks.

#### [Insider Threat](https://www.sei.cmu.edu/our-work/insider-threat/index.cfm)

Detect and mitigate the impact of insider threats and reduce their occurrence in organizations.

#### [Reverse Engineering for Malware Analysis](https://www.sei.cmu.edu/our-work/reverse-engineering-for-malware-analysis/index.cfm)

Develop tools and methods to identify and mitigate code that causes unintended effects in software systems.

#### [Situational Awareness](https://www.sei.cmu.edu/our-work/situational-awareness/index.cfm)

Analyze the cyber terrain as it evolves to characterize assets at risk, measure adversary activity, and prioritize responses to threat.

#### [Secure Development](https://www.sei.cmu.edu/our-work/secure-development/index.cfm)

Assess platforms through the analysis of source code to assure they adhere to security best practices.

#### [System and Platform Evaluation](https://www.sei.cmu.edu/our-work/projects/display.cfm?customel_datapageid_4050=21361)

Assess software, devices, systems, and platforms of unknown design or origin to find vulnerabilities and strategies for defending against possible attacks.

#### [Security Vulnerabilities](https://www.sei.cmu.edu/our-work/security-vulnerabilities/index.cfm)

Reduce exposure to known vulnerabilities in systems.

* ## Careers in the CERT Division

#### [Cyber Risk Intern](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cyber-Risk-Intern_2022294-1)

Pittsburgh, PA

#### [Senior Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Software-Engineer_2020922-1)

Pittsburgh, PA

#### [Associate Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Associate-Research-Scientist---Quantum_2021979)

Pittsburgh, PA

#### [Documentation Specialist and Content Strategist](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Documentation-Specialist-and-Content-Strategist_2022203-1)

Pittsburgh, PA

#### [Senior Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Communications-Engineer_2022179-1)

Pittsburgh, PA

#### [Senior AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-AI-Security-Researcher_2021569-1)

Pittsburgh, PA

#### [Technical Manager - Cybersecurity Assurance Team](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Technical-Manager---Cybersecurity-Assurance-Team_2022101-1)

2 Locations

#### [Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/System-Designer_2017276)

Pittsburgh, PA

#### [AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/AI-Security-Researcher_2020107)

Pittsburgh, PA

#### [Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Vulnerability-Researcher_2019726-1)

Pittsburgh, PA

#### [Senior Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Vulnerability-Researcher_2020002-1)

Pittsburgh, PA

#### [Assistant Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Assistant-Communications-Engineer_2021848-2)

Pittsburgh, PA

#### [Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Research-Scientist---Quantum_2021633-1)

Pittsburgh, PA

#### [Senior Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Research-Scientist---Quantum_2021632)

Pittsburgh, PA

#### [Cybersecurity Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cybersecurity-Engineer_2020646-1)

2 Locations

[SEE ALL SEI JOB OPENINGS](https://cmu.wd5.myworkdayjobs.com/en-US/SEI/)

## Recently Published Vulnerabilities

#### [VU#199397: Insecure Implementation of Tunneling Protocols (GRE/IPIP/4in6/6in4)](https://kb.cert.org/vuls/id/199397)

###### January 17, 2025

#### [VU#952657: Rsync contains six vulnerabilities](https://kb.cert.org/vuls/id/952657)

###### January 14, 2025

#### [VU#529659: Howyar Reloader UEFI bootloader vulnerable to unsigned software execution](https://kb.cert.org/vuls/id/529659)

###### January 14, 2025

[More Vulnerabilities](https://www.kb.cert.org/vuls)
[Report a Vulnerability](https://www.kb.cert.org/vuls/report/)

## Case Studies

[![Cyber Lightning Case Study](/sei-images/images/thumb_mid_thumb_cyber-lightning_380x380_1_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)
#### [Cyber Lightning Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

The SEI hosted Cyber Lightning, a three-day joint training exercise involving Air National Guard and Air Force Reserve units from western Pennsylvania and eastern Ohio.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

[![SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/sei-images/images/thumb_mid_thumb_crisis-simulation_380x380_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)
#### [SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

In SEI crisis simulation exercises, participants use scenarios that present fictitious malicious actors and environmental factors based on real-world events.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

[![USPS Case Study](/sei-images/images/thumb_standard_thumb_usps-improves-its-cybersecurity-and-resilience_260x260_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)
#### [USPS Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

The SEI teamed with the U.S. Postal Service to help it improve its cybersecurity and resilience and collaborated on a program to develop a strong cybersecurity workforce.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

## History

The CERT Division is the birthplace of cybersecurity. For nearly 30 years, the CERT Division of the SEI has partnered with government, industry, law enforcement, and academia to advance cybersecurity and improve the security and resilience of computer systems and networks.

Originally focused on incident response, we have expanded into cybersecurity areas such as network situational awareness, malicious code analysis, secure coding, resilience management, insider threats, digital investigations and intelligence, workforce development, DevOps, forensics, software assurance, vulnerability discovery and analysis, and risk management.

     ![The CERT Division - Barbara Fraser and Ed DeHart](/sei-images/images/about-divisions-cert-history-aside-144-2_2134.jpg "The CERT Division - Barbara Fraser and Ed DeHart")   Barbara Fraser and Ed DeHart, part of the SEI’s CERT/CC in the early 1990s

## Former Director Richard Pethia

[Richard Pethia](/about/leadership/display.cfm?customel_datapageid_2623=3545) was founding director of the SEI's CERT Division. Pethia, who served as director of CERT from 1988 to 2016, guided the organization through tremendous growth and change. Under Pethia's leadership, the unit expanded and evolved from the CERT Coordination Center—a small group focused on computer incident response—to a research organization of more than 200 professionals dedicated to solving problems with widespread cybersecurity implications.

[SEE FULL PROFILE](/about/leadership/display.cfm?customel_datapageid_2623=3545)

     ![Former Director Richard Pethia](/sei-images/images/about-divisions-cert-pethia-aside-144-2_2159.jpg "Former Director Richard Pethia")

## Related Links

* [CERT Podcast Series](http://www.cert.org/podcasts/index.cfm)
* [CERT/CC Blog Series](http://insights.sei.cmu.edu/cert)
* [Computer Security Incident Response Teams](/education-outreach/computer-security-incident-response-teams/index.cfm)

* [FloCon](https://resources.sei.cmu.edu/news-events/events/flocon)
* [Insider Threat Blog Series](https://insights.sei.cmu.edu/insider-threat)
* [Insider Threat Symposium](https://www.eventbrite.com/e/2017-cert-insider-threat-symposium-registration-31893497309)

* [NatCSIRT Meeting](https://resources.sei.cmu.edu/news-events/events/natcsirt/index.cfm)
* [Vulnerability Database](https://www.kb.cert.org/vuls)

[Report a Vulnerability to CERT/CC](https://www.kb.cert.org/vuls/report/)
[Subscribe to SEI Bulletin](/subscribe-to-sei-bulletin/)
[Request Permission to Use SEI Materials](/legal/request-permission-to-use-sei-material)

Carnegie Mellon University
 Software Engineering Institute
 4500 Fifth Avenue
 Pittsburgh, PA 15213-2612
 412-268-5800

 [  [Facebook](https://www.facebook.com/SEICMU/)  |  [Twitter](https://twitter.com/SEI_CMU)  |  [LinkedIn](https://www.linkedin.com/company/software-engineering-institute)  |  [YouTube](https://www.youtube.com/user/TheSEICMU)  |  [iTunes](https://itunes.apple.com/us/podcast/software-engineering-institute-sei-podcast-series/id566573552?mt=2)  ]

[Contact Us](/contact-us/)

 [  [Office Locations](/locations/index.cfm)  |  [Additional Sites Directory](/additional-sites-directory/index.cfm)  |  [Legal](/legal/index.cfm)  |  [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm)  |  [CMU Ethics Hotline](https://www.cmu.edu/hr/resources/ethics-hotline.html)  |  [www.sei.cmu.edu](/index.cfm)  ]

©2025 Carnegie Mellon University



=== Content from www.kb.cert.org_cb7a7a06_20250125_055807.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#265232

## Microsoft Windows DirectX MIDI library does not adequately validate MThd track values in MIDI files

#### Vulnerability Note VU#265232

Original Release Date: 2003-07-25 | Last Revised: 2003-07-30

---

### Overview

A Microsoft Windows DirectX library, quartz.dll, does not properly validate the number of tracks value in Musical Instrument Digital Interface (MIDI) files. An attacker could exploit this vulnerability to execute arbitrary code or crash any application using the library, causing a denial of service.

### Description

| Microsoft Windows operating systems includes multimedia technologies called DirectX and DirectShow. From [MS03-030](http://www.microsoft.com/technet/security/bulletin/MS03-030.asp),  *DirectX consists of a set of low-level Application Programming Interfaces (APIs) that are used by Windows programs for multimedia support. Within DirectX, the DirectShow technology performs client-side audio and video sourcing, manipulation, and rendering.*DirectShow support for MIDI files is implemented in a library called quartz.dll. This library does not adequately validate the tracks value in the MThd section of MIDI files. As a result, a specially crafted MIDI file could cause an integer overflow, leading to heap memory corruption. Further technical details are available in eEye Digital Security advisory [AD20030723](http://www.eeye.com/html/Research/Advisories/AD20030723.html).Any application that uses DirectX/DirectShow to process MIDI files could be affected by this vulnerability. Of particular concern, Internet Explorer (IE) loads the vulnerable library to process MIDI files embedded in HTML documents. An attacker could therefore exploit this vulnerability by convincing a victim to view an HTML document (web page, HTML email message) containing an embedded MIDI file. Note that a number of applications (Outlook, Outlook Express, Eudora, AOL, Lotus Notes, Adobe PhotoDeluxe, others) use the IE HTML rendering engine (WebBrowser ActiveX control) to interpret HTML documents.A similar vulnerability in quartz.dll is documented in VU#561284. |
| --- |

### Impact

| By convincing a victim to access a specially crafted MIDI or HTML file, an attacker could execute arbitrary code with the privileges of the victim. The attacker could also cause a denial of service in any application that uses the vulnerable library. |
| --- |

### Solution

| **Apply a patch or upgrade**Apply the appropriate patch as referenced in Microsoft Security Bulletin [MS03-030](http://www.microsoft.com/technet/security/bulletin/MS03-030.asp). The updated library (quartz.dll) is included in DirectX 9.0b and Service Pack 4 for Windows 2000. eEye notes that Windows Server 2003 is not vulnerable. |
| --- |

| **Modify IE settings**It is possible to significantly limit the ability of IE to automatically load MIDI files from HTML documents by making all of the following modifications:     + Disable Active scripting + Disable Run ActiveX controls and plug-ins (stops <EMBED src=x.mid>) + Disable Play sounds in web pages (stops <BGSOUND src=x.mid>) + Disable Play videos in web pages (stops <IMG dynsrc=x.mid>)  The only complete solution for these vulnerabilities is to apply the patch. For example, Outlook Express 6 SP1 will play a MIDI file in an HTML email message regardless of the settings for audio and video in web pages. There may be other methods to automatically load a MIDI file from an HTML document. Also, these modifications will prevent some web pages from functioning properly. |
| --- |

### Vendor Information

265232
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23265232/) to view vendors.**
### [Microsoft Corporation](#AAMN-5PS9FK) Affected

Updated:  July 25, 2003

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Please see Microsoft Security Bulletin [MS03-030](http://www.microsoft.com/technet/security/bulletin/MS03-030.asp).

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.eeye.com/html/Research/Advisories/AD20030723.html>
* <http://www.microsoft.com/technet/security/bulletin/MS03-030.asp>
* <http://support.microsoft.com/default.aspx?scid=kb;en-us;819696>
### Acknowledgements

This vulnerability was reported by eEye Digital Security. Information from eEye Digital Security advisory AD20030723 and Microsoft Security Bulletin MS03-030 was used to write this document.

This document was written by Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2003-0346](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0346) |
| --- | --- |
| **CERT Advisory:** | [CA-2003-18](http://www.cert.org/advisories/CA-2003-18.html) |
| **Severity Metric:** | 29.84 |
| **Date Public:** | 2003-07-23 |
| **Date First Published:** | 2003-07-25 |
| **Date Last Updated:** | 2003-07-30 17:12 UTC |
| **Document Revision:** | 23 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from marc.info_cc664591_20250125_055805.html ===

```
[[prev in list](?l=bugtraq&m=105899636522679&w=2)] [[next in list](?l=bugtraq&m=105899875225268&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=105906262614435&w=2)]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    [EEYE: Windows MIDI Decoder (QUARTZ.DLL) Heap Corruption](?t=105899763500004&r=1&w=2)
From:       ["Derek Soeder" <dsoeder () eeye ! com>](?a=105476395900001&r=1&w=2)
Date:       [2003-07-23 21:49:42](?l=bugtraq&r=1&w=2&b=200307)
[Download RAW [message](?l=bugtraq&m=105899759824008&q=mbox) or [body](?l=bugtraq&m=105899759824008&q=raw)]

Windows MIDI Decoder (QUARTZ.DLL) Heap Corruption

Release Date:
July 23, 2003

Severity:
High (Remote Code Execution)

Systems Affected:
Windows 98
Windows 98 SE
Windows Millennium Edition
Windows NT 4.0
Windows NT 4.0, Terminal Server Edition
Windows 2000
Windows XP
Windows Server 2003

Description:
A little over six hundred years ago, in a quaint German hamlet called
Hamelin, the Pied Piper proved to the townsfolk that he could take control
of their rodents and children with just a song.  Turns out the same thing
works on Windows.

Microsoft provides a component called QUARTZ.DLL that allows Windows
applications to play MIDI music through a common  interface.  Windows Media
Player and Internet Explorer, for example, both use QUARTZ.DLL to play MIDI
music files (.mid  extension); in the case of Internet Explorer, MIDI files
can be played automatically when a web page is visited through the use of a
specific HTML tag.

eEye Digital Security has discovered a pair of flaws in all versions of
QUARTZ.DLL that would allow a specially-crafted MIDI file to cause the
execution of arbitrary code when played.  In the worst case, an attacker
could construct a malicious .mid  file and have it play automatically
whenever a victim attempts to view certain HTML, such as an
attacker-controlled website, resulting in the compromise of the victim's
machine.

Technical Description:
Modern folklore contends that some bands used to inject subliminal messages
into their music by recording spoken commands or phrases and dubbing them
backwards into the track.  Although these allegations and the effectiveness
of the technique were  never proven conclusively, it is known that computers
running a vulnerable version of QUARTZ.DLL will happily do whatever they're
instructed to do without litigation, as long as the commands in the MIDI
music are in machine language.

The QUARTZ.DLL vulnerability discussed in this advisory is a heap buffer
overrun resulting from an integer overflow.  If a Text or Copyright string
with a specified length of FFFFFFFFh is included in the MIDI file, QUARTZ
will attempt to allocate a  zero-byte heap block, then copy the text
string -- and any data following it -- to the newly-allocated location in
the heap.  As a result, all contiguous pages of heap memory following the
zero-byte block are overwritten until either the source pointer reaches an
invalid page boundary, the destination pointer reaches the end of heap
memory, or another thread is dispatched and faults out trying to use
corrupted heap memory.

The reason this vulnerability exists is because QUARTZ increments the
specified string length (in order to make room for a null terminator)
without checking for a potential overflow condition.  The incremented value
(now 0) is passed to LocalAlloc(), which succeeds, while the original value
(FFFFFFFFh) is given to memcpy() to copy the string data from the file image
into the heap buffer.

For the sake of brevity, we have unfortunately omitted the details of the
MIDI file format from this advisory, and will instead skip straight to the
following example of a malicious MIDI:

    4D 54 68 64                 ; 'MThd' header chunk tag
    00 00 00 06                 ; size of header chunk data (6)
    00 01                       ; MIDI file version (1)
    00 01                       ; number of tracks (1)
    65 49                       ; pulses per quarter note (PPQN)

    4D 54 72 6B                 ; 'MTrk' track chunk tag
    00 00 00 10                 ; size of track chunk data (16)
    00                          ; delta-time for event (0)
       FF 02                    ; non-MIDI event (Copyright)
    8F FF FF FF 7F              ; VLQ for text length (FFFFFFFFh)
    65 45 79 65 32 30 30 33     ; (start of malicious data)

There are many possible ways to exploit this overflow; the following is a
sampling of instructions at which exceptions were observed in the aftermath
of loading a malicious MIDI in Internet Explorer:

    CALL [EAX]                  ; we control EAX
    CALL [EAX+C4h]              ; we control EAX
    CALL [ECX+0Ch]              ; we control ECX
    JMP [EAX+28h]               ; we control EAX
    MOV [ECX], EAX              ; we control EAX, ECX
    MOV [ESI], ECX              ; we control ECX, ESI

Of particular interest are "unlink" sequences such as "MOV [ECX], EAX / MOV
[EAX+4], ECX", which could be used to overwrite the unhandled exception
filter in KERNEL32 during the first instruction, then cause an exception
with the second (for instance, if EAX pointed somewhere into read-only
memory, or if EAX was near a page boundary such that EAX+4..7 landed in an
invalid memory region).

A second heap buffer overrun involving a 16-bit integer overflow and
subsequent memory allocation was also discovered, but to save space we will
only briefly mention it here.  The number of tracks in the MThd chunk, a
16-bit field, is subjected to some arithmetic in order to determine the
necessary size for an array of track data structures. In particular, the
size of the block is calculated as:

    (number_of_tracks * 24h) + 9E0h

However, the arithmetic is performed entirely in 16 bits, and as a result,
setting the number of tracks to 1751 (6D7h) or greater will cause an
insufficiently small heap block to be allocated.  This vulnerability can be
leveraged to overwrite  DWORDs in the heap at specific intervals with
arbitrary data.  Note that Windows 2003 is not susceptible to this
vulnerability, as it contained a check to ensure that the number of tracks
is never greater than the exact highest value safe for the 16-bit
arithmetic.

Vendor Status:
Microsoft was contacted on April 16, 2003, and has released a patch for this
vulnerability.  The patch is available at:
<http://www.microsoft.com/technet/security/bulletin/MS03-030.asp>

This vulnerability has been assigned the CVE identifier CAN-2003-0346.

Credit:
Derek Soeder - eEye Digital Security

Greetin's:
6Ds; TJB, JC, MC, JAG, AH, JRJ, SMJ, JM, KP; Uma; and finally, Trust, when
it's not spelled with a $.

Copyright (c) 1998-2003 eEye Digital Security
Permission is hereby granted for the redistribution of this alert
electronically. It is not to be edited in any way without express consent of
eEye. If you wish to reprint the whole or any part of this alert in any
other medium excluding electronic medium, please email alert@eEye.com for
permission.

Disclaimer
The information within this paper may change without notice. Use of this
information constitutes acceptance for use in an AS IS condition. There are
NO warranties with regard to this information. In no event shall the author
be liable for any damages whatsoever arising out of or in connection with
the use or spread of this information. Any use of this information is at the
user's own risk.

Feedback
Please send suggestions, updates, and comments to:

eEye Digital Security
<http://www.eEye.com>
info@eEye.com

[[prev in list](?l=bugtraq&m=105899636522679&w=2)] [[next in list](?l=bugtraq&m=105899875225268&w=2)] [prev in thread] [[next in thread](?l=ntbugtraq&m=105906262614435&w=2)]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


