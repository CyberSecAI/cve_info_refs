The provided content is related to CVE-2003-0558.

**Root cause of vulnerability:**
A stack-based buffer overflow vulnerability exists in LeapFTP when handling the response to a PASV command. A long IP address in the server's reply to the PASV request overflows a buffer on the stack.

**Weaknesses/vulnerabilities present:**
- Stack-based buffer overflow.
- Improper input validation of the IP address provided in the PASV response.
- Overwriting the Structured Exception Handler (SEH) on the stack.

**Impact of exploitation:**
- Arbitrary code execution by overwriting the SEH with a pointer to attacker controlled shellcode.
- The provided exploit downloads and executes a file from a specified URL.

**Attack vectors:**
- The attacker acts as a malicious FTP server.
- The attacker sends a crafted PASV response containing an oversized IP address field.
- The vulnerable client connects to the malicious FTP server.

**Required attacker capabilities/position:**
- Ability to set up a malicious FTP server.
- Ability to control the content of the PASV response sent to a victim running LeapFTP.
- Knowledge of the vulnerable software and the required buffer overflow payload construction.