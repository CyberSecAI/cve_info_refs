=== Content from marc.info_11c1a0b7_20250125_215209.html ===

```
[[prev in list](?l=ntbugtraq&m=106632188709562&w=2)] [[next in list](?l=ntbugtraq&m=106632193009611&w=2)] [prev in thread] [next in thread]
List:       [ntbugtraq](?l=ntbugtraq&r=1&w=2)
Subject:    Microsoft Local Troubleshooter ActiveX control buffer overflow
From:       [Cesar <cesarc56 () UOL ! COM ! AR>](?a=105217439500001&r=1&w=2)
Date:       [2003-10-16 13:36:04](?l=ntbugtraq&r=1&w=2&b=200310)
[Download RAW [message](?l=ntbugtraq&m=106632192709608&q=mbox) or [body](?l=ntbugtraq&m=106632192709608&q=raw)]

Security Advisory

Name:  Microsoft Local Troubleshooter ActiveX control buffer overflow.
System Affected :  Microsoft Windows 2000 (all versions).
Severity :  High
Remote exploitable : Yes
Author:    Cesar Cerrudo.
Date:    10/16/03
Advisory Number:    CC100309

Legal Notice:

This Advisory is Copyright (c) 2003 Cesar Cerrudo.
You may distribute it unmodified and for free. You may NOT modify it and distribute it or distribute
parts of it without the author's written permission. You may NOT use it for commercial intentions
(this means include it in vulnerabilities databases, vulnerabilities scanners, any paid service,
etc.) without the author's written permission. You are free to use Microsoft details
for commercial intentions.

Disclaimer:

The information in this advisory is believed to be true though it may be false.
The opinions expressed in this advisory are my own and not of any company. The usual standard
disclaimer applies, especially the fact that Cesar Cerrudo is not liable for any damages caused
by direct or indirect use of the information or functionality provided by this advisory.
Cesar Cerrudo bears no responsibility for content or misuse of this advisory or any derivatives thereof.

Overview:

Microsoft Local Troubleshooter is an ActiveX control, it's not documented what it does,
but doing some research it's possible find out that the ActiveX control is used in Microsoft Windows
Troubleshooting help. This control is installed by default in Windows 2000 operating systems. When one of
its methods is called with a long string a buffer overflow occurrs.

Details:

This ActiveX control has a few methods and properties, one of the methods called "RunQuery2" has
a buffer overflow when it's called with a long string in first parameter.

To reproduce the overflow just copy-and-paste the following:

------sample.htm-----------
<object id="test" classid="CLSID:4B106874-DD36-11D0-8B44-00A024DD9EFF" >
</object>
<script>
test.RunQuery2("longstringhere","","");
</script>
---------------------------

Microsoft Local Troubleshooter  ActiveX control is marked as safe for scripting and initialization,
so the above sample will run without being blocked in default Internet Explorer security configuration.

This vulnerability can be exploited through XSS, sending to a victim an HTML e-mail,
or social engineering a user to open an HTML page specially constructed. Explotation of this
vulnerability could allow an attacker to execute code of his choice in the victim computer.

Vendor Status:

Microsoft was contacted, we worked together and Microsoft released a fix.

Patch Available:

<http://www.microsoft.com/technet/treeview/?url=/technet/security/bulletin/MS03-042.asp>

Thanks to: Jimmers and Brett Moore.

SQL SECURITY LIST!!!: For people interested in SQL Server security, vulnerabilities, SQL injection, etc.
Get advisories and vulnerabilities before!!!
Join at:
sqlserversecurity-subscribe@yahoogroups.com
<http://groups.yahoo.com/group/sqlserversecurity/>

----
NTBugtraq subscribers save $103.00 off the TICSA exam by using promo
code "NT1003" when registering to take the TICSA exam at [www.2test.com](http://www.2test.com).
Prove to your employer and peers that you have the knowledge and
abilities to be an active stakeholder in today's enterprise security.
Become TICSA certified [www.trusecure.com/ticsa](http://www.trusecure.com/ticsa).  Promotion expires
12/31/03 and cannot be used in combination with other offers.

----

[[prev in list](?l=ntbugtraq&m=106632188709562&w=2)] [[next in list](?l=ntbugtraq&m=106632193009611&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)



=== Content from docs.microsoft.com_a0e9675b_20250125_215218.html ===

[Skip to main content](#main)

This browser is no longer supported.

Upgrade to Microsoft Edge to take advantage of the latest features, security updates, and technical support.

[Download Microsoft Edge](https://go.microsoft.com/fwlink/p/?LinkID=2092881 )
[More info about Internet Explorer and Microsoft Edge](https://learn.microsoft.com/en-us/lifecycle/faq/internet-explorer-microsoft-edge)

Table of contents

Exit focus mode

Read in English

Save

Table of contentsRead in English

Save

Add to plan
[Edit](https://github.com/MicrosoftDocs/security-updates/blob/live/security-updates/SecurityBulletins/2003/ms03-042.md "Edit This Document")

---

#### Share via

Facebook
x.com
LinkedIn
Email

---

Print

Table of contents

* Article
* 03/01/2023
* 6 contributors

Feedback

## In this article

Security Bulletin

# Microsoft Security Bulletin MS03-042 - Critical

## Buffer Overflow in Windows Troubleshooter ActiveX Control Could Allow Code Execution (826232)

Published: October 15, 2003 | Updated: October 29, 2003

**Version:** 2.0

**Issued:** October 15, 2003

**Updated:** October 29, 2003

**Version Number:** 2.0

[See all Windows bulletins released October, 2003](https://technet.microsoft.com/security/bulletin/winoct03)

#### Summary

**Who Should Read This Document:**
Customers using MicrosoftÂ® WindowsÂ®

**Impact of Vulnerability:**
Remote Code Execution

**Maximum Severity Rating:**
Critical

**Recommendation:**
Customers should apply the patch immediately

**Patch Replacement:**
None

**Caveats:**
None

**Tested Software and Patch Download Locations:**

**Affected Software:**

* Microsoft Windows 2000, Service Pack 2, Service Pack 3, Service Pack 4 - [Download the Patch](https://www.microsoft.com/download/details.aspx?familyid=fc1fd84b-b3a4-43f5-804b-a2608ec56163&displaylang;=en)

**Non Affected Software:**

* Microsoft Windows NT 4.0
* Microsoft Windows NT Server 4.0, Terminal Server Edition
* Microsoft Windows Millennium Edition
* Microsoft Windows XP
* Microsoft Windows Server 2003

The software listed above has been tested to determine if the versions are affected. Other versions are no longer [supported](https://support.microsoft.com/directory/discontinue.asp), and may or may not be affected.

### General Information

## Technical Details

**Technical Description:**

Microsoft re-issued this bulletin on October 29, 2003 to advise on the availability of an updated Windows 2000 patch. This revised patch corrects the Debug Programs (SeDebugPrivilege) user right issue that some customers experienced with the original patch that is discussed in Knowledge Base Article [830846](https://support.microsoft.com/?kbid=830846). This problem is unrelated to the security vulnerability discussed in this bulletin. If you have previously applied this security patch, this update does not need to be installed.

A security vulnerability exists in the Microsoft Local Troubleshooter ActiveX control. The vulnerability exists because the ActiveX control (Tshoot.ocx) contains a buffer overflow that could allow an attacker to run code of their choice on a user's system. Because this control is marked "safe for scripting", an attacker could exploit this vulnerability by convincing a user to view a specially crafted HTML page that references this ActiveX control. The Microsoft Local Troubleshooter ActiveX control is installed as a default part of the operating system on Windows 2000.

To exploit this vulnerability, the attacker would have to create a specially formed HTML-based e-mail and send it to the user. Alternatively an attacker would have to host a malicious Web site that contained a Web page designed to exploit this vulnerability.

In the worst case, this vulnerability could allow an attacker to load malicious code onto a user's system and then to execute the code. The code would run in the context of the user. Therefore, the code is limited to any action that the legitimate user could take on the system. Any limitations on the user's account would also limit the actions of any arbitrary code that the attacker could execute.

The risk of attack from the HTML email vector can be significantly reduced if the following conditions are met:

* You have applied the patch included with Microsoft Security bulletin [MS03-040](https://technet.microsoft.com/security/bulletin/ms03-040)
* You are using Internet Explorer 6 or later
* You are using the Microsoft Outlook Email Security Update or Microsoft Outlook Express 6.0 and higher, or Microsoft Outlook 2000 or higher in their default configuration.

**Mitigating factors:**

* A Web-based attack would only be successful if the attacker creates a Web site that contains a Web page that they use to exploit this vulnerability. An attacker would have no way to force users to visit the malicious Web site. Instead, the attacker would have to lure them there, typically by getting them to click a link in an email message that would takes them to the attacker's site.
* By default, Outlook Express 6.0 and Outlook 2002 open HTML mail in the Restricted Sites Zone. In addition, Outlook 98 and 2000 open HTML mail in the Restricted Sites Zone if the Outlook Email Security Update has been installed. Customers who use any of these products would be at a reduced risk from an e-mail borne attack that attempted to exploit this vulnerability unless the user clicked a malicious link in the email.
* An attacker's code could only run with the same permissions as the logged on user. The specific privileges the attacker could gain through this vulnerability would therefore depend on the privileges granted to the user. Any limitations on the user's account would also limit the actions of any arbitrary code executed by this vulnerability.

**Severity Rating:**

|  |  |
| --- | --- |
| **Microsoft Windows 2000** | Critical |

The above [assessment](https://go.microsoft.com/fwlink/?linkid=21140) is based on the types of systems affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.

**Vulnerability identifier:** [CAN-2003-0662](https://cve.mitre.org/cgi-bin/cvename.cgi?name=can-2003-0662)

## Workarounds

Microsoft has tested the following workarounds. These workarounds will not correct the underlying vulnerability however they help block **known** attack vectors. Workarounds may cause a reduction in functionality in some cases - in such situations this is identified below.

* **Prompt before running of ActiveX controls in the Internet and Intranet zones:** You can help protect against this vulnerability by changing your settings for the Internet security zone to prompt before running ActiveX components. To do this, perform the following steps:

  1. In Internet Explorer, select **Tools, Internet Options**
  2. Click on the **Security tab**
  3. Highlight the Internet icon and click on the **Custom Level** button
  4. Scroll through the list to the **Active X controls and plug-ins** section
  5. Under **Run ActiveX controls and plug-ins** click **Prompt**
  6. Click **OK**
  7. Highlight the Local Intranet icon and click on the **Custom Level** button
  8. Scroll through the list to the **Active X controls and plug-ins** section
  9. Under **Run ActiveX controls and plug-ins** click **Prompt**
  10. Click **OK**; then click **OK** again to return to Internet Explorer

  **Impact of Workaround:**

  Many Web sites on the Internet use ActiveX to provide additional functionality. For instance, an online e-commerce site or banking site might use ActiveX controls to provide menus, ordering forms, or even account statements. Prompting before running ActiveX controls is a global setting for all Internet and Intranet sites. You will be prompted frequently when you enable this work-around. For each prompt, if you feel you trust the site that you are visiting, click **Yes** to run ActiveX components. If you do not want to be prompted for all of these sites, you can instead use the "Restrict Web sites to only your trusted Web sites" workaround.
* **Restrict Web sites to only your trusted Web sites.** After requiring a prompt before running ActiveX in the Internet and Intranet zone, you can add sites that you trust into Internet Explorer's Trusted sites. This will allow you to continue using trusted Web sites exactly as you do today, while protecting you from this attack on untrusted sites. Microsoft recommends that you only add sites that you trust to the trusted sites zone.

  To do this, perform the following steps:

  1. In Internet Explorer, select **Tools**, then **Internet Options**. Click the **Security** tab.
  2. In the box labeled **Select a Web content zone to specify its current security settings**, click **Trusted Sites**, then click **Sites**.
  3. If you want to add sites that do not require an encrypted channel, click to clear the **Require server verification (https:)** for all sites in this zone check box.
  4. In the box labeled **Add this Web Site to the zone**, type the URL of a site that you trust, then click the **Add** button.

     Repeat for each site that you want to add to the zone.
  5. Click **OK** twice to accept the changes and return to Internet Explorer. Add any sites that you trust not to take malicious action on your computer. One in particular that you may want to add is "\*.windowsupdate.microsoft.com" (without the quotes). This is the site that will host the patch, and it requires the use of an ActiveX control to install the patch.

  **Impact of Workaround:**

  For those sites you have not configured to be in your Trusted sites zone, their functionality will be impaired if they require ActiveX controls to function properly. Adding sites to your Trusted sites zone will allow them to be able to download the ActiveX control required to function correctly. However you should only add Web sites you trust to the Trusted sites zone.
* **Install** **Outlook Email Security Update** **if you are using Outlook 2000 SP1 or Earlier.**

  The Outlook Email Security Update causes Outlook 98 and 2000 to open HTML mail in the Restricted Sites Zone by default. Outlook Express 6.0 and Outlook 2002 by default open HTML mail in the Restricted Sites Zone. Customers who use any of these products would be at a reduced risk from an e-mail borne attack that attempts to exploit this vulnerability unless the user clicks a malicious link in the email
* **If you are using Outlook 2002 or Outlook Express 6.0SP1 or higher, to help protect yourself from the HTML email attack vector, read email in plain text format.**

  Users of Microsoft Outlook 2002 and Outlook Express 6.0 who have applied Service Pack 1 and or higher can enable a feature to view all non-digitally-signed e-mail or non-encrypted e-mail messages in plain text only.

  Digitally signed e-mail or encrypted e-mail messages are not affected by the setting and may be read in their original formats. Information on enabling this setting in Outlook 2002 can be found in the following Knowledge Base article:

  [https:](https://)

  Information on enabling this setting in Outlook Express 6.0 can be found in the following Knowledge Base article:

  </https:>[https:](https://)

  **Impact of Workaround:**

  E-mail viewed in plain text format cannot contain pictures, specialized fonts, animations, or other rich content. In addition:

  + The changes are applied to the preview pane and open messages.
  + Pictures become attachments to avoid loss.
  + Since the message is still in Rich Text or HTML format in the store, the object model (custom code solutions) may behave unexpectedly because the message is still in Rich Text or HTML format in the mail store.

## Frequently Asked Questions

**Why has Microsoft reissued this bulletin?**

Subsequent to the release of this bulletin and the associated patches, a problem was identified with the Windows 2000 version of the patch. This problem is unrelated to the security vulnerability discussed in this bulletin. If you have previously applied this security patch, this update does not need to be installed.
Microsoft has corrected this problem and re-issued this bulletin on October 29th, 2003 to advise on the availability of an updated Windows 2000 patch. This revised patch corrects the Debug Programs (SeDebugPrivilege) user right issue that some customers experienced with the original patch that is discussed in Knowledge Base Article [830846](https://support.microsoft.com/?kbid=830846).

**What is the scope of the vulnerability?**

This is a [buffer overrun](https://technet.microsoft.com/security/bulletin/glossary) vulnerability. An attacker who successfully exploited the vulnerability could, in the worst case, run code of their choice on a user's system. This would enable an attacker to take any action the legitimate user could take. This could include creating, modifying or deleting data, This could also include reconfiguring the system, or reformatting the hard disk.

**What causes the vulnerability?**

The vulnerability results because the Microsoft Local Troubleshooter ActiveX control (Tshoot.ocx) does not correctly validate parameters under certain circumstances. By luring a user into viewing a specially-crafted Web page, or by sending them a specially-crafted email, an attacker could cause the ActiveX control to fail in such a way that could allow an attacker to run arbitrary code.

**What's ActiveX?**

ActiveXÂ® is a technology that enables developers to write small programs that are named controls. Web pages, Visual BasicÂ® programs, and other applications can use controls. An ActiveX control performs a small number of related tasks and can be used as building blocks in much more complex programs.
Developers can build custom ActiveX controls. If developers build custom ActiveX controls, the controls must be distributed to each user. However, Microsoft and many third-party software vendors include ActiveX controls with their products, to enable these products to be easily extended. The vulnerability in this case involves an ActiveX control that installs by default as part of the operating system.

**Which ActiveX controls contain the vulnerability?**

The Microsoft Windows Help system is a default component of Windows. This Help system features documentation and interactive troubleshooting wizards that help users diagnose common problems. In Windows 2000, the Microsoft Windows Troubleshooting and Help System uses an ActiveX control that is named the Microsoft Local Troubleshooter (Tshoot.ocx). Microsoft Local Troubleshooter interacts with the local computer to help diagnose problems. This ActiveX control was designed to be used only by the Windows Troubleshooting and Help System.

**What is wrong with the affected ActiveX controls?**

The affected ActiveX control contain a buffer overrun. Because the control is marked "safe for scripting'" after installation, Internet Explorer, even in the Internet security zone, can load the control without any user interaction. By luring a user to view a specially-crafted Web page, an attacker could cause the control to fail in such a way that would allow arbitrary code to be run.

**What are Internet Explorer security zones?**

Internet Explorer security zones are a system that divides online content into categories or zones based on its trustworthiness. Specific Web domains can be assigned to a zone, depending on how much trust is placed in the content of each domain. The zone then restricts the capabilities of the Web content, based on the zone's settings.
By default, most Internet domains are treated as part of the Internet security zone, which has settings that prevent scripts and other active code from accessing resources on the local system. Conversely, the My Computer zone is a much less restricted zone which allows content to access and to make changes to content that is on the local system. By default, files that are stored on the local computer are run in the My Computer zone.

**What could this vulnerability enable an attacker to do?**

An attacker who successfully exploited this vulnerability could, in the worst case, run code of their choice on a user's system. This would enable an attacker to take any action the legitimate user could take. This could include creating, modifying or deleting data. This could also include reconfiguring the system, or reformatting the hard disk.

**How could an attacker exploit the vulnerability?**

To exploit this vulnerability, the attacker would have to create a specially formed HTML-based e-mail and send it to the user. Alternatively an attacker would have to host a malicious Web site that contained a Web page designed to exploit this vulnerability.

**Is there anything that helps mitigate the risk of an HTML email attack?**

The risk of attack from the HTML email vector can be significantly reduced if the following conditions are met:

* You have applied the patch included with Microsoft Security bulletin [MS03-040](https://technet.microsoft.com/security/bulletin/ms03-040)
* You are using Internet Explorer 6 or later
* You are using the Microsoft Outlook Email Security Update or Microsoft Outlook Express 6.0 and higher, or Microsoft Outlook 2000 or higher in their default configuration.

**What does the patch do?**

The patch helps remove the vulnerability by making sure that the ActiveX control validates all parameters correctly.

## Security Patch Information

**Installation platforms and Prerequisites:**

For information about the specific security patch for your platform, click the appropriate link:

#### Windows 2000 (all versions)

**Prerequisites:**

For Windows 2000 this security patch requires Service Pack 2 (SP2), Service Pack 3 (SP3), or Service Pack 4 (SP4).

For information about the Windows desktop product life cycle, visit the following Microsoft Web site: </https:>[https:](https://).

For additional information, click the following article number to view the article in the Microsoft Knowledge Base: [260910](https://support.microsoft.com/default.aspx?scid=kb;en-us;260910) How to Obtain the Latest Windows 2000 Service Pack

**Inclusion in future service packs:**

The fix for this issue will be included in Windows 2000 Service Pack 5.

**Installation Information:**

This security patch supports the following Setup switches:

/help Displays the command line options

**Setup Modes**

/quiet Quiet mode (no user interaction or display)

**/passive** Unattended mode (progress bar only)

**/uninstall** Uninstalls the package

**Restart Options**

**/norestart** Do not restart when installation is complete

**/forcerestart** Restart after installation

**Special Options**

**/l** Lists installed Windows hotfixes or update packages

**/o** Overwrite OEM files without prompting

**/n** Do not backup files needed for uninstall

**/f** Force other programs to close when the computer shuts down

**Note:** For backward compatibility, the security patch also supports the setup switches used by the previous version of the setup utility, however usage of the previous switches should be discontinued as this support may be removed in future security patches.

**Deployment Information**

To install the security patch without any user intervention, use the following command line:

For Windows 2000 Service Pack 2, Windows 2000 Service Pack 3, Windows 2000 Service Pack 4:

**Windows2000-kb826232-x86-enu /passive /quiet**

To install the security patch without forcing the computer to restart, use the following command line:

For Windows 2000 Service Pack 2, Windows 2000 Service Pack 3, Windows 2000 Service Pack 4:

**Windows2000-kb826232-x86-enu /norestart**

**Note:** You can combine these switches into one command line.

**Restart Requirement:**

In some cases, this patch does not require a reboot. The installer stops the needed services, applies the patch, then restarts them. However, if the needed services cannot be stopped for any reason or if required files are in use, it will require a reboot. If this occurs, a prompt will be displayed advising of the need to reboot.

**Removal Information:**

To remove this security patch, use the Add or Remove Programs tool in Control Panel.

System administrators can use the Spuninst.exe utility to remove this security patch. The Spuninst.exe utility is located in the %Windir%\$NTUninstallKB826232$\Spuninst folder, and it supports the following Setup switches:

**/?**: Show the list of installation switches.

**/u**: Use unattended mode.

**/f**: Force other programs to quit when the computer shuts down.

**/z**: Do not restart when the installation is complete.

**/q**: Use Quiet mode (no user interaction).

**File Information:**

The English version of this fix has the file attributes (or later) that are listed in the following table. The dates and times for these files are listed in coordinated universal time (UTC). When you view the file information, it is converted to local time. To find the difference between UTC and local time, use the **Time Zone** tab in the Date and Time tool in Control Panel.

Windows 2000 Service Pack 2, Windows 2000 Service Pack 3, Windows 2000 Service Pack 4:

| Date | Time | Version | Size | File Name |
| --- | --- | --- | --- | --- |
| 07-Oct-2003 | 23:08 | 1.0.1.2125 | 107,792 | tshoot.ocx |

**Verifying patch installation:**

To verify that the security patch is installed on your computer use the Microsoft Baseline Security Analyzer (MBSA) tool. For additional information about MBSA, click the following article number to view the article in the Microsoft Knowledge Base:

[320454](https://support.microsoft.com/default.aspx?kbid=320454) Microsoft Baseline Security Analyzer Version 1.1.1 Is Available

You may also be able to verify the files that this security patch installed by reviewing the following registry key:

HKEY\_LOCAL\_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB826232\Filelist

**Note:** This registry key may not be not created properly when an administrator or an OEM integrates or slipstreams the 824146 security patch into the Windows installation source files.

### Other Information

**Acknowledgments**

Microsoft [thanks](https://technet.microsoft.com/security/bulletin/policy) the following for working with us to protect customers:

* Greg Jones of [KPMG UK](https://www.kpmg.co.uk/) and Cesar Cerrudo for reporting the issue described in MS03-042.

**Obtaining other security patches:**

Patches for other security issues are available from the following locations:

* Security patches are available from the [Microsoft Download Center](https://go.microsoft.com/fwlink/?linkid=21129), and can be most easily found by doing a keyword search for "security\_patch".
* Patches for consumer platforms are available from the [Windows Update](https://windowsupdate.microsoft.com/) web site

**Support:**

* Technical support is available from [Microsoft Product Support Services](https://support.microsoft.com/directory/question.asp?sd=gn&fr;=0) at 1-866-PCSAFETY. There is no charge for support calls associated with security patches.

**Security Resources:**

* The [Microsoft TechNet Security](https://www.microsoft.com/technet/security/default.mspx) Web Site provides additional information about security in Microsoft products.
* Microsoft Software Update Services: </https:>[https:](https://)
* Microsoft Baseline Security Analyzer (MBSA) details: [https://www.microsoft.com/mbsa](https://www.microsoft.com/mbsa/). Please see [https://support.microsoft.com/default.aspx?scid=kb;EN-US;306460](https://support.microsoft.com/default.aspx?scid=kb;en-us;306460) for list of security patches that have detection limitations with MBSA tool.
* Windows Update Catalog: [https://support.microsoft.com/default.aspx?scid=kb;EN-US;323166](https://support.microsoft.com/default.aspx?scid=kb;en-us;323166)
* Windows Update: [https://windowsupdate.microsoft.com](https://windowsupdate.microsoft.com/)
* Office Update: </https:>[https:](https://)

**Disclaimer:**

The information provided in the Microsoft Knowledge Base is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.

**Revisions:**

* V1.0 October 15, 2003: First Published.
* V1.1 October 21, 2003: Updated product specific information in the Security Patch Information section.
* V2.0 October 29, 2003: A revised version of the security patch for Windows 2000 has been released to correct the issue documented by Knowledge Base Article [830846](https://support.microsoft.com/?kbid=830846).

*Built at 2014-04-18T13:49:36Z-07:00*
</https:>

---

## Additional resources

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025
## Additional resources

### In this article

[California Consumer Privacy Act (CCPA) Opt-Out Icon

Your Privacy Choices](https://aka.ms/yourcaliforniaprivacychoices)

Theme

* Light
* Dark
* High contrast

* [Previous Versions](/en-us/previous-versions/)
* [Blog](https://techcommunity.microsoft.com/t5/microsoft-learn-blog/bg-p/MicrosoftLearnBlog)
* [Contribute](/en-us/contribute/)
* [Privacy](https://go.microsoft.com/fwlink/?LinkId=521839)
* [Terms of Use](/en-us/legal/termsofuse)
* [Trademarks](https://www.microsoft.com/legal/intellectualproperty/Trademarks/)
* © Microsoft 2025



=== Content from www.kb.cert.org_4ed5d410_20250125_215218.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#989932

## Microsoft contains a buffer overflow in the Local Troubleshooter ActiveX control (Tshoot.ocx)

#### Vulnerability Note VU#989932

Original Release Date: 2003-10-16 | Last Revised: 2003-10-16

---

### Overview

Microsoft Windows ships with a troubleshooting application to assist users with problems. A vulnerability in this application may permit a remote attacker to execute arbitrary code with the privileges of the current user.

### Description

| Microsoft Windows 2000 ships with an ActiveX control (Tshoot.ocx) that is a troubleshooting application to assist users with various system problems. A buffer overflow vulnerability exists in this control that may permit a remote attacker to execute arbitrary code with the privileges of the current user. Since this control is marked *Safe for Scripting*, a remote attacker who could trick the victim into viewing a crafted HTML web site, or HTML-based email message may be able to exploit this vulnerability.  It should be noted that the Microsoft Local Troubleshooter ActiveX control is installed as a default part of the operating system on Windows 2000. |
| --- |

### Impact

| Exploitation of this vulnerability could lead to the arbitrary execution of code with the privileges of the current user. |
| --- |

### Solution

| Microsoft has released patches in [MS03-042](http://www.microsoft.com/technet/security/bulletin/MS03-042.asp) and Knowledgebase Article [826232](http://support.microsoft.com/?kbid=826232) to address this issue. Apply the patches as appropriate.According to the Microsoft Advisory, Microsoft Windows 2000 with Service Pack 2, Service Pack 3 or Service Pack 4 are vulnerable to this issue. Windows NT 4.0, NT Server 4.0, Terminal Server Edition , Windows XP, Windows Millennium Edition and Windows Server 2003 are not affected by this issue. |
| --- |

### Vendor Information

989932
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23989932/) to view vendors.**
### [Microsoft Corporation](#JARL-5SDNPM) Affected

Updated:  October 16, 2003

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

Please see, <http://www.microsoft.com/technet/security/bulletin/MS03-042.asp>.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base |  |  |
| Temporal |  |  |
| Environmental |  |  |

### References

* <http://www.microsoft.com/technet/security/bulletin/MS03-042.asp>
* <http://support.microsoft.com/?kbid=826232>
### Acknowledgements

This vulnerability was reported in a Microsoft Security Bulletin.

This document was written by Jason A Rafail and is based on MS03-042.

### Other Information

| **CVE IDs:** | [CVE-2003-0661](http://web.nvd.nist.gov/vuln/detail/CVE-2003-0661) |
| --- | --- |
| **Severity Metric:** | 25.31 |
| **Date Public:** | 2003-10-15 |
| **Date First Published:** | 2003-10-16 |
| **Date Last Updated:** | 2003-10-16 18:27 UTC |
| **Document Revision:** | 7 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.cert.org_fdb4f397_20250125_215217.html ===


search

icon-carat-right

cmu-wordmark

[Carnegie Mellon University](https://www.cmu.edu)

# [Software Engineering Institute](/)

##

1. [SEI](/)
2. [About](/about/)
3. [Divisions](/about/divisions/)
4. The CERT Division

## The CERT Division

The CERT Division is a leader in cybersecurity. We partner with government, industry, law enforcement, and academia to improve the security and resilience of computer systems and networks. We study problems that have widespread cybersecurity implications and develop advanced methods and tools to counter large-scale, sophisticated cyber threats.

* [Leadership](/about/divisions/cert/index.cfm#leadership)
* [What We Do](/about/divisions/cert/index.cfm#cert-division-what-we-do)
* [Careers in the CERT Division](/about/divisions/cert/index.cfm#careers)
* [Recent Vulnerabilities](/about/divisions/cert/index.cfm#CERTRecentlyPublishedVulnerabilityNotes)
* [Case Studies](/about/divisions/cert/index.cfm#case-studies)
* [History](/about/divisions/cert/index.cfm#history)

## Leadership

[![Gregory J. Touhill](/sei-images/images/Touhill_Greg_393_2023_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=314857)
#### [Gregory J. Touhill](/about/leadership/display.cfm?customel_datapageid_2623=314857)

Director, CERT Division

[![William Wilson](/sei-images/images/Wilson_William_324_200113_2622.png)](/about/leadership/display.cfm?customel_datapageid_2623=3871)
#### [William Wilson](/about/leadership/display.cfm?customel_datapageid_2623=3871)

Deputy Director, CERT Division

[![Chris Inacio](/sei-images/images/inacio-chris-96_2622.jpg)](/about/leadership/display.cfm?customel_datapageid_2623=494689)
#### [Chris Inacio](/about/leadership/display.cfm?customel_datapageid_2623=494689)

Chief Engineer, CERT Division

## What We Do

CERT experts are a diverse group of researchers, software engineers, security analysts, and digital intelligence specialists working together to research security vulnerabilities in software products, contribute to long-term changes in networked systems, and develop cutting-edge information and training to improve the practice of cybersecurity.

Our connection to the internationally known [Carnegie Mellon University](https://www.cmu.edu/) creates multidisciplinary collaboration opportunities and amplifies our research abilities.

#### Autonomy Security and Resilience

Develop and sustain security, resilience, and assurance best practices for the development, construction, and employment of machine learning systems.

#### [Cybersecurity Center Development](https://www.sei.cmu.edu/our-work/cybersecurity-center-development/index.cfm)

Develop measurable and repeatable practices to prepare CSIRTs and other operational security organizations.

#### [Cybersecurity Engineering](https://www.sei.cmu.edu/our-work/cybersecurity-engineering/index.cfm)

Develop methods for engineering mission-essential capabilities that balance security and resiliency with mission performance.

#### [Cyber Workforce Development](https://www.sei.cmu.edu/our-work/cyber-workforce-development/index.cfm)

Develop and maintain a well-equipped cyber workforce that is immediately able to support the cybersecurity needs of organizations.

#### [Enterprise Risk and Resilience Management](https://www.sei.cmu.edu/our-work/enterprise-risk-resilience-management/index.cfm)

Develop measurable practices and frameworks that enable organizations to measure and mitigate risks.

#### [Insider Threat](https://www.sei.cmu.edu/our-work/insider-threat/index.cfm)

Detect and mitigate the impact of insider threats and reduce their occurrence in organizations.

#### [Reverse Engineering for Malware Analysis](https://www.sei.cmu.edu/our-work/reverse-engineering-for-malware-analysis/index.cfm)

Develop tools and methods to identify and mitigate code that causes unintended effects in software systems.

#### [Situational Awareness](https://www.sei.cmu.edu/our-work/situational-awareness/index.cfm)

Analyze the cyber terrain as it evolves to characterize assets at risk, measure adversary activity, and prioritize responses to threat.

#### [Secure Development](https://www.sei.cmu.edu/our-work/secure-development/index.cfm)

Assess platforms through the analysis of source code to assure they adhere to security best practices.

#### [System and Platform Evaluation](https://www.sei.cmu.edu/our-work/projects/display.cfm?customel_datapageid_4050=21361)

Assess software, devices, systems, and platforms of unknown design or origin to find vulnerabilities and strategies for defending against possible attacks.

#### [Security Vulnerabilities](https://www.sei.cmu.edu/our-work/security-vulnerabilities/index.cfm)

Reduce exposure to known vulnerabilities in systems.

* ## Careers in the CERT Division

#### [Cyber Risk Intern](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cyber-Risk-Intern_2022294-1)

Pittsburgh, PA

#### [Senior Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Software-Engineer_2020922-1)

Pittsburgh, PA

#### [Associate Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Associate-Research-Scientist---Quantum_2021979)

Pittsburgh, PA

#### [Documentation Specialist and Content Strategist](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Documentation-Specialist-and-Content-Strategist_2022203-1)

Pittsburgh, PA

#### [Senior Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Communications-Engineer_2022179-1)

Pittsburgh, PA

#### [Senior AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-AI-Security-Researcher_2021569-1)

Pittsburgh, PA

#### [Technical Manager - Cybersecurity Assurance Team](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Technical-Manager---Cybersecurity-Assurance-Team_2022101-1)

2 Locations

#### [Software Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/System-Designer_2017276)

Pittsburgh, PA

#### [AI Security Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/AI-Security-Researcher_2020107)

Pittsburgh, PA

#### [Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Vulnerability-Researcher_2019726-1)

Pittsburgh, PA

#### [Senior Vulnerability Researcher](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Vulnerability-Researcher_2020002-1)

Pittsburgh, PA

#### [Assistant Communications Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Assistant-Communications-Engineer_2021848-2)

Pittsburgh, PA

#### [Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Research-Scientist---Quantum_2021633-1)

Pittsburgh, PA

#### [Senior Research Scientist - Quantum](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Senior-Research-Scientist---Quantum_2021632)

Pittsburgh, PA

#### [Cybersecurity Engineer](https://cmu.wd5.myworkdayjobs.com/SEI/job/Pittsburgh-PA/Cybersecurity-Engineer_2020646-1)

2 Locations

[SEE ALL SEI JOB OPENINGS](https://cmu.wd5.myworkdayjobs.com/en-US/SEI/)

## Recently Published Vulnerabilities

#### [VU#199397: Insecure Implementation of Tunneling Protocols (GRE/IPIP/4in6/6in4)](https://kb.cert.org/vuls/id/199397)

###### January 17, 2025

#### [VU#952657: Rsync contains six vulnerabilities](https://kb.cert.org/vuls/id/952657)

###### January 14, 2025

#### [VU#529659: Howyar Reloader UEFI bootloader vulnerable to unsigned software execution](https://kb.cert.org/vuls/id/529659)

###### January 14, 2025

[More Vulnerabilities](https://www.kb.cert.org/vuls)
[Report a Vulnerability](https://www.kb.cert.org/vuls/report/)

## Case Studies

[![Cyber Lightning Case Study](/sei-images/images/thumb_mid_thumb_cyber-lightning_380x380_1_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)
#### [Cyber Lightning Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

The SEI hosted Cyber Lightning, a three-day joint training exercise involving Air National Guard and Air Force Reserve units from western Pennsylvania and eastern Ohio.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25905)

[![SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/sei-images/images/thumb_mid_thumb_crisis-simulation_380x380_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)
#### [SEI Hosts Crisis Simulation Exercise for Cyber Intelligence Research Consortium](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

In SEI crisis simulation exercises, participants use scenarios that present fictitious malicious actors and environmental factors based on real-world events.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=26232)

[![USPS Case Study](/sei-images/images/thumb_standard_thumb_usps-improves-its-cybersecurity-and-resilience_260x260_4070.jpg)](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)
#### [USPS Case Study](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

The SEI teamed with the U.S. Postal Service to help it improve its cybersecurity and resilience and collaborated on a program to develop a strong cybersecurity workforce.

[Learn More](/research-capabilities/all-work/display.cfm?customel_datapageid_4050=25328)

## History

The CERT Division is the birthplace of cybersecurity. For nearly 30 years, the CERT Division of the SEI has partnered with government, industry, law enforcement, and academia to advance cybersecurity and improve the security and resilience of computer systems and networks.

Originally focused on incident response, we have expanded into cybersecurity areas such as network situational awareness, malicious code analysis, secure coding, resilience management, insider threats, digital investigations and intelligence, workforce development, DevOps, forensics, software assurance, vulnerability discovery and analysis, and risk management.

     ![The CERT Division - Barbara Fraser and Ed DeHart](/sei-images/images/about-divisions-cert-history-aside-144-2_2134.jpg "The CERT Division - Barbara Fraser and Ed DeHart")   Barbara Fraser and Ed DeHart, part of the SEI’s CERT/CC in the early 1990s

## Former Director Richard Pethia

[Richard Pethia](/about/leadership/display.cfm?customel_datapageid_2623=3545) was founding director of the SEI's CERT Division. Pethia, who served as director of CERT from 1988 to 2016, guided the organization through tremendous growth and change. Under Pethia's leadership, the unit expanded and evolved from the CERT Coordination Center—a small group focused on computer incident response—to a research organization of more than 200 professionals dedicated to solving problems with widespread cybersecurity implications.

[SEE FULL PROFILE](/about/leadership/display.cfm?customel_datapageid_2623=3545)

     ![Former Director Richard Pethia](/sei-images/images/about-divisions-cert-pethia-aside-144-2_2159.jpg "Former Director Richard Pethia")

## Related Links

* [CERT Podcast Series](http://www.cert.org/podcasts/index.cfm)
* [CERT/CC Blog Series](http://insights.sei.cmu.edu/cert)
* [Computer Security Incident Response Teams](/education-outreach/computer-security-incident-response-teams/index.cfm)

* [FloCon](https://resources.sei.cmu.edu/news-events/events/flocon)
* [Insider Threat Blog Series](https://insights.sei.cmu.edu/insider-threat)
* [Insider Threat Symposium](https://www.eventbrite.com/e/2017-cert-insider-threat-symposium-registration-31893497309)

* [NatCSIRT Meeting](https://resources.sei.cmu.edu/news-events/events/natcsirt/index.cfm)
* [Vulnerability Database](https://www.kb.cert.org/vuls)

[Report a Vulnerability to CERT/CC](https://www.kb.cert.org/vuls/report/)
[Subscribe to SEI Bulletin](/subscribe-to-sei-bulletin/)
[Request Permission to Use SEI Materials](/legal/request-permission-to-use-sei-material)

Carnegie Mellon University
 Software Engineering Institute
 4500 Fifth Avenue
 Pittsburgh, PA 15213-2612
 412-268-5800

 [  [Facebook](https://www.facebook.com/SEICMU/)  |  [Twitter](https://twitter.com/SEI_CMU)  |  [LinkedIn](https://www.linkedin.com/company/software-engineering-institute)  |  [YouTube](https://www.youtube.com/user/TheSEICMU)  |  [iTunes](https://itunes.apple.com/us/podcast/software-engineering-institute-sei-podcast-series/id566573552?mt=2)  ]

[Contact Us](/contact-us/)

 [  [Office Locations](/locations/index.cfm)  |  [Additional Sites Directory](/additional-sites-directory/index.cfm)  |  [Legal](/legal/index.cfm)  |  [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm)  |  [CMU Ethics Hotline](https://www.cmu.edu/hr/resources/ethics-hotline.html)  |  [www.sei.cmu.edu](/index.cfm)  ]

©2025 Carnegie Mellon University


