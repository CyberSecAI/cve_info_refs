```
{
  "cve": "CVE-2003-0663",
  "source_documents": [
    {
      "url": "https://docs.microsoft.com/en-us/security-updates/securitybulletins/2004/ms04-011",
      "document_type": "Microsoft Security Bulletin",
      "plain_text": "Microsoft Security Bulletin MS04-011 - Critical\n\nSecurity Update for Microsoft Windows (835732)\n\nPublished: April 13, 2004 | Updated: August 10, 2004\n\nVersion: 2.1\n\nIssued: April 13, 2004\n\nUpdated: August 10, 2004\n\nVersion: 2.1\n\nSummary\n\nWho should read this document: Customers who use MicrosoftÂ® WindowsÂ®\n\nImpact of vulnerability:  Remote Code Execution\n\nMaximum Severity Rating: Critical\n\nRecommendation: Customers should apply the update immediately.\n\nSecurity Update Replacement: This bulletin replaces several prior security updates. See the frequently asked questions (FAQ) section of this bulletin for the complete list.\n\nCaveats: The security update for Windows NT Server 4.0 Terminal Server Edition Service Pack 6 requires, as a prerequisite, the Windows NT Server 4.0 Terminal Server Edition Security Rollup Package (SRP). To download the SRP, visit the following Web site. You must install the SRP before you install the security update that is provided in this security bulletin. If you are not using Windows NT Server 4.0 Terminal Server Edition Service Pack 6 you do not need to install the SRP.\n\nMicrosoft Knowledge Base Article 835732 documents the currently known issues that customers may experience when they install this security update. The article also documents recommended solutions for these issues. For more information, see Microsoft Knowledge Base Article 835732.\n\nTested Software and Security Update Download Locations:\n\nAffected Software:\n\nMicrosoft Windows NTÂ® Workstation 4.0 Service Pack 6a - Download the update\n\nMicrosoft Windows NT Server 4.0 Service Pack 6a - Download the update\n\nMicrosoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6 - Download the update\n\nMicrosoft Windows 2000 Service Pack 2, Microsoft Windows 2000 Service Pack 3, and Microsoft Windows 2000 Service Pack 4 - Download the update\n\nMicrosoft Windows XP and Microsoft Windows XP Service Pack 1 - Download the update\n\nMicrosoft Windows XP 64-Bit Edition Service Pack 1 - Download the update\n\nMicrosoft Windows XP 64-Bit Edition Version 2003 - Download the update\n\nMicrosoft Windows Serverâ¢ 2003 - Download the update\n\nMicrosoft Windows Server 2003 64-Bit Edition - Download the update\n\nMicrosoft NetMeeting\n\nMicrosoft Windows 98, Microsoft Windows 98 Second Edition (SE), and Microsoft Windows Millennium Edition (ME) - Review the FAQ section of this bulletin for details about these operating systems.\n\nThe software that is listed above has been tested to determine if the versions are affected. Other versions either no longer include security update support or may not be affected. To determine the support lifecycle for your product and version, visit the following Microsoft Support Lifecycle Web site.\n\nGeneral Information\n\nTechnical Details\n\nExecutive Summary:\n\nMicrosoft re-issued this bulletin on June 15, 2004 to advise on the availability of an updated Windows NT 4.0 Workstation update for the Pan Chinese language.\n\nThis revised update corrects an installation issue that some customers experienced with the original update. This issue is unrelated to the security vulnerability discussed in this bulletin. However, this issue has caused some customers difficulty installing the update. If you have previously applied this security update, this update does need to be installed to avoid potential issues when installing future security updates. This issue only affects the Pan Chinese language version of the update and only those versions of the update are being re-released. Other language versions of this update are not affected and are not being re-released.\n\nThis update resolves several newly-discovered vulnerabilities. Each vulnerability is documented in this bulletin in its own section.\n\nAn attacker who successfully exploited the most severe of these vulnerabilities could take complete control of an affected system, including installing programs; viewing, changing, or deleting data; or creating new accounts that have full privileges.\n\nMicrosoft recommends that customers apply the update immediately.\n\nSeverity Ratings and Vulnerability Identifiers:\n\n| Vulnerability Identifiers | Impact of Vulnerability | Windows 98, 98 SE, ME | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |\n| --- | --- | --- | --- | --- | --- | --- |\n| LSASS Vulnerability - CAN-2003-0533 | Remote Code Execution | None | None | Critical | Critical | Low |\n| LDAP Vulnerability - CAN-2003-0663 | Denial Of Service | None | None | Important | None | None |\n| PCT Vulnerability - CAN-2003-0719 | Remote Code Execution | None | Critical | Critical | Important | Low |\n| Winlogon Vulnerability - CAN-2003-0806 | Remote Code Execution | None | Moderate | Moderate | Moderate | None |\n| Metafile Vulnerability - CAN-2003-0906 | Remote Code Execution | None | Critical | Critical | Critical | None |\n| Help and Support Center Vulnerability - CAN-2003-0907 | Remote Code Execution | None | None | None | Critical | Critical |\n| Utility Manager Vulnerability - CAN-2003-0908 | Privilege Elevation | None | None | Important | None | None |\n| Windows Management Vulnerability - CAN-2003-0909 | Privilege Elevation | None | None | None | Important | None |\n| Local Descriptor Table Vulnerability - CAN-2003-0910 | Privilege Elevation | None | Important | Important | None | None |\n| H.323 Vulnerability* - CAN-2004-0117 | Remote Code Execution | Not Critical | None | Important | Important | Important |\n| Virtual DOS Machine Vulnerability - CAN-2004-0118 | Privilege Elevation | None | Important | Important | None | None |\n| Negotiate SSP Vulnerability - CAN-2004-0119 | Remote Code Execution | None | None | Critical | Critical | Critical |\n| SSL Vulnerability - CAN-2004-0120 | Denial Of Service | None | None | Important | Important | Important |\n| ASN.1 âDouble Freeâ Vulnerability - CAN-2004-0123 | Remote Code Execution | Not Critical | Critical | Critical | Critical | Critical |\n| Aggregate Severity of All Vulnerabilities |  | Not Critical | Critical | Critical | Critical | Critical |\n\n*Note The severity rating of H.323 Vulnerability - CAN-2004-0117 is Important for the standalone version of NetMeeting. To download an updated version of NetMeeting that addresses this vulnerability, visit the following Web site. This version of NetMeeting can be installed on all systems that are running Windows 98, Windows 98 Second Edition, Windows Millennium Edition, and Windows NT 4.0. The updated version of NetMeeting that addresses this vulnerability is version 3.01 (4.4.3399).\n\nThe above assessment is based on the types of systems that are affected by the vulnerability, their typical deployment patterns, and the effect that exploiting the vulnerability would have on them.\n\nFrequently asked questions (FAQ) related to this security update\n\nWhy has Microsoft re-issued this bulletin?\n\nMicrosoft re-issued this bulletin on June 15, 2004 to advise on the availability of an updated Windows NT 4.0 Workstation update for the Pan Chinese language.\n\nThis revised update corrects an installation issue that some customers experienced with the original update. This issue is unrelated to the security vulnerability discussed in this bulletin. However, this issue has caused some customers difficulty installing the update. If you have previously applied this security update, this update does need to be installed to avoid potential issues when installing future security updates. This issue only affects the Pan Chinese language version of the update and only those versions of the update are being re-released. Other language versions of this update are not affected and are not being re-released.\n\nWhy does this update address several reported security vulnerabilities?\n\nThis update contains support for several vulnerabilities because the modifications that are required to address these issues are located in related files. Instead of having to install several updates that contain almost identical files, customers can install only this update.\n\nWhat updates does this release replace?\n\nThis security update replaces several prior security bulletins. The security bulletin IDs and operating systems that are affected are listed in the table below.\n\n| Bulletin ID | Windows NT 4.0 | Windows 2000 | Windows XP | Windows Server 2003 |\n| --- | --- | --- | --- | --- |\n| MS99-023 | Replaced | Not Applicable | Not Applicable | Not Applicable |\n| MS00-027 | Not Replaced | Replaced | Not Applicable | Not Applicable |\n| MS00-032 | Not Applicable | Replaced | Not Applicable | Not Applicable |\n| MS00-070 | Not Replaced | Replaced | Not Applicable | Not Applicable |\n| MS02-050 | Replaced | Not Replaced | Not Replaced | Not Applicable |\n| MS02-051 | Not Applicable | Replaced | Not Replaced | Not Applicable |\n| MS02-071 | Replaced | Replaced | Not Replaced | Not Applicable |\n| MS03-007 | Not Replaced | Replaced | Not Replaced | Not Applicable |\n| MS03-013 | Replaced | Replaced | Not Replaced | Not Applicable |\n| MS03-025 | Not Applicable | Replaced | Not Applicable | Not Applicable |\n| MS03-041 | Replaced | Not Replaced | Not Replaced | Not Replaced |\n| MS03-045 | Replaced | Replaced | Not Replaced | Not Replaced |\n| MS04-007 | Replaced | Replaced | Replaced | Replaced |\n\nIs this update a Cumulative Security Update or a Security Update Roll-up?\n\nNeither. A Cumulative Security Update would typically include support for all prior updates. This update does not include support for all prior updates on all operating systems.\n\nA Security Update Roll-up is typically used to combine previous releases into a single update to allow for easier installation and faster download. Security Update Roll-ups typically do not include modifications to address new vulnerabilities; this update does.\n\nHow does the extended support for Windows 98, Windows 98 Second Edition, and Windows Millennium Edition affect the release of security updates for these operating systems?\n\nMicrosoft will only release security updates for critical security issues. Non-critical security issues are not offered during this support period. For more information about the Microsoft Support Lifecycle policies for these operating systems, visit the following Web site.\n\nFor more information about severity ratings, visit the following Web site.\n\nAre Windows 98, Windows 98 Second Edition, or Windows Millennium Edition critically affected by any of the vulnerabilities that are addressed in this security bulletin?\n\nNo. None of these vulnerabilities are critical in severity on Windows 98, on Windows 98 Second Edition, or on Windows Millennium Edition.\n\nDoes this update contain any other changes to functionality?\n\nYes. In addition to the changes that are listed in each of the vulnerability details sections of this bulletin, this update includes the following change in functionality: files that end with the file name extension â.folderâ are no longer associated with a directory. Files that have this extension are still supported by the affected operating system. However, those files will no longer appear as a directory in Windows Explorer and in other programs.\n\nCan I use the Microsoft Baseline Security Analyzer (MBSA) to determine if this update is required?\n\nYes. MBSA will determine if this update is required. However, MBSA does not currently support the stand-alone version of NetMeeting for detection. MBSA will not offer the required update to the stand-alone version of NetMeeting if it has been installed on Windows NT 4.0 systems. To download the updated stand-alone version of NetMeeting that addresses the H.323 Vulnerability (CAN-2004-0117), visit the following Web site. MBSA does detect if the update for the H.323 Vulnerability (CAN-2004-0117) is required for the version of NetMeeting that shipped as part of Windows 2000, Windows XP, or Windows Server 2003.\n\nFor more information about the H.323 Vulnerability (CAN-2004-0117), see that vulnerability details section of this bulletin. For more information about MBSA, visit the MBSA Web site. For more information about MBSA detection limitations, see Microsoft Knowledge Base Article 306460.\n\nHow did this change from the initial release of the bulletin?\n\nWhen the bulletin was released on April 13, 2004, MBSA detection for this security update was disabled for Windows NT 4.0 because of the lack of detection support for the stand-alone version of NetMeeting that is described earlier in this bulletin. This changed on April 21, 2004. MBSA will now detect if this security update is required for Windows NT 4.0 even though this limitation exists.\n\nCan I use Systems Management Server (SMS) to determine if this update is required?\n\nYes. SMS can help detect and deploy this security update. For information about SMS, visit the SMS Web site. SMS uses MBSA for detection; therefore, SMS has the same limitation listed earlier in this bulletin related to the stand-alone version of NetMeeting.\n\nCan I use Systems Management Server (SMS) to determine if the stand-alone version of NetMeeting has been installed on Windows NT 4.0 systems?\n\nYes. SMS can help detect if the updated stand-alone version of NetMeeting is required for Windows NT 4.0 systems. SMS can search for the presence of the file âConf.exe.â All versions before version 3.01 (4.4.3399) should be updated.\n\nVulnerability Details\n\nLSASS Vulnerability - CAN-2003-0533:\n\nA buffer overrun vulnerability exists in LSASS that could allow remote code execution on an affected system. An attacker who successfully exploited this vulnerability could take complete control of the affected system.\n\nMitigating Factors for LSASS Vulnerability - CAN-2003-0533:\n\nOnly Windows 2000 and Windows XP can be remotely attacked by an anonymous user. While Windows Server 2003 and Windows XP 64-Bit Edition Version 2003 contain the vulnerability, only a local administrator could exploit it.\n\nWindows NT 4.0 is not affected by this vulnerability.\n\nFirewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed.\n\nWorkarounds for LSASS Vulnerability - CAN-2003-0533:\n\nMicrosoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.\n\nCreate a file called %systemroot%\\debug\\dcpromo.log and make the file read-only. To do this, type the following command:\n\necho dcpromo >%systemroot%\\debug\\dcpromo.log & attrib +r %systemroot%\\debug\\dcpromo.log\n\nNote This is the most effective mitigation technique as it completely mitigates this vulnerability by causing the vulnerable code to never be executed. This work-around will work for packets sent to any vulnerable port.\n\nUse a personal firewall such as the Internet Connection Firewall, which is included with Windows XP and Windows Server 2003.\n\nIf you use the Internet Connection Firewall feature in Windows XP or in Windows Server 2003 to help protect your Internet connection, it blocks unsolicited inbound traffic by default. Microsoft recommends blocking all unsolicited inbound communication from the Internet.\n\nTo enable the Internet Connection Firewall feature by using the Network Setup Wizard, follow these steps:\n\nClick Start, and then click Control Panel.\n\nIn the default Category View, click Network and Internet Connections, and then click Setup or change your home or small office network. The Internet Connection Firewall feature is enabled when you select a configuration in the Network Setup Wizard that indicates that your system is connected directly to the Internet.\n\nTo configure Internet Connection Firewall manually for a connection, follow these steps:\n\nClick Start, and then click Control Panel.\n\nIn the default Category View, click Networking and Internet Connections, and then click Network Connections.\n\nRight-click the connection on which you want to enable Internet Connection Firewall, and then click Properties.\n\nClick the Advanced tab.\n\nClick to select the Protect my computer or network by limiting or preventing access to this computer from the Internet check box, and then click OK.\n\nNote If you want to enable the use of some programs and services through the firewall, click Settings on the Advanced tab, and then select the programs, protocols, and services needed.\n\nBlock the following at the firewall:\n\nUDP ports 135, 137, 138, and 445, and TCP ports 135, 139, 445, and 593\n\nAll unsolicited inbound traffic on ports greater than 1024\n\nAny other specifically configured RPC port\n\nThese ports are used to initiate a connection with RPC. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability. Also, make sure that you block any other specifically configured RPC port on the remote system. Microsoft recommends that you block all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports. For more information about the ports that RPC uses, visit the following Web site.\n\nEnable advanced TCP/IP filtering on systems that support this feature.\n\nYou can enable advanced TCP/IP filtering to block all unsolicited inbound traffic. For more information about how to configure TCP/IP filtering, see Microsoft Knowledge Base Article 309798.\n\nBlock the affected ports by using IPSec on the affected systems.\n\nUse Internet Protocol Security (IPSec) to help protect network communications. Detailed information about IPSec and how to apply filters is available in Microsoft Knowledge Base Articles 313190 and 813878.\n\nFAQ for LSASS Vulnerability - CAN-2003-0533:\n\nWhat is the scope of the vulnerability?\n\nThis is a buffer overrun vulnerability. An attacker who successfully exploited this vulnerability could remotely take complete control of an affected system, including installing programs; viewing, changing, or deleting data; or creating new accounts that have full privileges.\n\nWhat causes the vulnerability?\n\nAn unchecked buffer in the LSASS service.\n\nWhat is LSASS?\n\nLocal Security Authority Subsystem Service (LSASS) provides an interface for managing local security, domain authentication, and Active Directory processes. It handles authentication for the client and for the server. It also contains features that are used to support Active Directory utilities.\n\nWhat might an attacker use the vulnerability to do?\n\nAn attacker who successfully exploited this vulnerability could take complete control of the affected system.\n\nWho could exploit the vulnerability?\n\nOn Windows 2000 and Windows XP, any anonymous user who could deliver a specially crafted message to the affected system could attempt to exploit this vulnerability.\n\nHow could an attacker exploit this vulnerability?\n\nAn attacker could exploit the vulnerability by creating a specially crafted message and sending the message to an affected system, which could then cause the affected system to execute code.\n\nAn attacker could also access the affected component through another vector. For example, an attacker could log on to the system interactively or by using another program that passes parameters to the vulnerable component (locally or remotely).\n\nWhat systems are primarily at risk from the vulnerability?\n\nWindows 2000 and Windows XP are primarily at risk from this vulnerability.\n\nWindows Server 2003 and Windows XP 64-Bit Edition Version 2003 provide additional protection that would require an administrator to log on locally to an affected system to exploit this vulnerability.\n\nWhat does the update do?\n\nThe update removes the vulnerability by modifying the way that LSASS validates the length of a message before it passes the message to the allocated buffer.\n\nThis update also removes the vulnerable code from Windows 2000 Professional and from Windows XP because these operating systems do not require the vulnerable interface. This helps protect against possible future vulnerabilities in this service.\n\nLDAP Vulnerability - CAN-2003-0663:\n\nA denial of service vulnerability exists that could allow an attacker to send a specially crafted LDAP message to a Windows 2000 domain controller. An attacker could cause the service responsible for authenticating users in an Active Directory domain to stop responding.\n\nMitigating Factors for LDAP Vulnerability - CAN-2003-0663:\n\nTo exploit this vulnerability, an attacker would have to send a specially crafted LDAP message to the domain controller. If the LDAP ports are not blocked by a firewall, an attacker would not require any additional privileges to exploit this vulnerability.\n\nThis vulnerability only affects Windows 2000 Server domain controllers; Windows Server 2003 domain controllers are not affected.\n\nWindows NT 4.0 and Windows XP are not affected by this vulnerability.\n\nIf an attacker successfully exploited this vulnerability, the affected system might display a warning that it would automatically restart after a 60-second countdown. At the end of this 60-second countdown, the affected system would automatically restart. After restart, the affected system would be restored to normal functionality. However, the affected system could be susceptible to a new denial of service attack unless the update is applied.\n\nFirewall best practices and standard default firewall configurations can help protect networks from attacks originating outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed.\n\nWorkarounds for LDAP Vulnerability - CAN-2003-0663:\n\nMicrosoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.\n\nBlock LDAP TCP ports 389, 636, 3268, and 3269 at your firewall.\n\nThese ports are used to initiate an LDAP connection with a Windows 2000 domain controller. Blocking them at the firewall will help prevent systems that are behind that firewall from attempts to exploit this vulnerability that originate outside the enterprise perimeter. While other ports could be used to exploit this vulnerability, the ports listed are the most common attack vectors. Microsoft recommends blocking all unsolicited inbound communication from the Internet to help prevent attacks that may use other ports.\n\nImpact of workaround: Active Directory domain authentication will not be possible over a network connection where these ports are blocked.\n\nFAQ for LDAP Vulnerability - CAN-2003-0663:\n\nWhatâs the scope of the vulnerability?\n\nThis is a denial of service vulnerability. An attacker who exploited this vulnerability could cause the server to automatically restart and, during that time, stop the server from responding to authentication requests. This vulnerability exists in Windows 2000 Server systems that perform the role of a domain controller. The only effect on other Windows 2000 systems is that clients may not be able to log on to the domain if their domain controller stops responding.\n\nWhat causes the vulnerability?\n\nThe processing of specially crafted LDAP messages by the Local Security Authority Subsystem Service (LSASS).\n\nWhat is LDAP?\n\nLightweight Directory Access Protocol (LDAP) is an industry-standard protocol that enables authorized users to query or modify the data in a metadirectory. For example, in Windows 2000, LDAP is one protocol that is used to access data in Active Directory.\n\nWhatâs wrong with the way the specially crafted LDAP messages are handled?\n\nAn attacker could send a specially crafted LDAP message to the LSASS service and cause it to stop responding.\n\nWhat is LSASS?\n\nLocal Security Authority Subsystem Service (LSASS) provides an interface for managing local security, domain authentication, and Active Directory processes. It handles authentication for the client and for the server. It also contains features that are used to support Active Directory utilities.\n\nWhat might an attacker use the vulnerability to do?\n\nAn attacker who exploited this vulnerability could cause LSASS to stop responding and the affected system to restart. The affected system might display a warning that it would automatically restart after a 60-second countdown. During this 60 second countdown, local authentication at the console of the affected system and user domain authentication with the affected system would not be possible. At the end of this 60-second countdown, the affected system would automatically restart. If users cannot perform domain authentication with the affected system, they might not be able to access domain resources. After restart, the affected system would be restored to normal functionality. However, it could be susceptible to a new denial of service attack unless the update is applied.\n\nWho could exploit the vulnerability?\n\nAny anonymous user who could deliver the specially crafted LDAP message to the affected system could exploit this vulnerability.\n\nHow could an attacker exploit the vulnerability?\n\nAn attacker could exploit this vulnerability by sending a specially crafted LDAP message to the domain controllers in a single forest or multiple forests, potentially causing a denial of service to domain authentication throughout an enterprise. This could cause LSASS to stop responding and cause the affected system to restart. An attacker does not have to have a valid user account in the domain to send this specially crafted LDAP message. This attack can be performed by using anonymous access.\n\nWhat systems are primarily at risk from the vulnerability?\n\nOnly Windows 2000 domain controllers are vulnerable.\n\nI am running Windows 2000. What systems do I have to update?\n\nThe update to address this vulnerability must be installed on systems that are used as Windows 2000 domain controllers. However, the update can be safely installed on Windows 2000 Servers in other roles. Microsoft recommends that you install this update on systems that might be promoted to domain controllers in the future.\n\nWhat does the update do?\n\nThe update removes the vulnerability by modifying the way that LSASS processes the specially crafted LDAP message.\n\nPCT Vulnerability - CAN-2003-0719:\n\nA buffer overrun vulnerability exists in the Private Communications Transport (PCT) protocol, which is part of the Microsoft Secure Sockets Layer (SSL) library. Only systems that have SSL enabled, and in some cases Windows 2000 domain controllers, are vulnerable. An attacker who successfully exploited this vulnerability could take complete control of an affected system.\n\nMitigating Factors for PCT Vulnerability - CAN-2003-0719:\n\nOnly systems that have enabled SSL are affected, typically only server systems. SSL support is not enabled by default on any of the affected systems. However, SSL is generally used on Web servers to support electronic commerce programs, online banking, and other programs that require secure communications.\n\nWindows Server 2003 is only vulnerable to this issue if an administrator has manually enabled PCT (even if SSL has been enabled).\n\nIn some situations, the Web Publishing features of ISA Server 2000 or Proxy Server 2.0 can successfully block attempts to exploit this vulnerability. Testing has shown that the Web publishing features of ISA Server 2000, with Packet Filtering enabled and all Packet Filtering options selected can successfully block this attack with no noticeable side effects. Proxy Server 2.0 also successfully blocks this attack. However, until the security update is applied on the Proxy Server 2.0 system, this attack causes Proxy Server 2.0 Web services to stop responding and the system must be restarted.\n\nFirewall best practices and standard default firewall configurations can help protect networks from attacks that originate outside the enterprise perimeter. Best practices recommend that systems that are connected to the Internet have a minimal number of ports exposed.\n\nWorkarounds for PCT Vulnerability - CAN-2003-0719:\n\nMicrosoft has tested the following workarounds. While these workarounds will not correct the underlying vulnerability, they help block known attack vectors. When a workaround reduces functionality, it is identified below.\n\nDisable PCT support through the registry\n\nThis workaround is fully documented in Microsoft Knowledge Base Article 187498. This article is summarized below.\n\nThe following steps demonstrate how to disable the PCT 1.0 protocol that prevents the affected system from negotiating its use.\n\nNote Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk.\n\nFor information about how to edit the registry, view the \"Changing Keys And Values\" Help topic in Registry Editor (Regedit.exe) or the \"Add and Delete Information in the Registry\" and \"Edit Registry Data\" Help topics in Regedt32.exe.\n\nNote It is a good idea to back up the registry before you edit it.\n\nClick Start, click Run, type \"regedt32\" (without the quotation marks), and then click OK.\n\nIn Registry Editor, locate the following registry key:\n\nHKey_Local_Machine\\System\\CurrentControlSet\\Control\\SecurityProviders\\SCHANNEL\\Protocols\\PCT 1.0\\Server\n\nIn the Edit menu, click Add Value to create a new REG_DWORD value called \"Enabled\" in the Server subkey.\n\nIn the Data Type list, click REG_DWORD.\n\nIn the Value Name text box, type \"Enabled\" (without the quotation marks), and then click OK.\n\nNote If this value is already present, double-click on the value to edit its current value, and then go to step 6.\n\nIn the Binary Editor, set the new keys value to equal 0 by typing the following string: 00000000.\n\nClick OK, and then restart the system.\n\nNote To enable PCT, change the value of the Enabled registry key to 00000001, and then restart the system.\n\nNote If you are using Windows XP RTM you must also create a second registry key to fully disable PCT. This is not required on later versions of Windows XP or other affected operating systems. Use the instructions provided earlier and create a second REG_DWORD value named âClientâ. Use the same values as documented earlier.\n\nFAQ for PCT Vulnerability - CAN-2003-0719:\n\nWhatâs the scope of the vulnerability?\n\nA buffer overrun vulnerability exists in the Private Communications Transport (PCT) protocol, which is part of the Microsoft Secure Sockets Layer (SSL) library. Only systems that have SSL enabled, and in some cases Windows 2000 domain controllers, are vulnerable.\n\nAll programs that use SSL could be affected. Although SSL is generally associated with Internet Information Services by using HTTPS and port 443, any service that implements SSL on an affected platform is likely to be vulnerable. This includes but is not limited to, Microsoft Internet Information Services 4.0, Microsoft Internet Information Services 5.0, Microsoft Internet Information Services 5.1, Microsoft Exchange Server 5.5, Microsoft Exchange Server 2000, Microsoft Exchange Server 2003, Microsoft Analysis Services 2000 (included with SQL Server 2000), and any third-party programs that use PCT. SQL Server 2000 is not vulnerable because it specifically blocks PCT connections.\n\nWindows Server 2003 and Internet Information Services 6.0 are only vulnerable to this issue if an administrator has manually enabled PCT (even if SSL has been enabled).\n\nAn attacker who successfully exploited this vulnerability could take complete control of an affected system, including installing programs; viewing, changing, or deleting data; or creating new accounts that have full privileges.\n\nWhat causes the vulnerability?\n\nThe process used by the SSL Library to check message inputs.\n\nWhat is the SSL library?\n\nThe Microsoft Secure Sockets Layer (SSL) library contains support for a number of secure communication protocols. These include Transport Layer Security 1.0 (TLS 1.0), Secure Sockets Layer 3.0 (SSL 3.0), and the older and seldom-used Secure Sockets Layer 2.0 (SSL 2.0), and Private Communication Technology 1.0 (PCT 1.0) protocol.\n\nThese protocols provide an encrypted connection between a server and a client system. SSL can help protect information when transmitted across public networks such as the Internet. SSL support requires an SSL certificate, which must be installed on a server. For more information about SSL, see Microsoft Knowledge Base Article 245152.\n\nWhat is PCT?\n\nPrivate Communication Technology (PCT) is a protocol developed by Microsoft and Visa International for encrypted communication on the Internet. It was developed as an alternative to SSL 2.0. It is similar to SSL. The message formats are similar enough that a server can interact with clients that support SSL as well as clients that support PCT.\n\nPCT is an earlier protocol that has been replaced by SSL 3.0 and is no longer generally used. The Microsoft Secure Sockets Layer (SSL) library supports PCT only for backward compatibility. Most modern programs and servers use SSL 3.0, and PCT is no longer required. For more detailed information, visit the MSDN Library Web site.\n\nWhat might an attacker use the vulnerability to do?\n\nAn attacker who successfully exploited this vulnerability could take complete control of an affected system, including installing programs; viewing, changing, or deleting data; or creating new accounts that have full privileges.\n\nWho could exploit the vulnerability?\n\nAny anonymous attacker who could deliver a specially crafted TCP message to an SSL enabled service on an affected system could attempt to exploit this vulnerability.\n\nHow could an attacker exploit this vulnerability?\n\nAn attacker could exploit this vulnerability by communicating with an affected system through an SSL enabled service and sending a specially crafted TCP message. Receipt of such a message could cause the affected service on the vulnerable system to fail in such a way that it could execute code.\n\nAn attacker could also access the affected component through another vector. For example, an attacker could log on to the system interactively or by using another program that passes parameters to the vulnerable component (locally or remotely).\n\nWhat systems are primarily at risk from the vulnerability?\n\nAll programs that use SSL could be affected. Although SSL is generally associated with Internet Information Services by using HTTPS and port 443, any service that implements SSL on an affected platform is likely to be vulnerable. This includes but is not limited to, Internet Information Services 4.0, Internet Information Services 5.0, Internet Information Services 5.1, Exchange Server 5.5, Exchange Server 2000, Exchange Server 2003, Analysis Services 2000 (included with SQL Server 2000), and any third-party programs that use PCT. SQL Server 2000 is not vulnerable because it specifically blocks PCT connections.\n\nWindows Server 2003 and Internet Information Services 6.0 are only vulnerable to this issue if an administrator has manually enabled PCT (even if SSL has been enabled).\n\nActive Directory domains that have an Enterprise Root certification authority installed are also affected by this vulnerability because Windows 2000 domain controllers will automatically listen for SSL connections.\n\nHow is Windows Server 2003 affected?\n\nThe way that Windows Server 2003 implements PCT contains the same buffer overrun that is found on other