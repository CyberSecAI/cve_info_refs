- **Root cause of vulnerability**: A buffer overflow vulnerability exists in the `mysql_real_connect` function within the `libmysqlclient` library when handling Unix socket names. Specifically, the `strmov` function is used to copy the provided socket name into a fixed-size buffer (`sun_path`), without proper bounds checking.
- **Weaknesses/vulnerabilities present**: Stack-based buffer overflow. The `sun_path` buffer, which is part of the `sockaddr_un` structure, has a fixed size of 108 bytes. Supplying a socket name larger than this size will overwrite other stack data, including the return address (EIP).
- **Impact of exploitation**: An attacker can overwrite the return address on the stack, allowing arbitrary code execution. This is because by controlling the EIP register, the attacker can redirect the program's execution to a location they control.
- **Attack vectors**: The attack vector is supplying a long socket name to `mysql_real_connect`. This can be done through the `-S` command line option when using the mysql client or via the `ini_set("mysql.default_socket", ...)` function call in PHP.
- **Required attacker capabilities/position**: The attacker needs to be able to provide an overly long socket name to the `mysql_real_connect` function call, either through command line arguments, or using php settings. The attacker can trigger the vulnerability from the command line or through a web script.