=== Content from www.aqtronix.com_0a7b7994_20250125_175650.html ===
AQTRONIX Security Advisory AQ-2003-02
=====================================
Topic: Microsoft IIS Logging Failure
Release date: 28 December 2003
Affected Systems: IIS 5.0 (previous versions not tested)
Not Affected Systems: IIS 6.0
Category: Failure to log certain activity, information disclosure
without notice
Vendor URL: http://www.microsoft.com
Author: Parcifal Aertssen
This document (and updates) is available at:
http://www.aqtronix.com/Advisories/AQ-2003-02.txt
Introduction
============
The HTTP protocol consists of requests and responses. Requests are
sent from the clients (browsers) and they always start with a certain
keyword (verb). The most common request is a "GET" request, but there
are many more of these verbs, all of them are well documented within
the RFCs. But one of these verbs that Microsoft uses is not: it's the
"TRACK" request. The TRACK request returns the original request as an
entity (with a content-type of "message/http" and the returned body
contains your original request), just like a TRACE request. The TRACE
request is RFC compliant and well documented, the TRACK request is
not RFC compliant and not documented (only one page mentions this verb
in the MSDN library with no explanation).
Details
=======
Making an HTTP request with the verb TRACK is not being logged. This
makes it quite critical because it can be used to produce a lot of
traffic and to get the 'Server' header and other valuable information.
Furthermore because the TRACK request is the same as a TRACE request,
all known problems with TRACE requests also apply for this verb.
The most important issue with a TRACE request is cross-site
tracing (XST): a malicious web page or e-mail can send a TRACE/TRACK
request to another website (by using client side scripting) and by
analysing the response it can have access to your credentials and
your cookies on that site (think: session hijacking, passwords,...).
All unpatched and future exploits that work with a TRACE request,
should also work with the TRACK request but this time without being
logged, making it ideal for probing vulnerable IIS systems.
IIS 6 is not vulnerable. The IIS team probably found the bug and
removed it silently and didn't care about patching previous
versions of IIS because that's not part of their Trustworthy
Computing Initiative.
Exploit
=======
You can reproduce the problem using a tool like netcat and send the
following line, followed by two CRLF pairs:
TRACK / HTTP/1.0
You will see the response from IIS (just like a TRACE request), but
you won't find this in the IIS log files.
Vendor Response
================
I did not contact Microsoft about this vulnerability, because they
did not acknowledge me for my previous discovery. I found the ASP
Headers DoS (MS03-018) and received a private patch after 2 months.
They decided to release the patch in a cumulative one, even though
they had a patch ready. I thought this was a positive thing, the
less patches, the less work for me too. So I waited another 3 months
and still no word from Microsoft. When almost 6 months had passed,
I decided to go public, because I waited until "Microsoft could fix
the problem before malicious users even knew it existed", as it says
in their policy, they COULD have fixed it. One month later the
cumulative patch was released, but no acknowledgement for me. I told
Microsoft about their mistake and I told them I had other
vulnerabilities waiting, with no results, they simply ignored me.
So I decided to change my policy and release at least one advisory
without reporting anything to them.
Solution
========
Users running AQTRONIX WebKnight are protected from the first day
they installed it, people using Microsoft urlscan should add the
TRACK verb to the DenyVerbs section and make sure it is not in the
AllowVerbs section in the urlscan.ini file.
AQTRONIX WebKnight can be downloaded at:
http://www.aqtronix.com/webknight/
History
=======
2003.01.02 Found the vulnerability.
2003.05.29 Decided not to mail it to Microsoft
2003.12.28 Released initial advisory
Disclaimer
==========
The information in this advisory and any of its demonstrations is provided
"as is" without warranty of any kind.
AQTRONIX is not liable for any direct or indirect damages caused as a result
of using the information or demonstrations provided in any part of this
advisory.


=== Content from www.kb.cert.org_f193ba81_20250125_175651.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#288308

## Microsoft Internet Information Server (IIS) vulnerable to cross-site scripting via HTTP TRACK method

#### Vulnerability Note VU#288308

Original Release Date: 2004-01-05 | Last Revised: 2004-01-09

---

### Overview

Microsoft Internet Information Server (IIS) servers support a HTTP method called TRACK. The HTTP TRACK method returns the contents of client HTTP requests in the entity-body of the TRACK response. This behavior could be leveraged by attackers to access sensitive information, such as cookies or authentication data, contained in the HTTP headers of the request.

### Description

| Microsoft IIS servers support the HTTP TRACK method. The HTTP TRACK method asks a web server to echo the contents of the request back to the client for debugging purposes. The TRACK request is not RFC compliant and not well documented.  The complete request, including HTTP headers, is returned in the entity-body of a TRACK response. This leads to a Cross-site Scripting attack. Using features that provide client-side HTTP protocol support, such as [XMLHTTP](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/htm/xml_obj_ixmlhttprequest_8bp0.asp) ActiveX or XMLDOM scripting objects, a web site can cause browsers to issue TRACK requests. The site can read the TRACK response, including sensitive header information such as cookies or authentication data. Because the TRACK method is similar to the TRACE method, when combined with cross-domain browser vulnerabilities ([VU#244729](http://www.kb.cert.org/vuls/id/244729), [VU#711843](http://www.kb.cert.org/vuls/id/711843), [VU#728563](http://www.kb.cert.org/vuls/id/728563)), HTTP TRACK and client-side HTTP support can be leveraged by attackers to read sensitive header information from third-party domains. This technique has been termed "Cross-Site Tracing," or XST, in a [report](http://www.cgisecurity.com/whitehat-mirror/WhitePaper_screen.pdf) published by WhiteHat Security. As noted in the report, the technique can be used to bypass the [HttpOnly](http://msdn.microsoft.com/workshop/author/dhtml/httponly_cookies.asp) cookie attribute introduced in Microsoft Internet Explorer 6.0 SP1. HttpOnly blocks script access to the [cookie](http://msdn.microsoft.com/workshop/author/dhtml/reference/properties/cookie.asp) property (document.cookie), but does not prevent a scripting object from reading the cookie out of an HTTP TRACK response.IIS 6 is reported to be not vulnerable. |
| --- |

### Impact

| Attackers may abuse HTTP TRACK functionality to gain access to information in HTTP headers such as cookies and authentication data. In the presence of other cross-domain vulnerabilities in web browsers, sensitive header information could be read from any domains that support the HTTP TRACK method. |
| --- |

### Solution

| Microsoft IIS 6 is reported to be not vulnerable. The TRACK method can be added to Microsoft's URLScan DenyVerbs section. It should not be in the AllowVerbs section in the urlscan.ini file. |
| --- |

### Vendor Information

288308
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23288308/) to view vendors.**
### [Microsoft Corporation](#JARL-5UWQGW) Affected

Updated:  January 05, 2004

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

The vendor has not provided us with any further information regarding this vulnerability.

### Addendum

IIS 6 is reported as not vulnerable.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 0 | AV:--/AC:--/Au:--/C:--/I:--/A:-- |
| Temporal | 0 | E:Not Defined (ND)/RL:Not Defined (ND)/RC:Not Defined (ND) |
| Environmental | 0 | CDP:Not Defined (ND)/TD:Not Defined (ND)/CR:Not Defined (ND)/IR:Not Defined (ND)/AR:Not Defined (ND) |

### References

* <http://www.microsoft.com>
* <http://www.aqtronix.com/Advisories/AQ-2003-02.txt>
### Acknowledgements

Thanks to Parcifal Aertssen for reporting this vulnerability.

This document was written by Jason A Rafail and Art Manion.

### Other Information

| **CVE IDs:** | [CVE-2003-1567](http://web.nvd.nist.gov/vuln/detail/CVE-2003-1567) |
| --- | --- |
| **Date Public:** | 2003-12-28 |
| **Date First Published:** | 2004-01-05 |
| **Date Last Updated:** | 2004-01-09 19:06 UTC |
| **Document Revision:** | 12 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


