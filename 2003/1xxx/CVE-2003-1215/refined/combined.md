=== Content from www.phpbb.com_c23d0275_20250125_143121.html ===


# [phpBB • Free and Open Source Forum Software](/)

[![RSS](/assets/images/icons/rss-20.png)](/feeds/rss/)
[![Facebook](/assets/images/icons/facebook-20.png)](http://www.facebook.com/phpBB)
[![Twitter](/assets/images/icons/twitter-20.png)](http://www.twitter.com/phpbb)

Menu

* [About](/about/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Features](/about/features/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Learn about the features that phpBB has to offer.](/about/features/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Demo](/demo/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Give phpBB a try with a fully-featured demo board.](/demo/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Showcase](/showcase/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [A showcase of popular and unique sites using phpBB.](/showcase/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Get Involved](/get-involved/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Learn how you can get involved with the project.](/get-involved/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [3.3 New Features](/about/launch/)

    [An overview of the new features and improvements in phpBB 3.3.](/about/launch/)
  + #### [The Team](/about/team/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Find out who is responsible for all the mayhem.](/about/team/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Contact Us](/about/contact_us.php?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Have a question the forums don't answer? Come here.](/about/contact_us.php?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Advertising](/about/advertise/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Information if you want to advertise on phpBB.com.](/about/advertise/?sid=6f68f65f80243811ec38f38d4dc8a158)[Find out more about the project »](/about/?sid=6f68f65f80243811ec38f38d4dc8a158)
* [Downloads](/downloads/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Latest Version](/downloads/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Download the latest stable release of phpBB](/downloads/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Update Packages](/downloads/?sid=6f68f65f80243811ec38f38d4dc8a158#update)

    [Automatic Update packages for your phpBB release](/downloads/?sid=6f68f65f80243811ec38f38d4dc8a158#update)
  + #### [Language Packs](/languages/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Translate phpBB into (almost) any language you like](/languages/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Extensions](/customise/db/extensions-36?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Download extensions to enhance phpBB’s functionality](/customise/db/extensions-36?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Styles](/customise/db/styles-2?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Your forums need a new look? Browse our Styles DB](/customise/db/styles-2?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Official Tools](/customise/db/official_tools-23?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Official tools by the phpBB team to assist you with your board](/customise/db/official_tools-23?sid=6f68f65f80243811ec38f38d4dc8a158)
* [Customise](/customise/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Customisation Database](/customise/db/?sid=6f68f65f80243811ec38f38d4dc8a158)

    ![Customisation Database](/assets/images/images/customisation-db-icon.png)

    [Our customisation database contains just about everything you might need to customise your phpBB board to your liking. In it you will find Extensions, MODs (for 3.0.x), Styles, Language Packs, BBCodes, as well as various tools.](/customise/db/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Extensions](/extensions/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Guides on how to use them and how to create your own.](/extensions/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Extensions DB](/customise/db/extensions-36?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Download or submit extensions to our extensions database.](/customise/db/extensions-36?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Styles](/styles/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Guides on how to use them and to create your own styles.](/styles/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Styles DB](/customise/db/styles-2?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Download or submit styles to our styles database.](/customise/db/styles-2?sid=6f68f65f80243811ec38f38d4dc8a158)More resources on customising your board »
* [Support](/support/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Documentation](/support/docs/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Installation guide and the complete documentation.](/support/docs/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Knowledge Base](/support/docs/en/3.3/kb/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Team and user submitted ar­ticles covering support areas.](/support/docs/en/3.3/kb/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Support Forums](/support/forums/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [The Support related areas in our community forums.](/support/forums/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Discord / IRC](/support/chat?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Visit our Discord or IRC support channels.](/support/chat?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [International Support](/support/intl/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Find a 3rd party support site in your first language.](/support/intl/?sid=6f68f65f80243811ec38f38d4dc8a158)[More information on support »](/support/?sid=6f68f65f80243811ec38f38d4dc8a158)
* [Development](/development/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Area51 phpBB Development](//area51.phpbb.com/)

    ![Area51 Alien](/assets/images/images/area51/alien32.png?2014300900)

    [All Development Discussion takes place at Area51. Bug tracker, development wiki, continuous integration and other development tools are located here. Find out how to get involved in phpBB development.](//area51.phpbb.com/)
  + #### [phpBB Bug Tracker](http://tracker.phpbb.com/)

    [Report problems with phpBB core and other sub-projects such as the Website, Customisation DB, and Team Tools here.](http://tracker.phpbb.com/)
  + #### [phpBB Ideas](/community/ideas/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Suggest, vote on and comment on ideas for phpBB.](/community/ideas/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Security Tracker](https://tracker.phpbb.com/secure/BrowseProjects.jspa#10020)

    [The tracker for security issues in phpBB or validated MODs.](https://tracker.phpbb.com/secure/BrowseProjects.jspa#10020)
  + #### Development Wiki

    Share experience and learn more about the codebase.
  + #### [GSoC](/development/gsoc/?sid=6f68f65f80243811ec38f38d4dc8a158)

    [Google Summer of Code is an annual program in which Google awards stipends to students participating in coding projects for free and open source software projects.](/development/gsoc/?sid=6f68f65f80243811ec38f38d4dc8a158)[Participate in phpBB development now »](/development/?sid=6f68f65f80243811ec38f38d4dc8a158)
* [Blog](//blog.phpbb.com/)
* [Community](/community/?sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Support Forums](/community/viewforum.php?f=551&sid=6f68f65f80243811ec38f38d4dc8a158)

    [Help with installation & running phpBB – search first!](/community/viewforum.php?f=551&sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Extensions Forums](/community/viewforum.php?f=451&sid=6f68f65f80243811ec38f38d4dc8a158)

    [Discuss and view Extensions that are available for download.](/community/viewforum.php?f=451&sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Styles Forums](/community/viewforum.php?f=471&sid=6f68f65f80243811ec38f38d4dc8a158)

    [Discuss and view Styles that are available for download.](/community/viewforum.php?f=471&sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [phpBB Discussion](/community/viewforum.php?f=64&sid=6f68f65f80243811ec38f38d4dc8a158)

    [Discussions on all things phpBB: features, future, etc.](/community/viewforum.php?f=64&sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [General Discussion](/community/viewforum.php?f=6&sid=6f68f65f80243811ec38f38d4dc8a158)

    [General discussion and intelligent conversations.](/community/viewforum.php?f=6&sid=6f68f65f80243811ec38f38d4dc8a158)
  + #### [Area51](//area51.phpbb.com/phpBB/)

    [Bleeding edge testing and development discussion.](//area51.phpbb.com/phpBB/)[… and many more forums »](/community/?sid=6f68f65f80243811ec38f38d4dc8a158)
* [Hosting](/hosting/?sid=6f68f65f80243811ec38f38d4dc8a158)

* Quick links

  + [Unanswered topics](./search.php?search_id=unanswered&sid=6f68f65f80243811ec38f38d4dc8a158)
  + [Active topics](./search.php?search_id=active_topics&sid=6f68f65f80243811ec38f38d4dc8a158)
  + [Search](./search.php?sid=6f68f65f80243811ec38f38d4dc8a158)
* [FAQ](/community/help/faq?sid=6f68f65f80243811ec38f38d4dc8a158 "Frequently Asked Questions")
* [Login](./ucp.php?mode=login&redirect=viewtopic.php%3Ff%3D14%26t%3D161943&sid=6f68f65f80243811ec38f38d4dc8a158 "Login")
* [Register](./ucp.php?mode=register&sid=6f68f65f80243811ec38f38d4dc8a158)

* [Board index](./index.php?sid=6f68f65f80243811ec38f38d4dc8a158)
  [General](./viewforum.php?f=47&sid=6f68f65f80243811ec38f38d4dc8a158)
  [Announcements](./viewforum.php?f=14&sid=6f68f65f80243811ec38f38d4dc8a158)
* [Search](./search.php?sid=6f68f65f80243811ec38f38d4dc8a158 "View the advanced search options")

## [New packages available - Security related](./viewtopic.php?t=161943&sid=6f68f65f80243811ec38f38d4dc8a158)

**Read me first before posting anywhere!**

Subscribe to the feed, available in [![Image](https://www.phpbb.com/assets/images/images/feed-icon-14x14.png) Atom](https://www.phpbb.com/feeds/atom/) or [![Image](https://www.phpbb.com/assets/images/images/feed-icon-14x14.png) RSS](https://www.phpbb.com/feeds/rss/) format.

[![Get Involved](./styles/prosilver/theme/ads/upper_get_involved.png)](/get-involved/?from=upper_ad&sid=6f68f65f80243811ec38f38d4dc8a158)
**Forum rules**

**READ: [phpBB.com Board-Wide Rules and Regulations](https://www.phpbb.com/rules/)**

[Post Reply](./posting.php?mode=reply&t=161943&sid=6f68f65f80243811ec38f38d4dc8a158 "Post a reply")

* [Print view](./viewtopic.php?t=161943&sid=6f68f65f80243811ec38f38d4dc8a158&view=print "Print view")

Search

[Advanced search](./search.php?sid=6f68f65f80243811ec38f38d4dc8a158 "Advanced search")

1 post
• Page **1** of **1**

[![User avatar](./download/file.php?avatar=5_1180199503.gif)](./memberlist.php?mode=viewprofile&u=5&sid=6f68f65f80243811ec38f38d4dc8a158)
[psoTFX](./memberlist.php?mode=viewprofile&u=5&sid=6f68f65f80243811ec38f38d4dc8a158)
Former Team Member
**Posts:** [7425](./search.php?author_id=5&sr=posts&sid=6f68f65f80243811ec38f38d4dc8a158) **Joined:** Tue Jul 03, 2001 8:50 pm

### [New packages available - Security related](./viewtopic.php?p=910621&sid=6f68f65f80243811ec38f38d4dc8a158#p910621)

* [Quote](./posting.php?mode=quote&p=910621&sid=6f68f65f80243811ec38f38d4dc8a158 "Reply with quote")

[Post](./viewtopic.php?p=910621&sid=6f68f65f80243811ec38f38d4dc8a158#p910621 "Post")
by **[psoTFX](./memberlist.php?mode=viewprofile&u=5&sid=6f68f65f80243811ec38f38d4dc8a158)** » Thu Jan 01, 2004 12:13 am

We have been alerted to two potential vulnerabilities in the existing 2.0.6 package. One is cross-site scripting related while another may allow specific users (group moderators) to exploit an inproper data validation issue. While it is doubtful these have been actively exploited (particularly the group moderator issue) both are serious enough to warrant you updating as soon as possible.

New packages are now available from the download page. For those not wishing (or able due to sheer numbers of mods, etc.) to update via these packages please ensure you make the changes listed below.

Open privmsg.php in your favourite editor. Find the following code fragment:

Code: Select all

```
if ( isset($HTTP_POST_VARS['folder']) || isset($HTTP_GET_VARS['folder']) )
{
	$folder = ( isset($HTTP_POST_VARS['folder']) ) ? $HTTP_POST_VARS['folder'] : $HTTP_GET_VARS['folder'];

	if ( $folder != 'inbox' && $folder != 'outbox' && $folder != 'sentbox' && $folder != 'savebox' )
	{
		$folder = 'inbox';
	}
}
else
{
	$folder = 'inbox';
}

```

Replace with:

Code: Select all

```
if ( isset($HTTP_POST_VARS['folder']) || isset($HTTP_GET_VARS['folder']) )
{
	$folder = ( isset($HTTP_POST_VARS['folder']) ) ? $HTTP_POST_VARS['folder'] : $HTTP_GET_VARS['folder'];
	$folder = htmlspecialchars($folder);

	if ( $folder != 'inbox' && $folder != 'outbox' && $folder != 'sentbox' && $folder != 'savebox' )
	{
		$folder = 'inbox';
	}
}
else
{
	$folder = 'inbox';
}

```

Find:

Code: Select all

```
if ( !empty($HTTP_POST_VARS['mode']) || !empty($HTTP_GET_VARS['mode']) )
{
	$mode = ( !empty($HTTP_POST_VARS['mode']) ) ? $HTTP_POST_VARS['mode'] : $HTTP_GET_VARS['mode'];
}
else
{
	$mode = '';
}

```

Replace with:

Code: Select all

```
if ( !empty($HTTP_POST_VARS['mode']) || !empty($HTTP_GET_VARS['mode']) )
{
	$mode = ( !empty($HTTP_POST_VARS['mode']) ) ? $HTTP_POST_VARS['mode'] : $HTTP_GET_VARS['mode'];
	$mode = htmlspecialchars($mode);
}
else
{
	$mode = '';
}

```

Save the changes.

Open groupcp.php and find the following:

Code: Select all

```
if ( isset($HTTP_POST_VARS['mode']) || isset($HTTP_GET_VARS['mode']) )
{
	$mode = ( isset($HTTP_POST_VARS['mode']) ) ? $HTTP_POST_VARS['mode'] : $HTTP_GET_VARS['mode'];
}
else
{
	$mode = '';
}

```

Replace with:

Code: Select all

```
if ( isset($HTTP_POST_VARS['mode']) || isset($HTTP_GET_VARS['mode']) )
{
	$mode = ( isset($HTTP_POST_VARS['mode']) ) ? $HTTP_POST_VARS['mode'] : $HTTP_GET_VARS['mode'];
	$mode = htmlspecialchars($mode);
}
else
{
	$mode = '';
}

```

Find:

Code: Select all

```
				if ( ( ( isset($HTTP_POST_VARS['approve']) || isset($HTTP_POST_VARS['deny']) ) && isset($HTTP_POST_VARS['pending_members']) ) || ( isset($HTTP_POST_VARS['remove']) && isset($HTTP_POST_VARS['members']) ) )
				{

					$members = ( isset($HTTP_POST_VARS['approve']) || isset($HTTP_POST_VARS['deny']) ) ? $HTTP_POST_VARS['pending_members'] : $HTTP_POST_VARS['members'];

					$sql_in = '';
					for($i = 0; $i < count($members); $i++)
					{
						$sql_in .= ( ( $sql_in != '' ) ? ', ' : '' ) . $members[$i];
					}

```

Replace with:

Code: Select all

```
				if ( ( ( isset($HTTP_POST_VARS['approve']) || isset($HTTP_POST_VARS['deny']) ) && isset($HTTP_POST_VARS['pending_members']) ) || ( isset($HTTP_POST_VARS['remove']) && isset($HTTP_POST_VARS['members']) ) )
				{

					$members = ( isset($HTTP_POST_VARS['approve']) || isset($HTTP_POST_VARS['deny']) ) ? $HTTP_POST_VARS['pending_members'] : $HTTP_POST_VARS['members'];

					$sql_in = '';
					for($i = 0; $i < count($members); $i++)
					{
						$sql_in .= ( ( $sql_in != '' ) ? ', ' : '' ) . intval($members[$i]);
					}

```

Save the changes and upload both files, replacing the existing versions.

Please note that we continue to receive reports of the search\_id issue. This is known and has been fixed in 2.0.6 for many many weeks. Unless you downloaded the package/s for a short period after it was first made available you are not vulnerable. If you are unsure please review the following [topic](http://www.phpbb.com/phpBB/viewtopic.php?t=153818) [ <http://www.phpbb.com/phpBB/viewtopic.php?t=153818> ]

**Remember** always check this forum (and the downloads page) when you come across a "new" vulnerability or other issue. Please ensure you update accordingly. In doing so you are protecting yourself from all known issues and saving us time in fielding questions we've already answered ![:)](./images/smilies/icon_e_smile.gif "Smile")

[Top](#top "Top")

[Post Reply](./posting.php?mode=reply&t=161943&sid=6f68f65f80243811ec38f38d4dc8a158 "Post a reply")

* [Print view](./viewtopic.php?t=161943&sid=6f68f65f80243811ec38f38d4dc8a158&view=print "Print view")

1 post
• Page **1** of **1**

[Return to “Announcements”](./viewforum.php?f=14&sid=6f68f65f80243811ec38f38d4dc8a158)

Jump to

* [General](./viewforum.php?f=47&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Announcements](./viewforum.php?f=14&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Area 51 Development Board](./viewforum.php?f=416&sid=6f68f65f80243811ec38f38d4dc8a158)
* [Support Forums](./viewforum.php?f=551&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Support Forum](./viewforum.php?f=661&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Convertors](./viewforum.php?f=666&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Translations](./viewforum.php?f=671&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Custom BBCode Development and Requests](./viewforum.php?f=438&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Validated BBCodes](./viewforum.php?f=439&sid=6f68f65f80243811ec38f38d4dc8a158)
* [Extensions Forums](./viewforum.php?f=451&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Extensions Database Releases](./viewforum.php?f=611&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Validated Extensions Support Topics](./viewforum.php?f=541&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Extensions Database Releases](./viewforum.php?f=676&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Extension Requests](./viewforum.php?f=496&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Extensions in Development](./viewforum.php?f=456&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Abandoned Extensions](./viewforum.php?f=501&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Extension Writers Discussion](./viewforum.php?f=461&sid=6f68f65f80243811ec38f38d4dc8a158)
* [Styles Forums](./viewforum.php?f=471&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Styles Database Releases](./viewforum.php?f=576&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Styles Database Releases](./viewforum.php?f=681&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Styles Support & Discussion](./viewforum.php?f=586&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Validated Styles Support Topics](./viewforum.php?f=631&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Styles Support & Discussion](./viewforum.php?f=686&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Styles in Development](./viewforum.php?f=80&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Styles in Development](./viewforum.php?f=691&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.3.x] Abandoned Styles](./viewforum.php?f=696&sid=6f68f65f80243811ec38f38d4dc8a158)
* [Non-support Specific](./viewforum.php?f=52&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   phpBB Discussion](./viewforum.php?f=64&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   phpBB Custom Coding](./viewforum.php?f=641&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   phpBB Ideas](./viewforum.php?f=436&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   General Discussion](./viewforum.php?f=6&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Wanted!](./viewforum.php?f=656&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Test Me](./viewforum.php?f=26&sid=6f68f65f80243811ec38f38d4dc8a158)
* [phpBB Archives](./viewforum.php?f=48&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   phpBB 3.2.x Forums Archive](./viewforum.php?f=703&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Support Forum](./viewforum.php?f=556&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Convertors](./viewforum.php?f=561&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Translations](./viewforum.php?f=566&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Styles Database Releases](./viewforum.php?f=581&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Styles Support & Discussion](./viewforum.php?f=591&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Styles in Development](./viewforum.php?f=596&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Abandoned Styles](./viewforum.php?f=606&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.2.x] Extensions Database Releases](./viewforum.php?f=616&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   phpBB 3.1.x Forums Archive](./viewforum.php?f=651&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Support Forum](./viewforum.php?f=466&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Convertors](./viewforum.php?f=486&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Translations](./viewforum.php?f=491&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Styles Database Releases](./viewforum.php?f=531&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Styles Support & Discussion](./viewforum.php?f=481&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Styles in Development](./viewforum.php?f=476&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Abandoned Styles](./viewforum.php?f=601&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.1.x] Extensions Database Releases](./viewforum.php?f=536&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   phpBB 3.0.x Forums Archive](./viewforum.php?f=49&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   3.0.x Modifications Forums](./viewforum.php?f=81&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] MOD Database Releases](./viewforum.php?f=69&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Validated MODs Support Topics](./viewforum.php?f=423&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] MOD Requests](./viewforum.php?f=72&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] MODs in Development](./viewforum.php?f=70&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Abandoned MODs](./viewforum.php?f=434&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] MOD Writers Discussion](./viewforum.php?f=71&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] AutoMOD](./viewforum.php?f=225&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Support Forum](./viewforum.php?f=46&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Convertors](./viewforum.php?f=65&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Convertors Database](./viewforum.php?f=427&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Convertors Database Support](./viewforum.php?f=428&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Translations](./viewforum.php?f=66&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Translations Database](./viewforum.php?f=429&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   Translations Database Support](./viewforum.php?f=430&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Styles in Development](./viewforum.php?f=185&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Abandoned Styles](./viewforum.php?f=435&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Styles Support & Discussion](./viewforum.php?f=74&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [3.0.x] Styles Database Releases](./viewforum.php?f=73&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   phpBB2 Forums Archive](./viewforum.php?f=285&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   2.0.x Support & Discussion](./viewforum.php?f=295&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   2.0.x Support Forum](./viewforum.php?f=1&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] Convertors](./viewforum.php?f=10&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] Translations](./viewforum.php?f=50&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   2.0.x Discussion](./viewforum.php?f=18&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   2.0.x Modifications Forums](./viewforum.php?f=78&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] MOD Database Releases](./viewforum.php?f=15&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] MOD Database Cleanup](./viewforum.php?f=94&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] MOD Requests](./viewforum.php?f=17&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] MODs in Development](./viewforum.php?f=16&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] MOD Writers Discussion](./viewforum.php?f=35&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   2.0.x Styles Forums](./viewforum.php?f=77&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] Styles Database Releases](./viewforum.php?f=22&sid=6f68f65f80243811ec38f38d4dc8a158)
* [↳   [2.0.x] Styles Development & Discussion](./viewforum.php?f=23&sid=6f68f65f80243811ec38f38d4dc8a158)

* [Board index](./index.php?sid=6f68f65f80243811ec38f38d4dc8a158)
* All times are UTC
* [Delete cookies](/community/user/delete_cookies?sid=6f68f65f80243811ec38f38d4dc8a158)
* [Contact us](./memberlist.php?mode=contactadmin&sid=6f68f65f80243811ec38f38d4dc8a158)

### advertisements

[Need Hosting?](https://www.phpbb.com/hosting/)

**[BlueHost.com](https://www.phpbb.com/hosting/r/bluehost-footer/)** •
[Web Hosting UK](http://www.webhosting.uk.com/) •
[HostMonster](http://www.hostmonster.com/track/phpbbsoftwareltd/footer) •
[FastDomain Hosting](http://hosting.fastdomain.com/track/phpbbsoftwareltd/footer) •
[*Advertise on phpBB.com*](/about/advertise/?sid=6f68f65f80243811ec38f38d4dc8a158)

© 2000, 2002, 2003, 2007 [phpBB Limited](/about/?sid=6f68f65f80243811ec38f38d4dc8a158)

[Privacy](./ucp.php?mode=privacy&sid=6f68f65f80243811ec38f38d4dc8a158 "Privacy")
|
[Terms](./ucp.php?mode=terms&sid=6f68f65f80243811ec38f38d4dc8a158 "Terms")
|
[Contact Us](/about/contact_us.php?sid=6f68f65f80243811ec38f38d4dc8a158 "Contact Us")
|
[Advertise on www.phpbb.com](/about/advertise/?sid=6f68f65f80243811ec38f38d4dc8a158 "Advertise on www.phpbb.com")

###



=== Content from marc.info_a5ae1b26_20250125_143119.html ===

```
[[prev in list](?l=bugtraq&m=107273061830801&w=2)] [[next in list](?l=bugtraq&m=107273106431312&w=2)] [prev in thread] [next in thread]
List:       [bugtraq](?l=bugtraq&r=1&w=2)
Subject:    SQL Injection in phpBB's groupcp.php
From:       [Jay Gates <zarath () knightsofchaos ! com>](?a=107005726900002&r=1&w=2)
Date:       [2003-12-29 14:08:37](?l=bugtraq&r=1&w=2&b=200312)
[Download RAW [message](?l=bugtraq&m=107273069130885&q=mbox) or [body](?l=bugtraq&m=107273069130885&q=raw)]

BugTraq,

I have found an SQL injection vulnerability in phpBB. Hoever, I don't think this is \
going to be be a wide spread problem as it will only work if you are the moderator of \
a group.

How the SQL injection works:

In groupscp, it uses an array set to delete members from certain groups. This array \
set is sent through a quick loop to put all the values into a variable seperated by , \
s and then used in an IN check in the SQL query to delete the members that you've \
selected.  Code:
$members = ( isset($HTTP_POST_VARS['approve']) || isset($HTTP_POST_VARS['deny']) ) ? \
$HTTP_POST_VARS['pending_members'] : $HTTP_POST_VARS['members'];

$sql_in = '';
for($i = 0; $i < count($members); $i++)
{
	$sql_in .= ( ( $sql_in != '' ) ? ', ' : '' ) . $members[$i];
}

After this the $sql_in variable is not checked or changed at all, and this is where I \
found the SQL injection to be possible... There are two places this is used, first is \
through a check on if you're the moderator of a group, if you are it will run an if \
IN check on the array first:

$sql = "SELECT ug.user_id, ug.group_id
	FROM " . AUTH_ACCESS_TABLE . " aa, " . USER_GROUP_TABLE . " ug
	WHERE ug.user_id IN  ($sql_in)
	AND aa.group_id = ug.group_id
	AND aa.auth_mod = 1
	GROUP BY ug.user_id, ug.group_id
	ORDER BY ug.user_id, ug.group_id";

From this, it will pull a list of the users in the group and if they're moderators \
from being in the group... If they are, it will remove their securities.

Now the second one becomes more critical, this is after the check on if moderator:

$sql = "DELETE FROM " . USER_GROUP_TABLE . "
	WHERE user_id IN ($sql_in)
	AND group_id = $group_id";

Since this again uses an IN check on the unchecked $sql_in, you can easily replace it \
with something such as $sql_in = 1) or 1=1/* That would cause, every person in a \
group to be automatically deleted from it.

To fix this vulnerability, it's fairly simple. Open your groupcp.php file.
Find
$sql_in .= ( ( $sql_in != '' ) ? ', ' : '' ) . $members[$i];

and replace it with
$sql_in .= ( ( $sql_in != '' ) ? ', ' : '' ) . intval($members[$i]);

I'm providing no proof of concept code because you can easily check if you're \
vulnerable by searching for the first line in your groupcp.php file.

Thanks,
  Zarath

[[prev in list](?l=bugtraq&m=107273061830801&w=2)] [[next in list](?l=bugtraq&m=107273106431312&w=2)] [prev in thread] [next in thread]

```

[Configure](?q=configure) |
[About](?q=about) |
[News](?q=news) |
Add a list |
Sponsored by [KoreLogic](http://www.korelogic.com/)


