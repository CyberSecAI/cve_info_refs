=== Content from www.openntpd.org_e72048dc_20250125_175839.html ===
OpenNTPD 6.0p1 has just been released. It will be available from the mirrors
listed at http://www.openntpd.org/ shortly.
OpenNTPD is a FREE, secure, and easy to use implementation of the Network Time
Protocol. It provides the ability to sync the local clock to remote NTP servers
and can act as NTP server itself, redistributing the local clock.
Changes since OpenNTPD 5.9p1
============================
\* Fixed a link failure on older Linux distributions and a build
failure on FreeBSD.
\* Set MOD\_MAXERROR to avoid unsynced time status when using
ntp\_adjtime.
\* Fixed HTTP Timestamp header parsing to use strptime in a more
portable fashion.
\* Hardened TLS for ntpd constraints, enabling server name
verification. Thanks to Luis M. Merino.
The libtls library, as shipped with LibreSSL 2.3.2 or later, is
required to use the HTTPS constraint feature, though it is not
required to use OpenNTPD.
For detailed changes, see the changes either in the OpenBSD CVS repository or
the GitHub mirror.
Checksums:
==========
SHA256 (openntpd-6.0p1.tar.gz) = b1ab80094788912adb12b33cb1f251cc58db39294c1b5c6376972f5f7ba577e8
Reporting Bugs:
===============
General bugs may be reported to tech@openbsd.org
Portable bugs may be filed at https://github.com/openntpd-portable/openntpd-portable/


=== Content from www.openwall.com_2f09bc8d_20250125_175840.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](../../../2016/05/23/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160529195359.7CDC6332014@smtpvbsrv1.mitre.org>
Date: Sun, 29 May 2016 15:53:59 -0400 (EDT)
From: cve-assign@...re.org
To: luismiguelmerino@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: OpenNTPD not verifying CN during HTTPS constraints request

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> Common Name verification was disabled while configuring the HTTPS request,
> allowing upstream network attackers to intercept and forward the request to
> a malicious server that could provide forged timestamp
> constraints presenting valid certificates without the server noticing it.
>
> <http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.sbin/ntpd/constraint.c.diff?r1=1.27&r2=1.28>

>> <http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.sbin/ntpd/constraint.c>
>> Revision 1.28
>> stop disabling server name verification

Use CVE-2016-5117.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXS0fJAAoJEHb/MwWLVhi2bmAP/RU7Ksh8OPSWaen7I9Rof/fB
ckApEVEEeLVs52LSO/re3hmIqB+TiM9N6nMUYVT/EZajaFTZb2KALJcLU2sn7jWd
soEusAUwGTv6hiDKUrgK64suJIogNNAwuzkCozabvn8j0B4NT5SmxR7oMdaF2qZH
6h9jdmxCW1A2c9oyRpyWIpdcf241ir7DGqeEhS3aWir5211UHCysAmX4sxHtlG6Q
dzUsoJWOamlWEDTA5NP85dmJGhThiIN4eliJm9Ui1tQ+SqKzFzDEcpUf/TbF4CGc
MOWm4GQzG0omH48kGJ75KzMYE5Af26b8OsmCk1YZKCt8s+PSvnFRe2aZLI1QQ4IL
53kp+64P4XRPAemHeCDI7Zzf6GjczivYks46zRX42tHwEGwSx10MZxW0U+NdUWmT
ru3HyniFjRyLJ3X+jPnP+iftk5N2KsFrXUhVaSIQgTxST8CNAO/iiZUUs4YEnBJT
BDqTKr21CTWi7QgCl5vTrw2/LMIRhYu0nhHuI6X41RvdR2dgDizeYFEsliVrNw8g
6pw9CoF7qhBDi+A3X8FvOI94wE8u7OHRqNL80NjP26/gNI5JNmEcxN7wbOXFrN4W
SUfvSQk5TV63Cxq52veTLHebHxzjevW9feyQYsu0QMJWM5q3d8/r5AQDKnzOj6dg
nKZvo7u8C1L7lbNmWrVs
=4Wi8
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from cvsweb.openbsd.org_abb3398d_20250125_175839.html ===
===================================================================
RCS file: /cvsrepo/anoncvs/cvs/src/usr.sbin/ntpd/constraint.c,v
retrieving revision 1.27
retrieving revision 1.28
diff -u -r1.27 -r1.28
--- src/usr.sbin/ntpd/constraint.c 2016/05/06 16:49:46 1.27
+++ src/usr.sbin/ntpd/constraint.c 2016/05/21 13:46:10 1.28
@@ -1,4 +1,4 @@
-/\* $OpenBSD: constraint.c,v 1.27 2016/05/06 16:49:46 jsing Exp $ \*/
+/\* $OpenBSD: constraint.c,v 1.28 2016/05/21 13:46:10 jsing Exp $ \*/
/\*
\* Copyright (c) 2015 Reyk Floeter
@@ -292,12 +292,12 @@
if (setpriority(PRIO\_PROCESS, 0, 0) == -1)
log\_warn("could not set priority");
- /\* Init TLS and load cert before chroot() \*/
+ /\* Init TLS and load CA certs before chroot() \*/
if (tls\_init() == -1)
fatalx("tls\_init");
if ((conf->ca = tls\_load\_file(CONSTRAINT\_CA,
&conf->ca\_len, NULL)) == NULL)
- log\_warnx("constraint certificate verification turned off");
+ fatalx("failed to load constraint ca");
if (chroot(pw\_dir) == -1)
fatal("chroot");
@@ -821,9 +821,6 @@
if (tls\_config\_set\_ciphers(httpsdate->tls\_config, "compat") != 0)
goto fail;
- /\* XXX we have to pre-resolve, so name and host are not equal \*/
- tls\_config\_insecure\_noverifyname(httpsdate->tls\_config);
-
if (ca == NULL || ca\_len == 0)
tls\_config\_insecure\_noverifycert(httpsdate->tls\_config);
else
@@ -867,9 +864,10 @@
if (tls\_configure(httpsdate->tls\_ctx, httpsdate->tls\_config) == -1)
goto fail;
- if (tls\_connect(httpsdate->tls\_ctx,
- httpsdate->tls\_addr, httpsdate->tls\_port) == -1) {
- log\_debug("tls failed: %s: %s", httpsdate->tls\_addr,
+ if (tls\_connect\_servername(httpsdate->tls\_ctx, httpsdate->tls\_addr,
+ httpsdate->tls\_port, httpsdate->tls\_hostname) == -1) {
+ log\_warnx("tls connect failed: %s (%s): %s",
+ httpsdate->tls\_addr, httpsdate->tls\_hostname,
tls\_error(httpsdate->tls\_ctx));
goto fail;
}
@@ -880,8 +878,12 @@
ret = tls\_write(httpsdate->tls\_ctx, buf, len);
if (ret == TLS\_WANT\_POLLIN || ret == TLS\_WANT\_POLLOUT)
continue;
- if (ret < 0)
+ if (ret < 0) {
+ log\_warnx("tls write failed: %s (%s): %s",
+ httpsdate->tls\_addr, httpsdate->tls\_hostname,
+ tls\_error(httpsdate->tls\_ctx));
goto fail;
+ }
buf += ret;
len -= ret;
}
@@ -916,8 +918,8 @@
free(line);
}
-
return (0);
+
fail:
httpsdate\_free(httpsdate);
return (-1);


=== Content from www.openwall.com_7fb63579_20250125_175839.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](../../../2016/05/29/6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CABjOGM5oLVXRFhKCYf=0pRNn377m8Ahw4z-H-k8zgiN_ckQUoA@mail.gmail.com>
Date: Mon, 23 May 2016 17:06:13 +0200
From: "Luis M. Merino" <luismiguelmerino@...il.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: OpenNTPD not verifying CN during HTTPS constraints request

Good afternoon,

I'm requesting a CVE for this patched mitm mitigation bypass vulnerability
on OpenNTPD.

Upstream patch:
<http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.sbin/ntpd/constraint.c.diff?r1=1.27&r2=1.28>

Affected versions:
All OpenNTPD versions containing constraints before May 21st 2016 are
affected.
OpenBSD 5.9 is affected.

Description:
OpenNTPD constraints is an experimental functionality to mitigate
NTP man-in-the-middle attacks. When enabled (by default on OpenBSD base
install), it request timestamps from trusted HTTPS servers through HTTP
Date: header and the average of the values obtained are used to filter
out deviating NTP responses.

Common Name verification was disabled while configuring the HTTPS request,
allowing upstream network attackers to intercept and forward the request to
a malicious server that could provide forged timestamp
constraints presenting valid certificates without the server noticing it.

The vulnerable function is httpsdate_init at
/src/usr.sbin/ntpd/constraint.c on OpenBSD source:

[...]
/* XXX we have to pre-resolve, so name and host are not equal */
tls_config_insecure_noverifyname(httpsdate->tls_config);
[...]

Solution:
Update to -CURRENT.

Regards,
Luis M. Merino

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


