=== Content from bugzilla.mozilla.org_05e64c07_20250126_083454.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1292443)
* [XML](/show_bug.cgi?ctype=xml&id=1292443)

Closed
[Bug 1292443](/show_bug.cgi?id=1292443)
(CVE-2016-5296)

Opened 8 years ago
Closed 8 years ago

# Heap-buffer-overflow WRITE in rasterize\_edges\_1

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Heap-buffer-overflow WRITE in rasterize\_edges\_1

## Categories

### (Core :: Graphics, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics#Graphics)

Graphics
▾

Core :: Graphics
Mapping of cross platform rendering interfaces to various 2D graphics APIs
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla52

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | [50+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=50%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified) |
| firefox51 | [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified) |
| firefox52 | [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox-esr45 | 50+ | verified |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | verified |
| firefox51 | + | verified |
| firefox52 | + | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: inferno, Assigned: jrmuizel)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ad916833cb7747e6939d576f34df1daa?d=mm&size=40)  [jrmuizel](/user_profile?user_id=309398)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/61d5301eaed11c2f726c8ea95578e6b2?d=mm&size=40)  [inferno](/user_profile?user_id=397541)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/17436ade8da1b23d42b3df05b9c4fc77?d=mm&size=40)  [bhood](/user_profile?user_id=697075)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

16 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (5 keywords, Whiteboard: [post-critsmash-triage][adv-main50+][adv-esr45.5+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2016-5296

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[csectype-undefined](/buglist.cgi?keywords=csectype-undefined&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main50+][adv-esr45.5+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a5141426_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 2 obsolete files)

| [Testcase](/attachment.cgi?id=8778096)  [8 years ago](#c0)  [Abhishek Arya](/user_profile?user_id=397541)   4.65 KB, image/svg+xml |  | [Details](/attachment.cgi?id=8778096&action=edit) |
| --- | --- | --- |
| [testcase 2 (reduced)](/attachment.cgi?id=8779869)  [8 years ago](#c7)  [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)   413 bytes, application/xhtml+xml |  | [Details](/attachment.cgi?id=8779869&action=edit) |
| [testcase 3 (interactive -- hover blue area to test)](/attachment.cgi?id=8779903)  [8 years ago](#c9)  [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)   489 bytes, application/xhtml+xml |  | [Details](/attachment.cgi?id=8779903&action=edit) |
| [debugging patch v1](/attachment.cgi?id=8779906)  [8 years ago](#c10)  [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)   2.62 KB, patch |  | [Details](/attachment.cgi?id=8779906&action=edit) | [Diff](/attachment.cgi?id=8779906&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8779906) |
| [snippet of annotated disassembly](/attachment.cgi?id=8785631)  [8 years ago](#c15)  [Daniel Holbert [:dholbert]](/user_profile?user_id=278074)   2.17 KB, text/plain |  | [Details](/attachment.cgi?id=8785631&action=edit) |
| [snippet of annotated disassembly #2](/attachment.cgi?id=8786096)  [8 years ago](#c16)  [Mats Palmgren (inactive)](/user_profile?user_id=5168)   3.16 KB, text/plain |  | [Details](/attachment.cgi?id=8786096&action=edit) |
| [Check for overflow.](/attachment.cgi?id=8798497)  [8 years ago](#c31)  [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486)   1.07 KB, patch |  | [Details](/attachment.cgi?id=8798497&action=edit) | [Diff](/attachment.cgi?id=8798497&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8798497) |
| [Cast to unsigned for arithmetic](/attachment.cgi?id=8800006)  [8 years ago](#c32)  [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398)   25.18 KB, patch |  | [Details](/attachment.cgi?id=8800006&action=edit) | [Diff](/attachment.cgi?id=8800006&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800006) |
| [Cast to unsigned for arithmetic](/attachment.cgi?id=8800854)  [8 years ago](#c34)  [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398)   667 bytes, patch | dholbert : [review+](#c37 "8 years ago")  dveditz : [approval-mozilla-aurora+](#c45 "8 years ago")  dveditz : [approval-mozilla-beta+](#c45 "8 years ago")  dveditz : [approval-mozilla-esr45+](#c45 "8 years ago")  dveditz : [sec-approval+](#c45 "8 years ago") | [Details](/attachment.cgi?id=8800854&action=edit) | [Diff](/attachment.cgi?id=8800854&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800854) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Abhishek Arya](/user_profile?user_id=397541)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1292443#c0)• 8 years ago |
|  | |

Attached image
[Testcase](attachment.cgi?id=8778096)
— [Details](attachment.cgi?id=8778096&action=edit)

==13447==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6230000601a8 at pc 0x0000004bea3c bp 0x7ffeffd80c70 sp 0x7ffeffd80420
WRITE of size 4112 at 0x6230000601a8 thread T0 (Web Content)
SCARINESS: 55 (multi-byte-write-heap-buffer-overflow-far-from-bounds)
#0 0x4bea3b in \_\_asan\_memset \_asan\_rtl\_
#1 0x7fd8de8e2b4c in rasterize\_edges\_1 gfx/cairo/libpixman/src/pixman-edge-imp.h:125:7
#2 0x7fd8de8e2b4c in pixman\_rasterize\_edges\_no\_accessors gfx/cairo/libpixman/src/pixman-edge.c:351
#3 0x7fd8de8e2b4c in \_moz\_pixman\_rasterize\_edges gfx/cairo/libpixman/src/pixman-edge.c:382
#4 0x7fd8de99d824 in \_moz\_pixman\_rasterize\_trapezoid gfx/cairo/libpixman/src/pixman-trap.c:386:2
#5 0x7fd8de7b1392 in \_pixman\_image\_add\_traps gfx/cairo/cairo/src/cairo-image-surface.c:2466:2
#6 0x7fd8de7b0701 in \_composite\_traps gfx/cairo/cairo/src/cairo-image-surface.c:2516:5
#7 0x7fd8de7b5b18 in \_clip\_and\_composite gfx/cairo/cairo/src/cairo-image-surface.c:2359:15
#8 0x7fd8de7b891f in \_clip\_and\_composite\_trapezoids gfx/cairo/cairo/src/cairo-image-surface.c:3258:12
#9 0x7fd8de7b7d7d in \_clip\_and\_composite\_polygon gfx/cairo/cairo/src/cairo-image-surface.c:3625:15
#10 0x7fd8de7a3ceb in \_cairo\_image\_surface\_stroke gfx/cairo/cairo/src/cairo-image-surface.c:3717:15
#11 0x7fd8de81bce1 in \_cairo\_surface\_stroke gfx/cairo/cairo/src/cairo-surface.c:2296:11
#12 0x7fd8de796646 in \_cairo\_gstate\_stroke gfx/cairo/cairo/src/cairo-gstate.c:1166:14
#13 0x7fd8de83ea7d in \_moz\_cairo\_stroke\_preserve gfx/cairo/cairo/src/cairo.c:2430:14
#14 0x7fd8d75bfbcf in mozilla::gfx::DrawTargetCairo::DrawPattern(mozilla::gfx::Pattern const&, mozilla::gfx::StrokeOptions const&, mozilla::gfx::DrawOptions const&, mozilla::gfx::DrawTargetCairo::DrawPatternType, bool) gfx/2d/DrawTargetCairo.cpp:1024:7
#15 0x7fd8d75c4f81 in mozilla::gfx::DrawTargetCairo::Stroke(mozilla::gfx::Path const\*, mozilla::gfx::Pattern const&, mozilla::gfx::StrokeOptions const&, mozilla::gfx::DrawOptions const&) gfx/2d/DrawTargetCairo.cpp:1255:3
#16 0x7fd8dcd8bca6 in nsSVGPathGeometryFrame::Render(gfxContext\*, unsigned int, gfxMatrix const&) layout/svg/nsSVGPathGeometryFrame.cpp:867:21
#17 0x7fd8dcd8a20d in nsSVGPathGeometryFrame::PaintSVG(gfxContext&, gfxMatrix const&, mozilla::gfx::IntRectTyped<mozilla::gfx::UnknownUnits> const\*) layout/svg/nsSVGPathGeometryFrame.cpp:293:5
#18 0x7fd8dcd88726 in nsDisplaySVGPathGeometry::Paint(nsDisplayListBuilder\*, nsRenderingContext\*) layout/svg/nsSVGPathGeometryFrame.cpp:125:51
#19 0x7fd8dc5f5f98 in mozilla::FrameLayerBuilder::PaintItems(nsTArray<mozilla::FrameLayerBuilder::ClippedDisplayItem>&, mozilla::gfx::IntRectTyped<mozilla::gfx::UnknownUnits> const&, gfxContext\*, nsRenderingContext\*, nsDisplayListBuilder\*, nsPresContext\*, mozilla::gfx::IntPointTyped<mozilla::gfx::UnknownUnits> const&, float, float, int) layout/base/FrameLayerBuilder.cpp:5710:21
#20 0x7fd8dc5f9433 in mozilla::FrameLayerBuilder::DrawPaintedLayer(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*) layout/base/FrameLayerBuilder.cpp:5885:19
#21 0x7fd8d7940a51 in mozilla::layers::BasicPaintedLayer::PaintThebes(gfxContext\*, mozilla::layers::Layer\*, void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*) gfx/layers/basic/BasicPaintedLayer.cpp:95:9
#22 0x7fd8d793b3ec in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintLayerContext&, gfxContext\*) gfx/layers/basic/BasicLayerManager.cpp:714:13
#23 0x7fd8d7939c49 in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext\*, mozilla::layers::Layer\*, void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*) gfx/layers/basic/BasicLayerManager.cpp:883:5
#24 0x7fd8d793b0b2 in mozilla::layers::BasicLayerManager::PaintSelfOrChildren(mozilla::layers::PaintLayerContext&, gfxContext\*) gfx/layers/basic/BasicLayerManager.cpp:735:7
#25 0x7fd8d7939c49 in mozilla::layers::BasicLayerManager::PaintLayer(gfxContext\*, mozilla::layers::Layer\*, void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*) gfx/layers/basic/BasicLayerManager.cpp:883:5
#26 0x7fd8d7934f1d in mozilla::layers::BasicLayerManager::EndTransactionInternal(void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*, mozilla::layers::LayerManager::EndTransactionFlags) gfx/layers/basic/BasicLayerManager.cpp:623:5
#27 0x7fd8dc5f5fb6 in PaintInactiveLayer layout/base/FrameLayerBuilder.cpp:3605:12
#28 0x7fd8dc5f5fb6 in mozilla::FrameLayerBuilder::PaintItems(nsTArray<mozilla::FrameLayerBuilder::ClippedDisplayItem>&, mozilla::gfx::IntRectTyped<mozilla::gfx::UnknownUnits> const&, gfxContext\*, nsRenderingContext\*, nsDisplayListBuilder\*, nsPresContext\*, mozilla::gfx::IntPointTyped<mozilla::gfx::UnknownUnits> const&, float, float, int) layout/base/FrameLayerBuilder.cpp:5696
#29 0x7fd8dc5f9433 in mozilla::FrameLayerBuilder::DrawPaintedLayer(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*) layout/base/FrameLayerBuilder.cpp:5885:19
#30 0x7fd8d79536e2 in mozilla::layers::ClientPaintedLayer::PaintThebes() gfx/layers/client/ClientPaintedLayer.cpp:94:5
#31 0x7fd8d795437d in mozilla::layers::ClientPaintedLayer::RenderLayerWithReadback(mozilla::layers::ReadbackProcessor\*) gfx/layers/client/ClientPaintedLayer.cpp:148:3
#32 0x7fd8d796dd8c in mozilla::layers::ClientContainerLayer::RenderLayer() gfx/layers/client/ClientContainerLayer.h:65:29
#33 0x7fd8d796dd8c in mozilla::layers::ClientContainerLayer::RenderLayer() gfx/layers/client/ClientContainerLayer.h:65:29
#34 0x7fd8d796dd8c in mozilla::layers::ClientContainerLayer::RenderLayer() gfx/layers/client/ClientContainerLayer.h:65:29
#35 0x7fd8d796dd8c in mozilla::layers::ClientContainerLayer::RenderLayer() gfx/layers/client/ClientContainerLayer.h:65:29
#36 0x7fd8d796dd8c in mozilla::layers::ClientContainerLayer::RenderLayer() gfx/layers/client/ClientContainerLayer.h:65:29
#37 0x7fd8d796dd8c in mozilla::layers::ClientContainerLayer::RenderLayer() gfx/layers/client/ClientContainerLayer.h:65:29
#38 0x7fd8d796dd8c in mozilla::layers::ClientContainerLayer::RenderLayer() gfx/layers/client/ClientContainerLayer.h:65:29
#39 0x7fd8d794e89e in mozilla::layers::ClientLayerManager::EndTransactionInternal(void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*, mozilla::layers::LayerManager::EndTransactionFlags) gfx/layers/client/ClientLayerManager.cpp:296:9
#40 0x7fd8d794ee7c in mozilla::layers::ClientLayerManager::EndTransaction(void (\*)(mozilla::layers::PaintedLayer\*, gfxContext\*, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, mozilla::layers::DrawRegionClip, mozilla::gfx::IntRegionTyped<mozilla::gfx::UnknownUnits> const&, void\*), void\*, mozilla::layers::LayerManager::EndTransactionFlags) gfx/layers/client/ClientLayerManager.cpp:339:3
#41 0x7fd8dc74a3db in nsDisplayList::PaintRoot(nsDisplayListBuilder\*, nsRenderingContext\*, unsigned int) layout/base/nsDisplayList.cpp:1927:17
#42 0x7fd8dc7fb0d0 in nsLayoutUtils::PaintFrame(nsRenderingContext\*, nsIFrame\*, nsRegion const&, unsigned int, nsDisplayListBuilderMode, nsLayoutUtils::PaintFrameFlags) layout/base/nsLayoutUtils.cpp:3606:10
#43 0x7fd8dc8835ad in PresShell::Paint(nsView\*, nsRegion const&, unsigned int) layout/base/nsPresShell.cpp:6636:5
#44 0x7fd8dbe4bf5c in nsViewManager::ProcessPendingUpdatesPaint(nsIWidget\*) view/nsViewManager.cpp:484:19
#45 0x7fd8dbe4ad31 in nsViewManager::ProcessPendingUpdatesForView(nsView\*, bool) view/nsViewManager.cpp:415:33
#46 0x7fd8dbe4ecc9 in nsViewManager::ProcessPendingUpdates() view/nsViewManager.cpp:1119:5
#47 0x7fd8dc57654f in nsRefreshDriver::Tick(long, mozilla::TimeStamp) layout/base/nsRefreshDriver.cpp:1911:9
#48 0x7fd8dc58109d in TickDriver layout/base/nsRefreshDriver.cpp:279:13
#49 0x7fd8dc58109d in mozilla::RefreshDriverTimer::TickRefreshDrivers(long, mozilla::TimeStamp, nsTArray<RefPtr<nsRefreshDriver> >&) layout/base/nsRefreshDriver.cpp:251
#50 0x7fd8dc580cf9 in mozilla::RefreshDriverTimer::Tick(long, mozilla::TimeStamp) layout/base/nsRefreshDriver.cpp:270:5
#51 0x7fd8dc582c94 in mozilla::VsyncRefreshDriverTimer::RefreshDriverVsyncObserver::NotifyVsync(mozilla::TimeStamp) layout/base/nsRefreshDriver.cpp:430:9
#52 0x7fd8dcf0c2c4 in mozilla::layout::VsyncChild::RecvNotify(mozilla::TimeStamp const&) layout/ipc/VsyncChild.cpp:64:16
#53 0x7fd8d6823059 in mozilla::layout::PVsyncChild::OnMessageReceived(IPC::Message const&) objdir-ff-asan/ipc/ipdl/PVsyncChild.cpp:240:20
#54 0x7fd8d62a1814 in mozilla::ipc::PBackgroundChild::OnMessageReceived(IPC::Message const&) objdir-ff-asan/ipc/ipdl/PBackgroundChild.cpp:2133:28
#55 0x7fd8d61cd566 in mozilla::ipc::MessageChannel::DispatchAsyncMessage(IPC::Message const&) ipc/glue/MessageChannel.cpp:1661:25
#56 0x7fd8d61c9c87 in mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) ipc/glue/MessageChannel.cpp:1599:17
#57 0x7fd8d61b6dff in mozilla::ipc::MessageChannel::OnMaybeDequeueOne() ipc/glue/MessageChannel.cpp:1566:5
#58 0x7fd8d61e8152 in applyImpl<mozilla::ipc::MessageChannel, bool (mozilla::ipc::MessageChannel::\*)()> objdir-ff-asan/dist/include/nsThreadUtils.h:729:12
#59 0x7fd8d61e8152 in apply<mozilla::ipc::MessageChannel, bool (mozilla::ipc::MessageChannel::\*)()> objdir-ff-asan/dist/include/nsThreadUtils.h:735
#60 0x7fd8d61e8152 in mozilla::detail::RunnableMethodImpl<bool (mozilla::ipc::MessageChannel::\*)(), false, true>::Run() objdir-ff-asan/dist/include/nsThreadUtils.h:764
#61 0x7fd8d61e773f in Run objdir-ff-asan/dist/include/mozilla/ipc/MessageChannel.h:550:29
#62 0x7fd8d61e773f in mozilla::ipc::MessageChannel::DequeueTask::Run() objdir-ff-asan/dist/include/mozilla/ipc/MessageChannel.h:569
#63 0x7fd8d53e8802 in nsThread::ProcessNextEvent(bool, bool\*) xpcom/threads/nsThread.cpp:1068:14
#64 0x7fd8d54684d8 in NS\_ProcessNextEvent(nsIThread\*, bool) xpcom/glue/nsThreadUtils.cpp:290:10
#65 0x7fd8d61d4d51 in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) ipc/glue/MessagePump.cpp:100:21
#66 0x7fd8d61478f0 in RunInternal ipc/chromium/src/base/message\_loop.cc:232:10
#67 0x7fd8d61478f0 in RunHandler ipc/chromium/src/base/message\_loop.cc:225
#68 0x7fd8d61478f0 in MessageLoop::Run() ipc/chromium/src/base/message\_loop.cc:205
#69 0x7fd8dbec0e2f in nsBaseAppShell::Run() widget/nsBaseAppShell.cpp:156:27
#70 0x7fd8ddfe49c7 in XRE\_RunAppShell toolkit/xre/nsEmbedFunctions.cpp:851:22
#71 0x7fd8d61478f0 in RunInternal ipc/chromium/src/base/message\_loop.cc:232:10
#72 0x7fd8d61478f0 in RunHandler ipc/chromium/src/base/message\_loop.cc:225
#73 0x7fd8d61478f0 in MessageLoop::Run() ipc/chromium/src/base/message\_loop.cc:205
#74 0x7fd8ddfe4088 in XRE\_InitChildProcess toolkit/xre/nsEmbedFunctions.cpp:681:34
#75 0x510ae1 in content\_process\_main ipc/contentproc/plugin-container.cpp:224:19
#76 0x510ae1 in main browser/app/nsBrowserApp.cpp:357
#77 0x7fd8ef154f44 in \_\_libc\_start\_main /build/eglibc-oGUzwX/eglibc-2.19/csu/libc-start.c:287
AddressSanitizer can not describe address in more detail (wild memory access suspected).
SUMMARY: AddressSanitizer: heap-buffer-overflow (/mnt/scratch0/clusterfuzz/slave-bot/builds/linux\_asan\_firefox/custom/firefox/firefox-bin+0x4bea3b)
Shadow bytes around the buggy address:
0x0c4680003fe0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680003ff0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680004000: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680004010: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680004020: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
=>0x0c4680004030: fa fa fa fa fa[fa]fa fa fa fa fa fa fa fa fa fa
0x0c4680004040: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680004050: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680004060: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680004070: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c4680004080: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Heap right redzone: fb
Freed heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone: f3
Stack partial redzone: f4
Stack after return: f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
Container overflow: fc
Array cookie: ac
Intra object redzone: bb
ASan internal: fe
Left alloca redzone: ca
Right alloca redzone: cb
==13447==ABORTING

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1292443#c1)• 8 years ago |
|  | |

Daniel: please direct this bug to someone in the SVG team that can work on it.Group: core-security → layout-core-securityFlags: needinfo?(dholbert)Keywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1292443#c2)• 8 years ago |
|  | |

I'll take a look to start out... Abishek, could you let me know what build/OS you're using?
I can't reproduce any ASAN issues on linux, using the latest inbound ASAN build:
<http://archive.mozilla.org/pub/firefox/tinderbox-builds/mozilla-inbound-linux64-asan-debug/1470715521/>
I just get this when loading the attached file:
> JavaScript error: file:///...path-to-file.../test.svg, line 15: SyntaxError: expected expression, got '}'
but no ASAN errors.Flags: needinfo?(dholbert) → needinfo?(inferno)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a349473_278074)• 8 years ago |

Flags: needinfo?(dholbert)

|  | [Abhishek Arya](/user_profile?user_id=397541)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1292443#c3)• 8 years ago |
|  | |

20160807213804 was previous build i used. i just tried with tip-of-tree trunk (6cf0089510fa) and easily reproduces with that svg file. you need to use release build. also my clang revision is [r277962](https://viewvc.svn.mozilla.org/vc?view=rev&revision=277962). and this was on linux.Flags: needinfo?(inferno)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1292443#c4)• 8 years ago |
|  | |

(In reply to Abhishek Arya from [comment #3](/show_bug.cgi?id=1292443#c3 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))
> you need to use release build.
(I assume you mean an optimized build [not a build with release branding] -- gotcha.)
> also my clang revision is [r277962](https://viewvc.svn.mozilla.org/vc?view=rev&revision=277962). and this was on linux.
OK, thanks. Have you tested with a Mozilla-provided ASAN-enabled optimized Firefox build, like this one from today:
<https://ftp.mozilla.org/pub/firefox/tinderbox-builds/mozilla-central-linux64-asan/1470837316/firefox-51.0a1.en-US.linux-x86_64-asan.tar.bz2>
?
I just tried that one and still can't reproduce. I'm building locally as well, but given that I've failed to repro with 2 different types of ASAN builds so far, I'm wondering if there's another factor that I'm missing. (And if you could test [or let me know if you've already tested] a build like the FTP one above, that would rule out the possibility of something special in your build environment.)Flags: needinfo?(dholbert)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a473987_278074)• 8 years ago |

Flags: needinfo?(inferno)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1292443#c5)• 8 years ago |
|  | |

I just finished & tested my own local [enable-debug,enable-opt] ASAN Firefox build, as well -- couldn't repro any ASAN issues. I happen to be using clang from [r278176](https://viewvc.svn.mozilla.org/vc?view=rev&revision=278176) (~trunk), and mozilla-central c12bb83ad278 (also ~trunk).
I'll try Abhishek's clang/m-c revision next, to rule out the possibility of any differences there. But I suspect there's some other factor that I'm missing here.

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1292443#c6)• 8 years ago |
|  | |

(In reply to Daniel Holbert [:dholbert] (recovering from vacation reviews/bugmail) from [comment #5](/show_bug.cgi?id=1292443#c5 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))
> I'll try Abhishek's clang/m-c revision next, to rule out the possibility of
> any differences there.
OK, I've found that I can reproduce with those revisions.Flags: needinfo?(inferno)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1292443#c7)• 8 years ago |
|  | |

Attached file
[testcase 2 (reduced)](attachment.cgi?id=8779869)
— [Details](attachment.cgi?id=8779869&action=edit)

Here's a reduced / cleaned-up testcase that still triggers the crash for me (using a debug+opt ASAN-enabled build with the mozilla-central/clang revisions noted in [comment 3](/show_bug.cgi?id=1292443#c3 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1")).

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1292443#c8)• 8 years ago |
|  | |

er, s/still triggers the crash/still triggers the ASAN report/abort.

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1292443#c9)• 8 years ago |
|  | |

Attached file
[testcase 3 (interactive -- hover blue area to test)](attachment.cgi?id=8779903)
— [Details](attachment.cgi?id=8779903&action=edit)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1292443#c10)• 8 years ago |
|  | |

Attached patch

[debugging patch v1](attachment.cgi?id=8779906&action=diff)
— [Details](attachment.cgi?id=8779906&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8779906)

Here's a debugging/diagnostic patch which demonstrates what the problem is, on my machine.
It seems the compiler is assuming (incorrectly in this case) that signed integer overflow will never happen. IIRC, that is something that compilers are allowed to assume. We end up with an (overflowed) hugely-negative number, which the code \*purportedly\* clamps to be nonnegative -- BUT in actual fact, we skip the "lx < 0" check (and the clamping code) because the compiler is mistakenly assuming the value is still positive.
Here's the tail end of the printf output from this patch, leading up to where we get killed by ASAN:
{
Initial lx: 2147183239
Adding 32767 to lx
Do we think lx=2147216006 is negative & needs clamping? No.
Initial lx: 2147254082
Adding 32767 to lx
Do we think lx=2147286849 is negative & needs clamping? No.
Initial lx: 2147324924
Adding 32767 to lx
Do we think lx=2147357691 is negative & needs clamping? No.
Initial lx: 2147395766
Adding 32767 to lx
Do we think lx=2147428533 is negative & needs clamping? No.
Initial lx: 2147466609
Adding 32767 to lx
OH NO, we're about to wrap lx past INT32\_MAX! Upcoming clamp might fail to catch this...
Do we think lx=-2147467920 is negative & needs clamping? No.
\*\*\*dholbert Calling WRITE with nmiddle=1029 (x=0, width=32964, startmask=0, endmask=15) (rx=12865573, lx=-2147467920) (rxi=196, lxi=-32768)
=================================================================
==12873==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x623000122378 at pc 0x7f5c6c3238c5 bp 0x7fffa9076e30 sp 0x7fffa9076e28
}
Note in particular the final "Do we think lx=-2147467920 is negative...No" report there. :-/ That's the problem.

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1292443#c11)• 8 years ago |
|  | |

This particular chunk of code (the addition to & clamping of "lx") hasn't changed since a pixman update that happened in [bug 562087](/show_bug.cgi?id=562087 "RESOLVED FIXED - Update pixman to newer version") (back in 2010), BTW. And it looks like we had a version of this bug (potential for overflow & failure-to-clamp) before that, too.
This bug exists in the latest version of the pixman code that I can find, too (i.e. it may trigger signed-overflow and then fail to clamp a negative |lx| value):
> lx += X\_FRAC\_FIRST(1) - pixman\_fixed\_e;
> rx += X\_FRAC\_FIRST(1) - pixman\_fixed\_e;
> #endif
> /\* clip X \*/
> if (lx < 0)
> lx = 0;
<https://cgit.freedesktop.org/pixman/tree/pixman/pixman-edge-imp.h#n58>
Ideally this should get fixed in pixman, but that's perhaps pretty fragile... Perhaps we can also add some sanity-checking in the code that produces such large |lx| values, to clamp it such that it can never get this close to INT32\_MAX.

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a495258_278074)• 8 years ago |

Flags: needinfo?(dholbert)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1292443#c12)• 8 years ago |
|  | |

Jeff, maybe this falls under your wheelhouse, as being a bug in cairo... do you have any ideas on what we should do here? Perhaps we should add a spot fix here to check that lx and rx aren't going to overflow \*before\* we do the addition? (since checking for after the overflow already happened isn't guaranteed to work, due to compiler optimizations)
See my description of the bug in [comment 10](/show_bug.cgi?id=1292443#c10 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"). As shown in the output there, this value |lx| is overflowing into negative territory, and it's used to determine where we write some memory, so we end up writing into hugely negative memory.Flags: needinfo?(dholbert) → needinfo?(jmuizelaar)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1292443#c13)• 8 years ago |
|  | |

>so we end up writing into hugely negative memory.
(By which I meant to say: we end up writing at a hugely negative offset from some pointer, i.e. at a bogus location.)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1292443#c14)• 8 years ago |
|  | |

(In reply to Daniel Holbert [:dholbert] from [comment #11](/show_bug.cgi?id=1292443#c11 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))
I'd like to understand how the compiler is dropping the check. Can you perhaps post the annotated assembly?

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a1792056_278074)• 8 years ago |

Flags: needinfo?(dholbert)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1292443#c15)• 8 years ago |
|  | |

Attached file
[snippet of annotated disassembly](attachment.cgi?id=8785631)
— [Details](attachment.cgi?id=8785631&action=edit)

Here's a snippet of the annotated disassembly of "rasterize\_edges\_1".
The source annotation is missing some source code -- it just shows us assigning |lx| and then checking if it's less than 0, and it's missing the lines of addition that I quoted in [comment 11](/show_bug.cgi?id=1292443#c11 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1") (adding X\_FRAC\_FIRST(1) - pixman\_fixed\_e)
But I think that addition is present in the annotation - I do see an "add" instruction in between the bunch of assembly between the assignment & the less-than-zero-check, at least.Flags: needinfo?(dholbert)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1292443#c16)• 8 years ago |
|  | |

Attached file
[snippet of annotated disassembly #2](attachment.cgi?id=8786096)
— [Details](attachment.cgi?id=8786096&action=edit)

I see different assembler from Daniel's.
It appears this code essentially does this instead:
if ("original lx before the increment" < -32767)
lx = 0;
which clearly ignores any overflow from the addition.
(this is an Opt ASAN build on 64-bit Linux with clang 3.8.0)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1292443#c17)• 8 years ago |
|  | |

If I use an unsigned type to do the addition then it seems to work,
presumably because unsigned overflow is well-defined:
- lx += X\_FRAC\_FIRST(1) - pixman\_fixed\_e;
- rx += X\_FRAC\_FIRST(1) - pixman\_fixed\_e;
+ uint32\_t lx\_unsigned = lx;
+ lx = lx\_unsigned + (X\_FRAC\_FIRST(1) - pixman\_fixed\_e);
+ uint32\_t rx\_unsigned = rx;
+ rx = rx\_unsigned + (X\_FRAC\_FIRST(1) - pixman\_fixed\_e);
I'm not sure how we typically fix stuff like this though.
Any suggestions?

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1292443#c18)• 8 years ago |
|  | |

Reassigning to Graphics since the underlying bug is in Cairo.Group: layout-core-security → gfx-core-securitySeverity: normal → criticalComponent: SVG → GraphicsKeywords: [crash](/buglist.cgi?keywords=crash&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a2307650_1689)• 8 years ago |

Flags: sec-bounty?

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1292443#c19)• 8 years ago |
|  | |

Milan is there somebody who can look at this? This externally reported sec-critical bug is about a month old. Thanks!Flags: needinfo?(milan)

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1292443#c20)• 8 years ago |
|  | |

Does this actually happen with non-ASAN builds? I couldn't quite tell from the different comments.Flags: needinfo?(milan) → needinfo?(dholbert)

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a2896747_456486)• 8 years ago |

Flags: needinfo?(milan)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1292443#c21)• 8 years ago |
|  | |

On Windows, the attached testcases show rendering issues with hardware acceleration disabled, but they don't crash. No asserts with debug builds. However, the switch to the Skia backend for unaccelerated layers ([bug 1007702](/show_bug.cgi?id=1007702 "RESOLVED FIXED - Enable skia content on Windows by default when not using D2D")) has made this go away on m-c tip, i.e. rendering now matches the accelerated rendering.
Per dholbert on IRC, the root pixman issue has probably been around since ever, so removing the regressionwindow-wanted keyword.Keywords: [regressionwindow-wanted](/buglist.cgi?keywords=regressionwindow-wanted&resolution=---)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1292443#c22)• 8 years ago |
|  | |

(In reply to Milan Sreckovic [:milan] from [comment #20](/show_bug.cgi?id=1292443#c20 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))
> Does this actually happen with non-ASAN builds? I couldn't quite tell from
> the different comments.
I'm pretty sure. Since it depends on a compiler optimization, this does require optimizations to be enabled (i.e. not the sort of build we normally compile/test locally). I don't have an enable-optimize build handy, so I can't immediately check, but I'm rebuilding & can confirm soon.
My attached diagnostic patch should make it easy to detect if/when this bug happens, in any build (particularly opt builds). The key "printf" output to look for is something like this:
> OH NO, we're about to wrap lx past INT32\_MAX! Upcoming clamp might fail to catch this...
> Do we think lx=-2147467920 is negative & needs clamping? No.
"lx" is used as an assumed-to-be-positive offset for a write shortly after that point (and that's the dangerous/exploitable part).

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a2899287_406194)• 8 years ago |

Keywords: [csectype-undefined](/buglist.cgi?keywords=csectype-undefined&resolution=---)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1292443#c23)• 8 years ago |
|  | |

OK -- Milan, I can confirm that normal (non-ASAN) optimized builds \*\*are indeed affected by this bug\*\*, using my diagnostic patch. (I compiled my local opt build using Ubuntu 16.04's stock clang 3.8 version, if it matters.)
With my diagnostic patch applied, I see this go by in my terminal output when I load & hover testcase 3 (after grepping for "OH NO" to narrow in on the bad part):
> Adding 32767 to lx
> OH NO, we're about to wrap lx past INT32\_MAX! Upcoming clamp might fail to catch this...
> Do we think lx=-2147467920 is negative & needs clamping? No.
> \*\*\*dholbert Calling WRITE with nmiddle=1029 (x=0, width=32964, startmask=0, endmask=15) (rx=12865573, lx=-2147467920) (rxi=196, lxi=-32768)
Note that I had to manually enable cairo as my rendering backend here (by setting gfx.content.azure.backends=cairo) in order to enable this codepath. We recently switched to prefer/mandate skia on trunk, in [bug 1278957](/show_bug.cgi?id=1278957 "RESOLVED FIXED - Make Skia the default content backend on Linux"). But we're still shipping cairo in version 49 and 50, and as a fallback renderer on Windows, so we do still need to care about it I think.Flags: needinfo?(dholbert)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a3497820_280903)• 8 years ago |

[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B)

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1292443#c24)• 8 years ago |
|  | |

I'm particularly enjoying this from [comment 23](/show_bug.cgi?id=1292443#c23 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"):
Do we think lx=-2147467920 is negative & needs clamping? No.
Yikes.

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1292443#c25)• 8 years ago |
|  | |

Yeah, that's the problem. And then we use that as an (assumed-to-be-nonnegative) offset into a buffer, and we write data into that location.
Mats' suggestion in [comment 17](/show_bug.cgi?id=1292443#c17 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1") seems like a reasonable workaround to me, FWIW (just doing the arithmetic in unsigned space and then casting back to signed).

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1292443#c26)• 8 years ago |
|  | |

I don't mind changing the code, in order to fix this particular bug, but what are the chances of this being the only place where something like that happens?
It'd be interesting to try if -fwrapv option changes the behaviour at all.

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1292443#c27)• 8 years ago |
|  | |

(In reply to Milan Sreckovic [:milan] from [comment #26](/show_bug.cgi?id=1292443#c26 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))
> I don't mind changing the code, in order to fix this particular bug, but
> what are the chances of this being the only place where something like that
> happens?
I'm worried about that, too. :/ I was hoping someone who knows the cairo code (Jeff?) might have a guess about (or might be able to quickly audit for) the presence of other instances of this pattern that we'd need to fix at the same time.
We do probably want to report this bug to upstream cairo developers, too -- do we have a contact who works on cairo who we could CC here for thoughts/expertise?

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1292443#c28)• 8 years ago |
|  | |

On the upstream note - this code is still the same in the latest pixman from what I can see. Also, does this <https://gcc.gnu.org/onlinedocs/gcc/Integer-Overflow-Builtins.html> apply here? We're not currently using it, and it could be GCC only.Flags: needinfo?(milan)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a4707491_280903)• 8 years ago |

[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected)
[tracking-firefox52](/buglist.cgi?f1=cf_tracking_firefox52&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a5141426_1689)• 8 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1292443#c29)• 8 years ago |
|  | |

Milan, what do you think should happen going forward? Looks like there is some ambiguity about how to best approach this. But it is a sec critical issue so we don't want to let it sit too long.Flags: needinfo?(milan)

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1292443#c30)• 8 years ago |
|  | |

Yes, we're not completely sure what to do with this as a general issue, though perhaps could deal with it in this instance. Also, as of 52, we're moving to Skia where the problem goes away. Still, let me see if we can do something.

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1292443#c31)• 8 years ago |
|  | |

Attached patch

[Check for overflow.](attachment.cgi?id=8798497&action=diff) (obsolete)
— [Details](attachment.cgi?id=8798497&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8798497)

Not sure this is worth it (see my previous comment), but should take care of this particular instance of a problem. Don't know what kind of performance impact it may have.Flags: needinfo?(milan)Flags: needinfo?(jmuizelaar)
[Attachment #8798497](/attachment.cgi?id=8798497&action=edit "Check for overflow.") -
Flags: review?(jmuizelaar)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1292443#c32)• 8 years ago |
|  | |

Attached patch

[Cast to unsigned for arithmetic](attachment.cgi?id=8800006&action=diff) (obsolete)
— [Details](attachment.cgi?id=8800006&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800006)

I'd prefer this as this code is somewhat performance sensitive and this seems like it might be more palatable to upstream.

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1292443#c33)• 8 years ago |
|  | |

(In reply to Jeff Muizelaar [:jrmuizel] from [comment #32](/show_bug.cgi?id=1292443#c32 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))
> Created [attachment 8800006](/attachment.cgi?id=8800006 "Cast to unsigned for arithmetic") [[details]](/attachment.cgi?id=8800006&action=edit "Cast to unsigned for arithmetic") [[diff]](/attachment.cgi?id=8800006&action=diff "Cast to unsigned for arithmetic") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800006)
> Cast to unsigned for arithmetic
>
> I'd prefer this as this code is somewhat performance sensitive and this
> seems like it might be more palatable to upstream.
Pretty sure you attached a wrong patch.Flags: needinfo?(jmuizelaar)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1292443#c34)• 8 years ago |
|  | |

Attached patch

[Cast to unsigned for arithmetic](attachment.cgi?id=8800854&action=diff)
— [Details](attachment.cgi?id=8800854&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800854)

[Attachment #8800006](/attachment.cgi?id=8800006&action=edit "Cast to unsigned for arithmetic") -
Attachment is obsolete: trueFlags: needinfo?(jmuizelaar)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1292443#c35)• 8 years ago |
|  | |

Liz or Ritu, will this be able to make beta if we have a reviewed patch?Flags: needinfo?(rkothari)Flags: needinfo?(lhenry)

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1292443#c36)• 8 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #35](/show_bug.cgi?id=1292443#c35 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))
> Liz or Ritu, will this be able to make beta if we have a reviewed patch?
Hi Al, given that this is a sec-crit, yes we can take it in Beta. I hope it lands today/tomm am PST so it gets included in 50.0b9 (gtb Thursday noon PST).Flags: needinfo?(rkothari)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1292443#c37)• 8 years ago |
|  | |

Comment on [attachment 8800854](/attachment.cgi?id=8800854 "Cast to unsigned for arithmetic") [[details]](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") [[diff]](/attachment.cgi?id=8800854&action=diff "Cast to unsigned for arithmetic") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800854)
Cast to unsigned for arithmetic
Review of [attachment 8800854](/attachment.cgi?id=8800854 "Cast to unsigned for arithmetic") [[details]](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") [[diff]](/attachment.cgi?id=8800854&action=diff "Cast to unsigned for arithmetic") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800854):
-----------------------------------------------------------------
Not sure if you meant to request review on this latest patch, but in the interests of getting this landed, I'll jump in & mark this r=me, assuming:
- you've tested it locally & made sure it does fix the overflow.
- you add a sane commit message that doesn't give away too much.
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: review+

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a6529648_278074)• 8 years ago |

Flags: needinfo?(jmuizelaar)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1292443#c38)• 8 years ago |
|  | |

Comment on [attachment 8798497](/attachment.cgi?id=8798497 "Check for overflow.") [[details]](/attachment.cgi?id=8798497&action=edit "Check for overflow.") [[diff]](/attachment.cgi?id=8798497&action=diff "Check for overflow.") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8798497)
Check for overflow.
(I think this earlier patch is obsolete, too --> marking as such.)
[Attachment #8798497](/attachment.cgi?id=8798497&action=edit "Check for overflow.") -
Attachment is obsolete: true
[Attachment #8798497](/attachment.cgi?id=8798497&action=edit "Check for overflow.") -
Flags: review?(jmuizelaar)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1292443#c39)• 8 years ago |
|  | |

Comment on [attachment 8800854](/attachment.cgi?id=8800854 "Cast to unsigned for arithmetic") [[details]](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") [[diff]](/attachment.cgi?id=8800854&action=diff "Cast to unsigned for arithmetic") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800854)
Cast to unsigned for arithmetic
Looks like Jeff isn't online currently, so I'll jump-start the approvals...
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not really.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Nope.
Which older supported branches are affected by this flaw?
All, most likely.
If not all supported branches, which bug introduced the flaw?
N/A
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
This patch should apply to all branches.
How likely is this patch to cause regressions; how much testing does it need?
Very unlikely to cause regressions.
Approval Request Comment
[Feature/regressing bug #]: -
[User impact if declined]: sec-critical
[Describe test coverage new/current, TreeHerder]: I suspect this code is covered by a lot of tests in general (although not with the extreme input values that the testcases on this bug creates). As usual, we'll wait with landing these tests until the bug is public.
[Risks and why]: very low risc
[String/UUID change made/needed]: none
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: sec-approval?
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-beta?
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-aurora?

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a6541334_538805)• 8 years ago |

[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F)

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1292443#c40)• 8 years ago |
|  | |

I'll wait for a sec-approval+ before taking it in beta50 and aurora51.
If someone can assess whether esr45 is affected or not, that would be great!

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1292443#c41)• 8 years ago |
|  | |

It's a really old issue in pixman, so I'm about 99% sure that esr45 is also affected.
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1292443#c42)• 8 years ago |
|  | |

Yup -- per [comment 11](/show_bug.cgi?id=1292443#c11 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"), we've had this bug (via this chunk of pixman code) since 2010 or earlier, so esr45 is definitely affected.

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a6608773_451704)• 8 years ago |

Flags: needinfo?(lhenry)

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1292443#c43)• 8 years ago |
|  | |

Thanks Dan and Ryan. Hello Mats, could you please nominate a patch for uplift to ESR45 as well? Thanks!Flags: needinfo?(mats)

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a6609504_278074)• 8 years ago |

[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-esr45?

|  | [Daniel Holbert [:dholbert]](/user_profile?user_id=278074) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1292443#c44)• 8 years ago |
|  | |

(nominated. I would've done so sooner, in [comment 42](/show_bug.cgi?id=1292443#c42 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"), but I misread the flags that RyanVM had tweaked & thought he'd already nominated it.)Flags: needinfo?(mats)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1292443#c45)• 8 years ago |
|  | |

Comment on [attachment 8800854](/attachment.cgi?id=8800854 "Cast to unsigned for arithmetic") [[details]](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") [[diff]](/attachment.cgi?id=8800854&action=diff "Cast to unsigned for arithmetic") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1292443&attachment=8800854)
Cast to unsigned for arithmetic
sec-approval+
a=dveditz/ritu for aurora, beta, and esr45
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: sec-approval?
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: sec-approval+
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-esr45?
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-esr45+
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-beta?
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-beta+
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-aurora?
[Attachment #8800854](/attachment.cgi?id=8800854&action=edit "Cast to unsigned for arithmetic") -
Flags: approval-mozilla-aurora+

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a6612121_538805)• 8 years ago |

[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1292443#c46)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/6abc8be2325d29eeabdd59de838907cf0c0dbd44>
<https://hg.mozilla.org/releases/mozilla-beta/rev/d4fe6876afeb14bfa005e24b9e47260d9a2b4e1c>
<https://hg.mozilla.org/releases/mozilla-esr45/rev/5e39c1c2fded8a33099b0f0266a258b5673c79e0>
Unclear to me if this needs to still land on trunk with the move to skia.
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Mats Palmgren (inactive)](/user_profile?user_id=5168) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1292443#c47)• 8 years ago |
|  | |

I pushed this:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/fbd443ce8fb5b8a1897baac3bfe62f8c5c5b054f>

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a6629341_451704)• 8 years ago |

[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F) → [50+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=50%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1292443#c48)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/fbd443ce8fb5>Assignee: nobody → jmuizelaarStatus: NEW → RESOLVEDClosed: 8 years ago
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed)Flags: needinfo?(jmuizelaar)Resolution: --- → FIXEDTarget Milestone: --- → mozilla52

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a6950736_1689)• 8 years ago |

Group: gfx-core-security → core-security-release

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a7782473_488993)• 8 years ago |

Flags: qe-verify+

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a7905542_452604)• 8 years ago |

Whiteboard: [post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a8191121_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main50+][adv-esr45.5+]

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1292443#c49)• 8 years ago |
|  | |

I've managed to reproduce this bug with an inbound ASAN build (2016-08-04) and using testcase 3 on Ubuntu 16.04 x64 LTS.
This issue is verified fixed on latest Nightly 52.0a1 (2016-11-07) and latest Aurora 51.a2 (2016-11-07) using the same platform mentioned above. I can no longer reproduce the crash and I don't see any rendering issues.
-- On 45.5.0 esr (20161031153904) I cannot see the testcase 3 (interactive -- hover blue area to test), the page appears blank when I load the testcase. You can see here: <https://goo.gl/zNp9xF>
-- On 50.0-build2 (20161104212021) there are some rendering issues but the tab is not crashing. See here: <https://goo.gl/J6G0YX>
Jeff, Wes what do you think about this results in 45.5.0 esr and 50 RC2?

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1292443#c50)• 8 years ago |
|  | |

 > Jeff, Wes what do you think about this results in 45.5.0 esr and 50 RC2? ([comment 49](/show_bug.cgi?id=1292443#c49 "VERIFIED FIXED - Heap-buffer-overflow WRITE in rasterize_edges_1"))Flags: needinfo?(jmuizelaar)

|  | [Milan Sreckovic [:milan] (needinfo for best results)](/user_profile?user_id=456486) |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1292443#c51)• 8 years ago |
|  | |

I'm not worried about 45.5 and 50 results in the context of this bug. Looks like the crash got fixed. If those problems happen in those versions, we should probably open another bug.Flags: needinfo?(jmuizelaar)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a8429886_280903)• 8 years ago |

Alias: CVE-2016-5296

|  | [Ciprian Georgiu, Desktop QA](/user_profile?user_id=576182) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1292443#c52)• 8 years ago |
|  | |

Thank you, Milan. I will close this issue as verified fixed since I can no longer reproduce the crashes on 45.5.0 esr, 50, 51 beta 2 and 52 latest Aurora.Status: RESOLVED → VERIFIED
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified)
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified)Flags: qe-verify+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a16280540_1689)• 8 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1292443#a246710344_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1292443&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Abhishek Arya](/user_profile?user_id=397541)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_341655cb_20250125_123851.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1246945)
* [XML](/show_bug.cgi?ctype=xml&id=1246945)

Closed
[Bug 1246945](/show_bug.cgi?id=1246945)
(CVE-2016-5293)

Opened 9 years ago
Closed 9 years ago

# Write to arbitrary file with updater and moz maintenance service using updater.log hardlink

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Write to arbitrary file with updater and moz maintenance service using updater.log hardlink

## Categories

### (Toolkit :: Application Update, defect)

[Product:](/describecomponents.cgi?product=Toolkit)

Toolkit
▾

Toolkit
The Mozilla Toolkit is a set of APIs, built on top of Gecko, which provide advanced services to XUL applications. These services include Profile Management, Chrome Registration, Browsing History, Extension and Theme Management, Application Update Service, and Safe Mode. ([More info](https://wiki.mozilla.org/Modules/Toolkit))
[See Open Bugs in This Product](/buglist.cgi?product=Toolkit&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Toolkit)
Watch This Product

[Component:](/describecomponents.cgi?product=Toolkit&component=Application%20Update#Application%20Update)

Application Update
▾

Toolkit :: Application Update
Application update for Firefox and Thunderbird.
[See Open Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Toolkit&component=Application%20Update&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Toolkit&component=Application%20Update)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

---

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Install Update Workflow | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix) |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=wontfix) |
| firefox-esr45 | [50+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=50%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified) |
| firefox51 | --- | [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified) |
| firefox52 | --- | [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 |  | wontfix |
| firefox48 |  | wontfix |
| firefox49 | + | wontfix |
| firefox-esr45 | 50+ | verified |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | verified |
| firefox51 |  | verified |
| firefox52 |  | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: hofusec, Assigned: robert.strong.bugs)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](extensions/Gravatar/web/default.jpg)  [robert.strong.bugs](/user_profile?user_id=141755)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/f8267efedda3c2e24d5829ef3a9d124e?d=mm&size=40)  [kjozwiak](/user_profile?user_id=455785)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/270499a0d11a67b911327984af6ffe90?d=mm&size=40)  [hofusec](/user_profile?user_id=436533)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/50e82ef70720dfcf1385f583e34f9ba9?d=mm&size=40)  [erchen](/user_profile?user_id=753852)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: reporter-external, sec-high, Whiteboard: [post-critsmash-triage][adv-main50+][adv-esr45.5+] fixed by bug 1168743)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2016-5293

[Keywords:](/describekeywords.cgi)

[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main50+][adv-esr45.5+] fixed by bug 1168743

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a18672755_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a23249655_452604 "8 years ago") | + |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [write.poc.zip](/attachment.cgi?id=8717458)  [9 years ago](#c0)  [Holger Fuhrmannek](/user_profile?user_id=436533)   66.41 KB, application/zip |  | [Details](/attachment.cgi?id=8717458&action=edit) |
| --- | --- | --- |
| [Patch](/attachment.cgi?id=8761353)  [9 years ago](#c5)  [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257)   1.32 KB, patch | robert.strong.bugs : [review-](#c8 "9 years ago") | [Details](/attachment.cgi?id=8761353&action=edit) | [Diff](/attachment.cgi?id=8761353&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8761353) |
| [bug 1168743 client patch](/attachment.cgi?id=8762239)  [9 years ago](#c14)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   48.23 KB, patch | robert.strong.bugs : [review+](#c14 "9 years ago")  abillings : [sec-approval+](#a10586718_280903 "9 years ago") | [Details](/attachment.cgi?id=8762239&action=edit) | [Diff](/attachment.cgi?id=8762239&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8762239) |
| [esr45 bug 1168743 client patch](/attachment.cgi?id=8790403)  [8 years ago](#c31)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   47.14 KB, patch | robert.strong.bugs : [review+](#c31 "8 years ago")  lizzard : [approval-mozilla-esr45+](#c39 "8 years ago")  abillings : [sec-approval+](#a18777183_280903 "8 years ago") | [Details](/attachment.cgi?id=8790403&action=edit) | [Diff](/attachment.cgi?id=8790403&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8790403) |
| [esr45 patch for bug 1299333](/attachment.cgi?id=8790404)  [8 years ago](#c32)  [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)   9.40 KB, patch |  | [Details](/attachment.cgi?id=8790404&action=edit) | [Diff](/attachment.cgi?id=8790404&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8790404) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Holger Fuhrmannek](/user_profile?user_id=436533)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1246945#c0)• 9 years ago |
|  | |

Attached file
[write.poc.zip](attachment.cgi?id=8717458)
— [Details](attachment.cgi?id=8717458&action=edit)

During an update a updater.log file is created in the update source directory. If possible the new log data are added to an existing log file. If the file is actually a hardlink the new data are added to an arbitrary file.
The poc use the CreateHardlink tool from <https://github.com/google/symboliclink-testing-tools> to create the hardlink without the need of write access to the target file.
I have tested the poc with win7 and ff 47 nightly installed to C:\Program Files (x86)\Nightly\:
To reproduce
- download poc and extract the files
- execute poc.rb
The poc adds amongst other data a user controlled new line to the updater.ini in the firefox directory.
This might be used to elevate privileges by overwriting a script or ini file which has a permissive parser which subsequently gets executed/parsed by a privileged process.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1246945#c1)• 9 years ago |
|  | |

Rob, can you take this and suggest a security rating?Flags: needinfo?(robert.strong.bugs)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1246945#c2)• 9 years ago |
|  | |

Similar bugs have been rated sec-high. Looking into what can be done to mitigate this.Flags: needinfo?(robert.strong.bugs)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a5125832_280903)• 9 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1246945#c3)• 9 years ago |
|  | |

Matt, is this another one of these bugs that you'll be looking at?Flags: needinfo?(mhowell)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1246945#c4)• 9 years ago |
|  | |

This one wasn't on my radar, but I'll go ahead and take it.
rstrong, did you ever have time to come up with any mitigation ideas? This exploit uses a replace request, so it's exploiting the fact that moving the existing log file to the new temporary path before we append to it preserves the hard link from the source path. My first thought is that we should be able to move that file in a way that breaks the link.Assignee: nobody → mhowellFlags: needinfo?(mhowell) → needinfo?(robert.strong.bugs)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1246945#c5)• 9 years ago |
|  | |

Attached patch

[Patch](attachment.cgi?id=8761353&action=diff) (obsolete)
— [Details](attachment.cgi?id=8761353&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8761353)

This patch copies the existing log file instead of moving it; the original is then deleted by already existing code. This copies the content of the log while breaking the hard link.Flags: needinfo?(robert.strong.bugs)

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1246945#c6)• 9 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=574ce180d5e8>

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a10395229_550257)• 9 years ago |

[Attachment #8761353](/attachment.cgi?id=8761353&action=edit "Patch") -
Flags: review?(robert.strong.bugs)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1246945#c7)• 9 years ago |
|  | |

Note: in [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") I am removing the append option from logging which also fixes this bug.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1246945#c8)• 9 years ago |
|  | |

Comment on [attachment 8761353](/attachment.cgi?id=8761353 "Patch") [[details]](/attachment.cgi?id=8761353&action=edit "Patch") [[diff]](/attachment.cgi?id=8761353&action=diff "Patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8761353)
Patch
Won't this suffer from the same issue as [bug 1171518](/show_bug.cgi?id=1171518 "RESOLVED FIXED - [Win] Privileged update processes writing to user writable locations can overwrite non-user writable locations using hard links") when using CopyFile?
[Attachment #8761353](/attachment.cgi?id=8761353&action=edit "Patch") -
Flags: review?(robert.strong.bugs) → review-

|  | [Molly Howell (she/her) (mostly inactive)](/user_profile?user_id=550257) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1246945#c9)• 9 years ago |
|  | |

(In reply to Robert Strong [:rstrong] (use needinfo to contact me) from [comment #8](/show_bug.cgi?id=1246945#c8 "VERIFIED FIXED - Write to arbitrary file with updater and moz maintenance service using updater.log hardlink"))
> Won't this suffer from the same issue as [bug 1171518](/show_bug.cgi?id=1171518 "RESOLVED FIXED - [Win] Privileged update processes writing to user writable locations can overwrite non-user writable locations using hard links") when using CopyFile?
Yeah, looks like it would. I could mitigate that to a degree by including some randomness in the temp file name, instead of a timestamp like GetTempFileName uses. Do you want to bother in light of [comment 7](/show_bug.cgi?id=1246945#c7 "VERIFIED FIXED - Write to arbitrary file with updater and moz maintenance service using updater.log hardlink") though? Removing the append functionality is definitely the better fix.Flags: needinfo?(robert.strong.bugs)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1246945#c10)• 9 years ago |
|  | |

I think it would be better to go with [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup")Flags: needinfo?(robert.strong.bugs)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1246945#c11)• 9 years ago |
|  | |

Al, the client patch in [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") addresses this bug and I'd like to know how you'd like to handle getting that landed. Would you prefer that I put the client patch that only fixes this bug in this bug for the security approvals, etc. for landing on other branches and if so would you like the client patch without the additional cleanup? I don't think the additional cleanup is that risky to land on other branches especially since we are early in this cycle but I'm not against reducing the changes. Also, the test patches in [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") will need to land on the branches as well. Thanks!Flags: needinfo?(abillings)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1246945#c12)• 9 years ago |
|  | |

I'd just ask for sec-approval here and branch approvals with the caveat to all involved that we're actually approving (quietly) the patches for [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup"), if that works for you. That's assuming that the patches there are review+ in general.Flags: needinfo?(abillings)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1246945#c13)• 9 years ago |
|  | |

Works for me and thanks!

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a10565309_141755)• 9 years ago |

Assignee: mhowell → robert.strong.bugsStatus: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a10565636_141755)• 9 years ago |

[Attachment #8761353](/attachment.cgi?id=8761353&action=edit "Patch") -
Attachment is obsolete: true

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1246945#c14)• 9 years ago |
|  | |

Attached patch

[bug 1168743 client patch](attachment.cgi?id=8762239&action=diff)
— [Details](attachment.cgi?id=8762239&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8762239)

Attaching client patch from [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") so I have something to request sec-approcal on
[Security approval request comment]
How easily could an exploit be constructed based on the patch? Not easily at all since this fix was done as part of [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup").
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? Not at all
Which older supported branches are affected by this flaw? It was introduced in Firefox 42 in [bug 1171518](/show_bug.cgi?id=1171518 "RESOLVED FIXED - [Win] Privileged update processes writing to user writable locations can overwrite non-user writable locations using hard links") to fix a different security bug. So, all supported branches.
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? I don't expect any difficulty in creating backports.
How likely is this patch to cause regressions; how much testing does it need? Not very likely but I'd like this to spend a week or two on nightly before uplifting as with all app update changes. With this being the start of the cycle this shouldn't be a problem.
[Attachment #8762239](/attachment.cgi?id=8762239&action=edit "bug 1168743 client patch") -
Flags: sec-approval?
[Attachment #8762239](/attachment.cgi?id=8762239&action=edit "bug 1168743 client patch") -
Flags: review+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a10586718_280903)• 9 years ago |

[Attachment #8762239](/attachment.cgi?id=8762239&action=edit "bug 1168743 client patch") -
Flags: sec-approval? → sec-approval+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1246945#c15)• 9 years ago |
|  | |

Pushed patches in [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") to mozilla-inbound.
Pushed by rstrong@mozilla.com:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/a78bd6c722f8>
test data files - Only use env vars in the test updater and general app update cleanup. r=mhowell
<https://hg.mozilla.org/integration/mozilla-inbound/rev/8f965be1037f>
client changes - Only use env vars in the test updater and general app update cleanup. r=mhowell
<https://hg.mozilla.org/integration/mozilla-inbound/rev/c69b17415feb>
test changes - Only use env vars in the test updater and general app update cleanup. r=mhowell

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1246945#c16)• 9 years ago |
|  | |

After the patches from [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") have baked on m-c nightly for a while I'll request branch approval.Status: ASSIGNED → RESOLVEDClosed: 9 years agoResolution: --- → FIXED

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a12038074_1689)• 9 years ago |

Group: toolkit-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1246945#c17)• 9 years ago |
|  | |

Has it baked enough? It's too late to get this into Beta but would be nice to get it into Aurora so it has the full Beta period for testing.
[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix)
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)Flags: needinfo?(robert.strong.bugs)Whiteboard: fixed by bug 1168743

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1246945#c18)• 9 years ago |
|  | |

After baking I found a regression ([bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors")) that needs to be fixed first and I am working on.Flags: needinfo?(robert.strong.bugs)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1246945#c19)• 9 years ago |
|  | |

Definitely a no-go for Fx48 then; maybe it'll make Firefox 49.
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Gerry Chang [:gchang]](/user_profile?user_id=506302) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1246945#c20)• 8 years ago |
|  | |

Hi :rstrong,
Since this patch also affects 49, are you also considering to uplift this patch to 49 beta?Flags: needinfo?(robert.strong.bugs)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1246945#c21)• 8 years ago |
|  | |

I have considered it and don't think it should be uplifted at present due to [comment #18](/show_bug.cgi?id=1246945#c18 "VERIFIED FIXED - Write to arbitrary file with updater and moz maintenance service using updater.log hardlink").Flags: needinfo?(robert.strong.bugs)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1246945#c22)• 8 years ago |
|  | |

[Bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors") is marked as unaffected for 49. Does that change things? Or do you think it also affects 49?
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fix-optional](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fix-optional)Flags: needinfo?(robert.strong.bugs)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1246945#c23)• 8 years ago |
|  | |

The patch in [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") which fixes this bug caused [bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors"). I'd like the patch for [bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors") to bake a little longer but after that I am ok with uplifting [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") and [bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors") if you want them. Please note that like most of the app update bugs like this that local system access is necessary to exploit this and afaik we haven't had reports of this ever happening.Flags: needinfo?(robert.strong.bugs) → needinfo?(lhenry)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1246945#c24)• 8 years ago |
|  | |

I'm happier to leave it in 50. Thanks!
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[fix-optional](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fix-optional) → [wontfix](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=wontfix)Flags: needinfo?(lhenry)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1246945#c25)• 8 years ago |
|  | |

seems that esr will have to leave with this bug, are we ok?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a17545164_280903)• 8 years ago |

Flags: sec-bounty?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1246945#c26)• 8 years ago |
|  | |

How about uplifting this to esr when this merges to beta?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1246945#c27)• 8 years ago |
|  | |

If [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") is uplifted to esr45 I'd like to take [bug 1212939](/show_bug.cgi?id=1212939 "VERIFIED FIXED - Maintenance Service updater File Deletion Elevation of Privilege") as well to simplify the changes needed for the esr45 patch. In case we do decide at some point to uplift to esr45 I've created an esr45 patch for [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") and will soon create one for [bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors").

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1246945#c28)• 8 years ago |
|  | |

I have patches that apply to esr45 and the tests pass locally if this is wanted after the merge from aurora to beta.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1246945#c29)• 8 years ago |
|  | |

I think we should take this on ESR45.5 (shipping with Firefox 50).
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) → [50+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=50%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a18672755_1689)• 8 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1246945#c30)• 8 years ago |
|  | |

Requested esr45 on [bug 1212939](/show_bug.cgi?id=1212939 "VERIFIED FIXED - Maintenance Service updater File Deletion Elevation of Privilege") to simplify the landing of this patch.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1246945#c31)• 8 years ago |
|  | |

Attached patch

[esr45 bug 1168743 client patch](attachment.cgi?id=8790403&action=diff)
— [Details](attachment.cgi?id=8790403&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8790403)

This patch requires the patch from [bug 1212939](/show_bug.cgi?id=1212939 "VERIFIED FIXED - Maintenance Service updater File Deletion Elevation of Privilege") and [bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors") (I'll attach the patch for [bug 1299333](/show_bug.cgi?id=1299333 "RESOLVED FIXED - Fix app update test file in use checks") in this bug as well).
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined: Possible to write to arbitrary file with local computer access using the updater and moz maintenance service and an updater log hardlink
Fix Landed on Version: Firefox 50
Risk to taking this patch (and alternatives if risky): Minimal. The fix and the regression the patch caused has baked on Nightly and Aurora.
String or UUID changes made by this patch: None
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not easily at all since this fix was done as part of [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup").
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Not at all
Which older supported branches are affected by this flaw?
It was introduced in Firefox 42 in [bug 1171518](/show_bug.cgi?id=1171518 "RESOLVED FIXED - [Win] Privileged update processes writing to user writable locations can overwrite non-user writable locations using hard links") to fix a different security bug. So, all supported branches.
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Yes, I do.
How likely is this patch to cause regressions; how much testing does it need?
Not likely since it has baked on Nightly and Aurora for quite some time. Only normal update testing should be needed.
[Attachment #8790403](/attachment.cgi?id=8790403&action=edit "esr45 bug 1168743 client patch") -
Flags: sec-approval?
[Attachment #8790403](/attachment.cgi?id=8790403&action=edit "esr45 bug 1168743 client patch") -
Flags: review+
[Attachment #8790403](/attachment.cgi?id=8790403&action=edit "esr45 bug 1168743 client patch") -
Flags: approval-mozilla-esr45?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1246945#c32)• 8 years ago |
|  | |

Attached patch

[esr45 patch for bug 1299333](attachment.cgi?id=8790404&action=diff)
— [Details](attachment.cgi?id=8790404&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8790404)

[Approval Request Comment]
See previous request
[Attachment #8790404](/attachment.cgi?id=8790404&action=edit "esr45 patch for bug 1299333") -
Flags: approval-mozilla-esr45?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1246945#c33)• 8 years ago |
|  | |

Note: I'll land this myself since there are several test patches that go along with it.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1246945#c34)• 8 years ago |
|  | |

This can land on 9/20. sec-approval for that date for trunk. I think we'll want to move this up the branches after things are settled on trunk.
The flags on this bug are confusing since it isn't really "fixed" on 50 is it?Whiteboard: fixed by bug 1168743 → fixed by bug 1168743 [checkin on 9/20]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a18777183_280903)• 8 years ago |

[Attachment #8790403](/attachment.cgi?id=8790403&action=edit "esr45 bug 1168743 client patch") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1246945#c35)• 8 years ago |
|  | |

or is this patch ESR only?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1246945#c36)• 8 years ago |
|  | |

This patch is esr only

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1246945#c37)• 8 years ago |
|  | |

Ah, ok. Thank you for making this clear.

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1246945#c38)• 8 years ago |
|  | |

Liz, esr approval pingFlags: needinfo?(lhenry)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1246945#c39)• 8 years ago |
|  | |

Comment on [attachment 8790403](/attachment.cgi?id=8790403 "esr45 bug 1168743 client patch") [[details]](/attachment.cgi?id=8790403&action=edit "esr45 bug 1168743 client patch") [[diff]](/attachment.cgi?id=8790403&action=diff "esr45 bug 1168743 client patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1246945&attachment=8790403)
esr45 [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") client patch
Already landed in 50, sec-high, let's take this for ESR45.5.0.Flags: needinfo?(lhenry)
[Attachment #8790403](/attachment.cgi?id=8790403&action=edit "esr45 bug 1168743 client patch") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1246945#c40)• 8 years ago |
|  | |

Liz, this also needs the patch in [bug 1212939](/show_bug.cgi?id=1212939 "VERIFIED FIXED - Maintenance Service updater File Deletion Elevation of Privilege"). Can I get approval for that as well?Flags: needinfo?(lhenry)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a21262931_141755)• 8 years ago |

Flags: needinfo?(lhenry)

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a21287473_141755)• 8 years ago |

[Attachment #8790404](/attachment.cgi?id=8790404&action=edit "esr45 patch for bug 1299333") -
Flags: approval-mozilla-esr45?

|  | [Robert Strong (they/them - no direct email)](/user_profile?user_id=141755)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1246945#c41)• 8 years ago |
|  | |

Pushed the patches from [bug 1168743](/show_bug.cgi?id=1168743 "RESOLVED FIXED - Only use env vars in the test updater and general cleanup") to mozilla-esr45
<https://hg.mozilla.org/releases/mozilla-esr45/rev/54f7eaaa6de3> test data files
<https://hg.mozilla.org/releases/mozilla-esr45/rev/a1e06af61ab3> client code
<https://hg.mozilla.org/releases/mozilla-esr45/rev/6ac20c152794> test code
Pushed the patches from [bug 1287176](/show_bug.cgi?id=1287176 "RESOLVED FIXED - Status file not written for staging errors") to mozilla-esr45
<https://hg.mozilla.org/releases/mozilla-esr45/rev/0569d5dce9db> client code
<https://hg.mozilla.org/releases/mozilla-esr45/rev/804d7029982c> test code
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a23249655_452604)• 8 years ago |

Flags: qe-verify+QA Contact: kjozwiakWhiteboard: fixed by bug 1168743 [checkin on 9/20] → fixed by bug 1168743 [checkin on 9/20][post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a23536543_280903)• 8 years ago |

Whiteboard: fixed by bug 1168743 [checkin on 9/20][post-critsmash-triage] → fixed by bug 1168743 [checkin on 9/20][post-critsmash-triage][adv-main50+][adv-esr45.5+]

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1246945#c42)• 8 years ago |
|  | |

I managed to reproduce this issue using Firefox 49.0.2 build 2 and STR from [Comment 0](/show_bug.cgi?id=1246945#c0 "VERIFIED FIXED - Write to arbitrary file with updater and moz maintenance service using updater.log hardlink").
The issue is no longer reproducible on Firefox 45.5.0ESR, Firefox 50.0, Firefox 51.0a2(2016-11-08), or on Firefox 52.0a1(2016-11-07).
Tests were performed under Windows 10x64.Status: RESOLVED → VERIFIED
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified)
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- → [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified)

|  | [Kamil Jozwiak [:kjozwiak]](/user_profile?user_id=455785) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1246945#c43)• 8 years ago |
|  | |

As :mboldan used Win 10 x64 for verification, I double checked using Win 7 as it was the original platform used in [comment#0](/show_bug.cgi?id=1246945#c0 "VERIFIED FIXED - Write to arbitrary file with updater and moz maintenance service using updater.log hardlink").
Reproduced the issue using the POC from [comment#0](/show_bug.cgi?id=1246945#c0 "VERIFIED FIXED - Write to arbitrary file with updater and moz maintenance service using updater.log hardlink") with the following build:
\* <https://archive.mozilla.org/pub/firefox/nightly/2016/02/2016-02-09-03-03-47-mozilla-central/>
Platform used:
\* Win 7 SP1 x64 - PASSED
Changed the appropriate paths under "write.poc\poc.rb" when using fx51.0a2 and fx50.0b9.
FX builds being used:
\* fx52.0a1, buildId: 20161108030212, changeset: f13e90d496cf - PASSED
\* fx51.0a2, buildId: 20161108004019, changeset: d9cfe58247e8 - PASSED
\* fx50.0b9, buildId: 20161020152750, changeset: 2bb6dc758711 - PASSED
\* fx45.5.0, buildId: 20161031153904, changeset: 32ce7be98543 - PASSED

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a23775350_280903)• 8 years ago |

Alias: CVE-2016-5293

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a24908695_75935)• 8 years ago |

Whiteboard: fixed by bug 1168743 [checkin on 9/20][post-critsmash-triage][adv-main50+][adv-esr45.5+] → [post-critsmash-triage][adv-main50+][adv-esr45.5+] fixed by bug 1168743

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a31626116_1689)• 8 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1246945#a262055298_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1246945&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Holger Fuhrmannek](/user_profile?user_id=436533)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ce132be8_20250125_123853.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2016-89

## Security vulnerabilities fixed in Firefox 50

Announced
November 15, 2016
Impact
critical
Products
Firefox
Fixed in

* Firefox 50

#### [#CVE-2016-5296: Heap-buffer-overflow WRITE in rasterize\_edges\_1](#CVE-2016-5296)

Reporter
Abhishek Arya
Impact
critical
##### Description

A heap-buffer-overflow in Cairo when processing SVG content caused by compiler optimization, resulting in a potentially exploitable crash.

##### References

* [Bug 1292443](https://bugzilla.mozilla.org/show_bug.cgi?id=1292443)

#### [#CVE-2016-5292: URL parsing causes crash](#CVE-2016-5292)

Reporter
Daniel Browning
Impact
high
##### Description

During URL parsing, a maliciously crafted URL can cause a potentially exploitable crash.

##### References

* [Bug 1288482](https://bugzilla.mozilla.org/show_bug.cgi?id=1288482)

#### [#CVE-2016-5293: Write to arbitrary file with Mozilla Updater and Maintenance Service using updater.log hardlink](#CVE-2016-5293)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

When the Mozilla Updater is run, if the Updater's log file in the working directory points to a hardlink, data can be appended to an arbitrary local file. This vulnerability requires local system access.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1246945](https://bugzilla.mozilla.org/show_bug.cgi?id=1246945)

#### [#CVE-2016-5294: Arbitrary target directory for result files of update process](#CVE-2016-5294)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

The Mozilla Updater can be made to choose an arbitrary target working directory for output files resulting from the update process. This vulnerability requires local system access.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1246972](https://bugzilla.mozilla.org/show_bug.cgi?id=1246972)

#### [#CVE-2016-5297: Incorrect argument length checking in JavaScript](#CVE-2016-5297)

Reporter
André Bargull
Impact
high
##### Description

An error in argument length checking in JavaScript, leading to potential integer overflows or other bounds checking issues.

##### References

* [Bug 1303678](https://bugzilla.mozilla.org/show_bug.cgi?id=1303678)

#### [#CVE-2016-9064: Add-ons update must verify IDs match between current and new versions](#CVE-2016-9064)

Reporter
Multiple people
Impact
high
##### Description

Add-on updates failed to verify that the add-on ID inside the signed package matched the ID of the add-on being updated. An attacker who could perform a man-in-the-middle attack on the user's connection to the update server and defeat the certificate pinning protection could provide a malicious signed add-on instead of a valid update.

##### References

* [Bug 1303418](https://bugzilla.mozilla.org/show_bug.cgi?id=1303418)

#### [#CVE-2016-9065: Firefox for Android location bar spoofing using fullscreen](#CVE-2016-9065)

Reporter
Raphael
Impact
high
##### Description

The location bar in Firefox for Android can be spoofed by forcing a user into fullscreen mode, blocking its exiting, and creating of a fake location bar without any user notification.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1306696](https://bugzilla.mozilla.org/show_bug.cgi?id=1306696)

#### [#CVE-2016-9066: Integer overflow leading to a buffer overflow in nsScriptLoadHandler](#CVE-2016-9066)

Reporter
Samuel Groß
Impact
high
##### Description

A buffer overflow resulting in a potentially exploitable crash due to memory allocation issues when handling large amounts of incoming data.

##### References

* [Bug 1299686](https://bugzilla.mozilla.org/show_bug.cgi?id=1299686)

#### [#CVE-2016-9067: heap-use-after-free in nsINode::ReplaceOrInsertBefore](#CVE-2016-9067)

Reporter
Nils
Impact
high
##### Description

Two use-after-free errors during DOM operations resulting in potentially exploitable crashes.

##### References

* [Bug 1301777 (CVE-2016-9067)](https://bugzilla.mozilla.org/show_bug.cgi?id=1301777)
* [Bug 1308922 (CVE-2016-9069)](https://bugzilla.mozilla.org/show_bug.cgi?id=1308922)

#### [#CVE-2016-9068: heap-use-after-free in nsRefreshDriver](#CVE-2016-9068)

Reporter
Nils
Impact
high
##### Description

A use-after-free during web animations when working with timelines resulting in a potentially exploitable crash.

##### References

* [Bug 1302973](https://bugzilla.mozilla.org/show_bug.cgi?id=1302973)

#### [#CVE-2016-9072: 64-bit NPAPI sandbox isn't enabled on fresh profile](#CVE-2016-9072)

Reporter
Bob Owen
Impact
high
##### Description

When a new Firefox profile is created on 64-bit Windows installations, the sandbox for 64-bit NPAPI plugins is not enabled by default.
*Note: This issue only affects 64-bit Windows. 32-bit Windows and other operating systems are unaffected.*

##### References

* [Bug 1300083](https://bugzilla.mozilla.org/show_bug.cgi?id=1300083)

#### [#CVE-2016-9075: WebExtensions can access the mozAddonManager API and use it to gain elevated privileges](#CVE-2016-9075)

Reporter
Kris Maglione
Impact
high
##### Description

An issue where WebExtensions can use the mozAddonManager API to elevate privilege due to privileged pages being allowed in the permissions list. This allows a malicious extension to then install additional extensions without explicit user permission.

##### References

* [Bug 1295324](https://bugzilla.mozilla.org/show_bug.cgi?id=1295324)

#### [#CVE-2016-9077: Canvas filters allow feDisplacementMaps to be applied to cross-origin images, allowing timing attacks on them](#CVE-2016-9077)

Reporter
Markus Stange
Impact
high
##### Description

Canvas allows the use of the `feDisplacementMap` filter on images loaded cross-origin. The rendering by the filter is variable depending on the input pixel, allowing for timing attacks when the images are loaded from third party locations.

##### References

* [Bug 1298552](https://bugzilla.mozilla.org/show_bug.cgi?id=1298552)

#### [#CVE-2016-5291: Same-origin policy violation using local HTML file and saved shortcut file](#CVE-2016-5291)

Reporter
Yuyang Zhou
Impact
moderate
##### Description

A same-origin policy bypass with local shortcut files to load arbitrary local content from disk.

##### References

* [Bug 1292159](https://bugzilla.mozilla.org/show_bug.cgi?id=1292159)

#### [#CVE-2016-5295: Mozilla Maintenance Service: Ability to read arbitrary files as SYSTEM](#CVE-2016-5295)

Reporter
Holger Fuhrmannek
Impact
moderate
##### Description

This vulnerability allows an attacker to use the Mozilla Maintenance Service to escalate privilege by having the Maintenance Service invoke the Mozilla Updater to run malicious local files. This vulnerability requires local system access and is a variant of MFSA2013-44.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1247239](https://bugzilla.mozilla.org/show_bug.cgi?id=1247239)
* [MFSA2013-44 - Local privilege escalation through Mozilla Maintenance Service](https://www.mozilla.org/en-US/security/advisories/mfsa2013-44/)

#### [#CVE-2016-5298: SSL indicator can mislead the user about the real URL visited](#CVE-2016-5298)

Reporter
Jordi Chancel
Impact
moderate
##### Description

A mechanism where disruption of the loading of a new web page can cause the previous page's favicon and SSL indicator to not be reset when the new page is loaded.
*Note: this issue only affects Firefox for Android. Desktop Firefox is unaffected.*

##### References

* [Bug 1227538](https://bugzilla.mozilla.org/show_bug.cgi?id=1227538)

#### [#CVE-2016-5299: Firefox AuthToken in broadcast protected with signature-level permission can be accessed by an application installed beforehand that defines the same permissions](#CVE-2016-5299)

Reporter
Ken Okuyama
Impact
moderate
##### Description

A previously installed malicious Android application with same signature-level permissions as Firefox can intercept AuthTokens meant for Firefox only.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1245791](https://bugzilla.mozilla.org/show_bug.cgi?id=1245791)

#### [#CVE-2016-9061: API key (glocation) in broadcast protected with signature-level permission can be accessed by an application installed beforehand that defines the same permissions](#CVE-2016-9061)

Reporter
Ken Okuyama
Impact
moderate
##### Description

A previously installed malicious Android application which defines a specific signature-level permissions used by Firefox can access API keys meant for Firefox only.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1245795](https://bugzilla.mozilla.org/show_bug.cgi?id=1245795)

#### [#CVE-2016-9062: Private browsing browser traces (Android) in browser.db and wal file](#CVE-2016-9062)

Reporter
Daniel D.
Impact
moderate
##### Description

Private browsing mode leaves metadata information, such as URLs, for sites visited in `browser.db` and `browser.db-wal` files within the Firefox profile after the mode is exited.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1294438](https://bugzilla.mozilla.org/show_bug.cgi?id=1294438)

#### [#CVE-2016-9070: Sidebar bookmark can have reference to chrome window](#CVE-2016-9070)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

A maliciously crafted page loaded to the sidebar through a bookmark can reference a privileged chrome window and engage in limited JavaScript operations violating cross-origin protections.

##### References

* [Bug 1281071](https://bugzilla.mozilla.org/show_bug.cgi?id=1281071)

#### [#CVE-2016-9073: windows.create schema doesn't specify "format": "relativeUrl"](#CVE-2016-9073)

Reporter
Will Bamberg
Impact
moderate
##### Description

WebExtensions can bypass security checks to load privileged URLs and potentially escape the WebExtension sandbox.

##### References

* [Bug 1289273](https://bugzilla.mozilla.org/show_bug.cgi?id=1289273)

#### [#CVE-2016-9074: Insufficient timing side-channel resistance in divSpoiler](#CVE-2016-9074)

Reporter
Franziskus Kiefer
Impact
moderate
##### Description

An existing mitigation of timing side-channel attacks is insufficient in some circumstances. This issue is addressed in Network Security Services (NSS) 3.26.1.

##### References

* [Bug 1293334](https://bugzilla.mozilla.org/show_bug.cgi?id=1293334)

#### [#CVE-2016-9076: select dropdown menu can be used for URL bar spoofing on e10s](#CVE-2016-9076)

Reporter
Mats Palmgren
Impact
moderate
##### Description

An issue where a `<select>` dropdown menu can be used to cover location bar content, resulting in potential spoofing attacks. This attack requires e10s to be enabled in order to function.

##### References

* [Bug 1276976](https://bugzilla.mozilla.org/show_bug.cgi?id=1276976)

#### [#CVE-2016-9063: Possible integer overflow to fix inside XML\_Parse in Expat](#CVE-2016-9063)

Reporter
Gustavo Grieco
Impact
low
##### Description

An integer overflow during the parsing of XML using the Expat library.

##### References

* [Bug 1274777](https://bugzilla.mozilla.org/show_bug.cgi?id=1274777)

#### [#CVE-2016-9071: Probe browser history via HSTS/301 redirect + CSP](#CVE-2016-9071)

Reporter
Xiaoyin Liu
Impact
low
##### Description

Content Security Policy combined with HTTP to HTTPS redirection can be used by malicious server to verify whether a known site is within a user's browser history.

##### References

* [Bug 1285003](https://bugzilla.mozilla.org/show_bug.cgi?id=1285003)

#### [#CVE-2016-5289: Memory safety bugs fixed in Firefox 50](#CVE-2016-5289)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Christian Holler, Andrew McCreight, Dan Minor, Tyson Smith, Jon Coppeard, Jan-Ivar Bruaroey, Jesse Ruderman, and Markus Stange reported memory safety bugs present in Firefox 49. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 50](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1296649%2C1298107%2C1300129%2C1305876%2C1314667%2C1301252%2C1277866%2C1307254%2C1252511%2C1264053)

#### [#CVE-2016-5290: Memory safety bugs fixed in Firefox 50 and Firefox ESR 45.5](#CVE-2016-5290)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Olli Pettay, Christian Holler, Ehsan Akhgari, Jon Coppeard, Gary Kwong, Tooru Fujisawa, Philipp, and Randell Jesup reported memory safety bugs present in Firefox 49 and Firefox ESR 45.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 50 and Firefox ESR 45.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1309720%2C1297062%2C1303710%2C1018486%2C1292590%2C1301343%2C1301496%2C1308048%2C1308346%2C1299519%2C1286911%2C1298169)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.mozilla.org_b17a7bc6_20250126_083452.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1288482)
* [XML](/show_bug.cgi?ctype=xml&id=1288482)

Closed
[Bug 1288482](/show_bug.cgi?id=1288482)
(CVE-2016-5292)

Opened 9 years ago
Closed 8 years ago

# URL parsing causes crash

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

URL parsing causes crash

## Categories

### (Core :: Networking, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

50 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla50

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix) |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | --- | [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) |
| firefox-esr45 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected) |
| firefox50 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 |  | wontfix |
| firefox48 |  | wontfix |
| firefox49 |  | affected |
| firefox-esr45 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 |  | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: tsmith, Assigned: valentin)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40)  [valentin](/user_profile?user_id=415378)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/a2837b951fa7dc639a2568203478ff0a?d=mm&size=40)  [tsmith](/user_profile?user_id=486634)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

10 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request"), [1288481](/show_bug.cgi?id=1288481 "RESOLVED DUPLICATE - Crash in libsystem_platform.dylib@0x1360"), [1873915](/show_bug.cgi?id=1873915 "RESOLVED FIXED - %2e entered in URL bar not normalized leading to denormalized request")

Dependency [tree](/showdependencytree.cgi?id=1288482&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1288482)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1288123](/show_bug.cgi?id=1288123 "RESOLVED DUPLICATE - [WARNING MAY CRASH BROWSER] URL parsing causes crash"), [1288481](/show_bug.cgi?id=1288481 "RESOLVED DUPLICATE - Crash in libsystem_platform.dylib@0x1360")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1288123](/show_bug.cgi?id=1288123 "RESOLVED DUPLICATE - [WARNING MAY CRASH BROWSER] URL parsing causes crash")

## Details

### (Keywords: sec-high, testcase, Whiteboard: [necko-active][post-critsmash-triage][adv-main50+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2016-5292

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-active][post-critsmash-triage][adv-main50+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c15 "8 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a9158807_452604 "8 years ago") | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 1 obsolete file)

| [linux\_asan\_log.txt](/attachment.cgi?id=8773364)  [9 years ago](#c0)  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)   7.33 KB, text/plain |  | [Details](/attachment.cgi?id=8773364&action=edit) |
| --- | --- | --- |
| [test\_case.html](/attachment.cgi?id=8773365)  [9 years ago](#c1)  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)   93 bytes, text/html |  | [Details](/attachment.cgi?id=8773365&action=edit) |
| [Backout bug 1288482](/attachment.cgi?id=8774136)  [9 years ago](#c7)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   7.74 KB, patch |  | [Details](/attachment.cgi?id=8774136&action=edit) | [Diff](/attachment.cgi?id=8774136&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774136) |
| [Backout bug 1042347](/attachment.cgi?id=8774154)  [9 years ago](#c8)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   7.74 KB, patch | mcmanus : [review+](#c11 "9 years ago")  abillings : [sec-approval+](#c14 "8 years ago") | [Details](/attachment.cgi?id=8774154&action=edit) | [Diff](/attachment.cgi?id=8774154&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774154) |
| [Backout bug 1042347 [aurora]](/attachment.cgi?id=8776409)  [8 years ago](#c17)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   7.72 KB, patch | Sylvestre : [approval-mozilla-aurora+](#c19 "8 years ago") | [Details](/attachment.cgi?id=8776409&action=edit) | [Diff](/attachment.cgi?id=8776409&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8776409) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1288482#c0)• 9 years ago |
|  | |

Attached file
[linux\_asan\_log.txt](attachment.cgi?id=8773364)
— [Details](attachment.cgi?id=8773364&action=edit)

+++ This bug was initially created as a clone of [Bug #1288123](/show_bug.cgi?id=1288123 "RESOLVED DUPLICATE - [WARNING MAY CRASH BROWSER] URL parsing causes crash") +++
NOTE: This clone was created because the description of the initial bug was crashing browsers. The original was logged by db@kavod.com.
WARNING: Opening the [Bug #1288123](/show_bug.cgi?id=1288123 "RESOLVED DUPLICATE - [WARNING MAY CRASH BROWSER] URL parsing causes crash") may trigger crash.
User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_11\_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36
Steps to reproduce:
Create an html page with the following contents, access it, then "reload this page" one time.
Actual results:
It crashes for version 46+ on OS X, including FirefoxNightly 50.0a1 (2016-07-15). Older versions and other platforms work. (45 on OS X works, 47 on Linux works, etc.)
Process: firefox [38048]
Path: /Applications/NightlyDebug.app/Contents/MacOS/firefox
Identifier: org.mozilla.nightlydebug
Version: 47.0.2 (4716.7.2)
Code Type: X86-64 (Native)
Parent Process: ??? [1]
Responsible: firefox [38048]
User ID: 25628395
Date/Time: 2016-07-20 08:00:17.778 -0700
OS Version: Mac OS X 10.11.5 (15F34)
Report Version: 11
Anonymous UUID: 4F065409-6410-EED7-4352-470B9B7EA9DD
Sleep/Wake UUID: 1B10C1A4-591F-4DAC-AD77-30B47ECCF792
Time Awake Since Boot: 400000 seconds
Time Since Wake: 2900 seconds
System Integrity Protection: enabled
Crashed Thread: 0 Dispatch queue: com.apple.main-thread
Exception Type: EXC\_BAD\_ACCESS (SIGSEGV)
Exception Codes: KERN\_INVALID\_ADDRESS at 0x0000000213393047
Exception Note: EXC\_CORPSE\_NOTIFY
VM Regions Near 0x213393047:
mapped file 000000019de00000-000000019e082000 [ 2568K] r--/rwx SM=COW
-->
STACK GUARD 0000700000000000-0000700000001000 [ 4K] ---/rwx SM=NUL stack guard for thread 62
Thread 0 Crashed:: Dispatch queue: com.apple.main-thread
0 libsystem\_platform.dylib 0x00007fff83382360 \_platform\_strncmp + 320
1 XUL 0x00000001052a5db7 0x105093000 + 2174391
2 XUL 0x00000001086e0f64 0x105093000 + 56942436
3 XUL 0x00000001051b695a 0x105093000 + 1194330
4 XUL 0x00000001051b1b9d 0x105093000 + 1174429
5 XUL 0x000000010866a5ae 0x105093000 + 56456622
6 XUL 0x000000010623009f 0x105093000 + 18469023
7 XUL 0x00000001062fb175 0x105093000 + 19300725
[...]
Expected results:
No crash.

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1288482#c1)• 9 years ago |
|  | |

Attached file
[test\_case.html](attachment.cgi?id=8773365)
— [Details](attachment.cgi?id=8773365&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1288482#c3)• 9 years ago |
|  | |

Valentin, could you look at this? The top of the stack at least is in a strcmp of some URL thing, I believe.Flags: needinfo?(valentin.gosu)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a444_406194)• 9 years ago |

Blocks: [1288481](/show_bug.cgi?id=1288481 "RESOLVED DUPLICATE - Crash in libsystem_platform.dylib@0x1360")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1288482#c4)• 9 years ago |
|  | |

Members of the triage team observed a crash in Nightly (50) on Mac and Linux, but not on Windows. No crash on Dev Edition (49). Since it appears to be a bad access from strcmp() whether it crashes may depend on build differences and what happens to be allocated at the incorrect pointer. Testing in an ASAN build may reveal this to go back much much further than the reporter's 46+ (though we don't have to care about anything earlier than ESR-45 at this point).
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=%3F)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F)Summary: JS oneliner causes segfault on OS X → URL parsing causes crash

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1288482#c5)• 9 years ago |
|  | |

The issue seems to have been introduced by [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request").
It happens because nsStandardURL::CoalescePath is expecting net\_CoalesceDirs to only normalize the directory, not the entire filepath - which screws up the offsets.Assignee: nobody → valentin.gosuFlags: needinfo?(valentin.gosu)Whiteboard: [necko-active]

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1288482#c6)• 9 years ago |
|  | |

thanks valentin

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1288482#c7)• 9 years ago |
|  | |

Attached patch

[Backout bug 1288482](attachment.cgi?id=8774136&action=diff) (obsolete)
— [Details](attachment.cgi?id=8774136&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774136)

MozReview-Commit-ID: J3LmMfQ854V
[Attachment #8774136](/attachment.cgi?id=8774136&action=edit "Backout bug 1288482") -
Flags: review?(mcmanus)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1288482#c8)• 9 years ago |
|  | |

Attached patch

[Backout bug 1042347](attachment.cgi?id=8774154&action=diff)
— [Details](attachment.cgi?id=8774154&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774154)

MozReview-Commit-ID: J3LmMfQ854V
[Attachment #8774154](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") -
Flags: review?(mcmanus)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a273967_415378)• 9 years ago |

[Attachment #8774136](/attachment.cgi?id=8774136&action=edit "Backout bug 1288482") -
Attachment is obsolete: true
[Attachment #8774136](/attachment.cgi?id=8774136&action=edit "Backout bug 1288482") -
Flags: review?(mcmanus)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1288482#c9)• 9 years ago |
|  | |

The fix for this was getting to be quite complicated - something I wouldn't feel confident to uplift.
So I think the right decision is to backout [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request"), and fix this corner case in that bug.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a278651_406194)• 9 years ago |

[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix)
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F) → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1288482#c11)• 8 years ago |
|  | |

Comment on [attachment 8774154](/attachment.cgi?id=8774154 "Backout bug 1042347") [[details]](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") [[diff]](/attachment.cgi?id=8774154&action=diff "Backout bug 1042347") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774154)
Backout [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request")
Review of [attachment 8774154](/attachment.cgi?id=8774154 "Backout bug 1042347") [[details]](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") [[diff]](/attachment.cgi?id=8774154&action=diff "Backout bug 1042347") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774154):
-----------------------------------------------------------------
just to note that this isn't a straight backout of <https://hg.mozilla.org/mozilla-central/rev/f3925f5ffdbb> because of a change in test coverage.. not sure if that will impact cleanliness of uplifts.
[Attachment #8774154](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") -
Flags: review?(mcmanus) → review+

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1288482#c12)• 8 years ago |
|  | |

Comment on [attachment 8774154](/attachment.cgi?id=8774154 "Backout bug 1042347") [[details]](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") [[diff]](/attachment.cgi?id=8774154&action=diff "Backout bug 1042347") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774154)
Backout [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request")
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not easily.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No, but bugs 1288481, 1288123, 1288481 are public and contain examples of URLs that crash the browsers.
Which older supported branches are affected by this flaw?
Starting with Mozilla 47
If not all supported branches, which bug introduced the flaw?
[Bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request").
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Easy to backport. Only involves a backout of [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request").
How likely is this patch to cause regressions; how much testing does it need?
Unlikely. Only a backout.
[Attachment #8774154](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1288482#c13)• 8 years ago |
|  | |

I'm giving this sec-approval+ for trunk checkin now since the URLs are visible in bugs.
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1288482#c14)• 8 years ago |
|  | |

Comment on [attachment 8774154](/attachment.cgi?id=8774154 "Backout bug 1042347") [[details]](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") [[diff]](/attachment.cgi?id=8774154&action=diff "Backout bug 1042347") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8774154)
Backout [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request")
We'll want patches for other affected branches made and nominated after this is on trunk.
[Attachment #8774154](/attachment.cgi?id=8774154&action=edit "Backout bug 1042347") -
Flags: sec-approval? → sec-approval+

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a738323_415378)• 8 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1288482#c15)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/405ec1364547>Flags: in-testsuite?Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1288482#c16)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/405ec1364547>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla50

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1288482#c17)• 8 years ago |
|  | |

Attached patch

[Backout bug 1042347 [aurora]](attachment.cgi?id=8776409&action=diff)
— [Details](attachment.cgi?id=8776409&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8776409)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1288482#c18)• 8 years ago |
|  | |

Comment on [attachment 8776409](/attachment.cgi?id=8776409 "Backout bug 1042347 [aurora]") [[details]](/attachment.cgi?id=8776409&action=edit "Backout bug 1042347 [aurora]") [[diff]](/attachment.cgi?id=8776409&action=diff "Backout bug 1042347 [aurora]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8776409)
Backout [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request") [aurora]
Approval Request Comment
[Feature/regressing bug #]: [Bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request")
[User impact if declined]: Crash with specially crafter URL. Security risk.
[Describe test coverage new/current, TreeHerder]: Some unit tests. Previous handling of %2e is known to be safe.
[Risks and why]: Low. This is just a backout.
[String/UUID change made/needed]: None.
[Attachment #8776409](/attachment.cgi?id=8776409&action=edit "Backout bug 1042347 [aurora]") -
Flags: approval-mozilla-aurora?

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1288482#c19)• 8 years ago |
|  | |

Comment on [attachment 8776409](/attachment.cgi?id=8776409 "Backout bug 1042347 [aurora]") [[details]](/attachment.cgi?id=8776409&action=edit "Backout bug 1042347 [aurora]") [[diff]](/attachment.cgi?id=8776409&action=diff "Backout bug 1042347 [aurora]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288482&attachment=8776409)
Backout [bug 1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request") [aurora]
Fix a crash and sec-high, taking it to aurora.
[Attachment #8776409](/attachment.cgi?id=8776409&action=edit "Backout bug 1042347 [aurora]") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a1551585_1689)• 8 years ago |

Group: network-core-security → core-security-release

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a4919362_415378)• 8 years ago |

Blocks: [1042347](/show_bug.cgi?id=1042347 "RESOLVED WONTFIX - %2e entered in URL bar not normalized leading to denormalized request")

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a9158807_452604)• 8 years ago |

Flags: qe-verify-Whiteboard: [necko-active] → [necko-active][post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a9443291_280903)• 8 years ago |

Whiteboard: [necko-active][post-critsmash-triage] → [necko-active][post-critsmash-triage][adv-main50+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a9683136_280903)• 8 years ago |

Alias: CVE-2016-5292

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a17534025_1689)• 8 years ago |

Group: core-security-release

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288482#a235774085_415378)• 1 year ago |

Blocks: [1873915](/show_bug.cgi?id=1873915 "RESOLVED FIXED - %2e entered in URL bar not normalized leading to denormalized request")
You need to [log in](/show_bug.cgi?id=1288482&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_106fad63_20250125_123854.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2016-90

## Security vulnerabilities fixed in Firefox ESR 45.5

Announced
November 15, 2016
Impact
critical
Products
Firefox ESR
Fixed in

* Firefox ESR 45.5

#### [#CVE-2016-5296: Heap-buffer-overflow WRITE in rasterize\_edges\_1](#CVE-2016-5296)

Reporter
Abhishek Arya
Impact
critical
##### Description

A heap-buffer-overflow in Cairo when processing SVG content caused by compiler optimization, resulting in a potentially exploitable crash.

##### References

* [Bug 1292443](https://bugzilla.mozilla.org/show_bug.cgi?id=1292443)

#### [#CVE-2016-5293: Write to arbitrary file with Mozilla Updater and Maintenance Service using updater.log hardlink](#CVE-2016-5293)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

When the Mozilla Updater is run, if the Updater's log file in the working directory points to a hardlink, data can be appended to an arbitrary local file. This vulnerability requires local system access.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1246945](https://bugzilla.mozilla.org/show_bug.cgi?id=1246945)

#### [#CVE-2016-5294: Arbitrary target directory for result files of update process](#CVE-2016-5294)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

The Mozilla Updater can be made to choose an arbitrary target working directory for output files resulting from the update process. This vulnerability requires local system access.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1246972](https://bugzilla.mozilla.org/show_bug.cgi?id=1246972)

#### [#CVE-2016-5297: Incorrect argument length checking in JavaScript](#CVE-2016-5297)

Reporter
André Bargull
Impact
high
##### Description

An error in argument length checking in JavaScript, leading to potential integer overflows or other bounds checking issues.

##### References

* [Bug 1303678](https://bugzilla.mozilla.org/show_bug.cgi?id=1303678)

#### [#CVE-2016-9064: Add-ons update must verify IDs match between current and new versions](#CVE-2016-9064)

Reporter
Multiple people
Impact
high
##### Description

Add-on updates failed to verify that the add-on ID inside the signed package matched the ID of the add-on being updated. An attacker who could perform a man-in-the-middle attack on the user's connection to the update server and defeat the certificate pinning protection could provide a malicious signed add-on instead of a valid update.

##### References

* [Bug 1303418](https://bugzilla.mozilla.org/show_bug.cgi?id=1303418)

#### [#CVE-2016-9066: Integer overflow leading to a buffer overflow in nsScriptLoadHandler](#CVE-2016-9066)

Reporter
Samuel Groß
Impact
high
##### Description

A buffer overflow resulting in a potentially exploitable crash due to memory allocation issues when handling large amounts of incoming data.

##### References

* [Bug 1299686](https://bugzilla.mozilla.org/show_bug.cgi?id=1299686)

#### [#CVE-2016-5291: Same-origin policy violation using local HTML file and saved shortcut file](#CVE-2016-5291)

Reporter
Yuyang Zhou
Impact
moderate
##### Description

A same-origin policy bypass with local shortcut files to load arbitrary local content from disk.

##### References

* [Bug 1292159](https://bugzilla.mozilla.org/show_bug.cgi?id=1292159)

#### [#CVE-2016-9074: Insufficient timing side-channel resistance in divSpoiler](#CVE-2016-9074)

Reporter
Franziskus Kiefer
Impact
moderate
##### Description

An existing mitigation of timing side-channel attacks is insufficient in some circumstances. This issue is addressed in Network Security Services (NSS) 3.26.1.

##### References

* [Bug 1293334](https://bugzilla.mozilla.org/show_bug.cgi?id=1293334)

#### [#CVE-2016-5290: Memory safety bugs fixed in Firefox 50 and Firefox ESR 45.5](#CVE-2016-5290)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Olli Pettay, Christian Holler, Ehsan Akhgari, Jon Coppeard, Gary Kwong, Tooru Fujisawa, Philipp, and Randell Jesup reported memory safety bugs present in Firefox 49 and Firefox ESR 45.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 50 and Firefox ESR 45.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1309720%2C1297062%2C1303710%2C1018486%2C1292590%2C1301343%2C1301496%2C1308048%2C1308346%2C1299519%2C1286911%2C1298169)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_14686fcf_20250125_123852.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox, Thunderbird: Multiple vulnerabilities — GLSA **201701-15**

Multiple vulnerabilities have been found in Mozilla Firefox and
Thunderbird the worst of which could lead to the execution of arbitrary
code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

### Background

Mozilla Firefox is a cross-platform web browser from Mozilla. The
Mozilla Thunderbird mail client is a redesign of the Mozilla Mail
component. The goal is to produce a cross-platform stand-alone mail
application using XUL (XML User Interface Language).

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox and
Thunderbird. Please review the CVE identifiers referenced below for
details.

### Impact

A remote attacker could possibly execute arbitrary code with the
privileges of the process or cause a Denial of Service condition via
multiple vectors.

### Workaround

There is no known workaround at this time.

### Resolution

All Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-45.6.0"

```

All Firefox-bin users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-45.6.0"

```

All Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-45.6.0"

```

All Thunderbird-bin users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-45.6.0"

```
### References

* [CVE-2016-2804](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2804)
* [CVE-2016-2805](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2805)
* [CVE-2016-2806](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2806)
* [CVE-2016-2807](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2807)
* [CVE-2016-2808](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2808)
* [CVE-2016-2809](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2809)
* [CVE-2016-2810](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2810)
* [CVE-2016-2811](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2811)
* [CVE-2016-2812](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2812)
* [CVE-2016-2813](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2813)
* [CVE-2016-2814](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2814)
* [CVE-2016-2816](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2816)
* [CVE-2016-2817](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2817)
* [CVE-2016-2820](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2820)
* [CVE-2016-2827](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2827)
* [CVE-2016-2830](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2830)
* [CVE-2016-2835](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2835)
* [CVE-2016-2836](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2836)
* [CVE-2016-2837](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2837)
* [CVE-2016-2838](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2838)
* [CVE-2016-2839](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2839)
* [CVE-2016-5250](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5250)
* [CVE-2016-5251](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5251)
* [CVE-2016-5252](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5252)
* [CVE-2016-5253](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5253)
* [CVE-2016-5254](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5254)
* [CVE-2016-5255](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5255)
* [CVE-2016-5256](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5256)
* [CVE-2016-5257](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5257)
* [CVE-2016-5258](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5258)
* [CVE-2016-5259](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5259)
* [CVE-2016-5260](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5260)
* [CVE-2016-5261](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5261)
* [CVE-2016-5262](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5262)
* [CVE-2016-5263](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5263)
* [CVE-2016-5264](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5264)
* [CVE-2016-5265](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5265)
* [CVE-2016-5266](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5266)
* [CVE-2016-5267](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5267)
* [CVE-2016-5268](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5268)
* [CVE-2016-5270](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5270)
* [CVE-2016-5271](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5271)
* [CVE-2016-5272](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5272)
* [CVE-2016-5273](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5273)
* [CVE-2016-5274](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5274)
* [CVE-2016-5275](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5275)
* [CVE-2016-5276](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5276)
* [CVE-2016-5277](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5277)
* [CVE-2016-5278](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5278)
* [CVE-2016-5279](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5279)
* [CVE-2016-5280](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5280)
* [CVE-2016-5281](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5281)
* [CVE-2016-5282](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5282)
* [CVE-2016-5283](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5283)
* [CVE-2016-5284](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5284)
* [CVE-2016-5290](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5290)
* [CVE-2016-5291](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5291)
* [CVE-2016-5293](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5293)
* [CVE-2016-5294](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5294)
* [CVE-2016-5296](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5296)
* [CVE-2016-5297](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5297)
* [CVE-2016-9064](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9064)
* [CVE-2016-9066](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9066)
* [CVE-2016-9074](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9074)
* [CVE-2016-9079](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9079)
* [CVE-2016-9893](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9893)
* [CVE-2016-9895](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9895)
* [CVE-2016-9897](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9897)
* [CVE-2016-9898](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9898)
* [CVE-2016-9899](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9899)
* [CVE-2016-9900](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9900)
* [CVE-2016-9901](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9901)
* [CVE-2016-9902](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9902)
* [CVE-2016-9904](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9904)
* [CVE-2016-9905](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9905)

**Release date**

January 03, 2017

**Latest revision**

January 04, 2017: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [581326](https://bugs.gentoo.org/show_bug.cgi?id=581326)
* [590330](https://bugs.gentoo.org/show_bug.cgi?id=590330)
* [594616](https://bugs.gentoo.org/show_bug.cgi?id=594616)
* [599924](https://bugs.gentoo.org/show_bug.cgi?id=599924)
* [601320](https://bugs.gentoo.org/show_bug.cgi?id=601320)
* [602576](https://bugs.gentoo.org/show_bug.cgi?id=602576)
* [604024](https://bugs.gentoo.org/show_bug.cgi?id=604024)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from wiki.mozilla.org_2cf3059c_20250126_083451.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from wiki.mozilla.org_73f8d6fa_20250126_083449.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


