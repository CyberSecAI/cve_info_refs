=== Content from www.openwall.com_08694d59_20250125_074420.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[<thread-prev]](../../../2016/09/16/13) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <512ACAF7-7491-4805-84E5-7EB9E2727EAF@apache.org>
Date: Fri, 16 Sep 2016 20:57:21 +0100
From: Flavio Junqueira <fpj@...che.org>
To: lyon.yang.s@...il.com
Cc: DevZooKeeper <dev@...keeper.apache.org>,
 security@...keeper.apache.org,
 bugtraq@...urityfocus.com,
 oss-security@...ts.openwall.com,
 security@...che.org
Subject: [SECURITY] CVE-2016-5017: Buffer overflow vulnerability in ZooKeeper C cli shell

Apologies for the duplicate, this report has a correction over the previous version sent earlier.

#######################################################
CVE-2016-5017: Buffer overflow vulnerability in ZooKeeper C cli shell

Severity: moderate

Vendor:
The Apache Software Foundation

Versions Affected:
ZooKeeper 3.4.0 to 3.4.8
ZooKeeper 3.5.0 to 3.5.2
The unsupported ZooKeeper 1.x through 3.3.x versions may be also affected

Note: The 3.5 branch is still alpha at this time.

Description:
The ZooKeeper C client shells "cli_st" and "cli_mt" have a buffer
overflow vulnerability associated with parsing of the input command
when using the "cmd:<cmd>" batch mode syntax. If the command string
exceeds 1024 characters a buffer overflow will occur. There is no
known compromise which takes advantage of this vulnerability, and if
security is enabled the attacker would be limited by client level
security constraints. The C cli shell is intended as a sample/example
of how to use the C client interface, not as a production tool - the
documentation has also been clarified on this point.

Mitigation:
It is important to use the fully featured/supported Java cli shell rather
than the C cli shell independent of version.

- ZooKeeper 3.4.x users should upgrade to 3.4.9 or apply this patch:
<https://git-wip-us.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=27ecf981a15554dc8e64a28630af7a5c9e2bdf4f>

- ZooKeeper 3.5.x users should upgrade to 3.5.3 when released or apply
this patch:
<https://git-wip-us.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a>

The patch solves the problem reported here, but it does not make the
client ready for production use. The community has no plan to make
this client production ready at this time, and strongly recommends that
users move to the Java cli and use the C cli for illustration purposes only.

Credit:
This issue was discovered by Lyon Yang (@l0Op3r)

References:
<https://zookeeper.apache.org/security.html>
#######################################################
```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from issues.apache.org_a7f037f1_20250126_072013.html ===


[Log in](/jira/login.jsp?os_destination=%2Fbrowse%2FZOOKEEPER-2693)[Skip to main content](#main)[Skip to sidebar](#sidebar)Linked ApplicationsLoading…[![ASF JIRA](/jira/s/xd97tr/820010/13pdxe5/_/jira-logo-scaled.png)](https://issues.apache.org/jira/secure/MyJiraHome.jspa)

* [Dashboards](/jira/secure/Dashboard.jspa "View and manage your dashboards")
* [Projects](/jira/browse/ZOOKEEPER "View recent projects and browse a list of projects")
* [Issues](/jira/issues/ "Search for issues and view recent issues")

* [Help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Help")
  + [Jira Core help](https://docs.atlassian.com/jira/jcore-docs-0820/ "Go to the online documentation for Jira Core")
  + [Keyboard Shortcuts](/jira/secure/ViewKeyboardShortcuts%21default.jspa "Get more information about Jira's Keyboard Shortcuts")
  + [About Jira](/jira/secure/AboutPage.jspa "Get more information about Jira")
  + [Jira Credits](/jira/secure/credits/AroundTheWorld%21default.jspa "See who did what")
* [Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FZOOKEEPER-2693)

Public signup for this instance is **disabled**. Go to our [Self serve sign up page](https://selfserve.apache.org/jira-account.html) to request an account. Report potential security issues [privately](https://apache.org/security/#reporting-a-vulnerability)

![Uploaded image for project: 'ZooKeeper'](https://issues.apache.org/jira/secure/projectavatar?pid=12310801&avatarId=10011)

1. [ZooKeeper](/jira/browse/ZOOKEEPER)
2. [ZOOKEEPER-2693](/jira/browse/ZOOKEEPER-2693)

# DOS attack on wchp/wchc four letter words (4lw)

[Log In](/jira/login.jsp?os_destination=%2Fbrowse%2FZOOKEEPER-2693 "Log In")Export

XMLWordPrintableJSON
#### Details

* **Type:**
  ![](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.") Bug
* **Status:**
  Closed
* **Priority:**
  ![](/jira/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run") Blocker
* **Resolution:**
  Fixed
* **Affects Version/s:**
  3.4.0, 3.5.1, 3.5.2
* **Fix Version/s:**
  [3.4.10](/jira/issues/?jql=project+%3D+ZOOKEEPER+AND+fixVersion+%3D+3.4.10 "3.4.10 Fix release against 3.4 branch"), [3.5.3](/jira/issues/?jql=project+%3D+ZOOKEEPER+AND+fixVersion+%3D+3.5.3 "3.5.3 Beta release against 3.5 branch"), [3.6.0](/jira/issues/?jql=project+%3D+ZOOKEEPER+AND+fixVersion+%3D+3.6.0 "3.6.0 ")
* **Component/s:**
  [security](/jira/issues/?jql=project+%3D+ZOOKEEPER+AND+component+%3D+security "security "), [server](/jira/issues/?jql=project+%3D+ZOOKEEPER+AND+component+%3D+server "server General issues with the ZooKeeper server.")
* **Labels:**
  + [pull-request-available](/jira/issues/?jql=labels+%3D+pull-request-available "pull-request-available")
#### Description

The wchp/wchc four letter words can be exploited in a DOS attack on the ZK client port - typically 2181. The following POC attack was recently published on the web:

[https://vulners.com/exploitdb/EDB-ID:41277](https://vulners.com/exploitdb/EDB-ID%3A41277)

The most straightforward way to block this attack is to not allow access to the client port to non-trusted clients - i.e. firewall the ZooKeeper service and only allow access to trusted applications using it for coordination.

#### Attachments

#### Attachments

* Options
  + [Sort By Name](/jira/browse/ZOOKEEPER-2693?attachmentSortBy=fileName#attachmentmodule "viewissue.subtasks.tab.show.all.name")
  + [Sort By Date](/jira/browse/ZOOKEEPER-2693?attachmentSortBy=dateTime#attachmentmodule "Sort By Date")
  + [Ascending](/jira/browse/ZOOKEEPER-2693?attachmentOrder=asc#attachmentmodule "Ascending")
  + [Descending](/jira/browse/ZOOKEEPER-2693?attachmentOrder=desc#attachmentmodule "Descending")

1. [ZOOKEEPER-2693-01.patch](/jira/secure/attachment/12853642/ZOOKEEPER-2693-01.patch "Latest  21/Feb/17 03:23 - Mohammad Arshad")21/Feb/17 03:238 kBMohammad Arshad
#### Issue Links

is related to

![Bug - A problem which impairs or prevents the functions of the product.](/jira/secure/viewavatar?size=xsmall&avatarId=21133&avatarType=issuetype "Bug - A problem which impairs or prevents the functions of the product.")
[ZOOKEEPER-2726](/jira/browse/ZOOKEEPER-2726)
Patch for ZOOKEEPER-2693 introduces potential race condition

* ![Major - Major loss of function.](/jira/images/icons/priorities/major.svg "Major - Major loss of function.")
* Closed

relates to

![Task - A task that needs to be done.](/jira/secure/viewavatar?size=xsmall&avatarId=21148&avatarType=issuetype "Task - A task that needs to be done.")
[ZOOKEEPER-2713](/jira/browse/ZOOKEEPER-2713)
Create CVE text for ZOOKEEPER-2693 "DOS attack on wchp/wchc four letter words (4lw)"

* ![Blocker - Blocks development and/or testing work, production could not run](/jira/images/icons/priorities/blocker.svg "Blocker - Blocks development and/or testing work, production could not run")
* Resolved

links to

![Web Link](/jira/images/icons/generic_link_16.png "Web Link")
[GitHub Pull Request #](https://github.com/apache/zookeeper/commit/a2623a625a4778720f7d5482d0a66e9b37ae556f)

![Web Link](/jira/images/icons/generic_link_16.png "Web Link")
[GitHub Pull Request #179](https://github.com/apache/zookeeper/pull/179)

![Web Link](/jira/images/icons/generic_link_16.png "Web Link")
[GitHub Pull Request #183](https://github.com/apache/zookeeper/pull/183)

![Web Link](https://github.com/favicon.ico "Web Link")
[GitHub Pull Request #1608](https://github.com/apache/zookeeper/pull/1608)

Show 1 more links (1 links to)

#### Activity

#### People

Assignee:

![hanm](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Michael Han

Reporter:

![phunt](https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452)
Patrick D. Hunt

Votes:
0
Vote for this issue

Watchers:
8
Start watching this issue

#### Dates

Created:

14/Feb/17 03:33

Updated:

06/Mar/21 21:36

Resolved:

07/Mar/17 06:26

#### Time Tracking

Estimated:

| Original Estimate - Not Specified |
| --- |

Not Specified

Remaining:

| Remaining Estimate - 0h |
| --- |

0h

Logged:

| Time Spent - 1h 10m |
| --- |

1h 10m

* Atlassian Jira [Project Management Software](https://www.atlassian.com/software/jira)
* [About Jira](/jira/secure/AboutPage.jspa/secure/AboutPage.jspa)
* [Report a problem](/jira/secure/CreateIssue%21default.jspa)

Powered by a free Atlassian [Jira](http://www.atlassian.com/software/jira) open source license for Apache Software Foundation. Try Jira - [bug tracking software](http://www.atlassian.com/software/jira) for *your* team.

[Atlassian](http://www.atlassian.com/)



=== Content from lists.apache.org_ee3dc6b2_20250125_074425.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from packetstormsecurity.com_6db69125_20250125_074420.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from lists.apache.org_bfe14222_20250125_074425.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from git-wip-us.apache.org_d844f057_20250125_074424.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fzookeeper%2Fcommit%2Ff09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fzookeeper%2Fcommit%2Ff09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=apache%2Fzookeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[zookeeper](/apache/zookeeper)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fzookeeper) You must be signed in to change notification settings
* [Fork
  7.3k](/login?return_to=%2Fapache%2Fzookeeper)
* [Star
   12.3k](/login?return_to=%2Fapache%2Fzookeeper)

* [Code](/apache/zookeeper)
* [Pull requests
  214](/apache/zookeeper/pulls)
* [Actions](/apache/zookeeper/actions)
* [Security](/apache/zookeeper/security)
* [Insights](/apache/zookeeper/pulse)

Additional navigation options

* [Code](/apache/zookeeper)
* [Pull requests](/apache/zookeeper/pulls)
* [Actions](/apache/zookeeper/actions)
* [Security](/apache/zookeeper/security)
* [Insights](/apache/zookeeper/pulse)

## Commit

[Permalink](/apache/zookeeper/commit/f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix command handling in the C client shell (phunt via fpj)

[Browse files](/apache/zookeeper/tree/f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a)
Browse the repository at this point in the history

```
git-svn-id: [https://svn.apache.org/repos/asf/zookeeper/branches/branch-3.5@1755855](https://svn.apache.org/repos/asf/zookeeper/branches/branch-3.5%401755855) 13f79535-47bb-0310-9956-ffa450edef68
```

* Loading branch information

[![@fpj](https://avatars.githubusercontent.com/u/572920?s=40&v=4)](/fpj)

[fpj](/apache/zookeeper/commits?author=fpj "View all commits by fpj")
committed
Aug 10, 2016

1 parent
[59bd3ba](/apache/zookeeper/commit/59bd3ba59813992429802e7033f16ceb56f1d0c5)

commit f09154d

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**25 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGES.txt
  [CHANGES.txt](#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776)
* src/c

  + src/c/README
    [README](#diff-0395cb53ad6be93a3f2538ed674f6cace223d6a62fd1de290381d1c7ce654ec5)
  + src

    - src/c/src/cli.c
      [cli.c](#diff-76aafdd92057c42765a1a93da6da7b11654bde033642c91fc63e8db8043dd93e)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[CHANGES.txt](#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776 "CHANGES.txt")

Show comments

[View file](/apache/zookeeper/blob/f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a/CHANGES.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -20,6 +20,8 @@ BUGFIXES: |
|  |  | ZOOKEEPER-2074: Incorrect exit codes for "./zkCli.sh cmd arg" |
|  |  | (Abraham Fine via phunt) |
|  |  |  |
|  |  | Fix command handling in the C client shell (phunt via fpj) |
|  |  |  |
|  |  | IMPROVEMENTS: |
|  |  |  |
|  |  |  |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[src/c/README](#diff-0395cb53ad6be93a3f2538ed674f6cace223d6a62fd1de290381d1c7ce654ec5 "src/c/README")

Show comments

[View file](/apache/zookeeper/blob/f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a/src/c/README)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -72,7 +72,12 @@ tar downloaded from Apache please skip to step 2. |
|  |  | other document formats please use "./configure --help" |
|  |  |  |
|  |  |  |
|  |  | USING THE CLIENT |
|  |  | EXAMPLE/SAMPLE C CLIENT SHELL |
|  |  |  |
|  |  | NOTE: the ZooKeeper C client shell (cli\_st and cli\_mt) is meant as a |
|  |  | example/sample of ZooKeeper C client API usage. It is not a full |
|  |  | fledged client and not meant for production usage - see the Java |
|  |  | client shell for a fully featured shell. |
|  |  |  |
|  |  | You can test your client by running a zookeeper server (see |
|  |  | instructions on the project wiki page on how to run it) and connecting |
| Expand Down | |  |

18 changes: 17 additions & 1 deletion

18
[src/c/src/cli.c](#diff-76aafdd92057c42765a1a93da6da7b11654bde033642c91fc63e8db8043dd93e "src/c/src/cli.c")

Show comments

[View file](/apache/zookeeper/blob/f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a/src/c/src/cli.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,14 @@ |
|  |  | \* limitations under the License. |
|  |  | \*/ |
|  |  |  |
|  |  | /\*\* |
|  |  | \* cli.c is a example/sample C client shell for ZooKeeper. It contains |
|  |  | \* basic shell functionality which exercises some of the features of |
|  |  | \* the ZooKeeper C client API. It is not a full fledged client and is |
|  |  | \* not meant for production usage - see the Java client shell for a |
|  |  | \* fully featured shell. |
|  |  | \*/ |
|  |  |  |
|  |  | #include <zookeeper.h> |
|  |  | #include <proto.h> |
|  |  | #include <stdlib.h> |
| Expand Down  Expand Up | | @@ -679,7 +687,15 @@ int main(int argc, char \*\*argv) { |
|  |  | } |
|  |  | if (argc > 2) { |
|  |  | if(strncmp("cmd:",argv[2],4)==0){ |
|  |  | strcpy(cmd,argv[2]+4); |
|  |  | size\_t cmdlen = strlen(argv[2]); |
|  |  | if (cmdlen > sizeof(cmd)) { |
|  |  | fprintf(stderr, |
|  |  | "Command length %zu exceeds max length of %zu\n", |
|  |  | cmdlen, |
|  |  | sizeof(cmd)); |
|  |  | return 2; |
|  |  | } |
|  |  | strncpy(cmd, argv[2]+4, sizeof(cmd)); |
|  |  | batchMode=1; |
|  |  | fprintf(stderr,"Batch mode: %s\n",cmd); |
|  |  | }else{ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `f09154d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fzookeeper%2Fcommit%2Ff09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from git-wip-us.apache.org_826e3a51_20250125_074422.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fzookeeper%2Fcommit%2F27ecf981a15554dc8e64a28630af7a5c9e2bdf4f)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fzookeeper%2Fcommit%2F27ecf981a15554dc8e64a28630af7a5c9e2bdf4f)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=apache%2Fzookeeper)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[apache](/apache)
/
**[zookeeper](/apache/zookeeper)**
Public

* [Notifications](/login?return_to=%2Fapache%2Fzookeeper) You must be signed in to change notification settings
* [Fork
  7.3k](/login?return_to=%2Fapache%2Fzookeeper)
* [Star
   12.3k](/login?return_to=%2Fapache%2Fzookeeper)

* [Code](/apache/zookeeper)
* [Pull requests
  214](/apache/zookeeper/pulls)
* [Actions](/apache/zookeeper/actions)
* [Security](/apache/zookeeper/security)
* [Insights](/apache/zookeeper/pulse)

Additional navigation options

* [Code](/apache/zookeeper)
* [Pull requests](/apache/zookeeper/pulls)
* [Actions](/apache/zookeeper/actions)
* [Security](/apache/zookeeper/security)
* [Insights](/apache/zookeeper/pulse)

## Commit

[Permalink](/apache/zookeeper/commit/27ecf981a15554dc8e64a28630af7a5c9e2bdf4f)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix command handling in the C client shell (phunt via fpj)

[Browse files](/apache/zookeeper/tree/27ecf981a15554dc8e64a28630af7a5c9e2bdf4f)
Browse the repository at this point in the history

```
git-svn-id: [https://svn.apache.org/repos/asf/zookeeper/branches/branch-3.4@1755750](https://svn.apache.org/repos/asf/zookeeper/branches/branch-3.4%401755750) 13f79535-47bb-0310-9956-ffa450edef68
```

* Loading branch information

[![@fpj](https://avatars.githubusercontent.com/u/572920?s=40&v=4)](/fpj)

[fpj](/apache/zookeeper/commits?author=fpj "View all commits by fpj")
committed
Aug 10, 2016

1 parent
[b70b160](/apache/zookeeper/commit/b70b16016a379d2543c6e48a185f6b8603ab82a5)

commit 27ecf98

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**25 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* CHANGES.txt
  [CHANGES.txt](#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776)
* src/c

  + src/c/README
    [README](#diff-0395cb53ad6be93a3f2538ed674f6cace223d6a62fd1de290381d1c7ce654ec5)
  + src

    - src/c/src/cli.c
      [cli.c](#diff-76aafdd92057c42765a1a93da6da7b11654bde033642c91fc63e8db8043dd93e)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[CHANGES.txt](#diff-59130575b4fb2932c957db2922977d7d89afb0b2085357db1a14615a2fcad776 "CHANGES.txt")

Show comments

[View file](/apache/zookeeper/blob/27ecf981a15554dc8e64a28630af7a5c9e2bdf4f/CHANGES.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -45,6 +45,8 @@ BUGFIXES: |
|  |  | ZOOKEEPER-2498: Potential resource leak in C client when processing |
|  |  | unexpected / out of order response (Michael Han via rgs) |
|  |  |  |
|  |  | Fix command handling in the C client shell (phunt via fpj) |
|  |  |  |
|  |  | IMPROVEMENTS: |
|  |  |  |
|  |  | ZOOKEEPER-2240 Make the three-node minimum more explicit in |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[src/c/README](#diff-0395cb53ad6be93a3f2538ed674f6cace223d6a62fd1de290381d1c7ce654ec5 "src/c/README")

Show comments

[View file](/apache/zookeeper/blob/27ecf981a15554dc8e64a28630af7a5c9e2bdf4f/src/c/README)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -72,7 +72,12 @@ tar downloaded from Apache please skip to step 2. |
|  |  | other document formats please use "./configure --help" |
|  |  |  |
|  |  |  |
|  |  | USING THE CLIENT |
|  |  | EXAMPLE/SAMPLE C CLIENT SHELL |
|  |  |  |
|  |  | NOTE: the ZooKeeper C client shell (cli\_st and cli\_mt) is meant as a |
|  |  | example/sample of ZooKeeper C client API usage. It is not a full |
|  |  | fledged client and not meant for production usage - see the Java |
|  |  | client shell for a fully featured shell. |
|  |  |  |
|  |  | You can test your client by running a zookeeper server (see |
|  |  | instructions on the project wiki page on how to run it) and connecting |
| Expand Down | |  |

18 changes: 17 additions & 1 deletion

18
[src/c/src/cli.c](#diff-76aafdd92057c42765a1a93da6da7b11654bde033642c91fc63e8db8043dd93e "src/c/src/cli.c")

Show comments

[View file](/apache/zookeeper/blob/27ecf981a15554dc8e64a28630af7a5c9e2bdf4f/src/c/src/cli.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,6 +16,14 @@ |
|  |  | \* limitations under the License. |
|  |  | \*/ |
|  |  |  |
|  |  | /\*\* |
|  |  | \* cli.c is a example/sample C client shell for ZooKeeper. It contains |
|  |  | \* basic shell functionality which exercises some of the features of |
|  |  | \* the ZooKeeper C client API. It is not a full fledged client and is |
|  |  | \* not meant for production usage - see the Java client shell for a |
|  |  | \* fully featured shell. |
|  |  | \*/ |
|  |  |  |
|  |  | #include <zookeeper.h> |
|  |  | #include <proto.h> |
|  |  | #include <stdlib.h> |
| Expand Down  Expand Up | | @@ -540,7 +548,15 @@ int main(int argc, char \*\*argv) { |
|  |  | } |
|  |  | if (argc > 2) { |
|  |  | if(strncmp("cmd:",argv[2],4)==0){ |
|  |  | strcpy(cmd,argv[2]+4); |
|  |  | size\_t cmdlen = strlen(argv[2]); |
|  |  | if (cmdlen > sizeof(cmd)) { |
|  |  | fprintf(stderr, |
|  |  | "Command length %zu exceeds max length of %zu\n", |
|  |  | cmdlen, |
|  |  | sizeof(cmd)); |
|  |  | return 2; |
|  |  | } |
|  |  | strncpy(cmd, argv[2]+4, sizeof(cmd)); |
|  |  | batchMode=1; |
|  |  | fprintf(stderr,"Batch mode: %s\n",cmd); |
|  |  | }else{ |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `27ecf98`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fapache%2Fzookeeper%2Fcommit%2F27ecf981a15554dc8e64a28630af7a5c9e2bdf4f) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from lists.apache.org_104ed6d2_20250125_074425.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from zookeeper.apache.org_2aa9ad37_20250125_074428.html ===

[![](images/zookeeper_small.gif)Apache ZooKeeper™](index.html)

* Project
  [News](releases.html#news)
  [Releases](releases.html)
  [Wiki](https://cwiki.apache.org/confluence/display/ZOOKEEPER/Index)
  [Credits](credits.html)
  [Bylaws](bylaws.html)
  [License](https://www.apache.org/licenses/)
  [Privacy Policy](privacy.html)
  [Security](security.html)
  [Thanks](https://www.apache.org/foundation/thanks.html)
* Documentation
  [Release 3.9.3](doc/r3.9.3/index.html)
  [Release 3.8.4](doc/r3.8.4/index.html)
  [Release 3.7.2](doc/r3.7.2/index.html)
  [Older Versions](documentation.html)
* Developers
  [Mailing Lists](lists.html)
  [IRC Channel](irc.html)
  [Version Control](git.html)
  [Issue Tracker](https://issues.apache.org/jira/browse/ZOOKEEPER)
  [Events](events.html)
* ASF
  [Apache Software Foundation](https://www.apache.org/foundation/ "Apache Software Foundation")
  [How Apache Works](https://www.apache.org/foundation/how-it-works.html "How Apache Works")
  [Sponsoring Apache](https://www.apache.org/foundation/sponsorship.html "Sponsoring Apache")

# ZooKeeper Security

The Apache Software Foundation takes security issues very seriously. Due to the infrastructure nature of the Apache ZooKeeper project specifically, we haven't had many reports over time, but it doesn't mean that we haven't had concerns over some bugs and vulnerabilities. If you have any concern or believe you have uncovered a vulnerability, we suggest that you get in touch via the e-mail address security@zookeeper.apache.org. In the message, try to provide a description of the issue and ideally a way of reproducing it. Note that this security address should be used only for undisclosed vulnerabilities. Dealing with known issues should be handled regularly via jira and the mailing lists. **Please report any security problems to the project security address before disclosing it publicly.**

The ASF Security team maintains a page with a description of how vulnerabilities are handled, check their [Web page](https://www.apache.org/security/) for more information.

## Vulnerability reports

* [CVE-2024-51504: Authentication bypass with IP-based authentication in Admin Server](#CVE-2024-51504)
* [CVE-2024-23944: Information disclosure in persistent watcher handling](#CVE-2024-23944)
* [CVE-2023-44981: Authorization bypass in SASL Quorum Peer Authentication](#CVE-2023-44981)
* [CVE-2019-0201: Information disclosure vulnerability in Apache ZooKeeper](#CVE-2019-0201)
* [CVE-2018-8012: Apache ZooKeeper Quorum Peer mutual authentication](#CVE-2018-8012)
* [CVE-2017-5637: DOS attack on wchp/wchc four letter words (4lw)](#CVE-2017-5637)
* [CVE-2016-5017: Buffer overflow vulnerability in ZooKeeper C cli shell](#CVE-2016-5017)

### CVE-2024-51504: Authentication bypass with IP-based authentication in Admin Server

Severity: important

Affected versions:

* Apache ZooKeeper 3.9.0 before 3.9.3

Description:

When using IPAuthenticationProvider in ZooKeeper Admin Server there is a possibility of Authentication Bypass by Spoofing -- this only impacts IP based authentication implemented in ZooKeeper Admin Server. Default configuration of client's IP address detection in IPAuthenticationProvider, which uses HTTP request headers, is weak and allows an attacker to bypass authentication via spoofing client's IP address in request headers. Default configuration honors X- Forwarded-For HTTP header to read client's IP address. X-Forwarded-For request header is mainly used by proxy servers to identify the client and can be easily spoofed by an attacker pretending that the request comes from a different IP address. Admin Server commands, such as snapshot and restore arbitrarily can be executed on successful exploitation which could potentially lead to information leakage or service availability issues. Users are recommended to upgrade to version 3.9.3, which fixes this issue.

Credit:

4ra1n (reporter) Y4tacker (reporter)

References:

<https://zookeeper.apache.org/> <https://www.cve.org/CVERecord?id=CVE-2024-51504>

### CVE-2024-23944: Information disclosure in persistent watcher handling

Severity: critical

Affected versions:

* Apache ZooKeeper 3.9.0 through 3.9.1
* Apache ZooKeeper 3.8.0 through 3.8.3
* Apache ZooKeeper 3.6.0 through 3.7.2

Description:

Information disclosure in persistent watchers handling in Apache ZooKeeper due to missing ACL check. It allows an attacker to monitor child znodes by attaching a persistent watcher (addWatch command) to a parent which the attacker has already access to. ZooKeeper server doesn't do ACL check when the persistent watcher is triggered and as a consequence, the full path of znodes that a watch event gets triggered upon is exposed to the owner of the watcher. It's important to note that only the path is exposed by this vulnerability, not the data of znode, but since znode path can contain sensitive information like user name or login ID, this issue is potentially critical.

Users are recommended to upgrade to version 3.9.2, 3.8.4 which fixes the issue.

Credit:

å¨åå®(å¯æ³) zhoujian.zja@alibaba-inc.com (reporter)

References:

<https://zookeeper.apache.org/> <https://www.cve.org/CVERecord?id=CVE-2024-23944>

### CVE-2023-44981: Authorization bypass in SASL Quorum Peer Authentication

Severity: critical

Affected versions:

* Apache ZooKeeper 3.9.0
* Apache ZooKeeper 3.8.0 through 3.8.2
* Apache ZooKeeper 3.7.0 through 3.7.1
* Apache ZooKeeper before 3.7.0

Description:

Authorization Bypass Through User-Controlled Key vulnerability in Apache ZooKeeper. If SASL Quorum Peer authentication is enabled in ZooKeeper (quorum.auth.enableSasl=true), the authorization is done by verifying that the instance part in SASL authentication ID is listed in zoo.cfg server list. The instance part in SASL auth ID is optional and if it's missing, like 'eve@EXAMPLE.COM', the authorization check will be skipped. As a result an arbitrary endpoint could join the cluster and begin propagating counterfeit changes to the leader, essentially giving it complete read-write access to the data tree. Quorum Peer authentication is not enabled by default.

Users are recommended to upgrade to version 3.9.1, 3.8.3, 3.7.2, which fixes the issue.

Alternately ensure the ensemble election/quorum communication is protected by a firewall as this will mitigate the issue.

See the documentation for more details on correct cluster administration.

Credit:

Damien Diederen ddiederen@apache.org (reporter)

References:

<https://zookeeper.apache.org/>

<https://www.cve.org/CVERecord?id=CVE-2023-44981>

### CVE-2019-0201: Information disclosure vulnerability in Apache ZooKeeper

Severity: Critical

Vendor: The Apache Software Foundation

Versions Affected: ZooKeeper prior to 3.4.14 ZooKeeper 3.5.0-alpha through 3.5.4-beta. The unsupported ZooKeeper 1.x through 3.3.x versions may be also affected.

Description: ZooKeeperâs getACL() command doesnât check any permission when retrieves the ACLs of the requested node and returns all information contained in the ACL Id field as plaintext string. DigestAuthenticationProvider overloads the Id field with the hash value that is used for user authentication. As a consequence, if Digest Authentication is in use, the unsalted hash value will be disclosed by getACL() request for unauthenticated or unprivileged users.

Mitigation: Use an authentication method other than Digest (e.g. Kerberos) or upgrade to 3.4.14 or later (3.5.5 or later if on the 3.5 branch).

Credit: This issue was identified by Harrison Neal harrison@patchadvisor.com PatchAdvisor, Inc.

References: https://issues.apache.org/jira/browse/ZOOKEEPER-1392

### CVE-2018-8012: Apache ZooKeeper Quorum Peer mutual authentication

Severity: Critical

Vendor: The Apache Software Foundation

Versions Affected: ZooKeeper prior to 3.4.10 ZooKeeper 3.5.0-alpha through 3.5.3-beta The unsupported ZooKeeper 1.x through 3.3.x versions may be also affected

Description: No authentication/authorization is enforced when a server attempts to join a quorum. As a result an arbitrary end point could join the cluster and begin propagating counterfeit changes to the leader.

Mitigation: Upgrade to 3.4.10 or later (3.5.4-beta or later if on the 3.5 branch) and enable Quorum Peer mutual authentication.

Alternately ensure the ensemble election/quorum communication is protected by a firewall as this will mitigate the issue.

See the documentation for more details on correct cluster administration.

Credit: This issue was identified by FÃ¶ldi TamÃ¡s and Eugene Koontz

References: https://issues.apache.org/jira/browse/ZOOKEEPER-1045 https://cwiki.apache.org/confluence/display/ZOOKEEPER/Server-Server+mutual+authentication https://zookeeper.apache.org/doc/current/zookeeperAdmin.html

### CVE-2017-5637: DOS attack on wchp/wchc four letter words (4lw) {#CVE-2017-5637}

Severity: moderate

Vendor: The Apache Software Foundation

Versions Affected: ZooKeeper 3.4.0 to 3.4.9 ZooKeeper 3.5.0 to 3.5.2 The unsupported ZooKeeper 1.x through 3.3.x versions may be also affected

Note: The 3.5 branch is still beta at this time.

Description: Two four letter word commands âwchp/wchcâ are CPU intensive and could cause spike of CPU utilization on ZooKeeper server if abused, which leads to the server unable to serve legitimate client requests. There is no known compromise which takes advantage of this vulnerability.

Mitigation: This affects ZooKeeper ensembles whose client port is publicly accessible, so it is recommended to protect ZooKeeper ensemble with firewall. Documentation has also been updated to clarify on this point. In addition, a patch (ZOOKEEPER-2693) is provided to disable "wchp/wchcâ commands by default. - ZooKeeper 3.4.x users should upgrade to 3.4.10 or apply the patch. - ZooKeeper 3.5.x users should upgrade to 3.5.3 or apply the patch.

References [1] https://issues.apache.org/jira/browse/ZOOKEEPER-2693

### CVE-2016-5017: Buffer overflow vulnerability in ZooKeeper C cli shell {#CVE-2016-5017}

Severity: moderate

Vendor: The Apache Software Foundation

Versions Affected: ZooKeeper 3.4.0 to 3.4.8 ZooKeeper 3.5.0 to 3.5.2 The unsupported ZooKeeper 1.x through 3.3.x versions may be also affected

Note: The 3.5 branch is still alpha at this time.

Description: The ZooKeeper C client shells "cli\_st" and "cli\_mt" have a buffer overflow vulnerability associated with parsing of the input command when using the "cmd:" batch mode syntax. If the command string exceeds 1024 characters a buffer overflow will occur. There is no known compromise which takes advantage of this vulnerability, and if security is enabled the attacker would be limited by client level security constraints. The C cli shell is intended as a sample/example of how to use the C client interface, not as a production tool - the documentation has also been clarified on this point.

Mitigation: It is important to use the fully featured/supported Java cli shell rather than the C cli shell independent of version.

* ZooKeeper 3.4.x users should upgrade to 3.4.9 or apply this [patch](https://gitbox.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=27ecf981a15554dc8e64a28630af7a5c9e2bdf4f)
* ZooKeeper 3.5.x users should upgrade to 3.5.3 when released or apply this [patch](https://gitbox.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a)

The patch solves the problem reported here, but it does not make the client ready for production use. The community has no plan to make this client production ready at this time, and strongly recommends that users move to the Java cli and use the C cli for illustration purposes only.

Credit: This issue was discovered by Lyon Yang (@l0Op3r)

References: [Apache ZooKeeper Security Page](https://zookeeper.apache.org/security.html)

Copyright © 2010-2020
[The Apache Software Foundation](https://www.apache.org/), Licensed under the [Apache License, Version 2.0](https://www.apache.org/licenses/LICENSE-2.0).

Apache ZooKeeper, ZooKeeper, Apache, the Apache feather logo, and the Apache ZooKeeper project logo are trademarks of The Apache Software Foundation.

[![](images/asf-logo-with-feather.png)](https://apache.org)



=== Content from lists.apache.org_586fbc5e_20250125_074426.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.


