```
{
  "cve": "CVE-2016-5017",
  "description": "The ZooKeeper C client shells \"cli_st\" and \"cli_mt\" have a buffer overflow vulnerability associated with parsing of the input command when using the \"cmd:<cmd>\" batch mode syntax. If the command string exceeds 1024 characters a buffer overflow will occur. There is no known compromise which takes advantage of this vulnerability, and if security is enabled the attacker would be limited by client level security constraints. The C cli shell is intended as a sample/example of how to use the C client interface, not as a production tool.",
  "vulnerability_details": {
    "root_cause": "A buffer overflow vulnerability exists in the ZooKeeper C client shells when parsing commands in batch mode.",
    "weaknesses": [
      "Buffer Overflow"
    ],
    "impact": "A buffer overflow occurs if the command string exceeds 1024 characters. The impact is not well defined but could lead to a crash or potentially arbitrary code execution if an attacker can control the overflowed data. However, the C client shell is not intended for production use.",
    "attack_vector": "By providing a command string longer than 1024 characters via the `cmd:<cmd>` syntax to the C client shells `cli_st` or `cli_mt`",
    "attacker_capabilities": "An attacker must be able to provide input to the C client shell."
  },
  "affected_versions": [
    "ZooKeeper 3.4.0 to 3.4.8",
    "ZooKeeper 3.5.0 to 3.5.2",
        "The unsupported ZooKeeper 1.x through 3.3.x versions may be also affected"
  ],
  "patch_information": [
     "ZooKeeper 3.4.x users should upgrade to 3.4.9 or apply this patch: https://git-wip-us.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=27ecf981a15554dc8e64a28630af7a5c9e2bdf4f",
     "ZooKeeper 3.5.x users should upgrade to 3.5.3 when released or apply this patch: https://git-wip-us.apache.org/repos/asf?p=zookeeper.git;a=commitdiff;h=f09154d6648eeb4ec5e1ac8a2bacbd2f8c87c14a"
  ],
  "recommendations": "It is important to use the fully featured/supported Java cli shell rather than the C cli shell. The C cli shell is intended as a sample/example of how to use the C client interface, not as a production tool."
}
```