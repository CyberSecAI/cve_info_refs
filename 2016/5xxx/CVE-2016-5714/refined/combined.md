=== Content from bugs.gentoo.org_ef0cde84_20250124_221323.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Bug 597684
<app-admin/puppet-agent-1.7.1: Puppet Execution Protocol (PXP) Command Whitelist Validation Vulnerability
Last modified: 2017-10-13 23:33:23 UTC node [vulture]

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=597684&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=597684&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 597684**](show_bug.cgi?id=597684)
(CVE-2016-5714)
- <app-admin/puppet-agent-1.7.1: Puppet Execution Protocol (PXP) Command Whitelist Validation Vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
<app-admin/puppet-agent-1.7.1: Puppet Execution Protocol (PXP) Command Whitel...

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-5714 | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | Gentoo Security | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=Gentoo Security "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | Vulnerabilities ([show other bugs](buglist.cgi?component=Vulnerabilities&product=Gentoo%20Security&bug_status=__open__)) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All Linux | |  | | | [Importance](page.cgi?id=fields.html#importance): | Normal normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Gentoo Security | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") | [https://puppet.com/security/cve/pxp-a...](https://puppet.com/security/cve/pxp-agent-oct-2016) | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | B2 [glsa cve] | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-10-21 12:01 UTC by Matthew Thode ( prometheanfire ) | | --- | --- | | Modified: | 2017-10-13 23:33 UTC ([History](show_activity.cgi?id=597684)) | | CC List: | 1 user (show)  prometheanfire | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Package list:](page.cgi?id=fields.html#cf_stabilisation_atoms "Contains a list of packages (and optionally, architectures) to keyword or stabilize. One fully qualified package per line, optionally followed by a space-delimited list of architectures for that package.") |  | | [Runtime testing required:](page.cgi?id=fields.html#cf_runtime_testing_required "Indicate what level of testing is required. For manual testing following instructions in the bug, choose \"Manual\". For only compile-testing, choose \"No\". For where tests must pass, choose \"Yes\".") | --- | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=597684&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=597684&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](#c0)  Matthew Thode ( prometheanfire )   archtester Gentoo Infrastructure gentoo-dev Security  2016-10-21 12:01:37 UTC  ``` Note: Considered alone this vulnerability is High Risk, but in combination with the PCP Broker vulnerability this becomes Critical.  Puppet Agent 1.3.6 added a whitelist to prevent arbitrary options from being passed to Puppet runs triggered through the Puppet Communications Protocol (PCP). There was an issue with command validation that allowed this whitelist to be bypassed. This can potentially lead to arbitrary code execution on Puppet Agent nodes in Puppet Enterprise prior to 2016.4.0.  Default configurations of FOSS Puppet Agent are not vulnerable. Status:  Affected Software Versions:      Puppet Enterprise 2015.3.3     Puppet Enterprise 2016.x prior to 2016.4.0     Puppet Agent 1.3.6 - 1.7.0  Resolved in:      Puppet Enterprise 2016.4.0     Puppet Agent 1.7.1   As said above, the FOSS Puppet Agent is not vulnerable, so this doesn't effect us.  Reproducible: Always ```  [Comment 1](#c1)  Kristian Fiskerstrand (RETIRED)   gentoo-dev  2016-10-21 12:05:05 UTC  ``` (In reply to Matthew Thode ( prometheanfire ) from [comment #0](show_bug.cgi?id=597684#c0)) > Note: Considered alone this vulnerability is High Risk, but in combination > with the PCP Broker vulnerability this becomes Critical. >  > Puppet Agent 1.3.6 added a whitelist to prevent arbitrary options from being > passed to Puppet runs triggered through the Puppet Communications Protocol > (PCP). There was an issue with command validation that allowed this > whitelist to be bypassed. This can potentially lead to arbitrary code > execution on Puppet Agent nodes in Puppet Enterprise prior to 2016.4.0. >  > Default configurations of FOSS Puppet Agent are not vulnerable.  Are there more details available? In particular; Is there a possibility of the FOSS version being affected by changing a configuration parameter? ```  [Comment 2](#c2)  Matthew Thode ( prometheanfire )   archtester Gentoo Infrastructure gentoo-dev Security  2016-10-21 12:19:33 UTC  ``` I'd like to do fast stable here (and can do so myself since it's just x86 and amd64 arches).  I assume I have to go-ahead? ```  [Comment 3](#c3)  Matthew Thode ( prometheanfire )   archtester Gentoo Infrastructure gentoo-dev Security  2016-10-21 12:21:27 UTC  ``` hmm, this wasn't in the original link  Puppet Agent 1.7.1 also contains updated versions of OpenSSL and Curl to address vulnerabilities recently announced by those projects.  <https://groups.google.com/forum/#!msg/puppet-announce/Hbr8gv2hlIo/szhXUEdzBgAJ>  another cve is also fixed in 1.7.1 from that message, but the cve link given says it was resolved in 1.7.0, nice...  <https://puppet.com/security/cve/cve-2016-5714> ```  [Comment 4](#c4)  Kristian Fiskerstrand (RETIRED)   gentoo-dev  2016-10-21 12:24:16 UTC  ``` (In reply to Matthew Thode ( prometheanfire ) from [comment #3](show_bug.cgi?id=597684#c3)) > hmm, this wasn't in the original link >  > Puppet Agent 1.7.1 also contains updated versions of OpenSSL and Curl to > address vulnerabilities recently announced by those projects.  Are we affected by this, i.e we don't remove embedded stuff and use the system libs? >  > <https://groups.google.com/forum/#!msg/puppet-announce/Hbr8gv2hlIo/> > szhXUEdzBgAJ >  > another cve is also fixed in 1.7.1 from that message, but the cve link given > says it was resolved in 1.7.0, nice... >  > <https://puppet.com/security/cve/cve-2016-5714>   This is separate CVE that should go in different bug ```  [Comment 5](#c5)  Matthew Thode ( prometheanfire )   archtester Gentoo Infrastructure gentoo-dev Security  2016-10-21 15:18:30 UTC  ``` 1.7.1 marked stable, cleaned up as well ```  [Comment 6](#c6)  Matthew Thode ( prometheanfire )   archtester Gentoo Infrastructure gentoo-dev Security  2016-10-21 15:19:15 UTC  ``` Yes, we are affected by that as well.  This is a binary package-set. ```  [Comment 7](#c7)  Christopher Díaz Riveros (RETIRED)   gentoo-dev Security  2017-10-05 17:07:47 UTC  ``` puppet-agent is currently on 1.10.6, is this report still valid?  Gentoo Security Padawan ChrisADR ```  [Comment 8](#c8)  GLSAMaker/CVETool Bot   gentoo-dev  2017-10-13 23:33:23 UTC  ``` This issue was resolved and addressed in  GLSA 201710-12 at <https://security.gentoo.org/glsa/201710-12> by GLSA coordinator Aaron Bauman (b-man). ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=597684)
* - [XML](show_bug.cgi?ctype=xml&id=597684)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=597684)
* - [Clone In The Same
  Product](enter_bug.cgi?cloned_bug_id=597684&product=Gentoo%20Security)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=597684&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=597684&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from security.gentoo.org_3d084300_20250124_221326.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Puppet Agent: Multiple vulnerabilities — GLSA **201710-12**

Multiple vulnerabilities have been found in Puppet Agent, the worst
of which could result in the execution of arbitrary code.

### Affected packages

| Package | **app-admin/puppet-agent** on all architectures |
| --- | --- |
| Affected versions | < **1.7.1** |
| Unaffected versions | >= **1.7.1** |

### Background

Puppet Agent contains Puppet’s main code and all of the dependencies
needed to run it, including Facter, Hiera, and bundled versions of Ruby
and OpenSSL.

### Description

Multiple vulnerabilities have been discovered in Puppet Agent. Please
review the references for details.

### Impact

A remote attacker could possibly execute arbitrary code with the
privileges of the process or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Puppet Agent users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-admin/puppet-agent-1.7.1"

```
### References

* [CVE-2016-5714](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5714)
* [Puppet
  Security Advise Oct 2016](https://puppet.com/security/cve/pxp-agent-oct-2016)

**Release date**

October 13, 2017

**Latest revision**

October 13, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [597684](https://bugs.gentoo.org/show_bug.cgi?id=597684)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**


