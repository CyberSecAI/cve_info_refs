=== Content from bugs.launchpad.net_cc62f20d_20250126_124719.html ===

[Log in / Register](https://bugs.launchpad.net/neutron/%2Bbug/1502933/%2Blogin)

[![](https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png)](https://launchpad.net/neutron)

## [neutron](https://launchpad.net/neutron)

* [Overview](https://launchpad.net/neutron)
* [Code](https://code.launchpad.net/neutron)
* [Bugs](https://bugs.launchpad.net/neutron)
* [Blueprints](https://blueprints.launchpad.net/neutron)
* [Translations](https://translations.launchpad.net/neutron)
* [Answers](https://answers.launchpad.net/neutron)

# [OSSA-2016-009] ICMPv6 anti-spoofing rules are too permissive (CVE-2015-8914)

Bug #1502933 reported by
[xens](https://launchpad.net/~r-aviolat)
on 2015-10-05

[270](/%2Bhelp-bugs/bug-heat.html)

This bug affects 3 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | Unassigned |  |
|  | [neutron](https://bugs.launchpad.net/neutron) | Fix Released | High | [Dustin Lundquist](https://launchpad.net/~dlundquist) |  |

### Bug Description

ICMPv6 default firewall rules are too permissive on the hypervisors leaving VMs able to do ICMPv6 source address spoofing.

Pre-condition:

- having a provider-network providing IPv6 connectivity to the VMs

- in my case the controllers are providing statefull DHCPv6 and my physical router provides the default gateway using Router Advertisements.

How to reproduce:

- spin a VM and attach to it an IPv6 enabled network

- obtain an IPv6 address using #dhclient -6

- try to ping6 an IPv6 enabled host

- remove your IPv6 address from the interface: #sudo ip addr del 2001:0DB8::100/32 dev eth0

- add a forged IPv6 address to your interface, into the same subnet of the original IPv6 address: #sudo ip addr add 2001:0DB8::200/32 dev eth0

- try to ping6 the previous IPv6 enabled host, it will still work

- try to assign another IPv6 address to your NIC, completely outside your IPv6 assignment: sudo ip addr add 2001:dead:beef::1/64 dev eth0

- try to ping6 the previous IPv6 enabled host -> the destination will still receive your echo requests with your forget address but you won't receive answers, they won't be router back to you.

Expected behavior:

- VMs should not be able to spoof their IPv6 address and issue forged ICMPv6 packets. The firewall rules on the hypervisor should restrict ICMPv6 egress to the VMs link-local and global-unicast addresses.

Affected versions:

- I saw the issue into OpenStack Juno, under Ubuntu 14.04. But according to the upstream code, the issue is still present into the master branch, into; neutron/agent/linux/iptables\_firewall.py, into line 385:

ipv6\_rules += [comment\_rule('-p icmpv6 -j RETURN', comment=ic.IPV6\_ICMP\_ALLOW)]

Tags:

[sg-fw](/neutron/%2Bbugs?field.tag=sg-fw)
[in-stable-liberty](/neutron/%2Bbugs?field.tag=in-stable-liberty)
[in-stable-mitaka](/neutron/%2Bbugs?field.tag=in-stable-mitaka)

## CVE References

* [2015-8914](/bugs/cve/2015-8914 "The IPTables firewall in OpenStack Ne...")
* [2016-5362](/bugs/cve/2016-5362 "The IPTables firewall in OpenStack Ne...")
* [2016-5363](/bugs/cve/2016-5363 "The IPTables firewall in OpenStack Ne...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2015-10-05: |  |  | [#1](/neutron/%2Bbug/1502933/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Salvatore Orlando (salvatore-orlando)](https://launchpad.net/~salvatore-orlando) wrote on 2015-10-05: |  |  | [#2](/neutron/%2Bbug/1502933/comments/2) |
| --- | --- | --- | --- |

In this reports 2 different levels of address forging are discussed:

1 - forging with another address from the same subnet

2 - forging with an address outside the assigned subnet

In case #2 even if potentially there is a bug to investigate, there is not a security vulnerability imho.

For Case #1 I need to verify the behaviour independently (or get someone to do that), since it is a minor security vulnerability on shared networks as one tenant might impersonate another tenant's VM. Please note that this would happen if the operator did not assign each tenant a distinct security group, which is quite unlikely.

I'm inclined to say that this should not be granted an OSSA, but this is pending further verification on the behaviour reported.

In this reports 2 different levels of address forging are discussed:
1 - forging with another address from the same subnet
2 - forging with an address outside the assigned subnet
In case #2 even if potentially there is a bug to investigate, there is not a security vulnerability imho.
For Case #1 I need to verify the behaviour independently (or get someone to do that), since it is a minor security vulnerability on shared networks as one tenant might impersonate another tenant's VM. Please note that this would happen if the operator did not assign each tenant a distinct security group, which is quite unlikely.
I'm inclined to say that this should not be granted an OSSA, but this is pending further verification on the behaviour reported.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [xens (r-aviolat)](https://launchpad.net/~r-aviolat) wrote on 2015-10-05: |  |  | [#3](/neutron/%2Bbug/1502933/comments/3) |
| --- | --- | --- | --- |

Salvatore,

In our setup we have a public, shared provider-network where all tenants can obtain public-IP resources, both v4 and v6 subnets are setup on top of that network. For IPv6, users on multiple tenants share the same subnet (/64).

Case #1; each tenant have their own security groups in my setup but they are on the same shared v6 subnet; yes they can impersonate another tenant's VM.

Case #2; a malicious user could also impersonate or perturb any others tenant's VMs it's ihmo more critical than Case #1 from a usability point-of-view.

Salvatore,
In our setup we have a public, shared provider-network where all tenants can obtain public-IP resources, both v4 and v6 subnets are setup on top of that network. For IPv6, users on multiple tenants share the same subnet (/64).
Case #1; each tenant have their own security groups in my setup but they are on the same shared v6 subnet; yes they can impersonate another tenant's VM.
Case #2; a malicious user could also impersonate or perturb any others tenant's VMs it's ihmo more critical than Case #1 from a usability point-of-view.

[Ihar Hrachyshka (ihar-hrachyshka)](https://launchpad.net/~ihar-hrachyshka)
on 2015-10-07

| **tags**: | added: juno-backport-potential kilo-backport-potential liberty-rc-potential sg-fw |
| --- | --- |
| Changed in neutron: | |
| **importance**: | Undecided → High |
| **milestone**: | none → mitaka-1 |
| **status**: | New → Confirmed |

[Akihiro Motoki (amotoki)](https://launchpad.net/~amotoki)
on 2015-10-21

| **tags**: | added: liberty-backport-potentialremoved: liberty-rc-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-11-09: |  |  | [#4](/neutron/%2Bbug/1502933/comments/4) |
| --- | --- | --- | --- |

Unless someone complains about it, let's make this bug report public by the end of the week.

Unless someone complains about it, let's make this bug report public by the end of the week.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Travis McPeak (travis-mcpeak)](https://launchpad.net/~travis-mcpeak) wrote on 2015-11-09: |  |  | [#5](/neutron/%2Bbug/1502933/comments/5) |
| --- | --- | --- | --- |

I'm having trouble wrapping my head around this one. Can somebody knowledgable about this please help me understand:

1) The potential impact in above mentioned scenarios?

2) What would a fix look like? Specifically which component(s) should be updated and how?

I'm having trouble wrapping my head around this one. Can somebody knowledgable about this please help me understand:
1) The potential impact in above mentioned scenarios?
2) What would a fix look like? Specifically which component(s) should be updated and how?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Robert Clark (robert-clark)](https://launchpad.net/~robert-clark) wrote on 2015-11-10: |  |  | [#6](/neutron/%2Bbug/1502933/comments/6) |
| --- | --- | --- | --- |

repudiation probably, ICMPv6 can be used in some DDoS scenarios, a cloud provider that cannot identify where ICMP is originating from within it's network (wether the DOS is outbound or targeted at something else internal) will probably have a bad time.

I don't think it's super critical though and can probably be fixed in the open

repudiation probably, ICMPv6 can be used in some DDoS scenarios, a cloud provider that cannot identify where ICMP is originating from within it's network (wether the DOS is outbound or targeted at something else internal) will probably have a bad time.
I don't think it's super critical though and can probably be fixed in the open

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Travis McPeak (travis-mcpeak)](https://launchpad.net/~travis-mcpeak) wrote on 2015-11-10: |  |  | [#7](/neutron/%2Bbug/1502933/comments/7) |
| --- | --- | --- | --- |

Are there issues aside from the one which Rob mentioned?

If not we I agree, let's fix this in the open.

Are there issues aside from the one which Rob mentioned?
If not we I agree, let's fix this in the open.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Salvatore Orlando (salvatore-orlando)](https://launchpad.net/~salvatore-orlando) wrote on 2015-11-16: |  |  | [#8](/neutron/%2Bbug/1502933/comments/8) |
| --- | --- | --- | --- |

We have a related bug report filed here: [https://bugs.launchpad.net/ossa/+bug/1515444](https://bugs.launchpad.net/ossa/%2Bbug/1515444)

Tristan mentioned it could a duplicated, and indeed it might be.

If the underlying root cause is that we fail to apply the baseline DENY ALL security rule in the v6 case, then the extent of this issue might go well beyond DOS, and therefore should be granted an OSSA.

I think in the other bug report Brian Haley mentioned that he will do some tests to repro the issue and therefore I'd wait for his results before making a call on this bug.

We have a related bug report filed here: https://bugs.launchpad.net/ossa/+bug/1515444
Tristan mentioned it could a duplicated, and indeed it might be.
If the underlying root cause is that we fail to apply the baseline DENY ALL security rule in the v6 case, then the extent of this issue might go well beyond DOS, and therefore should be granted an OSSA.
I think in the other bug report Brian Haley mentioned that he will do some tests to repro the issue and therefore I'd wait for his results before making a call on this bug.

[Alan Pevec (apevec)](https://launchpad.net/~apevec)
on 2015-11-24

| **tags**: | removed: juno-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-11-30: |  |  | [#9](/neutron/%2Bbug/1502933/comments/9) |
| --- | --- | --- | --- |

Salvatore, turns out the related issue have been invalidated. At least DVR doesn't seems to be the culprit here.

Is someone still trying to reproduce this ?

Salvatore, turns out the related issue have been invalidated. At least DVR doesn't seems to be the culprit here.
Is someone still trying to reproduce this ?

[Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio)
on 2015-12-03

| Changed in neutron: | |
| --- | --- |
| **milestone**: | mitaka-1 → mitaka-2 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2015-12-07: |  |  | [#10](/neutron/%2Bbug/1502933/comments/10) |
| --- | --- | --- | --- |

If it's ok with reporter and neutron-coresec team, we'd like to open this bug report for public review by the end of the week.

If it's ok with reporter and neutron-coresec team, we'd like to open this bug report for public review by the end of the week.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [xens (r-aviolat)](https://launchpad.net/~r-aviolat) wrote on 2015-12-09: |  |  | [#11](/neutron/%2Bbug/1502933/comments/11) |
| --- | --- | --- | --- |

It's ok for me

It's ok for me

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2015-12-15

| **description**: | updated |
| --- | --- |
| **information type**: | Private Security → Public Security |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Salvatore Orlando (salvatore-orlando)](https://launchpad.net/~salvatore-orlando) wrote on 2016-01-11: |  |  | [#12](/neutron/%2Bbug/1502933/comments/12) |
| --- | --- | --- | --- |

Tristan, as far as I am aware there is no activity going on this bug atm.

IMHO this can be opened up just as it was done for [bug 1515444](/bugs/1515444)

Tristan, as far as I am aware there is no activity going on this bug atm.
IMHO this can be opened up just as it was done for bug 1515444

[Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio)
on 2016-01-20

| Changed in neutron: | |
| --- | --- |
| **milestone**: | mitaka-2 → mitaka-3 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-01-25: |  |  | [#13](/neutron/%2Bbug/1502933/comments/13) |
| --- | --- | --- | --- |

Is this happening with vlan/vxlan ? I wonder if it's not related to [bug 1534652](/bugs/1534652)...

Is this happening with vlan/vxlan ? I wonder if it's not related to bug 1534652...

[Mohammed Ashraf (mohammed-asharaf)](https://launchpad.net/~mohammed-asharaf)
on 2016-02-15

| Changed in neutron: | |
| --- | --- |
| **assignee**: | nobody → Mohammed Ashraf (mohammed-asharaf) |

[Mohammed Ashraf (mohammed-asharaf)](https://launchpad.net/~mohammed-asharaf)
on 2016-02-17

| Changed in neutron: | |
| --- | --- |
| **assignee**: | Mohammed Ashraf (mohammed-asharaf) → nobody |

[Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio)
on 2016-03-03

| Changed in neutron: | |
| --- | --- |
| **milestone**: | mitaka-3 → mitaka-rc1 |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio) wrote on 2016-03-11: |  |  | [#14](/neutron/%2Bbug/1502933/comments/14) |
| --- | --- | --- | --- |

failed to triage

failed to triage

| Changed in neutron: | |
| --- | --- |
| **status**: | Confirmed → Incomplete |
| **milestone**: | mitaka-rc1 → none |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-31:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1502933/comments/15) |  |  | [#15](/neutron/%2Bbug/1502933/comments/15) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/300233>

Fix proposed to branch: master
Review: https://review.openstack.org/300233

| Changed in neutron: | |
| --- | --- |
| **assignee**: | nobody → Dustin Lundquist (dlundquist) |
| **status**: | Incomplete → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-05:  [**Re: ICMPv6 anti-spoofing rules are too permissive**](/neutron/%2Bbug/1502933/comments/16) |  |  | [#16](/neutron/%2Bbug/1502933/comments/16) |
| --- | --- | --- | --- |

[bug 1558658](/bugs/1558658) points this bug as being the IPv6 case of the same flaw, but only ICMPv6 is discussed here.

Are DHCP discovery message also not protected in IPv6 ?

So would it makes sense to issue a single advisory for both bugs or are they different beast ?

bug 1558658 points this bug as being the IPv6 case of the same flaw, but only ICMPv6 is discussed here.
Are DHCP discovery message also not protected in IPv6 ?
So would it makes sense to issue a single advisory for both bugs or are they different beast ?

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Confirmed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-05: |  |  | [#17](/neutron/%2Bbug/1502933/comments/17) |
| --- | --- | --- | --- |

@Tristan, the antispoofing rules (prior to 299021 which just merged) has permitted a number of types of spoofing attacks:

1. Source MAC spoofing -- this could allow an attacker to cause physical and virtual switches to learn an incorrect destination of MAC addresses allowing an attacker to intercept traffic destine to another instance on the local Neutron network. In the case of a shared multi-tenant network this allowed cross tenant traffic inception.

2. Source IP spoofing in IPv4 DHCP requests -- I'm not aware of an attack which would permit accessing another instances traffic, but could be used to mask the source of a DoS attack.

3. Source IP spoofing of IPv6 DHCP requests -- same as #2.

4. Source IP spoofing of ICMPv6 traffic -- this could allow an attacker to participate in neighbor discovery on the behalf of any other host on the local network, allowing it to receive traffic destine to another instance on the local Neutron network. Same multi tenant concerns as #1.

@Tristan, the antispoofing rules (prior to 299021 which just merged) has permitted a number of types of spoofing attacks:
1. Source MAC spoofing -- this could allow an attacker to cause physical and virtual switches to learn an incorrect destination of MAC addresses allowing an attacker to intercept traffic destine to another instance on the local Neutron network. In the case of a shared multi-tenant network this allowed cross tenant traffic inception.
2. Source IP spoofing in IPv4 DHCP requests -- I'm not aware of an attack which would permit accessing another instances traffic, but could be used to mask the source of a DoS attack.
3. Source IP spoofing of IPv6 DHCP requests -- same as #2.
4. Source IP spoofing of ICMPv6 traffic -- this could allow an attacker to participate in neighbor discovery on the behalf of any other host on the local network, allowing it to receive traffic destine to another instance on the local Neutron network. Same multi tenant concerns as #1.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [xens (r-aviolat)](https://launchpad.net/~r-aviolat) wrote on 2016-04-05: |  |  | [#18](/neutron/%2Bbug/1502933/comments/18) |
| --- | --- | --- | --- |

Tristan,

this bug was a bit different originally as it was concerning only the ICMPv6 traffic, but it looks like that Dustin also enforced the DHCP traffic on the same occasion so it make sense for me to make a single advisory.

Tristan,
this bug was a bit different originally as it was concerning only the ICMPv6 traffic, but it looks like that Dustin also enforced the DHCP traffic on the same occasion so it make sense for me to make a single advisory.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-05: |  |  | [#19](/neutron/%2Bbug/1502933/comments/19) |
| --- | --- | --- | --- |

I don' think an additional advisory is necessary. , but the ICMPv6 Neighbor Discovery aspect of this bug is the IPv6 case of [bug 1274034](/bugs/1274034) rather than [bug 1558658](/bugs/1558658).

I don' think an additional advisory is necessary. , but the ICMPv6 Neighbor Discovery aspect of this bug is the IPv6 case of bug 1274034 rather than bug 1558658.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-05:  [**Related fix proposed to ossa (master)**](/neutron/%2Bbug/1502933/comments/20) |  |  | [#20](/neutron/%2Bbug/1502933/comments/20) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/301977>

Related fix proposed to branch: master
Review: https://review.openstack.org/301977

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-06:  [**Re: ICMPv6 anti-spoofing rules are too permissive**](/neutron/%2Bbug/1502933/comments/21) |  |  | [#21](/neutron/%2Bbug/1502933/comments/21) |
| --- | --- | --- | --- |

Just to be clear, the ICMPv6 source address spoof isn't addressed by [bug 1558658](/bugs/1558658) patch (I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78).

Since both issues abuse the same fundamental flaw, it seems like a good opportunity to bundle both fix in a single advisory.

However, because we need different patch, this will likely requires 2 different CVE numbers...

Does it makes sense ?

Just to be clear, the ICMPv6 source address spoof isn't addressed by bug 1558658 patch (I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78).
Since both issues abuse the same fundamental flaw, it seems like a good opportunity to bundle both fix in a single advisory.
However, because we need different patch, this will likely requires 2 different CVE numbers...
Does it makes sense ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [xens (r-aviolat)](https://launchpad.net/~r-aviolat) wrote on 2016-04-06: |  |  | [#22](/neutron/%2Bbug/1502933/comments/22) |
| --- | --- | --- | --- |

yes it does

yes it does

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Simon Leinen (simon-leinen)](https://launchpad.net/~simon-leinen) wrote on 2016-04-14: |  |  | [#23](/neutron/%2Bbug/1502933/comments/23) |
| --- | --- | --- | --- |

I would love to see this backported to Liberty and Kilo. Other than the security issues, it creates a dataplane/usability issue for guest OSes that use RFC 4941 privacy addresses by default, such as Windows.

The bug has the following effect: Normally, IPv6 privacy addresses should not work, because they cannot be known to Nova/Neutron, and thus they should be caught by the anti-spoofing filters.

But because of the bug, the anti-spoofing filters let all ICMPv6 through. So for example, on an instance running standard Windows 2012 Server, "ping6 ipv6.google.com" will work, but one cannot surf to <http://ipv6.google.com>. The built-in Windows network check will misdiagnose this as "server is online but refuses to respond to HTTP connections".

Of course it is true that OSes that use privacy addresses by default aren't suitable for out-of-the-box use under OpenStack with IPv6—privacy addresses must be disabled to get usable IPv6 connectivity. But legacy images exist, and because of the special ICMP behavior, it is hard to find the cause of the problem.

I would love to see this backported to Liberty and Kilo. Other than the security issues, it creates a dataplane/usability issue for guest OSes that use RFC 4941 privacy addresses by default, such as Windows.
The bug has the following effect: Normally, IPv6 privacy addresses should not work, because they cannot be known to Nova/Neutron, and thus they should be caught by the anti-spoofing filters.
But because of the bug, the anti-spoofing filters let all ICMPv6 through. So for example, on an instance running standard Windows 2012 Server, "ping6 ipv6.google.com" will work, but one cannot surf to http://ipv6.google.com. The built-in Windows network check will misdiagnose this as "server is online but refuses to respond to HTTP connections".
Of course it is true that OSes that use privacy addresses by default aren't suitable for out-of-the-box use under OpenStack with IPv6—privacy addresses must be disabled to get usable IPv6 connectivity. But legacy images exist, and because of the special ICMP behavior, it is hard to find the cause of the problem.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-14: |  |  | [#24](/neutron/%2Bbug/1502933/comments/24) |
| --- | --- | --- | --- |

@Simon

The IPv6 networking guide calls out RFC 4941 privacy extensions as being not supported. With only ICMP being permitted from privacy addresses is it really a regression because Microsoft tries to provide an automated network diagnostic? I don't think it is worth while permitted source IP spoofing to improve the automated error text provided my Microsoft's products.

@Simon
The IPv6 networking guide calls out RFC 4941 privacy extensions as being not supported. With only ICMP being permitted from privacy addresses is it really a regression because Microsoft tries to provide an automated network diagnostic? I don't think it is worth while permitted source IP spoofing to improve the automated error text provided my Microsoft's products.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Simon Leinen (simon-leinen)](https://launchpad.net/~simon-leinen) wrote on 2016-04-14: |  |  | [#25](/neutron/%2Bbug/1502933/comments/25) |
| --- | --- | --- | --- |

@dlundquist

Sorry for being unclear. I don't ask for spoofing to be permitted. I want anti-spoofing to work for all protocols including ICMP. Then Microsoft's network diagnostics won't be confused anymore. (And also things will be a bit more secure.)

@dlundquist
Sorry for being unclear. I don't ask for spoofing to be permitted. I want anti-spoofing to work for all protocols including ICMP. Then Microsoft's network diagnostics won't be confused anymore. (And also things will be a bit more secure.)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-14: |  |  | [#26](/neutron/%2Bbug/1502933/comments/26) |
| --- | --- | --- | --- |

@Simon, that is what the patch does: it permits very limited use of the unspecified address as source to enable DAD, then enforces anti-spoofing rules and then permits ICMP once anti-spoofing chain has been applied. What, if any, documentation do you think is required to alert users changed behavior of IPv6 privacy address (previously permitting only ICMP, and now blocking all traffic from privacy addresses)?

Existing documentation indicating privacy addresses are not supported: <http://docs.openstack.org/liberty/networking-guide/adv_config_ipv6.html> (under Security Considerations). I meant to include this link in my previous post.

@Simon, that is what the patch does: it permits very limited use of the unspecified address as source to enable DAD, then enforces anti-spoofing rules and then permits ICMP once anti-spoofing chain has been applied. What, if any, documentation do you think is required to alert users changed behavior of IPv6 privacy address (previously permitting only ICMP, and now blocking all traffic from privacy addresses)?
Existing documentation indicating privacy addresses are not supported: http://docs.openstack.org/liberty/networking-guide/adv\_config\_ipv6.html (under Security Considerations). I meant to include this link in my previous post.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-27:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1502933/comments/27) |  |  | [#27](/neutron/%2Bbug/1502933/comments/27) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/neutron/%2Bbug/1502933/comments/27/%2Bdownload) (3.7 KiB)

Reviewed: <https://review.openstack.org/300233>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=a8a9d225d8496c044db7057552394afd6c950a8e>

Submitter: Jenkins

Branch: master

commit a8a9d225d8496c044db7057552394afd6c950a8e

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 15:19:04 2016 -0700

IPtables firewall prevent ICMPv6 spoofing

IPv6 includes the concept of link-local addresses. There are address

    within the fe80::/64 prefix which are used only within the local layer 2

    network. They should never be routed. DHCPv6 is one of several protocols

    which utilize link-local addresses.

Previously the blanket permit DHCPv6 rule permitted DHCPv6 requests from

    a link-local source, before the source address was validated.

The structure of the IPtables egress firewall is:

a. fixed rules for special traffic

      b. validate source address

      c. fixed rules necessary for host to function

      d. user rules defined by security groups

This change restricts the special traffic permitted in part (a) to only

    that traffic which utilizes the "unspecified address" (::), by moving

    the fixed permit ICMPv6 and DHCPv6 rules to part (c), so they are

    applied after the source address has been validated. In order to enable

    DHCPv6 and other protocols utilizing link-local addresses, the

    link-local address corresponding to each MAC address are included in the

    permitted source addresses. After the source address is verified, the

    fixed rules permit ICMPv6 and DHCPv6, then the user defined security

    group rules are applied.

In the existing implementation ICMPv6 and DHCPv6 rules in the fixed

    ip6tables firewall rules are too permissive: they permit ICMPv6 and

    DHCPv6 traffic, regardless of source MAC or IPv6 address. These rules

    where intended to allow a host to acquire an IPv6 address, but

    inadvertently allowed a malicious or compromised host to spoof another's

    MAC or IPv6 address.

A host acquiring an IPv6 address should preform DAD (duplicate address

    detection). To preform this the host must join the multicast group

    corresponding to the tentative IPv6 address and the all nodes multicast

    group. To join these groups the host sends ICMP MLD (multicast listener

    discovery) report messages before it has an IPv6 address assigned, so

    the unspecified address is used as the source address. To complete DAD,

    ICMP neighbor solicitation messages are sent to solicit if any nodes

    using that address. This should be the only use of the unspecified IPv6

    address as a source address. The IPv4 case is similar the unspecified

    address is used for DHCP discovery and request messages.

To summarize, this patch permits only ICMPv6 traffic from the unspecified

    address which is used for duplicate address detection. Then it enforces

    the source IPv6 and MAC addresses and finally, allows only ICMPv6 traffic

    which has passed this source address validation.

In addition this patch permits traffic from all link-local addresses

    associated with each MAC address assigned t...

[Read more...](/neutron/%2Bbug/1502933/comments/27)

Reviewed: https://review.openstack.org/300233
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=a8a9d225d8496c044db7057552394afd6c950a8e
Submitter: Jenkins
Branch: master
commit a8a9d225d8496c044db7057552394afd6c950a8e
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 15:19:04 2016 -0700
IPtables firewall prevent ICMPv6 spoofing
IPv6 includes the concept of link-local addresses. There are address
within the fe80::/64 prefix which are used only within the local layer 2
network. They should never be routed. DHCPv6 is one of several protocols
which utilize link-local addresses.
Previously the blanket permit DHCPv6 rule permitted DHCPv6 requests from
a link-local source, before the source address was validated.
The structure of the IPtables egress firewall is:
a. fixed rules for special traffic
b. validate source address
c. fixed rules necessary for host to function
d. user rules defined by security groups
This change restricts the special traffic permitted in part (a) to only
that traffic which utilizes the "unspecified address" (::), by moving
the fixed permit ICMPv6 and DHCPv6 rules to part (c), so they are
applied after the source address has been validated. In order to enable
DHCPv6 and other protocols utilizing link-local addresses, the
link-local address corresponding to each MAC address are included in the
permitted source addresses. After the source address is verified, the
fixed rules permit ICMPv6 and DHCPv6, then the user defined security
group rules are applied.
In the existing implementation ICMPv6 and DHCPv6 rules in the fixed
ip6tables firewall rules are too permissive: they permit ICMPv6 and
DHCPv6 traffic, regardless of source MAC or IPv6 address. These rules
where intended to allow a host to acquire an IPv6 address, but
inadvertently allowed a malicious or compromised host to spoof another's
MAC or IPv6 address.
A host acquiring an IPv6 address should preform DAD (duplicate address
detection). To preform this the host must join the multicast group
corresponding to the tentative IPv6 address and the all nodes multicast
group. To join these groups the host sends ICMP MLD (multicast listener
discovery) report messages before it has an IPv6 address assigned, so
the unspecified address is used as the source address. To complete DAD,
ICMP neighbor solicitation messages are sent to solicit if any nodes
using that address. This should be the only use of the unspecified IPv6
address as a source address. The IPv4 case is similar the unspecified
address is used for DHCP discovery and request messages.
To summarize, this patch permits only ICMPv6 traffic from the unspecified
address which is used for duplicate address detection. Then it enforces
the source IPv6 and MAC addresses and finally, allows only ICMPv6 traffic
which has passed this source address validation.
In addition this patch permits traffic from all link-local addresses
associated with each MAC address assigned to the port. This is required
by many IPv6 protocols, such as DHCPv6, which depend on the link-local
addresses. This traffic was previously allowed by the blanket allow
ICMPv6 and allow DHCPv6 rules before the source address was validated.
Finally, it includes a functional test for IPv6 spoofing using both
ICMPv6 and DHCPv6 traffic. OVSFirewall currently permits this spoofed
DHCPv6 traffic. I'm excluding the OVSFirewall implementation from test
so it can be fixed in a follow on patch.
Change-Id: Ice1c9dd349864da28806c5053e38ef86f43b7771
Partial-Bug: 1502933

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-28:  [**Fix proposed to neutron (stable/mitaka)**](/neutron/%2Bbug/1502933/comments/28) |  |  | [#28](/neutron/%2Bbug/1502933/comments/28) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/310648>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/310648

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-28:  [**Fix proposed to neutron (stable/liberty)**](/neutron/%2Bbug/1502933/comments/29) |  |  | [#29](/neutron/%2Bbug/1502933/comments/29) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/310652>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/310652

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-13:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1502933/comments/30) |  |  | [#30](/neutron/%2Bbug/1502933/comments/30) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/315828>

Fix proposed to branch: master
Review: https://review.openstack.org/315828

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-14:  [**Fix merged to neutron (stable/liberty)**](/neutron/%2Bbug/1502933/comments/31) |  |  | [#31](/neutron/%2Bbug/1502933/comments/31) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/neutron/%2Bbug/1502933/comments/31/%2Bdownload) (3.8 KiB)

Reviewed: <https://review.openstack.org/310652>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=1d1159bb2b57f0b4193f8666f53736f05bf7eac9>

Submitter: Jenkins

Branch: stable/liberty

commit 1d1159bb2b57f0b4193f8666f53736f05bf7eac9

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 15:19:04 2016 -0700

IPtables firewall prevent ICMPv6 spoofing

IPv6 includes the concept of link-local addresses. There are address

    within the fe80::/64 prefix which are used only within the local layer 2

    network. They should never be routed. DHCPv6 is one of several protocols

    which utilize link-local addresses.

Previously the blanket permit DHCPv6 rule permitted DHCPv6 requests from

    a link-local source, before the source address was validated.

The structure of the IPtables egress firewall is:

a. fixed rules for special traffic

      b. validate source address

      c. fixed rules necessary for host to function

      d. user rules defined by security groups

This change restricts the special traffic permitted in part (a) to only

    that traffic which utilizes the "unspecified address" (::), by moving

    the fixed permit ICMPv6 and DHCPv6 rules to part (c), so they are

    applied after the source address has been validated. In order to enable

    DHCPv6 and other protocols utilizing link-local addresses, the

    link-local address corresponding to each MAC address are included in the

    permitted source addresses. After the source address is verified, the

    fixed rules permit ICMPv6 and DHCPv6, then the user defined security

    group rules are applied.

In the existing implementation ICMPv6 and DHCPv6 rules in the fixed

    ip6tables firewall rules are too permissive: they permit ICMPv6 and

    DHCPv6 traffic, regardless of source MAC or IPv6 address. These rules

    where intended to allow a host to acquire an IPv6 address, but

    inadvertently allowed a malicious or compromised host to spoof another's

    MAC or IPv6 address.

A host acquiring an IPv6 address should preform DAD (duplicate address

    detection). To preform this the host must join the multicast group

    corresponding to the tentative IPv6 address and the all nodes multicast

    group. To join these groups the host sends ICMP MLD (multicast listener

    discovery) report messages before it has an IPv6 address assigned, so

    the unspecified address is used as the source address. To complete DAD,

    ICMP neighbor solicitation messages are sent to solicit if any nodes

    using that address. This should be the only use of the unspecified IPv6

    address as a source address. The IPv4 case is similar the unspecified

    address is used for DHCP discovery and request messages.

To summarize, this patch permits only ICMPv6 traffic from the unspecified

    address which is used for duplicate address detection. Then it enforces

    the source IPv6 and MAC addresses and finally, allows only ICMPv6 traffic

    which has passed this source address validation.

In addition this patch permits traffic from all link-local addresses

    associated with each MAC address as...

[Read more...](/neutron/%2Bbug/1502933/comments/31)

Reviewed: https://review.openstack.org/310652
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=1d1159bb2b57f0b4193f8666f53736f05bf7eac9
Submitter: Jenkins
Branch: stable/liberty
commit 1d1159bb2b57f0b4193f8666f53736f05bf7eac9
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 15:19:04 2016 -0700
IPtables firewall prevent ICMPv6 spoofing
IPv6 includes the concept of link-local addresses. There are address
within the fe80::/64 prefix which are used only within the local layer 2
network. They should never be routed. DHCPv6 is one of several protocols
which utilize link-local addresses.
Previously the blanket permit DHCPv6 rule permitted DHCPv6 requests from
a link-local source, before the source address was validated.
The structure of the IPtables egress firewall is:
a. fixed rules for special traffic
b. validate source address
c. fixed rules necessary for host to function
d. user rules defined by security groups
This change restricts the special traffic permitted in part (a) to only
that traffic which utilizes the "unspecified address" (::), by moving
the fixed permit ICMPv6 and DHCPv6 rules to part (c), so they are
applied after the source address has been validated. In order to enable
DHCPv6 and other protocols utilizing link-local addresses, the
link-local address corresponding to each MAC address are included in the
permitted source addresses. After the source address is verified, the
fixed rules permit ICMPv6 and DHCPv6, then the user defined security
group rules are applied.
In the existing implementation ICMPv6 and DHCPv6 rules in the fixed
ip6tables firewall rules are too permissive: they permit ICMPv6 and
DHCPv6 traffic, regardless of source MAC or IPv6 address. These rules
where intended to allow a host to acquire an IPv6 address, but
inadvertently allowed a malicious or compromised host to spoof another's
MAC or IPv6 address.
A host acquiring an IPv6 address should preform DAD (duplicate address
detection). To preform this the host must join the multicast group
corresponding to the tentative IPv6 address and the all nodes multicast
group. To join these groups the host sends ICMP MLD (multicast listener
discovery) report messages before it has an IPv6 address assigned, so
the unspecified address is used as the source address. To complete DAD,
ICMP neighbor solicitation messages are sent to solicit if any nodes
using that address. This should be the only use of the unspecified IPv6
address as a source address. The IPv4 case is similar the unspecified
address is used for DHCP discovery and request messages.
To summarize, this patch permits only ICMPv6 traffic from the unspecified
address which is used for duplicate address detection. Then it enforces
the source IPv6 and MAC addresses and finally, allows only ICMPv6 traffic
which has passed this source address validation.
In addition this patch permits traffic from all link-local addresses
associated with each MAC address assigned to the port. This is required
by many IPv6 protocols, such as DHCPv6, which depend on the link-local
addresses. This traffic was previously allowed by the blanket allow
ICMPv6 and allow DHCPv6 rules before the source address was validated.
Conflicts:
neutron/agent/linux/iptables\_firewall.py
neutron/tests/functional/agent/test\_firewall.py
neutron/tests/unit/agent/linux/test\_iptables\_firewall.py
Removed functional test not present in Liberty. Since Liberty doesn't
contain the OVSFirewall this resolve bug 1502933 for Liberty.
Change-Id: Ice1c9dd349864da28806c5053e38ef86f43b7771
Closes-Bug: 1502933
(cherry picked from commit a8a9d225d8496c044db7057552394afd6c950a8e)

| **tags**: | added: in-stable-liberty |
| --- | --- |
| **tags**: | added: in-stable-mitaka |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-14:  [**Fix merged to neutron (stable/mitaka)**](/neutron/%2Bbug/1502933/comments/32) |  |  | [#32](/neutron/%2Bbug/1502933/comments/32) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/neutron/%2Bbug/1502933/comments/32/%2Bdownload) (3.9 KiB)

Reviewed: <https://review.openstack.org/310648>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=3e66b1a87544d7a127abceec13bfeacb8f18f7e1>

Submitter: Jenkins

Branch: stable/mitaka

commit 3e66b1a87544d7a127abceec13bfeacb8f18f7e1

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 15:19:04 2016 -0700

IPtables firewall prevent ICMPv6 spoofing

IPv6 includes the concept of link-local addresses. There are address

    within the fe80::/64 prefix which are used only within the local layer 2

    network. They should never be routed. DHCPv6 is one of several protocols

    which utilize link-local addresses.

Previously the blanket permit DHCPv6 rule permitted DHCPv6 requests from

    a link-local source, before the source address was validated.

The structure of the IPtables egress firewall is:

a. fixed rules for special traffic

      b. validate source address

      c. fixed rules necessary for host to function

      d. user rules defined by security groups

This change restricts the special traffic permitted in part (a) to only

    that traffic which utilizes the "unspecified address" (::), by moving

    the fixed permit ICMPv6 and DHCPv6 rules to part (c), so they are

    applied after the source address has been validated. In order to enable

    DHCPv6 and other protocols utilizing link-local addresses, the

    link-local address corresponding to each MAC address are included in the

    permitted source addresses. After the source address is verified, the

    fixed rules permit ICMPv6 and DHCPv6, then the user defined security

    group rules are applied.

In the existing implementation ICMPv6 and DHCPv6 rules in the fixed

    ip6tables firewall rules are too permissive: they permit ICMPv6 and

    DHCPv6 traffic, regardless of source MAC or IPv6 address. These rules

    where intended to allow a host to acquire an IPv6 address, but

    inadvertently allowed a malicious or compromised host to spoof another's

    MAC or IPv6 address.

A host acquiring an IPv6 address should preform DAD (duplicate address

    detection). To preform this the host must join the multicast group

    corresponding to the tentative IPv6 address and the all nodes multicast

    group. To join these groups the host sends ICMP MLD (multicast listener

    discovery) report messages before it has an IPv6 address assigned, so

    the unspecified address is used as the source address. To complete DAD,

    ICMP neighbor solicitation messages are sent to solicit if any nodes

    using that address. This should be the only use of the unspecified IPv6

    address as a source address. The IPv4 case is similar the unspecified

    address is used for DHCP discovery and request messages.

To summarize, this patch permits only ICMPv6 traffic from the unspecified

    address which is used for duplicate address detection. Then it enforces

    the source IPv6 and MAC addresses and finally, allows only ICMPv6 traffic

    which has passed this source address validation.

In addition this patch permits traffic from all link-local addresses

    associated with each MAC address ass...

[Read more...](/neutron/%2Bbug/1502933/comments/32)

Reviewed: https://review.openstack.org/310648
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=3e66b1a87544d7a127abceec13bfeacb8f18f7e1
Submitter: Jenkins
Branch: stable/mitaka
commit 3e66b1a87544d7a127abceec13bfeacb8f18f7e1
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 15:19:04 2016 -0700
IPtables firewall prevent ICMPv6 spoofing
IPv6 includes the concept of link-local addresses. There are address
within the fe80::/64 prefix which are used only within the local layer 2
network. They should never be routed. DHCPv6 is one of several protocols
which utilize link-local addresses.
Previously the blanket permit DHCPv6 rule permitted DHCPv6 requests from
a link-local source, before the source address was validated.
The structure of the IPtables egress firewall is:
a. fixed rules for special traffic
b. validate source address
c. fixed rules necessary for host to function
d. user rules defined by security groups
This change restricts the special traffic permitted in part (a) to only
that traffic which utilizes the "unspecified address" (::), by moving
the fixed permit ICMPv6 and DHCPv6 rules to part (c), so they are
applied after the source address has been validated. In order to enable
DHCPv6 and other protocols utilizing link-local addresses, the
link-local address corresponding to each MAC address are included in the
permitted source addresses. After the source address is verified, the
fixed rules permit ICMPv6 and DHCPv6, then the user defined security
group rules are applied.
In the existing implementation ICMPv6 and DHCPv6 rules in the fixed
ip6tables firewall rules are too permissive: they permit ICMPv6 and
DHCPv6 traffic, regardless of source MAC or IPv6 address. These rules
where intended to allow a host to acquire an IPv6 address, but
inadvertently allowed a malicious or compromised host to spoof another's
MAC or IPv6 address.
A host acquiring an IPv6 address should preform DAD (duplicate address
detection). To preform this the host must join the multicast group
corresponding to the tentative IPv6 address and the all nodes multicast
group. To join these groups the host sends ICMP MLD (multicast listener
discovery) report messages before it has an IPv6 address assigned, so
the unspecified address is used as the source address. To complete DAD,
ICMP neighbor solicitation messages are sent to solicit if any nodes
using that address. This should be the only use of the unspecified IPv6
address as a source address. The IPv4 case is similar the unspecified
address is used for DHCP discovery and request messages.
To summarize, this patch permits only ICMPv6 traffic from the unspecified
address which is used for duplicate address detection. Then it enforces
the source IPv6 and MAC addresses and finally, allows only ICMPv6 traffic
which has passed this source address validation.
In addition this patch permits traffic from all link-local addresses
associated with each MAC address assigned to the port. This is required
by many IPv6 protocols, such as DHCPv6, which depend on the link-local
addresses. This traffic was previously allowed by the blanket allow
ICMPv6 and allow DHCPv6 rules before the source address was validated.
Finally, it includes a functional test for IPv6 spoofing using both
ICMPv6 and DHCPv6 traffic. OVSFirewall currently permits this spoofed
DHCPv6 traffic. I'm excluding the OVSFirewall implementation from test
so it can be fixed in a follow on patch.
Conflicts:
neutron/agent/linux/iptables\_firewall.py
neutron/tests/unit/agent/linux/test\_iptables\_firewall.py
Change-Id: Ice1c9dd349864da28806c5053e38ef86f43b7771
Partial-Bug: 1502933
(cherry picked from commit a8a9d225d8496c044db7057552394afd6c950a8e)

[Kevin Benton (kevinbenton)](https://launchpad.net/~kevinbenton)
on 2016-05-16

| Changed in neutron: | |
| --- | --- |
| **status**: | In Progress → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2016-06-01:  [**Fix included in openstack/neutron 7.1.0**](/neutron/%2Bbug/1502933/comments/33) |  |  | [#33](/neutron/%2Bbug/1502933/comments/33) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 7.1.0 release.

This issue was fixed in the openstack/neutron 7.1.0 release.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-10

| Changed in ossa: | |
| --- | --- |
| **status**: | Confirmed → In Progress |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-13

| **summary**: | - ICMPv6 anti-spoofing rules are too permissive+ ICMPv6 anti-spoofing rules are too permissive (CVE-2015-8914) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-06-14:  [**Related fix merged to ossa (master)**](/neutron/%2Bbug/1502933/comments/34) |  |  | [#34](/neutron/%2Bbug/1502933/comments/34) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/301977>

Committed: <https://git.openstack.org/cgit/openstack/ossa/commit/?id=756540a726aa7309fcd7916c5f22ede66badeb1e>

Submitter: Jenkins

Branch: master

commit 756540a726aa7309fcd7916c5f22ede66badeb1e

Author: Tristan Cacqueray <email address hidden>

Date: Tue Apr 5 19:41:31 2016 -0400

Adds OSSA 2016-009 (CVE-2016-5362, CVE-2016-5363 and CVE-2015-8914)

Change-Id: Iad029108209fc631da286c777e8485106cea7f53

    Related-Bug: #1502933

    Related-Bug: #1558658

Reviewed: https://review.openstack.org/301977
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=756540a726aa7309fcd7916c5f22ede66badeb1e
Submitter: Jenkins
Branch: master
commit 756540a726aa7309fcd7916c5f22ede66badeb1e
Author: Tristan Cacqueray <tdecacqu@redhat.com>
Date: Tue Apr 5 19:41:31 2016 -0400
Adds OSSA 2016-009 (CVE-2016-5362, CVE-2016-5363 and CVE-2015-8914)
Change-Id: Iad029108209fc631da286c777e8485106cea7f53
Related-Bug: #1502933
Related-Bug: #1558658

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-14

| **summary**: | - ICMPv6 anti-spoofing rules are too permissive (CVE-2015-8914)+ [OSSA-2016-009] ICMPv6 anti-spoofing rules are too permissive+ (CVE-2015-8914) |
| --- | --- |
| Changed in ossa: | |
| **status**: | In Progress → Fix Released |

[Assaf Muller (amuller)](https://launchpad.net/~amuller)
on 2016-06-30

| **tags**: | removed: kilo-backport-potential liberty-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-07-05:  [**Change abandoned on neutron (master)**](/neutron/%2Bbug/1502933/comments/35) |  |  | [#35](/neutron/%2Bbug/1502933/comments/35) |
| --- | --- | --- | --- |

Change abandoned by Armando Migliaccio (<email address hidden>) on branch: master

Review: <https://review.openstack.org/315828>

Reason: This review is > 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.

Change abandoned by Armando Migliaccio (armamig@gmail.com) on branch: master
Review: https://review.openstack.org/315828
Reason: This review is > 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio) wrote on 2016-07-05: |  |  | [#36](/neutron/%2Bbug/1502933/comments/36) |
| --- | --- | --- | --- |

ping?

ping?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-07-06: |  |  | [#37](/neutron/%2Bbug/1502933/comments/37) |
| --- | --- | --- | --- |

@Armando it seems like this bug report has been addressed for IPTable firewall, perhaps the OVS issue could be address with a new bug number ?

@Armando it seems like this bug report has been addressed for IPTable firewall, perhaps the OVS issue could be address with a new bug number ?

[Rodolfo Alonso (rodolfo-alonso-hernandez)](https://launchpad.net/~rodolfo-alonso-hernandez)
on 2022-10-19

| Changed in neutron: | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

[See full activity log](https://bugs.launchpad.net/neutron/%2Bbug/1502933/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/neutron/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/neutron/%2Bbug/1502933/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/neutron/%2Bbug/1502933/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/neutron/%2Bbug/1502933/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_10dd1fe1_20250126_124709.html ===




=== Content from access.redhat.com_c262b403_20250126_124727.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)

  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Product Documentation](https://access.redhat.com/documentation)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)

  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform)
  [All Product Docs](//docs.redhat.com/en/products/)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)

  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Classifications](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Severety Ratings](https://access.redhat.com/security/security-updates/#/cve)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)

  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

 Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

# How do I apply package updates to my RHEL system?

Updated 2023-06-08T17:44:17+00:00 -
English

* [English](https://access.redhat.com/articles/11258)
* [Japanese](https://access.redhat.com/ja/articles/17461)
* [Chinese](https://access.redhat.com/zh-hans/articles/7047073)

## Table of Contents

* [Environment considerations](#environment-considerations-1)
* [Prerequisites](#prerequisites-2)
* [Registering the system with the Subscription Manager](#rhsm)
* [Graphical interface](#graphical-interface-4)
* [Command line](#command-line-5)

* [Applying package updates on Red Hat Enterprise Linux 9](#rhel9)
* [Applying package updates on Red Hat Enterprise Linux 8](#rhel8)
* [Applying package updates on Red Hat Enterprise Linux 7](#rhel7)
* [Applying package updates on Red Hat Enterprise Linux 6](#rhel6)
* [Applying package updates on Red Hat Enterprise Linux 5](#rhel5)

## Environment considerations

Red Hat Enterprise Linux starting with versions 6.1 and 5.7 introduced a new Red Hat Subscription Management (RHSM) service. Red Hat Network (RHN) has been decommissioned.

Users that are new to Red Hat or would like the enhanced subscription information and improved content access should use RHSM. If you are still using Red Hat Network, we advise you to [migrate to RHSM as soon as possible](https://access.redhat.com/products/red-hat-subscription-management#migration). Customers using older versions of Red Hat Enterprise Linux must continue using RHN Classic. Refer to [FAQ for Changes to Red Hat's Entitlement Platform with RHEL 6.1 and 5.7](https://access.redhat.com/articles/47844) and [What's the difference between management services provided by Red Hat Network (RHN) Classic and Red Hat Subscription Management (RHSM)?](https://access.redhat.com/articles/63269) for more information on benefits of RHSM over RHN.

* For **Red Hat Enterprise Linux 9**, register the system using RHSM as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 9](#rhel9).
* For **Red Hat Enterprise Linux 8**, register the system using RHSM as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 8](#rhel8).
* For **Red Hat Enterprise Linux 7**, register the system using RHSM as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 7](#rhel7).
* For **Red Hat Enterprise Linux 6**, register the system using RHSM (if RHEL 6.1 or above) as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 6](#rhel6).
* For **Red Hat Enterprise Linux 5**, register the system using RHSM (if RHEL 5.7 or above) as described in [Registering the system with the Subscription Manager](#rhsm). After registration, update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 5](#rhel5).
* If your system cannot connect to the Internet directly, our [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/) offering may be of interest.

## Prerequisites

### Registering the system with the Subscription Manager

#### Graphical interface

Access the Subscription Management GUI client in Red Hat Enterprise Linux 9 via **Activities** and then **Show Applications** which is visible in the Favorites dock by default.

Access the Subscription Management GUI client in Red Hat Enterprise Linux 8 via **Activities**, then select **Show Applications** and click **All**. Then select **Red Hat Subscription Manager**.

In Red Hat Enterprise Linux 7 open **Applications** -> **System Tools** -> **Red Hat Subscription Manager** and in Red Hat Enterprise Linux 6 via **System** -> **Administration** -> **Red Hat Subscription Manager**.

#### Command line

A system can also be registered via the command line by using the "subscription-manager" command. To register your system, either through the GUI or from the command line, follow the instructions in the [Using and Configuring Red Hat Subscription Manager](https://access.redhat.com/documentation/en-US/Red_Hat_Subscription_Management/1/html-single/RHSM/index.html) guide.

Make sure that your firewall allows configuring RHSM, for more information see [How do I access RHSM (yum) through a firewall?](https://access.redhat.com/solutions/65300).

General information on RHSM can be found in [Red Hat Network Subscription Management](https://access.redhat.com/documentation/en-US/Red_Hat_Customer_Portal/1/html/Red_Hat_Network_Certificate-based_Subscription_Management/index.html), while [FAQ for Changes to Red Hat's Entitlement Platform with RHEL 6.1 and 5.7](/knowledge/node/47844) provides a quick overview and a comparison with RHN.

## Applying package updates on Red Hat Enterprise Linux 9

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 9, launch the graphical update tool through **Applications** and then **Software** which is visible in the Favorites dock (by default).

```
# gnome-software

```

Within the graphical interface, select **Updates**.

For a command line interface, use the following command to update the operating system:

```
# dnf upgrade

```

To install a specific package, such as vsftpd, use the following command:

```
# dnf install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# dnf upgrade bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man dnf

```
## Applying package updates on Red Hat Enterprise Linux 8

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 8, launch the graphical update tool through **Applications** -> **Show Applications** -> **All** -> **Software**, or from the command line via the following command:

```
# gnome-software

```

Within the graphical interface, select **Updates**.

For a command line interface, use the following command to update the operating system:

```
# dnf update

```

To install a specific package, such as vsftpd, use the following command:

```
# dnf install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# dnf update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man dnf

```
## Applying package updates on Red Hat Enterprise Linux 7

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 7, launch the graphical update tool through **Applications** -> **System Tools** -> **Software Update**, or from the command line via the following command:

```
# gpk-update-viewer

```

For a command line interface, use the following command to update the operating system:

```
# yum update

```

To install a specific package, such as vsftpd, use the following command:

```
# yum install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# yum update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man yum

```
## Applying package updates on Red Hat Enterprise Linux 6

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 6, launch the graphical update tool through **System** -> **Administration** -> **Software Update**, or from the command line via the following command:

```
# gpk-update-viewer

```

For a command line interface, use the following command to update the operating system:

```
# yum update

```

To install a specific package, such as vsftpd, use the following command:

```
# yum install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# yum update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man yum

```
## Applying package updates on Red Hat Enterprise Linux 5

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 5, launch the graphical update tool through **Applications** -> **System Tools** -> **Software Updater**, or from the command line via the following command:

```
# pup

```

For a command line interface, use the following command to update the operating system:

```
# yum update

```

To install a specific package, such as vsftpd, use the following command:

```
# yum install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# yum update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man yum

```

* **Product(s)**
* [Red Hat Network](https://access.redhat.com/search?q=Red+Hat+Network&documentKind=Article%26Solution)
* [Red Hat Subscription Management](https://access.redhat.com/search?q=Red+Hat+Subscription+Management&documentKind=Article%26Solution)

* **Category**
* [Learn more](https://access.redhat.com/search?q=Learn+more&documentKind=Article%26Solution)

* **Component**
* [rhn\_register](https://access.redhat.com/search?q=rhn_register&documentKind=Article%26Solution)
* [subscription-manager](https://access.redhat.com/search?q=subscription-manager&documentKind=Article%26Solution)

* **Tags**
* [customer\_portal](https://access.redhat.com/search?q=customer_portal&documentKind=Article%26Solution)

* **Article Type**
* [General](https://access.redhat.com/search?q=General&documentKind=Article%26Solution)

## Comments

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com)

### Help

* [Contact Customer Portal](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Systems Status

### About

* [Red Hat Subscription Value](https://access.redhat.com/subscription-value)
* [About Red Hat](https://www.redhat.com/about/)
* [Red Hat Jobs](http://jobs.redhat.com)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

Copyright © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)

×
### Formatting Tips

Here are the common uses of Markdown.

Code blocks
```
~~~
Code surrounded in tildes is easier to read
~~~
```

Links/URLs`[Red Hat Customer Portal](https://access.redhat.com)`

[Learn more](/help/markdown)
Close

×
#### Request a English Translation

Are you sure you want to update a translation?
It seems an existing [English Translation](%40url) exists already.
We appreciate your interest in having Red Hat content localized to your language. Please note that excessive use of this feature could cause delays in getting specific content you are interested in translated.
Close
 [Request Japanese Translation](/articles/11258?rate=4KpVk2OisoRoaBCC1xAYYu2EqqVd-hs-lWbo3UiEzrI "Request Japanese Translation") [Request Chinese Translation](/articles/11258?rate=Djff6xI-V_Ac9jkgVml5Zy46vWj-_DUy2x9AY3QVlmM "Request Chinese Translation") [Request Korean Translation](/articles/11258?rate=Jlnc4lh8Dy-a-VpnQ5nujpRwH0WyxQjy0mAR7wwUHTU "Request Korean Translation")

×
#### Generating Machine Translation

Loading…
We are generating a machine translation for this content. Depending on the length of the content, this process could take a while.

Cancel



=== Content from www.openwall.com_3490a616_20250125_232946.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](6) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <575AD7A7.8090302@redhat.com>
Date: Fri, 10 Jun 2016 15:07:19 +0000
From: Tristan Cacqueray <tdecacqu@...hat.com>
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: CVE request for vulnerability in OpenStack Neutron

A vulnerability was discovered in OpenStack (see below). In order to
ensure full traceability, we need a CVE number assigned that we can
attach to further notifications. This issue is already public, although
an advisory was not sent yet.

Title: Neutron IPTables firewall anti-spoof protection bypass
Reporter: Romain Aviolat (Nagravision) and
          Dustin Lundquist (Blue Box Group, Inc)
Products: Neutron
Affects: <=7.0.4, >=8.0.0 <=8.1.0

Description:
Romain Aviolat from Nagravision and Dustin Lundquist from
Blue Box Group, Inc independently reported vulnerabilities in Neutron
anti-spoof protection. By forging DHCP discovery messages or non-IP
traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source
addresses on attached networks resulting in denial of services and/or
traffic interception. Moreover when L2population isn't used, other
tenants attached to a shared network are also vulnerable. Neutron
setups using the IPTables firewall driver are affected.

References:
<https://bugs.launchpad.net/bugs/1502933> (icmpv6)
<https://bugs.launchpad.net/bugs/1558658> (mac, dhcp)

Note:
The dhcp fix has been included in the 8.0.0 release and this
request probably needs more than one CVE.

Thanks in advance,

--
Tristan Cacqueray
OpenStack Vulnerability Management Team

Download attachment "[signature.asc](5/1)" of type "application/pgp-signature" (474 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from launchpad.net_9e50c715_20250126_124712.html ===

[Log in / Register](https://launchpad.net/~tristan-cacqueray/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~tristan-cacqueray)

## [Tristan Cacqueray](https://launchpad.net/~tristan-cacqueray)

* Overview
* [Code](https://code.launchpad.net/~tristan-cacqueray)
* [Bugs](https://bugs.launchpad.net/~tristan-cacqueray)
* [Blueprints](https://blueprints.launchpad.net/~tristan-cacqueray)
* [Translations](https://translations.launchpad.net/~tristan-cacqueray)
* [Answers](https://answers.launchpad.net/~tristan-cacqueray)

* [Related packages](https://launchpad.net/~tristan-cacqueray/%2Brelated-packages)
* [Related projects](https://launchpad.net/~tristan-cacqueray/%2Brelated-projects)

## User information

Launchpad Id:
tristan-cacqueray

Email:
[Log in](%2Blogin) for email information.

Member since:
2013-10-25

[![Icon of OpenStack Security SIG](https://launchpadlibrarian.net/203991792/os14.png "Member of OpenStack Security SIG")](/~openstack-ossg)

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

EB103DE8B5E69E631C6FF17922B9A05C925CC5D8

SSH keys:

[localadmin@controller](%2Bsshkeys)

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~tristan-cacqueray/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**tristanC**
 on
**irc.freenode.net**

## [All memberships](https://launchpad.net/~tristan-cacqueray/%2Bparticipation) Latest memberships

| [Swiftsync dev](/~swiftsync-devteam)  Joined on 2014-02-13 | |
| --- | --- |
| [OpenStack Security SIG](/~openstack-ossg)  Joined on 2013-12-12 | |

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugs.launchpad.net_bffe4db2_20250125_232949.html ===

[Log in / Register](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Blogin)

[![](https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png)](https://launchpad.net/neutron)

## [neutron](https://launchpad.net/neutron)

* [Overview](https://launchpad.net/neutron)
* [Code](https://code.launchpad.net/neutron)
* [Bugs](https://bugs.launchpad.net/neutron)
* [Blueprints](https://blueprints.launchpad.net/neutron)
* [Translations](https://translations.launchpad.net/neutron)
* [Answers](https://answers.launchpad.net/neutron)

# [OSSA-2016-009] Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests (CVE-2016-5362 and CVE-2016-5363)

Bug #1558658 reported by
[Dustin Lundquist](https://launchpad.net/~dlundquist)
on 2016-03-17

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | Unassigned |  |
|  | [neutron](https://bugs.launchpad.net/neutron) | Fix Released | High | [Kevin Benton](https://launchpad.net/~kevinbenton) |  |
|  | [Kilo](https://bugs.launchpad.net/neutron/kilo) | Fix Released | Undecided | [Kevin Benton](https://launchpad.net/~kevinbenton) | [neutron 2015.1.4](https://launchpad.net/neutron/%2Bmilestone/2015.1.4) |

### Bug Description

The IptablesFirewallDriver does not prevent spoofing other instances or a routers MAC and/or IP addresses. The rule to permit DHCP discovery and request messages:

ipv4\_rules += [comment\_rule('-p udp -m udp --sport 68 --dport 67 '

                                    '-j RETURN', comment=ic.DHCP\_CLIENT)]

is too permissive, it does not enforce the source MAC or IP address. This is the IPv4 case of public bug [https://bugs.launchpad.net/neutron/+bug/1502933](https://bugs.launchpad.net/neutron/%2Bbug/1502933), and a solution was previously mentioned in June 2013 in [https://bugs.launchpad.net/neutron/+bug/1427054](https://bugs.launchpad.net/neutron/%2Bbug/1427054).

If L2population is not used, an instance can spoof the Neutron router's MAC address and cause the switches to learn a MAC move, allowing the instance to intercept other instances traffic potentially belonging to other tenants if this is shared network.

The solution for this is to permit this DHCP traffic only from the instance's IP address and the unspecified IPv4 address 0.0.0.0/32 rather than from an IPv4 source, additionally the source MAC address should be restricted to MAC addresses assigned to the instance's Neutron port.

See [original description](comments/0)

Tags:

[in-stable-kilo](/neutron/%2Bbugs?field.tag=in-stable-kilo)
[in-stable-liberty](/neutron/%2Bbugs?field.tag=in-stable-liberty)
[in-stable-mitaka](/neutron/%2Bbugs?field.tag=in-stable-mitaka)

## CVE References

* [2015-8914](/bugs/cve/2015-8914 "The IPTables firewall in OpenStack Ne...")
* [2016-5362](/bugs/cve/2016-5362 "The IPTables firewall in OpenStack Ne...")
* [2016-5363](/bugs/cve/2016-5363 "The IPTables firewall in OpenStack Ne...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-03-17: |  |  | [#1](/neutron/%2Bbug/1558658/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio) wrote on 2016-03-18: |  |  | [#2](/neutron/%2Bbug/1558658/comments/2) |
| --- | --- | --- | --- |

Looking.

Looking.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio) wrote on 2016-03-18: |  |  | [#3](/neutron/%2Bbug/1558658/comments/3) |
| --- | --- | --- | --- |

I think the issue exists, and under the circumstances identified there's the risk to intercept traffic on a shared medium. If the solution wouldn't involve tracking the source mac of all instances on the shared network, I'd say go for it, but the scalability implications concern me. Having said that, I think knowledge about this is already public domain because of the other issues being reported, therefore we may want to consider open the discussion for wider feedback.

I think the issue exists, and under the circumstances identified there's the risk to intercept traffic on a shared medium. If the solution wouldn't involve tracking the source mac of all instances on the shared network, I'd say go for it, but the scalability implications concern me. Having said that, I think knowledge about this is already public domain because of the other issues being reported, therefore we may want to consider open the discussion for wider feedback.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-03-21: |  |  | [#4](/neutron/%2Bbug/1558658/comments/4) |
| --- | --- | --- | --- |

Thank you Armando for the investigation.

It's still unclear whenever shared network impacts do warrants an advisory.

If nobody objects, lets make this bug report public security.

Also, should the description be saying "the IPv6\* case of public bug" instead of IPv4 ?

Thank you Armando for the investigation.
It's still unclear whenever shared network impacts do warrants an advisory.
If nobody objects, lets make this bug report public security.
Also, should the description be saying "the IPv6\* case of public bug" instead of IPv4 ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-21: |  |  | [#5](/neutron/%2Bbug/1558658/comments/5) |
| --- | --- | --- | --- |

Tristan,

It's reasonable to assume IPv4 is much more widely deployed than IPv6, so the public IPv6 bug a significantly smaller number of installations. That being said, it wasn't a very difficult to examine the IPv4 case for the same vulnerability as the IPv6 case, so don't believe there is significant value in maintaining the embargo.

Armando,

Neutron presently maintains an ebtables chain for each instance port to prevent MAC spoofing, the overhead of expanding this to validate all source MAC as well as ARP messages is one additional rule in this chain (ebtables allows matching against multiple MAC addresses in a single rule). If Neutron chooses not to address this, first-hop security expectations should to be clearly defined in a policy somewhere so operators can make informed decisions on how they deploy Neutron.

Tristan,
It's reasonable to assume IPv4 is much more widely deployed than IPv6, so the public IPv6 bug a significantly smaller number of installations. That being said, it wasn't a very difficult to examine the IPv4 case for the same vulnerability as the IPv6 case, so don't believe there is significant value in maintaining the embargo.
Armando,
Neutron presently maintains an ebtables chain for each instance port to prevent MAC spoofing, the overhead of expanding this to validate all source MAC as well as ARP messages is one additional rule in this chain (ebtables allows matching against multiple MAC addresses in a single rule). If Neutron chooses not to address this, first-hop security expectations should to be clearly defined in a policy somewhere so operators can make informed decisions on how they deploy Neutron.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kevin Benton (kevinbenton)](https://launchpad.net/~kevinbenton) wrote on 2016-03-25: |  |  | [#6](/neutron/%2Bbug/1558658/comments/6) |
| --- | --- | --- | --- |

* [bug\_1558658.patch](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Battachment/4611129/%2Bfiles/bug_1558658.patch)
  [Edit](/neutron/%2Bbug/1558658/%2Battachment/4611129)
  (23.1 KiB,
  text/plain)

I agree that this is something we need to address. I'm fine with it being opened to the public or being fixed first.

@Dustin,

Can you confirm that the attached patch fixes the mac spoofing issue? (Note that there are two patches in there, one for Linux Bridge and one for OVS)

I didn't do anything about the DHCP request source IP restriction in this patch because that one just seems to be a way to spam some DHCP requests for an incorrect address. Correct me if I'm wrong, but that doesn't pose any security issue (other than log noise), right?

I agree that this is something we need to address. I'm fine with it being opened to the public or being fixed first.
@Dustin,
Can you confirm that the attached patch fixes the mac spoofing issue? (Note that there are two patches in there, one for Linux Bridge and one for OVS)
I didn't do anything about the DHCP request source IP restriction in this patch because that one just seems to be a way to spam some DHCP requests for an incorrect address. Correct me if I'm wrong, but that doesn't pose any security issue (other than log noise), right?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-28: |  |  | [#7](/neutron/%2Bbug/1558658/comments/7) |
| --- | --- | --- | --- |

@Kevin,

I've tested the patch on ML2 LinuxBridge, and in the process of testing on ML2 OVS now. I'm not positive that all potential instance operating systems would not insert an entry its ARP table after receiving a unicast UDP packet, although I've verified Linux does not learn neighbors from unicast UDP packets. I think we can remove the embargo once this patch is merged.

@Kevin,
I've tested the patch on ML2 LinuxBridge, and in the process of testing on ML2 OVS now. I'm not positive that all potential instance operating systems would not insert an entry its ARP table after receiving a unicast UDP packet, although I've verified Linux does not learn neighbors from unicast UDP packets. I think we can remove the embargo once this patch is merged.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-28: |  |  | [#8](/neutron/%2Bbug/1558658/comments/8) |
| --- | --- | --- | --- |

@Kevin

I've verified your patch prevents MAC address spoofing with both LinuxBridge and OVS mechanism drivers. The chunk in update\_stale\_ofport\_rules didn't apply cleanly to master, but was trivial to resolve by hand.

@Kevin
I've verified your patch prevents MAC address spoofing with both LinuxBridge and OVS mechanism drivers. The chunk in update\_stale\_ofport\_rules didn't apply cleanly to master, but was trivial to resolve by hand.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-03-29: |  |  | [#9](/neutron/%2Bbug/1558658/comments/9) |
| --- | --- | --- | --- |

I agree the impact of this bug should be limited enough that it's worthwhile to work it in public and avoid complexities of the embargo process.

I agree the impact of this bug should be limited enough that it's worthwhile to work it in public and avoid complexities of the embargo process.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-03-29: |  |  | [#10](/neutron/%2Bbug/1558658/comments/10) |
| --- | --- | --- | --- |

@Dustin @Kevin, if it's ok for you, can you remove the privacy setting of this bug before submitting the proposed patch to gerrit ?

@Dustin @Kevin, if it's ok for you, can you remove the privacy setting of this bug before submitting the proposed patch to gerrit ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-29: |  |  | [#11](/neutron/%2Bbug/1558658/comments/11) |
| --- | --- | --- | --- |

@Tristan @Jeremy, The MAC spoofing aspect of this could based used to DoS or intercept other tenants in a public cloud using shared networks. I'm not familiar with the review process for a patch under embargo, but releasing this could leave public deployments exposed. On the other hand, as I mentioned in the original bug report, this is the IPv4 case of a public IPv6 bug and a fix was first suggested in 2013. Hopefully public deployments have taken additional precautions to harden their environments.

@Tristan @Jeremy, The MAC spoofing aspect of this could based used to DoS or intercept other tenants in a public cloud using shared networks. I'm not familiar with the review process for a patch under embargo, but releasing this could leave public deployments exposed. On the other hand, as I mentioned in the original bug report, this is the IPv4 case of a public IPv6 bug and a fix was first suggested in 2013. Hopefully public deployments have taken additional precautions to harden their environments.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-03-29: |  |  | [#12](/neutron/%2Bbug/1558658/comments/12) |
| --- | --- | --- | --- |

In the past we've considered some bugs only impacting shared tenant networks to be impractical vulnerabilities given the warnings in the security guide about shared network deployment models (though I'm failing to find specific precedent bugs to cite at the moment). That said, if the proposed patch fixes this and can be backported quickly to supported stable branches (mitaka, liberty, kilo) without an adverse behavior change then we could follow embargo process. I'm just wary, as the related IPv6 bug has been public for months with no movement.

In the past we've considered some bugs only impacting shared tenant networks to be impractical vulnerabilities given the warnings in the security guide about shared network deployment models (though I'm failing to find specific precedent bugs to cite at the moment). That said, if the proposed patch fixes this and can be backported quickly to supported stable branches (mitaka, liberty, kilo) without an adverse behavior change then we could follow embargo process. I'm just wary, as the related IPv6 bug has been public for months with no movement.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kevin Benton (kevinbenton)](https://launchpad.net/~kevinbenton) wrote on 2016-03-29: |  |  | [#13](/neutron/%2Bbug/1558658/comments/13) |
| --- | --- | --- | --- |

I would be okay with a public release and then regular code review. It should be relatively quick since the patch is already prepared with tests.

I would be okay with a public release and then regular code review. It should be relatively quick since the patch is already prepared with tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-03-29: |  |  | [#14](/neutron/%2Bbug/1558658/comments/14) |
| --- | --- | --- | --- |

I've switched this to public security. Changes can be pushed to public Gerrit while we continue to debate the impact and need for an advisory.

I've switched this to public security. Changes can be pushed to public Gerrit while we continue to debate the impact and need for an advisory.

| **information type**: | Private Security → Public Security |
| --- | --- |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/15) |  |  | [#15](/neutron/%2Bbug/1558658/comments/15) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/299021>

Fix proposed to branch: master
Review: https://review.openstack.org/299021

| Changed in neutron: | |
| --- | --- |
| **assignee**: | nobody → Kevin Benton (kevinbenton) |
| **status**: | New → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#16](/neutron/%2Bbug/1558658/comments/16) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/299022>

Fix proposed to branch: master
Review: https://review.openstack.org/299022

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/17) |  |  | [#17](/neutron/%2Bbug/1558658/comments/17) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/299023>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/299023

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#18](/neutron/%2Bbug/1558658/comments/18) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/299024>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/299024

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/19) |  |  | [#19](/neutron/%2Bbug/1558658/comments/19) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/299025>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/299025

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#20](/neutron/%2Bbug/1558658/comments/20) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/299026>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/299026

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/21) |  |  | [#21](/neutron/%2Bbug/1558658/comments/21) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/299027>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/299027

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#22](/neutron/%2Bbug/1558658/comments/22) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/299028>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/299028

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-31:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/23) |  |  | [#23](/neutron/%2Bbug/1558658/comments/23) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/300202>

Fix proposed to branch: master
Review: https://review.openstack.org/300202

| Changed in neutron: | |
| --- | --- |
| **assignee**: | Kevin Benton (kevinbenton) → Dustin Lundquist (dlundquist) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-04:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/24) |  |  | [#24](/neutron/%2Bbug/1558658/comments/24) |
| --- | --- | --- | --- |

About the OSSA status, is the impact for non shared network limited to single tenant scope (e.g. one instance can bypass neutron anti-spoof rules toward other instances of the same tenant only) ?

About the OSSA status, is the impact for non shared network limited to single tenant scope (e.g. one instance can bypass neutron anti-spoof rules toward other instances of the same tenant only) ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-05:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1558658/comments/25) |  |  | [#25](/neutron/%2Bbug/1558658/comments/25) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299021>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=be298f8bc35e6d006c7a9361e42755c9d6790e1e>

Submitter: Jenkins

Branch: master

commit be298f8bc35e6d006c7a9361e42755c9d6790e1e

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

Reviewed: https://review.openstack.org/299021
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=be298f8bc35e6d006c7a9361e42755c9d6790e1e
Submitter: Jenkins
Branch: master
commit be298f8bc35e6d006c7a9361e42755c9d6790e1e
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-05:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/26) |  |  | [#26](/neutron/%2Bbug/1558658/comments/26) |
| --- | --- | --- | --- |

Covering both [bug 1558658](/bugs/1558658) and [bug 1502933](/bugs/1502933), here is impact description draft #1.

Is this accurate enough ?

Title: Neutron anti-spoof protection bypass

Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group)

Products: Neutron

Affects: >=2015.1.0 <=2015.1.3, >=7.0.0 <=7.0.4, <=8.0.0

Description:

Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box Group, Inc independently reported a vulnerability in Neutron anti-spoof protection. By forging discovery protocol source address, an instance may spoof addresses on attached network resulting in Denial of Service and/or traffic interception. When L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Covering both bug 1558658 and bug 1502933, here is impact description draft #1.
Is this accurate enough ?
Title: Neutron anti-spoof protection bypass
Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group)
Products: Neutron
Affects: >=2015.1.0 <=2015.1.3, >=7.0.0 <=7.0.4, <=8.0.0
Description:
Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box Group, Inc independently reported a vulnerability in Neutron anti-spoof protection. By forging discovery protocol source address, an instance may spoof addresses on attached network resulting in Denial of Service and/or traffic interception. When L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2016-04-05

| Changed in neutron: | |
| --- | --- |
| **assignee**: | Dustin Lundquist (dlundquist) → Kevin Benton (kevinbenton) |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-04-05

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-05: |  |  | [#27](/neutron/%2Bbug/1558658/comments/27) |
| --- | --- | --- | --- |

@Tristan, A few suggestions for impact description:

  1. s/forging discovery protocol source address/forging DHCP discovery source address/ (DHCP is the protocol, discovery is the message type, and could be confused with IPv6 neighbor discovery protocol).

  2. In bug/1558674 I generalized this to all non-IP traffic, I think this is relevant to the impact description since it is a more likely attack vector

  3. We should mention that both MAC and IP source spoofing where permitted. MAC spoofing effects are limited to local network, while IP spoofing could be used for either a direct DoS or interfering with DHCP leases on other networks.

@Tristan, A few suggestions for impact description:
1. s/forging discovery protocol source address/forging DHCP discovery source address/ (DHCP is the protocol, discovery is the message type, and could be confused with IPv6 neighbor discovery protocol).
2. In bug/1558674 I generalized this to all non-IP traffic, I think this is relevant to the impact description since it is a more likely attack vector
3. We should mention that both MAC and IP source spoofing where permitted. MAC spoofing effects are limited to local network, while IP spoofing could be used for either a direct DoS or interfering with DHCP leases on other networks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-05: |  |  | [#28](/neutron/%2Bbug/1558658/comments/28) |
| --- | --- | --- | --- |

Thank you Dustin for this review! How about:

By forging non-IP traffic such as DHCP discovery or ARP messages, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Thank you Dustin for this review! How about:
By forging non-IP traffic such as DHCP discovery or ARP messages, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-05: |  |  | [#29](/neutron/%2Bbug/1558658/comments/29) |
| --- | --- | --- | --- |

Still a bit muddled, DHCP is IP traffic, and ARP is already filtered by ebtables. How about:

By forging DHCP discovery messages or non-IP traffic, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Still a bit muddled, DHCP is IP traffic, and ARP is already filtered by ebtables. How about:
By forging DHCP discovery messages or non-IP traffic, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-05:  [**Related fix proposed to ossa (master)**](/neutron/%2Bbug/1558658/comments/30) |  |  | [#30](/neutron/%2Bbug/1558658/comments/30) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/301977>

Related fix proposed to branch: master
Review: https://review.openstack.org/301977

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-05:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/31) |  |  | [#31](/neutron/%2Bbug/1558658/comments/31) |
| --- | --- | --- | --- |

Oups, dhcp discovery is indeed IP. Thank you for the correction.

<https://review.openstack.org/301977> is the proposed OSSA, note that it is missing backports of the icmpv6 extra rules.

I'll request the CVE number once everything is ready.

Oups, dhcp discovery is indeed IP. Thank you for the correction.
https://review.openstack.org/301977 is the proposed OSSA, note that it is missing backports of the icmpv6 extra rules.
I'll request the CVE number once everything is ready.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-06:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1558658/comments/32) |  |  | [#32](/neutron/%2Bbug/1558658/comments/32) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299022>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=997d7b03fb7f5528f0a3ce70867b9dcd9321509e>

Submitter: Jenkins

Branch: master

commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 04:47:28 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

Reviewed: https://review.openstack.org/299022
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=997d7b03fb7f5528f0a3ce70867b9dcd9321509e
Submitter: Jenkins
Branch: master
commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 04:47:28 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

| Changed in neutron: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08: |  |  | [#33](/neutron/%2Bbug/1558658/comments/33) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/300202>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=6a93ee8ac1a901c255e3475a24f1afc11d8bf80f>

Submitter: Jenkins

Branch: master

commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

Reviewed: https://review.openstack.org/300202
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=6a93ee8ac1a901c255e3475a24f1afc11d8bf80f
Submitter: Jenkins
Branch: master
commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08:  [**Fix proposed to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/34) |  |  | [#34](/neutron/%2Bbug/1558658/comments/34) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/303563>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/303563

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08:  [**Fix proposed to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/35) |  |  | [#35](/neutron/%2Bbug/1558658/comments/35) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/303572>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/303572

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08:  [**Fix proposed to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/36) |  |  | [#36](/neutron/%2Bbug/1558658/comments/36) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/303617>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/303617

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-14:  [**Fix merged to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/37) |  |  | [#37](/neutron/%2Bbug/1558658/comments/37) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/303563>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=5853af9cba6733725d6c9ac0db644f426713f0cf>

Submitter: Jenkins

Branch: stable/mitaka

commit 5853af9cba6733725d6c9ac0db644f426713f0cf

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

    (cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

Reviewed: https://review.openstack.org/303563
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=5853af9cba6733725d6c9ac0db644f426713f0cf
Submitter: Jenkins
Branch: stable/mitaka
commit 5853af9cba6733725d6c9ac0db644f426713f0cf
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

| **tags**: | added: in-stable-mitaka |
| --- | --- |
| **tags**: | added: in-stable-liberty |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-14:  [**Fix merged to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/38) |  |  | [#38](/neutron/%2Bbug/1558658/comments/38) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/303572>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=fd5fd259a02156babdfcb12f66cde6ec9e7274ae>

Submitter: Jenkins

Branch: stable/liberty

commit fd5fd259a02156babdfcb12f66cde6ec9e7274ae

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Conflicts:

     neutron/tests/functional/agent/test\_firewall.py

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

    (cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

Reviewed: https://review.openstack.org/303572
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=fd5fd259a02156babdfcb12f66cde6ec9e7274ae
Submitter: Jenkins
Branch: stable/liberty
commit fd5fd259a02156babdfcb12f66cde6ec9e7274ae
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Conflicts:
neutron/tests/functional/agent/test\_firewall.py
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

| **tags**: | added: in-stable-kilo |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-14:  [**Fix merged to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/39) |  |  | [#39](/neutron/%2Bbug/1558658/comments/39) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/303617>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=b0f6984de3985b80c728dd282fe6148b28f01fe4>

Submitter: Jenkins

Branch: stable/kilo

commit b0f6984de3985b80c728dd282fe6148b28f01fe4

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Conflicts:

     neutron/agent/linux/iptables\_firewall.py

     neutron/tests/functional/agent/test\_firewall.py

     neutron/tests/unit/agent/linux/test\_iptables\_firewall.py

     neutron/tests/unit/agent/test\_securitygroups\_rpc.py

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

    (cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

Reviewed: https://review.openstack.org/303617
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=b0f6984de3985b80c728dd282fe6148b28f01fe4
Submitter: Jenkins
Branch: stable/kilo
commit b0f6984de3985b80c728dd282fe6148b28f01fe4
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Conflicts:
neutron/agent/linux/iptables\_firewall.py
neutron/tests/functional/agent/test\_firewall.py
neutron/tests/unit/agent/linux/test\_iptables\_firewall.py
neutron/tests/unit/agent/test\_securitygroups\_rpc.py
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

[Kevin Benton (kevinbenton)](https://launchpad.net/~kevinbenton)
on 2016-04-20

| Changed in neutron: | |
| --- | --- |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-09:  [**Change abandoned on neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/40) |  |  | [#40](/neutron/%2Bbug/1558658/comments/40) |
| --- | --- | --- | --- |

Change abandoned by Dave Walker (<email address hidden>) on branch: stable/kilo

Review: <https://review.openstack.org/299027>

Reason:

stable/kilo closed for 2015.1.4

This release is now pending its final release and no freeze exception has

been seen for this changeset. Therefore, I am now abandoning this change.

If this is not correct, please urgently raise a thread on openstack-dev.

More details at: <https://wiki.openstack.org/wiki/StableBranch>

Change abandoned by Dave Walker (email@daviey.com) on branch: stable/kilo
Review: https://review.openstack.org/299027
Reason:
stable/kilo closed for 2015.1.4
This release is now pending its final release and no freeze exception has
been seen for this changeset. Therefore, I am now abandoning this change.
If this is not correct, please urgently raise a thread on openstack-dev.
More details at: https://wiki.openstack.org/wiki/StableBranch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-09: |  |  | [#41](/neutron/%2Bbug/1558658/comments/41) |
| --- | --- | --- | --- |

Change abandoned by Dave Walker (<email address hidden>) on branch: stable/kilo

Review: <https://review.openstack.org/299028>

Reason:

stable/kilo closed for 2015.1.4

This release is now pending its final release and no freeze exception has

been seen for this changeset. Therefore, I am now abandoning this change.

If this is not correct, please urgently raise a thread on openstack-dev.

More details at: <https://wiki.openstack.org/wiki/StableBranch>

Change abandoned by Dave Walker (email@daviey.com) on branch: stable/kilo
Review: https://review.openstack.org/299028
Reason:
stable/kilo closed for 2015.1.4
This release is now pending its final release and no freeze exception has
been seen for this changeset. Therefore, I am now abandoning this change.
If this is not correct, please urgently raise a thread on openstack-dev.
More details at: https://wiki.openstack.org/wiki/StableBranch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-09:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/42) |  |  | [#42](/neutron/%2Bbug/1558658/comments/42) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/314250>

Fix proposed to branch: master
Review: https://review.openstack.org/314250

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10:  [**Fix merged to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/43) |  |  | [#43](/neutron/%2Bbug/1558658/comments/43) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299025>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=b57d9fa96967de4aa634fb32a683d6c37fd05fab>

Submitter: Jenkins

Branch: stable/liberty

commit b57d9fa96967de4aa634fb32a683d6c37fd05fab

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

    (cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Reviewed: https://review.openstack.org/299025
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=b57d9fa96967de4aa634fb32a683d6c37fd05fab
Submitter: Jenkins
Branch: stable/liberty
commit b57d9fa96967de4aa634fb32a683d6c37fd05fab
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658
(cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10: |  |  | [#44](/neutron/%2Bbug/1558658/comments/44) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299026>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=b33c16bb0e75015f3e75693d815cfd616c831112>

Submitter: Jenkins

Branch: stable/liberty

commit b33c16bb0e75015f3e75693d815cfd616c831112

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 04:47:28 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Conflicts:

      neutron/plugins/ml2/drivers/openvswitch/agent/openflow/ovs\_ofctl/br\_int.py

      (no 'dump\_flows\_for' method so dump\_flows had to be used with an additional

       check of the in\_port on existing rules)

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

    (cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Reviewed: https://review.openstack.org/299026
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=b33c16bb0e75015f3e75693d815cfd616c831112
Submitter: Jenkins
Branch: stable/liberty
commit b33c16bb0e75015f3e75693d815cfd616c831112
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 04:47:28 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Conflicts:
neutron/plugins/ml2/drivers/openvswitch/agent/openflow/ovs\_ofctl/br\_int.py
(no 'dump\_flows\_for' method so dump\_flows had to be used with an additional
check of the in\_port on existing rules)
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f
(cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10:  [**Fix merged to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/45) |  |  | [#45](/neutron/%2Bbug/1558658/comments/45) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299023>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=cc275e4975450947fa9d9e55ef42475a25bf611d>

Submitter: Jenkins

Branch: stable/mitaka

commit cc275e4975450947fa9d9e55ef42475a25bf611d

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

    (cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Reviewed: https://review.openstack.org/299023
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=cc275e4975450947fa9d9e55ef42475a25bf611d
Submitter: Jenkins
Branch: stable/mitaka
commit cc275e4975450947fa9d9e55ef42475a25bf611d
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658
(cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10: |  |  | [#46](/neutron/%2Bbug/1558658/comments/46) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299024>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=d7dc90946407d27eec9063f05f33e3f4888ad395>

Submitter: Jenkins

Branch: stable/mitaka

commit d7dc90946407d27eec9063f05f33e3f4888ad395

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 04:47:28 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

    (cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Reviewed: https://review.openstack.org/299024
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=d7dc90946407d27eec9063f05f33e3f4888ad395
Submitter: Jenkins
Branch: stable/mitaka
commit d7dc90946407d27eec9063f05f33e3f4888ad395
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 04:47:28 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f
(cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10:  [**Fix merged to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/47) |  |  | [#47](/neutron/%2Bbug/1558658/comments/47) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299027>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=d626eb24a304a0ba53311aa1bb877f60c974da72>

Submitter: Jenkins

Branch: stable/kilo

commit d626eb24a304a0ba53311aa1bb877f60c974da72

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Conflicts:

     neutron/plugins/linuxbridge/agent/arp\_protect.py

     neutron/tests/functional/agent/linux/test\_linuxbridge\_arp\_protect.py

        (simple conflicts on both due to utils.is\_trusted\_port logic being gone)

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

    (cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Reviewed: https://review.openstack.org/299027
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=d626eb24a304a0ba53311aa1bb877f60c974da72
Submitter: Jenkins
Branch: stable/kilo
commit d626eb24a304a0ba53311aa1bb877f60c974da72
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Conflicts:
neutron/plugins/linuxbridge/agent/arp\_protect.py
neutron/tests/functional/agent/linux/test\_linuxbridge\_arp\_protect.py
(simple conflicts on both due to utils.is\_trusted\_port logic being gone)
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658
(cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10: |  |  | [#48](/neutron/%2Bbug/1558658/comments/48) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299028>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=d48147b0fc192c49646951294479573e4ed9ae78>

Submitter: Jenkins

Branch: stable/kilo

commit d48147b0fc192c49646951294479573e4ed9ae78

Author: Kevin Benton <email address hidden>

Date: Mon Mar 28 22:21:53 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Conflicts:

        This had to be heavily modified to work with Kilo due to

        the lack of a pluggable openflow interface that was present

        in master, mitaka, and liberty.

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

    (cherry-picked from 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Reviewed: https://review.openstack.org/299028
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=d48147b0fc192c49646951294479573e4ed9ae78
Submitter: Jenkins
Branch: stable/kilo
commit d48147b0fc192c49646951294479573e4ed9ae78
Author: Kevin Benton <kevin@benton.pub>
Date: Mon Mar 28 22:21:53 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Conflicts:
This had to be heavily modified to work with Kilo due to
the lack of a pluggable openflow interface that was present
in master, mitaka, and liberty.
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f
(cherry-picked from 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-05-10:  [**Fix included in openstack/neutron 2015.1.4**](/neutron/%2Bbug/1558658/comments/49) |  |  | [#49](/neutron/%2Bbug/1558658/comments/49) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 2015.1.4 release.

This issue was fixed in the openstack/neutron 2015.1.4 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-13:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/50) |  |  | [#50](/neutron/%2Bbug/1558658/comments/50) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/315828>

Fix proposed to branch: master
Review: https://review.openstack.org/315828

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-16:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/51) |  |  | [#51](/neutron/%2Bbug/1558658/comments/51) |
| --- | --- | --- | --- |

Dustin, is change 315828 ( Ia1f9d768004871d743d2c7b979de1439667efe52 ) a security fix or does it fix a regression caused by one of the fix part of this upcoming advisory ? ftr, the current list of patch for the ossa are:

\* Ice1c9dd349864da28806c5053e38ef86f43b7771 (icmpv6)

\* Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5 (dhcp)

\* I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 (arp)

Dustin, is change 315828 ( Ia1f9d768004871d743d2c7b979de1439667efe52 ) a security fix or does it fix a regression caused by one of the fix part of this upcoming advisory ? ftr, the current list of patch for the ossa are:
\* Ice1c9dd349864da28806c5053e38ef86f43b7771 (icmpv6)
\* Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5 (dhcp)
\* I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 (arp)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-16: |  |  | [#52](/neutron/%2Bbug/1558658/comments/52) |
| --- | --- | --- | --- |

Here is the final impact description:

Title: Neutron anti-spoof protection bypass

Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group, Inc)

Products: Neutron

Affects: <=7.0.4, >=8.0.0 <=8.1.0

Description:

Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box

Group, Inc independently reported vulnerabilities in Neutron anti-

spoof protection. By forging DHCP discovery messages or non-IP

traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source

addresses on attached networks resulting in denial of services and/or

traffic interception. Moreover when L2population isn't used, other

tenants attached to a shared network are also vulnerable. Neutron

setups using the IPTables firewall driver are affected.

Here is the final impact description:
Title: Neutron anti-spoof protection bypass
Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group, Inc)
Products: Neutron
Affects: <=7.0.4, >=8.0.0 <=8.1.0
Description:
Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box
Group, Inc independently reported vulnerabilities in Neutron anti-
spoof protection. By forging DHCP discovery messages or non-IP
traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source
addresses on attached networks resulting in denial of services and/or
traffic interception. Moreover when L2population isn't used, other
tenants attached to a shared network are also vulnerable. Neutron
setups using the IPTables firewall driver are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-05-17: |  |  | [#53](/neutron/%2Bbug/1558658/comments/53) |
| --- | --- | --- | --- |

Tristan, change 315828 addresses the OVS Firewall which currently has many of these same problems. Specifically table 71 (BASE\_EGRESS\_TABLE) permits specific ICMPv6 types, DHCP and DHCPv6 before validating source MAC or IP addresses. This allows IPv6 spoofing: neighbor discovery is permitted without any address validation. In addition the DHCP (IPv4) could be used to mask the source address of flood attack or release the DHCP lease of another instance (potentially belonging to another tenant on a shared network). In addition all the of above traffic types could be used to cause an physical switch to learn an incorrect port of another instance or router's MAC address potentially intercepting another tenants traffic on a shared provider network.

I finally have a working OVS Firewall test environment and this is my initial analysis of the OpenFlow rules it produces. I think all of the above vulnerabilities are addressed in the existing bug reports. I know the OVS Firewall is recent addition, so I'm not sure how it falls into the security advisory process.

Tristan, change 315828 addresses the OVS Firewall which currently has many of these same problems. Specifically table 71 (BASE\_EGRESS\_TABLE) permits specific ICMPv6 types, DHCP and DHCPv6 before validating source MAC or IP addresses. This allows IPv6 spoofing: neighbor discovery is permitted without any address validation. In addition the DHCP (IPv4) could be used to mask the source address of flood attack or release the DHCP lease of another instance (potentially belonging to another tenant on a shared network). In addition all the of above traffic types could be used to cause an physical switch to learn an incorrect port of another instance or router's MAC address potentially intercepting another tenants traffic on a shared provider network.
I finally have a working OVS Firewall test environment and this is my initial analysis of the OpenFlow rules it produces. I think all of the above vulnerabilities are addressed in the existing bug reports. I know the OVS Firewall is recent addition, so I'm not sure how it falls into the security advisory process.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-17: |  |  | [#54](/neutron/%2Bbug/1558658/comments/54) |
| --- | --- | --- | --- |

Hum, well that's the problem with catch-all advisory where similar issues can be found later.

I propose we change impact description title to "Neutron IPTables firewall anti-spoof protection bypass" and move with it.

For the OVS Firewall case, I've added an ossa task to track this issue separately. If you agree, please review the new title and impact description posted in comment #52 so that we can request a CVE and proceed with the advisory.

Hum, well that's the problem with catch-all advisory where similar issues can be found later.
I propose we change impact description title to "Neutron IPTables firewall anti-spoof protection bypass" and move with it.
For the OVS Firewall case, I've added an ossa task to track this issue separately. If you agree, please review the new title and impact description posted in comment #52 so that we can request a CVE and proceed with the advisory.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-26:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1558658/comments/55) |  |  | [#55](/neutron/%2Bbug/1558658/comments/55) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/neutron/%2Bbug/1558658/comments/55/%2Bdownload) (36.9 KiB)

Reviewed: <https://review.openstack.org/314250>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=3bf73801df169de40d365e6240e045266392ca63>

Submitter: Jenkins

Branch: master

commit a323769143001d67fd1b3b4ba294e59accd09e0e

Author: Ryan Moats <email address hidden>

Date: Tue Oct 20 15:51:37 2015 +0000

Revert "Improve performance of ensure\_namespace"

This reverts commit 81823e86328e62850a89aef9f0b609bfc0a6dacd.

Unneeded optimization: this commit only improves execution

    time on the order of milliseconds, which is less than 1% of

    the total router update execution time at the network node.

This also

Closes-bug: #1574881

Change-Id: Icbcdf4725ba7d2e743bb6761c9799ae436bd953b

commit 7fcf0253246832300f13b0aa4cea397215700572

Author: OpenStack Proposal Bot <email address hidden>

Date: Thu Apr 21 07:05:16 2016 +0000

Imported Translations from Zanata

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I9e930750dde85a9beb0b6f85eeea8a0962d3e020

commit 643b4431606421b09d05eb0ccde130adbf88df64

Author: OpenStack Proposal Bot <email address hidden>

Date: Tue Apr 19 06:52:48 2016 +0000

Imported Translations from Zanata

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I52d7460b3265b5460b9089e1cc58624640dc7230

commit 1ffea42ccdc14b7a6162c1895bd8f2aae48d5dae

Author: OpenStack Proposal Bot <email address hidden>

Date: Mon Apr 18 15:03:30 2016 +0000

Updated from global requirements

Change-Id: Icb27945b3f222af1d9ab2b62bf2169d82b6ae26c

commit b970ed5bdac60c0fa227f2fddaa9b842ba4f51a7

Author: Kevin Benton <email address hidden>

Date: Fri Apr 8 17:52:14 2016 -0700

Clear DVR MAC on last agent deletion from host

Once all agents are deleted from a host, the DVR MAC generated

    for that host should be deleted as well to prevent a buildup of

    pointless flows generated in the OVS agent for hosts that don't

    exist.

Closes-Bug: #1568206

    Change-Id: I51e736aa0431980a595ecf810f148ca62d990d20

    (cherry picked from commit 92527c2de2afaf4862fddc101143e4d02858924d)

commit eee9e58ed258a48c69effef121f55fdaa5b68bd6

Author: Mike Bayer <email address hidden>

Date: Tue Feb 9 13:10:57 2016 -0500

Add an option for WSGI pool size

Neutron currently hardcodes the number of

    greenlets used to process requests in a process to 1000.

    As detailed in

    <http://lists.openstack.org/pipermail/openstack-dev/2015-December/082717.html>

this can cause requests to wait within one process

    for available database connection while other processes

    remain available.

By adding a wsgi\_default\_pool\_size option functionally

    identical to that of Nova, we can lower the number of

    greenlets per process to be more in line with a typical

    max database connection pool size.

DocImpact: a previously unused configuration value

               wsgi\_default\_pool\_size is now used to a...

Reviewed: https://review.openstack.org/314250
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=3bf73801df169de40d365e6240e045266392ca63
Submitter: Jenkins
Branch: master
commit a323769143001d67fd1b3b4ba294e59accd09e0e
Author: Ryan Moats <rmoats@us.ibm.com>
Date: Tue Oct 20 15:51:37 2015 +0000
Revert "Improve performance of ensure\_namespace"
This reverts commit 81823e86328e62850a89aef9f0b609bfc0a6dacd.
Unneeded optimization: this commit only improves execution
time on the order of milliseconds, which is less than 1% of
the total router update execution time at the network node.
This also
Closes-bug: #1574881
Change-Id: Icbcdf4725ba7d2e743bb6761c9799ae436bd953b
commit 7fcf0253246832300f13b0aa4cea397215700572
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Thu Apr 21 07:05:16 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9e930750dde85a9beb0b6f85eeea8a0962d3e020
commit 643b4431606421b09d05eb0ccde130adbf88df64
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Apr 19 06:52:48 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I52d7460b3265b5460b9089e1cc58624640dc7230
commit 1ffea42ccdc14b7a6162c1895bd8f2aae48d5dae
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Mon Apr 18 15:03:30 2016 +0000
Updated from global requirements
Change-Id: Icb27945b3f222af1d9ab2b62bf2169d82b6ae26c
commit b970ed5bdac60c0fa227f2fddaa9b842ba4f51a7
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Apr 8 17:52:14 2016 -0700
Clear DVR MAC on last agent deletion from host
Once all agents are deleted from a host, the DVR MAC generated
for that host should be deleted as well to prevent a buildup of
pointless flows generated in the OVS agent for hosts that don't
exist.
Closes-Bug: #1568206
Change-Id: I51e736aa0431980a595ecf810f148ca62d990d20
(cherry picked from commit 92527c2de2afaf4862fddc101143e4d02858924d)
commit eee9e58ed258a48c69effef121f55fdaa5b68bd6
Author: Mike Bayer <mike\_mp@zzzcomputing.com>
Date: Tue Feb 9 13:10:57 2016 -0500
Add an option for WSGI pool size
Neutron currently hardcodes the number of
greenlets used to process requests in a process to 1000.
As detailed in
http://lists.openstack.org/pipermail/openstack-dev/2015-December/082717.html
this can cause requests to wait within one process
for available database connection while other processes
remain available.
By adding a wsgi\_default\_pool\_size option functionally
identical to that of Nova, we can lower the number of
greenlets per process to be more in line with a typical
max database connection pool size.
DocImpact: a previously unused configuration value
wsgi\_default\_pool\_size is now used to affect
the number of greenlets used by the server. The
default number of greenlets also changes from 1000
to 100.
Change-Id: I94cd2f9262e0f330cf006b40bb3c0071086e5d71
(cherry picked from commit 9d573387f1e33ce85269d3ed9be501717eed4807)
commit bf66cc6f74133cfe6c1ab75287d39814ac44b068
Author: Clayton O'Neill <clayton.oneill@twcable.com>
Date: Thu Mar 24 15:28:21 2016 +0000
Don't disconnect br-int from phys br if connected
When starting up, we don't want to delete the patch port between br-int
and the physical bridges. In liberty the br-int bridge was changed to
not tear down flows on startup, and change
I9801b76829021c9a0e6358982e1136637634a521 will change the physical
bridges to not tear down flows also.
Without this patch the patch port is torn down and not reinstalled until
after the initial flows are set back up.
Partial-Bug: #1514056
Change-Id: I05bf5105a6f3acf6a313ce6799648a095cf8ec96
(cherry picked from commit a549f30fad93508bf9dfdcfb20cd522f7add27b0)
commit 93795a4bda47605d5616476b2a456772308aa3c3
Author: Kevin Benton <kevin@benton.pub>
Date: Mon Mar 28 14:14:15 2016 -0700
Fix deprecation warning for external\_network\_bridge
We only want this to warn when a deployer has set anything other
than a blank string. The olso cfg would warn whenever it was set
so it was incorrectly warning on the value we want operators to
set it to.
This changes the cfg option to not use deprecated for removal and
the L3 agent config validation to emit a warning if its not set
to the value we are suggesting.
Change-Id: If533cf7c4c379be78f5a15073accaff7f65973ab
Closes-Bug: #1563070
(cherry picked from 8382ac3717cf646145379456af94ce75000349a9)
commit 36305c0c4f4ebf498020f5956e103832da75f8a9
Author: Kevin Benton <kevin@benton.pub>
Date: Thu Feb 18 03:48:29 2016 -0800
Add ALLOCATING state to routers
This patch adds a new ALLOCATING status to routers
to indicate that the routers are still being built on the
Neutron server. Any routers in this state are excluded in
router retrievals by the L3 agent since they are not yet
ready to be wired up.
This is necessary when a router is made up of several
distinct Neutron resources that cannot all be put
into a single transaction. This patch applies this new
state to HA routers while their internal HA ports and
networks are being created/deleted so the L3 HA agent
will never retrieve a partially formed HA router. It's
important to note that the ALLOCATING status carries over
until after the scheduling is done, which ensures that
routers that weren't fully scheduled will not be sent to
the agents.
An HA router is placed in this state only when it is being
created or converted to/from the HA state since this is
disruptive to the dataplane.
This patch also reverts the changes introduced in
Iadb5a69d4cbc2515fb112867c525676cadea002b since they will
be handled by the ALLOCATING logic instead.
Co-Authored-By: Ann Kamyshnikova <akamyshnikova@mirantis.com>
Co-Authored-By: John Schwarz <jschwarz@redhat.com>
APIImpact
Closes-Bug: #1550886
Related-bug: #1499647
Change-Id: I22ff5a5a74527366da8f82982232d4e70e455570
(cherry picked from commit 9c3c19f07ce52e139d431aec54341c38a183f0b7)
commit 07401352a964b92ef4bc09a09800554e4a84cc87
Author: Hynek Mlnarik <hmlnarik@redhat.com>
Date: Thu Feb 25 11:34:15 2016 +0100
Cleanup stale OVS flows for physical bridges
Perform deletion of the stale flows in physical bridges consistently with
br-int and br-tun, respecting drop\_flows\_on\_start configuration option.
Added tests for auxiliary bridge and functional tests for the physical
bridge using VLAN/flat external network. Fixes part of the bug 1514056;
together with [1] and [2], the bug should be considered fixed.
The commit also fixes inconsistency between netmask of allocated IP
addresses assigned in \_create\_test\_port\_dict and ip\_len in \_plug\_ports
of base.py.
[1] https://review.openstack.org/#/c/297211/
[2] https://review.openstack.org/#/c/297818/
Co-Authored-By: Jian Wen <wenjianhn@gmail.com>
Partial-Bug: 1514056
Change-Id: I9801b76829021c9a0e6358982e1136637634a521
(cherry picked from commit cacde308eef6f1d7005e555b4521332da95d3cf4)
commit 05a4a34b7e46c2e13a9bd874674804a94f342d0c
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Thu Apr 7 16:45:52 2016 +0300
Notify resource\_versions from agents only when needed
resource\_versions were included into agent state reports recently to
support rolling upgrades (commit 97a272a892fcf488949eeec4959156618caccae8)
The downside is that it brought additional processing when handling state
reports on server side: update of local resources versions cache and
more seriously rpc casts to all other servers to do the same.
All this led to a visible performance degradation at scale with hundreds
of agents constantly sending reports. Under load (rally test) agents
may start "blinking" which makes cluster very unstable.
In fact there is no need to send and update resource\_versions in each state
report. I see two cases when it should be done:
1) agent was restarted (after it was upgraded);
2) agent revived - which means that server was not receiving or being able
to process state reports for some time (agent\_down\_time). During that
time agent might be upgraded and restarted.
So this patch makes agents include resource\_versions info only on startup.
After agent revival server itself will update version\_manager with
resource\_versions taken from agent DB record - this is to avoid
version\_manager being outdated.
Closes-Bug: #1567497
Change-Id: I47a9869801f4e8f8af2a656749166b6fb49bcd3b
(cherry picked from commit e532ee3fccd0820f9ab0efc417ee787fb8c870e9)
commit 07fa3725c5a7fc68a41ed8af53ca2d3aad4c35b9
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Tue Apr 5 16:18:03 2016 +0300
ADDRESS\_SCOPE\_MARK\_IDS should not be global for L3 agent
Otherwise agent becomes unable to handle more than 1024 routers
(including deleted routers) and starts failing.
It should be enough to distinguish address scopes inside router namespace,
so this patch moves ADDRESS\_SCOPE\_MARK\_IDS set to the RouterInfo class.
Closes-Bug: #1566291
Change-Id: I1e43bb3e68db4db93cc1dfc1383af0311bfb0f2d
(cherry picked from commit 1cb43734808eded87210d2957d56b70c514d55c3)
commit 9c58ae6a70125497a39612f71c53c60a8b35968e
Author: Eugene Nikanorov <enikanorov@mirantis.com>
Date: Wed Mar 30 08:36:58 2016 -0700
Wrap all update/delete l3\_rpc handlers with retries
This is needed for mysql galera multimaster backends.
Closes-Bug: #1564144
Change-Id: Ia5a14d5ee91c6672d61904f669e9e845a7f262c9
(cherry picked from commit d8f0ee5ecd67ee6ec956c7fdadce3c2a8e8301bf)
commit fff909e899eb06ca2ba1b9219df8525db0980fdd
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Thu Apr 7 19:27:38 2016 +0300
Values for [ml2]/physical\_network\_mtus should not be unique
Obviously there could be physical networks with same MTU.
The patch sets unique\_values to False when parsing physical\_network\_mtus
Unit test added.
Closes-Bug: #1567502
Change-Id: I46e5b5d3f7033a974fca40342af6dff7c71a9a4a
(cherry picked from commit 5cdd7ae574312a7499a8768c1752d9bc27ff7d20)
commit ece192b056c36568238abaf763b0ea9f99877c4c
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Fri Apr 1 19:40:20 2016 +0300
Use new DB context when checking if agent is online during rescheduling
Commit 9ec466cd42de94c2fad091edfd7583a5f47eb87a was not enough
since it checked l3 agents in the same transaction that was used
to fetch down bindings - so agents always were down even if actually
they went back online.
This commit adds context creation on each iteration to make sure
we use new transaction and fetch up-to-date info for the agent.
Closes-Bug: #1522436
Change-Id: I12a4e4f4e0c2042f0c0bf7eead42baca7b87a22b
(cherry picked from commit 70068992e37c80e9aa8e70f017aa35132d7e5aee)
commit 2e2d75cbc2be356e962793db42905cecf28730d8
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Thu Apr 7 10:09:13 2016 +0000
ovsfw: Load vlan tag from other\_config
OVS agent stores vlan tag only to other\_config before
setup\_port\_filter() is called [1], leaving 'tag' column empty. This
patch loads tag from correct place and modifies functional tests
accordingly.
Closes-Bug: 1566934
[1] https://github.com/openstack/neutron/blob/1efed3a5321a259d27ec4a6e80352d35fc423c11/neutron/plugins/ml2/drivers/openvswitch/agent/ovs\_neutron\_agent.py#L821
Change-Id: Iaae46ce7362fedfc53af958600d6d712eb382e9f
(cherry picked from commit dabd969090d35ec218d348f170edbef58163a79d)
commit 681441137b8590620c6a1f35ab5931edb22d7a31
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Mon Apr 11 06:27:57 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ia032d91e89bd78e16412b9bc7f60f466c61a16e5
commit a2d1c46fe7952abc392d91ef3d00d203e0f38a4c
Author: Ihar Hrachyshka <ihrachys@redhat.com>
Date: Thu Mar 24 16:16:17 2016 +0100
firewall: don't warn about a driver that does not accept bridge
Drivers that do not need the bridge parameter are safe to ignore it.
Actually, the base abstract interface for those drivers does not allow
to pass the new parameter.
Ideally, the base class \_\_init\_\_ signature would change to accept the
argument, but we can't do it without breaking API.
So instead, just handle both types of drivers - those that accept the
additional argument, and those that don't. And don't assume the latter
are somehow wrong.
Change-Id: Iceee46f63669b28e3a34d207216d864f1bfa5cf8
Closes-Bug: #1561243
(cherry picked from commit 193aa35325b897b960de88b510181b377e4c345c)
commit fa5eb530bb71c1b1fe1020802a63b05907695011
Author: Kevin Benton <kevin@benton.pub>
Date: Wed Mar 16 01:35:26 2016 -0700
Add uselist=True to subnet rbac\_entries relationship
Because the join conditions for Subnet rbac entries
are manually specified, SQLAlchemy is not
automatically detecting that this relationship is a list.
This adds the uselist=True kwarg to the relationship to
ensure that it's always handled as a list.
Change-Id: Ia4ae57ddd932260691584ae74c0305a79b2e60a9
Closes-Bug: #1557959
(cherry picked from commit 691f8f5ea54c04bfdfb76e25bda14665b05ed859)
commit 5853af9cba6733725d6c9ac0db644f426713f0cf
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)
commit c178bd9565ae699a79a8f13e89d1f8717a765cc1
Author: Armando Migliaccio <armamig@gmail.com>
Date: Wed Mar 30 14:24:58 2016 -0700
Fix race conditions in IP availability API tests
DHCP port creation is asynchronous with subnet creation.
Therefore there is a time window where, depending on how fast
the DHCP agent honors the request, the DHCP port IP allocation
may or may not be accounted for in the total number of used IP
for the network. To kill the race, do not run dhcp on the
created subnets at all.
Closes-bug: 1563883
Change-Id: Idda25e65d04852d68a3c160cc9deefdb4ee82dcd
(cherry picked from commit 27634bb2ba2637d694c7d0aa5758173d12ef579a)
commit ee32ea5e2bf2b01104c5bde6b6a5018dd0e15f57
Author: Ihar Hrachyshka <ihrachys@redhat.com>
Date: Thu Apr 7 19:15:01 2016 +0200
Switched from fixtures to mock to mock out starting RPC consumers
fixtures 2.0.0 broke us wildly, so instead of trying to make it work
with new fixtures, I better just switch the mock to... mock.
Change-Id: I58d7a750e263e4af54589ace07ac00bec34b553a
Closes-Bug: #1567295
(cherry picked from commit 2af86b8f6f749bf7b42a2c04b48c9a2dc28a46c9)
commit 77696d8529c7310e343722d809ab2e63bd8946f9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Fri Apr 8 06:36:58 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2f2ef73e04e007e9b450d51a72ee60e1ec788518
commit 3190494c0dfc9762d874399276327f096ce4bd92
Author: Armando Migliaccio <armamig@gmail.com>
Date: Fri Apr 1 13:38:06 2016 -0700
Fix zuul\_cloner errors during tox job setup
Since [1], Tempest is a pip installable package, and that prevents zuul\_cloner
to work correctly. This change moves away from the existing logic in tox\_install,
and adds tempest as an explicit requirement for the api job. This is in fact
the only tox target that needs Tempest to work.
tox\_install.sh has become less important now, but cleanup is left as follow
up, to speed up gate salvation.
[1] I25eac915c977ebaedced66ac896c5dd77259d193
Change-Id: I00d882dde77a687ecb57ec200a34fd96256ad87a
(cherry picked from commit 8a6913c534e39e93640ed99c67e66763a9d1da3c)
commit 9679285f547b301a511e02ebc763b5406fb03ffc
Author: Jamie Lennox <jamielennox@gmail.com>
Date: Tue Mar 15 10:05:29 2016 +1100
Return oslo\_config Opts to config generator
We shouldn't be returning keystoneauth Opts to the oslo\_config
generator. Whilst it mostly works these objects are not interchangable
and it can result in problems. You can see this by entries such as:
# Warning: Failed to format sample for tenant\_name
# isinstance() arg 2 must be a class, type, or tuple of classes
and types
in the currently generated config files.
Keystoneauth provides a function that returns oslo\_config options so
fetch, process and return those instead.
Change-Id: Ie3fad2381467b19189cbb332c41cea8b6cf6e264
Closes-Bug: #1548433
(cherry picked from commit c3db0707eff70f381913643891ba4e148977407d)
commit 04fb1476de3b9d81ad579586c7010b5cdd2248a2
Author: Hynek Mlnarik <hmlnarik@redhat.com>
Date: Wed Mar 30 10:44:09 2016 +0200
Refactor and fix dummy process fixture
Extracting the test fixture that creates a new process and leaves it
running for a given amount of time into helpers where other fixtures for
functional tests live. This both keeps the fixtures at one place and
increases visibility of the fixture so that it can be reused in other
tests. At the same time, the fixture is fixed as the original code
omitted starting the process.
Change-Id: I97aeb8d1d5773ef3d59e8f908aea34ccceb38378
Related-Bug: 1561046
(cherry picked from commit 2690eed19a749fb1b50bb38f3d01fce0f1497f39)
commit 844cae4960cb2e3aedad750ceb91aa675f8e1142
Author: Dmitry Sutyagin <dsutyagin@mirantis.com>
Date: Fri Feb 12 12:18:14 2016 +0300
Switches metering agent to stateless iptables
If state\_less parameter is not specified then
neutron-postrouting-bottom rule goes up in POSTROUTING
chain, which causes premature NATing of traffic,
for ex. traffic between internal networks becomes NATed.
Closes-Bug: 1544508
Co-Authored-By: Sergey Belous <sbelous@mirantis.com>
Change-Id: I2e0011237d50a59d417cfee01dcd5f9d0da2e7f5
(cherry picked from commit 5d2d1120fcdcd5977d3c760ac1520a841048d456)
commit 19ea6ba92379168e1bfff7a7235119cfbbc0172c
Author: Hynek Mlnarik <hmlnarik@redhat.com>
Date: Wed Mar 23 14:51:59 2016 +0100
Remove obsolete keepalived PID files before start
keepalived refuses to start and claims "daemon already started"
when there is already a process with the same PID as found in
either the VRRP or the main process PID file. This happens even
in case when the new process is not keepalived. The situation
can happen when the neutron node is reset and the obsolete PID
files are not cleaned before neutron is started.
This commit adds PID file cleanup before keepalived start.
Closes-Bug: 1561046
Change-Id: Ib6b6f2fe76fe82253f195c9eab6b243d9eb76fa2
(cherry picked from commit e98fabb5836b12bc40a2b64a2668893ea73c2320)
commit aafa702d2f389c0a4f3679df65be07940095ec29
Author: Kevin Benton <kevin@benton.pub>
Date: Sun Mar 13 20:52:09 2016 -0700
Add IPAllocation object to session info to stop GC
This adds the IPAllocation object created in the \_store\_ip\_allocation
method to the session info dictionary to prevent it from being
immediately garbage collected. This is necessary because otherwise a
new persistent object will be created when the fixed\_ips relationship
is referenced during the rest of the port create/update opertions.
This persistent object will then interfere with a retry operation
that uses the same session if it tries to create a conflicting record.
By preventing the object from being garbage collected, the reference
to fixed IPs will re-use the newly created sqlalchemy object instead
which will properly be cleaned up on a rollback.
This also removes the 'passive\_delete' option from the fixed\_ips
relationship on ports because IPAllocation objects would now be
left in the session after port deletes. At first glance, this might
look like a performance penalty because fixed\_ips would be looked
up before port deletes; however, we already do that in the IPAM
code as well as the ML2 code so this relationship is already being
loaded on the delete\_port operation.
Closes-Bug: #1556178
Change-Id: Ieee1343bb90cf111c55e00b9cabc27943b46c350
(cherry picked from commit 7d9169967fca3d81076cf60eb772f4506735a218)
commit 005d49d2f092039660a44896217a5c245dcc4685
Author: Vincent Untz <vuntz@suse.com>
Date: Tue Nov 17 17:47:56 2015 +0100
Ensure metadata agent doesn't use SSL for UNIX socket
The communication between the ns metadata proxy and the metadata agent
is pure HTTP, and should not switch to HTTPS when neutron is using SSL.
We're therefore telling wsgi.Server to forcefully disable SSL in that
case.
Change-Id: I2cb9fa231193bcd5c721c4d5cf0eb9c16e842349
Closes-Bug: #1514424
(cherry picked from commit 7a306e2918775ebb94d9e1408aaa2b7c3ed26fc6)
commit 905fd05f966e0c7d3851f59665e58746c50bad1e
Author: Swaminathan Vasudevan <swaminathan.vasudevan@hpe.com>
Date: Fri Mar 25 12:38:13 2016 -0700
DVR: Increase the link-local address pair range
The current dvr\_fip\_ns.py file has FIP\_LL\_SUBNET configured
with a subnet prefixlen of /23 which only allows 255 pairs of
link-local addresses to be generated. If the number of routers
per-node increases beyond the 255 limit it raises an assertion.
This patch increases the link-local address cidr to be a /18
to allow for 8K routers. The new range was chosen to not
overlap with the original, allowing for in-place upgrades
without affecting existing routers.
Closes-Bug: #1562110
Change-Id: I6e11622ea9cc74b1d2428757f16aa0de504ac31a
(cherry picked from commit 7b1b8c2de57457c2ec1ed784165a3e10e24151cf)
commit 93d719a554d9b179636afccd25e1018b6e5d1cc3
Author: Sreekumar S <sreesiv@gmail.com>
Date: Fri Jan 22 19:09:49 2016 +0530
SG protocol validation to allow numbers or names
SG rule protocol provided is validated against the DB rules'
protocols for both number and name. The filter provided to DB
is modified so that it is queried for records with both the
protocol name and number, instead of exactly the type provided
with the input. The returned DB rule record's protocol field is
validated against the supplied SG protocol field for both name
or number.
This way, user is still allowed to enter protocol name or number
to create a rule, and API compatibility is maintained.
Closes-Bug: #1215181
(cherry picked from commit 913a64cc1175b3bd7efc7abe34895c32bf39a696)
Also squashed the following regression fix:
===
Don't drop 'protocol' from client supplied security\_group\_rule dict
If protocol was present in the dict, but was None, then it was never
re-instantiated after being popped out of the dict. This later resulted
in KeyError when trying to access the key on the dict.
Change-Id: I4985e7b54117bee3241d7365cb438197a09b9b86
Closes-Bug: #1566327
(cherry picked from commit 5a41caa47a080fdbc1801e2771163734b9790c57)
===
Change-Id: If4ad684e961433b8d9d3ec8fe2810585d3f6a093
commit 33d3b8ce76d942950e2f999a6040787483adf729
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Apr 1 02:42:54 2016 -0700
L3 agent: match format used by iptables
This fixes the iptables rules generated by the L3 agent
(SNAT, DNAT, set-mark and metadata), and the DHCP agent
(checksum-fill) to match the format that will be returned
by iptables-save to prevent excessive extra replacement
work done by the iptables manager.
It also fixes the iptables test that was not passing the
expected arguments (-p PROTO -m PROTO) for block rules.
A simple test was added to the L3 agent to ensure that the
rules have converged during the normal lifecycle tests.
Closes-Bug: #1566007
Change-Id: I5e8e27cdbf0d0448011881614671efe53bb1b6a1
(cherry picked from commit b8d520ffe2afbffe26b554bff55165531e36e758)
commit 7b2fcaa1734bc1f26a1c4c2f0ace6fedbaa171e2
Author: Armando Migliaccio <armamig@gmail.com>
Date: Fri Apr 1 18:02:47 2016 -0700
Use right class method in IP availability tests
This should have been skip\_checks. Spotted when dealing with
fix for bug 1563883, argh.
Change-Id: If609c285c2363967aba91a8ae1560d99391654d9
Related-bug: 1563883
(cherry picked from commit 2b0ce0ba8bf6abeb62654a00c12cfaad89f86e7c)
commit 93cdf8eb559cf78895200b3ec6775afe60b6c638
Author: Kevin Benton <kevin@benton.pub>
Date: Sun Feb 21 21:31:59 2016 -0800
Make L3 HA interface creation concurrency safe
This patch creates a function to handle the creation of the
L3HA interfaces for a router in a manner that handles the
HA network not existing or an existing one being deleted
by another worker before the interfaces could be created.
Closes-Bug: #1548285
Change-Id: Ibac0c366362aa76615e448fbe11d6d6b031732fe
(cherry-picked from commit 7512d8aa26a945a695e889e0a97c6414cec6ac10)
commit d93466923f3b5627c55510f9bc7229a7b584b430
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Fri Apr 1 14:53:03 2016 +0000
ovsfw: Remove vlan tag before injecting packets to port
Open vSwitch takes care of vlan tagging in case normal switching is
used. When ingress traffic packets are accepted, the
actions=output:<port\_number> is used but we need to explicitly take care
of stripping out the vlan tags.
Closes-Bug: 1564947
Change-Id: If3fc44c9fd1ac0f7bc9dfe9dc48e76352e981f8e
(cherry picked from commit 0f9ec7b72a8ca173b760f20323f90bffefa91681)
commit 33c01f4d49a4561bac56831483ac22c4a4b3f47d
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Apr 5 06:48:18 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ief6281fde6ab1f72b26bfb11528fc64c71b407b9
commit 05ac0125fe861fbfb09d48eec97a29539b51b4e2
Author: YAMAMOTO Takashi <yamamoto@midokura.com>
Date: Fri Mar 25 15:22:46 2016 +0900
test\_network\_ip\_availability: Skip IPv6 tests when configured so
Use a class attribute known by the base class so that IPv6 tests
are skipped appropriately when CONF.network\_feature\_enabled.ipv6
is False.
Closes-Bug: #1561857
Change-Id: I93f76b7f7cd94ff484d2e4507500af97578ac71a
(cherry picked from commit 61a5bcb52e23fa39839c30cb4f13f8a26e115516)
commit 38894cc7603f90ed8a5938e37fcc773c926fbfe4
Author: Eugene Nikanorov <enikanorov@mirantis.com>
Date: Mon Mar 21 20:05:47 2016 -0700
Retry updating agents table in case of deadlock
Updating agents table is contantious operation which
can fail often if mysql backend is in multimaster mode.
This could lead to agents flapping and various issues
such as sporadic reschedluing, port binding failures, etc.
Change-Id: Ief392f9a09d86c185dc086055d2cbc1891ff1d7f
Closes-Bug: #1560724
(cherry picked from commit d5e4013556c7144d347ece267c4bd3c8dc87b24f)
commit aac460b0a7fec68fbb173ac8899274809e254a7a
Author: Vladimir Eremin <veremin@mirantis.com>
Date: Thu Mar 17 19:32:29 2016 +0300
Allow to use several nics for physnet with SR-IOV
Accordind specs and docs, SRIOV\_NIC.physical\_device\_mappings is not
limited to be a 1-1 mapping between physnets and NICs. However,
implementation requires this. This bugfix unlocks 1-M mappings, so one
physnet could be managed by many NICs.
\* introduced unique\_keys in neutron.utils.parse\_mappings
\* SRIOV\_NIC.physical\_device\_mappings is parsed as dict with lists as
values with parse\_mappings(..., unique\_keys=False)
DocImpact
Change-Id: I07b8682fdfe8389a35893cc662b87c94a00bd4a5
Closes-Bug: #1558626
(cherry picked from commit 46ddaf4288a1cac44d8afc0525b4ecb3ae2186a3)
commit 90b9cd334b1b33df933bf1b61b38c6e087c431af
Author: Ihar Hrachyshka <ihrachys@redhat.com>
Date: Thu Mar 17 16:20:52 2016 +0100
port security: gracefully handle resources with no bindings
Resources could be created before the extension was enabled in the
setup. In that case, no bindings are created for them. In that case, we
should gracefully return default (True) value when extracting the value
using the mixin; and we should also create binding model on update
request, if there is no existing binding model for the resource.
While at it, introduced a constant to store the default value for port
security (True) and changed several tests to use the constant instead of
extracting it from extension resource map.
Change-Id: I8607cdecdc16c5f94635c94e2f02700c732806eb
Closes-Bug: #1509312
(cherry picked from commit b0519cf0ada3b3d9b76f84948f9ad3c142fc50be)
commit 7174bc4c2a0a31e9036ec130cb65f91d1e5009a4
Author: venkata anil <anil.venkata@enovance.com>
Date: Wed Mar 23 15:24:01 2016 +0000
Ignore exception when deleting linux bridge if doesn't exist
Linux bridge is not handling RuntimeError exception when it is trying
to delete network's bridge, which is deleted in parallel by nova.
Fullstack test has similar scenario, it creates network's bridge for
agent and deletes the bridge after the test, like nova.
Linux bridge agent has to ignore RuntimeError exception if the bridge
doesn't exist.
Closes-bug: #1561040
Change-Id: I428384fd42181ff6bc33f29369a7ff5ec163b532
(cherry picked from commit 16b2ffdfd85eece8fb57a98d10bf35ad617d235a)
commit 93d29d131c0234075ac547906f77900ce47cceec
Author: Clayton O'Neill <clayton.oneill@twcable.com>
Date: Thu Mar 24 14:59:41 2016 +0000
Don't delete br-int to br-tun patch on startup
When starting up, we don't want to delete the patch port between br-int
and br-tun unless we're also dropping the flows.. In liberty both of
these bridges were switched to not dump flows on startup and to put the
bridges in secure mode so that default flood flows are not installed
when the bridge is created.
Without this patch the patch port is torn down and not reinstalled until
br-tun is setup again.
Partial-Bug: #1514056
Change-Id: Ia518a99a2de5d1bda467fde57892c43970f88bcd
(cherry picked from commit 8dce6a5c873c2c18e5a9c6165bf3974aead02588)
commit 211e0a65a0cf637ab58a20c91791b7eb6b8c8519
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Mon Feb 29 16:20:05 2016 +0100
functional: Update ref used from ovs branch-2.5.
OVS 2.5.0 has been released, but we need a later commit on branch-2.5 that
fixes compilation with the latest kernel on ubuntu that backported some
changes that broke compilation of 2.5.0.
Change-Id: Id70db79a8450d4f0125dd500f7f6ab8d103d98c3
(cherry picked from commit 59b36ecca8f60996a60cd52f816573ace9b39309)
commit e2676ae8d188286b76f802d605f363e21011841a
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 12:37:12 2016 -0700
DVR: rebind port if ofport changes
When binding is called in DVR, check to see if the port was
previously wired under a different ofport. If it was, first
unbind the old port and then bind the new one.
Change-Id: I372158c4a6986295e396d849a2c9c5372b271e08
Closes-Bug: #1562467
(cherry picked from commit 4731dbbef1f615b9ce6d18315e8ca9810e8a772d)
commit c6ef57a6d5f0397b1abf865815bd71d40292f482
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Wed Feb 24 16:34:07 2016 +0000
ovs-fw: Mark conntrack entries invalid if no rule is matched
This patch makes sure that existing connection breaks once security
group rule that allowed such connection is removed. Due to correctly
track connections on the same hypervisor, zones were changed from
per-port to per-network (based on port's vlan tag). This information is
now stored in register 6. Also there was added a test for RELATED
connections to avoid marking such connection as invalid by REPLY rules.
Closes-Bug: 1549370
Change-Id: Ibb5942a980ddd8f2dd7ac328e9559a80c05789bb
(cherry picked from commit 4f6aa3ffde2fd68b85bc5dfdaf6c2684931f3f61)
commit ef6ea62d5d1fc767a23e3caf2716e76f90d63f03
Author: Andreas Scheuring <andreas.scheuring@de.ibm.com>
Date: Wed Mar 9 13:56:22 2016 +0100
l3: Send notify on router\_create when ext gw is specified
A router that got created with an external gateway specified now
triggers a notfiy\_router\_updated event. This triggers scheduling
of the router and creation of the network namespace on the target
node.
Change-Id: I7f6ff5edf6a9c5ffa6d8978c1f3de0e106b6a8bb
Closes-Bug: #1535707
(cherry picked from commit da00d1a186c55c91887c9546e893f6d075a2c2ad)
commit eb8ddb95bbb56bbdc658e15feebbf7f91d5ddf13
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Tue Feb 16 18:03:52 2016 +0300
Move db query to fetch down bindings under try/except
In case of intermittent DB failures router and network auto-rescheduling
tasks may fail due to error on fetching down bindings from db.
Need to put this queries under try/except to prevent unexpected exit.
Closes-Bug: #1546110
Change-Id: Id48e899a5b3d906c6d1da4d03923bdda2681cd92
(cherry picked from commit b6ec40cbf754de9d189f843cbddfca67d4103ee3)
commit da1eee31057fb44ff758d99ac99eeb47b7caec6e
Author: Alex Oughton <alex.oughton@rackspace.com>
Date: Fri Mar 18 11:12:10 2016 -0500
Close XenAPI sessions in neutron-rootwrap-xen-dom0
Neutron with XenServer properly doesn't close XenAPI sessions.
If it creates these sessions so rapidly, the XenServer host eventually
exceeds its maximum allowed number of connections.
This patch adds a close process for session.
Closes-Bug: 1558721
Change-Id: Ida90a970c649745c492c28c41c4a151e4d940aa6
(cherry picked from commit 9d21b5ad7edbf9ac1fd9254e97f56966f25de8e6)
commit 1d51172babab64176716e723ae84f20e751a2ac3
Author: Kevin Benton <kevin@benton.pub>
Date: Thu Mar 17 05:19:19 2016 -0700
Watch for 'new' events in ovsdb monitor for ofport
This adjusts the event handling logic in the ovs interface
monitor to watch for 'new' events as well because this is
when ofports are assigned to the interface. Previously we
were only watching for 'insert' events, which would never
include the ofport so this led to every port being skipped
initially by the OVS agent and then picked up on the next
polling interval.
Closes-Bug: #1560464
Change-Id: I46ac508a839c6db779323d5afb083f3425f96e87
(cherry picked from commit 62e88623d977d28c113a1e29458621f82d48f6e5)
commit bd3e9c3b1e759d4296cdb9a816a63ef773ea5f63
Author: Stephen Eilert <stephen.eilert@hpe.com>
Date: Tue Mar 15 13:54:23 2016 -0700
Removes host file contents from DHCP agent logs
The change I3ad7864eeb2f959549ed356a1e34fa18804395cc addressed a
performance impact by removing logging calls from inside the loop that
creates the hosts file in memory. However, it also introduced the
dumping of said hosts file to the logs.
On deployments with a very high number of ports(>5K), this increases the
load of the node substantially. The problem is worse when a high number
of port updates is received in a short amount of time.
There is also the administrative burden caused by the sheer amount of
data being logged.
If the content of the host file is required for debugging purposes, it
can be found at /opt/stack/data/neutron/dhcp/<net-id>/host
This patch is trivial and only removes the logging of the file contents.
The 'building'/'done building' logging calls may still provide useful
information.
Change-Id: Ie176ef123c194c22dca0967a6acfb9a48c959e6c
Closes-Bug: 1557640
(cherry picked from commit ed7411fa1c4d6a26cea3a8737b3c29ce6ff64363)

[Ihar Hrachyshka (ihar-hrachyshka)](https://launchpad.net/~ihar-hrachyshka)
on 2016-05-27

| **tags**: | added: neutron-proactive-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2016-06-01:  [**Fix included in openstack/neutron 8.1.1**](/neutron/%2Bbug/1558658/comments/56) |  |  | [#56](/neutron/%2Bbug/1558658/comments/56) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 8.1.1 release.

This issue was fixed in the openstack/neutron 8.1.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2016-06-01:  [**Fix included in openstack/neutron 7.1.0**](/neutron/%2Bbug/1558658/comments/57) |  |  | [#57](/neutron/%2Bbug/1558658/comments/57) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 7.1.0 release.

This issue was fixed in the openstack/neutron 7.1.0 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-06-03:  [**Fix included in openstack/neutron 9.0.0.0b1**](/neutron/%2Bbug/1558658/comments/58) |  |  | [#58](/neutron/%2Bbug/1558658/comments/58) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 9.0.0.0b1 development milestone.

This issue was fixed in the openstack/neutron 9.0.0.0b1 development milestone.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-10

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-13

| **summary**: | Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests+ (CVE-2016-5362 and CVE-2016-5363) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-06-14:  [**Related fix merged to ossa (master)**](/neutron/%2Bbug/1558658/comments/59) |  |  | [#59](/neutron/%2Bbug/1558658/comments/59) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/301977>

Committed: <https://git.openstack.org/cgit/openstack/ossa/commit/?id=756540a726aa7309fcd7916c5f22ede66badeb1e>

Submitter: Jenkins

Branch: master

commit 756540a726aa7309fcd7916c5f22ede66badeb1e

Author: Tristan Cacqueray <email address hidden>

Date: Tue Apr 5 19:41:31 2016 -0400

Adds OSSA 2016-009 (CVE-2016-5362, CVE-2016-5363 and CVE-2015-8914)

Change-Id: Iad029108209fc631da286c777e8485106cea7f53

    Related-Bug: #1502933

    Related-Bug: #1558658

Reviewed: https://review.openstack.org/301977
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=756540a726aa7309fcd7916c5f22ede66badeb1e
Submitter: Jenkins
Branch: master
commit 756540a726aa7309fcd7916c5f22ede66badeb1e
Author: Tristan Cacqueray <tdecacqu@redhat.com>
Date: Tue Apr 5 19:41:31 2016 -0400
Adds OSSA 2016-009 (CVE-2016-5362, CVE-2016-5363 and CVE-2015-8914)
Change-Id: Iad029108209fc631da286c777e8485106cea7f53
Related-Bug: #1502933
Related-Bug: #1558658

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-14

| **summary**: | - Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests- (CVE-2016-5362 and CVE-2016-5363)+ [OSSA-2016-009] Security Groups do not prevent MAC and/or IPv4 spoofing+ in DHCP requests (CVE-2016-5362 and CVE-2016-5363) |
| --- | --- |
| Changed in ossa: | |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-07-05:  [**Change abandoned on neutron (master)**](/neutron/%2Bbug/1558658/comments/60) |  |  | [#60](/neutron/%2Bbug/1558658/comments/60) |
| --- | --- | --- | --- |

Change abandoned by Armando Migliaccio (<email address hidden>) on branch: master

Review: <https://review.openstack.org/315828>

Reason: This review is > 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.

Change abandoned by Armando Migliaccio (armamig@gmail.com) on branch: master
Review: https://review.openstack.org/315828
Reason: This review is > 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.

[Ihar Hrachyshka (ihar-hrachyshka)](https://launchpad.net/~ihar-hrachyshka)
on 2016-10-07

| **tags**: | removed: neutron-proactive-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-11-10:  [**Fix included in openstack/neutron 2015.1.4**](/neutron/%2Bbug/1558658/comments/61) |  |  | [#61](/neutron/%2Bbug/1558658/comments/61) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 2015.1.4 release.

This issue was fixed in the openstack/neutron 2015.1.4 release.

[Slavik Anikeyev (androidsmg8)](https://launchpad.net/~androidsmg8)
on 2018-07-23

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Vyacheslav Anikeyev (slavik1991) |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2018-07-24

| Changed in ossa: | |
| --- | --- |
| **assignee**: | Vyacheslav Anikeyev (slavik1991) → nobody |

[See full activity log](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/neutron/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1558674](https://bugs.launchpad.net/neutron/%2Bbug/1558674 "Security Groups do not prevent MAC spoofing with non-IP traffic")

You are
[not directly subscribed to this bug's notifications.](/neutron/%2Bbug/1558658/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [bug\_1558658.patch](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Battachment/4611129/%2Bfiles/bug_1558658.patch)
  [Edit](/neutron/%2Bbug/1558658/%2Battachment/4611129 "Change patch details")

* [Add patch](/neutron/%2Bbug/1558658/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.redhat.com_854214e8_20250126_124730.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.openwall.com_b7021d6f_20250125_232947.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](5) [[next>]](7) [[<thread-prev]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160610164327.253166C0780@smtpvmsrv1.mitre.org>
Date: Fri, 10 Jun 2016 12:43:27 -0400 (EDT)
From: cve-assign@...re.org
To: tdecacqu@...hat.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request for vulnerability in OpenStack Neutron

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> Title: Neutron IPTables firewall anti-spoof protection bypass

> independently reported vulnerabilities in Neutron
> anti-spoof protection. By forging DHCP discovery messages or non-IP
> traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source
> addresses on attached networks resulting in denial of services and/or
> traffic interception. Moreover when L2population isn't used, other
> tenants attached to a shared network are also vulnerable. Neutron
> setups using the IPTables firewall driver are affected.

> The dhcp fix has been included in the 8.0.0 release and this
> request probably needs more than one CVE.

>> [https://bugs.launchpad.net/neutron/+bug/1502933/comments/21](https://bugs.launchpad.net/neutron/%2Bbug/1502933/comments/21)

>> Just to be clear, the ICMPv6 source address spoof isn't addressed by
>> bug 1558658 patch (I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78).

>> Since both issues abuse the same fundamental flaw, it seems like a
>> good opportunity to bundle both fix in a single advisory.

>> However, because we need different patch, this will likely requires 2
>> different CVE numbers...

> <https://bugs.launchpad.net/bugs/1558658> (DHCP spoofing because the rule had only
>                                          -p udp -m udp --sport 68 --dport 67)

Use CVE-2016-5362.

> <https://bugs.launchpad.net/bugs/1558658> (MAC source address spoofing)

Use CVE-2016-5363.

> <https://bugs.launchpad.net/bugs/1502933> (ICMPv6 source address spoofing)

Use CVE-2015-8914.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXWuzyAAoJEHb/MwWLVhi2bBAQAKsmBq6+BILn7sflHZr1biSs
1bGOleiu+F947NAp5zzqjv9riowFneB7fCTPJ3uSXueCSNEyGFDIVPR80M7MWKdv
vtTUnLT8GLl9P2ZkvdYLaIW12UQq2OQF5nA0kuz8piVJx5Mx6M9rMypw83cKlIfw
iovaJMZuI6ZSsYmdm8RJiEyhRO+fyTXSYi/i7/6UqGUnZuBU4//KvkTqE3ZHWw6K
4HRaFIDVFljIHJpLgdIyLDBoMymxf7yYSvMVAX7f74drOLkQd+LyMYnLzR6dLCtc
sFR31f3f1v+lFSYTXdklEF/toSu6pNHauffcmxAWLpn3vOLJbzKpZZ2I23uDPQSZ
cOJ0ygs+ZbIXABaRsfBiU6bk0uiXvGqyifcFZnoayWPpCyN65qrdJlgMYBjhprVa
g1TEnJ7I+H/6FVTbvpdHo+m0YVS2oF3/Wy2B2FrpdCC43aTPYCzEWNmlQfl8MY39
aGdLugde8eOhWOJQugnqe94CxbAdcR2H/BTh28XaABhLdDwrnU6XSWY56pzcu1ys
ctYo8aPPsgHr9SC6c7noBfO3RMQGqkLOFakjjPGUmMHQ3Fz/Rz3pljVFZYwaQ8aS
BPvpQ2DtsHo9VSDt/t6srftFNWC2B91lbOj68aKm32rXq4rDuuNtS3pbmFpphjgv
WUQ3XjzlzzoHO3TR4PHY
=5QDQ
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugzilla.redhat.com_fc3415b7_20250126_124729.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1345891)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1345891)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1345891)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1345891

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1345891**](show_bug.cgi?id=1345891)
(CVE-2016-5363)
- [CVE-2016-5363](https://access.redhat.com/security/cve/CVE-2016-5363) openstack-neutron: MAC source address spoofing vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-5363 openstack-neutron: MAC source address spoofing vulnerability

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-5363 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1349669](show_bug.cgi?id=1349669 "CLOSED EOL - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [fedora-all]") [1349670](show_bug.cgi?id=1349670 "CLOSED ERRATA - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [openstack-rdo]") [1350648](show_bug.cgi?id=1350648) [1350649](show_bug.cgi?id=1350649) [1350650](show_bug.cgi?id=1350650) [1350651](show_bug.cgi?id=1350651) [1350652](show_bug.cgi?id=1350652) [1350653](show_bug.cgi?id=1350653) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1345893](show_bug.cgi?id=1345893) | | TreeView+ | [depends on](buglist.cgi?bug_id=1345891&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1345891&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-06-13 11:42 UTC by Andrej Nemec | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:51 UTC ([History](show_activity.cgi?id=1345891)) | | [CC List:](page.cgi?id=fields.html#cclist) | 25 users (show)  aathomas abaron amuller aortega apevec apevec ayoung chrisw cvsbot-xmlrpc ihrachys jlibosva jschluet kbasil lhh lpeer majopela markmc nyechiel rbryant rk sclewis srevivo tdecacqu tsuter twilson | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: | Neutron functionality includes internal firewall management between networks. Due to the relaxed nature of particular rules, it is possible for machines on the same layer 2 networks to forge non-IP traffic, such as ARP and DHCP requests. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-07-21 01:19:00 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:1473](https://access.redhat.com/errata/RHSA-2016%3A1473) | 0 | normal | SHIPPED\_LIVE | Low: openstack-neutron security and bug fix update | 2016-07-21 03:53:43 UTC | | Red Hat Product Errata | [RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474) | 0 | normal | SHIPPED\_LIVE | Low: openstack-neutron security, bug fix, and enhancement update | 2016-07-21 03:53:34 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1345891#c0)  Andrej Nemec    2016-06-13 11:42:43 UTC  ```  A vulnerability in Neutron anti-spoof protection. By forging DHCP discovery messages or non-IP traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.  Upstream bug:  <https://bugs.launchpad.net/bugs/1558658>  References:  <http://seclists.org/oss-sec/2016/q2/519>   ```  [Comment 1](show_bug.cgi?id=1345891#c1)  Garth Mollett    2016-06-23 23:48:52 UTC  ```  Created openstack-neutron tracking bugs for this issue:  Affects: fedora-all [[bug 1349669](show_bug.cgi?id=1349669 "CLOSED EOL - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [fedora-all]")] Affects: openstack-rdo [[bug 1349670](show_bug.cgi?id=1349670 "CLOSED ERRATA - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [openstack-rdo]")]   ```  [Comment 9](show_bug.cgi?id=1345891#c9)  errata-xmlrpc    2016-07-20 23:54:14 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 7.0 (Kilo) for RHEL 7  Via RHSA-2016:1474 [https://access.redhat.com/errata/RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474)   ```  [Comment 10](show_bug.cgi?id=1345891#c10)  errata-xmlrpc    2016-07-20 23:55:40 UTC  ``` This issue has been addressed in the following products:    Red Hat OpenStack Platform 8.0 (Liberty)  Via RHSA-2016:1473 [https://access.redhat.com/errata/RHSA-2016:1473](https://access.redhat.com/errata/RHSA-2016%3A1473)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1345891&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.redhat.com_2f6ae387_20250126_124725.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from security.openstack.org_df227380_20250125_232952.html ===


Toggle navigation

 Search

* [Software](https://www.openstack.org/software/)
  + [Overview](https://www.openstack.org/software/)
  + [OpenStack Components](https://www.openstack.org/software/project-navigator/openstack-components)
  + [SDKs](https://www.openstack.org/software/project-navigator/sdks)
  + [Deployment Tools](https://www.openstack.org/software/project-navigator/deployment-tools)
  + [OpenStack Map](https://www.openstack.org/assets/software/projectmap/openstack-map.pdf)
  + [Sample Configs](https://www.openstack.org/software/sample-configs/)
* [Use Cases](https://www.openstack.org/use-cases/)
  + [Users in Production](https://www.openstack.org/use-cases/)
  + [Ironic Bare Metal](https://www.openstack.org/use-cases/bare-metal/)
  + [Edge Computing](https://www.openstack.org/use-cases/edge-computing/)
  + [Telecom & NFV](https://www.openstack.org/use-cases/telecoms-and-nfv/)
  + [Science and HPC](https://www.openstack.org/use-cases/science/)
  + [Containers](https://www.openstack.org/use-cases/containers/)
  + [Enterprise](https://www.openstack.org/use-cases/enterprise/)
  + [User Survey](https://www.openstack.org/surveys/landing)
* [Events](https://openinfra.dev/summit)
  + [OpenInfra Summit](https://openinfra.dev/summit)
  + [Project Teams Gathering](https://www.openstack.org/ptg/)
  + [OpenDev](https://www.openstack.org/events/opendev-2020/)
  + [Community Events](https://www.openstack.org/events/community-events/)
  + [OpenStack & OpenInfra Days](https://www.openstack.org/events/openstackdays)
  + [Summit Videos](https://www.openstack.org/videos/)
* [Community](https://www.openstack.org/community/)
  + [Welcome! Start Here](https://www.openstack.org/community/)
  + [OpenStack Technical Committee](https://www.openstack.org/community/tech-committee)
  + [Speakers Bureau](https://www.openstack.org/community/speakers/)
  + [OpenStack Wiki](http://wiki.openstack.org)
  + [Get Certified (COA)](https://www.openstack.org/coa/)
  + [Jobs](https://www.openstack.org/community/jobs/)
  + [Marketing Resources](https://www.openstack.org/marketing/)
  + [Community News](https://www.openstack.org/news/)
  + [Superuser Magazine](http://superuser.openstack.org)
  + [OpenInfra Foundation Supporting Organizations](https://www.openstack.org/community/supporting-organizations/)
  + [OpenInfra Foundation](https://openinfra.dev)
* [Marketplace](https://www.openstack.org/marketplace/)
  + [Training](https://www.openstack.org/marketplace/training/)
  + [Distros & Appliances](https://www.openstack.org/marketplace/distros/)
  + [Public Clouds](https://www.openstack.org/marketplace/public-clouds/)
  + [Hosted Private Clouds](https://www.openstack.org/marketplace/hosted-private-clouds/)
  + [Remotely Managed Private Clouds](https://www.openstack.org/marketplace/remotely-managed-private-clouds/)
  + [Consulting & Integrators](https://www.openstack.org/marketplace/consulting/)
  + [Drivers](https://www.openstack.org/marketplace/drivers/)
* [Blog](https://www.openstack.org/blog/)
* [Docs](http://docs.openstack.org/)
* [Join](https://openinfra.dev/join/)
  + [Sign up for Foundation Membership](https://openinfra.dev/join/)
  + [Sponsor the Foundation](https://openinfra.dev/join/)
  + [More about the Foundation](https://openinfra.dev)
* [Log In](https://www.openstack.org/Security/login/?BackURL=/home/)

# OSSA-2016-009: Neutron IPTables firewall anti-spoof protection bypass

# OSSA-2016-009: Neutron IPTables firewall anti-spoof protection bypass[Â¶](#ossa-2016-009-neutron-iptables-firewall-anti-spoof-protection-bypass "Link to this heading")

Date:

June 14, 2016

CVE:

CVE-2016-5362 (DHCP spoofing),
CVE-2016-5363 (MAC source address spoofing),
CVE-2015-8914 (ICMPv6 source address spoofing)

## Affects[Â¶](#affects "Link to this heading")

* Neutron: <=7.0.4, >=8.0.0 <=8.1.0

## Description[Â¶](#description "Link to this heading")

Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box Group, Inc independently reported vulnerabilities in Neutron anti-spoof protection. By forging DHCP discovery messages or non-IP traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isnât used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

## Patches[Â¶](#patches "Link to this heading")

* <https://review.openstack.org/299025> (MAC) (Liberty)
* <https://review.openstack.org/303572> (DHCP) (Liberty)
* <https://review.openstack.org/310652> (ICMPv6) (Liberty)
* <https://review.openstack.org/299023> (MAC) (Mitaka)
* <https://review.openstack.org/303563> (DHCP) (Mitaka)
* <https://review.openstack.org/310648> (ICMPv6) (Mitaka)
* <https://review.openstack.org/299021> (MAC) (Newton)
* <https://review.openstack.org/300202> (DHCP) (Newton)
* <https://review.openstack.org/300233> (ICMPv6) (Newton)

## Credits[Â¶](#credits "Link to this heading")

* Romain Aviolat from Nagravision (CVE-2015-8914)
* Dustin Lundquist from Blue Box Group, Inc (CVE-2016-5362, CVE-2016-5363)

## References[Â¶](#references "Link to this heading")

* <https://bugs.launchpad.net/bugs/1502933> (ICMPv6)
* <https://bugs.launchpad.net/bugs/1558658> (MAC, DHCP)
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5362>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-5363>
* <http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8914>

this page last updated: 2025-01-07 18:17:35

[![Creative Commons Attribution 3.0 License](../_static/images/docs/license.png)](https://creativecommons.org/licenses/by/3.0/)

Except where otherwise noted, this document is licensed under
[Creative Commons
Attribution 3.0 License](https://creativecommons.org/licenses/by/3.0/). See all [OpenStack Legal Documents](https://www.openstack.org/legal).

found an error? report a bug

OpenStack Documentation

* Guides
* [Install Guides](https://docs.openstack.org/index.html#install-guides)
* [User Guides](https://docs.openstack.org/index.html#user-guides)
* [Configuration Guides](https://docs.openstack.org/index.html#configuration-guides)
* [Operations and Administration Guides](https://docs.openstack.org/index.html#ops-and-admin-guides)
* [API Guides](https://docs.openstack.org/index.html#api-guides)
* [Contributor Guides](https://docs.openstack.org/index.html#contributor-guides)
* Languages
* [Deutsch (German)](https://docs.openstack.org/de/)
* [FranÃ§ais (French)](https://docs.openstack.org/fr/)
* [Bahasa Indonesia (Indonesian)](https://docs.openstack.org/id/)
* [Italiano (Italian)](https://docs.openstack.org/it/)
* [æ¥æ¬èª (Japanese)](https://docs.openstack.org/ja/)
* [íêµ­ì´ (Korean)](https://docs.openstack.org/ko_KR/)
* [PortuguÃªs (Portuguese)](https://docs.openstack.org/pt_BR/)
* [TÃ¼rkÃ§e (TÃ¼rkiye)](https://docs.openstack.org/tr_TR/)
* [ç®ä½ä¸­æ (Simplified Chinese)](https://docs.openstack.org/zh_CN/)

#### Contents

* OSSA-2016-009: Neutron IPTables firewall anti-spoof protection bypass
  + [Affects](#affects)
  + [Description](#description)
  + [Patches](#patches)
  + [Credits](#credits)
  + [References](#references)

### OpenStack

* [Projects](https://www.openstack.org/software/project-navigator/)
* [OpenStack Security](https://security.openstack.org/)
* [Blog](https://openstack.org/blog/)
* [News](https://openstack.org/news/)

### Community

* [User Groups](https://www.meetup.com/pro/openinfradev/)
* [Events](https://openstack.org/community/events/)
* [Jobs](https://openstack.org/community/jobs/)
* [Companies](https://openinfra.dev/members/)
* [Contribute](https://docs.openstack.org/contributors)

### Documentation

* [OpenStack Manuals](https://docs.openstack.org)
* [Getting Started](https://openstack.org/software/start/)
* [API Documentation](https://developer.openstack.org)
* [Wiki](https://wiki.openstack.org)

### Branding & Legal

* [Legal Docs](https://openinfra.dev/legal)
* [Logos & Guidelines](https://openstack.org/brand/)
* [Trademark Policy](https://openinfra.dev/legal/trademark-policy)
* [Privacy Policy](https://openinfra.dev/privacy-policy)
* [OpenInfra CLA](https://docs.openstack.org/contributors/common/setup-gerrit.html#individual-contributor-license-agreement)

### Stay In Touch

The OpenStack project is provided under the
[Apache 2.0 license](https://www.apache.org/licenses/LICENSE-2.0). Docs.openstack.org is powered by
[Rackspace Cloud Computing](https://rackspace.com).



=== Content from bugs.launchpad.net_14c17cbd_20250126_124717.html ===

[Log in / Register](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Blogin)

[![](https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png)](https://launchpad.net/neutron)

## [neutron](https://launchpad.net/neutron)

* [Overview](https://launchpad.net/neutron)
* [Code](https://code.launchpad.net/neutron)
* [Bugs](https://bugs.launchpad.net/neutron)
* [Blueprints](https://blueprints.launchpad.net/neutron)
* [Translations](https://translations.launchpad.net/neutron)
* [Answers](https://answers.launchpad.net/neutron)

# [OSSA-2016-009] Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests (CVE-2016-5362 and CVE-2016-5363)

Bug #1558658 reported by
[Dustin Lundquist](https://launchpad.net/~dlundquist)
on 2016-03-17

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 1 person

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [OpenStack Security Advisory](https://bugs.launchpad.net/ossa) | Fix Released | Undecided | Unassigned |  |
|  | [neutron](https://bugs.launchpad.net/neutron) | Fix Released | High | [Kevin Benton](https://launchpad.net/~kevinbenton) |  |
|  | [Kilo](https://bugs.launchpad.net/neutron/kilo) | Fix Released | Undecided | [Kevin Benton](https://launchpad.net/~kevinbenton) | [neutron 2015.1.4](https://launchpad.net/neutron/%2Bmilestone/2015.1.4) |

### Bug Description

The IptablesFirewallDriver does not prevent spoofing other instances or a routers MAC and/or IP addresses. The rule to permit DHCP discovery and request messages:

ipv4\_rules += [comment\_rule('-p udp -m udp --sport 68 --dport 67 '

                                    '-j RETURN', comment=ic.DHCP\_CLIENT)]

is too permissive, it does not enforce the source MAC or IP address. This is the IPv4 case of public bug [https://bugs.launchpad.net/neutron/+bug/1502933](https://bugs.launchpad.net/neutron/%2Bbug/1502933), and a solution was previously mentioned in June 2013 in [https://bugs.launchpad.net/neutron/+bug/1427054](https://bugs.launchpad.net/neutron/%2Bbug/1427054).

If L2population is not used, an instance can spoof the Neutron router's MAC address and cause the switches to learn a MAC move, allowing the instance to intercept other instances traffic potentially belonging to other tenants if this is shared network.

The solution for this is to permit this DHCP traffic only from the instance's IP address and the unspecified IPv4 address 0.0.0.0/32 rather than from an IPv4 source, additionally the source MAC address should be restricted to MAC addresses assigned to the instance's Neutron port.

See [original description](comments/0)

Tags:

[in-stable-kilo](/neutron/%2Bbugs?field.tag=in-stable-kilo)
[in-stable-liberty](/neutron/%2Bbugs?field.tag=in-stable-liberty)
[in-stable-mitaka](/neutron/%2Bbugs?field.tag=in-stable-mitaka)

## CVE References

* [2015-8914](/bugs/cve/2015-8914 "The IPTables firewall in OpenStack Ne...")
* [2016-5362](/bugs/cve/2016-5362 "The IPTables firewall in OpenStack Ne...")
* [2016-5363](/bugs/cve/2016-5363 "The IPTables firewall in OpenStack Ne...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-03-17: |  |  | [#1](/neutron/%2Bbug/1558658/comments/1) |
| --- | --- | --- | --- |

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

Since this report concerns a possible security risk, an incomplete security advisory task has been added while the core security reviewers for the affected project or projects confirm the bug and discuss the scope of any vulnerability along with potential solutions.

| Changed in ossa: | |
| --- | --- |
| **status**: | New → Incomplete |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio) wrote on 2016-03-18: |  |  | [#2](/neutron/%2Bbug/1558658/comments/2) |
| --- | --- | --- | --- |

Looking.

Looking.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Armando Migliaccio (armando-migliaccio)](https://launchpad.net/~armando-migliaccio) wrote on 2016-03-18: |  |  | [#3](/neutron/%2Bbug/1558658/comments/3) |
| --- | --- | --- | --- |

I think the issue exists, and under the circumstances identified there's the risk to intercept traffic on a shared medium. If the solution wouldn't involve tracking the source mac of all instances on the shared network, I'd say go for it, but the scalability implications concern me. Having said that, I think knowledge about this is already public domain because of the other issues being reported, therefore we may want to consider open the discussion for wider feedback.

I think the issue exists, and under the circumstances identified there's the risk to intercept traffic on a shared medium. If the solution wouldn't involve tracking the source mac of all instances on the shared network, I'd say go for it, but the scalability implications concern me. Having said that, I think knowledge about this is already public domain because of the other issues being reported, therefore we may want to consider open the discussion for wider feedback.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-03-21: |  |  | [#4](/neutron/%2Bbug/1558658/comments/4) |
| --- | --- | --- | --- |

Thank you Armando for the investigation.

It's still unclear whenever shared network impacts do warrants an advisory.

If nobody objects, lets make this bug report public security.

Also, should the description be saying "the IPv6\* case of public bug" instead of IPv4 ?

Thank you Armando for the investigation.
It's still unclear whenever shared network impacts do warrants an advisory.
If nobody objects, lets make this bug report public security.
Also, should the description be saying "the IPv6\* case of public bug" instead of IPv4 ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-21: |  |  | [#5](/neutron/%2Bbug/1558658/comments/5) |
| --- | --- | --- | --- |

Tristan,

It's reasonable to assume IPv4 is much more widely deployed than IPv6, so the public IPv6 bug a significantly smaller number of installations. That being said, it wasn't a very difficult to examine the IPv4 case for the same vulnerability as the IPv6 case, so don't believe there is significant value in maintaining the embargo.

Armando,

Neutron presently maintains an ebtables chain for each instance port to prevent MAC spoofing, the overhead of expanding this to validate all source MAC as well as ARP messages is one additional rule in this chain (ebtables allows matching against multiple MAC addresses in a single rule). If Neutron chooses not to address this, first-hop security expectations should to be clearly defined in a policy somewhere so operators can make informed decisions on how they deploy Neutron.

Tristan,
It's reasonable to assume IPv4 is much more widely deployed than IPv6, so the public IPv6 bug a significantly smaller number of installations. That being said, it wasn't a very difficult to examine the IPv4 case for the same vulnerability as the IPv6 case, so don't believe there is significant value in maintaining the embargo.
Armando,
Neutron presently maintains an ebtables chain for each instance port to prevent MAC spoofing, the overhead of expanding this to validate all source MAC as well as ARP messages is one additional rule in this chain (ebtables allows matching against multiple MAC addresses in a single rule). If Neutron chooses not to address this, first-hop security expectations should to be clearly defined in a policy somewhere so operators can make informed decisions on how they deploy Neutron.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kevin Benton (kevinbenton)](https://launchpad.net/~kevinbenton) wrote on 2016-03-25: |  |  | [#6](/neutron/%2Bbug/1558658/comments/6) |
| --- | --- | --- | --- |

* [bug\_1558658.patch](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Battachment/4611129/%2Bfiles/bug_1558658.patch)
  [Edit](/neutron/%2Bbug/1558658/%2Battachment/4611129)
  (23.1 KiB,
  text/plain)

I agree that this is something we need to address. I'm fine with it being opened to the public or being fixed first.

@Dustin,

Can you confirm that the attached patch fixes the mac spoofing issue? (Note that there are two patches in there, one for Linux Bridge and one for OVS)

I didn't do anything about the DHCP request source IP restriction in this patch because that one just seems to be a way to spam some DHCP requests for an incorrect address. Correct me if I'm wrong, but that doesn't pose any security issue (other than log noise), right?

I agree that this is something we need to address. I'm fine with it being opened to the public or being fixed first.
@Dustin,
Can you confirm that the attached patch fixes the mac spoofing issue? (Note that there are two patches in there, one for Linux Bridge and one for OVS)
I didn't do anything about the DHCP request source IP restriction in this patch because that one just seems to be a way to spam some DHCP requests for an incorrect address. Correct me if I'm wrong, but that doesn't pose any security issue (other than log noise), right?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-28: |  |  | [#7](/neutron/%2Bbug/1558658/comments/7) |
| --- | --- | --- | --- |

@Kevin,

I've tested the patch on ML2 LinuxBridge, and in the process of testing on ML2 OVS now. I'm not positive that all potential instance operating systems would not insert an entry its ARP table after receiving a unicast UDP packet, although I've verified Linux does not learn neighbors from unicast UDP packets. I think we can remove the embargo once this patch is merged.

@Kevin,
I've tested the patch on ML2 LinuxBridge, and in the process of testing on ML2 OVS now. I'm not positive that all potential instance operating systems would not insert an entry its ARP table after receiving a unicast UDP packet, although I've verified Linux does not learn neighbors from unicast UDP packets. I think we can remove the embargo once this patch is merged.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-28: |  |  | [#8](/neutron/%2Bbug/1558658/comments/8) |
| --- | --- | --- | --- |

@Kevin

I've verified your patch prevents MAC address spoofing with both LinuxBridge and OVS mechanism drivers. The chunk in update\_stale\_ofport\_rules didn't apply cleanly to master, but was trivial to resolve by hand.

@Kevin
I've verified your patch prevents MAC address spoofing with both LinuxBridge and OVS mechanism drivers. The chunk in update\_stale\_ofport\_rules didn't apply cleanly to master, but was trivial to resolve by hand.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-03-29: |  |  | [#9](/neutron/%2Bbug/1558658/comments/9) |
| --- | --- | --- | --- |

I agree the impact of this bug should be limited enough that it's worthwhile to work it in public and avoid complexities of the embargo process.

I agree the impact of this bug should be limited enough that it's worthwhile to work it in public and avoid complexities of the embargo process.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-03-29: |  |  | [#10](/neutron/%2Bbug/1558658/comments/10) |
| --- | --- | --- | --- |

@Dustin @Kevin, if it's ok for you, can you remove the privacy setting of this bug before submitting the proposed patch to gerrit ?

@Dustin @Kevin, if it's ok for you, can you remove the privacy setting of this bug before submitting the proposed patch to gerrit ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-03-29: |  |  | [#11](/neutron/%2Bbug/1558658/comments/11) |
| --- | --- | --- | --- |

@Tristan @Jeremy, The MAC spoofing aspect of this could based used to DoS or intercept other tenants in a public cloud using shared networks. I'm not familiar with the review process for a patch under embargo, but releasing this could leave public deployments exposed. On the other hand, as I mentioned in the original bug report, this is the IPv4 case of a public IPv6 bug and a fix was first suggested in 2013. Hopefully public deployments have taken additional precautions to harden their environments.

@Tristan @Jeremy, The MAC spoofing aspect of this could based used to DoS or intercept other tenants in a public cloud using shared networks. I'm not familiar with the review process for a patch under embargo, but releasing this could leave public deployments exposed. On the other hand, as I mentioned in the original bug report, this is the IPv4 case of a public IPv6 bug and a fix was first suggested in 2013. Hopefully public deployments have taken additional precautions to harden their environments.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-03-29: |  |  | [#12](/neutron/%2Bbug/1558658/comments/12) |
| --- | --- | --- | --- |

In the past we've considered some bugs only impacting shared tenant networks to be impractical vulnerabilities given the warnings in the security guide about shared network deployment models (though I'm failing to find specific precedent bugs to cite at the moment). That said, if the proposed patch fixes this and can be backported quickly to supported stable branches (mitaka, liberty, kilo) without an adverse behavior change then we could follow embargo process. I'm just wary, as the related IPv6 bug has been public for months with no movement.

In the past we've considered some bugs only impacting shared tenant networks to be impractical vulnerabilities given the warnings in the security guide about shared network deployment models (though I'm failing to find specific precedent bugs to cite at the moment). That said, if the proposed patch fixes this and can be backported quickly to supported stable branches (mitaka, liberty, kilo) without an adverse behavior change then we could follow embargo process. I'm just wary, as the related IPv6 bug has been public for months with no movement.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Kevin Benton (kevinbenton)](https://launchpad.net/~kevinbenton) wrote on 2016-03-29: |  |  | [#13](/neutron/%2Bbug/1558658/comments/13) |
| --- | --- | --- | --- |

I would be okay with a public release and then regular code review. It should be relatively quick since the patch is already prepared with tests.

I would be okay with a public release and then regular code review. It should be relatively quick since the patch is already prepared with tests.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Jeremy Stanley (fungi)](https://launchpad.net/~fungi) wrote on 2016-03-29: |  |  | [#14](/neutron/%2Bbug/1558658/comments/14) |
| --- | --- | --- | --- |

I've switched this to public security. Changes can be pushed to public Gerrit while we continue to debate the impact and need for an advisory.

I've switched this to public security. Changes can be pushed to public Gerrit while we continue to debate the impact and need for an advisory.

| **information type**: | Private Security → Public Security |
| --- | --- |
| **description**: | updated |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/15) |  |  | [#15](/neutron/%2Bbug/1558658/comments/15) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/299021>

Fix proposed to branch: master
Review: https://review.openstack.org/299021

| Changed in neutron: | |
| --- | --- |
| **assignee**: | nobody → Kevin Benton (kevinbenton) |
| **status**: | New → In Progress |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#16](/neutron/%2Bbug/1558658/comments/16) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/299022>

Fix proposed to branch: master
Review: https://review.openstack.org/299022

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/17) |  |  | [#17](/neutron/%2Bbug/1558658/comments/17) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/299023>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/299023

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#18](/neutron/%2Bbug/1558658/comments/18) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/299024>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/299024

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/19) |  |  | [#19](/neutron/%2Bbug/1558658/comments/19) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/299025>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/299025

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#20](/neutron/%2Bbug/1558658/comments/20) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/299026>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/299026

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29:  [**Fix proposed to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/21) |  |  | [#21](/neutron/%2Bbug/1558658/comments/21) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/299027>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/299027

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-29: |  |  | [#22](/neutron/%2Bbug/1558658/comments/22) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/299028>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/299028

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-03-31:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/23) |  |  | [#23](/neutron/%2Bbug/1558658/comments/23) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/300202>

Fix proposed to branch: master
Review: https://review.openstack.org/300202

| Changed in neutron: | |
| --- | --- |
| **assignee**: | Kevin Benton (kevinbenton) → Dustin Lundquist (dlundquist) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-04:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/24) |  |  | [#24](/neutron/%2Bbug/1558658/comments/24) |
| --- | --- | --- | --- |

About the OSSA status, is the impact for non shared network limited to single tenant scope (e.g. one instance can bypass neutron anti-spoof rules toward other instances of the same tenant only) ?

About the OSSA status, is the impact for non shared network limited to single tenant scope (e.g. one instance can bypass neutron anti-spoof rules toward other instances of the same tenant only) ?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-05:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1558658/comments/25) |  |  | [#25](/neutron/%2Bbug/1558658/comments/25) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299021>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=be298f8bc35e6d006c7a9361e42755c9d6790e1e>

Submitter: Jenkins

Branch: master

commit be298f8bc35e6d006c7a9361e42755c9d6790e1e

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

Reviewed: https://review.openstack.org/299021
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=be298f8bc35e6d006c7a9361e42755c9d6790e1e
Submitter: Jenkins
Branch: master
commit be298f8bc35e6d006c7a9361e42755c9d6790e1e
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-05:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/26) |  |  | [#26](/neutron/%2Bbug/1558658/comments/26) |
| --- | --- | --- | --- |

Covering both [bug 1558658](/bugs/1558658) and [bug 1502933](/bugs/1502933), here is impact description draft #1.

Is this accurate enough ?

Title: Neutron anti-spoof protection bypass

Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group)

Products: Neutron

Affects: >=2015.1.0 <=2015.1.3, >=7.0.0 <=7.0.4, <=8.0.0

Description:

Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box Group, Inc independently reported a vulnerability in Neutron anti-spoof protection. By forging discovery protocol source address, an instance may spoof addresses on attached network resulting in Denial of Service and/or traffic interception. When L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Covering both bug 1558658 and bug 1502933, here is impact description draft #1.
Is this accurate enough ?
Title: Neutron anti-spoof protection bypass
Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group)
Products: Neutron
Affects: >=2015.1.0 <=2015.1.3, >=7.0.0 <=7.0.4, <=8.0.0
Description:
Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box Group, Inc independently reported a vulnerability in Neutron anti-spoof protection. By forging discovery protocol source address, an instance may spoof addresses on attached network resulting in Denial of Service and/or traffic interception. When L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

[OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack)
on 2016-04-05

| Changed in neutron: | |
| --- | --- |
| **assignee**: | Dustin Lundquist (dlundquist) → Kevin Benton (kevinbenton) |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-04-05

| Changed in ossa: | |
| --- | --- |
| **status**: | Incomplete → Triaged |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-05: |  |  | [#27](/neutron/%2Bbug/1558658/comments/27) |
| --- | --- | --- | --- |

@Tristan, A few suggestions for impact description:

  1. s/forging discovery protocol source address/forging DHCP discovery source address/ (DHCP is the protocol, discovery is the message type, and could be confused with IPv6 neighbor discovery protocol).

  2. In bug/1558674 I generalized this to all non-IP traffic, I think this is relevant to the impact description since it is a more likely attack vector

  3. We should mention that both MAC and IP source spoofing where permitted. MAC spoofing effects are limited to local network, while IP spoofing could be used for either a direct DoS or interfering with DHCP leases on other networks.

@Tristan, A few suggestions for impact description:
1. s/forging discovery protocol source address/forging DHCP discovery source address/ (DHCP is the protocol, discovery is the message type, and could be confused with IPv6 neighbor discovery protocol).
2. In bug/1558674 I generalized this to all non-IP traffic, I think this is relevant to the impact description since it is a more likely attack vector
3. We should mention that both MAC and IP source spoofing where permitted. MAC spoofing effects are limited to local network, while IP spoofing could be used for either a direct DoS or interfering with DHCP leases on other networks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-05: |  |  | [#28](/neutron/%2Bbug/1558658/comments/28) |
| --- | --- | --- | --- |

Thank you Dustin for this review! How about:

By forging non-IP traffic such as DHCP discovery or ARP messages, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Thank you Dustin for this review! How about:
By forging non-IP traffic such as DHCP discovery or ARP messages, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-04-05: |  |  | [#29](/neutron/%2Bbug/1558658/comments/29) |
| --- | --- | --- | --- |

Still a bit muddled, DHCP is IP traffic, and ARP is already filtered by ebtables. How about:

By forging DHCP discovery messages or non-IP traffic, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Still a bit muddled, DHCP is IP traffic, and ARP is already filtered by ebtables. How about:
By forging DHCP discovery messages or non-IP traffic, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-05:  [**Related fix proposed to ossa (master)**](/neutron/%2Bbug/1558658/comments/30) |  |  | [#30](/neutron/%2Bbug/1558658/comments/30) |
| --- | --- | --- | --- |

Related fix proposed to branch: master

Review: <https://review.openstack.org/301977>

Related fix proposed to branch: master
Review: https://review.openstack.org/301977

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-04-05:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/31) |  |  | [#31](/neutron/%2Bbug/1558658/comments/31) |
| --- | --- | --- | --- |

Oups, dhcp discovery is indeed IP. Thank you for the correction.

<https://review.openstack.org/301977> is the proposed OSSA, note that it is missing backports of the icmpv6 extra rules.

I'll request the CVE number once everything is ready.

Oups, dhcp discovery is indeed IP. Thank you for the correction.
https://review.openstack.org/301977 is the proposed OSSA, note that it is missing backports of the icmpv6 extra rules.
I'll request the CVE number once everything is ready.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-06:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1558658/comments/32) |  |  | [#32](/neutron/%2Bbug/1558658/comments/32) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299022>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=997d7b03fb7f5528f0a3ce70867b9dcd9321509e>

Submitter: Jenkins

Branch: master

commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 04:47:28 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

Reviewed: https://review.openstack.org/299022
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=997d7b03fb7f5528f0a3ce70867b9dcd9321509e
Submitter: Jenkins
Branch: master
commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 04:47:28 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

| Changed in neutron: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08: |  |  | [#33](/neutron/%2Bbug/1558658/comments/33) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/300202>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=6a93ee8ac1a901c255e3475a24f1afc11d8bf80f>

Submitter: Jenkins

Branch: master

commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

Reviewed: https://review.openstack.org/300202
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=6a93ee8ac1a901c255e3475a24f1afc11d8bf80f
Submitter: Jenkins
Branch: master
commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08:  [**Fix proposed to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/34) |  |  | [#34](/neutron/%2Bbug/1558658/comments/34) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/mitaka

Review: <https://review.openstack.org/303563>

Fix proposed to branch: stable/mitaka
Review: https://review.openstack.org/303563

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08:  [**Fix proposed to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/35) |  |  | [#35](/neutron/%2Bbug/1558658/comments/35) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/liberty

Review: <https://review.openstack.org/303572>

Fix proposed to branch: stable/liberty
Review: https://review.openstack.org/303572

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-08:  [**Fix proposed to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/36) |  |  | [#36](/neutron/%2Bbug/1558658/comments/36) |
| --- | --- | --- | --- |

Fix proposed to branch: stable/kilo

Review: <https://review.openstack.org/303617>

Fix proposed to branch: stable/kilo
Review: https://review.openstack.org/303617

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-14:  [**Fix merged to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/37) |  |  | [#37](/neutron/%2Bbug/1558658/comments/37) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/303563>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=5853af9cba6733725d6c9ac0db644f426713f0cf>

Submitter: Jenkins

Branch: stable/mitaka

commit 5853af9cba6733725d6c9ac0db644f426713f0cf

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

    (cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

Reviewed: https://review.openstack.org/303563
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=5853af9cba6733725d6c9ac0db644f426713f0cf
Submitter: Jenkins
Branch: stable/mitaka
commit 5853af9cba6733725d6c9ac0db644f426713f0cf
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

| **tags**: | added: in-stable-mitaka |
| --- | --- |
| **tags**: | added: in-stable-liberty |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-14:  [**Fix merged to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/38) |  |  | [#38](/neutron/%2Bbug/1558658/comments/38) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/303572>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=fd5fd259a02156babdfcb12f66cde6ec9e7274ae>

Submitter: Jenkins

Branch: stable/liberty

commit fd5fd259a02156babdfcb12f66cde6ec9e7274ae

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Conflicts:

     neutron/tests/functional/agent/test\_firewall.py

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

    (cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

Reviewed: https://review.openstack.org/303572
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=fd5fd259a02156babdfcb12f66cde6ec9e7274ae
Submitter: Jenkins
Branch: stable/liberty
commit fd5fd259a02156babdfcb12f66cde6ec9e7274ae
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Conflicts:
neutron/tests/functional/agent/test\_firewall.py
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

| **tags**: | added: in-stable-kilo |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-04-14:  [**Fix merged to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/39) |  |  | [#39](/neutron/%2Bbug/1558658/comments/39) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/303617>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=b0f6984de3985b80c728dd282fe6148b28f01fe4>

Submitter: Jenkins

Branch: stable/kilo

commit b0f6984de3985b80c728dd282fe6148b28f01fe4

Author: Dustin Lundquist <email address hidden>

Date: Thu Mar 31 12:04:31 2016 -0700

Iptables firewall prevent IP spoofed DHCP requests

The DHCP rules in the fixed iptables firewall rules were too permissive.

    They permitted any UDP traffic with a source port of 68 and destination

    port of 67. Care must be taken since these rules return before the IP

    spoofing prevention rules. This patch splits the fixed DHCP rules into

    two, one for the discovery and request messages which take place before

    the instance has bound an IP address and a second to permit DHCP

    renewals.

Conflicts:

     neutron/agent/linux/iptables\_firewall.py

     neutron/tests/functional/agent/test\_firewall.py

     neutron/tests/unit/agent/linux/test\_iptables\_firewall.py

     neutron/tests/unit/agent/test\_securitygroups\_rpc.py

Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5

    Partial-Bug: #1558658

    (cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

Reviewed: https://review.openstack.org/303617
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=b0f6984de3985b80c728dd282fe6148b28f01fe4
Submitter: Jenkins
Branch: stable/kilo
commit b0f6984de3985b80c728dd282fe6148b28f01fe4
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Conflicts:
neutron/agent/linux/iptables\_firewall.py
neutron/tests/functional/agent/test\_firewall.py
neutron/tests/unit/agent/linux/test\_iptables\_firewall.py
neutron/tests/unit/agent/test\_securitygroups\_rpc.py
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)

[Kevin Benton (kevinbenton)](https://launchpad.net/~kevinbenton)
on 2016-04-20

| Changed in neutron: | |
| --- | --- |
| **importance**: | Undecided → High |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-09:  [**Change abandoned on neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/40) |  |  | [#40](/neutron/%2Bbug/1558658/comments/40) |
| --- | --- | --- | --- |

Change abandoned by Dave Walker (<email address hidden>) on branch: stable/kilo

Review: <https://review.openstack.org/299027>

Reason:

stable/kilo closed for 2015.1.4

This release is now pending its final release and no freeze exception has

been seen for this changeset. Therefore, I am now abandoning this change.

If this is not correct, please urgently raise a thread on openstack-dev.

More details at: <https://wiki.openstack.org/wiki/StableBranch>

Change abandoned by Dave Walker (email@daviey.com) on branch: stable/kilo
Review: https://review.openstack.org/299027
Reason:
stable/kilo closed for 2015.1.4
This release is now pending its final release and no freeze exception has
been seen for this changeset. Therefore, I am now abandoning this change.
If this is not correct, please urgently raise a thread on openstack-dev.
More details at: https://wiki.openstack.org/wiki/StableBranch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-09: |  |  | [#41](/neutron/%2Bbug/1558658/comments/41) |
| --- | --- | --- | --- |

Change abandoned by Dave Walker (<email address hidden>) on branch: stable/kilo

Review: <https://review.openstack.org/299028>

Reason:

stable/kilo closed for 2015.1.4

This release is now pending its final release and no freeze exception has

been seen for this changeset. Therefore, I am now abandoning this change.

If this is not correct, please urgently raise a thread on openstack-dev.

More details at: <https://wiki.openstack.org/wiki/StableBranch>

Change abandoned by Dave Walker (email@daviey.com) on branch: stable/kilo
Review: https://review.openstack.org/299028
Reason:
stable/kilo closed for 2015.1.4
This release is now pending its final release and no freeze exception has
been seen for this changeset. Therefore, I am now abandoning this change.
If this is not correct, please urgently raise a thread on openstack-dev.
More details at: https://wiki.openstack.org/wiki/StableBranch

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-09:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/42) |  |  | [#42](/neutron/%2Bbug/1558658/comments/42) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/314250>

Fix proposed to branch: master
Review: https://review.openstack.org/314250

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10:  [**Fix merged to neutron (stable/liberty)**](/neutron/%2Bbug/1558658/comments/43) |  |  | [#43](/neutron/%2Bbug/1558658/comments/43) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299025>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=b57d9fa96967de4aa634fb32a683d6c37fd05fab>

Submitter: Jenkins

Branch: stable/liberty

commit b57d9fa96967de4aa634fb32a683d6c37fd05fab

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

    (cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Reviewed: https://review.openstack.org/299025
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=b57d9fa96967de4aa634fb32a683d6c37fd05fab
Submitter: Jenkins
Branch: stable/liberty
commit b57d9fa96967de4aa634fb32a683d6c37fd05fab
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658
(cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10: |  |  | [#44](/neutron/%2Bbug/1558658/comments/44) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299026>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=b33c16bb0e75015f3e75693d815cfd616c831112>

Submitter: Jenkins

Branch: stable/liberty

commit b33c16bb0e75015f3e75693d815cfd616c831112

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 04:47:28 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Conflicts:

      neutron/plugins/ml2/drivers/openvswitch/agent/openflow/ovs\_ofctl/br\_int.py

      (no 'dump\_flows\_for' method so dump\_flows had to be used with an additional

       check of the in\_port on existing rules)

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

    (cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Reviewed: https://review.openstack.org/299026
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=b33c16bb0e75015f3e75693d815cfd616c831112
Submitter: Jenkins
Branch: stable/liberty
commit b33c16bb0e75015f3e75693d815cfd616c831112
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 04:47:28 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Conflicts:
neutron/plugins/ml2/drivers/openvswitch/agent/openflow/ovs\_ofctl/br\_int.py
(no 'dump\_flows\_for' method so dump\_flows had to be used with an additional
check of the in\_port on existing rules)
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f
(cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10:  [**Fix merged to neutron (stable/mitaka)**](/neutron/%2Bbug/1558658/comments/45) |  |  | [#45](/neutron/%2Bbug/1558658/comments/45) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299023>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=cc275e4975450947fa9d9e55ef42475a25bf611d>

Submitter: Jenkins

Branch: stable/mitaka

commit cc275e4975450947fa9d9e55ef42475a25bf611d

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

    (cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Reviewed: https://review.openstack.org/299023
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=cc275e4975450947fa9d9e55ef42475a25bf611d
Submitter: Jenkins
Branch: stable/mitaka
commit cc275e4975450947fa9d9e55ef42475a25bf611d
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658
(cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10: |  |  | [#46](/neutron/%2Bbug/1558658/comments/46) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299024>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=d7dc90946407d27eec9063f05f33e3f4888ad395>

Submitter: Jenkins

Branch: stable/mitaka

commit d7dc90946407d27eec9063f05f33e3f4888ad395

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 04:47:28 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

    (cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Reviewed: https://review.openstack.org/299024
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=d7dc90946407d27eec9063f05f33e3f4888ad395
Submitter: Jenkins
Branch: stable/mitaka
commit d7dc90946407d27eec9063f05f33e3f4888ad395
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 04:47:28 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f
(cherry picked from commit 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10:  [**Fix merged to neutron (stable/kilo)**](/neutron/%2Bbug/1558658/comments/47) |  |  | [#47](/neutron/%2Bbug/1558658/comments/47) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299027>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=d626eb24a304a0ba53311aa1bb877f60c974da72>

Submitter: Jenkins

Branch: stable/kilo

commit d626eb24a304a0ba53311aa1bb877f60c974da72

Author: Kevin Benton <email address hidden>

Date: Fri Mar 25 02:45:11 2016 -0700

Linux Bridge: Add mac spoofing filtering to ebtables

The current mac-spoofing code in iptables has two issues.

    First, it occurs after the address discovery allow rules

    (e.g. DHCP), so MAC addresses can be spoofed on discovery

    protocols. Second, since it is based on iptables, it

    doesn't apply to protocols like STP.

This means a VM could generate one of these types of packets

    with a spoofed MAC address to trick switches into learning

    that the spoofed MAC now belongs to the VM's port. The impact

    of this depends on the configuration of the environment

    (e.g. use of L2pop: see the bug report for details).

This patch adds MAC spoofing filtering to the ARP protection

    code for Linux bridge based on ebtables. Only traffic sourced

    from the MAC address on the port or in the allowed address

    pair MACs will be allowed.

This filtering will not be enabled if the port has port

    security disabled or if the device\_owner starts with 'network:'.

Conflicts:

     neutron/plugins/linuxbridge/agent/arp\_protect.py

     neutron/tests/functional/agent/linux/test\_linuxbridge\_arp\_protect.py

        (simple conflicts on both due to utils.is\_trusted\_port logic being gone)

Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78

    Partial-Bug: #1558658

    (cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Reviewed: https://review.openstack.org/299027
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=d626eb24a304a0ba53311aa1bb877f60c974da72
Submitter: Jenkins
Branch: stable/kilo
commit d626eb24a304a0ba53311aa1bb877f60c974da72
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 02:45:11 2016 -0700
Linux Bridge: Add mac spoofing filtering to ebtables
The current mac-spoofing code in iptables has two issues.
First, it occurs after the address discovery allow rules
(e.g. DHCP), so MAC addresses can be spoofed on discovery
protocols. Second, since it is based on iptables, it
doesn't apply to protocols like STP.
This means a VM could generate one of these types of packets
with a spoofed MAC address to trick switches into learning
that the spoofed MAC now belongs to the VM's port. The impact
of this depends on the configuration of the environment
(e.g. use of L2pop: see the bug report for details).
This patch adds MAC spoofing filtering to the ARP protection
code for Linux bridge based on ebtables. Only traffic sourced
from the MAC address on the port or in the allowed address
pair MACs will be allowed.
This filtering will not be enabled if the port has port
security disabled or if the device\_owner starts with 'network:'.
Conflicts:
neutron/plugins/linuxbridge/agent/arp\_protect.py
neutron/tests/functional/agent/linux/test\_linuxbridge\_arp\_protect.py
(simple conflicts on both due to utils.is\_trusted\_port logic being gone)
Change-Id: I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78
Partial-Bug: #1558658
(cherry picked from commit be298f8bc35e6d006c7a9361e42755c9d6790e1e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-10: |  |  | [#48](/neutron/%2Bbug/1558658/comments/48) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/299028>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=d48147b0fc192c49646951294479573e4ed9ae78>

Submitter: Jenkins

Branch: stable/kilo

commit d48147b0fc192c49646951294479573e4ed9ae78

Author: Kevin Benton <email address hidden>

Date: Mon Mar 28 22:21:53 2016 -0700

OVS: Add mac spoofing filtering to flows

The mac-spoofing filtering done by iptables was

    not adequate. See the bug report and change

    I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for

    more information.

This patch adds flows to the OVS agent to block

    any traffic from the VM that isn't in the allowed

    address pairs macs or the mac address field of

    the port.

Conflicts:

        This had to be heavily modified to work with Kilo due to

        the lack of a pluggable openflow interface that was present

        in master, mitaka, and liberty.

Closes-Bug: #1558658

    Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f

    (cherry-picked from 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Reviewed: https://review.openstack.org/299028
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=d48147b0fc192c49646951294479573e4ed9ae78
Submitter: Jenkins
Branch: stable/kilo
commit d48147b0fc192c49646951294479573e4ed9ae78
Author: Kevin Benton <kevin@benton.pub>
Date: Mon Mar 28 22:21:53 2016 -0700
OVS: Add mac spoofing filtering to flows
The mac-spoofing filtering done by iptables was
not adequate. See the bug report and change
I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 for
more information.
This patch adds flows to the OVS agent to block
any traffic from the VM that isn't in the allowed
address pairs macs or the mac address field of
the port.
Conflicts:
This had to be heavily modified to work with Kilo due to
the lack of a pluggable openflow interface that was present
in master, mitaka, and liberty.
Closes-Bug: #1558658
Change-Id: I02984b21872e0f183db7404c10d8180dbd89075f
(cherry-picked from 997d7b03fb7f5528f0a3ce70867b9dcd9321509e)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-05-10:  [**Fix included in openstack/neutron 2015.1.4**](/neutron/%2Bbug/1558658/comments/49) |  |  | [#49](/neutron/%2Bbug/1558658/comments/49) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 2015.1.4 release.

This issue was fixed in the openstack/neutron 2015.1.4 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-13:  [**Fix proposed to neutron (master)**](/neutron/%2Bbug/1558658/comments/50) |  |  | [#50](/neutron/%2Bbug/1558658/comments/50) |
| --- | --- | --- | --- |

Fix proposed to branch: master

Review: <https://review.openstack.org/315828>

Fix proposed to branch: master
Review: https://review.openstack.org/315828

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-16:  [**Re: Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests**](/neutron/%2Bbug/1558658/comments/51) |  |  | [#51](/neutron/%2Bbug/1558658/comments/51) |
| --- | --- | --- | --- |

Dustin, is change 315828 ( Ia1f9d768004871d743d2c7b979de1439667efe52 ) a security fix or does it fix a regression caused by one of the fix part of this upcoming advisory ? ftr, the current list of patch for the ossa are:

\* Ice1c9dd349864da28806c5053e38ef86f43b7771 (icmpv6)

\* Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5 (dhcp)

\* I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 (arp)

Dustin, is change 315828 ( Ia1f9d768004871d743d2c7b979de1439667efe52 ) a security fix or does it fix a regression caused by one of the fix part of this upcoming advisory ? ftr, the current list of patch for the ossa are:
\* Ice1c9dd349864da28806c5053e38ef86f43b7771 (icmpv6)
\* Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5 (dhcp)
\* I39dc0e23fc118ede19ef2d986b29fc5a8e48ff78 (arp)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-16: |  |  | [#52](/neutron/%2Bbug/1558658/comments/52) |
| --- | --- | --- | --- |

Here is the final impact description:

Title: Neutron anti-spoof protection bypass

Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group, Inc)

Products: Neutron

Affects: <=7.0.4, >=8.0.0 <=8.1.0

Description:

Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box

Group, Inc independently reported vulnerabilities in Neutron anti-

spoof protection. By forging DHCP discovery messages or non-IP

traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source

addresses on attached networks resulting in denial of services and/or

traffic interception. Moreover when L2population isn't used, other

tenants attached to a shared network are also vulnerable. Neutron

setups using the IPTables firewall driver are affected.

Here is the final impact description:
Title: Neutron anti-spoof protection bypass
Reporter: Romain Aviolat (Nagravision) and Dustin Lundquist (Blue Box Group, Inc)
Products: Neutron
Affects: <=7.0.4, >=8.0.0 <=8.1.0
Description:
Romain Aviolat from Nagravision and Dustin Lundquist from Blue Box
Group, Inc independently reported vulnerabilities in Neutron anti-
spoof protection. By forging DHCP discovery messages or non-IP
traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source
addresses on attached networks resulting in denial of services and/or
traffic interception. Moreover when L2population isn't used, other
tenants attached to a shared network are also vulnerable. Neutron
setups using the IPTables firewall driver are affected.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Dustin Lundquist (dlundquist)](https://launchpad.net/~dlundquist) wrote on 2016-05-17: |  |  | [#53](/neutron/%2Bbug/1558658/comments/53) |
| --- | --- | --- | --- |

Tristan, change 315828 addresses the OVS Firewall which currently has many of these same problems. Specifically table 71 (BASE\_EGRESS\_TABLE) permits specific ICMPv6 types, DHCP and DHCPv6 before validating source MAC or IP addresses. This allows IPv6 spoofing: neighbor discovery is permitted without any address validation. In addition the DHCP (IPv4) could be used to mask the source address of flood attack or release the DHCP lease of another instance (potentially belonging to another tenant on a shared network). In addition all the of above traffic types could be used to cause an physical switch to learn an incorrect port of another instance or router's MAC address potentially intercepting another tenants traffic on a shared provider network.

I finally have a working OVS Firewall test environment and this is my initial analysis of the OpenFlow rules it produces. I think all of the above vulnerabilities are addressed in the existing bug reports. I know the OVS Firewall is recent addition, so I'm not sure how it falls into the security advisory process.

Tristan, change 315828 addresses the OVS Firewall which currently has many of these same problems. Specifically table 71 (BASE\_EGRESS\_TABLE) permits specific ICMPv6 types, DHCP and DHCPv6 before validating source MAC or IP addresses. This allows IPv6 spoofing: neighbor discovery is permitted without any address validation. In addition the DHCP (IPv4) could be used to mask the source address of flood attack or release the DHCP lease of another instance (potentially belonging to another tenant on a shared network). In addition all the of above traffic types could be used to cause an physical switch to learn an incorrect port of another instance or router's MAC address potentially intercepting another tenants traffic on a shared provider network.
I finally have a working OVS Firewall test environment and this is my initial analysis of the OpenFlow rules it produces. I think all of the above vulnerabilities are addressed in the existing bug reports. I know the OVS Firewall is recent addition, so I'm not sure how it falls into the security advisory process.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray) wrote on 2016-05-17: |  |  | [#54](/neutron/%2Bbug/1558658/comments/54) |
| --- | --- | --- | --- |

Hum, well that's the problem with catch-all advisory where similar issues can be found later.

I propose we change impact description title to "Neutron IPTables firewall anti-spoof protection bypass" and move with it.

For the OVS Firewall case, I've added an ossa task to track this issue separately. If you agree, please review the new title and impact description posted in comment #52 so that we can request a CVE and proceed with the advisory.

Hum, well that's the problem with catch-all advisory where similar issues can be found later.
I propose we change impact description title to "Neutron IPTables firewall anti-spoof protection bypass" and move with it.
For the OVS Firewall case, I've added an ossa task to track this issue separately. If you agree, please review the new title and impact description posted in comment #52 so that we can request a CVE and proceed with the advisory.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-05-26:  [**Fix merged to neutron (master)**](/neutron/%2Bbug/1558658/comments/55) |  |  | [#55](/neutron/%2Bbug/1558658/comments/55) |
| --- | --- | --- | --- |

[Download full text](https://bugs.launchpad.net/neutron/%2Bbug/1558658/comments/55/%2Bdownload) (36.9 KiB)

Reviewed: <https://review.openstack.org/314250>

Committed: <https://git.openstack.org/cgit/openstack/neutron/commit/?id=3bf73801df169de40d365e6240e045266392ca63>

Submitter: Jenkins

Branch: master

commit a323769143001d67fd1b3b4ba294e59accd09e0e

Author: Ryan Moats <email address hidden>

Date: Tue Oct 20 15:51:37 2015 +0000

Revert "Improve performance of ensure\_namespace"

This reverts commit 81823e86328e62850a89aef9f0b609bfc0a6dacd.

Unneeded optimization: this commit only improves execution

    time on the order of milliseconds, which is less than 1% of

    the total router update execution time at the network node.

This also

Closes-bug: #1574881

Change-Id: Icbcdf4725ba7d2e743bb6761c9799ae436bd953b

commit 7fcf0253246832300f13b0aa4cea397215700572

Author: OpenStack Proposal Bot <email address hidden>

Date: Thu Apr 21 07:05:16 2016 +0000

Imported Translations from Zanata

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I9e930750dde85a9beb0b6f85eeea8a0962d3e020

commit 643b4431606421b09d05eb0ccde130adbf88df64

Author: OpenStack Proposal Bot <email address hidden>

Date: Tue Apr 19 06:52:48 2016 +0000

Imported Translations from Zanata

For more information about this automatic import see:

    <https://wiki.openstack.org/wiki/Translations/Infrastructure>

Change-Id: I52d7460b3265b5460b9089e1cc58624640dc7230

commit 1ffea42ccdc14b7a6162c1895bd8f2aae48d5dae

Author: OpenStack Proposal Bot <email address hidden>

Date: Mon Apr 18 15:03:30 2016 +0000

Updated from global requirements

Change-Id: Icb27945b3f222af1d9ab2b62bf2169d82b6ae26c

commit b970ed5bdac60c0fa227f2fddaa9b842ba4f51a7

Author: Kevin Benton <email address hidden>

Date: Fri Apr 8 17:52:14 2016 -0700

Clear DVR MAC on last agent deletion from host

Once all agents are deleted from a host, the DVR MAC generated

    for that host should be deleted as well to prevent a buildup of

    pointless flows generated in the OVS agent for hosts that don't

    exist.

Closes-Bug: #1568206

    Change-Id: I51e736aa0431980a595ecf810f148ca62d990d20

    (cherry picked from commit 92527c2de2afaf4862fddc101143e4d02858924d)

commit eee9e58ed258a48c69effef121f55fdaa5b68bd6

Author: Mike Bayer <email address hidden>

Date: Tue Feb 9 13:10:57 2016 -0500

Add an option for WSGI pool size

Neutron currently hardcodes the number of

    greenlets used to process requests in a process to 1000.

    As detailed in

    <http://lists.openstack.org/pipermail/openstack-dev/2015-December/082717.html>

this can cause requests to wait within one process

    for available database connection while other processes

    remain available.

By adding a wsgi\_default\_pool\_size option functionally

    identical to that of Nova, we can lower the number of

    greenlets per process to be more in line with a typical

    max database connection pool size.

DocImpact: a previously unused configuration value

               wsgi\_default\_pool\_size is now used to a...

Reviewed: https://review.openstack.org/314250
Committed: https://git.openstack.org/cgit/openstack/neutron/commit/?id=3bf73801df169de40d365e6240e045266392ca63
Submitter: Jenkins
Branch: master
commit a323769143001d67fd1b3b4ba294e59accd09e0e
Author: Ryan Moats <rmoats@us.ibm.com>
Date: Tue Oct 20 15:51:37 2015 +0000
Revert "Improve performance of ensure\_namespace"
This reverts commit 81823e86328e62850a89aef9f0b609bfc0a6dacd.
Unneeded optimization: this commit only improves execution
time on the order of milliseconds, which is less than 1% of
the total router update execution time at the network node.
This also
Closes-bug: #1574881
Change-Id: Icbcdf4725ba7d2e743bb6761c9799ae436bd953b
commit 7fcf0253246832300f13b0aa4cea397215700572
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Thu Apr 21 07:05:16 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I9e930750dde85a9beb0b6f85eeea8a0962d3e020
commit 643b4431606421b09d05eb0ccde130adbf88df64
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Apr 19 06:52:48 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I52d7460b3265b5460b9089e1cc58624640dc7230
commit 1ffea42ccdc14b7a6162c1895bd8f2aae48d5dae
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Mon Apr 18 15:03:30 2016 +0000
Updated from global requirements
Change-Id: Icb27945b3f222af1d9ab2b62bf2169d82b6ae26c
commit b970ed5bdac60c0fa227f2fddaa9b842ba4f51a7
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Apr 8 17:52:14 2016 -0700
Clear DVR MAC on last agent deletion from host
Once all agents are deleted from a host, the DVR MAC generated
for that host should be deleted as well to prevent a buildup of
pointless flows generated in the OVS agent for hosts that don't
exist.
Closes-Bug: #1568206
Change-Id: I51e736aa0431980a595ecf810f148ca62d990d20
(cherry picked from commit 92527c2de2afaf4862fddc101143e4d02858924d)
commit eee9e58ed258a48c69effef121f55fdaa5b68bd6
Author: Mike Bayer <mike\_mp@zzzcomputing.com>
Date: Tue Feb 9 13:10:57 2016 -0500
Add an option for WSGI pool size
Neutron currently hardcodes the number of
greenlets used to process requests in a process to 1000.
As detailed in
http://lists.openstack.org/pipermail/openstack-dev/2015-December/082717.html
this can cause requests to wait within one process
for available database connection while other processes
remain available.
By adding a wsgi\_default\_pool\_size option functionally
identical to that of Nova, we can lower the number of
greenlets per process to be more in line with a typical
max database connection pool size.
DocImpact: a previously unused configuration value
wsgi\_default\_pool\_size is now used to affect
the number of greenlets used by the server. The
default number of greenlets also changes from 1000
to 100.
Change-Id: I94cd2f9262e0f330cf006b40bb3c0071086e5d71
(cherry picked from commit 9d573387f1e33ce85269d3ed9be501717eed4807)
commit bf66cc6f74133cfe6c1ab75287d39814ac44b068
Author: Clayton O'Neill <clayton.oneill@twcable.com>
Date: Thu Mar 24 15:28:21 2016 +0000
Don't disconnect br-int from phys br if connected
When starting up, we don't want to delete the patch port between br-int
and the physical bridges. In liberty the br-int bridge was changed to
not tear down flows on startup, and change
I9801b76829021c9a0e6358982e1136637634a521 will change the physical
bridges to not tear down flows also.
Without this patch the patch port is torn down and not reinstalled until
after the initial flows are set back up.
Partial-Bug: #1514056
Change-Id: I05bf5105a6f3acf6a313ce6799648a095cf8ec96
(cherry picked from commit a549f30fad93508bf9dfdcfb20cd522f7add27b0)
commit 93795a4bda47605d5616476b2a456772308aa3c3
Author: Kevin Benton <kevin@benton.pub>
Date: Mon Mar 28 14:14:15 2016 -0700
Fix deprecation warning for external\_network\_bridge
We only want this to warn when a deployer has set anything other
than a blank string. The olso cfg would warn whenever it was set
so it was incorrectly warning on the value we want operators to
set it to.
This changes the cfg option to not use deprecated for removal and
the L3 agent config validation to emit a warning if its not set
to the value we are suggesting.
Change-Id: If533cf7c4c379be78f5a15073accaff7f65973ab
Closes-Bug: #1563070
(cherry picked from 8382ac3717cf646145379456af94ce75000349a9)
commit 36305c0c4f4ebf498020f5956e103832da75f8a9
Author: Kevin Benton <kevin@benton.pub>
Date: Thu Feb 18 03:48:29 2016 -0800
Add ALLOCATING state to routers
This patch adds a new ALLOCATING status to routers
to indicate that the routers are still being built on the
Neutron server. Any routers in this state are excluded in
router retrievals by the L3 agent since they are not yet
ready to be wired up.
This is necessary when a router is made up of several
distinct Neutron resources that cannot all be put
into a single transaction. This patch applies this new
state to HA routers while their internal HA ports and
networks are being created/deleted so the L3 HA agent
will never retrieve a partially formed HA router. It's
important to note that the ALLOCATING status carries over
until after the scheduling is done, which ensures that
routers that weren't fully scheduled will not be sent to
the agents.
An HA router is placed in this state only when it is being
created or converted to/from the HA state since this is
disruptive to the dataplane.
This patch also reverts the changes introduced in
Iadb5a69d4cbc2515fb112867c525676cadea002b since they will
be handled by the ALLOCATING logic instead.
Co-Authored-By: Ann Kamyshnikova <akamyshnikova@mirantis.com>
Co-Authored-By: John Schwarz <jschwarz@redhat.com>
APIImpact
Closes-Bug: #1550886
Related-bug: #1499647
Change-Id: I22ff5a5a74527366da8f82982232d4e70e455570
(cherry picked from commit 9c3c19f07ce52e139d431aec54341c38a183f0b7)
commit 07401352a964b92ef4bc09a09800554e4a84cc87
Author: Hynek Mlnarik <hmlnarik@redhat.com>
Date: Thu Feb 25 11:34:15 2016 +0100
Cleanup stale OVS flows for physical bridges
Perform deletion of the stale flows in physical bridges consistently with
br-int and br-tun, respecting drop\_flows\_on\_start configuration option.
Added tests for auxiliary bridge and functional tests for the physical
bridge using VLAN/flat external network. Fixes part of the bug 1514056;
together with [1] and [2], the bug should be considered fixed.
The commit also fixes inconsistency between netmask of allocated IP
addresses assigned in \_create\_test\_port\_dict and ip\_len in \_plug\_ports
of base.py.
[1] https://review.openstack.org/#/c/297211/
[2] https://review.openstack.org/#/c/297818/
Co-Authored-By: Jian Wen <wenjianhn@gmail.com>
Partial-Bug: 1514056
Change-Id: I9801b76829021c9a0e6358982e1136637634a521
(cherry picked from commit cacde308eef6f1d7005e555b4521332da95d3cf4)
commit 05a4a34b7e46c2e13a9bd874674804a94f342d0c
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Thu Apr 7 16:45:52 2016 +0300
Notify resource\_versions from agents only when needed
resource\_versions were included into agent state reports recently to
support rolling upgrades (commit 97a272a892fcf488949eeec4959156618caccae8)
The downside is that it brought additional processing when handling state
reports on server side: update of local resources versions cache and
more seriously rpc casts to all other servers to do the same.
All this led to a visible performance degradation at scale with hundreds
of agents constantly sending reports. Under load (rally test) agents
may start "blinking" which makes cluster very unstable.
In fact there is no need to send and update resource\_versions in each state
report. I see two cases when it should be done:
1) agent was restarted (after it was upgraded);
2) agent revived - which means that server was not receiving or being able
to process state reports for some time (agent\_down\_time). During that
time agent might be upgraded and restarted.
So this patch makes agents include resource\_versions info only on startup.
After agent revival server itself will update version\_manager with
resource\_versions taken from agent DB record - this is to avoid
version\_manager being outdated.
Closes-Bug: #1567497
Change-Id: I47a9869801f4e8f8af2a656749166b6fb49bcd3b
(cherry picked from commit e532ee3fccd0820f9ab0efc417ee787fb8c870e9)
commit 07fa3725c5a7fc68a41ed8af53ca2d3aad4c35b9
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Tue Apr 5 16:18:03 2016 +0300
ADDRESS\_SCOPE\_MARK\_IDS should not be global for L3 agent
Otherwise agent becomes unable to handle more than 1024 routers
(including deleted routers) and starts failing.
It should be enough to distinguish address scopes inside router namespace,
so this patch moves ADDRESS\_SCOPE\_MARK\_IDS set to the RouterInfo class.
Closes-Bug: #1566291
Change-Id: I1e43bb3e68db4db93cc1dfc1383af0311bfb0f2d
(cherry picked from commit 1cb43734808eded87210d2957d56b70c514d55c3)
commit 9c58ae6a70125497a39612f71c53c60a8b35968e
Author: Eugene Nikanorov <enikanorov@mirantis.com>
Date: Wed Mar 30 08:36:58 2016 -0700
Wrap all update/delete l3\_rpc handlers with retries
This is needed for mysql galera multimaster backends.
Closes-Bug: #1564144
Change-Id: Ia5a14d5ee91c6672d61904f669e9e845a7f262c9
(cherry picked from commit d8f0ee5ecd67ee6ec956c7fdadce3c2a8e8301bf)
commit fff909e899eb06ca2ba1b9219df8525db0980fdd
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Thu Apr 7 19:27:38 2016 +0300
Values for [ml2]/physical\_network\_mtus should not be unique
Obviously there could be physical networks with same MTU.
The patch sets unique\_values to False when parsing physical\_network\_mtus
Unit test added.
Closes-Bug: #1567502
Change-Id: I46e5b5d3f7033a974fca40342af6dff7c71a9a4a
(cherry picked from commit 5cdd7ae574312a7499a8768c1752d9bc27ff7d20)
commit ece192b056c36568238abaf763b0ea9f99877c4c
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Fri Apr 1 19:40:20 2016 +0300
Use new DB context when checking if agent is online during rescheduling
Commit 9ec466cd42de94c2fad091edfd7583a5f47eb87a was not enough
since it checked l3 agents in the same transaction that was used
to fetch down bindings - so agents always were down even if actually
they went back online.
This commit adds context creation on each iteration to make sure
we use new transaction and fetch up-to-date info for the agent.
Closes-Bug: #1522436
Change-Id: I12a4e4f4e0c2042f0c0bf7eead42baca7b87a22b
(cherry picked from commit 70068992e37c80e9aa8e70f017aa35132d7e5aee)
commit 2e2d75cbc2be356e962793db42905cecf28730d8
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Thu Apr 7 10:09:13 2016 +0000
ovsfw: Load vlan tag from other\_config
OVS agent stores vlan tag only to other\_config before
setup\_port\_filter() is called [1], leaving 'tag' column empty. This
patch loads tag from correct place and modifies functional tests
accordingly.
Closes-Bug: 1566934
[1] https://github.com/openstack/neutron/blob/1efed3a5321a259d27ec4a6e80352d35fc423c11/neutron/plugins/ml2/drivers/openvswitch/agent/ovs\_neutron\_agent.py#L821
Change-Id: Iaae46ce7362fedfc53af958600d6d712eb382e9f
(cherry picked from commit dabd969090d35ec218d348f170edbef58163a79d)
commit 681441137b8590620c6a1f35ab5931edb22d7a31
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Mon Apr 11 06:27:57 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ia032d91e89bd78e16412b9bc7f60f466c61a16e5
commit a2d1c46fe7952abc392d91ef3d00d203e0f38a4c
Author: Ihar Hrachyshka <ihrachys@redhat.com>
Date: Thu Mar 24 16:16:17 2016 +0100
firewall: don't warn about a driver that does not accept bridge
Drivers that do not need the bridge parameter are safe to ignore it.
Actually, the base abstract interface for those drivers does not allow
to pass the new parameter.
Ideally, the base class \_\_init\_\_ signature would change to accept the
argument, but we can't do it without breaking API.
So instead, just handle both types of drivers - those that accept the
additional argument, and those that don't. And don't assume the latter
are somehow wrong.
Change-Id: Iceee46f63669b28e3a34d207216d864f1bfa5cf8
Closes-Bug: #1561243
(cherry picked from commit 193aa35325b897b960de88b510181b377e4c345c)
commit fa5eb530bb71c1b1fe1020802a63b05907695011
Author: Kevin Benton <kevin@benton.pub>
Date: Wed Mar 16 01:35:26 2016 -0700
Add uselist=True to subnet rbac\_entries relationship
Because the join conditions for Subnet rbac entries
are manually specified, SQLAlchemy is not
automatically detecting that this relationship is a list.
This adds the uselist=True kwarg to the relationship to
ensure that it's always handled as a list.
Change-Id: Ia4ae57ddd932260691584ae74c0305a79b2e60a9
Closes-Bug: #1557959
(cherry picked from commit 691f8f5ea54c04bfdfb76e25bda14665b05ed859)
commit 5853af9cba6733725d6c9ac0db644f426713f0cf
Author: Dustin Lundquist <dustin@null-ptr.net>
Date: Thu Mar 31 12:04:31 2016 -0700
Iptables firewall prevent IP spoofed DHCP requests
The DHCP rules in the fixed iptables firewall rules were too permissive.
They permitted any UDP traffic with a source port of 68 and destination
port of 67. Care must be taken since these rules return before the IP
spoofing prevention rules. This patch splits the fixed DHCP rules into
two, one for the discovery and request messages which take place before
the instance has bound an IP address and a second to permit DHCP
renewals.
Change-Id: Ibc2b0fa80baf2ea8b01fa568cd1fe7a7e092e7a5
Partial-Bug: #1558658
(cherry picked from commit 6a93ee8ac1a901c255e3475a24f1afc11d8bf80f)
commit c178bd9565ae699a79a8f13e89d1f8717a765cc1
Author: Armando Migliaccio <armamig@gmail.com>
Date: Wed Mar 30 14:24:58 2016 -0700
Fix race conditions in IP availability API tests
DHCP port creation is asynchronous with subnet creation.
Therefore there is a time window where, depending on how fast
the DHCP agent honors the request, the DHCP port IP allocation
may or may not be accounted for in the total number of used IP
for the network. To kill the race, do not run dhcp on the
created subnets at all.
Closes-bug: 1563883
Change-Id: Idda25e65d04852d68a3c160cc9deefdb4ee82dcd
(cherry picked from commit 27634bb2ba2637d694c7d0aa5758173d12ef579a)
commit ee32ea5e2bf2b01104c5bde6b6a5018dd0e15f57
Author: Ihar Hrachyshka <ihrachys@redhat.com>
Date: Thu Apr 7 19:15:01 2016 +0200
Switched from fixtures to mock to mock out starting RPC consumers
fixtures 2.0.0 broke us wildly, so instead of trying to make it work
with new fixtures, I better just switch the mock to... mock.
Change-Id: I58d7a750e263e4af54589ace07ac00bec34b553a
Closes-Bug: #1567295
(cherry picked from commit 2af86b8f6f749bf7b42a2c04b48c9a2dc28a46c9)
commit 77696d8529c7310e343722d809ab2e63bd8946f9
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Fri Apr 8 06:36:58 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: I2f2ef73e04e007e9b450d51a72ee60e1ec788518
commit 3190494c0dfc9762d874399276327f096ce4bd92
Author: Armando Migliaccio <armamig@gmail.com>
Date: Fri Apr 1 13:38:06 2016 -0700
Fix zuul\_cloner errors during tox job setup
Since [1], Tempest is a pip installable package, and that prevents zuul\_cloner
to work correctly. This change moves away from the existing logic in tox\_install,
and adds tempest as an explicit requirement for the api job. This is in fact
the only tox target that needs Tempest to work.
tox\_install.sh has become less important now, but cleanup is left as follow
up, to speed up gate salvation.
[1] I25eac915c977ebaedced66ac896c5dd77259d193
Change-Id: I00d882dde77a687ecb57ec200a34fd96256ad87a
(cherry picked from commit 8a6913c534e39e93640ed99c67e66763a9d1da3c)
commit 9679285f547b301a511e02ebc763b5406fb03ffc
Author: Jamie Lennox <jamielennox@gmail.com>
Date: Tue Mar 15 10:05:29 2016 +1100
Return oslo\_config Opts to config generator
We shouldn't be returning keystoneauth Opts to the oslo\_config
generator. Whilst it mostly works these objects are not interchangable
and it can result in problems. You can see this by entries such as:
# Warning: Failed to format sample for tenant\_name
# isinstance() arg 2 must be a class, type, or tuple of classes
and types
in the currently generated config files.
Keystoneauth provides a function that returns oslo\_config options so
fetch, process and return those instead.
Change-Id: Ie3fad2381467b19189cbb332c41cea8b6cf6e264
Closes-Bug: #1548433
(cherry picked from commit c3db0707eff70f381913643891ba4e148977407d)
commit 04fb1476de3b9d81ad579586c7010b5cdd2248a2
Author: Hynek Mlnarik <hmlnarik@redhat.com>
Date: Wed Mar 30 10:44:09 2016 +0200
Refactor and fix dummy process fixture
Extracting the test fixture that creates a new process and leaves it
running for a given amount of time into helpers where other fixtures for
functional tests live. This both keeps the fixtures at one place and
increases visibility of the fixture so that it can be reused in other
tests. At the same time, the fixture is fixed as the original code
omitted starting the process.
Change-Id: I97aeb8d1d5773ef3d59e8f908aea34ccceb38378
Related-Bug: 1561046
(cherry picked from commit 2690eed19a749fb1b50bb38f3d01fce0f1497f39)
commit 844cae4960cb2e3aedad750ceb91aa675f8e1142
Author: Dmitry Sutyagin <dsutyagin@mirantis.com>
Date: Fri Feb 12 12:18:14 2016 +0300
Switches metering agent to stateless iptables
If state\_less parameter is not specified then
neutron-postrouting-bottom rule goes up in POSTROUTING
chain, which causes premature NATing of traffic,
for ex. traffic between internal networks becomes NATed.
Closes-Bug: 1544508
Co-Authored-By: Sergey Belous <sbelous@mirantis.com>
Change-Id: I2e0011237d50a59d417cfee01dcd5f9d0da2e7f5
(cherry picked from commit 5d2d1120fcdcd5977d3c760ac1520a841048d456)
commit 19ea6ba92379168e1bfff7a7235119cfbbc0172c
Author: Hynek Mlnarik <hmlnarik@redhat.com>
Date: Wed Mar 23 14:51:59 2016 +0100
Remove obsolete keepalived PID files before start
keepalived refuses to start and claims "daemon already started"
when there is already a process with the same PID as found in
either the VRRP or the main process PID file. This happens even
in case when the new process is not keepalived. The situation
can happen when the neutron node is reset and the obsolete PID
files are not cleaned before neutron is started.
This commit adds PID file cleanup before keepalived start.
Closes-Bug: 1561046
Change-Id: Ib6b6f2fe76fe82253f195c9eab6b243d9eb76fa2
(cherry picked from commit e98fabb5836b12bc40a2b64a2668893ea73c2320)
commit aafa702d2f389c0a4f3679df65be07940095ec29
Author: Kevin Benton <kevin@benton.pub>
Date: Sun Mar 13 20:52:09 2016 -0700
Add IPAllocation object to session info to stop GC
This adds the IPAllocation object created in the \_store\_ip\_allocation
method to the session info dictionary to prevent it from being
immediately garbage collected. This is necessary because otherwise a
new persistent object will be created when the fixed\_ips relationship
is referenced during the rest of the port create/update opertions.
This persistent object will then interfere with a retry operation
that uses the same session if it tries to create a conflicting record.
By preventing the object from being garbage collected, the reference
to fixed IPs will re-use the newly created sqlalchemy object instead
which will properly be cleaned up on a rollback.
This also removes the 'passive\_delete' option from the fixed\_ips
relationship on ports because IPAllocation objects would now be
left in the session after port deletes. At first glance, this might
look like a performance penalty because fixed\_ips would be looked
up before port deletes; however, we already do that in the IPAM
code as well as the ML2 code so this relationship is already being
loaded on the delete\_port operation.
Closes-Bug: #1556178
Change-Id: Ieee1343bb90cf111c55e00b9cabc27943b46c350
(cherry picked from commit 7d9169967fca3d81076cf60eb772f4506735a218)
commit 005d49d2f092039660a44896217a5c245dcc4685
Author: Vincent Untz <vuntz@suse.com>
Date: Tue Nov 17 17:47:56 2015 +0100
Ensure metadata agent doesn't use SSL for UNIX socket
The communication between the ns metadata proxy and the metadata agent
is pure HTTP, and should not switch to HTTPS when neutron is using SSL.
We're therefore telling wsgi.Server to forcefully disable SSL in that
case.
Change-Id: I2cb9fa231193bcd5c721c4d5cf0eb9c16e842349
Closes-Bug: #1514424
(cherry picked from commit 7a306e2918775ebb94d9e1408aaa2b7c3ed26fc6)
commit 905fd05f966e0c7d3851f59665e58746c50bad1e
Author: Swaminathan Vasudevan <swaminathan.vasudevan@hpe.com>
Date: Fri Mar 25 12:38:13 2016 -0700
DVR: Increase the link-local address pair range
The current dvr\_fip\_ns.py file has FIP\_LL\_SUBNET configured
with a subnet prefixlen of /23 which only allows 255 pairs of
link-local addresses to be generated. If the number of routers
per-node increases beyond the 255 limit it raises an assertion.
This patch increases the link-local address cidr to be a /18
to allow for 8K routers. The new range was chosen to not
overlap with the original, allowing for in-place upgrades
without affecting existing routers.
Closes-Bug: #1562110
Change-Id: I6e11622ea9cc74b1d2428757f16aa0de504ac31a
(cherry picked from commit 7b1b8c2de57457c2ec1ed784165a3e10e24151cf)
commit 93d719a554d9b179636afccd25e1018b6e5d1cc3
Author: Sreekumar S <sreesiv@gmail.com>
Date: Fri Jan 22 19:09:49 2016 +0530
SG protocol validation to allow numbers or names
SG rule protocol provided is validated against the DB rules'
protocols for both number and name. The filter provided to DB
is modified so that it is queried for records with both the
protocol name and number, instead of exactly the type provided
with the input. The returned DB rule record's protocol field is
validated against the supplied SG protocol field for both name
or number.
This way, user is still allowed to enter protocol name or number
to create a rule, and API compatibility is maintained.
Closes-Bug: #1215181
(cherry picked from commit 913a64cc1175b3bd7efc7abe34895c32bf39a696)
Also squashed the following regression fix:
===
Don't drop 'protocol' from client supplied security\_group\_rule dict
If protocol was present in the dict, but was None, then it was never
re-instantiated after being popped out of the dict. This later resulted
in KeyError when trying to access the key on the dict.
Change-Id: I4985e7b54117bee3241d7365cb438197a09b9b86
Closes-Bug: #1566327
(cherry picked from commit 5a41caa47a080fdbc1801e2771163734b9790c57)
===
Change-Id: If4ad684e961433b8d9d3ec8fe2810585d3f6a093
commit 33d3b8ce76d942950e2f999a6040787483adf729
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Apr 1 02:42:54 2016 -0700
L3 agent: match format used by iptables
This fixes the iptables rules generated by the L3 agent
(SNAT, DNAT, set-mark and metadata), and the DHCP agent
(checksum-fill) to match the format that will be returned
by iptables-save to prevent excessive extra replacement
work done by the iptables manager.
It also fixes the iptables test that was not passing the
expected arguments (-p PROTO -m PROTO) for block rules.
A simple test was added to the L3 agent to ensure that the
rules have converged during the normal lifecycle tests.
Closes-Bug: #1566007
Change-Id: I5e8e27cdbf0d0448011881614671efe53bb1b6a1
(cherry picked from commit b8d520ffe2afbffe26b554bff55165531e36e758)
commit 7b2fcaa1734bc1f26a1c4c2f0ace6fedbaa171e2
Author: Armando Migliaccio <armamig@gmail.com>
Date: Fri Apr 1 18:02:47 2016 -0700
Use right class method in IP availability tests
This should have been skip\_checks. Spotted when dealing with
fix for bug 1563883, argh.
Change-Id: If609c285c2363967aba91a8ae1560d99391654d9
Related-bug: 1563883
(cherry picked from commit 2b0ce0ba8bf6abeb62654a00c12cfaad89f86e7c)
commit 93cdf8eb559cf78895200b3ec6775afe60b6c638
Author: Kevin Benton <kevin@benton.pub>
Date: Sun Feb 21 21:31:59 2016 -0800
Make L3 HA interface creation concurrency safe
This patch creates a function to handle the creation of the
L3HA interfaces for a router in a manner that handles the
HA network not existing or an existing one being deleted
by another worker before the interfaces could be created.
Closes-Bug: #1548285
Change-Id: Ibac0c366362aa76615e448fbe11d6d6b031732fe
(cherry-picked from commit 7512d8aa26a945a695e889e0a97c6414cec6ac10)
commit d93466923f3b5627c55510f9bc7229a7b584b430
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Fri Apr 1 14:53:03 2016 +0000
ovsfw: Remove vlan tag before injecting packets to port
Open vSwitch takes care of vlan tagging in case normal switching is
used. When ingress traffic packets are accepted, the
actions=output:<port\_number> is used but we need to explicitly take care
of stripping out the vlan tags.
Closes-Bug: 1564947
Change-Id: If3fc44c9fd1ac0f7bc9dfe9dc48e76352e981f8e
(cherry picked from commit 0f9ec7b72a8ca173b760f20323f90bffefa91681)
commit 33c01f4d49a4561bac56831483ac22c4a4b3f47d
Author: OpenStack Proposal Bot <openstack-infra@lists.openstack.org>
Date: Tue Apr 5 06:48:18 2016 +0000
Imported Translations from Zanata
For more information about this automatic import see:
https://wiki.openstack.org/wiki/Translations/Infrastructure
Change-Id: Ief6281fde6ab1f72b26bfb11528fc64c71b407b9
commit 05ac0125fe861fbfb09d48eec97a29539b51b4e2
Author: YAMAMOTO Takashi <yamamoto@midokura.com>
Date: Fri Mar 25 15:22:46 2016 +0900
test\_network\_ip\_availability: Skip IPv6 tests when configured so
Use a class attribute known by the base class so that IPv6 tests
are skipped appropriately when CONF.network\_feature\_enabled.ipv6
is False.
Closes-Bug: #1561857
Change-Id: I93f76b7f7cd94ff484d2e4507500af97578ac71a
(cherry picked from commit 61a5bcb52e23fa39839c30cb4f13f8a26e115516)
commit 38894cc7603f90ed8a5938e37fcc773c926fbfe4
Author: Eugene Nikanorov <enikanorov@mirantis.com>
Date: Mon Mar 21 20:05:47 2016 -0700
Retry updating agents table in case of deadlock
Updating agents table is contantious operation which
can fail often if mysql backend is in multimaster mode.
This could lead to agents flapping and various issues
such as sporadic reschedluing, port binding failures, etc.
Change-Id: Ief392f9a09d86c185dc086055d2cbc1891ff1d7f
Closes-Bug: #1560724
(cherry picked from commit d5e4013556c7144d347ece267c4bd3c8dc87b24f)
commit aac460b0a7fec68fbb173ac8899274809e254a7a
Author: Vladimir Eremin <veremin@mirantis.com>
Date: Thu Mar 17 19:32:29 2016 +0300
Allow to use several nics for physnet with SR-IOV
Accordind specs and docs, SRIOV\_NIC.physical\_device\_mappings is not
limited to be a 1-1 mapping between physnets and NICs. However,
implementation requires this. This bugfix unlocks 1-M mappings, so one
physnet could be managed by many NICs.
\* introduced unique\_keys in neutron.utils.parse\_mappings
\* SRIOV\_NIC.physical\_device\_mappings is parsed as dict with lists as
values with parse\_mappings(..., unique\_keys=False)
DocImpact
Change-Id: I07b8682fdfe8389a35893cc662b87c94a00bd4a5
Closes-Bug: #1558626
(cherry picked from commit 46ddaf4288a1cac44d8afc0525b4ecb3ae2186a3)
commit 90b9cd334b1b33df933bf1b61b38c6e087c431af
Author: Ihar Hrachyshka <ihrachys@redhat.com>
Date: Thu Mar 17 16:20:52 2016 +0100
port security: gracefully handle resources with no bindings
Resources could be created before the extension was enabled in the
setup. In that case, no bindings are created for them. In that case, we
should gracefully return default (True) value when extracting the value
using the mixin; and we should also create binding model on update
request, if there is no existing binding model for the resource.
While at it, introduced a constant to store the default value for port
security (True) and changed several tests to use the constant instead of
extracting it from extension resource map.
Change-Id: I8607cdecdc16c5f94635c94e2f02700c732806eb
Closes-Bug: #1509312
(cherry picked from commit b0519cf0ada3b3d9b76f84948f9ad3c142fc50be)
commit 7174bc4c2a0a31e9036ec130cb65f91d1e5009a4
Author: venkata anil <anil.venkata@enovance.com>
Date: Wed Mar 23 15:24:01 2016 +0000
Ignore exception when deleting linux bridge if doesn't exist
Linux bridge is not handling RuntimeError exception when it is trying
to delete network's bridge, which is deleted in parallel by nova.
Fullstack test has similar scenario, it creates network's bridge for
agent and deletes the bridge after the test, like nova.
Linux bridge agent has to ignore RuntimeError exception if the bridge
doesn't exist.
Closes-bug: #1561040
Change-Id: I428384fd42181ff6bc33f29369a7ff5ec163b532
(cherry picked from commit 16b2ffdfd85eece8fb57a98d10bf35ad617d235a)
commit 93d29d131c0234075ac547906f77900ce47cceec
Author: Clayton O'Neill <clayton.oneill@twcable.com>
Date: Thu Mar 24 14:59:41 2016 +0000
Don't delete br-int to br-tun patch on startup
When starting up, we don't want to delete the patch port between br-int
and br-tun unless we're also dropping the flows.. In liberty both of
these bridges were switched to not dump flows on startup and to put the
bridges in secure mode so that default flood flows are not installed
when the bridge is created.
Without this patch the patch port is torn down and not reinstalled until
br-tun is setup again.
Partial-Bug: #1514056
Change-Id: Ia518a99a2de5d1bda467fde57892c43970f88bcd
(cherry picked from commit 8dce6a5c873c2c18e5a9c6165bf3974aead02588)
commit 211e0a65a0cf637ab58a20c91791b7eb6b8c8519
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Mon Feb 29 16:20:05 2016 +0100
functional: Update ref used from ovs branch-2.5.
OVS 2.5.0 has been released, but we need a later commit on branch-2.5 that
fixes compilation with the latest kernel on ubuntu that backported some
changes that broke compilation of 2.5.0.
Change-Id: Id70db79a8450d4f0125dd500f7f6ab8d103d98c3
(cherry picked from commit 59b36ecca8f60996a60cd52f816573ace9b39309)
commit e2676ae8d188286b76f802d605f363e21011841a
Author: Kevin Benton <kevin@benton.pub>
Date: Fri Mar 25 12:37:12 2016 -0700
DVR: rebind port if ofport changes
When binding is called in DVR, check to see if the port was
previously wired under a different ofport. If it was, first
unbind the old port and then bind the new one.
Change-Id: I372158c4a6986295e396d849a2c9c5372b271e08
Closes-Bug: #1562467
(cherry picked from commit 4731dbbef1f615b9ce6d18315e8ca9810e8a772d)
commit c6ef57a6d5f0397b1abf865815bd71d40292f482
Author: Jakub Libosvar <libosvar@redhat.com>
Date: Wed Feb 24 16:34:07 2016 +0000
ovs-fw: Mark conntrack entries invalid if no rule is matched
This patch makes sure that existing connection breaks once security
group rule that allowed such connection is removed. Due to correctly
track connections on the same hypervisor, zones were changed from
per-port to per-network (based on port's vlan tag). This information is
now stored in register 6. Also there was added a test for RELATED
connections to avoid marking such connection as invalid by REPLY rules.
Closes-Bug: 1549370
Change-Id: Ibb5942a980ddd8f2dd7ac328e9559a80c05789bb
(cherry picked from commit 4f6aa3ffde2fd68b85bc5dfdaf6c2684931f3f61)
commit ef6ea62d5d1fc767a23e3caf2716e76f90d63f03
Author: Andreas Scheuring <andreas.scheuring@de.ibm.com>
Date: Wed Mar 9 13:56:22 2016 +0100
l3: Send notify on router\_create when ext gw is specified
A router that got created with an external gateway specified now
triggers a notfiy\_router\_updated event. This triggers scheduling
of the router and creation of the network namespace on the target
node.
Change-Id: I7f6ff5edf6a9c5ffa6d8978c1f3de0e106b6a8bb
Closes-Bug: #1535707
(cherry picked from commit da00d1a186c55c91887c9546e893f6d075a2c2ad)
commit eb8ddb95bbb56bbdc658e15feebbf7f91d5ddf13
Author: Oleg Bondarev <obondarev@mirantis.com>
Date: Tue Feb 16 18:03:52 2016 +0300
Move db query to fetch down bindings under try/except
In case of intermittent DB failures router and network auto-rescheduling
tasks may fail due to error on fetching down bindings from db.
Need to put this queries under try/except to prevent unexpected exit.
Closes-Bug: #1546110
Change-Id: Id48e899a5b3d906c6d1da4d03923bdda2681cd92
(cherry picked from commit b6ec40cbf754de9d189f843cbddfca67d4103ee3)
commit da1eee31057fb44ff758d99ac99eeb47b7caec6e
Author: Alex Oughton <alex.oughton@rackspace.com>
Date: Fri Mar 18 11:12:10 2016 -0500
Close XenAPI sessions in neutron-rootwrap-xen-dom0
Neutron with XenServer properly doesn't close XenAPI sessions.
If it creates these sessions so rapidly, the XenServer host eventually
exceeds its maximum allowed number of connections.
This patch adds a close process for session.
Closes-Bug: 1558721
Change-Id: Ida90a970c649745c492c28c41c4a151e4d940aa6
(cherry picked from commit 9d21b5ad7edbf9ac1fd9254e97f56966f25de8e6)
commit 1d51172babab64176716e723ae84f20e751a2ac3
Author: Kevin Benton <kevin@benton.pub>
Date: Thu Mar 17 05:19:19 2016 -0700
Watch for 'new' events in ovsdb monitor for ofport
This adjusts the event handling logic in the ovs interface
monitor to watch for 'new' events as well because this is
when ofports are assigned to the interface. Previously we
were only watching for 'insert' events, which would never
include the ofport so this led to every port being skipped
initially by the OVS agent and then picked up on the next
polling interval.
Closes-Bug: #1560464
Change-Id: I46ac508a839c6db779323d5afb083f3425f96e87
(cherry picked from commit 62e88623d977d28c113a1e29458621f82d48f6e5)
commit bd3e9c3b1e759d4296cdb9a816a63ef773ea5f63
Author: Stephen Eilert <stephen.eilert@hpe.com>
Date: Tue Mar 15 13:54:23 2016 -0700
Removes host file contents from DHCP agent logs
The change I3ad7864eeb2f959549ed356a1e34fa18804395cc addressed a
performance impact by removing logging calls from inside the loop that
creates the hosts file in memory. However, it also introduced the
dumping of said hosts file to the logs.
On deployments with a very high number of ports(>5K), this increases the
load of the node substantially. The problem is worse when a high number
of port updates is received in a short amount of time.
There is also the administrative burden caused by the sheer amount of
data being logged.
If the content of the host file is required for debugging purposes, it
can be found at /opt/stack/data/neutron/dhcp/<net-id>/host
This patch is trivial and only removes the logging of the file contents.
The 'building'/'done building' logging calls may still provide useful
information.
Change-Id: Ie176ef123c194c22dca0967a6acfb9a48c959e6c
Closes-Bug: 1557640
(cherry picked from commit ed7411fa1c4d6a26cea3a8737b3c29ce6ff64363)

[Ihar Hrachyshka (ihar-hrachyshka)](https://launchpad.net/~ihar-hrachyshka)
on 2016-05-27

| **tags**: | added: neutron-proactive-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2016-06-01:  [**Fix included in openstack/neutron 8.1.1**](/neutron/%2Bbug/1558658/comments/56) |  |  | [#56](/neutron/%2Bbug/1558658/comments/56) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 8.1.1 release.

This issue was fixed in the openstack/neutron 8.1.1 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Thierry Carrez (ttx)](https://launchpad.net/~ttx) wrote on 2016-06-01:  [**Fix included in openstack/neutron 7.1.0**](/neutron/%2Bbug/1558658/comments/57) |  |  | [#57](/neutron/%2Bbug/1558658/comments/57) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 7.1.0 release.

This issue was fixed in the openstack/neutron 7.1.0 release.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Doug Hellmann (doug-hellmann)](https://launchpad.net/~doug-hellmann) wrote on 2016-06-03:  [**Fix included in openstack/neutron 9.0.0.0b1**](/neutron/%2Bbug/1558658/comments/58) |  |  | [#58](/neutron/%2Bbug/1558658/comments/58) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 9.0.0.0b1 development milestone.

This issue was fixed in the openstack/neutron 9.0.0.0b1 development milestone.

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-10

| Changed in ossa: | |
| --- | --- |
| **status**: | Triaged → In Progress |

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-13

| **summary**: | Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests+ (CVE-2016-5362 and CVE-2016-5363) |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-06-14:  [**Related fix merged to ossa (master)**](/neutron/%2Bbug/1558658/comments/59) |  |  | [#59](/neutron/%2Bbug/1558658/comments/59) |
| --- | --- | --- | --- |

Reviewed: <https://review.openstack.org/301977>

Committed: <https://git.openstack.org/cgit/openstack/ossa/commit/?id=756540a726aa7309fcd7916c5f22ede66badeb1e>

Submitter: Jenkins

Branch: master

commit 756540a726aa7309fcd7916c5f22ede66badeb1e

Author: Tristan Cacqueray <email address hidden>

Date: Tue Apr 5 19:41:31 2016 -0400

Adds OSSA 2016-009 (CVE-2016-5362, CVE-2016-5363 and CVE-2015-8914)

Change-Id: Iad029108209fc631da286c777e8485106cea7f53

    Related-Bug: #1502933

    Related-Bug: #1558658

Reviewed: https://review.openstack.org/301977
Committed: https://git.openstack.org/cgit/openstack/ossa/commit/?id=756540a726aa7309fcd7916c5f22ede66badeb1e
Submitter: Jenkins
Branch: master
commit 756540a726aa7309fcd7916c5f22ede66badeb1e
Author: Tristan Cacqueray <tdecacqu@redhat.com>
Date: Tue Apr 5 19:41:31 2016 -0400
Adds OSSA 2016-009 (CVE-2016-5362, CVE-2016-5363 and CVE-2015-8914)
Change-Id: Iad029108209fc631da286c777e8485106cea7f53
Related-Bug: #1502933
Related-Bug: #1558658

[Tristan Cacqueray (tristan-cacqueray)](https://launchpad.net/~tristan-cacqueray)
on 2016-06-14

| **summary**: | - Security Groups do not prevent MAC and/or IPv4 spoofing in DHCP requests- (CVE-2016-5362 and CVE-2016-5363)+ [OSSA-2016-009] Security Groups do not prevent MAC and/or IPv4 spoofing+ in DHCP requests (CVE-2016-5362 and CVE-2016-5363) |
| --- | --- |
| Changed in ossa: | |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-07-05:  [**Change abandoned on neutron (master)**](/neutron/%2Bbug/1558658/comments/60) |  |  | [#60](/neutron/%2Bbug/1558658/comments/60) |
| --- | --- | --- | --- |

Change abandoned by Armando Migliaccio (<email address hidden>) on branch: master

Review: <https://review.openstack.org/315828>

Reason: This review is > 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.

Change abandoned by Armando Migliaccio (armamig@gmail.com) on branch: master
Review: https://review.openstack.org/315828
Reason: This review is > 4 weeks without comment, and failed Jenkins the last time it was checked. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.

[Ihar Hrachyshka (ihar-hrachyshka)](https://launchpad.net/~ihar-hrachyshka)
on 2016-10-07

| **tags**: | removed: neutron-proactive-backport-potential |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [OpenStack Infra (hudson-openstack)](https://launchpad.net/~hudson-openstack) wrote on 2016-11-10:  [**Fix included in openstack/neutron 2015.1.4**](/neutron/%2Bbug/1558658/comments/61) |  |  | [#61](/neutron/%2Bbug/1558658/comments/61) |
| --- | --- | --- | --- |

This issue was fixed in the openstack/neutron 2015.1.4 release.

This issue was fixed in the openstack/neutron 2015.1.4 release.

[Slavik Anikeyev (androidsmg8)](https://launchpad.net/~androidsmg8)
on 2018-07-23

| Changed in ossa: | |
| --- | --- |
| **assignee**: | nobody → Vyacheslav Anikeyev (slavik1991) |

[Jeremy Stanley (fungi)](https://launchpad.net/~fungi)
on 2018-07-24

| Changed in ossa: | |
| --- | --- |
| **assignee**: | Vyacheslav Anikeyev (slavik1991) → nobody |

[See full activity log](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/neutron/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

## Duplicates of this bug

* [Bug #1558674](https://bugs.launchpad.net/neutron/%2Bbug/1558674 "Security Groups do not prevent MAC spoofing with non-IP traffic")

You are
[not directly subscribed to this bug's notifications.](/neutron/%2Bbug/1558658/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [bug\_1558658.patch](https://bugs.launchpad.net/neutron/%2Bbug/1558658/%2Battachment/4611129/%2Bfiles/bug_1558658.patch)
  [Edit](/neutron/%2Bbug/1558658/%2Battachment/4611129 "Change patch details")

* [Add patch](/neutron/%2Bbug/1558658/%2Baddcomment?field.patch=on)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_5c4ec36d_20250125_232951.html ===




=== Content from www.redhat.com_d2b4eb63_20250126_124728.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from access.redhat.com_020692d5_20250125_232947.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2016:1474 - Security Advisory

Issued:
2016-07-20
Updated:
2016-07-20
# RHSA-2016:1474 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Low: openstack-neutron security, bug fix, and enhancement update

## Type/Severity

Security Advisory: Low

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2016%3A1474)

## Topic

An update for openstack-neutron is now available for Red Hat Enterprise Linux OpenStack Platform 7.0 (Kilo) for RHEL 7.

Red Hat Product Security has rated this update as having a security impact of Low. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

OpenStack Networking (neutron) is a pluggable, scalable, and API-driven system that provisions networking services to virtual machines. Its main function is to manage connectivity to and from virtual machines.

The following packages have been upgraded to a newer upstream version: openstack-neutron

Security Fix(es):

* Neutron functionality includes internal firewall management between networks. Due to the relaxed nature of particular rules, it is possible for machines on the same layer 2 networks to forge non-IP traffic, such as ARP and DHCP requests. (CVE-2015-8914, CVE-2016-5362, CVE-2016-5363)

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 7 x86\_64

## Fixes

* [BZ - 1311864](https://bugzilla.redhat.com/show_bug.cgi?id=1311864)
  - Neutron L3 Agent shows duplicate ports
* [BZ - 1345889](https://bugzilla.redhat.com/show_bug.cgi?id=1345889)
  - CVE-2016-5362 openstack-neutron: DHCP spoofing vulnerability
* [BZ - 1345891](https://bugzilla.redhat.com/show_bug.cgi?id=1345891)
  - CVE-2016-5363 openstack-neutron: MAC source address spoofing vulnerability
* [BZ - 1345892](https://bugzilla.redhat.com/show_bug.cgi?id=1345892)
  - CVE-2015-8914 openstack-neutron: ICMPv6 source address spoofing vulnerability
* [BZ - 1347428](https://bugzilla.redhat.com/show_bug.cgi?id=1347428)
  - neutron-meter-agent - makes traffic between internal networks NATed
* [BZ - 1350400](https://bugzilla.redhat.com/show_bug.cgi?id=1350400)
  - Rebase openstack-neutron to 2015.1.4

## CVEs

* [CVE-2015-8914](https://www.redhat.com/security/data/cve/CVE-2015-8914.html)
* [CVE-2016-5362](https://www.redhat.com/security/data/cve/CVE-2016-5362.html)
* [CVE-2016-5363](https://www.redhat.com/security/data/cve/CVE-2016-5363.html)

## References

* <http://www.redhat.com/security/updates/classification/#normal>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 7

| SRPM | |
| --- | --- |
| openstack-neutron-2015.1.4-2.el7ost.src.rpm | SHA-256: dd8607ab2800e66239a71d171f3668b66400926a051d4f214010e41bc02e4b94 |
| x86\_64 | |
| openstack-neutron-2015.1.4-2.el7ost.noarch.rpm | SHA-256: c044088592d4685eaefb59a8bdb52285b832e0afaf7312ef0b14958824cc8d60 |
| openstack-neutron-bigswitch-2015.1.4-2.el7ost.noarch.rpm | SHA-256: abf252218aa1cf55b6b60a15ae90c4db2384ae77f53175abaa9f7e5610c256ae |
| openstack-neutron-brocade-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 0c130d0e7b6331ad5710a08a477a68d8deb9964f538a7d6c58986d2c5fb556b7 |
| openstack-neutron-cisco-2015.1.4-2.el7ost.noarch.rpm | SHA-256: f9599e9775010deaeeb71404b913c54d8b3ba6db05a567ec794aa404993838ed |
| openstack-neutron-common-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 66ec8d2d744e0f1ef71e0c532f3ab3bc99b51645bef2cfcf34e481f684b2d0d1 |
| openstack-neutron-embrane-2015.1.4-2.el7ost.noarch.rpm | SHA-256: e683a31670f15329ba5ed9022a3add5f43c3d184ab082429c4084ad38306944d |
| openstack-neutron-ibm-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 72c7b31fca4b62402e9076bba25183bb26ae129589d271784f81e664fd0c511f |
| openstack-neutron-linuxbridge-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 5ff811034f70fdca5f16e51afa1445625a9d0a1b161dbc7cd9ce31323fce8cc3 |
| openstack-neutron-mellanox-2015.1.4-2.el7ost.noarch.rpm | SHA-256: fcb20ed45523650c1dc8a66235d965a4dfb9c63d0f2e8ba806d3099d6ca4f090 |
| openstack-neutron-metaplugin-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 485d0ae288b8764cdbf7f6431754d9556211dddc1d343ecd9a80b5764bea9941 |
| openstack-neutron-metering-agent-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 61262040b03b247db6302606be6230609ce099940d864ee8eeca0d4338fe79d3 |
| openstack-neutron-midonet-2015.1.4-2.el7ost.noarch.rpm | SHA-256: b4b8fb761a6dbad78c78be148f1e304b9a8aec5f7a8e309d9823aaed7a118840 |
| openstack-neutron-ml2-2015.1.4-2.el7ost.noarch.rpm | SHA-256: b61646fd256626d40f78f60ae899cc53c1ae1836f96bdc463d567c4770cd8107 |
| openstack-neutron-nec-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 5bf0efa809a3e0ad5a505cb8927f18c24f61ddbc0f33a5982b4e1e96688bc882 |
| openstack-neutron-nuage-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 6052b6f2b80db9066481b3370b8c3c152ab65138b70db85c44d43d25eca3e65f |
| openstack-neutron-ofagent-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 901fa368b2e401bcdbc3c77e455849ddb6b796a241376d0300945714d86c2898 |
| openstack-neutron-oneconvergence-nvsd-2015.1.4-2.el7ost.noarch.rpm | SHA-256: de3eee0721684ceaff4058a57a23d7699548d34cef92332ec3d228d0d5f5549e |
| openstack-neutron-opencontrail-2015.1.4-2.el7ost.noarch.rpm | SHA-256: fe57b1a0cf01a70db7d7fb78eafe76b77f9ee4d6bbad140e262cde2b9f03e47d |
| openstack-neutron-openvswitch-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 6c662c7f69702a52c55e380aa62368dbd7e40c9d6c80fc4e7e25ef0b88122b95 |
| openstack-neutron-ovsvapp-2015.1.4-2.el7ost.noarch.rpm | SHA-256: b741a3aa2a5ef7932d7f76ce8c30c4b61eda77475473ce159a6910e25467520f |
| openstack-neutron-plumgrid-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 7c4d3db796579119ebc1baa8b0f92ef2be847158fe9f6ad11668ce3201b3d786 |
| openstack-neutron-sriov-nic-agent-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 2dd359a6ca489b3ef018d4f56c81177b85e3f6305f6d6a7b07f567017f599821 |
| openstack-neutron-vmware-2015.1.4-2.el7ost.noarch.rpm | SHA-256: cdf698cdee2a6451309daf59d9bc470a45c97d0ef175a071e9e966dc25c83251 |
| python-neutron-2015.1.4-2.el7ost.noarch.rpm | SHA-256: dceb26d257b1fa238a25256d037eb8a858cbe46c3d40220748c9cf1933dae3de |
| python-neutron-tests-2015.1.4-2.el7ost.noarch.rpm | SHA-256: 5495f8fd3f007191917888fc31a0b3fa458d761dafe1494ed87bb84b4462fab0 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from launchpad.net_6f054491_20250126_124713.html ===

[Log in / Register](https://launchpad.net/~tris/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~tris)

## [GoTo](https://launchpad.net/~tris)

* Overview
* [Code](https://code.launchpad.net/~tris)
* [Bugs](https://bugs.launchpad.net/~tris)
* [Blueprints](https://blueprints.launchpad.net/~tris)
* [Translations](https://translations.launchpad.net/~tris)
* [Answers](https://answers.launchpad.net/~tris)

* [Related packages](https://launchpad.net/~tris/%2Brelated-packages)
* [Related projects](https://launchpad.net/~tris/%2Brelated-projects)

## User information

Launchpad Id:
tris

Email:
[Log in](%2Blogin) for email information.

Member since:
2005-10-05

Languages:

English

Time zone:

Europe/Zaporozhye
(UTC+0200)

Karma:
[0](https://launchpad.net/~tris/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

## Latest memberships

GoTo is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_6d822872_20250126_124723.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1350400)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1350400)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1350400)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1350400

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1350400**](show_bug.cgi?id=1350400)
- Rebase openstack-neutron to 2015.1.4

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Rebase openstack-neutron to 2015.1.4

| | [Keywords](describekeywords.cgi): | Rebase  ZStream | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Red Hat OpenStack | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Red Hat | | [Component:](describecomponents.cgi?product=Red Hat OpenStack "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | openstack-neutron | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 7.0 (Kilo) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | unspecified | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Target Release](page.cgi?id=fields.html#target_release): | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Nir Magnezi | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Alexander Stafeyev | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | Duplicates (1): | [1306508](show_bug.cgi?id=1306508 "CLOSED DUPLICATE - openstack-neutron package should be upgraded to latest kilo code base")  ([view as bug list](buglist.cgi?bug_id=1306508)) | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | | TreeView+ | [depends on](buglist.cgi?bug_id=1350400&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1350400&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-06-27 10:54 UTC by Nir Magnezi | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2016-07-20 23:54 UTC ([History](show_activity.cgi?id=1350400)) | | [CC List:](page.cgi?id=fields.html#cclist) | 6 users (show)  amuller chrisw nlevinki nyechiel qasims srevivo | | Fixed In Version: | openstack-neutron-2015.1.4-1.el7ost | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-07-20 23:54:37 UTC | | | Target Upstream Version: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474) | 0 | normal | SHIPPED\_LIVE | Low: openstack-neutron security, bug fix, and enhancement update | 2016-07-21 03:53:34 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1350400#c0)  Nir Magnezi    2016-06-27 10:54:58 UTC  ``` Rebase openstack-neutron to 2015.1.4   ```  [Comment 3](show_bug.cgi?id=1350400#c3)  Nir Magnezi    2016-06-30 11:27:22 UTC  ``` Rebase added the following:  d48147b OVS: Add mac spoofing filtering to flows d626eb2 Linux Bridge: Add mac spoofing filtering to ebtables 834ea6f DVR: rebind port if ofport changes 6854a9a Protect 'show' and 'index' with Retry decorator b0f6984 Iptables firewall prevent IP spoofed DHCP requests b69bce8 Prevent binding IPv6 addresses to Neutron interfaces 4858cd7 Ensure floating IPs only use IPv4 addresses 9d483ee Refactor and fix dummy process fixture d2447c5 Remove obsolete keepalived PID files before start 19bc45d Support Routes==2.3 9ba133d portsecurity_db_common: Access db columns in a consistent way 9b4b8d9 Move test_extend_port_dict_no_port_security to where it belongs to d552635 Update from global requirements a8b300a lb: avoid doing nova VIF work plumbing tap to qbr 6e80460 Check tap bridge timestamps to detect local changes 2b6c5f0 Move db query to fetch down bindings under try/except 1c96717 DHCP: Downgrade 'network has been deleted' logs 40ac921 L3 agent: log traceback on floating ip setup failure a58e667 Better message on allowed address pairs error 5390cc8 Make run_ofctl check for socket error fc3559b Unmarshall portinfo on update_fdb_entries calls af44923 Remove test_external_network_visibility b403b84 Catch DB reference errors in binding DVR ports 506b875 ML2: Downgrade 'no bound segment' warning 2b6d1bb Close XenAPI sessions in neutron-rootwrap-xen-dom0 9107376 Removes host file contents from DHCP agent logs d699a7e Downgrade "device not found" log message ae10ef0 Downgrade network not found log in DHCP RPC e39d561 Fixed L3 agent manual scheduling for HA routers 38dc081 DVR: when updating port's fixed_ips, update arp 964578a DVR:Fix _notify_l3_agent_new_port for proper arp update e14375d Documenting network_device_mtu in agents config files 3bc89c4 Update devstack plugin for dependent packages 5d920b8 Fix sanity check --no* BoolOpts abceda8 Revert "Explicitly select the version of testtools and fixtures" 40ae0d3 tests: disable process monitor before managers 7c1004e Correct insufficient name for external process in manager log 1c9e1fd Catch PortNotFound after HA router race condition c1a6fdb Make object creation methods in l3_hamode_db atomic e4fb128 ovs_lib: Fix a race between get_port_tag_dict and port removal 401f9ab Don't setup ARP protection on OVS for network ports 74bcec3 Log INFO message when setting admin state up flag to False for OVS port 7599186 Update HA router state if agent is not active da9f4f1 Add systemd notification after reporting initial state 686c885 Fix dvr_local_router.floating_ip_added_dist failure after agent restart 49ac0c4 Kill the vrrp orphan process when (re)spawn keepalived 25ba9bd Fix L3 HA with IPv6 b79ed67 Ensure that tunnels are fully reset on ovs restart 9d924ef Filter HA routers without HA interface and state 978390c Explicitly select the version of testtools and fixtures 4581c48 Notify about port create/update unconditionally 7da9b8d Raise RetryRequest on policy parent not found 0ef9e95 Updated from global requirements 26c9a66 Bump stable/kilo next version to 2015.1.4 608b541 Call _allocate_vr_id outside of transaction c6637ee move usage_audit to cmd/eventlet package e813812 Make port binding message on dead agents clear ca63e55 Force service provider relationships to load d65576d Add compatibility with iproute2 >= 4.0 cd978f8 Add transaction for setting agent_id in L3HARouterAgentPortBinding 8aca427 Skip bindings with agent_id=None 157aee0 Correct unwatch_log to support python <= 2.7.5 026e889 extend supported_extension_aliases for PLUMgrid plugin 249529b Fix pylint breakage for kilo branch 66d9b44 Adding security-groups unittests c2e55a1 Lower l2pop "isn't bound to any segement" log to debug a6059a8 Don't drop ARP table jump during OVS rewiring 80aa77b tox: pass TEMPEST_CONFIG_DIR envvar into api target environment 9f93faf Updated from global requirements 0fac32c Revert "Revert "Remove TEMPEST_CONFIG_DIR in the api tox env"" d2255ab Fix dvr update for subnet attach multi subnets 427c7dc Resolve issue where router can't be removed from L3-agent in dvr mode 30604c1 manual add/remove router for dvr_snat agent 5b40850 DVR: make sure snat portion is always scheduled when needed b0d40f4 DVR: fix router rescheduling on server side fcf6eaf OVS agent: handle deleted ports on each rpc_loop iteration d50a7f8 OVS agent: flush firewall rules for all deleted ports at once 6c3e15e Remove excessive fallback iptables ACCEPT rules a27b30d DHCP: protect against case when device name is None bc43214 DVR: fix router scheduling 754a013 Fix DVR interface delete by port when gateway is set 8e01105 Log end of router updates for delete branch 1578dcb Set security group provider rule for icmpv6 RA in DVR 314b2f6 Don't update metadata_proxy if metadata is not enabled 1f1499d Downgrade "extended * dict" log messages to debug fc34dbc Set ip_nonlocal_bind in namespace if it exists 223aafd Cache the ARP entries in L3 Agent for DVR 6308d78 The exception type is wrong and makes the except block not work 26fa0f9 L3 agent: use run_immediately parameter to sync after start 0a0b5c4 Always send status update for processed floating ips 30274d4 Kill conntrackd state on HA routers FIP disassociation f76a960 Fix inconsistency in DHCPv6 hosts and options generation 447d2cb Fix iptables comments for bare jump rules f419a5e usage_audit: Fix usage_audit to work with ML2 7776522 Open Kilo 2015.1.3 a2cf51e Fix fetching prevent_arp_spoofing from cfg in neutron-sanity-check 2051ffb Retry metadata request on connection refused error   ```  [Comment 4](show_bug.cgi?id=1350400#c4)  Nir Magnezi    2016-06-30 12:55:15 UTC  ``` *** [Bug 1306508](show_bug.cgi?id=1306508 "CLOSED DUPLICATE - openstack-neutron package should be upgraded to latest kilo code base") has been marked as a duplicate of this bug. ***   ```  [Comment 7](show_bug.cgi?id=1350400#c7)  nlevinki    2016-07-12 18:24:45 UTC  ``` RHOS7 puddle 07-07 is using rpm openstack-neutron-2015.1.4-2.el7ost.noarch which has the fix in. automation passed <https://rhos-jenkins.rhev-ci-vms.eng.rdu2.redhat.com/job/rhos-jenkins-rhos-7.0-puddle-rhel-7.2-multi-node-packstack-neutron-ml2-gre-rabbitmq-tempest-rpm-all/15/>   ```  [Comment 9](show_bug.cgi?id=1350400#c9)  errata-xmlrpc    2016-07-20 23:54:37 UTC  ``` Since the problem described in this bug report should be resolved in a recent advisory, it has been closed with a resolution of ERRATA.  For information on the advisory, and where to find the updated files, follow the link below.  If the solution does not work for you, open a new bug report.  [https://access.redhat.com/errata/RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1350400&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from launchpad.net_e1eee959_20250126_124712.html ===

[Log in / Register](https://launchpad.net/~dlundquist/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~dlundquist)

## [Dustin Lundquist](https://launchpad.net/~dlundquist)

* Overview
* [Code](https://code.launchpad.net/~dlundquist)
* [Bugs](https://bugs.launchpad.net/~dlundquist)
* [Blueprints](https://blueprints.launchpad.net/~dlundquist)
* [Translations](https://translations.launchpad.net/~dlundquist)
* [Answers](https://answers.launchpad.net/~dlundquist)

* [Related packages](https://launchpad.net/~dlundquist/%2Brelated-packages)
* [Related projects](https://launchpad.net/~dlundquist/%2Brelated-projects)

## User information

Launchpad Id:
dlundquist

Email:
[Log in](%2Blogin) for email information.

Member since:
2006-01-13

Signed Ubuntu Code of Conduct:
Yes

Languages:

English

OpenPGP keys:

4ACC78EE720F886C61E3053F97A378F273222299,
A3B21E1A2966712572205F796B192DA8F6ED4809

SSH keys:

[dustin@rigel](%2Bsshkeys)

Time zone:

America/Los\_Angeles
(UTC-0800)

Karma:
[0](https://launchpad.net/~dlundquist/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**dlundquist**
 on
**irc.freenode.net**

## Personal package archives

| [Backport testing](/~dlundquist/%2Barchive/ubuntu/backports) |
| --- |
| [Libwebsockets + libev](/~dlundquist/%2Barchive/ubuntu/lws) |
| [SNIProxy](/~dlundquist/%2Barchive/ubuntu/sniproxy) |

## Latest memberships

Dustin Lundquist is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_082dc741_20250126_124722.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1311864)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1311864)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1311864)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1311864

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1311864**](show_bug.cgi?id=1311864)
- Neutron L3 Agent shows duplicate ports

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Neutron L3 Agent shows duplicate ports

| | [Keywords](describekeywords.cgi): | ZStream | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Red Hat OpenStack | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Red Hat | | [Component:](describecomponents.cgi?product=Red Hat OpenStack "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | openstack-neutron | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 7.0 (Kilo) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | async | | [Target Release](page.cgi?id=fields.html#target_release): | 7.0 (Kilo) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | John Schwarz | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Alexander Stafeyev | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1273812](show_bug.cgi?id=1273812) | | TreeView+ | [depends on](buglist.cgi?bug_id=1311864&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1311864&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-02-25 08:57 UTC by Pablo Iranzo Gómez | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-11-14 07:29 UTC ([History](show_activity.cgi?id=1311864)) | | [CC List:](page.cgi?id=fields.html#cclist) | 10 users (show)  amuller astafeye chrisw jschluet jschwarz majopela nyechiel oblaut pablo.iranzo srevivo | | Fixed In Version: | openstack-neutron-2015.1.4-1.el7ost | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-07-20 23:53:55 UTC | | | Target Upstream Version: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | OpenStack gerrit | [143297](https://review.opendev.org/143297) | 0 | None | None | None | 2016-03-07 23:50:07 UTC | | OpenStack gerrit | [238122](https://review.opendev.org/238122) | 0 | None | None | None | 2016-03-02 02:25:50 UTC | | OpenStack gerrit | [296339](https://review.opendev.org/296339) | 0 | None | None | None | 2016-03-23 09:40:07 UTC | | Red Hat Product Errata | [RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474) | 0 | normal | SHIPPED\_LIVE | Low: openstack-neutron security, bug fix, and enhancement update | 2016-07-21 03:53:34 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1311864#c0)  Pablo Iranzo Gómez    2016-02-25 08:57:29 UTC  ``` Description of problem:  When executing `neutron l3-agent-list-hosting-router`:   +--------------------------------------+-------------+----------------+-------+----------+ | id                                   | host        | admin_state_up | alive | ha_state | +--------------------------------------+-------------+----------------+-------+----------+ | 04867f8c-5632-412a-8ce7-79bfccc2f620 | neutron-n-2 | True           | :-)   | active   |  *** | 8d24b6e8-fd63-4f84-93cd-9361ee5b9e4a | neutron-n-1 | True           | :-)   | standby  | | 04867f8c-5632-412a-8ce7-79bfccc2f620 | neutron-n-2 | True           | :-)   | active   |  *** | fb833e11-ce79-4287-bd6b-6ef5aeed5814 | neutron-n-0 | True           | :-)   | standby  | +--------------------------------------+-------------+----------------+-------+----------+  We see, for a 3 controller deployment, 3 different hosts, but 4 ports, in this case, the active port with same ID and same Host is listed as alive, active.   Version-Release number of selected component (if applicable): openstack-neutron-2015.1.2-9.el7ost.noarch openstack-neutron-common-2015.1.2-9.el7ost.noarch openstack-neutron-lbaas-2015.1.2-1.el7ost.noarch openstack-neutron-ml2-2015.1.2-9.el7ost.noarch openstack-neutron-openvswitch-2015.1.2-9.el7ost.noarch openstack-neutron-vpnaas-2015.1.2-1.el7ost.noarch python-neutron-2015.1.2-9.el7ost.noarch python-neutron-lbaas-2015.1.2-1.el7ost.noarch python-neutron-vpnaas-2015.1.2-1.el7ost.noarch python-neutronclient-2.4.0-2.el7ost.noarch    This was reported to also be happening on OSP6 version before it was upgraded to OSP7   ```  [Comment 3](show_bug.cgi?id=1311864#c3)  Miguel Angel Ajo    2016-02-25 09:10:35 UTC  ``` This could be related to the on-flight patches @assaf and @jschwarz are working on U/S to fix a few race conditions existing in the l3_ha part.   ```  [Comment 4](show_bug.cgi?id=1311864#c4)  John Schwarz    2016-02-25 09:51:05 UTC  ``` This is a different issue than what me and @assaf are working on U/S - we're dealing with not enough l3 ha ports, not too many.  I've looked at the attached logs but did not find anything about the port's UUID in question (04867f8c-5632-412a-8ce7-79bfccc2f620), so not a lot to go on. Pablo, can you perhaps try giving a rough outline of what scenario was running on the servers, so that we might be able to reproduce this?   ```  [Comment 5](show_bug.cgi?id=1311864#c5)  Pablo Iranzo Gómez    2016-02-25 09:57:57 UTC  ``` Hi John, I'm asking my customer on this, the background at the moment is that they had this in OSP6 and after the upgrade it's still there.  Not sure from the comments if this was cleaned up before upgrade or if it's an issue appearing in OSP6 and carried over to OSP7 setup.  Initial request from them was on how to properly clean this up and the availability implications of the cleaning procedure.  Thanks, Pablo   ```  [Comment 6](show_bug.cgi?id=1311864#c6)  Miguel Angel Ajo    2016-02-25 12:20:13 UTC  ``` One possible option could be to delete the specific agents via neutron client, and wait for heart beat to come back, so they are re-registered. But probably, that would also disassociate the routers from the agent.  @pablo, could we check that procedure/workaround in an OSP7:  1) Create a few routers, in HA 2) List l3-agent-list-hosting-router for one of the routers 3) Delete the agent holding the ACTIVE instance of the router 4) Wait for hearbeat to come back so agent appears in neutron agent-list again 5) List l3-agent-list-hosting-router for the same router as in (2) 6) If the agent is not there, we could do:        neutron l3-agent-router-add $agent-id $router 7) repeat 5 and verify the list is ok (2 agents backup, one active)  I believe such procedure would be harmless even if (6) happened, one of the backup routers would take the traffic until we do (7).  But it's better if we could verify this first.   ```  [Comment 7](show_bug.cgi?id=1311864#c7)  John Schwarz    2016-03-01 11:30:50 UTC  ``` I've added a patch that should be backported from upstream to the tracker. Once the upstream patch has been merged we can continue work on this patch.   ```  [Comment 16](show_bug.cgi?id=1311864#c16)  Assaf Muller    2016-06-04 20:09:19 UTC  ``` Please remember to flip this bug to MODIFIED with the appropriate 'Fixed in version' when you rebase OSP 7. Thank you.   ```  [Comment 17](show_bug.cgi?id=1311864#c17)  Nir Magnezi    2016-06-30 13:04:45 UTC  ``` The fix is incorporated in the rebase. See [bug 1350400](show_bug.cgi?id=1350400 "CLOSED ERRATA - Rebase openstack-neutron to 2015.1.4")   ```  [Comment 19](show_bug.cgi?id=1311864#c19)  Alexander Stafeyev    2016-07-11 08:49:24 UTC  ``` At this point there is no version to verify on.   Tnx   ```  [Comment 21](show_bug.cgi?id=1311864#c21)  Alexander Stafeyev    2016-07-11 12:44:49 UTC  ``` openstack-neutron-2015.1.4-2.el7ost.noarch  neutron l3-agent-list-hosting-router Router_eNet +--------------------------------------+------------------------------------+----------------+-------+----------+ | id                                   | host                               | admin_state_up | alive | ha_state | +--------------------------------------+------------------------------------+----------------+-------+----------+ | e0ad8091-ef57-4950-9e7d-7549cc529b1d | overcloud-controller-1.localdomain | True           | :-)   | standby  | | aa48e625-19a4-4a38-96d2-34e85fe7cf6c | overcloud-controller-2.localdomain | True           | :-)   | active   | | caef1d9c-d65b-4ea3-bd05-6814efc5c934 | overcloud-controller-0.localdomain | True           | :-)   | standby  | +--------------------------------------+------------------------------------+----------------+-------+----------+   [root@overcloud-controller-2 ~]# neutron l3-agent-router-remove caef1d9c-d65b-4ea3-bd05-6814efc5c934 Router_eNet Removed router Router_eNet from L3 agent [root@overcloud-controller-2 ~]# neutron l3-agent-list-hosting-router Router_eNet +--------------------------------------+------------------------------------+----------------+-------+----------+ | id                                   | host                               | admin_state_up | alive | ha_state | +--------------------------------------+------------------------------------+----------------+-------+----------+ | e0ad8091-ef57-4950-9e7d-7549cc529b1d | overcloud-controller-1.localdomain | True           | :-)   | standby  | | aa48e625-19a4-4a38-96d2-34e85fe7cf6c | overcloud-controller-2.localdomain | True           | :-)   | active   | +--------------------------------------+------------------------------------+----------------+-------+----------+   ```  [Comment 23](show_bug.cgi?id=1311864#c23)  errata-xmlrpc    2016-07-20 23:53:55 UTC  ``` Since the problem described in this bug report should be resolved in a recent advisory, it has been closed with a resolution of ERRATA.  For information on the advisory, and where to find the updated files, follow the link below.  If the solution does not work for you, open a new bug report.  [https://access.redhat.com/errata/RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1311864&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from answers.launchpad.net_bbf3e90b_20250126_124711.html ===

[Log in / Register](https://answers.launchpad.net/neutron/%2Blogin)

[![](https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png)](https://launchpad.net/neutron)

## [neutron](https://launchpad.net/neutron)

* [Overview](https://launchpad.net/neutron)
* [Code](https://code.launchpad.net/neutron)
* [Bugs](https://bugs.launchpad.net/neutron)
* [Blueprints](https://blueprints.launchpad.net/neutron)
* [Translations](https://translations.launchpad.net/neutron)
* Answers

# Questions for neutron

**Launchpad does not know where
neutron
tracks support requests.**

neutron questions are
tracked in:
[neutron in Ubuntu](/ubuntu/%2Bsource/neutron),
[neutron-fwaas in Ubuntu](/ubuntu/%2Bsource/neutron-fwaas),
[neutron-lbaas in Ubuntu](/ubuntu/%2Bsource/neutron-lbaas),
[neutron-vpnaas in Ubuntu](/ubuntu/%2Bsource/neutron-vpnaas),
[quantum in Ubuntu](/ubuntu/%2Bsource/quantum).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from review.openstack.org_acef15d3_20250126_124718.html ===




=== Content from bugzilla.redhat.com_d41869e6_20250126_124726.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1345889)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1345889)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1345889)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1345889

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1345889**](show_bug.cgi?id=1345889)
(CVE-2016-5362)
- [CVE-2016-5362](https://access.redhat.com/security/cve/CVE-2016-5362) openstack-neutron: DHCP spoofing vulnerability

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-5362 openstack-neutron: DHCP spoofing vulnerability

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-5362 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1349669](show_bug.cgi?id=1349669 "CLOSED EOL - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [fedora-all]") [1349670](show_bug.cgi?id=1349670 "CLOSED ERRATA - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [openstack-rdo]") [1350642](show_bug.cgi?id=1350642) [1350643](show_bug.cgi?id=1350643) [1350644](show_bug.cgi?id=1350644) [1350645](show_bug.cgi?id=1350645) [1350646](show_bug.cgi?id=1350646) [1350647](show_bug.cgi?id=1350647) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1345893](show_bug.cgi?id=1345893) | | TreeView+ | [depends on](buglist.cgi?bug_id=1345889&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1345889&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-06-13 11:40 UTC by Andrej Nemec | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:50 UTC ([History](show_activity.cgi?id=1345889)) | | [CC List:](page.cgi?id=fields.html#cclist) | 26 users (show)  aathomas abaron amuller aortega apevec apevec ayoung chrisw cvsbot-xmlrpc gmollett ihrachys jlibosva jschluet kbasil lhh lpeer majopela markmc nyechiel rbryant rk sclewis srevivo tdecacqu tsuter twilson | | Fixed In Version: |  | | | Doc Type: | Bug Fix | | | Doc Text: | Neutron functionality includes internal firewall management between networks. Due to the relaxed nature of particular rules, it is possible for machines on the same layer 2 networks to forge non-IP traffic, such as ARP and DHCP requests. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-07-21 01:18:46 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:1473](https://access.redhat.com/errata/RHSA-2016%3A1473) | 0 | normal | SHIPPED\_LIVE | Low: openstack-neutron security and bug fix update | 2016-07-21 03:53:43 UTC | | Red Hat Product Errata | [RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474) | 0 | normal | SHIPPED\_LIVE | Low: openstack-neutron security, bug fix, and enhancement update | 2016-07-21 03:53:34 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1345889#c0)  Andrej Nemec    2016-06-13 11:40:17 UTC  ``` A vulnerability in Neutron anti-spoof protection. By forging DHCP discovery messages or non-IP traffic, such as ARP or ICMPv6, an instance may spoof IP or MAC source addresses on attached networks resulting in denial of services and/or traffic interception. Moreover when L2population isn't used, other tenants attached to a shared network are also vulnerable. Neutron setups using the IPTables firewall driver are affected.  Upstream bug:  <https://bugs.launchpad.net/bugs/1558658>  References:  <http://seclists.org/oss-sec/2016/q2/519>   ```  [Comment 1](show_bug.cgi?id=1345889#c1)  Garth Mollett    2016-06-23 23:49:05 UTC  ```  Created openstack-neutron tracking bugs for this issue:  Affects: fedora-all [[bug 1349669](show_bug.cgi?id=1349669 "CLOSED EOL - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [fedora-all]")] Affects: openstack-rdo [[bug 1349670](show_bug.cgi?id=1349670 "CLOSED ERRATA - CVE-2015-8914 CVE-2016-5362 CVE-2016-5363 openstack-neutron: various flaws [openstack-rdo]")]   ```  [Comment 12](show_bug.cgi?id=1345889#c12)  errata-xmlrpc    2016-07-20 23:54:02 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 7.0 (Kilo) for RHEL 7  Via RHSA-2016:1474 [https://access.redhat.com/errata/RHSA-2016:1474](https://access.redhat.com/errata/RHSA-2016%3A1474)   ```  [Comment 13](show_bug.cgi?id=1345889#c13)  errata-xmlrpc    2016-07-20 23:55:28 UTC  ``` This issue has been addressed in the following products:    Red Hat OpenStack Platform 8.0 (Liberty)  Via RHSA-2016:1473 [https://access.redhat.com/errata/RHSA-2016:1473](https://access.redhat.com/errata/RHSA-2016%3A1473)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1345889&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from review.openstack.org_34589b3c_20250125_232951.html ===




=== Content from access.redhat.com_d148423e_20250125_232947.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2016:1473 - Security Advisory

Issued:
2016-07-20
Updated:
2016-07-20
# RHSA-2016:1473 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Low: openstack-neutron security and bug fix update

## Type/Severity

Security Advisory: Low

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2016%3A1473)

## Topic

An update for openstack-neutron is now available for Red Hat OpenStack Platform 8.0 (Liberty).

Red Hat Product Security has rated this update as having a security impact of Low. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

OpenStack Networking (neutron) is a pluggable, scalable, and API-driven system that provisions networking services to virtual machines. Its main function is to manage connectivity to and from virtual machines.

Security Fix(es):

* Neutron functionality includes internal firewall management between networks. Due to the relaxed nature of particular rules, it is possible for machines on the same layer 2 networks to forge non-IP traffic, such as ARP and DHCP requests. (CVE-2015-8914, CVE-2016-5362, CVE-2016-5363)

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 8 x86\_64

## Fixes

* [BZ - 1330778](https://bugzilla.redhat.com/show_bug.cgi?id=1330778)
  - Deadlock occurs when we turn on syslog and forking a process
* [BZ - 1345889](https://bugzilla.redhat.com/show_bug.cgi?id=1345889)
  - CVE-2016-5362 openstack-neutron: DHCP spoofing vulnerability
* [BZ - 1345891](https://bugzilla.redhat.com/show_bug.cgi?id=1345891)
  - CVE-2016-5363 openstack-neutron: MAC source address spoofing vulnerability
* [BZ - 1345892](https://bugzilla.redhat.com/show_bug.cgi?id=1345892)
  - CVE-2015-8914 openstack-neutron: ICMPv6 source address spoofing vulnerability

## CVEs

* [CVE-2015-8914](https://www.redhat.com/security/data/cve/CVE-2015-8914.html)
* [CVE-2016-5362](https://www.redhat.com/security/data/cve/CVE-2016-5362.html)
* [CVE-2016-5363](https://www.redhat.com/security/data/cve/CVE-2016-5363.html)

## References

* <http://www.redhat.com/security/updates/classification/#normal>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 8

| SRPM | |
| --- | --- |
| openstack-neutron-7.0.4-11.el7ost.src.rpm | SHA-256: 5b888f4c27ad051a2328416a8cdff215248f7b15e30f80b9b3fa33c395bff80e |
| x86\_64 | |
| openstack-neutron-7.0.4-11.el7ost.noarch.rpm | SHA-256: 06f9f9d28147c47bb22dd9e823e4d0128ffd080b78334e36b2a9cf32168b45db |
| openstack-neutron-bigswitch-7.0.4-11.el7ost.noarch.rpm | SHA-256: 717e44838fd313dac285fc422595f216bc69310657e16533d6f28e53abded088 |
| openstack-neutron-brocade-7.0.4-11.el7ost.noarch.rpm | SHA-256: 690e4251a2bf2c79fc723e0921fa5c543d03d04ab664e8b85e1ee45fc4ec59c0 |
| openstack-neutron-cisco-7.0.4-11.el7ost.noarch.rpm | SHA-256: 85f42a15f0098086ff932b3f025dfee5b589e6cff779a0836c508de708f7e853 |
| openstack-neutron-common-7.0.4-11.el7ost.noarch.rpm | SHA-256: 1f8cd1a290ed991eb19cee31cbee6ea32a7f1908062d821eea15b3591fd99e9d |
| openstack-neutron-dev-server-7.0.4-11.el7ost.noarch.rpm | SHA-256: 3c4f7380f0934ea01a7a2f8029913dee07537fa574f77a7a08ffcc331b78fd83 |
| openstack-neutron-embrane-7.0.4-11.el7ost.noarch.rpm | SHA-256: 24b9f810da763d9e2e939438070882878e61f9ecdd9076b6e70940da9df6f302 |
| openstack-neutron-linuxbridge-7.0.4-11.el7ost.noarch.rpm | SHA-256: 7608e17bd5dbf406812768a329aace44a5996c105de49ec7fc480aca6560ec4c |
| openstack-neutron-mellanox-7.0.4-11.el7ost.noarch.rpm | SHA-256: b0bab4bd1def6aa9f0260dd8b6a15a719273b610f77d0ff3c05cd6565d2eb36c |
| openstack-neutron-metering-agent-7.0.4-11.el7ost.noarch.rpm | SHA-256: 34e9c8198b2bf006aa013a13737d2af380b653d7689d528cce5abc60c773c7bb |
| openstack-neutron-midonet-7.0.4-11.el7ost.noarch.rpm | SHA-256: ac8f1e2de34fc869aee4baeb6d4f0cd1f29f033844abf9542740062ae3bf4f6a |
| openstack-neutron-ml2-7.0.4-11.el7ost.noarch.rpm | SHA-256: df2a451a659b0b96a85823f8ac22a29d33a217be849798fd085872237244cf76 |
| openstack-neutron-nuage-7.0.4-11.el7ost.noarch.rpm | SHA-256: 84b76762c2c3da8ab33951a3c1036fd938e1eb6171c0d1ee68125b07c215e49a |
| openstack-neutron-ofagent-7.0.4-11.el7ost.noarch.rpm | SHA-256: 78cb46372d8a7d610fe7dd7fca23ca91af7184800ab7017f4a6a160ca9528f76 |
| openstack-neutron-oneconvergence-nvsd-7.0.4-11.el7ost.noarch.rpm | SHA-256: 39a40ba0dc54c943cb329d0dc23ad01f85b6aa78d0399be58eb2d5150b86e7b9 |
| openstack-neutron-opencontrail-7.0.4-11.el7ost.noarch.rpm | SHA-256: 45267d0a4db3ce4975ba09cced14b6e901ffdaeedb21c69e6bc3cd4b97e52e36 |
| openstack-neutron-openvswitch-7.0.4-11.el7ost.noarch.rpm | SHA-256: 81de116b2b63497393eda0df4d02797937a8f05f50f2b5e18d57a2b50754f586 |
| openstack-neutron-ovsvapp-7.0.4-11.el7ost.noarch.rpm | SHA-256: 0b5faf52b8b7ce4be3e9c3674cbdefb49aaf7cd3fb2c6466d9f945b5b0f910d7 |
| openstack-neutron-rpc-server-7.0.4-11.el7ost.noarch.rpm | SHA-256: 043684642b95e49142805b0f2743d61a46abbd6ea265be818644d0fb0d0abb1c |
| openstack-neutron-sriov-nic-agent-7.0.4-11.el7ost.noarch.rpm | SHA-256: 73d7073ec1a70bff8b80b67f2d647a44dc8236dfbd1374718cf445d23071ccb4 |
| python-neutron-7.0.4-11.el7ost.noarch.rpm | SHA-256: 9551674a42f487b775bac248347c9cd718fe1039874eda471af1f2fff876152c |
| python-neutron-tests-7.0.4-11.el7ost.noarch.rpm | SHA-256: 41e471eae1fcdc7757657e34233e4cab4c03910765b62edaacae821c13b7208a |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from review.openstack.org_61ac6c5a_20250125_232951.html ===




=== Content from translations.launchpad.net_438d433b_20250126_124711.html ===

[Log in / Register](https://translations.launchpad.net/neutron/%2Blogin)

[![](https://launchpadlibrarian.net/337040413/OpenStack_Project_Neutron_mascot_64x64.png)](https://launchpad.net/neutron)

## [neutron](https://launchpad.net/neutron)

* [Overview](https://launchpad.net/neutron)
* [Code](https://code.launchpad.net/neutron)
* [Bugs](https://bugs.launchpad.net/neutron)
* [Blueprints](https://blueprints.launchpad.net/neutron)
* Translations
* [Answers](https://answers.launchpad.net/neutron)

# Translation overview

[Help for translations](https://help.launchpad.net/Translations)

**neutron does not use Launchpad
to translate its messages.**

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_c8c234a0_20250126_124730.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1330778)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1330778)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1330778)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1330778

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1330778**](show_bug.cgi?id=1330778)
- Deadlock occurs when we turn on syslog and forking a process

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Deadlock occurs when we turn on syslog and forking a process

| | [Keywords](describekeywords.cgi): | Triaged  ZStream | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Red Hat OpenStack | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Red Hat | | [Component:](describecomponents.cgi?product=Red Hat OpenStack "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | openstack-neutron | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 6.0 (Juno) | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Unspecified | | [Priority:](page.cgi?id=fields.html#priority) | urgent | | [Severity:](page.cgi?id=fields.html#bug_severity) | urgent | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | async | | [Target Release](page.cgi?id=fields.html#target_release): | 8.0 (Liberty) | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Jakub Libosvar | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") | Toni Freger | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") | hot | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1194008](show_bug.cgi?id=1194008) | | TreeView+ | [depends on](buglist.cgi?bug_id=1330778&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1330778&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-04-26 23:51 UTC by kahou | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-11-14 07:52 UTC ([History](show_activity.cgi?id=1330778)) | | [CC List:](page.cgi?id=fields.html#cclist) | 14 users (show)  aathomas amuller astafeye charcrou cheburge chrisw jdonohue jlibosva nyechiel oblaut pviktori skulkarn srevivo wlehman | | Fixed In Version: | openstack-neutron-7.0.4-8.el7ost | | | Doc Type: | Bug Fix | | | Doc Text: |  | | | Clone Of: |  | | | Clones: | [1346759](show_bug.cgi?id=1346759 "CLOSED ERRATA - Deadlock occurs when we turn on syslog and forking a process")  ([view as bug list](buglist.cgi?bug_id=1346759)) | | | Environment: |  | | | Last Closed: | 2016-07-20 23:55:21 UTC | | | Target Upstream Version: |  | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | | [**Neutron server runs into deadlock when syslog config is enabled**](attachment.cgi?id=1151143 "View the content of the attachment") (1.45 KB, text/plain)  [2016-04-26 23:51 UTC](#attach_1151143 "Go to the comment associated with the attachment"), kahou | *no flags* | [Details](attachment.cgi?id=1151143&action=edit) | | [**logging conf which run with deadlock\_syslog.py**](attachment.cgi?id=1151626 "View the content of the attachment") (1.44 KB, text/plain)  [2016-04-27 21:15 UTC](#attach_1151626 "Go to the comment associated with the attachment"), kahou | *no flags* | [Details](attachment.cgi?id=1151626&action=edit) | | [**script which reproduces the issue with syslog handler**](attachment.cgi?id=1151627 "View the content of the attachment") (745 bytes, text/plain)  [2016-04-27 21:16 UTC](#attach_1151627 "Go to the comment associated with the attachment"), kahou | *no flags* | [Details](attachment.cgi?id=1151627&action=edit) | | [View All](attachment.cgi?bugid=1330778&action=viewall) | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | OpenStack gerrit | [313277](https://review.opendev.org/313277) | 0 | None | None | None | 2016-06-08 13:18:04 UTC | | Python | [6721](https://bugs.python.org/issue6721) | 0 | None | None | None | 2016-05-03 12:46:36 UTC | | Red Hat Product Errata | [RHSA-2016:1473](https://access.redhat.com/errata/RHSA-2016%3A1473) | 0 | normal | SHIPPED\_LIVE | Low: openstack-neutron security and bug fix update | 2016-07-21 03:53:43 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1330778#c0)  kahou    2016-04-26 23:51:47 UTC  ``` Created [attachment 1151143](attachment.cgi?id=1151143 "Neutron server runs into deadlock when syslog config is enabled") [[details]](attachment.cgi?id=1151143&action=edit "Neutron server runs into deadlock when syslog config is enabled") Neutron server runs into deadlock when syslog config is enabled  Description of problem:  I was trying to turn on the syslog and corresponding configuration (see attached statement) for Neutron server but it doesn't create any consumer for the QPLUGIN queue. This causes all the Neutron agents stop functioning as it cannot communicate with the Neutron server.  Digging it deeper and looks like Neutron server fork the RPC worker when they create the QPLUGIN consumer. But since we use SyslogHandler which create lock in the critical section and this will cause deadlock when the child (Forked) process is trying to log message. Simialar explanation can be found here: <http://bugs.python.org/issue6721>  Even this issue above is opened against for Python 3, I can reproduce it by running the attached script (lock_fork_thread_deadlock_demo.py) in the issue in RH with Python 2.7.5 .   Version-Release number of selected component (if applicable):   How reproducible:  1. Save the attached logging.conf and in the neutron.conf, set the following under the DEFAULT section:  log_config=/etc/neutron/logging.conf logging_context_format_string="1 %(asctime)sZ mcp1.paslab013000.mc.metacloud.in neutron-server %(process)d - [MetaCloud@40521 levelname="%(levelname)s" component="neutron-server" funcname="%(name)s" request_id="%(request_id)s" user="%(user)s" tenant="%(tenant)s" instance="%(instance)s" lineno="%(pathname)s:%(lineno)d"] %(name)s %(message)s" logging_default_format_string="1 %(asctime)sZ mcp1.paslab013000.mc.metacloud.in neutron-server %(process)d - [MetaCloud@40521 levelname="%(levelname)s" component="neutron-server" funcname="%(name)s" instance="%(instance)s" lineno="%(pathname)s:%(lineno)d"] %(name)s %(message)s" logging_exception_prefix="!!!NL!!! %(process)d TRACE %(name)s %(instance)s"  2. Run neutron-server command like: /usr/bin/python2 /usr/bin/neutron-server --config-file /usr/share/neutron/neutron-dist.conf --config-dir /usr/share/neutron/server --config-file /etc/neutron/neutron.conf --config-file /etc/neutron/plugin.ini --config-dir /etc/neutron/conf.d/common --config-dir /etc/neutron/conf.d/neutron-server   3. Check qplugin queue in rabbitmq: sudo rabbitmqctl list_queues name messages messages_ready messages_unacknowledged consumers  You will notice that qplugin has 0 consumers  Also, check neutron agent-list, you will see all agents are reports as dead.   Steps to Reproduce: 1. 2. 3.  Actual results:   Expected results:   Additional info:   ```  [Comment 1](show_bug.cgi?id=1330778#c1)  Charles Crouch    2016-04-27 14:35:57 UTC  ``` I'm guessing we only started seeing this now because [https://bugzilla.redhat.com/show_bug.cgi?id=1322547](show_bug.cgi?id=1322547 "CLOSED ERRATA - oslo.log: Unintended assignment of \"syslog\"") just got fixed.   ```  [Comment 2](show_bug.cgi?id=1330778#c2)  kahou    2016-04-27 21:13:32 UTC  ``` I have attached a script which uses syslog handler and I can see the deadlock occurs in the child process.   ```  [Comment 3](show_bug.cgi?id=1330778#c3)  kahou    2016-04-27 21:15:43 UTC  ``` Created [attachment 1151626](attachment.cgi?id=1151626 "logging conf which run with deadlock_syslog.py") [[details]](attachment.cgi?id=1151626&action=edit "logging conf which run with deadlock_syslog.py") logging conf which run with deadlock_syslog.py   ```  [Comment 4](show_bug.cgi?id=1330778#c4)  kahou    2016-04-27 21:16:36 UTC  ``` Created [attachment 1151627](attachment.cgi?id=1151627 "script which reproduces the issue with syslog handler") [[details]](attachment.cgi?id=1151627&action=edit "script which reproduces the issue with syslog handler") script which reproduces the issue with syslog handler   ```  [Comment 5](show_bug.cgi?id=1330778#c5)  Charles Crouch    2016-04-28 14:30:40 UTC  ``` Just to clarify, while this problem was initially observed in Neutron, the subsequent reproduction steps which Kahou has posted don't utilize Neutron at all. Therefore marking this a python related bug.   ```  [Comment 10](show_bug.cgi?id=1330778#c10)  Assaf Muller    2016-06-08 13:18:43 UTC  ``` An upstream patch that solves the issue in Neutron was merged. We'll begin work on backporting it.   ```  [Comment 16](show_bug.cgi?id=1330778#c16)  Chet Burgess    2016-06-22 21:26:28 UTC  ``` Can you please provide a link to the upstream neutron commit that addresses this issue? Thank you.   ```  [Comment 17](show_bug.cgi?id=1330778#c17)  Jakub Libosvar    2016-06-23 07:56:30 UTC  ``` (In reply to Chet Burgess from [comment #16](show_bug.cgi?id=1330778#c16)) > Can you please provide a link to the upstream neutron commit that addresses > this issue? Thank you.  It's <https://review.openstack.org/#/c/313277/>   ```  [Comment 18](show_bug.cgi?id=1330778#c18)  Jakub Libosvar    2016-06-23 07:57:39 UTC  ``` <https://github.com/openstack/neutron/commit/483c5982c020ff21ceecf1d575c2d8fad2937d6e>   ```  [Comment 27](show_bug.cgi?id=1330778#c27)  Alexander Stafeyev    2016-07-07 07:18:40 UTC  ``` Hi Jakub what commit is the correct one ? the attached one has gaps   Tnx   ```  [Comment 29](show_bug.cgi?id=1330778#c29)  Jakub Libosvar    2016-07-07 08:38:03 UTC  ``` (In reply to Alexander Stafeyev from [comment #27](show_bug.cgi?id=1330778#c27)) > Hi Jakub > what commit is the correct one ? the attached one has gaps  >  > Tnx  Can you be more specific? What errors do you see?   ```  [Comment 30](show_bug.cgi?id=1330778#c30)  Toni Freger    2016-07-07 08:52:15 UTC  ``` The code tested on latest puddle  openstack-neutron-7.0.4-8.el7ost.noarch   ```  [Comment 32](show_bug.cgi?id=1330778#c32)  errata-xmlrpc    2016-07-20 23:55:21 UTC  ``` Since the problem described in this bug report should be resolved in a recent advisory, it has been closed with a resolution of ERRATA.  For information on the advisory, and where to find the updated files, follow the link below.  If the solution does not work for you, open a new bug report.  [https://access.redhat.com/errata/RHSA-2016:1473](https://access.redhat.com/errata/RHSA-2016%3A1473)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1330778&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)


