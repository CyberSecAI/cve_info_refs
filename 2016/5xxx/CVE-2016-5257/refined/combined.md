=== Content from www.debian.org_2c992b25_20250126_122143.html ===

[![Debian](../Pics/openlogo-50.png)](../ "Debian Home")

[Skip Quicknav](#content)

* [Blog](https://bits.debian.org/ "Bits from Debian")
* [Micronews](https://micronews.debian.org "Micronews from Debian")
* [Planet](https://planet.debian.org/ "The Planet of Debian")

[Security Information](./)
/
Debian security FAQ

# Debian security FAQ

1. [I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?](#buthow)- [The signature on your advisories does not verify correctly!](#signature)- [How is security handled in Debian?](#handling)- [Why are you fiddling with an old version of that package?](#oldversion)- [The version number for a package indicates that I am still running a vulnerable version!](#version)- [I received an advisory, but the build for one processor architecture seems to be missing.](#archismissing)- [How is security handled for unstable?](#unstable)- [How is security handled for testing?](#testing)- [How is security handled for contrib, non-free and non-free-firmware?](#contrib)- [The advisory says unstable is fixed in version 1.2.3-1, but unstable has 1.2.5-1, what's up?](#sidversionisold)- [Why are there no official mirrors for security.debian.org?](#mirror)- [I've seen DSA 100 and DSA 102, now where is DSA 101?](#missing)- [How can I reach the security team?](#contact)- [I guess I found a security problem, what should I do?](#discover)- [What am I supposed to do with a security problem in one of my packages?](#care)- [I tried to download a package listed in one of the security advisories, but I got a `file not found' error.](#enofile)- [I've got a bugfix, can I upload to security.debian.org directly?](#upload)- [I've got a bugfix, can I upload to proposed-updates instead?](#ppu)- [I'm pretty sure my packages are fine, how can I upload them?](#SecurityUploadQueue)- [How can I help with security?](#help)- [What is the scope of proposed-updates?](#proposed-updates)- [How is the security team composed?](#composing)- [How long will security updates be provided?](#lifespan)- [How can I check the integrity of packages?](#check)- [What to do if a random package breaks after a security update?](#break)- [What is a CVE identifier?](#cvewhat)- [Does Debian issue a DSA for every CVE id?](#cvedsa)- [Can Debian assign CVE identifiers?](#cveget)- [Does Debian have a vulnerability disclosure policy?](#disclosure-policy)- [Our vulnerability management tool has shown that the following issues are open (list of CVEs with random CVSS scores). When are those going to be fixed?](#cve-severity-assessment)- [What does local (remote) mean?](#localremote)

*Q: I received a DSA via debian-security-announce, how can I upgrade the vulnerable packages?*

A: As the DSA mail says, you should upgrade the packages affected by the
announced vulnerability. You can do this by just upgrading (after
updating the list of available packages with apt-get update)
every package in your system with apt-get upgrade or by
upgrading just a particular package, with apt-get install
*package*.

The announcement mail mentions the source package in which the vulnerability
was present. Therefore, you should update all the binary packages from
that source package. To check the binary packages to update, visit
https://packages.debian.org/src:*source-package-name* and
click on *[show ... binary packages]* for the distribution you
are updating.

It may also be necessary to restart a service or a running process. The
command [checkrestart](https://manpages.debian.org/checkrestart)
included in the package
[debian-goodies](https://packages.debian.org/debian-goodies)
might help to find which ones.

*Q: The signature on your advisories does not verify correctly!*

A: This is most likely a problem on your end. The
[debian-security-announce](https://lists.debian.org/debian-security-announce/)
list has a filter that only allows messages with a correct signature
from one of the security team members to be posted.

Most likely some piece of mail software on your end slightly changes
the message that breaks the signature. Make sure your software does
not do any MIME encoding or decoding, or tab/space conversions.

Known culprits are fetchmail (with the mimedecode option enabled),
formail (from procmail 3.14 only) and evolution.

*Q: How is security handled in Debian?*

A: Once the security team receives a notification of an incident,
one or more members review it and consider its impact on the stable
release of Debian (i.e. if it's vulnerable or not).
If our system is vulnerable, we work on a fix for the
problem. The package maintainer is contacted as well, if they didn't
contact the security team already. Finally, the fix is tested and
new packages are prepared, which are then compiled on all stable
architectures and uploaded afterwards. After all of that is done,
an advisory is published.

*Q: Why are you fiddling with an old version of that package?*

The most important guideline when making a new package that fixes a
security problem is to make as few changes as possible. Our users and
developers are relying on the exact behaviour of a release once it is made,
so any change we make can possibly break someone's system. This is
especially true in case of libraries: make sure you never change the
Application Program Interface (API) or Application Binary Interface (ABI),
no matter how small the change is.

This means that moving to a new upstream version is not a good solution,
instead the relevant changes should be backported. Generally upstream
maintainers are willing to help if needed, if not the Debian security team
might be able to help.

In some cases it is not possible to backport a security fix, for example
when large amounts of source code need to be modified or rewritten. If that
happens it might be necessary to move to a new upstream version, but this
has to be coordinated with the security team beforehand.

*Q: The version number for a package indicates that I am still running
a vulnerable version!*

A: Instead of upgrading to a new release we backport security fixes to
the version that was shipped in the stable release. The reason we do
this is to make sure that a release changes as little as possible
so things will not change or break unexpectedly as a result of a
security fix. You can check if you are running a secure version of
a package by looking at the package changelog, or comparing its
exact version number with the version indicated in the Debian
Security Advisory.

*Q: I received an advisory, but the build for one
processor architecture seems to be missing.*

A: Generally the Security Team releases an advisory with builds of the updated
packages for all architectures that Debian supports. However, some architectures
are slower than others and it may happen that builds for most architectures
are ready while some are still missing. These smaller archs represent a small
fraction of our user base. Depending on the urgency of the issue
we may decide to release the advisory forthwith. The missing builds will be
installed as soon as they come available, but no further notice of this will
be given. Of course we will never release an advisory where the i386 or amd64
builds are not present.

*Q: How is security handled for unstable?*

A: Security for unstable is primarily handled by package maintainers, not
by the Debian Security Team. Although the security team may upload
high-urgency security-only fixes when maintainers are noticed to be
inactive, support for stable will always have priority.
If you want to have a secure (and stable) server you are strongly encouraged
to stay with stable.

*Q: How is security handled for testing?*

A: Security for testing benefits from the security efforts of the entire
project for unstable. However, there is a minimum two-day migration delay,
and sometimes security fixes can be held up by transitions. The Security
Team helps to move along those transitions holding back important
security uploads, but this is not always possible and delays may occur.
Especially in the months after a new stable release, when many new versions
are uploaded to unstable, security fixes for testing may lag behind.
If you want to have a secure (and stable) server you are strongly
encouraged to stay with stable.

*Q: How is security handled for contrib,
non-free and non-free-firmware?*

A: The short answer is: it's not. Contrib, non-free and non-free-firmware aren't official
parts of the Debian Distribution and are not released, and thus not
supported by the security team. Some non-free packages are distributed
without source or without a license allowing the distribution of modified
versions. In those cases no security fixes can be made at all. If it
is possible to fix the problem, and the package maintainer or someone else
provides correct updated packages, then the security team will generally
process them and release an advisory.

*Q: The advisory says unstable is fixed in
version 1.2.3-1, but unstable has 1.2.5-1, what's up?*

A: We try to list the first version in unstable that fixed the problem.
Sometimes the maintainer has uploaded even newer versions in the meantime.
Compare the version in unstable with the version we indicate. If it's the
same or higher, you should be safe from this vulnerability. If you want to
be sure, you can check the package changelog with apt-get changelog
package-name and search for the entry announcing the fix.

*Q: Why are there no official mirrors for security.debian.org?*

A: Actually, there are. There are several official mirrors, implemented
through DNS aliases. The purpose of security.debian.org is to make security
updates available as quickly and easily as possible.

Encouraging the use of unofficial mirrors would add extra complexity
that is usually not needed and that can cause frustration if these
mirrors are not kept up to date.

*Q: I've seen DSA 100 and DSA 102, now where is DSA 101?*

A: Several vendors (mostly of GNU/Linux, but also of BSD
derivatives) coordinate security advisories for some incidents and
agree to a particular timeline so that all vendors are able to
release an advisory at the same time. This was decided in order to
not discriminate some vendors that need more time (e.g. when the
vendor has to pass packages through lengthy QA tests or has to
support several architectures or binary distributions). Our own
security team also prepares advisories in advance. Every now and
then, other security issues have to be dealt with before the parked
advisory could be released, and hence temporarily leaving out one or
more advisories by number.

*Q: How can I reach the security team?*

A: Security information can be sent to security@debian.org or
team@security.debian.org, both of which are read by the members of
the security team.

If desired, email can be encrypted with the Debian Security
Contact key (key ID [0x0D59D2B15144766A14D241C66BAF400B05C3E651](https://keyserver.ubuntu.com/pks/lookup?op=get&search=0x0d59d2b15144766a14d241c66baf400b05c3e651)). For the OpenPGP keys of individual team members, please
refer to the [keyring.debian.org](https://keyring.debian.org/)
keyserver.

*Q: I guess I found a security problem, what should I do?*

A: If you learn about a security problem, either in one of your own
packages or in someone else's please always contact the security team. If
the Debian security team confirms the vulnerability and other vendors are
likely to be vulnerable as well, they usually contact other vendors as
well. If the vulnerability is not yet public they will try to coordinate
security advisories with the other vendors, so all major distributions are
in sync.

If the vulnerability is already publicly known, be sure to file a bug
report in the Debian BTS, and tag it security.

If you are a Debian maintainer, [see below](#care).

*Q: What am I supposed to do with a security problem in one of
my packages?*

A: If you learn of a security problem, either in your package or
someone else's please always contact the security team via email at
team@security.debian.org. They keep track
of outstanding security problems, can help maintainers with
security problems or fix problems on their own, are responsible for
sending out security advisories and maintaining
security.debian.org.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

It's particularly important that you don't upload to any other
distribution other than unstable without prior agreement by the
security team, because bypassing them will cause confusion and more
work.

*Q: I tried to download a package listed in one of the security
advisories, but I got a `file not found' error.*

A: Whenever a newer bugfix supersedes an older package on
security.debian.org, chances are high that the old package will be
removed by the time the new one gets installed. Hence, you'll get
this `file not found' error. We don't want to distribute packages
with known security bugs longer than absolutely necessary.

Please use the packages from the latest security advisories, which are
distributed through the [debian-security-announce](https://lists.debian.org/debian-security-announce/) mailing list. It's best to simply run
`apt-get update` before upgrading the package.

*Q: I've got a bugfix, can I upload to security.debian.org directly?*

A: No, you can't. The archive at security.debian.org is maintained
by the security team, who have to approve all packages. You should
instead send patches or proper source packages to the security team
via team@security.debian.org. They will be
reviewed by the security team and eventually uploaded, either with
or without modifications.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I've got a bugfix, can I upload to proposed-updates instead?*

A: Technically speaking, you can. However, you should not do this,
since this interferes badly with the work of the security team.
Packages from security.debian.org will be copied into the
proposed-updates directory automatically. If a package with the
same or a higher version number is already installed into the
archive, the security update will be rejected by the archive
system. That way, the stable distribution will end up without a
security update for this package instead, unless the wrong
packages in the proposed-updates directory were rejected. Please contact the
security team instead and include all details of the vulnerability
and attach the source files (i.e. diff.gz and dsc files) to your mail.

The [Developer's Reference](../doc/developers-reference/pkgs.html#bug-security) has complete instructions on what to do.

*Q: I'm pretty sure my packages are fine,
how can I upload them?*

A: If you are very sure that your packages don't break anything, that the
version is sane (i.e. greater than the version in stable and less than the
version in testing/unstable), that you didn't change the behaviour of the
package, despite the corresponding security problem, that you compiled it
for the correct distribution (that is `oldstable-security` or
`stable-security`), that the package contains the original
source if the package is new on security.debian.org, that you can confirm
the patch against the most recent version is clean and only touches the
corresponding security problem (check with `interdiff -z` and
both `.diff.gz` files), that you have proofread the patch at
least thrice, and that `debdiff` doesn't display any changes,
you may upload the files into the incoming directory
`ftp://ftp.security.upload.debian.org/pub/SecurityUploadQueue` on the
security.debian.org directly. Please send a notification with all details
and links to team@security.debian.org as well.

*Q: How can I help with security?*

A: Please review each problem before reporting it to
security@debian.org. If you are able to provide patches, that
would speed up the process. Do not simply forward bugtraq mails,
because we already receive them — but do provide us with
additional information about things reported on bugtraq.

A good way to get started with security work is helping
out on the Debian Security Tracker ([instructions](https://security-tracker.debian.org/tracker/data/report)).

*Q: What is the scope of proposed-updates?*

A: This directory contains packages which are proposed to enter the
next revision of Debian stable. Whenever packages are uploaded by
a maintainer for the stable distribution, they end up in the
proposed-updates directory. Since stable is meant to be stable, no
automatic updates are made. The security team will upload fixed
packages mentioned in their advisories to stable, however they will
be placed in proposed-updates first. Every couple of months the
Stable Release Manager checks the list of packages in
proposed-updates and discusses whether a package is suited for
stable or not. This is compiled into another revision of stable
(e.g. 2.2r3 or 2.2r4). Packages that don't fit will probably be
rejected and dropped from proposed-updates as well.

Note that the packages uploaded by maintainers (not by the security team)
in the proposed-updates/ directory are not supported by the security
team.

*Q: How is the security team composed?*

A: The Debian security team consists of
[several officers and secretaries](../intro/organization#security).
The security team itself appoints people to join the team.

*Q: How long will security updates be provided?*

A: The security team will support a stable distribution for
three years after its release. It is not possible to support three
distributions; supporting two simultaneously is already difficult
enough.

*Q: How can I check the integrity of packages?*

A: This process involve checking the Release file signature against
the [public key](https://ftp-master.debian.org/keys.html) used for the archive. The Release file contains the
checksums of Packages and Sources files, which contain
checksums of binary and source packages. Detailed instruction on how
to check packages integrity can be found in the [Debian Securing Manual](../doc/manuals/securing-debian-howto/ch7#s-deb-pack-sign).

*Q: What to do if a random package breaks after a security update?*

A: First of all, you should figure out why the package breaks and
how it is connected to the security update, then contact the
security team if it is serious or the stable release manager if it
is less serious. We're talking about random packages that break
after a security update of a different package. If you can't
figure out what's going wrong but have a correction, talk to the
security team as well. You may be redirected to the stable release
manager though.

*Q: What is a CVE identifier?*

A: The Common Vulnerabilities and Exposures project assignes
unique names, called CVE identifiers, to specific security
vulnerabilities, to make it easier to uniquely refer to a specific
issue. More information can be found at [Wikipedia](https://en.wikipedia.org/wiki/Common_Vulnerabilities_and_Exposures).

*Q: Does Debian issue a DSA for every CVE id?*

A: The Debian security team keeps track of every issued CVE identifier,
connect it to the relevant Debian package and assess its impact in a
Debian context - the fact that something is assigned a CVE id does not
necessarily imply that the issue is a serious threat to a Debian system.
This information is tracked in the
[Debian Security Tracker](https://security-tracker.debian.org)
and for the issues that are considered serious a Debian Security Advisory
will be issued.

Low-impact issues not qualifying for a DSA can be fixed in the next
release of Debian, in a point release of the current stable or oldstable
distributions, or are included in a DSA when that is being issued for a
more serious vulnerability.

*Q: Can Debian assign CVE identifiers?*

A: Debian is a CVE Numbering Authority and can assign ids, but per
CVE policy only to yet-undisclosed issues. If you have an undisclosed
security vulnerability for software in Debian and would like to get an
identifier for it, contact the Debian Security Team. For cases where the
vulnerability is already public, we advise to follow the procedure
detailed in the [CVE OpenSource Request HOWTO](https://github.com/RedHatProductSecurity/CVE-HOWTO).

*Q: Does Debian have a vulnerability disclosure policy?*

A: Debian has published a [vulnerability
disclosure policy](disclosure-policy) as part of its participation in the CVE
program.

*Q: Our vulnerability management tool
has shown that the following issues are open (list of CVEs with random CVSS
scores). When are those going to be fixed?*

A: Debian does not provide CVSS scores and doesn't use CVSS scores from
external sources when triaging security issues.

You can check the state of every single CVE ID in the Debian Security Tracker by accessing
it by [ID](https://security-tracker.debian.org/tracker/CVE-ID).

The "Notes" section will contain additional information, e.g. that a security issue doesn't
warrant a Debian security update, but might get fixed in a subsequent point release.

A list of packages for which a Security update is planned can be found at the
[dsa-needed list](https://salsa.debian.org/security-tracker-team/security-tracker/raw/master/data/dsa-needed.txt).

If you find an error in triage data, you're very welcome to report it. The Debian Security Team will
however not generally react to requests asking for more specific information, you should instead contact
the vendor of your vulnerability management tool, after all they are the ones who alerted you about a
security issue and not Debian.

# Deprecated Debian security FAQ

*Q: What does local (remote) mean?*

**The field *Problem type* in DSA mails is not used since April 2014.**

A: Some advisories cover vulnerabilities that cannot be identified
with the classic scheme of local and remote exploitability. Some
vulnerabilities cannot be exploited from remote, i.e. don't
correspond to a daemon listening to a network port. If they can be
exploited by special files that could be provided via the network
while the vulnerable service is not permanently connected with the
network, we write local (remote) in such cases.

Such vulnerabilities are somewhat between local and remote
vulnerabilities and often cover archives that could be provided
through the network, e.g. as mail attachment or from a download
page.

---

Back to the [Debian Project homepage](../).

---

This page is also available in the following languages:
Select your language
dansk
Deutsch
español
français
Italiano
Nederlands
polski
Português
suomi
svenska
Русский (Russkij)
中文(简)
中文(HK)
中文(繁)
日本語 (Nihongo)

How to set [the default document language](../intro/cn)

---

**[Home](/)**

* [About](../intro/about)
  + [Social Contract](../social_contract)
  + [Code of Conduct](../code_of_conduct)
  + [Free Software](../intro/free)
  + [Legal Info](../legal)
* [Help Debian](../intro/help)

* [Getting Debian](../distrib/)
  + [Network install](../distrib/netinst)
  + [CD/USB ISO images](../CD/)
  + [Pure Blends](../blends/)
  + [Debian Packages](../distrib/packages)
  + [Developers' Corner](../devel/)

* [News](../News/)
  + [Project News](../News/weekly/)
  + [Events](../events/)
* [Documentation](../doc/)
  + [Release Info](../releases/)
  + [Debian Wiki](https://wiki.debian.org/)

* [Support](../support)
  + [Debian International](../international/)
  + [Security Information](../security/)
  + [Bug reports](../Bugs/)
  + [Mailing Lists](../MailingLists/)

* [Site map](../sitemap)
* [Search](https://search.debian.org/)
* [The Debian Blog](https://bits.debian.org)
* [Debian Micronews](https://micronews.debian.org)
* [Debian Planet](https://planet.debian.org)

See our [contact page](../contact) to get in touch. Web site source code is [available](https://salsa.debian.org/webmaster-team/webwml).

Last Modified: Fri, Oct 6 21:55:11 UTC 2023

Last Built: Sat, Jan 11 19:35:55 UTC 2025

Copyright © 1997-2023 [SPI](https://www.spi-inc.org/) and others; See [license terms](../license)

Debian is a registered [trademark](../trademark) of Software in the Public Interest, Inc.



=== Content from bugzilla.mozilla.org_1d195207_20250125_221230.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1288588)
* [XML](/show_bug.cgi?ctype=xml&id=1288588)

Closed
[Bug 1288588](/show_bug.cgi?id=1288588)

Opened 9 years ago
Closed 8 years ago

# PNG: heap-buffer-overflow crash [@MOZ\_PNG\_read\_filt\_row\_a]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

PNG: heap-buffer-overflow crash [@MOZ\_PNG\_read\_filt\_row\_a]

## Categories

### (Core :: Graphics: ImageLib, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Graphics%3A%20ImageLib#Graphics%3A%20ImageLib)

Graphics: ImageLib
▾

Core :: Graphics: ImageLib
ImageLib decodes GIF, JPEG and PNG images, and provides the decoded data to the Compositor for display. If Firefox or Seamonkey can display an image when loaded separately from the page, ImageLib is working, and the actual imaging bug exists elsewhere within Firefox or Seamonkey.

Examples of appropriate bugs: PNG gAMA chunk ignored; Crashes on GIF w/corrupted frame(merr-01.gif); or PNGs and JPEGs aren't displayed on FreeBSD.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20ImageLib&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Graphics%3A%20ImageLib&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Graphics%3A%20ImageLib)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla51

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | [-](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |
| firefox51 | [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | - | wontfix |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | fixed |
| firefox51 | + | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: posidron, Assigned: glennrp+bmo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d4e75acae35d32553f2e3a613f7fac1b?d=mm&size=40)  [glennrp+bmo](/user_profile?user_id=14419)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/9e7272cd8191f064be3b2b7dcd6a8903?d=mm&size=40)  [posidron](/user_profile?user_id=368570)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/0646a42110a02dd585f200f270716852?d=mm&size=40)  [tnikkel](/user_profile?user_id=255010)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[grizzly](/show_bug.cgi?id=1289609 "NEW - [meta] Bugs found while Fuzzing with Grizzly")

Dependency [tree](/showdependencytree.cgi?id=1288588&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1288588)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#a743179_75935 "8 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (7 files, 22 obsolete files)

| [Testcase](/attachment.cgi?id=8773580)  [9 years ago](#c1)  [Christoph Diehl [:posidron]](/user_profile?user_id=368570)   154.33 KB, application/octet-stream |  | [Details](/attachment.cgi?id=8773580&action=edit) |
| --- | --- | --- |
| [test\_case.png](/attachment.cgi?id=8776289)  [8 years ago](#c7)  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)   5.14 KB, image/png |  | [Details](/attachment.cgi?id=8776289&action=edit) |
| [v00-872626-crashtest](/attachment.cgi?id=8777180)  [8 years ago](#c10)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   2.83 KB, patch |  | [Details](/attachment.cgi?id=8777180&action=edit) | [Diff](/attachment.cgi?id=8777180&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777180) |
| [v00-1288588-part01-apng-bad-crc-pngdecoder](/attachment.cgi?id=8777283)  [8 years ago](#c14)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.51 KB, patch | glennrp+bmo : [review-](#a1099866_14419 "8 years ago") | [Details](/attachment.cgi?id=8777283&action=edit) | [Diff](/attachment.cgi?id=8777283&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777283) |
| [v00-1288588-part02-apng-bad-crc-crashtest](/attachment.cgi?id=8777286)  [8 years ago](#c15)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   2.84 KB, patch | RyanVM : [feedback-](#c17 "8 years ago") | [Details](/attachment.cgi?id=8777286&action=edit) | [Diff](/attachment.cgi?id=8777286&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777286) |
| [test\_case\_good\_crc.png](/attachment.cgi?id=8777362)  [8 years ago](#c18)  [Max Stepin](/user_profile?user_id=355876)   5.14 KB, image/png |  | [Details](/attachment.cgi?id=8777362&action=edit) |
| [v01-1288588-part02-apng-bad-crc-crashtests](/attachment.cgi?id=8777496)  [8 years ago](#c20)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   15.59 KB, patch | jrmuizel : [review+](#c26 "8 years ago") | [Details](/attachment.cgi?id=8777496&action=edit) | [Diff](/attachment.cgi?id=8777496&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777496) |
| [v00-1288588-beta-apng-bad-crc-pngdecoder](/attachment.cgi?id=8777497)  [8 years ago](#c21)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.23 KB, patch |  | [Details](/attachment.cgi?id=8777497&action=edit) | [Diff](/attachment.cgi?id=8777497&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777497) |
| [v00-1288588-part03-apng-bad-crc-pngset](/attachment.cgi?id=8777583)  [8 years ago](#c27)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.26 KB, patch |  | [Details](/attachment.cgi?id=8777583&action=edit) | [Diff](/attachment.cgi?id=8777583&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777583) |
| [v01-1288588-part03-apng-bad-crc-pngset](/attachment.cgi?id=8777593)  [8 years ago](#c28)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.32 KB, patch | jrmuizel : [review+](#a1707553_309398 "8 years ago") | [Details](/attachment.cgi?id=8777593&action=edit) | [Diff](/attachment.cgi?id=8777593&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777593) |
| [v00-1288588-part04-apng-bad-crc-apng-patch](/attachment.cgi?id=8777595)  [8 years ago](#c29)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.33 KB, patch | jrmuizel : [review+](#a1707560_309398 "8 years ago") | [Details](/attachment.cgi?id=8777595&action=edit) | [Diff](/attachment.cgi?id=8777595&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777595) |
| [v01-1288588-part01-apng-bad-crc-pngdecoder](/attachment.cgi?id=8777627)  [8 years ago](#c32)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   2.65 KB, patch |  | [Details](/attachment.cgi?id=8777627&action=edit) | [Diff](/attachment.cgi?id=8777627&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777627) |
| [v01-1288588-beta-apng-bad-crc-pngdecoder](/attachment.cgi?id=8777628)  [8 years ago](#c33)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   2.06 KB, patch |  | [Details](/attachment.cgi?id=8777628&action=edit) | [Diff](/attachment.cgi?id=8777628&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777628) |
| [v00-1288588-aurora-apng-bad-crc-pngdecoder](/attachment.cgi?id=8777629)  [8 years ago](#c34)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   2.17 KB, patch |  | [Details](/attachment.cgi?id=8777629&action=edit) | [Diff](/attachment.cgi?id=8777629&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777629) |
| [v02-1288588-part01-apng-bad-crc-pngdecoder](/attachment.cgi?id=8777848)  [8 years ago](#c36)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   2.66 KB, patch |  | [Details](/attachment.cgi?id=8777848&action=edit) | [Diff](/attachment.cgi?id=8777848&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777848) |
| [zero\_width\_frame.png](/attachment.cgi?id=8777962)  [8 years ago](#c37)  [Max Stepin](/user_profile?user_id=355876)   5.14 KB, image/png |  | [Details](/attachment.cgi?id=8777962&action=edit) |
| [v03-1288588-part01-apng-bad-crc-pngdecoder](/attachment.cgi?id=8778411)  [8 years ago](#c39)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   2.67 KB, patch |  | [Details](/attachment.cgi?id=8778411&action=edit) | [Diff](/attachment.cgi?id=8778411&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778411) |
| [v00-1288588-part05-apng-bad-crc-pnglibconf](/attachment.cgi?id=8778414)  [8 years ago](#c40)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.34 KB, patch | jrmuizel : [review+](#a1707535_309398 "8 years ago") | [Details](/attachment.cgi?id=8778414&action=edit) | [Diff](/attachment.cgi?id=8778414&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778414) |
| [v02-1288588-beta-apng-bad-fcTL-pngdecoder](/attachment.cgi?id=8778415)  [8 years ago](#c41)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.11 KB, patch | jrmuizel : [review+](#a1707476_309398 "8 years ago")  abillings : [approval-mozilla-beta+](#a2140106_280903 "8 years ago")  abillings : [sec-approval+](#a1884813_280903 "8 years ago") | [Details](/attachment.cgi?id=8778415&action=edit) | [Diff](/attachment.cgi?id=8778415&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778415) |
| [v01-1288588-aurora-apng-bad-fcTL-pngdecoder](/attachment.cgi?id=8778416)  [8 years ago](#c42)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.32 KB, patch | jrmuizel : [review+](#a1707526_309398 "8 years ago")  abillings : [approval-mozilla-aurora+](#a2140144_280903 "8 years ago")  abillings : [sec-approval+](#a1884819_280903 "8 years ago") | [Details](/attachment.cgi?id=8778416&action=edit) | [Diff](/attachment.cgi?id=8778416&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778416) |
| [v02-1288588-part02-apng-bad-crc-crashtest](/attachment.cgi?id=8778529)  [8 years ago](#c43)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   7.27 KB, patch | jrmuizel : [review+](#a1707381_309398 "8 years ago") | [Details](/attachment.cgi?id=8778529&action=edit) | [Diff](/attachment.cgi?id=8778529&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778529) |
| [v02-1288588-part03-apng-bad-crc-pngset](/attachment.cgi?id=8778579)  [8 years ago](#c44)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   21.35 KB, patch |  | [Details](/attachment.cgi?id=8778579&action=edit) | [Diff](/attachment.cgi?id=8778579&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778579) |
| [v04-1288588-part01-apng-bad-crc-pngdecoder](/attachment.cgi?id=8778660)  [8 years ago](#c48)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.41 KB, patch | jrmuizel : [review+](#a1707504_309398 "8 years ago") | [Details](/attachment.cgi?id=8778660&action=edit) | [Diff](/attachment.cgi?id=8778660&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778660) |
| [v03-1288588-part03-apng-bad-crc-pngset](/attachment.cgi?id=8780129)  [8 years ago](#c51)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.44 KB, patch |  | [Details](/attachment.cgi?id=8780129&action=edit) | [Diff](/attachment.cgi?id=8780129&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780129) |
| [v01-1288588-part04-apng-bad-crc-apng-patch](/attachment.cgi?id=8780130)  [8 years ago](#c52)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.43 KB, patch |  | [Details](/attachment.cgi?id=8780130&action=edit) | [Diff](/attachment.cgi?id=8780130&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780130) |
| [v01-1288588-part05-apng-bad-crc-pnglibconf](/attachment.cgi?id=8780131)  [8 years ago](#c53)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   844 bytes, patch |  | [Details](/attachment.cgi?id=8780131&action=edit) | [Diff](/attachment.cgi?id=8780131&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780131) |
| [v00-1288588-apng-bad-fcTL-combined.diff](/attachment.cgi?id=8780243)  [8 years ago](#c54)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   4.87 KB, patch |  | [Details](/attachment.cgi?id=8780243&action=edit) | [Diff](/attachment.cgi?id=8780243&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780243) |
| [v01-1288588-apng-bad-fcTL (combined)](/attachment.cgi?id=8780252)  [8 years ago](#c55)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   4.82 KB, patch | jrmuizel : [review+](#a1790335_309398 "8 years ago")  abillings : [sec-approval+](#a1884829_280903 "8 years ago") | [Details](/attachment.cgi?id=8780252&action=edit) | [Diff](/attachment.cgi?id=8780252&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780252) |
| [v00-1288588-esr45-apng-bad-fcTL-pngdecoder](/attachment.cgi?id=8780801)  [8 years ago](#c64)  [Glenn Randers-Pehrson](/user_profile?user_id=14419)   1.11 KB, patch | abillings : [approval-mozilla-esr45+](#a2140099_280903 "8 years ago")  abillings : [sec-approval+](#a2140099_280903 "8 years ago") | [Details](/attachment.cgi?id=8780801&action=edit) | [Diff](/attachment.cgi?id=8780801&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780801) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Christoph Diehl [:posidron]](/user_profile?user_id=368570)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1288588#c0)• 9 years ago |
|  | |

The following testcase crashes on en-us.linux-x86\_64-asan.tar.bz2 revision 0684715b032f06273416fdc554c071ee61a889db
See attachment.
Backtrace:
==5608==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x610000321503 at pc 0x7f5a6880760e bp 0x7f5a47afdaf0 sp 0x7f5a47afdae8
READ of size 16 at 0x610000321503 thread T32 (ImgDecoder #1)
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6481][GFX1]: Unknown image format 16 (t=286.938) |[6467][GFX1]: Unknown image format 16 (t=286.437) |[6468][GFX1]: Unknown image format 16 (t=286.471) |[6469][GFX1]: Unknown image format 16 (t=286.504) |[6470][GFX1]: Unknown image format 16 (t=286.537) |[6471][GFX1]: Unknown image format 16 (t=286.588) |[6472][GFX1]: Unknown image format 16 (t=286.604) |[6473][GFX1]: Unknown image format 16 (t=286.637) |[6474][GFX1]: Unknown image format 16 (t=286.671) |[6475][GFX1]: Unknown image format 16 (t=286.704) |[6476][GFX1]: Unknown image format 16 (t=286.737) |[6477][GFX1]: Unknown image format 16 (t=286.771) |[6478][GFX1]: Unknown image format 16 (t=286.804) |[6479][GFX1]: Unknown image format 16 (t=286.854) |[6480][GFX1]: Unknown image format 16 (t=286.888) [GFX1]: Unknown image format 16
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6481][GFX1]: Unknown image format 16 (t=286.938) |[6482][GFX1]: Unknown image format 16 (t=286.971) |[6468][GFX1]: Unknown image format 16 (t=286.471) |[6469][GFX1]:
[...]
Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#0 0x7f5a6880760d in MOZ\_PNG\_read\_filt\_row\_a /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngrutil.c:4017:31
#1 0x7f5a687e7b02 in MOZ\_PNG\_read\_filt\_row /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngrutil.c:4170:7
#2 0x7f5a687e7b02 in MOZ\_PNG\_push\_proc\_row /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:905
#3 0x7f5a687e71f6 in MOZ\_PNG\_proc\_IDAT\_data /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:873:13
#4 0x7f5a687df5fe in MOZ\_PNG\_push\_read\_IDAT /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:754:7
#5 0x7f5a687db137 in MOZ\_PNG\_proc\_some\_data /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:115:10
#6 0x7f5a687db137 in MOZ\_PNG\_process\_data /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:46
#7 0x7f5a622b7e69 in mozilla::image::nsPNGDecoder::ReadPNGData(char const\*, unsigned long) /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:379:3
#8 0x7f5a622b588f in operator() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:362:16
#9 0x7f5a622b588f in Lex<(lambda at /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:359:21)> /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/StreamingLexer.h:382
#10 0x7f5a622b588f in mozilla::image::nsPNGDecoder::DoDecode(mozilla::image::SourceBufferIterator&) /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:358
#11 0x7f5a6221d4ca in mozilla::image::Decoder::Decode(mozilla::NotNull<mozilla::image::IResumable\*>) /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/Decoder.cpp:155:44
#12 0x7f5a6222f996 in mozilla::image::DecodingTask::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/IDecodingTask.cpp:88:17
#13 0x7f5a6223d332 in mozilla::image::DecodePoolWorker::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/DecodePool.cpp:187:11
#14 0x7f5a5fa74b86 in nsThread::ProcessNextEvent(bool, bool\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/threads/nsThread.cpp:1068:7
#15 0x7f5a5faf2f6c in NS\_ProcessNextEvent(nsIThread\*, bool) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/glue/nsThreadUtils.cpp:290:10
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6603][GFX1]: Unknown image format 16 (t=290.705) |[6604][GFX1]: Unknown image format 16 (t=290.738) |[6605][GFX1]: Unknown image format 16 (t=290.771) |[6606][GFX1]: Unknown image format 16 (t=290.805) |[6607][GFX1]: Unknown image format 16 (t=290.854) |[6608][GFX1]: Unknown image format 16 (t=290.871) |[6609][GFX1]: Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#16 0x7f5a6084090c in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/glue/MessagePump.cpp:354:20
#17 0x7f5a607b3d28 in RunInternal /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:232:3
#18 0x7f5a607b3d28 in RunHandler /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:225
#19 0x7f5a607b3d28 in MessageLoop::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:205
#20 0x7f5a5fa6fea1 in nsThread::ThreadFunc(void\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/threads/nsThread.cpp:463:5
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6604][GFX1]: Unknown image format 16 (t=290.738) |[6605][GFX1]: Unknown image format 16 (t=290.771) |[6606][GFX1]: Unknown image format 16 (t=290.805) |[6607][GFX1]: Unknown image format 16 (t=290.854) |[6608][GFX1]: Unknown image format 16 (t=290.871) |[6609][GFX1]: Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#21 0x7f5a76ba3378 in \_pt\_root /builds/slave/m-in-l64-asan-0000000000000000/build/src/nsprpub/pr/src/pthreads/ptthread.c:216:5
#22 0x7f5a7a115181 in start\_thread (/lib/x86\_64-linux-gnu/libpthread.so.0+0x8181)
0x610000321503 is located 10 bytes to the right of 185-byte region [0x610000321440,0x6100003214f9)
allocated by thread T32 (ImgDecoder #1) here:
#0 0x4b247b in malloc /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_malloc\_linux.cc:52:3
#1 0x7f5a687f1452 in MOZ\_PNG\_malloc\_base /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngmem.c:95:17
#2 0x7f5a687f1452 in MOZ\_PNG\_malloc /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngmem.c:179
#3 0x7f5a687f1452 in MOZ\_PNG\_read\_start\_row /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngrutil.c:4673
#4 0x7f5a687f0e87 in MOZ\_PNG\_read\_update\_info /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngread.c:350:10
#5 0x7f5a622b1aa3 in mozilla::image::nsPNGDecoder::info\_callback(png\_struct\_def\*, png\_info\_def\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:648:3
#6 0x7f5a687dd51f in MOZ\_PNG\_push\_have\_info /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:1189:7
#7 0x7f5a687dd51f in MOZ\_PNG\_push\_read\_chunk /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:351
#8 0x7f5a687db12b in MOZ\_PNG\_proc\_some\_data /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:109:10
#9 0x7f5a687db12b in MOZ\_PNG\_process\_data /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngpread.c:46
#10 0x7f5a622b7e69 in mozilla::image::nsPNGDecoder::ReadPNGData(char const\*, unsigned long) /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:379:3
#11 0x7f5a622b588f in operator() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:362:16
#12 0x7f5a622b588f in Lex<(lambda at /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:359:21)> /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/StreamingLexer.h:382
#13 0x7f5a622b588f in mozilla::image::nsPNGDecoder::DoDecode(mozilla::image::SourceBufferIterator&) /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/decoders/nsPNGDecoder.cpp:358
#14 0x7f5a6221d4ca in mozilla::image::Decoder::Decode(mozilla::NotNull<mozilla::image::IResumable\*>) /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/Decoder.cpp:155:44
#15 0x7f5a6222f996 in mozilla::image::DecodingTask::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/IDecodingTask.cpp:88:17
#16 0x7f5a6223d332 in mozilla::image::DecodePoolWorker::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/DecodePool.cpp:187:11
#17 0x7f5a5fa74b86 in nsThread::ProcessNextEvent(bool, bool\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/threads/nsThread.cpp:1068:7
#18 0x7f5a5faf2f6c in NS\_ProcessNextEvent(nsIThread\*, bool) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/glue/nsThreadUtils.cpp:290:10
#19 0x7f5a6084090c in mozilla::ipc::MessagePumpForNonMainThreads::Run(base::MessagePump::Delegate\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/glue/MessagePump.cpp:354:20
#20 0x7f5a607b3d28 in RunInternal /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:232:3
#21 0x7f5a607b3d28 in RunHandler /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:225
#22 0x7f5a607b3d28 in MessageLoop::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:205
#23 0x7f5a5fa6fea1 in nsThread::ThreadFunc(void\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/threads/nsThread.cpp:463:5
#24 0x7f5a76ba3378 in \_pt\_root /builds/slave/m-in-l64-asan-0000000000000000/build/src/nsprpub/pr/src/pthreads/ptthread.c:216:5
#25 0x7f5a7a115181 in start\_thread (/lib/x86\_64-linux-gnu/libpthread.so.0+0x8181)
Thread T32 (ImgDecoder #1) created by T0 here:
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6605][GFX1]: Unknown image format 16 (t=290.771) |[6606][GFX1]: Unknown image format 16 (t=290.805) |[6607][GFX1]: Unknown image format 16 (t=290.854) |[6608][GFX1]: Unknown image format 16 (t=290.871) |[6609][GFX1]: Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#0 0x49a839 in \_\_interceptor\_pthread\_create /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_interceptors.cc:238:3
#1 0x7f5a76b9ff3f in \_PR\_CreateThread /builds/slave/m-in-l64-asan-0000000000000000/build/src/nsprpub/pr/src/pthreads/ptthread.c:457:14
#2 0x7f5a76b9fb4a in PR\_CreateThread /builds/slave/m-in-l64-asan-0000000000000000/build/src/nsprpub/pr/src/pthreads/ptthread.c:548:12
#3 0x7f5a5fa7162b in nsThread::Init() /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/threads/nsThread.cpp:634:8
#4 0x7f5a5fa78d4f in nsThreadManager::NewThread(unsigned int, unsigned int, nsIThread\*\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/threads/nsThreadManager.cpp:253:17
#5 0x7f5a5faf1f5e in NS\_NewThread(nsIThread\*\*, nsIRunnable\*, unsigned int) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/glue/nsThreadUtils.cpp:64:5
#6 0x7f5a6221ad98 in mozilla::image::DecodePool::DecodePool() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/DecodePool.cpp:263:19
#7 0x7f5a6221a310 in Singleton /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/DecodePool.cpp:220:22
#8 0x7f5a6221a310 in mozilla::image::DecodePool::Initialize() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/DecodePool.cpp:212
#9 0x7f5a62273ce5 in mozilla::image::EnsureModuleInitialized() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/build/nsImageModule.cpp:103:3
#10 0x7f5a621d5b01 in imgLoader::CreateImageLoader() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/imgLoader.cpp:1147:3
#11 0x7f5a621d5dd8 in imgLoader::NormalLoader() /builds/slave/m-in-l64-asan-0000000000000000/build/src/image/imgLoader.cpp:1159:21
#12 0x7f5a6236dc76 in GetImgLoaderForDocument /builds/slave/m-in-l64-asan-0000000000000000/build/src/dom/base/nsContentUtils.cpp:3136:22
#13 0x7f5a6236dc76 in nsContentUtils::LoadImage(nsIURI\*, nsINode\*, nsIDocument\*, nsIPrincipal\*, nsIURI\*, mozilla::net::ReferrerPolicy, imgINotificationObserver\*, int, nsAString\_internal const&, imgRequestProxy\*\*, unsigned int) /builds/slave/m-in-l64-asan-0000000000000000/build/src/dom/base/nsContentUtils.cpp:3188
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6606][GFX1]: Unknown image format 16 (t=290.805) |[6607][GFX1]: Unknown image format 16 (t=290.854) |[6608][GFX1]: Unknown image format 16 (t=290.871) |[6609][GFX1]: Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#14 0x7f5a665abe33 in mozilla::css::ImageLoader::LoadImage(nsIURI\*, nsIPrincipal\*, nsIURI\*, mozilla::css::ImageValue\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/ImageLoader.cpp:262:17
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6607][GFX1]: Unknown image format 16 (t=290.854) |[6608][GFX1]: Unknown image format 16 (t=290.871) |[6609][GFX1]: Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#15 0x7f5a66669696 in mozilla::css::ImageValue::ImageValue(nsIURI\*, nsStringBuffer\*, nsIURI\*, nsIPrincipal\*, nsIDocument\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsCSSValue.cpp:2655:3
#16 0x7f5a66663365 in nsCSSValue::StartImageLoad(nsIDocument\*) const /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsCSSValue.cpp:746:9
#17 0x7f5a666c1ea9 in TryToStartImageLoadOnValue(nsCSSValue const&, nsIDocument\*, nsStyleContext\*, nsCSSProperty, bool) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsCSSDataBlock.cpp:83:5
#18 0x7f5a666c1d23 in TryToStartImageLoad(nsCSSValue const&, nsIDocument\*, nsStyleContext\*, nsCSSProperty, bool) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsCSSDataBlock.cpp:118:7
#19 0x7f5a66619e0d in MapSinglePropertyInto(nsCSSProperty, nsCSSValue const\*, nsCSSValue\*, nsRuleData\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsCSSDataBlock.cpp:171:5
#20 0x7f5a66618f70 in nsCSSCompressedDataBlock::MapRuleInfoInto(nsRuleData\*) const /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsCSSDataBlock.cpp:318:9
#21 0x7f5a6657cb3c in mozilla::css::Declaration::MapRuleInfoInto(nsRuleData\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/Declaration.cpp:98:3
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6608][GFX1]: Unknown image format 16 (t=290.871) |[6609][GFX1]: Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#22 0x7f5a6677817b in nsRuleNode::WalkRuleTree(nsStyleStructID, nsStyleContext\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsRuleNode.cpp:2354:7
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6623][GFX1]: Unknown image format 16 (t=291.404) |[6609][GFX1]: Unknown image format 16 (t=290.904) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#23 0x7f5a669a4b41 in GetStyleBackground<true> /builds/slave/m-in-l64-asan-0000000000000000/build/src/obj-firefox/dist/include/nsStyleStructList.h:81:1
#24 0x7f5a669a4b41 in DoGetStyleBackground<true> /builds/slave/m-in-l64-asan-0000000000000000/build/src/obj-firefox/dist/include/nsStyleStructList.h:81
#25 0x7f5a669a4b41 in StyleBackground /builds/slave/m-in-l64-asan-0000000000000000/build/src/obj-firefox/dist/include/nsStyleStructList.h:81
#26 0x7f5a669a4b41 in StartBackgroundImageLoads /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/style/nsStyleContext.h:429
#27 0x7f5a669a4b41 in nsCSSFrameConstructor::ConstructFramesFromItem(nsFrameConstructorState&, nsCSSFrameConstructor::FrameConstructionItemList::Iterator&, nsContainerFrame\*, nsFrameItems&) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:6082
#28 0x7f5a66992112 in ConstructFramesFromItemList /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:10520:5
#29 0x7f5a66992112 in nsCSSFrameConstructor::CreateAnonymousFrames(nsFrameConstructorState&, nsIContent\*, nsContainerFrame\*, PendingBinding\*, nsFrameItems&) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:4150
#30 0x7f5a6698e7f4 in nsCSSFrameConstructor::BeginBuildingScrollFrame(nsFrameConstructorState&, nsIContent\*, nsStyleContext\*, nsContainerFrame\*, nsIAtom\*, bool, nsContainerFrame\*&) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:4564:3
#31 0x7f5a6698b4b5 in nsCSSFrameConstructor::SetUpDocElementContainingBlock(nsIContent\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:2891:25
#32 0x7f5a669870ca in nsCSSFrameConstructor::ConstructDocElementFrame(mozilla::dom::Element\*, nsILayoutHistoryState\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:2411:3
#33 0x7f5a669aaf97 in nsCSSFrameConstructor::ContentRangeInserted(nsIContent\*, nsIContent\*, nsIContent\*, nsILayoutHistoryState\*, bool) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsCSSFrameConstructor.cpp:7653:7
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6623][GFX1]: Unknown image format 16 (t=291.404) |[6624][GFX1]: Unknown image format 16 (t=291.421) |[6610][GFX1]: Unknown image format 16 (t=290.937) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6623][GFX1]: Unknown image format 16 (t=291.404) |[6624][GFX1]: Unknown image format 16 (t=291.421) |[6625][GFX1]: Unknown image format 16 (t=291.438) |[6611][GFX1]: Unknown image format 16 (t=290.954) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6623][GFX1]: Unknown image format 16 (t=291.404) |[6624][GFX1]: Unknown image format 16 (t=291.421) |[6625][GFX1]: Unknown image format 16 (t=291.438) |[6626][GFX1]: Unknown image format 16 (t=291.455) |[6612][GFX1]: Unknown image format 16 (t=290.988) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#34 0x7f5a66b489d7 in PresShell::Initialize(int, int) /builds/slave/m-in-l64-asan-0000000000000000/build/src/layout/base/nsPresShell.cpp:1726:7
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6623][GFX1]: Unknown image format 16 (t=291.404) |[6624][GFX1]: Unknown image format 16 (t=291.421) |[6625][GFX1]: Unknown image format 16 (t=291.438) |[6626][GFX1]: Unknown image format 16 (t=291.455) |[6627][GFX1]: Unknown image format 16 (t=291.488) |[6613][GFX1]: Unknown image format 16 (t=291.021) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#35 0x7f5a6268fbc1 in nsContentSink::StartLayout(bool) /builds/slave/m-in-l64-asan-0000000000000000/build/src/dom/base/nsContentSink.cpp:1210:19
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6623][GFX1]: Unknown image format 16 (t=291.404) |[6624][GFX1]: Unknown image format 16 (t=291.421) |[6625][GFX1]: Unknown image format 16 (t=291.438) |[6626][GFX1]: Unknown image format 16 (t=291.455) |[6627][GFX1]: Unknown image format 16 (t=291.488) |[6628][GFX1]: Unknown image format 16 (t=291.522) |[6614][GFX1]: Unknown image format 16 (t=291.037) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#36 0x7f5a61a2a426 in nsHtml5TreeOpExecutor::StartLayout() /builds/slave/m-in-l64-asan-0000000000000000/build/src/parser/html/nsHtml5TreeOpExecutor.cpp:612:3
#37 0x7f5a61a36b7e in nsHtml5TreeOperation::Perform(nsHtml5TreeOpExecutor\*, nsIContent\*\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/parser/html/nsHtml5TreeOperation.cpp:990:7
#38 0x7f5a61a27d77 in nsHtml5TreeOpExecutor::RunFlushLoop() /builds/slave/m-in-l64-asan-0000000000000000/build/src/parser/html/nsHtml5TreeOpExecutor.cpp:448:21
#39 0x7f5a61a2c80b in nsHtml5ExecutorFlusher::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/parser/html/nsHtml5StreamParser.cpp:128:9
#40 0x7f5a5fa74b86 in nsThread::ProcessNextEvent(bool, bool\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/threads/nsThread.cpp:1068:7
#41 0x7f5a5faf2f6c in NS\_ProcessNextEvent(nsIThread\*, bool) /builds/slave/m-in-l64-asan-0000000000000000/build/src/xpcom/glue/nsThreadUtils.cpp:290:10
#42 0x7f5a6083f4ef in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/glue/MessagePump.cpp:100:21
#43 0x7f5a607b3d28 in RunInternal /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:232:3
#44 0x7f5a607b3d28 in RunHandler /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:225
#45 0x7f5a607b3d28 in MessageLoop::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/ipc/chromium/src/base/message\_loop.cc:205
#46 0x7f5a662060af in nsBaseAppShell::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/widget/nsBaseAppShell.cpp:156:3
#47 0x7f5a6813ea91 in nsAppStartup::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/toolkit/components/startup/nsAppStartup.cpp:284:19
Crash Annotation GraphicsCriticalError: |[0][GFX1]: Unknown image format 16 (t=3.91881) |[6616][GFX1]: Unknown image format 16 (t=291.104) |[6617][GFX1]: Unknown image format 16 (t=291.171) |[6618][GFX1]: Unknown image format 16 (t=291.204) |[6619][GFX1]: Unknown image format 16 (t=291.255) |[6620][GFX1]: Unknown image format 16 (t=291.288) |[6621][GFX1]: Unknown image format 16 (t=291.338) |[6622][GFX1]: Unknown image format 16 (t=291.371) |[6623][GFX1]: Unknown image format 16 (t=291.404) |[6624][GFX1]: Unknown image format 16 (t=291.421) |[6625][GFX1]: Unknown image format 16 (t=291.438) |[6626][GFX1]: Unknown image format 16 (t=291.455) |[6627][GFX1]: Unknown image format 16 (t=291.488) |[6628][GFX1]: Unknown image format 16 (t=291.522) |[6629][GFX1]: Unknown image format 16 (t=291.554) |[6615][GFX1]: Unknown image format 16 (t=291.071) [GFX1]: Unknown image format 16
#48 0x7f5a6828bbd3 in XREMain::XRE\_mainRun() /builds/slave/m-in-l64-asan-0000000000000000/build/src/toolkit/xre/nsAppRunner.cpp:4213:10
#49 0x7f5a6828d173 in XREMain::XRE\_main(int, char\*\*, nsXREAppData const\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/toolkit/xre/nsAppRunner.cpp:4332:8
#50 0x7f5a6828e04a in XRE\_main /builds/slave/m-in-l64-asan-0000000000000000/build/src/toolkit/xre/nsAppRunner.cpp:4423:16
#51 0x4dfb47 in do\_main /builds/slave/m-in-l64-asan-0000000000000000/build/src/browser/app/nsBrowserApp.cpp:251:10
#52 0x4dfb47 in main /builds/slave/m-in-l64-asan-0000000000000000/build/src/browser/app/nsBrowserApp.cpp:387
#53 0x7f5a7913dec4 in \_\_libc\_start\_main (/lib/x86\_64-linux-gnu/libc.so.6+0x21ec4)
SUMMARY: AddressSanitizer: heap-buffer-overflow /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/libpng/pngrutil.c:4017:31 in MOZ\_PNG\_read\_filt\_row\_a
Shadow bytes around the buggy address:
0x0c208005c250: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
0x0c208005c260: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
0x0c208005c270: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd
0x0c208005c280: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
0x0c208005c290: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01
=>0x0c208005c2a0:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c208005c2b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
0x0c208005c2c0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
0x0c208005c2d0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
0x0c208005c2e0: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
0x0c208005c2f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Heap right redzone: fb
Freed heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone: f3
Stack partial redzone: f4
Stack after return: f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
Container overflow: fc
Array cookie: ac
Intra object redzone: bb
ASan internal: fe
Left alloca redzone: ca
Right alloca redzone: cb

|  | [Christoph Diehl [:posidron]](/user_profile?user_id=368570)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1288588#c1)• 9 years ago |
|  | |

Attached file
[Testcase](attachment.cgi?id=8773580) (obsolete)
— [Details](attachment.cgi?id=8773580&action=edit)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1288588#c2)• 9 years ago |
|  | |

Nightly just shows the "image cannot be displayed..." window, and this is
in the log:
[ImgDecoder #1]: W/PNGDecoder libpng warning: Invalid color type in IHDR
[ImgDecoder #1]: E/PNGDecoder libpng error: Invalid IHDR data
[ImgDecoder #2]: W/PNGDecoder libpng warning: Invalid color type in IHDR
[ImgDecoder #2]: E/PNGDecoder libpng error: Invalid IHDR data
when I did
cp data\_1\_output\_Output.txt fuzzed.png
and then tried to view fuzzed.png
Other applications (pngcheck, pngcrush) also report that the
color type is invalid.
Not sure why you got a crash instead of a png\_error().
Recent change to nsPNGDecoder.cpp
previously:
if (setjmp(png\_jmpbuf(mPNG))) {
// We exited early. If mSuccessfulEarlyFinish isn't true, then we
// encountered an error. We might not really know what caused it, but it
// makes more sense to blame the data.
if (!mSuccessfulEarlyFinish && !HasError()) {
PostDataError();
}
png\_destroy\_read\_struct(&mPNG, &mInfo, nullptr);
return;
}
now:
// libpng uses setjmp/longjmp for error handling.
if (setjmp(png\_jmpbuf(mPNG))) {
return Transition::TerminateFailure();
}
The cleanup is gone; perhaps that explains the behavior
after the error in IHDR was encountered. At least there
may be a memory leak of mPNG.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a165896_14419)• 9 years ago |

Assignee: nobody → glennrp+bmoStatus: NEW → ASSIGNED

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1288588#c3)• 9 years ago |
|  | |

I'm unable to reproduce this behavior, neither with my own asan build nor with one on the try-server:
[http://archive.mozilla.org/pub/firefox/try-builds/ryanvm@gmail.com-18b21945f8d6303ca41be2c9c4f9bd7e53364cab/try-linux64-asan-debug/](http://archive.mozilla.org/pub/firefox/try-builds/ryanvm%40gmail.com-18b21945f8d6303ca41be2c9c4f9bd7e53364cab/try-linux64-asan-debug/)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a670199_1689)• 8 years ago |

Group: core-security → gfx-core-security

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1288588#c4)• 8 years ago |
|  | |

(In reply to Glenn Randers-Pehrson from [comment #2](/show_bug.cgi?id=1288588#c2 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]"))
> The cleanup is gone; perhaps that explains the behavior
> after the error in IHDR was encountered. At least there
> may be a memory leak of mPNG.
I've verified with some temporary logging that the mPNG
structure does get properly destroyed so there's not a leak.
There seems to be nothing more for me to do here.Assignee: glennrp+bmo → nobodyStatus: ASSIGNED → NEW

|  | [Christoph Diehl [:posidron]](/user_profile?user_id=368570)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1288588#c5)• 8 years ago |
|  | |

I also saw this only one time to happen but the fact that it was a ASan issue, lead me to post it here, cause there are no false-positive there.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1288588#c6)• 8 years ago |
|  | |

Have you still got the relevant build that you mentioned: en-us.linux-x86\_64-asan.tar.bz2 revision 0684715b032f06273416fdc554c071ee61a889db ? Is it available somewhere?

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1288588#c7)• 8 years ago |
| testcase | |

Attached image
[test\_case.png](attachment.cgi?id=8776289)
— [Details](attachment.cgi?id=8776289&action=edit)

This repro's for me on inbound ASan builds with this test case.
[Attachment #8773580](/attachment.cgi?id=8773580&action=edit "Testcase") -
Attachment is obsolete: true

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a742087_486634)• 8 years ago |

Blocks: [grizzly](/show_bug.cgi?id=1289609 "NEW - [meta] Bugs found while Fuzzing with Grizzly")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a743179_75935)• 8 years ago |

Flags: in-testsuite?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1288588#c8)• 8 years ago |
|  | |

For me, the new test\_case.png crashes the tab under Nightly, but my own asan build correctly reports the error and does not generate an asan dump. In this case, the error is in an fdAT chunk, which libpng handles as an "ancillary" chunk and issues a png\_warning and continues on. In the original test\_case, there is also an error in the IHDR chunk (invalid colortype) which causes libpng to abort processing the image before it gets to the bad fdAT chunk.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1288588#c9)• 8 years ago |
|  | |

Landing the patch in [bug #872626](/show_bug.cgi?id=872626 "NEW - Bad fcTL CRC in APNG files ignored (regression)") will fix this. Currently when a bad fcTL or fdAT APNG chunk is found, the decoder continues with the bad data. The patch will cause the decoder to discontinue with the APNG, which should be safer.Assignee: nobody → glennrp+bmo

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a828357_14419)• 8 years ago |

Status: NEW → ASSIGNEDOS: Mac OS X → All

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1288588#c10)• 8 years ago |
|  | |

Attached patch

[v00-872626-crashtest](attachment.cgi?id=8777180&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777180&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777180)

test\_case.png converted to media/libpng/crashtests/872626-1.html
[Attachment #8777180](/attachment.cgi?id=8777180&action=edit "v00-872626-crashtest") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1288588#c11)• 8 years ago |
|  | |

@ryanvm, this is the test case you requested over in [bug #872626](/show_bug.cgi?id=872626 "NEW - Bad fcTL CRC in APNG files ignored (regression)")Flags: needinfo?(ryanvm)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1288588#c12)• 8 years ago |
|  | |

So we intend to land this sec-critical fix in a non-sensitive bug? Al, what's the right practice here?
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox48](/buglist.cgi?f1=cf_tracking_firefox48&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%3F)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%3F)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%3F)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F)Flags: needinfo?(ryanvm) → needinfo?(abillings)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1288588#c13)• 8 years ago |
|  | |

AFAIK, this is not a chemspill situation, we can let it ride the train from 49
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[tracking-firefox48](/buglist.cgi?f1=cf_tracking_firefox48&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=-)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F) → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1288588#c14)• 8 years ago |
|  | |

Attached patch

[v00-1288588-part01-apng-bad-crc-pngdecoder](attachment.cgi?id=8777283&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777283&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777283)

This is the same as the v10 patch in [bug #872626](/show_bug.cgi?id=872626 "NEW - Bad fcTL CRC in APNG files ignored (regression)") with an indentation error fixed

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1288588#c15)• 8 years ago |
|  | |

Attached patch

[v00-1288588-part02-apng-bad-crc-crashtest](attachment.cgi?id=8777286&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777286&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777286)

Renaming the crashtest
[Attachment #8777180](/attachment.cgi?id=8777180&action=edit "v00-872626-crashtest") -
Attachment is obsolete: true
[Attachment #8777180](/attachment.cgi?id=8777180&action=edit "v00-872626-crashtest") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1288588#c16)• 8 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #12](/show_bug.cgi?id=1288588#c12 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]"))
> So we intend to land this sec-critical fix in a non-sensitive bug?
I've moved the patch over here. Works for me locally but probably ought to do another "try" to be sure.Flags: needinfo?(ryanvm)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1066729_14419)• 8 years ago |

[Attachment #8777283](/attachment.cgi?id=8777283&action=edit "v00-1288588-part01-apng-bad-crc-pngdecoder") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1066783_14419)• 8 years ago |

[Attachment #8777286](/attachment.cgi?id=8777286&action=edit "v00-1288588-part02-apng-bad-crc-crashtest") -
Flags: review?(jmuizelaar)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1288588#c17)• 8 years ago |
|  | |

Comment on [attachment 8777286](/attachment.cgi?id=8777286 "v00-1288588-part02-apng-bad-crc-crashtest") [[details]](/attachment.cgi?id=8777286&action=edit "v00-1288588-part02-apng-bad-crc-crashtest") [[diff]](/attachment.cgi?id=8777286&action=diff "v00-1288588-part02-apng-bad-crc-crashtest") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777286)
v00-1288588-part02-apng-bad-crc-crashtest
This is missing a corresponding crashtest.list entry.Flags: needinfo?(ryanvm)
[Attachment #8777286](/attachment.cgi?id=8777286&action=edit "v00-1288588-part02-apng-bad-crc-crashtest") -
Flags: feedback-

|  | [Max Stepin](/user_profile?user_id=355876) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1288588#c18)• 8 years ago |
| testcase | |

Attached image
[test\_case\_good\_crc.png](attachment.cgi?id=8777362)
— [Details](attachment.cgi?id=8777362&action=edit)

The same file, with the same incorrect content, but with CRC fixed.
Please test this one too.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1288588#c19)• 8 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #12](/show_bug.cgi?id=1288588#c12 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]"))
> So we intend to land this sec-critical fix in a non-sensitive bug? Al,
> what's the right practice here?
You'd get sec-approval here and land through the cover bug (if it is actually a cover bug). Fill out the sec-approval? template here and get approval here to land there. This happens often enough.
If the other bug is a fix for an issue that also happens to cover this, I'd just land it. The main issue is that if we want it on branches, people will wonder why we're porting a non-security bug to branches later but that is fine.Flags: needinfo?(abillings)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1288588#c20)• 8 years ago |
|  | |

Attached patch

[v01-1288588-part02-apng-bad-crc-crashtests](attachment.cgi?id=8777496&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777496&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777496)

Added test\_case\_good\_crc to crashtests and updated crashtests.list
[Attachment #8777286](/attachment.cgi?id=8777286&action=edit "v00-1288588-part02-apng-bad-crc-crashtest") -
Attachment is obsolete: true
[Attachment #8777286](/attachment.cgi?id=8777286&action=edit "v00-1288588-part02-apng-bad-crc-crashtest") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1097492_14419)• 8 years ago |

[Attachment #8777496](/attachment.cgi?id=8777496&action=edit "v01-1288588-part02-apng-bad-crc-crashtests") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1288588#c21)• 8 years ago |
|  | |

Attached patch

[v00-1288588-beta-apng-bad-crc-pngdecoder](attachment.cgi?id=8777497&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777497&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777497)

Patch for Firefox-49 (beta)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1288588#c22)• 8 years ago |
|  | |

Sadly, although the patched asan build successfully handles the "bad crc" test, the tab crashes on the "good crc" test. Thanks Max.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1099866_14419)• 8 years ago |

[Attachment #8777283](/attachment.cgi?id=8777283&action=edit "v00-1288588-part01-apng-bad-crc-pngdecoder") -
Flags: review?(jmuizelaar) → review-

|  | [Max Stepin](/user_profile?user_id=355876) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1288588#c23)• 8 years ago |
|  | |

I think we should look into frame\_info\_callback(). We read frame dimensions there, but make no attempt to validate them:
const IntRect frameRect(png\_get\_next\_frame\_x\_offset(png\_ptr, decoder->mInfo),
png\_get\_next\_frame\_y\_offset(png\_ptr, decoder->mInfo),
png\_get\_next\_frame\_width(png\_ptr, decoder->mInfo),
png\_get\_next\_frame\_height(png\_ptr, decoder->mInfo));
All frames in test\_case.png are the same rectangle: (0,0,16,16) except one frame's buggy header is set as (0,0,0,16) and obviously creating new bitmap with width=0 could cause all kinds of memory problems.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1288588#c24)• 8 years ago |
|  | |

(In reply to Max Stepin from [comment #23](/show_bug.cgi?id=1288588#c23 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]"))
> I think we should look into frame\_info\_callback(). We read frame dimensions
> there, but make no attempt to validate them
Yes. The inputs should be validated in pngget.c. The APNG specification
tells us the valid ranges.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1288588#c25)• 8 years ago |
|  | |

It looks to me as though they are supposed to be checked properly in png\_ensure\_fcTL\_is\_valid(), in pngset.c; we need to find out why that isn't happening.

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1288588#c26)• 8 years ago |
|  | |

Comment on [attachment 8777496](/attachment.cgi?id=8777496 "v01-1288588-part02-apng-bad-crc-crashtests") [[details]](/attachment.cgi?id=8777496&action=edit "v01-1288588-part02-apng-bad-crc-crashtests") [[diff]](/attachment.cgi?id=8777496&action=diff "v01-1288588-part02-apng-bad-crc-crashtests") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777496)
v01-1288588-part02-apng-bad-crc-crashtests
Review of [attachment 8777496](/attachment.cgi?id=8777496 "v01-1288588-part02-apng-bad-crc-crashtests") [[details]](/attachment.cgi?id=8777496&action=edit "v01-1288588-part02-apng-bad-crc-crashtests") [[diff]](/attachment.cgi?id=8777496&action=diff "v01-1288588-part02-apng-bad-crc-crashtests") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777496):
-----------------------------------------------------------------
Do you need to include the PNG inline? It seems like we might as well have it on the side.
It's also nice to have more verbose test names that include something about what's being tested.
[Attachment #8777496](/attachment.cgi?id=8777496&action=edit "v01-1288588-part02-apng-bad-crc-crashtests") -
Flags: review?(jmuizelaar) → review+

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1288588#c27)• 8 years ago |
|  | |

Attached patch

[v00-1288588-part03-apng-bad-crc-pngset](attachment.cgi?id=8777583&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777583&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777583)

Check dimensions for 0

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1288588#c28)• 8 years ago |
|  | |

Attached patch

[v01-1288588-part03-apng-bad-crc-pngset](attachment.cgi?id=8777593&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777593&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777593)

[Attachment #8777583](/attachment.cgi?id=8777583&action=edit "v00-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1288588#c29)• 8 years ago |
|  | |

Attached patch

[v00-1288588-part04-apng-bad-crc-apng-patch](attachment.cgi?id=8777595&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777595&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777595)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1288588#c30)• 8 years ago |
|  | |

Please "try" parts 01,02,02,04 together.Flags: needinfo?(ryanvm)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1288588#c31)• 8 years ago |
|  | |

Note that builds using the system libpng+apng\_patch will still be vulnerable, unless we also put a check in nsPNGDecoder.cpp after the calls to png\_get\_next\_frame\_width|height().

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1288588#c32)• 8 years ago |
|  | |

Attached patch

[v01-1288588-part01-apng-bad-crc-pngdecoder](attachment.cgi?id=8777627&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777627&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777627)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1288588#c33)• 8 years ago |
|  | |

Attached patch

[v01-1288588-beta-apng-bad-crc-pngdecoder](attachment.cgi?id=8777628&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777628&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777628)

[Attachment #8777283](/attachment.cgi?id=8777283&action=edit "v00-1288588-part01-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true
[Attachment #8777497](/attachment.cgi?id=8777497&action=edit "v00-1288588-beta-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1288588#c34)• 8 years ago |
|  | |

Attached patch

[v00-1288588-aurora-apng-bad-crc-pngdecoder](attachment.cgi?id=8777629&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777629&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777629)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1288588#c35)• 8 years ago |
|  | |

(In reply to [comment #31](/show_bug.cgi?id=1288588#c31 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]"))
> Note that builds using the system libpng+apng\_patch will still be
> vulnerable, unless we also put a check in nsPNGDecoder.cpp after the calls
> to png\_get\_next\_frame\_width|height().
The patch set now takes care of this.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1288588#c36)• 8 years ago |
|  | |

Attached patch

[v02-1288588-part01-apng-bad-crc-pngdecoder](attachment.cgi?id=8777848&action=diff) (obsolete)
— [Details](attachment.cgi?id=8777848&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777848)

Rebased after [bug #1240665](/show_bug.cgi?id=1240665 "RESOLVED FIXED - Make image loading error log messages more accurate") landed.
[Attachment #8777627](/attachment.cgi?id=8777627&action=edit "v01-1288588-part01-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1174655_486634)• 8 years ago |

See Also: → [872626](/show_bug.cgi?id=872626 "NEW - Bad fcTL CRC in APNG files ignored (regression)")

|  | [Max Stepin](/user_profile?user_id=355876) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1288588#c37)• 8 years ago |
| testcase | |

Attached image
[zero\_width\_frame.png](attachment.cgi?id=8777962)
— [Details](attachment.cgi?id=8777962&action=edit)

(In reply to Jeff Muizelaar [:jrmuizel] from [comment #26](/show_bug.cgi?id=1288588#c26 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]"))
> It's also nice to have more verbose test names that include something about
> what's being tested.
Here's more minimal test (only width=0 at one frame, nothing else, good crc) with a verbose name.
It should probably go into image/test/crashtests directory.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1288588#c38)• 8 years ago |
|  | |

I think we only need to fix the width==0 or height==0 issue here. The change to CRC handling can be left to [bug #872676](/show_bug.cgi?id=872676 "RESOLVED FIXED - [mortar] Create app-stub template"); that only hides this bug. I'm preparing a new set of patches now.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1288588#c39)• 8 years ago |
|  | |

Attached patch

[v03-1288588-part01-apng-bad-crc-pngdecoder](attachment.cgi?id=8778411&action=diff) (obsolete)
— [Details](attachment.cgi?id=8778411&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778411)

[Attachment #8777848](/attachment.cgi?id=8777848&action=edit "v02-1288588-part01-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1288588#c40)• 8 years ago |
|  | |

Attached patch

[v00-1288588-part05-apng-bad-crc-pnglibconf](attachment.cgi?id=8778414&action=diff) (obsolete)
— [Details](attachment.cgi?id=8778414&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778414)

Please include part05 in the try run

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1288588#c41)• 8 years ago |
|  | |

Attached patch

[v02-1288588-beta-apng-bad-fcTL-pngdecoder](attachment.cgi?id=8778415&action=diff)
— [Details](attachment.cgi?id=8778415&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778415)

Only check width|height
[Attachment #8777628](/attachment.cgi?id=8777628&action=edit "v01-1288588-beta-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1288588#c42)• 8 years ago |
|  | |

Attached patch

[v01-1288588-aurora-apng-bad-fcTL-pngdecoder](attachment.cgi?id=8778416&action=diff)
— [Details](attachment.cgi?id=8778416&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778416)

Only check for width|height == 0
[Attachment #8777629](/attachment.cgi?id=8777629&action=edit "v00-1288588-aurora-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1288588#c43)• 8 years ago |
|  | |

Attached patch

[v02-1288588-part02-apng-bad-crc-crashtest](attachment.cgi?id=8778529&action=diff) (obsolete)
— [Details](attachment.cgi?id=8778529&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778529)

Added Max' zero\_width\_frame.png to image/test/crashtests as zero\_width\_fcTL\_chunk.png
[Attachment #8777496](/attachment.cgi?id=8777496&action=edit "v01-1288588-part02-apng-bad-crc-crashtests") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1304781_14419)• 8 years ago |

[Attachment #8778411](/attachment.cgi?id=8778411&action=edit "v03-1288588-part01-apng-bad-crc-pngdecoder") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1304834_14419)• 8 years ago |

[Attachment #8778529](/attachment.cgi?id=8778529&action=edit "v02-1288588-part02-apng-bad-crc-crashtest") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1304900_14419)• 8 years ago |

[Attachment #8777593](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1304951_14419)• 8 years ago |

[Attachment #8777595](/attachment.cgi?id=8777595&action=edit "v00-1288588-part04-apng-bad-crc-apng-patch") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1304998_14419)• 8 years ago |

[Attachment #8778414](/attachment.cgi?id=8778414&action=edit "v00-1288588-part05-apng-bad-crc-pnglibconf") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1305093_14419)• 8 years ago |

[Attachment #8778415](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1305139_14419)• 8 years ago |

[Attachment #8778416](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1288588#c44)• 8 years ago |
|  | |

Attached patch

[v02-1288588-part03-apng-bad-crc-pngset](attachment.cgi?id=8778579&action=diff) (obsolete)
— [Details](attachment.cgi?id=8778579&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778579)

Improved the error message in pngset.c
[Attachment #8777593](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: true
[Attachment #8777593](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") -
Flags: review?(jmuizelaar)
[Attachment #8778579](/attachment.cgi?id=8778579&action=edit "v02-1288588-part03-apng-bad-crc-pngset") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1337600_14419)• 8 years ago |

[Attachment #8777583](/attachment.cgi?id=8777583&action=edit "v00-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: false

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1337637_14419)• 8 years ago |

[Attachment #8778579](/attachment.cgi?id=8778579&action=edit "v02-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: true
[Attachment #8778579](/attachment.cgi?id=8778579&action=edit "v02-1288588-part03-apng-bad-crc-pngset") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1288588#c45)• 8 years ago |
|  | |

Comment on [attachment 8777583](/attachment.cgi?id=8777583 "v00-1288588-part03-apng-bad-crc-pngset") [[details]](/attachment.cgi?id=8777583&action=edit "v00-1288588-part03-apng-bad-crc-pngset") [[diff]](/attachment.cgi?id=8777583&action=diff "v00-1288588-part03-apng-bad-crc-pngset") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777583)
v00-1288588-part03-apng-bad-crc-pngset
Phooey, the v02-part03 patch was for after libpng-1.6.24 lands, so I've retracted it for now.
[Attachment #8777583](/attachment.cgi?id=8777583&action=edit "v00-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1288588#c46)• 8 years ago |
|  | |

Comment on [attachment 8777593](/attachment.cgi?id=8777593 "v01-1288588-part03-apng-bad-crc-pngset") [[details]](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") [[diff]](/attachment.cgi?id=8777593&action=diff "v01-1288588-part03-apng-bad-crc-pngset") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777593)
v01-1288588-part03-apng-bad-crc-pngset
Restored the v01-part03 patch for now.
[Attachment #8777593](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: false
[Attachment #8777593](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1288588#c47)• 8 years ago |
|  | |

Several of the parts (03, 04, 05) will need to be rebased after [bug #1291986](/show_bug.cgi?id=1291986 "RESOLVED FIXED - Update in-tree libpng to version 1.6.24") (libpng-1.6.24) lands, and vice versa, the patches in [bug #1291986](/show_bug.cgi?id=1291986 "RESOLVED FIXED - Update in-tree libpng to version 1.6.24") will have to be rebased if this one lands first. I can deal with that either way.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1288588#c48)• 8 years ago |
|  | |

Attached patch

[v04-1288588-part01-apng-bad-crc-pngdecoder](attachment.cgi?id=8778660&action=diff) (obsolete)
— [Details](attachment.cgi?id=8778660&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778660)

Rebased after nsPNGDecoder changed
[Attachment #8778411](/attachment.cgi?id=8778411&action=edit "v03-1288588-part01-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true
[Attachment #8778411](/attachment.cgi?id=8778411&action=edit "v03-1288588-part01-apng-bad-crc-pngdecoder") -
Flags: review?(jmuizelaar)
[Attachment #8778660](/attachment.cgi?id=8778660&action=edit "v04-1288588-part01-apng-bad-crc-pngdecoder") -
Flags: review?(jmuizelaar)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1707381_309398)• 8 years ago |

[Attachment #8778529](/attachment.cgi?id=8778529&action=edit "v02-1288588-part02-apng-bad-crc-crashtest") -
Flags: review?(jmuizelaar) → review+

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1707476_309398)• 8 years ago |

[Attachment #8778415](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") -
Flags: review?(jmuizelaar) → review+

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1707504_309398)• 8 years ago |

[Attachment #8778660](/attachment.cgi?id=8778660&action=edit "v04-1288588-part01-apng-bad-crc-pngdecoder") -
Flags: review?(jmuizelaar) → review+

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1707526_309398)• 8 years ago |

[Attachment #8778416](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") -
Flags: review?(jmuizelaar) → review+

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1707535_309398)• 8 years ago |

[Attachment #8778414](/attachment.cgi?id=8778414&action=edit "v00-1288588-part05-apng-bad-crc-pnglibconf") -
Flags: review?(jmuizelaar) → review+

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1707553_309398)• 8 years ago |

[Attachment #8777593](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") -
Flags: review?(jmuizelaar) → review+

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1707560_309398)• 8 years ago |

[Attachment #8777595](/attachment.cgi?id=8777595&action=edit "v00-1288588-part04-apng-bad-crc-apng-patch") -
Flags: review?(jmuizelaar) → review+

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1288588#c49)• 8 years ago |
|  | |

Comment on [attachment 8777595](/attachment.cgi?id=8777595 "v00-1288588-part04-apng-bad-crc-apng-patch") [[details]](/attachment.cgi?id=8777595&action=edit "v00-1288588-part04-apng-bad-crc-apng-patch") [[diff]](/attachment.cgi?id=8777595&action=diff "v00-1288588-part04-apng-bad-crc-apng-patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777595)
v00-1288588-part04-apng-bad-crc-apng-patch
apng.patch was fixed by landing [bug #1291986](/show_bug.cgi?id=1291986 "RESOLVED FIXED - Update in-tree libpng to version 1.6.24")
[Attachment #8777595](/attachment.cgi?id=8777595&action=edit "v00-1288588-part04-apng-bad-crc-apng-patch") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1288588#c50)• 8 years ago |
|  | |

Comment on [attachment 8777593](/attachment.cgi?id=8777593 "v01-1288588-part03-apng-bad-crc-pngset") [[details]](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") [[diff]](/attachment.cgi?id=8777593&action=diff "v01-1288588-part03-apng-bad-crc-pngset") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8777593)
v01-1288588-part03-apng-bad-crc-pngset
pngset.c was fixed by landing [bug #1291986](/show_bug.cgi?id=1291986 "RESOLVED FIXED - Update in-tree libpng to version 1.6.24")
[Attachment #8777593](/attachment.cgi?id=8777593&action=edit "v01-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: true

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1288588#c51)• 8 years ago |
|  | |

Attached patch

[v03-1288588-part03-apng-bad-crc-pngset](attachment.cgi?id=8780129&action=diff) (obsolete)
— [Details](attachment.cgi?id=8780129&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780129)

Rebase after landing [bug #1291986](/show_bug.cgi?id=1291986 "RESOLVED FIXED - Update in-tree libpng to version 1.6.24")

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1288588#c52)• 8 years ago |
|  | |

Attached patch

[v01-1288588-part04-apng-bad-crc-apng-patch](attachment.cgi?id=8780130&action=diff) (obsolete)
— [Details](attachment.cgi?id=8780130&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780130)

Rebase after landing [bug #1291986](/show_bug.cgi?id=1291986 "RESOLVED FIXED - Update in-tree libpng to version 1.6.24")

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1288588#c53)• 8 years ago |
|  | |

Attached patch

[v01-1288588-part05-apng-bad-crc-pnglibconf](attachment.cgi?id=8780131&action=diff) (obsolete)
— [Details](attachment.cgi?id=8780131&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780131)

Rebase after landing [bug #1291986](/show_bug.cgi?id=1291986 "RESOLVED FIXED - Update in-tree libpng to version 1.6.24")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1784907_1689)• 8 years ago |

See Also: [872626](/show_bug.cgi?id=872626 "NEW - Bad fcTL CRC in APNG files ignored (regression)") →

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1288588#c54)• 8 years ago |
|  | |

Attached patch

[v00-1288588-apng-bad-fcTL-combined.diff](attachment.cgi?id=8780243&action=diff) (obsolete)
— [Details](attachment.cgi?id=8780243&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780243)

Combined patches into one.
[Attachment #8778414](/attachment.cgi?id=8778414&action=edit "v00-1288588-part05-apng-bad-crc-pnglibconf") -
Attachment is obsolete: true
[Attachment #8778529](/attachment.cgi?id=8778529&action=edit "v02-1288588-part02-apng-bad-crc-crashtest") -
Attachment is obsolete: true
[Attachment #8778660](/attachment.cgi?id=8778660&action=edit "v04-1288588-part01-apng-bad-crc-pngdecoder") -
Attachment is obsolete: true
[Attachment #8780129](/attachment.cgi?id=8780129&action=edit "v03-1288588-part03-apng-bad-crc-pngset") -
Attachment is obsolete: true
[Attachment #8780130](/attachment.cgi?id=8780130&action=edit "v01-1288588-part04-apng-bad-crc-apng-patch") -
Attachment is obsolete: true
[Attachment #8780131](/attachment.cgi?id=8780131&action=edit "v01-1288588-part05-apng-bad-crc-pnglibconf") -
Attachment is obsolete: true
[Attachment #8780243](/attachment.cgi?id=8780243&action=edit "v00-1288588-apng-bad-fcTL-combined.diff") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1789043_14419)• 8 years ago |

[Attachment #8780243](/attachment.cgi?id=8780243&action=edit "v00-1288588-apng-bad-fcTL-combined.diff") -
Attachment is obsolete: true
[Attachment #8780243](/attachment.cgi?id=8780243&action=edit "v00-1288588-apng-bad-fcTL-combined.diff") -
Flags: review?(jmuizelaar)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1288588#c55)• 8 years ago |
|  | |

Attached patch

[v01-1288588-apng-bad-fcTL (combined)](attachment.cgi?id=8780252&action=diff)
— [Details](attachment.cgi?id=8780252&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780252)

fixed a typo
[Attachment #8780252](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") -
Flags: review?(jmuizelaar)

|  | [Jeff Muizelaar [:jrmuizel]](/user_profile?user_id=309398) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1790335_309398)• 8 years ago |

[Attachment #8780252](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") -
Flags: review?(jmuizelaar) → review+

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1288588#c56)• 8 years ago |
|  | |

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=1c663ca95bb7>Flags: needinfo?(ryanvm)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1288588#c57)• 8 years ago |
|  | |

Comment on [attachment 8778415](/attachment.cgi?id=8778415 "v02-1288588-beta-apng-bad-fcTL-pngdecoder") [[details]](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") [[diff]](/attachment.cgi?id=8778415&action=diff "v02-1288588-beta-apng-bad-fcTL-pngdecoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778415)
v02-1288588-beta-apng-bad-fcTL-pngdecoder
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
trivially
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
yes
Which older supported branches are affected by this flaw?
all
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
yes
How likely is this patch to cause regressions; how much testing does it need?
unlikely
[Attachment #8778415](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") -
Flags: sec-approval?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1288588#c58)• 8 years ago |
|  | |

Comment on [attachment 8778416](/attachment.cgi?id=8778416 "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") [[details]](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") [[diff]](/attachment.cgi?id=8778416&action=diff "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778416)
v01-1288588-aurora-apng-bad-fcTL-pngdecoder
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
trivially
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
yes
Which older supported branches are affected by this flaw?
all
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
yes
How likely is this patch to cause regressions; how much testing does it need?
unlikely
[Attachment #8778416](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") -
Flags: sec-approval?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1288588#c59)• 8 years ago |
|  | |

Comment on [attachment 8780252](/attachment.cgi?id=8780252 "v01-1288588-apng-bad-fcTL (combined)") [[details]](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") [[diff]](/attachment.cgi?id=8780252&action=diff "v01-1288588-apng-bad-fcTL (combined)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780252)
v01-1288588-apng-bad-fcTL (combined)
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Which older supported branches are affected by this flaw?
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
How likely is this patch to cause regressions; how much testing does it need?
[Attachment #8780252](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") -
Flags: sec-approval?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1810554_14419)• 8 years ago |

[Attachment #8780252](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") -
Flags: sec-approval?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 60](/show_bug.cgi?id=1288588#c60)• 8 years ago |
|  | |

Comment on [attachment 8780252](/attachment.cgi?id=8780252 "v01-1288588-apng-bad-fcTL (combined)") [[details]](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") [[diff]](/attachment.cgi?id=8780252&action=diff "v01-1288588-apng-bad-fcTL (combined)") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780252)
v01-1288588-apng-bad-fcTL (combined)
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
trivially
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
yes
Which older supported branches are affected by this flaw?
all
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
yes
How likely is this patch to cause regressions; how much testing does it need?
unlikely
[Attachment #8780252](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1288588#c61)• 8 years ago |
|  | |

I don't think we normally get sec-approval on each part of a multi-part patch. :-)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1884813_280903)• 8 years ago |

[Attachment #8778415](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1884819_280903)• 8 years ago |

[Attachment #8778416](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a1884829_280903)• 8 years ago |

[Attachment #8780252](/attachment.cgi?id=8780252&action=edit "v01-1288588-apng-bad-fcTL (combined)") -
Flags: sec-approval? → sec-approval+

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 62](/show_bug.cgi?id=1288588#c62)• 8 years ago |
|  | |

Please checkin the "combined" patch to trunk, "aurora" to aurora, and "beta" to beta.Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 63](/show_bug.cgi?id=1288588#c63)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/8fd07f16556c>
This needs an esr45 patch too, or will the beta patch apply cleanly?Flags: needinfo?(glennrp+bmo)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 64](/show_bug.cgi?id=1288588#c64)• 8 years ago |
|  | |

Attached patch

[v00-1288588-esr45-apng-bad-fcTL-pngdecoder](attachment.cgi?id=8780801&action=diff)
— [Details](attachment.cgi?id=8780801&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780801)

Flags: needinfo?(glennrp+bmo)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 65](/show_bug.cgi?id=1288588#c65)• 8 years ago |
|  | |

The branch patches still need to go through the usual uplift approval process too. Can you please do the requests?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 66](/show_bug.cgi?id=1288588#c66)• 8 years ago |
|  | |

Comment on [attachment 8780801](/attachment.cgi?id=8780801 "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") [[details]](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") [[diff]](/attachment.cgi?id=8780801&action=diff "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780801)
v00-1288588-esr45-apng-bad-fcTL-pngdecoder
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
trivially
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
yes
Which older supported branches are affected by this flaw?
all
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
yes
How likely is this patch to cause regressions; how much testing does it need?
very unlikely
[Attachment #8780801](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") -
Flags: sec-approval?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 67](/show_bug.cgi?id=1288588#c67)• 8 years ago |
|  | |

Comment on [attachment 8780801](/attachment.cgi?id=8780801 "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") [[details]](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") [[diff]](/attachment.cgi?id=8780801&action=diff "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8780801)
v00-1288588-esr45-apng-bad-fcTL-pngdecoder
[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined:
Fix Landed on Version:
trunk (51.0a1)
(also landed in the APNG patch for libpng-1.6.24 on August 4, 2016).
Risk to taking this patch (and alternatives if risky):
not risky
String or UUID changes made by this patch:
adds error messages "Frame width must not be 0" and "Frame height must not be 0".
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Attachment #8780801](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") -
Flags: approval-mozilla-esr45?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 68](/show_bug.cgi?id=1288588#c68)• 8 years ago |
|  | |

Comment on [attachment 8778415](/attachment.cgi?id=8778415 "v02-1288588-beta-apng-bad-fcTL-pngdecoder") [[details]](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") [[diff]](/attachment.cgi?id=8778415&action=diff "v02-1288588-beta-apng-bad-fcTL-pngdecoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778415)
v02-1288588-beta-apng-bad-fcTL-pngdecoder
Approval Request Comment
[Feature/regressing bug #]:
[User impact if declined]: crash caused by malevolent APNG file
[Describe test coverage new/current, TreeHerder]:
TreeHerder with trunk (see [comment #56](/show_bug.cgi?id=1288588#c56 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]")).
[Risks and why]:
Little or no risk; it simply adds a test on width or height being zero and returns an error message and aborts processing the image.
[String/UUID change made/needed]:
Adds error messages "Frame width must not be 0" and "Frame height must not be 0".
[Attachment #8778415](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") -
Flags: approval-mozilla-beta?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 69](/show_bug.cgi?id=1288588#c69)• 8 years ago |
|  | |

Comment on [attachment 8778416](/attachment.cgi?id=8778416 "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") [[details]](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") [[diff]](/attachment.cgi?id=8778416&action=diff "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288588&attachment=8778416)
v01-1288588-aurora-apng-bad-fcTL-pngdecoder
Approval Request Comment
[Feature/regressing bug #]:
[User impact if declined]: crash caused by malevolent APNG file
[Describe test coverage new/current, TreeHerder]:
TreeHerder with trunk (see [comment #56](/show_bug.cgi?id=1288588#c56 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]")).
[Risks and why]:
Little or no risk; it simply adds a test on width or height being zero and returns an error message and aborts processing the image.
[String/UUID change made/needed]:
Adds error messages "Frame width must not be 0" and "Frame height must not be 0".
[Attachment #8778416](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") -
Flags: approval-mozilla-aurora?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a2140099_280903)• 8 years ago |

[Attachment #8780801](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") -
Flags: sec-approval?
[Attachment #8780801](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") -
Flags: sec-approval+
[Attachment #8780801](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") -
Flags: approval-mozilla-esr45?
[Attachment #8780801](/attachment.cgi?id=8780801&action=edit "v00-1288588-esr45-apng-bad-fcTL-pngdecoder") -
Flags: approval-mozilla-esr45+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a2140106_280903)• 8 years ago |

[Attachment #8778415](/attachment.cgi?id=8778415&action=edit "v02-1288588-beta-apng-bad-fcTL-pngdecoder") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a2140144_280903)• 8 years ago |

[Attachment #8778416](/attachment.cgi?id=8778416&action=edit "v01-1288588-aurora-apng-bad-fcTL-pngdecoder") -
Flags: approval-mozilla-aurora? → approval-mozilla-aurora+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 70](/show_bug.cgi?id=1288588#c70)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/8fd07f16556c>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla51

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 71](/show_bug.cgi?id=1288588#c71)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/8d65d9b7e5d2>
<https://hg.mozilla.org/releases/mozilla-beta/rev/9fc9fb9f8ae8>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a2219104_1689)• 8 years ago |

Group: gfx-core-security → core-security-release

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 72](/show_bug.cgi?id=1288588#c72)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/9707c3423a1e>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Christoph Diehl [:posidron]](/user_profile?user_id=368570)  Reporter |  |
| --- | --- | --- |
| [Comment 73](/show_bug.cgi?id=1288588#c73)• 8 years ago |
|  | |

May be stupid question but why are we declaring "width" and "height" as 'int' and not 'unsigned int' ?

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 74](/show_bug.cgi?id=1288588#c74)• 8 years ago |
|  | |

(In reply to Christoph Diehl [:posidron] from [comment #73](/show_bug.cgi?id=1288588#c73 "RESOLVED FIXED - PNG: heap-buffer-overflow crash [@MOZ_PNG_read_filt_row_a]"))
> May be stupid question but why are we declaring "width" and "height" as
> 'int' and not 'unsigned int' ?
In trunk and Aurora they are both png\_uint\_32 which is unsigned long
on 32-bit systems and unsigned int on 64-bit systems. So this
seems to have been fixed already.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 75](/show_bug.cgi?id=1288588#c75)• 8 years ago |
|  | |

There are at least two "apng" patches being distributed from SourceForge. The one by maxst, in the "APNG" project, and which we are using in our embedded libpng, is safe. The one by daisuken, in the "APNG patch for libpng" project, does not guard against width==0. Therefore it's important to guard against this in nsPNGDecoder.cpp when using the system library, and therefore landing [bug #1295671](/show_bug.cgi?id=1295671 "VERIFIED FIXED - Reliably detect use of the system libpng in nsPNGDecoder") is urgent, although it's currently marked "minor" importance.

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a3178031_14419)• 8 years ago |

[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected)

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 76](/show_bug.cgi?id=1288588#c76)• 8 years ago |
|  | |

Firefox 51 is still affected, until [bug #1295671](/show_bug.cgi?id=1295671 "VERIFIED FIXED - Reliably detect use of the system libpng in nsPNGDecoder") lands.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a4049708_280903)• 8 years ago |

Whiteboard: [adv-main49+][adv-esr45.4+]

|  | [Glenn Randers-Pehrson](/user_profile?user_id=14419)  Assignee |  |
| --- | --- | --- |
| [Comment 77](/show_bug.cgi?id=1288588#c77)• 8 years ago |
|  | |

[Bug #1295671](/show_bug.cgi?id=1295671 "VERIFIED FIXED - Reliably detect use of the system libpng in nsPNGDecoder") has landed, fixing the regression with unpatched non-system libpngStatus: REOPENED → RESOLVEDClosed: 8 years ago → 8 years agoResolution: --- → FIXED

|  | [Gerry Chang [:gchang]](/user_profile?user_id=506302) |  |
| --- | --- | --- |
| [Comment 78](/show_bug.cgi?id=1288588#c78)• 8 years ago |
|  | |

[Bug 1295671](/show_bug.cgi?id=1295671 "VERIFIED FIXED - Reliably detect use of the system libpng in nsPNGDecoder") is fixed and verified. Mark 51 as fixed.
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288588#a17500253_1689)• 8 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1288588&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Christoph Diehl [:posidron]](/user_profile?user_id=368570)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.debian.org_73c717fb_20250125_221219.html ===


---

[[Date Prev](msg00270.html)][[Date Next](msg00272.html)]
[[Thread Prev](msg00270.html)][[Thread Next](msg00272.html)]
[[Date Index](maillist.html#00271)]
[[Thread Index](threads.html#00271)]

# [SECURITY] [DSA 3690-1] icedove security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3690-1] icedove security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Mon, 10 Oct 2016 21:18:43 +0200
* *Message-id*: <[[🔎]](/msgid-search/20161010191843.ly4zacozsulh7w54%40pisco.westfalen.local) [20161010191843.ly4zacozsulh7w54@pisco.westfalen.local](msg00271.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3690-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
October 10, 2016                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : icedove
CVE ID         : CVE-2016-5257

Multiple security issues have been found in Icedove, Debian's version of
the Mozilla Thunderbird mail client: Multiple memory safety errors may
lead to the execution of arbitrary code or denial of service.

For the stable distribution (jessie), this problem has been fixed in
version 1:45.4.0-1~deb8u1.

For the testing distribution (stretch), this problem has been fixed
in version 1:45.4.0-1.

For the unstable distribution (sid), this problem has been fixed in
version 1:45.4.0-1.

We recommend that you upgrade your icedove packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIcBAEBCAAGBQJX++kmAAoJEBDCk7bDfE42uwsP/0nC79ULdxNJtIvJlIazE8v+
T7xr5STKgTaCr3Ytrgcd6/4Q1MxJxidQcHR2x7MfjBh4MwLveZwdvYFC/UlorrKc
YSZxyXw0MoW8/f0aomiUNyqWoUUfNxXH9BL2b0XRgIw0ubt9nm7ipbRy0t1FzyZz
bi9Ksb1UKKx2Nb8B4XqeACSKhOjCS/T2SpPd8WTrxngtzM77yug+TJaQnRUJ6e0K
M773NTiWZk/C1KTr7Rg8WMc2ruYkzt1Ydv3pM2vQ+eZtoc30e5MXhp9/lcda/O1D
ypm+2OYT619SdYWrTMAxNFFd/Nn4Pr2N8xPiGYCCk4SXEqXGAUDTdIYqiGr6mR8b
hJ8AgLN2DGDsmNenW8AiojdvgJEyjhGhi2g1ZrJQHhP1hb3/DkRBRrNSRcFSQHHe
O2dHNXdMwgqpvfLoCZLKTHBuh6VesFYTFrKfhiC+I6cFZpHbVInOox2RQvfzX3IV
HIK+dvEZO7MNEspDd260wLpDlWo7aOHMwUego+117Y0IrW15wGFZWPkSK6cQQz5/
7NF8k6VSsMvl83Ki6y8RYSB3zfI9s/8c4VuzvNMlFM/Q318VI2ASeoqQlPac2aSE
9aLXC+KZgUOSjGUnbU43vXOZXLQig32bdGRc51kSPeqAlbgsNKCdlicBSxxcYT+n
UbACrfn/VgBkvPADX242
=n4c8
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_a78aa95f_20250126_122132.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1287266)
* [XML](/show_bug.cgi?ctype=xml&id=1287266)

Closed
[Bug 1287266](/show_bug.cgi?id=1287266)
(CVE-2016-5261)

Opened 9 years ago
Closed 9 years ago

# Integer overflow and memory corruption in WebSocketChannel

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Integer overflow and memory corruption in WebSocketChannel

## Categories

### (Core :: Networking: WebSockets, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20WebSockets#Networking%3A%20WebSockets)

Networking: WebSockets
▾

Core :: Networking: WebSockets
Bugs related to the performance/correctness of the
on-the-wire WebSocket networking protocol: file other WebSockets bugs under
DOM:WebSockets
interface may be better classified as Core::DOM.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20WebSockets&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20WebSockets&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20WebSockets)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

47 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla50

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| a11y-review | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix) |
| firefox48 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=fixed) |
| firefox49 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 |  | wontfix |
| firefox48 |  | fixed |
| firefox49 |  | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 |  | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mozilla, Assigned: michal)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0299ccf6cbed3f86e2a9316f177739a8?d=mm&size=40)  [michal](/user_profile?user_id=268625)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/74745f547e8453a5dbb82cdbe0eee477?d=mm&size=40)  [mozilla](/user_profile?user_id=545368)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

12 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-intoverflow, reporter-external, sec-high, Whiteboard: [necko-active][adv-main48+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2016-5261

[Keywords:](/describekeywords.cgi)

[csectype-intoverflow](/buglist.cgi?keywords=csectype-intoverflow&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[necko-active][adv-main48+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [abillings](/user_profile?user_id=280903) | [sec-bounty](#a803469_280903 "9 years ago") | + |
| --- | --- | --- |
| [abillings](/user_profile?user_id=280903) | sec-bounty | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [Proof of Concept code](/attachment.cgi?id=8771665)  [9 years ago](#c0)  [Samuel Groß](/user_profile?user_id=545368)   1.78 KB, application/zip |  | [Details](/attachment.cgi?id=8771665&action=edit) |
| --- | --- | --- |
| [fix](/attachment.cgi?id=8772804)  [9 years ago](#c3)  [Michal Novotny [:michal]](/user_profile?user_id=268625)   867 bytes, patch | baku : [feedback-](#c4 "9 years ago") | [Details](/attachment.cgi?id=8772804&action=edit) | [Diff](/attachment.cgi?id=8772804&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772804) |
| [fix](/attachment.cgi?id=8772816)  [9 years ago](#c5)  [Michal Novotny [:michal]](/user_profile?user_id=268625)   1.07 KB, patch | mcmanus : [review+](#c6 "9 years ago")  Sylvestre : [approval-mozilla-aurora+](#c11 "9 years ago")  Sylvestre : [approval-mozilla-beta+](#c11 "9 years ago")  Sylvestre : [approval-mozilla-esr45+](#c20 "8 years ago") | [Details](/attachment.cgi?id=8772816&action=edit) | [Diff](/attachment.cgi?id=8772816&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Samuel Groß](/user_profile?user_id=545368)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1287266#c0)• 9 years ago |
| poc testcase | |

Attached file
[Proof of Concept code](attachment.cgi?id=8771665)
— [Details](attachment.cgi?id=8771665&action=edit)

From WebSocketChannel::ProcessInput
if (payloadLength64 + mFragmentAccumulator > mMaxMessageSize) {
return NS\_ERROR\_FILE\_TOO\_BIG;
}
|payloadLength64| is taken from the incoming websocket frame, and thus attacker controlled, while |mFragmentAccumulator| is the total size of all previous fragments belonging to the current message. The check tries to ensure that no incoming message is ever larger than |kMaxMessageSize|, which itself is at most INT32\_MAX. However, The check is incorrect due to the types of the operands:
int64\_t payloadLength64
uint32\_t mFragmentAccumulator;
int32\_t mMaxMessageSize;
According to the arithmetic conversion rules [1], |mFragmentAccumulator| and |kMaxMessageSize| will be converted to int64\_t before the comparison. As such the comparison is signed and will evaluate to false if the sum becomes negative. This can be achieved as follows:
1. Send a websocket fragment of size X (where X is less than |kMaxMessageSize|)
2. Send a second websocket fragment of size 0x7fffffffffffffff
The sum will then become negative and the check fails.
What happens then?
uint32\_t payloadLength = static\_cast<uint32\_t>(payloadLength64);
if (avail < payloadLength)
break;
|payloadLength| will be 0xffffffff and so ProcessInput will defer processing of the message until this many bytes have been received. Incoming data is thus buffered internally until a whole message has been received. WebSocketChannel::UpdateReadBuffer does this. Let's see what happens there:
} else {
// existing buffer is not sufficient, extend it
mBufferSize += count + 8192 + mBufferSize/3;
LOG(("WebSocketChannel: update read buffer extended to %u\n", mBufferSize));
uint8\_t \*old = mBuffer;
mBuffer = (uint8\_t \*)realloc(mBuffer, mBufferSize);
if (!mBuffer) {
mBuffer = old;
return false;
}
mFramePtr = mBuffer + (mFramePtr - old);
}
::memcpy(mBuffer + mBuffered, buffer, count);
The buffer will be resized multiple times. However, at some point 'count + 8192 + mBufferSize/3' will overflow, resulting in realloc actually shrinking the array. The following memcpy will then write controlled data at a known offset from the new buffer.
Attached is an html file and a python script. The html file sets up the websocket connection while the python script implements a simple websocket server and sends the malicious frames once a client is connected. To reproduce: start the python script on localhost and open websocket.html via file://. The python script should start printing progress information and at some point the browser will crash.
The backtrace at the time of the crash:
Process 75634 stopped
\* thread #8: tid = 0x206a90, 0x00007fff882ed01c libsystem\_platform.dylib`\_platform\_memmove$VARIANT$Haswell + 252, name = 'Socket Thread', stop reason = EXC\_BAD\_ACCESS (code=1, address=0x26d51700a)
frame #0: 0x00007fff882ed01c libsystem\_platform.dylib`\_platform\_memmove$VARIANT$Haswell + 252
libsystem\_platform.dylib`\_platform\_memmove$VARIANT$Haswell:
-> 0x7fff882ed01c <+252>: vmovups ymmword ptr [rax], ymm0
0x7fff882ed020 <+256>: vmovups ymm2, ymmword ptr [rsi + 0x20]
0x7fff882ed025 <+261>: add rsi, 0x40
0x7fff882ed029 <+265>: sub rdx, 0x80
(lldb) bt
\* thread #8: tid = 0x206a90, 0x00007fff882ed01c libsystem\_platform.dylib`\_platform\_memmove$VARIANT$Haswell + 252, name = 'Socket Thread', stop reason = EXC\_BAD\_ACCESS (code=1, address=0x26d51700a)
\* frame #0: 0x00007fff882ed01c libsystem\_platform.dylib`\_platform\_memmove$VARIANT$Haswell + 252
frame #1: 0x0000000102f91eb8 XUL`mozilla::net::WebSocketChannel::UpdateReadBuffer(this=0x00000001217c3000, buffer="AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"..., count=2048, accumulatedFragments=1024, available=0x000070000029ee0c) + 1096 at WebSocketChannel.cpp:1481
frame #2: 0x0000000102f92088 XUL`mozilla::net::WebSocketChannel::ProcessInput(this=0x00000001217c3000, buffer="AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"..., count=2048) + 360 at WebSocketChannel.cpp:1512
frame #3: 0x0000000102fa06b2 XUL`mozilla::net::WebSocketChannel::OnInputStreamReady(this=0x00000001217c3000, aStream=0x0000000122ee5630) + 898 at WebSocketChannel.cpp:3937
frame #4: 0x00000001027c6489 XUL`nsInputStreamReadyEvent::Run(this=0x000000011a713880) + 137 at nsStreamUtils.cpp:95
frame #5: 0x00000001027fabeb XUL`nsThread::ProcessNextEvent(this=0x0000000100719100, aMayWait=true, aResult=0x000070000029f88e) + 1211 at nsThread.cpp:1067
frame #6: 0x0000000102885e4c XUL`NS\_ProcessNextEvent(aThread=0x0000000100719100, aMayWait=true) + 140 at nsThreadUtils.cpp:290
frame #7: 0x00000001029e8a74 XUL`mozilla::net::nsSocketTransportService::Run(this=0x0000000100719000) + 1572 at nsSocketTransportService2.cpp:911
frame #8: 0x00000001027fabeb XUL`nsThread::ProcessNextEvent(this=0x0000000100719100, aMayWait=false, aResult=0x000070000029fbfe) + 1211 at nsThread.cpp:1067
frame #9: 0x0000000102885e4c XUL`NS\_ProcessNextEvent(aThread=0x0000000100719100, aMayWait=false) + 140 at nsThreadUtils.cpp:290
frame #10: 0x00000001031f7c86 XUL`mozilla::ipc::MessagePumpForNonMainThreads::Run(this=0x000000011a82b5c0, aDelegate=0x000000010072b460) + 646 at MessagePump.cpp:354
frame #11: 0x00000001030f4f15 XUL`MessageLoop::RunInternal(this=0x000000010072b460) + 117 at message\_loop.cc:235
frame #12: 0x00000001030f4e75 XUL`MessageLoop::RunHandler(this=0x000000010072b460) + 21 at message\_loop.cc:228
frame #13: 0x00000001030f4e1d XUL`MessageLoop::Run(this=0x000000010072b460) + 45 at message\_loop.cc:208
frame #14: 0x00000001027f8538 XUL`nsThread::ThreadFunc(aArg=0x0000000100719100) + 472 at nsThread.cpp:467
frame #15: 0x000000010235692d libnss3.dylib`\_pt\_root(arg=0x0000000100734eb0) + 429 at ptthread.c:216
frame #16: 0x00007fff894cf99d libsystem\_pthread.dylib`\_pthread\_body + 131
frame #17: 0x00007fff894cf91a libsystem\_pthread.dylib`\_pthread\_start + 168
frame #18: 0x00007fff894cd351 libsystem\_pthread.dylib`thread\_start + 13
[1] <http://en.cppreference.com/w/c/language/conversion#Usual_arithmetic_conversions>

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1287266#c1)• 9 years ago |
|  | |

Pat/Jed/Michal, can you look into this?Flags: needinfo?(michal.novotny)Flags: needinfo?(mcmanus)Flags: needinfo?(jld)

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1287266#c2)• 9 years ago |
|  | |

thanks - michal can fix this up.Group: firefox-core-security → network-core-securityComponent: Security → Networking: WebSocketsFlags: needinfo?(mcmanus)Product: Firefox → CoreWhiteboard: [necko-active]

|  | [Michal Novotny [:michal]](/user_profile?user_id=268625)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a119926_268625)• 9 years ago |

Assignee: nobody → michal.novotnyFlags: needinfo?(michal.novotny)

|  | [Jed Davis [:jld] ⟨⏰|UTC-8⟩ ⟦he/him⟧](/user_profile?user_id=462836) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a306397_462836)• 9 years ago |

Flags: needinfo?(jld)

|  | [Michal Novotny [:michal]](/user_profile?user_id=268625)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1287266#c3)• 9 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=8772804&action=diff) (obsolete)
— [Details](attachment.cgi?id=8772804&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772804)

[Attachment #8772804](/attachment.cgi?id=8772804&action=edit "fix") -
Flags: review?(mcmanus)

|  | [Andrea Marchesini [:baku]](/user_profile?user_id=446257) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1287266#c4)• 9 years ago |
|  | |

Comment on [attachment 8772804](/attachment.cgi?id=8772804 "fix") [[details]](/attachment.cgi?id=8772804&action=edit "fix") [[diff]](/attachment.cgi?id=8772804&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772804)
fix
Review of [attachment 8772804](/attachment.cgi?id=8772804 "fix") [[details]](/attachment.cgi?id=8772804&action=edit "fix") [[diff]](/attachment.cgi?id=8772804&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772804):
-----------------------------------------------------------------
::: netwerk/protocol/websocket/WebSocketChannel.cpp
@@ +1568,5 @@
>
> LOG(("WebSocketChannel::ProcessInput: payload %lld avail %lu\n",
> payloadLength64, avail));
>
> + if (payloadLength64 > UINT32\_MAX) {
What about:
CheckedInt<in64\_t> payloadLengthChecked(payloadLength64);
payloadLengthChecked += mFragmentAccumulator;
if (!payloadLengthChecked.isValid() || payloadLengthChecked.value() > mMaxMessageSize) {
return NS\_ERROR\_FILE\_TOO\_BIG;
}
[Attachment #8772804](/attachment.cgi?id=8772804&action=edit "fix") -
Flags: feedback-

|  | [Michal Novotny [:michal]](/user_profile?user_id=268625)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1287266#c5)• 9 years ago |
|  | |

Attached patch

[fix](attachment.cgi?id=8772816&action=diff)
— [Details](attachment.cgi?id=8772816&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816)

[Attachment #8772804](/attachment.cgi?id=8772804&action=edit "fix") -
Attachment is obsolete: true
[Attachment #8772804](/attachment.cgi?id=8772804&action=edit "fix") -
Flags: review?(mcmanus)
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: review?(mcmanus)

|  | [Michal Novotny [:michal]](/user_profile?user_id=268625)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a351129_268625)• 9 years ago |

Status: UNCONFIRMED → ASSIGNEDEver confirmed: true

|  | [Patrick McManus [:mcmanus]](/user_profile?user_id=32546) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1287266#c6)• 9 years ago |
|  | |

Comment on [attachment 8772816](/attachment.cgi?id=8772816 "fix") [[details]](/attachment.cgi?id=8772816&action=edit "fix") [[diff]](/attachment.cgi?id=8772816&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816)
fix
Review of [attachment 8772816](/attachment.cgi?id=8772816 "fix") [[details]](/attachment.cgi?id=8772816&action=edit "fix") [[diff]](/attachment.cgi?id=8772816&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816):
-----------------------------------------------------------------
Thanks Michal - and thanks for the CheckedInt shoutout
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: review?(mcmanus) → review+

|  | [Michal Novotny [:michal]](/user_profile?user_id=268625)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1287266#c7)• 9 years ago |
|  | |

Comment on [attachment 8772816](/attachment.cgi?id=8772816 "fix") [[details]](/attachment.cgi?id=8772816&action=edit "fix") [[diff]](/attachment.cgi?id=8772816&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816)
fix
Approval Request Comment
[Feature/regressing bug #]: probably 640003
[User impact if declined]: memory corruption caused by malicious page
[Describe test coverage new/current, TreeHerder]: tested manually against test provided by reporter
[Risks and why]: low, simple integer overflow fix
[String/UUID change made/needed]: none
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-beta?
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-aurora?

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1287266#c8)• 9 years ago |
|  | |

I think we need a sec approval here.
I guess esr45 is also impacted?
[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix)
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1287266#c9)• 9 years ago |
|  | |

Yes, this needs sec-approval to go into trunk (and anywhere else).Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a380410_1689)• 9 years ago |

[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1287266#c10)• 9 years ago |
|  | |

(In reply to Sylvestre Ledru [:sylvestre] from [comment #8](/show_bug.cgi?id=1287266#c8 "RESOLVED FIXED - Integer overflow and memory corruption in WebSocketChannel"))
> I think we need a sec approval here.
> I guess esr45 is also impacted?
landed without sec-approval in <https://hg.mozilla.org/integration/mozilla-inbound/rev/311e127edfff> and got now merged in:
<https://hg.mozilla.org/mozilla-central/rev/311e127edfff>Status: ASSIGNED → RESOLVEDClosed: 9 years ago
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)Flags: needinfo?(abillings)Resolution: --- → FIXEDTarget Milestone: --- → mozilla50

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1287266#c11)• 9 years ago |
|  | |

Comment on [attachment 8772816](/attachment.cgi?id=8772816 "fix") [[details]](/attachment.cgi?id=8772816&action=edit "fix") [[diff]](/attachment.cgi?id=8772816&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816)
fix
Next time, please wait for the sec approval before landing it.
Taking it to beta and aurora as we don't have much choice and we need it for beta 10...
Al, should we take into esr45? Thanks
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-beta?
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-beta+
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-aurora?
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-aurora+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1287266#c12)• 9 years ago |
|  | |

This needs a security rating before we can know and the sec-approval? template questions answered.Flags: needinfo?(abillings)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1287266#c13)• 9 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/99b62d79d2e4f8e8e5cb606891c1df80f0771bd1>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1287266#c14)• 9 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/68ca20cf8042>
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=fixed)

|  | [:Gijs (he/him)](/user_profile?user_id=159069) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1287266#c15)• 9 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #12](/show_bug.cgi?id=1287266#c12 "RESOLVED FIXED - Integer overflow and memory corruption in WebSocketChannel"))
> This needs a security rating before we can know and the sec-approval?
> template questions answered.
--> michal?Flags: needinfo?(michal.novotny)

|  | [Michal Novotny [:michal]](/user_profile?user_id=268625)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1287266#c16)• 9 years ago |
|  | |

The bug allows to write data provided by the web server outside the allocated buffer. I have no idea whether this can be used to execute native code or just to crash the firefox. I guess this is security-critical or security-high.Flags: needinfo?(michal.novotny)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a803327_280903)• 9 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a803469_280903)• 9 years ago |

Flags: sec-bounty? → sec-bounty+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a826479_280903)• 9 years ago |

Alias: CVE-2016-5261Whiteboard: [necko-active] → [necko-active][adv-main48+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1287266#c17)• 8 years ago |
|  | |

Do we need a different patch for the ESR-45 branch? We're basically out of time to get this into this release, please request esr-approval on the patch if it will work or on a new patch if it's needed.
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [48+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=48%2B)Flags: needinfo?(michal.novotny)

|  | [Michal Novotny [:michal]](/user_profile?user_id=268625)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1287266#c18)• 8 years ago |
|  | |

Comment on [attachment 8772816](/attachment.cgi?id=8772816 "fix") [[details]](/attachment.cgi?id=8772816&action=edit "fix") [[diff]](/attachment.cgi?id=8772816&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816)
fix
[Approval Request Comment]
User impact if declined: memory corruption caused by malicious page
Fix Landed on Version: 48
Risk to taking this patch (and alternatives if risky): low, simple integer overflow fix
String or UUID changes made by this patch: noneFlags: needinfo?(michal.novotny)
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-esr45?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a1086294_280903)• 8 years ago |

Flags: needinfo?(sledru)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1287266#c19)• 8 years ago |
|  | |

This is too late for esr, we already built it and we have the sign off.
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[48+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=48%2B) → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)Flags: needinfo?(sledru)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a1157314_1689)• 8 years ago |

Group: network-core-security → core-security-release

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1287266#c20)• 8 years ago |
|  | |

Comment on [attachment 8772816](/attachment.cgi?id=8772816 "fix") [[details]](/attachment.cgi?id=8772816&action=edit "fix") [[diff]](/attachment.cgi?id=8772816&action=diff "fix") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287266&attachment=8772816)
fix
sec-high, taking it to esr45 - 45.4.0
[Attachment #8772816](/attachment.cgi?id=8772816&action=edit "fix") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1287266#c21)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/bc2f5467b33d>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a4542594_280903)• 8 years ago |

Whiteboard: [necko-active][adv-main48+] → [necko-active][adv-main48+][adv-esr45.4+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a5925112_1689)• 8 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a11962969_1689)• 8 years ago |

Keywords: [csectype-intoverflow](/buglist.cgi?keywords=csectype-intoverflow&resolution=---)

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287266#a248420747_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1287266&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Samuel Groß](/user_profile?user_id=545368)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_cbb491a8_20250125_221221.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2016-85

## Security vulnerabilities fixed in Firefox 49

Announced
September 20, 2016
Impact
critical
Products
Firefox
Fixed in

* Firefox 49

#### [#CVE-2016-2827: Out-of-bounds read in mozilla::net::IsValidReferrerPolicy](#CVE-2016-2827)

Reporter
Atte Kettunen
Impact
low
##### Description

A content security policy (CSP) containing a `referrer` directive with no values can cause a non-exploitable crash.

##### References

* [Bug 1289085](https://bugzilla.mozilla.org/show_bug.cgi?id=1289085)

#### [#CVE-2016-5270: Heap-buffer-overflow in nsCaseTransformTextRunFactory::TransformString](#CVE-2016-5270)

Reporter
Atte Kettunen
Impact
high
##### Description

An out-of-bounds write of a boolean value during text conversion with some unicode characters

##### References

* [Bug 1291016](https://bugzilla.mozilla.org/show_bug.cgi?id=1291016)

#### [#CVE-2016-5271: Out-of-bounds read in PropertyProvider::GetSpacingInternal](#CVE-2016-5271)

Reporter
Abhishek Arya
Impact
low
##### Description

An out-of-bounds read during the processing of text runs in some pages using `display:contents`.

##### References

* [Bug 1288946](https://bugzilla.mozilla.org/show_bug.cgi?id=1288946)

#### [#CVE-2016-5272: Bad cast in nsImageGeometryMixin](#CVE-2016-5272)

Reporter
Abhishek Arya
Impact
high
##### Description

A bad cast when processing layout with `input` elements can result in a potentially exploitable crash.

##### References

* [Bug 129793](https://bugzilla.mozilla.org/show_bug.cgi?id=129793)

#### [#CVE-2016-5273: crash in mozilla::a11y::HyperTextAccessible::GetChildOffset](#CVE-2016-5273)

Reporter
Nils
Impact
high
##### Description

A potentially exploitable crash in accessibility.

##### References

* [Bug 1280387](https://bugzilla.mozilla.org/show_bug.cgi?id=1280387)

#### [#CVE-2016-5276: Heap-use-after-free in mozilla::a11y::DocAccessible::ProcessInvalidationList](#CVE-2016-5276)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability triggered by setting a `aria-owns` attribute.

##### References

* [Bug 1287721](https://bugzilla.mozilla.org/show_bug.cgi?id=1287721)

#### [#CVE-2016-5274: use-after-free in nsFrameManager::CaptureFrameState](#CVE-2016-5274)

Reporter
Nils
Impact
high
##### Description

A use-after-free issue in web animations during restyling.

##### References

* [Bug 1282076](https://bugzilla.mozilla.org/show_bug.cgi?id=1282076)

#### [#CVE-2016-5277: Heap-use-after-free in nsRefreshDriver::Tick](#CVE-2016-5277)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability with web animations when destroying a timeline.

##### References

* [Bug 1291665](https://bugzilla.mozilla.org/show_bug.cgi?id=1291665)

#### [#CVE-2016-5275: Buffer overflow in mozilla::gfx::FilterSupport::ComputeSourceNeededRegions](#CVE-2016-5275)

Reporter
Nils
Impact
critical
##### Description

A buffer overflow when working with empty filters during canvas rendering.

##### References

* [Bug 1287316](https://bugzilla.mozilla.org/show_bug.cgi?id=1287316)

#### [#CVE-2016-5278: Heap-buffer-overflow in nsBMPEncoder::AddImageFrame](#CVE-2016-5278)

Reporter
Nils
Impact
critical
##### Description

A potentially exploitable crash caused by a buffer overflow while encoding image frames to images.

##### References

* [Bug 1294677](https://bugzilla.mozilla.org/show_bug.cgi?id=1294677)

#### [#CVE-2016-5279: Full local path of files is available to web pages after drag and drop](#CVE-2016-5279)

Reporter
Rafael Gieschke
Impact
moderate
##### Description

The full path to local files is available to scripts when local files are drag and dropped into Firefox.

##### References

* [Bug 1249522](https://bugzilla.mozilla.org/show_bug.cgi?id=1249522)

#### [#CVE-2016-5280: Use-after-free in mozilla::nsTextNodeDirectionalityMap::RemoveElementFromMap](#CVE-2016-5280)

Reporter
Mei Wang
Impact
high
##### Description

Use-after-free vulnerability when changing text direction.

##### References

* [Bug 1289970](https://bugzilla.mozilla.org/show_bug.cgi?id=1289970)

#### [#CVE-2016-5281: use-after-free in DOMSVGLength](#CVE-2016-5281)

Reporter
Brian Carpenter
Impact
high
##### Description

Use-after-free vulnerability when manipulating SVG format content through script.

##### References

* [Bug 1284690](https://bugzilla.mozilla.org/show_bug.cgi?id=1284690)

#### [#CVE-2016-5282: Don't allow content to request favicons from non-whitelisted schemes](#CVE-2016-5282)

Reporter
Richard Newman
Impact
moderate
##### Description

Favicons can be loaded through non-whitelisted protocols, such as `jar:`.

##### References

* [Bug 932335](https://bugzilla.mozilla.org/show_bug.cgi?id=932335)

#### [#CVE-2016-5283: Iframe src fragment timing attack can reveal cross-origin data](#CVE-2016-5283)

Reporter
Gavin Sharp
Impact
high
##### Description

A timing attack vulnerability using iframes to potentially reveal private data using document resizes and link colors.

##### References

* [Bug 928187](https://bugzilla.mozilla.org/show_bug.cgi?id=928187)

#### [#CVE-2016-5284: Add-on update site certificate pin expiration](#CVE-2016-5284)

Reporter
Multiple people
Impact
high
##### Description

Due to [flaws in the process we used to update "Preloaded Public Key Pinning"](https://blog.mozilla.org/security/2016/09/16/update-on-add-on-pinning-vulnerability/) in our releases, the pinning for add-on updates became ineffective in early September. An attacker who was able to get a mis-issued certificate for a Mozilla web site could send malicious add-on updates to users on networks controlled by the attacker. Users who have not installed any add-ons are not affected.

##### References

* [1303127](https://bugzilla.mozilla.org/show_bug.cgi?id=1303127)

#### [#CVE-2016-5256: Memory safety bugs fixed in Firefox 49](#CVE-2016-5256)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers Christoph Diehl, Christian Holler, Gary Kwong, Nathan Froyd, Honza Bambas, Seth Fowler, and Michael Smith reported memory safety bugs present in Firefox 48. Some of these bugs showed evidence of memory corruption under certain circumstances could potentially exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 49](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087)

#### [#CVE-2016-5257: Memory safety bugs fixed in Firefox 49 and Firefox ESR 45.4](#CVE-2016-5257)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, and Carsten Book reported memory safety bugs present in Firefox 48 and Firefox ESR 45.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort at least some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 49 and Firefox ESR 45.4](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1288588%2C1287204%2C1294407%2C1293347%2C1288780%2C1288555%2C1289280%2C1294095%2C1277213)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.redhat.com_5f1ef493_20250126_122138.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_47f1586b_20250125_221232.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1288780)
* [XML](/show_bug.cgi?ctype=xml&id=1288780)

Closed
[Bug 1288780](/show_bug.cgi?id=1288780)

Opened 9 years ago
Closed 8 years ago

# Possible crash if object containing GCPtr destroyed after failed initialisation

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Possible crash if object containing GCPtr destroyed after failed initialisation

## Categories

### (Core :: JavaScript: GC, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%3A%20GC#JavaScript%3A%20GC)

JavaScript: GC
▾

Core :: JavaScript: GC
File bugs here for issues involving the garbage collector (crashes, leaks, etc.), where the issue is *not* one caused by failure to use the JSAPI correctly.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%3A%20GC&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%3A%20GC)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla50

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 |  | wontfix |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: jonco, Assigned: jonco)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/c9ec760b0d3a20a6775614baa4086871?d=mm&size=40)  [jonco](/user_profile?user_id=443194)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/c9ec760b0d3a20a6775614baa4086871?d=mm&size=40)  [jonco](/user_profile?user_id=443194)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

5 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

[1292529](/show_bug.cgi?id=1292529 "RESOLVED FIXED - Crash [@ js::gc::IsInsideNursery]"), [1292564](/show_bug.cgi?id=1292564 "RESOLVED FIXED - Assertion failure: CurrentThreadIsGCSweeping(), at js/src/jsweakmap.cpp:35 with OOM and Debugger")

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

Dependency [tree](/showdependencytree.cgi?id=1288780&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1288780)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-moderate, Whiteboard: [post-critsmash-triage][adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a3943855_452604 "8 years ago") | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (3 files, 1 obsolete file)

| [bug1288780-gc-ptr](/attachment.cgi?id=8773860)  [9 years ago](#c1)  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)   7.10 KB, patch |  | [Details](/attachment.cgi?id=8773860&action=edit) | [Diff](/attachment.cgi?id=8773860&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8773860) |
| --- | --- | --- |
| [bug1288780-gc-ptr v1](/attachment.cgi?id=8775250)  [8 years ago](#c2)  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)   35.75 KB, patch | terrence : [review+](#c3 "8 years ago")  abillings : [sec-approval+](#a646589_280903 "8 years ago") | [Details](/attachment.cgi?id=8775250&action=edit) | [Diff](/attachment.cgi?id=8775250&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8775250) |
| [bug1288780-beta](/attachment.cgi?id=8777254)  [8 years ago](#c14)  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)   36.77 KB, patch | jonco : [review+](#c14 "8 years ago")  ritu : [approval-mozilla-beta+](#c16 "8 years ago") | [Details](/attachment.cgi?id=8777254&action=edit) | [Diff](/attachment.cgi?id=8777254&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8777254) |
| [bug1288780-esr45](/attachment.cgi?id=8777255)  [8 years ago](#c15)  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)   36.81 KB, patch | jonco : [review+](#c15 "8 years ago")  ritu : [approval-mozilla-esr45+](#c17 "8 years ago") | [Details](/attachment.cgi?id=8777255&action=edit) | [Diff](/attachment.cgi?id=8777255&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8777255) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1288780#c0)• 9 years ago |
|  | |

The GCPtr destructor contains this assertion as to when it's safe to destroy one of these things:
// No prebarrier necessary as this only happens when we are sweeping or
// before the containing object becomes part of the GC graph.
MOZ\_ASSERT(CurrentThreadIsGCSweeping() || CurrentThreadIsHandlingInitFailure());
This doesn't take account of the fact that a post-barrier may have put a pointer to this GCPtr into the storebuffer. If we do a minor GC in this state we'll attempt to mark whatever garbage ends up at this location.
This only happens when an object containing a GCPtr is destroyed due to initialization failure (otherwise they are destroyed during sweeping which is fine).
We already have AutoInitGCManagedObject that is supposed to take care of issues like this for us. A possible fix is to make that put the object on a queue whose contents are destroyed after the next minor GC. Also, we need jsapi-tests for this.

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1288780#c1)• 9 years ago |
|  | |

Attached patch

[bug1288780-gc-ptr](attachment.cgi?id=8773860&action=diff) (obsolete)
— [Details](attachment.cgi?id=8773860&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8773860)

Here's a failing test case.

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a410619_443194)• 8 years ago |

Assignee: nobody → jcoppeard

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1288780#c2)• 8 years ago |
|  | |

Attached patch

[bug1288780-gc-ptr v1](attachment.cgi?id=8775250&action=diff)
— [Details](attachment.cgi?id=8775250&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8775250)

Here's a patch to implement the proposed fix.
It removes AutoInitGCManagedObject and replaces it with GCManagedDeletePolicy. The latter can be used as the delete policy for a UniquePtr, or used to implement the default delete policy for the relevant classes (I've done the latter here).
The delete policy queues a thunk to delete the object after the next minor GC, by which time the store buffer will be empty. It uses a nursery allocation for the linked list element. If the nursery is disabled or we are not on the main thread then the problem doesn't occur anyway and we can delete the object immediately. Similarly, we evict the nursery instead if we can't allocate (and this path is exercised by our OOM testing).
UnboxedLayout caused me a lot of problems with the assertions in the GCPtr destructor because it can theoretically be constructed and hence destroyed off main thread (I never observed this though). This is safe as stated previously. I relaxed the assertion to allow destruction off main thread where the wrapper doesn't contain a nursery pointer. I feel like that's a bit of a cop-out but couldn't see a better way.
Also, UnboxedLayout is constructed when we are inside an AutoSuppressGC region. I had to add a UniquePtr in AutoEnterAnalysis for it to use so that it was cleaned up after then end of the GC suppression.
[Attachment #8773860](/attachment.cgi?id=8773860&action=edit "bug1288780-gc-ptr") -
Attachment is obsolete: true
[Attachment #8775250](/attachment.cgi?id=8775250&action=edit "bug1288780-gc-ptr v1") -
Flags: review?(terrence)

|  | [Terrence Cole [:terrence]](/user_profile?user_id=231770) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1288780#c3)• 8 years ago |
|  | |

Comment on [attachment 8775250](/attachment.cgi?id=8775250 "bug1288780-gc-ptr v1") [[details]](/attachment.cgi?id=8775250&action=edit "bug1288780-gc-ptr v1") [[diff]](/attachment.cgi?id=8775250&action=diff "bug1288780-gc-ptr v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8775250)
[bug1288780](/show_bug.cgi?id=1288780 "RESOLVED FIXED - Possible crash if object containing GCPtr destroyed after failed initialisation")-gc-ptr v1
Review of [attachment 8775250](/attachment.cgi?id=8775250 "bug1288780-gc-ptr v1") [[details]](/attachment.cgi?id=8775250&action=edit "bug1288780-gc-ptr v1") [[diff]](/attachment.cgi?id=8775250&action=diff "bug1288780-gc-ptr v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8775250):
-----------------------------------------------------------------
::: js/src/gc/Barrier.h
@@ +454,5 @@
> + // after we have just collected the nursery.
> + bool inNursery = InternalBarrierMethods<T>::isInsideNursery(this->value);
> + MOZ\_ASSERT(CurrentThreadIsGCSweeping() ||
> + CurrentThreadCanSkipPostBarrier(inNursery));
> + memset(this, JS\_FREED\_HEAP\_PTR\_PATTERN, sizeof(\*this));
Nice touch! Please use the Poison function so that we have global control over when this is enabled.
::: js/src/gc/Nursery.cpp
@@ +73,5 @@
> + uint32\_t padding;
> +#endif
> +};
> +
> +
Extra whitespace.
@@ +829,5 @@
> + runtime()->gc.evictNursery();
> + AutoSetThreadIsSweeping threadIsSweeping;
> + thunk(data);
> + return;
> + }
Neat! Is the intention that we can implement our other ad-hoc sweeping activity with this mechanism?
[Attachment #8775250](/attachment.cgi?id=8775250&action=edit "bug1288780-gc-ptr v1") -
Flags: review?(terrence) → review+

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1288780#c4)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/d757a1ca6d56>

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1288780#c5)• 8 years ago |
|  | |

Comment on [attachment 8775250](/attachment.cgi?id=8775250 "bug1288780-gc-ptr v1") [[details]](/attachment.cgi?id=8775250&action=edit "bug1288780-gc-ptr v1") [[diff]](/attachment.cgi?id=8775250&action=diff "bug1288780-gc-ptr v1") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8775250)
[bug1288780](/show_bug.cgi?id=1288780 "RESOLVED FIXED - Possible crash if object containing GCPtr destroyed after failed initialisation")-gc-ptr v1
Ah, I forgot to get approval before landing, sorry about that.
[Security approval request comment]
How easily could an exploit be constructed based on the patch? Difficult, would require an attacker to understand the changes and work out where this problem currently manifests itself. I'm not sure it's even an issue in the current codebase just that it has the possibility to become one.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? No.
Which older supported branches are affected by this flaw? Pretty much everything.
If not all supported branches, which bug introduced the flaw? [Bug 1165966](/show_bug.cgi?id=1165966 "RESOLVED FIXED - Assertion failure: safepoint->hasBoxedValue(alloc), at js/src/jit/RegisterAllocator.cpp:338 or Assertion failure: CurrentThreadIsGCSweeping(), at js/src/gc/Barrier.h:442 with OOM") was the previous attempt to address this issue but the underlying problem may be have there since [bug 619558](/show_bug.cgi?id=619558 "RESOLVED FIXED - [meta] Implement generational garbage collection").
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? Shouldn't be too hard to create patches along the same lines.
How likely is this patch to cause regressions; how much testing does it need? Unlikely.
[Attachment #8775250](/attachment.cgi?id=8775250&action=edit "bug1288780-gc-ptr v1") -
Flags: sec-approval?

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1288780#c6)• 8 years ago |
|  | |

backed for causing hazard failures like <https://treeherder.mozilla.org/logviewer.html#?job_id=32784246&repo=mozilla-inbound>Flags: needinfo?(jcoppeard)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1288780#c7)• 8 years ago |
|  | |

Steve, I want to do something like the following in a jsapi test:
auto heapPtr = cx->make\_unique<GCPtr<JSObject\*>>();
// ...
cx->minorGC(JS::gcreason::API);
Is there any way I can do this without the hazard analysis complaining that heapPtr is unrooted?Flags: needinfo?(jcoppeard) → needinfo?(sphink)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1288780#c8)• 8 years ago |
|  | |

Let's try to get this into aurora (49) now and then work on ESR for next cycle (e.g. the one shipping with 49).
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1288780#c9)• 8 years ago |
|  | |

I guess the problem is that you're basically putting a heap pointer on the stack, or rather in UniquePtr memory, which the analysis treats as unsafe as the stack.
Which is ok here because... oh, because it's a jsapi-test. So to confirm: you want a way to avoid the analysis for a test only, right? As in, it would still be correct for the analysis to complain for the above code normally?
Assuming so, I think this seems like a totally appropriate use of AutoSuppressGCAnalysis. You're sort of intentionally setting up the situation that the analysis protects against: you're putting a GC pointer into memory that doesn't get traced, and then you GC. If your test did another GC after the minorGC, then this would be a UAF, right?
I'm working on something that would allow annotating specific variables as holding only non-GC pointers even though their type says they can have GC pointers. It's intended for use in cases where you know you only have a numeric Value or whatever, but it would be handy here. I wouldn't wait for it, though; I'm not sure how feasible it is yet.Flags: needinfo?(sphink)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1288780#c10)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/2a200a9215d7>

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1288780#c11)• 8 years ago |
|  | |

backed out for bustage like <https://treeherder.mozilla.org/logviewer.html#?job_id=32891639&repo=mozilla-inbound>Flags: needinfo?(jcoppeard)

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1288780#c12)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/1506fafba57d>Flags: needinfo?(jcoppeard)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a646589_280903)• 8 years ago |

[Attachment #8775250](/attachment.cgi?id=8775250&action=edit "bug1288780-gc-ptr v1") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a646604_280903)• 8 years ago |

[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1288780#c13)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/1506fafba57d>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla50

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1288780#c14)• 8 years ago |
|  | |

Attached patch

[bug1288780-beta](attachment.cgi?id=8777254&action=diff)
— [Details](attachment.cgi?id=8777254&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8777254)

Approval Request Comment
[Feature/regressing bug #]: [Bug 619558](/show_bug.cgi?id=619558 "RESOLVED FIXED - [meta] Implement generational garbage collection")
[User impact if declined]: Possible (though unlikely) crash / security vulnerability.
[Describe test coverage new/current, TreeHerder]: On central since 30th July
[Risks and why]: Low
[String/UUID change made/needed]:
[Attachment #8777254](/attachment.cgi?id=8777254&action=edit "bug1288780-beta") -
Flags: review+
[Attachment #8777254](/attachment.cgi?id=8777254&action=edit "bug1288780-beta") -
Flags: approval-mozilla-beta?

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1288780#c15)• 8 years ago |
|  | |

Attached patch

[bug1288780-esr45](attachment.cgi?id=8777255&action=diff)
— [Details](attachment.cgi?id=8777255&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8777255)

[Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined: Possible (though unlikely) crash / security vulnerability.
Fix Landed on Version: 50
Risk to taking this patch (and alternatives if risky): Low
String or UUID changes made by this patch: None
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Attachment #8777255](/attachment.cgi?id=8777255&action=edit "bug1288780-esr45") -
Flags: review+
[Attachment #8777255](/attachment.cgi?id=8777255&action=edit "bug1288780-esr45") -
Flags: approval-mozilla-esr45?

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1288780#c16)• 8 years ago |
|  | |

Comment on [attachment 8777254](/attachment.cgi?id=8777254 "bug1288780-beta") [[details]](/attachment.cgi?id=8777254&action=edit "bug1288780-beta") [[diff]](/attachment.cgi?id=8777254&action=diff "bug1288780-beta") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8777254)
[bug1288780](/show_bug.cgi?id=1288780 "RESOLVED FIXED - Possible crash if object containing GCPtr destroyed after failed initialisation")-beta
Sec-mod, still early in the beta cycle, Beta49+
[Attachment #8777254](/attachment.cgi?id=8777254&action=edit "bug1288780-beta") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1288780#c17)• 8 years ago |
|  | |

Comment on [attachment 8777255](/attachment.cgi?id=8777255 "bug1288780-esr45") [[details]](/attachment.cgi?id=8777255&action=edit "bug1288780-esr45") [[diff]](/attachment.cgi?id=8777255&action=diff "bug1288780-esr45") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288780&attachment=8777255)
[bug1288780](/show_bug.cgi?id=1288780 "RESOLVED FIXED - Possible crash if object containing GCPtr destroyed after failed initialisation")-esr45
Sec-mod, ESR45+
[Attachment #8777255](/attachment.cgi?id=8777255&action=edit "bug1288780-esr45") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1288780#c18)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/186f568472e7>
<https://hg.mozilla.org/releases/mozilla-esr45/rev/b08f28db372e>

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1288780#c19)• 8 years ago |
|  | |

(In reply to Jon Coppeard (:jonco) from [comment #18](/show_bug.cgi?id=1288780#c18 "RESOLVED FIXED - Possible crash if object containing GCPtr destroyed after failed initialisation"))
> <https://hg.mozilla.org/releases/mozilla-beta/rev/186f568472e7>
> <https://hg.mozilla.org/releases/mozilla-esr45/rev/b08f28db372e>
setting flags for jon
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a1466975_1689)• 8 years ago |

Group: javascript-core-security → core-security-release

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a1550177_443194)• 8 years ago |

Depends on: [1292564](/show_bug.cgi?id=1292564 "RESOLVED FIXED - Assertion failure: CurrentThreadIsGCSweeping(), at js/src/jsweakmap.cpp:35 with OOM and Debugger")

|  | [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a2240863_443194)• 8 years ago |

Depends on: [1292529](/show_bug.cgi?id=1292529 "RESOLVED FIXED - Crash [@ js::gc::IsInsideNursery]")

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a3943855_452604)• 8 years ago |

Flags: qe-verify-Whiteboard: [post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a3998845_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main49+][adv-esr45.4+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288780#a17448988_1689)• 8 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1288780&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Jon Coppeard (:jonco) (PTO until 27th Jan)](/user_profile?user_id=443194)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.redhat.com_a44c4179_20250126_122136.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_42f0b06d_20250125_221239.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1294407)
* [XML](/show_bug.cgi?ctype=xml&id=1294407)

Closed
[Bug 1294407](/show_bug.cgi?id=1294407)

Opened 8 years ago
Closed 8 years ago

# Firefox crash when packets with missing headers are received

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Firefox crash when packets with missing headers are received

## Categories

### (Core :: WebRTC, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC#WebRTC)

WebRTC
▾

Core :: WebRTC
General bugs associated with WebRTC
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

[Rank:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rank)

10

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla51

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |
| firefox51 | [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 |  | wontfix |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | fixed |
| firefox51 | + | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: dminor, Assigned: jesup)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/2ac711ca4c5ab8c8545725bcd618c037?d=mm&size=40)  [dminor](/user_profile?user_id=466787)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/e2a2be17b9bb8a1d4d7427c810996388?d=mm&size=40)  [mjf](/user_profile?user_id=546718)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[webrtc\_upstream\_bugs](/show_bug.cgi?id=864513 "NEW - [meta] Upstream or remove local webrtc.org code changes")

Dependency [tree](/showdependencytree.cgi?id=1294407&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1294407)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-bounds, sec-high, Whiteboard: [adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c6 "8 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a2231980_452604 "8 years ago") | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Clean up H264 STAP-A handling](/attachment.cgi?id=8780344)  [8 years ago](#c2)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   5.40 KB, patch | pkerr : [review+](#a100410_498289 "8 years ago")  abillings : [approval-mozilla-aurora+](#a375044_280903 "8 years ago")  abillings : [approval-mozilla-beta+](#a375044_280903 "8 years ago")  abillings : [approval-mozilla-esr45+](#a375044_280903 "8 years ago")  abillings : [sec-approval+](#a375044_280903 "8 years ago") | [Details](/attachment.cgi?id=8780344&action=edit) | [Diff](/attachment.cgi?id=8780344&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294407&attachment=8780344) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Dan Minor [:dminor]](/user_profile?user_id=466787)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1294407#c0)• 8 years ago |
|  | |

In [Bug 1293422](/show_bug.cgi?id=1293422 "RESOLVED FIXED - [openh264] Mode 0 crashes FF >= 50 immediately") I was inadvertently fuzzing Firefox with packets with missing headers, which caused heap corruption and an eventual crash. We should be rejecting invalid packets rather than crashing.

|  | [Dan Minor [:dminor]](/user_profile?user_id=466787)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1294407#c1)• 8 years ago |
|  | |

jesup confirmed the same location reported in [Bug 1293422](/show_bug.cgi?id=1293422 "RESOLVED FIXED - [openh264] Mode 0 crashes FF >= 50 immediately"):
==17052==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61900110258f at pc 0x00000049bc2a bp 0x7fffc433d550 sp 0x7fffc433cd10
READ of size 12288 at 0x61900110258f thread T6 (Socket Thread)
[New Thread 0x7fffc4346700 (LWP 17076)]
Detaching after fork from child process 17223.
#0 0x49bc29 in \_\_asan\_memcpy /home/nikola/final/llvm.src/projects/compiler-rt/lib/asan/asan\_interceptors.cc:393:3
#1 0x7fffd8bb687a in webrtc::VCMSessionInfo::Insert(unsigned char const\*, unsigned long, bool, unsigned char\*) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/session\_info.cc:222:3
#2 0x7fffd8bb687a in webrtc::VCMSessionInfo::InsertBuffer(unsigned char\*, std::\_List\_iterator<webrtc::VCMPacket>) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/session\_info.cc:193
#3 0x7fffd8bb8868 in webrtc::VCMSessionInfo::InsertPacket(webrtc::VCMPacket const&, unsigned char\*, webrtc::VCMDecodeErrorMode, webrtc::FrameData const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/session\_info.cc:565:25
#4 0x7fffd8b8719d in webrtc::VCMFrameBuffer::InsertPacket(webrtc::VCMPacket const&, long, webrtc::VCMDecodeErrorMode, webrtc::FrameData const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/frame\_buffer.cc:144:18
#5 0x7fffd8b93baf in webrtc::VCMJitterBuffer::InsertPacket(webrtc::VCMPacket const&, bool\*) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/jitter\_buffer.cc:778:7
#6 0x7fffd8bad1d2 in webrtc::VCMReceiver::InsertPacket(webrtc::VCMPacket const&, unsigned short, unsigned short) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/receiver.cc:72:34
#7 0x7fffd8bc0078 in webrtc::vcm::VideoReceiver::IncomingPacket(unsigned char const\*, unsigned long, webrtc::WebRtcRTPHeader const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/video\_receiver.cc:580:17
#8 0x7fffd8d2c634 in webrtc::ViEReceiver::OnReceivedPayloadData(unsigned char const\*, unsigned long, webrtc::WebRtcRTPHeader const\*) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/video\_engine/vie\_receiver.cc:249:7
#9 0x7fffd8dad101 in webrtc::RTPReceiverVideo::ParseRtpPacket(webrtc::WebRtcRTPHeader\*, webrtc::PayloadUnion const&, bool, unsigned char const\*, unsigned long, long, bool) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/rtp\_rtcp/source/rtp\_receiver\_video.cc:101:10
#10 0x7fffd8da9a9d in webrtc::RtpReceiverImpl::IncomingRtpPacket(webrtc::RTPHeader const&, unsigned char const\*, unsigned long, webrtc::PayloadUnion, bool) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/rtp\_rtcp/source/rtp\_receiver\_impl.cc:222:21
#11 0x7fffd8d2cc74 in webrtc::ViEReceiver::ReceivePacket(unsigned char const\*, unsigned long, webrtc::RTPHeader const&, bool) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/video\_engine/vie\_receiver.cc:358:10
#12 0x7fffd8d2b9a4 in webrtc::ViEReceiver::InsertRTPPacket(unsigned char const\*, unsigned long, webrtc::PacketTime const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/video\_engine/vie\_receiver.cc:332:13
Submit a correction or amendment below (click here to make a fresh posting)
After submitting an amendment, you'll be able to view the differences between the old and new posts easily.
Syntax highlighting:
To highlight particular lines, prefix each line with ~~
==17052==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x61900110258f at pc 0x00000049bc2a bp 0x7fffc433d550 sp 0x7fffc433cd10
READ of size 12288 at 0x61900110258f thread T6 (Socket Thread)
[New Thread 0x7fffc4346700 (LWP 17076)]
Detaching after fork from child process 17223.
#0 0x49bc29 in \_\_asan\_memcpy /home/nikola/final/llvm.src/projects/compiler-rt/lib/asan/asan\_interceptors.cc:393:3
#1 0x7fffd8bb687a in webrtc::VCMSessionInfo::Insert(unsigned char const\*, unsigned long, bool, unsigned char\*) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/session\_info.cc:222:3
#2 0x7fffd8bb687a in webrtc::VCMSessionInfo::InsertBuffer(unsigned char\*, std::\_List\_iterator<webrtc::VCMPacket>) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/session\_info.cc:193
#3 0x7fffd8bb8868 in webrtc::VCMSessionInfo::InsertPacket(webrtc::VCMPacket const&, unsigned char\*, webrtc::VCMDecodeErrorMode, webrtc::FrameData const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/session\_info.cc:565:25
#4 0x7fffd8b8719d in webrtc::VCMFrameBuffer::InsertPacket(webrtc::VCMPacket const&, long, webrtc::VCMDecodeErrorMode, webrtc::FrameData const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/frame\_buffer.cc:144:18
#5 0x7fffd8b93baf in webrtc::VCMJitterBuffer::InsertPacket(webrtc::VCMPacket const&, bool\*) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/jitter\_buffer.cc:778:7
#6 0x7fffd8bad1d2 in webrtc::VCMReceiver::InsertPacket(webrtc::VCMPacket const&, unsigned short, unsigned short) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/receiver.cc:72:34
#7 0x7fffd8bc0078 in webrtc::vcm::VideoReceiver::IncomingPacket(unsigned char const\*, unsigned long, webrtc::WebRtcRTPHeader const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/video\_coding/main/source/video\_receiver.cc:580:17
#8 0x7fffd8d2c634 in webrtc::ViEReceiver::OnReceivedPayloadData(unsigned char const\*, unsigned long, webrtc::WebRtcRTPHeader const\*) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/video\_engine/vie\_receiver.cc:249:7
#9 0x7fffd8dad101 in webrtc::RTPReceiverVideo::ParseRtpPacket(webrtc::WebRtcRTPHeader\*, webrtc::PayloadUnion const&, bool, unsigned char const\*, unsigned long, long, bool) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/rtp\_rtcp/source/rtp\_receiver\_video.cc:101:10
#10 0x7fffd8da9a9d in webrtc::RtpReceiverImpl::IncomingRtpPacket(webrtc::RTPHeader const&, unsigned char const\*, unsigned long, webrtc::PayloadUnion, bool) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/modules/rtp\_rtcp/source/rtp\_receiver\_impl.cc:222:21
#11 0x7fffd8d2cc74 in webrtc::ViEReceiver::ReceivePacket(unsigned char const\*, unsigned long, webrtc::RTPHeader const&, bool) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/video\_engine/vie\_receiver.cc:358:10
#12 0x7fffd8d2b9a4 in webrtc::ViEReceiver::InsertRTPPacket(unsigned char const\*, unsigned long, webrtc::PacketTime const&) /home/jesup/src/mozilla/asan-inbound/media/webrtc/trunk/webrtc/video\_engine/vie\_receiver.cc:332:13

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a43912_11539)• 8 years ago |

Assignee: nobody → rjesupGroup: media-core-securityComponent: WebRTC: Audio/Video → WebRTCKeywords: [csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1294407#c2)• 8 years ago |
|  | |

Attached patch

[Clean up H264 STAP-A handling](attachment.cgi?id=8780344&action=diff)
— [Details](attachment.cgi?id=8780344&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294407&attachment=8780344)

[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: review?(pkerr)

|  | [Paul Kerr [:pkerr]](/user_profile?user_id=498289) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a100410_498289)• 8 years ago |

[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: review?(pkerr) → review+

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a108524_11539)• 8 years ago |

[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1294407#c3)• 8 years ago |
|  | |

Comment on [attachment 8780344](/attachment.cgi?id=8780344 "Clean up H264 STAP-A handling") [[details]](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") [[diff]](/attachment.cgi?id=8780344&action=diff "Clean up H264 STAP-A handling") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294407&attachment=8780344)
Clean up H264 STAP-A handling
[ESR Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration:
User impact if declined: Possible attack by feeding corrupt video data forcing an overrun with the data in the packets copied past the end of the buffer.
Fix Landed on Version: N/A
Risk to taking this patch (and alternatives if risky): Low risk. Adds some bufferspace, and kicks out (throws away data) if it's larger than it was supposed to be.
String or UUID changes made by this patch: none
[Feature/regressing bug #]: Upstream bug; N/A
[Describe test coverage new/current, TreeHerder]: We don't fuzz in automation
[Security approval request comment]
How easily could an exploit be constructed based on the patch? Not that hard to figure out how to force a buffer-overrun. Exploiting would likely require forcing a more complex case where there is a later packet in the "session" that needs to get moved down to make space for a corrupt STAP-A NAL. However, normally a STAP-A is a single packet, so there'd be no later packets, but you might be able to trick it by sending a FU-A or other packet with a sequence number gap before it, then send the corrupt STAP-A as the packet to fill the sequence number gap (with the same timestamp as the packets after the gap). This may not be obvious, but could be figured out with some work.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
The code and log messages do indicate buffersize issues and mishandling of corrupt STAP NAL sizes.
Which older supported branches are affected by this flaw? Pretty much all branches
If not all supported branches, which bug introduced the flaw? Probably the upstream 43 import, or perhaps the one before that. At least back to Nov 2015.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? Backports should be trivial; few changes to these files.
How likely is this patch to cause regressions; how much testing does it need? Some manual testing - I've 'fuzzed' it by using the broken Mode 0 support that generates corrupt packets, and I could previously see ASAN hits quickly (seconds or instantly). With this patch it's gone for a good part of an hour with no problems. Also, I've run it with Mode 1 to verify it's good under ASAN, no problems.
A more complete fuzzing of H264 would be a good idea as a followup.
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: sec-approval?
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-esr45?
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-beta?
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-aurora?

|  | [Maire Reavy [:mreavy]](/user_profile?user_id=74434) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a115903_74434)• 8 years ago |

Rank: 10Priority: P2 → P1

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a375044_280903)• 8 years ago |

[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: sec-approval?
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: sec-approval+
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-esr45?
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-esr45+
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-beta?
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-beta+
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-aurora?
[Attachment #8780344](/attachment.cgi?id=8780344&action=edit "Clean up H264 STAP-A handling") -
Flags: approval-mozilla-aurora+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a375081_280903)• 8 years ago |

[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1294407#c4)• 8 years ago |
|  | |

 <https://hg.mozilla.org/integration/mozilla-inbound/rev/f77d344cf887>

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1294407#c5)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/d23f68f5cb77>
<https://hg.mozilla.org/releases/mozilla-beta/rev/8ea0c38aae0b>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1294407#c6)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/dd9eb81853b9>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)Flags: in-testsuite?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1294407#c7)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/f77d344cf887>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla51

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a1830938_1689)• 8 years ago |

Group: media-core-security → core-security-release

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a2231980_452604)• 8 years ago |

Flags: qe-verify-

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a2287331_280903)• 8 years ago |

Whiteboard: [adv-main49+][adv-esr45.4+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294407#a15737658_1689)• 8 years ago |

Group: core-security-release

|  | [Dan Minor [:dminor]](/user_profile?user_id=466787)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1294407#c8)• 6 years ago |
|  | |

We should upstream this fix.Blocks: [webrtc\_upstream\_bugs](/show_bug.cgi?id=864513 "NEW - [meta] Upstream or remove local webrtc.org code changes")
You need to [log in](/show_bug.cgi?id=1294407&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.redhat.com_fbd8f219_20250126_122135.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1377549)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1377549)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1377549)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1377549

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1377549**](show_bug.cgi?id=1377549)
(CVE-2016-5278)
- [CVE-2016-5278](https://access.redhat.com/security/cve/CVE-2016-5278) Mozilla: Heap-buffer-overflow in nsBMPEncoder::AddImageFrame (MFSA 2016-85, MFSA 2016-86)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-5278 Mozilla: Heap-buffer-overflow in nsBMPEncoder::AddImageFrame (M...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-5278 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | urgent | | [Severity:](page.cgi?id=fields.html#bug_severity) | urgent | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1369653](show_bug.cgi?id=1369653) | | TreeView+ | [depends on](buglist.cgi?bug_id=1377549&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1377549&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-09-20 05:44 UTC by Siddharth Sharma | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-25 17:28 UTC ([History](show_activity.cgi?id=1377549)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  cschalle jhorak security-response-team stransky | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-10-04 02:39:58 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:1912](https://access.redhat.com/errata/RHSA-2016%3A1912) | 0 | normal | SHIPPED\_LIVE | Critical: firefox security update | 2016-09-21 11:47:31 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1377549#c0)  Siddharth Sharma    2016-09-20 05:44:02 UTC  ``` A potentially exploitable crash caused by a buffer overflow while encoding image frames to images  External Reference:  <https://www.mozilla.org/security/advisories/mfsa2016-85/> <https://www.mozilla.org/security/advisories/mfsa2016-86/>   ```  [Comment 1](show_bug.cgi?id=1377549#c1)  Siddharth Sharma    2016-09-20 05:44:10 UTC  ``` Acknowledgments:  Name: the Mozilla project Upstream: Nils   ```  [Comment 2](show_bug.cgi?id=1377549#c2)  errata-xmlrpc    2016-09-21 07:49:42 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7   Red Hat Enterprise Linux 6   Red Hat Enterprise Linux 5  Via RHSA-2016:1912 <https://rhn.redhat.com/errata/RHSA-2016-1912.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1377549&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.mozilla.org_8a6ca8a9_20250125_221224.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1277213)
* [XML](/show_bug.cgi?ctype=xml&id=1277213)

Closed
[Bug 1277213](/show_bug.cgi?id=1277213)

Opened 9 years ago
Closed 8 years ago

# Missing continuation state reset after auth dialog cancellation

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Missing continuation state reset after auth dialog cancellation

## Categories

### (Core :: Networking: HTTP, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking%3A%20HTTP#Networking%3A%20HTTP)

Networking: HTTP
▾

Core :: Networking: HTTP
For bugs in Mozilla's HTTP networking code. This component deals with HTTP specific issues like pipelining, keep-alive, HTTP proxies, 1.1 issues, redirects, authentication (basic), etc.

Examples of appropriate bugs: Problems with proxy authentication; HTTP redirects looping indefinitely, etc.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking%3A%20HTTP&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking%3A%20HTTP)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla50

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix) |
| firefox48 | [+](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%2B) | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=verified) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 |  | wontfix |
| firefox48 | + | wontfix |
| firefox49 | + | verified |
| firefox-esr45 | 49+ | verified |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: cbook, Assigned: jhorak)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d3cd7603003add063c427e34a9121464?d=mm&size=40)  [jhorak](/user_profile?user_id=328198)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/c283b43bb335591e8c45a929dc905f53?d=mm&size=40)  [noni](/user_profile?user_id=458186)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8378311bf1bd5e9eddc7896a07688876?d=mm&size=40)  [cbook](/user_profile?user_id=277293)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

### ( [URL](http://ib1c.nios.ru/Fresh_1c82_GUO_StAcc_R2_n4b01/1199/ru_RU/messageBox.html?sysver=8.3.7.1917 "http://ib1c.nios.ru/Fresh_1c82_GUO_StAcc_R2_n4b01/1199/ru_RU/messageBox.html?sysver=8.3.7.1917") )

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[ib1c.nios.ru/Fresh\_1c82\_GUO\_StAcc\_R2\_...](http://ib1c.nios.ru/Fresh_1c82_GUO_StAcc_R2_n4b01/1199/ru_RU/messageBox.html?sysver=8.3.7.1917 "http://ib1c.nios.ru/Fresh_1c82_GUO_StAcc_R2_n4b01/1199/ru_RU/messageBox.html?sysver=8.3.7.1917")

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: assertion, csectype-race, sec-high, Whiteboard: hidden while we figure out comment 16/18[fixed by backout of bug 890908][necko-active][adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[assertion](/buglist.cgi?keywords=assertion&resolution=---),
[csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

hidden while we figure out comment 16/18[fixed by backout of bug 890908][necko-active][adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (6 files, 1 obsolete file)

| [bughunter crash report](/attachment.cgi?id=8758668)  [9 years ago](#c0)  [Carsten Book [:Tomcat]](/user_profile?user_id=277293)   105.25 KB, text/plain |  | [Details](/attachment.cgi?id=8758668&action=edit) |
| --- | --- | --- |
| [windows debug build stack with todays m-c tip](/attachment.cgi?id=8759053)  [9 years ago](#c5)  [Carsten Book [:Tomcat]](/user_profile?user_id=277293)   3.65 KB, text/plain |  | [Details](/attachment.cgi?id=8759053&action=edit) |
| [bughunter asan stack](/attachment.cgi?id=8759174)  [9 years ago](#c8)  [Carsten Book [:Tomcat]](/user_profile?user_id=277293)   9.86 KB, text/plain |  | [Details](/attachment.cgi?id=8759174&action=edit) |
| [reset-state-after-cancel v1 patch](/attachment.cgi?id=8761516)  [9 years ago](#c19)  [Jan Horak [:jhorak]](/user_profile?user_id=328198)   1.38 KB, patch | mayhemer : [review+](#c23 "9 years ago") | [Details](/attachment.cgi?id=8761516&action=edit) | [Diff](/attachment.cgi?id=8761516&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8761516) |
| [reset-state-after-cancel v2 patch](/attachment.cgi?id=8765950)  [9 years ago](#c24)  [Jan Horak [:jhorak]](/user_profile?user_id=328198)   1.47 KB, patch | jhorak : [review+](#c24 "9 years ago")  abillings : [sec-approval+](#c27 "9 years ago") | [Details](/attachment.cgi?id=8765950&action=edit) | [Diff](/attachment.cgi?id=8765950&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8765950) |
| [reset-state-after-cancel v2 patch [45esr version]](/attachment.cgi?id=8776938)  [8 years ago](#c38)  [Jan Horak [:jhorak]](/user_profile?user_id=328198)   1.48 KB, patch | jhorak : [review+](#c38 "8 years ago")  Sylvestre : [approval-mozilla-esr45+](#c43 "8 years ago") | [Details](/attachment.cgi?id=8776938&action=edit) | [Diff](/attachment.cgi?id=8776938&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8776938) |
| [reset-state-after-cancel patch [beta]](/attachment.cgi?id=8778836)  [8 years ago](#c39)  [Jan Horak [:jhorak]](/user_profile?user_id=328198)   1.43 KB, patch | jhorak : [review+](#c39 "8 years ago")  lizzard : [approval-mozilla-beta+](#c41 "8 years ago") | [Details](/attachment.cgi?id=8778836&action=edit) | [Diff](/attachment.cgi?id=8778836&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8778836) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1277213#c0)• 9 years ago |
| str | |

Attached file
[bughunter crash report](attachment.cgi?id=8758668)
— [Details](attachment.cgi?id=8758668&action=edit)

Found via bughunter and reproduced on a windows 7 trunk debug build based on m-c tip
Steps to reproduce:
->> Load -> <http://ib1c.nios.ru/Fresh_1c82_GUO_StAcc_R2_n4b01/1199/ru_RU/messageBox.html?sysver=8.3.7.1917>
--> close the auth dialog
-->>
Hit MOZ\_CRASH(nsAuthSSPI not thread-safe) at c:/Users/mozilla/debug-builds/mozilla-central/extensions/auth/nsAuthSSPI.cpp:181
#01: nsCOMPtr\_base::assign\_with\_AddRef[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x7d4b80]
#02: nsCOMPtr<nsISupports>::operator=[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x6da6a2]
#03: nsHttpNegotiateAuth::MatchesBaseURI[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf5c3d4]
#04: nsHttpNegotiateAuth::Release[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf5cb4e]
#05: nsThread::ProcessNextEvent[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x778459]
#06: NS\_ProcessNextEvent[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x7e3cd2]
#07: mozilla::ipc::MessagePumpForNonMainThreads::Run[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dl
#08: MessageLoop::RunInternal[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf9555d]
#09: MessageLoop::RunHandler[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf954d2]
#10: MessageLoop::Run[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf950cd]
#11: nsThread::ThreadFunc[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x7834fa]
#12: \_PR\_NativeRunThread[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\nss3.dll +0x2fb02b]
#13: \_PR\_MD\_YIELD[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\nss3.dll +0x2e01f9]
#14: crt\_at\_quick\_exit[C:\Windows\system32\ucrtbase.DLL +0x7f794]
#15: BaseThreadInitThunk[C:\Windows\system32\kernel32.dll +0x4ef1c]
#16: RtlInitializeExceptionChain[C:\Windows\SYSTEM32\ntdll.dll +0x63648]
#17: RtlInitializeExceptionChain[C:\Windows\SYSTEM32\ntdll.dll +0x6361b]
[Child 4224] ###!!! ABORT: Aborting on channel error.: file c:/Users/mozilla/debug-builds/mozilla-central/ipc/glue/MessageChanne

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1277213#c1)• 9 years ago |
|  | |

marking as s-s bugGroup: core-security

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1277213#c2)• 9 years ago |
|  | |

Hm, that stack looks bogus, since MatchesBaseURI:
<http://dxr.mozilla.org/mozilla-central/source/extensions/auth/nsHttpNegotiateAuth.cpp#625>
doesn't even touch nsCOMPtr-ish things. That stack is from a local build?Flags: needinfo?(cbook)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1277213#c3)• 9 years ago |
|  | |

(In reply to Nathan Froyd [:froydnj] from [comment #2](/show_bug.cgi?id=1277213#c2 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> Hm, that stack looks bogus, since MatchesBaseURI:
>
> <http://dxr.mozilla.org/mozilla-central/source/extensions/auth/>
> nsHttpNegotiateAuth.cpp#625
>
> doesn't even touch nsCOMPtr-ish things. That stack is from a local build?
yes local debug build based and i think the bughunter build is from tinderboxFlags: needinfo?(cbook)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1277213#c4)• 9 years ago |
|  | |

ok, new debug builds based on <https://hg.mozilla.org/mozilla-central/rev/22047a4eea784c15026c77911c0bd6ea1b70fa68>
Hit MOZ\_CRASH(nsAuthSSPI not thread-safe) at c:/Users/mozilla/debug-builds/mozilla-central/extensions/auth/nsAuthSSPI.cpp:181
#01: nsCOMPtr\_base::assign\_with\_AddRef[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x7d9380]
#02: nsCOMPtr<nsISupports>::operator=[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x6deaa2]
#03: nsHttpNegotiateAuth::MatchesBaseURI[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf61764]
#04: nsHttpNegotiateAuth::Release[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf61ede]
#05: nsThread::ProcessNextEvent[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x77cc79]
#06: NS\_ProcessNextEvent[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x7e84b2]
#07: mozilla::ipc::MessagePumpForNonMainThreads::Run[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xffc4bc]
#08: MessageLoop::RunInternal[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf9a8bd]
#09: MessageLoop::RunHandler[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf9a832]
#10: MessageLoop::Run[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0xf9a42d]
#11: nsThread::ThreadFunc[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\xul.dll +0x787cfa]
#12: \_PR\_NativeRunThread[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\nss3.dll +0x2fbc1b]
#13: \_PR\_MD\_YIELD[c:\Users\mozilla\debug-builds\mozilla-central\firefox-debug\dist\bin\nss3.dll +0x2e0de9]
#14: crt\_at\_quick\_exit[C:\Windows\system32\ucrtbase.DLL +0x7f794]
#15: BaseThreadInitThunk[C:\Windows\system32\kernel32.dll +0x4ef1c]
#16: RtlInitializeExceptionChain[C:\Windows\SYSTEM32\ntdll.dll +0x63648]
#17: RtlInitializeExceptionChain[C:\Windows\SYSTEM32\ntdll.dll +0x6361b]
[Child 5772] ###!!! ABORT: Aborting on channel error.: file c:/Users/mozilla/debug-builds/mozilla-central/ipc/glue/MessageChannel.cpp, line 2052

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1277213#c5)• 9 years ago |
|  | |

Attached file
[windows debug build stack with todays m-c tip](attachment.cgi?id=8759053)
— [Details](attachment.cgi?id=8759053&action=edit)

nathan, does this help more ?Flags: needinfo?(nfroyd)

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1277213#c6)• 9 years ago |
|  | |

(In reply to Carsten Book [:Tomcat] from [comment #5](/show_bug.cgi?id=1277213#c5 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> Created [attachment 8759053](/attachment.cgi?id=8759053 "windows debug build stack with todays m-c tip") [[details]](/attachment.cgi?id=8759053&action=edit "windows debug build stack with todays m-c tip")
> windows debug build stack with todays m-c tip
>
> nathan, does this help more ?
That looks like the same stack. :(
There are a couple problems with that stack:
\* nsHttpNegotiateAuth::Release shouldn't be getting called from nsThread::ProcessNextEvent. There should be a ::Run method somewhere in there.
\* nsHttpNegotiateAuth::Release is defined here:
<http://dxr.mozilla.org/mozilla-central/source/extensions/auth/nsHttpNegotiateAuth.cpp#191>
and there's nothing in that macro definition that would call MatchesBaseURI.
\* nsHttpNegotiateAuth::MatchesBaseURI doesn't call any nsCOMPtr things; it's straight string manipulation.
bz (?) mentioned vtable corruption for some crashes on dev-platform the other day. Perhaps that's what we're seeing here...I can try to reproduce at some point.Flags: needinfo?(nfroyd)

|  | [Bob Clary [:bc] (inactive)](/user_profile?user_id=23402) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1277213#c7)• 9 years ago |
|  | |

asan builds on linux crash with operator++ nsNTLMAuthModule::AddRef() nsCOMPtr\_base::assign\_with\_AddRef(nsISupports\*) operator= ObtainCredentialsAndFlags
Perhaps you can get more information using them?

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1277213#c8)• 9 years ago |
|  | |

Attached file
[bughunter asan stack](attachment.cgi?id=8759174)
— [Details](attachment.cgi?id=8759174&action=edit)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1277213#c9)• 9 years ago |
|  | |

The ASan stack says the crash is in this line in ObtainCredentialsAndFlags:
362 mContinuationState = continuationState;
mContinuationState has type nsCOMPtr<nsISupports> mContinuationState so that makes sense.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1277213#c10)• 9 years ago |
|  | |

This code changed a week or two ago in [bug 890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread").Blocks: [890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread")Flags: needinfo?(honzab.moz)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1277213#c11)• 9 years ago |
|  | |

[Tracking Requested - why for this release]: sec-high
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=unaffected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%3F)Keywords: [csectype-race](/buglist.cgi?keywords=csectype-race&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Nathan Froyd [:froydnj]](/user_profile?user_id=417288) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1277213#c12)• 9 years ago |
|  | |

That ASAN stack looks way, way more valid than the Windows ones did. :)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1277213#c13)• 9 years ago |
|  | |

For starter I think we should back [bug 890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread") out and think more.Flags: needinfo?(honzab.moz)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1277213#c14)• 9 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #13](/show_bug.cgi?id=1277213#c13 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> For starter I think we should back [bug 890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread") out and think more.
this is backed out now in <https://hg.mozilla.org/mozilla-central/rev/a39da695528a>

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a149946_406194)• 9 years ago |

[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%3F) → ---Whiteboard: [fixed by backout of bug 890908]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a149953_406194)• 9 years ago |

Status: NEW → RESOLVEDClosed: 9 years agoResolution: --- → FIXED

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1277213#c15)• 9 years ago |
|  | |

(In reply to Carsten Book [:Tomcat] from [comment #14](/show_bug.cgi?id=1277213#c14 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> (In reply to Honza Bambas (:mayhemer) from [comment #13](/show_bug.cgi?id=1277213#c13 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> > For starter I think we should back [bug 890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread") out and think more.
>
> this is backed out now in
> <https://hg.mozilla.org/mozilla-central/rev/a39da695528a>
confirmed this is fixed by the backout

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a279798_1689)• 9 years ago |

Group: core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a282377_1689)• 9 years ago |

Group: core-security-release
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected)

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1277213#c16)• 9 years ago |
|  | |

The server is sending two authentication requests:
WWW-Authenticate: NTLM
WWW-Authenticate: Negotiate
When NTLM dialog is cancelled the Negotiate authentication follows but mAuthContinuationState, instance of nsNTLMAuthModule, is not reset, so when proceeding with Negotiate authentication then [2] is called and since continuationState is set to instance nsNTLMAuthModule then the instance of nsAuthGSSAPI is not created [3].
Subsequently it is wrongly used in nsHttpNegotiateAuth::GenerateCredentials [4] so instead of nsAuthGSSAPI::GetNextToken is the nsNTLMAuthModule::GetNextToken called. So I presume the negotiate auth cannot work correcly even with current implementation.
This leads to crash when patch from [bug 890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread") is applied because nsNTLMAuthModule is not declared as NS\_ITHREADSAFESUPPORT thus cannot be called from non-main thread from GetNextTokenRunnable::ObtainCredentialsAndFlags (code in patch [5] )
:Tomcat could you please test if WWW-authentication: Negotiate method work for you on <http://ib1c.nios.ru/Fresh_1c82_GUO_StAcc_R2_n4b01/1199/ru_RU/messageBox.html?sysver=8.3.7.1917> if it is possible to test (ie. have convenient credentials for the site) that by cancelling NTLM dialog.
[2] <http://mxr.mozilla.org/mozilla-central/source/netwerk/protocol/http/nsHttpChannelAuthProvider.cpp#716>
[3] <http://mxr.mozilla.org/mozilla-central/source/extensions/auth/nsHttpNegotiateAuth.cpp#90>
[4] <http://mxr.mozilla.org/mozilla-central/source/extensions/auth/nsHttpNegotiateAuth.cpp#267>
[5] <https://bug890908.bmoattachments.org/attachment.cgi?id=8754813>Flags: needinfo?(cbook)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1277213#c17)• 9 years ago |
|  | |

(In reply to Jan Horak from [comment #16](/show_bug.cgi?id=1277213#c16 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> The server is sending two authentication requests:
>
> WWW-Authenticate: NTLM
> WWW-Authenticate: Negotiate
>
> When NTLM dialog is cancelled the Negotiate authentication follows but
> mAuthContinuationState, instance of nsNTLMAuthModule, is not reset, so when
> proceeding with Negotiate authentication then [2] is called and since
> continuationState is set to instance nsNTLMAuthModule then the instance of
> nsAuthGSSAPI is not created [3].
>
> Subsequently it is wrongly used in nsHttpNegotiateAuth::GenerateCredentials
> [4] so instead of nsAuthGSSAPI::GetNextToken is the
> nsNTLMAuthModule::GetNextToken called. So I presume the negotiate auth
> cannot work correcly even with current implementation.
>
> This leads to crash when patch from [bug 890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread") is applied because
> nsNTLMAuthModule is not declared as NS\_ITHREADSAFESUPPORT thus cannot be
> called from non-main thread from
> GetNextTokenRunnable::ObtainCredentialsAndFlags (code in patch [5] )
>
> :Tomcat could you please test if WWW-authentication: Negotiate method work
> for you on
> <http://ib1c.nios.ru/Fresh_1c82_GUO_StAcc_R2_n4b01/1199/ru_RU/messageBox>.
> html?sysver=8.3.7.1917 if it is possible to test (ie. have convenient
> credentials for the site) that by cancelling NTLM dialog.
>
Hi, i don't have any relation or login at this site, so i guess its not possible to login here.Flags: needinfo?(cbook)

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1277213#c18)• 9 years ago |
|  | |

Okay. With some help from our guys we'll try to setup server for testing. I'll fill a new bug as soon as I know more.

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a641303_1689)• 9 years ago |

Group: core-security-releaseWhiteboard: [fixed by backout of bug 890908] → hidden while we figure out comment 16/18[fixed by backout of bug 890908]

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1277213#c19)• 9 years ago |
|  | |

Attached patch

[reset-state-after-cancel v1 patch](attachment.cgi?id=8761516&action=diff) (obsolete)
— [Details](attachment.cgi?id=8761516&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8761516)

I'm not sure if attaching patch to fix this issue is correct, but since I don't want to create another bug (not sure about security impact), attaching the patch there.
The patch is addressing a state when server sends more than one WWW-Authenticate header.
In case user cancels prompt for the first authentication method, then the continuationState is reused during processing next method. This is wrong, a new instance of continuationState must be created.
This is reproducible with server mentioned in [comment 1](/show_bug.cgi?id=1277213#c1 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"), the Live HTTP Headers extensions shows following challenges for the server:
WWW-Authenticate: NTLM
WWW-Authenticate: Negotiate
[Attachment #8761516](/attachment.cgi?id=8761516&action=edit "reset-state-after-cancel v1 patch") -
Flags: review?(honzab.moz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1277213#c20)• 9 years ago |
|  | |

(In reply to Jan Horak from [comment #19](/show_bug.cgi?id=1277213#c19 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> since I don't want to create another bug (not sure about security impact), attaching the patch there.
We should have created another bug: "FIXED" bugs are invisible to most developers, and two fixes (even if related) in the same bug leads to confusion.
At this point maybe the best thing to do is to reopen the bug to at least address the first problem.Status: RESOLVED → REOPENEDResolution: FIXED → ---

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1277213#c21)• 9 years ago |
|  | |

Could you please check it out or reassign the review to someone else? It seems to be a corner case, but it would be nice to have it fixed.Flags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1277213#c22)• 9 years ago |
|  | |

(In reply to Jan Horak from [comment #21](/show_bug.cgi?id=1277213#c21 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> Could you please check it out or reassign the review to someone else? It
> seems to be a corner case, but it would be nice to have it fixed.
I'll get to it next week.Flags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a2254381_269762)• 9 years ago |

Assignee: nobody → jhorakStatus: REOPENED → ASSIGNEDComponent: XPCOM → Networking: HTTPWhiteboard: hidden while we figure out comment 16/18[fixed by backout of bug 890908] → hidden while we figure out comment 16/18[fixed by backout of bug 890908][necko-active]

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1277213#c23)• 9 years ago |
|  | |

Comment on [attachment 8761516](/attachment.cgi?id=8761516 "reset-state-after-cancel v1 patch") [[details]](/attachment.cgi?id=8761516&action=edit "reset-state-after-cancel v1 patch") [[diff]](/attachment.cgi?id=8761516&action=diff "reset-state-after-cancel v1 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8761516)
reset-state-after-cancel v1 patch
Review of [attachment 8761516](/attachment.cgi?id=8761516 "reset-state-after-cancel v1 patch") [[details]](/attachment.cgi?id=8761516&action=edit "reset-state-after-cancel v1 patch") [[diff]](/attachment.cgi?id=8761516&action=diff "reset-state-after-cancel v1 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8761516):
-----------------------------------------------------------------
Definitely a good catch! But it doesn't solve the root problem of the assertion. Still, this should be landed (with sec+ approval) as a separate patch.
r+ on this patch with the one small change.
::: netwerk/protocol/http/nsHttpChannelAuthProvider.cpp
@@ +1245,5 @@
> nsresult rv;
>
> + // Get rid of current continuationState to avoid reusing it in
> + // next challenges since it is no longer relevant.
> + NS\_IF\_RELEASE( mProxyAuth ? mProxyAuthContinuationState : mAuthContinuationState );
please do:
if (mProxyAuth) {
NS\_IF\_RELEASE(mProxyAuthContinuationState);
} else {
NS\_IF\_RELEASE(mAuthContinuationState);
}
[Attachment #8761516](/attachment.cgi?id=8761516&action=edit "reset-state-after-cancel v1 patch") -
Flags: review?(honzab.moz) → review+

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a2262051_269762)• 9 years ago |

Summary: Hit MOZ\_CRASH(nsAuthSSPI not thread-safe) at c:/Users/mozilla/debug-builds/mozilla-central/extensions/auth/nsAuthSSPI.cpp:181 → Missing continuation state reset after auth dialog cancellation

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a2262074_269762)• 9 years ago |

No longer blocks: [890908](/show_bug.cgi?id=890908 "RESOLVED FIXED - Move Negotiate auth off main thread")

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1277213#c24)• 9 years ago |
|  | |

Attached patch

[reset-state-after-cancel v2 patch](attachment.cgi?id=8765950&action=diff)
— [Details](attachment.cgi?id=8765950&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8765950)

Thank you! Copying positive review from previous comment.
[Attachment #8761516](/attachment.cgi?id=8761516&action=edit "reset-state-after-cancel v1 patch") -
Attachment is obsolete: true
[Attachment #8765950](/attachment.cgi?id=8765950&action=edit "reset-state-after-cancel v2 patch") -
Flags: review+
[Attachment #8765950](/attachment.cgi?id=8765950&action=edit "reset-state-after-cancel v2 patch") -
Flags: checkin?

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1277213#c25)• 9 years ago |
|  | |

needs sec-approval before landing btw

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1277213#c26)• 9 years ago |
|  | |

Comment on [attachment 8765950](/attachment.cgi?id=8765950 "reset-state-after-cancel v2 patch") [[details]](/attachment.cgi?id=8765950&action=edit "reset-state-after-cancel v2 patch") [[diff]](/attachment.cgi?id=8765950&action=diff "reset-state-after-cancel v2 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8765950)
reset-state-after-cancel v2 patch
(don't use checkin? flag on attachemnt, btw)
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Hard to say, you would need a good knowledge of how all the auth modules and logic around works, so not that easy IMO.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
I would say no.
Which older supported branches are affected by this flaw?
All, this is there since ever AFAIK.
If not all supported branches, which bug introduced the flaw?
It's there since ever AFAIK.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
There is very low risk.
How likely is this patch to cause regressions; how much testing does it need?
I was doing some manual testing with this patch, but I was focusing on a bit different problem. I would leave this to Jan Horak, but this very much needs testing on Windows as well, which I'm not sure he posses.
[Attachment #8765950](/attachment.cgi?id=8765950&action=edit "reset-state-after-cancel v2 patch") -
Flags: checkin? → sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1277213#c27)• 9 years ago |
|  | |

Comment on [attachment 8765950](/attachment.cgi?id=8765950 "reset-state-after-cancel v2 patch") [[details]](/attachment.cgi?id=8765950&action=edit "reset-state-after-cancel v2 patch") [[diff]](/attachment.cgi?id=8765950&action=diff "reset-state-after-cancel v2 patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8765950)
reset-state-after-cancel v2 patch
sec-approval+ for trunk. We'll want patches made and nominated for ESR45, Aurora, and Beta as well though.
[Attachment #8765950](/attachment.cgi?id=8765950&action=edit "reset-state-after-cancel v2 patch") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1277213#c28)• 9 years ago |
|  | |

I'm confused by why 48 and ESR45 are marked as "unaffected" since your sec-approval? request says that everything is affected.Flags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1277213#c29)• 9 years ago |
|  | |

Because this has been discovered by a different patch landed just on m-c. But later we found out the issue was unrelated and in the tree forever. So, everything is affected.Flags: needinfo?(honzab.moz)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1277213#c30)• 9 years ago |
|  | |

Then we will want the newer patch everywhere.
[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix)
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected) → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox48](/buglist.cgi?f1=cf_tracking_firefox48&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%2B)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [48+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=48%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a3237756_75935)• 9 years ago |

Keywords: [regression](/buglist.cgi?keywords=regression&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1277213#c31)• 8 years ago |
|  | |

What's the status here? We seem to have a reviewed sec-approved patch that never landed -- does it need a "check-in" keyword/flag? At this point we won't be able to get this into 48 (RC is already built).
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)Flags: needinfo?(jhorak)Flags: needinfo?(honzab.moz)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1277213#c32)• 8 years ago |
|  | |

Apparently, Jan forgot about this bug..Flags: needinfo?(honzab.moz)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1277213#c33)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/660eca9e31be>Flags: needinfo?(jhorak)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1277213#c34)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/660eca9e31be>Status: ASSIGNED → RESOLVEDClosed: 9 years ago → 8 years agoResolution: --- → FIXED

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a5011045_277293)• 8 years ago |

[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)Target Milestone: --- → mozilla50

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1277213#c35)• 8 years ago |
|  | |

We need an ESR45 and 49 patch for this.
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[48+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=48%2B) → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Honza Bambas (:mayhemer)](/user_profile?user_id=269762) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1277213#c36)• 8 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #35](/show_bug.cgi?id=1277213#c35 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> We need an ESR45 and 49 patch for this.
Jan?Flags: needinfo?(jhorak)

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1277213#c37)• 8 years ago |
|  | |

(In reply to Honza Bambas (:mayhemer) from [comment #36](/show_bug.cgi?id=1277213#c36 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> (In reply to Al Billings [:abillings] from [comment #35](/show_bug.cgi?id=1277213#c35 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation"))
> > We need an ESR45 and 49 patch for this.
>
> Jan?
Will do that.Flags: needinfo?(jhorak)

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1277213#c38)• 8 years ago |
|  | |

Attached patch

[reset-state-after-cancel v2 patch [45esr version]](attachment.cgi?id=8776938&action=diff)
— [Details](attachment.cgi?id=8776938&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8776938)

Attached patch for 45 ESR. Copying previous positive review.
[Attachment #8776938](/attachment.cgi?id=8776938&action=edit "reset-state-after-cancel v2 patch [45esr version]") -
Flags: review+

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1277213#c39)• 8 years ago |
|  | |

Attached patch

[reset-state-after-cancel patch [beta]](attachment.cgi?id=8778836&action=diff)
— [Details](attachment.cgi?id=8778836&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8778836)

Since 49 was transferred from central recently, attaching patch for beta.
Approval Request Comment
See [comment 26](/show_bug.cgi?id=1277213#c26 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation")
[Attachment #8778836](/attachment.cgi?id=8778836&action=edit "reset-state-after-cancel patch [beta]") -
Flags: review+
[Attachment #8778836](/attachment.cgi?id=8778836&action=edit "reset-state-after-cancel patch [beta]") -
Flags: approval-mozilla-beta?

|  | [Jan Horak [:jhorak]](/user_profile?user_id=328198)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1277213#c40)• 8 years ago |
|  | |

Comment on [attachment 8776938](/attachment.cgi?id=8776938 "reset-state-after-cancel v2 patch [45esr version]") [[details]](/attachment.cgi?id=8776938&action=edit "reset-state-after-cancel v2 patch [45esr version]") [[diff]](/attachment.cgi?id=8776938&action=diff "reset-state-after-cancel v2 patch [45esr version]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8776938)
reset-state-after-cancel v2 patch [45esr version]
[Approval Request Comment]
See [comment 26](/show_bug.cgi?id=1277213#c26 "VERIFIED FIXED - Missing continuation state reset after auth dialog cancellation").
[Attachment #8776938](/attachment.cgi?id=8776938&action=edit "reset-state-after-cancel v2 patch [45esr version]") -
Flags: approval-mozilla-esr45?

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1277213#c41)• 8 years ago |
|  | |

Comment on [attachment 8778836](/attachment.cgi?id=8778836 "reset-state-after-cancel patch [beta]") [[details]](/attachment.cgi?id=8778836&action=edit "reset-state-after-cancel patch [beta]") [[diff]](/attachment.cgi?id=8778836&action=diff "reset-state-after-cancel patch [beta]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8778836)
reset-state-after-cancel patch [beta]
Sec-high patch, ok to uplift to beta.
[Attachment #8778836](/attachment.cgi?id=8778836&action=edit "reset-state-after-cancel patch [beta]") -
Flags: approval-mozilla-beta? → approval-mozilla-beta+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1277213#c42)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/52ad6d77d5e4>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1277213#c43)• 8 years ago |
|  | |

Comment on [attachment 8776938](/attachment.cgi?id=8776938 "reset-state-after-cancel v2 patch [45esr version]") [[details]](/attachment.cgi?id=8776938&action=edit "reset-state-after-cancel v2 patch [45esr version]") [[diff]](/attachment.cgi?id=8776938&action=diff "reset-state-after-cancel v2 patch [45esr version]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1277213&attachment=8776938)
reset-state-after-cancel v2 patch [45esr version]
Sec high, taking it to esr45.
[Attachment #8776938](/attachment.cgi?id=8776938&action=edit "reset-state-after-cancel v2 patch [45esr version]") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1277213#c44)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/d91fc76079e0>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a8374713_488993)• 8 years ago |

Flags: qe-verify+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a8592711_280903)• 8 years ago |

Whiteboard: hidden while we figure out comment 16/18[fixed by backout of bug 890908][necko-active] → hidden while we figure out comment 16/18[fixed by backout of bug 890908][necko-active][adv-main49+][adv-esr45.4+]

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1277213#c45)• 8 years ago |
|  | |

Verified that the issue no longer reproduces on Windows 7 x64, Windows 10 x64, Ubuntu 14.04x64 and Mac OS X 10.11.6 using the STR from the description.
Tested with the following Firefox versions:
\*49.0 RC build 2, build ID 20160907153016
\*50.0a2 Aurora, build ID 20160912004004
\*45.4.0 ESR, build ID 20160905130425.Status: RESOLVED → VERIFIED
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=verified)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified)Flags: qe-verify+QA Contact: cornel.ionce

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1277213#a21878548_1689)• 8 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1277213&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Carsten Book [:Tomcat]](/user_profile?user_id=277293)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from rhn.redhat.com_a7c44a83_20250125_221219.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2016:1985 - Security Advisory

Issued:
2016-10-03
Updated:
2016-10-03
# RHSA-2016:1985 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: thunderbird security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2016%3A1985)

## Topic

An update for thunderbird is now available for Red Hat Enterprise Linux 5, Red
Hat Enterprise Linux 6, and Red Hat Enterprise Linux 7.

Red Hat Product Security has rated this update as having a security impact of
Important. A Common Vulnerability Scoring System (CVSS) base score, which gives
a detailed severity rating, is available for each vulnerability from the CVE
link(s) in the References section.

## Description

Mozilla Thunderbird is a standalone mail and newsgroup client.

This update upgrades Thunderbird to version 45.4.0.

Security Fix(es):

* Multiple flaws were found in the processing of malformed web content. A web

page containing malicious content could cause Thunderbird to crash or,
potentially, execute arbitrary code with the privileges of the user running
Thunderbird. (CVE-2016-5257)

Red Hat would like to thank the Mozilla project for reporting these issues.
Upstream acknowledges Christoph Diehl, Andrew McCreight, Dan Minor, Byron
Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp and Carsten Book as the
original reporters.

## Solution

For details on how to apply this update, which includes the changes described in
this advisory, refer to:

<https://access.redhat.com/articles/11258>

All running instances of Thunderbird must be restarted for the update to take
effect.

## Affected Products

* Red Hat Enterprise Linux Server 7 x86\_64
* Red Hat Enterprise Linux Server 6 x86\_64
* Red Hat Enterprise Linux Server 6 i386
* Red Hat Enterprise Linux Server 5 x86\_64
* Red Hat Enterprise Linux Server 5 i386
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.4 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.3 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.2 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.6 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.4 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.3 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.2 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 7 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 6 i386
* Red Hat Enterprise Linux Workstation 7 x86\_64
* Red Hat Enterprise Linux Workstation 6 x86\_64
* Red Hat Enterprise Linux Workstation 6 i386
* Red Hat Enterprise Linux Workstation 5 x86\_64
* Red Hat Enterprise Linux Workstation 5 i386
* Red Hat Enterprise Linux Desktop 7 x86\_64
* Red Hat Enterprise Linux Desktop 6 x86\_64
* Red Hat Enterprise Linux Desktop 6 i386
* Red Hat Enterprise Linux Desktop 5 x86\_64
* Red Hat Enterprise Linux Desktop 5 i386
* Red Hat Enterprise Linux for IBM z Systems 6 s390x
* Red Hat Enterprise Linux for Power, big endian 6 ppc64
* Red Hat Enterprise Linux for Power, little endian 7 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.4 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.3 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.2 ppc64le
* Red Hat Enterprise Linux Server - TUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.6 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.3 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.2 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 6 s390x
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.4 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.3 ppc64le
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.4 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.3 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.2 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7 ppc64le
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6 i386
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension (for IBM z Systems) 6 s390x

## Fixes

* [BZ - 1377543](https://bugzilla.redhat.com/bugzilla/show_bug.cgi?id=1377543)
  - CVE-2016-5257 Mozilla: Memory safety bugs fixed in Firefox ESR 45.4 (MFSA 2016-85, MFSA 2016-86)

## CVEs

* [CVE-2016-5257](https://www.redhat.com/security/data/cve/CVE-2016-5257.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>
* <https://www.mozilla.org/en-US/security/known-vulnerabilities/thunderbird/#thunderbird45.4>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| x86\_64 | |
| thunderbird-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 16326f4bbae9719734a507a40bbf3cb35909c34f4349e1fdb03879817ab7aeb9 |
| thunderbird-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 16326f4bbae9719734a507a40bbf3cb35909c34f4349e1fdb03879817ab7aeb9 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 5e3eda6dac510b4139f719a04e260c08d4f6741781014b15e61dde1094cda09b |
| i386 | |
| thunderbird-45.4.0-1.el6\_8.i686.rpm | SHA-256: 4c696874290ae8d240d4ecc5497a54acb2c0034c3aa85bf03eb7388b55ec7c81 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: ec5eaf98ad64115ab36e0edaceb1b940ea1dd33b1329576a7ad503ad8964d0ae |

## Red Hat Enterprise Linux Server 5

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el5\_11.src.rpm | SHA-256: 297311e7a25a2f21e1c699505475ff24016794ba9aea141165f5377b9c435fc4 |
| x86\_64 | |
| thunderbird-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 4e769e9519f4e2181e2e855256c52af8144b156719680a79f237c8401b7fabff |
| thunderbird-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 9be1b227622373ebece3aec0b263cbfd6ca4d97c08477b002fe7bae7dca940a5 |
| i386 | |
| thunderbird-45.4.0-1.el5\_11.i386.rpm | SHA-256: e15d3099e15a8c902f78f34cab018c51ced169919778e92ee2aa1b33486ade67 |
| thunderbird-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: ea5534fb71059765be3a0c1e713b0882419fb623b5b9fd927a0e8c1fe68cd8f3 |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.3

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.2

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - AUS 7.7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - AUS 7.6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - AUS 7.4

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - AUS 7.3

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - AUS 7.2

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| x86\_64 | |
| thunderbird-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 16326f4bbae9719734a507a40bbf3cb35909c34f4349e1fdb03879817ab7aeb9 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 5e3eda6dac510b4139f719a04e260c08d4f6741781014b15e61dde1094cda09b |
| i386 | |
| thunderbird-45.4.0-1.el6\_8.i686.rpm | SHA-256: 4c696874290ae8d240d4ecc5497a54acb2c0034c3aa85bf03eb7388b55ec7c81 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: ec5eaf98ad64115ab36e0edaceb1b940ea1dd33b1329576a7ad503ad8964d0ae |

## Red Hat Enterprise Linux Workstation 7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Workstation 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| x86\_64 | |
| thunderbird-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 16326f4bbae9719734a507a40bbf3cb35909c34f4349e1fdb03879817ab7aeb9 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 5e3eda6dac510b4139f719a04e260c08d4f6741781014b15e61dde1094cda09b |
| i386 | |
| thunderbird-45.4.0-1.el6\_8.i686.rpm | SHA-256: 4c696874290ae8d240d4ecc5497a54acb2c0034c3aa85bf03eb7388b55ec7c81 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: ec5eaf98ad64115ab36e0edaceb1b940ea1dd33b1329576a7ad503ad8964d0ae |

## Red Hat Enterprise Linux Workstation 5

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el5\_11.src.rpm | SHA-256: 297311e7a25a2f21e1c699505475ff24016794ba9aea141165f5377b9c435fc4 |
| x86\_64 | |
| thunderbird-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 4e769e9519f4e2181e2e855256c52af8144b156719680a79f237c8401b7fabff |
| thunderbird-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 9be1b227622373ebece3aec0b263cbfd6ca4d97c08477b002fe7bae7dca940a5 |
| i386 | |
| thunderbird-45.4.0-1.el5\_11.i386.rpm | SHA-256: e15d3099e15a8c902f78f34cab018c51ced169919778e92ee2aa1b33486ade67 |
| thunderbird-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: ea5534fb71059765be3a0c1e713b0882419fb623b5b9fd927a0e8c1fe68cd8f3 |

## Red Hat Enterprise Linux Desktop 7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Desktop 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| x86\_64 | |
| thunderbird-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 16326f4bbae9719734a507a40bbf3cb35909c34f4349e1fdb03879817ab7aeb9 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 5e3eda6dac510b4139f719a04e260c08d4f6741781014b15e61dde1094cda09b |
| i386 | |
| thunderbird-45.4.0-1.el6\_8.i686.rpm | SHA-256: 4c696874290ae8d240d4ecc5497a54acb2c0034c3aa85bf03eb7388b55ec7c81 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: ec5eaf98ad64115ab36e0edaceb1b940ea1dd33b1329576a7ad503ad8964d0ae |

## Red Hat Enterprise Linux Desktop 5

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el5\_11.src.rpm | SHA-256: 297311e7a25a2f21e1c699505475ff24016794ba9aea141165f5377b9c435fc4 |
| x86\_64 | |
| thunderbird-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 4e769e9519f4e2181e2e855256c52af8144b156719680a79f237c8401b7fabff |
| thunderbird-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 9be1b227622373ebece3aec0b263cbfd6ca4d97c08477b002fe7bae7dca940a5 |
| i386 | |
| thunderbird-45.4.0-1.el5\_11.i386.rpm | SHA-256: e15d3099e15a8c902f78f34cab018c51ced169919778e92ee2aa1b33486ade67 |
| thunderbird-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: ea5534fb71059765be3a0c1e713b0882419fb623b5b9fd927a0e8c1fe68cd8f3 |

## Red Hat Enterprise Linux for IBM z Systems 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| s390x | |
| thunderbird-45.4.0-1.el6\_8.s390x.rpm | SHA-256: d86013e24a6552e1e12d6bc07d672e0945c2ca3055955bd2285b7d4006d115ad |
| thunderbird-debuginfo-45.4.0-1.el6\_8.s390x.rpm | SHA-256: c7eebbb3068846664bc1be5b72044878de04908ebe6c8bd5f6524d5b7a2e744e |

## Red Hat Enterprise Linux for Power, big endian 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| ppc64 | |
| thunderbird-45.4.0-1.el6\_8.ppc64.rpm | SHA-256: 56e5d2d0018f665d1df07107e3567bf67d0c861167f80b75d56b6b004b1ecdba |
| thunderbird-debuginfo-45.4.0-1.el6\_8.ppc64.rpm | SHA-256: ee33c25acd46ab77f75b1734aa70f668a6169f839fd1db907a9b50c94ea01c02 |

## Red Hat Enterprise Linux for Power, little endian 7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.3

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.2

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux Server - TUS 7.7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - TUS 7.6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - TUS 7.3

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - TUS 7.2

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| s390x | |
| thunderbird-45.4.0-1.el6\_8.s390x.rpm | SHA-256: d86013e24a6552e1e12d6bc07d672e0945c2ca3055955bd2285b7d4006d115ad |
| thunderbird-debuginfo-45.4.0-1.el6\_8.s390x.rpm | SHA-256: c7eebbb3068846664bc1be5b72044878de04908ebe6c8bd5f6524d5b7a2e744e |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.4

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.3

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.4

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.3

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.2

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| x86\_64 | |
| thunderbird-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: d16852f6049a1ba498c467dc5ba271e4b900e3ef834d078c00afe25ef58ac9e1 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: fb368d60f77f4b5c88b96135a998bdc908e64b6a223a50de3912b126b8efae4e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el7\_2.src.rpm | SHA-256: 33873eff4a0bb57fdbca017492ae966c3829e09e2405c36540140f75d11d3ee9 |
| ppc64le | |
| thunderbird-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: c57b59d66fbca30f7785163a24295d6a0eb90c5f02f45b769dc7504e15ca26d2 |
| thunderbird-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: e8e7503d135e140eeb4e456777ca84b08b38be7f2be0316e975f73479cb4e9a5 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| x86\_64 | |
| thunderbird-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 16326f4bbae9719734a507a40bbf3cb35909c34f4349e1fdb03879817ab7aeb9 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 5e3eda6dac510b4139f719a04e260c08d4f6741781014b15e61dde1094cda09b |
| i386 | |
| thunderbird-45.4.0-1.el6\_8.i686.rpm | SHA-256: 4c696874290ae8d240d4ecc5497a54acb2c0034c3aa85bf03eb7388b55ec7c81 |
| thunderbird-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: ec5eaf98ad64115ab36e0edaceb1b940ea1dd33b1329576a7ad503ad8964d0ae |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension (for IBM z Systems) 6

| SRPM | |
| --- | --- |
| thunderbird-45.4.0-1.el6\_8.src.rpm | SHA-256: 957e70888ed7fff544c6e72397adf5f5fdfa4bc03b499eb948c13d81f08dda52 |
| s390x | |
| thunderbird-45.4.0-1.el6\_8.s390x.rpm | SHA-256: d86013e24a6552e1e12d6bc07d672e0945c2ca3055955bd2285b7d4006d115ad |
| thunderbird-debuginfo-45.4.0-1.el6\_8.s390x.rpm | SHA-256: c7eebbb3068846664bc1be5b72044878de04908ebe6c8bd5f6524d5b7a2e744e |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_90c9296d_20250126_122142.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1254688)
* [XML](/show_bug.cgi?ctype=xml&id=1254688)

Closed
[Bug 1254688](/show_bug.cgi?id=1254688)
(CVE-2016-5250)

Opened 9 years ago
Closed 9 years ago

# Resource Timing API is storing resources sent by the previous page.

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Resource Timing API is storing resources sent by the previous page.

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

45 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla49

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |
| Webcompat Priority | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox46 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox46&o1=equals&v1=wontfix) |
| firefox47 | [-](/buglist.cgi?f1=cf_tracking_firefox47&o1=equals&v1=-) | [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix) |
| firefox48 | [+](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=fixed) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox46 |  | wontfix |
| firefox47 | - | wontfix |
| firefox48 | + | fixed |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: catalind, Assigned: valentin, NeedInfo)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/dedff9d4500fcbc5cdd1cd270f044b33?d=mm&size=40)  [valentin](/user_profile?user_id=415378)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8379576d7004ec4d956475a77e97cdf5?d=mm&size=40)  [catalind](/user_profile?user_id=564444)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

NeedInfo From:

 [catalind](/user_profile?user_id=564444)

[9 years ago](#c47)

[NeedInfo:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#needinfo)

Update

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[822480](/show_bug.cgi?id=822480 "RESOLVED FIXED - Add in the Resource Timing API")

[1399535](/show_bug.cgi?id=1399535 "NEW - Land test for bug 1254688")

Dependency [tree](/showdependencytree.cgi?id=1254688&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1254688)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-sop, privacy, sec-moderate, Whiteboard: [land tests in July][adv-main48+][adv-esr45.4+] maybe sec-high? btpp-active)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2016-5250

[Keywords:](/describekeywords.cgi)

[csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[land tests in July][adv-main48+][adv-esr45.4+] maybe sec-high? btpp-active

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [in-testsuite](#a7336169_1689 "9 years ago") | ? |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 3 obsolete files)

| [Test pages which reproduce the error](/attachment.cgi?id=8728078)  [9 years ago](#c0)  [Catalin Dumitru](/user_profile?user_id=564444)   3.41 KB, application/java-archive |  | [Details](/attachment.cgi?id=8728078&action=edit) |
| --- | --- | --- |
| [Use mLoadInfo to get the performance object](/attachment.cgi?id=8737899)  [9 years ago](#c9)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   3.88 KB, patch |  | [Details](/attachment.cgi?id=8737899&action=edit) | [Diff](/attachment.cgi?id=8737899&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737899) |
| [Use mLoadInfo to get the performance object](/attachment.cgi?id=8737916)  [9 years ago](#c13)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   3.73 KB, patch | tanvi : [review-](#c21 "9 years ago")  bzbarsky : [review+](#c15 "9 years ago") | [Details](/attachment.cgi?id=8737916&action=edit) | [Diff](/attachment.cgi?id=8737916&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737916) |
| [Test - Resources loaded in onunload shouldn't show up in the next page performance object](/attachment.cgi?id=8737958)  [9 years ago](#c14)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   5.08 KB, patch | bzbarsky : [review+](#c16 "9 years ago") | [Details](/attachment.cgi?id=8737958&action=edit) | [Diff](/attachment.cgi?id=8737958&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737958) |
| [Test - Resources loaded in onunload shouldn't show up in the next page performance object](/attachment.cgi?id=8748584)  [9 years ago](#c25)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   5.09 KB, patch |  | [Details](/attachment.cgi?id=8748584&action=edit) | [Diff](/attachment.cgi?id=8748584&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8748584) |
| [Use mLoadInfo to get the performance object](/attachment.cgi?id=8750426)  [9 years ago](#c27)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   4.17 KB, patch | tanvi : [review+](#c30 "9 years ago")  dveditz : [approval-mozilla-aurora+](#c41 "9 years ago")  dveditz : [sec-approval+](#c41 "9 years ago") | [Details](/attachment.cgi?id=8750426&action=edit) | [Diff](/attachment.cgi?id=8750426&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8750426) |
| [Use mLoadInfo to get the performance object [aurora]](/attachment.cgi?id=8759617)  [9 years ago](#c43)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   3.76 KB, patch |  | [Details](/attachment.cgi?id=8759617&action=edit) | [Diff](/attachment.cgi?id=8759617&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8759617) |
| [Use mLoadInfo to get the performance object [esr45]](/attachment.cgi?id=8775389)  [8 years ago](#c50)  [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)   4.70 KB, patch | Sylvestre : [approval-mozilla-esr45+](#c53 "8 years ago") | [Details](/attachment.cgi?id=8775389&action=edit) | [Diff](/attachment.cgi?id=8775389&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8775389) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Catalin Dumitru](/user_profile?user_id=564444)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1254688#c0)• 9 years ago |
| str testcase | |

Attached file
[Test pages which reproduce the error](attachment.cgi?id=8728078)
— [Details](attachment.cgi?id=8728078&action=edit)

User Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10\_10\_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36
Steps to reproduce:
We've identified an issue with the Resource Timing API, in scenarios in which requests are sent during a navigation from one page to another. Requests sent by the previous page, which were made after the next page starts loading, will appear in the list of resources for the next page. This typically happens if requests are sent during the "onbeforeunload" and "unload" handlers. These resources will appear at the beginning of the array returned by calling:
performance.getEntriesByType("resource")
This scenario also reproduces for cross-origin navigations, which is why this can pose a security and privacy issue, considering that any page can detect and capture some of the requests sent by the previous page.
Steps to Reproduce:
Attached are two files used as test pages to reproduce this bug. Each page will attach a handler to the "unload" event which will perform an external request with an identifier for the current page. This request has the format:
<http://www.google-analytics.com/r/collect?dl={{current> page}}
Additionally, when the page initially loads, with a 2 delay, a list of resources for the current page will be populated in the "Current list of resources" section, extracted by calling "performance.getEntriesByType('resource')".
1. Ensure any "AdBlock" extensions are disabled before opening these test pages. They might block the external request.​
2. Open "page1.html" in Firefox
3. Wait 2 seconds for the list of resources to be displayed. The initial list should be empty as the first page hasn't made any requests yet.
4. Press the bottom link to navigate to the next page.
5. Wait 2 seconds for the new list of resources to be displayed. This time, we see the list consists of a single request to "<http://www.google-analytics.com>" sent by the previous page.
Actual results:
The list of resources should be empty on both accounts, for page1 and for page2, as the requests are made after the initial 2 seconds delay, during the "unload" event.
Expected results:
On page2, there is a single request made by page1. In essence, page2 has captured a request made by page1.
We've tested this scenario on Chrome and IE11, and in both cases, the lists of resources are empty.

|  | [Kohei Yoshino](/user_profile?user_id=232883) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a30482_232883)• 9 years ago |

Component: Untriaged → DOMProduct: Firefox → Core

|  | [Catalin Dumitru](/user_profile?user_id=564444)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1254688#c1)• 9 years ago |
|  | |

I seem to have made a mistake in the description of the bug, the "Actual results" and "Expected results" sections are reversed. It should read:
Actual results:
On page2, there is a single request made by page1. In essence, page2 has captured a request made by page1.
Expected results:
The list of resources should be empty on both accounts, for page1 and for page2, as the requests are made after the initial 2 seconds delay, during the "unload" event.

|  | [Andrew Overholt [:overholt]](/user_profile?user_id=442218) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1254688#c2)• 9 years ago |
|  | |

Valentin, what do you think?Group: dom-core-securityFlags: needinfo?(valentin.gosu)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a2081312_1689)• 9 years ago |

[Attachment #8728078](/attachment.cgi?id=8728078&action=edit "Test pages which reproduce the error") -
Attachment mime type: application/zip → application/java-archive

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1254688#c3)• 9 years ago |
|  | |

Confirmed on nightly.Blocks: [822480](/show_bug.cgi?id=822480 "RESOLVED FIXED - Add in the Resource Timing API")Status: UNCONFIRMED → NEWEver confirmed: trueKeywords: [csectype-sop](/buglist.cgi?keywords=csectype-sop&resolution=---),
[privacy](/buglist.cgi?keywords=privacy&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)Whiteboard: maybe sec-high?

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1254688#c4)• 9 years ago |
|  | |

Thanks for the report.
I suspect the docshell's performance object is switched in onunload, and we end up saving the resources in the wrong array.Assignee: nobody → valentin.gosuFlags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1254688#c5)• 9 years ago |
|  | |

So, the problem here is that during the onunload handler we initialize the object which creates a channel and calls :AsyncOpen.
When the request completes, in :OnStopRequest we call HttpBaseChannel::GetPerfomance() which goes through the loadContext -> domWindow -> nsPerformance. At this point unload has already finished, and the docshell has changed the window for a new one.
I've tried caching the performance object in :AsyncOpen, to make sure we're using the correct one. That seems to work but it fails a mochitest for iframe behaviour - currently debugging.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1254688#c6)• 9 years ago |
|  | |

We should be getting to the performance object via the loadinfo, I would think. That represents the actual Document and Window the load is associated with...

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1254688#c7)• 9 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] from [comment #6](/show_bug.cgi?id=1254688#c6 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> We should be getting to the performance object via the loadinfo, I would
> think. That represents the actual Document and Window the load is
> associated with...
Getting the performance object via mLoadInfo->GetLoadingDocument -> mozIDOMWindowProxy::GetDefaultView ... innerWindow->GetPerformance() seems to have the same problem.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1254688#c8)• 9 years ago |
|  | |

If you're going through mozIDOMWindowProxy you have clearly lost, since that's the outer window. You want to go through nsIDocument::GetInnerWindow().

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1254688#c9)• 9 years ago |
|  | |

Attached patch

[Use mLoadInfo to get the performance object](attachment.cgi?id=8737899&action=diff) (obsolete)
— [Details](attachment.cgi?id=8737899&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737899)

Thanks for the hint, Boris. That worked, except I get a null pointer for GetParentPerformance() in regular iframe use cases. Do you know why there would be a difference between the 2 ways of getting the performance object?
[Attachment #8737899](/attachment.cgi?id=8737899&action=edit "Use mLoadInfo to get the performance object") -
Flags: feedback?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1254688#c10)• 9 years ago |
|  | |

Which two ways are you talking about?Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1254688#c11)• 9 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] from [comment #10](/show_bug.cgi?id=1254688#c10 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> Which two ways are you talking about?
The one we currently use:
> loadContext->GetAssociatedWindow(); pDomWindow->GetCurrentInnerWindow();
> innerWindow->GetPerformance(); docPerformance->GetParentPerformance();
vs the one you suggested:
> mLoadInfo->GetLoadingDocument(); loadingDocument->GetInnerWindow();
> innerWindow->GetPerformance(); docPerformance->GetParentPerformance();
While writing the comment I actually realized that there's no need for docPerformance->GetParentPerformance() when using mLoadInfo to get the document, but I'm still not quite sure why that is.Flags: needinfo?(valentin.gosu)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1254688#c12)• 9 years ago |
|  | |

> loadContext->GetAssociatedWindow(); pDomWindow->GetCurrentInnerWindow();
> innerWindow->GetPerformance(); docPerformance->GetParentPerformance();
OK, so this gets the corresponding window for the load context (the docshell), then gets its performance object, then does GetParentPerformance. This makes sense for document loads, because the loadcontext for a document load is the subframe docshell, so the performance object you would get is for that subframe's window, but you want to put it in the parent. For non-document loads the performance object off the loadcontext is the right one, which is why the GetParentPerformance is done only when LOAD\_DOCUMENT\_URI.
> mLoadInfo->GetLoadingDocument(); loadingDocument->GetInnerWindow();
> innerWindow->GetPerformance();
The loading document is defined as the document the load got started from. Its semantics for toplevel loads are a bit unclear (please check with tanvi as to what they are nowadays); for subframe loads it's the document containing the <iframe> or <frame> tag. For non-document loads it's the document the load is associated with. So in this case the performance object you get is already the one for the parent document, in the case of subframe loads.
Note that the semantics of loadingDocument are documented in nsILoadInfo.idl; if that documentation is not clear pleas file bugs.

|  | [Andrew Overholt [:overholt]](/user_profile?user_id=442218) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a2327157_442218)• 9 years ago |

Whiteboard: maybe sec-high? → maybe sec-high? btpp-active

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1254688#c13)• 9 years ago |
|  | |

Attached patch

[Use mLoadInfo to get the performance object](attachment.cgi?id=8737916&action=diff) (obsolete)
— [Details](attachment.cgi?id=8737916&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737916)

MozReview-Commit-ID: KMbwR7J8FLm
[Attachment #8737916](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") -
Flags: review?(bzbarsky)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a2329188_415378)• 9 years ago |

[Attachment #8737899](/attachment.cgi?id=8737899&action=edit "Use mLoadInfo to get the performance object") -
Attachment is obsolete: true
[Attachment #8737899](/attachment.cgi?id=8737899&action=edit "Use mLoadInfo to get the performance object") -
Flags: feedback?(bzbarsky)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1254688#c14)• 9 years ago |
|  | |

Attached patch

[Test - Resources loaded in onunload shouldn't show up in the next page performance object](attachment.cgi?id=8737958&action=diff) (obsolete)
— [Details](attachment.cgi?id=8737958&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737958)

MozReview-Commit-ID: EI1daHa9VTp
[Attachment #8737958](/attachment.cgi?id=8737958&action=edit "Test - Resources loaded in onunload shouldn't show up in the next page performance object") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1254688#c15)• 9 years ago |
|  | |

Comment on [attachment 8737916](/attachment.cgi?id=8737916 "Use mLoadInfo to get the performance object") [[details]](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") [[diff]](/attachment.cgi?id=8737916&action=diff "Use mLoadInfo to get the performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737916)
Use mLoadInfo to get the performance object
>+ nsCOMPtr<nsIDOMDocument> domDocument;
>+ mLoadInfo->GetLoadingDocument(getter\_AddRefs(domDocument));
I think it might be a bit simpler to do:
nsINode\* loadingNode = mLoadInfo->LoadingNode();
if (!loadingNode) {
return nullptr;
}
nsPIDOMWindowInner\* innerWindow = loadingNode->OwnerDoc()->GetInnerWindow();
Though the fact that LoadingNode() can return null is weird; worth filing a bug on that: it should have a Get prefix if it can return null.
>+ if (!docPerformance) {
>+ return nullptr;
>+ }
>+
>+ return docPerformance;
Why do you need that if? Just return docPerformance; if it's null, it's null.
This seems reasonable to me, but please double-check with Tanvi as to whether the LoadingNode() of mLoadInfo is reliable enough at this point, and whether it's that way on the branches you plan to backport this to....
[Attachment #8737916](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") -
Flags: review?(tanvi)
[Attachment #8737916](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") -
Flags: review?(bzbarsky)
[Attachment #8737916](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") -
Flags: review+

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1254688#c16)• 9 years ago |
|  | |

Comment on [attachment 8737958](/attachment.cgi?id=8737958 "Test - Resources loaded in onunload shouldn't show up in the next page performance object") [[details]](/attachment.cgi?id=8737958&action=edit "Test - Resources loaded in onunload shouldn't show up in the next page performance object") [[diff]](/attachment.cgi?id=8737958&action=diff "Test - Resources loaded in onunload shouldn't show up in the next page performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737958)
Test - Resources loaded in onunload shouldn't show up in the next page performance object
>+ while (performance.now() - start < 1000);
What's the point of this line? I don't expect it to have any effect whatsoever....
r=me with that removed or clearly explained...
[Attachment #8737958](/attachment.cgi?id=8737958&action=edit "Test - Resources loaded in onunload shouldn't show up in the next page performance object") -
Flags: review?(bzbarsky) → review+

|  | [Tanvi Vyas[:tanvi]](/user_profile?user_id=430652) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1254688#c17)• 9 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] from [comment #15](/show_bug.cgi?id=1254688#c15 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> This seems reasonable to me, but please double-check with Tanvi as to
> whether the LoadingNode() of mLoadInfo is reliable enough at this point, and
> whether it's that way on the branches you plan to backport this to....
What content types is GetPerformance() called for? TYPE\_DOCUMENT loads don't have an accurate loadingNode and soon won't have one at all, but from [Comment 0](/show_bug.cgi?id=1254688#c0 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page.") it looks like this is only an issue for subresources. Does it apply to TYPE\_SUBDOCUMENT?
loadingPrincipal is required for non-TYPE\_DOCUMENT loads, but loadingNode is not. There are cases where we have a principal, but no node. And specifically in e10s, we don't always have a node.
Valentin, I'm happy to chat more about this on irc or vidyo if you would like. I'm out tomorrow but will be back online on Wednesday. Christoph is also out right now, but you may be able to find sicking on irc.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1254688#c18)• 9 years ago |
|  | |

> What content types is GetPerformance() called for?
I'm guessing all of them, though for TYPE\_DOCUMENT we really want to end up with null.
> Does it apply to TYPE\_SUBDOCUMENT?
Yes.
> There are cases where we have a principal, but no node.
What cases are those?

|  | [Tanvi Vyas[:tanvi]](/user_profile?user_id=430652) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1254688#c19)• 9 years ago |
|  | |

loadInfo->loadingNode is not reliable for TYPE\_DOCUMENT.
\*\* In e10s mode it is often wrong before [Bug 1113196](/show_bug.cgi?id=1113196 "RESOLVED FIXED - Don't pass the existing document for top-level loads to the loadinfo")/Firefox 47.
\*\* In e10s mode it is null after [Bug 1113196](/show_bug.cgi?id=1113196 "RESOLVED FIXED - Don't pass the existing document for top-level loads to the loadinfo")/Firefox 47
\*\* With [Bug 1105556](/show_bug.cgi?id=1105556 "RESOLVED FIXED - Set correct loadingPrincipal and loadingNode in docshell") (probably Firefox 49), it will be null for non-e10s mode and e10s mode.
loadInfo->loadingNode and loadInfo->loadingPrincipal should be reliable for TYPE\_SUBDOCUMENT loads after [Bug 1113196](/show_bug.cgi?id=1113196 "RESOLVED FIXED - Don't pass the existing document for top-level loads to the loadinfo") and [bug 1240246](/show_bug.cgi?id=1240246 "RESOLVED FIXED - Determine why mScriptGlobal becomes null in DoURILoad in test browser_page_style_menu.js") in Firefox 47. (It may also be reliable before Firefox 47, but I can't be sure without better understanding the changes in [bug 1240246](/show_bug.cgi?id=1240246 "RESOLVED FIXED - Determine why mScriptGlobal becomes null in DoURILoad in test browser_page_style_menu.js"). There may be circumstances where we couldn't get a node and couldn't get a principal, and fell back to not-necessarily-sane values.)
(In reply to Boris Zbarsky [:bz] from [comment #18](/show_bug.cgi?id=1254688#c18 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> > There are cases where we have a principal, but no node.
>
> What cases are those?
Here are a some examples, along with some random places in the code I found where we don't have a loadingNode. There are likely many more.
\* When we go from e10s child to parent or parent to child: <http://mxr.mozilla.org/mozilla-central/source/ipc/glue/BackgroundUtils.cpp#207>. Example: <https://mxr.mozilla.org/mozilla-central/source/netwerk/protocol/wyciwyg/WyciwygChannelParent.cpp#93>
\* Per nsNetUtil.h, For loads that are not related to any document, such as loads coming from addons or internal browser features. And WebWorkers
\* calls to NS\_NewInputStreamChannel() <https://mxr.mozilla.org/mozilla-central/ident?i=NS_NewInputStreamChannel>
\* in nsNetUtil, we have multiple NewChannel methods to account for cases where we have a
i) loadingNode, loadingPrincipal and triggeringPrincipal
ii) loadingNode, loadingPrincipal
iii) loadingPrincipal, triggeringPrincipal
iv) just a loadingPrincipal
Callers choose which method to call based on what parameters they have available. I don't remember all the cases where we call the methods for iii or iv[1], but perhaps Christoph or Jonas can think of a few good examples.
\* <http://mxr.mozilla.org/mozilla-central/source/toolkit/components/places/nsFaviconService.cpp#350>
\* <https://mxr.mozilla.org/mozilla-central/source/image/imgLoader.cpp#782>
[1] <https://mxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil.h#212>
<https://mxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil.h#237>
<https://mxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil.h#299>
<https://mxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil.h#328>
<https://mxr.mozilla.org/mozilla-central/source/netwerk/base/nsNetUtil.h#410>

|  | [Tanvi Vyas[:tanvi]](/user_profile?user_id=430652) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1254688#c20)• 9 years ago |
|  | |

(In reply to Boris Zbarsky [:bz] from [comment #12](/show_bug.cgi?id=1254688#c12 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> > loadContext->GetAssociatedWindow(); pDomWindow->GetCurrentInnerWindow();
> > innerWindow->GetPerformance(); docPerformance->GetParentPerformance();
>
> ... For non-document loads the performance object off the loadcontext is the right
> one, which is why the GetParentPerformance is done only when
> LOAD\_DOCUMENT\_URI.
>
If the problem with the existing code that uses loadcontext is only for subframes then maybe we can:
\* use loadcontext for non-TYPE\_DOCUMENT, non-TYPE\_SUBDOCUMENT loads
\* Return null for TYPE\_DOCUMENT loads
\* use loadinfo->LoadingNode for TYPE\_SUBDOCUMENT loads

|  | [Tanvi Vyas[:tanvi]](/user_profile?user_id=430652) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1254688#c21)• 9 years ago |
|  | |

Comment on [attachment 8737916](/attachment.cgi?id=8737916 "Use mLoadInfo to get the performance object") [[details]](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") [[diff]](/attachment.cgi?id=8737916&action=diff "Use mLoadInfo to get the performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8737916)
Use mLoadInfo to get the performance object
r- for now, since we can't depend on the loadingDocument for all content types.
[Attachment #8737916](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") -
Flags: review?(tanvi) → review-

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1254688#c22)• 9 years ago |
|  | |

> If the problem with the existing code that uses loadcontext is only for subframes
It's not. It's a problem for toplevel documents too.
We really need to fix things so that for anything that's not a TYPE\_DOCUMENT load that's associated with a web document we properly track which document it's associated with; I thought LoadInfo was supposed to solve that problem. Because there is no sane way to do something like resource timing unless we do that...

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1254688#c23)• 9 years ago |
|  | |

> loadInfo->loadingNode is not reliable for TYPE\_DOCUMENT.
That's fine. The code involved in this bug doesn't care about TYPE\_DOCUMENT.
> When we go from e10s child to parent or parent to child:
Is that an issue for HTTP at all? If not, it probably doesn't matter for purposes of this bug, since this bug only cares about loadinfo on HTTP channels.
> For loads that are not related to any document, such as loads coming from addons or internal browser
> features.
Not an issue, since those are not relevant to web-exposed resource timing.
> calls to NS\_NewInputStreamChannel()
Not an issue, since this code is HTTP-channel-specific.
>\* <https://mxr.mozilla.org/mozilla-central/source/image/imgLoader.cpp#782>
Seems ok; the "not loading inside a document" case means we don't want to track that stuff in resource timing.
Sounds like the issues are: 1) people using NewChannel without loadingNode when the load \_is\_ document-associated, assuming we have such cases and 2) TYPE\_SUBDOCUMENT prior to Firefox 47. The latter may require some thought if we want to backport this past Firefox 47, but could be worked around by explicitly walking to the frameElement of the window of the docshell the load is happening in to find the right document/window for the relevant Performance object.

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1254688#c24)• 9 years ago |
|  | |

Boris, I'm looking into landing this. The patch applies and works on m-c and aurora, and also beta with minimal changes.
Do we need Tanvi to r+ this as well?Flags: needinfo?(bzbarsky)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1254688#c25)• 9 years ago |
|  | |

Attached patch

[Test - Resources loaded in onunload shouldn't show up in the next page performance object](attachment.cgi?id=8748584&action=diff)
— [Details](attachment.cgi?id=8748584&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8748584)

Updated test removing unnecessary while loop. Using daemon.png instead of red.png because [bug 1113676](/show_bug.cgi?id=1113676 "NEW - img resources missing from resource-timing entries when loaded from cache") makes it pass even when it shouldn't.

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a4889338_415378)• 9 years ago |

[Attachment #8737958](/attachment.cgi?id=8737958&action=edit "Test - Resources loaded in onunload shouldn't show up in the next page performance object") -
Attachment is obsolete: true

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1254688#c26)• 9 years ago |
|  | |

Yes, please talk to tanvi about the situation with loadingDocument on all the various branches and whether it does what we want it to do. I haven't been keeping track of what's going on there and what all the edge cases are, so I simply don't know whether there are issues or not.Flags: needinfo?(bzbarsky)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1254688#c27)• 9 years ago |
|  | |

Attached patch

[Use mLoadInfo to get the performance object](attachment.cgi?id=8750426&action=diff)
— [Details](attachment.cgi?id=8750426&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8750426)

Updated with Tanvi's suggestions that we return early for TYPE\_DOCUMENT, or if we're in the parent process on e10s
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: review?(tanvi)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a5348783_415378)• 9 years ago |

[Attachment #8737916](/attachment.cgi?id=8737916&action=edit "Use mLoadInfo to get the performance object") -
Attachment is obsolete: true

|  | [Tanvi Vyas[:tanvi]](/user_profile?user_id=430652) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1254688#c28)• 9 years ago |
|  | |

Discussed with Christoph and Jonas again today. As mentioned in [comment 19](/show_bug.cgi?id=1254688#c19 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."), the loadingDocument is not always available. In most cases, that is because there is no document. There may be cases, however, where there is a document involved but we just don't have it. Determining all of these cases would involve a large audit, but we have compiled a list from memory:
favicons - favicon requests may happen in chrome code where we can't tell what document they belong to. I'm not sure if this is for all favicon requests, or just some. But it is worth testing. This is not an easy problem to solve, so for now you may want to just accept that some favicon requests won't make it into the Performance object.
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1119386](/show_bug.cgi?id=1119386 "RESOLVED FIXED - Use the loading document's principal to populate loadInfo for Favicons instead of using systemPrincipal"), <http://mxr.mozilla.org/mozilla-central/source/toolkit/components/places/nsFaviconService.cpp#415>
Jonas suggested testing preloads. He also suggested testing some image codepaths; in particular he said to check css background images and image preloads. Finally, he said it is worth testing send beacon.

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1254688#c29)• 9 years ago |
|  | |

> so for now you may want to just accept that some favicon requests won't make it into the Performance object
They shouldn't make it in there at all, so that's fine.

|  | [Tanvi Vyas[:tanvi]](/user_profile?user_id=430652) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1254688#c30)• 9 years ago |
|  | |

Comment on [attachment 8750426](/attachment.cgi?id=8750426 "Use mLoadInfo to get the performance object") [[details]](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") [[diff]](/attachment.cgi?id=8750426&action=diff "Use mLoadInfo to get the performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8750426)
Use mLoadInfo to get the performance object
This patch looks fine. Before pushing to inbound, I would do a MOZ\_ASSERT(domDocument) here and push to try just to see what types of things might be failing:
>+ nsCOMPtr<nsIDOMDocument> domDocument;
>+ mLoadInfo->GetLoadingDocument(getter\_AddRefs(domDocument));
>+ if (!domDocument) {
>+ return nullptr;
>+ }
Also, per below, there are a number of things you could test manually for correctness. If you don't though, none of these issues are security issues.
(In reply to Tanvi Vyas out 5/16-5/17 [:tanvi] from [comment #28](/show_bug.cgi?id=1254688#c28 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> Discussed with Christoph and Jonas again today. As mentioned in [comment 19](/show_bug.cgi?id=1254688#c19 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."),
> the loadingDocument is not always available. In most cases, that is because
> there is no document. There may be cases, however, where there is a
> document involved but we just don't have it. Determining all of these cases
> would involve a large audit, but we have compiled a list from memory:
>
> favicons - favicon requests may happen in chrome code where we can't tell
> what document they belong to. I'm not sure if this is for all favicon
> requests, or just some. But it is worth testing. This is not an easy
> problem to solve, so for now you may want to just accept that some favicon
> requests won't make it into the Performance object.
> [https://bugzilla.mozilla.org/show\_bug.cgi?id=1119386](/show_bug.cgi?id=1119386 "RESOLVED FIXED - Use the loading document's principal to populate loadInfo for Favicons instead of using systemPrincipal"),
> <http://mxr.mozilla.org/mozilla-central/source/toolkit/components/places/>
> nsFaviconService.cpp#415
>
> Jonas suggested testing preloads. He also suggested testing some image
> codepaths; in particular he said to check css background images and image
> preloads. Finally, he said it is worth testing send beacon.
Also, one more from Christoph - workers should have a loadingNode, but subworkers don't.
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: review?(tanvi) → review+

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1254688#c31)• 9 years ago |
|  | |

Comment on [attachment 8750426](/attachment.cgi?id=8750426 "Use mLoadInfo to get the performance object") [[details]](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") [[diff]](/attachment.cgi?id=8750426&action=diff "Use mLoadInfo to get the performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8750426)
Use mLoadInfo to get the performance object
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not easily.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
It is not immediately obvious what the problem is. The test in attachment 874858 does illustrate the vulnerability.
Which older supported branches are affected by this flaw?
All.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
The patch can be easily backported to all branches.
How likely is this patch to cause regressions; how much testing does it need?
There is a slight risk of regressions that have been mentioned in previous comments. I have manually tested some of them and found no problems, and the unit tests cover the most important cases.
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1254688#c32)• 9 years ago |
|  | |

Is this too late to get into 47?
[status-firefox46](/buglist.cgi?f1=cf_status_firefox46&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox46&o1=equals&v1=wontfix)
[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=affected)
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox47](/buglist.cgi?f1=cf_tracking_firefox47&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox47&o1=equals&v1=%3F)
[tracking-firefox48](/buglist.cgi?f1=cf_tracking_firefox48&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%3F)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F)Flags: needinfo?(rkothari)Flags: needinfo?(lhenry)

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1254688#c33)• 9 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #32](/show_bug.cgi?id=1254688#c32 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> Is this too late to get into 47?
Yes, as this point in time, I am only open to uplifting sec-high and sec-crit issues. Just based on the rating, this does not meet the Beta47 uplift bar now. Is this easily exploitable? That might make me reconsider. Please let me know.Flags: needinfo?(rkothari)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1254688#c34)• 9 years ago |
|  | |

(In reply to Ritu Kothari (:ritu) from [comment #33](/show_bug.cgi?id=1254688#c33 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> (In reply to Al Billings [:abillings] from [comment #32](/show_bug.cgi?id=1254688#c32 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page."))
> > Is this too late to get into 47?
>
> Yes, as this point in time, I am only open to uplifting sec-high and
> sec-crit issues. Just based on the rating, this does not meet the Beta47
> uplift bar now. Is this easily exploitable? That might make me reconsider.
> Please let me know.
There is a possible privacy leak if a page initiates a load in its onunload handler.
Also, an attacker may cause performance.getEntries() to report entries that the current page hasn't loaded, by triggering the load in the previous' page onunload handler. It isn't clear how dangerous this is.

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1254688#c35)• 9 years ago |
|  | |

From discussion with Al it sounds like it is borderline. So I agree we shouldn't take this at the last minute in beta. But let's land it to nightly and aurora. We could still take it in the next esr that releases along with 48 (45.3.0)
[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix)
[tracking-firefox47](/buglist.cgi?f1=cf_tracking_firefox47&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox47&o1=equals&v1=%3F) → [-](/buglist.cgi?f1=cf_tracking_firefox47&o1=equals&v1=-)
[tracking-firefox48](/buglist.cgi?f1=cf_tracking_firefox48&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%2B)Flags: needinfo?(lhenry)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1254688#c36)• 9 years ago |
|  | |

Can you request uplift to aurora once this lands on m-c? Thanks.Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1254688#c37)• 9 years ago |
|  | |

Setting checkin needed for [attachment 8750426](/attachment.cgi?id=8750426 "Use mLoadInfo to get the performance object") [[details]](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") [[diff]](/attachment.cgi?id=8750426&action=diff "Use mLoadInfo to get the performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8750426)Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1254688#c38)• 9 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/88c344a56eac>Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1254688#c39)• 9 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/88c344a56eac>Status: NEW → RESOLVEDClosed: 9 years ago
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla49

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1254688#c40)• 9 years ago |
|  | |

Comment on [attachment 8750426](/attachment.cgi?id=8750426 "Use mLoadInfo to get the performance object") [[details]](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") [[diff]](/attachment.cgi?id=8750426&action=diff "Use mLoadInfo to get the performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8750426)
Use mLoadInfo to get the performance object
Approval Request Comment
[Feature/regressing bug #]:
Since first implementation of Resource Timing ([bug 822480](/show_bug.cgi?id=822480 "RESOLVED FIXED - Add in the Resource Timing API"))
[User impact if declined]:
Possible privacy leak. See [comment 34](/show_bug.cgi?id=1254688#c34 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page.").
[Describe test coverage new/current, TreeHerder]:
Existing mochitests and web-platform-tests for resource timing.
[Attachment 8748584](/attachment.cgi?id=8748584 "Test - Resources loaded in onunload shouldn't show up in the next page performance object") [[details]](/attachment.cgi?id=8748584&action=edit "Test - Resources loaded in onunload shouldn't show up in the next page performance object") [[diff]](/attachment.cgi?id=8748584&action=diff "Test - Resources loaded in onunload shouldn't show up in the next page performance object") (not checked in yet) tests the correct behaviour of this change.
[Risks and why]:
Slight risk of regressions (not reporting resource timing entries). Main use cases are covered by tests and have been verified locally.
[String/UUID change made/needed]:
None.Flags: needinfo?(valentin.gosu)
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: approval-mozilla-aurora?

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a7264925_451704)• 9 years ago |

[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F) → [48+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=48%2B)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a7269380_1689)• 9 years ago |

Group: dom-core-security → core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1254688#c41)• 9 years ago |
|  | |

Comment on [attachment 8750426](/attachment.cgi?id=8750426 "Use mLoadInfo to get the performance object") [[details]](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") [[diff]](/attachment.cgi?id=8750426&action=diff "Use mLoadInfo to get the performance object") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8750426)
Use mLoadInfo to get the performance object
please also land on aurora, a=dveditz.
But don't land the tests yet! I'll set the in-testsuite? flag as a reminder to land those closer to the 48 release.
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: sec-approval?
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: sec-approval+
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: approval-mozilla-aurora?
[Attachment #8750426](/attachment.cgi?id=8750426&action=edit "Use mLoadInfo to get the performance object") -
Flags: approval-mozilla-aurora+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a7336169_1689)• 9 years ago |

Flags: in-testsuite?Whiteboard: maybe sec-high? btpp-active → [land tests in July] maybe sec-high? btpp-active

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1254688#c42)• 9 years ago |
|  | |

has problems uplifting to aurora, could you take a look, thanks!
grafting 347531:88c344a56eac "[Bug 1254688](/show_bug.cgi?id=1254688 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page.") - Use mLoadInfo to get the performance object. r=bz, r=tanvi"
merging dom/tests/mochitest/general/resource\_timing\_main\_test.html
merging netwerk/protocol/http/HttpBaseChannel.cpp
warning: conflicts while merging netwerk/protocol/http/HttpBaseChannel.cpp! (edit, then use 'hg resolve --mark')
abort: unresolved conflicts, can't continue
(use 'hg resolve' and 'hg graft --continue')Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1254688#c43)• 9 years ago |
|  | |

Attached patch

[Use mLoadInfo to get the performance object [aurora]](attachment.cgi?id=8759617&action=diff)
— [Details](attachment.cgi?id=8759617&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8759617)

MozReview-Commit-ID: KMbwR7J8FLm

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1254688#c44)• 9 years ago |
|  | |

I rebased the patch for aurora.Flags: needinfo?(valentin.gosu)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1254688#c45)• 9 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/85854d2b443e>
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1254688#c46)• 9 years ago |
|  | |

Bustage fix:
<https://hg.mozilla.org/releases/mozilla-aurora/rev/d992dde457ca>

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1254688#c47)• 9 years ago |
|  | |

Hi Catalin, can you verify that this has been fixed on your end?
You can try a build from here:
<http://ftp.mozilla.org/pub/firefox/candidates/48.0b9-candidates/build1/>Flags: needinfo?(catalind)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1254688#c48)• 9 years ago |
|  | |

Catalin, can you tell me who the "we" for bug credit in advisories is for this issue?Alias: CVE-2016-5250Whiteboard: [land tests in July] maybe sec-high? btpp-active → [land tests in July][adv-main48+] maybe sec-high? btpp-active

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1254688#c49)• 8 years ago |
|  | |

This is supposed to go on the ESR-45 branch for the Fx48-matching release (see status flags). Why hasn't this had an ESR-approval request (likely needs a separate patch) and landed yet?Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1254688#c50)• 8 years ago |
|  | |

Attached patch

[Use mLoadInfo to get the performance object [esr45]](attachment.cgi?id=8775389&action=diff)
— [Details](attachment.cgi?id=8775389&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8775389)

MozReview-Commit-ID: KMbwR7J8FLm

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1254688#c51)• 8 years ago |
|  | |

Comment on [attachment 8775389](/attachment.cgi?id=8775389 "Use mLoadInfo to get the performance object [esr45]") [[details]](/attachment.cgi?id=8775389&action=edit "Use mLoadInfo to get the performance object [esr45]") [[diff]](/attachment.cgi?id=8775389&action=diff "Use mLoadInfo to get the performance object [esr45]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8775389)
Use mLoadInfo to get the performance object [esr45]
[Approval Request Comment]
User impact if declined: Possible privacy leak. See [comment 34](/show_bug.cgi?id=1254688#c34 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page.").
Fix Landed on Version: 49, uplifted to 48.
Risk to taking this patch (and alternatives if risky): Low risk. No known regressions in the past few months.
String or UUID changes made by this patch: noneFlags: needinfo?(valentin.gosu)
[Attachment #8775389](/attachment.cgi?id=8775389&action=edit "Use mLoadInfo to get the performance object [esr45]") -
Flags: approval-mozilla-esr45?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1254688#c52)• 8 years ago |
|  | |

Must be ESR45.4 now. This missed the board for 45.3.
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[48+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=48%2B) → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1254688#c53)• 8 years ago |
|  | |

Comment on [attachment 8775389](/attachment.cgi?id=8775389 "Use mLoadInfo to get the performance object [esr45]") [[details]](/attachment.cgi?id=8775389&action=edit "Use mLoadInfo to get the performance object [esr45]") [[diff]](/attachment.cgi?id=8775389&action=diff "Use mLoadInfo to get the performance object [esr45]") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1254688&attachment=8775389)
Use mLoadInfo to get the performance object [esr45]
Doesn't match the esr criteria, however, as it has a cve, taking it.
Should be in 45.4
[Attachment #8775389](/attachment.cgi?id=8775389&action=edit "Use mLoadInfo to get the performance object [esr45]") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1254688#c54)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/6711ccb0184e>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a15735824_280903)• 8 years ago |

Whiteboard: [land tests in July][adv-main48+] maybe sec-high? btpp-active → [land tests in July][adv-main48+][adv-esr45.4+] maybe sec-high? btpp-active

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a17118457_1689)• 8 years ago |

Group: core-security-release

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1254688#c55)• 7 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/142c2979af94204afd0963202c4b8f5282dfd38e>
[Bug 1254688](/show_bug.cgi?id=1254688 "RESOLVED FIXED - Resource Timing API is storing resources sent by the previous page.") - Test that loaded in onunload shouldn't show up in the next page performance object r=bz

|  | [Sebastian Hengst [:aryx] (needinfo me if it's about an intermittent or backout)](/user_profile?user_id=258347) |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1254688#c56)• 7 years ago |
|  | |

Backed out last push for failing mochitest dom/tests/mochitest/general/test\_resource\_timing\_unload.html | Only one entry should be found:
<https://hg.mozilla.org/integration/mozilla-inbound/rev/8912096e79cde3931d84d8e2e0257518f4b7d001>
Push which ran failing test: <https://treeherder.mozilla.org/#/jobs?repo=mozilla-inbound&revision=b382ec54d164fde891d5f520fd15654d1d521ba9&filter-resultStatus=testfailed&filter-resultStatus=busted&filter-resultStatus=exception&filter-resultStatus=retry&filter-resultStatus=usercancel&filter-resultStatus=runnable>
Failure log: <https://treeherder.mozilla.org/logviewer.html#?job_id=130666428&repo=mozilla-inbound>
[task 2017-09-13T14:36:57.349167Z] 14:36:57 INFO - 3071 INFO TEST-START | dom/tests/mochitest/general/test\_resource\_timing\_unload.html
[task 2017-09-13T14:36:58.161809Z] 14:36:58 INFO - TEST-INFO | started process screentopng
[task 2017-09-13T14:36:59.959793Z] 14:36:59 INFO - TEST-INFO | screentopng: exit 0
[task 2017-09-13T14:36:59.963033Z] 14:36:59 ERROR - 3072 INFO TEST-UNEXPECTED-FAIL | dom/tests/mochitest/general/test\_resource\_timing\_unload.html | Only one entry should be found - got +0, expected 1
[task 2017-09-13T14:36:59.964318Z] 14:36:59 INFO - SimpleTest.is@SimpleTest/SimpleTest.js:312:5
[task 2017-09-13T14:36:59.965724Z] 14:36:59 INFO - is@dom/tests/mochitest/general/file\_resource\_timing\_unload1.html:12:3
[task 2017-09-13T14:36:59.967174Z] 14:36:59 INFO - window.onload@dom/tests/mochitest/general/file\_resource\_timing\_unload1.html:17:3
[task 2017-09-13T14:36:59.968469Z] 14:36:59 INFO - EventHandlerNonNull\*@dom/tests/mochitest/general/file\_resource\_timing\_unload1.html:15:1Flags: needinfo?(valentin.gosu)

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a47847585_415378)• 7 years ago |

Blocks: [1399535](/show_bug.cgi?id=1399535 "NEW - Land test for bug 1254688")

|  | [Valentin Gosu [:valentin] (he/him)](/user_profile?user_id=415378)  Assignee |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1254688#c57)• 7 years ago |
|  | |

I filed [bug 1399535](/show_bug.cgi?id=1399535 "NEW - Land test for bug 1254688") to fixup and land the test.Flags: needinfo?(valentin.gosu)

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1254688#a95012661_1)• 6 years ago |

Component: DOM → DOM: Core & HTML
You need to [log in](/show_bug.cgi?id=1254688&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Catalin Dumitru](/user_profile?user_id=564444)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_cd3aab51_20250125_221236.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1293347)
* [XML](/show_bug.cgi?ctype=xml&id=1293347)

Closed
[Bug 1293347](/show_bug.cgi?id=1293347)

Opened 8 years ago
Closed 8 years ago

# UAF in sctp\_iterator\_inp\_being\_freed

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

UAF in sctp\_iterator\_inp\_being\_freed

## Categories

### (Core :: Networking, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Networking#Networking)

Networking
▾

Core :: Networking
For bugs in Mozilla's modular networking library (aka "Netlib" or "Necko".) The networking library supplies the software interface that Mozilla uses to access physical transports (e.g. the Internet and local drives), perform URL resolutions, and handle a variety of networking protocols.

Examples of appropriate bugs: URLs with backslash not fetched; URLs starting with a single slash turn into http:///; Cannot access authenticated FTP site.

[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

51 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

[Rank:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rank)

10

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla51

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |
| firefox51 | [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 |  | wontfix |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | fixed |
| firefox51 | + | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bwc, Assigned: bwc)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40)  [bwc](/user_profile?user_id=478411)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40)  [bwc](/user_profile?user_id=478411)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/608e04ebca94be52b05c003d51d43e07?d=mm&size=40)  [kershaw](/user_profile?user_id=505624)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

11 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1300716](/show_bug.cgi?id=1300716 "RESOLVED DUPLICATE - WebRtc - Memory corruption in webrtc::ThreadWindows::Run()")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1291244](/show_bug.cgi?id=1291244 "RESOLVED DUPLICATE - WebRtc - Memory corruption in nr_socket_sendto()")

## Details

### (Keywords: csectype-uaf, reporter-external, sec-high, Whiteboard: [adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#c28 "8 years ago") | - |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a2472000_452604 "8 years ago") | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [asan\_output.txt](/attachment.cgi?id=8778987)  [8 years ago](#c1)  [Byron Campen [:bwc]](/user_profile?user_id=478411)   34.45 KB, text/plain |  | [Details](/attachment.cgi?id=8778987&action=edit) |
| --- | --- | --- |
| [Zero out a pointer](/attachment.cgi?id=8779362)  [8 years ago](#c4)  [Byron Campen [:bwc]](/user_profile?user_id=478411)   1.59 KB, patch |  | [Details](/attachment.cgi?id=8779362&action=edit) | [Diff](/attachment.cgi?id=8779362&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8779362) |
| [Move the set/unset of |cur\_it| to a better place](/attachment.cgi?id=8780136)  [8 years ago](#c11)  [Byron Campen [:bwc]](/user_profile?user_id=478411)   2.55 KB, patch | tuexen : [review+](#c12 "8 years ago")  jduell.mcbugs : [review+](#a353604_334931 "8 years ago")  abillings : [approval-mozilla-aurora+](#c19 "8 years ago")  abillings : [approval-mozilla-beta+](#c19 "8 years ago")  abillings : [approval-mozilla-esr45+](#a1303395_280903 "8 years ago")  abillings : [sec-approval+](#c19 "8 years ago") | [Details](/attachment.cgi?id=8780136&action=edit) | [Diff](/attachment.cgi?id=8780136&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8780136) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1293347#c0)• 8 years ago |
|  | |

When running the test case from [bug 1291244](/show_bug.cgi?id=1291244 "RESOLVED DUPLICATE - WebRtc - Memory corruption in nr_socket_sendto()") on linux ASAN, I observed a UAF crash. At first glance it looks like a threadsafety problem.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1293347#c1)• 8 years ago |
|  | |

Attached file
[asan\_output.txt](attachment.cgi?id=8778987)
— [Details](attachment.cgi?id=8778987&action=edit)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1293347#c2)• 8 years ago |
|  | |

The problem is in |sctp\_iterator\_worker|:
sctp\_iterator\_work(it);
sctp\_it\_ctl.cur\_it = NULL;
|sctp\_iterator\_work| can destroy |sctp\_it\_ctl.cur\_it| (aka |it|), but no lock is held by |sctp\_iterator\_worker|. This means that another thread can attempt to use |sctp\_it\_ctl.cur\_it| which is now a dangling pointer. It is a super tight race though.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1293347#c3)• 8 years ago |
|  | |

I think the fix is to unset |sctp\_it\_ctl.cur\_it| in |sctp\_iterator\_work| before we unlock.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a1883_478411)• 8 years ago |

Version: 48 Branch → 51 Branch

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a2560_1689)• 8 years ago |

Group: core-security → media-core-security

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1293347#c4)• 8 years ago |
|  | |

Attached patch

[Zero out a pointer](attachment.cgi?id=8779362&action=diff) (obsolete)
— [Details](attachment.cgi?id=8779362&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8779362)

MozReview-Commit-ID: BGRFposcrBG

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a77793_478411)• 8 years ago |

Assignee: nobody → docfaradayStatus: NEW → ASSIGNED

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a77939_478411)• 8 years ago |

Component: WebRTC: Networking → Networking

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a78105_478411)• 8 years ago |

[Attachment #8779362](/attachment.cgi?id=8779362&action=edit "Zero out a pointer") -
Flags: review?(jduell.mcbugs)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1293347#c5)• 8 years ago |
|  | |

+tuexen for upstream notification about this issueRank: 10Priority: -- → P1

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a94666_11539)• 8 years ago |

[Attachment #8779362](/attachment.cgi?id=8779362&action=edit "Zero out a pointer") -
Flags: review?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1293347#c6)• 8 years ago |
|  | |

What about:
diff --git a/netinet/sctputil.c b/netinet/sctputil.c
index eedc4ab..157b881 100755
--- a/netinet/sctputil.c
+++ b/netinet/sctputil.c
@@ -1518,11 +1518,11 @@ sctp\_iterator\_worker(void)
CURVNET\_SET(it->vn);
#endif
sctp\_iterator\_work(it);
- sctp\_it\_ctl.cur\_it = NULL;
#if defined(\_\_FreeBSD\_\_) && \_\_FreeBSD\_version >= 801000
CURVNET\_RESTORE();
#endif
SCTP\_IPI\_ITERATOR\_WQ\_LOCK();
+ sctp\_it\_ctl.cur\_it = NULL;
#if !defined(\_\_FreeBSD\_\_)
if (sctp\_it\_ctl.iterator\_flags & SCTP\_ITERATOR\_MUST\_EXIT) {
break;

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1293347#c7)• 8 years ago |
|  | |

(In reply to Michael Tüxen from [comment #6](/show_bug.cgi?id=1293347#c6 "RESOLVED FIXED - UAF in sctp_iterator_inp_being_freed"))
> What about:
>
> diff --git a/netinet/sctputil.c b/netinet/sctputil.c
> index eedc4ab..157b881 100755
> --- a/netinet/sctputil.c
> +++ b/netinet/sctputil.c
> @@ -1518,11 +1518,11 @@ sctp\_iterator\_worker(void)
> CURVNET\_SET(it->vn);
> #endif
> sctp\_iterator\_work(it);
> - sctp\_it\_ctl.cur\_it = NULL;
> #if defined(\_\_FreeBSD\_\_) && \_\_FreeBSD\_version >= 801000
> CURVNET\_RESTORE();
> #endif
> SCTP\_IPI\_ITERATOR\_WQ\_LOCK();
> + sctp\_it\_ctl.cur\_it = NULL;
> #if !defined(\_\_FreeBSD\_\_)
> if (sctp\_it\_ctl.iterator\_flags & SCTP\_ITERATOR\_MUST\_EXIT) {
> break;
If anything that'll make the problem worse, as |sctp\_it\_ctl.cur\_it| is a dangling pointer for longer.

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1293347#c8)• 8 years ago |
|  | |

Got it, you are right. I agree, setting it to NULL where you do it makes sense.
Shouldn't it be only cleared there? So what about:
diff --git a/src/netinet/sctputil.c b/src/netinet/sctputil.c
index eedc4ab..a938088 100755
--- a/src/netinet/sctputil.c
+++ b/src/netinet/sctputil.c
@@ -1363,6 +1363,7 @@ sctp\_iterator\_work(struct sctp\_iterator \*it)
if (it->inp == NULL) {
/\* iterator is complete \*/
done\_with\_iterator:
+ sctp\_it\_ctl.cur\_it = NULL;
SCTP\_ITERATOR\_UNLOCK();
SCTP\_INP\_INFO\_RUNLOCK();
if (it->function\_atend != NULL) {
@@ -1518,7 +1519,6 @@ sctp\_iterator\_worker(void)
CURVNET\_SET(it->vn);
#endif
sctp\_iterator\_work(it);
- sctp\_it\_ctl.cur\_it = NULL;
#if defined(\_\_FreeBSD\_\_) && \_\_FreeBSD\_version >= 801000
CURVNET\_RESTORE();
#endif

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1293347#c9)• 8 years ago |
|  | |

(In reply to Michael Tüxen from [comment #8](/show_bug.cgi?id=1293347#c8 "RESOLVED FIXED - UAF in sctp_iterator_inp_being_freed"))
> Got it, you are right. I agree, setting it to NULL where you do it makes
> sense.
> Shouldn't it be only cleared there? So what about:
> diff --git a/src/netinet/sctputil.c b/src/netinet/sctputil.c
> index eedc4ab..a938088 100755
> --- a/src/netinet/sctputil.c
> +++ b/src/netinet/sctputil.c
> @@ -1363,6 +1363,7 @@ sctp\_iterator\_work(struct sctp\_iterator \*it)
> if (it->inp == NULL) {
> /\* iterator is complete \*/
> done\_with\_iterator:
> + sctp\_it\_ctl.cur\_it = NULL;
> SCTP\_ITERATOR\_UNLOCK();
> SCTP\_INP\_INFO\_RUNLOCK();
> if (it->function\_atend != NULL) {
> @@ -1518,7 +1519,6 @@ sctp\_iterator\_worker(void)
> CURVNET\_SET(it->vn);
> #endif
> sctp\_iterator\_work(it);
> - sctp\_it\_ctl.cur\_it = NULL;
> #if defined(\_\_FreeBSD\_\_) && \_\_FreeBSD\_version >= 801000
> CURVNET\_RESTORE();
> #endif
Ah, done\_with\_iterator is the only exit from that function, so yeah this works. Let me update.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1293347#c10)• 8 years ago |
|  | |

And while we're at it, it probably makes sense to move the setting of cur\_it.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1293347#c11)• 8 years ago |
|  | |

Attached patch

[Move the set/unset of |cur\_it| to a better place](attachment.cgi?id=8780136&action=diff)
— [Details](attachment.cgi?id=8780136&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8780136)

<https://treeherder.mozilla.org/#/jobs?repo=try&revision=93cfd86ddf03>

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a253279_478411)• 8 years ago |

[Attachment #8779362](/attachment.cgi?id=8779362&action=edit "Zero out a pointer") -
Attachment is obsolete: true
[Attachment #8779362](/attachment.cgi?id=8779362&action=edit "Zero out a pointer") -
Flags: review?(tuexen)
[Attachment #8779362](/attachment.cgi?id=8779362&action=edit "Zero out a pointer") -
Flags: review?(jduell.mcbugs)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a253434_478411)• 8 years ago |

[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: review?(tuexen)
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: review?(jduell.mcbugs)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1293347#c12)• 8 years ago |
|  | |

Comment on [attachment 8780136](/attachment.cgi?id=8780136 "Move the set/unset of |cur_it| to a better place") [[details]](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") [[diff]](/attachment.cgi?id=8780136&action=diff "Move the set/unset of |cur_it| to a better place") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8780136)
Move the set/unset of |cur\_it| to a better place
The whitespace change in sctp\_sorecvmsg() is not related. Other than that, I'm fine with the patch.
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: review?(tuexen) → review+

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1293347#c13)• 8 years ago |
|  | |

BTW: Can I put a corresponding patch in public repos (usrsctp, FreeBSD) giving "Byron Campen" credit?
(I'm asking since this report is closed.).

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1293347#c14)• 8 years ago |
|  | |

Of course.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a282795_11539)• 8 years ago |

[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: review?(jduell.mcbugs)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1293347#c15)• 8 years ago |
|  | |

Comment on [attachment 8780136](/attachment.cgi?id=8780136 "Move the set/unset of |cur_it| to a better place") [[details]](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") [[diff]](/attachment.cgi?id=8780136&action=diff "Move the set/unset of |cur_it| to a better place") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8780136)
Move the set/unset of |cur\_it| to a better place
Approval Request Comment
[Feature/regressing bug #]:
[Bug 729511](/show_bug.cgi?id=729511 "RESOLVED FIXED - Import SCTP library from FreeBSD")
[User impact if declined]:
Possible UAF crashes.
[Describe test coverage new/current, TreeHerder]:
This is very hard to repro, even on ASAN.
[Risks and why]:
Extremely low, just moving a set/unset under the protection of a lock that is already being acquired.
[String/UUID change made/needed]:
None.
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Probably pretty tough. Catching this required lots of tries on ASAN, since the window is so narrow. It also doesn't show up on crash-stats.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
A careful observer could work out that we were moving modifications to |cur\_it| somewhere it would be protected by a lock, and dxr would make it fairly easy to identify places where |cur\_it| might be accessed.
Which older supported branches are affected by this flaw?
All.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
I expect the patch to apply cleanly.
How likely is this patch to cause regressions; how much testing does it need?
Pretty unlikely.
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: sec-approval?
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-beta?
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-aurora?

|  | [Jason Duell](/user_profile?user_id=334931) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a353604_334931)• 8 years ago |

[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: review+

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1293347#c16)• 8 years ago |
|  | |

Committed upstream:
<https://github.com/sctplab/usrsctp/commit/fb26455c2d56cd5f74c891c586b9ee2398188b8a>

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1293347#c17)• 8 years ago |
|  | |

Note: since the patch is committed upstream, I think we should not delay landing this.

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1293347#c18)• 8 years ago |
|  | |

Sec-approval+. We'll want branch patches, including ESR45, made and nominated.
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1293347#c19)• 8 years ago |
|  | |

Comment on [attachment 8780136](/attachment.cgi?id=8780136 "Move the set/unset of |cur_it| to a better place") [[details]](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") [[diff]](/attachment.cgi?id=8780136&action=diff "Move the set/unset of |cur_it| to a better place") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8780136)
Move the set/unset of |cur\_it| to a better place
Ah, I see the branch approvals now. I'll plus them. We will still need ESR45.
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: sec-approval?
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: sec-approval+
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-beta?
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-beta+
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-aurora?
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-aurora+

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1293347#c20)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/f4cd5568389b>

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1293347#c21)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/f2842fbb9b28>
<https://hg.mozilla.org/releases/mozilla-beta/rev/f3e74826733d>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1293347#c22)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/f4cd5568389b>
Looks like this is missing an esr45 nomination still.Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla51

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411)  Assignee |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1293347#c23)• 8 years ago |
|  | |

Comment on [attachment 8780136](/attachment.cgi?id=8780136 "Move the set/unset of |cur_it| to a better place") [[details]](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") [[diff]](/attachment.cgi?id=8780136&action=diff "Move the set/unset of |cur_it| to a better place") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1293347&attachment=8780136)
Move the set/unset of |cur\_it| to a better place
Sure, why not. See other approval requests.
[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-esr45?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a1303395_280903)• 8 years ago |

[Attachment #8780136](/attachment.cgi?id=8780136&action=edit "Move the set/unset of |cur_it| to a better place") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1293347#c24)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/3e37ba5e0867>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a2070891_1689)• 8 years ago |

Group: media-core-security → core-security-release

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a2472000_452604)• 8 years ago |

Flags: qe-verify-

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a2527321_280903)• 8 years ago |

Whiteboard: [adv-main49+][adv-esr45.4+]

|  | [Looben Yang](/user_profile?user_id=506912) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1293347#c26)• 8 years ago |
|  | |

(In reply to Byron Campen [:bwc] from [comment #0](/show_bug.cgi?id=1293347#c0 "RESOLVED FIXED - UAF in sctp_iterator_inp_being_freed"))
> When running the test case from [bug 1291244](/show_bug.cgi?id=1291244 "RESOLVED DUPLICATE - WebRtc - Memory corruption in nr_socket_sendto()") on linux ASAN, I observed a UAF
> crash. At first glance it looks like a threadsafety problem.
Looks like there is some miscommunication here.
Someone used my test case to open a new bug and then you guys marked my bug as duplicate:
[https://bugzilla.mozilla.org/show\_bug.cgi?id=1300716#c22](/show_bug.cgi?id=1300716#c22 "RESOLVED DUPLICATE - WebRtc - Memory corruption in webrtc::ThreadWindows::Run()")
Would you consider a bounty for it?Flags: needinfo?(dveditz)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1293347#c27)• 8 years ago |
|  | |

I nominated this bug for a bounty to trigger a re-evaluation, but I suspect that this will be considered part of the [bug 1291244](/show_bug.cgi?id=1291244 "RESOLVED DUPLICATE - WebRtc - Memory corruption in nr_socket_sendto()") investigation for which you were already awarded a bounty (the "someone" who opened this bug was the guy fixing that one).Flags: needinfo?(dveditz) → sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a15977606_1689)• 8 years ago |

Group: core-security-release

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1293347#c28)• 8 years ago |
|  | |

The bounty committee agrees: this fix was part of the due dilligence from fixing [bug 1291244](/show_bug.cgi?id=1291244 "RESOLVED DUPLICATE - WebRtc - Memory corruption in nr_socket_sendto()"), split into a separate bug to keep the comment history sane.Flags: sec-bounty? → sec-bounty-

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1293347#a246407860_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1293347&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Byron Campen [:bwc]](/user_profile?user_id=478411)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.redhat.com_4091e041_20250126_122138.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from access.redhat.com_f3632052_20250126_122131.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)

  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Product Documentation](https://access.redhat.com/documentation)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)

  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform)
  [All Product Docs](//docs.redhat.com/en/products/)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)

  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Classifications](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Severety Ratings](https://access.redhat.com/security/security-updates/#/cve)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)

  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

 Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

# Severity ratings

## Understanding Red Hat security ratings

Red Hat Product Security rates the severity of security issues found
in Red Hat products using a four-point scale (Low, Moderate,
Important, and Critical), as well as including a separate Common
Vulnerability Scoring System (CVSS) base score. These scoring systems
provide a prioritized risk assessment to help you understand and
schedule upgrades to your systems, enabling informed decisions on the
risk each issue places on your unique environment.

The four-point scale tells you how serious Red Hat considers an issue
to be, helping you judge the severity and determine the most important
updates. The scale takes into account the potential risk based on a technical analysis of the exact flaw and its type. The risk level of a flaw does not change if an exploit or worm is later released for a flaw, or if one is available before the release of a fix. A flaw will only be re-evaluated if new technical details emerge.

The following table provides severity ratings for Red Hat products and systems. For flaws specific to AI models, see [Red Hat security ratings for AI models](https://access.redhat.com/security/ai).

| **Severity ratings** | **Security flaw description** |
| --- | --- |
| **Critical impact** | This rating is given to flaws that could be easily exploited by a remote unauthenticated attacker and lead to system compromise (arbitrary code execution) without requiring user interaction, or easily cause system compromise via inference end points on AI systems. Flaws that require authentication, local or physical access to a system, or an unlikely configuration are not classified as Critical impact. These are the types of vulnerabilities that can be exploited by worms. |
| **Important impact** | This rating is given to flaws that can easily compromise the confidentiality, integrity or availability of resources. These are the types of vulnerabilities that allow local or authenticated users to gain additional privileges, allow unauthenticated remote users to view resources that should otherwise be protected by authentication or other controls, allow authenticated remote users to execute arbitrary code, allow remote users to cause a denial of service, or can cause system compromise via inference end points on AI systems. |
| **Moderate impact** | This rating is given to flaws that may be more difficult to exploit but could still lead to some compromise of the confidentiality, integrity or availability of resources under certain circumstances. It is also given to flaws that could be exploited to cause denial of service-like conditions on AI systems via an inference end point, or allow attackers to steal other users’ data from the AI system without authorization. These are the types of vulnerabilities that could have had a Critical or Important impact but are less easily exploited based on a technical evaluation of the flaw and/or affect unlikely configurations. || **Low impact** | This rating is given to all other issues that may have a security impact. These are the types of vulnerabilities that are believed to require unlikely circumstances to be able to be exploited, or where a successful exploit would give minimal consequences. This includes flaws that are present in a program’s source code but to which no current or theoretically possible, but unproven, exploitation vectors exist or were found during the technical analysis of the flaw. |

A Red Hat security advisory can contain fixes for more than one
vulnerability and for packages for more than one product (such as both
Red Hat Enterprise Linux 7 and 8). Each issue in an advisory has a
severity rating for each product. The overall severity of an advisory
is the highest severity out of all the individual issues, across all
the products the advisory targets. For simplicity, advisories only
show the overall severity. The advisories contain links to the
relevant entries in Red Hat's bug-tracking system, where you can
examine individual severity ratings and additional commentary, as well
as links to the relevant pages in Red Hat’s CVE database.

When a technology—enabled and most likely used by default—completely
blocks the exploitation of a particular vulnerability across all
architectures, we will adjust the severity level. When a technology
reduces the risk of a vulnerability, we may adjust the severity level
and give an explanation of the decision in the bug-tracking  and CVE
database entries.

## Common Vulnerability Scoring System (CVSS)

Common Vulnerability Scoring System (CVSS) base scores provide
additional guidance about a vulnerability, giving a detailed severity
rating by scoring the constant aspects of a vulnerability: Attack
Vector, Attack Complexity, User Interaction, Privileges Required,
Scope, Confidentiality, Integrity, and Availability.

CVSS version 2 base metrics are available for all vulnerabilities from
2009-2016, as well as selected earlier vulnerabilities. In 2016, Red
Hat adopted the CVSS v3 standard, and all vulnerabilities going
forward will use version 3.1 for scoring. These scores are found on
the
[CVE pages](https://access.redhat.com/security/security-updates/#/cve)
(linked from the References section of each Red Hat Security Advisory).

Red Hat does not solely use the CVSS rating to determine the priority
with which flaws are fixed, or to determine the severity rating of the
vulnerability. It is used as a guideline to identify and describe key
metrics of a flaw, however the priority for which flaws are fixed is
determined by the overall severity of the flaw using the
aforementioned four-point scale.  CVSS is meant to help customers
prioritize the order in which they remediate flaws.

### CVSS v3 Base Metrics

The CVSS v3 base metrics group covers the constant aspects of a
vulnerability:

* Attack Vector (AV) - Expresses the "remoteness" of the attack and
  how the vulnerability is exploited.
* Attack Complexity (AC) - Speaks to the difficulty of executing an
  attack and what factors are needed for it to be successful. (Along
  with User Interaction, Attack Complexity was formerly part of the
  Access Complexity metric.).
* User Interaction (UI) - Determines whether the attack requires an
  active human to participate or if the attack can be automated.
* Privileges Required (PR) - Documents the level of user
  authentication required for the attack to be successful. (This
  replaces the former Authentication metric.).
* Scope (S) - Determines whether an attacker can impact a component
  beyond its security scope/authority.
* Confidentiality (C) - Determines whether unauthorized parties can
  access data and to what extent.
* Integrity (I) - Measures the impact to the trustworthiness and
  veracity of data.
* Availability (A) - Refers to the impact to accessibility of data or
  services for authorized users.

A formula translates these measurements into a single, numerical base
score, ranging from 0.0 (no risk) to 10.0 (highest risk). Refer to
[Common Vulnerability Scoring System v3.1: User Guide](https://www.first.org/cvss/user-guide)
for detailed descriptions of the base metrics. It is important to note
that the CVSS base metrics were designed to be used with the other
CVSS metric groups, notably the Temporal and Environmental metrics, to
provide an accurate representation of risk in customer environments.
Alone, the Base metrics offer a shallow view of the vulnerability
itself without accounting for deployment or the environment.

### How Red Hat Uses CVSS v3 Base Metrics

We aim to comply with the CVSS v3 standard when assigning base scores,
and Red Hat uses base metrics that reflect how a vulnerability affects
our products specifically.  In addition, we do not use the Qualitative
Severity Rating Scale in the CVSS v3.1 User Guide to rate severity,
and our severity ratings are always based on the aforementioned
four-point scale.  In some circumstances, it may not be obvious why a
flaw received a particular score. The following are some common
vulnerability types with our interpretation and typical scoring:

#### Libraries

It is not always possible to know how third-party applications use
libraries, making it difficult to give accurate CVSS v3 base metrics
for flaws in system libraries. When rating these flaws, we take into
account the way the library is used by applications that we ship, and
also look at other popular software that may use the library in a way
that would cause an issue to be of higher severity, and adjust the
score appropriately.

#### Other Common Scores

Flaws where a local, unprivileged user can cause a kernel to crash
(denial of service) typically score 5.5 (for example,
[CVE-2019-9213](https://access.redhat.com/security/cve/CVE-2019-9213)).

Flaws that allow a local, unprivileged user to escalate their
privileges to root typically score 7.8 (for example,
[CVE-2019-18634](https://access.redhat.com/security/cve/CVE-2019-18634)).

Cross-site scripting flaws are generally scored as having Low impact
to Integrity and/or Confidentiality, with no impact to Availability,
in line with scoring from other vendors and NVD. A typical score for
these flaws is 6.1 (for example,
[CVE-2020-11023](https://access.redhat.com/security/cve/CVE-2020-11023)).

### Base Score Variations Across Products

It is common for a given CVE-named vulnerability to have several
different CVSS base metrics, depending on the product, version, and
architecture. Examples of this include:

* A vulnerability that only affected some architectures. For example,
  [CVE-2019-15031](https://access.redhat.com/security/cve/CVE-2019-15031)
  only affected PowerPC.
* A vulnerability that is mitigated by source code protection
  mechanisms on some platforms. For example,
  [CVE-2018-1125](https://access.redhat.com/security/cve/CVE-2018-1125)
  could have led to arbitrary code execution on Red Hat Enterprise
  Linux, but it is only a denial of service because it was compiled
  with FORTIFY protections.
* A vulnerability that affected more than one product.  For example,
  [CVE-2020-14060](https://access.redhat.com/security/cve/CVE-2020-14060)
  affected a component in both OpenShift and OpenStack.  The severity
  to OpenStack was lower (Low) as compared to OpenShift (Moderate)
  based on its usage; the overall vulnerability itself was rated
  Important.

If CVSS v3 base scores are significantly different across products, we
note that separately wherever possible. If we do not split the score,
we report the metric that gives the highest CVSS v3 base score (the
worst-case outcome).

### Differences Between NVD and Red Hat Scores

For open source software shipped by multiple vendors, the CVSS base
scores may vary for each vendor's version, depending on the version
they ship, how they ship it, the platform, and even how the software
is compiled. This makes scoring vulnerabilities difficult for
third-party vulnerability databases, such as NVD, who can give only a
single CVSS base score to each vulnerability, or when comparing to
other vendors who score based on the characteristics of use in their
own products. See the
[National Vulnerability Database](https://nvd.nist.gov/vuln-metrics/cvss)
for more information regarding NVD security ratings.

These differences can cause the scores to vary widely. Other reasons
may include how the source code was compiled with certain compiler
flags or hardening technologies that reduce or eliminate the security
severity of a flaw, or how the software is used within the product.
Software running standalone may suffer from a flaw, but its use within
a product may preclude the vulnerable code from ever being used in a
way that could be exploited.

For example, NVD may rate a flaw in a particular service as having
High Impact on the CVSS CIA Triad (Confidentiality, Integrity,
Availability) where the service in question is typically run as the
root user with full privileges on a system. However, in a Red Hat
product, the service may be specifically configured to run as a
dedicated non-privileged user running entirely in a SELinux sandbox,
greatly reducing the immediate impact from compromise, resulting in
Low impact.

For these reasons, we recommend that, whenever possible, you use a
CVSS base score provided by Red Hat in preference to a score from a
third party. Please
[let us know](https://access.redhat.com/site/security/team/contact/)
if you believe we have given an incorrect CVSS v3 base score for a
particular vulnerability. We are happy to discuss and update if
needed.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com)

### Help

* [Contact Customer Portal](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Systems Status

### About

* [Red Hat Subscription Value](https://access.redhat.com/subscription-value)
* [About Red Hat](https://www.redhat.com/about/)
* [Red Hat Jobs](http://jobs.redhat.com)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

Copyright © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)

×
### Formatting Tips

Here are the common uses of Markdown.

Code blocks
```
~~~
Code surrounded in tildes is easier to read
~~~
```

Links/URLs`[Red Hat Customer Portal](https://access.redhat.com)`

[Learn more](/help/markdown)
Close



=== Content from www.mozilla.org_1b3f088f_20250125_221247.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2016-86

## Security vulnerabilities fixed in Firefox ESR 45.4

Announced
September 20, 2016
Impact
critical
Products
Firefox ESR
Fixed in

* Firefox ESR 45.4

#### [#CVE-2016-5270: Heap-buffer-overflow in nsCaseTransformTextRunFactory::TransformString](#CVE-2016-5270)

Reporter
Atte Kettunen
Impact
high
##### Description

An out-of-bounds write of a boolean value during text conversion with some unicode characters

##### References

* [Bug 1291016](https://bugzilla.mozilla.org/show_bug.cgi?id=1291016)

#### [#CVE-2016-5272: Bad cast in nsImageGeometryMixin](#CVE-2016-5272)

Reporter
Abhishek Arya
Impact
high
##### Description

A bad cast when processing layout with `input` elements can result in a potentially exploitable crash.

##### References

* [Bug 129793](https://bugzilla.mozilla.org/show_bug.cgi?id=129793)

#### [#CVE-2016-5276: Heap-use-after-free in mozilla::a11y::DocAccessible::ProcessInvalidationList](#CVE-2016-5276)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability triggered by setting a `aria-owns` attribute.

##### References

* [Bug 1287721](https://bugzilla.mozilla.org/show_bug.cgi?id=1287721)

#### [#CVE-2016-5274: use-after-free in nsFrameManager::CaptureFrameState](#CVE-2016-5274)

Reporter
Nils
Impact
high
##### Description

A use-after-free issue in web animations during restyling.

##### References

* [Bug 1282076](https://bugzilla.mozilla.org/show_bug.cgi?id=1282076)

#### [#CVE-2016-5277: Heap-use-after-free in nsRefreshDriver::Tick](#CVE-2016-5277)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability with web animations when destroying a timeline.

##### References

* [Bug 1291665](https://bugzilla.mozilla.org/show_bug.cgi?id=1291665)

#### [#CVE-2016-5278: Heap-buffer-overflow in nsBMPEncoder::AddImageFrame](#CVE-2016-5278)

Reporter
Nils
Impact
critical
##### Description

A potentially exploitable crash caused by a buffer overflow while encoding image frames to images.

##### References

* [Bug 1294677](https://bugzilla.mozilla.org/show_bug.cgi?id=1294677)

#### [#CVE-2016-5280: Use-after-free in mozilla::nsTextNodeDirectionalityMap::RemoveElementFromMap](#CVE-2016-5280)

Reporter
Mei Wang
Impact
high
##### Description

Use-after-free vulnerability when changing text direction.

##### References

* [Bug 1289970](https://bugzilla.mozilla.org/show_bug.cgi?id=1289970)

#### [#CVE-2016-5281: use-after-free in DOMSVGLength](#CVE-2016-5281)

Reporter
Brian Carpenter
Impact
high
##### Description

Use-after-free vulnerability when manipulating SVG format content through script.

##### References

* [Bug 1284690](https://bugzilla.mozilla.org/show_bug.cgi?id=1284690)

#### [#CVE-2016-5284: Add-on update site certificate pin expiration](#CVE-2016-5284)

Reporter
Multiple people
Impact
high
##### Description

Due to [flaws in the process we used to update "Preloaded Public Key Pinning"](https://blog.mozilla.org/security/2016/09/16/update-on-add-on-pinning-vulnerability/) in our releases, the pinning for add-on updates became ineffective in early September. An attacker who was able to get a mis-issued certificate for a Mozilla web site could send malicious add-on updates to users on networks controlled by the attacker. Users who have not installed any add-ons are not affected.

##### References

* [1303127](https://bugzilla.mozilla.org/show_bug.cgi?id=1303127)

#### [#CVE-2016-5250: Timing API is storing resources sent by the previous page](#CVE-2016-5250)

Reporter
Catalin Dumitru
Impact
moderate
##### Description

URLs of resources loaded after a navigation started can leak to the following page through the Resource Timing API, leading to potential information disclosure.

##### References

* [Bug 1254688](https://bugzilla.mozilla.org/show_bug.cgi?id=1254688)

#### [#CVE-2016-5261: Integer overflow and memory corruption in WebSocketChannel](#CVE-2016-5261)

Reporter
Samuel Groß
Impact
high
##### Description

An integer overflow error in WebSockets during data buffering on incoming packets resulting in attacker controlled data being written at a known offset in the allocated buffer.

##### References

* [Bug 1287266](https://bugzilla.mozilla.org/show_bug.cgi?id=1287266)

#### [#CVE-2016-5257: Memory safety bugs fixed in Firefox 49 and Firefox ESR 45.4](#CVE-2016-5257)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, and Carsten Book reported memory safety bugs present in Firefox 48 and Firefox ESR 45.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort at least some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 49 and Firefox ESR 45.4](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1288588%2C1287204%2C1294407%2C1293347%2C1288780%2C1288555%2C1289280%2C1294095%2C1277213)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from www.oracle.com_72083f0a_20250125_221222.html ===


* [Skip to content](#maincontent)
* [Accessibility Policy](https://www.oracle.com/corporate/accessibility/)

Products
Industries
Resources
Customers
Partners
Developers
Company

Close Search

Search Oracle.com

* QUICK LINKS
* [Oracle Cloud Infrastructure](/cloud/)
* [Oracle Fusion Cloud Applications](/applications/)
* [Oracle Database](/database/technologies/)
* [Download Java](/java/technologies/downloads/)
* [Careers at Oracle](/careers/)

Search

[Country
![]()](/countries-list.html#countries)

View Accounts

Back
Cloud Account
[Sign in to Cloud](/cloud/sign-in.html)
[Sign Up for Free Cloud Tier](/cloud/free/)

Oracle Account

* [Sign-In](https://www.oracle.com/webapps/redirect/signon?nexturl=)
* [Create an Account](https://profile.oracle.com/myprofile/account/create-account.jspx)

* [Help](/corporate/contact/help.html)
* Sign Out

[Contact Sales](/corporate/contact/ "Contact Sales")

[Menu

Menu](/global-menu-v2/)

* [Security Alerts](/security-alerts/)

# Oracle Linux Bulletin - October 2016

## Oracle Linux Bulletin - October 2016

### Description

The Oracle Linux Bulletin lists all CVEs that had been resolved and announced in Oracle Linux Security Advisories (ELSA) in the last one month prior to the release of the bulletin. Oracle Linux Bulletins are published on the same day as Oracle Critical Patch Updates are released. These bulletins will also be updated for the following two months after their release (i.e., the two months between the normal quarterly Critical Patch Update publication dates) to cover all CVEs that had been resolved in those two months following the bulletin's publication. In addition, Oracle Linux Bulletins may also be updated for vulnerability fixes deemed too critical to wait for the next scheduled bulletin publication date.

**Due to the threat posed by a successful attack, Oracle strongly recommends that customers apply Oracle Linux Bulletin fixes as soon as possible.**

### Patch Availability

Please see ULN Advisory [http://linux.oracle.com/ol-pad-bulletin](//linux.oracle.com/ol-pad-bulletin)

### Oracle Linux Bulletin Schedule

Oracle Linux Bulletins are released on the Tuesday closest to the 17th day of January, April, July and October. The next four dates are:

* 17 January 2017
* 18 April 2017
* 18 July 2017
* 17 October 2017

### References

* Oracle Critical Patch Updates and Security Alerts main page  [ [Oracle Technology Network](/security-alerts/) ]
* CVRF XML version of the risk matrix   [ [Oracle Technology Network](https://www.oracle.com/ocom/groups/public/%40otn/documents/webcontent/3090558.xml) ]
* Oracle Critical Patch Updates and Security Alerts - Frequently Asked Questions [ [CPU FAQ](/security-alerts/cpufaq.html) ]
* Risk Matrix definitions   [ [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html) ]
* Use of Common Vulnerability Scoring System (CVSS) by Oracle   [ [Oracle CVSS Scoring](/security-alerts/cvssscoringsystem.html) ]

### Modification History

| 2016-December-19 | Rev 3. New CVEs added. |
| --- | --- |
| 2016-November-18 | Rev 2. New CVEs added. |
| 2016-October-18 | Rev 1. Initial Release |

### Oracle Linux Executive Summary

This Oracle Linux Bulletin contains 181 new security fixes for the Oracle Linux. 96 of these vulnerabilities may be remotely exploitable without authentication, i.e., may be exploited over a network without the need for a username and password.

### Oracle Linux Risk Matrix

#### Revision 3: Published on 2016-12-19

| CVE# | Product | Component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-4794 | Oracle Linux | Unbreakable Enterprise kernel | No | 7.2 | Local | Low | None | Complete | Complete | Complete | 6,7 |
| CVE-2016-9555 | Oracle Linux | Unbreakable Enterprise kernel | Yes | 7.1 | Network | Medium | None | None | None | Complete | 6,7 |
| CVE-2016-9555 | Oracle Linux | Unbreakable Enterprise kernel | Yes | 7.1 | Network | Medium | None | None | None | Complete | 5,6 |
| CVE-2016-1583 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6,7 |
| CVE-2016-1583 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 5,6 |
| CVE-2016-0718 | Oracle Linux | expat | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-9079 | Oracle Linux | firefox | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-9893 | Oracle Linux | firefox | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-9899 | Oracle Linux | firefox | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-8704 | Oracle Linux | memcached | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-8705 | Oracle Linux | memcached | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-8706 | Oracle Linux | memcached | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2016-5290 | Oracle Linux | thunderbird | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-9079 | Oracle Linux | thunderbird | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-7032 | Oracle Linux | sudo | No | 6.6 | Local | Medium | Single | Complete | Complete | Complete | 6,7 |
| CVE-2016-7076 | Oracle Linux | sudo | No | 6.6 | Local | Medium | Single | Complete | Complete | Complete | 6,7 |
| CVE-2016-8638 | Oracle Linux | ipsilon | Yes | 6.4 | Network | Low | None | Partial | None | Partial | 7 |
| CVE-2015-8956 | Oracle Linux | Unbreakable Enterprise kernel | No | 5.4 | Local | Medium | None | Partial | None | Complete | 6,7 |
| CVE-2015-8956 | Oracle Linux | Unbreakable Enterprise kernel | No | 5.4 | Local | Medium | None | Partial | None | Complete | 5,6 |
| CVE-2016-9897 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-9898 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-9905 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-8650 | Oracle Linux | Unbreakable Enterprise kernel | No | 4.9 | Local | Low | None | None | None | Complete | 6,7 |
| CVE-2016-3070 | Oracle Linux | Unbreakable Enterprise kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 6,7 |
| CVE-2016-6480 | Oracle Linux | Unbreakable Enterprise kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 6,7 |
| CVE-2016-3070 | Oracle Linux | Unbreakable Enterprise kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 5,6 |
| CVE-2016-6480 | Oracle Linux | Unbreakable Enterprise kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 5,6 |
| CVE-2016-2053 | Oracle Linux | Unbreakable Enterprise kernel | No | 4.6 | Local | Low | Single | None | None | Complete | 6,7 |
| CVE-2016-9895 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | None | Partial | None | 5,6,7 |
| CVE-2016-9900 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2016-9901 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2016-9902 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2016-9904 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2016-3699 | Oracle Linux | Unbreakable Enterprise kernel | No | 3.3 | Local | Medium | None | None | Partial | Partial | 6,7 |
| CVE-2016-6136 | Oracle Linux | Unbreakable Enterprise kernel | No | 3.3 | Local | Medium | None | Partial | None | Partial | 6,7 |
| CVE-2016-6136 | Oracle Linux | Unbreakable Enterprise kernel | No | 3.3 | Local | Medium | None | Partial | None | Partial | 5,6 |
| CVE-2016-4569 | Oracle Linux | Unbreakable Enterprise kernel | No | 2.1 | Local | Low | None | Partial | None | None | 6,7 |
| CVE-2016-4578 | Oracle Linux | Unbreakable Enterprise kernel | No | 2.1 | Local | Low | None | Partial | None | None | 6,7 |
| CVE-2016-4569 | Oracle Linux | Unbreakable Enterprise kernel | No | 2.1 | Local | Low | None | Partial | None | None | 5,6 |
| CVE-2016-4578 | Oracle Linux | Unbreakable Enterprise kernel | No | 2.1 | Local | Low | None | Partial | None | None | 5,6 |

#### Revision 2: Published on 2016-11-18

| CVE# | Product | Component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-4794 | Oracle Linux | kernel | No | 7.2 | Local | Low | None | Complete | Complete | Complete | 7 |
| CVE-2016-6662 | Oracle Linux | mariadb | No | 7.1 | Network | High | Single | Complete | Complete | Complete | 7 |
| CVE-2016-1583 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6,7 |
| CVE-2016-5195 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6,7 |
| CVE-2016-1583 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 5,6 |
| CVE-2016-5195 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 5 |
| CVE-2016-5195 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6,7 |
| CVE-2015-8812 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 7 |
| CVE-2016-3841 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 7 |
| CVE-2016-5829 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 7 |
| CVE-2016-5195 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 5,6 |
| CVE-2016-5290 | Oracle Linux | firefox | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5296 | Oracle Linux | firefox | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5582 | Oracle Linux | java-1.7.0-openjdk | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5582 | Oracle Linux | java-1.8.0-openjdk | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-7545 | Oracle Linux | policycoreutils | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-7050 | Oracle Linux | resteasy-base | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2016-0714 | Oracle Linux | tomcat | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2016-4971 | Oracle Linux | wget | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2016-5423 | Oracle Linux | postgresql | No | 6.5 | Network | Low | Single | Partial | Partial | Partial | 7 |
| CVE-2016-2143 | Oracle Linux | kernel | No | 6.2 | Local | High | None | Complete | Complete | Complete | 6 |
| CVE-2016-2384 | Oracle Linux | kernel | No | 6.2 | Local | High | None | Complete | Complete | Complete | 7 |
| CVE-2015-8325 | Oracle Linux | openssh | No | 6.2 | Local | High | None | Complete | Complete | Complete | 7 |
| CVE-2016-5424 | Oracle Linux | postgresql | No | 6.0 | Network | Medium | Single | Partial | Partial | Partial | 7 |
| CVE-2016-5419 | Oracle Linux | curl | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 7 |
| CVE-2015-8803 | Oracle Linux | nettle | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 7 |
| CVE-2015-8804 | Oracle Linux | nettle | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 7 |
| CVE-2015-8805 | Oracle Linux | nettle | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 7 |
| CVE-2016-6489 | Oracle Linux | nettle | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 7 |
| CVE-2015-7979 | Oracle Linux | ntp | Yes | 5.8 | Network | Medium | None | None | Partial | Partial | 7 |
| CVE-2016-7795 | Oracle Linux | systemd | No | 5.6 | Local | Low | None | None | Partial | Complete | 7 |
| CVE-2015-8956 | Oracle Linux | kernel | No | 5.4 | Local | Medium | None | Partial | None | Complete | 7 |
| CVE-2016-5297 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-9066 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5573 | Oracle Linux | java-1.7.0-openjdk | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5573 | Oracle Linux | java-1.8.0-openjdk | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 6,7 |
| CVE-2016-5008 | Oracle Linux | libvirt | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 7 |
| CVE-2016-2834 | Oracle Linux | nss and nss-util | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5399 | Oracle Linux | php | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 7 |
| CVE-2016-5766 | Oracle Linux | php | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 7 |
| CVE-2016-5767 | Oracle Linux | php | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 7 |
| CVE-2015-8868 | Oracle Linux | poppler | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 7 |
| CVE-2016-5416 | Oracle Linux | 389-ds-base | Yes | 5.0 | Network | Low | None | Partial | None | None | 6,7 |
| CVE-2016-2848 | Oracle Linux | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 5,6 |
| CVE-2016-8864 | Oracle Linux | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 5,6,7 |
| CVE-2016-2848 | Oracle Linux | bind97 | Yes | 5.0 | Network | Low | None | None | None | Partial | 5 |
| CVE-2016-8864 | Oracle Linux | bind97 | Yes | 5.0 | Network | Low | None | None | None | Partial | 5 |
| CVE-2016-5361 | Oracle Linux | libreswan | Yes | 5.0 | Network | Low | None | None | None | Partial | 7 |
| CVE-2016-2569 | Oracle Linux | squid | Yes | 5.0 | Network | Low | None | None | None | Partial | 7 |
| CVE-2016-2570 | Oracle Linux | squid | Yes | 5.0 | Network | Low | None | None | None | Partial | 7 |
| CVE-2016-2571 | Oracle Linux | squid | Yes | 5.0 | Network | Low | None | None | None | Partial | 7 |
| CVE-2016-2572 | Oracle Linux | squid | Yes | 5.0 | Network | Low | None | None | None | Partial | 7 |
| CVE-2016-3948 | Oracle Linux | squid | Yes | 5.0 | Network | Low | None | None | None | Partial | 7 |
| CVE-2015-5345 | Oracle Linux | tomcat | Yes | 5.0 | Network | Low | None | Partial | None | None | 7 |
| CVE-2016-5420 | Oracle Linux | curl | No | 4.9 | Network | Medium | Single | Partial | Partial | None | 7 |
| CVE-2016-7141 | Oracle Linux | curl | No | 4.9 | Network | Medium | Single | Partial | Partial | None | 7 |
| CVE-2013-4312 | Oracle Linux | kernel | No | 4.9 | Local | Low | None | None | None | Complete | 7 |
| CVE-2016-2847 | Oracle Linux | kernel | No | 4.9 | Local | Low | None | None | None | Complete | 7 |
| CVE-2015-5313 | Oracle Linux | libvirt | No | 4.9 | Network | High | Single | None | Complete | None | 7 |
| CVE-2016-5011 | Oracle Linux | util-linux | No | 4.9 | Local | Low | None | None | None | Complete | 7 |
| CVE-2016-3070 | Oracle Linux | kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 7 |
| CVE-2016-4581 | Oracle Linux | kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 7 |
| CVE-2016-6198 | Oracle Linux | kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 7 |
| CVE-2016-6327 | Oracle Linux | kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 7 |
| CVE-2016-6480 | Oracle Linux | kernel | No | 4.7 | Local | Medium | None | None | None | Complete | 7 |
| CVE-2015-8543 | Oracle Linux | kernel | No | 4.6 | Local | Low | Single | None | None | Complete | 7 |
| CVE-2016-2053 | Oracle Linux | kernel | No | 4.6 | Local | Low | Single | None | None | Complete | 7 |
| CVE-2016-5410 | Oracle Linux | firewalld | No | 4.4 | Local | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2015-8844 | Oracle Linux | kernel | No | 4.4 | Local | Medium | Single | None | None | Complete | 7 |
| CVE-2015-8845 | Oracle Linux | kernel | No | 4.4 | Local | Medium | Single | None | None | Complete | 7 |
| CVE-2015-8869 | Oracle Linux | libguestfs and virt-p2v | No | 4.4 | Local | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2016-5636 | Oracle Linux | python | No | 4.4 | Local | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2015-5351 | Oracle Linux | tomcat | No | 4.4 | Local | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2016-5291 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | None | Partial | None | 5,6,7 |
| CVE-2016-9064 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2016-5554 | Oracle Linux | java-1.7.0-openjdk | Yes | 4.3 | Network | Medium | None | None | Partial | None | 5,6,7 |
| CVE-2016-5554 | Oracle Linux | java-1.8.0-openjdk | Yes | 4.3 | Network | Medium | None | None | Partial | None | 6,7 |
| CVE-2016-5412 | Oracle Linux | kernel | No | 4.3 | Adjacent network | High | Single | None | None | Complete | 7 |
| CVE-2016-5285 | Oracle Linux | nss and nss-util | Yes | 4.3 | Network | Medium | None | None | None | Partial | 5,6,7 |
| CVE-2016-8635 | Oracle Linux | nss and nss-util | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2015-7701 | Oracle Linux | ntp | Yes | 4.3 | Network | Medium | None | None | None | Partial | 7 |
| CVE-2015-7852 | Oracle Linux | ntp | Yes | 4.3 | Network | Medium | None | None | None | Partial | 7 |
| CVE-2015-7977 | Oracle Linux | ntp | Yes | 4.3 | Network | Medium | None | None | None | Partial | 7 |
| CVE-2015-7978 | Oracle Linux | ntp | Yes | 4.3 | Network | Medium | None | None | None | Partial | 7 |
| CVE-2015-8158 | Oracle Linux | ntp | Yes | 4.3 | Network | Medium | None | None | None | Partial | 7 |
| CVE-2016-0763 | Oracle Linux | tomcat | No | 4.3 | Adjacent network | Medium | None | Partial | Partial | None | 7 |
| CVE-2016-3092 | Oracle Linux | tomcat | Yes | 4.3 | Network | Medium | None | None | None | Partial | 7 |
| CVE-2016-5828 | Oracle Linux | kernel | No | 4.0 | Local | High | None | None | None | Complete | 7 |
| CVE-2016-6313 | Oracle Linux | libgcrypt | Yes | 4.0 | Network | High | None | Partial | Partial | None | 6,7 |
| CVE-2016-3492 | Oracle Linux | mariadb | No | 4.0 | Network | Low | Single | None | None | Partial | 7 |
| CVE-2016-5612 | Oracle Linux | mariadb | No | 4.0 | Network | Low | Single | None | None | Partial | 7 |
| CVE-2016-5624 | Oracle Linux | mariadb | No | 4.0 | Network | Low | Single | None | None | Partial | 7 |
| CVE-2016-5626 | Oracle Linux | mariadb | No | 4.0 | Network | Low | Single | None | None | Partial | 7 |
| CVE-2016-5629 | Oracle Linux | mariadb | No | 4.0 | Network | Low | Single | None | None | Partial | 7 |
| CVE-2016-8283 | Oracle Linux | mariadb | No | 4.0 | Network | Low | Single | None | None | Partial | 7 |
| CVE-2015-5194 | Oracle Linux | ntp | No | 4.0 | Network | Low | Single | None | Partial | None | 7 |
| CVE-2015-5195 | Oracle Linux | ntp | No | 4.0 | Network | Low | Single | None | Partial | None | 7 |
| CVE-2015-5196 | Oracle Linux | ntp | No | 4.0 | Network | Low | Single | None | Partial | None | 7 |
| CVE-2015-7691 | Oracle Linux | ntp | Yes | 4.0 | Network | High | None | Partial | None | Partial | 7 |
| CVE-2015-7692 | Oracle Linux | ntp | Yes | 4.0 | Network | High | None | Partial | None | Partial | 7 |
| CVE-2015-7702 | Oracle Linux | ntp | Yes | 4.0 | Network | High | None | Partial | None | Partial | 7 |
| CVE-2015-7703 | Oracle Linux | ntp | No | 4.0 | Network | Low | Single | None | Partial | None | 7 |
| CVE-2015-5174 | Oracle Linux | tomcat | No | 4.0 | Network | Low | Single | Partial | None | None | 7 |
| CVE-2015-8746 | Oracle Linux | kernel | No | 3.8 | Local | High | Single | None | None | Complete | 7 |
| CVE-2016-3712 | Oracle Linux | qemu-kvm | No | 3.8 | Adjacent network | Medium | Single | Partial | None | Partial | 7 |
| CVE-2016-5384 | Oracle Linux | fontconfig | No | 3.7 | Local | High | None | Partial | Partial | Partial | 7 |
| CVE-2016-3075 | Oracle Linux | glibc | No | 3.7 | Local | High | None | Partial | Partial | Partial | 7 |
| CVE-2016-2069 | Oracle Linux | kernel | No | 3.7 | Local | High | None | Partial | Partial | Partial | 7 |
| CVE-2015-7974 | Oracle Linux | ntp | No | 3.6 | Network | High | Single | None | Partial | Partial | 7 |
| CVE-2016-7091 | Oracle Linux | sudo | No | 3.6 | Local | Low | None | Partial | Partial | None | 7 |
| CVE-2016-4992 | Oracle Linux | 389-ds-base | No | 3.5 | Network | Medium | Single | Partial | None | None | 6,7 |
| CVE-2015-8374 | Oracle Linux | kernel | No | 3.5 | Network | Medium | Single | Partial | None | None | 7 |
| CVE-2016-3120 | Oracle Linux | krb5 | No | 3.5 | Network | Medium | Single | None | None | Partial | 7 |
| CVE-2016-5616 | Oracle Linux | mariadb | No | 3.5 | Local | High | Single | Partial | Partial | Partial | 7 |
| CVE-2016-6663 | Oracle Linux | mariadb | No | 3.5 | Local | High | Single | Partial | Partial | Partial | 7 |
| CVE-2016-3699 | Oracle Linux | kernel | No | 3.3 | Local | Medium | None | None | Partial | Partial | 7 |
| CVE-2016-6136 | Oracle Linux | kernel | No | 3.3 | Local | Medium | None | Partial | None | Partial | 7 |
| CVE-2015-5219 | Oracle Linux | ntp | No | 3.3 | Adjacent network | Low | None | None | None | Partial | 7 |
| CVE-2016-0706 | Oracle Linux | tomcat | No | 2.9 | Adjacent network | Medium | None | Partial | None | None | 7 |
| CVE-2016-5405 | Oracle Linux | 389-ds-base | Yes | 2.6 | Network | High | None | Partial | None | None | 6,7 |
| CVE-2016-2774 | Oracle Linux | dhcp | Yes | 2.6 | Network | High | None | None | None | Partial | 7 |
| CVE-2016-4994 | Oracle Linux | gimp | Yes | 2.6 | Network | High | None | None | None | Partial | 7 |
| CVE-2016-5542 | Oracle Linux | java-1.7.0-openjdk | Yes | 2.6 | Network | High | None | None | Partial | None | 5,6,7 |
| CVE-2016-5597 | Oracle Linux | java-1.7.0-openjdk | Yes | 2.6 | Network | High | None | Partial | None | None | 5,6,7 |
| CVE-2016-5542 | Oracle Linux | java-1.8.0-openjdk | Yes | 2.6 | Network | High | None | None | Partial | None | 6,7 |
| CVE-2016-5597 | Oracle Linux | java-1.8.0-openjdk | Yes | 2.6 | Network | High | None | Partial | None | None | 6,7 |
| CVE-2016-2117 | Oracle Linux | kernel | Yes | 2.6 | Network | High | None | Partial | None | None | 7 |
| CVE-2016-5768 | Oracle Linux | php | Yes | 2.6 | Network | High | None | None | None | Partial | 7 |
| CVE-2016-1981 | Oracle Linux | qemu-kvm | No | 2.3 | Adjacent network | Medium | Single | None | None | Partial | 7 |
| CVE-2016-0764 | Oracle Linux | NetworkManager | No | 2.1 | Local | Low | None | Partial | None | None | 7 |
| CVE-2016-4569 | Oracle Linux | kernel | No | 2.1 | Local | Low | None | Partial | None | None | 7 |
| CVE-2016-4578 | Oracle Linux | kernel | No | 2.1 | Local | Low | None | Partial | None | None | 7 |
| CVE-2016-3119 | Oracle Linux | krb5 | No | 2.1 | Network | High | Single | None | None | Partial | 7 |
| CVE-2015-5160 | Oracle Linux | libvirt | No | 2.1 | Local | Low | None | Partial | None | None | 7 |
| CVE-2016-3099 | Oracle Linux | mod\_nss | No | 1.9 | Local | Medium | None | None | Partial | None | 7 |
| CVE-2016-3156 | Oracle Linux | kernel | No | 1.7 | Local | Low | Single | None | None | Partial | 7 |

#### Revision 1: Published on 2016-10-18

| CVE# | Product | Component | Remote Exploit without Auth.? | CVSS VERSION 2.0 RISK (see [Risk Matrix Definitions](/security-alerts/advisorymatrixglossary.html)) | | | | | | | Supported Versions Affected |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| Base Score | Access Vector | Access Complexity | Authen­tication | Confid­entiality | Inte­grity | Avail­ability |
| CVE-2016-4997 | Oracle Linux | Unbreakable Enterprise kernel | No | 7.2 | Local | Low | None | Complete | Complete | Complete | 6,7 |
| CVE-2016-4997 | Oracle Linux | Unbreakable Enterprise kernel | No | 7.2 | Local | Low | None | Complete | Complete | Complete | 5,6 |
| CVE-2016-7039 | Oracle Linux | Unbreakable Enterprise kernel | Yes | 7.1 | Network | Medium | None | None | None | Complete | 6,7 |
| CVE-2016-7039 | Oracle Linux | kernel | Yes | 7.1 | Network | Medium | None | None | None | Complete | 7 |
| CVE-2016-5829 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6,7 |
| CVE-2016-4470 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6 |
| CVE-2016-5829 | Oracle Linux | kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6 |
| CVE-2016-5425 | Oracle Linux | tomcat | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 7 |
| CVE-2016-6325 | Oracle Linux | tomcat | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 7 |
| CVE-2016-6325 | Oracle Linux | tomcat6 | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 6 |
| CVE-2016-5829 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.9 | Local | Medium | None | Complete | Complete | Complete | 5,6 |
| CVE-2016-5257 | Oracle Linux | firefox | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5278 | Oracle Linux | firefox | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5257 | Oracle Linux | thunderbird | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6,7 |
| CVE-2015-5346 | Oracle Linux | tomcat | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 7 |
| CVE-2016-0714 | Oracle Linux | tomcat6 | Yes | 6.8 | Network | Medium | None | Partial | Partial | Partial | 6 |
| CVE-2016-3710 | Oracle Linux | kvm | No | 6.5 | Adjacent network | High | Single | Complete | Complete | Complete | 5 |
| CVE-2016-3134 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.2 | Local | High | None | Complete | Complete | Complete | 6,7 |
| CVE-2016-3134 | Oracle Linux | Unbreakable Enterprise kernel | No | 6.2 | Local | High | None | Complete | Complete | Complete | 5,6 |
| CVE-2014-7810 | Oracle Linux | tomcat | Yes | 5.8 | Network | Medium | None | Partial | Partial | None | 7 |
| CVE-2016-4998 | Oracle Linux | Unbreakable Enterprise kernel | No | 5.6 | Local | Low | None | Partial | None | Complete | 6,7 |
| CVE-2016-4998 | Oracle Linux | Unbreakable Enterprise kernel | No | 5.6 | Local | Low | None | Partial | None | Complete | 5,6 |
| CVE-2016-5261 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5270 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5272 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5274 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5276 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5277 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5280 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5281 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-5284 | Oracle Linux | firefox | Yes | 5.1 | Network | High | None | Partial | Partial | Partial | 5,6,7 |
| CVE-2016-2776 | Oracle Linux | bind | Yes | 5.0 | Network | Low | None | None | None | Partial | 5,6,7 |
| CVE-2016-2776 | Oracle Linux | bind97 | Yes | 5.0 | Network | Low | None | None | None | Partial | 5 |
| CVE-2016-2179 | Oracle Linux | openssl | Yes | 5.0 | Network | Low | None | None | None | Partial | 6,7 |
| CVE-2016-6304 | Oracle Linux | openssl | Yes | 5.0 | Network | Low | None | None | None | Partial | 6,7 |
| CVE-2016-1000111 | Oracle Linux | python-twisted-web | Yes | 5.0 | Network | Undefined | None | None | None | None | 6 |
| CVE-2015-5345 | Oracle Linux | tomcat6 | Yes | 5.0 | Network | Low | None | Partial | None | None | 6 |
| CVE-2016-5250 | Oracle Linux | firefox | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2016-2181 | Oracle Linux | openssl | Yes | 4.3 | Network | Medium | None | None | None | Partial | 6,7 |
| CVE-2016-2182 | Oracle Linux | openssl | Yes | 4.3 | Network | Medium | None | None | None | Partial | 5,6,7 |
| CVE-2016-2183 | Oracle Linux | openssl | Yes | 4.3 | Network | Medium | None | Partial | None | None | 5 |
| CVE-2016-6302 | Oracle Linux | openssl | Yes | 4.3 | Network | Medium | None | None | None | Partial | 6,7 |
| CVE-2015-5174 | Oracle Linux | tomcat6 | No | 4.0 | Network | Low | Single | Partial | None | None | 6 |
| CVE-2015-8374 | Oracle Linux | Unbreakable Enterprise kernel | No | 3.5 | Network | Medium | Single | Partial | None | None | 5,6 |
| CVE-2016-0706 | Oracle Linux | tomcat6 | No | 2.9 | Adjacent network | Medium | None | Partial | None | None | 6 |
| CVE-2016-2177 | Oracle Linux | openssl | Yes | 2.6 | Network | High | None | None | None | Partial | 5,6,7 |
| CVE-2016-5388 | Oracle Linux | tomcat | Yes | 2.6 | Network | High | None | None | Partial | None | 7 |
| CVE-2016-5388 | Oracle Linux | tomcat6 | Yes | 2.6 | Network | High | None | None | Partial | None | 6 |
| CVE-2016-5403 | Oracle Linux | kvm | No | 2.3 | Adjacent network | Medium | Single | None | None | Partial | 5 |
| CVE-2016-2178 | Oracle Linux | openssl | No | 1.9 | Local | Medium | None | Partial | None | None | 5,6,7 |
| CVE-2016-2180 | Oracle Linux | openssl | No | 1.9 | Local | Medium | None | None | None | Partial | 6,7 |
| CVE-2016-6306 | Oracle Linux | openssl | No | 1.2 | Local | High | None | None | None | Partial | 5,6,7 |

Resources for

* [Careers](/careers/)
* [Developers](/developer/)
* [Investors](https://investor.oracle.com/home/default.aspx)
* [Partners](/partner/)
* [Researchers](/research/)
* [Students and Educators](https://academy.oracle.com/en/oa-web-overview.html)

Why Oracle

* [Analyst Reports](/corporate/analyst-reports/)
* [Best cloud-based
  ERP](/erp/what-is-erp/best-erp/)
* [Cloud Economics](/cloud/economics/)
* [Social Impact](/social-impact/)
* [Culture and Inclusion](/careers/diversity-inclusion/)
* [Security Practices](/corporate/security-practices/)

Learn

* [What is cloud
  computing?](/cloud/what-is-cloud-computing/)
* [What is CRM?](/cx/what-is-crm/)
* [What is
  Docker?](/cloud/cloud-native/container-registry/what-is-docker/)
* [What is
  Kubernetes?](/cloud/cloud-native/kubernetes-engine/what-is-kubernetes/)
* [What is
  Python?](/developer/what-is-python-for-developers/)
* [What is SaaS?](/applications/what-is-saas/)

News and Events

* [News](/news/)
* [Oracle CloudWorld](/cloudworld/)
* [Oracle CloudWorld Tour](/cloudworld-tour/)
* [Oracle Health Summit](/health/health-summit/)
* [Oracle Dev Tour](/developer/dev-tour/)
* [Search all events](https://search.oracle.com/events?q=&lang=english)

Contact Us

* US Sales: +1.800.633.0738
* [How can we help?](/corporate/contact/)
* [Subscribe to emails](https://go.oracle.com/subscribe/?l_code=en&src1=OW:O:FO)
* [Integrity Helpline](https://secure.ethicspoint.com/domain/media/en/gui/31053/index.html)
* [Accessibility](/corporate/accessibility/)

---

* [Country/Region](/universal-menu/#u10countrymenu)

* [© 2025 Oracle](/legal/copyright/)
* [Privacy](/legal/privacy/)/[Do Not Sell My
  Info](/legal/privacy/privacy-choices/)
* [Ad
  Choices](/legal/privacy/privacy-policy/#adchoices)
* [Careers](/corporate/careers/)



=== Content from bugzilla.mozilla.org_a288db3c_20250125_221237.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1294095)
* [XML](/show_bug.cgi?ctype=xml&id=1294095)

Closed
[Bug 1294095](/show_bug.cgi?id=1294095)

Opened 8 years ago
Closed 8 years ago

# Crash in mozilla::DataChannelConnection::SctpDtlsOutput

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Crash in mozilla::DataChannelConnection::SctpDtlsOutput

## Categories

### (Core :: WebRTC: Networking, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=WebRTC%3A%20Networking#WebRTC%3A%20Networking)

WebRTC: Networking
▾

Core :: WebRTC: Networking
Bugs in the networking portions of WebRTC (PeerConnection dataChannels, SCTP, DTLS, SRTP, ICE, TURN, STUN, etc)
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Networking&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=WebRTC%3A%20Networking&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=WebRTC%3A%20Networking)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

49 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

[Rank:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rank)

5

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla51

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=verified) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified) |
| firefox51 | [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 |  | wontfix |
| firefox49 | + | verified |
| firefox-esr45 | 49+ | verified |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | verified |
| firefox51 | + | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: philipp, Assigned: jesup)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/ae002109ba1cfbb7f5ad990cc5d9fbaf?d=mm&size=40)  [jesup](/user_profile?user_id=11539)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/3c7706fb156c53ce5f3aabc0ca897079?d=mm&size=40)  [philipp](/user_profile?user_id=209011)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/3e201149abea356acc9bb6f0eea8b5a0?d=mm&size=40)  [bwc](/user_profile?user_id=478411)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

13 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1311380](/show_bug.cgi?id=1311380 "RESOLVED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput")

Dependency [tree](/showdependencytree.cgi?id=1294095&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1294095)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1290314](/show_bug.cgi?id=1290314 "RESOLVED DUPLICATE - Use-after-free in mozilla::DataChannelConnection::SctpDtlsOutput"), [1294097](/show_bug.cgi?id=1294097 "RESOLVED DUPLICATE - Crash in mozilla::TransportFlow::CheckThreadInt")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: crash, regression, sec-critical, Whiteboard: [adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c57 "8 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

[[@ mozilla::DataChannelConnection::SctpDtlsOutput ]](https://crash-stats.mozilla.org/signature/?signature=mozilla%3A%3ADataChannelConnection%3A%3ASctpDtlsOutput)

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 1 obsolete file)

| [wrap and lock DataChannelConnection for SCTP callbacks](/attachment.cgi?id=8782576)  [8 years ago](#c15)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   9.90 KB, patch | bwc : [feedback-](#c17 "8 years ago") | [Details](/attachment.cgi?id=8782576&action=edit) | [Diff](/attachment.cgi?id=8782576&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782576) |
| --- | --- | --- |
| [wrap and lock DataChannelConnection for SCTP callbacks](/attachment.cgi?id=8782954)  [8 years ago](#c22)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   11.00 KB, patch |  | [Details](/attachment.cgi?id=8782954&action=edit) | [Diff](/attachment.cgi?id=8782954&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782954) |
| [Swap order of notifications on association failure](/attachment.cgi?id=8783983)  [8 years ago](#c48)  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)   2.55 KB, patch | bwc : [review+](#c49 "8 years ago")  abillings : [approval-mozilla-aurora+](#c52 "8 years ago")  abillings : [approval-mozilla-beta+](#c52 "8 years ago")  Sylvestre : [approval-mozilla-esr45+](#a1621108_495955 "8 years ago")  abillings : [sec-approval+](#c52 "8 years ago") | [Details](/attachment.cgi?id=8783983&action=edit) | [Diff](/attachment.cgi?id=8783983&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8783983) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [[:philipp]](/user_profile?user_id=209011)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1294095#c0)• 8 years ago |
|  | |

This bug was filed from the Socorro interface and is
report [bp-c237a768-7c3a-4c28-b18c-ad34f2160810](https://crash-stats.mozilla.org/report/index/c237a768-7c3a-4c28-b18c-ad34f2160810).
=============================================================
Crashing Thread (54)
Frame Module Signature Source
0 xul.dll mozilla::DataChannelConnection::SctpDtlsOutput(void\*, void\*, unsigned int, unsigned char, unsigned char) netwerk/sctp/datachannel/DataChannel.cpp:691
1 xul.dll sctp\_lowlevel\_chunk\_output netwerk/sctp/src/netinet/sctp\_output.c:5010
2 mozglue.dll je\_malloc memory/mozjemalloc/jemalloc.c:6184
3 xul.dll sctp\_abort\_an\_association netwerk/sctp/src/netinet/sctputil.c:4212
4 xul.dll sctp\_threshold\_management netwerk/sctp/src/netinet/sctp\_timer.c:167
5 xul.dll sctp\_t3rxt\_timer netwerk/sctp/src/netinet/sctp\_timer.c:832
6 xul.dll sctp\_timeout\_handler netwerk/sctp/src/netinet/sctputil.c:1706
7 xul.dll sctp\_handle\_tick netwerk/sctp/src/netinet/sctp\_callout.c:155
8 xul.dll user\_sctp\_timer\_iterate netwerk/sctp/src/netinet/sctp\_callout.c:194
9 kernel32.dll BaseThreadInitThunk
10 ntdll.dll \_\_RtlUserThreadStart
11 ntdll.dll \_RtlUserThreadStart
crashes with this signature are regressing in number since the 49 nightly cycle & the signature is currently making up 0.3% of browser crashes in 49.0b1.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1294095#c1)• 8 years ago |
|  | |

e5e5 signature
I wonder if this is another instance of the sctp timer iterator issue? Byron?
I don't see how peer could point to freed memory, or peer->mSTS, while the sctp stack is still open. In DataChannelConnection::Destory() we close() the sctp socket on STS thread (mSTS), and the runnable that does that has a RefPtr to the DataChannelConnection, so we can't free the DataChannelConnection until we've finished the close(). This implies that usrsctp\_close() could leave a dangling timer reference about to fire...Assignee: nobody → rjesupGroup: media-core-securityRank: 5Flags: needinfo?(tuexen)Flags: needinfo?(docfaraday)Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)Priority: -- → P1

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1294095#c2)• 8 years ago |
|  | |

I don't really see how this pointer can go wrong... Are you also tearing down the SCTP stack at the same time?Flags: needinfo?(tuexen)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1294095#c3)• 8 years ago |
|  | |

So we're not calling sctp\_finish until the browser is shutdown, so the timer thread will continue to operate. However, as per above, we are certain that until usrsctp\_close() returns that the pointer will be valid. I would hope we would not get an callback to send a packet (per the stack) after close() returns...

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1294095#c4)• 8 years ago |
|  | |

(In reply to Michael Tüxen from [comment #2](/show_bug.cgi?id=1294095#c2 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> I don't really see how this pointer can go wrong... Are you also tearing
> down the SCTP stack at the same time?
The stack is not being torn down, but we are calling |usrsctp\_deregister\_address| and |usrsctp\_close|. Should that be enough?Flags: needinfo?(docfaraday)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1294095#c5)• 8 years ago |
|  | |

I think so.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1294095#c6)• 8 years ago |
|  | |

(In reply to Byron Campen [:bwc] from [comment #4](/show_bug.cgi?id=1294095#c4 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> (In reply to Michael Tüxen from [comment #2](/show_bug.cgi?id=1294095#c2 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> > I don't really see how this pointer can go wrong... Are you also tearing
> > down the SCTP stack at the same time?
>
> The stack is not being torn down, but we are calling
> |usrsctp\_deregister\_address| and |usrsctp\_close|. Should that be enough?
Note: the order of usrsctp\_deregister\_address and usrsctp\_close() isn't fixed here (and not on the same thread). Could that impact it? We could always call deregister\_address before usrsctp\_close though. Calling it afterwards would be possible; we'd have to pass a refptr to the connection along with the DestroyOnSTS(), and move the deregister into DestroyOnSTS (along with the usrsctp\_close()es).

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1294095#c8)• 8 years ago |
|  | |

When looking at the traces at <https://crash-stats.mozilla.com/signature/?product=Firefox&version=49.0b&signature=mozilla%3A%3ADataChannelConnection%3A%3ASctpDtlsOutput&_columns=date&_columns=product&_columns=version&_columns=build_id&_columns=platform&_columns=reason&_columns=address&_sort=-date&page=1>
it is
\* always Windows as a platform
\* always when a timer (either HEARTBEAT or data retransmission timer) runs off
\* always when this results in aborting the association due to excessive retransmissions.
So how do you think usrsctp\_close() is in the game here?

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1294095#c9)• 8 years ago |
|  | |

A question: When do you call usrsctp\_deregister\_address()? When the Peer connection dies? When it get closed? Do you leave some SCTP associations open?
Based on that I could do some testing with the usrsctp stack using valgrind, that should give a hint if the current code handles the situation well. This wouldn't mean that the code you are using, handles it, but possibly I can identify a bug in the current code...

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1294095#c10)• 8 years ago |
|  | |

So the only way the DataChannelConnection object can be freed is if we go through Destroy() first, which fires off DestroyOnSTS (which does usrsctp\_close()) to the STS thread, then calls deregister\_address (on the main/calling thread). Thus due to thread ordering the DestroyOnSTS may run before or after deregister\_address. I presume the crashes are due to a race between the abort timer going off and the teardown of the peerconnection.
After Destroy() returns, the DataChannelConnection object will be released, which (if that's the last ref) will delete it. (Various things in-flight might hold a ref to the connection, but generally it will be freed on return from Destroy()).
This pattern assumes that after deregister\_address, no callbacks can occur (the DataChannelConnection ptr (raw ptr) is associated with the socket callback). If instead we have to do usrsctp\_close to stop callbacks, or both that and deregister, we could move deregister to before we fire off DestroyOnSTS(), or if deregister must come after the close, move it to DestroyOnSTS and also pass a reference to DataChannelConnection to DestroyOnSTS, so that the connection object can't be deleted until DestroyOnSTS completes.Flags: needinfo?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1294095#c11)• 8 years ago |
|  | |

Let me test a bit...Flags: needinfo?(tuexen)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1294095#c12)• 8 years ago |
|  | |

This signature is still on the rise for 49 beta 2 & 3, though not huge volume. Tracking.
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1294095#c13)• 8 years ago |
|  | |

So, looking through the stuff that |usrsctp\_close| calls, I don't see an |sctp\_timer\_stop| for |SCTP\_TIMER\_TYPE\_SEND|, which is the timer type that is blowing us up here. I only see an |sctp\_timer\_stop| for |SCTP\_TIMER\_TYPE\_NEWCOOKIE|. Is there something else that |usrsctp\_close| does that ought to be stopping (or at least neutering) this timer?Flags: needinfo?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1294095#c14)• 8 years ago |
|  | |

It is for example stopped when we clear the net in the sctp\_free\_remote\_addr() macro.
My current guess is that it is fine that the timer fires. The problem is that as a result
of the firing, the upper layer gets notified and probably deregisters the pointer to the lower
layer. I need to understand the C++ stuff...
I can add code that the lower layer pointer is not provided anymore after it is deregistered,
that might solve the issue. But I would like to understand the issue first. Not sure if I
can reproduce the problem with firefox... I was busy with my dayjob earlier this week...Flags: needinfo?(tuexen)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1294095#c15)• 8 years ago |
|  | |

Attached patch

[wrap and lock DataChannelConnection for SCTP callbacks](attachment.cgi?id=8782576&action=diff) (obsolete)
— [Details](attachment.cgi?id=8782576&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782576)

Proposed wrapper idea, though Michael's idea may be better

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a726573_11539)• 8 years ago |

[Attachment #8782576](/attachment.cgi?id=8782576&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") -
Flags: feedback?(docfaraday)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1294095#c16)• 8 years ago |
|  | |

OK, I looked at the code. It is not so easy as I thought to add the protection. And I have no
idea why this is happening.
If you just want to avoid the problem to occur, add
usrsctp\_sysctl\_set\_sctp\_assoc\_rtx\_max\_default(0xffffffff);
after
<https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/datachannel/DataChannel.cpp#351>
This will basically turn off the detection that the peer is dead. All error logs I looked at, this was the code path the problem occurs.
This doesn't solve the real problem (which I currently haven't been to identify based on the information available) but will avoid the problem.Flags: needinfo?(rjesup)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1294095#c17)• 8 years ago |
|  | |

Comment on [attachment 8782576](/attachment.cgi?id=8782576 "wrap and lock DataChannelConnection for SCTP callbacks") [[details]](/attachment.cgi?id=8782576&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") [[diff]](/attachment.cgi?id=8782576&action=diff "wrap and lock DataChannelConnection for SCTP callbacks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782576)
wrap and lock DataChannelConnection for SCTP callbacks
Review of [attachment 8782576](/attachment.cgi?id=8782576 "wrap and lock DataChannelConnection for SCTP callbacks") [[details]](/attachment.cgi?id=8782576&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") [[diff]](/attachment.cgi?id=8782576&action=diff "wrap and lock DataChannelConnection for SCTP callbacks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782576):
-----------------------------------------------------------------
::: netwerk/sctp/datachannel/DataChannel.h
@@ +296,5 @@
> nsCOMPtr<nsIThread> mInternalIOThread;
> +
> + // Temporary wrapper object to use with sctp library callbacks so we can
> + // neuter it on Destroy(). Leaked on purpose when we delete this object.
> + ConnectionWrapper \*mTempWrapper;
Oof. Leaking a mutex on purpose? Surely there's a better fix.
[Attachment #8782576](/attachment.cgi?id=8782576&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") -
Flags: feedback?(docfaraday) → feedback-

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1294095#c18)• 8 years ago |
|  | |

Hmmm. That will turn off detection of a failed connection. In theory ICE Consent Freshness should eventually kick in and mark it as failed. There might even be advantages in not having an independent timeout for datachannels... since that will be confusing for JS apps (they'd see close events but the peerconnection may still be "connected")
However... while the stacks are all from association timeout, if we do this we may retransmit "forever", and in the case where we timed out, we might try to send a packet retransmit instead, and I'm concerned that this would use the bad ptr - unless the normal retransmit is blocked by the deregister/close.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1294095#c19)• 8 years ago |
|  | |

(In reply to Byron Campen [:bwc] from [comment #17](/show_bug.cgi?id=1294095#c17 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> Comment on [attachment 8782576](/attachment.cgi?id=8782576 "wrap and lock DataChannelConnection for SCTP callbacks") [[details]](/attachment.cgi?id=8782576&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") [[diff]](/attachment.cgi?id=8782576&action=diff "wrap and lock DataChannelConnection for SCTP callbacks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782576)
> wrap and lock DataChannelConnection for SCTP callbacks
>
> Review of [attachment 8782576](/attachment.cgi?id=8782576 "wrap and lock DataChannelConnection for SCTP callbacks") [[details]](/attachment.cgi?id=8782576&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") [[diff]](/attachment.cgi?id=8782576&action=diff "wrap and lock DataChannelConnection for SCTP callbacks") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782576):
> -----------------------------------------------------------------
>
> ::: netwerk/sctp/datachannel/DataChannel.h
> @@ +296,5 @@
> > nsCOMPtr<nsIThread> mInternalIOThread;
> > +
> > + // Temporary wrapper object to use with sctp library callbacks so we can
> > + // neuter it on Destroy(). Leaked on purpose when we delete this object.
> > + ConnectionWrapper \*mTempWrapper;
>
> Oof. Leaking a mutex on purpose? Surely there's a better fix.
Leaking a mutex is better than a UAF.
However, I wonder if I can so some magic with atomics... or do some deferred cleanup of these (clean them up on a 10s timer). Initially I'd hoped to do this with a bare ptr to minimize the leak, but that opens us to holes when trying to clear it (inherently from a different thread)Flags: needinfo?(rjesup)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1294095#c20)• 8 years ago |
|  | |

I could also use a single static Mutex for all datachannelconnections.... likely no contention (or minimal), and the leak would then just be a class ConnectionWrapper { ConnectionWrapper(foo) : mConnection(foo); RefPtr<DataChannelConnection> mConnection; }

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1294095#c21)• 8 years ago |
|  | |

(In reply to Randell Jesup [:jesup] from [comment #18](/show_bug.cgi?id=1294095#c18 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> Hmmm. That will turn off detection of a failed connection. In theory ICE
> Consent Freshness should eventually kick in and mark it as failed. There
> might even be advantages in not having an independent timeout for
> datachannels... since that will be confusing for JS apps (they'd see close
> events but the peerconnection may still be "connected")
>
> However... while the stacks are all from association timeout, if we do this
> we may retransmit "forever", and in the case where we timed out, we might
> try to send a packet retransmit instead, and I'm concerned that this would
> use the bad ptr - unless the normal retransmit is blocked by the
> deregister/close.
We have retransmitted multiple times before we do the cleanup. So I think
the problem is NOT related to the timerou (either HEARTBEAT or DATA retransmit),
but related to the cleanup. Which, I guess, also involves somehow the freeing
of the DTLS connection object. That is why I think my change would work around
the issue.
You can also:
\* make sure you call usrscpt\_close() before usrsctp\_deregister().
\* make sure you do not free whatever the pointer given to usrsctp points to before
calling usrsctp\_deregister().
That would (I'm guessing here) the real fix. However, it is not within the usrsctp stack.
I also think that the ICE layer detects that the peer is unreachable earlier than SCTP
does with the used default settings.Flags: needinfo?(rjesup)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1294095#c22)• 8 years ago |
|  | |

Attached patch

[wrap and lock DataChannelConnection for SCTP callbacks](attachment.cgi?id=8782954&action=diff)
— [Details](attachment.cgi?id=8782954&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8782954)

Switched to a shared StaticMutex for locking access to the DataChannelConnection pointer
[Attachment #8782954](/attachment.cgi?id=8782954&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") -
Flags: review?(docfaraday)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a780212_11539)• 8 years ago |

[Attachment #8782576](/attachment.cgi?id=8782576&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") -
Attachment is obsolete: true

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1294095#c23)• 8 years ago |
|  | |

(In reply to Michael Tüxen from [comment #21](/show_bug.cgi?id=1294095#c21 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> (In reply to Randell Jesup [:jesup] from [comment #18](/show_bug.cgi?id=1294095#c18 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> > Hmmm. That will turn off detection of a failed connection. In theory ICE
> > Consent Freshness should eventually kick in and mark it as failed. There
> > might even be advantages in not having an independent timeout for
> > datachannels... since that will be confusing for JS apps (they'd see close
> > events but the peerconnection may still be "connected")
> >
> > However... while the stacks are all from association timeout, if we do this
> > we may retransmit "forever", and in the case where we timed out, we might
> > try to send a packet retransmit instead, and I'm concerned that this would
> > use the bad ptr - unless the normal retransmit is blocked by the
> > deregister/close.
>
> We have retransmitted multiple times before we do the cleanup. So I think
> the problem is NOT related to the timerou (either HEARTBEAT or DATA
> retransmit),
> but related to the cleanup. Which, I guess, also involves somehow the freeing
> of the DTLS connection object. That is why I think my change would work
> around
> the issue.
>
> You can also:
> \* make sure you call usrscpt\_close() before usrsctp\_deregister().
> \* make sure you do not free whatever the pointer given to usrsctp points to
> before
> calling usrsctp\_deregister().
You mean usrsctp\_deregister\_address, right? Because if that will fix this, that's really easy.

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1294095#c24)• 8 years ago |
|  | |

Yes, I meant usrsctp\_deregister\_address(). If that is easy, I would say do that and let us see
if that fixes the issue in the field.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1294095#c25)• 8 years ago |
|  | |

(In reply to Michael Tüxen from [comment #14](/show_bug.cgi?id=1294095#c14 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> It is for example stopped when we clear the net in the
> sctp\_free\_remote\_addr() macro.
>
I added an abort to this macro, and it never fires when running our mochitest suite...

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1294095#c26)• 8 years ago |
|  | |

|sctp\_timer\_stop| for |SCTP\_TIMER\_TYPE\_SEND| is not called (transitively) by either |usrsctp\_close| or |usrsctp\_deregister\_address|. Is there some other way this kind of timer could be getting canceled?Flags: needinfo?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1294095#c27)• 8 years ago |
|  | |

The retransmission timers (like all timers) are stopped in sctp\_free\_assoc() for each path:
TAILQ\_FOREACH(net, &asoc->nets, sctp\_next) {
(void)SCTP\_OS\_TIMER\_STOP(&net->rxt\_timer.timer);
net->rxt\_timer.self = NULL;
(void)SCTP\_OS\_TIMER\_STOP(&net->pmtu\_timer.timer);
net->pmtu\_timer.self = NULL;
(void)SCTP\_OS\_TIMER\_STOP(&net->hb\_timer.timer);
net->hb\_timer.self = NULL;
}Flags: needinfo?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1294095#c28)• 8 years ago |
|  | |

Hmm. sctp\_free\_assoc() also calls:
TAILQ\_FOREACH\_SAFE(net, &asoc->nets, sctp\_next, nnet) {
#ifdef INVARIANTS
if (SCTP\_BASE\_INFO(ipi\_count\_raddr) == 0) {
panic("no net's left alloc'ed, or list points to itself");
}
#endif
TAILQ\_REMOVE(&asoc->nets, net, sctp\_next);
sctp\_free\_remote\_addr(net);
}
So could it be that you don't tear down the associations in your test cases?

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1294095#c29)• 8 years ago |
|  | |

So, we can call close() before deregister\_address() (per my comments in [comment 10](/show_bug.cgi?id=1294095#c10 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput").) if that's all it takes, that's easy.
Right now, we call either close and then deregister\_address, or deregister\_address and then close (since they're occurring on separate threads.) There's no way the DataChannelConnection object can be released before both have happened. The crashes we're seeing imply that we've freed the object, and thus close and deregister\_address must have completedFlags: needinfo?(rjesup)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1294095#c30)• 8 years ago |
|  | |

After calling usrsctp\_deregister\_address(), the usrsctp stack will still call the lower layer output routine using the provided pointer. I tested that. Avoiding that is harder than I thought, since most
of the address handling we normally use isn't used in the case where we deal with the pointer.
However, if you say that the DataChannelConnection isn't released before usrsctp\_close() has been called AND usrsctp\_deregister\_address() has been called, then the sequence doesn't matter.
Just to be crystal clear; Here is what I get from the stack traces:
In all cases, SCTP detects via multiple retransmissions (10 to be precisely, taking several minutes of probing) that the peer is dead. Then it calls the upper layer to let him know. There you are doing some cleanups. See
<https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/datachannel/DataChannel.cpp#1470>
I'm not sure what happens there. Could it be that you are releasing there the DataChannelConnection?
After that callback, the SCTP stack will send out an ABORT. This is where FF crashes, since the DataChannelConnection object is gone at this point of time.
The missing piece for me is that I don't understand under which condition the DataChannelConnection gets freed (since I'm not familiar with C++)... I suspect that this might be done in the cleanup.
So that is why I'm proposing the make sure it never happens (until we understand what is going on and we have a way to test this).

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1294095#c31)• 8 years ago |
|  | |

So that send an ON\_DISCONNECTED message to the MainThread, which calls DataChannelConnection::CloseAll().
CloseAll() calls Close() on each DataChannel, and does some cleanup on pending opens (calls Close on them). Lastly if it closed any channels, it does SCTP\_STREAM\_RESET\_OUTGOING (in SendOutgoingStreamReset()).
None of these should affect the DataChannelConnection object itself, which is refcounted - so long as the PeerConnection (or anything else) has a RefPtr<> to the connection, it will not be deleted. Before the PeerConnection will drop the RefPtr (which can delete the connection), it will call Destroy() on the connection, which will at that point call close() and deregister\_address(). After those have been called, it \*will\* destroy the connection object (we leave the sctp stack available until browser shutdown (i.e. we normally \*don't\* call sctp\_finish() until the browser exits, though I'd like to look at doing so.)
So it looks like the original assessment is correct - there's no easy way to avoid a race between an SCTP timeout and someone destroying the connection. Now, I don't know that's what \*did\* happen (i.e. that it's not some other problem), but this is a plausible if unlikely race.
So, ugly as it is, we may have to go with the original idea, since without calling usrsctp\_finish there's no way to ensure that the stack won't call us (and if multiple connections in different peerconnections are active, calling usrsctp\_finish would be bad.

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1294095#c32)• 8 years ago |
|  | |

OK. So you are saying that we have a race:
(a) One thread processing a timeout which results in terminating the SCTP association.
(b) Another thread destroying the DataChannelConnection.
Any idea how (b) can happen? Which usrsctp\_\*() functions might be involved?
If you have a conjecture, I could look at the code and/or write a stress tester...

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 33](/show_bug.cgi?id=1294095#c33)• 8 years ago |
|  | |

Thread B is the thread that opened the SCTP library, and from previous experience (bugs) must be the one that closes it.
<user shutdown of PeerConnection>
Thread A (Mainthread):
Destroy() {
Send message to Thread B to close SCTP (DestroyOnSTSThread())
usrsctp\_deregister\_address()
}
~DataChannelConnection() - delete of the structure (object ptr) we registered with the open
Thread B (STS):
DestroyOnSTSThread() {
usrsctp\_close()
}
Browser Shutdown:
usrsctp\_finish();
Because of threading, DestroyOnSTSThread() can happen before or after deregister\_address. However, you're telling me that after deregister\_address "the usrsctp stack will still call the lower layer output routine using the provided pointer", so it appears there's no way to avoid that other than usrsctp\_finish (which we don't do until browser shutdown and all users of sctp have shut down).
I could make the message dispatch to the STS thread synchronous (though we prefer to avoid synchronous messages starting from MainThread, since that can block the main thread of the browser) and do deregister on STS or after it returns, or I could move deregister to before the message is sent. But from your quote above I don't think that will help me (I might still get called back using the ptr even after deregister \*and\* close)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 34](/show_bug.cgi?id=1294095#c34)• 8 years ago |
|  | |

Just as a side note: usrsctp\_finish() will teardown the stack if there are not endpoints anymore.
Doesn't the above mean that you possibly delete the structure within thread A before thread B calls usrsctp\_close().
Please note that in the crashes we are looking at, the timer thread is involved. We run the notification code within the timer thread. So the cleanup will be triggered from that thread.
Again: I'm not sure about the timeframe you need to handle this problem. If you need a quick way to avoid it, think about raising the threshold for dead peer detection.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 35](/show_bug.cgi?id=1294095#c35)• 8 years ago |
|  | |

(In reply to Michael Tüxen from [comment #34](/show_bug.cgi?id=1294095#c34 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> Just as a side note: usrsctp\_finish() will teardown the stack if there are
> not endpoints anymore.
>
> Doesn't the above mean that you possibly delete the structure within thread
> A before thread B calls usrsctp\_close().
The Runnable that calls DestroyOnSTS holds a strong ref to the DataChannelConnection.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 36](/show_bug.cgi?id=1294095#c36)• 8 years ago |
|  | |

(In reply to Michael Tüxen from [comment #30](/show_bug.cgi?id=1294095#c30 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> In all cases, SCTP detects via multiple retransmissions (10 to be precisely,
> taking several minutes of probing) that the peer is dead. Then it calls the
> upper layer to let him know. There you are doing some cleanups. See
> <https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/datachannel/>
> DataChannel.cpp#1470
Is there an event that signals that the SCTP stack will definitely not be calling us back anymore?Flags: needinfo?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 37](/show_bug.cgi?id=1294095#c37)• 8 years ago |
|  | |

Currently not. When aborting the association, we provide the notification first and then send an ABORT.
We are currently reworking the callback API to overcome several limitations of the current way, but that needs some further testing...Flags: needinfo?(tuexen)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 38](/show_bug.cgi?id=1294095#c38)• 8 years ago |
|  | |

[Comment 35](/show_bug.cgi?id=1294095#c35 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput") (DestroyOnSTS holding a strong ref) means we will not destroy it until close() returns.
However - this isn't on the timer thread. Sounds like there's a race between close/etc on other threads (close() on STS in this case) and the timer firing; i.e. some missing interlock that stops the timer from firing if close happens.
This is a security bug, and as it's a UAF we really want to take a fix for it in the next week or two so it can go out in 49 -- even if that fix is my "leak a ptr" fix

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 39](/show_bug.cgi?id=1294095#c39)• 8 years ago |
|  | |

So, we have unlocked a mutex in the crashing callstack:
<https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/src/netinet/sctp_callout.c#155>
It does look like this leaves a brief window that could allow the Destroy() code to finish at the same time the timer is popping.

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 40](/show_bug.cgi?id=1294095#c40)• 8 years ago |
|  | |

Is there some way we could get the sctp stack to schedule an immediate timer that comes around as a callback on the timer thread? We could schedule this timer in DestroyOnSTS (and move the deregister there too), and once that timer pops we can dispose of the DataChannelConnection.
If there is not currently a way to do this, how hard would it be to make one?Flags: needinfo?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 41](/show_bug.cgi?id=1294095#c41)• 8 years ago |
|  | |

(In reply to Byron Campen [:bwc] from [comment #39](/show_bug.cgi?id=1294095#c39 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> So, we have unlocked a mutex in the crashing callstack:
>
> <https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/src/netinet/>
> sctp\_callout.c#155
>
> It does look like this leaves a brief window that could allow the Destroy()
> code to finish at the same time the timer is popping.
The TIMERQ\_LOCK just protects the list of timers. If the stored timer is stopped,
sctp\_os\_timer\_next is adopted.Flags: needinfo?(tuexen)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 42](/show_bug.cgi?id=1294095#c42)• 8 years ago |
|  | |

(In reply to Byron Campen [:bwc] from [comment #40](/show_bug.cgi?id=1294095#c40 "VERIFIED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput"))
> Is there some way we could get the sctp stack to schedule an immediate timer
> that comes around as a callback on the timer thread? We could schedule this
> timer in DestroyOnSTS (and move the deregister there too), and once that
> timer pops we can dispose of the DataChannelConnection.
>
> If there is not currently a way to do this, how hard would it be to make one?
It is just software, so it can be changed.
However, the code has evolved and the base you are using is over a year old.
I would have to look at that code and adding such a timer without having a reproducible
test case to make sure we are working around that issue is something I would like
to avoid. I guess the simplest workaround for the crashes I have seen is to disable the
dead peer detection at the SCTP layer for now. Is there a reason not going down this path?
If Randell feels save to add his patch, it can be added in addition to setting the maximum
number of retransmits to 0xffffffff.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 43](/show_bug.cgi?id=1294095#c43)• 8 years ago |
|  | |

My only concern with the "retransmit forever" case is this:
> However... while the stacks are all from association timeout, if we do this we may retransmit
> "forever", and in the case where we timed out, we might try to send a packet retransmit instead, and
> I'm concerned that this would use the bad ptr - unless the normal retransmit is blocked by the
> deregister/close.
If close/deregister\_address will block \*that\* timer (the retransmit) - then it could help.

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 44](/show_bug.cgi?id=1294095#c44)• 8 years ago |
|  | |

All stack traces I have looked at showed that sctp\_abort\_an\_association() was called from sctp\_threshold\_management. So it was always happening when SCTP was destroying the association,
not when it did all the retransmits before.
That is why I belief that it is related to the cleanup when handling dead peer detection.
I have not seen a trace where a normal retransmission triggered the crash. Have you?

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 45](/show_bug.cgi?id=1294095#c45)• 8 years ago |
|  | |

OK. By looking at the code again, this might be a fix for the issue:
Move the "notify the ulp" code in
<https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/src/netinet/sctputil.c#4207>
below the "notify the peer" code in
<https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/src/netinet/sctputil.c#4211>
This would mean we send out the ABORT (using your object pointer) before notifying
the C++ code, which might free the pointer.
For consistency, We would need a similar swap around
<https://dxr.mozilla.org/mozilla-central/source/netwerk/sctp/src/netinet/sctputil.c#4066>
However, without a test, we can't be sure. But it might be worth a try... At least
I would try to test it. What do you think?Flags: needinfo?(rjesup)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 46](/show_bug.cgi?id=1294095#c46)• 8 years ago |
|  | |

It makes sense in any case, since when you notify the owner of the association failure it may break the channel between usrsctp and the network. (this becomes an issue once sctp travels in a tunnel via the callbacks, as we use it). As to if this could cause the problem... maybe. We will fire close events to JS, and it may well tear down the peerconnection in response.Flags: needinfo?(rjesup)

|  | [Michael Tüxen](/user_profile?user_id=459963) |  |
| --- | --- | --- |
| [Comment 47](/show_bug.cgi?id=1294095#c47)• 8 years ago |
|  | |

I committed such a change to the usrsctp code:
<https://github.com/sctplab/usrsctp/commit/d1208ae09e4e8bfb552b52773722d49748da0818>

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 48](/show_bug.cgi?id=1294095#c48)• 8 years ago |
|  | |

Attached patch

[Swap order of notifications on association failure](attachment.cgi?id=8783983&action=diff)
— [Details](attachment.cgi?id=8783983&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8783983)

I think it's worth landing this in any case. I forget the details of the analysis, but perhaps this causes the race with a JS app that responds to onclose by tearing down the peerconnection.
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: review?(docfaraday)

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Comment 49](/show_bug.cgi?id=1294095#c49)• 8 years ago |
|  | |

Comment on [attachment 8783983](/attachment.cgi?id=8783983 "Swap order of notifications on association failure") [[details]](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") [[diff]](/attachment.cgi?id=8783983&action=diff "Swap order of notifications on association failure") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8783983)
Swap order of notifications on association failure
Review of [attachment 8783983](/attachment.cgi?id=8783983 "Swap order of notifications on association failure") [[details]](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") [[diff]](/attachment.cgi?id=8783983&action=diff "Swap order of notifications on association failure") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8783983):
-----------------------------------------------------------------
This might do the trick? Worth a shot at any rate.
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: review?(docfaraday) → review+

|  | [Byron Campen [:bwc]](/user_profile?user_id=478411) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a1121234_478411)• 8 years ago |

[Attachment #8782954](/attachment.cgi?id=8782954&action=edit "wrap and lock DataChannelConnection for SCTP callbacks") -
Flags: review?(docfaraday)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 50](/show_bug.cgi?id=1294095#c50)• 8 years ago |
|  | |

Comment on [attachment 8783983](/attachment.cgi?id=8783983 "Swap order of notifications on association failure") [[details]](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") [[diff]](/attachment.cgi?id=8783983&action=diff "Swap order of notifications on association failure") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8783983)
Swap order of notifications on association failure
[Security approval request comment]
How easily could an exploit be constructed based on the patch? Very hard
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? No - at most it is only of interest if it lands on a sec bug and is uplifted. Also, patch has landed upstream - we could land it under a generic "cherry-pick mod from upstream" bug if we care.
Which older supported branches are affected by this flaw? All, though it appears as if other changes recently exposed the flaw (timing/references/etc).
If not all supported branches, which bug introduced the flaw? N/A
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? Trivial
How likely is this patch to cause regressions; how much testing does it need? Very low chance of regression; swaps the order of notifications.
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: sec-approval?
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-beta?
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-aurora?

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 51](/show_bug.cgi?id=1294095#c51)• 8 years ago |
|  | |

Likely affects 48 and ESR45, but they may not have changes elsewhere that expose the issue. They might still be exploitable though.
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 52](/show_bug.cgi?id=1294095#c52)• 8 years ago |
|  | |

Comment on [attachment 8783983](/attachment.cgi?id=8783983 "Swap order of notifications on association failure") [[details]](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") [[diff]](/attachment.cgi?id=8783983&action=diff "Swap order of notifications on association failure") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8783983)
Swap order of notifications on association failure
Approvals given. This is a tiny patch. We should take this on ESR45 as well.
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: sec-approval?
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: sec-approval+
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-beta?
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-beta+
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-aurora?
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-aurora+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a1131678_280903)• 8 years ago |

[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=%3F) → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 53](/show_bug.cgi?id=1294095#c53)• 8 years ago |
|  | |

Comment on [attachment 8783983](/attachment.cgi?id=8783983 "Swap order of notifications on association failure") [[details]](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") [[diff]](/attachment.cgi?id=8783983&action=diff "Swap order of notifications on association failure") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1294095&attachment=8783983)
Swap order of notifications on association failure
[Approval Request Comment]
User impact if declined: sec-crit fixed on other branches
Fix Landed on Version: 51 (uplift to 49)
Risk to taking this patch (and alternatives if risky): very low risk
String or UUID changes made by this patch: none
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-esr45?

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 54](/show_bug.cgi?id=1294095#c54)• 8 years ago |
|  | |

Note: We might hold landing it on ESR45 until we see some crashstats data that confirms the fix in the field.

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 55](/show_bug.cgi?id=1294095#c55)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/fab696bc92fd>

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Comment 56](/show_bug.cgi?id=1294095#c56)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/a15468866522>
<https://hg.mozilla.org/releases/mozilla-beta/rev/382c9188549d>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 57](/show_bug.cgi?id=1294095#c57)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/fab696bc92fd>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Flags: in-testsuite?Resolution: --- → FIXEDTarget Milestone: --- → mozilla51

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Comment 58](/show_bug.cgi?id=1294095#c58)• 8 years ago |
|  | |

sec critical, taking it to esr 45. Should be in 45.4
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F) → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Sylvestre Ledru [:Sylvestre]](/user_profile?user_id=495955) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a1621108_495955)• 8 years ago |

[Attachment #8783983](/attachment.cgi?id=8783983&action=edit "Swap order of notifications on association failure") -
Flags: approval-mozilla-esr45? → approval-mozilla-esr45+

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 59](/show_bug.cgi?id=1294095#c59)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/3c4958a98908>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a1905501_1689)• 8 years ago |

Group: media-core-security → core-security-release

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a2363138_280903)• 8 years ago |

Whiteboard: [adv-main49+][adv-esr45.4+]

|  | [Cornel Ionce [:noni] [Hubs QA]](/user_profile?user_id=458186) |  |
| --- | --- | --- |
| [Comment 61](/show_bug.cgi?id=1294095#c61)• 8 years ago |
|  | |

7 crashes with this signature in Socorro n the last week, the most recent affected build being 49.0b6.
<https://crash-stats.mozilla.com/signature/?product=Firefox&signature=mozilla%3A%3ADataChannelConnection%3A%3ASctpDtlsOutput>
Closing this issue.Status: RESOLVED → VERIFIED
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=verified)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=verified)

|  | [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a6042541_11539)• 8 years ago |

Blocks: [1311380](/show_bug.cgi?id=1311380 "RESOLVED FIXED - Crash in mozilla::DataChannelConnection::SctpDtlsOutput")

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1294095#a15812229_1689)• 8 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1294095&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Randell Jesup [:jesup] (needinfo me)](/user_profile?user_id=11539)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.mozilla.org_d553d632_20250125_221228.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1288555)
* [XML](/show_bug.cgi?ctype=xml&id=1288555)

Closed
[Bug 1288555](/show_bug.cgi?id=1288555)

Opened 9 years ago
Closed 8 years ago

# wrong compartment while structured cloning a cross-compartment ArrayBuffer

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

wrong compartment while structured cloning a cross-compartment ArrayBuffer

## Categories

### (Core :: JavaScript Engine, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=JavaScript%20Engine#JavaScript%20Engine)

JavaScript Engine
▾

Core :: JavaScript Engine
The interpreter engine for the core JavaScript language, independent of the browser's object model. File ONLY core JavaScript language bugs in this category. For bugs involving browser objects such as "window" and "document", use the "DOM" component. For bugs involving calls between JavaScript and C++, use the "XPConnect" component.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=JavaScript%20Engine&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=JavaScript%20Engine)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

unspecified

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla51

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Score | --- |
| --- | --- |
| a11y-review | --- |
| Accessibility Severity | --- |
| Performance Impact | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix) |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |
| firefox51 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox47 |  | wontfix |
| firefox48 |  | wontfix |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | fixed |
| firefox51 |  | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: sfink, Assigned: sfink)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/d269c0228684029dedb75d73b81a64c3?d=mm&size=40)  [sfink](/user_profile?user_id=359004)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/d269c0228684029dedb75d73b81a64c3?d=mm&size=40)  [sfink](/user_profile?user_id=359004)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/4fe52ee1503aecf7b6c976b8eb7c1753?d=mm&size=40)  [willyelm](/user_profile?user_id=714609)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1240984](/show_bug.cgi?id=1240984 "RESOLVED FIXED - Large transferables (worker, postMessage) cause OOM"), [1287298](/show_bug.cgi?id=1287298 "RESOLVED FIXED - Add an API to give up ownership of ArrayBuffer data")

Dependency [tree](/showdependencytree.cgi?id=1288555&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1288555)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-other, sec-high, Whiteboard: [post-critsmash-triage][adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a4010776_452604 "8 years ago") | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | - |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (2 files, 2 obsolete files)

| [Enter the transferred ArrayBuffer's compartment before stealing its data](/attachment.cgi?id=8773527)  [9 years ago](#c2)  [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)   3.75 KB, patch | Waldo : [review+](#c3 "9 years ago") | [Details](/attachment.cgi?id=8773527&action=edit) | [Diff](/attachment.cgi?id=8773527&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8773527) |
| --- | --- | --- |
| [Enter the transferred ArrayBuffer's compartment before stealing its data](/attachment.cgi?id=8775698)  [8 years ago](#c4)  [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)   4.72 KB, patch |  | [Details](/attachment.cgi?id=8775698&action=edit) | [Diff](/attachment.cgi?id=8775698&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775698) |
| [Enter the transferred ArrayBuffer's compartment before stealing its data](/attachment.cgi?id=8775701)  [8 years ago](#c5)  [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)   3.55 KB, patch | Waldo : [review+](#a595965_83595 "8 years ago") | [Details](/attachment.cgi?id=8775701&action=edit) | [Diff](/attachment.cgi?id=8775701&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775701) |
| [Version of the patch with a more mundane description](/attachment.cgi?id=8775728)  [8 years ago](#c6)  [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)   3.02 KB, patch | Waldo : [review+](#a600751_83595 "8 years ago")  ritu : [approval-mozilla-aurora+](#c9 "8 years ago")  ritu : [approval-mozilla-beta+](#c9 "8 years ago")  ritu : [approval-mozilla-esr45+](#c9 "8 years ago")  abillings : [sec-approval+](#a713975_280903 "8 years ago") | [Details](/attachment.cgi?id=8775728&action=edit) | [Diff](/attachment.cgi?id=8775728&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775728) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1288555#c0)• 9 years ago |
| testcase | |

When transferring the contents of an ArrayBuffer during a structured clone, a cross-compartment ArrayBuffer is unwrapped, but then the detach call happens in the original compartment. If there is more than one view on that ArrayBuffer, all views after the second will then fail to be detached (because we have an InnerViewsTable \*on the compartment\* that holds all views but the first.)
As a result, these views (eg typed arrays) will still have pointers into the ArrayBuffer's data, which is a huge correctness violation as well as a set up for lots of race conditions if the data has been transferred between threads. Furthermore, if the buffer gets GC'd, it's a very controllable UAF.
JS shell example:
b = new ArrayBuffer(100);
ta = new Int32Array(b);
ta[0] = 17;
g = newGlobal();
g.b = b;
ta2 = g.eval("new Int32Array(b)");
g.serialize(b, [b]);
// gc();
print(ta[0]);
print(ta2[0]); // This is 17, should be undefined. With the gc(), it is a UAF and will probably crash.
In the browser, you'd use postMessage to detach the buffer.

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1288555#c1)• 9 years ago |
|  | |

[Tracking Requested - why for this release]: This bug goes back to at least Fx45, and is trivially exploitable.
[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=affected)
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox47](/buglist.cgi?f1=cf_tracking_firefox47&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox47&o1=equals&v1=%3F)
[tracking-firefox48](/buglist.cgi?f1=cf_tracking_firefox48&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%3F)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%3F)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1288555#c2)• 9 years ago |
|  | |

Attached patch

[Enter the transferred ArrayBuffer's compartment before stealing its data](attachment.cgi?id=8773527&action=diff) (obsolete)
— [Details](attachment.cgi?id=8773527&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8773527)

Asking for review on this patch, but I'm not sure in what form we'd want to land this to be discreet. We can discuss that during the approval process. (Same thing for tests. I have a test, but it makes things horribly obvious.)
[Attachment #8773527](/attachment.cgi?id=8773527&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Flags: review?(jwalden+bmo)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a1910_359004)• 9 years ago |

Assignee: nobody → sphinkStatus: NEW → ASSIGNED

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1288555#c3)• 8 years ago |
|  | |

Comment on [attachment 8773527](/attachment.cgi?id=8773527 "Enter the transferred ArrayBuffer's compartment before stealing its data") [[details]](/attachment.cgi?id=8773527&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") [[diff]](/attachment.cgi?id=8773527&action=diff "Enter the transferred ArrayBuffer's compartment before stealing its data") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8773527)
Enter the transferred ArrayBuffer's compartment before stealing its data
Review of [attachment 8773527](/attachment.cgi?id=8773527 "Enter the transferred ArrayBuffer's compartment before stealing its data") [[details]](/attachment.cgi?id=8773527&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") [[diff]](/attachment.cgi?id=8773527&action=diff "Enter the transferred ArrayBuffer's compartment before stealing its data") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8773527):
-----------------------------------------------------------------
\*gulp\* I keep missing when our tracking of buffer views changes. First it was a linked list, then it was something, then something else, now this. CAN'T WE JUST GET IT RIGHT THE FIRST TIME. :-)
::: js/src/vm/ArrayBufferObject.cpp
@@ +1062,1 @@
> MOZ\_ASSERT\_IF(buf.dataPointer() == nullptr, offset == 0);
The more these build up, the more I prefer #ifdef DEBUG around an if with MOZ\_ASSERTs, but this is fine.
[Attachment #8773527](/attachment.cgi?id=8773527&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Flags: review?(jwalden+bmo) → review+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a588721_1689)• 8 years ago |

Group: core-security → javascript-core-securityKeywords: [csectype-other](/buglist.cgi?keywords=csectype-other&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1288555#c4)• 8 years ago |
|  | |

Attached patch

[Enter the transferred ArrayBuffer's compartment before stealing its data](attachment.cgi?id=8775698&action=diff) (obsolete)
— [Details](attachment.cgi?id=8775698&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775698)

MozReview-Commit-ID: 90tALXT2BVr
[Attachment #8775698](/attachment.cgi?id=8775698&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Flags: review?(jwalden+bmo)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a594295_359004)• 8 years ago |

[Attachment #8773527](/attachment.cgi?id=8773527&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Attachment is obsolete: true

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1288555#c5)• 8 years ago |
|  | |

Attached patch

[Enter the transferred ArrayBuffer's compartment before stealing its data](attachment.cgi?id=8775701&action=diff)
— [Details](attachment.cgi?id=8775701&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775701)

MozReview-Commit-ID: 90tALXT2BVr
[Attachment #8775701](/attachment.cgi?id=8775701&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Flags: review?(jwalden+bmo)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a594442_359004)• 8 years ago |

[Attachment #8775698](/attachment.cgi?id=8775698&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Attachment is obsolete: true
[Attachment #8775698](/attachment.cgi?id=8775698&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Flags: review?(jwalden+bmo)

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a595965_83595)• 8 years ago |

[Attachment #8775701](/attachment.cgi?id=8775701&action=edit "Enter the transferred ArrayBuffer's compartment before stealing its data") -
Flags: review?(jwalden+bmo) → review+

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1288555#c6)• 8 years ago |
|  | |

Attached patch

[Version of the patch with a more mundane description](attachment.cgi?id=8775728&action=diff)
— [Details](attachment.cgi?id=8775728&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775728)

My original comment was a little too revealing.
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: review?(jwalden+bmo)

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1288555#c7)• 8 years ago |
|  | |

Comment on [attachment 8775728](/attachment.cgi?id=8775728 "Version of the patch with a more mundane description") [[details]](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") [[diff]](/attachment.cgi?id=8775728&action=diff "Version of the patch with a more mundane description") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775728)
Version of the patch with a more mundane description
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
If someone is familiar with the security properties of compartments, it's pretty easy. This gives you a read/write UAF with a completely controllable offset.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No, I changed to a less revealing comment.
Which older supported branches are affected by this flaw?
all of them
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Easy to create. They should be nearly identical, though I suspect enough of the structured clone code will have changed slightly that they might not apply cleanly. I looked back to esr45 and the code is functionally identical.
How likely is this patch to cause regressions; how much testing does it need?
Unlikely. Without this fix, some things would have worked that should not. (Specifically, if you transferred a buffer via postMessage, its views would continue to "work" when they shouldn't.)
[Approval Request Comment]
Fix Landed on Version: not yet landed at this time
Risk to taking this patch (and alternatives if risky): low risk
String or UUID changes made by this patch: none
Approval Request Comment
[Feature/regressing bug #]: 1061404
[User impact if declined]: exploitable UAF
[Describe test coverage new/current, TreeHerder]: it fixes my test case, but I'm afraid to push it to a publicly visible place
[Risks and why]: theoretically somebody could be depending on views of detached buffers working, but if so we need to break them ASAP
[String/UUID change made/needed]: none
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: sec-approval?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-release?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-esr45?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-beta?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-aurora?

|  | [Jeff Walden [:Waldo]](/user_profile?user_id=83595) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a600751_83595)• 8 years ago |

[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: review?(jwalden+bmo) → review+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1288555#c8)• 8 years ago |
|  | |

This is pretty bad and revealing from your comments. I'm going to sec-approve for trunk checkin but it needs to wait until August 16 so we're two weeks into the cycle so we don't overly expose this to anyone watching checkins.
[status-firefox47](/buglist.cgi?f1=cf_status_firefox47&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox47&o1=equals&v1=wontfix)
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[tracking-firefox47](/buglist.cgi?f1=cf_tracking_firefox47&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox47&o1=equals&v1=%3F) → ---
[tracking-firefox48](/buglist.cgi?f1=cf_tracking_firefox48&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox48&o1=equals&v1=%3F) → ---
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=%3F) → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)Whiteboard: [checkin on 8/16]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a713975_280903)• 8 years ago |

[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: sec-approval?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: sec-approval+
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-release?

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1288555#c9)• 8 years ago |
|  | |

Comment on [attachment 8775728](/attachment.cgi?id=8775728 "Version of the patch with a more mundane description") [[details]](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") [[diff]](/attachment.cgi?id=8775728&action=diff "Version of the patch with a more mundane description") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1288555&attachment=8775728)
Version of the patch with a more mundane description
Sec-high, approving for all affected branches. Based on Al's last comment this ought to be committed on Aug 16th and not before that. Aurora50+, Beta49+, ESR45+
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-esr45?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-esr45+
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-beta?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-beta+
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-aurora?
[Attachment #8775728](/attachment.cgi?id=8775728&action=edit "Version of the patch with a more mundane description") -
Flags: approval-mozilla-aurora+

|  | [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a1629955_359004)• 8 years ago |

Blocks: [1287298](/show_bug.cgi?id=1287298 "RESOLVED FIXED - Add an API to give up ownership of ArrayBuffer data"), [1240984](/show_bug.cgi?id=1240984 "RESOLVED FIXED - Large transferables (worker, postMessage) cause OOM")

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1288555#c10)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/a9213b054219>Whiteboard: [checkin on 8/16]

|  | [Wes Kocher (:KWierso) (Not reading bugmail; email directly if needed)](/user_profile?user_id=308534) |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1288555#c11)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/a9213b054219>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla51

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1288555#c12)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/8ececbd9880d>
<https://hg.mozilla.org/releases/mozilla-beta/rev/6cfff98fe1a0>
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a2334492_75935)• 8 years ago |

[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1288555#c13)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/9d632865560a>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a2412395_1689)• 8 years ago |

Group: javascript-core-security → core-security-release

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a4010776_452604)• 8 years ago |

Flags: qe-verify-Whiteboard: [post-critsmash-triage]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a4066033_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage] → [post-critsmash-triage][adv-main49+][adv-esr45.4+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1288555#a17515945_1689)• 8 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1288555&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Steve Fink [:sfink] [:s:]](/user_profile?user_id=359004)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_8ba7178c_20250126_122129.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Security Advisories for Thunderbird

### Impact key

* Critical
  Vulnerability can be used to run attacker code and install
  software, requiring no user interaction beyond normal browsing.
* High
  Vulnerability can be used to gather sensitive data
  from sites in other windows or inject data or code into
  those sites, requiring no more than normal browsing actions.
* Moderate
  Vulnerabilities that would otherwise be High or Critical
  except they only work in uncommon non-default configurations or
  require the user to perform complicated and/or unlikely steps.
* Low
  Minor security vulnerabilities such as Denial of Service
  attacks, minor data leaks, or spoofs. (Undetectable spoofs of
  SSL indicia would have "High" impact because those are generally
  used to steal sensitive data intended for other sites.)

### [# Fixed in Thunderbird 134](#thunderbird134)

* [2025-04 Security Vulnerabilities fixed in Thunderbird 134](/en-US/security/advisories/mfsa2025-04/)

### [# Fixed in Thunderbird 133](#thunderbird133)

* [2024-67 Security Vulnerabilities fixed in Thunderbird 133](/en-US/security/advisories/mfsa2024-67/)

### [# Fixed in Thunderbird 132.0.1](#thunderbird132.0.1)

* [2024-62 Security Vulnerabilities fixed in Thunderbird 132.0.1](/en-US/security/advisories/mfsa2024-62/)

### [# Fixed in Thunderbird 132](#thunderbird132)

* [2024-59 Security Vulnerabilities fixed in Thunderbird 132](/en-US/security/advisories/mfsa2024-59/)

### [# Fixed in Thunderbird 131.0.1](#thunderbird131.0.1)

* [2024-52 Security Vulnerability fixed in Thunderbird 131.0.1, Thunderbird 128.3.1, Thunderbird 115.16.0](/en-US/security/advisories/mfsa2024-52/)

### [# Fixed in Thunderbird 131](#thunderbird131)

* [2024-50 Security Vulnerabilities fixed in Thunderbird 131](/en-US/security/advisories/mfsa2024-50/)

### [# Fixed in Thunderbird 128.6](#thunderbird128.6)

* [2025-05 Security Vulnerabilities fixed in Thunderbird ESR 128.6](/en-US/security/advisories/mfsa2025-05/)

### [# Fixed in Thunderbird 128.5.2](#thunderbird128.5.2)

* [2024-69 Security Vulnerabilities fixed in Thunderbird 128.5.2](/en-US/security/advisories/mfsa2024-69/)

### [# Fixed in Thunderbird 128.5](#thunderbird128.5)

* [2024-68 Security Vulnerabilities fixed in Thunderbird 128.5](/en-US/security/advisories/mfsa2024-68/)

### [# Fixed in Thunderbird 128.4.3](#thunderbird128.4.3)

* [2024-61 Security Vulnerabilities fixed in Thunderbird 128.4.3](/en-US/security/advisories/mfsa2024-61/)

### [# Fixed in Thunderbird 128.4](#thunderbird128.4)

* [2024-58 Security Vulnerabilities fixed in Thunderbird 128.4](/en-US/security/advisories/mfsa2024-58/)

### [# Fixed in Thunderbird 128.3.1](#thunderbird128.3.1)

* [2024-52 Security Vulnerability fixed in Thunderbird 131.0.1, Thunderbird 128.3.1, Thunderbird 115.16.0](/en-US/security/advisories/mfsa2024-52/)

### [# Fixed in Thunderbird 128.3](#thunderbird128.3)

* [2024-49 Security Vulnerabilities fixed in Thunderbird 128.3](/en-US/security/advisories/mfsa2024-49/)

### [# Fixed in Thunderbird 128.2](#thunderbird128.2)

* [2024-43 Security Vulnerabilities fixed in Thunderbird 128.2](/en-US/security/advisories/mfsa2024-43/)

### [# Fixed in Thunderbird 128.1](#thunderbird128.1)

* [2024-37 Security Vulnerabilities fixed in Thunderbird 128.1](/en-US/security/advisories/mfsa2024-37/)

### [# Fixed in Thunderbird 128](#thunderbird128)

* [2024-32 Security Vulnerabilities fixed in Thunderbird 128](/en-US/security/advisories/mfsa2024-32/)

### [# Fixed in Thunderbird 115.18](#thunderbird115.18)

* [2024-70 Security Vulnerabilities fixed in Thunderbird 115.18](/en-US/security/advisories/mfsa2024-70/)

### [# Fixed in Thunderbird 115.16](#thunderbird115.16)

* [2024-52 Security Vulnerability fixed in Thunderbird 131.0.1, Thunderbird 128.3.1, Thunderbird 115.16.0](/en-US/security/advisories/mfsa2024-52/)

### [# Fixed in Thunderbird 115.15](#thunderbird115.15)

* [2024-44 Security Vulnerabilities fixed in Thunderbird 115.15](/en-US/security/advisories/mfsa2024-44/)

### [# Fixed in Thunderbird 115.14](#thunderbird115.14)

* [2024-38 Security Vulnerabilities fixed in Thunderbird 115.14](/en-US/security/advisories/mfsa2024-38/)

### [# Fixed in Thunderbird 115.13](#thunderbird115.13)

* [2024-31 Security Vulnerabilities fixed in Thunderbird 115.13](/en-US/security/advisories/mfsa2024-31/)

### [# Fixed in Thunderbird 115.12](#thunderbird115.12)

* [2024-28 Security Vulnerabilities fixed in Thunderbird 115.12](/en-US/security/advisories/mfsa2024-28/)

### [# Fixed in Thunderbird 115.11](#thunderbird115.11)

* [2024-23 Security Vulnerabilities fixed in Thunderbird 115.11](/en-US/security/advisories/mfsa2024-23/)

### [# Fixed in Thunderbird 115.10](#thunderbird115.10)

* [2024-20 Security Vulnerabilities fixed in Thunderbird 115.10](/en-US/security/advisories/mfsa2024-20/)

### [# Fixed in Thunderbird 115.9](#thunderbird115.9)

* [2024-14 Security Vulnerabilities fixed in Thunderbird 115.9](/en-US/security/advisories/mfsa2024-14/)

### [# Fixed in Thunderbird 115.8.1](#thunderbird115.8.1)

* [2024-11 Security Vulnerabilities fixed in Thunderbird 115.8.1](/en-US/security/advisories/mfsa2024-11/)

### [# Fixed in Thunderbird 115.8](#thunderbird115.8)

* [2024-07 Security Vulnerabilities fixed in Thunderbird 115.8](/en-US/security/advisories/mfsa2024-07/)

### [# Fixed in Thunderbird 115.7](#thunderbird115.7)

* [2024-04 Security Vulnerabilities fixed in Thunderbird 115.7](/en-US/security/advisories/mfsa2024-04/)

### [# Fixed in Thunderbird 115.6](#thunderbird115.6)

* [2023-55 Security Vulnerabilities fixed in Thunderbird 115.6](/en-US/security/advisories/mfsa2023-55/)

### [# Fixed in Thunderbird 115.5](#thunderbird115.5)

* [2023-52 Security Vulnerabilities fixed in Thunderbird 115.5](/en-US/security/advisories/mfsa2023-52/)

### [# Fixed in Thunderbird 115.4.1](#thunderbird115.4.1)

* [2023-47 Security Vulnerabilities fixed in Thunderbird 115.4.1](/en-US/security/advisories/mfsa2023-47/)

### [# Fixed in Thunderbird 115.3.1](#thunderbird115.3.1)

* [2023-44 Security Vulnerability fixed in Firefox 118.0.1, Firefox ESR 115.3.1, Firefox for Android 118.1.0, Firefox Focus for Android 118.1.0, and Thunderbird 115.3.1.](/en-US/security/advisories/mfsa2023-44/)

### [# Fixed in Thunderbird 115.3](#thunderbird115.3)

* [2023-43 Security Vulnerabilities fixed in Thunderbird 115.3](/en-US/security/advisories/mfsa2023-43/)

### [# Fixed in Thunderbird 115.2.2](#thunderbird115.2.2)

* [2023-40 Security Vulnerability fixed in Firefox 117.0.1, Firefox ESR 115.2.1, Firefox ESR 102.15.1, Thunderbird 102.15.1, and Thunderbird 115.2.2](/en-US/security/advisories/mfsa2023-40/)

### [# Fixed in Thunderbird 115.2](#thunderbird115.2)

* [2023-38 Security Vulnerabilities fixed in Thunderbird 115.2](/en-US/security/advisories/mfsa2023-38/)

### [# Fixed in Thunderbird 115.1](#thunderbird115.1)

* [2023-33 Security Vulnerabilities fixed in Thunderbird 115.1](/en-US/security/advisories/mfsa2023-33/)

### [# Fixed in Thunderbird 115.0.1](#thunderbird115.0.1)

* [2023-27 Security Vulnerabilities fixed in Thunderbird 115.0.1](/en-US/security/advisories/mfsa2023-27/)

### [# Fixed in Thunderbird 102.15.1](#thunderbird102.15.1)

* [2023-40 Security Vulnerability fixed in Firefox 117.0.1, Firefox ESR 115.2.1, Firefox ESR 102.15.1, Thunderbird 102.15.1, and Thunderbird 115.2.2](/en-US/security/advisories/mfsa2023-40/)

### [# Fixed in Thunderbird 102.15](#thunderbird102.15)

* [2023-37 Security Vulnerabilities fixed in Thunderbird 102.15](/en-US/security/advisories/mfsa2023-37/)

### [# Fixed in Thunderbird 102.14](#thunderbird102.14)

* [2023-32 Security Vulnerabilities fixed in Thunderbird 102.14](/en-US/security/advisories/mfsa2023-32/)

### [# Fixed in Thunderbird 102.13.1](#thunderbird102.13.1)

* [2023-28 Security Vulnerabilities fixed in Thunderbird 102.13.1](/en-US/security/advisories/mfsa2023-28/)

### [# Fixed in Thunderbird 102.13](#thunderbird102.13)

* [2023-24 Security Vulnerabilities fixed in Thunderbird 102.13](/en-US/security/advisories/mfsa2023-24/)

### [# Fixed in Thunderbird 102.12](#thunderbird102.12)

* [2023-21 Security Vulnerabilities fixed in Thunderbird 102.12](/en-US/security/advisories/mfsa2023-21/)

### [# Fixed in Thunderbird 102.11](#thunderbird102.11)

* [2023-18 Security Vulnerabilities fixed in Thunderbird 102.11](/en-US/security/advisories/mfsa2023-18/)

### [# Fixed in Thunderbird 102.10](#thunderbird102.10)

* [2023-15 Security Vulnerabilities fixed in Thunderbird 102.10](/en-US/security/advisories/mfsa2023-15/)

### [# Fixed in Thunderbird 102.9.1](#thunderbird102.9.1)

* [2023-12 Security Vulnerabilities fixed in Thunderbird 102.9.1](/en-US/security/advisories/mfsa2023-12/)

### [# Fixed in Thunderbird 102.9](#thunderbird102.9)

* [2023-11 Security Vulnerabilities fixed in Thunderbird 102.9](/en-US/security/advisories/mfsa2023-11/)

### [# Fixed in Thunderbird 102.8](#thunderbird102.8)

* [2023-07 Security Vulnerabilities fixed in Thunderbird 102.8](/en-US/security/advisories/mfsa2023-07/)

### [# Fixed in Thunderbird 102.7.1](#thunderbird102.7.1)

* [2023-04 Security Vulnerabilities fixed in Thunderbird 102.7.1](/en-US/security/advisories/mfsa2023-04/)

### [# Fixed in Thunderbird 102.7](#thunderbird102.7)

* [2023-03 Security Vulnerabilities fixed in Thunderbird 102.7](/en-US/security/advisories/mfsa2023-03/)

### [# Fixed in Thunderbird 102.6.1](#thunderbird102.6.1)

* [2022-54 Security Vulnerabilities fixed in Thunderbird 102.6.1](/en-US/security/advisories/mfsa2022-54/)

### [# Fixed in Thunderbird 102.6](#thunderbird102.6)

* [2022-53 Security Vulnerabilities fixed in Thunderbird 102.6](/en-US/security/advisories/mfsa2022-53/)

### [# Fixed in Thunderbird 102.5.1](#thunderbird102.5.1)

* [2022-50 Security Vulnerabilities fixed in Thunderbird 102.5.1](/en-US/security/advisories/mfsa2022-50/)

### [# Fixed in Thunderbird 102.5](#thunderbird102.5)

* [2022-49 Security Vulnerabilities fixed in Thunderbird 102.5](/en-US/security/advisories/mfsa2022-49/)

### [# Fixed in Thunderbird 102.4](#thunderbird102.4)

* [2022-46 Security Vulnerabilities fixed in Thunderbird 102.4](/en-US/security/advisories/mfsa2022-46/)

### [# Fixed in Thunderbird 102.3.1](#thunderbird102.3.1)

* [2022-43 Security Vulnerabilities fixed in Thunderbird 102.3.1](/en-US/security/advisories/mfsa2022-43/)

### [# Fixed in Thunderbird 102.3](#thunderbird102.3)

* [2022-42 Security Vulnerabilities fixed in Thunderbird 102.3](/en-US/security/advisories/mfsa2022-42/)

### [# Fixed in Thunderbird 102.2.1](#thunderbird102.2.1)

* [2022-38 Security Vulnerabilities fixed in Thunderbird 102.2.1](/en-US/security/advisories/mfsa2022-38/)

### [# Fixed in Thunderbird 102.2](#thunderbird102.2)

* [2022-36 Security Vulnerabilities fixed in Thunderbird 102.2](/en-US/security/advisories/mfsa2022-36/)

### [# Fixed in Thunderbird 102.1](#thunderbird102.1)

* [2022-32 Security Vulnerabilities fixed in Thunderbird 102.1](/en-US/security/advisories/mfsa2022-32/)

### [# Fixed in Thunderbird 102](#thunderbird102)

* [2022-26 Security Vulnerabilities fixed in Thunderbird 91.11 and Thunderbird 102](/en-US/security/advisories/mfsa2022-26/)

### [# Fixed in Thunderbird 91.13.1](#thunderbird91.13.1)

* [2022-39 Security Vulnerabilities fixed in Thunderbird 91.13.1](/en-US/security/advisories/mfsa2022-39/)

### [# Fixed in Thunderbird 91.13](#thunderbird91.13)

* [2022-37 Security Vulnerabilities fixed in Thunderbird 91.13](/en-US/security/advisories/mfsa2022-37/)

### [# Fixed in Thunderbird 91.12](#thunderbird91.12)

* [2022-31 Security Vulnerabilities fixed in Thunderbird 91.12](/en-US/security/advisories/mfsa2022-31/)

### [# Fixed in Thunderbird 91.11](#thunderbird91.11)

* [2022-26 Security Vulnerabilities fixed in Thunderbird 91.11 and Thunderbird 102](/en-US/security/advisories/mfsa2022-26/)

### [# Fixed in Thunderbird 91.10](#thunderbird91.10)

* [2022-22 Security Vulnerabilities fixed in Thunderbird 91.10](/en-US/security/advisories/mfsa2022-22/)

### [# Fixed in Thunderbird 91.9.1](#thunderbird91.9.1)

* [2022-19 Security Vulnerabilities fixed in Firefox 100.0.2, Firefox for Android 100.3.0, Firefox ESR 91.9.1, Thunderbird 91.9.1](/en-US/security/advisories/mfsa2022-19/)

### [# Fixed in Thunderbird 91.9](#thunderbird91.9)

* [2022-18 Security Vulnerabilities fixed in Thunderbird 91.9](/en-US/security/advisories/mfsa2022-18/)

### [# Fixed in Thunderbird 91.8](#thunderbird91.8)

* [2022-15 Security Vulnerabilities fixed in Thunderbird 91.8](/en-US/security/advisories/mfsa2022-15/)

### [# Fixed in Thunderbird 91.7](#thunderbird91.7)

* [2022-12 Security Vulnerabilities fixed in Thunderbird 91.7](/en-US/security/advisories/mfsa2022-12/)

### [# Fixed in Thunderbird 91.6.2](#thunderbird91.6.2)

* [2022-09 Security Vulnerabilities fixed in Firefox 97.0.2, Firefox ESR 91.6.1, Firefox for Android 97.3.0, and Focus 97.3.0](/en-US/security/advisories/mfsa2022-09/)

### [# Fixed in Thunderbird 91.6.1](#thunderbird91.6.1)

* [2022-07 Security Vulnerabilities fixed in Thunderbird 91.6.1](/en-US/security/advisories/mfsa2022-07/)

### [# Fixed in Thunderbird 91.6](#thunderbird91.6)

* [2022-06 Security Vulnerabilities fixed in Thunderbird 91.6](/en-US/security/advisories/mfsa2022-06/)

### [# Fixed in Thunderbird 91.5](#thunderbird91.5)

* [2022-03 Security Vulnerabilities fixed in Thunderbird 91.5](/en-US/security/advisories/mfsa2022-03/)

### [# Fixed in Thunderbird 91.4.1](#thunderbird91.4.1)

* [2021-55 Security Vulnerabilities fixed in Thunderbird 91.4.1](/en-US/security/advisories/mfsa2021-55/)

### [# Fixed in Thunderbird 91.4](#thunderbird91.4)

* [2021-54 Security Vulnerabilities fixed in Thunderbird 91.4.0](/en-US/security/advisories/mfsa2021-54/)

### [# Fixed in Thunderbird 91.3](#thunderbird91.3)

* [2021-50 Security Vulnerabilities fixed in Thunderbird 91.3](/en-US/security/advisories/mfsa2021-50/)

### [# Fixed in Thunderbird 91.2](#thunderbird91.2)

* [2021-47 Security Vulnerabilities fixed in Thunderbird 91.2](/en-US/security/advisories/mfsa2021-47/)

### [# Fixed in Thunderbird 91.1](#thunderbird91.1)

* [2021-41 Security Vulnerabilities fixed in Thunderbird 91.1](/en-US/security/advisories/mfsa2021-41/)

### [# Fixed in Thunderbird 91.0.1](#thunderbird91.0.1)

* [2021-37 Security Vulnerabilities fixed in Firefox 91.0.1 and Thunderbird 91.0.1](/en-US/security/advisories/mfsa2021-37/)

### [# Fixed in Thunderbird 91](#thunderbird91)

* [2021-36 Security Vulnerabilities fixed in Thunderbird 91](/en-US/security/advisories/mfsa2021-36/)

### [# Fixed in Thunderbird 78.14](#thunderbird78.14)

* [2021-42 Security Vulnerabilities fixed in Thunderbird 78.14](/en-US/security/advisories/mfsa2021-42/)

### [# Fixed in Thunderbird 78.13](#thunderbird78.13)

* [2021-35 Security Vulnerabilities fixed in Thunderbird 78.13](/en-US/security/advisories/mfsa2021-35/)

### [# Fixed in Thunderbird 78.12](#thunderbird78.12)

* [2021-30 Security Vulnerabilities fixed in Thunderbird 78.12](/en-US/security/advisories/mfsa2021-30/)

### [# Fixed in Thunderbird 78.11](#thunderbird78.11)

* [2021-26 Security Vulnerabilities fixed in Thunderbird 78.11](/en-US/security/advisories/mfsa2021-26/)

### [# Fixed in Thunderbird 78.10.2](#thunderbird78.10.2)

* [2021-22 Security Vulnerabilities fixed in Thunderbird 78.10.2](/en-US/security/advisories/mfsa2021-22/)

### [# Fixed in Thunderbird 78.10.1](#thunderbird78.10.1)

* [2021-19 Security Vulnerabilities fixed in Thunderbird 78.10.1](/en-US/security/advisories/mfsa2021-19/)

### [# Fixed in Thunderbird 78.10](#thunderbird78.10)

* [2021-14 Security Vulnerabilities fixed in Thunderbird 78.10](/en-US/security/advisories/mfsa2021-14/)

### [# Fixed in Thunderbird 78.9.1](#thunderbird78.9.1)

* [2021-13 Security Vulnerabilities fixed in Thunderbird 78.9.1](/en-US/security/advisories/mfsa2021-13/)

### [# Fixed in Thunderbird 78.9](#thunderbird78.9)

* [2021-12 Security Vulnerabilities fixed in Thunderbird 78.9](/en-US/security/advisories/mfsa2021-12/)

### [# Fixed in Thunderbird 78.8.1](#thunderbird78.8.1)

* [2021-17 Security Vulnerabilities fixed in Thunderbird 78.8.1](/en-US/security/advisories/mfsa2021-17/)

### [# Fixed in Thunderbird 78.8](#thunderbird78.8)

* [2021-09 Security Vulnerabilities fixed in Thunderbird 78.8](/en-US/security/advisories/mfsa2021-09/)

### [# Fixed in Thunderbird 78.7](#thunderbird78.7)

* [2021-05 Security Vulnerabilities fixed in Thunderbird 78.7](/en-US/security/advisories/mfsa2021-05/)

### [# Fixed in Thunderbird 78.6.1](#thunderbird78.6.1)

* [2021-02 Security Vulnerabilities fixed in Thunderbird 78.6.1](/en-US/security/advisories/mfsa2021-02/)

### [# Fixed in Thunderbird 78.6](#thunderbird78.6)

* [2020-56 Security Vulnerabilities fixed in Thunderbird 78.6](/en-US/security/advisories/mfsa2020-56/)

### [# Fixed in Thunderbird 78.5.1](#thunderbird78.5.1)

* [2020-53 Security Vulnerabilities fixed in Thunderbird 78.5.1](/en-US/security/advisories/mfsa2020-53/)

### [# Fixed in Thunderbird 78.5](#thunderbird78.5)

* [2020-52 Security Vulnerabilities fixed in Thunderbird 78.5](/en-US/security/advisories/mfsa2020-52/)

### [# Fixed in Thunderbird 78.4.2](#thunderbird78.4.2)

* [2020-49 Security Vulnerabilities fixed in Firefox 82.0.3, Firefox ESR 78.4.1, and Thunderbird 78.4.2](/en-US/security/advisories/mfsa2020-49/)

### [# Fixed in Thunderbird 78.4](#thunderbird78.4)

* [2020-47 Security Vulnerabilities fixed in Thunderbird 78.4](/en-US/security/advisories/mfsa2020-47/)

### [# Fixed in Thunderbird 78.3](#thunderbird78.3)

* [2020-44 Security Vulnerabilities fixed in Thunderbird 78.3](/en-US/security/advisories/mfsa2020-44/)

### [# Fixed in Thunderbird 78.2](#thunderbird78.2)

* [2020-41 Security Vulnerabilities fixed in Thunderbird 78.2](/en-US/security/advisories/mfsa2020-41/)

### [# Fixed in Thunderbird 78.1](#thunderbird78.1)

* [2020-33 Security Vulnerabilities fixed in Thunderbird 78.1](/en-US/security/advisories/mfsa2020-33/)

### [# Fixed in Thunderbird 78](#thunderbird78)

* [2020-29 Security Vulnerabilities fixed in Thunderbird 78](/en-US/security/advisories/mfsa2020-29/)

### [# Fixed in Thunderbird 68.12](#thunderbird68.12)

* [2020-40 Security Vulnerabilities fixed in Thunderbird 68.12](/en-US/security/advisories/mfsa2020-40/)

### [# Fixed in Thunderbird 68.11](#thunderbird68.11)

* [2020-35 Security Vulnerabilities fixed in Thunderbird 68.11](/en-US/security/advisories/mfsa2020-35/)

### [# Fixed in Thunderbird 68.10](#thunderbird68.10)

* [2020-26 Security Vulnerabilities fixed in Thunderbird 68.10.0](/en-US/security/advisories/mfsa2020-26/)

### [# Fixed in Thunderbird 68.9](#thunderbird68.9)

* [2020-22 Security Vulnerabilities fixed in Thunderbird 68.9.0](/en-US/security/advisories/mfsa2020-22/)

### [# Fixed in Thunderbird 68.8](#thunderbird68.8)

* [2020-18 Security Vulnerabilities fixed in Thunderbird 68.8.0](/en-US/security/advisories/mfsa2020-18/)

### [# Fixed in Thunderbird 68.7](#thunderbird68.7)

* [2020-14 Security Vulnerabilities fixed in Thunderbird 68.7.0](/en-US/security/advisories/mfsa2020-14/)

### [# Fixed in Thunderbird 68.6](#thunderbird68.6)

* [2020-10 Security Vulnerabilities fixed in Thunderbird 68.6](/en-US/security/advisories/mfsa2020-10/)

### [# Fixed in Thunderbird 68.5](#thunderbird68.5)

* [2020-07 Security Vulnerabilities fixed in Thunderbird 68.5](/en-US/security/advisories/mfsa2020-07/)

### [# Fixed in Thunderbird 68.4.1](#thunderbird68.4.1)

* [2020-04 Security Vulnerabilities fixed in Thunderbird 68.4.1](/en-US/security/advisories/mfsa2020-04/)

### [# Fixed in Thunderbird 68.3](#thunderbird68.3)

* [2019-38 Security Vulnerabilities fixed in - Thunderbird 68.3](/en-US/security/advisories/mfsa2019-38/)

### [# Fixed in Thunderbird 68.2](#thunderbird68.2)

* [2019-35 Security vulnerabilities fixed in - Thunderbird 68.2](/en-US/security/advisories/mfsa2019-35/)

### [# Fixed in Thunderbird 68.1.1](#thunderbird68.1.1)

* [2019-32 Security vulnerabilities fixed in - Thunderbird 68.1.1](/en-US/security/advisories/mfsa2019-32/)

### [# Fixed in Thunderbird 68.1](#thunderbird68.1)

* [2019-30 Security vulnerabilities fixed in - Thunderbird 68.1](/en-US/security/advisories/mfsa2019-30/)

### [# Fixed in Thunderbird 68](#thunderbird68)

* [2019-28 Security vulnerabilities fixed in Thunderbird 68](/en-US/security/advisories/mfsa2019-28/)

### [# Fixed in Thunderbird 60.9](#thunderbird60.9)

* [2019-29 Security vulnerabilities fixed in - Thunderbird 60.9](/en-US/security/advisories/mfsa2019-29/)

### [# Fixed in Thunderbird 60.8](#thunderbird60.8)

* [2019-23 Security vulnerabilities fixed in Thunderbird 60.8](/en-US/security/advisories/mfsa2019-23/)

### [# Fixed in Thunderbird 60.7.2](#thunderbird60.7.2)

* [2019-20 Security vulnerabilities fixed in Thunderbird 60.7.2](/en-US/security/advisories/mfsa2019-20/)

### [# Fixed in Thunderbird 60.7.1](#thunderbird60.7.1)

* [2019-17 Security vulnerabilities fixed in Thunderbird 60.7.1](/en-US/security/advisories/mfsa2019-17/)

### [# Fixed in Thunderbird 60.7](#thunderbird60.7)

* [2019-15 Security vulnerabilities fixed in Thunderbird 60.7](/en-US/security/advisories/mfsa2019-15/)

### [# Fixed in Thunderbird 60.6.1](#thunderbird60.6.1)

* [2019-12 Security vulnerabilities fixed in Thunderbird 60.6.1](/en-US/security/advisories/mfsa2019-12/)

### [# Fixed in Thunderbird 60.6](#thunderbird60.6)

* [2019-11 Security vulnerabilities fixed in Thunderbird 60.6](/en-US/security/advisories/mfsa2019-11/)

### [# Fixed in Thunderbird 60.5.1](#thunderbird60.5.1)

* [2019-06 Security vulnerabilities fixed in Thunderbird 60.5.1](/en-US/security/advisories/mfsa2019-06/)

### [# Fixed in Thunderbird 60.5](#thunderbird60.5)

* [2019-03 Security vulnerabilities fixed in Thunderbird 60.5](/en-US/security/advisories/mfsa2019-03/)

### [# Fixed in Thunderbird 60.4](#thunderbird60.4)

* [2018-31 Security vulnerabilities fixed in Thunderbird 60.4](/en-US/security/advisories/mfsa2018-31/)

### [# Fixed in Thunderbird 60.3](#thunderbird60.3)

* [2018-28 Security vulnerabilities fixed in Thunderbird ESR 60.3](/en-US/security/advisories/mfsa2018-28/)

### [# Fixed in Thunderbird 60.2.1](#thunderbird60.2.1)

* [2018-25 Security vulnerabilities fixed in Thunderbird 60.2.1](/en-US/security/advisories/mfsa2018-25/)

### [# Fixed in Thunderbird 60](#thunderbird60)

* [2018-19 Security vulnerabilities fixed in Thunderbird 60](/en-US/security/advisories/mfsa2018-19/)

### [# Fixed in Thunderbird 52.9](#thunderbird52.9)

* [2018-18 Security vulnerabilities fixed in Thunderbird 52.9](/en-US/security/advisories/mfsa2018-18/)

### [# Fixed in Thunderbird 52.8](#thunderbird52.8)

* [2018-13 Security vulnerabilities fixed in Thunderbird 52.8](/en-US/security/advisories/mfsa2018-13/)

### [# Fixed in Thunderbird 52.7](#thunderbird52.7)

* [2018-09 Security vulnerabilities fixed in Thunderbird 52.7](/en-US/security/advisories/mfsa2018-09/)

### [# Fixed in Thunderbird 52.6](#thunderbird52.6)

* [2018-04 Security vulnerabilities fixed in Thunderbird 52.6](/en-US/security/advisories/mfsa2018-04/)

### [# Fixed in Thunderbird 52.5.2](#thunderbird52.5.2)

* [2017-30 Security vulnerabilities fixed in Thunderbird 52.5.2](/en-US/security/advisories/mfsa2017-30/)

### [# Fixed in Thunderbird 52.5](#thunderbird52.5)

* [2017-26 Security vulnerabilities fixed in Thunderbird 52.5](/en-US/security/advisories/mfsa2017-26/)

### [# Fixed in Thunderbird 52.4](#thunderbird52.4)

* [2017-23 Security vulnerabilities fixed in Thunderbird 52.4](/en-US/security/advisories/mfsa2017-23/)

### [# Fixed in Thunderbird 52.3](#thunderbird52.3)

* [2017-20 Security vulnerabilities fixed in Thunderbird 52.3](/en-US/security/advisories/mfsa2017-20/)

### [# Fixed in Thunderbird 52.2](#thunderbird52.2)

* [2017-17 Security vulnerabilities fixed in Thunderbird 52.2](/en-US/security/advisories/mfsa2017-17/)

### [# Fixed in Thunderbird 52.1](#thunderbird52.1)

* [2017-13 Security vulnerabilities fixed in Thunderbird 52.1](/en-US/security/advisories/mfsa2017-13/)

### [# Fixed in Thunderbird 52](#thunderbird52)

* [2017-09 Security vulnerabilities fixed in - Thunderbird 52](/en-US/security/advisories/mfsa2017-09/)

### [# Fixed in Thunderbird 45.8](#thunderbird45.8)

* [2017-07 Security vulnerabilities fixed in Thunderbird 45.8](/en-US/security/advisories/mfsa2017-07/)

### [# Fixed in Thunderbird 45.7](#thunderbird45.7)

* [2017-03 Security vulnerabilities fixed in Thunderbird 45.7](/en-US/security/advisories/mfsa2017-03/)

### [# Fixed in Thunderbird 45.6](#thunderbird45.6)

* [2016-96 Security vulnerabilities fixed in Thunderbird 45.6](/en-US/security/advisories/mfsa2016-96/)

### [# Fixed in Thunderbird 45.5.1](#thunderbird45.5.1)

* [2016-92 Firefox SVG Animation Remote Code Execution](/en-US/security/advisories/mfsa2016-92/)

### [# Fixed in Thunderbird 45.5](#thunderbird45.5)

* [2016-93 Security vulnerabilities fixed in Thunderbird 45.5](/en-US/security/advisories/mfsa2016-93/)

### [# Fixed in Thunderbird 45.4](#thunderbird45.4)

* [2016-88 Security vulnerabilities fixed in Thunderbird 45.4](/en-US/security/advisories/mfsa2016-88/)

### [# Fixed in Thunderbird 45.3](#thunderbird45.3)

* [2016-62 Miscellaneous memory safety hazards (rv:48.0 / rv:45.3)](/en-US/security/advisories/mfsa2016-62/)

### [# Fixed in Thunderbird 45.2](#thunderbird45.2)

* [2016-49 Miscellaneous memory safety hazards (rv:47.0 / rv:45.2)](/en-US/security/advisories/mfsa2016-49/)

### [# Fixed in Thunderbird 45.1](#thunderbird45.1)

* [2016-39 Miscellaneous memory safety hazards (rv:46.0 / rv:45.1 / rv:38.8)](/en-US/security/advisories/mfsa2016-39/)

### [# Fixed in Thunderbird 45](#thunderbird45)

* [2016-37 Font vulnerabilities in the Graphite 2 library](/en-US/security/advisories/mfsa2016-37/)
* [2016-36 Use-after-free during processing of DER encoded keys in NSS](/en-US/security/advisories/mfsa2016-36/)
* [2016-35 Buffer overflow during ASN.1 decoding in NSS](/en-US/security/advisories/mfsa2016-35/)
* [2016-34 Out-of-bounds read in HTML parser following a failed allocation](/en-US/security/advisories/mfsa2016-34/)
* [2016-27 Use-after-free during XML transformations](/en-US/security/advisories/mfsa2016-27/)
* [2016-24 Use-after-free in SetBody](/en-US/security/advisories/mfsa2016-24/)
* [2016-23 Use-after-free in HTML5 string parser](/en-US/security/advisories/mfsa2016-23/)
* [2016-20 Memory leak in libstagefright when deleting an array during MP4 processing](/en-US/security/advisories/mfsa2016-20/)
* [2016-19 Linux video memory DOS with Intel drivers](/en-US/security/advisories/mfsa2016-19/)
* [2016-18 CSP reports fail to strip location information for embedded iframe pages](/en-US/security/advisories/mfsa2016-18/)
* [2016-17 Local file overwriting and potential privilege escalation through CSP reports](/en-US/security/advisories/mfsa2016-17/)
* [2016-16 Miscellaneous memory safety hazards (rv:45.0 / rv:38.7)](/en-US/security/advisories/mfsa2016-16/)

### [# Fixed in Thunderbird 38.8](#thunderbird38.8)

* [2016-39 Miscellaneous memory safety hazards (rv:46.0 / rv:45.1 / rv:38.8)](/en-US/security/advisories/mfsa2016-39/)
* [2016-36 Use-after-free during processing of DER encoded keys in NSS](/en-US/security/advisories/mfsa2016-36/)

### [# Fixed in Thunderbird 38.7](#thunderbird38.7)

* [2016-37 Font vulnerabilities in the Graphite 2 library](/en-US/security/advisories/mfsa2016-37/)
* [2016-35 Buffer overflow during ASN.1 decoding in NSS](/en-US/security/advisories/mfsa2016-35/)
* [2016-34 Out-of-bounds read in HTML parser following a failed allocation](/en-US/security/advisories/mfsa2016-34/)
* [2016-31 Memory corruption with malicious NPAPI plugin](/en-US/security/advisories/mfsa2016-31/)
* [2016-27 Use-after-free during XML transformations](/en-US/security/advisories/mfsa2016-27/)
* [2016-24 Use-after-free in SetBody](/en-US/security/advisories/mfsa2016-24/)
* [2016-23 Use-after-free in HTML5 string parser](/en-US/security/advisories/mfsa2016-23/)
* [2016-20 Memory leak in libstagefright when deleting an array during MP4 processing](/en-US/security/advisories/mfsa2016-20/)
* [2016-17 Local file overwriting and potential privilege escalation through CSP reports](/en-US/security/advisories/mfsa2016-17/)
* [2016-16 Miscellaneous memory safety hazards (rv:45.0 / rv:38.7)](/en-US/security/advisories/mfsa2016-16/)

### [# Fixed in Thunderbird 38.6](#thunderbird38.6)

* [2016-14 Vulnerabilities in Graphite 2](/en-US/security/advisories/mfsa2016-14/)
* [2016-03 Buffer overflow in WebGL after out of memory allocation](/en-US/security/advisories/mfsa2016-03/)
* [2016-01 Miscellaneous memory safety hazards (rv:44.0 / rv:38.6)](/en-US/security/advisories/mfsa2016-01/)
* [2015-150 MD5 signatures accepted within TLS 1.2 ServerKeyExchange in server signature](/en-US/security/advisories/mfsa2015-150/)

### [# Fixed in Thunderbird 38.5](#thunderbird38.5)

* [2015-149 Cross-site reading attack through data and view-source URIs](/en-US/security/advisories/mfsa2015-149/)
* [2015-146 Integer overflow in MP4 playback in 64-bit versions](/en-US/security/advisories/mfsa2015-146/)
* [2015-145 Underflow through code inspection](/en-US/security/advisories/mfsa2015-145/)
* [2015-139 Integer overflow allocating extremely large textures](/en-US/security/advisories/mfsa2015-139/)
* [2015-134 Miscellaneous memory safety hazards (rv:43.0 / rv:38.5)](/en-US/security/advisories/mfsa2015-134/)

### [# Fixed in Thunderbird 38.4](#thunderbird38.4)

* [2015-133 NSS and NSPR memory corruption issues](/en-US/security/advisories/mfsa2015-133/)
* [2015-132 Mixed content WebSocket policy bypass through workers](/en-US/security/advisories/mfsa2015-132/)
* [2015-131 Vulnerabilities found through code inspection](/en-US/security/advisories/mfsa2015-131/)
* [2015-128 Memory corruption in libjar through zip files](/en-US/security/advisories/mfsa2015-128/)
* [2015-127 CORS preflight is bypassed when non-standard Content-Type headers are received](/en-US/security/advisories/mfsa2015-127/)
* [2015-123 Buffer overflow during image interactions in canvas](/en-US/security/advisories/mfsa2015-123/)
* [2015-122 Trailing whitespace in IP address hostnames can bypass same-origin policy](/en-US/security/advisories/mfsa2015-122/)
* [2015-116 Miscellaneous memory safety hazards (rv:42.0 / rv:38.4)](/en-US/security/advisories/mfsa2015-116/)

### [# Fixed in Thunderbird 38.3](#thunderbird38.3)

* [2015-113 Memory safety errors in libGLES in the ANGLE graphics library](/en-US/security/advisories/mfsa2015-113/)
* [2015-112 Vulnerabilities found through code inspection](/en-US/security/advisories/mfsa2015-112/)
* [2015-111 Errors in the handling of CORS preflight request headers](/en-US/security/advisories/mfsa2015-111/)
* [2015-110 Dragging and dropping images exposes final URL after redirects](/en-US/security/advisories/mfsa2015-110/)
* [2015-106 Use-after-free while manipulating HTML media content](/en-US/security/advisories/mfsa2015-106/)
* [2015-105 Buffer overflow while decoding WebM video](/en-US/security/advisories/mfsa2015-105/)
* [2015-101 Buffer overflow in libvpx while parsing vp9 format video](/en-US/security/advisories/mfsa2015-101/)
* [2015-100 Arbitrary file manipulation by local user through Mozilla updater](/en-US/security/advisories/mfsa2015-100/)
* [2015-96 Miscellaneous memory safety hazards (rv:41.0 / rv:38.3)](/en-US/security/advisories/mfsa2015-96/)

### [# Fixed in Thunderbird 38.2](#thunderbird38.2)

* [2015-90 Vulnerabilities found through code inspection](/en-US/security/advisories/mfsa2015-90/)
* [2015-88 Heap overflow in gdk-pixbuf when scaling bitmap images](/en-US/security/advisories/mfsa2015-88/)
* [2015-85 Out-of-bounds write with Updater and malicious MAR file](/en-US/security/advisories/mfsa2015-85/)
* [2015-84 Arbitrary file overwriting through Mozilla Maintenance Service with hard links](/en-US/security/advisories/mfsa2015-84/)
* [2015-79 Miscellaneous memory safety hazards (rv:40.0 / rv:38.2)](/en-US/security/advisories/mfsa2015-79/)

### [# Fixed in Thunderbird 38.1](#thunderbird38.1)

* [2015-71 NSS incorrectly permits skipping of ServerKeyExchange](/en-US/security/advisories/mfsa2015-71/)
* [2015-70 NSS accepts export-length DHE keys with regular DHE cipher suites](/en-US/security/advisories/mfsa2015-70/)
* [2015-67 Key pinning is ignored when overridable errors are encountered](/en-US/security/advisories/mfsa2015-67/)
* [2015-66 Vulnerabilities found through code inspection](/en-US/security/advisories/mfsa2015-66/)
* [2015-63 Use-after-free in Content Policy due to microtask execution error](/en-US/security/advisories/mfsa2015-63/)
* [2015-59 Miscellaneous memory safety hazards (rv:39.0 / rv:31.8 / rv:38.1)](/en-US/security/advisories/mfsa2015-59/)

### [# Fixed in Thunderbird 38.0.1](#thunderbird38.0.1)

* [2015-58 Mozilla Windows updater can be run outside of application directory](/en-US/security/advisories/mfsa2015-58/)
* [2015-57 Privilege escalation through IPC channel messages](/en-US/security/advisories/mfsa2015-57/)
* [2015-54 Buffer overflow when parsing compressed XML](/en-US/security/advisories/mfsa2015-54/)
* [2015-51 Use-after-free during text processing with vertical text enabled](/en-US/security/advisories/mfsa2015-51/)
* [2015-48 Buffer overflow with SVG content and CSS](/en-US/security/advisories/mfsa2015-48/)
* [2015-47 Buffer overflow parsing H.264 video with Linux Gstreamer](/en-US/security/advisories/mfsa2015-47/)
* [2015-46 Miscellaneous memory safety hazards (rv:38.0 / rv:31.7)](/en-US/security/advisories/mfsa2015-46/)

### [# Fixed in Thunderbird 31.8](#thunderbird31.8)

* [2015-71 NSS incorrectly permits skipping of ServerKeyExchange](/en-US/security/advisories/mfsa2015-71/)
* [2015-70 NSS accepts export-length DHE keys with regular DHE cipher suites](/en-US/security/advisories/mfsa2015-70/)
* [2015-66 Vulnerabilities found through code inspection](/en-US/security/advisories/mfsa2015-66/)
* [2015-59 Miscellaneous memory safety hazards (rv:39.0 / rv:31.8 / rv:38.1)](/en-US/security/advisories/mfsa2015-59/)

### [# Fixed in Thunderbird 31.7](#thunderbird31.7)

* [2015-57 Privilege escalation through IPC channel messages](/en-US/security/advisories/mfsa2015-57/)
* [2015-54 Buffer overflow when parsing compressed XML](/en-US/security/advisories/mfsa2015-54/)
* [2015-51 Use-after-free during text processing with vertical text enabled](/en-US/security/advisories/mfsa2015-51/)
* [2015-48 Buffer overflow with SVG content and CSS](/en-US/security/advisories/mfsa2015-48/)
* [2015-47 Buffer overflow parsing H.264 video with Linux Gstreamer](/en-US/security/advisories/mfsa2015-47/)
* [2015-46 Miscellaneous memory safety hazards (rv:38.0 / rv:31.7)](/en-US/security/advisories/mfsa2015-46/)

### [# Fixed in Thunderbird 31.6](#thunderbird31.6)

* [2015-40 Same-origin bypass through anchor navigation](/en-US/security/advisories/mfsa2015-40/)
* [2015-37 CORS requests should not follow 30x redirections after preflight](/en-US/security/advisories/mfsa2015-37/)
* [2015-33 resource:// documents can load privileged pages](/en-US/security/advisories/mfsa2015-33/)
* [2015-31 Use-after-free when using the Fluendo MP3 GStreamer plugin](/en-US/security/advisories/mfsa2015-31/)
* [2015-30 Miscellaneous memory safety hazards (rv:37.0 / rv:31.6)](/en-US/security/advisories/mfsa2015-30/)

### [# Fixed in Thunderbird 31.5](#thunderbird31.5)

* [2015-24 Reading of local files through manipulation of form autocomplete](/en-US/security/advisories/mfsa2015-24/)
* [2015-19 Out-of-bounds read and write while rendering SVG content](/en-US/security/advisories/mfsa2015-19/)
* [2015-16 Use-after-free in IndexedDB](/en-US/security/advisories/mfsa2015-16/)
* [2015-12 Invoking Mozilla updater will load locally stored DLL files](/en-US/security/advisories/mfsa2015-12/)
* [2015-11 Miscellaneous memory safety hazards (rv:36.0 / rv:31.5)](/en-US/security/advisories/mfsa2015-11/)

### [# Fixed in Thunderbird 31.4](#thunderbird31.4)

* [2015-04 Cookie injection through Proxy Authenticate responses](/en-US/security/advisories/mfsa2015-04/)
* [2015-03 sendBeacon requests lack an Origin header](/en-US/security/advisories/mfsa2015-03/)
* [2015-01 Miscellaneous memory safety hazards (rv:35.0 / rv:31.4)](/en-US/security/advisories/mfsa2015-01/)

### [# Fixed in Thunderbird 31.3](#thunderbird31.3)

* [2014-90 Apple CoreGraphics framework on OS X 10.10 logging input data to /tmp directory](/en-US/security/advisories/mfsa2014-90/)
* [2014-89 Bad casting from the BasicThebesLayer to BasicContainerLayer](/en-US/security/advisories/mfsa2014-89/)
* [2014-88 Buffer overflow while parsing media content](/en-US/security/advisories/mfsa2014-88/)
* [2014-87 Use-after-free during HTML5 parsing](/en-US/security/advisories/mfsa2014-87/)
* [2014-85 XMLHttpRequest crashes with some input streams](/en-US/security/advisories/mfsa2014-85/)
* [2014-83 Miscellaneous memory safety hazards (rv:34.0 / rv:31.3)](/en-US/security/advisories/mfsa2014-83/)

### [# Fixed in Thunderbird 31.2](#thunderbird31.2)

* [2014-81 Inconsistent video sharing within iframe](/en-US/security/advisories/mfsa2014-81/)
* [2014-79 Use-after-free interacting with text directionality](/en-US/security/advisories/mfsa2014-79/)
* [2014-77 Out-of-bounds write with WebM video](/en-US/security/advisories/mfsa2014-77/)
* [2014-76 Web Audio memory corruption issues with custom waveforms](/en-US/security/advisories/mfsa2014-76/)
* [2014-75 Buffer overflow during CSS manipulation](/en-US/security/advisories/mfsa2014-75/)
* [2014-74 Miscellaneous memory safety hazards (rv:33.0 / rv:31.2)](/en-US/security/advisories/mfsa2014-74/)

### [# Fixed in Thunderbird 31.1.2](#thunderbird31.1.2)

* [2014-73 RSA Signature Forgery in NSS](/en-US/security/advisories/mfsa2014-73/)

### [# Fixed in Thunderbird 31.1](#thunderbird31.1)

* [2014-72 Use-after-free setting text directionality](/en-US/security/advisories/mfsa2014-72/)
* [2014-70 Out-of-bounds read in Web Audio audio timeline](/en-US/security/advisories/mfsa2014-70/)
* [2014-69 Uninitialized memory use during GIF rendering](/en-US/security/advisories/mfsa2014-69/)
* [2014-68 Use-after-free during DOM interactions with SVG](/en-US/security/advisories/mfsa2014-68/)
* [2014-67 Miscellaneous memory safety hazards (rv:32.0 / rv:31.1 / rv:24.8)](/en-US/security/advisories/mfsa2014-67/)

### [# Fixed in Thunderbird 31](#thunderbird31)

* [2014-66 IFRAME sandbox same-origin access through redirect](/en-US/security/advisories/mfsa2014-66/)
* [2014-65 Certificate parsing broken by non-standard character encoding](/en-US/security/advisories/mfsa2014-65/)
* [2014-64 Crash in Skia library when scaling high quality images](/en-US/security/advisories/mfsa2014-64/)
* [2014-63 Use-after-free while when manipulating certificates in the trusted cache](/en-US/security/advisories/mfsa2014-63/)
* [2014-62 Exploitable WebGL crash with Cesium JavaScript library](/en-US/security/advisories/mfsa2014-62/)
* [2014-61 Use-after-free with FireOnStateChange event](/en-US/security/advisories/mfsa2014-61/)
* [2014-59 Use-after-free in DirectWrite font handling](/en-US/security/advisories/mfsa2014-59/)
* [2014-58 Use-after-free in Web Audio due to incorrect control message ordering](/en-US/security/advisories/mfsa2014-58/)
* [2014-57 Buffer overflow during Web Audio buffering for playback](/en-US/security/advisories/mfsa2014-57/)
* [2014-56 Miscellaneous memory safety hazards (rv:31.0 / rv:24.7)](/en-US/security/advisories/mfsa2014-56/)

### [# Fixed in Thunderbird 24.8.1](#thunderbird24.8.1)

* [2014-73 RSA Signature Forgery in NSS](/en-US/security/advisories/mfsa2014-73/)

### [# Fixed in Thunderbird 24.8](#thunderbird24.8)

* [2014-72 Use-after-free setting text directionality](/en-US/security/advisories/mfsa2014-72/)
* [2014-67 Miscellaneous memory safety hazards (rv:32.0 / rv:31.1 / rv:24.8)](/en-US/security/advisories/mfsa2014-67/)

### [# Fixed in Thunderbird 24.7](#thunderbird24.7)

* [2014-64 Crash in Skia library when scaling high quality images](/en-US/security/advisories/mfsa2014-64/)
* [2014-63 Use-after-free while when manipulating certificates in the trusted cache](/en-US/security/advisories/mfsa2014-63/)
* [2014-62 Exploitable WebGL crash with Cesium JavaScript library](/en-US/security/advisories/mfsa2014-62/)
* [2014-61 Use-after-free with FireOnStateChange event](/en-US/security/advisories/mfsa2014-61/)
* [2014-59 Use-after-free in DirectWrite font handling](/en-US/security/advisories/mfsa2014-59/)
* [2014-56 Miscellaneous memory safety hazards (rv:31.0 / rv:24.7)](/en-US/security/advisories/mfsa2014-56/)

### [# Fixed in Thunderbird 24.6](#thunderbird24.6)

* [2014-52 Use-after-free with SMIL Animation Controller](/en-US/security/advisories/mfsa2014-52/)
* [2014-49 Use-after-free and out of bounds issues found using Address Sanitizer](/en-US/security/advisories/mfsa2014-49/)
* [2014-48 Miscellaneous memory safety hazards (rv:30.0 / rv:24.6)](/en-US/security/advisories/mfsa2014-48/)

### [# Fixed in Thunderbird 24.5](#thunderbird24.5)

* [2014-46 Use-after-free in nsHostResolver](/en-US/security/advisories/mfsa2014-46/)
* [2014-44 Use-after-free in imgLoader while resizing images](/en-US/security/advisories/mfsa2014-44/)
* [2014-43 Cross-site scripting (XSS) using history navigations](/en-US/security/advisories/mfsa2014-43/)
* [2014-42 Privilege escalation through Web Notification API](/en-US/security/advisories/mfsa2014-42/)
* [2014-38 Buffer overflow when using non-XBL object as XBL](/en-US/security/advisories/mfsa2014-38/)
* [2014-37 Out of bounds read while decoding JPG images](/en-US/security/advisories/mfsa2014-37/)
* [2014-34 Miscellaneous memory safety hazards (rv:29.0 / rv:24.5)](/en-US/security/advisories/mfsa2014-34/)

### [# Fixed in Thunderbird 24.4](#thunderbird24.4)

* [2014-32 Out-of-bounds write through TypedArrayObject after neutering](/en-US/security/advisories/mfsa2014-32/)
* [2014-31 Out-of-bounds read/write through neutering ArrayBuffer objects](/en-US/security/advisories/mfsa2014-31/)
* [2014-30 Use-after-free in TypeObject](/en-US/security/advisories/mfsa2014-30/)
* [2014-29 Privilege escalation using WebIDL-implemented APIs](/en-US/security/advisories/mfsa2014-29/)
* [2014-28 SVG filters information disclosure through feDisplacementMap](/en-US/security/advisories/mfsa2014-28/)
* [2014-27 Memory corruption in Cairo during PDF font rendering](/en-US/security/advisories/mfsa2014-27/)
* [2014-26 Information disclosure through polygon rendering in MathML](/en-US/security/advisories/mfsa2014-26/)
* [2014-17 Out of bounds read during WAV file decoding](/en-US/security/advisories/mfsa2014-17/)
* [2014-16 Files extracted during updates are not always read only](/en-US/security/advisories/mfsa2014-16/)
* [2014-15 Miscellaneous memory safety hazards (rv:28.0 / rv:24.4)](/en-US/security/advisories/mfsa2014-15/)

### [# Fixed in Thunderbird 24.3](#thunderbird24.3)

* [2014-13 Inconsistent JavaScript handling of access to Window objects](/en-US/security/advisories/mfsa2014-13/)
* [2014-12 NSS ticket handling issues](/en-US/security/advisories/mfsa2014-12/)
* [2014-09 Cross-origin information leak through web workers](/en-US/security/advisories/mfsa2014-09/)
* [2014-08 Use-after-free with imgRequestProxy and image proccessing](/en-US/security/advisories/mfsa2014-08/)
* [2014-04 Incorrect use of discarded images by RasterImage](/en-US/security/advisories/mfsa2014-04/)
* [2014-02 Clone protected content with XBL scopes](/en-US/security/advisories/mfsa2014-02/)
* [2014-01 Miscellaneous memory safety hazards (rv:27.0 / rv:24.3)](/en-US/security/advisories/mfsa2014-01/)

### [# Fixed in Thunderbird 24.2](#thunderbird24.2)

* [2013-117 Mis-issued ANSSI/DCSSI certificate](/en-US/security/advisories/mfsa2013-117/)
* [2013-116 JPEG information leak](/en-US/security/advisories/mfsa2013-116/)
* [2013-115 GetElementIC typed array stubs can be generated outside observed typesets](/en-US/security/advisories/mfsa2013-115/)
* [2013-114 Use-after-free in synthetic mouse movement](/en-US/security/advisories/mfsa2013-114/)
* [2013-113 Trust settings for built-in roots ignored during EV certificate validation](/en-US/security/advisories/mfsa2013-113/)
* [2013-111 Segmentation violation when replacing ordered list elements](/en-US/security/advisories/mfsa2013-111/)
* [2013-109 Use-after-free during Table Editing](/en-US/security/advisories/mfsa2013-109/)
* [2013-108 Use-after-free in event listeners](/en-US/security/advisories/mfsa2013-108/)
* [2013-104 Miscellaneous memory safety hazards (rv:26.0 / rv:24.2)](/en-US/security/advisories/mfsa2013-104/)

### [# Fixed in Thunderbird 24.1.1](#thunderbird24.1.1)

* [2013-103 Miscellaneous Network Security Services (NSS) vulnerabilities](/en-US/security/advisories/mfsa2013-103/)

### [# Fixed in Thunderbird 24.1](#thunderbird24.1)

* [2013-102 Use-after-free in HTML document templates](/en-US/security/advisories/mfsa2013-102/)
* [2013-101 Memory corruption in workers](/en-US/security/advisories/mfsa2013-101/)
* [2013-100 Miscellaneous use-after-free issues found through ASAN fuzzing](/en-US/security/advisories/mfsa2013-100/)
* [2013-98 Use-after-free when updating offline cache](/en-US/security/advisories/mfsa2013-98/)
* [2013-97 Writing to cycle collected object during image decoding](/en-US/security/advisories/mfsa2013-97/)
* [2013-96 Improperly initialized memory and overflows in some JavaScript functions](/en-US/security/advisories/mfsa2013-96/)
* [2013-95 Access violation with XSLT and uninitialized data](/en-US/security/advisories/mfsa2013-95/)
* [2013-94 Spoofing addressbar though SELECT element](/en-US/security/advisories/mfsa2013-94/)
* [2013-93 Miscellaneous memory safety hazards (rv:25.0 / rv:24.1 / rv:17.0.10)](/en-US/security/advisories/mfsa2013-93/)

### [# Fixed in Thunderbird 24](#thunderbird24)

* [2013-92 GC hazard with default compartments and frame chain restoration](/en-US/security/advisories/mfsa2013-92/)
* [2013-91 User-defined properties on DOM proxies get the wrong "this" object](/en-US/security/advisories/mfsa2013-91/)
* [2013-90 Memory corruption involving scrolling](/en-US/security/advisories/mfsa2013-90/)
* [2013-89 Buffer overflow with multi-column, lists, and floats](/en-US/security/advisories/mfsa2013-89/)
* [2013-88 Compartment mismatch re-attaching XBL-backed nodes](/en-US/security/advisories/mfsa2013-88/)
* [2013-85 Uninitialized data in IonMonkey](/en-US/security/advisories/mfsa2013-85/)
* [2013-83 Mozilla Updater does not lock MAR file after signature verification](/en-US/security/advisories/mfsa2013-83/)
* [2013-82 Calling scope for new Javascript objects can lead to memory corruption](/en-US/security/advisories/mfsa2013-82/)
* [2013-81 Use-after-free with select element](/en-US/security/advisories/mfsa2013-81/)
* [2013-80 NativeKey continues handling key messages after widget is destroyed](/en-US/security/advisories/mfsa2013-80/)
* [2013-79 Use-after-free in Animation Manager during stylesheet cloning](/en-US/security/advisories/mfsa2013-79/)
* [2013-77 Improper state in HTML5 Tree Builder with templates](/en-US/security/advisories/mfsa2013-77/)
* [2013-76 Miscellaneous memory safety hazards (rv:24.0 / rv:17.0.9)](/en-US/security/advisories/mfsa2013-76/)

### [# Fixed in Thunderbird 23](#thunderbird23)

* [2014-14 Script execution in HTML mail replies](/en-US/security/advisories/mfsa2014-14/)

### [# Fixed in Thunderbird 17.0.8](#thunderbird17.0.8)

* [2013-75 Local Java applets may read contents of local file system](/en-US/security/advisories/mfsa2013-75/)
* [2013-73 Same-origin bypass with web workers and XMLHttpRequest](/en-US/security/advisories/mfsa2013-73/)
* [2013-72 Wrong principal used for validating URI for some Javascript components](/en-US/security/advisories/mfsa2013-72/)
* [2013-71 Further Privilege escalation through Mozilla Updater](/en-US/security/advisories/mfsa2013-71/)
* [2013-69 CRMF requests allow for code execution and XSS attacks](/en-US/security/advisories/mfsa2013-69/)
* [2013-68 Document URI misrepresentation and masquerading](/en-US/security/advisories/mfsa2013-68/)
* [2013-66 Buffer overflow in Mozilla Maintenance Service and Mozilla Updater](/en-US/security/advisories/mfsa2013-66/)
* [2013-63 Miscellaneous memory safety hazards (rv:23.0 / rv:17.0.8)](/en-US/security/advisories/mfsa2013-63/)

### [# Fixed in Thunderbird 17.0.7](#thunderbird17.0.7)

* [2013-59 XrayWrappers can be bypassed to run user defined methods in a privileged context](/en-US/security/advisories/mfsa2013-59/)
* [2013-56 PreserveWrapper has inconsistent behavior](/en-US/security/advisories/mfsa2013-56/)
* [2013-55 SVG filters can lead to information disclosure](/en-US/security/advisories/mfsa2013-55/)
* [2013-54 Data in the body of XHR HEAD requests leads to CSRF attacks](/en-US/security/advisories/mfsa2013-54/)
* [2013-53 Execution of unmapped memory through onreadystatechange event](/en-US/security/advisories/mfsa2013-53/)
* [2013-51 Privileged content access and execution via XBL](/en-US/security/advisories/mfsa2013-51/)
* [2013-50 Memory corruption found using Address Sanitizer](/en-US/security/advisories/mfsa2013-50/)
* [2013-49 Miscellaneous memory safety hazards (rv:22.0 / rv:17.0.7)](/en-US/security/advisories/mfsa2013-49/)

### [# Fixed in Thunderbird 17.0.6](#thunderbird17.0.6)

* [2013-48 Memory corruption found using Address Sanitizer](/en-US/security/advisories/mfsa2013-48/)
* [2013-47 Uninitialized functions in DOMSVGZoomEvent](/en-US/security/advisories/mfsa2013-47/)
* [2013-46 Use-after-free with video and onresize event](/en-US/security/advisories/mfsa2013-46/)
* [2013-44 Local privilege escalation through Mozilla Maintenance Service](/en-US/security/advisories/mfsa2013-44/)
* [2013-42 Privileged access for content level constructor](/en-US/security/advisories/mfsa2013-42/)
* [2013-41 Miscellaneous memory safety hazards (rv:21.0 / rv:17.0.6)](/en-US/security/advisories/mfsa2013-41/)

### [# Fixed in Thunderbird 17.0.5](#thunderbird17.0.5)

* [2013-40 Out-of-bounds array read in CERT\_DecodeCertPackage](/en-US/security/advisories/mfsa2013-40/)
* [2013-38 Cross-site scripting (XSS) using timed history navigations](/en-US/security/advisories/mfsa2013-38/)
* [2013-36 Bypass of SOW protections allows cloning of protected nodes](/en-US/security/advisories/mfsa2013-36/)
* [2013-35 WebGL crash with Mesa graphics driver on Linux](/en-US/security/advisories/mfsa2013-35/)
* [2013-34 Privilege escalation through Mozilla Updater](/en-US/security/advisories/mfsa2013-34/)
* [2013-32 Privilege escalation through Mozilla Maintenance Service](/en-US/security/advisories/mfsa2013-32/)
* [2013-31 Out-of-bounds write in Cairo library](/en-US/security/advisories/mfsa2013-31/)
* [2013-30 Miscellaneous memory safety hazards (rv:20.0 / rv:17.0.5)](/en-US/security/advisories/mfsa2013-30/)

### [# Fixed in Thunderbird 17.0.4](#thunderbird17.0.4)

* [2013-29 Use-after-free in HTML Editor](/en-US/security/advisories/mfsa2013-29/)

### [# Fixed in Thunderbird 17.0.3](#thunderbird17.0.3)

* [2013-28 Use-after-free, out of bounds read, and buffer overflow issues found using Address Sanitizer](/en-US/security/advisories/mfsa2013-28/)
* [2013-27 Phishing on HTTPS connection through malicious proxy](/en-US/security/advisories/mfsa2013-27/)
* [2013-26 Use-after-free in nsImageLoadingContent](/en-US/security/advisories/mfsa2013-26/)
* [2013-25 Privacy leak in JavaScript Workers](/en-US/security/advisories/mfsa2013-25/)
* [2013-24 Web content bypass of COW and SOW security wrappers](/en-US/security/advisories/mfsa2013-24/)
* [2013-21 Miscellaneous memory safety hazards (rv:19.0 / rv:17.0.3)](/en-US/security/advisories/mfsa2013-21/)

### [# Fixed in Thunderbird 17.0.2](#thunderbird17.0.2)

* [2013-20 Mis-issued TURKTRUST certificates](/en-US/security/advisories/mfsa2013-20/)
* [2013-19 Use-after-free in Javascript Proxy objects](/en-US/security/advisories/mfsa2013-19/)
* [2013-18 Use-after-free in Vibrate](/en-US/security/advisories/mfsa2013-18/)
* [2013-17 Use-after-free in ListenerManager](/en-US/security/advisories/mfsa2013-17/)
* [2013-16 Use-after-free in serializeToStream](/en-US/security/advisories/mfsa2013-16/)
* [2013-15 Privilege escalation through plugin objects](/en-US/security/advisories/mfsa2013-15/)
* [2013-14 Chrome Object Wrapper (COW) bypass through changing prototype](/en-US/security/advisories/mfsa2013-14/)
* [2013-13 Memory corruption in XBL with XML bindings containing SVG](/en-US/security/advisories/mfsa2013-13/)
* [2013-12 Buffer overflow in Javascript string concatenation](/en-US/security/advisories/mfsa2013-12/)
* [2013-11 Address space layout leaked in XBL objects](/en-US/security/advisories/mfsa2013-11/)
* [2013-10 Event manipulation in plugin handler to bypass same-origin policy](/en-US/security/advisories/mfsa2013-10/)
* [2013-09 Compartment mismatch with quickstubs returned values](/en-US/security/advisories/mfsa2013-09/)
* [2013-08 AutoWrapperChanger fails to keep objects alive during garbage collection](/en-US/security/advisories/mfsa2013-08/)
* [2013-07 Crash due to handling of SSL on threads](/en-US/security/advisories/mfsa2013-07/)
* [2013-05 Use-after-free when displaying table with many columns and column groups](/en-US/security/advisories/mfsa2013-05/)
* [2013-04 URL spoofing in addressbar during page loads](/en-US/security/advisories/mfsa2013-04/)
* [2013-03 Buffer Overflow in Canvas](/en-US/security/advisories/mfsa2013-03/)
* [2013-02 Use-after-free and buffer overflow issues found using Address Sanitizer](/en-US/security/advisories/mfsa2013-02/)
* [2013-01 Miscellaneous memory safety hazards (rv:18.0/ rv:10.0.12 / rv:17.0.2)](/en-US/security/advisories/mfsa2013-01/)

### [# Fixed in Thunderbird 17](#thunderbird17)

* [2012-106 Use-after-free, buffer overflow, and memory corruption issues found using Address Sanitizer](/en-US/security/advisories/mfsa2012-106/)
* [2012-105 Use-after-free and buffer overflow issues found using Address Sanitizer](/en-US/security/advisories/mfsa2012-105/)
* [2012-103 Frames can shadow top.location](/en-US/security/advisories/mfsa2012-103/)
* [2012-101 Improper character decoding in HZ-GB-2312 charset](/en-US/security/advisories/mfsa2012-101/)
* [2012-100 Improper security filtering for cross-origin wrappers](/en-US/security/advisories/mfsa2012-100/)
* [2012-99 XrayWrappers exposes chrome-only properties when not in chrome compartment](/en-US/security/advisories/mfsa2012-99/)
* [2012-97 XMLHttpRequest inherits incorrect principal within sandbox](/en-US/security/advisories/mfsa2012-97/)
* [2012-96 Memory corruption in str\_unescape](/en-US/security/advisories/mfsa2012-96/)
* [2012-94 Crash when combining SVG text on path with CSS](/en-US/security/advisories/mfsa2012-94/)
* [2012-93 evalInSanbox location context incorrectly applied](/en-US/security/advisories/mfsa2012-93/)
* [2012-92 Buffer overflow while rendering GIF images](/en-US/security/advisories/mfsa2012-92/)
* [2012-91 Miscellaneous memory safety hazards (rv:17.0/ rv:10.0.11)](/en-US/security/advisories/mfsa2012-91/)

### [# Fixed in Thunderbird 16.0.2](#thunderbird16.0.2)

* [2012-90 Fixes for Location object issues](/en-US/security/advisories/mfsa2012-90/)
* [2012-67 Installer will launch incorrect executable following new installation](/en-US/security/advisories/mfsa2012-67/)

### [# Fixed in Thunderbird 16.0.1](#thunderbird16.0.1)

* [2012-89 defaultValue security checks not applied](/en-US/security/advisories/mfsa2012-89/)
* [2012-88 Miscellaneous memory safety hazards (rv:16.0.1)](/en-US/security/advisories/mfsa2012-88/)

### [# Fixed in Thunderbird 16](#thunderbird16)

* [2012-87 Use-after-free in the IME State Manager](/en-US/security/advisories/mfsa2012-87/)
* [2012-86 Heap memory corruption issues found using Address Sanitizer](/en-US/security/advisories/mfsa2012-86/)
* [2012-85 Use-after-free, buffer overflow, and out of bounds read issues found using Address Sanitizer](/en-US/security/advisories/mfsa2012-85/)
* [2012-84 Spoofing and script injection through location.hash](/en-US/security/advisories/mfsa2012-84/)
* [2012-83 Chrome Object Wrapper (COW) does not disallow access to privileged functions or properties](/en-US/security/advisories/mfsa2012-83/)
* [2012-82 top object and location property accessible by plugins](/en-US/security/advisories/mfsa2012-82/)
* [2012-81 GetProperty function can bypass security checks](/en-US/security/advisories/mfsa2012-81/)
* [2012-80 Crash with invalid cast when using instanceof operator](/en-US/security/advisories/mfsa2012-80/)
* [2012-79 DOS and crash with full screen and history navigation](/en-US/security/advisories/mfsa2012-79/)
* [2012-77 Some DOMWindowUtils methods bypass security checks](/en-US/security/advisories/mfsa2012-77/)
* [2012-76 Continued access to initial origin after setting document.domain](/en-US/security/advisories/mfsa2012-76/)
* [2012-75 select element persistance allows for attacks](/en-US/security/advisories/mfsa2012-75/)
* [2012-74 Miscellaneous memory safety hazards (rv:16.0/ rv:10.0.8)](/en-US/security/advisories/mfsa2012-74/)

### [# Fixed in Thunderbird 15](#thunderbird15)

* [2012-72 Web console eval capable of executing chrome-privileged code](/en-US/security/advisories/mfsa2012-72/)
* [2012-70 Location object security checks bypassed by chrome code](/en-US/security/advisories/mfsa2012-70/)
* [2012-68 DOMParser loads linked resources in extensions when parsing text/html](/en-US/security/advisories/mfsa2012-68/)
* [2012-65 Out-of-bounds read in format-number in XSLT](/en-US/security/advisories/mfsa2012-65/)
* [2012-64 Graphite 2 memory corruption](/en-US/security/advisories/mfsa2012-64/)
* [2012-63 SVG buffer overflow and use-after-free issues](/en-US/security/advisories/mfsa2012-63/)
* [2012-62 WebGL use-after-free and memory corruption](/en-US/security/advisories/mfsa2012-62/)
* [2012-61 Memory corruption with bitmap format images with negative height](/en-US/security/advisories/mfsa2012-61/)
* [2012-59 Location object can be shadowed using Object.defineProperty](/en-US/security/advisories/mfsa2012-59/)
* [2012-58 Use-after-free issues found using Address Sanitizer](/en-US/security/advisories/mfsa2012-58/)
* [2012-57 Miscellaneous memory safety hazards (rv:15.0/ rv:10.0.7)](/en-US/security/advisories/mfsa2012-57/)

### [# Fixed in Thunderbird 14](#thunderbird14)

* [2012-56 Code execution through javascript: URLs](/en-US/security/advisories/mfsa2012-56/)
* [2012-53 Content Security Policy 1.0 implementation errors cause data leakage](/en-US/security/advisories/mfsa2012-53/)
* [2012-52 JSDependentString::undepend string conversion results in memory corruption](/en-US/security/advisories/mfsa2012-52/)
* [2012-51 X-Frame-Options header ignored when duplicated](/en-US/security/advisories/mfsa2012-51/)
* [2012-50 Out of bounds read in QCMS](/en-US/security/advisories/mfsa2012-50/)
* [2012-49 Same-compartment Security Wrappers can be bypassed](/en-US/security/advisories/mfsa2012-49/)
* [2012-48 use-after-free in nsGlobalWindow::PageHidden](/en-US/security/advisories/mfsa2012-48/)
* [2012-47 Improper filtering of javascript in HTML feed-view](/en-US/security/advisories/mfsa2012-47/)
* [2012-45 Spoofing issue with location](/en-US/security/advisories/mfsa2012-45/)
* [2012-44 Gecko memory corruption](/en-US/security/advisories/mfsa2012-44/)
* [2012-42 Miscellaneous memory safety hazards (rv:14.0/ rv:10.0.6)](/en-US/security/advisories/mfsa2012-42/)

### [# Fixed in Thunderbird 13](#thunderbird13)

* [2012-54 Clickjacking of certificate warning page](/en-US/security/advisories/mfsa2012-54/)
* [2012-40 Buffer overflow and use-after-free issues found using Address Sanitizer](/en-US/security/advisories/mfsa2012-40/)
* [2012-39 NSS parsing errors with zero length items](/en-US/security/advisories/mfsa2012-39/)
* [2012-38 Use-after-free while replacing/inserting a node in a document](/en-US/security/advisories/mfsa2012-38/)
* [2012-37 Information disclosure though Windows file shares and shortcut files](/en-US/security/advisories/mfsa2012-37/)
* [2012-36 Content Security Policy inline-script bypass](/en-US/security/advisories/mfsa2012-36/)
* [2012-35 Privilege escalation through Mozilla Updater and Windows Updater Service](/en-US/security/advisories/mfsa2012-35/)
* [2012-34 Miscellaneous memory safety hazards (rv:13.0/ rv:10.0.5)](/en-US/security/advisories/mfsa2012-34/)

### [# Fixed in Thunderbird 12](#thunderbird12)

* [2012-33 Potential site identity spoofing when loading RSS and Atom feeds](/en-US/security/advisories/mfsa2012-33/)
* [2012-32 HTTP Redirections and remote content can be read by javascript errors](/en-US/security/advisories/mfsa2012-32/)
* [2012-31 Off-by-one error in OpenType Sanitizer](/en-US/security/advisories/mfsa2012-31/)
* [2012-30 Crash with WebGL content using textImage2D](/en-US/security/advisories/mfsa2012-30/)
* [2012-29 Potential XSS through ISO-2022-KR/ISO-2022-CN decoding issues](/en-US/security/advisories/mfsa2012-29/)
* [2012-28 Ambiguous IPv6 in Origin headers may bypass webserver access restrictions](/en-US/security/advisories/mfsa2012-28/)
* [2012-27 Page load short-circuit can lead to XSS](/en-US/security/advisories/mfsa2012-27/)
* [2012-26 WebGL.drawElements may read illegal video memory due to FindMaxUshortElement error](/en-US/security/advisories/mfsa2012-26/)
* [2012-25 Potential memory corruption during font rendering using cairo-dwrite](/en-US/security/advisories/mfsa2012-25/)
* [2012-24 Potential XSS via multibyte content processing errors](/en-US/security/advisories/mfsa2012-24/)
* [2012-23 Invalid frees causes heap corruption in gfxImageSurface](/en-US/security/advisories/mfsa2012-23/)
* [2012-22 use-after-free in IDBKeyRange](/en-US/security/advisories/mfsa2012-22/)
* [2012-20 Miscellaneous memory safety hazards (rv:12.0/ rv:10.0.4)](/en-US/security/advisories/mfsa2012-20/)

### [# Fixed in Thunderbird 11](#thunderbird11)

* [2012-19 Miscellaneous memory safety hazards (rv:11.0/ rv:10.0.3 / rv:1.9.2.28)](/en-US/security/advisories/mfsa2012-19/)
* [2012-18 window.fullScreen writeable by untrusted content](/en-US/security/advisories/mfsa2012-18/)
* [2012-17 Crash when accessing keyframe cssText after dynamic modification](/en-US/security/advisories/mfsa2012-17/)
* [2012-16 Escalation of privilege with Javascript: URL as home page](/en-US/security/advisories/mfsa2012-16/)
* [2012-15 XSS with multiple Content Security Policy headers](/en-US/security/advisories/mfsa2012-15/)
* [2012-14 SVG issues found with Address Sanitizer](/en-US/security/advisories/mfsa2012-14/)
* [2012-13 XSS with Drag and Drop and Javascript: URL](/en-US/security/advisories/mfsa2012-13/)
* [2012-12 Use-after-free in shlwapi.dll](/en-US/security/advisories/mfsa2012-12/)

### [# Fixed in Thunderbird 10.0.2](#thunderbird10.0.2)

* [2012-11 libpng integer overflow](/en-US/security/advisories/mfsa2012-11/)

### [# Fixed in Thunderbird 10.0.1](#thunderbird10.0.1)

* [2012-10 use after free in nsXBLDocumentInfo::ReadPrototypeBindings](/en-US/security/advisories/mfsa2012-10/)

### [# Fixed in Thunderbird 10](#thunderbird10)

* [2012-08 Crash with malformed embedded XSLT stylesheets](/en-US/security/advisories/mfsa2012-08/)
* [2012-07 Potential Memory Corruption When Decoding Ogg Vorbis files](/en-US/security/advisories/mfsa2012-07/)
* [2012-06 Uninitialized memory appended when encoding icon images may cause information disclosure](/en-US/security/advisories/mfsa2012-06/)
* [2012-05 Frame scripts calling into untrusted objects bypass security checks](/en-US/security/advisories/mfsa2012-05/)
* [2012-04 Child nodes from nsDOMAttribute still accessible after removal of nodes](/en-US/security/advisories/mfsa2012-04/)
* [2012-03 <iframe> element exposed across domains via name attribute](/en-US/security/advisories/mfsa2012-03/)
* [2012-01 Miscellaneous memory safety hazards (rv:10.0/ 1.9.2.26)](/en-US/security/advisories/mfsa2012-01/)

### [# Fixed in Thunderbird 9](#thunderbird9)

* [2012-41 Use-after-free in nsHTMLSelectElement](/en-US/security/advisories/mfsa2012-41/)
* [2011-58 Crash scaling <video> to extreme sizes](/en-US/security/advisories/mfsa2011-58/)
* [2011-57 Crash when plugin removes itself on Mac OS X](/en-US/security/advisories/mfsa2011-57/)
* [2011-56 Key detection without JavaScript via SVG animation](/en-US/security/advisories/mfsa2011-56/)
* [2011-55 nsSVGValue out-of-bounds access](/en-US/security/advisories/mfsa2011-55/)
* [2011-54 Potentially exploitable crash in the YARR regular expression library](/en-US/security/advisories/mfsa2011-54/)
* [2011-53 Miscellaneous memory safety hazards (rv:9.0)](/en-US/security/advisories/mfsa2011-53/)

### [# Fixed in Thunderbird 8](#thunderbird8)

* [2011-52 Code execution via NoWaiverWrapper](/en-US/security/advisories/mfsa2011-52/)
* [2011-51 Cross-origin image theft on Mac with integrated Intel GPU](/en-US/security/advisories/mfsa2011-51/)
* [2011-50 Cross-origin data theft using canvas and Windows D2D](/en-US/security/advisories/mfsa2011-50/)
* [2011-49 Memory corruption while profiling using Firebug](/en-US/security/advisories/mfsa2011-49/)
* [2011-48 Miscellaneous memory safety hazards (rv:8.0)](/en-US/security/advisories/mfsa2011-48/)
* [2011-47 Potential XSS against sites using Shift-JIS](/en-US/security/advisories/mfsa2011-47/)

### [# Fixed in Thunderbird 7](#thunderbird7)

* [2012-02 Overly permissive IPv6 literal syntax](/en-US/security/advisories/mfsa2012-02/)
* [2011-44 Use after free reading OGG headers](/en-US/security/advisories/mfsa2011-44/)
* [2011-42 Potentially exploitable crash in the YARR regular expression library](/en-US/security/advisories/mfsa2011-42/)
* [2011-40 Code installation through holding down `Enter`](/en-US/security/advisories/mfsa2011-40/)
* [2011-39 Defense against multiple Location headers due to CRLF Injection](/en-US/security/advisories/mfsa2011-39/)
* [2011-36 Miscellaneous memory safety hazards (rv:7.0 / rv:1.9.2.23)](/en-US/security/advisories/mfsa2011-36/)

### [# Fixed in Thunderbird 6.0.2](#thunderbird6.0.2)

* [2011-35 Additional protection against fraudulent DigiNotar certificates](/en-US/security/advisories/mfsa2011-35/)

### [# Fixed in Thunderbird 6.0.1](#thunderbird6.0.1)

* [2011-34 Protection against fraudulent DigiNotar certificates](/en-US/security/advisories/mfsa2011-34/)

### [# Fixed in Thunderbird 6](#thunderbird6)

* [2011-38 XSS via plugins and shadowed window.location object](/en-US/security/advisories/mfsa2011-38/)
* [2011-31 Security issues addressed in Thunderbird 6](/en-US/security/advisories/mfsa2011-31/)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from bugzilla.redhat.com_fd27e1e0_20250126_122134.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1377543)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1377543)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1377543)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1377543

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1377543**](show_bug.cgi?id=1377543)
(CVE-2016-5257)
- [CVE-2016-5257](https://access.redhat.com/security/cve/CVE-2016-5257) Mozilla: Memory safety bugs fixed in Firefox ESR 45.4 (MFSA 2016-85, MFSA 2016-86)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-5257 Mozilla: Memory safety bugs fixed in Firefox ESR 45.4 (MFSA 201...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-5257 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | urgent | | [Severity:](page.cgi?id=fields.html#bug_severity) | urgent | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1369653](show_bug.cgi?id=1369653) | | TreeView+ | [depends on](buglist.cgi?bug_id=1377543&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1377543&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-09-20 05:18 UTC by Siddharth Sharma | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-25 17:28 UTC ([History](show_activity.cgi?id=1377543)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  cschalle jhorak security-response-team stransky | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-10-04 02:51:57 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:1912](https://access.redhat.com/errata/RHSA-2016%3A1912) | 0 | normal | SHIPPED\_LIVE | Critical: firefox security update | 2016-09-21 11:47:31 UTC | | Red Hat Product Errata | [RHSA-2016:1985](https://access.redhat.com/errata/RHSA-2016%3A1985) | 0 | normal | SHIPPED\_LIVE | Important: thunderbird security update | 2016-10-03 21:22:15 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1377543#c0)  Siddharth Sharma    2016-09-20 05:18:34 UTC  ``` Mozilla developers and community members Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, and Carsten Book reported memory safety bugs present in Firefox 48 and Firefox ESR 45.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort at least some of these could be exploited to run arbitrary code.  External Reference:  <https://www.mozilla.org/security/advisories/mfsa2016-85/> <https://www.mozilla.org/security/advisories/mfsa2016-86/>   ```  [Comment 1](show_bug.cgi?id=1377543#c1)  Siddharth Sharma    2016-09-20 05:18:43 UTC  ``` Acknowledgments:  Name: the Mozilla project Upstream: Mozilla developers, Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, Carsten Book   ```  [Comment 2](show_bug.cgi?id=1377543#c2)  errata-xmlrpc    2016-09-21 07:49:35 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7   Red Hat Enterprise Linux 6   Red Hat Enterprise Linux 5  Via RHSA-2016:1912 <https://rhn.redhat.com/errata/RHSA-2016-1912.html>   ```  [Comment 3](show_bug.cgi?id=1377543#c3)  errata-xmlrpc    2016-10-03 17:22:45 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 5   Red Hat Enterprise Linux 7   Red Hat Enterprise Linux 6  Via RHSA-2016:1985 <https://rhn.redhat.com/errata/RHSA-2016-1985.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1377543&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from rhn.redhat.com_72a7f8e3_20250125_221215.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2016:1912 - Security Advisory

Issued:
2016-09-21
Updated:
2016-09-21
# RHSA-2016:1912 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Critical: firefox security update

## Type/Severity

Security Advisory: Critical

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2016%3A1912)

## Topic

An update for firefox is now available for Red Hat Enterprise Linux 5, Red Hat Enterprise Linux 6, and Red Hat Enterprise Linux 7.

Red Hat Product Security has rated this update as having a security impact of Critical. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Mozilla Firefox is an open source web browser.

This update upgrades Firefox to version 45.4.0 ESR.

Security Fix(es):

* Multiple flaws were found in the processing of malformed web content. A web page containing malicious content could cause Firefox to crash or, potentially, execute arbitrary code with the privileges of the user running Firefox. (CVE-2016-5257, CVE-2016-5278, CVE-2016-5270, CVE-2016-5272, CVE-2016-5274, CVE-2016-5276, CVE-2016-5277, CVE-2016-5280, CVE-2016-5281, CVE-2016-5284, CVE-2016-5250, CVE-2016-5261)

Red Hat would like to thank the Mozilla project for reporting these issues. Upstream acknowledges Samuel Groß, Brian Carpenter, Mei Wang, Ryan Duff, Catalin Dumitru, Mozilla developers, Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, Carsten Book, Abhishek Arya, Atte Kettunen, and Nils as the original reporters.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

After installing the update, Firefox must be restarted for the changes to take effect.

## Affected Products

* Red Hat Enterprise Linux Server 7 x86\_64
* Red Hat Enterprise Linux Server 6 x86\_64
* Red Hat Enterprise Linux Server 6 i386
* Red Hat Enterprise Linux Server 5 x86\_64
* Red Hat Enterprise Linux Server 5 i386
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.4 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.3 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.2 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.6 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.4 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.3 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.2 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 7 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 6 i386
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 5 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 5 i386
* Red Hat Enterprise Linux Workstation 7 x86\_64
* Red Hat Enterprise Linux Workstation 6 x86\_64
* Red Hat Enterprise Linux Workstation 6 i386
* Red Hat Enterprise Linux Workstation 5 x86\_64
* Red Hat Enterprise Linux Workstation 5 i386
* Red Hat Enterprise Linux Desktop 7 x86\_64
* Red Hat Enterprise Linux Desktop 6 x86\_64
* Red Hat Enterprise Linux Desktop 6 i386
* Red Hat Enterprise Linux Desktop 5 x86\_64
* Red Hat Enterprise Linux Desktop 5 i386
* Red Hat Enterprise Linux for IBM z Systems 7 s390x
* Red Hat Enterprise Linux for IBM z Systems 6 s390x
* Red Hat Enterprise Linux for IBM z Systems 5 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.7 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.6 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.5 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.4 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.3 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.2 s390x
* Red Hat Enterprise Linux for Power, big endian 7 ppc64
* Red Hat Enterprise Linux for Power, big endian 6 ppc64
* Red Hat Enterprise Linux for Power, big endian 5 ppc
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.7 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.6 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.5 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.4 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.3 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.2 ppc64
* Red Hat Enterprise Linux for Power, little endian 7 ppc64le
* Red Hat Enterprise Linux for Scientific Computing 6 x86\_64
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.4 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.3 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.2 ppc64le
* Red Hat Enterprise Linux Server - TUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.6 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.3 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.2 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 7 s390x
* Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 6 s390x
* Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 5 s390x
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.4 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.3 ppc64le
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.4 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.3 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.2 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, big endian 7 ppc64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7 ppc64le
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6 i386
* Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension (for IBM z Systems) 6 s390x

## Fixes

* [BZ - 1361986](https://bugzilla.redhat.com/show_bug.cgi?id=1361986)
  - CVE-2016-5261 Mozilla: Integer overflow and memory corruption in WebSocketChannel (MFSA 2016-75, MFSA 2016-86)
* [BZ - 1361998](https://bugzilla.redhat.com/show_bug.cgi?id=1361998)
  - CVE-2016-5250 Mozilla: Resource Timing API is storing resources sent by the previous page (MFSA 2016-84, MFSA 2016-86)
* [BZ - 1377543](https://bugzilla.redhat.com/show_bug.cgi?id=1377543)
  - CVE-2016-5257 Mozilla: Memory safety bugs fixed in Firefox ESR 45.4 (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377549](https://bugzilla.redhat.com/show_bug.cgi?id=1377549)
  - CVE-2016-5278 Mozilla: Heap-buffer-overflow in nsBMPEncoder::AddImageFrame (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377552](https://bugzilla.redhat.com/show_bug.cgi?id=1377552)
  - CVE-2016-5270 Mozilla: Heap-buffer-overflow in nsCaseTransformTextRunFactory::TransformString (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377554](https://bugzilla.redhat.com/show_bug.cgi?id=1377554)
  - CVE-2016-5272 Mozilla: Bad cast in nsImageGeometryMixin (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377557](https://bugzilla.redhat.com/show_bug.cgi?id=1377557)
  - CVE-2016-5276 Mozilla: Heap-use-after-free in mozilla::a11y::DocAccessible::ProcessInvalidationList (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377558](https://bugzilla.redhat.com/show_bug.cgi?id=1377558)
  - CVE-2016-5274 Mozilla: use-after-free in nsFrameManager::CaptureFrameState (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377559](https://bugzilla.redhat.com/show_bug.cgi?id=1377559)
  - CVE-2016-5277 Mozilla: Heap-use-after-free in nsRefreshDriver::Tick (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377561](https://bugzilla.redhat.com/show_bug.cgi?id=1377561)
  - CVE-2016-5280 Mozilla: Use-after-free in mozilla::nsTextNodeDirectionalityMap::RemoveElementFromMap (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377563](https://bugzilla.redhat.com/show_bug.cgi?id=1377563)
  - CVE-2016-5281 Mozilla: use-after-free in DOMSVGLength (MFSA 2016-85, MFSA 2016-86)
* [BZ - 1377565](https://bugzilla.redhat.com/show_bug.cgi?id=1377565)
  - CVE-2016-5284 Mozilla: Add-on update site certificate pin expiration (MFSA 2016-85, MFSA 2016-86)

## CVEs

* [CVE-2016-5250](https://www.redhat.com/security/data/cve/CVE-2016-5250.html)
* [CVE-2016-5257](https://www.redhat.com/security/data/cve/CVE-2016-5257.html)
* [CVE-2016-5261](https://www.redhat.com/security/data/cve/CVE-2016-5261.html)
* [CVE-2016-5270](https://www.redhat.com/security/data/cve/CVE-2016-5270.html)
* [CVE-2016-5272](https://www.redhat.com/security/data/cve/CVE-2016-5272.html)
* [CVE-2016-5274](https://www.redhat.com/security/data/cve/CVE-2016-5274.html)
* [CVE-2016-5276](https://www.redhat.com/security/data/cve/CVE-2016-5276.html)
* [CVE-2016-5277](https://www.redhat.com/security/data/cve/CVE-2016-5277.html)
* [CVE-2016-5278](https://www.redhat.com/security/data/cve/CVE-2016-5278.html)
* [CVE-2016-5280](https://www.redhat.com/security/data/cve/CVE-2016-5280.html)
* [CVE-2016-5281](https://www.redhat.com/security/data/cve/CVE-2016-5281.html)
* [CVE-2016-5284](https://www.redhat.com/security/data/cve/CVE-2016-5284.html)

## References

* <https://access.redhat.com/security/updates/classification/#critical>
* <https://www.mozilla.org/en-US/security/known-vulnerabilities/firefox-esr/#firefoxesr45.4>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| x86\_64 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 54d5a0379377daeff48bb453c74382a5b9cd08d73188e68fb10d037bdee51231 |
| firefox-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 54d5a0379377daeff48bb453c74382a5b9cd08d73188e68fb10d037bdee51231 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |
| firefox-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 65fe15e250afae09cf4b3b40b4c68b8aab9b6f1e12e2daef7ee45f7232f74581 |
| firefox-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 65fe15e250afae09cf4b3b40b4c68b8aab9b6f1e12e2daef7ee45f7232f74581 |
| i386 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |

## Red Hat Enterprise Linux Server 5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el5\_11.src.rpm | SHA-256: 4fa8a079e68b1752c8646e2824674d7a934a77c7d00b23b06ec64f9514ca3c6f |
| x86\_64 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 6f36a46de438c9f9f549d7a0b1e34e305c417a8e493484ce11b63284dc330704 |
| firefox-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 6f36a46de438c9f9f549d7a0b1e34e305c417a8e493484ce11b63284dc330704 |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |
| firefox-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: df53e2fc9f816621debb3f151feab201ebbae3372a049022baf705857612b697 |
| firefox-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: df53e2fc9f816621debb3f151feab201ebbae3372a049022baf705857612b697 |
| ia64 | |
| i386 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.2

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - AUS 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - AUS 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - AUS 7.4

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - AUS 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - AUS 7.2

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| x86\_64 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 54d5a0379377daeff48bb453c74382a5b9cd08d73188e68fb10d037bdee51231 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |
| firefox-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 65fe15e250afae09cf4b3b40b4c68b8aab9b6f1e12e2daef7ee45f7232f74581 |
| i386 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el5\_11.src.rpm | SHA-256: 4fa8a079e68b1752c8646e2824674d7a934a77c7d00b23b06ec64f9514ca3c6f |
| x86\_64 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 6f36a46de438c9f9f549d7a0b1e34e305c417a8e493484ce11b63284dc330704 |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |
| firefox-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: df53e2fc9f816621debb3f151feab201ebbae3372a049022baf705857612b697 |
| i386 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |

## Red Hat Enterprise Linux Workstation 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Workstation 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| x86\_64 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 54d5a0379377daeff48bb453c74382a5b9cd08d73188e68fb10d037bdee51231 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |
| firefox-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 65fe15e250afae09cf4b3b40b4c68b8aab9b6f1e12e2daef7ee45f7232f74581 |
| i386 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |

## Red Hat Enterprise Linux Workstation 5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el5\_11.src.rpm | SHA-256: 4fa8a079e68b1752c8646e2824674d7a934a77c7d00b23b06ec64f9514ca3c6f |
| x86\_64 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 6f36a46de438c9f9f549d7a0b1e34e305c417a8e493484ce11b63284dc330704 |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |
| firefox-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: df53e2fc9f816621debb3f151feab201ebbae3372a049022baf705857612b697 |
| i386 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |

## Red Hat Enterprise Linux Desktop 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Desktop 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| x86\_64 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 54d5a0379377daeff48bb453c74382a5b9cd08d73188e68fb10d037bdee51231 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |
| firefox-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 65fe15e250afae09cf4b3b40b4c68b8aab9b6f1e12e2daef7ee45f7232f74581 |
| i386 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |

## Red Hat Enterprise Linux Desktop 5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el5\_11.src.rpm | SHA-256: 4fa8a079e68b1752c8646e2824674d7a934a77c7d00b23b06ec64f9514ca3c6f |
| x86\_64 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: 6f36a46de438c9f9f549d7a0b1e34e305c417a8e493484ce11b63284dc330704 |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |
| firefox-debuginfo-45.4.0-1.el5\_11.x86\_64.rpm | SHA-256: df53e2fc9f816621debb3f151feab201ebbae3372a049022baf705857612b697 |
| i386 | |
| firefox-45.4.0-1.el5\_11.i386.rpm | SHA-256: a71185ae62c3178a9fd3c36b529d67c36528a46ee8768a8ffbdc5ce2167c10ad |
| firefox-debuginfo-45.4.0-1.el5\_11.i386.rpm | SHA-256: 85a408b367295ade29e5fb51ddf96b7e2b7efe98fbab2befe304eb785eb487dc |

## Red Hat Enterprise Linux for IBM z Systems 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux for IBM z Systems 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| s390x | |
| firefox-45.4.0-1.el6\_8.s390.rpm | SHA-256: 0a73f0f402f99bb617fcf6f32eb04c9201156f23673016d67e82b20caa80d480 |
| firefox-45.4.0-1.el6\_8.s390x.rpm | SHA-256: bdd96abd499399b4def6bb98203e343b4ff6dd95bcdc13502885be30ab6952ae |
| firefox-debuginfo-45.4.0-1.el6\_8.s390.rpm | SHA-256: 7e5b29a83096b89483d6f5f9b6ef11ac2886066793d91bd1838cae7994edbf6a |
| firefox-debuginfo-45.4.0-1.el6\_8.s390x.rpm | SHA-256: a9c68a51045a057e1b540fb7b3d3a61784271a5a020168ce37d12171452f1a45 |

## Red Hat Enterprise Linux for IBM z Systems 5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el5\_11.src.rpm | SHA-256: 4fa8a079e68b1752c8646e2824674d7a934a77c7d00b23b06ec64f9514ca3c6f |
| s390x | |
| firefox-45.4.0-1.el5\_11.s390.rpm | SHA-256: e283cf04b14dedc7b8b776186a8b3dc92d6965a8299e70d10ada14f7b6701914 |
| firefox-45.4.0-1.el5\_11.s390.rpm | SHA-256: e283cf04b14dedc7b8b776186a8b3dc92d6965a8299e70d10ada14f7b6701914 |
| firefox-45.4.0-1.el5\_11.s390x.rpm | SHA-256: 9b8adffb1aa46e8fd5a5aecf37cd8b5045fdab7e26242b785ad4c1832dde4f2d |
| firefox-45.4.0-1.el5\_11.s390x.rpm | SHA-256: 9b8adffb1aa46e8fd5a5aecf37cd8b5045fdab7e26242b785ad4c1832dde4f2d |
| firefox-debuginfo-45.4.0-1.el5\_11.s390.rpm | SHA-256: 06ae03a70f43ada5864058ec1c90ec1902d1f6e52e3b95e8c8d9cd451df93f12 |
| firefox-debuginfo-45.4.0-1.el5\_11.s390.rpm | SHA-256: 06ae03a70f43ada5864058ec1c90ec1902d1f6e52e3b95e8c8d9cd451df93f12 |
| firefox-debuginfo-45.4.0-1.el5\_11.s390x.rpm | SHA-256: 3d8d99a3df6dae4a9a68595a04160d700b4772d637da32d44ad8c19f392ab658 |
| firefox-debuginfo-45.4.0-1.el5\_11.s390x.rpm | SHA-256: 3d8d99a3df6dae4a9a68595a04160d700b4772d637da32d44ad8c19f392ab658 |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.2

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux for Power, big endian 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux for Power, big endian 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| ppc64 | |
| firefox-45.4.0-1.el6\_8.ppc.rpm | SHA-256: 221c55ebcd5863f7bd85156b264597867b851cd79bcb13f95f15c7c1e94dc780 |
| firefox-45.4.0-1.el6\_8.ppc64.rpm | SHA-256: 9ab6fde93a896cc953b7b02751746deda5936163cd93dad49b171e7f84885ee0 |
| firefox-debuginfo-45.4.0-1.el6\_8.ppc.rpm | SHA-256: e8f1420a725bd829f7c93899d75a164732e9e8c5fe623be045a2f72fc8a180fa |
| firefox-debuginfo-45.4.0-1.el6\_8.ppc64.rpm | SHA-256: 59d4138c9563c9d71d1c46868621685e9d65782d26281dd232ec0531c178a059 |

## Red Hat Enterprise Linux for Power, big endian 5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el5\_11.src.rpm | SHA-256: 4fa8a079e68b1752c8646e2824674d7a934a77c7d00b23b06ec64f9514ca3c6f |
| ppc | |
| firefox-45.4.0-1.el5\_11.ppc64.rpm | SHA-256: 56b27a5659a3a12b5732b9a2f529f998b1825092c11926d0b51de064dfbd454f |
| firefox-debuginfo-45.4.0-1.el5\_11.ppc64.rpm | SHA-256: 6f2dbca419e8edb22f26d2073a0ecec0230087b3307fe24321e9478389aed806 |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.2

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux for Power, little endian 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux for Scientific Computing 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| x86\_64 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 54d5a0379377daeff48bb453c74382a5b9cd08d73188e68fb10d037bdee51231 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |
| firefox-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 65fe15e250afae09cf4b3b40b4c68b8aab9b6f1e12e2daef7ee45f7232f74581 |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.2

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux Server - TUS 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - TUS 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - TUS 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - TUS 7.2

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| s390x | |
| firefox-45.4.0-1.el7\_2.s390.rpm | SHA-256: 1fe2fd34e64fb5deadb21f48ce1671f8859127350fa97a359e9ad12e801d80ef |
| firefox-45.4.0-1.el7\_2.s390x.rpm | SHA-256: fcff6e7fb239de4d54337d149c9314543eb5255c9fe8ddf5748c687419a87a34 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390.rpm | SHA-256: 47b74f84c3420080340299f6a635f762e1a20d6e94582f5b7b269371a8edf6f8 |
| firefox-debuginfo-45.4.0-1.el7\_2.s390x.rpm | SHA-256: af5999b896122137701b1289da9342d301033504b972b3c6f0d997bee4aa5f66 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| s390x | |
| firefox-45.4.0-1.el6\_8.s390.rpm | SHA-256: 0a73f0f402f99bb617fcf6f32eb04c9201156f23673016d67e82b20caa80d480 |
| firefox-45.4.0-1.el6\_8.s390x.rpm | SHA-256: bdd96abd499399b4def6bb98203e343b4ff6dd95bcdc13502885be30ab6952ae |
| firefox-debuginfo-45.4.0-1.el6\_8.s390.rpm | SHA-256: 7e5b29a83096b89483d6f5f9b6ef11ac2886066793d91bd1838cae7994edbf6a |
| firefox-debuginfo-45.4.0-1.el6\_8.s390x.rpm | SHA-256: a9c68a51045a057e1b540fb7b3d3a61784271a5a020168ce37d12171452f1a45 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 5

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el5\_11.src.rpm | SHA-256: 4fa8a079e68b1752c8646e2824674d7a934a77c7d00b23b06ec64f9514ca3c6f |
| s390x | |
| firefox-45.4.0-1.el5\_11.s390.rpm | SHA-256: e283cf04b14dedc7b8b776186a8b3dc92d6965a8299e70d10ada14f7b6701914 |
| firefox-45.4.0-1.el5\_11.s390x.rpm | SHA-256: 9b8adffb1aa46e8fd5a5aecf37cd8b5045fdab7e26242b785ad4c1832dde4f2d |
| firefox-debuginfo-45.4.0-1.el5\_11.s390.rpm | SHA-256: 06ae03a70f43ada5864058ec1c90ec1902d1f6e52e3b95e8c8d9cd451df93f12 |
| firefox-debuginfo-45.4.0-1.el5\_11.s390x.rpm | SHA-256: 3d8d99a3df6dae4a9a68595a04160d700b4772d637da32d44ad8c19f392ab658 |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.4

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.4

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.3

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.2

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| x86\_64 | |
| firefox-45.4.0-1.el7\_2.i686.rpm | SHA-256: 83be9775344f9e1bad938dec3f212aa7000d799bee2ec2399417248ad04b244c |
| firefox-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 7efdb73550a6d262bfcbcc6dac3c38a97e63d4863a9abf5344e13afb53093880 |
| firefox-debuginfo-45.4.0-1.el7\_2.i686.rpm | SHA-256: 063b93f7afc9963fcd8fab75b82cba0a7b507e80fa4d00f46e534bb0f6fffe94 |
| firefox-debuginfo-45.4.0-1.el7\_2.x86\_64.rpm | SHA-256: 1f9f8eb0685c2d5543477cc48f58320a34496e2f48c2da8868d164f18b5b1b6e |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, big endian 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64 | |
| firefox-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 4b1ae924930e7757dcfcba874cae78a954e59c6273c64ad8186c014839dddf88 |
| firefox-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: da8e63d6bda3dcafa4089d73a6d1594a1ece4bce42ac54c9b24809c3275dde53 |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc.rpm | SHA-256: 8bda966d3964f7897168855c5df8ff509e84121d3ea489f63bd6a4e33fc2a3ad |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64.rpm | SHA-256: 48e81f4ac67f917987fcdd89f1d4be11ac545377ae9c19d36eff2d21c709629c |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el7\_2.src.rpm | SHA-256: 882263809902202f6142bd5121fb26405204ed466283e51f8de006ab1e70d408 |
| ppc64le | |
| firefox-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: f350fbc01c8a6b1238060aff1c753821101288a507b810d6a1a0ea84cf2c82ac |
| firefox-debuginfo-45.4.0-1.el7\_2.ppc64le.rpm | SHA-256: fc0719dfaf047fa279fbd647a87f1c53170dca82f04cda016f8bcd0eeb61658f |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| x86\_64 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 54d5a0379377daeff48bb453c74382a5b9cd08d73188e68fb10d037bdee51231 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |
| firefox-debuginfo-45.4.0-1.el6\_8.x86\_64.rpm | SHA-256: 65fe15e250afae09cf4b3b40b4c68b8aab9b6f1e12e2daef7ee45f7232f74581 |
| i386 | |
| firefox-45.4.0-1.el6\_8.i686.rpm | SHA-256: 9b57e745941f2f110b5de29df3515057ef7811650582581fa0071c74467451e9 |
| firefox-debuginfo-45.4.0-1.el6\_8.i686.rpm | SHA-256: 2af1aa7872a8f7b25e7a863bcdeb960fbc28d5e330e4e892958b7b9e75172514 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support Extension (for IBM z Systems) 6

| SRPM | |
| --- | --- |
| firefox-45.4.0-1.el6\_8.src.rpm | SHA-256: 0052c3b42ea0616602a6f545e687e7a016756a78506c0a5f7248a0651ee85df3 |
| s390x | |
| firefox-45.4.0-1.el6\_8.s390.rpm | SHA-256: 0a73f0f402f99bb617fcf6f32eb04c9201156f23673016d67e82b20caa80d480 |
| firefox-45.4.0-1.el6\_8.s390x.rpm | SHA-256: bdd96abd499399b4def6bb98203e343b4ff6dd95bcdc13502885be30ab6952ae |
| firefox-debuginfo-45.4.0-1.el6\_8.s390.rpm | SHA-256: 7e5b29a83096b89483d6f5f9b6ef11ac2886066793d91bd1838cae7994edbf6a |
| firefox-debuginfo-45.4.0-1.el6\_8.s390x.rpm | SHA-256: a9c68a51045a057e1b540fb7b3d3a61784271a5a020168ce37d12171452f1a45 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.mozilla.org_0eb23535_20250126_122119.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Sun Jan 26 2025 04:21:19 PST

* **Bug ID:**
  1290244,
  1282746,
  1268034,
  1296078,
  1297099,
  1276413,
  1296087

---

| [ID](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=bug_id%20DESC&query_based_on=) | [Type](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=bug_type%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Summary](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=short_desc%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Product](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=product%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Comp](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=component%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Assignee▲](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=assigned_to%20DESC%2Cbug_status%2Cpriority%2Cbug_id&query_based_on=) | [Status▲](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=bug_status%20DESC%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Resolution](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=resolution%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) | [Updated](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&order=changeddate%2Cbug_status%2Cpriority%2Cassigned_to%2Cbug_id&query_based_on=) |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |
| [1297099](/show_bug.cgi?id=1297099 "RESOLVED FIXED - LoadManagerSingleton weak reference used on multiple threads") |  | [LoadManagerSingleton weak reference used on multiple threads](/show_bug.cgi?id=1297099) | Core | Audio/Video: MediaSt | apehrson | RESO | FIXE | 2017-02-09 |
| [1290244](/show_bug.cgi?id=1290244 "RESOLVED FIXED - Crash: double-free [@xcb_render_create_picture]") |  | [Crash: double-free [@xcb\_render\_create\_picture]](/show_bug.cgi?id=1290244) | Core | Graphics: Layers | andrew | RESO | FIXE | 2017-02-09 |
| [1282746](/show_bug.cgi?id=1282746 "RESOLVED FIXED - Assertion failure: comp == compartment || runtime()->isAtomsCompartment(comp) || (srcKind == JS::TraceKind::Object && InCrossCompartmentMap(static_cast<JSObject*>(src), thing)), at js/src/jsgc.cpp:3745") |  | [Assertion failure: comp == compartment || runtime()->isAtomsCompartment(comp) || (srcKind == JS::TraceKind::Object && InCrossCompartmentMap(static\_cast<JSObject\*>(src), thing)), at js/src/jsgc.cpp:3745](/show_bug.cgi?id=1282746) | Core | JavaScript Engine | efaustbmo | RESO | FIXE | 2017-01-04 |
| [1296078](/show_bug.cgi?id=1296078 "RESOLVED FIXED - format string mismatch in CreateDXVAManagerEvent::Run()") |  | [format string mismatch in CreateDXVAManagerEvent::Run()](/show_bug.cgi?id=1296078) | Core | Audio/Video | froydnj+bz | RESO | FIXE | 2017-08-28 |
| [1296087](/show_bug.cgi?id=1296087 "RESOLVED FIXED - IonCache getter stub may not correctly restore clobbered register") |  | [IonCache getter stub may not correctly restore clobbered register](/show_bug.cgi?id=1296087) | Core | JavaScript Engine: J | lists | RESO | FIXE | 2017-08-28 |
| [1276413](/show_bug.cgi?id=1276413 "RESOLVED FIXED - Clear the buffer we allocate for paletted image frames") |  | [Clear the buffer we allocate for paletted image frames](/show_bug.cgi?id=1276413) | Core | Graphics: ImageLib | seth.bugzilla | RESO | FIXE | 2017-08-28 |
| [1268034](/show_bug.cgi?id=1268034 "VERIFIED FIXED - Assertion failure: isObject(), at dist/include/js/Value.h:1281") |  | [Assertion failure: isObject(), at dist/include/js/Value.h:1281](/show_bug.cgi?id=1268034) | Core | JavaScript Engine | arai.unmht | VERI | FIXE | 2017-02-09 |

7 bugs found.

|  |  | [REST](/rest/bug?include_fields=id,summary,status&bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087 "Query as a REST API request") | [CSV](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&ctype=csv&human=1) | [Feed](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&title=Bug%20List&ctype=atom) | [iCalendar](/buglist.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&ctype=ics)  [Change Columns](/colchange.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced&query_based_on=) | [Edit Search](/query.cgi?bug_id=1290244%2C1282746%2C1268034%2C1296078%2C1297099%2C1276413%2C1296087&query_format=advanced) |  | as |
| --- | --- | --- | --- | --- | --- |

[File
a new bug
in the "Core" product](/enter_bug.cgi?product=Core)



=== Content from bugzilla.mozilla.org_31fac44d_20250125_221226.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1287204)
* [XML](/show_bug.cgi?ctype=xml&id=1287204)

Closed
[Bug 1287204](/show_bug.cgi?id=1287204)

Opened 9 years ago
Closed 8 years ago

# nsNodeUtils::CloneAndAdopt() incorrectly handles ReparentWrapper failure

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

nsNodeUtils::CloneAndAdopt() incorrectly handles ReparentWrapper failure

## Categories

### (Core :: DOM: Core & HTML, defect)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML#DOM%3A%20Core%20%26%20HTML)

DOM: Core & HTML
▾

Core :: DOM: Core & HTML
Issues in DOM tree [https://dom.spec.whatwg.org](https://dom.spec.whatwg.org/) & HTML [https://html.spec.whatwg.org](https://html.spec.whatwg.org/) that do not fit into any other DOM or HTML component or which span multiple DOM or HTML components.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Core%20%26%20HTML)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla51

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Performance Impact | --- |
| Accessibility Severity | --- |
| Webcompat Score | --- |
| Webcompat Priority | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |
| firefox51 | --- | [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 |  | wontfix |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | fixed |
| firefox51 |  | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: mccr8, Assigned: mccr8)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=40)  [mccr8](/user_profile?user_id=406194)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0a70c84cd33dba0151fe15f2f8773137?d=mm&size=40)  [mccr8](/user_profile?user_id=406194)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/5111b810214a00377104f5ad3efefa26?d=mm&size=40)  [sefeng](/user_profile?user_id=625922)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: sec-high, Whiteboard: [adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Fix typo in nsNodeUtils::CloneAndAdopt().](/attachment.cgi?id=8773353)  [9 years ago](#c4)  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)   905 bytes, patch | bzbarsky : [review+](#c5 "9 years ago")  abillings : [approval-mozilla-aurora+](#a1897590_280903 "8 years ago")  abillings : [approval-mozilla-beta+](#a1897590_280903 "8 years ago")  abillings : [approval-mozilla-esr45+](#a1897590_280903 "8 years ago")  abillings : [sec-approval+](#a600563_280903 "9 years ago") | [Details](/attachment.cgi?id=8773353&action=edit) | [Diff](/attachment.cgi?id=8773353&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1287204&attachment=8773353) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1287204#c0)• 9 years ago |
|  | |

Boiled down a bit, the code looks like this:
NodeInfo \*nodeInfo = aNode->mNodeInfo;
RefPtr<NodeInfo> newNodeInfo;
if (nodeInfoManager) {
...
newNodeInfo = // create a new node info
nodeInfo = newNodeInfo;
}
...
if (...) {
...
} else if (nodeInfoManager) {
...
aNode->mNodeInfo.swap(newNodeInfo);
...
if (aReparentScope) {
...
if (...) {
...
if (NS\_FAILED(rv)) {
aNode->mNodeInfo.swap(nodeInfo);
return rv;
}
}
}
}
After the first swap, aNode->mNodeInfo and nodeInfo both contain the new node (I'm assuming no method we call changed aNode->mNodeInfo), while newNodeInfo contains the original node.
The second swap is bogus: it is swapping a refcounted value and a raw pointer (it seems unfortunate that this is legal...). If these were not equal, you'd have a bad refcount problem (aNode->mNodeInfo would underflow its refcount when it was destroyed, and nodeInfo would leak), but it looks like they are the same, so we don't leak any objects.
Presumably the second swap is supposed to be newNodeInfo instead of nodeInfo.
As far as I can tell there's no security issue here, but given that wrappers and refcounting are involved I wanted to get a second opinion before making this bug public.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1287204#c1)• 9 years ago |
|  | |

For what it is worth, this bug appears to have been introduced in [bug 347524](/show_bug.cgi?id=347524 "RESOLVED FIXED - Refactor adoptNode, importNode and cloneNode to share implementation"):
<https://github.com/mozilla/gecko-dev/commit/64ec124ee5210d7673618c26900c8abd56bdd28b>

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1287204#c2)• 9 years ago |
|  | |

Ugh. I can't tell whether there's a security issue, but we end up with a node which is in one document but has a wrapper (and hence principal, via the wrapper!) from another document. I can't guarantee that this won't cause issues, especially when document.domain is involved.

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a4259_406194)• 9 years ago |

Assignee: nobody → continuation

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a8183_1689)• 9 years ago |

Group: core-security → dom-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1287204#c3)• 9 years ago |
|  | |

I'll just be conservative per [comment 2](/show_bug.cgi?id=1287204#c2 "RESOLVED FIXED - nsNodeUtils::CloneAndAdopt() incorrectly handles ReparentWrapper failure") and mark this sec-high. It might be difficult to exploit in practice (I think it requires an OOM at a precise point) but it seems like if somebody is very clever it could go very wrong. Honestly we might be better off just crashing here instead of trying to recover but whatever.
try run: <https://treeherder.mozilla.org/#/jobs?repo=try&revision=b856020e804e>Keywords: [sec-audit](/buglist.cgi?keywords=sec-audit&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1287204#c4)• 9 years ago |
|  | |

Attached patch

[Fix typo in nsNodeUtils::CloneAndAdopt().](attachment.cgi?id=8773353&action=diff)
— [Details](attachment.cgi?id=8773353&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1287204&attachment=8773353)

I'm not sure if we should land this now or just wait until the next beta, but I'll see what Al thinks.
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: review?(bzbarsky)

|  | [Boris Zbarsky [:bzbarsky]](/user_profile?user_id=20209) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1287204#c5)• 9 years ago |
|  | |

Comment on [attachment 8773353](/attachment.cgi?id=8773353 "Fix typo in nsNodeUtils::CloneAndAdopt().") [[details]](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") [[diff]](/attachment.cgi?id=8773353&action=diff "Fix typo in nsNodeUtils::CloneAndAdopt().") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287204&attachment=8773353)
Fix typo in nsNodeUtils::CloneAndAdopt().
r=me
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: review?(bzbarsky) → review+

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1287204#c6)• 9 years ago |
|  | |

Comment on [attachment 8773353](/attachment.cgi?id=8773353 "Fix typo in nsNodeUtils::CloneAndAdopt().") [[details]](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") [[diff]](/attachment.cgi?id=8773353&action=diff "Fix typo in nsNodeUtils::CloneAndAdopt().") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287204&attachment=8773353)
Fix typo in nsNodeUtils::CloneAndAdopt().
[Security approval request comment]
How easily could an exploit be constructed based on the patch? It would be hard to trigger reliably, and I'm not sure how easily this would lead to an exploit, but the problem is fairly clear from the patch.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem? no
Which older supported branches are affected by this flaw? this bug is around 10 years old
If not all supported branches, which bug introduced the flaw?
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be? should be the same
How likely is this patch to cause regressions; how much testing does it need? It shouldn't be too risky. If we get in this state, bad things probably happen right now, so this can only be better.
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1287204#c7)• 9 years ago |
|  | |

This is too late for the current release cycle so it will have to land two weeks into the next. I'm giving it sec-approval+ for checkin on August 16 (not before). We'll want patches for affected branches made and nominated at the same time as well.
[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)Whiteboard: [checkin on 8/16]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a600563_280903)• 9 years ago |

[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: sec-approval? → sec-approval+

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1287204#c8)• 9 years ago |
|  | |

I agree we shouldn't land this cycle, but I don't see a need to wait once the tree reopens.Whiteboard: [checkin on 8/16] → [checkin after 8/2]

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a1703684_406194)• 8 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)Whiteboard: [checkin after 8/2] → [checkin on 8/2]

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1287204#c9)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/6e875e1462fc68ee5deef2ce1923d4e351982d03>Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)Whiteboard: [checkin on 8/2]

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1287204#c10)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/6e875e1462fc>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla51

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1287204#c11)• 8 years ago |
|  | |

Comment on [attachment 8773353](/attachment.cgi?id=8773353 "Fix typo in nsNodeUtils::CloneAndAdopt().") [[details]](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") [[diff]](/attachment.cgi?id=8773353&action=diff "Fix typo in nsNodeUtils::CloneAndAdopt().") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1287204&attachment=8773353)
Fix typo in nsNodeUtils::CloneAndAdopt().
Approval Request Comment
[Feature/regressing bug #]: very old
[User impact if declined]: sec-high
[Describe test coverage new/current, TreeHerder]: this is an error case, so it probably is not tested
[Risks and why]: low, this just fixes one rare error case
[String/UUID change made/needed]: none
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-esr45?
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-beta?
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-aurora?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a1897590_280903)• 8 years ago |

[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-esr45?
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-esr45+
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-beta?
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-beta+
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-aurora?
[Attachment #8773353](/attachment.cgi?id=8773353&action=edit "Fix typo in nsNodeUtils::CloneAndAdopt().") -
Flags: approval-mozilla-aurora+

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1287204#c12)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/bd7ac9bc5d7b8285929c956025ee6bd30221fea6>
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1287204#c13)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/cab91bc0d960>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1287204#c14)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/a49fd7eb57ba>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a2057387_1689)• 8 years ago |

Group: dom-core-security → core-security-release

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a4589027_280903)• 8 years ago |

Whiteboard: [adv-main49+][adv-esr45.4+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a18039394_1689)• 8 years ago |

Group: core-security-release

|  | [Nobody; OK to take it and work on it](/user_profile?user_id=1) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1287204#a83868157_1)• 6 years ago |

Component: DOM → DOM: Core & HTML
You need to [log in](/show_bug.cgi?id=1287204&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Andrew McCreight [:mccr8]](/user_profile?user_id=406194)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from bugzilla.redhat.com_5816df7a_20250126_122127.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1377543)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1377543)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1377543)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1377543

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1377543**](show_bug.cgi?id=1377543)
(CVE-2016-5257)
- [CVE-2016-5257](https://access.redhat.com/security/cve/CVE-2016-5257) Mozilla: Memory safety bugs fixed in Firefox ESR 45.4 (MFSA 2016-85, MFSA 2016-86)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-5257 Mozilla: Memory safety bugs fixed in Firefox ESR 45.4 (MFSA 201...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-5257 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | urgent | | [Severity:](page.cgi?id=fields.html#bug_severity) | urgent | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1369653](show_bug.cgi?id=1369653) | | TreeView+ | [depends on](buglist.cgi?bug_id=1377543&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1377543&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-09-20 05:18 UTC by Siddharth Sharma | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-25 17:28 UTC ([History](show_activity.cgi?id=1377543)) | | [CC List:](page.cgi?id=fields.html#cclist) | 4 users (show)  cschalle jhorak security-response-team stransky | | Fixed In Version: |  | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2016-10-04 02:51:57 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2016:1912](https://access.redhat.com/errata/RHSA-2016%3A1912) | 0 | normal | SHIPPED\_LIVE | Critical: firefox security update | 2016-09-21 11:47:31 UTC | | Red Hat Product Errata | [RHSA-2016:1985](https://access.redhat.com/errata/RHSA-2016%3A1985) | 0 | normal | SHIPPED\_LIVE | Important: thunderbird security update | 2016-10-03 21:22:15 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1377543#c0)  Siddharth Sharma    2016-09-20 05:18:34 UTC  ``` Mozilla developers and community members Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, and Carsten Book reported memory safety bugs present in Firefox 48 and Firefox ESR 45.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort at least some of these could be exploited to run arbitrary code.  External Reference:  <https://www.mozilla.org/security/advisories/mfsa2016-85/> <https://www.mozilla.org/security/advisories/mfsa2016-86/>   ```  [Comment 1](show_bug.cgi?id=1377543#c1)  Siddharth Sharma    2016-09-20 05:18:43 UTC  ``` Acknowledgments:  Name: the Mozilla project Upstream: Mozilla developers, Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, Carsten Book   ```  [Comment 2](show_bug.cgi?id=1377543#c2)  errata-xmlrpc    2016-09-21 07:49:35 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7   Red Hat Enterprise Linux 6   Red Hat Enterprise Linux 5  Via RHSA-2016:1912 <https://rhn.redhat.com/errata/RHSA-2016-1912.html>   ```  [Comment 3](show_bug.cgi?id=1377543#c3)  errata-xmlrpc    2016-10-03 17:22:45 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 5   Red Hat Enterprise Linux 7   Red Hat Enterprise Linux 6  Via RHSA-2016:1985 <https://rhn.redhat.com/errata/RHSA-2016-1985.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1377543&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.redhat.com_c3473b4a_20250126_122139.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.mozilla.org_fc3cc69a_20250125_221248.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2016-88

## Security vulnerabilities fixed in Thunderbird 45.4

Announced
October 3, 2016
Impact
critical
Products
Thunderbird
Fixed in

* Thunderbird 45.4

*In general, these flaws cannot be exploited through email in the Thunderbird product because scripting is disabled when reading mail, but are potentially risks in browser or browser-like contexts.*

#### [#CVE-2016-5270: Heap-buffer-overflow in nsCaseTransformTextRunFactory::TransformString](#CVE-2016-5270)

Reporter
Atte Kettunen
Impact
high
##### Description

An out-of-bounds write of a boolean value during text conversion with some unicode characters.

##### References

* [1291016](https://bugzilla.mozilla.org/show_bug.cgi?id=1291016)

#### [#CVE-2016-5272: Bad cast in nsImageGeometryMixin](#CVE-2016-5272)

Reporter
Abhishek Arya
Impact
high
##### Description

A bad cast when processing layout with `input` elements can result in a potentially exploitable crash.

##### References

* [1297934](https://bugzilla.mozilla.org/show_bug.cgi?id=1297934)

#### [#CVE-2016-5276: Heap-use-after-free in mozilla::a11y::DocAccessible::ProcessInvalidationList](#CVE-2016-5276)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability triggered by setting a `aria-owns` attribute

##### References

* [1287721](https://bugzilla.mozilla.org/show_bug.cgi?id=1287721)

#### [#CVE-2016-5274: use-after-free in nsFrameManager::CaptureFrameState](#CVE-2016-5274)

Reporter
Nils
Impact
high
##### Description

A use-after-free issue in web animations during restyling.

##### References

* [1282076](https://bugzilla.mozilla.org/show_bug.cgi?id=1282076)

#### [#CVE-2016-5277: Heap-use-after-free in nsRefreshDriver::Tick](#CVE-2016-5277)

Reporter
Nils
Impact
high
##### Description

A use-after-free vulnerability with web animations when destroying a timeline

##### References

* [1291665](https://bugzilla.mozilla.org/show_bug.cgi?id=1291665)

#### [#CVE-2016-5278: Heap-buffer-overflow in nsBMPEncoder::AddImageFrame](#CVE-2016-5278)

Reporter
Nils
Impact
critical
##### Description

A potentially exploitable crash caused by a buffer overflow while encoding image frames to images

##### References

* [1294677](https://bugzilla.mozilla.org/show_bug.cgi?id=1294677)

#### [#CVE-2016-5280: Use-after-free in mozilla::nsTextNodeDirectionalityMap::RemoveElementFromMap](#CVE-2016-5280)

Reporter
Mei Wang
Impact
high
##### Description

Use-after-free vulnerability when changing text direction

##### References

* [1289970](https://bugzilla.mozilla.org/show_bug.cgi?id=1289970)

#### [#CVE-2016-5281: use-after-free in DOMSVGLength](#CVE-2016-5281)

Reporter
Brian Carpenter
Impact
high
##### Description

Use-after-free vulnerability when manipulating SVG format content through script

##### References

* [1284690](https://bugzilla.mozilla.org/show_bug.cgi?id=1284690)

#### [#CVE-2016-5284: Add-on update site certificate pin expiration](#CVE-2016-5284)

Reporter
Multiple people
Impact
high
##### Description

Due to [flaws in the process we used to update "Preloaded Public Key Pinning"](https://blog.mozilla.org/security/2016/09/16/update-on-add-on-pinning-vulnerability/) in our releases, the pinning for add-on updates became ineffective in early September. An attacker who was able to get a mis-issued certificate for a Mozilla web site could send malicious add-on updates to users on networks controlled by the attacker. Users who have not installed any add-ons are not affected.

##### References

* [1303127](https://bugzilla.mozilla.org/show_bug.cgi?id=1303127)

#### [#CVE-2016-5250: Resource Timing API is storing resources sent by the previous page](#CVE-2016-5250)

Reporter
Catalin Dumitru
Impact
moderate
##### Description

URLs of resources loaded after a navigation started can leak to the following page through the Resource Timing API, leading to potential information disclosure.

##### References

* [1254688](https://bugzilla.mozilla.org/show_bug.cgi?id=1254688)

#### [#CVE-2016-5257: Memory safety bugs fixed in Thunderbird 45.4](#CVE-2016-5257)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Christoph Diehl, Andrew McCreight, Dan Minor, Byron Campen, Jon Coppeard, Steve Fink, Tyson Smith, Philipp, and Carsten Book reported memory safety bugs present in Thunderbird ESR 45.3. Some of these bugs showed evidence of memory corruption and we presume that with enough effort at least some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Thunderbird 45.4](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1288588%2C1287204%2C1294407%2C1293347%2C1288780%2C1288555%2C1289280%2C1294095%2C1277213)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from security.gentoo.org_14686fcf_20250125_221240.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Mozilla Firefox, Thunderbird: Multiple vulnerabilities — GLSA **201701-15**

Multiple vulnerabilities have been found in Mozilla Firefox and
Thunderbird the worst of which could lead to the execution of arbitrary
code.

### Affected packages

| Package | **www-client/firefox** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

| Package | **www-client/firefox-bin** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

| Package | **mail-client/thunderbird** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

| Package | **mail-client/thunderbird-bin** on all architectures |
| --- | --- |
| Affected versions | < **45.6.0** |
| Unaffected versions | >= **45.6.0** |

### Background

Mozilla Firefox is a cross-platform web browser from Mozilla. The
Mozilla Thunderbird mail client is a redesign of the Mozilla Mail
component. The goal is to produce a cross-platform stand-alone mail
application using XUL (XML User Interface Language).

### Description

Multiple vulnerabilities have been discovered in Mozilla Firefox and
Thunderbird. Please review the CVE identifiers referenced below for
details.

### Impact

A remote attacker could possibly execute arbitrary code with the
privileges of the process or cause a Denial of Service condition via
multiple vectors.

### Workaround

There is no known workaround at this time.

### Resolution

All Firefox users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-45.6.0"

```

All Firefox-bin users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=www-client/firefox-bin-45.6.0"

```

All Thunderbird users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=mail-client/thunderbird-45.6.0"

```

All Thunderbird-bin users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=mail-client/thunderbird-bin-45.6.0"

```
### References

* [CVE-2016-2804](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2804)
* [CVE-2016-2805](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2805)
* [CVE-2016-2806](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2806)
* [CVE-2016-2807](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2807)
* [CVE-2016-2808](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2808)
* [CVE-2016-2809](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2809)
* [CVE-2016-2810](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2810)
* [CVE-2016-2811](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2811)
* [CVE-2016-2812](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2812)
* [CVE-2016-2813](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2813)
* [CVE-2016-2814](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2814)
* [CVE-2016-2816](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2816)
* [CVE-2016-2817](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2817)
* [CVE-2016-2820](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2820)
* [CVE-2016-2827](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2827)
* [CVE-2016-2830](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2830)
* [CVE-2016-2835](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2835)
* [CVE-2016-2836](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2836)
* [CVE-2016-2837](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2837)
* [CVE-2016-2838](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2838)
* [CVE-2016-2839](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2839)
* [CVE-2016-5250](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5250)
* [CVE-2016-5251](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5251)
* [CVE-2016-5252](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5252)
* [CVE-2016-5253](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5253)
* [CVE-2016-5254](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5254)
* [CVE-2016-5255](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5255)
* [CVE-2016-5256](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5256)
* [CVE-2016-5257](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5257)
* [CVE-2016-5258](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5258)
* [CVE-2016-5259](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5259)
* [CVE-2016-5260](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5260)
* [CVE-2016-5261](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5261)
* [CVE-2016-5262](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5262)
* [CVE-2016-5263](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5263)
* [CVE-2016-5264](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5264)
* [CVE-2016-5265](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5265)
* [CVE-2016-5266](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5266)
* [CVE-2016-5267](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5267)
* [CVE-2016-5268](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5268)
* [CVE-2016-5270](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5270)
* [CVE-2016-5271](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5271)
* [CVE-2016-5272](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5272)
* [CVE-2016-5273](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5273)
* [CVE-2016-5274](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5274)
* [CVE-2016-5275](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5275)
* [CVE-2016-5276](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5276)
* [CVE-2016-5277](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5277)
* [CVE-2016-5278](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5278)
* [CVE-2016-5279](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5279)
* [CVE-2016-5280](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5280)
* [CVE-2016-5281](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5281)
* [CVE-2016-5282](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5282)
* [CVE-2016-5283](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5283)
* [CVE-2016-5284](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5284)
* [CVE-2016-5290](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5290)
* [CVE-2016-5291](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5291)
* [CVE-2016-5293](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5293)
* [CVE-2016-5294](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5294)
* [CVE-2016-5296](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5296)
* [CVE-2016-5297](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5297)
* [CVE-2016-9064](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9064)
* [CVE-2016-9066](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9066)
* [CVE-2016-9074](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9074)
* [CVE-2016-9079](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9079)
* [CVE-2016-9893](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9893)
* [CVE-2016-9895](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9895)
* [CVE-2016-9897](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9897)
* [CVE-2016-9898](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9898)
* [CVE-2016-9899](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9899)
* [CVE-2016-9900](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9900)
* [CVE-2016-9901](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9901)
* [CVE-2016-9902](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9902)
* [CVE-2016-9904](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9904)
* [CVE-2016-9905](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9905)

**Release date**

January 03, 2017

**Latest revision**

January 04, 2017: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [581326](https://bugs.gentoo.org/show_bug.cgi?id=581326)
* [590330](https://bugs.gentoo.org/show_bug.cgi?id=590330)
* [594616](https://bugs.gentoo.org/show_bug.cgi?id=594616)
* [599924](https://bugs.gentoo.org/show_bug.cgi?id=599924)
* [601320](https://bugs.gentoo.org/show_bug.cgi?id=601320)
* [602576](https://bugs.gentoo.org/show_bug.cgi?id=602576)
* [604024](https://bugs.gentoo.org/show_bug.cgi?id=604024)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.debian.org_5e13b908_20250125_221219.html ===


---

[[Date Prev](msg00252.html)][[Date Next](msg00254.html)]
[[Thread Prev](msg00252.html)][[Thread Next](msg00254.html)]
[[Date Index](maillist.html#00253)]
[[Thread Index](threads.html#00253)]

# [SECURITY] [DSA 3674-1] firefox-esr security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3674-1] firefox-esr security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 22 Sep 2016 21:55:24 +0200
* *Message-id*: <[[🔎]](/msgid-search/20160922195524.GA3345%40pisco.westfalen.local) [20160922195524.GA3345@pisco.westfalen.local](msg00253.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3674-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
September 22, 2016                    <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : firefox-esr
CVE ID         : CVE-2016-5250 CVE-2016-5257 CVE-2016-5261 CVE-2016-5270
                 CVE-2016-5272 CVE-2016-5274 CVE-2016-5276 CVE-2016-5277
                 CVE-2016-5278 CVE-2016-5280 CVE-2016-5281 CVE-2016-5284

Multiple security issues have been found in the Mozilla Firefox web
browser: Multiple memory safety errors, buffer overflows and other
implementation errors may lead to the execution of arbitrary code or
information disclosure.

For the stable distribution (jessie), these problems have been fixed in
version 45.4.0esr-1~deb8u2.

For the unstable distribution (sid), these problems have been fixed in
version 45.4.0esr-1 of firefox-esr and in version 49.0-1 of firefox.

We recommend that you upgrade your firefox-esr packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBAgAGBQJX5DblAAoJEBDCk7bDfE42BxIQALD2i2Dzj9wWpvd0iNMJBsok
UH3HqnNrKlFN/peAMLinGKuhxYWkEkTOBf+FhxewsAjFt+f09hnDmORFJkBQ5uF0
jBlDWFTtmdaUXqTDF0A0ydXiY0k65/1WnV96poI3TX4c6/TN04ZXmJt8tVkSpylZ
d5TOu4MyErJbgm3FKqz1eOgPoWjwyDSNOvJ7bdxDbpw2USv5HtpsfDnY6qaLxywX
uqCI5HimK4U6ModG8KyUsuIURKv12+7LdN7E4eJdZwzskS0DzpLVaz8FQN0f8OVU
bDrOU6owo/VzqFzSWgExOGDhUbYQzJTlVMELDCSe4FDSJqryd4ECcYAxeJbUX+Oa
7b/cr/mYQPQ2PWCryNGrMf/pOZnkDN+2Fci6hddBS4Yxm27n+8Eo5HH8MTr49nr9
qtbmdYikG74SWt3h09IiXDrTj8SavNKT7KS/HYjOhLTBDSYiQ3T9NFrsp1DfDX87
gD/w4EGfVHYp/Z9vQ8Ic9xjKWZz0RuXDtQlaaBjjTKEfSS4nqd6TLX7r7T9wimn9
K2oB2QB1v5wz/f45ETeYgzGr/d4muezTwtOQhW1HU8F0cne3hHeEBd5/wLgXwZF/
ZmXM0VEFPob/SiJBEm+mC4XupSZauI96VI7Hcg9wE2gmFMuozswcY6/0Kq64QTfq
5SWa6viV6dAQA3wQaOzq
=eZqq
-----END PGP SIGNATURE-----

```

---



=== Content from bugzilla.mozilla.org_9f1f3ef3_20250125_221234.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1289280)
* [XML](/show_bug.cgi?ctype=xml&id=1289280)

Closed
[Bug 1289280](/show_bug.cgi?id=1289280)

Opened 9 years ago
Closed 8 years ago

# FFMPEG: heap-buffer-overflow read in [@av\_packet\_split\_side\_data]

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

FFMPEG: heap-buffer-overflow read in [@av\_packet\_split\_side\_data]

## Categories

### (Core :: Audio/Video: Playback, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Audio%2FVideo%3A%20Playback#Audio%2FVideo%3A%20Playback)

Audio/Video: Playback
▾

Core :: Audio/Video: Playback
For problems related to the HTML 5 media elements (<video> and <audio>) -- including WebM, MP4, MSE and EME issues. This would also typically include decoding problems in the codecs themselves (e.g. VP8, VP9, H.264, AAC) experienced during playback.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo%3A%20Playback&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Audio%2FVideo%3A%20Playback&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Audio%2FVideo%3A%20Playback)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

50 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

All

All

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

critical

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla51

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Performance Impact | --- |
| --- | --- |
| Accessibility Severity | --- |
| a11y-review | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed) |
| firefox-esr45 | [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) |
| firefox51 | [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B) | [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 |  | wontfix |
| firefox49 | + | fixed |
| firefox-esr45 | 49+ | fixed |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | fixed |
| firefox51 | + | fixed |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: tsmith, Assigned: mozbugz)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/9f52c9dd6d534afbf996f4ebb8f417ce?d=mm&size=40)  [mozbugz](/user_profile?user_id=515575)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/a2837b951fa7dc639a2568203478ff0a?d=mm&size=40)  [tsmith](/user_profile?user_id=486634)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](extensions/Gravatar/web/default.jpg)  [jimm](/user_profile?user_id=279663)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

8 people

## References

### (Blocks 1 open bug)

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[grizzly](/show_bug.cgi?id=1289609 "NEW - [meta] Bugs found while Fuzzing with Grizzly"), [fuzzing-ffmpeg](/show_bug.cgi?id=1225325 "RESOLVED FIXED - [meta] Fuzzing: ffmpeg"), [1289282](/show_bug.cgi?id=1289282 "RESOLVED DUPLICATE - FFMPEG: heap-buffer-overflow read in [@av_packet_ref]")

Dependency [tree](/showdependencytree.cgi?id=1289280&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1289280)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[Duplicates:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#duplicates)

[1289282](/show_bug.cgi?id=1289282 "RESOLVED DUPLICATE - FFMPEG: heap-buffer-overflow read in [@av_packet_ref]")

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

[1289282](/show_bug.cgi?id=1289282 "RESOLVED DUPLICATE - FFMPEG: heap-buffer-overflow read in [@av_packet_ref]"), [1290902](/show_bug.cgi?id=1290902 "RESOLVED WONTFIX - [FFmpeg] When flushing or draining the decoder, the codec parser must be recreated")

## Details

### (4 keywords, Whiteboard: [adv-main49+][adv-esr45.4+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

[crash](/buglist.cgi?keywords=crash&resolution=---),
[csectype-bounds](/buglist.cgi?keywords=csectype-bounds&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---),
[testcase](/buglist.cgi?keywords=testcase&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main49+][adv-esr45.4+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c30 "8 years ago") | ? |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | ? |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (4 files, 3 obsolete files)

| [test\_case.webm](/attachment.cgi?id=8774601)  [9 years ago](#c0)  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)   165.25 KB, video/webm |  | [Details](/attachment.cgi?id=8774601&action=edit) |
| --- | --- | --- |
| [log.txt](/attachment.cgi?id=8774602)  [9 years ago](#c1)  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)   16.53 KB, text/plain |  | [Details](/attachment.cgi?id=8774602&action=edit) |
| [1289280.patch](/attachment.cgi?id=8776451)  [8 years ago](#c8)  [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)   1.38 KB, patch | jya : [review+](#c9 "8 years ago") | [Details](/attachment.cgi?id=8776451&action=edit) | [Diff](/attachment.cgi?id=8776451&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776451) |
| [1289280.patch](/attachment.cgi?id=8776457)  [8 years ago](#c10)  [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)   1.26 KB, patch | mozbugz : [review+](#c10 "8 years ago") | [Details](/attachment.cgi?id=8776457&action=edit) | [Diff](/attachment.cgi?id=8776457&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776457) |
| [1289280.patch](/attachment.cgi?id=8776461)  [8 years ago](#c11)  [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)   1.34 KB, patch | jya : [review+](#a527420_512198 "8 years ago") | [Details](/attachment.cgi?id=8776461&action=edit) | [Diff](/attachment.cgi?id=8776461&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776461) |
| [1289280-ffvpx-vp9\_parser.patch](/attachment.cgi?id=8776841)  [8 years ago](#c16)  [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)   2.62 KB, patch | jya : [review+](#a613196_512198 "8 years ago")  abillings : [approval-mozilla-aurora+](#a2056167_280903 "8 years ago")  abillings : [approval-mozilla-beta+](#a2056167_280903 "8 years ago")  abillings : [sec-approval+](#c26 "8 years ago") | [Details](/attachment.cgi?id=8776841&action=edit) | [Diff](/attachment.cgi?id=8776841&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776841) |
| [1289280-no-libav-vp9-ESR45.patch](/attachment.cgi?id=8777632)  [8 years ago](#c25)  [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)   917 bytes, patch | jya : [review+](#a781846_512198 "8 years ago")  abillings : [approval-mozilla-esr45+](#a1004300_280903 "8 years ago")  abillings : [sec-approval+](#a1004300_280903 "8 years ago") | [Details](/attachment.cgi?id=8777632&action=edit) | [Diff](/attachment.cgi?id=8777632&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8777632) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1289280#c0)• 9 years ago |
| testcase | |

Attached video
[test\_case.webm](attachment.cgi?id=8774601)
— [Details](attachment.cgi?id=8774601&action=edit)

I found this while fuzzing a nightly build of the browser not a standalone ffmpeg build.
This could be potentially nasty. I am seeing the following over read but also a much larger on at another location with the same test case. Not sure if it is the same issue or two separate issues.
==6943==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6190012f0d44 at pc 0x7fce58a7dcd9 bp 0x7fce514b4c60 sp 0x7fce514b4c58
READ of size 8 at 0x6190012f0d44 thread T57 (MediaPD~oder #1)
#0 0x7fce58a7dcd8 in av\_packet\_split\_side\_data /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/ffvpx/libavcodec/avpacket.c:396:51
#1 0x7fce58b42baa in avcodec\_decode\_video2 /builds/slave/m-in-l64-asan-0000000000000000/build/src/media/ffvpx/libavcodec/utils.c:2115:25
#2 0x7fce8cf4960f in mozilla::FFmpegVideoDecoder<46465650>::DoDecode(mozilla::MediaRawData\*, unsigned char\*, int) /builds/slave/m-in-l64-asan-0000000000000000/build/src/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp:235:5
#3 0x7fce8cf48fe1 in mozilla::FFmpegVideoDecoder<46465650>::DoDecode(mozilla::MediaRawData\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp:187:17
#4 0x7fce8cf469af in mozilla::FFmpegDataDecoder<46465650>::ProcessDecode(mozilla::MediaRawData\*) /builds/slave/m-in-l64-asan-0000000000000000/build/src/dom/media/platforms/ffmpeg/FFmpegDataDecoder.cpp:122:11
#5 0x7fce8cf4b6be in applyImpl<mozilla::FFmpegDataDecoder<LIBAV\_VER>, void (mozilla::FFmpegDataDecoder<LIBAV\_VER>::\*)(mozilla::MediaRawData \*), StorensRefPtrPassByPtr<mozilla::MediaRawData> , 0> /builds/slave/m-in-l64-asan-0000000000000000/build/src/obj-firefox/dist/include/nsThreadUtils.h:729:12
#6 0x7fce8cf4b6be in apply<mozilla::FFmpegDataDecoder<LIBAV\_VER>, void (mozilla::FFmpegDataDecoder<LIBAV\_VER>::\*)(mozilla::MediaRawData \*)> /builds/slave/m-in-l64-asan-0000000000000000/build/src/obj-firefox/dist/include/nsThreadUtils.h:735
#7 0x7fce8cf4b6be in mozilla::detail::RunnableMethodImpl<void (mozilla::FFmpegDataDecoder<46465650>::\*)(mozilla::MediaRawData\*), true, false, RefPtr<mozilla::MediaRawData> >::Run() /builds/slave/m-in-l64-asan-0000000000000000/build/src/obj-firefox/dist/include/nsThreadUtils.h:764
...
See log.txt for entire log.

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1289280#c1)• 9 years ago |
|  | |

Attached file
[log.txt](attachment.cgi?id=8774602)
— [Details](attachment.cgi?id=8774602&action=edit)

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a318_486634)• 9 years ago |

See Also: → [1289282](/show_bug.cgi?id=1289282 "RESOLVED DUPLICATE - FFMPEG: heap-buffer-overflow read in [@av_packet_ref]")

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1289280#c2)• 9 years ago |
|  | |

The other less frequent over read is [bug 1289282](/show_bug.cgi?id=1289282 "RESOLVED DUPLICATE - FFMPEG: heap-buffer-overflow read in [@av_packet_ref]")

|  | [Michael Niedermayer [:mn]](/user_profile?user_id=555577) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1289280#c3)• 9 years ago |
|  | |

Cannot reproduce this with command line FFmpeg (git master)
I dont have a mozilla development environment setup ATM here but
are the AVPacket->data and ->size fields valid that are passed into avcodec\_decode\_video2() from build/src/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp:235:5 ?

|  | [Michael Niedermayer [:mn]](/user_profile?user_id=555577) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1289280#c4)• 9 years ago |
|  | |

Adding ronald as this may (or may not) be related to the output from the vp9 parser

|  | [Ronald S. Bultje](/user_profile?user_id=433809) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1289280#c5)• 9 years ago |
|  | |

Do you have a link to the code that mozilla uses to interact with libavformat? I'm suspecting that it's slightly different from what ffmpeg.c does and that causes the issue. (This may still be an API violation in the vp9 parser, I'm not saying mozilla is buggy, I'm just saying I suspect it's different.)

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1289280#c6)• 9 years ago |
|  | |

(In reply to Ronald S. Bultje from [comment #5](/show_bug.cgi?id=1289280#c5 "RESOLVED FIXED - FFMPEG: heap-buffer-overflow read in [@av_packet_split_side_data]"))
> Do you have a link to the code that mozilla uses to interact with
> libavformat?
Ronald, I think the code you are looking can be found here: <https://dxr.mozilla.org/mozilla-central/source/dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp>.
jya can you please confirm this is correct?Flags: needinfo?(jyavenard)

|  | [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)  Reporter |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a62082_486634)• 9 years ago |

Blocks: [grizzly](/show_bug.cgi?id=1289609 "NEW - [meta] Bugs found while Fuzzing with Grizzly")

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1289280#c7)• 9 years ago |
|  | |

That's where we feed the decoder with compressed data.
For the demuxing part, this is done by libnestegg and its wrapper found in dom/media/webm/WebMDemuxer.cpp
I'll try to extract what data is being fed to ffvpxFlags: needinfo?(jyavenard)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a217667_1689)• 8 years ago |

Keywords: [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Anthony Jones (:ajones, :kentuckyfriedtakahe, :k17e)](/user_profile?user_id=443088) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a510907_443088)• 8 years ago |

Priority: -- → P1

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1289280#c8)• 8 years ago |
|  | |

Attached patch

[1289280.patch](attachment.cgi?id=8776451&action=diff) (obsolete)
— [Details](attachment.cgi?id=8776451&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776451)

While debugging, I noticed that the 'size' out-parameter was larger than the allowed input size, and that size is passed to DoDecode and then avcodec\_decode\_video2, which explains the buffer overrun there.
This patch just checks that the parsed buffer is totally contained inside the given input buffer, and if not triggers a DECODE\_ERROR.
Note that this does not correct the actual issue, which happens inside FFmpeg's av\_parser\_parse2, but at least we can catch this problem before continuing with the buffer overrun, before FFmpeg is properly fixed.Assignee: nobody → gsquelart
[Attachment #8776451](/attachment.cgi?id=8776451&action=edit "1289280.patch") -
Flags: review?(jyavenard)

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a520170_515575)• 8 years ago |

Blocks: [1289282](/show_bug.cgi?id=1289282 "RESOLVED DUPLICATE - FFMPEG: heap-buffer-overflow read in [@av_packet_ref]")

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1289280#c9)• 8 years ago |
|  | |

Comment on [attachment 8776451](/attachment.cgi?id=8776451 "1289280.patch") [[details]](/attachment.cgi?id=8776451&action=edit "1289280.patch") [[diff]](/attachment.cgi?id=8776451&action=diff "1289280.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776451)
1289280.patch
assuming that av\_parser\_parse2 always return a pointer within the original data (which seems likely, otherwise we would leak)
[Attachment #8776451](/attachment.cgi?id=8776451&action=edit "1289280.patch") -
Flags: review?(jyavenard) → review+

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1289280#c10)• 8 years ago |
|  | |

Attached patch

[1289280.patch](attachment.cgi?id=8776457&action=diff) (obsolete)
— [Details](attachment.cgi?id=8776457&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776457)

After discussion with Jean-Yves:
Previous patch didn't account for a possible data==nullptr in some cases.
So now we only test that the output size is never bigger than the input size, \*if\* there is a non-zero size.
And I don't assume that the output buffer must be inside the input buffer, in case it gets copied elsewhere (in which case there might well be a leak, but it wouldn't be a security issue, so we'll handle that later if that ever happens.)
Carrying r+ from [comment 9](/show_bug.cgi?id=1289280#c9 "RESOLVED FIXED - FFMPEG: heap-buffer-overflow read in [@av_packet_split_side_data]").
[Attachment #8776451](/attachment.cgi?id=8776451&action=edit "1289280.patch") -
Attachment is obsolete: true
[Attachment #8776457](/attachment.cgi?id=8776457&action=edit "1289280.patch") -
Flags: review+

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1289280#c11)• 8 years ago |
|  | |

Attached patch

[1289280.patch](attachment.cgi?id=8776461&action=diff) (obsolete)
— [Details](attachment.cgi?id=8776461&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776461)

Sorry, I messed up the previous patch, by comparing the output size to inputSize \*after\* inputSize was modified.
To avoid further embarrassment, I'm requesting another review, just to be sure.
(I've tested locally with the fuzzing POC from this bug and [bug 1289282](/show_bug.cgi?id=1289282 "RESOLVED DUPLICATE - FFMPEG: heap-buffer-overflow read in [@av_packet_ref]"), and mochitests.)
[Attachment #8776457](/attachment.cgi?id=8776457&action=edit "1289280.patch") -
Attachment is obsolete: true
[Attachment #8776461](/attachment.cgi?id=8776461&action=edit "1289280.patch") -
Flags: review?(jyavenard)

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a527093_512198)• 8 years ago |

[Attachment #8776461](/attachment.cgi?id=8776461&action=edit "1289280.patch") -
Flags: review?(jyavenard) → review+

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a527402_512198)• 8 years ago |

[Attachment #8776461](/attachment.cgi?id=8776461&action=edit "1289280.patch") -
Flags: review+ → superreview?

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a527420_512198)• 8 years ago |

[Attachment #8776461](/attachment.cgi?id=8776461&action=edit "1289280.patch") -
Flags: superreview? → review+

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1289280#c12)• 8 years ago |
|  | |

Comment on [attachment 8776461](/attachment.cgi?id=8776461 "1289280.patch") [[details]](/attachment.cgi?id=8776461&action=edit "1289280.patch") [[diff]](/attachment.cgi?id=8776461&action=diff "1289280.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776461)
1289280.patch
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not that easily I believe, because it would require knowledge of what FFmpeg's av\_parser\_parse2 function does, to be able to tailor a bad webm file that will produce a too-big packet size.
Also, even after achieving this, further knowledge of FFmpeg would be required to exploit the buffer overrun happening later in avcodec\_decode\_video2.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
The patch and check-in comment point at the fact that the output size was not checked, there's not much we can do about that. But it doesn't make it obvious how it could be exploited next.
Which older supported branches are affected by this flaw?
All: Landed in FF43 ([bug 1197319](/show_bug.cgi?id=1197319 "RESOLVED FIXED - Enable ffvp9 support on Linux for WebM decoding")), so ESR45 and later are affected.
If not all supported branches, which bug introduced the flaw?
(See above)
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Rebase will be needed, but it is trivial to create backports as needed, without risks.
How likely is this patch to cause regressions; how much testing does it need?
At worst it could prevent playing some videos that could theoretically play today (despite the buffer overrun), but this really shouldn't happen in real life as it would indicate a corrupt file with a potential exploit in it.
[Attachment #8776461](/attachment.cgi?id=8776461&action=edit "1289280.patch") -
Flags: sec-approval?

|  | [Michael Niedermayer [:mn]](/user_profile?user_id=555577) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1289280#c13)• 8 years ago |
|  | |

The patch below might help but if it helps then there might be something inconsistent or at least suboptimal in how the parser is fed.
commit 82ff29f1b76787b11d73b1959ac74c8496067de4
Author: Michael Niedermayer <michael@niedermayer.cc>
Date: Mon Aug 1 12:32:37 2016 +0200
avcodec/vp9\_parser: Check the input frame sizes for being consistent
Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
diff --git a/libavcodec/vp9\_parser.c b/libavcodec/vp9\_parser.c
index 2e9235e..aa06091 100644
--- a/libavcodec/vp9\_parser.c
+++ b/libavcodec/vp9\_parser.c
@@ -88,6 +88,12 @@ static int parse(AVCodecParserContext \*ctx,
return 0;
}
+ if (s->n\_frames > 0 && s->size[s->n\_frames - 1] > size) {
+ av\_log(avctx, AV\_LOG\_ERROR, "Inconsistent input frame sizes %d %d\n",
+ s->size[s->n\_frames - 1], size);
+ s->n\_frames = 0;
+ }
+
if (s->n\_frames > 0) {
\*out\_data = data;
\*out\_size = s->size[--s->n\_frames];

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1289280#c14)• 8 years ago |
|  | |

Comment on [attachment 8776461](/attachment.cgi?id=8776461 "1289280.patch") [[details]](/attachment.cgi?id=8776461&action=edit "1289280.patch") [[diff]](/attachment.cgi?id=8776461&action=diff "1289280.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776461)
1289280.patch
We've missed the release train anyway, so I'm removing the sec-approval request from this patch as I'd like to take the time and look at Michael's proposed fix (or something like it), which is probably much better than mine!Flags: needinfo?(gsquelart)
[Attachment #8776461](/attachment.cgi?id=8776461&action=edit "1289280.patch") -
Flags: sec-approval?

|  | [Michael Niedermayer [:mn]](/user_profile?user_id=555577) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1289280#c15)• 8 years ago |
|  | |

I think the way the parser is called in dom/media/platforms/ffmpeg/FFmpegVideoDecoder.cpp would loose all frames of a packet after a decode error without reseting/closing and reopening the parser. This might be the source of the inconsistency as the vp9 parser ATM without any patches does not expect this

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a552771_512198)• 8 years ago |

See Also: → [1290902](/show_bug.cgi?id=1290902 "RESOLVED WONTFIX - [FFmpeg] When flushing or draining the decoder, the codec parser must be recreated")

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1289280#c16)• 8 years ago |
|  | |

Attached patch

[1289280-ffvpx-vp9\_parser.patch](attachment.cgi?id=8776841&action=diff)
— [Details](attachment.cgi?id=8776841&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776841)

Take 4: This is an import of a public patch from ffmpeg.org, it fixes the core issue by catching size mismatches during parsing.
I've tested it locally with the POCs and mochitests.
I'm obsoleting my previous patch, as I don't think it is required anymore, and at worst it could have prevented some corner cases from playing.
[Attachment #8776461](/attachment.cgi?id=8776461&action=edit "1289280.patch") -
Attachment is obsolete: trueFlags: needinfo?(gsquelart)
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: review?(jyavenard)

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a613196_512198)• 8 years ago |

[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: review?(jyavenard) → review+

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1289280#c17)• 8 years ago |
|  | |

Comment on [attachment 8776841](/attachment.cgi?id=8776841 "1289280-ffvpx-vp9_parser.patch") [[details]](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") [[diff]](/attachment.cgi?id=8776841&action=diff "1289280-ffvpx-vp9_parser.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776841)
1289280-ffvpx-vp9\_parser.patch
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Not that easily I believe, because it would require knowledge of where FFmpeg's parse\_frame function is used inside Firefox, to be able to tailor a bad webm file that will produce a too-big packet size.
Also, even after achieving this, further knowledge of FFmpeg would be required to exploit the buffer overrun happening later in Firefox's separate call to avcodec\_decode\_video2.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
The patch and check-in comment point at the fact that frame individual sizes inside a superframe was not checked. But it doesn't make it obvious that it could be exploited next (except by being associated with this sec bug).
Which older supported branches are affected by this flaw?
If not all supported branches, which bug introduced the flaw?
[Bug 1214462](/show_bug.cgi?id=1214462 "RESOLVED FIXED - Support ffmpeg on Windows"), landed in FF46.
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
The same patch applies cleanly on Aurora and Beta.
How likely is this patch to cause regressions; how much testing does it need?
At worst it could prevent playing some videos that could theoretically play today (despite the buffer overrun), but this really shouldn't happen in real life as it would indicate a corrupt file with a potential exploit in it.
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: sec-approval?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1289280#c18)• 8 years ago |
|  | |

(In reply to Gerald Squelart [:gerald] from [comment #17](/show_bug.cgi?id=1289280#c17 "RESOLVED FIXED - FFMPEG: heap-buffer-overflow read in [@av_packet_split_side_data]"))
> Which older supported branches are affected by this flaw?
> If not all supported branches, which bug introduced the flaw?
> [Bug 1214462](/show_bug.cgi?id=1214462 "RESOLVED FIXED - Support ffmpeg on Windows"), landed in FF46.
Your previous sec-approval said that 43 and higher, including ESR45, were affected. Now you're saying 46 and higher. Can you clarify, please?Flags: needinfo?(gsquelart)

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1289280#c19)• 8 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #18](/show_bug.cgi?id=1289280#c18 "RESOLVED FIXED - FFMPEG: heap-buffer-overflow read in [@av_packet_split_side_data]"))
> (In reply to Gerald Squelart [:gerald] from [comment #17](/show_bug.cgi?id=1289280#c17 "RESOLVED FIXED - FFMPEG: heap-buffer-overflow read in [@av_packet_split_side_data]"))
>
> > Which older supported branches are affected by this flaw?
> > If not all supported branches, which bug introduced the flaw?
> > [Bug 1214462](/show_bug.cgi?id=1214462 "RESOLVED FIXED - Support ffmpeg on Windows"), landed in FF46.
>
> Your previous sec-approval said that 43 and higher, including ESR45, were
> affected. Now you're saying 46 and higher. Can you clarify, please?
Well-spotted, thank you.
The source of the overrun found by fuzzing is in ffvpx, which we only imported in FF46 ([bug 1214462](/show_bug.cgi?id=1214462 "RESOLVED FIXED - Support ffmpeg on Windows")). That is why this patch can only be ported up to 46.
Before that, on Linux we would have either used ffmpeg (if installed) or libvpx.
A system-provided ffmpeg could of course have the same issue. I'm guessing that users of ESR will probably not update their system much either, and therefore would miss ffmpeg fixes, so we should try and fix them.
Discussing with Jean-Yves, he thinks the best solution there would be to just disable VP9 decoding through ffmpeg, which would protect us from this issue and also from others, including unreliable VP9 decoding compared to libvpx.
I will submit a patch shortly for the ESR45 case.Flags: needinfo?(gsquelart)

|  | [Ronald S. Bultje](/user_profile?user_id=433809) |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1289280#c20)• 8 years ago |
|  | |

What does "unreliable VP9 decoding compared to libvpx" mean?

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1289280#c21)• 8 years ago |
|  | |

(In reply to Ronald S. Bultje from [comment #20](/show_bug.cgi?id=1289280#c20 "RESOLVED FIXED - FFMPEG: heap-buffer-overflow read in [@av_packet_split_side_data]"))
> What does "unreliable VP9 decoding compared to libvpx" mean?
I would presume that most people using ESR45, are actually also on older version, and likely to use older version of LibAV.
As you know, LibAV has never upgraded their code with all the ffmpeg fixes.

|  | [Ronald S. Bultje](/user_profile?user_id=433809) |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1289280#c22)• 8 years ago |
|  | |

Oh, I see, you mean the project Libav, not the libav\* libraries in FFmpeg, sorry about that, I misunderstood.

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1289280#c23)• 8 years ago |
|  | |

Yes, it is unfortunate that the majority of users are still using LibAV at present. Though we did limit vp9 decoding to libavcodec >= 55
The alternative was to use :gerald's original patch and exit early if the return value of the parser was nonsensical. But we're afraid of some unknown consequences that could break playback

|  | [Ronald S. Bultje](/user_profile?user_id=433809) |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1289280#c24)• 8 years ago |
|  | |

I don't think you want to use Libav's VP9 decoder for any reason. Most of its code is C, so it will be substantially slower than libvpx. FFmpeg's decoder, on the other hand, will be much faster than libvpx or Libav's VP9 decoder.

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1289280#c25)• 8 years ago |
|  | |

Attached patch

[1289280-no-libav-vp9-ESR45.patch](attachment.cgi?id=8777632&action=diff)
— [Details](attachment.cgi?id=8777632&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8777632)

Don't use libav to decode VP9.
[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: review?(jyavenard)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1289280#c26)• 8 years ago |
|  | |

Comment on [attachment 8776841](/attachment.cgi?id=8776841 "1289280-ffvpx-vp9_parser.patch") [[details]](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") [[diff]](/attachment.cgi?id=8776841&action=diff "1289280-ffvpx-vp9_parser.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776841)
1289280-ffvpx-vp9\_parser.patch
sec-approval+
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: sec-approval? → sec-approval+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a781273_280903)• 8 years ago |

[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
--- → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%2B)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B)
[tracking-firefox-esr45](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=isnotempty):
--- → [49+](/buglist.cgi?f1=cf_tracking_firefox_esr45&o1=equals&v1=49%2B)

|  | [Jean-Yves Avenard [:jya]](/user_profile?user_id=512198) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a781846_512198)• 8 years ago |

[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: review?(jyavenard) → review+

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1289280#c27)• 8 years ago |
|  | |

Comment on [attachment 8777632](/attachment.cgi?id=8777632 "1289280-no-libav-vp9-ESR45.patch") [[details]](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") [[diff]](/attachment.cgi?id=8777632&action=diff "1289280-no-libav-vp9-ESR45.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8777632)
1289280-no-libav-vp9-ESR45.patch
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
Very hard, as the patch is just disabling all of VP9/libav, without hint as to why
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
No
Which older supported branches are affected by this flaw?
ESR45
If not all supported branches, which bug introduced the flaw?
-
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
This patch is only for ESR45
How likely is this patch to cause regressions; how much testing does it need?
No regressions expected, we'll fallback to libvpx to play VP9.
[ESR45 Approval Request Comment]
If this is not a sec:{high,crit} bug, please state case for ESR consideration: sec-high
User impact if declined: Potential exploit
Fix Landed on Version: Not yet, should land on 51n, 40a, 49b
Risk to taking this patch (and alternatives if risky): Can't see a risk, we're just disabling VP9 decoding through libav
String or UUID changes made by this patch: None
See <https://wiki.mozilla.org/Release_Management/ESR_Landing_Process> for more info.
[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: sec-approval?
[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: approval-mozilla-esr45?

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a1004300_280903)• 8 years ago |

[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: sec-approval?
[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: sec-approval+
[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: approval-mozilla-esr45?
[Attachment #8777632](/attachment.cgi?id=8777632&action=edit "1289280-no-libav-vp9-ESR45.patch") -
Flags: approval-mozilla-esr45+

|  | [Gerald Squelart (he/him) (not at Mozilla since 2022-09-15)](/user_profile?user_id=515575)  Assignee |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1289280#c28)• 8 years ago |
|  | |

Comment on [attachment 8776841](/attachment.cgi?id=8776841 "1289280-ffvpx-vp9_parser.patch") [[details]](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") [[diff]](/attachment.cgi?id=8776841&action=diff "1289280-ffvpx-vp9_parser.patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1289280&attachment=8776841)
1289280-ffvpx-vp9\_parser.patch
I've just noticed that I had not officially requested uplift to aurora and beta. Just in case it is required:
Approval Request Comment
[Feature/regressing bug #]: webm playback
[User impact if declined]: OOB access, at worst a potential sec issue
[Describe test coverage new/current, TreeHerder]: Ran POC and webm mochitests locally
[Risks and why]: Low risk as it's only adding a sanity check for sizes. Main risk would be to refuse playing some corrupted (but previously still playable) videos.
[String/UUID change made/needed]: None
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: approval-mozilla-beta?
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: approval-mozilla-aurora?

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1289280#c29)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/e734cf260908>

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a2056167_280903)• 8 years ago |

[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: approval-mozilla-beta?
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: approval-mozilla-beta+
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: approval-mozilla-aurora?
[Attachment #8776841](/attachment.cgi?id=8776841&action=edit "1289280-ffvpx-vp9_parser.patch") -
Flags: approval-mozilla-aurora+

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a2056174_280903)• 8 years ago |

Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1289280#c30)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/0b2e1f4c1af3>
<https://hg.mozilla.org/releases/mozilla-beta/rev/144875f1f75b>
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=fixed)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)Flags: in-testsuite?Keywords: [checkin-needed](/buglist.cgi?keywords=checkin-needed&resolution=---)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1289280#c31)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-esr45/rev/90697781ec9f>
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=fixed)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 32](/show_bug.cgi?id=1289280#c32)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/e734cf260908>Status: NEW → RESOLVEDClosed: 8 years ago
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla51

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a3240472_1689)• 8 years ago |

Group: media-core-security → core-security-release

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a3697402_280903)• 8 years ago |

Whiteboard: [adv-main49+][adv-esr45.4+]

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1289280#a17147214_1689)• 8 years ago |

Group: core-security-release
You need to [log in](/show_bug.cgi?id=1289280&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Tyson Smith [:tsmith] (PTO)](/user_profile?user_id=486634)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


