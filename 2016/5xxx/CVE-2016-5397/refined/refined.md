```
{
  "vulnerability_details": {
    "root_cause": "Improper file path sanitization in the `t_go_generator.cc:format_go_output()` function of the Apache Thrift Go client library.",
    "weaknesses": [
      "The `file_path` parameter, derived from the service name, is not properly validated or sanitized before being used in a command execution.",
      "The code uses an external formatting tool (`gofmt`) which is vulnerable to command injection through the `file_path` parameter."
    ],
    "impact": "An attacker can inject arbitrary commands by crafting a malicious service name, leading to command execution on the server when the Thrift library is used.",
     "attack_vectors": [
      "The vulnerability can be exploited by providing a crafted service name to a framework invoking the vulnerable Thrift library.",
       "Specifically, an attacker can manipulate the service name, which is used to generate a file path, to include shell commands, taking advantage of the use of `gofmt`.",
         "The attacker needs to be able to influence the service name that is used in the vulnerable code."
    ],
    "required_capabilities": "The attacker needs the ability to provide a service name that will be processed by a framework using the vulnerable Thrift library. The attacker does not need to be authenticated or have special privileges within the target system, but needs to be able to inject a crafted service name.",
    "additional_information": "The vulnerability affects Apache Thrift versions before 0.10.0. It is fixed by removing the vulnerable call to the external formatting tool, `gofmt`, as it is not necessary for the core functionality of Apache Thrift. The vulnerable code is in t_go_generator.cc."
  }
}
```