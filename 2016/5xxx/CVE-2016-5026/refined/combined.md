=== Content from github.com_f18e2242_20250124_211505.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonionshare%2Fonionshare)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fonionshare%2Fonionshare)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=onionshare%2Fonionshare)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[onionshare](/onionshare)
/
**[onionshare](/onionshare/onionshare)**
Public

* [Notifications](/login?return_to=%2Fonionshare%2Fonionshare) You must be signed in to change notification settings
* [Fork
  660](/login?return_to=%2Fonionshare%2Fonionshare)
* [Star
   6.4k](/login?return_to=%2Fonionshare%2Fonionshare)

Securely and anonymously share files, host websites, and chat with friends using the Tor network

[onionshare.org/](https://onionshare.org/ "https://onionshare.org/")

### License

[View license](/onionshare/onionshare/blob/main/LICENSE.txt)

[6.4k
stars](/onionshare/onionshare/stargazers) [660
forks](/onionshare/onionshare/forks) [Branches](/onionshare/onionshare/branches) [Tags](/onionshare/onionshare/tags) [Activity](/onionshare/onionshare/activity)
 [Star](/login?return_to=%2Fonionshare%2Fonionshare)

 [Notifications](/login?return_to=%2Fonionshare%2Fonionshare) You must be signed in to change notification settings

* [Code](/onionshare/onionshare)
* [Issues
  127](/onionshare/onionshare/issues)
* [Pull requests
  17](/onionshare/onionshare/pulls)
* [Actions](/onionshare/onionshare/actions)
* [Wiki](/onionshare/onionshare/wiki)
* [Security](/onionshare/onionshare/security)
* [Insights](/onionshare/onionshare/pulse)

Additional navigation options

* [Code](/onionshare/onionshare)
* [Issues](/onionshare/onionshare/issues)
* [Pull requests](/onionshare/onionshare/pulls)
* [Actions](/onionshare/onionshare/actions)
* [Wiki](/onionshare/onionshare/wiki)
* [Security](/onionshare/onionshare/security)
* [Insights](/onionshare/onionshare/pulse)

# onionshare/onionshare

    main[Branches](/onionshare/onionshare/branches)[Tags](/onionshare/onionshare/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[5,241 Commits](/onionshare/onionshare/commits/main/) | | |
| [.github](/onionshare/onionshare/tree/main/.github ".github") | | [.github](/onionshare/onionshare/tree/main/.github ".github") |  |  |
| [cli](/onionshare/onionshare/tree/main/cli "cli") | | [cli](/onionshare/onionshare/tree/main/cli "cli") |  |  |
| [desktop](/onionshare/onionshare/tree/main/desktop "desktop") | | [desktop](/onionshare/onionshare/tree/main/desktop "desktop") |  |  |
| [docs](/onionshare/onionshare/tree/main/docs "docs") | | [docs](/onionshare/onionshare/tree/main/docs "docs") |  |  |
| [flatpak](/onionshare/onionshare/tree/main/flatpak "flatpak") | | [flatpak](/onionshare/onionshare/tree/main/flatpak "flatpak") |  |  |
| [licenses](/onionshare/onionshare/tree/main/licenses "licenses") | | [licenses](/onionshare/onionshare/tree/main/licenses "licenses") |  |  |
| [security](/onionshare/onionshare/tree/main/security "security") | | [security](/onionshare/onionshare/tree/main/security "security") |  |  |
| [snap](/onionshare/onionshare/tree/main/snap "snap") | | [snap](/onionshare/onionshare/tree/main/snap "snap") |  |  |
| [.gitignore](/onionshare/onionshare/blob/main/.gitignore ".gitignore") | | [.gitignore](/onionshare/onionshare/blob/main/.gitignore ".gitignore") |  |  |
| [CHANGELOG.md](/onionshare/onionshare/blob/main/CHANGELOG.md "CHANGELOG.md") | | [CHANGELOG.md](/onionshare/onionshare/blob/main/CHANGELOG.md "CHANGELOG.md") |  |  |
| [LICENSE.txt](/onionshare/onionshare/blob/main/LICENSE.txt "LICENSE.txt") | | [LICENSE.txt](/onionshare/onionshare/blob/main/LICENSE.txt "LICENSE.txt") |  |  |
| [README.md](/onionshare/onionshare/blob/main/README.md "README.md") | | [README.md](/onionshare/onionshare/blob/main/README.md "README.md") |  |  |
| [RELEASE.md](/onionshare/onionshare/blob/main/RELEASE.md "RELEASE.md") | | [RELEASE.md](/onionshare/onionshare/blob/main/RELEASE.md "RELEASE.md") |  |  |
| [build-source.sh](/onionshare/onionshare/blob/main/build-source.sh "build-source.sh") | | [build-source.sh](/onionshare/onionshare/blob/main/build-source.sh "build-source.sh") |  |  |
| View all files | | |

## Repository files navigation

* README
* License

[![OnionShare](/onionshare/onionshare/raw/main/docs/source/_static/logo.png)](/onionshare/onionshare/blob/main/docs/source/_static/logo.png)

[![Run Tests](https://github.com/onionshare/onionshare/actions/workflows/tests.yml/badge.svg)](https://github.com/onionshare/onionshare/actions/workflows/tests.yml)

# OnionShare

OnionShare is an open source tool that lets you securely and anonymously share files, host websites, and chat with friends using the Tor network.

## Installing OnionShare

You can download OnionShare for Windows and macOS from the [OnionShare website](https://onionshare.org).

For macOS you can also use [Homebrew](https://brew.sh/):

```
brew install --cask onionshare

```

See [these instructions](https://docs.onionshare.org/2.6/en/install.html#linux) to install OnionShare in Linux as a Flatpak or Snap package.

## Documentation

To learn how OnionShare works, what its security properties are, how to use it, and how to contribute to the project, check out <https://docs.onionshare.org>.

## About

Securely and anonymously share files, host websites, and chat with friends using the Tor network

[onionshare.org/](https://onionshare.org/ "https://onionshare.org/")

### Topics

[python](/topics/python "Topic: python")
[open-source](/topics/open-source "Topic: open-source")
[security](/topics/security "Topic: security")
[cross-platform](/topics/cross-platform "Topic: cross-platform")
[file-sharing](/topics/file-sharing "Topic: file-sharing")
[tor](/topics/tor "Topic: tor")
[onion-service](/topics/onion-service "Topic: onion-service")
[onionshare](/topics/onionshare "Topic: onionshare")
[tor-onion-service](/topics/tor-onion-service "Topic: tor-onion-service")

### Resources

[Readme](#readme-ov-file)
### License

[View license](#License-1-ov-file)

[Activity](/onionshare/onionshare/activity)
[Custom properties](/onionshare/onionshare/custom-properties)
### Stars

[**6.4k**
stars](/onionshare/onionshare/stargazers)
### Watchers

[**185**
watching](/onionshare/onionshare/watchers)
### Forks

[**660**
forks](/onionshare/onionshare/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fonionshare%2Fonionshare&report=onionshare+%28user%29)

## [Releases 34](/onionshare/onionshare/releases)

[OnionShare 2.6.2
Latest

Mar 21, 2024](/onionshare/onionshare/releases/tag/v2.6.2)
[+ 33 releases](/onionshare/onionshare/releases)

## [Packages 0](/orgs/onionshare/packages?repo_name=onionshare)

No packages published

## [Contributors 235](/onionshare/onionshare/graphs/contributors)

[+ 221 contributors](/onionshare/onionshare/graphs/contributors)

## Languages

* [Python
  95.2%](/onionshare/onionshare/search?l=python)
* [JavaScript
  1.7%](/onionshare/onionshare/search?l=javascript)
* [HTML
  1.5%](/onionshare/onionshare/search?l=html)
* [CSS
  0.9%](/onionshare/onionshare/search?l=css)
* [Shell
  0.6%](/onionshare/onionshare/search?l=shell)
* [PowerShell
  0.1%](/onionshare/onionshare/search?l=powershell)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_d6542a90_20250124_211503.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](4) [[next>]](../../../2016/05/24/1) [[thread-next>]](../../../2016/05/24/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20160523181917.GA19626@sisay.ephaone.org>
Date: Mon, 23 May 2016 20:19:17 +0200
From: Michael Scherer <misc@...b.org>
To: oss-security@...ts.openwall.com
Subject: CVE request: /tmp usage race condition in onionshare

Hi,

I found a rather complicated issue regarding /tmp and onionshare, a
utility to share file over tor hidden services.

See
<https://github.com/micahflee/onionshare/blob/master/onionshare/hs.py#L105>
for the start of the problem.

And <https://www.torproject.org/docs/tor-hidden-service.html.en> for
more details on what happen for hidden services.

So onionshare use /tmp/onionshare to create a temporary directory
$HS that is then used for the creation of a tor hidden service, as
HiddenServiceDir configuration.  Then, the tor daemon create 2 files
in $HS, one for the hidden service hostname, the other for the
private key

But onionshare doesn't verify the owner or the exact permission of
/tmp/onionshare.  So if a attacker pre-create a directory
/tmp/onionshare with 777 permissions and him as a owner, he can use
a race condition to inject his own files in the share.

Since the file 'hostname' is created by tor, then opened and read by
onionshare, the attacker could use inotify on the temporary
directory and rename the $HS dir (since he own /tmp/onionshare) and
substitute his own directory with a crafted hostname directing to
his own hiddenservice, thus permitting him to inject his own
hiddenservices and so own files in the exchange, which seems to be a
potential problem.

I suspect that using setgid on /tmp/onionshare might also give
interesting potential attacks.  For example, if umask is not properly
set, the attacker could steal the private key and hostname, thus
being able to place himself as man in the middle during the
exchange, which make the previous attack easier (since the attacker
just have to set a proxy, rather than guessing the filename or
something like this)

I am also not 100% sure that
<https://github.com/micahflee/onionshare/blob/master/onionshare/hs.py#L217>
and
<https://github.com/micahflee/onionshare/blob/master/onionshare/hs.py#L116>
are safe if a attacker control the directory that will be used for
shutil.rmtree.

I tried to contact upstream 5 months ago without results.

So I guess I can go public and provides a patch once I have a CVE id
assigned ( or any others kind of way to identify the vuln...)

--
Michael Scherer

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_1c120100_20250124_211504.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2016/05/25/1) [[<thread-prev]](../../../2016/05/23/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160524233429.36792B2E006@smtpvbsrv1.mitre.org>
Date: Tue, 24 May 2016 19:34:29 -0400 (EDT)
From: cve-assign@...re.org
To: misc@...b.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: /tmp usage race condition in onionshare

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> So onionshare use /tmp/onionshare to create a temporary directory
> $HS that is then used for the creation of a tor hidden service, as
> HiddenServiceDir configuration.  Then, the tor daemon create 2 files
> in $HS
>
> But onionshare doesn't verify the owner or the exact permission of
> /tmp/onionshare.  So if a attacker pre-create a directory
> /tmp/onionshare with 777 permissions and him as a owner, he can use
> a race condition to inject his own files in the share.
>
> I suspect that using setgid on /tmp/onionshare might also give
> interesting potential attacks.  For example, if umask is not properly
> set, the attacker could steal the private key and hostname

As far as we can tell, there is only one primary problem: the product
accepts the existence of a pre-created /tmp/onionshare for which
ownership and all permission bits are controlled by the attacker.
(Control over the setgid bit isn't really an independent problem with
a realistically independent solution.)

Use CVE-2016-5026.

> I am also not 100% sure that
> <https://github.com/micahflee/onionshare/blob/master/onionshare/hs.py#L217>
> and
> <https://github.com/micahflee/onionshare/blob/master/onionshare/hs.py#L116>
> are safe if a attacker control the directory that will be used for
> shutil.rmtree.

Nobody has commented on this today, so we are not going to assign a
separate CVE ID related to an shutil.rmtree impact unless there is
further research by someone.

The code has "self.cleanup_filenames.append(self.hidserv_dir)" and the
product should have been designed so that self.hidserv_dir is never
something controlled by an arbitrary unauthorized local user. Possibly
you are envisioning a threat model in which the attacker controls the
process running tor but not the process running onionshare. In that
situation, it might be important to understand whether there's any
symlink following in shutil.rmtree, because this might allow the tor
process to trigger unlink actions with the privileges of the
onionshare process.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXRORnAAoJEHb/MwWLVhi2AjAP/213PqKqOX4HRjUx4vU2Y4gd
PUqAk17+LR9BgsIbWJTCl1kcXGSlpHHqsgq/8W3OP+Aumsr6iLy5ksZmw7D9xgyW
wYOslFWUA6z9Drt/P24OxiDrHfpqRAxyPclAQJbSgNwmBk9iQK9Tpb+ACLDr3yOU
XBcbnBr1QKT2kOFogdB8bx+Qz/uhR9wAJ0f37nJ+iI3Y6pzeKzMDEHl/je9/Pa+X
iHjUPuKYHU/A+X+2mN3nBmuXJerijn/MBKjgxW3L4DCNOr5NUC1UQ2WULE9WIds1
DS6CvpaVsZXSA5Q094HFvo0M2AoyfePpQuVuGgPZ3tens//In3pr3xkKPT316HW4
eKNH7I9L6Xc604a64TzFmSQnWui7ZlOwFy/0aR8p2mZCBYEKqMkV1OvFx78EE0pw
QpZMRuoz3EcnwNfIhKYpzVzCf1UOKw7srdIfuxnLO6dAPQhMnios26mU7BnxxlLR
4UiZQWeDMZVBqwd+NJnL1NupgAs/4H1mQ+vKIn/obpYnTxGb8q1+x61eyk1Ueh/O
JFBj4gfMnO7v/zA0wtlDK/otE9j/XxWHTw9gKH7BAr3wdbJFPoYnng2CMRFjBva3
Kq4j/ml0BclQDxmk4/3PVc19rO56h0EgMKccArJSVANjMrj3YDmKlTcS2YcaJIVa
zFC5SNEvmY0EdRR6f2gX
=RzaD
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


