```
{
  "vulnerability": {
    "cve_id": "CVE-2016-5390",
    "description": "Non-admin users with the view_hosts permission containing a filter are able to access API routes beneath \"hosts\" such as GET /api/v2/hosts/secrethost/interfaces without the filter being taken into account. This allows users to access network interface details (including BMC login details) for any host.\n\nThe filter is only correctly used when accessing the main host details (/api/v2/hosts/secrethost). Access to the \"nested\" routes, which includes interfaces, reports, parameters, audits, facts and Puppet classes, is not authorized beyond requiring any `view_hosts` permission.",
    "affected_versions": "1.10.0 and higher",
    "fixed_versions": [
      "1.12.1",
      "1.11.4"
    ],
     "root_cause": "The vulnerability stems from the fact that when accessing nested API routes under `/api/v2/hosts/:id/*` (e.g., interfaces, reports), the application does not properly apply the view_hosts filters defined for non-admin users. The code incorrectly checks if the resource responds to `.authorized` method. The Host class is a module not a class, therefore the check returns false, and no authorization is applied.",
    "vulnerabilities": [
      "Inadequate access control",
      "Improper authorization"
    ],
    "impact": "Unauthorized access to sensitive host information including network interfaces details and BMC login details.",
     "attack_vector": "An attacker can exploit this vulnerability by making API requests to nested routes under /api/v2/hosts/:id/* such as /api/v2/hosts/secrethost/interfaces with view_hosts permission but without the appropriate filters.",
    "required_capabilities": "The attacker needs to have a non-admin user account with `view_hosts` permission and knowledge of the target host name."
  }
}
```