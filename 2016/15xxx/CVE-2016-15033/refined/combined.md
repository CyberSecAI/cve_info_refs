=== Content from www.wordfence.com_188d7ba7_20250125_154031.html ===


# JavaScript is disabled

In order to continue, we need to verify that you're not a robot.
This requires JavaScript. Enable JavaScript and then reload the page.



=== Content from blog.nintechnet.com_ae821df1_20250125_154029.html ===

[![NinTechNet](https://blog.nintechnet.com/wp-content/uploads/2018/07/nintechnet_logo.png)](https://nintechnet.com/)

[NinTechNet](https://nintechnet.com/ "Back to NinTechNet's home")

The Ninja Technologies Network

[Skip to content](#content)
[Menu](#header-menu-responsive)

* [Blog Summary](https://blog.nintechnet.com/)
* [NinTechNet’s Home](https://nintechnet.com/)

# Arbitrary file upload vulnerability in WordPress Delete-All-Comments plugin.

* by [NinTechNet](https://blog.nintechnet.com/author/nintechnet/)
* Posted on [December 10, 2016 - 4:40pm [+0700]May 3, 2019 - 7:51pm [+0700]](https://blog.nintechnet.com/arbitrary-file-upload-vulnerability-in-wordpress-delete-all-comments-plugin/)

On November 20th, while auditing a hacked WordPress website, we identified a critical vulnerability in the [Delete All Comments](https://wordpress.org/plugins/delete-all-comments/) WordPress plugin v2.0, which has over 30,000 active installations.

Because a part of the `delete-all-comments.php` main script is not restricted to the administrator, any unauthenticated user can upload a remote PHP script into the `/plugins/delete-all-comments/backup/` folder:

```
14    if(isset($_POST['restorefromfileNAME']) || isset($_POST['restorefromfileURL']))
15    {
16
17    if(!file_exists(dirname(__file__)."/backup/".$_POST['restorefromfileNAME']))
18       {
19          $fileUrl=$_POST['restorefromfileNAME'];
20          $fileName=$fileUrl;
21          $extension=explode(".",$fileUrl);
22          file_put_contents(dirname(__file__)."/backup/$fileName",file_get_contents($_POST['restorefromfileURL']));
23          file_put_contents(dirname(__file__)."/content.log","working");

```

An attacker can assign the destination file name to the `$_POST['restorefromfileNAME']` variable and the remote file to download to

the `$_POST['restorefromfileURL']` variable. The remote script will be uploaded into the `/backup/` sub-folder.

Here is a sample of the HTTP log showing a real attack:

```
95.153.xx.xx - - [20/Nov/2016:11:41:34 +0700] "POST /wp-content/plugins/delete-all-comments/delete-all-comments.php HTTP/1.1" 200 57
95.153.xx.xx - - [20/Nov/2016:11:42:09 +0700] "GET /wp-content/plugins/delete-all-comments/backup/wp-conf.php HTTP/1.1" 200 1782

```
### Recommendations

The author was informed on November 20th but did not respond. We contacted the WordPress plugin department and the plugin was removed from the repository the same day. Therefore, there is no patch or fix available.

As that vulnerability is a 0day, i.e., it is currently being exploited, consider uninstalling the plugin ASAP.

Alternatively, if your are using [NinjaFirewall (WP/WP+ Edition)](https://nintechnet.com/ninjafirewall/), our WordPress WAF, you are protected against it.

Tagged: [NinjaFirewall](https://blog.nintechnet.com/tag/ninjafirewall/), [Security](https://blog.nintechnet.com/tag/security/), [Vulnerability](https://blog.nintechnet.com/tag/vulnerability/), [WordPress](https://blog.nintechnet.com/tag/wordpress/)

* [Share on Twitter](https://twitter.com/share?text=Arbitrary%20file%20upload%20vulnerability%20in%20WordPress%20Delete-All-Comments%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Farbitrary-file-upload-vulnerability-in-wordpress-delete-all-comments-plugin%2F)
* [Share on Facebook](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fblog.nintechnet.com%2Farbitrary-file-upload-vulnerability-in-wordpress-delete-all-comments-plugin%2F)
* [Share on Reddit](https://www.reddit.com/submit?title=Arbitrary%20file%20upload%20vulnerability%20in%20WordPress%20Delete-All-Comments%20plugin.&url=https%3A%2F%2Fblog.nintechnet.com%2Farbitrary-file-upload-vulnerability-in-wordpress-delete-all-comments-plugin%2F)
* [RSS icon](https://blog.nintechnet.com/feed/)

## Post navigation

[Previous Latest Joomla! critical vulnerability being actively exploited in the wild.](https://blog.nintechnet.com/latest-joomla-critical-vulnerability-being-actively-exploited-in-the-wild/)[Next Hackers targeting web hosts customer accounts.](https://blog.nintechnet.com/hackers-targeting-web-hosts-customer-accounts/)

## Our Products

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfwp-150.png)

**NinjaFirewall WP+**

Web Application Firewall for WordPress. It will give your blog the highest level of protection it deserves.

Free Download

---

![SaferCheckout](https://blog.nintechnet.com/wp-content/uploads/safercheckout_150x150.png)

**SaferCheckout**

A powerful security plugin to protect WooCommerce stores from fraudulent transactions.

Free Download

---

![NinjaFirewall](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-nfpro-150.png)

**NinjaFirewall Pro+**

Web Application Firewall for PHP applications. It will protect your PHP site, from custom scripts to popular shopping cart and CMS applications.

Free Download

---

![Code Profiler](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-cp-150.png)

**Code Profiler**

Speed up your WordPress website by locating bottlenecks and performance issues in your plugins and themes.

Free Download

---

![NinjaScanner](https://blog.nintechnet.com/wp-content/uploads/2018/09/logo-ns-150.png)

**NinjaScanner**

A lightweight, fast and powerful malware and virus scanner for WordPress which includes many features to help you scan your blog for malware and virus.

Free Download
## Categories

Categories
Select Category
Benchmarks  (5)
Code Profiler  (1)
HHVM  (1)
Joomla!  (2)
Magento  (1)
NinjaFirewall  (150)
NinjaScanner  (8)
Performance  (2)
Privacy  (1)
Security  (154)
   Brute-force attack  (5)
   Malware  (7)
   Phishing  (2)
   Virus  (2)
   Vulnerability  (129)
Troubleshooting  (14)
Tutorial  (26)
WooCommerce  (2)
WordPress  (149)

## Search

Search for:

Search

## Recent Posts

* [XSS / HTML injection vulnerability in WordPress Plugin Check (PCP) plugin.](https://blog.nintechnet.com/xss-html-injection-vulnerability-in-wordpress-plugin-check-pcp-plugin/)
  December 6, 2024 - 7:24pm [+0700]
* [How to debug WooCommerce Add to Cart action with Code Profiler.](https://blog.nintechnet.com/how-to-debug-woocommerce-add-to-cart-action-with-code-profiler/)
  November 28, 2024 - 7:00pm [+0700]
* [SaferCheckout: Fraud prevention plugin for WooCommerce stores.](https://blog.nintechnet.com/safercheckout-fraud-prevention-plugin-for-woocommerce-stores/)
  August 5, 2024 - 5:31pm [+0700]
* [Unauthenticated function injection vulnerability in WordPress Shortcode Addons plugin (unpatched).](https://blog.nintechnet.com/unauthenticated-function-injection-vulnerability-in-wordpress-shortcode-addons-plugin-unpatched/)
  April 22, 2024 - 11:29am [+0700]
* [Broken access control vulnerability fixed in WordPress 10Web AI Assistant plugin.](https://blog.nintechnet.com/broken-access-control-vulnerability-fixed-in-wordpress-10web-ai-assistant-plugin/)
  January 26, 2024 - 1:50pm [+0700]

© Copyright
2025 – [The Ninja Technologies Network](https://nintechnet.com/)



=== Content from wordpress.org_837e6b9e_20250125_154030.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

Delete All Comments

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdelete-all-comments&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdelete-all-comments&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/delete-all-comments.svg)
# delete-all-comments

By [ryanbose, Ganesh Chandra](https://wordpress.org/plugins/delete-all-comments/)

* [Details](https://wordpress.org/plugins/delete-all-comments/#description)
* [Reviews](https://wordpress.org/plugins/delete-all-comments/#reviews)
* [Development](https://wordpress.org/plugins/delete-all-comments/#developers)

[Support](https://wordpress.org/support/plugin/delete-all-comments/)

## Description

This plugin has been closed as of November 28, 2017 and is not available for download. Reason: Unknown.

## Reviews

![](https://secure.gravatar.com/avatar/323129c7df166f8cb620034689d819d6982ec758f4456d335b1a35f02e8b56ab?s=60&d=retro&r=g)
### [Was Hacked Twice](https://wordpress.org/support/topic/was-hacked-twice/)

[ubound](https://profiles.wordpress.org/ubound/ "Posts by ubound")
November 20, 2016

I am sorry to the author that I have to give this one star review, but I feel it’s important to warn others about potential dangers of using this plugin.
Truth be told: I used this plugin for a long time and it was perfect. Then something happened after last update. The plugin stopped working, but I was too busy to figure that out. So I left it without deleting and forgot about it.
Then after some time Wordfence alerts me about admin login from another country with an administrative username I never created. Hacked!
I was alerted only one hour after they broke into my site, so I it wasn’t hard to undo the damage. That’s when I began to suspect that “Delete All Comments” was used as a backdoor to my site. I have a similar set up across several sites, but only the one with “Delete All Comments” was hacked.
I cleaned up their files and deleted “Delete All Comments”. For about 3 weeks I lived peacefully. But today again, Wordfence alerted me about administrator’s login but this time with MY username but from India! (I am not in India and I just woke up when I was alerted).
Thankfully, it happened so that only two minutes passed since their login and till I noticed the problem. Again, I rushed to create a new administrator and deleted the old one. They had not much time to do the damage, but they were fast enough because in my cPanel the latest modified file was in plugins folder and belonged to “Delete All Comments” (which was definitely deleted, so they installed it again!).
I cleaned up everything again but still need to spend some time figuring out how they were able to enter again this time. It must be that simply deleting “Delete All Comments” doesn’t remove everything that needs to be removed and leaves some type of a backdoor.
So no, don’t install it. Thanks to the author for all the type (about two years) that I was able to use it without problems, but now I wouldn’t recommend this plugin.

![](https://secure.gravatar.com/avatar/62dc988cfbd2325fb6948880d17aa2294b02433b82f568dc4b2e5415d570d975?s=60&d=retro&r=g)
### [DO NOT USE](https://wordpress.org/support/topic/do-not-use-20/)

[rixorcizm](https://profiles.wordpress.org/rixorcizm/ "Posts by rixorcizm")
November 8, 2016

Sadly I can’t endorse this plugin. I work for a UK based host that actively tracks compromises on customer based sites and the number of compromises that relate to this plugin is steadily growing. It’s entirely exploitable, allowing (people who know what they’re doing) the ability to upload unverified files that could do pretty much anything within reason. I’ve had an instance recently where a file was uploaded via a POST request to the plugins main file (delete-all-comments.php), and that’s then injected a user into the DB, allowing someone to login to the relevant admin area.
Until this has been verified fixed, or at least updated in some manner – do yourself a favour and stay the hell away.

![](https://secure.gravatar.com/avatar/ae4c8d43d817e23537269d61105015c2aff0e1cd9fab376a895b5d7349b46414?s=60&d=retro&r=g)
### [ALERT! THIS PLUGIN HACK MI SITE!!!!](https://wordpress.org/support/topic/alert-this-plugin-hack-mi-site/)

[krola](https://profiles.wordpress.org/krola/ "Posts by krola")
October 13, 2016

After Installing, someone install a php in my site and delete my theme.

![](https://secure.gravatar.com/avatar/9149875a8cf2875474223005576f7c412e7b4d07df82160adc687a8252227a5d?s=60&d=retro&r=g)
### [Great plugin](https://wordpress.org/support/topic/great-plugin-10013/)

[Hareesh S](https://profiles.wordpress.org/hareesh-pillai/ "Posts by Hareesh S")
September 3, 2016

Deleted about 10,000 comments in a second. Thanks!

![](https://secure.gravatar.com/avatar/4a23ff7e2e2b8dfb4301b43dc5d8e53a834a3ee4f94f175df4734723742eaa56?s=60&d=retro&r=g)
### [DELETED! Very happy about that.](https://wordpress.org/support/topic/deleted-very-happy-about-that/)

[carricdesign](https://profiles.wordpress.org/carricdesign/ "Posts by carricdesign")
September 3, 2016

Had to delete over 50,000 comments. Worked in seconds. Thanks!

![](https://secure.gravatar.com/avatar/1a9c1c1a355b321d96df41401a828b782f0def4295c56b1da5be769e1195169e?s=60&d=retro&r=g)
### [Internal error occured. Please try again later.](https://wordpress.org/support/topic/internal-error-occured-please-try-again-later/)

[rolandaa](https://profiles.wordpress.org/rolandaa/ "Posts by rolandaa")
September 3, 2016

Got 24k comments to get rid off! This plugin is not working on two of our sites, the rest 38 sites it works ok tough!
Regards / Roland

[Read all 51 reviews](https://wordpress.org/support/plugin/delete-all-comments/reviews/)
## Contributors & Developers

“Delete All Comments” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/3e17f5378964d5a9293f03045931dfd7cb1a0b171f39eec6e902bbde4d469fab?s=32&d=mm&r=g) [Ganesh Chandra](https://profiles.wordpress.org/osolutions/)

[Translate “Delete All Comments” into your language.](https://translate.wordpress.org/projects/wp-plugins/delete-all-comments)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/delete-all-comments/), check out the [SVN repository](https://plugins.svn.wordpress.org/delete-all-comments/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/delete-all-comments/) by [RSS](https://plugins.trac.wordpress.org/log/delete-all-comments/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **2.0**
* Last updated **7 years ago**
* Active installations **N/A**
* WordPress version **4.0 or higher**
* Tested up to **4.6.29**
* [Advanced View](https://wordpress.org/plugins/delete-all-comments/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)


