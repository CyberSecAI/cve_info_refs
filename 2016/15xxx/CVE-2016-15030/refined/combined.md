=== Content from github.com_f77e4370_20250125_182023.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FArno0x%2FTwoFactorAuth%2Fpull%2F3)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FArno0x%2FTwoFactorAuth%2Fpull%2F3)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=Arno0x%2FTwoFactorAuth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Arno0x](/Arno0x)
/
**[TwoFactorAuth](/Arno0x/TwoFactorAuth)**
Public

* [Notifications](/login?return_to=%2FArno0x%2FTwoFactorAuth) You must be signed in to change notification settings
* [Fork
  44](/login?return_to=%2FArno0x%2FTwoFactorAuth)
* [Star
   130](/login?return_to=%2FArno0x%2FTwoFactorAuth)

* [Code](/Arno0x/TwoFactorAuth)
* [Issues
  6](/Arno0x/TwoFactorAuth/issues)
* [Pull requests
  3](/Arno0x/TwoFactorAuth/pulls)
* [Actions](/Arno0x/TwoFactorAuth/actions)
* [Projects
  0](/Arno0x/TwoFactorAuth/projects)
* [Wiki](/Arno0x/TwoFactorAuth/wiki)
* [Security](/Arno0x/TwoFactorAuth/security)
* [Insights](/Arno0x/TwoFactorAuth/pulse)

Additional navigation options

* [Code](/Arno0x/TwoFactorAuth)
* [Issues](/Arno0x/TwoFactorAuth/issues)
* [Pull requests](/Arno0x/TwoFactorAuth/pulls)
* [Actions](/Arno0x/TwoFactorAuth/actions)
* [Projects](/Arno0x/TwoFactorAuth/projects)
* [Wiki](/Arno0x/TwoFactorAuth/wiki)
* [Security](/Arno0x/TwoFactorAuth/security)
* [Insights](/Arno0x/TwoFactorAuth/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FArno0x%2FTwoFactorAuth%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FArno0x%2FTwoFactorAuth%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Security Vulnerabilities #3

 Merged

[Arno0x](/Arno0x)
merged 10 commits into
[Arno0x:master](/Arno0x/TwoFactorAuth/tree/master "Arno0x/TwoFactorAuth:master")
from
[crackedeggs1:XSS-vulnerabilities](/crackedeggs1/TwoFactorAuth/tree/XSS-vulnerabilities "crackedeggs1/TwoFactorAuth:XSS-vulnerabilities")

Jan 29, 2016

 Merged

# [Security Vulnerabilities](#top) #3

[Arno0x](/Arno0x)
merged 10 commits into
[Arno0x:master](/Arno0x/TwoFactorAuth/tree/master "Arno0x/TwoFactorAuth:master")
from
[crackedeggs1:XSS-vulnerabilities](/crackedeggs1/TwoFactorAuth/tree/XSS-vulnerabilities "crackedeggs1/TwoFactorAuth:XSS-vulnerabilities")

Jan 29, 2016

[Conversation
5](/Arno0x/TwoFactorAuth/pull/3)
[Commits
10](/Arno0x/TwoFactorAuth/pull/3/commits)
[Checks
0](/Arno0x/TwoFactorAuth/pull/3/checks)
[Files changed](/Arno0x/TwoFactorAuth/pull/3/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=60&v=4)](/crackedeggs1)

Copy link

Contributor

### @crackedeggs1 **[crackedeggs1](/crackedeggs1)** commented [Jan 27, 2016](#issue-129292020)

The following issues are resolved:

* Potential (but unlikely) cross-site scripting vulnerabilities when admins manage users with unsafe characters in their names.
* Cross-site scripting vulnerability when any user logs in by following a link posted by someone else.
* Failed login phishing vulnerability when any user logs in by following a link posted by someone else.
* Wrong success URL after failed login attempt. (Not a vulnerability but resolved nonetheless)
* Resolved inconsistencies with encoding convention of stored usernames.
* Potential SQL injection vulnerabilities involving an SQLite3 bug and NUL terminator bytes.

Notes:

* Some users who were affected by data storage inconsistencies might require an admin to reset their password/qrcode.

Again, please review these changes carefully before merging. There are a number of significant changes rolled up here. The last thing we want is to prevent users from logging in, or to prevent the installer from creating the first admin. I'm pretty sure these are the changes I'm using in production, but I could have made a copy-paste error or there might be a use-case I've overlooked that is now broken...

Sorry, something went wrong.

All reactions

 [crackedeggs1](/crackedeggs1)
added 10 commits
[January 27, 2016 14:29](#commits-pushed-1b82b88)

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[Security fix](/Arno0x/TwoFactorAuth/pull/3/commits/1b82b8814c7b5568b3fc60905df668afe880905c "Security fix

This should fix an XSS vector, which here, could have been used to place Javascript which would listen for the user's name, password, and token, and send it to a remote server which would login first.
The method used to fix should also have the benefit of preserving ?from= when authentication fails (maybe the user ran out of time, or mistyped), so that after failure+success, the user is still forwarded to the 'from' address, rather than the URL named by AUTH_SUCCEED_REDIRECT_URL.")`
 …

`[1b82b88](/Arno0x/TwoFactorAuth/pull/3/commits/1b82b8814c7b5568b3fc60905df668afe880905c)`

```
This should fix an XSS vector, which here, could have been used to place Javascript which would listen for the user's name, password, and token, and send it to a remote server which would login first.
The method used to fix should also have the benefit of preserving ?from= when authentication fails (maybe the user ran out of time, or mistyped), so that after failure+success, the user is still forwarded to the 'from' address, rather than the URL named by AUTH_SUCCEED_REDIRECT_URL.
```

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[a lot of XSS here](/Arno0x/TwoFactorAuth/pull/3/commits/6fd2b41c3fdb1f2689c1c73eaafa3f3943c9a743 "a lot of XSS here

A lot of XSS was possible here if an admin had ever let users pick their own usernames")`
 …

`[6fd2b41](/Arno0x/TwoFactorAuth/pull/3/commits/6fd2b41c3fdb1f2689c1c73eaafa3f3943c9a743)`

```
A lot of XSS was possible here if an admin had ever let users pick their own usernames
```

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[for good measure](/Arno0x/TwoFactorAuth/pull/3/commits/49fb6d2c6e9afe6d5e4ce9b2cd21d20354ee04f9 "for good measure")`

`[49fb6d2](/Arno0x/TwoFactorAuth/pull/3/commits/49fb6d2c6e9afe6d5e4ce9b2cd21d20354ee04f9)`

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[secure both variants](/Arno0x/TwoFactorAuth/pull/3/commits/b89186b475628f54da1473b8203285cdc1bc3b1e "secure both variants")`

`[b89186b](/Arno0x/TwoFactorAuth/pull/3/commits/b89186b475628f54da1473b8203285cdc1bc3b1e)`

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[convert both kinds of quotes](/Arno0x/TwoFactorAuth/pull/3/commits/0fe9a69671ed864af913cfae83b1d6a7961f2d8d "convert both kinds of quotes")`

`[0fe9a69](/Arno0x/TwoFactorAuth/pull/3/commits/0fe9a69671ed864af913cfae83b1d6a7961f2d8d)`

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[parse error](/Arno0x/TwoFactorAuth/pull/3/commits/72cb9468c4f94ec1b311de067e4a80c47b81fcd4 "parse error")`

`[72cb946](/Arno0x/TwoFactorAuth/pull/3/commits/72cb9468c4f94ec1b311de067e4a80c47b81fcd4)`

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[name rules of 1st admin consistent w/ others](/Arno0x/TwoFactorAuth/pull/3/commits/f78106fad5747286685088197be9521e9666e3c6 "name rules of 1st admin consistent w/ others")`

`[f78106f](/Arno0x/TwoFactorAuth/pull/3/commits/f78106fad5747286685088197be9521e9666e3c6)`

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[& => &amp;, etc](/Arno0x/TwoFactorAuth/pull/3/commits/656e31e19a6b4a09b80d07fb7dc663edafa3b587 "& => &amp;, etc

Really just a standards thing")`
 …

`[656e31e](/Arno0x/TwoFactorAuth/pull/3/commits/656e31e19a6b4a09b80d07fb7dc663edafa3b587)`

```
Really just a standards thing
```

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[protection against NUL bytes](/Arno0x/TwoFactorAuth/pull/3/commits/4be3ac28cdaa93569eed9c2ab54065578d28cc70 "protection against NUL bytes

Also refactor where code was reused.")`
 …

`[4be3ac2](/Arno0x/TwoFactorAuth/pull/3/commits/4be3ac28cdaa93569eed9c2ab54065578d28cc70)`

```
Also refactor where code was reused.
```

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

`[cross-site ?from can be used for phishing](/Arno0x/TwoFactorAuth/pull/3/commits/8549ad3cf197095f783643e41333586d6a4d0e54 "cross-site ?from can be used for phishing

Using cross-site ?from, the user can be presented with a fake \"auth failed\" page, which will trick them into logging in again. Since they are now on a different site, the site can capture their user, password, and current token in order to steal their access to the real site.")`
 …

`[8549ad3](/Arno0x/TwoFactorAuth/pull/3/commits/8549ad3cf197095f783643e41333586d6a4d0e54)`

```
Using cross-site ?from, the user can be presented with a fake "auth failed" page, which will trick them into logging in again. Since they are now on a different site, the site can capture their user, password, and current token in order to steal their access to the real site.
```

[![@Arno0x](https://avatars.githubusercontent.com/u/10797139?s=80&u=c426d9300f4861f8046b7dadb00f9a658c493e27&v=4)](/Arno0x)

Copy link

Owner

### **[Arno0x](/Arno0x)** commented [Jan 28, 2016](#issuecomment-176154229)

| oh my godness... I'm learning so much looking at your code enhancements and fixes ! Many PHP syntax tricks I was not even aware of. There's also some few things I don't quite understand why you do it this way (the sqlQuery stuff) rather than my way.  I had a quick overview of your changes and it seems fine. I will however take some further time to learn from it and check what these changes exactly do (hopefully will tell the "why" you're doing it this way).  I'll then merge, probably by the end of the week. Just one question though: how can I test this branch of changes in my environment without merging on the master branch ?  Many thanks for your contribution. (makes me feel like I should stop coding and learn how to do things properly :-) |
| --- |

All reactions

Sorry, something went wrong.

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=80&v=4)](/crackedeggs1)

Copy link

Contributor

Author

### **[crackedeggs1](/crackedeggs1)** commented [Jan 28, 2016](#issuecomment-176194801)

| I'm not sure I'm not sure how to do it in git, but you can download the branch and test it separately like that.  Don't worry about it. You have no idea how often I find things like this in my own code. I've got a few more fixes to add here in general, but still trying to learn how github deals with branches, etc. My background is in mercurial, so everything is a little different here.  Regarding the sqlQuery stuff: your way worked fine and only had some minor issues (like trusting the safety of passwordhash and gauthsecret), but there is a known bug in one of the functions in the Sqlite3 library when certain characters were in the data, so we have to do it a slightly different way to prevent errors (maybe security related) if those characters ever make it to the query. |
| --- |

All reactions

Sorry, something went wrong.

![Arno0x](https://avatars.githubusercontent.com/u/10797139?s=60&v=4)

 **[Arno0x](/Arno0x)**
reviewed
[Jan 29, 2016](#discussion-diff-51258855)
 [View reviewed changes](/Arno0x/TwoFactorAuth/pull/3/files/8549ad3cf197095f783643e41333586d6a4d0e54#diff-2c8c95bdacef329a1928b942e93f5305dc34a78ace6e71ddda6f6a6e1e74188c)

[lib/dbManager.php](/Arno0x/TwoFactorAuth/pull/3/files#diff-2c8c95bdacef329a1928b942e93f5305dc34a78ace6e71ddda6f6a6e1e74188c)

|  |  |  |
| --- | --- | --- |
|  |  | // Prepare variables before the query |
|  |  | $username = SQLite3::escapeString ($username); |

Copy link

Owner

### @Arno0x **[Arno0x](/Arno0x)** [Jan 29, 2016](#discussion_r51258855)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Just curious why removing the SQLite3::escapeString function as it supposedly adds extra security with potential characters specific to sqlite queries that might appear in the username while not being already escaped by the previous sanitization performed with htmlspecialchars ?

Sorry, something went wrong.

All reactions

Copy link

Contributor

Author

### @crackedeggs1 **[crackedeggs1](/crackedeggs1)** [Jan 29, 2016](#discussion_r51264193)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

As I mentioned, there is a bug in the SQLite3 library: <https://bugs.php.net/bug.php?id=62361>

Also see: <http://security.stackexchange.com/questions/3611/sql-injection-why-isnt-escape-quotes-safe-anymore>

So considering both factors, I replaced all the escapeString calls with prepared statements, which don't need to be escaped and are more secure.

Sorry, something went wrong.

All reactions

Copy link

Owner

### @Arno0x **[Arno0x](/Arno0x)** [Jan 29, 2016](#discussion_r51264652)

There was a problem hiding this comment.

### Choose a reason for hiding this comment

The reason will be displayed to describe this comment to others. [Learn more](https://docs.github.com/articles/managing-disruptive-comments/#hiding-a-comment).

Choose a reason

Spam
Abuse
Off Topic
Outdated
Duplicate
Resolved

Hide comment

Oh, OK, so that was that line you were referring to when mentioning the SQLite3 library bug.

So all the commits you're proposing are good with me: I tested the whole branch in a test environment, went through all use-cases and it's seems all right. I'll merge now. Thanks for all those fixes, your time, and your contribution.

Sorry, something went wrong.

All reactions

[Arno0x](/Arno0x)
added a commit
that referenced
this pull request
[Jan 29, 2016](#ref-commit-4353544)
[![@Arno0x](https://avatars.githubusercontent.com/u/10797139?s=40&u=c426d9300f4861f8046b7dadb00f9a658c493e27&v=4)](/Arno0x)

`[Merge pull request](/Arno0x/TwoFactorAuth/commit/43535441857d8219606d101badca510691e4e8be "Merge pull request #3 from vaultwiki/XSS-vulnerabilities

Security Vulnerabilities") [#3](https://github.com/Arno0x/TwoFactorAuth/pull/3) [from vaultwiki/XSS-vulnerabilities](/Arno0x/TwoFactorAuth/commit/43535441857d8219606d101badca510691e4e8be "Merge pull request #3 from vaultwiki/XSS-vulnerabilities

Security Vulnerabilities")`
…

`[4353544](/Arno0x/TwoFactorAuth/commit/43535441857d8219606d101badca510691e4e8be)`

```
Security Vulnerabilities
```

[![@Arno0x](https://avatars.githubusercontent.com/u/10797139?s=40&u=c426d9300f4861f8046b7dadb00f9a658c493e27&v=4)](/Arno0x)
[Arno0x](/Arno0x)
merged commit [`4353544`](/Arno0x/TwoFactorAuth/commit/43535441857d8219606d101badca510691e4e8be)
into
Arno0x:master

[Jan 29, 2016](https://github.com/Arno0x/TwoFactorAuth/pull/3#event-531427775)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FArno0x%2FTwoFactorAuth%2Fpull%2F3)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

No milestone

Development

Successfully merging this pull request may close these issues.

2 participants

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=52&v=4)](/crackedeggs1) [![@Arno0x](https://avatars.githubusercontent.com/u/10797139?s=52&v=4)](/Arno0x)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_07d1e3d9_20250125_182021.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FArno0x%2FTwoFactorAuth%2Fcommit%2F8549ad3cf197095f783643e41333586d6a4d0e54)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FArno0x%2FTwoFactorAuth%2Fcommit%2F8549ad3cf197095f783643e41333586d6a4d0e54)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Arno0x%2FTwoFactorAuth)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Arno0x](/Arno0x)
/
**[TwoFactorAuth](/Arno0x/TwoFactorAuth)**
Public

* [Notifications](/login?return_to=%2FArno0x%2FTwoFactorAuth) You must be signed in to change notification settings
* [Fork
  44](/login?return_to=%2FArno0x%2FTwoFactorAuth)
* [Star
   130](/login?return_to=%2FArno0x%2FTwoFactorAuth)

* [Code](/Arno0x/TwoFactorAuth)
* [Issues
  6](/Arno0x/TwoFactorAuth/issues)
* [Pull requests
  3](/Arno0x/TwoFactorAuth/pulls)
* [Actions](/Arno0x/TwoFactorAuth/actions)
* [Projects
  0](/Arno0x/TwoFactorAuth/projects)
* [Wiki](/Arno0x/TwoFactorAuth/wiki)
* [Security](/Arno0x/TwoFactorAuth/security)
* [Insights](/Arno0x/TwoFactorAuth/pulse)

Additional navigation options

* [Code](/Arno0x/TwoFactorAuth)
* [Issues](/Arno0x/TwoFactorAuth/issues)
* [Pull requests](/Arno0x/TwoFactorAuth/pulls)
* [Actions](/Arno0x/TwoFactorAuth/actions)
* [Projects](/Arno0x/TwoFactorAuth/projects)
* [Wiki](/Arno0x/TwoFactorAuth/wiki)
* [Security](/Arno0x/TwoFactorAuth/security)
* [Insights](/Arno0x/TwoFactorAuth/pulse)

## Commit

[Permalink](/Arno0x/TwoFactorAuth/commit/8549ad3cf197095f783643e41333586d6a4d0e54)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

cross-site ?from can be used for phishing

[Browse files](/Arno0x/TwoFactorAuth/tree/8549ad3cf197095f783643e41333586d6a4d0e54)
Browse the repository at this point in the history

```
Using cross-site ?from, the user can be presented with a fake "auth failed" page, which will trick them into logging in again. Since they are now on a different site, the site can capture their user, password, and current token in order to steal their access to the real site.
```

* Loading branch information

[![@crackedeggs1](https://avatars.githubusercontent.com/u/7571412?s=40&v=4)](/crackedeggs1)

[crackedeggs1](/Arno0x/TwoFactorAuth/commits?author=crackedeggs1 "View all commits by crackedeggs1")
committed
Jan 27, 2016

1 parent
[4be3ac2](/Arno0x/TwoFactorAuth/commit/4be3ac28cdaa93569eed9c2ab54065578d28cc70)

commit 8549ad3

Showing
**1 changed file**
with
**6 additions**
and
**2 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

8 changes: 6 additions & 2 deletions

8
[login/login.php](#diff-b317fdd3ef1ee1a9b911d58749d2003f21d89ed2949871de3ed826aaaff2f6e9 "login/login.php")

Show comments

[View file](/Arno0x/TwoFactorAuth/blob/8549ad3cf197095f783643e41333586d6a4d0e54/login/login.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -84,8 +84,12 @@ |
|  |  |  |
|  |  | //-------------------------------------------------- |
|  |  | // Checking which URL we should redirect the user to |
|  |  | if (isset($\_POST["from"])) { |
|  |  | $from = urldecode($\_POST["from"]); |
|  |  | if (isset($\_GET['from'])) { |
|  |  | $from = $\_GET['from']; |
|  |  | if (preg\_match('#^(?:https?:)?//#', $\_GET['from'], $m)) { |
|  |  | $url = parse\_url($\_GET['from']); |
|  |  | $from = $url['path'] . (!empty($url['query']) ? '?' . $url['query'] : '') . (!empty($url['fragment']) ? '#' . $url['fragment'] : ''); |
|  |  | } |
|  |  | $redirectTo = ((isset($\_SERVER["HTTPS"]) && $\_SERVER["HTTPS"] === "on")? "https://" : "http://").$\_SERVER["SERVER\_NAME"].":".$\_SERVER["SERVER\_PORT"].$from; |
|  |  | } |
|  |  | else { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8549ad3`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FArno0x%2FTwoFactorAuth%2Fcommit%2F8549ad3cf197095f783643e41333586d6a4d0e54) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


