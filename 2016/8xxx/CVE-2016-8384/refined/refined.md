- **Root cause of vulnerability**: A heap-based buffer overflow in the `DHFSummary` function of AntennaHouse DMC HTMLFilter due to an integer underflow.

- **Weaknesses/vulnerabilities present**:
    - Heap-based buffer overflow: The `DHFSummary` function reads a size value from the DOC file, which is later used in `DMC_malloc`. A subsequent read of `someSize - 4` bytes into a buffer allocated with `someSize + 2`, where `someSize` can be manipulated to be 0, results in a very large read due to integer underflow during the subtraction, causing the overflow.
    - Integer underflow: The calculation `someSize - 4` results in an underflow when `someSize` is 0. The result is then cast to an `unsigned __int16` which becomes a large value `0xfffc` instead of a negative number.
- **Impact of exploitation**: Arbitrary code execution due to heap corruption.

- **Attack vectors**: A specially crafted DOC file is used as input to the AntennaHouse DMC HTMLFilter, specifically during the conversion to HTML.

- **Required attacker capabilities/position**: An attacker needs the ability to provide a malicious DOC file to the vulnerable software (e.g. MarkLogic). The attacker doesn't need any special privileges.