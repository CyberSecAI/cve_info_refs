=== Content from security.gentoo.org_536109de_20250125_144750.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libTIFF: Multiple vulnerabilities — GLSA **201701-16**

Multiple vulnerabilities have been found in libTIFF, the worst of
which may allow execution of arbitrary code.

### Affected packages

| Package | **media-libs/tiff** on all architectures |
| --- | --- |
| Affected versions | < **4.0.7** |
| Unaffected versions | >= **4.0.7** |

### Background

The TIFF library contains encoding and decoding routines for the Tag
Image File Format. It is called by numerous programs, including GNOME and
KDE applications, to interpret TIFF images.

### Description

Multiple vulnerabilities have been discovered in libTIFF. Please review
the CVE identifier and bug reports referenced for details.

### Impact

A remote attacker could entice a user to process a specially crafted
image file, possibly resulting in execution of arbitrary code with the
privileges of the process or a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libTIFF users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/tiff-4.0.7"

```
### References

* [CVE-2013-4243](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-4243)
* [CVE-2014-8127](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8127)
* [CVE-2014-8128](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8128)
* [CVE-2014-8129](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8129)
* [CVE-2014-8130](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8130)
* [CVE-2014-9330](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-9330)
* [CVE-2014-9655](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-9655)
* [CVE-2015-1547](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-1547)
* [CVE-2015-7313](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7313)
* [CVE-2015-7554](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7554)
* [CVE-2015-8665](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8665)
* [CVE-2015-8668](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8668)
* [CVE-2015-8683](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8683)
* [CVE-2015-8781](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8781)
* [CVE-2015-8782](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8782)
* [CVE-2015-8783](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8783)
* [CVE-2015-8784](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8784)
* [CVE-2016-3186](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3186)
* [CVE-2016-3619](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3619)
* [CVE-2016-3620](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3620)
* [CVE-2016-3621](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3621)
* [CVE-2016-3622](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3622)
* [CVE-2016-3623](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3623)
* [CVE-2016-3624](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3624)
* [CVE-2016-3625](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3625)
* [CVE-2016-3631](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3631)
* [CVE-2016-3632](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3632)
* [CVE-2016-3633](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3633)
* [CVE-2016-3634](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3634)
* [CVE-2016-3658](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3658)
* [CVE-2016-3945](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3945)
* [CVE-2016-3990](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3990)
* [CVE-2016-3991](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3991)
* [CVE-2016-5102](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5102)
* [CVE-2016-5314](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5314)
* [CVE-2016-5315](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5315)
* [CVE-2016-5316](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5316)
* [CVE-2016-5317](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5317)
* [CVE-2016-5318](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5318)
* [CVE-2016-5319](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5319)
* [CVE-2016-5320](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5320)
* [CVE-2016-5321](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5321)
* [CVE-2016-5322](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5322)
* [CVE-2016-5323](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5323)
* [CVE-2016-5652](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5652)
* [CVE-2016-5875](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5875)
* [CVE-2016-6223](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-6223)
* [CVE-2016-8331](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-8331)
* [CVE-2016-9273](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9273)
* [CVE-2016-9297](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9297)
* [CVE-2016-9448](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9448)
* [CVE-2016-9453](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9453)
* [CVE-2016-9532](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9532)

**Release date**

January 09, 2017

**Latest revision**

January 09, 2017: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [484542](https://bugs.gentoo.org/show_bug.cgi?id=484542)
* [534108](https://bugs.gentoo.org/show_bug.cgi?id=534108)
* [538318](https://bugs.gentoo.org/show_bug.cgi?id=538318)
* [561880](https://bugs.gentoo.org/show_bug.cgi?id=561880)
* [572876](https://bugs.gentoo.org/show_bug.cgi?id=572876)
* [585274](https://bugs.gentoo.org/show_bug.cgi?id=585274)
* [585508](https://bugs.gentoo.org/show_bug.cgi?id=585508)
* [599746](https://bugs.gentoo.org/show_bug.cgi?id=599746)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.talosintelligence.com_473efd25_20250125_144750.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2016-0190

## LibTIFF Tag Extension Remote Code Execution Vulnerability

##### October 25, 2016

##### CVE Number

CVE-2016-8331

### Report ID

{{ page.status }}

### Summary

An exploitable remote code execution vulnerability exists in the handling of TIFF images in LibTIFF. A crafted TIFF document can lead to a type confusion vulnerability resulting in remote code execution. This vulnerability can be triggered via a TIFF file delivered to the application using LibTIFF’s tag extension functionality.

### Tested Versions

LibTIFF - 4.0.6

### Product URLs

http://www.remotesensing.org/libtiff/

### CVSSv3 Score

8.1 - CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

### Details

There exists a vulnerability in the parsing and handling of TIFF images. A specially crafted TIFF image file can lead to an out of bounds write and ultimately to remote code execution. This vulnerability is present in the LibTIFF api and is present in the standard build.

TIFF offers support for tag extensions allowing for more tags than the standard TIFF specification. One such tag is number 326, BadFaxLines. When using this tag in LibTIFF it is possible to have a type confusion vulnerability where LibTIFF attempts to read a mistyped argument off of the variable argument list. Running the provided trigger through the Thumbnail utility provided by LibTIFF gives us the following crash.

```
   1130               case TIFF_DOUBLE:
-> 1131                 *va_arg(ap, double*) =
   1132                   *(double *)val;

(lldb) h
-=[registers]=-
[rax: 0x00000001003002d0] [rbx: 0x0000000000000146] [rcx: 0x0000390000003a03]
[rdx: 0x0000000000000020] [rsi: 0x0000000000000018] [rdi: 0x0000000100300170]
[rsp: 0x00007fff5fbff8e0] [rbp: 0x00007fff5fbff910] [ pc: 0x000000010001e08b]
[ r8: 0x0000000000000040] [ r9: 0x00007fff71d71110] [r10: 0xffffffffffffffff]
[r11: 0x0000000000000246] [r12: 0x0000000000000000] [r13: 0x0000000100300110]
[r14: 0x00007fff5fbff9d0] [r15: 0x0000000000000000] [efl: 0x0000000000010202]
[rflags: 00000000 NZ NS NO NC ND NI]

-=[stack]=-
7fff5fbff8e0 | 0000000000000001 0000000101002c00 | .........,......
7fff5fbff8f0 | eb008c3017da5776 0000000101002c00 | vW..0....,......
7fff5fbff900 | 0000000000000146 0000000000000000 | F...............
7fff5fbff910 | 00007fff5fbffa10 0000000100011338 | ..._....8.......

-=[disassembly]=-
    0x10001e080 <+9504>:  lea    rsp, [rsp + 0x98]
    0x10001e088 <+9512>:  mov    rcx, qword ptr [rcx]
->  0x10001e08b <+9515>:  mov    qword ptr [rcx], rax
    0x10001e08e <+9518>:  jmp    0x10001e30e               ; <+10158> at tif_dir.c:855
    0x10001e093 <+9523>:  nop    word ptr cs:[rax + rax]
    0x10001e0a0 <+9536>:  lea    rsp, [rsp - 0x98]

(lldb) bt
* thread #1: tid = 0x3008d362, 0x000000010001e08b libtiff.5.dylib`_TIFFVGetField(tif=<unavailable>, tag=326, ap=<unavailable>) + 9515 at tif_dir.c:1131, queue = 'com.apple.main-thread', stop reason = EXC_BAD_ACCESS (code=1, address=0x390000003a03)
  * frame #0: 0x000000010001e08b libtiff.5.dylib`_TIFFVGetField(tif=<unavailable>, tag=326, ap=<unavailable>) + 9515 at tif_dir.c:1131
    frame #1: 0x0000000100011338 libtiff.5.dylib`TIFFGetField [inlined] TIFFVGetField(tif=0x0000000101002c00, tag=326) + 335 at tif_dir.c:1176
    frame #2: 0x00000001000111e9 libtiff.5.dylib`TIFFGetField(tif=0x0000000101002c00, tag=326) + 345 at tif_dir.c:1160
    frame #3: 0x0000000100001c7b thumbnail`main + 12 at thumbnail.c:178
    frame #4: 0x0000000100001c6f thumbnail`main [inlined] cpTags at thumbnail.c:310
    frame #5: 0x0000000100001c6f thumbnail`main [inlined] cpIFD at thumbnail.c:386
    frame #6: 0x0000000100001c6f thumbnail`main(argc=<unavailable>, argv=<unavailable>) + 2415 at thumbnail.c:133
    frame #7: 0x00007fff8260f5ad libdyld.dylib`start + 1
    frame #8: 0x00007fff8260f5ad libdyld.dylib`start + 1

```

The crash occurs at the following lines of code:

```
tif_dir.c
   1130               case TIFF_DOUBLE:
-> 1131                 *va_arg(ap, double*) =
   1132                   *(double *)val;

```

Recall that `va_arg` retrieves the next available argument from the argument list `ap`. Let’s take a look at where this function was called.

```
int
TIFFGetField(TIFF * tif, uint32 tag, ...)
{
    int status;
    va_list ap;

    va_start(ap, tag)
    status = TIFFVGetField(tif, tag, ap); // Crash happens here
    va_end(ap);
    return (status);
}

```

We see that we are passing in the variable argument list from TIFFGetField into TIFFVGetField. Effectively this is a wrapper for creating the variable list that will be handled by each individual tag. Let’s traverse up one more function to see how `TIFFGetField` is called.

```
tools/thumbnail.c

136 #define	CopyField(tag, v) \
137     if (TIFFGetField(in, tag, &v)) TIFFSetField(out, tag, v)

165 case TIFF_LONG:
166		{ uint32 longv;
167		  CopyField(tag, longv); // Call to TIFFGetField
168		}
169		break;

```

Analyzing the crash a bit we can see the tag that we are crashing on is indeed number 326. Looking into the source we can see a double value is expected on the argument list but instead there is nothing there.

```
tif_dir.c:599
    switch (fip->field_type) {
            ...
tif_dir.c:659
        case TIFF_DOUBLE:
            *va_arg(ap, double*) =
                *(double *)val;
            ret_val = 1;
            break;
        default:
            ret_val = 0;
            break;
    }

```

The vulnerability arises due to the field type being determined to be a double, yet the variable argument list is empty causing an out of bounds write and ultimately leading to an exploitable condition.

### Crash Information

```
Crashed thread log =
: Dispatch queue: com.apple.main-thread
0   libtiff.5.dylib                 0x00000001045ea5e0 _TIFFVGetField + 2784 (tif_dir.c:1132)
1   libtiff.5.dylib                 0x00000001045e774b TIFFGetField + 219 (tif_dir.c:1177)
2   thumbnail                       0x00000001045d8c7b main + 2427 (thumbnail.c:178)
3   libdyld.dylib                   0x00007fff8260f5ad start + 1

log name is: ./crashlogs/libtiff-thumbnail-report_badfaxlines_tif.crashlog.txt
---
exception=EXC_BAD_ACCESS:signal=11:is_exploitable=yes:instruction_disassembly=movq  %rax,(%rcx):instruction_address=0x00000001045ea5e0:access_type=write:access_address=0x0000430000004403:
Crash accessing invalid address.  Consider running it again with libgmalloc(3) to see if the log changes.

```
### Timeline

2016-07-25 - Vendor Disclosure

2016-10-25 - Public Release

##### Credit

Tyler Bohan and Cory Duplantis

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2016-0187](/vulnerability_reports/TALOS-2016-0187) [Previous Report

TALOS-2016-0205](/vulnerability_reports/TALOS-2016-0205)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


