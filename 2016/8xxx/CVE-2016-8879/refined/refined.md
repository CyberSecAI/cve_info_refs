```
{
  "cve": "CVE-2016-8879",
  "affected_products": [
    "Foxit PDF Reader",
    "Foxit PhantomPDF",
    "Foxit PDF Editor",
    "Foxit PDF SDK",
    "Foxit PDF ActiveX",
    "Foxit Studio Photo",
    "Foxit Reader for Linux",
    "Foxit Reader for Mac",
    "Foxit PhantomPDF for Mac",
    "Foxit PDF SDK for Web",
    "Quick PDF Library"
  ],
  "vulnerabilities": [
    {
      "type": "Untrusted URL Invocation",
      "details": "The application loads images from all resources (including untrusted ones) when parsing image resources or fails to properly request user confirmation before getting or posting content from external HTTP servers. Attackers could exploit this to access resources or execute malicious actions under users’ systems by embedding malicious images or codes in PDF documents.",
      "impact": "Access to resources, execution of malicious actions on user system.",
      "attack_vector": "Embedding malicious images or codes in PDF documents, by loading images from untrusted resources or by not requesting user confirmation before getting/posting content from external HTTP servers.",
       "required_capabilities": "Ability to craft malicious PDF documents containing untrusted URLs or malicious content"
    },
    {
       "type": "Incorrect Signature Verification",
        "details": "The application improperly ignores the changes to the “/NeedsRendering” key or “TextField” field when verifying the XFA documents. Attackers could exploit this to manipulate document content and deceive users into trusting and signing the manipulated documents.",
      "impact": "Manipulation of document content, deceiving users into trusting and signing manipulated documents.",
       "attack_vector": "Manipulating XFA documents, specifically the `/NeedsRendering` key or `TextField` field.",
       "required_capabilities": "Ability to craft malicious or modify existing XFA documents."
    },
    {
      "type": "Information Disclosure",
       "details": "The application fails to provide a reasonable prompt for user confirmation when executing the “app.openDoc”/“LaunchAction” functions, or ignores the encryption elements and transmits form content in clear text without a proper prompt for users. Attackers could exploit this vulnerability to exfiltrate XFA data from other documents on the file system or from SMB servers, retrieve NTLM information, or access form data.",
       "impact": "Exfiltration of XFA data, retrieval of NTLM information, access to form data.",
      "attack_vector": "Crafting malicious XFA documents with the “app.openDoc” function, PDF files with the ‘’LaunchAction” function, or submitting form data in XFA documents without encryption. ",
      "required_capabilities": "Ability to craft malicious PDF and XFA documents"
    },
     {
      "type": "Use-After-Free",
      "details": "The application uses a wild pointer or null pointer without proper validation. Attackers could exploit this to execute remote code or cause the application to crash",
      "impact": "Remote code execution or denial of service via application crash.",
      "attack_vector": "Crafting a malicious PDF document that utilizes AcroForms, checkbox objects, or 3D page objects.",
      "required_capabilities": "Ability to craft malicious PDF documents with specific content"
    },
    {
      "type": "DLL Hijacking",
       "details": "The application fails to specify the secure search path when loading edputil.dll, which could be exploited by attackers to execute malicious actions.",
      "impact": "Execution of malicious actions.",
       "attack_vector":"Placing malicious DLL file `edputil.dll` in a location where it will be loaded before the legitimate one.",
        "required_capabilities": "Ability to control file system access to place a malicious DLL."
    },
    {
       "type": "Privilege Escalation",
       "details": "The application lacks proper validation when performing an update or installing a plugin. Attackers could exploit this to execute arbitrary code in the context of SYSTEM by loading malicious DLLs, calling an outdated version of the updater, or creating a junction to write an arbitrary file with full privileges.",
      "impact": "Arbitrary code execution in the context of SYSTEM, privilege escalation.",
       "attack_vector": "Malicious DLL loading, calling an outdated updater, creating a junction to write an arbitrary file.",
      "required_capabilities": "Ability to intercept or modify the update/plugin process of the application"
    },
        {
      "type": "Cross-Site Scripting",
       "details": "The application is vulnerable to Cross-Site Scripting when working with certain PDF files embedded with JavaScript. This occurs due to the incomplete isolation of the JavaScript execution environment in PDFs, which allows the JavaScript embedded in PDFs to be executed within the browser environment.",
       "impact": "JavaScript embedded in PDFs can be executed within the browser environment. Potential data exfiltration, session hijacking etc.",
      "attack_vector": "Crafting malicious PDF files with embedded JavaScripts.",
      "required_capabilities":"Ability to embed malicious JavaScript code into PDF files"
    },
     {
       "type":"Out-of-Bounds Read/Write",
        "details": "The application reads or writes data beyond the boundaries of an allocated object or buffer, which could be exploited to execute remote code, disclose information, or cause an application crash.",
      "impact":"Remote code execution or information disclosure via application crash.",
      "attack_vector":"Crafting a malicious PDF that triggers a read or write past the boundaries of an allocated object or buffer.",
      "required_capabilities":"Ability to create malicious PDF documents"
     },
    {
      "type": "Side-Loading",
      "details": "The application fails to validate the integrity of the updater when running the update service, which could allow an attacker to replace the update file with a malicious one.",
       "impact": "Running of malicious payloads.",
       "attack_vector": "Replacing the update file with a malicious one.",
        "required_capabilities": "Ability to replace or modify files during the update process"
    },
      {
      "type": "Null Pointer Dereference",
      "details": "The application uses a null pointer without proper validation. Attackers could exploit this to cause a denial of service by crashing the application. Occurs when scrolling certain PDF files with an abnormal *StructTreeRoot* dictionary entry, or when playing multimedia in certain PDF files",
       "impact": "Denial of Service via application crash.",
      "attack_vector": "Crafting a malicious PDF document with abnormal StructTreeRoot dictionary entry or with malformed multimedia content.",
      "required_capabilities":"Ability to create malicious PDF documents"
      },
      {
      "type": "Redaction Bypass",
      "details": "Partial redaction of information occurs when using the “Search and Redact” or “Smart Redact” feature with search text including multiple words with a space and a character larger than the search text within the same text object is present. All of these conditions must be met to replicate this issue",
      "impact":"Partial redaction of information potentially leading to unwanted exposure",
      "attack_vector":"Crafting PDF documents that meets specific criteria of search term and character size",
      "required_capabilities":"Ability to create specific PDF documents"
      },
        {
        "type":"Time-of-Check Time-of-Use (TOCTOU) Race Condition",
        "details":"The application fails to properly validate the certificate of the updater executable or fails to lock the permissions of the update file after certificate validation, which could be exploited to carry out privilege escalation attacks by replacing the update file with a malicious one.",
        "impact":"Privilege escalation attack by replacing the update file with a malicious one.",
        "attack_vector":"Replacing the update file during the update process.",
        "required_capabilities":"Ability to perform a man in the middle attack"
        },
        {
        "type": "Arbitrary Code Execution",
        "details": "The application could be exposed to Arbitrary Code Execution vulnerability when executing certain JavaScripts, which attackers could exploit to induce users to execute commands with malicious parameters.",
         "impact": "Arbitrary code execution on the user system",
         "attack_vector": "Executing JavaScript with malicious parameters",
        "required_capabilities": "Ability to craft malicious PDF documents with JavaScript payloads"
        },
       {
      "type": "Type Confusion",
      "details": "The application improperly handles the annotation object that contains a non-standard “DS” field in the annotation dictionary entry using a type that is incompatible with the intended type, or when opening certain PDF files that contain JavaScripts. This occurs due to the use of object that has been deleted or freed without proper validation. Attackers could exploit to execute arbitrary code.",
      "impact": "Remote code execution.",
       "attack_vector": "Creating malicious PDF files with specific annotation objects or javascript that trigger type confusion",
        "required_capabilities": "Ability to craft malicious PDF documents"
      },
         {
        "type":"Arbitrary File Creation",
        "details":"The application directly opens the executable files due to the failure to properly identify the file type that is disallowed to be opened when handling the *exportDataObject* method of the Doc object. This could be exploited by attackers to execute arbitrary code.",
        "impact":"Arbitrary Code Execution",
        "attack_vector":"Crafting PDF documents that use the *exportDataObject* method.",
        "required_capabilities":"Ability to craft malicious PDF documents."
      },
       {
        "type":"Arbitrary File Execution",
        "details":"The application could be exposed to Arbitrary File Execution vulnerability when opening certain PDF files that include the *OpenAction* method using the relative path with path spoofing techniques, which could be exploited by attackers to deceive users to execute commands to spread malicious code.",
        "impact":"Execution of arbitrary code",
        "attack_vector":"Crafting malicious PDF documents that include *OpenAction* method with relative path.",
         "required_capabilities": "Ability to craft malicious PDF documents."
       },
        {
        "type":"Side-Loading vulnerability",
         "details":"The application fails to validate the integrity of the updater when running the update service. Attackers could exploit to run malicious payloads by replacing the update file with a malicious one.",
          "impact":"Execution of malicious payloads.",
          "attack_vector":"Replacing the update file with a malicious one.",
         "required_capabilities": "Ability to place a malicious update file where the application will load from during update"
        },
        {
           "type":"Hidden Dangers Lurking",
            "details":"The security warning dialog box shows “OK” as the default selected option, which may cause users to habitually click “OK” without understanding the potential risks involved when opening certain PDFs that include the Launch File action.",
           "impact": "Users may be deceived into executing harmful commands by habitually clicking 'OK' without understanding risks",
           "attack_vector":"Crafting PDF documents with a malicious Launch File action.",
          "required_capabilities":"Ability to craft malicious PDF documents."
         },
       {
        "type":"Partial Redaction",
         "details":"The application does partial redaction if all conditions are met: Windows or Mac editor versions affected; “Search and Redact” or “Smart Redact” features used; search text with multiple words separated by spaces is used; and a larger character is present in the same text object. ",
         "impact": "Failure to completely redact sensitive information.",
          "attack_vector": "Crafting specific PDF documents that fulfills conditions needed to trigger the vulnerability",
           "required_capabilities":"Ability to craft specific PDF documents"
       },
      {
       "type":"Out-of-Bounds Read",
        "details":"The application fails to properly initialize the allocated pointer when parsing certain PDF files, which could be exploited by attackers to disclose information.",
        "impact":"Information disclosure",
        "attack_vector":"Parsing specially crafted PDF files",
         "required_capabilities": "Ability to create malicious PDF documents"
      },
        {
       "type": "Out-of-Bounds Write",
       "details": "The application writes data beyond the boundaries of an allocated object or buffer, leading to potential crashes or remote code execution. This can occur when parsing or handling certain objects or files such as U3D files, annotation objects, and when converting specific file types like BMP to PDF or when handling Doc objects, or when parsing certain PDF files",
        "impact": "Crash or remote code execution",
         "attack_vector": "Crafting malicious PDF files containing malformed or specific objects to trigger the out of bound write during parsing or conversion.",
        "required_capabilities": "Ability to create or modify PDF files."
       },
      {
      "type": "Side-Loading",
       "details":"The application fails to validate the integrity of the updater when running the update service.",
       "impact":"Execution of malicious payloads, by replacing the update file with a malicious one.",
        "attack_vector":"Replacing the update file with a malicious one.",
       "required_capabilities": "Ability to replace the update file during the update process"
      },
       {
         "type":"Local Privilege Escalation",
         "details":"The application is vulnerable to Local Privilege Escalation due to weak permissions on the folder in which the update service is executed, incorrect permission assignment on the resources used by the update service, improper signature validation and incomplete certificate check for the updater, weak randomness setting for the name of the temporary folder during a plugin installation, or improper DLL loading without using the built-in manifest file. This could be exploited by attackers to execute malicious DLL files, delete arbitrary files or execute arbitrary code in the context of SYSTEM.",
          "impact": "Privilege escalation to the level of SYSTEM",
          "attack_vector":"Exploiting weak permissions on the update service resources or the updater process.",
           "required_capabilities": "Ability to place malicious files/payloads or intercept/manipulate the update process on the target system"
        },
        {
           "type":"GDI Memory Overflow",
            "details":"Use-After-Free or Out-of-Bounds Write vulnerability when handling GDI (Graphics Device Interface) related resources. Attackers could exploit to execute arbitrary code. This occurs due to the GDI memory overflow as the application fails to properly handle the user inputs",
           "impact": "Remote code execution",
            "attack_vector": "Providing crafted user input during GDI related calls",
            "required_capabilities": "Ability to provide crafted input values"
        },
       {
          "type":"Arbitrary File Read",
          "details":"The application fails to properly validate the type of attachment when calling the methods (with file attachments specified) to create annotations which could be exploited by attackers to disclose files in the target system.",
           "impact": "Information disclosure of arbitrary files in the system.",
           "attack_vector":"Specifying file attachments to create annotations.",
           "required_capabilities": "Ability to craft PDF documents"
       },
       {
        "type":"Arbitrary File Deletion",
         "details":"The application fails to validate the file type and deletes the target file improperly without checking its existence in the user system when calling certain JavaScripts to export PDFs, which could be exploited by attackers to delete the private files in the current user context.",
          "impact":"Deletion of arbitrary files in the user's context.",
          "attack_vector":"Crafting malicious PDFs containing Javascripts that cause arbitrary file deletions during export.",
           "required_capabilities":"Ability to craft malicious PDF documents with specific Javascripts"
       },
         {
        "type":"Side-Loading",
          "details": "The application could be exposed to a Side-Loading vulnerability when performing an update, which attackers could exploit to run malicious payloads by replacing the update file with a malicious one. This occurs as the application fails to validate the integrity of the updater when running the update service.",
          "impact": "Remote code execution by malicious update file",
          "attack_vector": " Replacing a valid update file with a malicious one.",
          "required_capabilities":"Ability to place malicious files or intercept or control network traffic"
          },
       {
       "type": "Null Pointer Dereference",
       "details":"The application uses a null pointer without proper validation when parsing certain PDF files that contain the invalid Page object, or when handling the bookmarks or text annotations in certain PDFs. This could be exploited by attackers to cause a denial of service.",
        "impact": "Application crash and Denial of Service",
         "attack_vector": "Crafting PDF documents with invalid Page objects, bookmarks or text annotations.",
          "required_capabilities": "Ability to create malicious PDF documents"
       },
       {
        "type":"Type Confusion",
        "details":"The application improperly handles the annotation object that contains a non-standard “DS” field in the annotation dictionary entry using a type that is incompatible with the intended type.",
        "impact":"Remote code execution",
        "attack_vector":"Crafting malicious PDF documents that uses non-standard DS field",
         "required_capabilities": "Ability to create malicious PDF documents"
        },
      {
        "type":"Arbitrary File Execution",
        "details":"The application could be exposed to Arbitrary File Execution vulnerability when opening certain PDF files that include the Launch File action, which could be exploited by attackers to deceive users into executing harmful commands. The default selected option in security dialog box is 'OK'.",
         "impact": "Deception of users into executing harmful commands",
          "attack_vector":"Crafting PDF documents with a Launch File action.",
           "required_capabilities": "Ability to craft PDF documents with specific actions."
       }
  ]
}
```