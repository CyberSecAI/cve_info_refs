The content is related to CVE-2016-8643.

- **Root cause of vulnerability**: The vulnerability stems from a flaw in Moodle's web services. Specifically, the `update_users` web service did not properly enforce the restriction that non-admin users with the capability to edit other users should not be able to edit information about admin users. This restriction was enforced in the standard web interface but not consistently in the web service.

- **Weaknesses/vulnerabilities present**: The core vulnerability is a lack of consistent capability checking between the Moodle web interface and the `update_users` web service. This allowed non-admin site managers to bypass the usual access controls and potentially modify administrator user accounts using the web service.

- **Impact of exploitation**: A non-admin site manager could potentially modify admin user information. This could lead to privilege escalation or denial of service depending on the modifications made to the admin accounts.

- **Attack vectors**: The attack vector involves using the `update_users` web service. An attacker needs to have non-admin site manager privileges within the Moodle instance and be able to access the web services. The vulnerability is not exposed through the mobile app.

- **Required attacker capabilities/position**: The attacker needs to be a non-admin site manager within a Moodle instance. They also need to be able to access and interact with the Moodle web services.

- **Affected Versions**: 3.1 to 3.1.2, 3.0 to 3.0.6, 2.9 to 2.9.8, 2.8 to 2.8.12, 2.7 to 2.7.16 and earlier unsupported versions.
- **Fixed Versions**: 3.1.3, 3.0.7, 2.9.9 and 2.7.17