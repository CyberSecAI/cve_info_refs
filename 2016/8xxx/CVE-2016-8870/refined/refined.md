```
{
  "CVE-2016-8870": {
    "Description": "Inadequate checks allows for users to register on a site when registration has been disabled.",
    "Root cause": "The `register` method in the `UsersControllerUser` class did not check if user registrations were enabled, unlike the `register` method in the `UsersControllerRegistration` class. Also, the vulnerable `register` method in `UsersControllerUser`  did not properly validate the user input against the expected form fields. It only validated if the data was successfully processed.",
    "Weaknesses": [
      "Insufficient input validation",
      "Bypass of intended access controls"
    ],
    "Impact": "An unauthenticated attacker could create user accounts, even if user registration was disabled on the Joomla site. By adding a `user[groups][]` parameter, an attacker can assign the new user to any group, including the Administrators group, leading to privilege escalation and complete control of the website. Once admin access is gained, attackers can upload malicious files such as backdoors.",
    "Attack vectors": "HTTP POST requests to `/index.php` targeting the `user.register` task in the `com_users` component.",
    "Required attacker capabilities": "The attacker needs to be able to send crafted HTTP POST requests, and know/guess the correct parameter names.",
     "Additional Information": "The vulnerability allowed for arbitrary user creation and privilege escalation by bypassing the intended registration controller and directly accessing the vulnerable `register` method of the `UsersControllerUser`. This method did not perform adequate input validation and allowed extra parameters to be passed to the `JUser::bind` method, enabling attackers to set any property of the JUser object. The lack of input sanitization in the `register` method of `UsersControllerUser` is the key vulnerability. The fix was to remove the `register` method from the `UsersControllerUser` class so that all user registrations would have to go through the `UsersControllerRegistration` class which performed the required validation and access checks."
  }
}
```