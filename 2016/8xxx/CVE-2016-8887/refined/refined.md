```
{
  "guidelines": "1. First verify if the content relates to the CVE specified based on the official description\n2. If the content does not relate to this CVE, respond with \"UNRELATED\"\n3. If no useful vulnerability information is found, respond with \"NOINFO\" \n4. For relevant content, extract:\n   - Root cause of vulnerability\n   - Weaknesses/vulnerabilities present\n   - Impact of exploitation\n   - Attack vectors\n   - Required attacker capabilities/position\n\nAdditional instructions:\n- Preserve original technical details and descriptions\n- Remove unrelated content\n- Translate non-English content to English\n- Note if the content provides more detail than the official CVE description",
  "response": [
    {
      "content": "Message-Id: <20161023010529.DB3343AE00F@smtpvbsrv1.mitre.org>\nDate: Sat, 22 Oct 2016 21:05:29 -0400 (EDT)\nFrom: cve-assign@...re.org\nTo: ago@...too.org\nCc: cve-assign@...re.org, oss-security@...ts.openwall.com\nSubject: Re: jasper: NULL pointer dereference in jp2_colr_destroy (jp2_cod.c)\n\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA256\n\n> <https://blogs.gentoo.org/ago/2016/10/18/jasper-null-pointer-dereference-in-jp2_colr_destroy-jp2_cod-c>\n>\n> AddressSanitizer: SEGV on unknown address 0x000000000000\n> 0x7f8dcb5bc940 in jp2_colr_destroy ... jasper-1.900.5/src/libjasper/jp2/jp2_cod.c:443:3\n>\n> <https://github.com/mdadams/jasper/commit/e24bdc716c3327b067c551bc6cfb97fd2370358d>\n\nUse CVE-2016-8887.\n\n- --\nCVE Assignment Team\nM/S M300, 202 Burlington Road, Bedford, MA 01730 USA\n[ A PGP key is available for encrypted communications at\n  <http://cve.mitre.org/cve/request_id.html> ]\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAEBCAAGBQJYDAr/AAoJEHb/MwWLVhi24I8QAKtduMTN4eo5SAOfpBYIgLdr\n9K4Vlzy3AB73c1TA/d/ck8EiG8WeDeHdU4XgZqpG7ZcEl3Yg8Tu1OZI/eNNS4pFs\nz2+TDEzRP71cy7yuX+LwjWFzu5jYDVZl4UYjLS004k5jQ4xvwZ8iuUCP6OmU1lfe\nkyaHWsvX5+uGohyz+Wd71pK8/OJockZmsSRDqaFj0ZN2luYB4daOnkUURiQ+b3Km\n9m6KfDIDw+x2sS9Ts+YFCU0LY/7Em68hh7qabACjXQql1xuwaGoZsw+30HItKfLo\nh41JMuPrEf1LyhJBZrg0URp/+f+Nlq/n3aqwrxRm/iARWw3XsNqrCBPa5QhBCO6e\nlWAGB3S8VnfXeFxsirFCy3yacIF0/sUfc3sYNdqOVOKkDPI3vg6bmwgnVefoD3+J\n4UY3KZOrGp54Y6vTGGiFBb4JMqRy6TijxoGWUhqRBZH5w9p0mbrcK3bC9iCOYndk\nZCOeC1z+sfXYWSAdsqxInOJlT5WCVBK21qOfIbfcEfJIbaAWQbSZSTQ7OpIM/1K9\nIUuZqNWJNAEDXZi1BsxEr34lGFacIpXsCCiVBKBFrON7GKZPwikTrj13R8N1pCtJ\nFAFqIZflZDcpOoB80DgYgEZMhMV6QqaKkp6WgdwoTI1XXzrtPCFgfOU++JWmn9p+\noFzCFvJnQ9yyHGdSThSf\n=eoij\n-----END PGP SIGNATURE-----",
      "vulnerability": "The content assigns CVE-2016-8887 to a NULL pointer dereference in `jp2_colr_destroy` in `jp2_cod.c`.",
      "root_cause": "NULL pointer dereference in jp2_colr_destroy",
      "weaknesses": [
        "NULL pointer dereference"
      ],
      "impact": "Denial of service due to application crash",
        "attack_vectors": "Maliciously crafted JPEG-2000 image files",
        "required_capabilities": "Ability to provide a crafted image file to the vulnerable application"
    },
    {
      "content": "# USN-3693-1: JasPer vulnerabilities\n\n27 June 2018\n\nSeveral security issues were fixed in JasPer.\n\n### Reduce your security exposure\n\nUbuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.\n\n[Learn more about Ubuntu Pro](/pro)\n\n## Releases\n\n* [Ubuntu 16.04 ESM](/security/notices?release=xenial)\n* [Ubuntu 14.04 ESM](/security/notices?release=trusty)\n\n## Packages\n\n* [jasper](/security/cves?package=jasper) - Library for manipulating JPEG-2000 files\n\n## Details\n\nIt was discovered that JasPer incorrectly handled certain malformed\n\nJPEG-2000 image files. If a user or automated system using JasPer were\n\ntricked into opening a specially crafted image, an attacker could exploit\n\nthis to cause a denial of service or possibly execute code with the\n\nprivileges of the user invoking the program.\n\n### Reduce your security exposure\n\nUbuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.\n\n[Learn more about Ubuntu Pro](/pro)\n\n## Update instructions\n\nThe problem can be corrected by updating your system to the following package versions:\n\n##### Ubuntu 16.04\n\n* [libjasper1](https://launchpad.net/ubuntu/%2Bsource/jasper)\n  - [1.900.1-debian1-2.4ubuntu1.2](https://launchpad.net/ubuntu/%2Bsource/jasper/1.900.1-debian1-2.4ubuntu1.2)\n\n##### Ubuntu 14.04\n\n* [libjasper1](https://launchpad.net/ubuntu/%2Bsource/jasper)\n  - [1.900.1-14ubuntu3.5](https://launchpad.net/ubuntu/%2Bsource/jasper/1.900.1-14ubuntu3.5)\n\nIn general, a standard system update will make all the necessary changes.\n\n## References\n\n* [CVE-2015-5203](/security/CVE-2015-5203)\n* [CVE-2015-5221](/security/CVE-2015-5221)\n* [CVE-2016-10248](/security/CVE-2016-10248)\n* [CVE-2016-10250](/security/CVE-2016-10250)\n* [CVE-2016-8883](/security/CVE-2016-8883)\n* [CVE-2016-8887](/security/CVE-2016-8887)\n* [CVE-2016-9262](/security/CVE-2016-9262)\n* [CVE-2016-9387](/security/CVE-2016-9387)\n* [CVE-2016-9388](/security/CVE-2016-9388)\n* [CVE-2016-9389](/security/CVE-2016-9389)\n* [CVE-2016-9390](/security/CVE-2016-9390)\n* [CVE-2016-9391](/security/CVE-2016-9391)\n* [CVE-2016-9392](/security/CVE-2016-9392)\n* [CVE-2016-9393](/security/CVE-2016-9393)\n* [CVE-2016-9394](/security/CVE-2016-9394)\n* [CVE-2016-9396](/security/CVE-2016-9396)\n* [CVE-2016-9600](/security/CVE-2016-9600)\n* [CVE-2017-1000050](/security/CVE-2017-1000050)\n* [CVE-2017-6850](/security/CVE-2017-6850)\n\n### Join the discussion\n\n* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)\n* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)",
      "vulnerability": "The content describes multiple vulnerabilities fixed in JasPer, including CVE-2016-8887. It states that JasPer incorrectly handles malformed JPEG-2000 image files, potentially leading to denial of service or code execution.",
        "root_cause": "Incorrect handling of malformed JPEG-2000 image files",
        "weaknesses": [
            "Improper input validation"
        ],
        "impact": "Denial of service or arbitrary code execution",
        "attack_vectors": "Maliciously crafted JPEG-2000 image files",
        "required_capabilities": "Ability to provide a crafted image file to the vulnerable application"
    },
    {
      "content": "[**Bug 1388828**](show_bug.cgi?id=1388828)\n(CVE-2016-8887)\n- [CVE-2016-8887](https://access.redhat.com/security/cve/CVE-2016-8887) jasper: uninitialized pointer use in jp2\\_box\\_get()\n\n[Summary:](page.cgi?id=fields.html#short_desc \"The bug summary is a short sentence which succinctly describes what the bug is about.\")\nCVE-2016-8887 jasper: uninitialized pointer use in jp2\\_box\\_get()\n\n| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED NOTABUG | | [Alias:](page.cgi?id=fields.html#alias \"A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.\") | CVE-2016-8887 | | [Product:](describecomponents.cgi \"Bugs are categorised into Products and Components. Select a Classification to narrow down this list.\") | Security Response | | [Classification:](page.cgi?id=fields.html#classification \"Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.\") | Other | | [Component:](describecomponents.cgi?product=Security Response \"Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.\") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components \"The sub component of a specific component\") | --- | | [Version:](page.cgi?id=fields.html#version \"The version field defines the version of the software the bug was found in.\") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform \"The hardware platform the bug was observed on. Note: When searching, selecting the option \\\"All\\\" only finds bugs whose value for this field is literally the word \\\"All\\\".\") | All | | [OS:](page.cgi?id=fields.html#op_sys \"The operating system the bug was observed on. Note: When searching, selecting the option \\\"All\\\" only finds bugs whose value for this field is literally the word \\\"All\\\".\") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone \"The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.\") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to \"The person in charge of resolving the bug.\") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact \"The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.\") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact \"The person responsible for documenting once the bug has been resolved.\") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc \"Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.\") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard \"Each bug has a free-form single line text entry box for adding tags and status information.\") |  | | Duplicates (1): | [CVE-2016-10250](show_bug.cgi?id=1388829 \"CLOSED DUPLICATE - CVE-2016-10250 jasper: Null pointer dereference in jp2_colr_destroy (incomplete fix for CVE-2016-8887)\")  ([view as bug list](buglist.cgi?bug_id=1388829)) | | [Depends On:](page.cgi?id=fields.html#dependson \"The bugs listed here must be resolved before this bug can be resolved.\") | [1388873](show_bug.cgi?id=1388873 \"CLOSED ERRATA - CVE-2016-10250 CVE-2016-8880 CVE-2016-8881 CVE-2016-8882 CVE-2016-8883 CVE-2016-8886 CVE-2016-8887 jasper: various flaws [fedora-all]\") [1388874](show_bug.cgi?id=1388874 \"CLOSED RAWHIDE - CVE-2016-10250 CVE-2016-8880 CVE-2016-8881 CVE-2016-8882 CVE-2016-8883 CVE-2016-8886 CVE-2016-8887 mingw-jasper: various flaws [fedora-all]\") [1388875](show_bug.cgi?id=1388875 \"CLOSED EOL - CVE-2016-10250 CVE-2016-8880 CVE-2016-8881 CVE-2016-8882 CVE-2016-8883 CVE-2016-8886 CVE-2016-8887 jasper: various flaws [epel-5]\") [1388876](show_bug.cgi?id=1388876 \"CLOSED ERRATA - CVE-2016-10250 CVE-2016-8880 CVE-2016-8881 CVE-2016-8882 CVE-2016-8883 CVE-2016-8886 CVE-2016-8887 mingw-jasper: various flaws [epel-7]\") | | [Blocks:](page.cgi?id=fields.html#blocked \"This bug must be resolved before the bugs listed in this field can be resolved.\") | [1314477](show_bug.cgi?id=1314477) | | TreeView+ | [depends on](buglist.cgi?bug_id=1388828&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1388828&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-10-26 09:21 UTC by Adam Mariš | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 13:58 UTC ([History](show_activity.cgi?id=1388828)) |\n\n| [Description](show_bug.cgi?id=1388828#c0)  Adam Mariš    2016-10-26 09:21:17 UTC  ``` Null pointer dereference vulnerability in jp2_colr_destroy in jp2_cod.c was found.  Upstream patch:  <https://github.com/mdadams/jasper/commit/e24bdc716c3327b067c551bc6cfb97fd2370358d>  CVE assignment:  <http://seclists.org/oss-sec/2016/q4/215>   ```  [Comment 3](show_bug.cgi?id=1388828#c3)  Tomas Hoger    2016-12-12 13:25:13 UTC  ``` This isn't actually a NULL pointer dereference issue, but rather a use of uninitialized pointer.  In the jp2_box_get() function, a variable box of type jp2_box_t is allocated using jas_malloc().  Data parsed from a read file is stored in the structure.  However, if certain errors occur while parsing, the structure is destroyed using jp2_box_destroy() before it was fully initialized.  jp2_box_destroy() calls box type specific destroy functions, such as jp2_colr_destroy() mentioned in the original report, which contains a code as this:  static void jp2_colr_destroy(jp2_box_t *box) {     jp2_colr_t *colr = &box->data.colr;     if (colr->iccp) {         jas_free(colr->iccp);     } }  As colr->iccp has not been initialized yet, this leads to an attempt to free invalid pointer.  It seems attacker may be able to trigger freeing of the attacker controlled pointer, which may lead to use after free.  Therefore, impact of this problem does not seem limited to application crash.  This problem did not affect jasper packages in Red Hat Enterprise Linux 6 and 7, as they include the following change as part of the patch for CVE-2008-3520:  +++ jasper-1.900.1/src/libjasper/jp2/jp2_cod.c @@ -247,7 +247,7 @@ jp2_box_t *jp2_box_get(jas_stream_t *in)  	box = 0;  	tmpstream = 0;   -	if (!(box = jas_malloc(sizeof(jp2_box_t)))) { +	if (!(box = jas_calloc(1, sizeof(jp2_box_t)))) {  		goto error;  As jas_calloc() is used to allocate memory instead of jas_malloc(), uninitialized fields of the box are guaranteed to be 0 / NULL, avoiding problematic jas_free() calls in jp2_*_destroy() functions.   ```  [Comment 4](show_bug.cgi?id=1388828#c4)  Tomas Hoger    2016-12-12 13:31:55 UTC  ``` Original reporter's advisory:  <https://blogs.gentoo.org/ago/2016/10/18/jasper-null-pointer-dereference-in-jp2_colr_destroy-jp2_cod-c/>\n  Relevant info from the advisory:\n  jasper: NULL pointer dereference in jp2_colr_destroy (jp2_cod.c)\n\n  Another round of fuzzing on an updated version (1.900.5) revealed a NULL pointer access in jp2_colr_destroy\n\nThe complete ASan output:\n# imginfo -f $FILE\ncannot copy box data\nASAN:DEADLYSIGNAL\n=================================================================\n==19664==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000041defd bp 0xbebebebebebebebe sp 0x7ffc50768570 T0)\n    #0 0x41defc in atomic_compare_exchange_strong /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_atomic_clang.h:81\n    #1 0x41defc in __asan::Allocator::AtomicallySetQuarantineFlag(__asan::AsanChunk*, void*, __sanitizer::BufferedStackTrace*) /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_allocator.cc:465\n    #2 0x41defc in __asan::Allocator::Deallocate(void*, unsigned long, __sanitizer::BufferedStackTrace*, __asan::AllocType) /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_allocator.cc:525\n    #3 0x41defc in __asan::asan_free(void*, __sanitizer::BufferedStackTrace*, __asan::AllocType) /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_allocator.cc:709\n    #4 0x4c008c in free /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:41\n    #5 0x7f8dcb5bc940 in jp2_colr_destroy /tmp/portage/media-libs/jasper-1.900.5/work/jasper-1.900.5/src/libjasper/jp2/jp2_cod.c:443:3\n    #6 0x7f8dcb5c1f69 in jp2_box_destroy /tmp/portage/media-libs/jasper-1.900.5/work/jasper-1.900.5/src/libjasper/jp2/jp2_cod.c:211:3\n    #7 0x7f8dcb5c1f69 in jp2_box_get /tmp/portage/media-libs/jasper-1.900.5/work/jasper-1.900.5/src/libjasper/jp2/jp2_cod.c:307\n    #8 0x7f8dcb5c5dc0 in jp2_decode /tmp/portage/media-libs/jasper-1.900.5/work/jasper-1.900.5/src/libjasper/jp2/jp2_dec.c:156:16\n    #9 0x7f8dcb556f39 in jas_image_decode /tmp/portage/media-libs/jasper-1.900.5/work/jasper-1.900.5/src/libjasper/base/jas_image.c:380:16\n    #10 0x4f1686 in main /tmp/portage/media-libs/jasper-1.900.5/work/jasper-1.900.5/src/appl/imginfo.c:188:16\n    #11 0x7f8dca66561f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.22-r4/work/glibc-2.22/csu/libc-start.c:289\n    #12 0x418e68 in _init (/usr/bin/imginfo+0x418e68)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_atomic_clang.h:81 in atomic_compare_exchange_strong\n==19664==ABORTING\n\n  Upstream bug report:\n  <https://github.com/mdadams/jasper/issues/34>\n\nThe following fix was applied in version 1.900.10:\n <https://github.com/mdadams/jasper/commit/e24bdc716c3327b067c551bc6cfb97fd2370358d>\n   However, the above fix was found to be incomplete.  There is this follow-up advisory from the original reporter:  <https://blogs.gentoo.org/ago/2016/10/23/jasper-null-pointer-dereference-in-jp2_colr_destroy-jp2_cod-c-incomplete-fix-for-cve-2016-8887/>\n  Relevant info from the advisory:\n  jasper: NULL pointer dereference in jp2_colr_destroy (jp2_cod.c) (incomplete fix for [CVE-2016-8887](https://access.redhat.com/security/cve/CVE-2016-8887))\n\n  Another round of fuzzing on an updated version (1.900.10) revealed that the NULL pointer access identified as [CVE-2016-8887](https://access.redhat.com/security/cve/CVE-2016-8887) which upstream declared to be fixed in the version 1.900.10 is still here.\n\nThe complete ASan output:\n# imginfo -f $FILE\nASAN:DEADLYSIGNAL\n=================================================================\n==20885==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000000 (pc 0x00000041defd bp 0xbebebebebebebebe sp 0x7ffc4e4a4550 T0)\n    #0 0x41defc in atomic_compare_exchange_strong /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_atomic_clang.h:81\n    #1 0x41defc in __asan::Allocator::AtomicallySetQuarantineFlag(__asan::AsanChunk*, void*, __sanitizer::BufferedStackTrace*) /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_allocator.cc:465\n    #2 0x41defc in __asan::Allocator::Deallocate(void*, unsigned long, __sanitizer::BufferedStackTrace*, __asan::AllocType) /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_allocator.cc:525\n    #3 0x41defc in __asan::asan_free(void*, __sanitizer::BufferedStackTrace*, __asan::AllocType) /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_allocator.cc:709\n    #4 0x4c008c in free /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/asan_malloc_linux.cc:41\n    #5 0x7faeeeb2d430 in jp2_colr_destroy /tmp/portage/media-libs/jasper-1.900.10/work/jasper-1.900.10/src/libjasper/jp2/jp2_cod.c:450:3\n    #6 0x7faeeeb32b0e in jp2_box_destroy /tmp/portage/media-libs/jasper-1.900.10/work/jasper-1.900.10/src/libjasper/jp2/jp2_cod.c:211:3\n    #7 0x7faeeeb32b0e in jp2_box_get /tmp/portage/media-libs/jasper-1.900.10/work/jasper-1.900.10/src/libjasper/jp2/jp2_cod.c:314\n    #8 0x7faeeeb369a0 in jp2_decode /tmp/portage/media-libs/jasper-1.900.10/work/jasper-1.900.10/src/libjasper/jp2/jp2_dec.c:156:16\n    #9 0x7faeeeac6a29 in jas_image_decode /tmp/portage/media-libs/jasper-1.900.10/work/jasper-1.900.10/src/libjasper/base/jas_image.c:392:16\n    #10 0x4f1686 in main /tmp/portage/media-libs/jasper-1.900.10/work/jasper-1.900.10/src/appl/imginfo.c:188:16\n    #11 0x7faeedbd361f in __libc_start_main /var/tmp/portage/sys-libs/glibc-2.22-r4/work/glibc-2.22/csu/libc-start.c:289\n    #12 0x418e68 in _init (/usr/bin/imginfo+0x418e68)\n\nAddressSanitizer can not provide additional info.\nSUMMARY: AddressSanitizer: SEGV /var/tmp/portage/sys-devel/llvm-3.8.1-r2/work/llvm-3.8.1.src/projects/compiler-rt/lib/asan/../sanitizer_common/sanitizer_atomic_clang.h:81 in atomic_compare_exchange_strong\n==20885==ABORTING\n\n Upstream bug report:\n  <https://github.com/mdadams/jasper/issues/45>\n  Upstream fix applied in version 1.900.13:\n  <https://github.com/mdadams/jasper/commit/bdfe95a6e81ffb4b2fad