=== Content from xenbits.xen.org_49430e3c_20250125_102610.html ===

# Information

| Advisory | [XSA-167](advisory-167.html) |
| --- | --- |
| Public release | 2016-01-20 12:00 |
| Updated | 2016-01-20 12:08 |
| Version | 4 |
| CVE(s) | [CVE-2016-1570](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1570) |
| Title | PV superpage functionality missing sanity checks |

# Files

<advisory-167.txt> (signed advisory file)

<xsa167.patch>

<xsa167-4.4.patch>

<xsa167-4.6.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

            Xen Security Advisory CVE-2016-1570 / XSA-167
                              version 4

            PV superpage functionality missing sanity checks

UPDATES IN VERSION 4
====================

Public release.

ISSUE DESCRIPTION
=================

The PV superpage functionality lacks certain validity checks on data
being passed to the hypervisor by guests.  This is the case for the
page identifier (MFN) passed to MMUEXT_MARK_SUPER and
MMUEXT_UNMARK_SUPER sub-ops of the HYPERVISOR_mmuext_op hypercall as
well as for various forms of page table updates.

IMPACT
======

Use of the feature, which is disabled by default, may have unknown
effects, ranging from information leaks through Denial of Service to
privilege escalation.

VULNERABLE SYSTEMS
==================

Only systems which enable the PV superpage feature are affected.  That
is, only systems with an `allowsuperpage' setting on the hypervisor
command line.  Note that in Xen 4.0.x and 3.4.x the option is named
`allowhugepage'.

Xen versions 3.4.0, 3.4.1, and from 4.1 onwards are affected.

Only x86 systems are affected.

Only PV guests can exploit the vulnerability.

MITIGATION
==========

Running only HVM guests will avoid this issue.

Not enabling PV superpage support (by omitting the `allowsuperpage' or
`allowhugepage' hypervisor command line options) will avoid exposing
the issue.

CREDITS
=======

This issue was discovered by Qinghao Tang of 360 Marvel Team.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa167.patch           xen-unstable
xsa167-4.6.patch       Xen 4.6.x, 4.5.x
xsa167-4.4.patch       Xen 4.4.x, 4.3.x

$ sha256sum xsa167*
[a71f709eef59425cb2113fa48d3b44048c6bf41063200fee1c847f6e0ed45a09  xsa167.patch](xsa167.patch)
[194c1ce89292f4cbb9980baa703095bcbeb5849abf46d193e07a98a0d8301f78  xsa167-4.4.patch](xsa167-4.4.patch)
[2bd786cccfd13c6732d6db8afc9e18058465efcb1bc93f894c359e3a820d5403  xsa167-4.6.patch](xsa167-4.6.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

However deployment of the SUPERPAGE DISABLEMENT MITIGATION is NOT
permitted (except where all the affected systems and VMs are
administered and used only by organisations which are members of the
Xen Project Security Issues Predisclosure List).  Specifically,
deployment on public cloud systems is NOT permitted.

This is because disabling PV superpage support is visible to guests, so
such deployment could lead to the rediscovery of the vulnerability.

Deployment of the mitigation is permitted only AFTER the embargo ends.

Also: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1.4.12 (GNU/Linux)

iQEcBAEBAgAGBQJWn3jEAAoJEIP+FMlX6CvZTOsH/2ReFJ0Yhp5da69XKvFEJR/s
0yEFxjvqiSyBPsWjyiaAdOp/1A2sltEeDDnMy7xEoXHmon0p6IV0IR4L+fMCLjl2
1ZI4tKpkn3zUE+IOjfu/GJ53f87XWSq/u9Ri7yZQdxFpgd3AXcLegGm8i4L/58iY
vdwAAuczACztEN/NbWFedlGUEd5PKqKwb4wOg1uhLIMwzvjxgtejVAyZD83HgP6i
LeWMO7EfeU8ND38Otiw9lNlKD/Ia7vpRG+BXuADLx18hbR1TU9AJ0RO1zb9JnAAj
snYdgB6s1wzRD4/HOc+s1uaIttPPODs0IhZunylI7UVhdWKp5Qkszw/QUcmufnk=
=5acB
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team


=== Content from www.debian.org_b5c9b0e8_20250125_102610.html ===


---

[[Date Prev](msg00092.html)][[Date Next](msg00094.html)]
[[Thread Prev](msg00092.html)][[Thread Next](msg00094.html)]
[[Date Index](maillist.html#00093)]
[[Thread Index](threads.html#00093)]

# [SECURITY] [DSA 3519-1] xen security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3519-1] xen security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Thu, 17 Mar 2016 22:52:03 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20160317215203.GA7650%40pisco.westfalen.local)Â [20160317215203.GA7650@pisco.westfalen.local](msg00093.html)>
* *Reply-to*: debian-security@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3519-1                   security@debian.org
<https://www.debian.org/security/>                       Moritz Muehlenhoff
March 17, 2016                        <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : xen
CVE ID         : CVE-2015-8339 CVE-2015-8340 CVE-2015-8341 CVE-2015-8550
                 CVE-2015-8555 CVE-2016-1570 CVE-2016-1571 CVE-2016-2270
                 CVE-2016-2271

Multiple security issues have been found in the Xen virtualisation
solution, which may result in denial of service or information disclosure.

The oldstable distribution (wheezy) will be updated in a separate DSA.

For the stable distribution (jessie), these problems have been fixed in
version 4.4.1-9+deb8u4.

For the unstable distribution (sid), these problems will be fixed soon.

We recommend that you upgrade your xen packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iQIcBAEBCAAGBQJW6ya7AAoJEBDCk7bDfE427J8P/2cgj7Yd7mngUPduPnDvwWwp
onFLAj90elaoRYBrLqigZTTDd3f8peGDFddc7iDKEKLmlVFPsWiYJ/QGRJPT5GE1
x8e41qIZpg9Il1tV09x8r98iTsKnNSaSbGN5iYP8nOGyHo79EIM0Uh/1T0/AZOYQ
Ka02G7PO9ARu9gCebzaqrtPjCGv72FoK5nFG0115kZ1yTbB5qsF2v4xhThgJenN0
CBQboqpdL5Cw7NgekdkEenri95UoZDQOVp/PQNMTmLZsqUyeMZG5VjTRkItIYoc0
06WEH6mu4I25fCXuxhDLiWePHXQzoRavlBw0G9pdPMOnG7Xkz8tXVZTEllNtVf8d
IrMgcHjmPSgIETrz98VPIZ933GLHlFlD+DUAo8p86nER9Shm4vpLoGpe9Ejc5iwa
Dp8pIgLnXTRsS3ZBlggpgXE5yA41BwZEUYNfp8vBJsPpH9JG/ks4e2PDVU165mGp
gsoWadqSaOsIU7CtdxnMi28lt/nSwFSDyztcAqKMcS9EeW1gvvUXsHU4gMjF9O6b
Kd3MJXAkK7RQZpYXMV22VAUWYAK7RTR4SAx1/ReH3o4/6hze+45n3o4cAfun7PIj
UBeoUdmja4xuX7Mk0dOg6ZAtNQG3a/tqQhMMOQDD99VjKd/Pyi03fQ4yqfTueuU9
oo1gR80qcjdDqAJdm6rn
=mfoX
-----END PGP SIGNATURE-----

```

---


