### CVE-2016-1567

**Root cause of vulnerability:**
The vulnerability arises from a missing check in the NTP daemon (ntpd) where it does not verify if the key used to authenticate a packet matches the key configured for the peer association. Instead, ntpd only checks if the key is a trusted key.

**Weaknesses/vulnerabilities present:**
- **Symmetric Key Impersonation:** Any authenticated peer can impersonate any other authenticated peer by using any trusted key for authentication, not just the one specifically configured for that peer.
- **Weak Digest Algorithm Abuse:** If any of the trusted keys uses a weak digest algorithm (like MD5), an attacker can exploit that even if stronger keys are configured.

**Impact of exploitation:**
- **Time Spoofing:** An attacker can manipulate the time on client systems by spoofing server packets.
- **Man-in-the-middle Attack:** Attackers can intercept and modify network packets between NTP clients and servers, causing time synchronization issues.
- **Clock Manipulation:** Attackers can cause clients to step their clocks to arbitrary times.
- **Denial of Service:** By repeatedly spoofing packets, attackers could disrupt time synchronization services.

**Attack vectors:**
- **Man-in-the-Middle:** By intercepting and modifying network traffic between an NTP client and server
- **Compromised peer:** A compromised client/peer in the network can be used to launch the impersonation attack

**Required attacker capabilities/position:**
- **Network Access:** The attacker must be able to intercept or inject network packets between a client and server
- **Knowledge of Trusted Key:** The attacker needs to know at least one valid key from the trusted key list on the target system.
- **Ability to Compute MAC:** The attacker needs the ability to compute the Message Authentication Code using the chosen key.