=== Content from www.openwall.com_310ef9ac_20250124_121413.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[thread-next>]](../../../2016/01/07/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <1452088437.1365.2@smtp.gmail.com>
Date: Wed, 06 Jan 2016 14:53:57 +0100
From: Guillaume Ayoub <guillaume.ayoub@...ea.fr>
To: oss-security@...ts.openwall.com
Subject: Re: CVE request for radicale

(Sorry if this mail is not in the original thread, I wasn't following
the mailing-list before today)

Hi,

I'm the main developer of Radicale, I've merged the different fixes,
but I'm not the author of these fixes. So, I know the software quite
well, but I'm definitely no security expert.

That being said, here are for me the 3 real independent vulnerabilities
reported and fixed in 1.1:

1. "The multifilesystem backend allows access to arbitrary files on all
platforms."

This storage backend is not the default backend used, it's even marked
as "not ready for production" in the configuration file. But when used,
this backend could allow anybody to read/write anything anywhere, by
sending requests with particular paths and contents.

2. "Prevent regex injection in rights management."

If an attacker is able to authenticate with a user name like .*, he can
bypass read/write limitations imposed by regex-based rules, including
the built-in rules called owner_write (read for everybody, write for
the owner of the calendar) and owner_only (read and write for the owner
of the calendr).

3. "On MS Windows the filesystem backend allows access to the first
level of files on a drive."

The filesystem backend is the default storage backend. When used, it
converts paths like /c:/filename/dummy to c:\filename, and allowing
anybody to read/write anything anywhere, by sending requests with
particular paths and contents.

For me, the other ones are theoretical vulnerabilities, but I'm not
sure that they can lead to real life consequences:

- "Paths like .., ../.. or // are not sanitized correctly". But when
translated into a filesystem path, I think that it could only enable to
read/write files in the default storage directory, like "normal"
requests do.

- "The program crashes if a path doesn't start with base_prefix instead
of showing an error message." It was actually raising an exception, but
didn't "crash". That's bad for sure, but not related to security.

- "Improve the regex used for well-known URIs." It wasn't really
harmful because of Radicale's code at this moment, but may have become
a problem later.

- "Decouple the daemon from its parent environment." Always a good
idea, but I can't find a related possible attack.

- "Avoid race condition in PID file creation." No possible attack for
me.

- "Prevent crafted HTTP request from calling arbitrary functions". In
real life, no way to attack because of the signature of the other
methods, but may have enabled an attacker to call a method called "a"
by sending an HTTP "a" request, if "a" had had the good signature.

Hope that it helps!

Regards,
--
Guillaume Ayoub
Kozea - Directeur associé

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_042ba36c_20250124_121415.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUnrud%2FRadicale%2Fcommit%2Fb4b3d51f33c7623d312f289252dd7bbb8f58bbe6)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUnrud%2FRadicale%2Fcommit%2Fb4b3d51f33c7623d312f289252dd7bbb8f58bbe6)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=Unrud%2FRadicale)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Unrud](/Unrud)
/
**[Radicale](/Unrud/Radicale)**
Public

forked from [Kozea/Radicale](/Kozea/Radicale)

* [Notifications](/login?return_to=%2FUnrud%2FRadicale) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2FUnrud%2FRadicale)
* [Star
   5](/login?return_to=%2FUnrud%2FRadicale)

* [Code](/Unrud/Radicale)
* [Pull requests
  0](/Unrud/Radicale/pulls)
* [Projects
  0](/Unrud/Radicale/projects)
* [Security](/Unrud/Radicale/security)
* [Insights](/Unrud/Radicale/pulse)

Additional navigation options

* [Code](/Unrud/Radicale)
* [Pull requests](/Unrud/Radicale/pulls)
* [Projects](/Unrud/Radicale/projects)
* [Security](/Unrud/Radicale/security)
* [Insights](/Unrud/Radicale/pulse)

## Commit

[Permalink](/Unrud/Radicale/commit/b4b3d51f33c7623d312f289252dd7bbb8f58bbe6)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Convert paths safely to file system paths

[Browse files](/Unrud/Radicale/tree/b4b3d51f33c7623d312f289252dd7bbb8f58bbe6)
Browse the repository at this point in the history

```
With the old implementation on Windows a path like
"/c:/file/ignore" got converted to "c:\file" and
allowed access to files outside of FOLDER
```

* Loading branch information

Unrud
committed
Dec 24, 2015

1 parent
[6b7e79a](/Unrud/Radicale/commit/6b7e79a368be86d266c51cf50915324490a1b728)

commit b4b3d51

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**77 additions**
and
**33 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* radicale

  + radicale/pathutils.py
    [pathutils.py](#diff-fed0a2e80b5c0e415229be489e393f4836e69fb840e55ff8699ad43fa20e2a62)
  + storage

    - radicale/storage/filesystem.py
      [filesystem.py](#diff-73b06bb9ddf6dfaeefe4904978eff2c909d0c51fae92dd00833ad8e2732456c4)
    - radicale/storage/multifilesystem.py
      [multifilesystem.py](#diff-b356c4078af03b09dad3b2d1a876cd13d9ce8eba30cc7fd7acdc42d8d67b07b0)

## There are no files selected for viewing

37 changes: 36 additions & 1 deletion

37
[radicale/pathutils.py](#diff-fed0a2e80b5c0e415229be489e393f4836e69fb840e55ff8699ad43fa20e2a62 "radicale/pathutils.py")

Show comments

[View file](/Unrud/Radicale/blob/b4b3d51f33c7623d312f289252dd7bbb8f58bbe6/radicale/pathutils.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -20,8 +20,11 @@ |
|  |  |  |
|  |  | """ |
|  |  |  |
|  |  | import os |
|  |  | import posixpath |
|  |  |  |
|  |  | from . import log |
|  |  |  |
|  |  |  |
|  |  | def sanitize\_path(path): |
|  |  | """Make absolute (with leading slash) to prevent access to other data. |
| Expand All | | @@ -34,4 +37,36 @@ def sanitize\_path(path): |
|  |  | continue |
|  |  | new\_path = posixpath.join(new\_path, part) |
|  |  | trailing\_slash = "" if new\_path.endswith("/") else trailing\_slash |
|  |  | return new\_path + trailing\_slash |
|  |  | return new\_path + trailing\_slash |
|  |  |  |
|  |  |  |
|  |  | def is\_safe\_filesystem\_path\_component(path): |
|  |  | """Checks if path is a single component of a local filesystem path |
|  |  | and is safe to join""" |
|  |  | if not path: |
|  |  | return False |
|  |  | drive, \_ = os.path.splitdrive(path) |
|  |  | if drive: |
|  |  | return False |
|  |  | head, \_ = os.path.split(path) |
|  |  | if head: |
|  |  | return False |
|  |  | if path in (os.curdir, os.pardir): |
|  |  | return False |
|  |  | return True |
|  |  |  |
|  |  |  |
|  |  | def path\_to\_filesystem(path, base\_folder): |
|  |  | """Converts path to a local filesystem path relative to base\_folder |
|  |  | in a secure manner or raises ValueError.""" |
|  |  | sane\_path = sanitize\_path(path).strip("/") |
|  |  | safe\_path = base\_folder |
|  |  | if not sane\_path: |
|  |  | return safe\_path |
|  |  | for part in sane\_path.split("/"): |
|  |  | if not is\_safe\_filesystem\_path\_component(part): |
|  |  | log.LOGGER.debug("Can't translate path safely to filesystem: %s", |
|  |  | path) |
|  |  | raise ValueError("Unsafe path") |
|  |  | safe\_path = os.path.join(safe\_path, part) |
|  |  | return safe\_path |

35 changes: 19 additions & 16 deletions

35
[radicale/storage/filesystem.py](#diff-73b06bb9ddf6dfaeefe4904978eff2c909d0c51fae92dd00833ad8e2732456c4 "radicale/storage/filesystem.py")

Show comments

[View file](/Unrud/Radicale/blob/b4b3d51f33c7623d312f289252dd7bbb8f58bbe6/radicale/storage/filesystem.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -28,7 +28,8 @@ |
|  |  | import time |
|  |  | import sys |
|  |  | from contextlib import contextmanager |
|  |  | from .. import config, ical |
|  |  |  |
|  |  | from .. import config, ical, pathutils |
|  |  |  |
|  |  |  |
|  |  | FOLDER = os.path.expanduser(config.get("storage", "filesystem\_folder")) |
| Expand Down  Expand Up | | @@ -63,59 +64,61 @@ def open(path, mode="r"): |
|  |  | class Collection(ical.Collection): |
|  |  | """Collection stored in a flat ical file.""" |
|  |  | @property |
|  |  | def \_path(self): |
|  |  | def \_filesystem\_path(self): |
|  |  | """Absolute path of the file at local ``path``.""" |
|  |  | return os.path.join(FOLDER, self.path.replace("/", os.sep)) |
|  |  | return pathutils.path\_to\_filesystem(self.path, FOLDER) |
|  |  |  |
|  |  | @property |
|  |  | def \_props\_path(self): |
|  |  | """Absolute path of the file storing the collection properties.""" |
|  |  | return self.\_path + ".props" |
|  |  | return self.\_filesystem\_path + ".props" |
|  |  |  |
|  |  | def \_create\_dirs(self): |
|  |  | """Create folder storing the collection if absent.""" |
|  |  | if not os.path.exists(os.path.dirname(self.\_path)): |
|  |  | os.makedirs(os.path.dirname(self.\_path)) |
|  |  | if not os.path.exists(os.path.dirname(self.\_filesystem\_path)): |
|  |  | os.makedirs(os.path.dirname(self.\_filesystem\_path)) |
|  |  |  |
|  |  | def save(self, text): |
|  |  | self.\_create\_dirs() |
|  |  | with open(self.\_path, "w") as fd: |
|  |  | with open(self.\_filesystem\_path, "w") as fd: |
|  |  | fd.write(text) |
|  |  |  |
|  |  | def delete(self): |
|  |  | os.remove(self.\_path) |
|  |  | os.remove(self.\_filesystem\_path) |
|  |  | os.remove(self.\_props\_path) |
|  |  |  |
|  |  | @property |
|  |  | def text(self): |
|  |  | try: |
|  |  | with open(self.\_path) as fd: |
|  |  | with open(self.\_filesystem\_path) as fd: |
|  |  | return fd.read() |
|  |  | except IOError: |
|  |  | return "" |
|  |  |  |
|  |  | @classmethod |
|  |  | def children(cls, path): |
|  |  | abs\_path = os.path.join(FOLDER, path.replace("/", os.sep)) |
|  |  | \_, directories, files = next(os.walk(abs\_path)) |
|  |  | filesystem\_path = pathutils.path\_to\_filesystem(path, FOLDER) |
|  |  | \_, directories, files = next(os.walk(filesystem\_path)) |
|  |  | for filename in directories + files: |
|  |  | rel\_filename = posixpath.join(path, filename) |
|  |  | if cls.is\_node(rel\_filename) or cls.is\_leaf(rel\_filename): |
|  |  | yield cls(rel\_filename) |
|  |  |  |
|  |  | @classmethod |
|  |  | def is\_node(cls, path): |
|  |  | abs\_path = os.path.join(FOLDER, path.replace("/", os.sep)) |
|  |  | return os.path.isdir(abs\_path) |
|  |  | filesystem\_path = pathutils.path\_to\_filesystem(path, FOLDER) |
|  |  | return os.path.isdir(filesystem\_path) |
|  |  |  |
|  |  | @classmethod |
|  |  | def is\_leaf(cls, path): |
|  |  | abs\_path = os.path.join(FOLDER, path.replace("/", os.sep)) |
|  |  | return os.path.isfile(abs\_path) and not abs\_path.endswith(".props") |
|  |  | filesystem\_path = pathutils.path\_to\_filesystem(path, FOLDER) |
|  |  | return (os.path.isfile(filesystem\_path) and not |
|  |  | filesystem\_path.endswith(".props")) |
|  |  |  |
|  |  | @property |
|  |  | def last\_modified(self): |
|  |  | modification\_time = time.gmtime(os.path.getmtime(self.\_path)) |
|  |  | modification\_time = \ |
|  |  | time.gmtime(os.path.getmtime(self.\_filesystem\_path)) |
|  |  | return time.strftime("%a, %d %b %Y %H:%M:%S +0000", modification\_time) |
|  |  |  |
|  |  | @property |
| Expand Down | |  |

38 changes: 22 additions & 16 deletions

38
[radicale/storage/multifilesystem.py](#diff-b356c4078af03b09dad3b2d1a876cd13d9ce8eba30cc7fd7acdc42d8d67b07b0 "radicale/storage/multifilesystem.py")

Show comments

[View file](/Unrud/Radicale/blob/b4b3d51f33c7623d312f289252dd7bbb8f58bbe6/radicale/storage/multifilesystem.py)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,13 +30,14 @@ |
|  |  | from . import filesystem |
|  |  | from .. import ical |
|  |  | from .. import log |
|  |  | from .. import pathutils |
|  |  |  |
|  |  |  |
|  |  | class Collection(filesystem.Collection): |
|  |  | """Collection stored in several files per calendar.""" |
|  |  | def \_create\_dirs(self): |
|  |  | if not os.path.exists(self.\_path): |
|  |  | os.makedirs(self.\_path) |
|  |  | if not os.path.exists(self.\_filesystem\_path): |
|  |  | os.makedirs(self.\_filesystem\_path) |
|  |  |  |
|  |  | @property |
|  |  | def headers(self): |
| Expand All | | @@ -52,32 +53,33 @@ def write(self): |
|  |  | name = ( |
|  |  | component.name if sys.version\_info[0] >= 3 else |
|  |  | component.name.encode(filesystem.FILESYSTEM\_ENCODING)) |
|  |  | path = os.path.join(self.\_path, name) |
|  |  | with filesystem.open(path, "w") as fd: |
|  |  | filesystem\_path = os.path.join(self.\_filesystem\_path, name) |
|  |  | with filesystem.open(filesystem\_path, "w") as fd: |
|  |  | fd.write(text) |
|  |  |  |
|  |  | def delete(self): |
|  |  | shutil.rmtree(self.\_path) |
|  |  | shutil.rmtree(self.\_filesystem\_path) |
|  |  | os.remove(self.\_props\_path) |
|  |  |  |
|  |  | def remove(self, name): |
|  |  | if os.path.exists(os.path.join(self.\_path, name)): |
|  |  | os.remove(os.path.join(self.\_path, name)) |
|  |  | filesystem\_path = os.path.join(self.\_filesystem\_path, name) |
|  |  | if os.path.exists(filesystem\_path): |
|  |  | os.remove(filesystem\_path) |
|  |  |  |
|  |  | @property |
|  |  | def text(self): |
|  |  | components = ( |
|  |  | ical.Timezone, ical.Event, ical.Todo, ical.Journal, ical.Card) |
|  |  | items = set() |
|  |  | try: |
|  |  | filenames = os.listdir(self.\_path) |
|  |  | filenames = os.listdir(self.\_filesystem\_path) |
|  |  | except (OSError, IOError) as e: |
|  |  | log.LOGGER.info('Error while reading collection %r: %r' |
|  |  | % (self.\_path, e)) |
|  |  | % (self.\_filesystem\_path, e)) |
|  |  | return "" |
|  |  |  |
|  |  | for filename in filenames: |
|  |  | path = os.path.join(self.\_path, filename) |
|  |  | path = os.path.join(self.\_filesystem\_path, filename) |
|  |  | try: |
|  |  | with filesystem.open(path) as fd: |
|  |  | items.update(self.\_parse(fd.read(), components)) |
| Expand All | | @@ -90,17 +92,21 @@ def text(self): |
|  |  |  |
|  |  | @classmethod |
|  |  | def is\_node(cls, path): |
|  |  | path = os.path.join(filesystem.FOLDER, path.replace("/", os.sep)) |
|  |  | return os.path.isdir(path) and not os.path.exists(path + ".props") |
|  |  | filesystem\_path = pathutils.path\_to\_filesystem(path, |
|  |  | filesystem.FOLDER) |
|  |  | return (os.path.isdir(filesystem\_path) and |
|  |  | not os.path.exists(filesystem\_path + ".props")) |
|  |  |  |
|  |  | @classmethod |
|  |  | def is\_leaf(cls, path): |
|  |  | path = os.path.join(filesystem.FOLDER, path.replace("/", os.sep)) |
|  |  | return os.path.isdir(path) and os.path.exists(path + ".props") |
|  |  | filesystem\_path = pathutils.path\_to\_filesystem(path, |
|  |  | filesystem.FOLDER) |
|  |  | return (os.path.isdir(filesystem\_path) and |
|  |  | os.path.exists(path + ".props")) |
|  |  |  |
|  |  | @property |
|  |  | def last\_modified(self): |
|  |  | last = max([ |
|  |  | os.path.getmtime(os.path.join(self.\_path, filename)) |
|  |  | for filename in os.listdir(self.\_path)] or [0]) |
|  |  | os.path.getmtime(os.path.join(self.\_filesystem\_path, filename)) |
|  |  | for filename in os.listdir(self.\_filesystem\_path)] or [0]) |
|  |  | return time.strftime("%a, %d %b %Y %H:%M:%S +0000", time.gmtime(last)) |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b4b3d51`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FUnrud%2FRadicale%2Fcommit%2Fb4b3d51f33c7623d312f289252dd7bbb8f58bbe6) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_b90ea08b_20250124_121412.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[thread-next>]](../../../2016/01/06/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <1451995511.3914.25.camel@debian.org>
Date: Tue, 05 Jan 2016 13:05:11 +0100
From: Yves-Alexis Perez <corsac@...ian.org>
To: oss-security@...ts.openwall.com
Subject: CVE request for radicale

Hi,

multiple security fixes were done in radicale (a calendar/contact server) 1.1,
released on dec 31st:

<https://github.com/Kozea/Radicale/pull/343>
<http://radicale.org/news/#2015-12-31@11:54:03>
<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=809920>

Can CVE be assigned for those issues?

Thank in advance,
--
Yves-Alexis

Download attachment "[signature.asc](7/1)" of type "application/pgp-signature" (474 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_b3a24dbb_20250124_121413.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2016/01/06/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160107182324.DD9B272E06A@smtpvbsrv1.mitre.org>
Date: Thu,  7 Jan 2016 13:23:24 -0500 (EST)
From: cve-assign@...re.org
To: guillaume.ayoub@...ea.fr
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request for radicale

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> here are for me the 3 real independent vulnerabilities
> reported and fixed in 1.1:

OK, we will keep the two CVE IDs already assigned in

  <http://www.openwall.com/lists/oss-security/2016/01/06/4>

and add one more CVE ID for the third issue.

> 3. "On MS Windows the filesystem backend allows access to the first
> level of files on a drive."
>
> The filesystem backend is the default storage backend. When used, it
> converts paths like /c:/filename/dummy to c:\filename, and allowing
> anybody to read/write anything anywhere, by sending requests with
> particular paths and contents.

Use CVE-2016-1505.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWjqzGAAoJEL54rhJi8gl5ls8P/3X6IIeZYgpQ9bwDGeVTdPiu
qkeJl0cLsikGu2+uyfSTVA5s869DUXERPHLAAVq96LJBm6uWK/w22Z+3D8QPZBqF
IjfR5uMe6HMizpBEiJb2MXWBS1kcjKBOU7kJKBHbToYnJCzhX8WIPW7EG69W/d+/
K4ILFTTXwO/bZunY4wdIM08mE+LQZZEvdGTLm8roIGoorl/qC/ox0ZSWx+mmkf2p
PY/KPSnIPG/4gfF+50lCtluV73fI0i1m9si6IBSlwaWA9Bij1tBrtmj+TnBCKu5n
KW8nRQYwGK6WKh9xZ87fxavRh7jnrwWUYNGpK/NC11DANGa9PLkz4w/oufEm3G00
4Zxd7orjvO81bD3UHiv8hYPEAHtkqBxyoDItctR+yZ0owFDd/EbrIie9yPGheeW8
EgosX7xs5nQ/YNIip2FdGZvS+kjhMvf0O/teO6exdMGlPv1UnFwCl67XyRbp8qt3
+8kaEzAgib84Jg/jEvE353MJ+kHS0FJaA6GI282lRC13OZfLVqi621KXr7xVqstD
WCb0wOza2tCsmcE3nvMqmqKpIrWk+O5MPtcq5yXmpQV/LonJIqF5gQUcrW0iKEdM
LFrSp20MgnrX31nRSlSvNiTijcZBCPqgi+yBhuFLbtYs95YAlLhXen7oB53NF8zn
YEwGYy/Oa476zqRq3/FP
=SRvk
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_ef4f62f3_20250124_121412.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2016/01/05/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160106082513.E5702332074@smtpvbsrv1.mitre.org>
Date: Wed,  6 Jan 2016 03:25:13 -0500 (EST)
From: cve-assign@...re.org
To: corsac@...ian.org
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request for radicale

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <https://github.com/Kozea/Radicale/pull/343>
> <http://radicale.org/news/#2015-12-31@11:54:03>
> <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=809920>

>> This fixes a number of issues with dodgy path handling

>> Many improvements in this release are related to security

We do not see a straightforward way to determine the total number of
independent vulnerabilities. For example:

  Paths like .., ../.. or // are not sanitized correctly

  The program crashes if a path doesn't start with base_prefix instead of showing an error message

  On MS Windows the filesystem backend allows access to the first level of files on a drive.

  Improve the regex used for well-known URIs

  Decouple the daemon from its parent environment

  Avoid race condition in PID file creation

are missing information about the attacker and/or the impact.

These might potentially be overlapping observations:

  Paths like .., ../.. or // are not sanitized correctly

  Improve the regex used for well-known URIs

  Prevent crafted HTTP request from calling arbitrary functions

  Improve URI sanitation and conversion to filesystem path

For now, we will start with two CVE IDs for the change information that
seems somewhat more clear:

CVE-2015-8747 - The multifilesystem backend allows access to arbitrary files on all platforms.

CVE-2015-8748 - Prevent regex injection in rights management

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWjM5nAAoJEL54rhJi8gl5CT8P/3BdMvzOj6xjmM/jITW6Xabs
F4KoH+xeoN8dABnJLMYoFxJSokjVlvNu2CbdQo4JIdE76iTLTG48s5BPOlga/6Nh
fbEDGk+lrEsWro86FUDQh0oJYFcJCQdOS+GNSi3KW2I7DQVKvsvO5lTvG8zUNH8k
ELJ67CVjFR2g1DeiTnJaXYIeGoDPf0YckjagpGnxZKR6ZFjKi0YOTSPThWNSqIVG
I0NZxXpcno+MMylsSg7f9KObwkti8eFl6oFHzxOTuyugJjQbkpkdXBfY08ZiVBOq
Ik44z97aIZqaGKpiDdYPZnLhSfeBAT8i0kDZn5SH5Am0Oacb5WF2774Vj1NOQtdT
D4Z2q+KpydU9hMeIeaEz84IjF2JoZapZax32zY+vQI28jzrbWmJ2EFiMIHh29fHk
h97+pz/nRlebbLcUcwvs9we6Bec0ZyA74+XCPH68UferVg5YUD85mbTl+elIB9x7
VAD/9hKGzqEnuQNfaOEur6H+gfik6667qpcelYnpxa+ReidcUwtkq0MmkmZwaGBl
Jw5mji3a77BhbakfMAc18OfJ16Xrd+bV5ffd/mFA0jegQDtd8HiY5+mMPDdKU5Sx
kePOeaQxTM22mnFvYuyHekW/tZR8zWIajSbFpG/wQwM5E05Kr/KuIyozlU5oZWDj
/Xvt2kqc2sHESQq+kDhG
=HPXl
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_39f8a740_20250124_121414.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FKozea%2FRadicale%2Fpull%2F343)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FKozea%2FRadicale%2Fpull%2F343)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fpull_requests_fragments%2Fpull_request_layout&source=header-repo&source_repo=Kozea%2FRadicale)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[Kozea](/Kozea)
/
**[Radicale](/Kozea/Radicale)**
Public

* [Notifications](/login?return_to=%2FKozea%2FRadicale) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2FKozea%2FRadicale)
* [Star
   3.5k](/login?return_to=%2FKozea%2FRadicale)

* [Code](/Kozea/Radicale)
* [Issues
  32](/Kozea/Radicale/issues)
* [Pull requests
  1](/Kozea/Radicale/pulls)
* [Discussions](/Kozea/Radicale/discussions)
* [Actions](/Kozea/Radicale/actions)
* [Wiki](/Kozea/Radicale/wiki)
* [Security](/Kozea/Radicale/security)
* [Insights](/Kozea/Radicale/pulse)

Additional navigation options

* [Code](/Kozea/Radicale)
* [Issues](/Kozea/Radicale/issues)
* [Pull requests](/Kozea/Radicale/pulls)
* [Discussions](/Kozea/Radicale/discussions)
* [Actions](/Kozea/Radicale/actions)
* [Wiki](/Kozea/Radicale/wiki)
* [Security](/Kozea/Radicale/security)
* [Insights](/Kozea/Radicale/pulse)

New issue

**Have a question about this project?** Sign up for a free GitHub account to open an issue and contact its maintainers and the community.

 [Sign up for GitHub](/signup?return_to=%2FKozea%2FRadicale%2Fissues%2Fnew%2Fchoose)

By clicking “Sign up for GitHub”, you agree to our [terms of service](https://docs.github.com/terms) and
[privacy statement](https://docs.github.com/privacy). We’ll occasionally send you account related emails.

Already on GitHub?
[Sign in](/login?return_to=%2FKozea%2FRadicale%2Fissues%2Fnew%2Fchoose)
to your account

[Jump to bottom](#issue-comment-box)

# Secure path handling #343

 Merged

[liZe](/liZe)
merged 8 commits into
[Kozea:master](/Kozea/Radicale/tree/master "Kozea/Radicale:master")
from
[Unrud:paths](/Unrud/Radicale/tree/paths "Unrud/Radicale:paths")

Dec 24, 2015

 Merged

# [Secure path handling](#top) #343

[liZe](/liZe)
merged 8 commits into
[Kozea:master](/Kozea/Radicale/tree/master "Kozea/Radicale:master")
from
[Unrud:paths](/Unrud/Radicale/tree/paths "Unrud/Radicale:paths")

Dec 24, 2015

[Conversation
2](/Kozea/Radicale/pull/343)
[Commits
8](/Kozea/Radicale/pull/343/commits)
[Checks
0](/Kozea/Radicale/pull/343/checks)
[Files changed](/Kozea/Radicale/pull/343/files)

## Conversation

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

[![Unrud](https://avatars.githubusercontent.com/u/11810547?s=60&v=4)](/Unrud)

Copy link

Collaborator

### @Unrud **[Unrud](/Unrud)** commented [Dec 24, 2015](#issue-123806341)

This fixes a number of issues with dodgy path handling:

* Paths like `..`, `../..` or `//` are not sanitized correctly
* The program crashes if a path doesn't start with `base_prefix` instead of showing an error message
* On MS Windows the filesystem backend allows access to the first level of files on a drive.

  e.g. the path `/c:/filename/dummy` gets converted to `c:\filename`
* The multifilesystem backend allows access to arbitrary files on all platforms.

  e.g. set the UID of a ics file to `/dev/null`

Sorry, something went wrong.

All reactions

 Unrud
added 8 commits
[December 24, 2015 14:32](#commits-pushed-ee095a4)

`[Improve URI sanitation](/Kozea/Radicale/pull/343/commits/ee095a463d997eed30232e4a8e25ca3ef2acea1a "Improve URI sanitation
The old implementation failed to sanitize URIs
like \".\", \"..\", \"../..\" or \"//\"")`
 …

`[ee095a4](/Kozea/Radicale/pull/343/commits/ee095a463d997eed30232e4a8e25ca3ef2acea1a)`

```
The old implementation failed to sanitize URIs
like ".", "..", "../.." or "//"
```

`[Always sanitize request URI](/Kozea/Radicale/pull/343/commits/780cecc0f2f91116bc71852888061874fd5b1277 "Always sanitize request URI
Do no rely on the HTTP server")`
 …

`[780cecc](/Kozea/Radicale/pull/343/commits/780cecc0f2f91116bc71852888061874fd5b1277)`

```
Do no rely on the HTTP server
```

`[Error message if path not starting with prefix](/Kozea/Radicale/pull/343/commits/ed44830447224d13fb2d2639cf1297e41ec5c511 "Error message if path not starting with prefix
Before the program crashed implicitly")`
 …

`[ed44830](/Kozea/Radicale/pull/343/commits/ed44830447224d13fb2d2639cf1297e41ec5c511)`

```
Before the program crashed implicitly
```

`[Move sanitize_path into pathutils.py](/Kozea/Radicale/pull/343/commits/1ad994cadf8a339863c1a8f5e405b76a83fd7ba5 "Move sanitize_path into pathutils.py")`

`[1ad994c](/Kozea/Radicale/pull/343/commits/1ad994cadf8a339863c1a8f5e405b76a83fd7ba5)`

`[Use sanitize_path instead of normpath](/Kozea/Radicale/pull/343/commits/6b7e79a368be86d266c51cf50915324490a1b728 "Use sanitize_path instead of normpath
See a7b47f075499a1e1b40539bc1fa872a3ab77a204
The check for \".\" is now needless because the sane
path is always absolute.
```path.replace(os.sep, \"/\")``` is only relevant
for the (multi)filesystem backend and should be
there.")`
 …

`[6b7e79a](/Kozea/Radicale/pull/343/commits/6b7e79a368be86d266c51cf50915324490a1b728)`

```
See a7b47f075499a1e1b40539bc1fa872a3ab77a204
The check for "." is now needless because the sane
path is always absolute.
```path.replace(os.sep, "/")``` is only relevant
for the (multi)filesystem backend and should be
there.
```

`[Convert paths safely to file system paths](/Kozea/Radicale/pull/343/commits/b4b3d51f33c7623d312f289252dd7bbb8f58bbe6 "Convert paths safely to file system paths
With the old implementation on Windows a path like
\"/c:/file/ignore\" got converted to \"c:\file\" and
allowed access to files outside of FOLDER")`
 …

`[b4b3d51](/Kozea/Radicale/pull/343/commits/b4b3d51f33c7623d312f289252dd7bbb8f58bbe6)`

```
With the old implementation on Windows a path like
"/c:/file/ignore" got converted to "c:\file" and
allowed access to files outside of FOLDER
```

`[Convert component names safely to filenames](/Kozea/Radicale/pull/343/commits/bcaf452e516c02c9bed584a73736431c5e8831f1 "Convert component names safely to filenames
Component names are controlled by the user and
without this checks access to arbitrary files is
possible if the multifilesystem backend is used.")`
 …

`[bcaf452](/Kozea/Radicale/pull/343/commits/bcaf452e516c02c9bed584a73736431c5e8831f1)`

```
Component names are controlled by the user and
without this checks access to arbitrary files is
possible if the multifilesystem backend is used.
```

`[Convert filesystem paths safely to paths](/Kozea/Radicale/pull/343/commits/eed37792aef835a18cf1413814adf37a3394b4d1 "Convert filesystem paths safely to paths
This only becomes a problem if the OS/filesystem
allows / in filenames or . respectively
.. as filenames.")`
 …

`[eed3779](/Kozea/Radicale/pull/343/commits/eed37792aef835a18cf1413814adf37a3394b4d1)`

```
This only becomes a problem if the OS/filesystem
allows / in filenames or . respectively
.. as filenames.
```

[liZe](/liZe)
added a commit
that referenced
this pull request
[Dec 24, 2015](#ref-commit-18c8864)
[![@liZe](https://avatars.githubusercontent.com/u/952243?s=40&u=bf700a5768d64529e87911656ce1a054f3449a26&v=4)](/liZe)

`[Merge pull request](/Kozea/Radicale/commit/18c88642fb19ee1480690e51fff9605ecc6fdab5 "Merge pull request #343 from Unrud/paths

Secure path handling") [#343](https://github.com/Kozea/Radicale/pull/343) [from Unrud/paths](/Kozea/Radicale/commit/18c88642fb19ee1480690e51fff9605ecc6fdab5 "Merge pull request #343 from Unrud/paths

Secure path handling")`
…

`[18c8864](/Kozea/Radicale/commit/18c88642fb19ee1480690e51fff9605ecc6fdab5)`

```
Secure path handling
```

[![@liZe](https://avatars.githubusercontent.com/u/952243?s=40&u=bf700a5768d64529e87911656ce1a054f3449a26&v=4)](/liZe)
[liZe](/liZe)
merged commit [`18c8864`](/Kozea/Radicale/commit/18c88642fb19ee1480690e51fff9605ecc6fdab5)
into
Kozea:master

[Dec 24, 2015](https://github.com/Kozea/Radicale/pull/343#event-500197875)

[![@liZe](https://avatars.githubusercontent.com/u/952243?s=80&u=bf700a5768d64529e87911656ce1a054f3449a26&v=4)](/liZe)

Copy link

Member

### **[liZe](/liZe)** commented [Dec 24, 2015](#issuecomment-167121758)

| That's a serious one.  Do you have other security-related issues coming? I'll have to release a new version after that.  Thank you again! |
| --- |

All reactions

Sorry, something went wrong.

[![@Unrud](https://avatars.githubusercontent.com/u/11810547?s=80&v=4)](/Unrud)

Copy link

Collaborator

Author

### **[Unrud](/Unrud)** commented [Dec 24, 2015](#issuecomment-167127097)

| No, I've not. |
| --- |

All reactions

Sorry, something went wrong.

[![@liZe](https://avatars.githubusercontent.com/u/952243?s=40&u=bf700a5768d64529e87911656ce1a054f3449a26&v=4)](/liZe)
[liZe](/liZe)
modified the milestone:
[1.1](/Kozea/Radicale/milestone/6)
[Dec 31, 2015](#event-503325941)

 [![@Unrud](https://avatars.githubusercontent.com/u/11810547?s=40&v=4)](/Unrud)
[Unrud](/Unrud)
deleted the
paths

branch
[September 1, 2016 09:03](#event-774841184)

[Sign up for free](/join?source=comment-repo)
**to join this conversation on GitHub**.
Already have an account?
[Sign in to comment](/login?return_to=https%3A%2F%2Fgithub.com%2FKozea%2FRadicale%2Fpull%2F343)

Reviewers

No reviews

Assignees

No one assigned

Labels

None yet

Projects

None yet

Milestone

 [**1.1**](/Kozea/Radicale/milestone/6 "1.1")

Development

Successfully merging this pull request may close these issues.

2 participants

[![@Unrud](https://avatars.githubusercontent.com/u/11810547?s=52&v=4)](/Unrud) [![@liZe](https://avatars.githubusercontent.com/u/952243?s=52&v=4)](/liZe)

Add this suggestion to a batch that can be applied as a single commit.
This suggestion is invalid because no changes were made to the code.
Suggestions cannot be applied while the pull request is closed.
Suggestions cannot be applied while viewing a subset of changes.
Only one suggestion per line can be applied in a batch.
Add this suggestion to a batch that can be applied as a single commit.
Applying suggestions on deleted lines is not supported.
You must change the existing code in this line in order to create a valid suggestion.
Outdated suggestions cannot be applied.
This suggestion has been applied or marked resolved.
Suggestions cannot be applied from pending reviews.
Suggestions cannot be applied on multi-line comments.
Suggestions cannot be applied while the pull request is queued to merge.
Suggestion cannot be applied right now. Please check back later.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


