=== Content from 10degres.net_cd23ad75_20250126_005301.html ===

[Gwendal Le Coguic](https://10degres.net/)

* [Blog](https://10degres.net/posts/)
* [Projects](https://10degres.net/projects/)
* [CVEs](https://10degres.net/cves/)
* [Services](https://10degres.net/services/)
* [Press](https://10degres.net/press/)
* [About](https://10degres.net/about/)

# Sql Injection

* February 12, 2020
  [Authenticated SQL injection in Zenphoto v1.5.6 and prior](https://10degres.net/cves/cve-2020-22154/)
* February 5, 2020
  [Unauthenticated SQL injection in SimpleJobScript](https://10degres.net/cves/cve-2020-8645/)
* January 19, 2020
  [Unauthenticated SQL injection in SimpleJobScript](https://10degres.net/cves/cve-2020-7229/)
* September 12, 2017
  [Wordpress testing](https://10degres.net/wordpress-testing/)
* May 20, 2016
  [Unauthenticated SQL injection in Wordpress plugin âgallery-imagesâ](https://10degres.net/cves/cve-2016-11018/)
* January 28, 2016
  [An extremely buggy web app !](https://10degres.net/an-extremely-buggy-web-app/)
* January 18, 2016
  [Sqlmap](https://10degres.net/sqlmap/)
* February 12, 2015
  [Vulnerability in Wordpress Video Gallery](https://10degres.net/vulnerability-in-wordpress-video-gallery/)
* December 10, 2014
  [Damn Vulnerable Web Application](https://10degres.net/damn-vulnerable-web-application/)
* January 1, 1970
  [Vulnerability - SQL Injection aka SQLi](https://10degres.net/vulnerability-sql-injection-aka-sqli/)
* January 1, 1970
  [Vulnerability - Subdomain takeover](https://10degres.net/vulnerability-subdomain-takeover/)



=== Content from 10degres.net_63cdfa13_20250124_113610.html ===

[Gwendal Le Coguic](https://10degres.net/)

* [Blog](https://10degres.net/posts/)
* [Projects](https://10degres.net/projects/)
* [CVEs](https://10degres.net/cves/)
* [Services](https://10degres.net/services/)
* [Press](https://10degres.net/press/)
* [About](https://10degres.net/about/)

[![twitter](https://10degres.net/assets/img/share/twitter.svg)](https://twitter.com/intent/tweet?text=Unauthenticated%20SQL%20injection%20in%20Wordpress%20plugin%20%e2%80%9cgallery-images%e2%80%9d%20https%3a%2f%2f10degres.net%2fcves%2fcve-2016-11018%2f)
[![reddit](https://10degres.net/assets/img/share/reddit.svg)](http://www.reddit.com/submit?url=https%3a%2f%2f10degres.net%2fcves%2fcve-2016-11018%2f&title=Unauthenticated%20SQL%20injection%20in%20Wordpress%20plugin%20%e2%80%9cgallery-images%e2%80%9d)
[![hackernews](https://10degres.net/assets/img/share/hackernews.svg)](https://news.ycombinator.com/submitlink?u=https%3a%2f%2f10degres.net%2fcves%2fcve-2016-11018%2f&t=Unauthenticated%20SQL%20injection%20in%20Wordpress%20plugin%20%e2%80%9cgallery-images%e2%80%9d)
![mail](https://10degres.net/assets/img/share/mail.svg)
[![facebook](https://10degres.net/assets/img/share/whatsapp.svg)](https://wa.me/?text=Unauthenticated%20SQL%20injection%20in%20Wordpress%20plugin%20%e2%80%9cgallery-images%e2%80%9d%20https%3a%2f%2f10degres.net%2fcves%2fcve-2016-11018%2f)
[![facebook](https://10degres.net/assets/img/share/telegram.svg)](https://t.me/share/url?url=https%3a%2f%2f10degres.net%2fcves%2fcve-2016-11018%2f&text=Unauthenticated%20SQL%20injection%20in%20Wordpress%20plugin%20%e2%80%9cgallery-images%e2%80%9d)
[![linkedin](https://10degres.net/assets/img/share/linkedin.svg)](https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2f10degres.net%2fcves%2fcve-2016-11018%2f&title=Unauthenticated%20SQL%20injection%20in%20Wordpress%20plugin%20%e2%80%9cgallery-images%e2%80%9d)
[![facebook](https://10degres.net/assets/img/share/facebook.svg)](https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2f10degres.net%2fcves%2fcve-2016-11018%2f&t=Unauthenticated%20SQL%20injection%20in%20Wordpress%20plugin%20%e2%80%9cgallery-images%e2%80%9d)

# CVE-2016-11018

May 20, 2016

3 minutes read

[cve](https://10degres.net/tags/cve/)
â¢
[wordpress](https://10degres.net/tags/wordpress/)
â¢
[sql injection](https://10degres.net/tags/sql-injection/)

An issue was discovered in the Huge-IT gallery-images plugin before 1.9.0 for WordPress. The headers `Client-Ip` and `X-Forwarded-For` are prone to unauthenticated SQL injection. The affected file is `gallery-images.php`. The affected function is `huge_it_image_gallery_ajax_callback()`.

* mitre: <https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-11018>

---

While I was working on a famous bug bounty program, WPScan returns me the list of the plugins configured on the Wordpress install.
Here is what I found in one of them: [Image Gallery by Huge-IT](https://wordpress.org/plugins/gallery-images/).

WPScan output, no issues known:

```
[+] Name: gallery-images - v1.8.6
 |  Location: https://[REDACTED]/wp-content/plugins/gallery-images/
 |  Readme: https://[REDACTED]/wp-content/plugins/gallery-images/readme.txt

```

After a fast search on [exploit-db.com](https://www.exploit-db.com/) with no success, I finally decided to download it and read the code to find vulnerabilites by myself.
Since the readme was available, I was able to confirm the version of the plugin.

I was looking for two kind of vulnerabilities: file upload and sql injection.
First thing I did was to locate PHP files, and grepping the result to find `Content-Disposition` header:

```
$ find . -name "*.php*" | xargs grep -i header
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:		/*HEIGHT FROM HEADER.PHP*/
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./Front_end/gallery_front_end_view.php:							header("Location:".$actual_link."");
./admin/gallery_func.php:			header('Location: admin.php?page=gallerys_huge_it_gallery&id='.$rowsldccs->id.'&task=apply');
./admin/gallery_view.php:	header('Location: admin.php?page=gallerys_huge_it_gallery&id='.$row->id.'&task=apply');
./admin/gallery_view.php:	<div id="gallery-header">

```

Nothing interesting here…

Then, I noticed that the “non admin” requests where mainly coded in two files: `gallery-images.php` and `Front_end/gallery_front_end_view.php`.
Luckily I started to read the first one which contains the hole.

In the function `huge_it_image_gallery_ajax_callback`, the variable `$huge_it_ip` is used multiple times in the following form:

```
$wpdb->prepare("SELECT `image_status`,`ip` FROM ".$wpdb->prefix."huge_itgallery_like_dislike WHERE image_id = %d AND `ip` = '".$huge_it_ip."'",(int)$row->id);

```

This variable is defined at the top of the file:

```
if(!empty($_SERVER['HTTP_CLIENT_IP'])){
	$huge_it_ip=$_SERVER['HTTP_CLIENT_IP'];
}
elseif(!empty($_SERVER['HTTP_X_FORWARDED_FOR'])){
	$huge_it_ip=$_SERVER['HTTP_X_FORWARDED_FOR'];
}
else{
	$huge_it_ip=$_SERVER['REMOTE_ADDR'];
}

```

Unfortunately HTTP headers cannot be trusted, even ip address.
So I started to test the injection in `X-Forwarded-For` header and it worked perfectly on my local install.
However the site I was testing seems to had a firewall who drop this header.
I then tested the injection in `Client-Ip` header and it passed !

Note that the plugin must be enabled to be able to exploit the injection.
Finally here is the full request in Burp Suite:

```
POST /wp-admin/admin-ajax.php HTTP/1.1
Host: local.wordpress.com
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101 Firefox/38.0 Iceweasel/38.8.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Referer: http://local.wordpress.com/wp-admin/admin.php?page=gallerys_huge_it_gallery&task=edit_cat&id=1
Content-Length: 89
Client-Ip: 123.123.123.123
Cookie: wordpress_3e0ed6e299d95d3a38b8516e25f1b1e2=admin%7C1463913228%7CYRWrxl5s69SoSkkXyMBFnXzSt2dSINk63ojC6F0mcWJ%7Cb28be90ae8a75452f047cb21fcc84f42a9a801123af24c1f77bb3f19c880147b; wordpress_test_cookie=WP+Cookie+check; wordpress_logged_in_3e0ed6e299d95d3a38b8516e25f1b1e2=admin%7C1463913228%7CYRWrxl5s69SoSkkXyMBFnXzSt2dSINk63ojC6F0mcWJ%7C243730f21ebdc724e25dd292d6c8d1773510dd572a0a39abc88b379852181f1f; wp-settings-1=libraryContent%3Dbrowse%26editor%3Dtinymce; wp-settings-time-1=1463740430; PHPSESSID=e5a63r274m6mvcfbmblgacrvq0
Connection: keep-alive
Pragma: no-cache
Cache-Control: no-cache
action=huge_it_video_gallery_ajax&task=load_images_content&galleryid=1&page=1&perpage=100

```

The parameter `task` can be one of the following:

load\_images\_content

load\_images\_lightbox

load\_image\_justified

load\_image\_thumbnail

load\_blog\_view

And the result:
![cve-2016-11018](https://10degres.net/images/image-gallery-sql-injection.png)

A Full Path Disclosure is also available if you call `http://www.example.com/wp-content/plugins/gallery-images/gallery-images.php`

I sent an email to Huge-IT who released a fix the same day. Fast enough :)

## External resources

* [Huge-IT website](http://huge-it.com/wordpress-gallery/)



=== Content from www.facebook.com_a5b0c722_20250126_005301.html ===

# [*Facebook*](https://www.facebook.com/ "Go to Facebook home")

| Email or phone | Password |
| --- | --- |
|  |  |  |
|  | [Forgot account?](https://www.facebook.com/recover/initiate?lwv=110&ars=royal_blue_bar) |

[Sign Up](/r.php?locale=en_US)
## Not Logged In

## Not Logged In

You are not logged in. Please login and try again.

* [Return home](/)

* English (US)
* [Gaeilge](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Irish")
* [Polski](https://ga-ie.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Polish")
* [Lietuvių](https://pl-pl.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Lithuanian")
* [Português (Brasil)](https://lt-lt.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Portuguese (Brazil)")
* [Русский](https://pt-br.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Russian")
* [Română](https://ru-ru.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Romanian")
* [Español](https://ro-ro.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Spanish")
* [Français (France)](https://es-la.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "French (France)")
* [Deutsch](https://fr-fr.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "German")
* [Italiano](https://de-de.facebook.com/sharer/sharer.php?u=https%3A%2F%2F10degres.net%2Fcves%2Fcve-2016-11018%2F&t=Unauthenticated+SQL+injection+in+Wordpress+plugin+%E2%80%9Cgallery-images%E2%80%9D "Italian")

* [Sign Up](/reg/ "Sign Up for Facebook")
* [Log In](/login/ "Log into Facebook")
* [Messenger](https://messenger.com/ "Check out Messenger.")
* [Facebook Lite](/lite/ "Facebook Lite for Android.")
* [Video](https://www.facebook.com/watch/ "Browse in Video")
* [Places](/places/ "Check out popular places on Facebook.")
* [Games](/games/ "Check out Facebook games.")
* [Marketplace](/marketplace/ "Buy and sell on Facebook Marketplace.")
* [Meta Pay](https://about.meta.com/technologies/meta-pay "Learn more about Meta Pay")
* [Meta Store](https://www.meta.com/ "Check out Meta")
* [Meta Quest](https://www.meta.com/quest/ "Learn more about Meta Quest")
* [Ray-Ban Meta](https://www.meta.com/smart-glasses/ "Learn more about Ray-Ban Meta")
* [Meta AI](https://www.meta.ai/ "Meta AI")
* [Instagram](https://l.facebook.com/l.php?u=https%3A%2F%2Fwww.instagram.com%2F&h=AT3LX69MPg39s88W8OfWjJJlGU68wRnKge-4kF4U3IxKUtjvJfVvyG0sPYafAwEj_A4gMm7Ksx_5uwhQNk6dvlK4rEq35Eq5IHAYeUed6dzq-9oomI_HdeZ9S1nfPIek5dUPiaVfrYZITGvxynC-ww "Check out Instagram")
* [Threads](https://www.threads.net/ "Check out Threads")
* [Fundraisers](/fundraisers/ "Donate to worthy causes.")
* [Services](/biz/directory/ "Browse our Facebook Services directory.")
* [Voting Information Center](/votinginformationcenter/?entry_point=c2l0ZQ%3D%3D "See the Voting Information Center.")
* [Privacy Policy](/privacy/policy/?entry_point=facebook_page_footer "Learn how we collect, use and share information to support Facebook.")
* [Privacy Center](/privacy/center/?entry_point=facebook_page_footer "Learn how to manage and control your privacy on Facebook.")
* [Groups](/groups/discover/ "Explore our Groups.")
* [About](https://about.meta.com/ "Read our blog, discover the resource center, and find job opportunities.")
* [Create ad](/ad_campaign/landing.php?placement=pflo&campaign_id=402047449186&nav_source=unknown&extra_1=auto "Advertise on Facebook.")
* [Create Page](/pages/create/?ref_type=site_footer "Create a page")
* [Developers](https://developers.facebook.com/?ref=pf "Develop on our platform.")
* [Careers](/careers/?ref=pf "Make your next career move to our awesome company.")
* [Cookies](/policies/cookies/ "Learn about cookies and Facebook.")
* [Ad choices](https://www.facebook.com/help/568137493302217 "Learn about Ad Choices.")
* [Terms](/policies?ref=pf "Review our terms and policies.")
* [Help](/help/?ref=pf "Visit our Help Center.")
* [Contact Uploading & Non-Users](https://www.facebook.com/help/637205020878504 "Visit our Contact Uploading & Non-Users Notice.")
* [Settings](/settings "View and edit your Facebook settings.")
* [Activity log](/allactivity?privacy_source=activity_log_top_menu "View your activity log")
 Meta © 2025![](https://facebook.com/security/hsts-pixel.gif)



=== Content from 10degres.net_30167480_20250126_005301.html ===

[Gwendal Le Coguic](https://10degres.net/)

* [Blog](https://10degres.net/posts/)
* [Projects](https://10degres.net/projects/)
* [CVEs](https://10degres.net/cves/)
* [Services](https://10degres.net/services/)
* [Press](https://10degres.net/press/)
* [About](https://10degres.net/about/)

# Cve

* November 11, 2022
  [Unrestricted File Upload in Canteen Management System](https://10degres.net/cves/cve-2022-43265/)
* October 26, 2022
  [CVE demystified](https://10degres.net/cve-demystified/)
* February 13, 2020
  [Code injection in SimpleJobScript by Niteosoft](https://10degres.net/cves/cve-2020-22155/)
* February 12, 2020
  [Authenticated SQL injection in Zenphoto v1.5.6 and prior](https://10degres.net/cves/cve-2020-22154/)
* February 11, 2020
  [Code injection in Zenphoto v1.5.6 and prior](https://10degres.net/cves/cve-2020-22145/)
* February 10, 2020
  [Path traversal in Zenphoto v1.5.6 and prior](https://10degres.net/cves/cve-2020-22144/)
* February 9, 2020
  [Reflected XSS in Zenphoto v1.5.6 and prior](https://10degres.net/cves/cve-2020-22143/)
* February 5, 2020
  [Unauthenticated SQL injection in SimpleJobScript](https://10degres.net/cves/cve-2020-8645/)
* January 29, 2020
  [Unrestricted file upload in SimpleJobScript](https://10degres.net/cves/cve-2020-8440/)
* January 19, 2020
  [Unauthenticated SQL injection in SimpleJobScript](https://10degres.net/cves/cve-2020-7229/)
* May 20, 2016
  [Unauthenticated SQL injection in Wordpress plugin âgallery-imagesâ](https://10degres.net/cves/cve-2016-11018/)



=== Content from 10degres.net_0cd7ac3c_20250126_005301.html ===

[Gwendal Le Coguic](https://10degres.net/)

* [Blog](https://10degres.net/posts/)
* [Projects](https://10degres.net/projects/)
* [CVEs](https://10degres.net/cves/)
* [Services](https://10degres.net/services/)
* [Press](https://10degres.net/press/)
* [About](https://10degres.net/about/)

# Wordpress

* September 12, 2017
  [Wordpress testing](https://10degres.net/wordpress-testing/)
* May 20, 2016
  [Unauthenticated SQL injection in Wordpress plugin âgallery-imagesâ](https://10degres.net/cves/cve-2016-11018/)
* May 10, 2015
  [Secure your Wordpress](https://10degres.net/secure-your-wordpress/)
* February 12, 2015
  [Vulnerability in Wordpress Video Gallery](https://10degres.net/vulnerability-in-wordpress-video-gallery/)
* December 15, 2014
  [Vulnerability in HD FLV Player](https://10degres.net/vulnerability-in-hd-flv-player/)


