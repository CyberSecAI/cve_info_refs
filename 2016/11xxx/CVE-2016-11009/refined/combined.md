=== Content from wordpress.org_3bd83837_20250124_115131.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

WP-Invoice – Web Invoice and Billing

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-invoice&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fwp-invoice&locale=en_US)

Search plugins

![](https://s.w.org/plugins/geopattern-icon/wp-invoice_c36510.svg)
# wp-invoice

By [Usability Dynamics, Inc.](http://www.usabilitydynamics.com)

* [Details](https://wordpress.org/plugins/wp-invoice/#description)
* [Reviews](https://wordpress.org/plugins/wp-invoice/#reviews)
* [Development](https://wordpress.org/plugins/wp-invoice/#developers)

[Support](https://wordpress.org/support/plugin/wp-invoice/)

## Description

This plugin has been closed as of April 27, 2022 and is not available for download. Reason: Security Issue.

## Reviews

![](https://secure.gravatar.com/avatar/9f54044970565a9be946862c97204e92a6530028062b527d9c73cd77c19edb31?s=60&d=retro&r=g)
### [Looks like they are out of business](https://wordpress.org/support/topic/looks-like-they-are-out-of-business/)

[pparkadmin](https://profiles.wordpress.org/pparkadmin/ "Posts by pparkadmin")
February 9, 2021

I have posted 2 times in the last few months to the support forum and gotten no reply. In fact no one has gotten any replies in about a year. I would say that with support like the company is either gone, or will soon be gone. Its a shame because the product itself had a lot of potential.

![](https://secure.gravatar.com/avatar/3c55a69977752433913a92196b06b5b9d919d39716e909448e8374d91802a0e6?s=60&d=retro&r=g)
### [Poor instructions & confusing](https://wordpress.org/support/topic/poor-instructions-confusing/)

[mattoid55](https://profiles.wordpress.org/mattoid55/ "Posts by mattoid55")
December 29, 2020

The setup instructions are not very good. The forms have misaligned fields. I can’t recommend this.

![](https://secure.gravatar.com/avatar/4d222ae9cb7d88065b695eb585833754e9605507be23537f595c173c8219fc36?s=60&d=retro&r=g)
### [free plugin to generate customize invoice](https://wordpress.org/support/topic/free-plugin-to-generate-customize-invoice/)

[Kevin Kovadia](https://profiles.wordpress.org/kpdaa/ "Posts by Kevin Kovadia")
November 8, 2020

Thank you for making this plugin and avail for free. I am looking for such a plugin and then I showed this plugin video. I am using this video now. I had added my currency INR from setting options.

![](https://secure.gravatar.com/avatar/8ae1229d3680dfb91d0d13ac8b9ce7595c8efe80d57e35737b44c35654a24b7e?s=60&d=retro&r=g)
### [Very customizable](https://wordpress.org/support/topic/very-customizable-32/)

[goldorak](https://profiles.wordpress.org/goldorak/ "Posts by goldorak")
May 31, 2020

Great work there. I am able to send and track payments in different languages and currencies. I upgraded my website to work under https and stripe works too!
I can see you’re quite busy lately, and would like to help out whenever I get a few minutes to do so! I LOVE THE PRODUCT!

![](https://secure.gravatar.com/avatar/628121808c6387ffda861d275ae31b894da2d3ad4195b36f11ee4b203ba0436c?s=60&d=retro&r=g)
### [Very bad](https://wordpress.org/support/topic/very-bad-95/)

[aditya123456789](https://profiles.wordpress.org/aditya123456789/ "Posts by aditya123456789")
April 5, 2020

I use WP-Invoice to allow credit card payments via Stripe on my site. I’m aware that stronger authentication rules are coming into force in the UK, and I’ve received emails from Stripe asking me to upgrade to be able to allow 2-factor authentication. However, I don’t see any recent update from WP-Invoice to tie in with this change.
Is integration with SCA/2-factor authentication already available in WP-Invoice, or is an upgrade going to be available soon?
Thanks,
Ranjit

![](https://secure.gravatar.com/avatar/16446b1ab9fa6c75cfa986791deca75627f734e3efbb5f74766a0a73b8f846dd?s=60&d=retro&r=g)
### [Some bugs or problems](https://wordpress.org/support/topic/some-bugs-or-problems/)

[sirdash](https://profiles.wordpress.org/sirdash/ "Posts by sirdash")
September 4, 2019

hi
Normally this app is for the store , And the best store plugins right now are woocommerce
Now if your plugin sync with woocommerce plugin very very good
for example choice of product and currency unit and country local payment system choice
and attach invoice pdf when send notification mail.
If the above items are included in the plugin , It will be very beautiful.
thanks

[Read all 61 reviews](https://wordpress.org/support/plugin/wp-invoice/reviews/)
## Contributors & Developers

“WP-Invoice – Web Invoice and Billing” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/3a08e202ea2a25ebf1fa3baa02a79921359559917ab79748cf1a0fb581f65b35?s=32&d=mm&r=g) [Usability Dynamics](https://profiles.wordpress.org/usability_dynamics/)
* ![](https://secure.gravatar.com/avatar/f120c99131992985e84f8976533edf6b03a87580249de49befb9ecf1e8ae0fea?s=32&d=mm&r=g) [Anton Korotkoff](https://profiles.wordpress.org/anton-korotkoff/)
* ![](https://secure.gravatar.com/avatar/26fb1afd034b43a7fe204dfc667c143ce7fbda46be477ba7212cf753cd784706?s=32&d=mm&r=g) [Andy Potanin](https://profiles.wordpress.org/andypotanin/)
* ![](https://secure.gravatar.com/avatar/b95c83f36fdae768254f7c83abf5c3e359c5cf80ca1bfc6f37f78a55486378cb?s=32&d=mm&r=g) [jbrw1984](https://profiles.wordpress.org/jbrw1984/)
* ![](https://secure.gravatar.com/avatar/a437e09012c59b62487e0137b6732380076a559b1670520fac8ef86365047f7b?s=32&d=mm&r=g) [Maxim Peshkov](https://profiles.wordpress.org/maximpeshkov/)
* ![](https://secure.gravatar.com/avatar/8c33e9a1a47a4570094501aad6972897b35a5d5dff752010ec71028872d93d87?s=32&d=mm&r=g) [Eric Sopp](https://profiles.wordpress.org/ideric/)
* ![](https://secure.gravatar.com/avatar/7c9ff7e924d12c672c8caa3bc20aeffbf4a17b18d4055d830a0f5672dbb183ea?s=32&d=mm&r=g) [MariaKravchenko](https://profiles.wordpress.org/mariakravchenko/)
* ![](https://secure.gravatar.com/avatar/3d71104d71f45f1f5a36968b83917622437452e3a3581b554478a35c9c774ba8?s=32&d=mm&r=g) [smoot328](https://profiles.wordpress.org/smoot328/)
* ![](https://secure.gravatar.com/avatar/905a4dc9dfb9d123ef49c900481a99bc7c0c8d3bed74246cd3a028bdfa766956?s=32&d=mm&r=g) [Vladimir Palant](https://profiles.wordpress.org/planvova/)

“WP-Invoice – Web Invoice and Billing” has been translated into 5 locales. Thank you to [the translators](https://translate.wordpress.org/projects/wp-plugins/wp-invoice/contributors) for their contributions.

[Translate “WP-Invoice – Web Invoice and Billing” into your language.](https://translate.wordpress.org/projects/wp-plugins/wp-invoice)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/wp-invoice/), check out the [SVN repository](https://plugins.svn.wordpress.org/wp-invoice/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/wp-invoice/) by [RSS](https://plugins.trac.wordpress.org/log/wp-invoice/?limit=100&mode=stop_on_copy&format=rss).

## Meta

* Version **4.3.1**
* Last updated **3 years ago**
* Active installations **N/A**
* WordPress version **4.0 or higher**
* Tested up to **5.4.16**
* Languages
  See all 6

  Close

  [English (US)](https://wordpress.org/plugins/wp-invoice/), [Italian](https://it.wordpress.org/plugins/wp-invoice/), [Russian](https://ru.wordpress.org/plugins/wp-invoice/), [Spanish (Mexico)](https://es-mx.wordpress.org/plugins/wp-invoice/), [Spanish (Spain)](https://es.wordpress.org/plugins/wp-invoice/), and [Spanish (Venezuela)](https://ve.wordpress.org/plugins/wp-invoice/).

  [Translate into your language](https://translate.wordpress.org/projects/wp-plugins/wp-invoice)
* [Advanced View](https://wordpress.org/plugins/wp-invoice/advanced/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from www.pritect.net_e765e38c_20250124_115130.html ===


[Skip to content](#site-content)
# [Pritect Network](https://www.pritect.net/)

WordPress Security Solutions

Menu

* [Home](http://www.pritect.net/)
* [Contact](https://www.pritect.net/contact)

[Home](https://www.pritect.net/) » WP-Invoice < 4.1.1 Multiple Security Vulnerabilities

# WP-Invoice < 4.1.1 Multiple Security Vulnerabilities

by [James Golovich](https://www.pritect.net/blog/author/james)

February 3, 2016

The [WP-Invoice plugin](https://www.usabilitydynamics.com/product/wp-invoice) from [Usability Dynamics, Inc.](https://www.usabilitydynamics.com/) contains several security vulnerabilities. The [wordpress.org](https://wordpress.org/plugins/wp-invoice/) stats claim there are 5,000+ active installs, so this is not a highly used plugin but anything that is related to billing/invoices always puts me on edge. If you use this plugin I encourage you to update immediately.

I only evaluated the free version of this plugin and did not look at any of their paid add-ons for vulnerabilities. I discovered three issues that were accessible to unauthenticated users and one issue that required a valid WordPress account.

## Unauthorized Setting Changes

Inside class\_core.php the function admin\_init() gets hooked to the [‘admin\_init’ WordPress action](https://codex.wordpress.org/Plugin_API/Action_Reference/admin_init) which is called when the admin files are loaded, not just when an account with administrator access is used.

Inside this function it takes user input and without verification updates the sites settings. This merges in the existing settings so by passing individual settings only those can be updated. This allows changing settings like the emailed templates, paypal email address, and various other scary parts.

[![wpinvoice_admin_init](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_admin_init.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_admin_init.png)

## Retrieving invoices of arbitrary users

I’m not sure this is the most critical of the flaws, but it does allow release of sensitive data and the invoice numbers can be used in the next vulnerability.

Here we have AJAX actions registered for logged in and not logged in users.

[![wpinvoice_load_invoices](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_load_invoices.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_load_invoices.png)

Upon first glance I thought this would allow only the current users invoices to be loaded.

[![wpinvoice_load_invoices1](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_load_invoices1.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_load_invoices1.png)

Upon further examination if the user is logged in then their invoice will be loaded, but if the user is not logged in $\_GET[‘wpi\_user\_id’] can be passed containing a WordPress numeric user\_id.

[![wpinvoice_load_invoices2](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_load_invoices2.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_load_invoices2.png)

## Updating previously invoiced users meta data

Through the magic of unauthenticated AJAX the ‘wpi\_gateway\_process\_payment’ actions can be called.

[![wpinvoice_process_payment](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_process_payment.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_process_payment.png)

The wpi\_gateway\_base::process\_payment() function takes user input in order to call the process\_payment() function in various payment gateway handlers.

[![wpinvoice_process_payment1](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_process_payment1.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_process_payment1.png)

In this case the ‘wpi\_paypal’, ‘wpi\_interkassa’, and ‘wpi\_twocheckout’ all allow this to happen. Below I’ll only show the ‘wpi\_paypal’ variation. This allows various type of the users meta data to be updated and if their CRM plugin is installed any of the attributes that are used in there can be updated.

[![wpinvoice_process_payment2](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_process_payment2.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_process_payment2.png)

## Privilege escalation of logged in users

Through the ‘wpi\_update\_user\_option’ AJAX action, a logged in user can pass arbitrary ‘meta\_key’ and ‘meta\_value’ that gets updated for their account. Many of these options are accessible to the user via their profile, but typically a user should not be able to modify their ‘wp\_capabilities’ or other potentially dangerous fields.

[![wpinvoice_update_option](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_update_option.png)](http://www.pritect.net/wp-content/uploads/2016/02/wpinvoice_update_option.png)

### Timeline

* 1/15/2016 11:28am Initial contact email sent
* 1/18/2016 3:14am Contact information received
* 1/19/2016 11:58am Full disclosure email sent
* 1/29/2016 6:23am Vendor responded saying issues were resolved in latest release

* [ajax](https://www.pritect.net/blog/tag/ajax)
* [wordpress](https://www.pritect.net/blog/tag/wordpress)
* [wordpress plugin](https://www.pritect.net/blog/tag/wordpress-plugin)

Post navigation
[Beaver Builder Lite and Pro < 1.7.1 Security Issue](https://www.pritect.net/blog/beaver-builder-1-7-1-security-issues)[WordPress Download Manager < 2.8.8 Critical Security Vulnerabilities](https://www.pritect.net/blog/wordpress-download-manager-2-8-8-critical-security-vulnerabilities)

#### Recent Posts

* [Advanced Custom Fields < 5.12.3 can allow unauthenticated users to upload arbitrary files](https://www.pritect.net/blog/advanced-custom-fields-5-12-3-can-allow-unauthenticated-users-to-upload-arbitrary-files)
* [Elementor Page Builder < 1.8 allows logged in users unrestricted editing](https://www.pritect.net/blog/elementor-page-builder-1-8-allows-logged-users-unrestricted-editing)
* [WordPress shortcode injection as an attack vector](https://www.pritect.net/blog/wordpress-shortcode-injection-attack-vector)
* [Ultimate Member < 1.3.84 allows executing arbitrary WordPress shortcodes](https://www.pritect.net/blog/ultimate-member-1-3-84-wordpress-shortcodes)
* [NinjaForms < 3.0.32 allows injecting arbitrary WordPress shortcodes](https://www.pritect.net/blog/ninjaforms-3-0-32-allows-injecting-arbitrary-wordpress-shortcodes)
#### Search

#### Donate to Pritect

Your donations keep us working on security issues!

![](https://www.paypalobjects.com/en_US/i/scr/pixel.gif)

#### Subscribe to our Newsletter

Receive information about new vulnerabilities and products.

First name

Last name

Email \*

* [Facebook](https://www.facebook.com/Pritect/)
* [Twitter](http://twitter.com/pritect)
* Email


