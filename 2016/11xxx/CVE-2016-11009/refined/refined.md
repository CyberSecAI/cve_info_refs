Based on the provided content, here's a breakdown of the vulnerabilities associated with WP-Invoice plugin versions prior to 4.1.1, as described in the blog post:

**Root Cause of Vulnerability:**
The primary root cause across multiple vulnerabilities stems from insufficient input sanitization and authorization checks within the WP-Invoice plugin's code, particularly in handling user-supplied data and AJAX requests.

**Weaknesses/Vulnerabilities Present:**

1.  **Unauthorized Setting Changes:**
    *   **Weakness:** The `admin_init()` function, hooked to the `admin_init` action, updates site settings based on user input without proper verification.
    *   **Vulnerability:** Unauthenticated users can modify sensitive settings such as email templates and PayPal email addresses by sending a crafted request.

2.  **Retrieving Invoices of Arbitrary Users:**
    *   **Weakness:** The AJAX action for loading invoices (`wpi_load_invoices`) does not properly validate the user ID when the user is not logged in.
    *  **Vulnerability:** An unauthenticated attacker can retrieve invoices belonging to any user by providing a valid `wpi_user_id` via the `_GET` parameter.

3.  **Updating Previously Invoiced Users Meta Data:**
    *   **Weakness:** The `wpi_gateway_process_payment` AJAX action, meant for processing payments, does not adequately sanitize user input before updating user meta data.
    *   **Vulnerability:**  Unauthenticated users can modify arbitrary user meta data through crafted AJAX requests by exploiting the `wpi_paypal`, `wpi_interkassa`, and `wpi_twocheckout` payment gateways. This includes potential CRM attribute manipulation.

4.  **Privilege Escalation of Logged-in Users:**
    *   **Weakness:** The `wpi_update_user_option` AJAX action allows logged-in users to update their user meta data without proper validation.
     *   **Vulnerability:** A logged-in user can modify their `wp_capabilities` and other dangerous fields, potentially granting themselves administrative privileges.

**Impact of Exploitation:**

*   **Unauthorized Setting Changes:** Attackers can take control of the plugin's settings, potentially leading to further compromise by, for example, redirecting payments or sending malicious emails using the compromised mail templates.
*   **Retrieving Invoices of Arbitrary Users:** Sensitive invoice data of any user can be exposed, violating user privacy and potentially revealing financial information.
*   **Updating Previously Invoiced Users Meta Data:** Attackers can modify user data, potentially leading to data corruption, account takeover, or further exploitation of connected CRM systems.
*   **Privilege Escalation of Logged-in Users:** Attackers can gain administrative access to the WordPress site by modifying their user capabilities.

**Attack Vectors:**

*   All vulnerabilities, except the privilege escalation one, can be exploited remotely by unauthenticated users.
*   The privilege escalation vulnerability requires a valid WordPress user account but does not require administrative privileges initially.

**Required Attacker Capabilities/Position:**

*   For unauthorized setting changes, retrieving invoices of arbitrary users, and updating user meta data:
    *   No prior access is needed. Attackers can exploit these vulnerabilities by sending crafted HTTP requests to the affected WordPress site.
*  For privilege escalation:
    *  A registered user account with basic access to the WordPress installation.

**Additional Notes:**

* The plugin was closed due to "Security Issue" as mentioned in the wordpress.org plugin directory page, confirming the severity of the identified vulnerabilities.
* The blog post indicates that the issues were addressed in the latest release after the researcher disclosed them to the plugin vendor.

This information provides a more detailed understanding of the vulnerabilities than the generic CVE description placeholder.