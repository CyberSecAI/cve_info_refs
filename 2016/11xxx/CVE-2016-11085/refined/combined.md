=== Content from security.dxw.com_fb30f653_20250125_062354.html ===


[# dxw advisories](https://advisories.dxw.com)

Menu

* [Advisories](/advisories/)
* [Plugins](/plugins/)
* [About](https://advisories.dxw.com/about/)

## Advisory:

# CSRF/stored XSS in Quiz And Survey Master (Formerly Quiz Master Next) allows unauthenticated attackers to do almost anything an admin can

## Vulnerability

Last revised: December 7, 2016

A CSRF vulnerability allows an unauthenticated attacker to add questions to existing quizzes.

The question\_name parameter is put into a manually-constructed JavaScript object and escaped with esc\_js() (php/qmn\_options\_questions\_tab.php line 499). If the user (or attacker) creates a new question on a quiz containing “<script>alert(1)</script>” in the question\_name field then “question: ‘&lt;script&gt;alert(1)&lt;/script&gt;’,” will get output inside the JS object. All good so far.

However, in js/admin\_question.js on line 205, we see this line, as part of some JS-generated HTML:

```
jQuery('<textarea/>').html(questions_list[i].question.replace(/"/g, '"').replace(/'/g, "'")).text()+
```

This looks okay. We’re creating a TEXTAREA element, setting its HTML to the value of the question\_name parameter, and extracting the .text() of it. If we did jQuery(‘<textarea/>’).html(‘<script>alert(1)</script>’).text() we would get “alert(1)” as the output.

However, that’s not how inline JavaScript gets parsed. Between a <script> and a </script>, the HTML parser actually parses “&lt;” as “&lt;” not as “<“. So if we do jQuery(‘<textarea/>’).html(‘&lt;script&gt;alert(1)&lt;/script&gt;’).text() we get “<script>alert(1)</script>”.

And since “<script>alert(1)</script>” doesn’t appear anywhere in the page, Chrome’s reflected XSS mitigation measures are not activated. Thus the stored XSS attack can be executed immediately.

Current state:
 Fixed

## CVSS Summary

CVSS base scores for this vulnerability
| Score 5.8 Medium | |
| --- | --- |
| Vector | Network |
| Complexity | Medium |
| Authentication | None |
| Confidentiality | Partial |
| Integrity | Partial |
| Availability | None |

You can read more about CVSS base scores on [Wikipedia](http://en.wikipedia.org/wiki/CVSS) or in the [CVSS specification](http://www.first.org/cvss/cvss-guide).

## Proof of concept

Click the submit button on the following page (in a real attack the form can be submitted without user interaction):

```
<form method="POST" action="http://localhost/wp-admin/admin.php?page=mlw_quiz_options&quiz_id=1">
<input type="text" name="question_type" value="0">
<input type="text" name="question_name" value="&lt;script>alert(1)&lt;/script>">
<input type="text" name="question_submission" value="new_question">
<input type="text" name="quiz_id" value="1">
<input type="submit">
</form>
```

## Advisory timeline

* 2015-09-14: Discovered
* 2016-12-07: Reported to vendor via https://quizandsurveymaster.com/contact-us/
* 2016-12-07: Requested CVE
* 2016-12-13: Vendor replied
* 2016-12-14: Vendor reported issue fixed in version 4.7.9
* 2016-12-15: Advisory published
* 2017-09-29: Requested CVE

## Mitigation/further actions

Upgrade to version 4.7.9 or later.

Discovered by:
Mallory Adams and dxwsupport
Advisory ID:
dxw-2015-2500
CVE:
Awaiting assignment
Component/package:
Quiz And Survey Master (Formerly Quiz Master Next)
Homepage:
[Quiz And Survey Master (Formerly Quiz Master Next)](https://wordpress.org/plugins/quiz-master-next/)
Version:
4.5.4,4.7.8

##### Contact

dxw advisories
Studio 1.05c
4 The Boulevard
Leeds,
LS10 1PZ

Call us on 0345 257 7520
contact@dxw.com

##### Services

* [Plugin reviews](https://advisories.dxw.com/about/plugin-reviews/)
* [Plugin inspections](https://advisories.dxw.com/about/plugin-inspections/)
* [Responsible disclosure policy](https://advisories.dxw.com/disclosure/)
* [Terms of service](https://advisories.dxw.com/terms/)

##### Github

* [Whippet](https://github.com/dxw/whippet)
* [2FA Plugin](https://github.com/dxw/2fa)
* [Iguana](https://github.com/dxw/iguana)

##### More from dxw

* [dxw](https://www.dxw.com)
* [Tradecraft](https://www.tradecraft.com/)

---

[![UKAS logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ukas.svg)](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ukas.svg)
![Government Procurement Service](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ccs-certificate.png)
[![Cyber Essentials logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ce-mark.png)](https://registry.blockmarktech.com/certificates/fe6a3790-9019-4df0-8d32-f894397b03d2/)
[![Cyber Essentials Plus logo](https://advisories.dxw.com/wp-content/themes/dxw-security-2017/static/img/ce-plus-mark.png)](https://registry.blockmarktech.com/certificates/ced635fc-ba0c-4e59-905c-508dd66dff1b/)

* [Bluesky

  Bluesky](https://bsky.app/profile/dxw.bsky.social)
* [Facebook

  Facebook](https://www.facebook.com/thedxw/)
* [LinkedIn

  LinkedIn](https://www.linkedin.com/company/dxw)
* [GitHub

  GitHub](https://github.com/dxw)

© 2008 – 2025. The Dextrous Web Ltd, trading as dxw. “dxw” is a registered trademark. All rights reserved. The Dextrous Web Ltd is a company registered in England & Wales, No. 6617101. Registered address Studio 1.05c, 4 The Boulevard, Leeds, LS10 1PZ.


