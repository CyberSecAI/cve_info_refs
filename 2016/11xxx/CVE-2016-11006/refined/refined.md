Based on the provided content, here's a breakdown of the vulnerabilities associated with WP-Invoice plugin (versions < 4.1.1) which are likely related to CVE-2016-11006:

**Root Cause of Vulnerability:**

*   **Insufficient Input Validation and Sanitization:** The plugin fails to properly validate and sanitize user inputs before using them in database queries and settings updates.
*   **Insecure AJAX Actions:**  The plugin registers AJAX actions that are accessible to unauthenticated users and do not properly verify user authorization, allowing them to perform privileged operations.
*   **Lack of Access Control:** The plugin lacks proper access control mechanisms, allowing unauthorized users to access sensitive information and modify user data.

**Weaknesses/Vulnerabilities Present:**

1.  **Unauthorized Setting Changes:**
    *   **Vulnerability:** Unauthenticated users can modify the plugin's settings by sending a crafted request to the `admin_init` function.
    *   **Technical Detail:** The `admin_init()` function is hooked to the WordPress 'admin_init' action, which is called when admin files are loaded, regardless of user authentication. It directly merges user-provided input with existing settings.
    *   **Impact:** Attackers can alter critical settings, such as email templates and PayPal email addresses, potentially leading to phishing attacks or financial manipulation.
2.  **Retrieving Invoices of Arbitrary Users:**
    *   **Vulnerability:**  Unauthenticated users can retrieve invoices of arbitrary users by providing a user ID via the `wpi_user_id` parameter in the AJAX request to the `wpi_load_invoices` action.
    *   **Technical Detail:** The `wpi_load_invoices` AJAX action uses the `$_GET['wpi_user_id']` value without checking if the user is logged in. If not logged in, it retrieves invoices for the given user id.
    *   **Impact:** Attackers can access sensitive user data, including invoice details, potentially leading to information disclosure and further attacks.
3.  **Updating Meta Data of Previously Invoiced Users:**
    *   **Vulnerability:**  Unauthenticated users can update the metadata of previously invoiced users by calling the `wpi_gateway_process_payment` AJAX action.
    *   **Technical Detail:** The `wpi_gateway_process_payment` AJAX action passes user input to the `process_payment()` function in payment gateway handlers (`wpi_paypal`, `wpi_interkassa`, `wpi_twocheckout`), allowing attackers to modify user metadata associated with the invoice.
    *   **Impact:** Attackers can modify user data, potentially including CRM data, leading to manipulation of user profiles or other malicious activities.
4.  **Privilege Escalation of Logged-in Users:**
    *   **Vulnerability:** Logged-in users can escalate their privileges by using the `wpi_update_user_option` AJAX action.
    *   **Technical Detail:** The  `wpi_update_user_option` action allows logged-in users to update arbitrary meta keys and values for their user accounts.
    *   **Impact:** Attackers can modify user capabilities by setting the `wp_capabilities` option, leading to privilege escalation and administrative access.

**Impact of Exploitation:**

*   **Data Breaches:** Unauthorized access to invoices and user data, leading to potential exposure of sensitive information.
*   **Financial Manipulation:** Modification of payment settings and email templates to redirect payments or carry out phishing attacks.
*   **Account Takeovers:** Privilege escalation leading to unauthorized access to administrative functions on the affected website.
*   **Website Compromise:** Ability to modify website settings or user data, leading to potential site defacement, malware injection, or data loss.

**Attack Vectors:**

*   **HTTP GET/POST Requests:** Vulnerabilities are exploited via crafted HTTP GET/POST requests to specific AJAX endpoints.
*   **Unauthenticated Access:** Most vulnerabilities can be exploited without authentication (except privilege escalation), making them easily accessible to attackers.
*   **AJAX Actions:** The vulnerabilities are triggered through insecure AJAX actions registered within the plugin.

**Required Attacker Capabilities/Position:**

*   **Basic HTTP Request Knowledge:** Attackers need to be able to craft and send HTTP requests to the vulnerable endpoints.
*   **No Prior Authentication:** Attackers do not require any initial authentication for most of the vulnerabilities, making them accessible from anywhere on the web.
*   **Knowledge of Plugin's AJAX Actions:** Attackers need to be aware of the vulnerable AJAX action endpoints (`admin_init`, `wpi_load_invoices`, `wpi_gateway_process_payment`, `wpi_update_user_option`).

**Additional Information**
*   The plugin was closed on April 27, 2022, due to security issues.
*   The vulnerabilities were addressed in version 4.1.1 of the plugin