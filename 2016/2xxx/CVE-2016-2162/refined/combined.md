=== Content from struts.apache.org_38efe21b_20250125_005354.html ===


[Log in](https://cwiki.apache.org/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-030)
[Skip to sidebar](#nav-sidebar)
[Skip to main content](#main)
Linked ApplicationsLoading...[Apache Software Foundation](/confluence/)

* [Spaces](/confluence/spacedirectory/view.action "Spaces")

* Hit enter to search
* Help
  + [Online Help](https://docs.atlassian.com/confluence/docs-719/ "Visit the Confluence documentation home")
  + [Keyboard Shortcuts](/confluence "View available keyboard shortcuts")
  + [Feed Builder](/confluence/dashboard/configurerssfeed.action "Create your custom RSS feed.")
  + [What’s new](https://docs.atlassian.com/confluence/docs-719/help.whats.new.iframe.link)
  + [What’s new](https://confluence.atlassian.com/display/DOC/Confluence%2B7.19%2BRelease%2BNotes)
  + [Available Gadgets](/confluence "Browse gadgets provided by Confluence")
  + [About Confluence](/confluence/aboutconfluencepage.action "Get more information about Confluence")
* * [Log in](/confluence/login.action?os_destination=%2Fdisplay%2FWW%2FS2-030)

[![Apache Struts 2 Wiki](/confluence/images/logo/default-space-logo.svg)](/confluence/display/WW/Home "Apache Struts 2 Wiki")[Apache Struts 2 Wiki](/confluence/display/WW/Home "Apache Struts 2 Wiki")
##### Child pages

* [Security Bulletins](/confluence/display/WW/Security%2BBulletins "Security Bulletins")

* S2-030
Browse pagesConfigureSpace tools

* + [Attachments (0)](/confluence/pages/viewpageattachments.action?pageId=62687301 "View Attachments")
  + [Page History](/confluence/pages/viewpreviousversions.action?pageId=62687301)
  + [Resolved comments](/confluence)
  + [Page Information](/confluence/pages/viewinfo.action?pageId=62687301)
  + [View in Hierarchy](/confluence/pages/reorderpages.action?key=WW&openId=62687301#selectedPageInHierarchy)
  + [View Source](/confluence/plugins/viewsource/viewpagesrc.action?pageId=62687301)
  + [Delete comments](/confluence/plugins/aptis/deleteAllComments/ask-user.action?pageId=62687301)
  + [Export to PDF](/confluence/spaces/flyingpdf/pdfpageexport.action?pageId=62687301)
  + [Export to Word](/confluence/exportword?pageId=62687301)
  + [Copy Page Tree](/confluence/plugins/tree-copy/preparing-copying.action?pageId=62687301)

1. [Pages](/confluence/collector/pages.action?key=WW)- [Home](/confluence/display/WW/Home)- [Security Bulletins](/confluence/display/WW/Security%2BBulletins)

* Jira links
# [S2-030](/confluence/display/WW/S2-030)

* Created by  [Lukasz Lenart](/confluence/display/~lukaszlenart), last modified on [Mar 18, 2016](/confluence/pages/diffpagesbyversion.action?pageId=62687301&selectedPageVersions=4&selectedPageVersions=5 "Show changes")

## Summary

Possible XSS vulnerability in `I18NInterceptor`

| Who should read this | All Struts 2 developers and users |
| --- | --- |
| Impact of vulnerability | Possible XSS vulnerability |
| Maximum security rating | Low |
| Recommendation | Do not expose parts of `Locale` object constructed by `I18NInterceptor` as it may contain user specific string which may leads to XSS vulnerability. Alternatively upgrade to [Struts 2.3.28](/confluence/display/WW/Version%2BNotes%2B2.3.28). |
| Affected Software | Struts 2.0.0 - Struts Struts 2.3.24.1 |
| Reporter | Paolo Perliti paolo dot perliti at miliaris dot it - [Miliaris](http://www.miliaris.it/) |
| CVE Identifier | CVE-2016-2162 |

## Problem

The Apache Struts framework uses `I18NInterceptor` to allow users and developers switch language used in the framework and an application built on top of it. The problem is that the interceptor doesn't perform any validation of the user input and accept arbitrary string which can be used by a developer to display language selected by the user. However, the framework doesn't expose the value directly in UI.

## Solution

If you want present language selected by user based on `I18NInterceptor` always escape the string before presenting it to the user. Alternatively upgrade to Struts 2.3.28.

## Backward compatibility

No issues expected when upgrading to Struts 2.3.28.

## Workaround

When needed you can use [StringEscapeUtils](https://commons.apache.org/proper/commons-lang/javadocs/api-3.4/org/apache/commons/lang3/StringEscapeUtils.html) from the Apache Commons to escape the string.

* No labels

Overview
Content Tools
Apps

Powered by a free **Atlassian Confluence Open Source Project License** granted to Apache Software Foundation. [Evaluate Confluence today](https://www.atlassian.com/software/views/opensource-community-additional-license-offer).

* Powered by [Atlassian Confluence](https://www.atlassian.com/software/confluence) 7.19.30
* Printed by Atlassian Confluence 7.19.30
* [Report a bug](https://support.atlassian.com/confluence-server/)
* [Atlassian News](https://www.atlassian.com/company)

[Atlassian](https://www.atlassian.com/)

{"serverDuration": 69, "requestCorrelationId": "b7aa1771b0f94dc5"}

