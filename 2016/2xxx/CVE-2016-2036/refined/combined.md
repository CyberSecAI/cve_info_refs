=== Content from github.com_6187e119_20250125_074808.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fud2%2Fadvisories%2Ftree%2Fmaster%2Fandroid%2Fsamsung%2Fnocve-2016-0001)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fud2%2Fadvisories%2Ftree%2Fmaster%2Fandroid%2Fsamsung%2Fnocve-2016-0001)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Ffiles%2Fdisambiguate&source=header-repo&source_repo=ud2%2Fadvisories)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ud2](/ud2)
/
**[advisories](/ud2/advisories)**
Public

* [Notifications](/login?return_to=%2Fud2%2Fadvisories) You must be signed in to change notification settings
* [Fork
  66](/login?return_to=%2Fud2%2Fadvisories)
* [Star
   169](/login?return_to=%2Fud2%2Fadvisories)

* [Code](/ud2/advisories)
* [Issues
  4](/ud2/advisories/issues)
* [Pull requests
  0](/ud2/advisories/pulls)
* [Actions](/ud2/advisories/actions)
* [Projects
  0](/ud2/advisories/projects)
* [Wiki](/ud2/advisories/wiki)
* [Security](/ud2/advisories/security)
* [Insights](/ud2/advisories/pulse)

Additional navigation options

* [Code](/ud2/advisories)
* [Issues](/ud2/advisories/issues)
* [Pull requests](/ud2/advisories/pulls)
* [Actions](/ud2/advisories/actions)
* [Projects](/ud2/advisories/projects)
* [Wiki](/ud2/advisories/wiki)
* [Security](/ud2/advisories/security)
* [Insights](/ud2/advisories/pulse)

## Files

 master
## Breadcrumbs

1. [advisories](/ud2/advisories/tree/master)
2. /[android](/ud2/advisories/tree/master/android)
3. /[samsung](/ud2/advisories/tree/master/android/samsung)
/
# nocve-2016-0001

/Copy path
## Directory actions

## More options

## Directory actions

## More options

## Latest commit

## History

[History](/ud2/advisories/commits/master/android/samsung/nocve-2016-0001) master
## Breadcrumbs

1. [advisories](/ud2/advisories/tree/master)
2. /[android](/ud2/advisories/tree/master/android)
3. /[samsung](/ud2/advisories/tree/master/android/samsung)
/
# nocve-2016-0001

/Top
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| parent directory[..](/ud2/advisories/tree/master/android/samsung) | | |
| [README.md](/ud2/advisories/blob/master/android/samsung/nocve-2016-0001/README.md "README.md") | | [README.md](/ud2/advisories/blob/master/android/samsung/nocve-2016-0001/README.md "README.md") |  |  |
| [secnetfilter-crash1.txt](/ud2/advisories/blob/master/android/samsung/nocve-2016-0001/secnetfilter-crash1.txt "secnetfilter-crash1.txt") | | [secnetfilter-crash1.txt](/ud2/advisories/blob/master/android/samsung/nocve-2016-0001/secnetfilter-crash1.txt "secnetfilter-crash1.txt") |  |  |
| View all files | | |

## [README.md](#readme)

# URL filtering in kernel land: what could possibly go wrong?

* *Authors*: Roberto Paleari ([@rpaleari](https://twitter.com/rpaleari)) and Aristide Fattori ([@joystick](https://twitter.com/joystick))
* *ID*: CVE-2016-2036
* *Samsung ID*: [SVE-2016-5036](http://security.samsungmobile.com/smrupdate.html#SMR-FEB-2016)
* *Notification date*: 20/10/2015
* *Release date*: 20/01/2016

While looking at the Samsung Android kernel, we stumbled into a custom module
named `secfilter`. This module captured our attention right from its
initalization routine, where some Netfilter hooks are promptly registered:

```
...
static struct nf_queue_handler sec_url_queue_handler = {
	.name = SEC_MODULE_NAME,
	.outfn = sec_url_filter_slow
};

static struct nf_hook_ops sec_url_filter = {
	.hook       = sec_url_filter_hook,
	.pf         = PF_INET,
	.hooknum    = NF_INET_LOCAL_OUT,
	.priority   = NF_IP_PRI_FIRST
	};

static struct nf_hook_ops sec_url_recv_filter = {
	.hook       = sec_url_filter_recv_hook,
	.pf         = PF_INET,
	.hooknum    = NF_INET_LOCAL_IN,
	.priority   = NF_IP_PRI_FIRST
};
...
if ((add_send_hook =nf_register_hook( &sec_url_filter)) <0) break;
if (nf_register_hook( &sec_url_recv_filter) <0) break;
...
nf_register_queue_handler(PF_INET, &sec_url_queue_handler);
...

```

These hooks are configured to intercept all incoming (`NF_INET_LOCAL_IN`) and
outgoing (`NF_INET_LOCAL_OUT`) packets. After being intercepted, outgoing TCP
packets that match certain criteria eventually reach an internal function named
`getURL()` which (surprise!) checks whether the TCP data resembles an HTTP
request, and parses the contained URL.

So why Samsung put an URL parser in the Android kernel? Well, this is part of a
mechanism accessible from a user-space application. Possible use cases include
parental control apps, which need to implement system-wide URL filtering.

## But how it works?

Netfilter hooks are always present, but the URL filtering mechanism is enabled
only after a proper `ioctl()` request issued to user-space device
`/dev/url/`. On our test phones, this device is accessible members of the
`secnetfilter` group:

```
shell@hlte:/ $ ls -l /dev/url
crw-rw---- secnetfilter secnetfilter 226,   0 2014-01-04 19:36 url

```

In turn, access to the `secnetfilter` group is granted to applications via the
`com.sec.android.SAMSUNG_GET_URL` permission, created with protection level
`signature`. An App with this permission can thenconfigure the device to enable
different monitoring modes:

* `FILTER_MODE_ON_BLOCK`: standard blocking mode, URLs are checked on outgoing
  packets and eventually blocked.
* `FILTER_MODE_ON_RESPONSE`: alternative blocking mode, URLs are extracted from
  outgoing packets, but responses are blocked and replaced with a custom
  HTTP/404 message.
* `FILTER_MODE_ON_BLOCK_REFER`: similar to `FILTER_MODE_ON_BLOCK`, but checks
  the `Referer` header rather than the requested URL.
* `FILTER_MODE_ON_RESPONSE_REFER`: similar to `FILTER_MODE_ON_RESPONSE`, but
  checks the `Referer` header rather than the requested URL.

If any of the blocking modes is enabled, then each visited URL is put in a
queue and blocked until the App unblocks it.

To wrap up, an App that wants to use the URL filtering feature should implement
the following logic:

1. First, the App enables one of the blocking modes available, for example by
   writing the following binary data to `/dev/url`:

   `<2-byte ver (0x00)><4-byte SET_FILTER_MODE cmd (0x01)><4 byte mode>`
2. Then, the App polls on `/dev/url` until some data is available for
   reading. Read data has the following format:

   `<4-byte header><4-byte blocked URL ID><4 irrelevant bytes><4-byte URL length><n-byte URL>`
3. Finally, the App checks the URL, takes a decision according to some
   application-specific logics, and communicates the decision to the driver,
   writing the following bytes on `/dev/url`:

   `<2-byte ver (0x00)><4-byte SET_USER_SELECT cmd (0x01)><4-byte URL ID><4-byte choice (0x64 for block, 0xx65 for allow)>`

The kernel module reads integers from the buffer through direct dereferences
(e.g., `filterMode = *(int *)data`), so data must be in little-endian
format. When the kernel module receives a `SET_USER_SELECT` command, it checks
if the received ID corresponds to a blocked request (i.e., to a blocked TCP
flow) and acts on it, according to the App decision.

We currently identified only a single application which uses this permission,
namely
[`com.symantec.familysafety`](https://play.google.com/store/apps/details?id=com.symantec.familysafety),
thus the whole URL filtering mechanism is probably not so widespread, or maybe
it is still at an early stage of its development.

## Security implications

As discussed before, it is true that only applications signed by Samsung (and
installed exclusively through the Samsung App store) can obtain the
`SAMSUNG_GET_URL` permission, yet this kernel module should raise the concerns
of more than one privacy-aware Samsung users. It can be certainly wrapped in a
"*child protection*" coat, but it still is a module that allows an "authorized"
App to monitor any visited URL.

Anyway, besides ethical and privacy-related considerations, this module is
quite worrisome even from a merely technical perspective. Indeed, after the URL
filtering mechanism has been activated by an "authorized" App, any user-space
application can then trigger a NULL pointer dereference in the HTTP parsing
code, and crash the system.

To trigger the bug, it is simply enough to issue an HTTP request with no URL,
such as (see [this](/ud2/advisories/blob/master/android/samsung/nocve-2016-0001/secnetfilter-crash1.txt) file):

```
GET  HTTP/1.1
Host: www.google.com

```

The actual destination of such a request is irrelevant, as all the outgoing
HTTP traffic is inspected when URL filtering is enabled.

Technically speaking, Samsung releases the source code of its Android kernels
through its ["Open Source Release Center"](http://opensource.samsung.com/). For
the NULL pointer dereference outlined above, the vulnerable code lies in
`drivers/secfilter/urlparser.c`, function `getURL()`. In a nutshell, the module
extracts the HTTP request path through the following call:

```
findStringByTag(node, &(node->url), dataStart, " HTTP/");

```

Where `dataStart` is a char string pointing right after the HTTP request method
token. However, when `findStringByTag()` processes the malformed request above
it finds a zero-length string for the HTTP path, and leaves `node->url`
uninitialized. Few lines after, `node->url` is dereferenced while still NULL.

## Affected devices

We confirm this issue affects the following device models. Other models and
firmware versions are probably affected as well, but they were not tested.

* SM-N9005, build N9005XXUGBOB6 (Note 3)
* SM-G920F, build G920FXXU2COH2 (Galaxy S6)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from twitter.com_2088dc6a_20250126_072202.html ===



=== Content from twitter.com_c38cf83c_20250126_072202.html ===


