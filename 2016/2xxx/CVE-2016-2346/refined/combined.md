=== Content from adamcaudill.com_3d4a70ad_20250125_140535.html ===

# [Adam Caudill](https://adamcaudill.com/)

*Security Leader, Researcher, Developer, Writer, & Photographer*

* [Home](https://adamcaudill.com/)
* [Blog](https://adamcaudill.com/blog/)
* [Research](https://adamcaudill.com/research/)
* [Speaking](https://adamcaudill.com/speaking/)
* [Photography](https://adamcaudill.com/photography/)
* [Writing](https://adamcaudill.com/writing/)
* [About](https://adamcaudill.com/about/)
# PL/SQL Developer: Nonexistent Encryption

February 2, 2016
|
4 minute read
|
[Security Research](https://adamcaudill.com/categories/security-research)

![](https://adamcaudill.com/header_images/broken-2.jpg)Table of Contents

1. [The Algorithm](#the-algorithm)
2. [The Data](#the-data)
3. [The Proof of Concept](#the-proof-of-concept)
4. [Credit](#credit)

*(See [here](https://adamcaudill.com/2016/05/01/plsql-developer-http-to-command-execution/) for another issue discovered during this research; Updates over HTTP & Command Execution.)*

PL/SQL Developer by [Allround Automations](https://www.allroundautomations.com/plsqldev.html) has an option to store the user’s logon history with passwords – the passwords are encrypted with a proprietary algorithm. At this point, you should know how this is going to go.

For those that don’t know, PL/SQL Developer is a tool for developers and database administrators to access Oracle – an essential tool in many enterprise environments. Instead of using something that provides some actual security like [DPAPI](https://en.wikipedia.org/wiki/Data_Protection_API) (which itself is far from perfect, as we saw with the [UPEK fiasco](https://adamcaudill.com/2012/10/07/upek-windows-password-decryption/)), they opted to use a proprietary “encryption” algorithm to protect these passwords – making it trivial to recover the passwords for any attacker that can access the preferences file(s).

Some time ago I asked the vendor about the security of the password storage – they are aware of the lack of security, but don’t make it clear to their customers.

```
From: Allround Automations Support [support@allroundautomations.com]
Sent: Monday, February 09, 2015 12:37 PM
To: Adam Caudill
Subject: RE: PL/SQL Developer - Password Storage

Hello Adam,

The encryption is proprietary. If a user copies the config file,
the passwords are also copied, so it's not secure.

Greetings,
Marco Kalter
Allround Automations (https://www.allroundautomations.com)
```

The fact that they are aware that it isn’t secure, yet this issue has existed for years – nor made it clear to users what they are risking by activating the option is extremely disappointing. Vendors have a responsibility to protect customer information, and broken features like this completely ignore that.

## The Algorithm [#](#the-algorithm)

The encryption algorithm is quite simple, primarily consisting of a bit shift and xor – let’s take a closer look at how it works. The ciphertext produced looks like this:

`273645624572423045763066456443024120413041724566408044424900...`

The first group of four digits (`2736`) is the key – it’s generated based on the system uptime, producing an integer between 0 and 999, then 2,000 is added. This means that the key is has 1,000 possible values, or just under 10 bits. Of course, when you store the key with the encrypted data – key size really doesn’t matter.

After the key at the beginning, each group of four digits represents one byte – this simple code is all that’s needed to encrypt:

```
for (int i = 0; i < plaintext.Length; i++)
{
  var mask = plaintext[i] << 4;
  var n = (mask ^ (key + (i + 1)*10)) + 1000;

  ret += Convert.ToString(n).PadLeft(4, '0');
}
```

When you encrypt the string `user/password@server`, here’s what the encrypted data breaks down to:

* `2736` = Key
* `4562` = `u`
* `4572` = `s`
* `4230` = `e`
* `4576` = `r`
* `3066` = `/`
* `4564` = `p`
* `4302` = `a`
* `4120` = `s`
* `4130` = `s`
* `4172` = `w`
* `4566` = `o`
* `4080` = `r`
* `4442` = `d`
* `4900` = `@`
* `4190` = `s`
* `4328` = `e`
* `4194` = `r`
* `4076` = `v`
* `4390` = `e`
* `4160` = `r`

## The Data [#](#the-data)

The login information is stored in an INI-like file called `user.prefs` – under the headings of `[LogonHistory]` and `[CurrentConnections]`; storage of passwords is an option that is turned off by default, though storage of history is turned on by default. All data stored in these sections is encrypted using this method, so the presence of data in these sections does not necessarily mean that passwords are present.

These files can be stored in a number of locations (the latter are more common with older versions of the application):

* `C:\Users\<username>\AppData\Roaming\PLSQL Developer\Preferences\<username>\`
* `C:\Program Files\PLSQL Developer\Preferences\<username>\`
* `C:\Program Files (x86)\PLSQL Developer\Preferences\<username>\`

The data format for the two sections is somewhat different, in `[LogonHistory]`, the data is in the following format:

`<username>/<password>@<server>`

In `[CurrentConnections]`, the format is `<username>,<password>,<server>,,,`; the login can also be stored in `C:\Users\<username>\AppData\Roaming\PLSQL Developer\PLS-Recovery\*.cfg`, in this same format.

This encryption method is also used in other files, though in less predictable locations.

## The Proof of Concept [#](#the-proof-of-concept)

We have [released](https://github.com/adamcaudill/PLSQLDevPass/releases) a proof of concept tool to decrypt these logins, and as is typical, it’s [open source](https://github.com/adamcaudill/PLSQLDevPass). Simply run the executable from the command line, and it will search for the preference files and print any information it’s able to retrieve.

```
PL/SQL Developer: Password 'Decrypter'
  Copyright 2016 Adam Caudill & Brandon Wilson
  v1.0.0.0 - https://github.com/adamcaudill/PLSQLDevPass

Found 1 config files...
Result! 'user/password@server'
Done.
```

You can also pass in the name of a remote machine, and it will attempt to use the administrative (`c$`) share.

## Credit [#](#credit)

Special thanks to my frequent research partner, [Brandon Wilson](https://brandonw.net/), for his help with this project.

Adam Caudill

---

## Related Posts

* ### [PL/SQL Developer: HTTP to Command Execution](https://adamcaudill.com/2016/05/01/plsql-developer-http-to-command-execution/ "PL/SQL Developer: HTTP to Command Execution")

  While looking into PL/SQL Developer – a very popular tool for working with Oracle databases, to see how it encrypts passwords I noticed something interesting. When testing Windows applications, I make it a habit to have Fiddler running, to see if there is any interesting traffic – and in this case, there certainly was.
  PL/SQL Developer has an update mechanism which retrieves a file containing information about available updates to PL/SQL Developer and other components; this file is retrieved via HTTP, meaning that an attacker in a privileged network position could modify this file.
* ### [Ruby + GCM Nonce Reuse: When your language sets you up to fail…](https://adamcaudill.com/2016/09/19/ruby-gcm-nonce-reuse-language-sets-fail/ "Ruby + GCM Nonce Reuse: When your language sets you up to fail…")

  A couple hours ago, Mike Santillana posted to oss-security about a rather interesting find in Ruby’s OpenSSL library; in this case, the flaw is subtle – so much so that it’s unlikely that anyone would notice it, and it’s a matter of a seemingly insignificant choice that determines if your code is affected. When performing AES-GCM encryption, if you set the key first, then the IV, and you are fine – set the IV first, you’re in trouble.
* ### [Breaking the NemucodAES Ransomware](https://adamcaudill.com/2017/07/12/breaking-nemucodaes-ransomware/ "Breaking the NemucodAES Ransomware")

  The Nemucod ransomware has been around, in various incarnations, for some time. Recently a new variant started spreading via email claiming to be from UPS. This new version changed how files are encrypted, clearly in an attempt to fix its prior issue of being able to decrypt files without paying the ransom, and as this is a new version, no decryptor was available1. My friends at Savage Security contacted me to help save the data of one of their clients; I immediately began studying the cryptography related portions of the software, while the Savage Security team was busy looking at other portions.
* ### [Testing for SWEET32 with YAWAST](https://adamcaudill.com/2016/09/15/testing-sweet32-yawast/ "Testing for SWEET32 with YAWAST")

  Testing for SWEET32 isn’t simple – when the vulnerability was announced, some argued that the best solution was to assume that if a TLS server supported any of the 3DES cipher suites, consider it vulnerable. The problem is, it’s not that simple. On my employer’s corporate blog, I wrote about practical advice for dealing with SWEET32 – and pointed out that there are ways around the vulnerability, and some are quite simple.
* ### [When Hashing isn’t Hashing](https://adamcaudill.com/2016/05/23/when-hashing-isnt-hashing/ "When Hashing isn’t Hashing")

  Anyone working in application security has found themselves saying something like this a thousand times: “always hash passwords with a secure password hashing function.” I’ve said this phrase at nearly all of the developer events I’ve spoken at, it’s become a mantra of sorts for many of us that try to improve the security of applications. We tell developers to hash passwords, then we have to qualify it to explain that it isn’t normal hashing.

* [Rance, Goodbye Friend](https://adamcaudill.com/2016/01/08/rance-goodbye-friend/)
* [Crypto Crisis: Fear over Freedom](https://adamcaudill.com/2016/03/12/crypto-crisis-fear-over-freedom/)
#### About Me

![](https://1.gravatar.com/avatar/49e14cf9f67c48aad082dec4f106f19a?size=500)

Security researcher, engineer and software developer with more than 20 years of experience.

*Work:* I primarily focus on application security, usable security, secure communications, and cryptography. I build and lead strong and dynamic teams, who cover all facets of security and privacy.

*Writing:* I write about my research, security in general, development and software design, and leadership through my [blog](https://adamcaudill.com/blog/), [essays](https://adamcaudill.com/essays/), and various publications.
I also engage in some [creating writing](https://adamcaudill.com/writing/) when I can.

*Photography:* I am a purist fine art photographer, working primarily in black & white, and focused on sharing [new perspectives](https://photo.adamcaudill.com/perspective) of the world.
Limited edition prints of my work are available on my [online gallery](https://adamcaudill.pictorem.com/).
I also have a background in photojournalism, and volunteer in this field when I can.

[Contact](https://adamcaudill.com/contact/)

##### Disclaimer

Opinions expressed here are solely those of Adam Caudill, and do not represent the views of his employer, or any other person or entity.

##### Contact & Media

If you have any questions, please feel free to [contact me](https://adamcaudill.com/pgp/), I will try to respond as quickly as possible.

##### Copyright

Copyright © 2003 - 2024 Adam Caudill.



=== Content from www.kb.cert.org_6432549a_20250125_140534.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#229047

## Allround Automations PL/SQL Developer v11 performs updates over HTTP

#### Vulnerability Note VU#229047

Original Release Date: 2016-04-25 | Last Revised: 2016-05-02

---

### Overview

Allround Automations PL/SQL Developer version 11 checks for updates over HTTP and does not verify updates before executing commands, which may allow an attacker to execute arbitrary code.

### Description

| [**CWE-345**](https://cwe.mitre.org/data/definitions/345.html)**: Insufficient Verification of Data Authenticity** - CVE-2016-2346  According to the researcher, Allround Automations PL/SQL Developer version 11 periodically checks for updates over HTTP. When an update is available, PL/SQL Developer downloads the update and executes the update without verifying authenticity or performing other checks. By intercepting such requests and modifying the necessary fields, an attacker with a man-in-the-middle position between the victim and the network may be able write arbitrary data to vulnerable devices and execute arbitrary code with permissions of the PL/SQL Developer user.The researcher has published a [blog post](https://adamcaudill.com/2016/05/01/plsql-developer-http-to-command-execution/) with more information. |
| --- |

### Impact

| A remote attacker with a man-in-the-middle position may able to execute code with permissions of the PL/SQL Developer user. |
| --- |

### Solution

| **Apply an update**PL/SQL Developer version 11.0.6 has been released to address this issue. The update utility now uses HTTPS and restricts downloads to the allroundautomations.com domain.Affected users may also consider the following workaround: |
| --- |

| **Avoid untrusted networks**Avoid using untrusted networks, including public WiFi. Using your device on an untrusted network increases the chance of falling victim to a man-in-the-middle attack that could intercept your HTTP data. |
| --- |

### Vendor Information

229047
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23229047/) to view vendors.**
### [Allround Automations](#GWAN-A845UW) Affected

Notified:  March 16, 2016  Updated: April 25, 2016

**Statement Date:   April 19, 2016**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 7.5 | AV:N/AC:L/Au:N/C:P/I:P/A:P |
| Temporal | 6.4 | E:POC/RL:U/RC:UR |
| Environmental | 4.8 | CDP:ND/TD:M/CR:ND/IR:ND/AR:ND |

### References

<https://adamcaudill.com/2016/05/01/plsql-developer-http-to-command-execution/>

### Acknowledgements

Thanks to Adam Caudill for reporting this vulnerability.

This document was written by Garret Wassermann.

### Other Information

| **CVE IDs:** | [CVE-2016-2346](http://web.nvd.nist.gov/vuln/detail/CVE-2016-2346) |
| --- | --- |
| **Date Public:** | 2016-04-29 |
| **Date First Published:** | 2016-04-25 |
| **Date Last Updated:** | 2016-05-02 15:23 UTC |
| **Document Revision:** | 49 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


