=== Content from www.ntp.org_a9cc7a66_20250126_075243.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)
3. [4.2.8p7 Release Announcement](https://www.ntp.org/support/securitynotice/4_2_8p7-release-announcement/)

# 4.2.8p7 Release Announcement

Last update: June 28, 2022 21:06 UTC ([1f97faf40](https://git.nwtime.org/websites/ntpwww/commit/1f97faf40ebfcdfdee0201c3d607f8c2c9649d7b))

NTF’s NTP Project has been notified of the following 4 low- and 7 medium-severity vulnerabilities that are fixed in ntp-4.2.8p7, released on Tuesday, 26 April 2016:

* [3020: Refclock impersonation vulnerability](https://www.ntp.org/support/securitynotice/ntpbug3020/) / [CVE-2016-1551](https://nvd.nist.gov/vuln/detail/CVE-2016-1551) AKA: refclock-peering
  + Reported by Matt Street and others of Cisco ASIG
* [3012: Sybil vulnerability: ephemeral association attack](https://www.ntp.org/support/securitynotice/ntpbug3012/) / [CVE-2016-1549](https://nvd.nist.gov/vuln/detail/CVE-2016-1549) AKA: ntp-sybil - MITIGATION ONLY
  + Reported by Matthew Van Gundy of Cisco ASIG
* [3011: Duplicate IPs on unconfig directives will cause an assertion botch](https://www.ntp.org/support/securitynotice/ntpbug3011/) / [CVE-2016-2516](https://nvd.nist.gov/vuln/detail/CVE-2016-2516)
  + Reported by Yihan Lian of the Cloud Security Team, Qihoo 360
* [3010: Remote configuration trustedkey/requestkey values are not properly validated](https://www.ntp.org/support/securitynotice/ntpbug3010/) / [CVE-2016-2517](https://nvd.nist.gov/vuln/detail/CVE-2016-2517)
  + Reported by Yihan Lian of the Cloud Security Team, Qihoo 360
* [3009: Crafted addpeer with hmode > 7 causes array wraparound with MATCH\_ASSOC](https://www.ntp.org/support/securitynotice/ntpbug3009/) / [CVE-2016-2518](https://nvd.nist.gov/vuln/detail/CVE-2016-2518)
  + Reported by Yihan Lian of the Cloud Security Team, Qihoo 360
* [3008: ctl\_getitem() return value not always checked](https://www.ntp.org/support/securitynotice/ntpbug3008/) / [CVE-2016-2519](https://nvd.nist.gov/vuln/detail/CVE-2016-2519)
  + Reported by Yihan Lian of the Cloud Security Team, Qihoo 360
* [3007: Validate crypto-NAKs](https://www.ntp.org/support/securitynotice/ntpbug3007/) / [CVE-2016-1547](https://nvd.nist.gov/vuln/detail/CVE-2016-1547) AKA: nak-dos
  + Reported by Stephen Gray and Matthew Van Gundy of Cisco ASIG
* [2978: Interleave-pivot](https://www.ntp.org/support/securitynotice/ntpbug2978/) / [CVE-2016-1548](https://nvd.nist.gov/vuln/detail/CVE-2016-1548) - MITIGATION ONLY
  + Reported by Miroslav Lichvar of RedHat and separately by Jonathan Gardner of Cisco ASIG
* [2952: KoD fix: peer associations were broken by the fix for 2901](https://www.ntp.org/support/securitynotice/ntpbug2952/) / [CVE-2015-7704](https://nvd.nist.gov/vuln/detail/CVE-2015-7704) AKA: Symmetric active/passive mode is broken
  + Reported by Michael Tatarinov, NTP Project Developer Volunteer
* [2945](https://www.ntp.org/support/securitynotice/ntpbug2945/) / [2901: Zero Origin Timestamp Bypass](https://www.ntp.org/support/securitynotice/ntpbug2901/) / [CVE-2015-8138](https://nvd.nist.gov/vuln/detail/CVE-2015-8138) AKA: Additional KoD Checks
  + Reported by Jonathan Gardner of Cisco ASIG
* [2879: Improve NTP security against buffer comparison timing attacks, authdecrypt-timing](https://www.ntp.org/support/securitynotice/ntpbug2879/) / [CVE-2016-1550](https://nvd.nist.gov/vuln/detail/CVE-2016-1550) AKA: authdecrypt-timing
  + Reported independently by Loganaden Velvindron, and Matthew Van Gundy and Stephen Gray of Cisco ASIG.

The following issues already listed above are “Mitigation only” and are expected to be fully resolved in an upcoming release.

* [3012: Sybil vulnerability: ephemeral association attack](https://www.ntp.org/support/securitynotice/ntpbug3012/) - MITIGATION ONLY
* [2978: Interleave pivot](https://www.ntp.org/support/securitynotice/ntpbug2978/) - MITIGATION ONLY

The following issues were fixed in earlier releases and contain improvements in this p7 release:

* [2936: Skeleton Key](https://www.ntp.org/support/securitynotice/ntpbug2936/)
* [2901: Clients that receive a KoD should validate the origin timestamp field](https://www.ntp.org/support/securitynotice/ntpbug2901/)

---

**Timeline:**

* 2016 Apr 26: Public release
* 2016 Apr 18: CERT notified and pre-release patch availability announced to CERT
* 2016 Apr 12: [Early Access Program Release: Premier and Partner Institutional Members](https://www.nwtime.org/membership/benefits/)
* 2016 Feb 21: CVE numbers requested from Mitre
* 2016 Feb 19: Initial notification from Qihoo/360; analysis begins
* 2016 Feb 14: [Notification to Institutional Members](https://www.nwtime.org/membership/benefits/)
* 2016 Jan 12: Initial notification from Cisco; analysis begins

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)



=== Content from security.netapp.com_60c0e312_20250125_095146.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English
æ¥æ¬èª

[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [April 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products](https://security.netapp.com/advisory/ntap-20171004-0002)

## April 2016 Network Time Protocol Daemon (ntpd) Vulnerabilities in Multiple NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close ×

#### Subscribe to NTAP-20171004-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20171004-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close ×

#### Unsubscribe from NTAP-20171004-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20171004-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20171004-0002
**Version:**
5.0

**Last updated:**
01/28/2020

**Status:**
Final.

**CVEs:** CVE-2015-7704, CVE-2016-1548, CVE-2015-8138, CVE-2016-1549, CVE-2016-2516, CVE-2016-2517, CVE-2016-2519, CVE-2016-1550, CVE-2016-1547, CVE-2016-1551, CVE-2016-2518

Overview
#### Summary

Multiple NetAppÂ® products contain the Network Time Protocol daemon (ntpd). The Open NTP project (www.ntp.org) has released a Security Notice regarding vulnerabilities that affect versions before ntp-4.2.8p7. These vulnerabilities could allow an attacker to bypass security restrictions or cause a denial of service condition.

#### Impact

Exploitation of these vulnerabilities may lead to bypassed security restrictions or a denial of service condition.

Data ONTAP operating in 7-Mode is only affected by CVE-2015-8138.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2015-7704](https://nvd.nist.gov/vuln/detail/CVE-2015-7704) | 7.5 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H |
| [CVE-2015-8138](https://nvd.nist.gov/vuln/detail/CVE-2015-8138) | 5.3 (MEDIUM) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N |
| [CVE-2016-1547](https://nvd.nist.gov/vuln/detail/CVE-2016-1547) | 3.7 (LOW) | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L |
| [CVE-2016-1548](https://nvd.nist.gov/vuln/detail/CVE-2016-1548) | 7.2 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:N/I:L/A:L |
| [CVE-2016-1549](https://nvd.nist.gov/vuln/detail/CVE-2016-1549) | 5.3 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:L/UI:N/S:U/C:N/I:H/A:N |
| [CVE-2016-1550](https://nvd.nist.gov/vuln/detail/CVE-2016-1550) | 4.0 (MEDIUM) | CVSS:3.0/AV:L/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N |
| [CVE-2016-1551](https://nvd.nist.gov/vuln/detail/CVE-2016-1551) | 3.7 (LOW) | CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N |
| [CVE-2016-2516](https://nvd.nist.gov/vuln/detail/CVE-2016-2516) | 4.2 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2016-2517](https://nvd.nist.gov/vuln/detail/CVE-2016-2517) | 4.2 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H |
| [CVE-2016-2518](https://nvd.nist.gov/vuln/detail/CVE-2016-2518) | 2.0 (LOW) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:L |
| [CVE-2016-2519](https://nvd.nist.gov/vuln/detail/CVE-2016-2519) | 4.2 (MEDIUM) | CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <http://support.ntp.org/bin/view/Main/SecurityNotice#April_2016_ntp_4_2_8p7_Security>

Affected Products
#### Affected Products

* Clustered Data ONTAP
* Data ONTAP operating in 7-Mode
* OnCommand Balance
* OnCommand Performance Manager (Unified Manager Performance Pkg)
* OnCommand Unified Manager for Clustered Data ONTAP

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge
* Brocade Fabric Operating System Firmware
* Brocade Network Advisor Software
* Clustered Data ONTAP Antivirus Connector
* E-Series SANtricity Management Plug-ins (VMware vCenter)
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* FAS/AFF BIOS
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp Plug-in for Symantec NetBackup
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp Storage Encryption
* NetApp VASA Provider for Clustered Data ONTAP 7.2 and above
* OnCommand API Services
* OnCommand Cloud Manager
* OnCommand Insight
* OnCommand System Manager 9.x
* OnCommand Unified Manager for 7-Mode (core package)
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* RAID Controller CTS2600 Legacy Engenio
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID Webscale NAS Bridge
* StorageGRID9 (9.x and prior)
* System Setup
* Virtual Storage Console for VMware vSphere 7.2 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **OnCommand Performance Manager (Unified Manager Performance Pkg)** | <http://mysupport.netapp.com/NOW/download/software/oncommand_pm/2.1P1/> <http://mysupport.netapp.com/NOW/download/software/oncommand_pm_linux/2.1P1/> |
| **Data ONTAP operating in 7-Mode** | Data ONTAP operating in 7-Mode has no plans to address this vulnerability. |
| **OnCommand Balance** | OnCommand Balance has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMP1655122.html) for more information. |
| **OnCommand Unified Manager for Clustered Data ONTAP** | <http://mysupport.netapp.com/NOW/download/software/oncommand_cdot_win/6.4P1/> <http://mysupport.netapp.com/NOW/download/software/oncommand_cdot_lin/6.4P1/> <http://mysupport.netapp.com/NOW/download/software/oncommand_cdot/6.4P1/> |
| **Clustered Data ONTAP** | <https://mysupport.netapp.com/NOW/download/software/ontap/9.1/> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20171004-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20171004 | Initial Public Release |
| 2.0 | 20171020 | After additional review, NetApp VASA Provider for Clustered Data ONTAP moved from Affected Products to Products Not Affected |
| 3.0 | 20171129 | Clustered Data ONTAP added to Software Versions and Fixes |
| 4.0 | 20180122 | OnCommand Balance moved to Won't Fix status, Final status |
| 5.0 | 20200128 | Impact is updated for Data ONTAP operating in 7-Mode |

This document is provided solely for informational purposes. All information is based upon NetAppâs current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp. Â© 2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

 ©  NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from www.kb.cert.org_15dff26d_20250125_095146.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#718152

## NTP.org ntpd contains multiple vulnerabilities

#### Vulnerability Note VU#718152

Original Release Date: 2016-04-27 | Last Revised: 2016-04-28

---

### Overview

The NTP.org reference implementation of ntpd contains multiple vulnerabilities.

### Description

| NTP.org's reference implementation of NTP server, ntpd, contains multiple vulnerabilities.  [**CWE-294**](http://cwe.mitre.org/data/definitions/294.html)**: Authentication Bypass by Capture-replay -** CVE-2015-7973An attacker on the network can record and replay authenticated broadcast mode packets. Also known as the "Deja Vu" attack.[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2015-7974A missing key check allows impersonation between authenticated peers. Also known as the "Skeleton Key" attack.[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2015-7975The nextvar() function does not properly validate length.[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2015-7976ntpq saveconfig command allows dangerous characters in filenames[**CWE-476**](http://cwe.mitre.org/data/definitions/476.html)**: NULL Pointer Dereference -** CVE-2015-7977reslist NULL pointer dereference[**CWE-400**](http://cwe.mitre.org/data/definitions/400.html)**: Uncontrolled Resource Consumption ('Resource Exhaustion') -** CVE-2015-7978Stack exhaustion in recursive traversal of restriction list[**CWE-821**](http://cwe.mitre.org/data/definitions/821.html)**: Incorrect Synchronization -** CVE-2015-7979Off-path Denial of Service (DoS) attack on authenticated broadcast and other pre-emptable modes[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2015-8138Zero Origin Timestamp Bypass[**CWE-200**](http://cwe.mitre.org/data/definitions/200.html)**: Information Exposure -** CVE-2015-8139Network Time Protocol ntpq and ntpdc Origin Timestamp Disclosure Vulnerability<http://support.ntp.org/bin/view/Main/NtpBug2946>[**CWE-294**](http://cwe.mitre.org/data/definitions/294.html)**: Authentication Bypass by Capture-replay -** CVE-2015-8140Network Time Protocol ntpq Control Protocol Replay Vulnerability<http://support.ntp.org/bin/view/Main/NtpBug2947>[**CWE-400**](http://cwe.mitre.org/data/definitions/400.html)**: Uncontrolled Resource Consumption ('Resource Exhaustion') -** CVE-2015-8158Potential Infinite Loop in ntpq<http://support.ntp.org/bin/view/Main/NtpBug2948>[**CWE-821**](http://cwe.mitre.org/data/definitions/821.html)**: Incorrect Synchronization -** CVE-2016-1547An off-path attacker can deny service to ntpd clients by demobilizing preemptable associations using spoofed crypto-NAK packets. This vulnerability involves different code paths than those used by CVE-2015-7979.[**CWE-290**](http://cwe.mitre.org/data/definitions/290.html)**: Authentication Bypass by Spoofing -** CVE-2016-1548By spoofing packets from a legitimate server, an attacker can change the time of an ntpd client or deny service to an ntpd client by forcing it to change from basic client/server mode to interleaved symmetric mode.[**CWE-362**](http://cwe.mitre.org/data/definitions/362.html)**: Concurrent Execution using Shared Resource with Improper Synchronization ('Race Condition') -** CVE-2016-1549ntpd does not prevent Sybil attacks from authenticated peers. An malicious authenticated peer can create any number of ephemeral associations in order to win ntpd's clock selection algorithm and modify a victim's clock.[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2016-1550ntpd does not use a constant-time memory comparison function when validating the authentication digest on incoming packets. In some situations this may allow an attacker to conduct a timing attack to compute the value of the valid authentication digest causing forged packets to be accepted by ntpd.[**CWE-290**](http://cwe.mitre.org/data/definitions/290.html)**: Authentication Bypass by Spoofing -** CVE-2016-1551ntpd does not filter IPv4 bogon packets received from the network. This allows unauthenticated network attackers to spoof refclock packets to ntpd processes on systems that do not implement bogon filtering.[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2016-2516, CVE-2016-2517Duplicate IPs on unconfig directives will cause an assertion botch in ntpd. A regression caused by the patch for CVE-2016-2516 was fixed and identified as CVE-2016-2517.[**CWE-125**](http://cwe.mitre.org/data/definitions/125.html)**: Out-of-bounds Read -** CVE-2016-2518Using a crafted packet to create a peer association with hmode > 7 causes the MATCH\_ASSOC() lookup to make an out-of-bounds reference.[**CWE-119**](http://cwe.mitre.org/data/definitions/119.html)**: Improper Restriction of Operations within the Bounds of a Memory Buffer -** CVE-2016-2519ntpq and ntpdc can be used to store and retrieve information in ntpd. It is possible to store a data value that is larger than the size of the buffer that the ctl\_getitem() function of ntpd uses to report the return value. If the length of the requested data value returned by ctl\_getitem() is too large, the value NULL is returned instead. There are 2 cases where the return value from ctl\_getitem() was not directly checked to make sure it's not NULL, but there are subsequent INSIST() checks that make sure the return value is not NULL. There are no data values ordinarily stored in ntpd that would exceed this buffer length. But if one has permission to store values and one stores a value that is "too large", then ntpd will abort if an attempt is made to read that oversized value.[**CWE-20**](http://cwe.mitre.org/data/definitions/20.html)**: Improper Input Validation -** CVE-2015-7704**,** CVE-2015-7705An ntpd client that honors Kiss-of-Death (KoD) responses will honor KoD messages that have been forged by an attacker, causing it to delay or stop querying its servers for time updates. Also, an attacker can forge packets that claim to be from the target and send them to servers often enough that a server that implements KoD rate limiting will send the target machine a KoD response to attempt to reduce the rate of incoming packets, or it may also trigger a firewall block at the server for packets from the target machine. For either of these attacks to succeed, the attacker must know what servers the target is communicating with. An attacker can be anywhere on the Internet and can frequently learn the identity of the target's time source by sending the target a time query. For more information on these vulnerabilities, please see NTP.org's [April 2016 security advisory](http://support.ntp.org/bin/view/Main/SecurityNotice#April_2016_NTP_4_2_8p7_Security) as well as the [January 2016 security advisory](http://support.ntp.org/bin/view/Main/SecurityNotice#January_2016_NTP_4_2_8p6_Securit). |
| --- |

### Impact

| Unauthenticated remote attackers may be able to spoof packets to cause denial of service, authentication bypass on commands, or certain configuration changes. For more information on these vulnerabilities, please see NTP.org's [April 2016 security advisory](http://support.ntp.org/bin/view/Main/SecurityNotice#April_2016_NTP_4_2_8p7_Security) as well as the [January 2016 security advisory](http://support.ntp.org/bin/view/Main/SecurityNotice#January_2016_NTP_4_2_8p6_Securit). |
| --- |

### Solution

| **Apply an update**Partial patches for some of these issues were initially released in January 2016 as version 4.2.8p6. Complete patches for all of these issues are now available in version [4.2.8p7](http://www.ntp.org/downloads.html), released 2016-04-26. Affected users are encouraged to update as soon as possible. |
| --- |

### Vendor Information

718152
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23718152/) to view vendors.**
### [NTP Project](#BLUU-A6BKEJ) Affected

Notified:  January 19, 2016  Updated: April 22, 2016

**Statement Date:   April 19, 2016**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [ACCESS](#BLUU-A9CUD2) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [AT&T](#BLUU-A9CUDS) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Alcatel-Lucent](#BLUU-A9CUDN) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Apple](#BLUU-A9CUCA) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Arista Networks, Inc.](#BLUU-A9CUCS) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Aruba Networks](#BLUU-A9CUD7) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Avaya, Inc.](#BLUU-A9CUCY) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Belkin, Inc.](#BLUU-A9CUDA) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Blue Coat Systems](#BLUU-A9CUCK) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [CA Technologies](#BLUU-A9CUDQ) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [CentOS](#BLUU-A9CUDW) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Check Point Software Technologies](#BLUU-A9CUDG) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Cisco](#BLUU-A5YJQV) Unknown

Notified:  January 08, 2016  Updated: January 08, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [CoreOS](#BLUU-A9CUDK) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [D-Link Systems, Inc.](#BLUU-A9CUCG) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Debian GNU/Linux](#BLUU-A9CUCN) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [DesktopBSD](#BLUU-A9CUCV) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [DragonFly BSD Project](#BLUU-A9CUDE) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [EMC Corporation](#BLUU-A9CUEU) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [EfficientIP SAS](#BLUU-A9CUDU) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Enterasys Networks](#BLUU-A9CUF3) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Ericsson](#BLUU-A9CUFB) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Extreme Networks](#BLUU-A9CUJS) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [F5 Networks, Inc.](#BLUU-A9CUK8) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Fedora Project](#BLUU-A9CUFX) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Force10 Networks](#BLUU-A9CUEW) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [FreeBSD Project](#BLUU-A9CUFT) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Gentoo Linux](#BLUU-A9CUJK) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Google](#BLUU-A9CUHG) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Hardened BSD](#BLUU-A9CUK4) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Hewlett Packard Enterprise](#BLUU-A9CUGE) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Hitachi](#BLUU-A9CUKA) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Huawei Technologies](#BLUU-A9CUJD) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [IBM Corporation](#BLUU-A9CUER) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [IBM eServer](#BLUU-A9CUF6) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Infoblox](#BLUU-A9CUFZ) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Intel Corporation](#BLUU-A9CUGG) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Internet Systems Consortium](#BLUU-A9CUJB) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Internet Systems Consortium - DHCP](#BLUU-A9CUFM) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Juniper Networks](#BLUU-A9CUGX) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [McAfee](#BLUU-A9CUJQ) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Microsoft Corporation](#BLUU-A9CUFE) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [NEC Corporation](#BLUU-A9CUG3) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [NTPsec](#BLUU-A6BKEG) Unknown

Notified:  January 19, 2016  Updated: January 19, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [NetBSD](#BLUU-A9CUJ3) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Nokia](#BLUU-A9CUGC) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Nominum](#BLUU-A9CUJF) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [OmniTI](#BLUU-A9CUFR) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [OpenBSD](#BLUU-A9CUEN) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [OpenDNS](#BLUU-A9CUGR) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Openwall GNU/\*/Linux](#BLUU-A9CUJW) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Oracle Corporation](#BLUU-A9CUJ9) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Peplink](#BLUU-A9CUK6) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Q1 Labs](#BLUU-A9CUG5) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [QNX Software Systems Inc.](#BLUU-A9CUG8) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Red Hat, Inc.](#BLUU-A9CUGT) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [SUSE Linux](#BLUU-A9CUGV) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [SafeNet](#BLUU-A9CUJY) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Secure64 Software Corporation](#BLUU-A9CUJ6) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Slackware Linux Inc.](#BLUU-A9CUK2) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [SmoothWall](#BLUU-A9CUGP) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Snort](#BLUU-A9CUGZ) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Sony Corporation](#BLUU-A9CUHZ) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Sourcefire](#BLUU-A9CUH3) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Symantec](#BLUU-A9CUHM) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [TippingPoint Technologies Inc.](#BLUU-A9CUHT) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Turbolinux](#BLUU-A9CUHJ) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Ubuntu](#BLUU-A9CUH6) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Unisys](#BLUU-A9CUHP) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [VMware](#BLUU-A9CUHD) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Wind River](#BLUU-A9CUH9) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [dnsmasq](#BLUU-A9CUFP) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [m0n0wall](#BLUU-A9CUFK) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [openSUSE project](#BLUU-A9CUJU) Unknown

Notified:  April 25, 2016  Updated: April 25, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

View all 75 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 6.8 | AV:N/AC:M/Au:N/C:P/I:P/A:P |
| Temporal | 5.3 | E:POC/RL:OF/RC:C |
| Environmental | 5.3 | CDP:ND/TD:H/CR:ND/IR:ND/AR:ND |

### References

* <http://support.ntp.org/bin/view/Main/SecurityNotice#April_2016_NTP_4_2_8p7_Security>
* <http://support.ntp.org/bin/view/Main/SecurityNotice#January_2016_NTP_4_2_8p6_Securit>
### Acknowledgements

Thanks to Cisco TALOS for reporting many of these issues to us. The Network Time Foundation credits many researchers for these vulnerabilities; see NTP.org's January 2016 and April 2016 security advisories for the complete list.

This document was written by Garret Wassermann.

### Other Information

| **CVE IDs:** | [CVE-2015-7704](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7704), [CVE-2015-7705](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7705), [CVE-2015-7973](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7973), [CVE-2015-7974](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7974), [CVE-2015-7975](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7975), [CVE-2015-7976](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7976), [CVE-2015-7977](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7977), [CVE-2015-7978](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7978), [CVE-2015-7979](http://web.nvd.nist.gov/vuln/detail/CVE-2015-7979), [CVE-2015-8138](http://web.nvd.nist.gov/vuln/detail/CVE-2015-8138), [CVE-2015-8139](http://web.nvd.nist.gov/vuln/detail/CVE-2015-8139), [CVE-2015-8140](http://web.nvd.nist.gov/vuln/detail/CVE-2015-8140), [CVE-2015-8158](http://web.nvd.nist.gov/vuln/detail/CVE-2015-8158), [CVE-2016-1547](http://web.nvd.nist.gov/vuln/detail/CVE-2016-1547), [CVE-2016-1548](http://web.nvd.nist.gov/vuln/detail/CVE-2016-1548), [CVE-2016-1549](http://web.nvd.nist.gov/vuln/detail/CVE-2016-1549), [CVE-2016-1550](http://web.nvd.nist.gov/vuln/detail/CVE-2016-1550), [CVE-2016-1551](http://web.nvd.nist.gov/vuln/detail/CVE-2016-1551), [CVE-2016-2516](http://web.nvd.nist.gov/vuln/detail/CVE-2016-2516), [CVE-2016-2517](http://web.nvd.nist.gov/vuln/detail/CVE-2016-2517), [CVE-2016-2518](http://web.nvd.nist.gov/vuln/detail/CVE-2016-2518), [CVE-2016-2519](http://web.nvd.nist.gov/vuln/detail/CVE-2016-2519) |
| --- | --- |
| **Date Public:** | 2016-04-26 |
| **Date First Published:** | 2016-04-27 |
| **Date Last Updated:** | 2016-04-28 15:15 UTC |
| **Document Revision:** | 49 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from security.FreeBSD.org_83b44072_20250125_095145.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-16:16.ntp Security Advisory
The FreeBSD Project
Topic: Multiple vulnerabilities of ntp
Category: contrib
Module: ntp
Announced: 2016-04-29
Credits: Network Time Foundation and various contributors listed below
Affects: All supported versions of FreeBSD.
Corrected: 2016-04-27 15:24:33 UTC (stable/10, 10.3-STABLE)
2016-04-29 08:02:31 UTC (releng/10.3, 10.3-RELEASE-p1)
2016-04-29 08:02:31 UTC (releng/10.2, 10.2-RELEASE-p15)
2016-04-29 08:02:31 UTC (releng/10.1, 10.1-RELEASE-p32)
2016-04-27 15:25:18 UTC (stable/9, 9.3-STABLE)
2016-04-29 08:02:31 UTC (releng/9.3, 9.3-RELEASE-p40)
CVE Name: CVE-2016-1547, CVE-2016-1548, CVE-2016-1549, CVE-2016-1550,
CVE-2016-1551, CVE-2016-2516, CVE-2016-2517, CVE-2016-2518,
CVE-2016-2519
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
The ntpd(8) daemon is an implementation of the Network Time Protocol (NTP)
used to synchronize the time of a computer system to a reference time
source.
II. Problem Description
Multiple vulnerabilities have been discovered in the NTP suite:
On OSes (FreeBSD not affected) that allows packets claiming to be from
127.0.0.0/8 that arrive over physical network, if ntpd is configured to use
a reference clock, an attacker can inject packets over the network that look
like they are coming from that reference clock. [CVE-2016-1551, Reported by
Matt Street and others of Cisco ASIG]
If a system is set up to use a trustedkey, and if one is not using the
feature introduced in ntp-4.2.8p6 allowing an optional 4th field in the
ntp.keys file to specify which IPs can serve time, a malicious
authenticated peer -- i.e. one where the attacker knows the private
symmetric key -- can create arbitrarily-many ephemeral associations in
order to win the clock selection of ntpd and modify a victim's clock.
[CVE-2016-1549, Reported by Matthew Van Gundy of Cisco ASIG]
If ntpd was expressly configured to allow for remote configuration (this is
not common), a malicious user who knows the controlkey for ntpq or the
requestkey for ntpdc (if mode7 is expressly enabled) can create a session
with ntpd and if an existing association is unconfigured using the same IP
twice on the unconfig directive line, ntpd will abort. [CVE-2016-2516,
Reported by Yihan Lian of the Cloud Security Team, Qihoo 360]
If ntpd was expressly configured to allow for remote configuration (this is
not common), a malicious user who knows the controlkey for ntpq or the
requestkey for ntpdc (if mode7 is expressly enabled) can create a session
with ntpd and then send a crafted packet to ntpd that will change the value
of the trustedkey, controlkey, or requestkey to a value that will prevent
any subsequent authentication with ntpd until ntpd is restarted.
[CVE-2016-2517, Reported by Yihan Lian of the Cloud Security Team, Qihoo 360]
Using a crafted packet to create a peer association with hmode > 7 causes
the MATCH\_ASSOC() lookup to make an out-of-bounds reference. [CVE-2016-2518,
Reported by Yihan Lian of the Cloud Security Team, Qihoo 360]
ntpq and ntpdc can be used to store and retrieve information in ntpd. It is
possible to store a data value that is larger than the size of the buffer
that the ctl\_getitem() function of ntpd uses to report the return value.
If the length of the requested data value returned by ctl\_getitem() is too
large, the value NULL is returned instead. There are 2 cases where the return
value from ctl\_getitem() was not directly checked to make sure it's not NULL,
but there are subsequent INSIST() checks that make sure the return value is
not NULL. There are no data values ordinarily stored in ntpd that would
exceed this buffer length. But if one has permission to store values and
one stores a value that is "too large", then ntpd will abort if an attempt
is made to read that oversized value. [CVE-2016-2519, Reported by
Yihan Lian of the Cloud Security Team, Qihoo 360]
For ntp-4 versions up to but not including ntp-4.2.8p7, an off-path attacker
can cause a preemptable client association to be demobilized by sending a
crypto NAK packet to a victim client with a spoofed source address of an
existing associated peer. This is true even if authentication is enabled.
Furthermore, if the attacker keeps sending crypto NAK packets, for example
one every second, the victim never has a chance to reestablish the
association and synchronize time with that legitimate server. For ntp-4.2.8
up to ntp-4.2.8p6 there is less risk because more stringent checks are
performed on incoming packets, but there are still ways to exploit this
vulnerability in versions before ntp-4.2.8p7. [CVE-2016-1547, Reported by
Stephen Gray and Matthew Van Gundy of Cisco ASIG]
It is possible to change the time of an ntpd client or deny service to an
ntpd client by forcing it to change from basic client/server mode to
interleaved symmetric mode. An attacker can spoof a packet from a legitimate
ntpd server with an origin timestamp that matches the peer->dst timestamp
recorded for that server. After making this switch, the client will reject
all future legitimate server responses. It is possible to force the victim
client to move time after the mode has been changed. ntpq gives no
indication that the mode has been switched. [CVE-2016-1548, Reported by
Miroslav Lichvar of RedHat and separately by Jonathan Gardner of
Cisco ASIG]
Packet authentication tests have been performed using memcmp() or possibly
bcmp(), and it is potentially possible for a local or perhaps LAN-based
attacker to send a packet with an authentication payload and indirectly
observe how much of the digest has matched. [CVE-2016-1550, Reported
independently by Loganaden Velvindron, and Matthew Van Gundy and
Stephen Gray of Cisco ASIG]
III. Impact
Malicious remote attackers may be able to break time synchornization,
or cause the ntpd(8) daemon to crash.
IV. Workaround
No workaround is available, but systems not running ntpd(8) are not
affected. Network administrators are advised to implement BCP-38,
which helps to reduce risk associated with the attacks.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
The ntpd service has to be restarted after the update. A reboot is
recommended but not required.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-16:16/ntp.patch
# fetch https://security.FreeBSD.org/patches/SA-16:16/ntp.patch.asc
# gpg --verify ntp.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
Restart the applicable daemons, or reboot the system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/9/ r298700
releng/9.3/ r298770
stable/10/ r298699
releng/10.1/ r298770
releng/10.2/ r298770
releng/10.3/ r298770
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.1.11 (FreeBSD)
iQIcBAEBCgAGBQJXIxXiAAoJEO1n7NZdz2rnAXgP/0OzpMmgCt4H9ldywUWaFmtr
ppIrbIXEuruh08TqrBm+PgUKFT0rZptCtX5pvZ/CwPdqfaisbvWkphcMART47q/Y
NcysqVGddmQUvrYihirYloj8qiODPu6XNqSG6QS4fw26NP1/dPnUmAREsTukWJjk
rAE+YZloikmKHXPXmG0Dr2STlzLrPDpeEp0aEb+MybZLerzyS6OyzTrnDLHttkwb
PFdA54KH4kUzCKJu3O4xtXimMjRm8s7tyOSHQhCI3U6bgTB0Q3hU+9FDFsx3K/7+
LsIa3JVefdgcIRnKWqli31Nk3fyndYgjFXpcqdUnK7bA0RpliGPqW90gom6W+Jb7
uRE5BDWHH3z9KAAGtOpziN20aWXeHHuisDpyfLVNyE350qyKuoVR/FPEa6mc2Fc4
CN53AfTQYPnGrwH4BnIVg2AsOmwwrEWx/TvzQ2DZLrKsUCklWXiUOxHz+6jXlz5v
RGIYJtJX/B+QN5a3RgAcluMb/A08FzjyAx57mEkYesv4nQn+9i2lLCP/LFHxId49
3rTmk817Mx1SMIS8Xc1bnd94gOBK8kNuduiV0xVKoJIn4IK5puwy/CBtx2jfMfI7
FPN6Krm7cQDy7z1rAZc80gTuIcMqXFNDHVtGVq+AqDQyv6rXL2iM8N+3xgQEe8Ei
fKgeiTiC4OSqKYLy/Ut/
=nQp/
-----END PGP SIGNATURE-----


=== Content from security.gentoo.org_7a9148c9_20250125_095145.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# NTP: Multiple vulnerabilities — GLSA **201607-15**

Multiple vulnerabilities have been found in NTP, the worst of which
could lead to Denial of Service.

### Affected packages

| Package | **net-misc/ntp** on all architectures |
| --- | --- |
| Affected versions | < **4.2.8\_p8** |
| Unaffected versions | >= **4.2.8\_p8** |

### Background

NTP contains software for the Network Time Protocol.

### Description

Multiple vulnerabilities have been discovered in NTP. Please review the
CVE identifiers referenced below for details.

### Impact

A remote attacker could possibly cause a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All NTP users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-misc/ntp-4.2.8_p8"

```
### References

* [CVE-2015-7691](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7691)
* [CVE-2015-7692](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7692)
* [CVE-2015-7701](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7701)
* [CVE-2015-7702](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7702)
* [CVE-2015-7703](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7703)
* [CVE-2015-7704](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7704)
* [CVE-2015-7705](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7705)
* [CVE-2015-7848](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7848)
* [CVE-2015-7849](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7849)
* [CVE-2015-7850](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7850)
* [CVE-2015-7851](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7851)
* [CVE-2015-7852](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7852)
* [CVE-2015-7853](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7853)
* [CVE-2015-7854](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7854)
* [CVE-2015-7855](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7855)
* [CVE-2015-7871](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7871)
* [CVE-2015-7973](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7973)
* [CVE-2015-7974](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7974)
* [CVE-2015-7975](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7975)
* [CVE-2015-7976](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7976)
* [CVE-2015-7977](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7977)
* [CVE-2015-7978](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7978)
* [CVE-2015-7979](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7979)
* [CVE-2015-8138](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8138)
* [CVE-2015-8139](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8139)
* [CVE-2015-8140](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8140)
* [CVE-2015-8158](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8158)
* [CVE-2016-1547](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1547)
* [CVE-2016-1548](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1548)
* [CVE-2016-1549](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1549)
* [CVE-2016-1550](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1550)
* [CVE-2016-1551](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-1551)
* [CVE-2016-2516](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2516)
* [CVE-2016-2517](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2517)
* [CVE-2016-2518](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2518)
* [CVE-2016-2519](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2519)
* [CVE-2016-4953](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4953)
* [CVE-2016-4954](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4954)
* [CVE-2016-4955](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4955)
* [CVE-2016-4956](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4956)
* [CVE-2016-4957](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-4957)

**Release date**

July 20, 2016

**Latest revision**

July 20, 2016: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [563774](https://bugs.gentoo.org/show_bug.cgi?id=563774)
* [572452](https://bugs.gentoo.org/show_bug.cgi?id=572452)
* [581528](https://bugs.gentoo.org/show_bug.cgi?id=581528)
* [584954](https://bugs.gentoo.org/show_bug.cgi?id=584954)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugs.ntp.org_b580ad7d_20250126_075245.html ===

[join](https://www.nwtime.org/membership/)

[donate](https://www.nwtime.org/donate/)

Network Time Foundation:
[NTP](https://www.nwtime.org/projects/ntp/ "Network Time Protocol Project")
• [Linux PTP](https://www.nwtime.org/projects/linuxptp/ "Linux Precision Time Protocol Project")
• [RADclock](https://www.nwtime.org/projects/radclock/ "Robust Absolute and Difference Clock Project")
• [GT API](https://www.nwtime.org/projects/timestamp-api/ "General Timestamp API Project")
• [More](http://networktimefoundation.org/projects/ "Other Projects")

---

[Help Us Continue the Legacy of Father Time by Donating to the
Mills-Spring Fund](https://www.nwtime.org/mills-spring/)
![](https://www.nwtime.org/images/support.jpg)

Bugzilla – Bug 3008
ctl\_getitem() return value not always checked
Last modified: 2016-04-27 04:13:55 UTC

* [Home](./)
* | [New](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=3008&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?id=3008&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

NTP users are strongly urged to take immediate action to ensure that their NTP daemons are not susceptible to being used in distributed denial-of-service (DDoS) attacks. Please also take this opportunity to defeat denial-of-service attacks by [implementing Ingress and Egress filtering through BCP38](http://www.bcp38.info/index.php/Main_Page "BCP38 Ingress/Egress filtering").

`ntp-4.2.8p18` was released on 25 May 2024 and addresses 40 bugs and provides 40 improvements.

Please see the [NTP 4.2.8p18 Changelog](https://www.ntp.org/support/securitynotice/4_2_8-series-changelog/#428p18 "4.2.8p18 Changelog") for details.

[**Bug 3008**](show_bug.cgi?id=3008)
- ctl\_getitem() return value not always checked

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
ctl\_getitem() return value not always checked

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | ntp | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=ntp "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | ntpd ([show other bugs](buglist.cgi?component=ntpd&product=ntp&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | 4.2.8 | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All All | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Harlan Stenn | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-02-03 06:05 UTC by Harlan Stenn | | --- | --- | | Modified: | 2016-04-27 04:13 UTC ([History](show_activity.cgi?id=3008)) | | CC List: | 4 users (show)  bugs LRlian perlinger security | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | |  | | | Flags: | stenn: blocking4.2.8+ | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | | --- | --- | --- | | [Add an attachment](attachment.cgi?bugid=3008&action=enter) (proposed patch, testcase, etc.) | | |   | Note You need to [log in](show_bug.cgi?id=3008&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=3008#c0)  Harlan Stenn    2016-02-03 06:05:46 UTC   [Comment 1](show_bug.cgi?id=3008#c1)  Harlan Stenn    2016-02-03 06:22:23 UTC  ``` There are cases where the return value of ctl_getitem() is not directly checked to make sure it's not NULL, but there are subsequent INSIST() checks that make sure the return value is not NULL.  There are situations where this can happen, and because the current code uses INSIST for safety checks this can cause ntpd to abort. ```  [Comment 2](show_bug.cgi?id=3008#c2)  Juergen Perlinger    2016-02-17 08:40:39 UTC  ``` My cleanup for 'ctl_getitem()' itself is in    psp.ntp.org:~perlinger/ntp-stable-3008-harlan  This has still some unclear semantics, but should behave more consistent now. ```  [Comment 3](show_bug.cgi?id=3008#c3)  Harlan Stenn    2016-02-22 07:45:28 UTC  ``` Lian,  Thanks for the report.  The fix is STAGED for 4.2.8p7.  Pearly, thanks for your additional cleanup! ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=3008)
* - [XML](show_bug.cgi?ctype=xml&id=3008)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=3008)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=3008&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=3008&GoAheadAndLogIn=1#forgot)
    Login:

    [x]

[© 2025 Network Time Foundation](https://www.nwtime.org/)



=== Content from support.ntp.org_7665ff9b_20250125_095144.html ===

[![](https://www.ntp.org/images/logo.png)](https://www.nwtime.org)
[![NTP: Network Time Protocol](https://www.ntp.org/images/ntp_logo.jpg)](https://www.ntp.org/)

[Support](https://www.ntp.org/support/)

[Reference Library](https://www.ntp.org/reflib/)

[Documentation](https://www.ntp.org/current-stable/)

[Donate](https://www.ntp.org/donate/)

1. [Support](https://www.ntp.org/support/)
2. [Security](https://www.ntp.org/support/securitynotice/)
3. [NTP BUG 3008: ctl\_getitem() return value not always checked](https://www.ntp.org/support/securitynotice/ntpbug3008/)

# NTP BUG 3008: ctl\_getitem() return value not always checked

Last update: April 22, 2024 18:49 UTC ([7e7bd5857](https://git.nwtime.org/websites/ntpwww/commit/7e7bd5857f893277639b3765bf9347c4c6faa447))

---

#### Summary

| **Resolved** | [4.2.8p7/](https://www.ntp.org/support/securitynotice/4_2_8p7-release-announcement/) | 26 Apr 2016 |
| --- | --- | --- |
| **References** | [Bug 3008](https://bugs.ntp.org/show_bug.cgi?id=3008) | [CVE-2016-2519](https://nvd.nist.gov/vuln/detail/CVE-2016-2519) |
| **Affects** | All ntp-4 releases up to, but not including 4.2.8p7, and 4.3.0 up to, but not including 4.3.92. | Resolved in 4.2.8p7. |
| **CVSS2 Score** | MED 4.9 | [AV:N/AC:H/Au:S/C:N/I:N/A:C](https://nvd.nist.gov/vuln-metrics/cvss/v2-calculator?calculator&version=2.0&vector=(AV:N/AC:H/Au:S/C:N/I:N/A:C)) |
| **CVSS3 Score** | MED 4.2 | [CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H](https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:N/AC:H/PR:H/UI:R/S:U/C:N/I:N/A:H) |

---

#### Description

`ntpq` and `ntpdc` can be used to store and retrieve information in `ntpd`. It is possible to store a data value that is larger than the size of the buffer that the `ctl_getitem()` function of `ntpd` uses to report the return value. If the length of the requested data value returned by `ctl_getitem()` is too large, the value `NULL` is returned instead. There are 2 cases where the return value from `ctl_getitem()` was not directly checked to make sure it’s not `NULL`, but there are subsequent `INSIST()` checks that make sure the return value is not `NULL`. There are no data values ordinarily stored in `ntpd` that would exceed this buffer length. But if one has permission to store values and one stores a value that is “too large”, then `ntpd` will abort if an attempt is made to read that oversized value.

---

#### Mitigation

* Implement [BCP-38](http://www.bcp38.info/index.php/Main_Page).
* Upgrade to [4.2.8p7 or later.](https://downloads.nwtime.org/ntp/4.2.8/)
* Properly monitor your `ntpd` instances.

---

#### Credit

This weakness was discovered by Yihan Lian of the Cloud Security Team, Qihoo 360.

---

#### Timeline

* 2016 Apr 26: Public release
* 2016 Apr 12: [Early Access Program Release: Premier and Partner Institutional Members](https://www.nwtime.org/membership/benefits/)
* 2016 Feb 14: [Notification to Institutional Members](https://www.nwtime.org/membership/benefits/)
* 2016 Jan 12: Initial notification from Cisco

* [![](https://www.ntp.org/images/icons/linkedin.svg)](https://www.linkedin.com/groups/4651343)
* [![](https://www.ntp.org/images/icons/facebook.svg)](https://www.facebook.com/networktimeprotocol)

© 2025 [Network Time Foundation](https://www.nwtime.org/)


