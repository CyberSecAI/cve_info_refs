=== Content from koz.io_4dace713_20250124_121816.html ===

[Blog Home](https://koz.io/)
[LinkedIn](https://www.linkedin.com/in/kozyrakis)
[GitHub](https://github.com/ikoz)
[Twitter](https://twitter.com/ikoz)

[About](https://koz.io/author/ikoz/)
[Archive](https://koz.io/post/)

# Testing for CVE-2016-2402 and similar pinning issues

[ikoz](https://koz.io/author/ikoz)
31 Mar 2016

[#certificate-pinning](https://koz.io/tags/certificate-pinning/)

Two weeks ago I [published](https://www.synopsys.com/blogs/software-security/ineffective-certificate-pinning-implementations/) details of an attack method that can be used to bypass various implementations of certificate pinning in Android or generally Java applications.

Several applications and frameworks are still vulnerable to the attack, among them every Java or Android application using a version of the popular OkHttp networking library before versions 3.1.2 and 2.7.4. [The OkHttp issue is tracked as CVE-2016-2402]

![One does not simply implement certificate pinning](https://koz.io/images/2016/03/z03d9.jpg)

#### Brief overview

Certificate pinning is a control used to mitigate Man-In-The-Middle attacks by privileged attackers. These attackers are assumed to have access to the private key used to sign a certificate that is trusted by the system hosting the application under attack.

It turns out that certificate pinning - if implemented using certain Java APIs like `checkServerTrusted()` - without taking extra steps - can be easily bypassed by the same attackers that the control is supposed to protect against. If vulnerable, pinning becomes completely ineffective as a control as it doesn’t do what it sets out to do.

The main reason behind the flaw is that for pinning to work correctly, developers should not check pins against the list of certificates sent by the server. Instead, pins should be checked against the new, ‘clean’ chain that is created during SSL validation.

##### Attack prerequisites

There has been some confusion over the pre-requirements for such attack. These are:

1. The attacker must be able to intercept network comms.
2. The attacker must have the private key of a certificate trusted by the host system/device.

Under other circumstances, the 2nd prerequisite would be a ‘huge’ one. However that’s not the case here: Certificate pinning, as a control, **only makes sense** against attackers that already have such access. Applications that implement pinning want to actively protect against such attackers. The described attack enables this attack vector, bypassing the pinning control.

##### Local or remote?

Some confusion may also exist over whether this is a ‘local’ or ‘remote’ attack.
The answer is that it can be both. It boils down to the method used by an attacker to obtain the private key of a trusted certificate. Some of these are mentioned in the original post:

> * Compromising a CA or intermediate CA
> * Direct or indirect access to a CA
>   + A malicious CA employee
>   + Phishing a CA employee
>   + Leveraging mistakes in the certificate request process
>   + Configuration mistake on the CA
>   + Nation-state attackers
> * Phishing a user into installing a malicious certificate in their system’s trusted store

If an attacker uses a compromised trusted CA key, the attack can be remote. If an attacker needs to install or somehow trick the user into installing their own malicious CA certificate, then the attack could be local and requires the attacker to ‘phish’ a user.

# How to test

Say Alice is the client, Bob is the server and Mallory is the intercepting host.

The general idea is:

1. Alice, while attempting to connect to Bob, is somehow redirected to Mallory.
2. Mallory knows that Alice wanted to connect to Bob, so, before fully establishing an SSL connection with Alice, he first contacts Bob and grabs all his SSL certificates.
3. Mallory then uses the private key of a CA that Alice trusts to sign a certificate masquerading as belonging to Bob.
4. Mallory also appends all of Bob’s *real certificates* in the list of certificates it sends to Alice
5. Alice completes the SSL handshake with Mallory instead of Bob. The handshake is verified successfully because Mallory’s certificate is signed by a CA that Alice trusts.
6. Alice now goes through certificate pinning checks using a vulnerable implementation which looks for Bob’s exact certificates in the received chain. The checks pass because …they are there.

Here’s a sequence diagram version of the above steps:

![Pinning attack sequence diagram](https://koz.io/images/2016/03/pinning-attack-seq-diagram.png)

If the above scenario is possible, then an application that claims to perform pinning is vulnerable.

Testing for this can be tricky, because no ready-made tools exist - so I created a few.

## POC server

While submitting bug reports to OkHttp and several other applications I used a simple python script that acts as a malicious HTTPS web server that masquerades as a specified trusted server.
You can find it in [my github](https://github.com/ikoz/cert-pinning-flaw-poc).
Start this server with a command line parameter indicating which trusted server to masquerade as (domain name). Any client connecting to it will receive a certificate chain that looks like the following:

```
[0] malicious server end-entity cert signed by CA A
[1] real server end-entity cert signed by CA B
[2] real server intermediate CA B signed by CA C

```

**CA A** and **CA C** are trusted by the system.

Of course, for this to work, for POC purposes we have to manually create a ‘CA A’ certificate and insert it in the host system’s trusted store. A real attacker may not have to do this step.

Using this for testing is simple:

* Start the POC server masquerading as a domain name the application is going to connect to
* Import the POC server’s CA into the app’s host system
* Redirect traffic from the application to the server. The easy way is to change `/etc/hosts` so that requests for a particular domain end up to the malicious server. DNS spoofing or a variety of other methods can also be used.
* Once you start the application, if the attack worked, you should see GET or POST requests hitting the malicious web server - you should be able to read their contents. The POC server is not a proxy - there will be no responses back or any means for the application to make use of the connection. This is just to prove the attack works.
  If pinning was not vulnerable, then you wouldn’t see a plaintext GET or POST request in your malicious server’s logs; the client should have refused to establish the SSL channel with the malicious server.

## mitmproxy

An easier way to demonstrate the attack is by making use of a new feature I [added](https://github.com/mitmproxy/mitmproxy/pull/1014) to the popular [mitmproxy](https://mitmproxy.org/) intercepting proxy and was merged a few days ago.

To use this, for now, you’ll have to [checkout the master branch](https://github.com/mitmproxy/mitmproxy.git) ([zip](https://github.com/mitmproxy/mitmproxy/archive/master.zip)). The feature will be part of [v0.17](https://github.com/mitmproxy/mitmproxy/releases/latest) - once that is tagged and released.

Once you have the code, all you have to do is:

1. Insert mitmproxy’s CA certificate in the tested system *(unless you have the key of a trusted CA like a real attacker would)*
2. Configure device networking to pass through mitmproxy (e.g. proxy settings on the device, invisible proxying via vpn, gateway etc)
3. Start mitmproxy or mitmdump using the new `--add-upstream-certs-to-client-chain` command line switch.

While operating in this mode, mitmproxy will automatically add all certificates of the upstream server to the certificate list that is served to the client.

If connections using normal proxying fail (due to pinning) but work in this new mode, then you can easily conclude that the pinning implementation exhibits this flaw.

### Sample vulnerable app

I created [a sample vulnerable Java app] for demo purposes. Find it in [my github](https://github.com/ikoz/certPinningVulnerableOkHttp). This uses OkHttp 3.0.1 (which is vulnerable to CVE-2016-2402) to connect to github.com and retrieve a file.

Since pinning is used, if you attempt to proxy this app or redirect its connections you shouldn’t be able to see the encrypted traffic as the application will refuse to connect to the proxy - even if the proxy certificate is trusted by the system.

However, because OkHttp 3.0.1 is vulnerable to CVE-2016-2402, you should be able to intercept the traffic if you redirect to the POC malicious server or if you use mitmproxy with the new `--add-upstream-certs-to-client-chain` option.

Happy testing.

####

mobile security, static & dynamic analysis, automation, payments

London, UK

#### Share this post

[Twitter](https://twitter.com/share?text=Testing%20for%20CVE-2016-2402%20and%20similar%20pinning%20issues&url=https%3a%2f%2fkoz.io%2fpinning-cve-2016-2402%2f)
[Facebook](https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fkoz.io%2fpinning-cve-2016-2402%2f)
[Google+](https://plus.google.com/share?url=https%3a%2f%2fkoz.io%2fpinning-cve-2016-2402%2f)

Please enable JavaScript to view the [comments powered by Disqus.](https://disqus.com/?ref_noscript)

Yiannis Kozyrakis ~ blog All rights reserved - 2016



=== Content from twitter.com_4adf6872_20250126_010448.html ===



=== Content from twitter.com_eba8638d_20250126_010447.html ===



=== Content from koz.io_c85bd011_20250126_010448.html ===

[Blog Home](https://koz.io/)
[LinkedIn](https://www.linkedin.com/in/kozyrakis)
[GitHub](https://github.com/ikoz)
[Twitter](https://twitter.com/ikoz)

[About](https://koz.io/author/ikoz/)
[Archive](https://koz.io/post/)

# Certificate Pinning

## [Pinning - not as simple as it sounds](https://koz.io/android-pinning-bugs/)

[Two weeks ago I presented (once more) on the topic of pinning, this time focusing on bugs seen in real-world Android applications implementing pinning. The presentation also covered CVE-2016-2402 in some detail, Android’s Network Security Configuration and a few other relevant topics.
The conference was Android Security Symposium - a great security event, hosted in an awesome venue within Vienna University of Technology.
So, here are the slides and here is the video. »](https://koz.io/android-pinning-bugs/)

[ikoz](https://koz.io/author/ikoz)
22 Mar 2017

[#certificate-pinning](https://koz.io/tags/certificate-pinning/)
[#presentation](https://koz.io/tags/presentation/)
[#android-security-symposium](https://koz.io/tags/android-security-symposium/)

## [Certificate Pinning for mobile apps - OWASP AppSecEU16 slides](https://koz.io/certificate-pinning-owasp-appseceu16/)

[As you might have guessed from previous posts on the topic, I’ve been researching certificate pinning implementations in mobile apps for the last couple of years.
Two months ago I presented a talk on certificate pinning at OWASP AppSecEU16 conference in Rome, Italy. The conference was pretty fun, met so many interesting people.
So, here are the slides and the video.
The official abstract:
Pinning Certificates (“Cert Pinning”) trends perennially, coming to the fore with each new SSL hack. »](https://koz.io/certificate-pinning-owasp-appseceu16/)

[ikoz](https://koz.io/author/ikoz)
9 Aug 2016

[#certificate-pinning](https://koz.io/tags/certificate-pinning/)
[#presentation](https://koz.io/tags/presentation/)
[#owasp](https://koz.io/tags/owasp/)

## [Testing for CVE-2016-2402 and similar pinning issues](https://koz.io/pinning-cve-2016-2402/)

[Two weeks ago I published details of an attack method that can be used to bypass various implementations of certificate pinning in Android or generally Java applications.
Several applications and frameworks are still vulnerable to the attack, among them every Java or Android application using a version of the popular OkHttp networking library before versions 3.1.2 and 2.7.4. [The OkHttp issue is tracked as CVE-2016-2402]
Brief overview Certificate pinning is a control used to mitigate Man-In-The-Middle attacks by privileged attackers. »](https://koz.io/pinning-cve-2016-2402/)

[ikoz](https://koz.io/author/ikoz)
31 Mar 2016

[#certificate-pinning](https://koz.io/tags/certificate-pinning/)

## [Network Security Policy configuration for Android apps](https://koz.io/network-security-policy-configuration-for-android-apps/)

[android.security.net.config Capabilities Permit clear-text traffic HSTS enforcement Certificate Pinning Custom Trust Anchors Android engineers have recently been busy building out AndroidNSSP (Android Network Security Provider): a system that application developers will be able to use in order control aspects of the network security policy of their application. It’s been long overdue, and there are various bits and pieces still missing; however important parts were merged to AOSP master about a month ago. »](https://koz.io/network-security-policy-configuration-for-android-apps/)

[ikoz](https://koz.io/author/ikoz)
15 Feb 2016

[#android](https://koz.io/tags/android/)
[#certificate-pinning](https://koz.io/tags/certificate-pinning/)

Page 1 of 1

Yiannis Kozyrakis ~ blog All rights reserved - 2016



=== Content from lists.apache.org_a7a32925_20250124_121817.html ===


[![Foal logo](images/logo.png)](./)

* ![Display Settings](images/cog.png "Display Settings")
  **Email display mode:**

  ---

   Modern rendering

   Legacy rendering
* ![Logged out](images/user_loggedout.png "Not logged in")

This site requires JavaScript enabled. Please enable it.



=== Content from www.facebook.com_535cda50_20250126_010444.html ===

# [*Facebook*](https://www.facebook.com/ "Go to Facebook home")

| Email or phone | Password |
| --- | --- |
|  |  |  |
|  | [Forgot account?](https://www.facebook.com/recover/initiate?lwv=110&ars=royal_blue_bar) |

[Sign Up](/r.php?locale=en_US)
## Not Logged In

## Not Logged In

You are not logged in. Please login and try again.

* [Return home](/)

* English (US)
* [Gaeilge](https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Irish")
* [Polski](https://ga-ie.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Polish")
* [Lietuvių](https://pl-pl.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Lithuanian")
* [Português (Brasil)](https://lt-lt.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Portuguese (Brazil)")
* [Русский](https://pt-br.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Russian")
* [Română](https://ru-ru.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Romanian")
* [Español](https://ro-ro.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Spanish")
* [Français (France)](https://es-la.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "French (France)")
* [Deutsch](https://fr-fr.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "German")
* [Italiano](https://de-de.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fkoz.io%2Fpinning-cve-2016-2402%2F "Italian")

* [Sign Up](/reg/ "Sign Up for Facebook")
* [Log In](/login/ "Log into Facebook")
* [Messenger](https://messenger.com/ "Check out Messenger.")
* [Facebook Lite](/lite/ "Facebook Lite for Android.")
* [Video](https://www.facebook.com/watch/ "Browse in Video")
* [Places](/places/ "Check out popular places on Facebook.")
* [Games](/games/ "Check out Facebook games.")
* [Marketplace](/marketplace/ "Buy and sell on Facebook Marketplace.")
* [Meta Pay](https://about.meta.com/technologies/meta-pay "Learn more about Meta Pay")
* [Meta Store](https://www.meta.com/ "Check out Meta")
* [Meta Quest](https://www.meta.com/quest/ "Learn more about Meta Quest")
* [Ray-Ban Meta](https://www.meta.com/smart-glasses/ "Learn more about Ray-Ban Meta")
* [Meta AI](https://www.meta.ai/ "Meta AI")
* [Instagram](https://l.facebook.com/l.php?u=https%3A%2F%2Fwww.instagram.com%2F&h=AT17mgmwo2hc0AjMeLYCLR2CS7xnxB7-gVxJz77FMeRSpI4ooJCKcfBQ7q5aFySrNDQVNE7NKcEDa0xpFmiJzbxTYSMsLtCtB2B1CoPP9EJxG-Vxt0AIb-d5XvwsZjQcznl6Fi7Owg2E2gNRSAjXDA "Check out Instagram")
* [Threads](https://www.threads.net/ "Check out Threads")
* [Fundraisers](/fundraisers/ "Donate to worthy causes.")
* [Services](/biz/directory/ "Browse our Facebook Services directory.")
* [Voting Information Center](/votinginformationcenter/?entry_point=c2l0ZQ%3D%3D "See the Voting Information Center.")
* [Privacy Policy](/privacy/policy/?entry_point=facebook_page_footer "Learn how we collect, use and share information to support Facebook.")
* [Privacy Center](/privacy/center/?entry_point=facebook_page_footer "Learn how to manage and control your privacy on Facebook.")
* [Groups](/groups/discover/ "Explore our Groups.")
* [About](https://about.meta.com/ "Read our blog, discover the resource center, and find job opportunities.")
* [Create ad](/ad_campaign/landing.php?placement=pflo&campaign_id=402047449186&nav_source=unknown&extra_1=auto "Advertise on Facebook.")
* [Create Page](/pages/create/?ref_type=site_footer "Create a page")
* [Developers](https://developers.facebook.com/?ref=pf "Develop on our platform.")
* [Careers](/careers/?ref=pf "Make your next career move to our awesome company.")
* [Cookies](/policies/cookies/ "Learn about cookies and Facebook.")
* [Ad choices](https://www.facebook.com/help/568137493302217 "Learn about Ad Choices.")
* [Terms](/policies?ref=pf "Review our terms and policies.")
* [Help](/help/?ref=pf "Visit our Help Center.")
* [Contact Uploading & Non-Users](https://www.facebook.com/help/637205020878504 "Visit our Contact Uploading & Non-Users Notice.")
* [Settings](/settings "View and edit your Facebook settings.")
* [Activity log](/allactivity?privacy_source=activity_log_top_menu "View your activity log")
 Meta © 2025![](https://facebook.com/security/hsts-pixel.gif)



=== Content from koz.io_14d6db69_20250126_010442.html ===

[Blog Home](https://koz.io/)
[LinkedIn](https://www.linkedin.com/in/kozyrakis)
[GitHub](https://github.com/ikoz)
[Twitter](https://twitter.com/ikoz)

[About](https://koz.io/author/ikoz/)
[Archive](https://koz.io/post/)

# All posts

A list of all published blog posts.

#### 2017

* [Inside Android's SafetyNet Attestation - BlackHatEU17 slides](https://koz.io/android-safetynet-blackhat/) — Dec 8
* [Mobile OS version adoption](https://koz.io/mobile-os-version-adoption/) — Aug 23
* [Library injection for debuggable Android apps](https://koz.io/library-injection-for-debuggable-android-apps/) — Jul 9
* [Using Frida on Android without root](https://koz.io/using-frida-on-android-without-root/) — Apr 12
* [Pinning - not as simple as it sounds](https://koz.io/android-pinning-bugs/) — Mar 22

#### 2016

* [Inside SafetyNet - part 3](https://koz.io/inside-safetynet-3/) — Nov 13
* [Migrating from Ghost to Hugo](https://koz.io/ghost-to-hugo/) — Nov 7
* [Hiding root with suhide](https://koz.io/hiding-root-with-suhide/) — Aug 30
* [Certificate Pinning for mobile apps - OWASP AppSecEU16 slides](https://koz.io/certificate-pinning-owasp-appseceu16/) — Aug 9
* [Testing for CVE-2016-2402 and similar pinning issues](https://koz.io/pinning-cve-2016-2402/) — Mar 31
* [Inside SafetyNet - part 2](https://koz.io/inside-safetynet-2/) — Mar 20
* [Network Security Policy configuration for Android apps](https://koz.io/network-security-policy-configuration-for-android-apps/) — Feb 15

#### 2015

* [Using Android's tamper detection securely in your app](https://koz.io/using-safetynet-securely-in-your-android-app/) — Oct 12
* [SafetyNet: Google's tamper detection for Android](https://koz.io/inside-safetynet/) — Sep 17
* [Using ProGuard to remove logs](https://koz.io/on-proguard-log-removal/) — Jul 2
* [Android M and the war on cleartext traffic](https://koz.io/android-m-and-the-war-on-cleartext-traffic/) — Jun 17
* [Substrate - hooking C on Android](https://koz.io/android-substrate-c-hooking/) — Jun 1
* [Same Origin Policy and the Android WebView](https://koz.io/same-origin-policy-and-android-webview/) — May 15

Yiannis Kozyrakis ~ blog All rights reserved - 2016



=== Content from www.linkedin.com_1c99c467_20250126_010447.html ===




=== Content from koz.io_68f6f2b4_20250126_010448.html ===

[Blog Home](https://koz.io/)
[LinkedIn](https://www.linkedin.com/in/kozyrakis)
[GitHub](https://github.com/ikoz)
[Twitter](https://twitter.com/ikoz)

[About](https://koz.io/author/ikoz/)
[Archive](https://koz.io/post/)

# Yiannis Kozyrakis

# Bio

Since August 2022, working as a security engineer at Meta - focusing on mobile security.

Before that, since 2018 I was a Security Research Engineer at Synopsys, focusing on static analysis. As part of this work, I have been investigating security issues in frameworks and libraries developed in various languages, creating SAST rules for identifying them at scale. I’ve created workflows and infrastructure for others to contribute checkers and models efficiently. More recently I have been part of a team that started, from the ground up, a new static analysis tool developed fully in Rust, aiming to be extremely small and fast.

Previously, for 6 years I’ve worked as an application security consultant at [Cigital](http://www.cigital.com), based in London, UK. I focused primarily on mobile application security. As a consultant I helped architects and developers build mobile applications securely from design and specifications to low-level details of binary protections. I also spend time designing and building static & dynamic analysis tools for mobile applications. Over the years I’ve engaged in many aspects of application security, including architecture reviews, threat modeling, SDLC management, code reviews, pentesting and reverse engineering.

* Follow me on twitter [@ikoz](https://twitter.com/ikoz)
* Find me on [LinkedIn](https://uk.linkedin.com/in/kozyrakis)
* [Github](https://github.com/ikoz) - [Gitlab](https://gitlab.com/ikoz)

You might see my name written as Yiannis, Yannis, Ioannis or John, depending on context and platform. Kozyrakis is pronounced “cozy-ra-kiss”.

Yiannis Kozyrakis ~ blog All rights reserved - 2016



=== Content from github.com_3e8f31ec_20250126_010443.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fikoz)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fikoz)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@ikoz](https://avatars.githubusercontent.com/u/9115937?s=64&v=4)

**ikoz**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fikoz)

[Overview](/ikoz)
[Repositories
27](/ikoz?tab=repositories)
[Projects
0](/ikoz?tab=projects)
[Packages
0](/ikoz?tab=packages)
[Stars
209](/ikoz?tab=stars)

More

* [Overview](/ikoz)
* [Repositories](/ikoz?tab=repositories)
* [Projects](/ikoz?tab=projects)
* [Packages](/ikoz?tab=packages)
* [Stars](/ikoz?tab=stars)

![@ikoz](https://avatars.githubusercontent.com/u/9115937?s=64&v=4)

**ikoz**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fikoz)

[![View ikoz's full-sized avatar](https://avatars.githubusercontent.com/u/9115937?v=4)](https://avatars.githubusercontent.com/u/9115937?v=4)

# Yiannis Kozyrakis ikoz

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fikoz)

[120
followers](https://github.com/ikoz?tab=followers) · [30
following](https://github.com/ikoz?tab=following)

* London, UK
* <https://koz.io>

## [Achievements](/ikoz?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/ikoz?achievement=quickdraw&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/ikoz?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/ikoz?achievement=pull-shark&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/ikoz?achievement=starstruck&tab=achievements)
## [Achievements](/ikoz?tab=achievements)

[![Achievement: Quickdraw](https://github.githubassets.com/assets/quickdraw-default-39c6aec8ff89.png)](/ikoz?achievement=quickdraw&tab=achievements)[![Achievement: Arctic Code Vault Contributor](https://github.githubassets.com/assets/arctic-code-vault-contributor-default-df8d74122a06.png)](/ikoz?achievement=arctic-code-vault-contributor&tab=achievements)[![Achievement: Pull Shark](https://github.githubassets.com/assets/pull-shark-default-498c279a747d.png)](/ikoz?achievement=pull-shark&tab=achievements)[![Achievement: Starstruck](https://github.githubassets.com/assets/starstruck-default-b6610abad518.png)](/ikoz?achievement=starstruck&tab=achievements)

Block or Report

# Block or report ikoz

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=ikoz+%28user%29)

[Overview](/ikoz)
[Repositories
27](/ikoz?tab=repositories)
[Projects
0](/ikoz?tab=projects)
[Packages
0](/ikoz?tab=packages)
[Stars
209](/ikoz?tab=stars)

More

* [Overview](/ikoz)
* [Repositories](/ikoz?tab=repositories)
* [Projects](/ikoz?tab=projects)
* [Packages](/ikoz?tab=packages)
* [Stars](/ikoz?tab=stars)

## Popular repositories Loading

1. [jdwp-lib-injector](/ikoz/jdwp-lib-injector) jdwp-lib-injector
   Public

   Forked from [IOActive/jdwp-shellifier](/IOActive/jdwp-shellifier)

   Python

   [74](/ikoz/jdwp-lib-injector/stargazers)
   [19](/ikoz/jdwp-lib-injector/forks)
2. [AndroidSubstrate\_hookingC\_examples](/ikoz/AndroidSubstrate_hookingC_examples) AndroidSubstrate\_hookingC\_examples
   Public

   AndroidSubstrate\_hookingC\_examples

   C++

   [56](/ikoz/AndroidSubstrate_hookingC_examples/stargazers)
   [40](/ikoz/AndroidSubstrate_hookingC_examples/forks)
3. [cert-pinning-flaw-poc](/ikoz/cert-pinning-flaw-poc) cert-pinning-flaw-poc
   Public

   Simple script for testing CVE-2016-2402 and similar flaws

   Python

   [13](/ikoz/cert-pinning-flaw-poc/stargazers)
   [5](/ikoz/cert-pinning-flaw-poc/forks)
4. [public\_talks](/ikoz/public_talks) public\_talks
   Public

   [11](/ikoz/public_talks/stargazers)
   [4](/ikoz/public_talks/forks)
5. [certPinningVulnerableOkHttp](/ikoz/certPinningVulnerableOkHttp) certPinningVulnerableOkHttp
   Public

   OkHttp sample app vulnerable to CVE-2016-2402

   Java

   [10](/ikoz/certPinningVulnerableOkHttp/stargazers)
   [4](/ikoz/certPinningVulnerableOkHttp/forks)
6. [AndroidEagleEye](/ikoz/AndroidEagleEye) AndroidEagleEye
   Public

   Forked from [MindMac/AndroidEagleEye](/MindMac/AndroidEagleEye)

   An Xposed and adbi based module which is capable of hooking both Java and Native methods targeting Android OS.

   Makefile

   [2](/ikoz/AndroidEagleEye/stargazers)
   [2](/ikoz/AndroidEagleEye/forks)

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from koz.io_9a5d025b_20250126_010442.html ===

[Blog Home](https://koz.io/)
[LinkedIn](https://www.linkedin.com/in/kozyrakis)
[GitHub](https://github.com/ikoz)
[Twitter](https://twitter.com/ikoz)

[About](https://koz.io/author/ikoz/)
[Archive](https://koz.io/post/)

# Yiannis Kozyrakis

# Bio

Since August 2022, working as a security engineer at Meta - focusing on mobile security.

Before that, since 2018 I was a Security Research Engineer at Synopsys, focusing on static analysis. As part of this work, I have been investigating security issues in frameworks and libraries developed in various languages, creating SAST rules for identifying them at scale. I’ve created workflows and infrastructure for others to contribute checkers and models efficiently. More recently I have been part of a team that started, from the ground up, a new static analysis tool developed fully in Rust, aiming to be extremely small and fast.

Previously, for 6 years I’ve worked as an application security consultant at [Cigital](http://www.cigital.com), based in London, UK. I focused primarily on mobile application security. As a consultant I helped architects and developers build mobile applications securely from design and specifications to low-level details of binary protections. I also spend time designing and building static & dynamic analysis tools for mobile applications. Over the years I’ve engaged in many aspects of application security, including architecture reviews, threat modeling, SDLC management, code reviews, pentesting and reverse engineering.

* Follow me on twitter [@ikoz](https://twitter.com/ikoz)
* Find me on [LinkedIn](https://uk.linkedin.com/in/kozyrakis)
* [Github](https://github.com/ikoz) - [Gitlab](https://gitlab.com/ikoz)

You might see my name written as Yiannis, Yannis, Ioannis or John, depending on context and platform. Kozyrakis is pronounced “cozy-ra-kiss”.

Yiannis Kozyrakis ~ blog All rights reserved - 2016



=== Content from github.com_78eb8e4a_20250126_010443.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fikoz%2FcertPinningVulnerableOkHttp)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fikoz%2FcertPinningVulnerableOkHttp)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=ikoz%2FcertPinningVulnerableOkHttp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[ikoz](/ikoz)
/
**[certPinningVulnerableOkHttp](/ikoz/certPinningVulnerableOkHttp)**
Public

* [Notifications](/login?return_to=%2Fikoz%2FcertPinningVulnerableOkHttp) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2Fikoz%2FcertPinningVulnerableOkHttp)
* [Star
   10](/login?return_to=%2Fikoz%2FcertPinningVulnerableOkHttp)

OkHttp sample app vulnerable to CVE-2016-2402

[10
stars](/ikoz/certPinningVulnerableOkHttp/stargazers) [4
forks](/ikoz/certPinningVulnerableOkHttp/forks) [Branches](/ikoz/certPinningVulnerableOkHttp/branches) [Tags](/ikoz/certPinningVulnerableOkHttp/tags) [Activity](/ikoz/certPinningVulnerableOkHttp/activity)
 [Star](/login?return_to=%2Fikoz%2FcertPinningVulnerableOkHttp)

 [Notifications](/login?return_to=%2Fikoz%2FcertPinningVulnerableOkHttp) You must be signed in to change notification settings

* [Code](/ikoz/certPinningVulnerableOkHttp)
* [Issues
  2](/ikoz/certPinningVulnerableOkHttp/issues)
* [Pull requests
  0](/ikoz/certPinningVulnerableOkHttp/pulls)
* [Actions](/ikoz/certPinningVulnerableOkHttp/actions)
* [Projects
  0](/ikoz/certPinningVulnerableOkHttp/projects)
* [Security](/ikoz/certPinningVulnerableOkHttp/security)
* [Insights](/ikoz/certPinningVulnerableOkHttp/pulse)

Additional navigation options

* [Code](/ikoz/certPinningVulnerableOkHttp)
* [Issues](/ikoz/certPinningVulnerableOkHttp/issues)
* [Pull requests](/ikoz/certPinningVulnerableOkHttp/pulls)
* [Actions](/ikoz/certPinningVulnerableOkHttp/actions)
* [Projects](/ikoz/certPinningVulnerableOkHttp/projects)
* [Security](/ikoz/certPinningVulnerableOkHttp/security)
* [Insights](/ikoz/certPinningVulnerableOkHttp/pulse)

# ikoz/certPinningVulnerableOkHttp

    master[Branches](/ikoz/certPinningVulnerableOkHttp/branches)[Tags](/ikoz/certPinningVulnerableOkHttp/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[1 Commit](/ikoz/certPinningVulnerableOkHttp/commits/master/) | | |
| [lib](/ikoz/certPinningVulnerableOkHttp/tree/master/lib "lib") | | [lib](/ikoz/certPinningVulnerableOkHttp/tree/master/lib "lib") |  |  |
| [src](/ikoz/certPinningVulnerableOkHttp/tree/master/src "src") | | [src](/ikoz/certPinningVulnerableOkHttp/tree/master/src "src") |  |  |
| [README.md](/ikoz/certPinningVulnerableOkHttp/blob/master/README.md "README.md") | | [README.md](/ikoz/certPinningVulnerableOkHttp/blob/master/README.md "README.md") |  |  |
| [build.xml](/ikoz/certPinningVulnerableOkHttp/blob/master/build.xml "build.xml") | | [build.xml](/ikoz/certPinningVulnerableOkHttp/blob/master/build.xml "build.xml") |  |  |
| [certPinningVulnerableOkHttp.jar](/ikoz/certPinningVulnerableOkHttp/blob/master/certPinningVulnerableOkHttp.jar "certPinningVulnerableOkHttp.jar") | | [certPinningVulnerableOkHttp.jar](/ikoz/certPinningVulnerableOkHttp/blob/master/certPinningVulnerableOkHttp.jar "certPinningVulnerableOkHttp.jar") |  |  |
| View all files | | |

## Repository files navigation

* README
# OkHttp simple-client app vulnerable to CVE-2016-2402

This is a fork of the default [simple-client](https://github.com/square/okhttp/blob/okhttp_31/samples/simple-client) from the okhttp project.

Simple-client is a Java app that just does a GET request to <https://api.github.com> and fetches the names of okhttp's contributors.

This fork has been edited so that OkHttp 3.0.1 is used for networking connections and certificate pinning is also used.

OkHttp 3.0.1 is vulnerable to CVE-2016-2402 - this app demonstrates the flaw.

For more information please read:

* <https://koz.io/pinning-cve-2016-2402>
* <https://www.cigital.com/blog/ineffective-certificate-pinning-implementations/>

## Building

To build the app, first clone the repository and then run:

`ant build`

## Usage

If you don't have the private key of a CA trusted by your system's JRE, you'll have to add the proxy's certificate to your CA store.
Let's say CA\_CERT.pem is your proxy's CA certificate.

`$cp /etc/ssl/certs/java/cacerts .`

`$keytool -import -trustcacerts -alias ikozCA -file CA_CERT.pem -keystore cacerts -storepass changeit`

Then start simple-client using the following parameters to connect through a local proxy

`$java -DproxyHost=127.0.0.1 -DproxyPort=8080 -Djavax.net.ssl.trustStore=cacerts -jar certPinningVulnerableOkHttp.jar`

John Kozyrakis

## About

OkHttp sample app vulnerable to CVE-2016-2402

### Resources

[Readme](#readme-ov-file)

[Activity](/ikoz/certPinningVulnerableOkHttp/activity)
### Stars

[**10**
stars](/ikoz/certPinningVulnerableOkHttp/stargazers)
### Watchers

[**2**
watching](/ikoz/certPinningVulnerableOkHttp/watchers)
### Forks

[**4**
forks](/ikoz/certPinningVulnerableOkHttp/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fikoz%2FcertPinningVulnerableOkHttp&report=ikoz+%28user%29)

## [Releases](/ikoz/certPinningVulnerableOkHttp/releases)

No releases published

## [Packages 0](/users/ikoz/packages?repo_name=certPinningVulnerableOkHttp)

No packages published

## Languages

* [Java
  100.0%](/ikoz/certPinningVulnerableOkHttp/search?l=java)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_feca322a_20250124_121816.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](7) [[next>]](../../../2016/02/11/1) [[thread-next>]](../../../2016/02/18/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAGKXR4sFSLHEf0Eb2tRxLUMsZQbB6b77WJrEuJ_HKqnF4HmA6g@mail.gmail.com>
Date: Wed, 10 Feb 2016 13:35:17 -0800
From: Matthew McPherrin <mmc@...areup.com>
To: oss-security@...ts.openwall.com
Subject: CVE request - OkHttp Certificate Pining Bypass

A vulnerability was discovered in OkHttp that allows an attacker to bypass
certificate pinning. OkHttp did not validate that the pinned certificate
was in the chain to a trusted certificate authority.

This resulted in an attacker being able to present a certificate chain with
a certificate issued by one trusted certificate authority, and additionally
including the pinned certificate authority. Because the pinned certificate
was present, and the certificate was issued by a trusted certificate
authority, the server's certificate was accepted. However, it should not
have been accepted as the pinned certificate was not in the trust chain.

This allows an attacker to obtain a certificate from a non-pinned but
trusted CA, then have OkHttp connect to that server, bypassing certificate
pinning.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_7c4a0eef_20250124_121816.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2016/02/10/8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160218035444.2ED678BC081@smtpvmsrv1.mitre.org>
Date: Wed, 17 Feb 2016 22:54:44 -0500 (EST)
From: cve-assign@...re.org
To: mmc@...areup.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request - OkHttp Certificate Pining Bypass

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> A vulnerability was discovered in OkHttp that allows an attacker to bypass
> certificate pinning. OkHttp did not validate that the pinned certificate
> was in the chain to a trusted certificate authority.
>
> This resulted in an attacker being able to present a certificate chain with
> a certificate issued by one trusted certificate authority, and additionally
> including the pinned certificate authority. Because the pinned certificate
> was present, and the certificate was issued by a trusted certificate
> authority, the server's certificate was accepted. However, it should not
> have been accepted as the pinned certificate was not in the trust chain.
>
> This allows an attacker to obtain a certificate from a non-pinned but
> trusted CA, then have OkHttp connect to that server, bypassing certificate
> pinning.

We found this wording to be somewhat confusing, but we believe we
understand what was meant, so the CVE ID is included below.

Essentially, we think "attacker being able to present a certificate
chain with a certificate issued by one trusted certificate authority,
and additionally including the pinned certificate authority" was
intended to state "attacker being able to present a certificate chain
with a certificate issued by one trusted certificate authority, and
additionally include the pinned certificate." The use of "including"
instead of "include" in that sentence seemed to imply that "including
the pinned certificate authority" was a phrase describing the server
end-entity certificate: that would not make sense.

Use CVE-2016-2402.

- --
CVE assignment team, MITRE CVE Numbering Authority
M/S M300
202 Burlington Road, Bedford, MA 01730 USA
[ PGP key available through <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJWxUAUAAoJEL54rhJi8gl5GcEP/iubChgKfa8SqskoVdCi9+P1
yBMrAZRqU2vfyiq+ZtLyr9K+0WbgliFot1RSxP/wXzvAt1zZo0dZyYsxdH6LhDi+
B6ACYVorpRxEsZ4U35wf1E892LRoeSXMDsjm//7vRvMkCssLanFtgcCO3sJ68uxe
URLFX+CsoJ82BsyqA4tm3HMQsfbSk6WN2pnf5ZkMy366FslbAkyR0PYM/kFfNBtm
Hd/J+M6lKzi5ZchxeeEX+h91iGkVg9HUcrvHyMwwR4nxnI0xCMscLoYrqbuacbe1
BCLW5+UYI1011soo5UBsbRXCRNAyL9JeMXmonpqPkXP41PlpOmFfwX7y+hCAzGnn
mW22iXY/YERYTKnote8VGaWxV0h6gthagyZWaY03AA/T4371aD+37xMzqKAAjWrO
3FuFo9B1ppYTjCmRRPHaQD5ccFJZmap1IWTsaHcJxEyNlHZ3YiyB5V2Nn8aZpSgC
1OoNodfBsC2fb+SkjXpEIpN8Aodw71ZQByFDjE65q20ZPYqbmUiOZgFlQ2mEYamO
EBv/LXxPKMRGC2vHSqkVu9qfh71s48bCKqhyz42HU0WnQyhsdgi0A2KdaVBBkDVz
81HTJUssP5UGoThf1xN5/y0nsHK0/VLhCV8oeEXd0WHiwrfzLARDiOrwhIDML0cD
o2JbErxSMlMhZSdwjTuU
=VVYc
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from publicobject.com_0dc55bed_20250124_121818.html ===

[PUBLIC OBJECT](https://publicobject.com)

# OkHttp Certificate Pinning Vulnerability!

Published on 2016-02-11

Bad news. When I [added](https://publicobject.com/2014/11/05/okhttp-2-1-rc1/) certificate pinning in OkHttp 2.1, I didn’t sanitize the server’s certificate chain. An attacker could exploit this weakness to defeat the protection offered by certificate pinning.

The vulnerability was disclosed to Square by security researcher [John Kozyrakis](https://twitter.com/ikoz). Whew! We fixed it in OkHttp 3.1.2, and backported that to OkHttp 2.7.4. Matthew McPherrin has [requested a CVE](http://permalink.gmane.org/gmane.comp.security.oss.general/18796) for this vulnerability.

If you’re using OkHttp, you should **upgrade to the latest version immediately!** Staying up to date on OkHttp is a good idea – we track the latest HTTPS cipher suites & TLS versions to [balance](https://github.com/square/okhttp/wiki/HTTPS) connectivity with security. It’s like keeping the browser up to date on your computer: staying current is the best way to stay safe.

[## Ceilings & Floors

I’ve been thinking about policies and incentives. A lot of motivation…

2016-02-20](/2016/02/20/ceilings-floors/)
[## LinkedHashMap is always better than HashMap

Deterministic code is much easier to debug & understand than non-determinstic code.…

2016-02-08](/2016/02/08/linkedhashmap-is-always-better-than-hashmap/)

Public Object is written by Jesse Wilson in Kitchener-Waterloo, Canada.
Check out my [Mastodon](https://cosocial.ca/%40jessewilson), [GitHub](https://github.com/swankjesse/), and [Presentations](/2024/09/26/jesses-presentations/). Or email me.


