Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

The vulnerability stems from the CMS Made Simple application using the `$_SERVER['HTTP_HOST']` variable instead of `$_SERVER['SERVER_NAME']` or an application-specific constant when Smarty Cache is enabled. This makes it possible to manipulate the Host header, which in turn poisons the web server cache.

**Weaknesses/Vulnerabilities:**

*   **Web Server Cache Poisoning:** The primary vulnerability is the ability to poison the web server cache. This is achieved by manipulating the `Host` HTTP header in a request.
*   **Improper HTML Entity Filtering:** The application does not properly filter HTML entities within the `$_SERVER` variable. Specifically,  the `Host` header can be manipulated to inject arbitrary HTML, leading to XSS.

**Impact of Exploitation:**

*   **Phishing Attacks:** By modifying links within the cached content, attackers can redirect users to malicious websites.
*   **Defacement:** Attackers can inject malicious content to deface the website.
*   **Cross-Site Scripting (XSS):** The lack of HTML entity filtering allows for the injection of arbitrary JavaScript code.

**Attack Vectors:**

*   **Remote, Unauthenticated:** The vulnerability is remotely exploitable by any attacker without requiring prior authentication.
*   **HTTP Host Header Manipulation:** The attack vector involves modifying the `Host` header of an HTTP request.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to send HTTP requests to the targeted web server.
*   The webserver must be configured to not include the Host header in the routing process. This is typically the case if the server hosts multiple domains.
*   The targeted CMS Made Simple installation must have Smarty Cache enabled.

**Additional Details:**

*   The vulnerability can only be triggered if the Host header is not part of the web server routing process (e.g., if multiple domains are served by the same web server).
*   The vulnerability is classified as CWE-20 (Improper Input Validation).
*   CVSS Base Score: 5.3 (CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N)

**Mitigation:**

*   Upgrade to CMS Made Simple 2.1.3 or 1.12.2.
*   Disable Smarty caching in the admin panel.
*   Use the `$_SERVER['SERVER_NAME']` variable instead of the `$_SERVER['HTTP_HOST']` variable or use an application specific constant.
*   Implement host whitelisting.

The provided content also includes proof-of-concept requests demonstrating how to inject XSS and modify links.