=== Content from gcc.gnu.org_e4a376c6_20250125_132947.html ===


This is the mail archive of the
gcc-patches@gcc.gnu.org
mailing list for the [GCC project](/).

---

| Index Nav: | [[Date Index](index.html#02030)] [[Subject Index](subjects.html#02030)] [[Author Index](authors.html#02030)] [[Thread Index](threads.html#02030)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg02029.html)] [[Date Next](msg02031.html)] | [[Thread Prev](msg02029.html)] [[Thread Next](msg02031.html)] |
| Other format: | [[Raw text](/cgi-bin/get-raw-msg?listname=gcc-patches&date=2016-06&msgid=2542F285-1E9B-4A52-A89C-5E06FC117020%40gmail.com)] |

# Fix fir PR71696 in Libiberty Demangler (6)

* *From*: Marcel BÃhme <boehme dot marcel at gmail dot com>
* *To*: gcc-patches List <gcc-patches at gcc dot gnu dot org>
* *Date*: Thu, 30 Jun 2016 14:46:18 +0800
* *Subject*: Fix fir PR71696 in Libiberty Demangler (6)
* *Authentication-results*: sourceware.org; auth=none

---

```
Hi,

The attached patch fixes the stack overflow in the demangler due to cycles in the references of ârememberedâ mangled types (<https://gcc.gnu.org/bugzilla/show_bug.cgi?id=71696>).

The methods demangle_signature and do_arg in cplus-dem.c allow to ârememberâ mangled type names that can later be referenced and will also be demangled. The method demangle_args demangles those types following any references. So, if there is a cycle in the referencing (or in the simplest case a self-reference), the method enters infinite recursion.

The patch tracks the mangled types that are currently being demangled in a new variable called work->proctypevec. If a referenced type is currently being demangled, the demangling is marked as not successful.

Bootstrapped and regression tested on x86_64-pc-linux-gnu. Test case added to libiberty/testsuite/demangler-expected and checked PR71696 is resolved.

Index: libiberty/ChangeLog
===================================================================
--- libiberty/ChangeLog	(revision 237852)
+++ libiberty/ChangeLog	(working copy)
@@ -1,3 +1,21 @@
+2016-06-30  Marcel BÃhme <boehme.marcel@gmail.com>
+
+	* cplus-dem.c: Prevent infinite recursion when there is a cycle
+	in the referencing of remembered mangled types.
+	(work_stuff): New stack to keep track of the remembered mangled
+	types that are currently being processed.
+	(push_processed_type): New method to push currently processed
+	remembered type onto the stack.
+	(pop_processed_type): New method to pop currently processed
+	remembered type from the stack.
+	(work_stuff_copy_to_from): Copy values of new variables.
+	(delete_non_B_K_work_stuff): Free stack memory.
+	(demangle_args): Push/Pop currently processed remembered type.
+	(do_type): Do not demangle a cyclic reference and push/pop
+	referenced remembered type.
+
+	* testsuite/demangle-expected: Add tests.
+
 2016-05-31  Alan Modra  <amodra@gmail.com>

 	* xmemdup.c (xmemdup): Use xmalloc rather than xcalloc.
Index: libiberty/cplus-dem.c
===================================================================
--- libiberty/cplus-dem.c	(revision 237852)
+++ libiberty/cplus-dem.c	(working copy)
@@ -144,6 +144,9 @@ struct work_stuff
   string* previous_argument; /* The last function argument demangled.  */
   int nrepeats;         /* The number of times to repeat the previous
 			   argument.  */
+  int *proctypevec;     /* Indices of currently processed remembered typevecs.  */
+  int proctypevec_size;
+  int nproctypes;
 };

 #define PRINT_ANSI_QUALIFIERS (work -> options & DMGL_ANSI)
@@ -436,6 +439,10 @@ iterate_demangle_function (struct work_stuff *,

 static void remember_type (struct work_stuff *, const char *, int);

+static void push_processed_type (struct work_stuff *, int);
+
+static void pop_processed_type (struct work_stuff *);
+
 static void remember_Btype (struct work_stuff *, const char *, int, int);

 static int register_Btype (struct work_stuff *);
@@ -1302,6 +1309,13 @@ work_stuff_copy_to_from (struct work_stuff *to, st
       memcpy (to->btypevec[i], from->btypevec[i], len);
     }

+  if (from->proctypevec)
+    {
+      to->proctypevec = XNEWVEC (int, from->proctypevec_size);
+      memcpy (to->proctypevec, from->proctypevec,
+	      from->proctypevec_size * sizeof(int));
+    }
+
   if (from->ntmpl_args)
     to->tmpl_argvec = XNEWVEC (char *, from->ntmpl_args);

@@ -1336,6 +1350,12 @@ delete_non_B_K_work_stuff (struct work_stuff *work
       work -> typevec = NULL;
       work -> typevec_size = 0;
     }
+  if (work -> proctypevec != NULL)
+    {
+      free (work -> proctypevec);
+      work -> proctypevec = NULL;
+      work -> proctypevec_size = 0;
+    }
   if (work->tmpl_argvec)
     {
       int i;
@@ -3554,6 +3574,8 @@ static int
 do_type (struct work_stuff *work, const char **mangled, string *result)
 {
   int n;
+  int i;
+  int is_proctypevec;
   int done;
   int success;
   string decl;
@@ -3566,6 +3588,7 @@ do_type (struct work_stuff *work, const char **man

   done = 0;
   success = 1;
+  is_proctypevec = 0;
   while (success && !done)
     {
       int member;
@@ -3626,7 +3649,14 @@ do_type (struct work_stuff *work, const char **man
 	      success = 0;
 	    }
 	  else
-	    {
+	    for (i = 0; i < work -> nproctypes; i++)
+	      if (work -> proctypevec [i] == n)
+	        success = 0;
+
+	  if (success)
+	    {
+	      is_proctypevec = 1;
+	      push_processed_type (work, n);
 	      remembered_type = work -> typevec[n];
 	      mangled = &remembered_type;
 	    }
@@ -3849,6 +3879,9 @@ do_type (struct work_stuff *work, const char **man
     string_delete (result);
   string_delete (&decl);

+  if (is_proctypevec)
+    pop_processed_type (work);
+
   if (success)
     /* Assume an integral type, if we're not sure.  */
     return (int) ((tk == tk_none) ? tk_integral : tk);
@@ -4261,6 +4294,34 @@ do_arg (struct work_stuff *work, const char **mang
 }

 static void
+push_processed_type (struct work_stuff *work, int typevec_index)
+{
+  if (work -> nproctypes >= work -> proctypevec_size)
+    {
+      if (work -> proctypevec_size == 0)
+	{
+	  work -> proctypevec_size = 3;
+	  work -> proctypevec = XNEWVEC (int, work -> proctypevec_size);
+	}
+      else
+	{
+	  if (work -> proctypevec_size > INT_MAX / 2)
+            xmalloc_failed (INT_MAX);
+          work -> proctypevec_size *= 2;
+          work -> proctypevec
+            = XRESIZEVEC (int, work->proctypevec, work->proctypevec_size);
+        }
+    }
+    work -> proctypevec [work -> nproctypes ++] = typevec_index;
+}
+
+static void
+pop_processed_type (struct work_stuff *work)
+{
+  work -> nproctypes --;
+}
+
+static void
 remember_type (struct work_stuff *work, const char *start, int len)
 {
   char *tem;
@@ -4524,10 +4585,13 @@ demangle_args (struct work_stuff *work, const char
 		{
 		  string_append (declp, ", ");
 		}
+	      push_processed_type (work, t);
 	      if (!do_arg (work, &tem, &arg))
 		{
+		  pop_processed_type (work);
 		  return (0);
 		}
+	      pop_processed_type (work);
 	      if (PRINT_ARG_TYPES)
 		{
 		  string_appends (declp, &arg);
Index: libiberty/testsuite/demangle-expected
===================================================================
--- libiberty/testsuite/demangle-expected	(revision 237852)
+++ libiberty/testsuite/demangle-expected	(working copy)
@@ -4556,3 +4556,8 @@ __vt_90000000000cafebabe

 _Z80800000000000000000000
 _Z80800000000000000000000
+#
+# Tests stack overflow PR71696
+
+__10%0__S4_0T0T0
+%0<>::%0(%0<>)

```

---

| Index Nav: | [[Date Index](index.html#02030)] [[Subject Index](subjects.html#02030)] [[Author Index](authors.html#02030)] [[Thread Index](threads.html#02030)] | |
| --- | --- | --- |
| Message Nav: | [[Date Prev](msg02029.html)] [[Date Next](msg02031.html)] | [[Thread Prev](msg02029.html)] [[Thread Next](msg02031.html)] |



=== Content from www.openwall.com_44c85340_20250125_132945.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[thread-next>]](7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <9BC348CE-0958-4F38-A0DB-D228EE0D9E27@gmail.com>
Date: Thu, 30 Jun 2016 15:25:16 +0800
From: Marcel Böhme <boehme.marcel@...il.com>
To: oss-security@...ts.openwall.com
Cc: florian@...h-krohm.de,
 nickc@...hat.com,
 Bernd Schmidt <bschmidt@...hat.com>
Subject: CVE Request: No demangling of untrusted binaries (2)

Hi all,

Another vulnerability in GNU Libiberty was found that impacts the security of binary analysis tools, such as Valgrind, GDB, Binutils (e.g., objdump, nm, ..), Gcov, or other LibBFD-based tools. An attacker might modify a program binary such that it executes malicious code upon *analysis* of the binary (e.g., to find whether it is malicious in the first place) or during the attempt to reverse-engineer an untrusted binary.

Workaround: Until the patches propagate to the vulnerable tools, switch off default demangling! E.g.,
$ echo "set demangle-style none"  >>  ~/.gdbinit
$ echo "--demangle=no" >> ~/.valgrindrc

A stackoverflow in the libiberty demangler causes its host application to crash on a tainted branch instruction. The problem is caused by a self-reference in a mangled type string that is "remembered" for later reference. This leads to an infinite recursion during the demangling.
* GDB exploitable classifies the stack overflow as exploitable.
* Bug Report: <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=71696>
* Patch under review: <https://gcc.gnu.org/ml/gcc-patches/2016-06/msg02030.html>

All vulnerabilities were found with a more efficient version of the AFL fuzzer, called AFLFast.

Update on the previously reported, related vulnerabilities:
CVE-2016-2226: Fixed in trunk
CVE-2016-4487: Fixed in trunk
CVE-2016-4488: Fixed in trunk
CVE-2016-4489: Fixed in trunk
CVE-2016-4490: Fixed in trunk
CVE-2016-4491: Patch under review
CVE-2016-4492: Patch accepted
CVE-2016-4493: Patch accepted

Best regards,
- Marcel

---
Marcel Böhme
Post-doctoral Research Fellow
TSUNAMi Security Research Center
National University of Singapore
```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from gcc.gnu.org_e5eea816_20250125_132946.html ===


GCC Bugzilla – Bug 71696
Libiberty Demangler segfaults (6)
Last modified: 2016-08-04 16:54:04 UTC

* [Home](./)
* | [New](enter_bug.cgi?product=gcc)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?id=71696&GoAheadAndLogIn=1)

  Remember

  [x]
* |
  [Forgot Password](show_bug.cgi?id=71696&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

[**Bug 71696**](show_bug.cgi?id=71696)
- Libiberty Demangler segfaults (6)

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
Libiberty Demangler segfaults (6)

| | [Status](page.cgi?id=fields.html#bug_status): | RESOLVED FIXED | | --- | --- | |  | | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | None | |  | | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components.") | gcc | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Unclassified | | [Component:](describecomponents.cgi?product=gcc "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | c++ ([show other bugs](buglist.cgi?component=c%2B%2B&product=gcc&bug_status=__open__)) | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unknown | |  | | | [Importance](page.cgi?id=fields.html#importance): | P3 normal | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Not yet assigned to anyone | |  | | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Keywords:](describekeywords.cgi "You can add keywords from a defined list to bugs, in order to easily identify and group them.") |  | |  | | | [Depends on:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") |  | |  | | Reported: | 2016-06-29 13:42 UTC by Marcel Böhme | | --- | --- | | Modified: | 2016-08-04 16:54 UTC ([History](show_activity.cgi?id=71696)) | | CC List: | 2 users (show)  jeffreyalaw webrown.cpp | |  | | | [See Also:](page.cgi?id=fields.html#see_also "This allows you to refer to bugs in other installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with whitespace. You should normally use this field to refer to bugs in other installations. For bugs in this installation, it is better to use the Depends on and Blocks fields.") |  | | [Host:](page.cgi?id=fields.html#cf_gcchost "The machine that you are building for. That's the value you passed to ./configure --host.") |  | | [Target:](page.cgi?id=fields.html#cf_gcctarget "The machine that GCC will produce code for. That's the value you passed to ./configure --target.") |  | | [Build:](page.cgi?id=fields.html#cf_gccbuild "The machine you are building on. That's the value you passed to ./configure --build.") |  | | [Known to work:](page.cgi?id=fields.html#cf_known_to_work "Known versions for which the issue is not reproducible.") |  | | [Known to fail:](page.cgi?id=fields.html#cf_known_to_fail "Known versions for which the issue is reproducible.") |  | | [Last reconfirmed:](page.cgi?id=fields.html#cf_reconfirmed_on "Last time the issue was confirmed as still being present.") | 2016-06-30 00:00:00 | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | | | --- | --- | | [Add an attachment](attachment.cgi?bugid=71696&action=enter) (proposed patch, testcase, etc.) | |   | Note You need to [log in](show_bug.cgi?id=71696&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. | | --- | |  |
| --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=71696#c0)  Marcel Böhme    2016-06-29 13:42:52 UTC  ``` A stackoverflow in the libiberty demangler causes its host application to crash on a tainted branch instruction. The problem is caused by a self-reference in a mangled type string that is "remembered" for later reference. This leads to an infinite recursion during the demangling.  How to reproduce: $ valgrind cxxfilt __33%00000000000000000000__S8_00T0000T0 ==30184== Memcheck, a memory error detector ==30184== Copyright (C) 2002-2013, and GNU GPL'd, by Julian Seward et al. ==30184== Using Valgrind-3.10.1 and LibVEX; rerun with -h for copyright info ==30184== Command: ../../binutils_git5/libiberty/testsuite/test-demangle ==30184==  ==30184== Stack overflow in thread 1: can't grow stack to 0xffe801ff8 ..  $ valgrind cxxfilt __10%0__S4_0T0T0 ..  Analysis: The demangler "remembers" mangled types that can later be referenced in the mangled string. In this case the complete string is remembered in work->typevec[0] before it is demangled in cplus-dem.c:4534. Now, a part of the mangled string ("T0000") references the remembered type stored at work->typevec[0] which is supposed to be demangled as well (cplus-dem.c:3632).  The tool was found with a more efficient version of AFL, called AFL-Fast. I am preparing a patch. ```  [Comment 1](show_bug.cgi?id=71696#c1)  Martin Liška    2016-06-30 08:10:35 UTC  ``` Confirmed. ```  [Comment 2](show_bug.cgi?id=71696#c2)  Jeffrey A. Law    2016-08-04 16:53:50 UTC  ``` Author: law Date: Thu Aug  4 16:53:18 2016 New Revision: 239143  URL: <https://gcc.gnu.org/viewcvs?rev=239143&root=gcc&view=rev> Log: 2016-08-04  Marcel Böhme  <boehme.marcel@gmail.com>  	[PR c++/71696](show_bug.cgi?id=71696 "RESOLVED FIXED - Libiberty Demangler segfaults (6)") 	* cplus-dem.c: Prevent infinite recursion when there is a cycle 	in the referencing of remembered mangled types. 	(work_stuff): New stack to keep track of the remembered mangled 	types that are currently being processed. 	(push_processed_type): New method to push currently processed 	remembered type onto the stack. 	(pop_processed_type): New method to pop currently processed 	remembered type from the stack. 	(work_stuff_copy_to_from): Copy values of new variables. 	(delete_non_B_K_work_stuff): Free stack memory. 	(demangle_args): Push/Pop currently processed remembered type. 	(do_type): Do not demangle a cyclic reference and push/pop 	referenced remembered type.  Modified:     trunk/libiberty/ChangeLog     trunk/libiberty/cplus-dem.c     trunk/libiberty/testsuite/demangle-expected ```  [Comment 3](show_bug.cgi?id=71696#c3)  Jeffrey A. Law    2016-08-04 16:54:04 UTC  ``` Should be fixed on trunk now. ``` |  |
| --- | --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=71696)
* - [XML](show_bug.cgi?ctype=xml&id=71696)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=71696)
* - Top of page

* + [Home](./)
  + | [New](enter_bug.cgi?product=gcc)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Help](https://bugzilla.readthedocs.org/en/5.0/using/understanding.html)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?id=71696&GoAheadAndLogIn=1)

    Remember

    [x]
  + |
    [Forgot Password](show_bug.cgi?id=71696&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from www.openwall.com_d2bd7c26_20250125_132945.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](4) [[thread-next>]](8) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160630134439.2449D6C0AE6@smtpvmsrv1.mitre.org>
Date: Thu, 30 Jun 2016 09:44:39 -0400 (EDT)
From: cve-assign@...re.org
To: boehme.marcel@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com, florian@...h-krohm.de, nickc@...hat.com, bschmidt@...hat.com
Subject: Re: CVE Request: No demangling of untrusted binaries (2)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> A stackoverflow in the libiberty demangler causes its host application
> to crash on a tainted branch instruction. The problem is caused by a
> self-reference in a mangled type string that is "remembered" for later
> reference. This leads to an infinite recursion during the demangling.
>
> * GDB exploitable classifies the stack overflow as exploitable.
>
> * Bug Report: <https://gcc.gnu.org/bugzilla/show_bug.cgi?id=71696>
>
> * Patch under review: <https://gcc.gnu.org/ml/gcc-patches/2016-06/msg02030.html>
>
> All vulnerabilities were found with a more efficient version of the AFL fuzzer, called AFLFast.

>> The patch tracks the mangled types that are currently being demangled
>> in a new variable called work->proctypevec. If a referenced type is
>> currently being demangled, the demangling is marked as not successful.

Use CVE-2016-6131.

As far as we can tell, there was only one vulnerability reported here.
We don't understand the reference to "All vulnerabilities were found
with" - this seems to imply more than one vulnerability. Also, we
don't understand the parenthesized numbers such as "No demangling of
untrusted binaries (2)" in the Subject line, and "Libiberty Demangler
segfaults (6)" and "Fix fir PR71696 in Libiberty Demangler (6)" in the
references.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXdSHOAAoJEHb/MwWLVhi2SOMP/37QfylN++UvAd0PdO/ZTc00
Vk+piwJvzeVoAv2Jp8ZwU1S4hj43LlXR9WrK0NX/lLUwId69Zao6faWGO203hDnz
4TrmvuRyVT7jT5df6NVadwOawEeEklRuI56fBnm7e09nuchLpg1314TsiyqmHo1C
Ca41bfkIj091KAKW3nKER37ALb2DG2dSfR4+9ksTaalhdDwaykKwy9eYHcbA7+Sd
76Dra1MRTGgHr+YTIrqASn+lXC/ar/+rqy81oUZK38XviK8rkK+oKY6ODz9DHmED
815kkv8iflHezxsEW5PSWP9oQ5C7wGD7bju480ziqZF/r8bjW5dwm5jeEiTd6XWj
b1R05LqhnldiaSlYT/TqaFz6Pbu3uEbTUjOqH/Sn85MHFLVKJ3ZeLOzYUamaDRN7
KcHQPNM2GW6zcJJax9UEd0qseCvmn04X9NrNNjL06RstrxGtLeFGRQjyRX83uRij
mue5U2pf27YSKeVTo3CHw/q65Xwe+a/uSOoJzGYnmkGdx2Eu/3DKLsCqxP9d5BA2
jY+MnwkvctJpBzy6kxfeSGJkZ/N7np/yzD6k/hfJrGEgTaB7qfZ8NeHX3WTjiT73
MvkAAvICRwnLRN93buvCwMDQNl4xOSCVg3eK2slpxFxaU6/dsH/W+BUN20/Gkmf6
dsWpgmbMAUIb6gmzPCR2
=De4P
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


