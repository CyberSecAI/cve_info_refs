=== Content from www.kb.cert.org_40e08ca7_20250124_193958.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#548487

## BSD libc contains a buffer overflow vulnerability in link\_ntoa()

#### Vulnerability Note VU#548487

Original Release Date: 2016-12-06 | Last Revised: 2016-12-08

---

### Overview

The BSD libc library's link\_ntoa() function may be vulnerable to a classic buffer overflow. It is currently unclear if this issue is exploitable.

### Description

| [**CWE-120**](http://cwe.mitre.org/data/definitions/120.html)**: Buffer Copy without Checking Size of Input ('Classic Buffer Overflow') -** CVE-2016-6559  Improper bounds checking of the obuf variable in the link\_ntoa() function in linkaddr.c may allow an attacker to read or write from memory.The full impact and severity depends on the method of exploit and how the library is used by applications. According to analysis by FreeBSD developers, it is very unlikely that applications exist that utilize link\_ntoa() in an exploitable manner, and the CERT/CC is not aware of any proof of concept. A [blog post](http://www.tedunangst.com/flak/post/who-even-calls-link-ntoa) describes the functionality of link\_ntoa() and points out that none of the base utilities use this function in an exploitable manner. For more information, please see [FreeBSD Security Advisory SA-16:37](https://www.freebsd.org/security/advisories/FreeBSD-SA-16%3A37.libc.asc).The CVSS score below reflects a worst-case scenario in which an attacker may execute arbitrary code with root permissions. It is unclear if any program exists that would allow exploit in any manner. |
| --- |

### Impact

| The full impact and severity depends on the method of exploit and how the library is used by applications. An attacker may be able to execute arbitrary code, but CERT/CC is currently unaware of a proof of concept. |
| --- |

### Solution

| **Apply an update**FreeBSD libc was updated to address this vulnerability. Affected users are encouraged to upgrade to the latest version of libc and/or the latest release of your operating system.In FreeBSD, the following patch levels (or later) contain a fix:9.3-RELEASE-p5110.1-RELEASE-p4310.2-RELEASE-p2610.3-RELEASE-p1311.0-RELEASE-p4 |
| --- |

### Vendor Information

548487
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23548487/) to view vendors.**
### [Apple](#BLUU-AELAM3) Affected

Notified:  October 10, 2016  Updated: November 16, 2016

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [FreeBSD Project](#BLUU-AEXLCQ) Affected

Notified:  October 21, 2016  Updated: November 21, 2016

**Statement Date:   November 21, 2016**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

In FreeBSD, the following patch levels (or later) contain a fix:

9.3-RELEASE-p51
10.1-RELEASE-p43
10.2-RELEASE-p26
10.3-RELEASE-p13
11.0-RELEASE-p4

### [HardenedBSD](#BLUU-AF4LHC) Affected

Notified:  October 26, 2016  Updated: December 07, 2016

**Statement Date:   December 07, 2016**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

HardenedBSD has fixed this issue in the latest releases. Please see the commit URLs below.

### Vendor References

* <https://github.com/HardenedBSD/hardenedBSD-stable/releases/tag/HardenedBSD-10-STABLE-v46.20>
* <https://github.com/HardenedBSD/hardenedBSD-stable/releases/tag/HardenedBSD-11-STABLE-v46.11>

### [NetBSD](#BLUU-AF4LH3) Affected

Notified:  October 26, 2016  Updated: December 08, 2016

**Statement Date:   December 08, 2016**

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

NetBSD has updated on 20161207 to address this issue.

### [DesktopBSD](#BLUU-AF4LGH) Unknown

Notified:  October 26, 2016  Updated: October 26, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [DragonFly BSD Project](#BLUU-AF4LH7) Unknown

Notified:  October 26, 2016  Updated: October 26, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [F5 Networks, Inc.](#BLUU-AF4LHE) Unknown

Notified:  October 26, 2016  Updated: October 26, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Juniper Networks](#BLUU-AF4LGU) Unknown

Notified:  October 26, 2016  Updated: October 26, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [Nokia](#BLUU-AF4LGW) Unknown

Notified:  October 26, 2016  Updated: October 26, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [OpenBSD](#BLUU-AF4LGQ) Unknown

Notified:  October 26, 2016  Updated: December 08, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

OpenBSD shares the same affected code, see below:

### Vendor References

* <http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/lib/libc/net/linkaddr.c?sortby=date>

### [PC-BSD](#BLUU-AFRLUN) Unknown

Notified:  November 16, 2016  Updated: November 16, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [QNX Software Systems Inc.](#BLUU-AF4LH9) Unknown

Notified:  October 26, 2016  Updated: October 26, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor References

### [TrueOS](#GWAN-AFRLZZ) Unknown

Notified:  November 16, 2016  Updated: November 16, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

View all 13 vendorsView less vendors

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9.3 | AV:N/AC:M/Au:N/C:C/I:C/A:C |
| Temporal | 6.9 | E:U/RL:OF/RC:C |
| Environmental | 1.7 | CDP:ND/TD:L/CR:ND/IR:ND/AR:ND |

### References

* [https://www.freebsd.org/security/advisories/FreeBSD-SA-16:37.libc.asc](https://www.freebsd.org/security/advisories/FreeBSD-SA-16%3A37.libc.asc)
* <https://github.com/freebsd/freebsd/blob/386ddae58459341ec567604707805814a2128a57/lib/libc/net/linkaddr.c#L132>
* <http://www.tedunangst.com/flak/post/who-even-calls-link-ntoa>
* <http://cwe.mitre.org/data/definitions/120.html>
### Acknowledgements

Thanks to the reporter who wishes to remain anonymous.

This document was written by Garret Wassermann.

### Other Information

| **CVE IDs:** | [CVE-2016-6559](http://web.nvd.nist.gov/vuln/detail/CVE-2016-6559) |
| --- | --- |
| **Date Public:** | 2016-12-06 |
| **Date First Published:** | 2016-12-06 |
| **Date Last Updated:** | 2016-12-08 22:54 UTC |
| **Document Revision:** | 54 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800



=== Content from www.freebsd.org_083cd95b_20250124_193958.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-16:37.libc Security Advisory
The FreeBSD Project
Topic: link\_ntoa(3) buffer overflow
Category: core
Module: libc
Announced: 2016-12-06, revised on 2016-12-08
Affects: All supported versions of FreeBSD.
Corrected: 2016-12-07 23:19:46 UTC (stable/11, 11.0-STABLE)
2016-12-07 23:29:42 UTC (releng/11.0, 11.0-RELEASE-p5)
2016-12-07 23:20:26 UTC (stable/10, 10.3-STABLE)
2016-12-07 23:31:07 UTC (releng/10.3, 10.3-RELEASE-p14)
2016-12-07 23:32:42 UTC (releng/10.2, 10.2-RELEASE-p27)
2016-12-07 23:34:06 UTC (releng/10.1, 10.1-RELEASE-p44)
2016-12-07 23:20:50 UTC (stable/9, 9.3-STABLE)
2016-12-07 23:35:15 UTC (releng/9.3, 9.3-RELEASE-p52)
CVE Name: CVE-2016-6559
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
0. Revision history.
v1.0 2016-12-06 Initial release.
v1.1 2016-12-08 Revised patches to address regressions.
I. Background
The link\_ntoa(3) function generates ASCII representation of a link-level
address and is avaliable as part of standard C library (libc).
II. Problem Description
A specially crafted argument can trigger a static buffer overflow in the
library, with possibility to rewrite following static buffers that belong to
other library functions.
III. Impact
Due to very limited use of the function in the existing applications,
and limited length of the overflow, exploitation of the vulnerability
does not seem feasible. None of the utilities and daemons in the base
system are known to be vulnerable. However, careful review of third
party software that may use the function was not performed.
IV. Workaround
No workaround is available.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
Restart all daemons that use the library, or reboot the system.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
[\*\*\* v1.1 NOTE \*\*\*] If your sources are not yet patched using the initially
published patch, then you need to apply libc.patch. If your sources are
already updated, or patched with patch from the initial advisory, then you
need to apply the incremental patch, named libc-inc.patch.
[FreeBSD system, not patched with initial SA-16:37 patch]
# fetch https://security.FreeBSD.org/patches/SA-16:37/libc.patch
# fetch https://security.FreeBSD.org/patches/SA-16:37/libc.patch.asc
# gpg --verify libc.patch.asc
[FreeBSD system, initial SA-16:37 patch already applied]
# fetch https://security.FreeBSD.org/patches/SA-16:37/libc-inc.patch
# fetch https://security.FreeBSD.org/patches/SA-16:37/libc-inc.patch.asc
# gpg --verify libc-inc.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
Restart all daemons that use the library, or reboot the system.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/9/ r309691
releng/9.3/ r309697
stable/10/ r309690
releng/10.1/ r309696
releng/10.2/ r309694
releng/10.3/ r309693
stable/11/ r309689
releng/11.0/ r309692
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
iQIcBAEBCgAGBQJYSNoxAAoJEO1n7NZdz2rnQfQP/0oJ8WdTTVMpjEHRBQ7WbayB
f7Y8MeVFErNLL8caQDxRyiF/ex07m5m2morik84ggDTkHiWnllaP0H3MadivP9Ly
XspViMU73r49PmYTAsrMARyW2ncufgGpsvaEcVOVKEAiwcm0ATu7gnTf+cyrfWoe
k9HlTS18bN18zQ/FFSJPjmIsTh8Cb+cdF6SrVEt7bIcoVzZWMU/sDJP9JDnRFa3+
o7bWDQg3kfA8k3XEzrL9FSO52Sr9jNslZGAaycFFQjxecgC/05mTbqPsJOpdhkaC
mfcARX/8+iwxsE/3h7R5OK6vsu6piUE6vi8HsnTwK7ZMz/IYkPpe4C9WroRYAG29
mqBl+qdVElk/DXPgsz6F7PHqG3SUY3Kkn/bMGT4B3yLjNvWs4+pjh74uyvVLPKkQ
meQEs3VLl+c0VkpAxbieMS1KChJwBAKAD7Cevg83YfosC8/LFRoqS6kofjXjVqCd
dd0cSWyOE6y/eFy2187lncnz1BNW1Eg8AEH02vEkXOI5hrnhmO6t0cH9dQcj3nHa
6yULqFHJJJGsGqPD1/FkXjn7hAMKsMMROCGpY0txNVA2a3Z6zf593nZL7Vr1nPy7
7C7/sKToSilR3OJGoSFxNlRHqkgb08dQOzsof/355M94baKw82QAULuQoOBYu0DU
PZ21bNtGfZSN4rThyVuQ
=Id1+
-----END PGP SIGNATURE-----

