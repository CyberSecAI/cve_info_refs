Based on the provided information, here's an analysis of CVE-2016-6191:

**Root Cause of Vulnerability:**

The root cause is the lack of proper HTML escaping when displaying the raw source of calendar events and tasks in the SOGo web UI. Specifically, the application was directly rendering user-supplied content within a `<pre>` tag which allowed for the execution of malicious JavaScript code embedded within the calendar entry's description, location, URL, or title fields when viewing the raw source.

**Weaknesses/Vulnerabilities Present:**

*   **Cross-Site Scripting (XSS):** The primary vulnerability is a persistent XSS issue. This means the malicious script is stored in the database and executed every time a user views the raw source of a calendar entry containing the malicious script.
*   **Lack of Input Sanitization:** The application failed to sanitize or encode user-supplied data before rendering it within the HTML context, making it vulnerable to XSS injection.

**Impact of Exploitation:**

*   **Arbitrary JavaScript Execution:** Successful exploitation allows an attacker to execute arbitrary JavaScript code in the context of the victim's browser.
*   **Data Theft and Manipulation:** Attackers could steal session cookies, modify content on the page, or redirect users to malicious sites, potentially leading to data theft or further compromise of user accounts.
*   **Account Takeover:** In some cases, if an attacker gains control of a user session, it could potentially lead to account takeover.

**Attack Vectors:**

*   **Malicious Calendar Entries:** An attacker could inject malicious JavaScript code into various fields of a calendar entry such as "Description", "Location", "URL", or "Title".
*   **User Interaction:** The victim needs to interact with the crafted calendar entry and click on "View Raw Source" to trigger the execution of malicious code.

**Required Attacker Capabilities/Position:**

*   **Authenticated User:** An attacker needs to have a valid user account on the SOGo system.
*   **Ability to Create Calendar Entries:** An attacker needs to be able to create calendar entries or modify existing ones.
*   **No Direct Network Access:**  The attack is performed within the web application, not requiring network-level access to the server.

**Additional Details:**

* The fix involves escaping HTML entities in the raw source of events and tasks before rendering. This is done by adding `[response appendContentString: [content stringByEscapingHTMLString]];` in `UI/Scheduler/UIxComponentEditor.m`. The javascript part was fixed by removing `ng-bind-html` from the view template.
* The vulnerability was also found to exist in the raw source view of cards, and the fix was applied to that area as well in a separate commit.
* The vulnerability is described as a "DOM-based XSS" by the reporter, although, technically, it's more of a classic stored XSS since the malicious payload is stored and executed later.
* The issue was initially reported with a specific calendar entry created via Thunderbird, but it's likely the issue would occur if the entry was created directly within the SOGo web UI.