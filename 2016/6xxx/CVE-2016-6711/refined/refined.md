Based on the provided information, here's an analysis of CVE-2016-6711:

**Root cause of vulnerability:**
The vulnerability lies in the VP8 decoder within the `libvpx` library. Specifically, the decoder crashes when encountering an invalid leading keyframe. The issue arises when the same invalid keyframe is decoded twice. The second time through the decoder, the decoder assumes initialization has occurred when it has not because there was no resolution change. In this specific scenario, the resolution itself was invalid, but the `vp8_peek_si()` function was failing only in the case of `0x0`.

**Weaknesses/vulnerabilities present:**
- Improper handling of invalid keyframes in the VP8 decoder.
- Lack of proper initialization checks during repeated decoding of invalid keyframes, leading to a crash.
- The `vp8_peek_si()` function does not handle invalid resolution values correctly.

**Impact of exploitation:**
- Denial of Service (DoS): The vulnerability leads to a crash in the Mediaserver process, potentially causing a device hang or reboot.

**Attack vectors:**
- The vulnerability can be triggered by processing a specially crafted media file containing an invalid VP8 keyframe.
- Attackers could exploit this via email, web browsing or MMS, if the application processes the crafted media content and uses the vulnerable VP8 decoder.

**Required attacker capabilities/position:**
- Ability to craft or obtain a malicious media file containing an invalid VP8 keyframe.
- Ability to deliver the crafted file to a vulnerable device via an exploitable vector such as a media file sent by MMS, email, or a web page visited by the user.

**Additional notes**
- The fix involves adding a check to ensure the decoder can resume decoding without error, even with a duplicated invalid keyframe.
- The provided commit log indicates a test case has been created (`invalid-vp80-00-comprehensive-018.ivf.2kf_0x6.ivf`) which duplicates the first keyframe and adds a valid one to ensure decoding can resume without error.