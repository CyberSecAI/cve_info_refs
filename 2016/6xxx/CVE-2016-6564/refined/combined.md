=== Content from www.bitsighttech.com_5c62fd95_20250125_235545.html ===

[Skip to main content](#main-content)

Expand Search

Search for

## Utility

* [Blog](/blog)
* [Partners](/partners)
* [Request Demo](/demo/security-rating)
* [Chat With Us](#chatnow)
* [Login](https://service.bitsighttech.com/)

[xml version="1.0" encoding="utf-8"?

xml version="1.0" encoding="utf-8"?](/ "Home")

[See Your Rating](/security-ratings-snapshot-report)

[xml version="1.0" encoding="utf-8"?

xml version="1.0" encoding="utf-8"?](/ "Home")

Show/Hide Main Menu

Search for

* Products

  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Products_EnterpriseSecurity.svg)
    Enterprise Security

    - [Security Performance Management](https://www.bitsight.com/products/security-performance-management)
    - [External Attack Surface Management](https://www.bitsight.com/products/external-attack-surface-management)
    - [Cybersecurity Analytics](https://www.bitsight.com/products/governance-and-analytics)
    - [Security Ratings](https://www.bitsight.com/security-ratings)
    - [Cyber Threat Intelligence
      NEW](https://www.bitsight.com/products/cyber-threat-intelligence)
    - [SPM Integrations](https://www.bitsight.com/products/spm-integrations)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Products_DigitalSupplyChainSecurity.svg)
    Digital Supply Chain

    - [Third-Party Risk Management](https://www.bitsight.com/products/third-party-risk-management)
    - [Vendor Risk Management](https://www.bitsight.com/products/vendor-risk-management)
    - [Continuous Monitoring](https://www.bitsight.com/products/continuous-monitoring)
    - [Vulnerability Detection & Response](https://www.bitsight.com/products/vulnerability-detection-response)
    - [Trust Management Hub](https://www.bitsight.com/products/trust-management-hub)
    - [TPRM Integrations](https://www.bitsight.com/products/tprm-integrations)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Products_RiskGovernanceReporting.svg)
    Cyber Governance & Reporting

    - [Cybersecurity Ratings](https://www.bitsight.com/security-ratings)
    - [Cybersecurity Regulations](https://www.bitsight.com/cybersecurity-regulations)
    - [Cyber Risk Quantification](https://www.bitsight.com/products/financial-quantification-enterprise-cyber-risk)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Products_RiskAnalysisData.svg)
    Cybersecurity Data Feed

    - [Cyber Data Solutions](https://www.bitsight.com/cybersecurity-data-solutions)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Products_CyberUnderwritingRiskControl.svg)
    Cyber Underwriting & Risk Control

    - [Cyber Insurance](https://www.bitsight.com/products/bitsight-for-cyber-insurance)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Produ_ProfessionalServices.svg)
    Professional Services

    - [Service Offerings](https://www.bitsight.com/bitsight-professional-services)
  ![](https://www.bitsight.com/sites/default/files/2024/04/27/Sidebar_LightBulb.svg)
  [Free Attack Surface Report](https://www.bitsight.com/get-free-attack-surface-report)

  Your attack surface is expanding—know exactly how it looks. Our report gives you the insights you need to **see your external attack surface**.

  [Receive custom report](https://www.bitsight.com/get-free-attack-surface-report)
* Solutions

  See beyond borders

  Bitsight enables risk and security leaders to see beyond the firewall — to the vendors and partners, clouds and applications, patches and programs — that introduce risk in your digital ecosystem.

  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Solutions_UseCases.svg)
    By Use Cases

    - [Exposure Management](https://www.bitsight.com/solutions/exposure-management)
    - [Third-Party Risk Management](https://www.bitsight.com/products/third-party-risk-management)
    - [Reporting and Compliance](https://www.bitsight.com/products/governance-and-analytics)
    - [Cybersecurity Regulations
      NEW](https://www.bitsight.com/cybersecurity-regulations)
    - [Continuous Monitoring](https://www.bitsight.com/uses/continuous-monitoring)
    - [Executive Reporting](https://www.bitsight.com/uses/executive-cybersecurity-reporting)
    - [Supply Chain Visibility](https://www.bitsight.com/uses/supply-chain-cybersecurity-risk-management)
    - [Investment Management](https://www.bitsight.com/uses/investment-management)
    - [National Cybersecurity](https://www.bitsight.com/products/national-cybersecurity)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Solutions_Industries.svg)
    By Industry

    - [Financial Services](https://www.bitsight.com/industries/financial-services)
    - [Insurance Services](https://www.bitsight.com/industries/insurance)
    - [Healthcare](https://www.bitsight.com/industries/healthcare-organizations)
    - [Government](https://www.bitsight.com/industries/government)
    - [Technology](https://www.bitsight.com/industries/technology)
    - [Energy/Utilities](https://www.bitsight.com/industries/energy-and-utilities)
    - [Retail](https://www.bitsight.com/industries/security-ratings-retail)
    - [Manufacturing](https://www.bitsight.com/industries/cyber-risk-management-for-manufacturing)
    - [Education](https://www.bitsight.com/industries/cyber-risk-management-solutions-for-education)
  ![](https://www.bitsight.com/sites/default/files/2024/04/27/Sidebar_LightBulb.svg)
  [Bitsight to Acquire Cyber Threat Intelligence Leader Cybersixgill to Help Enterprises to Preempt Cyber Attacks](https://www.bitsight.com/press-releases/bitsight-acquire-cyber-threat-intelligence-leader-cybersixgill-help-enterprises)

  [Read release](https://www.bitsight.com/press-releases/bitsight-acquire-cyber-threat-intelligence-leader-cybersixgill-help-enterprises)
* Data & Research

  Trust in our data

  We combine real-time discovery of networks, assets, and vulnerabilities with our AI attribution engine and over 100 security researchers to amass one of the largest and mapped risk datasets in the world.

  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/DataInsights_OurData.svg)
    [Our Data](https://www.bitsight.com/data/cyber-data-and-insights)

    - [Data & Insights](https://www.bitsight.com/data/cyber-data-and-insights)
    - [Data Correlation & Studies](https://www.bitsight.com/data/correlation-to-outcomes)
    - [Data Discovery](https://www.bitsight.com/data/cyber-data-risk-discovery)
    - [Data Mapping & Attribution
      NEW](https://www.bitsight.com/data/mapping-and-attribution)
    - [Cyber Data for Capital Markets](https://www.bitsight.com/data/capital-markets)
    - [Groma Explorer: Internet Software Observations
      NEW](https://www.bitsight.com/groma-explorer)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/DataInsights_ThreatResearch.svg)
    [Our Research](https://www.bitsight.com/trace)

    - [Latest Security Research](https://www.bitsight.com/trace)
    - [Meet the TRACE Team](https://www.bitsight.com/trace/about)
  ![](https://www.bitsight.com/sites/default/files/2024/04/27/Sidebar_Bell.svg)
  [Bitsight delivered 297% ROI for security leaders](https://www.bitsight.com/report/forrester-total-economic-impact)

  Forrester Consulting's Total Economic Impact™ Of Bitsight study shows a near 3x return on investment and material business outcomes for customers.

  [Download Study](https://www.bitsight.com/report/forrester-total-economic-impact)
* Company

  Building trust in the digital economy

  Bitsight is a cyber risk management leader transforming how companies manage exposure, performance, and risk for themselves and their third parties.

  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Company_AboutUs.svg)
    [Our Story](https://www.bitsight.com/about/about-us)

    - [Why Bitsight](https://www.bitsight.com/why-bitsight)
    - [Our Team](https://www.bitsight.com/about/our-team)
    - [Trust Center](https://www.bitsight.com/about/trust-center)
    - [Moody's Partnership](https://www.bitsight.com/partners/moodys)
    - [Diversity & Inclusion](https://www.bitsight.com/about/diversity-and-inclusion)
    - [Press Releases](https://www.bitsight.com/press-releases)
    - [In the News](https://www.bitsight.com/news)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Company_ConnectWithUs.svg)
    [Connect with Us](https://www.bitsight.com/contact-us)

    - [Careers](https://www.bitsight.com/about/careers)
    - * [Open Positions](https://bitsight.wd1.myworkdayjobs.com/Bitsight)
    - [Events](https://www.bitsight.com/events)
    - [Locations](https://www.bitsight.com/contact-us)
    - [Contact Us](https://www.bitsight.com/contact-us)
  ![](https://www.bitsight.com/sites/default/files/2024/04/27/Sidebar_Bell.svg)
  [Bitsight to Acquire Cyber Threat Intelligence Leader Cybersixgill to Help Enterprises to Preempt Cyber Attacks](https://www.bitsight.com/press-releases/bitsight-acquire-cyber-threat-intelligence-leader-cybersixgill-help-enterprises)

  [Read release](https://www.bitsight.com/press-releases/bitsight-acquire-cyber-threat-intelligence-leader-cybersixgill-help-enterprises)
* Resources

  Did you know?

  More than [60% of Known Exploited Vulnerabilities](/node/13911) remain unmitigated past deadlines and take, on average, 4.5 months to remediate.

  Source: Bitsight TRACE

  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Resources_Resources.svg)
    Resources

    - [Customer Stories](https://www.bitsight.com/customers)
    - [Reports & eBooks](https://www.bitsight.com/resources?field_resource_type_target_id=231)
    - [Datasheets](https://www.bitsight.com/resources?field_resource_type_target_id=266)
    - [Webinars](https://www.bitsight.com/resources?field_resource_type_target_id=256)
    - [Videos](https://www.bitsight.com/resources?field_resource_type_target_id=241)
    - [Cybersecurity Glossary](https://www.bitsight.com/glossary)
    - [Groma Explorer
      NEW](https://www.bitsight.com/groma-explorer)
    - [All Resources](https://www.bitsight.com/resources)
  + ![](https://www.bitsight.com/sites/default/files/2024/04/27/Resources_Blog.svg)
    Blog

    - [Vulnerabilities & Incidents](https://www.bitsight.com/blogs?field_topics_target_id=111)
    - [Policy & Regulations](https://www.bitsight.com/blogs?field_topics_target_id=171)
    - [Exposure Management](https://www.bitsight.com/blogs?field_topics_target_id=1856)
    - [Third-Party Risk Management](https://www.bitsight.com/blogs?field_topics_target_id=211)
    - [All Blog Posts](https://www.bitsight.com/blog)
  ![](https://www.bitsight.com/sites/default/files/2024/04/27/Sidebar_QuoteBubble.svg)
  [Bitsight delivered 297% ROI for security leaders](https://www.bitsight.com/report/forrester-total-economic-impact)

  Read the study to see how bolstering your cyber security program with Bitsight can protect your business while improving your bottom line.

  [Download Forrester Study](https://www.bitsight.com/report/forrester-total-economic-impact)

[See Your Rating](/security-ratings-snapshot-report)

* [Blog](/blog)
* [Partners](/partners)
* [Login](https://service.bitsighttech.com/)
* [Chat With Us](#chatnow)
* [Request Demo](/demo/security-rating)

# Ragentek Android OTA Update Mechanism Vulnerable To MITM Attack

November 17, 2016

## Tags:

[Bitsight](/blog?field_topics_target_id=86)

[Bitsight Security Research](/blog?field_topics_target_id=496)

![bitsight-blog](/sites/default/files/styles/16_9_xlarge/public/2024/05/24/bitsight-blog.jpg?itok=sza_2037)

Share:

* [Facebook](https://www.facebook.com/sharer/sharer.php?u=https://www.bitsight.com/blog/ragentek-android-ota-update-mechanism-vulnerable-to-mitm-attack "Facebook")
* [Twitter](https://twitter.com/intent/tweet?url=https://www.bitsight.com/blog/ragentek-android-ota-update-mechanism-vulnerable-to-mitm-attack "Twitter")
* [LinkedIn](https://www.linkedin.com/shareArticle?mini=true&url=https://www.bitsight.com/blog/ragentek-android-ota-update-mechanism-vulnerable-to-mitm-attack "LinkedIn")

![Dan Dahlberg](/sites/default/files/styles/avatar/public/2024/10/02/dan-dahlberg-photo-min.jpg?itok=0KpZ_-2r)

Written by [Dan Dahlberg](/about/our-team/dan-dahlberg)
VP of Data Research

In this article, we will be detailing an issue we discovered affecting a number of low-cost devices. It allowed for adversaries to remotely execute commands on the devices as a privileged user if they were in a position to conduct a Man-in-the-Middle attack. The binary responsible appears to be an insecure implementation of an OTA (Over-the-air) mechanism for device updates associated to the software company, Ragentek Group, in China. All transactions from the binary to the third-party endpoint occur over an unencrypted channel, which not only exposes user-specific information during these communications, but would allow an adversary to issue commands supported by the protocol. One of these commands allows for the execution of system commands. This issue affected devices out of the box.

On Tuesday, November 15th, the [New York Times reported on an issue](http://www.nytimes.com/2016/11/16/us/politics/china-phones-software-security.html) affecting a similar set of device manufacturers that caused the devices to report sensitive material, such as text messages and the user’s previous physical locations, back to the Chinese software company Shanghai ADUPS Technology Co., Ltd. This was an issue discovered and announced by Kryptowire, and covered in more detail in a [posted article on their website](https://www.kryptowire.com/kryptowire-discovers-mobile-phone-firmware-transmitted-personally-identifiable-information-pii-without-user-consent-disclosure/). The issue described in this article is unrelated to the one discovered by Kryptowire.

## ANALYSIS

We acquired one of the affected devices, a BLU Studio G, from Best Buy. After building a passive network traffic capturing system, an unencrypted transaction to the Ragentek head-end (oyag[.]lhzbdvm[.]com) was observed not long after proceeding through the Android first-use setup process on the device:

![3AnubisBlog1.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3AnubisBlog1.png)

The device then attempted to contact two other pre-configured domains, which were previously unregistered until AnubisNetworks acquired them. This gave us immediate visibility into the larger population of affected devices, which are detailed later in this article. We were able to associate the network transactions back to specific binaries on the device, and were the ones investigated as part of this analysis:

![3anubisblog2.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog2.png)

The fact that the device reached out to defined head-ends immediately after initialization implies that the devices are affected by this issue out of the box, and were not subsequently compromised through other means, such as through a subsequent update.

### Endpoints and Hosts

This binary has been observed to cycle through three specific hosts:

![3anubisblog3.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog3.png)

Only one HTTP Path has been seen in use when communicating with these hosts:

![3anubisblog4.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog4.png)

Submissions have been only been observed as a HTTP POST with the data blob passed as a parameter named ‘data’ in the URL, e.g.:

![3anubisblog5.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog5.png)

The set of HTTP headers from the client are consistent between the head-ends, with the exception of the Host header, which does not use the actual DNS host but uses the IP address of the host. An example is below:

![3anubisblog6.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog6.png)

The name of the command from the client is contained in the ‘name’ key of the pseudo-json blob that is sent as described above. The known key types and their expected responses are listed below for each command.

### Client Solicitations

This command appears to be purposed for checking itself into the designated head-ends. Based from the response from the head-end, the device could enter either one of three states:

* Sleep for 6 months until the process restarts, or more likely until the device is rebooted.
* Enter a period of checking in via the “c\_get\_msg” command at an interval of every 10 minutes.
* If the “c\_regist” request remains unanswered, as is the case for the majority of devices at the moment, it will try again in 10 minutes.

It’s worth noting that any response could be issued to the device in response to “c\_regist” or “c\_get\_msg”. Through traffic analysis and simulated clients, any submission to the Ragentek head-end thus far using the c\_regist command results in an immediate TCP RST response.

The payloads typically seen for this command contain mixed-use datatypes in the key values, but the key is always the same. Below is a sample of the values observed from the test device:

![3anubisblog7.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog7.png)

As shown above, this payload contains information such as the device model and version, the user’s phone number, their IMEI, among other identifiers, and is transmitted unencrypted.

### Server Commands

The server is able to respond to requests from the client, but since the actual Ragentek head-end did not issue any commands in the course of this analysis, this had to be discovered by further investigation of the binary. By determining that it utilized Rui Maciel’s JSON library, it was straightforward to reverse the expected data structure of the server response. As shown below:

![3anubisblog8.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog8.png)

The values for “code” are strings, and are either:

![3anubisblog9.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog9.png)

The value of the “name” field was the desired command that server wished to issue. The protocol supports six defined command types:

* push\_commands
* push\_apk
* push\_link
* push\_text
* push\_client
* push\_config

The “details” JSON key value varies by command, but is also always a JSON object.

The most notable of the aforementioned commands is “push\_commands”. The push\_commands function allows the head-end to execute an arbitrary command of its choice on the device. In the communication structure, it requires a “details” JSON object of the following schema:

![3anubisblog10.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog10.png)

Before the command is executed, the values of “title” and “comments” are written into the local sqlite database. Whether it was successful, for example due to database error, the value of “commands” is executed via a system call. Despite the name of the key, it is a string, and not a list of commands. The client will subsequently send a “c\_update\_commands” message to the head-end, with a status value of “61”. If the client received a valid-form JSON back from the server, it will access the local database to likely log the response from the server.

Using the described information above, an example response from the server could thus be:

![3anubisblog11.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog11.png)

### Masking Attempts

We also investigated where the debugs binary was referenced throughout the system and in other processes from a firmware image downloaded from one of the device brand websites. Two other important pieces of information were discovered by this investigation. First, an explicit check was added into the “top**”** and “ps” code to mask the fact that “/system/bin/debugsrun” and “/system/bin/debugs” were running, and would hide or skip its presence in the user output.

![3anubisblog12.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog12.png)

##### *Screenshot of decompiled code from ‘top’*

By comparing that discovery to the output of running the commands on the test device, which is a different brand than the firmware image, we confirmed the system was hiding the processes from “top”, although hiding only “debugsrun” from “ps”. “debugs” was observed in the “ps” output, executing out of “/data/debugs/”, and we simply attribute it actually appearing in the list as a mistake on the original author’s behalf, slightly out of date firmware on the test devices, or differences between the firmware of the different brands. Doing a cat of all commands for running pids under /proc, we also confirmed the processes are in fact running despite the output of the commands, and network traffic also verified this:

![3anubisblog13.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog13.png)

##### ***List of running processes under /proc***

Second, we noticed the Java framework has also been modified to also hide references to this process. Specifically the core java.util.Scanner class has a modified next() method to exclude references to the binary names:

![3anubisblog14.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog14.png)

##### ***Code snippet from java.util.Scanner***

In addition, the nextInt() method was modified to always return a pid of 10008 for the processes:

![3anubisblog15.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog15.png)

Third, the local sqlite database that the binary logged events, stored system and user information and fetched from, was located at **/system/bin/unint8int**.

It’s unclear why the author of this process wanted to purposely hide the presence of the process and local database on the device, although it’s worth noting that it did not attempt to do this comprehensively.

## PROOF OF CONCEPT

With the information learned and the attack surface made available, a head-end simulator can be built that has the ability to issue commands to affected devices. As a proof of concept, one of the these head-end simulators was created to respond back to the device with a static, crafted message to evaluate the desired command.

The test setup involved was an host containing:

* The simulated head-end HTTP server to respond to client requests.
* A BIND DNS server that acted as a recursive resolver for clients, but had three zones created for the three C&C domains. It would otherwise return correct responses to the clients.

Any desired device that wants to undergo testing simply needs to connect to a network configured to push out the described host as the resolver in the DHCP responses by competing with the local DHCP server, poison the devices ARP table of the local network DNS server if present, or just perform a full man-in-the-middle attack and intercept all traffic through targeting the local gateway or other means.

The command to undergo testing was the remote command execution functionality. This is the same as the “push\_command” action described earlier in the article. In this case, the ability to write to protected space, “/data/system” was tested by using touch to create an empty file. Specifically, the following command was to be issued:

![3anubisblog16.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog16.png)

After configuring the device appropriately, the simulated head-end simply had to wait for the client to ultimately contact the head-end. Ultimately this request was received and an appropriately formatted response was sent to the client, as shown in this screenshot of output from the simulated head-end.

![3anubisblog17.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog17.png)

The device was then connected to a computer to access its local shell via adb. The below screenshot shows the directory listing for /data/system/, demonstrating that the file was created as expected with root owner and group, and that a standard user does not have the ability to write into this directory.

![3anubisblog18.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog18.png)

## AFFECTED DEVICES

The following chart outlines the top set of device manufacturers affected, or previously affected, as reported by the binary. This information was generated based on the solicitations we received to our sinkholes.

![3anubisblog19.png](https://cdn2.hubspot.net/hubfs/277648/images/blog/3anubisblog19.png)

##### ***Distribution of Observed Devices by Manufacturer***

 We have observed over 2.8 million distinct devices, across roughly 55 reported device models, which have checked into our sinkholes since we registered the extraneous domains. In some cases, we have not been to translate the provided device model into a reference to the real world device. These are the devices captured in the “Others” category above. Thus, there could be additional device models affected by this problem not outlined in this article or by CERT.

Please refer to the CERT Knowledgebase reference at the end of this article for additional information about how to check whether your device is affected. To manually verify, you can monitor for outbound connections from your phone to the hostnames described earlier in the article. If the transactions occur over HTTP instead of HTTPS, then the device would be affected by this issue.

## CONCLUSION

This analysis revealed two critical discoveries:

* Firstly, the vulnerability described above allows for users to be subjected to significant attacks in positions where an adversary can perform a Man-in-the-Middle attack.
* Secondly, this OTA binary was distributed with a set of domains preconfigured in the software. Only one of these domains was registered at the time of the discovery of this issue. If an adversary had noticed this, and registered these two domains, they would’ve instantly had access to perform arbitrary attacks on almost 3,000,000 devices **without** the need to perform a Man-in-the-Middle attack. AnubisNetworks now controls these two extraneous domains to prevent such an attack from occurring in the future for this particular case.

## ADDITIONAL NOTES

Additional information about this issue can be found at the CERT Knowledgebase article: <http://www.kb.cert.org/vuls/id/624539> and has been assigned CVE-2016-6564.

AnubisNetworks has worked with Google, BLU, and CERT in attempt to notify all affected parties.

[xml version="1.0" encoding="utf-8"?](/)

BitSight Technologies, Inc.

111 Huntington Ave, Suite 400

Boston,  MA  02199

United States of America

+1-617-245-0469

[![TermScout logo](/sites/default/files/2024/10/10/Favorable_TermScout.svg)](https://app.termscout.com/certify/bitsight-certified-contract)

Free Cyber Security Reports

* [Security Ratings Snapshot](/report/security-ratings-snapshot)
* [Attack Surface Report](/report/attack-surface)
* [Supply Chain Risk Report](/report/supply-chain-cyber-risk-report)
* [Marsh McLennan Cyber Risk Report](/resources/the-marsh-mclennan-cyber-risk-analytics-center-study-finds-statistically-significant-correlation-between-bitsight-analytics-and-cybersecurity-incidents)
* [Third-Party Vendor Risk Report](/report/free-third-party-risk-management-report)

* [BitSight Academy](https://academy.bitsight.com/learn/dashboard)
* [BitSight Knowledge Base](https://help.bitsighttech.com/hc/en-us)
* [Privacy Statement](/privacy-policy)
* [Corporate Social Responsibility Statement](/corporate-social-responsibility-statement)
* [Security](/security)
* [BitSight Security Ratings Access Terms](/security-ratings-access-terms)
* [Website Terms Of Use](/terms-of-use)
* [Get A Free Demo](/demo/bitsight-demo)
* [Cybersecurity Glossary](/glossary)
* [Do Not Sell or Share My Personal Information](https://submit-irm.trustarc.com/services/validation/313077aa-ba94-46d5-8cdb-1eec02a3553a)
* [Order Fulfillment Policy](https://www.bitsight.com/bitsight-order-fulfillment-policy)

[Contact Us](/contact-us)

© 2025 BitSight Technologies, Inc. and its Affiliates. All Rights Reserved.

* [Facebook](https://www.facebook.com/BitSight "Facebook")
* [Instagram](https://www.instagram.com/bitsight/ "Instagram")
* [Linkedin](https://www.linkedin.com/company/bitsight/ "Linkedin")
* [Twitter](https://twitter.com/BitSight "Twitter")
* [YouTube](https://www.youtube.com/channel/UCQK4819a_k18f2GGC3Fkv8g "YouTube")



=== Content from www.kb.cert.org_9eddbbde_20250125_235546.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#624539

## Ragentek Android OTA update mechanism vulnerable to MITM attack

#### Vulnerability Note VU#624539

Original Release Date: 2016-11-17 | Last Revised: 2016-11-17

---

### Overview

Ragentek Android software contains an over-the-air update mechanism that communicates over an unencrypted channel, which can allow a remote attacker to execute arbitrary code with root privileges.

### Description

| [**CWE-494**](https://cwe.mitre.org/data/definitions/494.html)**: Download of Code Without Integrity Check** - CVE-2016-6564  Android devices with code from Ragentek contain a privileged binary that performs over-the-air (OTA) update checks.Additionally, there are multiple techniques used to hide the execution of this binary. This behavior could be described as a [rootkit](https://en.wikipedia.org/wiki/Rootkit).This binary, which resides as /system/bin/debugs, runs with root privileges and does not communicate over an encrypted channel.The binary has been shown to communicate with three hosts via HTTP:     + oyag[.]lhzbdvm[.]com + oyag[.]prugskh[.]net + oyag[.]prugskh[.]com  Server responses to requests sent by the debugs binary include functionalities to execute arbitrary commands as root, install applications, or update configurations.Examples of a request sent by the client binary:  POST /pagt/agent?data={"name":"c\_regist","details":{...}} HTTP/1. 1Host: 114.80.68.223Connection: Close An example response from the server could be:  HTTP/1.1 200 OK{"code": "01", "name": "push\_commands", "details": {"server\_id": "1" ,"title": "Test Command", "comments": "Test", "commands": "touch /tmp/test"}} This binary is reported to be present in the following devices:    + BLU Studio G + BLU Studio G Plus + BLU Studio 6.0 HD + BLU Studio X + BLU Studio X Plus + BLU Studio C HD + Infinix Hot X507 + Infinix Hot 2 X510 + Infinix Zero X506 + Infinix Zero 2 X509 + DOOGEE Voyager 2 DG310 + LEAGOO Lead 5 + LEAGOO Lead 6 + LEAGOO Lead 3i + LEAGOO Lead 2S + LEAGOO Alfa 6 + IKU Colorful K45i + Beeline Pro 2 + XOLO Cube 5.0 |
| --- |

### Impact

| An remote, unauthenticated attacker in a position to perform man-in-the-middle attacks can execute arbitrary commands as root. |
| --- |

### Solution

| **Apply an update**The reporter indicates that BLU has provided an update, which is intended to address the vulnerability, Please see the vendor status page for more details.For other devices, please check with your device vendor for updates. If you are unable to apply an update, see the following workarounds: |
| --- |

| **Avoid use of untrusted networks**Use your device on trusted networks only, and avoid using untrusted networks such as open or public wifi. |
| --- |

### Vendor Information

624539
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23624539/) to view vendors.**
### [BLU Products](#TNOY-AFLLS5) Affected

Updated:  November 11, 2016

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

To check the software version of the below BLU devices users need to go to Settings > About device > Build Number and look for the respective build numbers.

BLU Studio G D790

BLU\_D790U\_V27\_GENERIC
BLU\_D790L\_V27\_GENERIC
BLU\_D790U\_V27\_GENERIC\_O
BLU\_D790L\_V27\_GENERIC\_O

BLU Studio X D750

BLU\_D750U\_V10\_GENERIC
BLU\_D750L\_V10\_GENERIC
BLU\_D750U\_V10\_GENERIC\_O
BLU\_D750L\_V10\_GENERIC\_O

BLU Studio X D770

BLU\_D770U\_V12\_GENERIC
BLU\_D770L\_V12\_GENERIC
BLU\_D770U\_V12\_GENERIC\_O
BLU\_D770L\_V12\_GENERIC\_O
### Vendor References

None

### Addendum

There are no additional comments at this time.

If you have feedback, comments, or additional information about this vulnerability, please send us email.

### [Infinix Mobility](#TNOY-AFLLSA) Affected

Updated:  November 11, 2016

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Ragentek](#TNOY-AFLLR2) Affected

Updated:  November 11, 2016

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Beeline](#TNOY-AFLLSX) Unknown

Updated:  November 11, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Doogee](#TNOY-AFLLSE) Unknown

Updated:  November 11, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [IKU Mobile](#TNOY-AFLLSS) Unknown

Updated:  November 11, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [Leagoo](#TNOY-AFLLSN) Unknown

Updated:  November 11, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### [XOLO](#TNOY-AFLLT4) Unknown

Updated:  November 11, 2016

### Status

Unknown

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 9.3 | AV:N/AC:M/Au:N/C:C/I:C/A:C |
| Temporal | 8.4 | E:POC/RL:ND/RC:C |
| Environmental | 6.3 | CDP:N/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <http://blog.anubisnetworks.com/blog/ragentek-android-ota-update-mechanism-vulnerable-to-mitm-attack>
* <https://cwe.mitre.org/data/definitions/494.html>
* <http://www.observatoriodeseguridad.com/?p=230>
* <https://twitter.com/timstrazz/status/689981808012828673>
* <https://en.wikipedia.org/wiki/Rootkit>
### Acknowledgements

Thanks to Dan Dahlberg and Tiago Pereira of BitSight Technologies and Anubis Networks for reporting this vulnerability.

This document was written by Trent Novelly.

### Other Information

| **CVE IDs:** | [CVE-2016-6564](http://web.nvd.nist.gov/vuln/detail/CVE-2016-6564) |
| --- | --- |
| **Date Public:** | 2016-11-11 |
| **Date First Published:** | 2016-11-17 |
| **Date Last Updated:** | 2016-11-17 21:49 UTC |
| **Document Revision:** | 21 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


