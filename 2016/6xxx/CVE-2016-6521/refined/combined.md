=== Content from www.openwall.com_a85adcf3_20250125_192239.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2016/08/04/1) [[<thread-prev]](1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAFdyfB2hwixWS3k1v=ZdPX4NRrBvzBNnseGv2HgFs3VNyobXPA@mail.gmail.com>
Date: Wed, 3 Aug 2016 22:28:50 +0100
From: Dario Bertini <berdario@...il.com>
To: oss-security@...ts.openwall.com
Subject: Grails Console is still vulnerable to CSRF CVE-2016-6521

In a previous email I announced that the issue was fixed in versions
1.5.10, 2.0.7

I was wrong

<https://github.com/sheehan/grails-console/issues/55>

Hopefully this vuln will be closed for good soon

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_061c2b37_20250125_192238.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](10) [[next>]](12) [[<thread-prev]](2) [[thread-next>]](../../../2016/08/03/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160802224316.0A523B2E007@smtpvbsrv1.mitre.org>
Date: Tue,  2 Aug 2016 18:43:16 -0400 (EDT)
From: cve-assign@...re.org
To: berdario@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: CSRF in Grails console

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> The Grails console (aka Grails Debug Console, Grails Web Console) was
> vulnerable to CSRF.
>
> <https://grails.org/plugin/console>
> <https://github.com/sheehan/grails-console>
>
> (this is the plugin, not to be confused with the command line grails
> console: <http://docs.grails.org/3.1.1/ref/Command%20Line/console.html>
> )
>
> The fix has been made available in versions 1.5.10, 2.0.7. Versions up
> to 1.5.9 and 2.0.6 are affected.
>
> This allows an attacker to (create pages that when visited by a victim
> will) forge requests that will execute arbitrary groovy code on the
> backend (the documentation explains how to enable it in production,
> and granting access to administrators only, so this is not simply a
> development tool).
>
> Bug tracker: <https://github.com/sheehan/grails-console/issues/54>
> fix commit: <https://github.com/sheehan/grails-console/commit/155e0f5f0fe3b3bd7027d730fa00bf0655f28207>

Use CVE-2016-6521.

(Conceivably this could have had a CVE-2015 number if
<https://github.com/sheehan/grails-console/issues/24> were interpreted as
a vulnerability disclosure; however issues/24 seems too vague.)

> Unfortunately the Grails framework itself ships with some horribly
> insecure defaults. As of 3.1.9 the template code dropped by `grails
> create-app` will have a UrlMappings.groovy that will allow access to
> Grails controllers actions via any HTTP method.

It is possible that a behavior like this could have its own CVE ID if
it is undocumented or interacts incorrectly with run-app. For example,
<http://docs.grails.org/1.3.9/guide/single.html#6.4.5%20Mapping%20to%20HTTP%20methods>
says "the HTTP method (GET, POST, PUT or DELETE)." Do you mean, for
example, that the OPTIONS or TRACE method can allow access, but the
documentation suggests that only GET, POST, PUT, and DELETE need to be
anticipated?

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXoSGRAAoJEHb/MwWLVhi2gEIP/iwnGiItegQOEYvx1qpyJvGP
+dTJ3xgvB0Zc8L5e4VD6AUd2d687GKeLB4juOYWR9h7TGyu62X6KMfAVfSl/4D5n
3N+DoZHuPIw6GlW9apWA9HeHg/PqUxV7in41wDRXkn1m1eD2Jz5zxm+ZaBrKmoOy
DNFnjSSaUkNuQtPq2qstIGxZ+iLBlBSH0k4kR5MTIUEoZZ3E2DZrP+0x5v+8MaZn
GCDfhJ0WWxUMr0d8lbpntZGWJU0hbacg2ImKDFSwhNkRR8r5CMzEK62p0ZqiEWNU
0udvX42XXM4YUXg54fXpN8lkt6qd8QIpa0FXlFLN/Oa2auI2pU+RnQ607yc8KGzN
1tiWXGQtxiWRQcZ8V93K5Ytj99qbpfyPRQpLtEX1GCilu/Bog2HCv9mFWmgTqib0
3/80z6599TFmeSibxIz21qkGPtXjwxjEhwdaDuUNP3Cc6xQK9pS9Vq/GmoGCNR46
ov/CpWbWEK058n6or0u7gl6rsJJNh55XKrXjfujrY+Dly3FQ0pULXPWnbsnFS4Vj
J+nNiQnX2wuYOmf+RoRn1H7rxFj5+9+pkrQFNbZZFKUpmXchyI6TTPaq5Cfpm9X8
oyyEV4ykiaOpH7CgHavqbhgfV3FkDBCPWb0iN2tgpK1rNEl84b18afRlVq+zVNBN
INdR8i7XC8AJf0piGF8J
=yHDR
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openwall.com_f8d793c0_20250125_192239.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](11) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CAFdyfB2D-63JUZbO_tU8sx2_pbS1e30cBemu81PNKABufdogpg@mail.gmail.com>
Date: Mon, 1 Aug 2016 23:27:23 +0100
From: Dario Bertini <berdario@...il.com>
To: oss-security@...ts.openwall.com
Subject: CVE Request: CSRF in Grails console

The Grails console (aka Grails Debug Console, Grails Web Console) was
vulnerable to CSRF.

<https://grails.org/plugin/console>
<https://github.com/sheehan/grails-console>

(this is the plugin, not to be confused with the command line grails
console: <http://docs.grails.org/3.1.1/ref/Command%20Line/console.html>
)

The fix has been made available in versions 1.5.10, 2.0.7. Versions up
to 1.5.9 and 2.0.6 are affected.

This allows an attacker to (create pages that when visited by a victim
will) forge requests that will execute arbitrary groovy code on the
backend (the documentation explains how to enable it in production,
and granting access to administrators only, so this is not simply a
development tool).

Bug tracker: <https://github.com/sheehan/grails-console/issues/54>
fix commit: <https://github.com/sheehan/grails-console/commit/155e0f5f0fe3b3bd7027d730fa00bf0655f28207>

Could you allocate a CVE id for this?

Thank you

On a more general note to Grails programmers, Caveat Auditor:

Unfortunately the Grails framework itself ships with some horribly
insecure defaults. As of 3.1.9 the template code dropped by `grails
create-app` will have a UrlMappings.groovy that will allow access to
Grails controllers actions via any HTTP method. CSRF protection is
also not enabled by default, and there's no documentation on how to
enable it globally. Some deprecated builtin modules in widespread but
old Grails versions (i.e. formRemote) also make it impossible to add
csrf protection to the associated endpoints.

On the bright side, Grails 3.1 added explicit rest mappings:
<http://docs.grails.org/latest/guide/theWebLayer.html#restfulMappings>

which makes it clearer which methods are allowed for every action, and
harder to forget about it. Compare to allowedMethods
<http://docs.grails.org/latest/ref/Controllers/allowedMethods.html>
which can be distant tens/hundreds line of code from the actual
controller-action they are protecting, and moreover can be easily
forgotten in a new file, also because they aren't added by default
when creating a controller with `grails create-controller`

It's thus likely that you might find more csrf vulnerabilities in
other open source plugins, as well as in your closed source
applications.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from github.com_244d7c84_20250126_111859.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F55)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F55)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=sheehan%2Fgrails-console)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

[sheehan](/sheehan)
/
**[grails-console](/sheehan/grails-console)**
Public archive

* [Notifications](/login?return_to=%2Fsheehan%2Fgrails-console) You must be signed in to change notification settings
* [Fork
  41](/login?return_to=%2Fsheehan%2Fgrails-console)
* [Star
   78](/login?return_to=%2Fsheehan%2Fgrails-console)

* [Code](/sheehan/grails-console)
* [Issues
  14](/sheehan/grails-console/issues)
* [Pull requests
  3](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects
  0](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

Additional navigation options

* [Code](/sheehan/grails-console)
* [Issues](/sheehan/grails-console/issues)
* [Pull requests](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

# CSRF vulnerability, again #55

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CSRF vulnerability, again](#top)#55Copy link[![@berdario](https://avatars.githubusercontent.com/u/752835?v=4&size=80)](/berdario)
## Description

[![@berdario](https://avatars.githubusercontent.com/u/752835?v=4&size=48)](/berdario)[berdario](https://github.com/berdario)opened [on Aug 3, 2016](https://github.com/sheehan/grails-console/issues/55#issue-169232762)

I'm afraid that the issue hasn't been fixed properly. I realized it today after deploying your new release.

You can try: login (or simply visit in a barebone new grails application) the main app website, but DON'T visit the console. Trigger the poc I sent you the last time, and you'll see that it'll still work. After accessing the console the protection will be effective and the poc will stop working.

I suspect that the reason might be the `request.getHeader('X-CSRFToken') != session['CONSOLE_CSRF_TOKEN'])` check.

If the console hasn't been visited yet, there will be no `CONSOLE_CSRF_TOKEN` in the session, and thus both side of the equations will be `null`, letting the check pass.

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_e20b7b8d_20250126_111903.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fcommit%2F155e0f5f0fe3b3bd7027d730fa00bf0655f28207)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fcommit%2F155e0f5f0fe3b3bd7027d730fa00bf0655f28207)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=sheehan%2Fgrails-console)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

[sheehan](/sheehan)
/
**[grails-console](/sheehan/grails-console)**
Public archive

* [Notifications](/login?return_to=%2Fsheehan%2Fgrails-console) You must be signed in to change notification settings
* [Fork
  41](/login?return_to=%2Fsheehan%2Fgrails-console)
* [Star
   78](/login?return_to=%2Fsheehan%2Fgrails-console)

* [Code](/sheehan/grails-console)
* [Issues
  14](/sheehan/grails-console/issues)
* [Pull requests
  3](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects
  0](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

Additional navigation options

* [Code](/sheehan/grails-console)
* [Issues](/sheehan/grails-console/issues)
* [Pull requests](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

## Commit

[Permalink](/sheehan/grails-console/commit/155e0f5f0fe3b3bd7027d730fa00bf0655f28207)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

fix [#54](https://github.com/sheehan/grails-console/issues/54) add CSRF protection

[Browse files](/sheehan/grails-console/tree/155e0f5f0fe3b3bd7027d730fa00bf0655f28207)
Browse the repository at this point in the history

* Loading branch information

[![@sheehan](https://avatars.githubusercontent.com/u/253069?s=40&v=4)](/sheehan)

[sheehan](/sheehan/grails-console/commits?author=sheehan "View all commits by sheehan")
committed
Jul 31, 2016

1 parent
[7736e3a](/sheehan/grails-console/commit/7736e3a175ead340ffc659fea99dd6239dc57b38)

commit 155e0f5

 Show file tree

 Hide file tree

Showing
**15 changed files**
with
**228 additions**
and
**65 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* README.md
  [README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5)
* changelog.md
  [changelog.md](#diff-3bd14d078188074c410028847113ceae68865d0ad5b844a27183ef87fbe2fcc3)
* grails2/plugin

  + grails2/plugin/ConsoleGrailsPlugin.groovy
    [ConsoleGrailsPlugin.groovy](#diff-61f51a7e98f6708fc04303a8f058c543d05b961b72343275885ce3fa1dff7325)
  + grails-app/controllers/org/grails/plugins/console

    - grails2/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy
      [ConsoleController.groovy](#diff-2e9e10197d97fe9059191ab16ad361eb00e03d0cc2cabf94d6c8591faed7cdb1)
  + src/groovy/org/grails/plugins/console

    - grails2/plugin/src/groovy/org/grails/plugins/console/ConsoleConfig.groovy
      [ConsoleConfig.groovy](#diff-e281670f1e6a1a0685a5a737dfbc414a0bd06244cd4bd3a9753ede125a84fd22)
  + test/unit/org/grails/plugins/console

    - grails2/plugin/test/unit/org/grails/plugins/console/ConsoleControllerSpec.groovy
      [ConsoleControllerSpec.groovy](#diff-cb7d44598b2d4553a75cb9414480ff5984a94af601677e096235656144710efb)
* grails3/plugin

  + grails3/plugin/build.gradle
    [build.gradle](#diff-6540655bde30637bf914fa4c1f2222f6ca74d5abe9f7d7cd9ebeb83b9de502d6)
  + grails-app/controllers/org/grails/plugins/console

    - grails3/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy
      [ConsoleController.groovy](#diff-ca0e130c29bb288c1a3d9b58455e3586286a1a107f4233674b815bc4268d37da)
    - grails3/plugin/grails-app/controllers/org/grails/plugins/console/EnabledInterceptor.groovy
      [EnabledInterceptor.groovy](#diff-d94cac6a66ed2d44cb5c32cf9802f028f4e27430641831e6a1a8adbaa3db9c4f)
    - grails3/plugin/grails-app/controllers/org/grails/plugins/console/TokenInterceptor.groovy
      [TokenInterceptor.groovy](#diff-a5752720bc901317336271d05fb24fd960995802fac979674386461c1ab41713)
  + src

    - main/groovy/org/grails/plugins/console

      * grails3/plugin/src/main/groovy/org/grails/plugins/console/ConsoleConfig.groovy
        [ConsoleConfig.groovy](#diff-2c83cb875f73f31054edf8ee87d74091434da53ccb0f04fd43cda8a011b54fcb)
      * grails3/plugin/src/main/groovy/org/grails/plugins/console/ConsoleGrailsPlugin.groovy
        [ConsoleGrailsPlugin.groovy](#diff-0ee87064c28b16af91c77d50e734f0c34c6899494f6144bc3826a2ce101a2e3c)
    - test/groovy/unit/org/grails/plugins/console

      * grails3/plugin/src/test/groovy/unit/org/grails/plugins/console/ConsoleControllerSpec.groovy
        [ConsoleControllerSpec.groovy](#diff-d31f5298dc9579a33a6be2b7550cef28a1cecbd7665dca142ad54059656d9e28)
* web/app

  + web/app/app.coffee
    [app.coffee](#diff-702fb28111b0f118d77a8d85b9e79b9615cfc06b1148246bd35328c02f27b9f4)
  + result

    - web/app/result/result-model.coffee
      [result-model.coffee](#diff-cb17dcad18dab3e87d30991f26598561eecd62b181ad4bba01b0aad37ee91883)

## There are no files selected for viewing

13 changes: 7 additions & 6 deletions

13
[README.md](#diff-b335630551682c19a781afebcf4d07bf978fb1f8ac04c6bf87428ed5106870f5 "README.md")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/README.md)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

| Expand Up | | @@ -15,7 +15,7 @@ Add a dependency in BuildConfig.groovy: |
|  |  | grails.project.dependency.resolution = { |
|  |  | // ... |
|  |  | plugins { |
|  |  | runtime ':console:1.5.9' |
|  |  | runtime ':console:1.5.10' |
|  |  | // ... |
|  |  | } |
|  |  | } |
| Expand All | | @@ -30,7 +30,7 @@ grails.project.dependency.resolution = { |
|  |  | Add a dependency in build.gradle |
|  |  |  |
|  |  | ```groovy |
|  |  | runtime 'org.grails.plugins:grails-console:2.0.6' |
|  |  | runtime 'org.grails.plugins:grails-console:2.0.7' |
|  |  | ``` |
|  |  |  |
|  |  | ## Usage |
| Expand Down  Expand Up | | @@ -73,9 +73,9 @@ See [Script Examples](https://github.com/sheehan/grails-console/wiki/Script-Exam |
|  |  |  |
|  |  | | Key | Command | |
|  |  | |---|---| |
|  |  | | Ctrl-Enter / Cmd-Enter | Execute | |
|  |  | | Ctrl-S / Cmd-S | Save | |
|  |  | | Esc  | Clear output | |
|  |  | | Ctrl-Enter / ⌘-Enter | Execute | |
|  |  | | Ctrl-S / ⌘-S | Save | |
|  |  | | Esc | Clear output | |
|  |  |  |
|  |  | ## Configuration |
|  |  |  |
| Expand All | | @@ -91,7 +91,8 @@ The following configuration options are available: |
|  |  | | `grails.plugin.console.newFileText` | Text to display as a template for new files. Can be used to add frequently used imports, environment specific warnings, etc... Defaults to empty. | |
|  |  | | `grails.plugin.console.tabSize` | The width of a tab character. Defaults to 4. | |
|  |  | | `grails.plugin.console.indentWithTabs` | Whether indents should use tabs rather than spaces. Default is false. | |
|  |  | | `grails.plugin.console.indentUnit` | How many spaces a block should be indented. The default is 4. | |
|  |  | | `grails.plugin.console.indentUnit` | How many spaces a block should be indented. Default is 4. | |
|  |  | | `grails.plugin.console.csrfProtection.enabled` | Whether to enable CSRF protection. Default is true. | |
|  |  |  |
|  |  | ## Security |
|  |  |  |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[changelog.md](#diff-3bd14d078188074c410028847113ceae68865d0ad5b844a27183ef87fbe2fcc3 "changelog.md")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/changelog.md)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,3 +1,6 @@ |
|  |  | ### v2.0.7 / v1.5.10 |
|  |  | \* Fix #54 add CSRF protection |
|  |  |  |
|  |  | ### v2.0.6 / v1.5.9 |
|  |  | \* Fix #52 bad dependency graph |
|  |  | \* Fix #51 database commands fail if dataSource is defined with logSql=true |
| Expand Down | |  |

8 changes: 7 additions & 1 deletion

8
[grails2/plugin/ConsoleGrailsPlugin.groovy](#diff-61f51a7e98f6708fc04303a8f058c543d05b961b72343275885ce3fa1dff7325 "grails2/plugin/ConsoleGrailsPlugin.groovy")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/grails2/plugin/ConsoleGrailsPlugin.groovy)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,8 +1,10 @@ |
|  |  | import grails.converters.JSON |
|  |  | import org.grails.plugins.console.ConsoleConfig |
|  |  |  |
|  |  | import java.lang.reflect.Method |
|  |  |  |
|  |  | class ConsoleGrailsPlugin { |
|  |  | String version = '1.5.9' |
|  |  | String version = '1.5.10' |
|  |  | String grailsVersion = '2.0 > \*' |
|  |  | String title = 'Console Plugin' |
|  |  | String description = 'A web-based Groovy console for interactive runtime application management and debugging' |
| Expand Down  Expand Up | | @@ -32,4 +34,8 @@ class ConsoleGrailsPlugin { |
|  |  | } |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | def doWithSpring = { |
|  |  | consoleConfig(ConsoleConfig, application.config.grails.plugin.console) |
|  |  | } |
|  |  | } |

58 changes: 26 additions & 32 deletions

58
[grails2/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy](#diff-2e9e10197d97fe9059191ab16ad361eb00e03d0cc2cabf94d6c8591faed7cdb1 "grails2/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/grails2/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -9,12 +9,20 @@ import java.lang.reflect.Method |
|  |  | class ConsoleController { |
|  |  |  |
|  |  | def consoleService |
|  |  | def consoleConfig |
|  |  |  |
|  |  | def beforeInterceptor = { |
|  |  | if (!isConsolePluginEnabled()) { |
|  |  | if (!consoleConfig.enabled) { |
|  |  | response.sendError 404 |
|  |  | return false |
|  |  | } |
|  |  | if (actionName != 'index' |
|  |  | && consoleConfig.csrfProtectionEnabled |
|  |  | && request.getHeader('X-CSRFToken') != session['CONSOLE\_CSRF\_TOKEN']) { |
|  |  | response.status = 403 |
|  |  | response.writer.println "CSRF token doesn't match. Please refresh the page." |
|  |  | return false |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | def index() { |
| Expand All | | @@ -29,31 +37,29 @@ class ConsoleController { |
|  |  | out: 'the output PrintStream' |
|  |  | ], |
|  |  | baseUrl: getBaseUrl(), |
|  |  | remoteFileStoreEnabled: isRemoteFileStoreEnabled(), |
|  |  | remoteFileStoreEnabled: consoleConfig.remoteFileStoreEnabled, |
|  |  | groovyVersion: GroovySystem.version, |
|  |  | grailsVersion: grailsApplication.metadata['app.grails.version'] |
|  |  | ] |
|  |  | ] |
|  |  |  |
|  |  | def consoleConfig = grailsApplication.config.grails.plugin.console |
|  |  | if (consoleConfig.newFileText) { |
|  |  | model.json.newFileText = consoleConfig.newFileText.toString() |
|  |  | } |
|  |  |  |
|  |  | if (consoleConfig.indentWithTabs) { |
|  |  | model.json.indentWithTabs = consoleConfig.indentWithTabs as boolean |
|  |  | if (consoleConfig.newFileText != null) { |
|  |  | model.json.newFileText = consoleConfig.newFileText |
|  |  | } |
|  |  |  |
|  |  | if (consoleConfig.tabSize) { |
|  |  | model.json.tabSize = consoleConfig.tabSize as int |
|  |  | } |
|  |  | model.json.indentWithTabs = consoleConfig.indentWithTabs |
|  |  | model.json.tabSize = consoleConfig.tabSize |
|  |  | model.json.indentUnit = consoleConfig.indentUnit |
|  |  |  |
|  |  | if (consoleConfig.indentUnit) { |
|  |  | model.json.indentUnit = consoleConfig.indentUnit as int |
|  |  | if (consoleConfig.remoteFileStoreDefaultPath != null) { |
|  |  | model.json.remoteFileStoreDefaultPath = consoleConfig.remoteFileStoreDefaultPath |
|  |  | } |
|  |  |  |
|  |  | if (consoleConfig.fileStore.remote.defaultPath) { |
|  |  | model.json.remoteFileStoreDefaultPath = consoleConfig.fileStore.remote.defaultPath.toString() |
|  |  | if (consoleConfig.csrfProtectionEnabled) { |
|  |  | if (!session['CONSOLE\_CSRF\_TOKEN']) { |
|  |  | session['CONSOLE\_CSRF\_TOKEN'] = UUID.randomUUID().toString() |
|  |  | } |
|  |  | model.json.csrfToken = session['CONSOLE\_CSRF\_TOKEN'] |
|  |  | } |
|  |  |  |
|  |  | render view: 'index', model: model |
| Expand Down  Expand Up | | @@ -83,7 +89,7 @@ class ConsoleController { |
|  |  | } |
|  |  |  |
|  |  | def listFiles(String path) { |
|  |  | if (!isRemoteFileStoreEnabled()) { |
|  |  | if (!consoleConfig.remoteFileStoreEnabled) { |
|  |  | return renderError("Remote file store disabled", 403) |
|  |  | } |
|  |  |  |
| Expand All | | @@ -100,7 +106,7 @@ class ConsoleController { |
|  |  | } |
|  |  |  |
|  |  | def file() { |
|  |  | if (!isRemoteFileStoreEnabled()) { |
|  |  | if (!consoleConfig.remoteFileStoreEnabled) { |
|  |  | return renderError("Remote file store disabled", 403) |
|  |  | } |
|  |  | switch (request.method) { |
| Expand Down  Expand Up | | @@ -196,27 +202,15 @@ class ConsoleController { |
|  |  | render([error: error] as JSON) |
|  |  | } |
|  |  |  |
|  |  | private boolean isConsolePluginEnabled() { |
|  |  | def enabled = grailsApplication.config.grails.plugin.console.enabled |
|  |  | if (!(enabled instanceof Boolean)) { |
|  |  | enabled = Environment.current == Environment.DEVELOPMENT |
|  |  | } |
|  |  | enabled |
|  |  | } |
|  |  |  |
|  |  | private boolean isRemoteFileStoreEnabled() { |
|  |  | grailsApplication.config.grails.plugin.console.fileStore.remote.enabled != false |
|  |  | } |
|  |  |  |
|  |  | private String getBaseUrl() { |
|  |  | def baseUrl = grailsApplication.config.grails.plugin.console.baseUrl |
|  |  | def baseUrl = consoleConfig.baseUrl |
|  |  | if (baseUrl instanceof List) { |
|  |  | String serverName = request.serverName |
|  |  | baseUrl = baseUrl.find { String baseUrlFromConfig -> |
|  |  | baseUrlFromConfig.contains(serverName) |
|  |  | } |
|  |  | } |
|  |  | if (!(baseUrl instanceof String)) { |
|  |  | if (baseUrl == null) { |
|  |  | baseUrl = createLink(action: 'index', absolute: true) - '/index' |
|  |  | } |
|  |  | baseUrl |
| Expand Down | |  |

57 changes: 57 additions & 0 deletions

57
[grails2/plugin/src/groovy/org/grails/plugins/console/ConsoleConfig.groovy](#diff-e281670f1e6a1a0685a5a737dfbc414a0bd06244cd4bd3a9753ede125a84fd22 "grails2/plugin/src/groovy/org/grails/plugins/console/ConsoleConfig.groovy")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/grails2/plugin/src/groovy/org/grails/plugins/console/ConsoleConfig.groovy)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -0,0 +1,57 @@ |
|  |  | package org.grails.plugins.console |
|  |  |  |
|  |  | import grails.util.Environment |
|  |  |  |
|  |  | class ConsoleConfig { |
|  |  |  |
|  |  | boolean enabled |
|  |  | String newFileText = null |
|  |  | boolean indentWithTabs = false |
|  |  | boolean tabSize = 4 |
|  |  | boolean indentUnit = 4 |
|  |  | String remoteFileStoreDefaultPath = null |
|  |  | boolean remoteFileStoreEnabled = true |
|  |  | boolean csrfProtectionEnabled = true |
|  |  | def baseUrl |
|  |  |  |
|  |  | ConsoleConfig(Map config) { |
|  |  |  |
|  |  | if (config.enabled instanceof Boolean) { |
|  |  | enabled = config.enabled |
|  |  | } else { |
|  |  | enabled = Environment.current == Environment.DEVELOPMENT |
|  |  | } |
|  |  |  |
|  |  | if (config.newFileText instanceof String) { |
|  |  | newFileText = config.newFileText |
|  |  | } |
|  |  |  |
|  |  | if (config.indentWithTabs instanceof Boolean) { |
|  |  | indentWithTabs = config.indentWithTabs |
|  |  | } |
|  |  |  |
|  |  | if (config.tabSize instanceof Integer) { |
|  |  | tabSize = config.tabSize |
|  |  | } |
|  |  |  |
|  |  | if (config.indentUnit instanceof Integer) { |
|  |  | indentUnit = config.indentUnit |
|  |  | } |
|  |  |  |
|  |  | if (config.fileStore.remote.defaultPath instanceof String) { |
|  |  | remoteFileStoreDefaultPath = config.fileStore.remote.defaultPath |
|  |  | } |
|  |  |  |
|  |  | if (config.fileStore.remote.enabled instanceof Boolean) { |
|  |  | remoteFileStoreEnabled = config.fileStore.remote.enabled |
|  |  | } |
|  |  |  |
|  |  | if (config.csrfProtection.enabled instanceof Boolean) { |
|  |  | csrfProtectionEnabled = config.csrfProtection.enabled |
|  |  | } |
|  |  |  |
|  |  | if (config.baseUrl instanceof List || config.baseUrl instanceof String) { |
|  |  | baseUrl = config.baseUrl |
|  |  | } |
|  |  | } |
|  |  | } |

6 changes: 6 additions & 0 deletions

6
[grails2/plugin/test/unit/org/grails/plugins/console/ConsoleControllerSpec.groovy](#diff-cb7d44598b2d4553a75cb9414480ff5984a94af601677e096235656144710efb "grails2/plugin/test/unit/org/grails/plugins/console/ConsoleControllerSpec.groovy")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/grails2/plugin/test/unit/org/grails/plugins/console/ConsoleControllerSpec.groovy)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -17,6 +17,8 @@ class ConsoleControllerSpec extends Specification { |
|  |  | controller.consoleService = consoleService |
|  |  | tempDir = Files.createTempDirectory('console').toFile() |
|  |  | config.grails.plugin.console.fileStore.remote.enabled = true |
|  |  | config.grails.plugin.console.csrfProtection.enabled = true |
|  |  | controller.consoleConfig = new ConsoleConfig(config.grails.plugin.console) |
|  |  | } |
|  |  |  |
|  |  | void cleanup() { |
| Expand All | | @@ -32,6 +34,7 @@ class ConsoleControllerSpec extends Specification { |
|  |  | void 'beforeInterceptor - console plugin enabled'() { |
|  |  | given: |
|  |  | config.grails.plugin.console.enabled = true |
|  |  | controller.consoleConfig = new ConsoleConfig(config.grails.plugin.console) |
|  |  |  |
|  |  | expect: |
|  |  | controller.beforeInterceptor() != false |
| Expand All | | @@ -58,6 +61,7 @@ class ConsoleControllerSpec extends Specification { |
|  |  | void 'index - baseUrl with config'() { |
|  |  | when: |
|  |  | config.grails.plugin.console.baseUrl = 'http://localhost:5050/x/y/z/console' |
|  |  | controller.consoleConfig = new ConsoleConfig(config.grails.plugin.console) |
|  |  | controller.index() |
|  |  |  |
|  |  | then: |
| Expand Down  Expand Up | | @@ -153,6 +157,7 @@ class ConsoleControllerSpec extends Specification { |
|  |  | given: |
|  |  | String path = tempDir.absolutePath |
|  |  | config.grails.plugin.console.fileStore.remote.enabled = false |
|  |  | controller.consoleConfig = new ConsoleConfig(config.grails.plugin.console) |
|  |  |  |
|  |  | when: |
|  |  | controller.listFiles(path) |
| Expand Down  Expand Up | | @@ -190,6 +195,7 @@ class ConsoleControllerSpec extends Specification { |
|  |  |  |
|  |  | params.path = testFile1.absolutePath |
|  |  | config.grails.plugin.console.fileStore.remote.enabled = false |
|  |  | controller.consoleConfig = new ConsoleConfig(config.grails.plugin.console) |
|  |  |  |
|  |  | when: |
|  |  | controller.file() |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[grails3/plugin/build.gradle](#diff-6540655bde30637bf914fa4c1f2222f6ca74d5abe9f7d7cd9ebeb83b9de502d6 "grails3/plugin/build.gradle")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/grails3/plugin/build.gradle)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -16,7 +16,7 @@ plugins { |
|  |  | id "com.jfrog.bintray" version "1.1" |
|  |  | } |
|  |  |  |
|  |  | version "2.0.6" |
|  |  | version "2.0.7" |
|  |  | group "org.grails.plugins" |
|  |  |  |
|  |  | apply plugin: 'maven-publish' |
| Expand Down | |  |

41 changes: 18 additions & 23 deletions

41
[grails3/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy](#diff-ca0e130c29bb288c1a3d9b58455e3586286a1a107f4233674b815bc4268d37da "grails3/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy")

Show comments

[View file](/sheehan/grails-console/blob/155e0f5f0fe3b3bd7027d730fa00bf0655f28207/grails3/plugin/grails-app/controllers/org/grails/plugins/console/ConsoleController.groovy)
Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -6,6 +6,7 @@ import org.apache.commons.io.FilenameUtils |
|  |  | class ConsoleController { |
|  |  |  |
|  |  | def consoleService |
|  |  | def consoleConfig |
|  |  |  |
|  |  | def index() { |
|  |  | Map model = [ |
| Expand All | | @@ -19,31 +20,29 @@ class ConsoleController { |
|  |  | out: 'the output PrintStream' |
|  |  | ], |
|  |  | baseUrl: getBaseUrl(), |
|  |  | remoteFileStoreEnabled: isRemoteFileStoreEnabled(), |
|  |  | remoteFileStoreEnabled: consoleConfig.remoteFileStoreEnabled, |
|  |  | groovyVersion: GroovySystem.version, |
|  |  | grailsVersion: grailsApplication.metadata['app.grails.version'] |
|  |  | ] |
|  |  | ] |
|  |  |  |
|  |  | def consoleConfig = grailsApplication.config.grails.plugin.console |
|  |  | if (consoleConfig.newFileText) { |
|  |  | model.json.newFileText = consoleConfig.newFileText.toString() |
|  |  | if (consoleConfig.newFileText != null) { |
|  |  | model.json.newFileText = consoleConfig.newFileText |
|  |  | } |
|  |  |  |
|  |  | if (consoleConfig.indentWithTabs) { |
|  |  | model.json.indentWithTabs = consoleConfig.indentWithTabs as boolean |
|  |  | } |
|  |  |  |
|  |  | if (consoleConfig.tabSize) { |
|  |  | model.json.tabSize = consoleConfig.tabSize as int |
|  |  | } |
|  |  | model.json.indentWithTabs = consoleConfig.indentWithTabs |
|  |  | model.json.tabSize = consoleConfig.tabSize |
|  |  | model.json.indentUnit = consoleConfig.indentUnit |
|  |  |  |
|  |  | if (consoleConfig.indentUnit) { |
|  |  | model.json.indentUnit = consoleConfig.indentUnit as int |
|  |  | if (consoleConfig.remoteFileStoreDefaultPath != null) { |
|  |  | model.json.remoteFileStoreDefaultPath = consoleConfig.remoteFileStoreDefaultPath |
|  |  | } |
|  |  |  |
|  |  | if (consoleConfig.fileStore.remote.defaultPath) { |
|  |  | model.json.remoteFileStoreDefaultPath = consoleConfig.fileStore.remote.defaultPath.toString() |
|  |  | if (consoleConfig.csrfProtectionEnabled) { |
|  |  | if (!session['CONSOLE\_CSRF\_TOKEN']) { |
|  |  | session['CONSOLE\_CSRF\_TOKEN'] = UUID.randomUUID().toString() |
|  |  | } |
|  |  | model.json.csrfToken = session['CONSOLE\_CSRF\_TOKEN'] |
|  |  | } |
|  |  |  |
|  |  | render view: 'index', model: model |
| Expand Down  Expand Up | | @@ -73,7 +72,7 @@ class ConsoleController { |
|  |  | } |
|  |  |  |
|  |  | def listFiles(String path) { |
|  |  | if (!isRemoteFileStoreEnabled()) { |
|  |  | if (!consoleConfig.remoteFileStoreEnabled) { |
|  |  | return renderError("Remote file store disabled", 403) |
|  |  | } |
|  |  |  |
| Expand All | | @@ -90,7 +89,7 @@ class ConsoleController { |
|  |  | } |
|  |  |  |
|  |  | def file() { |
|  |  | if (!isRemoteFileStoreEnabled()) { |
|  |  | if (!consoleConfig.remoteFileStoreEnabled) { |
|  |  | return renderError("Remote file store disabled", 403) |
|  |  | } |
|  |  | switch (request.method) { |
| Expand Down  Expand Up | | @@ -186,19 +185,15 @@ class ConsoleController { |
|  |  | render([error: error] as JSON) |
|  |  | } |
|  |  |  |
|  |  | private boolean isRemoteFileStoreEnabled() { |
|  |  | grailsApplication.config.grails.plugin.console.fileStore.remote.enabled != false |
|  |  | } |
|  |  |  |
|  |  | private String getBaseUrl() { |
|  |  | def baseUrl = grailsApplication.config.grails.plugin.console.baseUrl |
|  |  | def baseUrl = consoleConfig.baseUrl |
|  |  | if (baseUrl instanceof List) { |
|  |  | String serverName = request.serverName |
|  |  | baseUrl = baseUrl.find { String baseUrlFromConfig -> |
|  |  | baseUrlFromConfig.contains(serverName) |
|  |  | } |
|  |  | } |
|  |  | if (!(baseUrl instanceof String)) { |
|  |  | if (baseUrl == null) { |
|  |  | baseUrl = createLink(action: 'index', absolute: true) - '/index' |
|  |  | } |
|  |  | baseUrl |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `155e0f5`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fcommit%2F155e0f5f0fe3b3bd7027d730fa00bf0655f28207) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_87c4bb22_20250126_111900.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F24)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F24)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=sheehan%2Fgrails-console)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

[sheehan](/sheehan)
/
**[grails-console](/sheehan/grails-console)**
Public archive

* [Notifications](/login?return_to=%2Fsheehan%2Fgrails-console) You must be signed in to change notification settings
* [Fork
  41](/login?return_to=%2Fsheehan%2Fgrails-console)
* [Star
   78](/login?return_to=%2Fsheehan%2Fgrails-console)

* [Code](/sheehan/grails-console)
* [Issues
  14](/sheehan/grails-console/issues)
* [Pull requests
  3](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects
  0](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

Additional navigation options

* [Code](/sheehan/grails-console)
* [Issues](/sheehan/grails-console/issues)
* [Pull requests](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

# CSRF check #24

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CSRF check](#top)#24Copy link[![@theaspect](https://avatars.githubusercontent.com/u/199627?u=e6e560b5277239f67292f7b4e1b82f93563aad5b&v=4&size=80)](/theaspect)
## Description

[![@theaspect](https://avatars.githubusercontent.com/u/199627?u=e6e560b5277239f67292f7b4e1b82f93563aad5b&v=4&size=48)](/theaspect)[theaspect](https://github.com/theaspect)opened [on Jan 9, 2015](https://github.com/sheehan/grails-console/issues/24#issue-53867348)

Why CSRF tokens not checked?

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_88252f53_20250126_111904.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F54)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F54)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fissues%2Fshow&source=header-repo&source_repo=sheehan%2Fgrails-console)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

[sheehan](/sheehan)
/
**[grails-console](/sheehan/grails-console)**
Public archive

* [Notifications](/login?return_to=%2Fsheehan%2Fgrails-console) You must be signed in to change notification settings
* [Fork
  41](/login?return_to=%2Fsheehan%2Fgrails-console)
* [Star
   78](/login?return_to=%2Fsheehan%2Fgrails-console)

* [Code](/sheehan/grails-console)
* [Issues
  14](/sheehan/grails-console/issues)
* [Pull requests
  3](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects
  0](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

Additional navigation options

* [Code](/sheehan/grails-console)
* [Issues](/sheehan/grails-console/issues)
* [Pull requests](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

# CSRF prevention #54

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CSRF prevention](#top)#54Copy link[![@berdario](https://avatars.githubusercontent.com/u/752835?v=4&size=80)](/berdario)
## Description

[![@berdario](https://avatars.githubusercontent.com/u/752835?v=4&size=48)](/berdario)[berdario](https://github.com/berdario)opened [on Jul 1, 2016](https://github.com/sheehan/grails-console/issues/54#issue-163350045)

Same issue as [#24](https://github.com/sheehan/grails-console/issues/24) which was unfortunately not recognized for the severe bug that it is.

Yesterday I explained privately the issue to [@sheehan](https://github.com/sheehan) and supplied him a POC. Will add the same information here once a fix is released (or otherwise to expedite its release), but for now this issue should merely serve to keep track of it publicly

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_88252f53_20250125_192239.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F54)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fsheehan%2Fgrails-console%2Fissues%2F54)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fissues_fragments%2Fissue_layout&source=header-repo&source_repo=sheehan%2Fgrails-console)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

[sheehan](/sheehan)
/
**[grails-console](/sheehan/grails-console)**
Public archive

* [Notifications](/login?return_to=%2Fsheehan%2Fgrails-console) You must be signed in to change notification settings
* [Fork
  41](/login?return_to=%2Fsheehan%2Fgrails-console)
* [Star
   78](/login?return_to=%2Fsheehan%2Fgrails-console)

* [Code](/sheehan/grails-console)
* [Issues
  14](/sheehan/grails-console/issues)
* [Pull requests
  3](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects
  0](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

Additional navigation options

* [Code](/sheehan/grails-console)
* [Issues](/sheehan/grails-console/issues)
* [Pull requests](/sheehan/grails-console/pulls)
* [Actions](/sheehan/grails-console/actions)
* [Projects](/sheehan/grails-console/projects)
* [Wiki](/sheehan/grails-console/wiki)
* [Security](/sheehan/grails-console/security)
* [Insights](/sheehan/grails-console/pulse)

This repository has been archived by the owner on Sep 10, 2024. It is now read-only.

# CSRF prevention #54

[Jump to bottom](#comment-composer-heading)Copy link[Jump to bottom](#comment-composer-heading)Copy linkClosedClosed[CSRF prevention](#top)#54Copy link[![@berdario](https://avatars.githubusercontent.com/u/752835?v=4&size=80)](/berdario)
## Description

[![@berdario](https://avatars.githubusercontent.com/u/752835?v=4&size=48)](/berdario)[berdario](https://github.com/berdario)opened [on Jul 1, 2016](https://github.com/sheehan/grails-console/issues/54#issue-163350045)

Same issue as [#24](https://github.com/sheehan/grails-console/issues/24) which was unfortunately not recognized for the severe bug that it is.

Yesterday I explained privately the issue to [@sheehan](https://github.com/sheehan) and supplied him a POC. Will add the same information here once a fix is released (or otherwise to expedite its release), but for now this issue should merely serve to keep track of it publicly

## Metadata

### Assignees

No one assigned

### Labels

No labelsNo labels
### Projects

No projects
### Milestone

No milestone

### Relationships

None yet
### Development

No branches or pull requests
## Issue actions

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


