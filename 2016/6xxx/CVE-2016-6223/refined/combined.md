=== Content from www.openwall.com_11f33c62_20250125_001255.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](../../../2016/07/14/4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <CACG6YS0Q_DcgZ+N9_X1PcdTZ45hkVDe4JYEF-hMaL92b2wh0rw@mail.gmail.com>
Date: Wed, 13 Jul 2016 10:05:26 +0200
From: Mathias Svensson <idolf@...gle.com>
To: oss-security@...ts.openwall.com
Subject: CVE request: Information leak in LibTIFF

Hello oss-security,

I would like to request a CVE number for an information leak in LibTIFF,
specifically in the file libtiff/tif_read.c.

The vulnerability allows an attacker to specify a negative index into the
file-content buffer and copy data from that position until the end of the
buffer.

This will allow an attacker to crash the process by accessing unmapped
memory and (depending on how LibTIFF is used) might also allow an attacker
to leak sensitive information.

The issue is fixed in CVS HEAD with the commit:

revision 1.49
date: 2016-07-10 20:00:21 +0200;  author: erouault;  state: Exp;  lines: +6
-3;  commitid: YhOZoKv5OA9gNNdz;
* libtiff/tif_read.c: Fix out-of-bounds read on
memory-mapped files in TIFFReadRawStrip1() and TIFFReadRawTile1()
when stripoffset is beyond tmsize_t max value (reported by
Mathias Svensson)

Kinds regards,
Mathias Svensson
Google Security Team

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.gentoo.org_536109de_20250125_001257.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libTIFF: Multiple vulnerabilities â€” GLSA **201701-16**

Multiple vulnerabilities have been found in libTIFF, the worst of
which may allow execution of arbitrary code.

### Affected packages

| Package | **media-libs/tiff** on all architectures |
| --- | --- |
| Affected versions | < **4.0.7** |
| Unaffected versions | >= **4.0.7** |

### Background

The TIFF library contains encoding and decoding routines for the Tag
Image File Format. It is called by numerous programs, including GNOME and
KDE applications, to interpret TIFF images.

### Description

Multiple vulnerabilities have been discovered in libTIFF. Please review
the CVE identifier and bug reports referenced for details.

### Impact

A remote attacker could entice a user to process a specially crafted
image file, possibly resulting in execution of arbitrary code with the
privileges of the process or a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libTIFF users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/tiff-4.0.7"

```
### References

* [CVE-2013-4243](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-4243)
* [CVE-2014-8127](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8127)
* [CVE-2014-8128](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8128)
* [CVE-2014-8129](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8129)
* [CVE-2014-8130](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8130)
* [CVE-2014-9330](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-9330)
* [CVE-2014-9655](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-9655)
* [CVE-2015-1547](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-1547)
* [CVE-2015-7313](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7313)
* [CVE-2015-7554](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7554)
* [CVE-2015-8665](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8665)
* [CVE-2015-8668](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8668)
* [CVE-2015-8683](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8683)
* [CVE-2015-8781](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8781)
* [CVE-2015-8782](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8782)
* [CVE-2015-8783](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8783)
* [CVE-2015-8784](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8784)
* [CVE-2016-3186](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3186)
* [CVE-2016-3619](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3619)
* [CVE-2016-3620](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3620)
* [CVE-2016-3621](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3621)
* [CVE-2016-3622](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3622)
* [CVE-2016-3623](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3623)
* [CVE-2016-3624](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3624)
* [CVE-2016-3625](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3625)
* [CVE-2016-3631](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3631)
* [CVE-2016-3632](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3632)
* [CVE-2016-3633](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3633)
* [CVE-2016-3634](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3634)
* [CVE-2016-3658](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3658)
* [CVE-2016-3945](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3945)
* [CVE-2016-3990](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3990)
* [CVE-2016-3991](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3991)
* [CVE-2016-5102](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5102)
* [CVE-2016-5314](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5314)
* [CVE-2016-5315](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5315)
* [CVE-2016-5316](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5316)
* [CVE-2016-5317](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5317)
* [CVE-2016-5318](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5318)
* [CVE-2016-5319](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5319)
* [CVE-2016-5320](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5320)
* [CVE-2016-5321](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5321)
* [CVE-2016-5322](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5322)
* [CVE-2016-5323](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5323)
* [CVE-2016-5652](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5652)
* [CVE-2016-5875](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5875)
* [CVE-2016-6223](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-6223)
* [CVE-2016-8331](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-8331)
* [CVE-2016-9273](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9273)
* [CVE-2016-9297](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9297)
* [CVE-2016-9448](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9448)
* [CVE-2016-9453](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9453)
* [CVE-2016-9532](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9532)

**Release date**

January 09, 2017

**Latest revision**

January 09, 2017: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [484542](https://bugs.gentoo.org/show_bug.cgi?id=484542)
* [534108](https://bugs.gentoo.org/show_bug.cgi?id=534108)
* [538318](https://bugs.gentoo.org/show_bug.cgi?id=538318)
* [561880](https://bugs.gentoo.org/show_bug.cgi?id=561880)
* [572876](https://bugs.gentoo.org/show_bug.cgi?id=572876)
* [585274](https://bugs.gentoo.org/show_bug.cgi?id=585274)
* [585508](https://bugs.gentoo.org/show_bug.cgi?id=585508)
* [599746](https://bugs.gentoo.org/show_bug.cgi?id=599746)

### Questions or comments?

Please feel free to contact us.

**Â© 2001â€“2020 Gentoo Foundation, Inc.**



=== Content from libtiff.maptools.org_c40335c3_20250125_001254.html ===


**TIFF CHANGE INFORMATION**

---

**Current Version**: v4.0.7

**Previous Version**: [v4.0.6](v4.0.6.html)

**Master Download Site**: [download.osgeo.org](https://download.osgeo.org/libtiff), directory pub/libtiff

**Master HTTP Site #1**: <http://www.simplesystems.org/libtiff/>

**Master HTTP Site #2**: <http://libtiff.maptools.org/>

---

This document describes the changes made to the software between the
*previous* and *current* versions (see above). If you don't
find something listed here, then it was not done in this timeframe, or
it was not considered important enough to be mentioned. The following
information is located here:

* [Major Changes](#highlights)* [Changes in the software configuration](#configure)* [Changes in libtiff](#libtiff)* [Changes in the tools](#tools)* [Changes in the contrib area](#contrib)

---

**MAJOR CHANGES:**

* The libtiff tools bmp2tiff, gif2tiff, ras2tiff, sgi2tiff,
  sgisv, and ycbcr are completely removed from the distribution.
  These tools were written in the late 1980s and early 1990s for
  test and demonstration purposes. In some cases the tools were
  never updated to support updates to the file format, or the
  file formats are now rarely used. In all cases these tools
  increased the libtiff security and maintenance exposure beyond
  the value offered by the tool.

---

**CHANGES IN THE SOFTWARE CONFIGURATION:**

* None

---

**CHANGES IN LIBTIFF:**

* libtiff/tif\_dirread.c: in TIFFFetchNormalTag(), do not
  dereference NULL pointer when values of tags with
  TIFF\_SETGET\_C16\_ASCII / TIFF\_SETGET\_C32\_ASCII access are
  0-byte arrays. Fixes
  http://bugzilla.maptools.org/show\_bug.cgi?id=2593 (regression
  introduced by previous fix done on 2016-11-11 for
  CVE-2016-9297). Reported by Henri Salo. Assigned as
  CVE-2016-9448* libtiff/tif\_aux.c: fix crash in TIFFVGetFieldDefaulted() when
    requesting Predictor tag and that the zip/lzw codec is not
    configured. Fixes
    http://bugzilla.maptools.org/show\_bug.cgi?id=2591* libtiff/tif\_dirread.c: in TIFFFetchNormalTag(), make sure
      that values of tags with TIFF\_SETGET\_C16\_ASCII /
      TIFF\_SETGET\_C32\_ASCII access are null terminated, to avoid
      potential read outside buffer in \_TIFFPrintField(). Fixes
      http://bugzilla.maptools.org/show\_bug.cgi?id=2590* libtiff/tif\_dirread.c: reject images with OJPEG compression
        that have no TileOffsets/StripOffsets tag, when OJPEG
        compression is disabled. Prevent null pointer dereference in
        TIFFReadRawStrip1() and other functions that expect
        td\_stripbytecount to be non NULL. Fixes
        http://bugzilla.maptools.org/show\_bug.cgi?id=2585* libtiff/tif\_strip.c: make TIFFNumberOfStrips() return the
          td->td\_nstrips value when it is non-zero, instead of
          recomputing it. This is needed in TIFF\_STRIPCHOP mode where
          td\_nstrips is modified. Fixes a read outsize of array in
          tiffsplit (or other utilities using TIFFNumberOfStrips()).
          Fixes http://bugzilla.maptools.org/show\_bug.cgi?id=2587
          (CVE-2016-9273)* libtiff/tif\_predict.h, libtiff/tif\_predict.c: Replace
            assertions by runtime checks to avoid assertions in debug
            mode, or buffer overflows in release mode. Can happen when
            dealing with unusual tile size like YCbCr with
            subsampling. Reported as MSVR 35105 by Axel Souchet & Vishal
            Chauhan from the MSRC Vulnerabilities & Mitigations* libtiff/tif\_dir.c: discard values of SMinSampleValue and
              SMaxSampleValue when they have been read and the value of
              SamplesPerPixel is changed afterwards (like when reading a
              OJPEG compressed image with a missing SamplesPerPixel tag, and
              whose photometric is RGB or YCbCr, forcing SamplesPerPixel
              being 3). Otherwise when rewriting the directory (for example
              with tiffset, we will expect 3 values whereas the array had
              been allocated with just one), thus causing a out of bound
              read access. Fixes
              http://bugzilla.maptools.org/show\_bug.cgi?id=2500
              (CVE-2014-8127, duplicate: CVE-2016-3658)* libtiff/tif\_dirwrite.c: avoid null pointer dereference on
                td\_stripoffset when writing directory, if FIELD\_STRIPOFFSETS
                was artificially set for a hack case in OJPEG case. Fixes
                http://bugzilla.maptools.org/show\_bug.cgi?id=2500
                (CVE-2014-8127, duplicate: CVE-2016-3658)* libtiff/tif\_getimage.c (TIFFRGBAImageOK): Reject attempts to
                  read floating point images.* libtiff/tif\_predict.c (PredictorSetup): Enforce
                    bits-per-sample requirements of floating point predictor (3).
                    Fixes CVE-2016-3622 "Divide By Zero in the tiff2rgba tool."* libtiff/tif\_pixarlog.c: fix out-of-bounds write vulnerabilities
                      in heap allocated buffers. Reported as MSVR 35094. Discovered by
                      Axel Souchet and Vishal Chauhan from the MSRC Vulnerabilities &
                      Mitigations team.* libtiff/tif\_write.c: fix issue in error code path of
                        TIFFFlushData1() that didn't reset the tif\_rawcc and tif\_rawcp
                        members. I'm not completely sure if that could happen in
                        practice outside of the odd behaviour of t2p\_seekproc() of
                        tiff2pdf). The report points that a better fix could be to
                        check the return value of TIFFFlushData1() in places where it
                        isn't done currently, but it seems this patch is enough.
                        Reported as MSVR 35095. Discovered by Axel Souchet & Vishal
                        Chauhan & Suha Can from the MSRC Vulnerabilities & Mitigations
                        team.* libtiff/tif\_pixarlog.c: Fix write buffer overflow in
                          PixarLogEncode if more input samples are provided than
                          expected by PixarLogSetupEncode. Idea based on
                          libtiff-CVE-2016-3990.patch from
                          libtiff-4.0.3-25.el7\_2.src.rpm by Nikola Forro, but with
                          different and simpler check. (bugzilla #2544)* libtiff/tif\_read.c: Fix out-of-bounds read on memory-mapped
                            files in TIFFReadRawStrip1() and TIFFReadRawTile1() when
                            stripoffset is beyond tmsize\_t max value (reported by Mathias
                            Svensson)* libtiff/tif\_read.c: make TIFFReadEncodedStrip() and
                              TIFFReadEncodedTile() directly use user provided buffer when
                              no compression (and other conditions) to save a memcpy()* libtiff/tif\_write.c: make TIFFWriteEncodedStrip() and
                                TIFFWriteEncodedTile() directly use user provided buffer when
                                no compression to save a memcpy().* libtiff/tif\_luv.c: validate that for COMPRESSION\_SGILOG and
                                  PHOTOMETRIC\_LOGL, there is only one sample per pixel. Avoid
                                  potential invalid memory write on corrupted/unexpected images
                                  when using the TIFFRGBAImageBegin() interface (reported by
                                  Clay Wood)* libtiff/tif\_pixarlog.c: fix potential buffer write overrun in
                                    PixarLogDecode() on corrupted/unexpected images (reported by
                                    Mathias Svensson) (CVE-2016-5875)* libtiff/libtiff.def: Added \_TIFFMultiply32 and
                                      \_TIFFMultiply64 to libtiff.def* libtiff/tif\_config.vc.h (HAVE\_SNPRINTF): Add a '1' to the
                                        HAVE\_SNPRINTF definition.* libtiff/tif\_config.vc.h (HAVE\_SNPRINTF): Applied patch by
                                          Edward Lam to define HAVE\_SNPRINTF for Visual Studio 2015.* libtiff/tif\_dirread.c: when compiled with DEFER\_STRILE\_LOAD,
                                            fix regression, introduced on 2014-12-23, when reading a
                                            one-strip file without a StripByteCounts tag. GDAL #6490* libtiff/\*: upstream typo fixes (mostly contributed by Kurt
                                              Schwehr) coming from GDAL internal libtiff* libtiff/tif\_fax3.h: make Param member of TIFFFaxTabEnt
                                                structure a uint16 to reduce size of the binary.* libtiff/tif\_read.c, tif\_dirread.c: fix indentation issues
                                                  raised by GCC 6 -Wmisleading-indentation* libtiff/tif\_pixarlog.c: avoid zlib error messages to pass a
                                                    NULL string to %s formatter, which is undefined behaviour in
                                                    sprintf().* libtiff/tif\_next.c: fix potential out-of-bound write in NeXTDecode()
                                                      triggered by http://lcamtuf.coredump.cx/afl/vulns/libtiff5.tif
                                                      (bugzilla #2508)* libtiff/tif\_luv.c: fix potential out-of-bound writes in
                                                        decode functions in non debug builds by replacing assert()s by
                                                        regular if checks (bugzilla #2522). Fix potential
                                                        out-of-bound reads in case of short input data.* libtiff/tif\_getimage.c: fix out-of-bound reads in
                                                          TIFFRGBAImage interface in case of unsupported values of
                                                          SamplesPerPixel/ExtraSamples for LogLUV / CIELab. Add explicit
                                                          call to TIFFRGBAImageOK() in TIFFRGBAImageBegin(). Fix
                                                          CVE-2015-8665 reported by limingxing and CVE-2015-8683
                                                          reported by zzf of Alibaba.* libtiff/tif\_dirread.c: workaround false positive warning of
                                                            Clang Static Analyzer about null pointer dereference in
                                                            TIFFCheckDirOffset().* libtiff/tif\_fax3.c: remove dead assignment in
                                                              Fax3PutEOLgdal(). Found by Clang Static Analyzer* libtiff/tif\_dirwrite.c: fix truncation to 32 bit of file
                                                                offsets in TIFFLinkDirectory() and TIFFWriteDirectorySec()
                                                                when aligning directory offsets on a even offset (affects
                                                                BigTIFF). This was a regression of the changeset of
                                                                2015-10-19.* libtiff/tif\_write.c: TIFFWriteEncodedStrip() and
                                                                  TIFFWriteEncodedTile() should return -1 in case of failure of
                                                                  tif\_encodestrip() as documented* libtiff/tif\_dumpmode.c: DumpModeEncode() should return 0 in
                                                                    case of failure so that the above mentioned functions detect
                                                                    the error.* libtiff/\*.c: fix MSVC warnings related to cast shortening and
                                                                      assignment within conditional expression* libtiff/\*.c: fix clang -Wshorten-64-to-32 warnings* libtiff/tif\_dirread.c: prevent reading ColorMap or
                                                                          TransferFunction if BitsPerPixel > 24, so as to avoid huge
                                                                          memory allocation and file read attempts* libtiff/tif\_dirread.c: remove duplicated assignment (reported
                                                                            by Clang static analyzer)* libtiff/tif\_dir.c, libtiff/tif\_dirinfo.c,
                                                                              libtiff/tif\_compress.c, libtiff/tif\_jpeg\_12.c: suppress
                                                                              warnings about 'no previous declaration/prototype'* libtiff/tiffiop.h, libtiff/tif\_dirwrite.c: suffix constants
                                                                                by U to fix 'warning: negative integer implicitly converted to
                                                                                unsigned type' warning (part of -Wconversion)* libtiff/tif\_dir.c, libtiff/tif\_dirread.c,
                                                                                  libtiff/tif\_getimage.c, libtiff/tif\_print.c: fix -Wshadow
                                                                                  warnings (only in libtiff/)

---

**CHANGES IN THE TOOLS:**

* tools/Makefile.am: The libtiff tools bmp2tiff, gif2tiff,
  ras2tiff, sgi2tiff, sgisv, and ycbcr are completely removed
  from the distribution. The libtiff tools rgb2ycbcr and
  thumbnail are only built in the build tree for testing. Old
  files are put in new 'archive' subdirectory of the source
  repository, but not in distribution archives. These changes
  are made in order to lessen the maintenance burden.* tools/tiff2pdf.c: avoid undefined behaviour related to
    overlapping of source and destination buffer in memcpy() call
    in t2p\_sample\_rgbaa\_to\_rgb() Fixes
    http://bugzilla.maptools.org/show\_bug.cgi?id=2577* tools/tiff2pdf.c: fix potential integer overflows on 32 bit
      builds in t2p\_read\_tiff\_size() Fixes
      http://bugzilla.maptools.org/show\_bug.cgi?id=2576* tools/fax2tiff.c: fix segfault when specifying -r without
        argument. Patch by Yuriy M. Kaminskiy. Fixes
        http://bugzilla.maptools.org/show\_bug.cgi?id=2572* tools/tiffinfo.c: fix out-of-bound read on some tiled images.
          (http://bugzilla.maptools.org/show\_bug.cgi?id=2517)* tools/tiffcrop.c: fix multiple uint32 overflows in
            writeBufferToSeparateStrips(), writeBufferToContigTiles() and
            writeBufferToSeparateTiles() that could cause heap buffer
            overflows. Reported by Henri Salo from Nixu Corporation.
            Fixes http://bugzilla.maptools.org/show\_bug.cgi?id=2592* tools/tiffcrop.c: fix out-of-bound read of up to 3 bytes in
              readContigTilesIntoBuffer(). Reported as MSVR 35092 by Axel
              Souchet & Vishal Chauhan from the MSRC Vulnerabilities &
              Mitigations team.* tools/tiff2pdf.c: fix write buffer overflow of 2 bytes on
                JPEG compressed images. Reported by Tyler Bohan of Cisco Talos
                as TALOS-CAN-0187 / CVE-2016-5652. Also prevents writing 2
                extra uninitialized bytes to the file stream.* tools/tiffcp.c: fix out-of-bounds write on tiled images with odd
                  tile width vs image width. Reported as MSVR 35103
                  by Axel Souchet and Vishal Chauhan from the MSRC Vulnerabilities &
                  Mitigations team.* tools/tiff2pdf.c: fix read -largely- outsize of buffer in
                    t2p\_readwrite\_pdf\_image\_tile(), causing crash, when reading a
                    JPEG compressed image with TIFFTAG\_JPEGTABLES length being
                    one. Reported as MSVR 35101 by Axel Souchet and Vishal
                    Chauhan from the MSRC Vulnerabilities & Mitigations team.* tools/tiffcp.c: fix read of undefined variable in case of
                      missing required tags. Found on test case of MSVR 35100.* tools/tiffcrop.c: fix read of undefined buffer in
                        readContigStripsIntoBuffer() due to uint16 overflow. Probably
                        not a security issue but I can be wrong. Reported as MSVR
                        35100 by Axel Souchet from the MSRC Vulnerabilities &
                        Mitigations team.* tools/tiffcrop.c: fix various out-of-bounds write
                          vulnerabilities in heap or stack allocated buffers. Reported
                          as MSVR 35093, MSVR 35096 and MSVR 35097. Discovered by Axel
                          Souchet and Vishal Chauhan from the MSRC Vulnerabilities &
                          Mitigations team.* tools/tiff2pdf.c: fix out-of-bounds write vulnerabilities in
                            heap allocate buffer in t2p\_process\_jpeg\_strip(). Reported as
                            MSVR 35098. Discovered by Axel Souchet and Vishal Chauhan from
                            the MSRC Vulnerabilities & Mitigations team.* tools/tiff2bw.c: fix weight computation that could result of
                              color value overflow (no security implication). Fix bugzilla
                              #2550. Patch by Frank Freudenberg.* tools/rgb2ycbcr.c: validate values of -v and -h parameters to
                                avoid potential divide by zero. Fixes CVE-2016-3623 (bugzilla #2569)* tools/tiffcrop.c: Fix out-of-bounds write in loadImage().
                                  From patch libtiff-CVE-2016-3991.patch from
                                  libtiff-4.0.3-25.el7\_2.src.rpm by Nikola Forro (bugzilla
                                  #2543)* tools/tiff2rgba.c: Fix integer overflow in size of allocated
                                    buffer, when -b mode is enabled, that could result in
                                    out-of-bounds write. Based initially on patch
                                    tiff-CVE-2016-3945.patch from libtiff-4.0.3-25.el7\_2.src.rpm
                                    by Nikola Forro, with correction for invalid tests that
                                    rejected valid files. (bugzilla #2545)* tools/tiffcrop.c: Avoid access outside of stack allocated
                                      array on a tiled separate TIFF with more than 8 samples per
                                      pixel. Reported by Kaixiang Zhang of the Cloud Security Team,
                                      Qihoo 360 (CVE-2016-5321 / CVE-2016-5323 , bugzilla #2558 /
                                      #2559)* tools/tiffdump.c: fix a few misaligned 64-bit reads warned by
                                        -fsanitize* tools/tiffdump.c (ReadDirectory): Remove uint32 cast to
                                          \_TIFFmalloc() argument which resulted in Coverity report.
                                          Added more mutiplication overflow checks.

---

**CHANGES IN THE CONTRIB AREA:**

* None

Last updated $Date: 2016-11-19 17:47:40 $.



=== Content from www.openwall.com_dc6af1ba_20250125_001255.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux Â  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper Â  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists Â  *for password cracking*](/wordlists/)+ [passwdqc Â  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt Â  *KDF & password hashing*](/yescrypt/)+ [yespower Â  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish Â  *password hashing*](/crypt/)+ [phpass Â  *ditto in PHP*](/phpass/)+ [tcb Â  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd Â  *port scan detector*](/scanlogd/)+ [popa3d Â  *tiny POP3 daemon*](/popa3d/)+ [blists Â  *web interface to mailing lists*](/blists/)+ [msulogin Â  *single user mode login*](/msulogin/)+ [php\_mt\_seed Â  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](3) [[next>]](5) [[<thread-prev]](../../../2016/07/13/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160714181602.59527B2E012@smtpvbsrv1.mitre.org>
Date: Thu, 14 Jul 2016 14:16:02 -0400 (EDT)
From: cve-assign@...re.org
To: idolf@...gle.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE request: Information leak in LibTIFF

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> I would like to request a CVE number for an information leak in LibTIFF,
> specifically in the file libtiff/tif_read.c.
>
> The vulnerability allows an attacker to specify a negative index into the
> file-content buffer and copy data from that position until the end of the
> buffer.
>
> This will allow an attacker to crash the process by accessing unmapped
> memory and (depending on how LibTIFF is used) might also allow an attacker
> to leak sensitive information.
>
> The issue is fixed in CVS HEAD with the commit:
>
> revision 1.49
> date: 2016-07-10 20:00:21 +0200;  author: erouault;
> commitid: YhOZoKv5OA9gNNdz;
> * libtiff/tif_read.c: Fix out-of-bounds read on
> memory-mapped files in TIFFReadRawStrip1() and TIFFReadRawTile1()
> when stripoffset is beyond tmsize_t max value (reported by
> Mathias Svensson)

Use CVE-2016-6223.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJXh9YEAAoJEHb/MwWLVhi2NZIP/AlJLMTfzlrz/si4ZZdxud9U
yJTUt7t/zzzH7oLx0rzZb+hivMp6Z5P5Cqhn8eVzTj+hOMFTaZek+sBaf034WKxN
qZyaVdu4VHs1gpJNJpP7t0toXdUmNMh2CKsx7PUEfrM73o+VeiwaWgG8UvuJO5vd
28sspVqmhtfOmsPtx6mnIabnHtZG0N4TE/FUVKF9mRp73xlxhxB3gkwAzAXy5sRh
R23M0qU5v5HkryvUvKoA0sQ3H6dgMDMqUE/Gq6B67t2Lm98E0DLPnayCn5x/Jkzf
IrNGI8e2yRjqggeXKO/SRfmZSR/1qM43vGuHeYbgn0ZOJPPrFIv9+BY9uN6fIfpH
ox5x2GXFVMp79Rwnea2ywy0Z6mCBLvmFCs8In2B4GxoVJ+MUVAuhyFUqctgrZ81L
5uphXH8KDhKiY5k/qa6T9j2eNz13Por3UvK0irEixsgaUQzEz3wNUy8mW56L0mB0
4sCZVlH5zt5/eIDHRWxHrbBR3Oo27R21ONVP2MJTthcVthCiLnMvZEcNOOp7//MR
1FWYp3qsPrc858j7ZWtyXvpROscv/ivN7V6xzPvjYal+qVs4RPexwJ3/pUn63fms
mEZdDlbzR7ecLPXRHksx99FgT9R/ETgugd1oYKwgCo+zVgCHGrJH3XvhQQsHgCK+
A/ao2iuPSnQu1eG2aUSi
=Bszf
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.debian.org_3d765701_20250125_001254.html ===


---

[[Date Prev](msg00011.html)][[Date Next](msg00013.html)]
[[Thread Prev](msg00011.html)][[Thread Next](msg00013.html)]
[[Date Index](maillist.html#00012)]
[[Thread Index](threads.html#00012)]

# [SECURITY] [DSA 3762-1] tiff security update

---

* *To*: debian-security-announce@lists.debian.org
* *Subject*: [SECURITY] [DSA 3762-1] tiff security update
* *From*: Moritz Muehlenhoff <jmm@debian.org>
* *Date*: Fri, 13 Jan 2017 16:45:16 +0100
* *Message-id*: <[[ðŸ”Ž]](/msgid-search/20170113154516.32o6xhinnahcuins%40pisco.westfalen.local)Â [20170113154516.32o6xhinnahcuins@pisco.westfalen.local](msg00012.html)>
* *Reply-to*: debian-security-announce-request@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

- -------------------------------------------------------------------------
Debian Security Advisory DSA-3762-1                   security@debian.org
<https://www.debian.org/security/>                 Laszlo Boszormenyi (GCS)
January 13, 2017                      <https://www.debian.org/security/faq>
- -------------------------------------------------------------------------

Package        : tiff
CVE ID         : CVE-2016-3622 CVE-2016-3623 CVE-2016-3624 CVE-2016-3945
                 CVE-2016-3990 CVE-2016-3991 CVE-2016-5314 CVE-2016-5315
                 CVE-2016-5316 CVE-2016-5317 CVE-2016-5320 CVE-2016-5321
                 CVE-2016-5322 CVE-2016-5323 CVE-2016-5652 CVE-2016-5875
                 CVE-2016-6223 CVE-2016-9273 CVE-2016-9297 CVE-2016-9448
                 CVE-2016-9453 CVE-2016-9532 CVE-2016-9533 CVE-2016-9534
                 CVE-2016-9535 CVE-2016-9536 CVE-2016-9537 CVE-2016-9538
                 CVE-2016-9540 CVE-2016-10092 CVE-2016-10093
		 CVE-2016-10094

Multiple vulnerabilities have been discovered in the libtiff library
and the included tools tiff2rgba, rgb2ycbcr, tiffcp, tiffcrop, tiff2pdf
and tiffsplit, which may result in denial of service, memory disclosure
or the execution of arbitrary code.

There were additional vulnerabilities in the tools bmp2tiff, gif2tiff,
thumbnail and ras2tiff, but since these were addressed by the libtiff
developers by removing the tools altogether, no patches are available
and those tools were also removed from the tiff package in Debian
stable. The change had already been made in Debian stretch before and
no applications included in Debian are known to rely on these scripts.
If you use those tools in custom setups, consider using a different
conversion/thumbnailing tool.

For the stable distribution (jessie), these problems have been fixed in
version 4.0.3-12.3+deb8u2.

For the testing distribution (stretch), these problems have been fixed
in version 4.0.7-4.

For the unstable distribution (sid), these problems have been fixed in
version 4.0.7-4.

We recommend that you upgrade your tiff packages.

Further information about Debian Security Advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://www.debian.org/security/>

Mailing list: debian-security-announce@lists.debian.org
-----BEGIN PGP SIGNATURE-----

iQIzBAEBCAAdFiEEtuYvPRKsOElcDakFEMKTtsN8TjYFAlh49Z8ACgkQEMKTtsN8
TjZISQ/+LKohHxR25bZwnFj+QXmoN5XS+7dvdeUk0QpQbfV7I1V0LSTTzN5JCMyz
/4au77zspQkHSLkRri9SFwshrB1dI7KHCupQx/1W7oZwOenGVJI8tGHLCEanhRdN
X8pR0q1zQ2StlB/hRDfm40SDOda1ArE9GfGF5mlBMzarabGx9kF+JKdMnT0Ks3j2
ZSMDtlNVT/aJV2LUoG33VAdN9s2wS3rpZjgq5GHlyu3VmvstBygcEW06FqMH6Uxx
e1JQysgdIgjwOURD6YWnvXus6BWVBOFzVswygMBkvUBA+FY8MC1i0S/pRcYLRvSQ
CcSSaE/qqc+gI1OSLmdClnz7eAEheYjIOUUrkrK5zA8JuRakRRhkvsPHAAY/Mmrz
LA6GR1UvJjef1EDCttio0hsEluyTE0S/9ApoKVLRVq1kOAOXZn8DtjL7Eq0+5RG1
UDqGPn7RQNZ3Gcc9kw5TglLSDofX/gai/zCN0IYy6R9TbMYw/pP3TlSb1FKELXuh
9KAzz4z0s7h1VB7a59rQSbb2JvyKPImtaiuN/KpZykZ2pGMjJSzuNOfJyVnSbhra
4eVIFnd7JWrtLoPmABEDXV8YA3dbG6CpyS42x1fvVf1rM3XAvXw9E0XHe39czObk
IfQGzTryedx6STzvwX4N7G33NdYHHi3QbZOhAz0jmqXfI7x1EAk=
=nR9A
-----END PGP SIGNATURE-----

```

---


