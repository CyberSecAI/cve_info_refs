- **Root cause of vulnerability:** The `process-execute` and `process-spawn` procedures in the CHICKEN Scheme implementation allocated buffers of fixed sizes (`ARG_MAX` and `ENV_MAX`) to store command arguments and environment variables. The code then copied input lists of strings into these buffers without checking the length of the input lists, resulting in a buffer overflow. Additionally, the values of `ARG_MAX` and `ENV_MAX` could be undefined on some systems.
- **Weaknesses/vulnerabilities present:** Buffer overflow vulnerability and memory leak. The code didn't validate the size of the input data before copying it to a fixed-size buffer. A memory leak existed that would trigger when an error was raised during argument and environment processing, which was caused by the allocation of memory that would not get freed in the event of an error.
- **Impact of exploitation:** A buffer overflow could lead to arbitrary code execution or denial of service.
- **Attack vectors:** An attacker could provide an overly long list of arguments or environment variables to the vulnerable procedures, exceeding the buffer size and causing the overflow.
- **Required attacker capabilities/position:** The attacker needs the ability to call the vulnerable `process-execute` or `process-spawn` procedures with attacker-controlled lists of arguments or environment variables.