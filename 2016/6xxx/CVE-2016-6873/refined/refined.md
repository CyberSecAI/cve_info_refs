Based on the provided information, here's an analysis of CVE-2016-6873:

**Root Cause:**

The vulnerability stems from a lack of proper recursion checks within the `compact` function in Facebook's HHVM (HipHop Virtual Machine). The `compact` function is used to create an array from variables by their names. The issue occurs when the function encounters a self-referential array. Without adequate checks, it could enter an infinite recursion.

**Weaknesses/Vulnerabilities:**

*   **Missing Recursion Detection:** The `compact` function lacked checks to prevent processing the same array multiple times when encountering self-referential structures which could lead to infinite recursion.

**Impact of Exploitation:**

*   **Denial of Service:**  A malicious actor could craft an input with a self-referential array passed to the `compact` function that would cause HHVM to enter an infinite loop. This could lead to a denial-of-service condition due to excessive resource consumption. The fix raises a warning and prevents the recursion.

**Attack Vectors:**

*   **Crafted Input:** An attacker can trigger the vulnerability by crafting a PHP script that passes a self-referential array to the `compact` function.

**Required Attacker Capabilities/Position:**

*   The attacker needs to be able to execute PHP code through HHVM. This could be achieved through various means depending on the HHVM setup, such as:
    *   Direct access to a web server running HHVM.
    *   Ability to upload and execute PHP files.
    *   Ability to pass parameters to HHVM through a web interface or API.

**Additional Details:**

*   The fix introduces a `PointerSet` to keep track of processed arrays during the recursion. If an array is encountered again during the recursion, a warning is raised and the recursion is terminated. This prevents infinite recursion and mitigates the denial-of-service vulnerability.
*   The code changes associated with the fix are shown in the provided diff. It adds checks to detect the recursion. Specifically, the `compact` function now utilizes a `PointerSet` to track visited arrays and prevent infinite recursion.

In summary, CVE-2016-6873 is related to a missing recursion check in the `compact` function of HHVM, which could lead to a denial-of-service condition. The fix implements a mechanism to detect and stop such recursions.