=== Content from googleprojectzero.blogspot.com_a0334d5b_20250125_211553.html ===


# [Project Zero](https://googleprojectzero.blogspot.com/)

News and updates from the Project Zero team at Google

## Thursday, December 1, 2016

### BitUnmap: Attacking Android Ashmem

Posted by Gal Beniamini, Project Zero

The [law of leaky abstractions](http://www.joelonsoftware.com/articles/LeakyAbstractions.html) states that “all non-trivial abstractions, to some degree, are leaky”. In this blog post we’ll explore the ashmem shared memory interface provided by Android and see how false assumptions about its internal operation can result in security vulnerabilities affecting core system code.

We’ll walk through the process of discovering and exploiting a vulnerability resulting from this leaky abstraction, which will allow us to elevate our privileges from any Android application to a multitude of privileged contexts, including the highly-privileged “system\_server”. This vulnerability has been present in the core Android platform code for the Marshmallow and Nougat versions. It has now been fixed in the [recent Android bulletin](https://source.android.com/security/bulletin/2016-11-01.html). For a detailed disclosure timeline, see the “Timeline” section below.
## One Device to Bind Them

As you know, Android applications can perform inter-process communication (for example, in order to communicate with various Android services), by using the Android [binder](https://www.nds.rub.de/media/attachments/files/2012/03/binder.pdf). Initially, each Android service registers itself with a central daemon; the “service manager”. Subsequently, applications may contact the daemon in order to request “handles” with which the registered services may be contacted.

In keeping with good IPC design, the interface provided by binder itself is rather simplified. In fact, binder transactions are capped to a size of [at-most 1MB](https://developer.android.com/reference/android/os/TransactionTooLargeException.html). Well then, what about scenarios in which we need to transfer a large amount of data to a system service? For example, what if we want to modify the phone’s wallpaper? What about playing a media file? Surely we wouldn’t need to “re-invent” a mechanism through which memory can be shared in larger quantities between processes using binder transactions.

Indeed, there’s no need to worry. You see, binder transactions support the transfer of more than just binary data. In fact, binder transactions can be used to transfer file descriptors and even other binder handles. For instance, this is how the “service manager” is able to provide processes with handles through which they may communicate with the requested services.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiAkQeswaAN0Jn6Ik5sUfCWz-l27UHtI1UD8mGf1kipUX0AGIdBX5LvyWyKJ2rt4e90WvOcoUyr0L08Z9zNqHTgS1U1MaqjqwAnl2nZLv5ccMo4uXjA66egBAaI1z8Iel1pJecBkqxsczYlOPVTi2yaTY34SeWmeVmlm2ui5jWTBBUb5Kak6H4eCZUr/s600/QSNxlFBNN4j5Cxs9Q-jmYY3zZXkEZZ53UMtPi0bixgxhIai9mbgAVr8gF_O-mOtj6SNsuSs_Gjq1URYpW3pMkhNoknSdaQyD0Ru2a5WzKfJTMHsCDi3gdv5gNHoIp2hCUpOwc-UO.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiAkQeswaAN0Jn6Ik5sUfCWz-l27UHtI1UD8mGf1kipUX0AGIdBX5LvyWyKJ2rt4e90WvOcoUyr0L08Z9zNqHTgS1U1MaqjqwAnl2nZLv5ccMo4uXjA66egBAaI1z8Iel1pJecBkqxsczYlOPVTi2yaTY34SeWmeVmlm2ui5jWTBBUb5Kak6H4eCZUr/s1138/QSNxlFBNN4j5Cxs9Q-jmYY3zZXkEZZ53UMtPi0bixgxhIai9mbgAVr8gF_O-mOtj6SNsuSs_Gjq1URYpW3pMkhNoknSdaQyD0Ru2a5WzKfJTMHsCDi3gdv5gNHoIp2hCUpOwc-UO.png)
Great, so we have a means of communicating with other processes - even in large volumes. But what about cases where we’d like to share (rather than simply transfer) large quantities of memory? Once again - no need to worry! For this purpose, Android has introduced a means of sharing memory, called “ashmem” (Android Shared Memory).

## Sharing (memory) is Caring

So what exactly is ashmem? In short, each ashmem file descriptor acts as a handle to a shared memory region. The device also allows the user to perform several memory-sharing operations via a set of supported ioctls. These allow the user to set the size of the shared memory region referred to by the ashmem file descriptor, modify the name of the shared region and even control the protection mask with which this descriptor may be mmap-ed.

Let’s take a closer look at the actual implementation of the ashmem device, starting with the ioctl used to control the size of a shared memory region - [ASHMEM\_SET\_SIZE](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#753):

| static long [ashmem\_ioctl](http://androidxref.com/kernel_3.18/s?refs=ashmem_ioctl&project=drivers)(struct [file](http://androidxref.com/kernel_3.18/s?refs=file&project=drivers) \*[file](http://androidxref.com/kernel_3.18/s?refs=file&project=drivers), unsigned int [cmd](http://androidxref.com/kernel_3.18/s?refs=cmd&project=drivers), unsigned long [arg](http://androidxref.com/kernel_3.18/s?refs=arg&project=drivers)){    struct [ashmem\_area](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#ashmem_area) \*[asma](http://androidxref.com/kernel_3.18/s?refs=asma&project=drivers) = [file](http://androidxref.com/kernel_3.18/s?defs=file&project=drivers)->[private\_data](http://androidxref.com/kernel_3.18/s?defs=private_data&project=drivers);    long [ret](http://androidxref.com/kernel_3.18/s?refs=ret&project=drivers) = -[ENOTTY](http://androidxref.com/kernel_3.18/s?defs=ENOTTY&project=drivers);     switch ([cmd](http://androidxref.com/kernel_3.18/s?defs=cmd&project=drivers)) {        …   **...**     }    return [ret](http://androidxref.com/kernel_3.18/s?defs=ret&project=drivers);} |
| --- |

As we can see above, this ioctl simply allows the user to pass in any size. As long as the shared memory region has not been mapped yet, the device will happily record the passed-in size as the underlying size corresponding to the memory region. Not only that, but the recorded size can then be queried by the user by issuing the corresponding ioctl - [ASHMEM\_GET\_SIZE](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#760).

So… this looks rather suspicious. What exactly does “setting the size” actually mean? Recall that ashmem regions are mapped-in by calling mmap, and, as we know, the mmap syscall receives an argument denoting the size of the mapping to be created.

This begs the question: what if the size of a created mapping does not match the size of an ashmem region? Perhaps the implementation of mmap will simply ignore the passed in size argument and use the size provided in ASHMEM\_SET\_SIZE? Perhaps, instead, the implementation of mmap will simply ignore the underlying size and use the size argument instead? There’s only one way to [find out](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#361):

| static int [ashmem\_mmap](http://androidxref.com/kernel_3.18/s?refs=ashmem_mmap&project=drivers)(struct [file](http://androidxref.com/kernel_3.18/s?refs=file&project=drivers) \*[file](http://androidxref.com/kernel_3.18/s?refs=file&project=drivers), struct [vm\_area\_struct](http://androidxref.com/kernel_3.18/s?defs=vm_area_struct&project=drivers) \*[vma](http://androidxref.com/kernel_3.18/s?refs=vma&project=drivers)){    struct [ashmem\_area](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#ashmem_area) \*[asma](http://androidxref.com/kernel_3.18/s?refs=asma&project=drivers) = [file](http://androidxref.com/kernel_3.18/s?defs=file&project=drivers)->[private\_data](http://androidxref.com/kernel_3.18/s?defs=private_data&project=drivers);     ...    if (![asma](http://androidxref.com/kernel_3.18/s?defs=asma&project=drivers)->[file](http://androidxref.com/kernel_3.18/s?defs=file&project=drivers)) {        ...         [vmfile](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#vmfile) = [shmem\_file\_setup](http://androidxref.com/kernel_3.18/s?defs=shmem_file_setup&project=drivers)([name](http://androidxref.com/kernel_3.18/s?defs=name&project=drivers), [asma](http://androidxref.com/kernel_3.18/s?defs=asma&project=drivers)->[size](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#size), [vma](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#vma)->[vm\_flags](http://androidxref.com/kernel_3.18/s?defs=vm_flags&project=drivers));        ...         [asma](http://androidxref.com/kernel_3.18/s?defs=asma&project=drivers)->[file](http://androidxref.com/kernel_3.18/s?defs=file&project=drivers) = [vmfile](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#vmfile);    }    ...     [vma](http://androidxref.com/kernel_3.18/xref/drivers/staging/android/ashmem.c#vma)->[vm\_file](http://androidxref.com/kernel_3.18/s?defs=vm_file&project=drivers) = [asma](http://androidxref.com/kernel_3.18/s?defs=asma&project=drivers)->[file](http://androidxref.com/kernel_3.18/s?defs=file&project=drivers);     [mutex\_unlock](http://androidxref.com/kernel_3.18/s?defs=mutex_unlock&project=drivers)(&[ashmem\_mutex](http://androidxref.com/kernel_3.18/s?defs=ashmem_mutex&project=drivers));    return [ret](http://androidxref.com/kernel_3.18/s?defs=ret&project=drivers);} |
| --- |

As we can see above, while the actual shared memory file is created using the size of the shared memory region (using “shmem\_file\_setup”), the memory mapping itself is created using the size in the virtual memory area (vma) - that is, the size passed in to mmap.

Let’s take a step back and reflect on this decision.

Essentially, this means that developers who attempt to use an ashmem region must take special care to always call mmap using the same size of the underlying shared memory region. Failing to do so will not return any visible error code to the developer, but will instead create a mapping with potentially dangerous consequences.

For starters, if a developer mmap-s a region with a size larger than the actual underlying region’s size, any attempt to access memory beyond the bounds of the underlying region will result in a illegal access, sending the SIGBUS signal to the process (which will then probably subsequently terminate).

But there’s another, more interesting, potential pitfall. What if the developer erroneously assumes that size of the underlying shared memory region and the mmap-ed size must be equal to one another? To try and answer this question, I’ve audited all instances of Android services which use ashmem to share memory with a user. From here on, we’ll focus on one such case - Bitmaps.
## Mismatching Assumptions

As we mentioned earlier, one operation which requires the transfer of potentially large quantities of memory from one process to another is the exchange of images. For this purpose, Android exposes the [Bitmap](https://developer.android.com/reference/android/graphics/Bitmap.html) class, which can be easily serialized into a binder parcel.

As Bitmaps may be larger than the 1MB limit for binder transactions, the image’s data must be transferred via other means - such as ashmem. Indeed, for bitmaps above a certain size, this is exactly how this data is transferred. We can see that by looking at the “unflattening” function, “[Bitmap\_createFromParcel](http://androidxref.com/7.0.0_r1/xref/frameworks/base/core/jni/android/graphics/Bitmap.cpp#947)”:

| static [jobject](http://androidxref.com/7.0.0_r1/s?defs=jobject&project=frameworks) [Bitmap\_createFromParcel](http://androidxref.com/7.0.0_r1/s?refs=Bitmap_createFromParcel&project=frameworks)([JNIEnv](http://androidxref.com/7.0.0_r1/s?defs=JNIEnv&project=frameworks)\* [env](http://androidxref.com/7.0.0_r1/s?refs=env&project=frameworks), [jobject](http://androidxref.com/7.0.0_r1/s?defs=jobject&project=frameworks), [jobject](http://androidxref.com/7.0.0_r1/s?defs=jobject&project=frameworks) [parcel](http://androidxref.com/7.0.0_r1/s?refs=parcel&project=frameworks)) {      [android](http://androidxref.com/7.0.0_r1/xref/frameworks/base/core/jni/android/graphics/Bitmap.cpp#android)::[Parcel](http://androidxref.com/7.0.0_r1/s?defs=Parcel&project=frameworks)\* p = [android](http://androidxref.com/7.0.0_r1/xref/frameworks/base/core/jni/android/graphics/Bitmap.cpp#android)::[parcelForJavaObject](http://androidxref.com/7.0.0_r1/s?defs=parcelForJavaObject&project=frameworks)([env](http://androidxref.com/7.0.0_r1/s?defs=env&project=frameworks), [parcel](http://androidxref.com/7.0.0_r1/s?defs=parcel&project=frameworks));    const [SkColorType](http://androidxref.com/7.0.0_r1/s?defs=SkColorType&project=frameworks) [colorType](http://androidxref.com/7.0.0_r1/s?refs=colorType&project=frameworks) = ([SkColorType](http://androidxref.com/7.0.0_r1/s?defs=SkColorType&project=frameworks))p->[readInt32](http://androidxref.com/7.0.0_r1/s?defs=readInt32&project=frameworks)();    const [SkAlphaType](http://androidxref.com/7.0.0_r1/s?defs=SkAlphaType&project=frameworks) [alphaType](http://androidxref.com/7.0.0_r1/s?refs=alphaType&project=frameworks) = ([SkAlphaType](http://androidxref.com/7.0.0_r1/s?defs=SkAlphaType&project=frameworks))p->[readInt32](http://androidxref.com/7.0.0_r1/s?defs=readInt32&project=frameworks)();    const int [width](http://androidxref.com/7.0.0_r1/s?refs=width&project=frameworks) = p->[readInt32](http://androidxref.com/7.0.0_r1/s?defs=readInt32&project=frameworks)();    const int [height](http://androidxref.com/7.0.0_r1/s?refs=height&project=frameworks) = p->[readInt32](http://androidxref.com/7.0.0_r1/s?defs=readInt32&project=frameworks)();    const int [rowBytes](http://androidxref.com/7.0.0_r1/s?refs=rowBytes&project=frameworks) = p->[readInt32](http://androidxref.com/7.0.0_r1/s?defs=readInt32&project=frameworks)();    …    [std](http://androidxref.com/7.0.0_r1/s?defs=std&project=frameworks)::[unique\_ptr](http://androidxref.com/7.0.0_r1/s?defs=unique_ptr&project=frameworks)<[SkBitmap](http://androidxref.com/7.0.0_r1/s?path=SkBitmap)> [bitmap](http://androidxref.com/7.0.0_r1/s?defs=bitmap&project=frameworks)(new [SkBitmap](http://androidxref.com/7.0.0_r1/s?defs=SkBitmap&project=frameworks));    if (![bitmap](http://androidxref.com/7.0.0_r1/s?defs=bitmap&project=frameworks)->[setInfo](http://androidxref.com/7.0.0_r1/s?defs=setInfo&project=frameworks)([SkImageInfo](http://androidxref.com/7.0.0_r1/s?defs=SkImageInfo&project=frameworks)::[Make](http://androidxref.com/7.0.0_r1/s?defs=Make&project=frameworks)([width](http://androidxref.com/7.0.0_r1/s?defs=width&project=frameworks), [height](http://androidxref.com/7.0.0_r1/s?defs=height&project=frameworks), [colorType](http://androidxref.com/7.0.0_r1/s?defs=colorType&project=frameworks), [alphaType](http://androidxref.com/7.0.0_r1/s?defs=alphaType&project=frameworks)), [rowBytes](http://androidxref.com/7.0.0_r1/s?defs=rowBytes&project=frameworks))) {        return [NULL](http://androidxref.com/7.0.0_r1/s?defs=NULL&project=frameworks);    }     …     [size\_t](http://androidxref.com/7.0.0_r1/s?defs=size_t&project=frameworks) [size](http://androidxref.com/7.0.0_r1/s?refs=size&project=frameworks) = [bitmap](http://androidxref.com/7.0.0_r1/s?defs=bitmap&project=frameworks)->[getSize](http://androidxref.com/7.0.0_r1/s?defs=getSize&project=frameworks)();    [android](http://androidxref.com/7.0.0_r1/xref/frameworks/base/core/jni/android/graphics/Bitmap.cpp#android)::[Parcel](http://androidxref.com/7.0.0_r1/s?defs=Parcel&project=frameworks)::[ReadableBlob](http://androidxref.com/7.0.0_r1/s?defs=ReadableBlob&project=frameworks) [blob](http://androidxref.com/7.0.0_r1/s?refs=blob&project=frameworks);    [android](http://androidxref.com/7.0.0_r1/xref/frameworks/base/core/jni/android/graphics/Bitmap.cpp#android)::[status\_t](http://androidxref.com/7.0.0_r1/s?defs=status_t&project=frameworks) [status](http://androidxref.com/7.0.0_r1/s?refs=status&project=frameworks) = p->[readBlob](http://androidxref.com/7.0.0_r1/s?defs=readBlob&project=frameworks)([size](http://androidxref.com/7.0.0_r1/s?defs=size&project=frameworks), &[blob](http://androidxref.com/7.0.0_r1/s?defs=blob&project=frameworks));     … } |
| --- |

First, the image’s metadata is extracted from the parcel and is used to construct an SkBitmap instance to hold this information. Next, the function proceeds to reads the actual bitmap’s data by calling Parcel::readBlob.

However, this looks potentially dangerous! First of all, note that the function uses the SkBitmap instance (i.e., the one holding all the metadata we read earlier on) in order to calculate the “size” of the resulting bitmap’s data. Then, it calls Parcel::readBlob in order to actually read the transferred data, while using the previously calculated size as an input argument.

Finally, let’s take a look at how Parcel::readBlob actually reads the enclosed Bitmap’s data:

| [status\_t](http://androidxref.com/7.0.0_r1/s?defs=status_t&project=frameworks) [Parcel](http://androidxref.com/7.0.0_r1/xref/frameworks/native/libs/binder/Parcel.cpp#Parcel)::[readBlob](http://androidxref.com/7.0.0_r1/s?refs=readBlob&project=frameworks)([size\_t](http://androidxref.com/7.0.0_r1/s?defs=size_t&project=frameworks) [len](http://androidxref.com/7.0.0_r1/s?refs=len&project=frameworks), [ReadableBlob](http://androidxref.com/7.0.0_r1/s?defs=ReadableBlob&project=frameworks)\* [outBlob](http://androidxref.com/7.0.0_r1/xref/frameworks/native/libs/binder/Parcel.cpp#outBlob)) const{    [int32\_t](http://androidxref.com/7.0.0_r1/s?defs=int32_t&project=frameworks) [blobType](http://androidxref.com/7.0.0_r1/s?refs=blobType&project=frameworks);    [status\_t](http://androidxref.com/7.0.0_r1/s?defs=status_t&project=frameworks) [status](http://androidxref.com/7.0.0_r1/s?refs=status&project=frameworks) = [readInt32](http://androidxref.com/7.0.0_r1/s?defs=readInt32&project=frameworks)(&[blobType](http://androidxref.com/7.0.0_r1/xref/frameworks/native/libs/binder/Parcel.cpp#blobType));     …    int [fd](http://androidxref.com/7.0.0_r1/s?refs=fd&project=frameworks) = [readFileDescriptor](http://androidxref.com/7.0.0_r1/xref/frameworks/native/libs/binder/Parcel.cpp#readFileDescriptor)();    ...     void\* [ptr](http://androidxref.com/7.0.0_r1/s?refs=ptr&project=frameworks) = ::[mmap](http://androidxref.com/7.0.0_r1/s?defs=mmap&project=frameworks)([NULL](http://androidxref.com/7.0.0_r1/s?defs=NULL&project=frameworks), l[en](http://androidxref.com/7.0.0_r1/s?defs=len&project=frameworks),                                     [isMutable](http://androidxref.com/7.0.0_r1/s?defs=isMutable&project=frameworks) ? [PROT\_READ](http://androidxref.com/7.0.0_r1/s?defs=PROT_READ&project=frameworks) | [PROT\_WRITE](http://androidxref.com/7.0.0_r1/s?defs=PROT_WRITE&project=frameworks) : [PROT\_READ](http://androidxref.com/7.0.0_r1/s?defs=PROT_READ&project=frameworks),                                    [MAP\_SHARED](http://androidxref.com/7.0.0_r1/s?defs=MAP_SHARED&project=frameworks), f[d](http://androidxref.com/7.0.0_r1/s?defs=fd&project=frameworks), 0);     ...    return [NO\_ERROR](http://androidxref.com/7.0.0_r1/s?defs=NO_ERROR&project=frameworks); } |
| --- |

Aha! This is exactly what we were looking for. Instead of using the underlying size of the memory region, Parcel::readBlob performs an mmap operation using our own controlled length argument (i.e., the size computed from the bitmap’s metadata).

In and of itself, this is already a bad practice; the user could pass in an ashmem descriptor with any arbitrary size, resulting in an “invalid” memory mapping of the type we discussed earlier. This, in turn, would trigger a SIGBUS if the receiving application attempts to access the mmap-ed memory region.

But perhaps we can do better than just creating an invalid mapping? We’ve seen how the memory is mapped-in when creating a Bitmap, but how is it unmapped?

Well, after reading in the bitmap’s data, Bitmap\_createFromParcel proceeds to store the information about the mapped data in the constructed Bitmap instance:

| [Bitmap](http://androidxref.com/7.0.0_r1/s?refs=Bitmap&project=frameworks)::[Bitmap](http://androidxref.com/7.0.0_r1/s?refs=Bitmap&project=frameworks)(void\* [address](http://androidxref.com/7.0.0_r1/s?refs=address&project=frameworks), int [fd](http://androidxref.com/7.0.0_r1/s?refs=fd&project=frameworks),                            const [SkImageInfo](http://androidxref.com/7.0.0_r1/s?defs=SkImageInfo&project=frameworks)& [info](http://androidxref.com/7.0.0_r1/s?defs=info&project=frameworks), [size\_t](http://androidxref.com/7.0.0_r1/s?defs=size_t&project=frameworks) [rowBytes](http://androidxref.com/7.0.0_r1/s?defs=rowBytes&project=frameworks), [SkColorTable](http://androidxref.com/7.0.0_r1/s?defs=SkColorTable&project=frameworks)\* [ctable](http://androidxref.com/7.0.0_r1/s?defs=ctable&project=frameworks))                                : [mPixelStorageType](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorageType&project=frameworks)([PixelStorageType](http://androidxref.com/7.0.0_r1/s?defs=PixelStorageType&project=frameworks)::[Ashmem](http://androidxref.com/7.0.0_r1/s?defs=Ashmem&project=frameworks)) {    [mPixelStorage](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorage&project=frameworks).[ashmem](http://androidxref.com/7.0.0_r1/s?defs=ashmem&project=frameworks).[address](http://androidxref.com/7.0.0_r1/s?defs=address&project=frameworks) = [address](http://androidxref.com/7.0.0_r1/s?defs=address&project=frameworks);    [mPixelStorage](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorage&project=frameworks).[ashmem](http://androidxref.com/7.0.0_r1/s?defs=ashmem&project=frameworks).[fd](http://androidxref.com/7.0.0_r1/s?defs=fd&project=frameworks) = [fd](http://androidxref.com/7.0.0_r1/s?defs=fd&project=frameworks);    [mPixelStorage](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorage&project=frameworks).[ashmem](http://androidxref.com/7.0.0_r1/s?defs=ashmem&project=frameworks).[size](http://androidxref.com/7.0.0_r1/s?defs=size&project=frameworks) = [ashmem\_get\_size\_region](http://androidxref.com/7.0.0_r1/s?defs=ashmem_get_size_region&project=frameworks)([fd](http://androidxref.com/7.0.0_r1/s?defs=fd&project=frameworks));    [mPixelRef](http://androidxref.com/7.0.0_r1/s?defs=mPixelRef&project=frameworks).[reset](http://androidxref.com/7.0.0_r1/s?defs=reset&project=frameworks)(new [WrappedPixelRef](http://androidxref.com/7.0.0_r1/s?defs=WrappedPixelRef&project=frameworks)(this, [address](http://androidxref.com/7.0.0_r1/s?defs=address&project=frameworks), [info](http://androidxref.com/7.0.0_r1/s?defs=info&project=frameworks), [rowBytes](http://androidxref.com/7.0.0_r1/s?defs=rowBytes&project=frameworks), [ctable](http://androidxref.com/7.0.0_r1/s?defs=ctable&project=frameworks)));    // Note: this will trigger a call to onStrongRefDestroyed(), but    // we want the pixel ref to have a ref count of 0 at this point    [mPixelRef](http://androidxref.com/7.0.0_r1/s?defs=mPixelRef&project=frameworks)->[unref](http://androidxref.com/7.0.0_r1/s?defs=unref&project=frameworks)();} |
| --- |

However, instead of using the size of the previously created mapping, the constructor simply retrieves the size of the mapping using the ASHMEM\_GET\_SIZE ioctl (using the thin-wrapper ashmem\_get\_size\_region). This is, once more, a false assumption - namely, that the underlying ashmem size and the size of the mmap-ed region must be equal to one another. Finally, once the bitmap is freed, the area is unmapped by calling:

| void [Bitmap](http://androidxref.com/7.0.0_r1/s?defs=Bitmap&project=frameworks)::[doFreePixels](http://androidxref.com/7.0.0_r1/s?refs=doFreePixels&project=frameworks)() {    switch ([mPixelStorageType](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorageType&project=frameworks)) {         ...        case [PixelStorageType](http://androidxref.com/7.0.0_r1/s?defs=PixelStorageType&project=frameworks)::[Ashmem](http://androidxref.com/7.0.0_r1/s?defs=Ashmem&project=frameworks):            [munmap](http://androidxref.com/7.0.0_r1/s?defs=munmap&project=frameworks)([mPixelStorage](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorage&project=frameworks).[ashmem](http://androidxref.com/7.0.0_r1/s?defs=ashmem&project=frameworks).[address](http://androidxref.com/7.0.0_r1/s?defs=address&project=frameworks), [mPixelStorage](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorage&project=frameworks).[ashmem](http://androidxref.com/7.0.0_r1/s?defs=ashmem&project=frameworks).[size](http://androidxref.com/7.0.0_r1/s?defs=size&project=frameworks));            [close](http://androidxref.com/7.0.0_r1/s?defs=close&project=frameworks)([mPixelStorage](http://androidxref.com/7.0.0_r1/s?defs=mPixelStorage&project=frameworks).[ashmem](http://androidxref.com/7.0.0_r1/s?defs=ashmem&project=frameworks).[fd](http://androidxref.com/7.0.0_r1/s?defs=fd&project=frameworks));            break;        ...     } } |
| --- |

Putting it all together, this means that the mmap and the munmap calls are performed with potentially different length arguments, both of which are fully controllable by the attacker:

* The length of the mmap operation is calculated from the bitmap’s metadata
* The length of the munmap operation is calculated from the ashmem’s size

The mismatch between the mmap-ed and munmap-ed length provides us with a great exploitation primitive! Specifically, we could supply a short length for the mmap operation and a longer length for the munmap operation - thus resulting in deletion of an arbitrarily large range of virtual memory following our bitmap object. Moreover, there’s no need for the deleted range to contain one continuous memory mapping, since the range supplied in munmap [simply ignores unmapped pages](https://linux.die.net/man/3/munmap).

Once we delete a range of memory, we can then attempt to “re-capture” that memory region with controlled data, by causing another allocation in the remote process. By doing so, we can forcibly “free” a data structure and replace its contents with our own chosen data -- effectively forcing a use-after-free condition.

From here on, we’ll refer to these crafted bitmaps with mismatching lengths as “BitUnmap”s.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiqUX3DdzTACT5RZsKzsmupVbjT6CThV2H7shRBALU1p7Ap9-eUExDxrZ-oscQFk7g_Wo58Ja2BM5mnbeHQ4uJo9zkz0gOnv2-y4ywNnkh6JcqTaYe9Vki_C-XTU_TlPe6DyD3E1_kabe6BTrGikNeih7KWWvO-od6aLAo471t-wciVd7oAN9OLiucM/s600/c26F-jF6NB0yPryv3KfzUqfa_59WiaHpl6pcVfJza-Lfz1aK8sIAlMTtp7wimBNVlfUr5oy2O2Wa1q2T-97GntP4BTTjdrN7vSNBiocG0ptQPreSzCzHfc1nZnM6AdnLqhm6s79w.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiqUX3DdzTACT5RZsKzsmupVbjT6CThV2H7shRBALU1p7Ap9-eUExDxrZ-oscQFk7g_Wo58Ja2BM5mnbeHQ4uJo9zkz0gOnv2-y4ywNnkh6JcqTaYe9Vki_C-XTU_TlPe6DyD3E1_kabe6BTrGikNeih7KWWvO-od6aLAo471t-wciVd7oAN9OLiucM/s1600/c26F-jF6NB0yPryv3KfzUqfa_59WiaHpl6pcVfJza-Lfz1aK8sIAlMTtp7wimBNVlfUr5oy2O2Wa1q2T-97GntP4BTTjdrN7vSNBiocG0ptQPreSzCzHfc1nZnM6AdnLqhm6s79w.png)
## Thinking of an Exploit Strategy

### Finding a Target Service

Okay - now that we finally have a good exploitation primitive, how can we use it in order to write a stable exploit that will allow us to gain code execution in system\_server? First of all, we’ll need to find a binder call in system\_server which un-flattens a Bitmap object (or unparcels a Bundle containing a Bitmap) from a binder transaction. Moreover, it would be advantageous if we were able to access this call from any context, requiring no permissions.

Luckily, system\_server houses many different binder services, increasing the odds of finding a comfortably exploitable endpoint.

One such candidate is the “notification” service, which provides an interface for interaction with the notification bar. Among the operations supported by this service, any application (even those running in the isolated\_app SELinux context and those requiring no permissions whatsoever) may attempt to add a notification object which is then handled by the notification service. Moreover, Notification objects are [complex](http://androidxref.com/7.0.0_r1/xref/frameworks/base/core/java/android/app/Notification.java), and may contain images (bitmaps) along with the presented text.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjh9zM9rssS4C3lVISaVIXhshF8JZV-Y53caAzNfM1R6SzEd3tXVZ_dQUifNsTcVjjbRqMACoRg27s4-pWMjODXpQGQRCB1Vh4Ta3kSa4RfZHjn8W-A9-mWKJhafTkw2gcU9fwXWBvXKbzv2H1KQzF-mBi6T4cjd9H-OmjkeGxtGisrJM3kHJdIdvhU/s600/nMFNq9pXWgGcHOq5dk-JFAUDN_IDfjfLhZ2Fx8FDbTRInuMlzZoE60AxmJisQuD0WKJ9KeNiaRzIBAaeluhPbDh71qOu8JjukT2FyLdRgEtpqD5PIHxasg1NoVbobA0r1_5A5KzW.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjh9zM9rssS4C3lVISaVIXhshF8JZV-Y53caAzNfM1R6SzEd3tXVZ_dQUifNsTcVjjbRqMACoRg27s4-pWMjODXpQGQRCB1Vh4Ta3kSa4RfZHjn8W-A9-mWKJhafTkw2gcU9fwXWBvXKbzv2H1KQzF-mBi6T4cjd9H-OmjkeGxtGisrJM3kHJdIdvhU/s844/nMFNq9pXWgGcHOq5dk-JFAUDN_IDfjfLhZ2Fx8FDbTRInuMlzZoE60AxmJisQuD0WKJ9KeNiaRzIBAaeluhPbDh71qOu8JjukT2FyLdRgEtpqD5PIHxasg1NoVbobA0r1_5A5KzW.png)
Using notifications is also advantageous for a completely different reason - their lifetime is controlled by the attacker. Remember that after we free a memory range in the remote process, we’d like to re-capture that memory region with our own controlled data. Well, as we’ve already seen, Bitmap objects are mmap-ed into the remote address-space, and contain completely controlled data. What’s more, once a notification is added to the notification bar, the Notification object will remain referenced in the remote process (until the notification is removed). This effectively means we can use notifications for a dual purpose:

* Sending crafted BitUnmaps to delete memory ranges in the remote process
* Sending regular Bitmaps with controlled data in order to reclaim freed regions

### Finding a Target Data Structure

After we’ve established our ability to unmap arbitrarily large memory regions in system\_server by crafting our own Notification objects containing BitUnmap instances, we still need to think of a method with which we’ll be able to reliably hijack control flow in system\_server. That is, we need to decide which data structure to unmap using our primitive.

First, consider the fact that our BitUnmap objects are allocated by calling mmap. Due to the [behaviour of mmap](http://androidxref.com/kernel_3.18/xref/mm/mmap.c#1922), they will simply inhabit the highest memory address between mm->mmap\_base and TASK\_SIZE which contains a sufficiently large contiguous hole. This means that, for example, attacking single C++ or Java objects would be rather difficult, as they are located in the heap and are surrounded by other data structures which we would have to “repair”.

Moreover, even if we were able to hijack such data structures, we would still need to craft their content in a way which would allow us to eventually hijack the control flow. For example, exploiting use-after-free vulnerabilities in C++ objects normally includes hijacking their vtable and replacing it with a structure pointing to other executable memory locations. With modern exploit mitigation techniques, the amount of steps required to bypass XN-bit protection and ASLR could be quite substantial.

Perhaps there’s a cleaner way to get code execution?

Optimally, we’re looking to replace a data structure that has the following properties:

* Is allocated directly using mmap (i.e., not “on the heap”)

+ Therefore we don’t need to “repair” adjacent data structures

* Allows direct control over code execution

+ Saves us the need to craft a complex chain to bypass mitigation techniques

* Does not require address-space dependant information unique to system\_server

+ Saves us the need to find (or create) an information leak to bypass ASLR

In order to find this magical structure, I’ve written a small gdb script to monitor and log all calls to mmap coupled with their origins and sizes. This helped me group the “families” of mmap-ed objects which could be useful for exploitation. After producing the list, one such candidate stood out as having all the above properties - Threads.

### Hanging by a Thread

As we know, all threads in the same process share the same address space. Moreover, system\_server, being the large process that it is, contains many code paths which handle long-running or periodic tasks. Naturally, these code paths are handled by creating additional threads in system\_server. When threads are created, they require two data structures which are unique to each thread: the thread metadata (pthread\_internal\_t) and the thread’s stack.

Looking at the code in Android’s bionic, we can see that these two regions are, in fact, carved from the same memory region, which is [allocated using mmap](http://androidxref.com/7.0.0_r1/xref/bionic/libc/bionic/pthread_create.cpp#142):

| static int [\_\_allocate\_thread](http://androidxref.com/7.0.0_r1/s?refs=__allocate_thread&project=bionic)([pthread\_attr\_t](http://androidxref.com/7.0.0_r1/s?defs=pthread_attr_t&project=bionic)\* [attr](http://androidxref.com/7.0.0_r1/s?refs=attr&project=bionic),                                                [pthread\_internal\_t](http://androidxref.com/7.0.0_r1/s?defs=pthread_internal_t&project=bionic)\*\* [threadp](http://androidxref.com/7.0.0_r1/s?refs=threadp&project=bionic),                                                void\*\* [child\_stack](http://androidxref.com/7.0.0_r1/s?refs=child_stack&project=bionic)) {    if ([attr](http://androidxref.com/7.0.0_r1/s?defs=attr&project=bionic)->[stack\_base](http://androidxref.com/7.0.0_r1/xref/bionic/libc/bionic/pthread_create.cpp#stack_base) == [NULL](http://androidxref.com/7.0.0_r1/s?defs=NULL&project=bionic)) {        // The caller didn't provide a stack, so allocate one.        // Make sure the stack size and guard size are multiples of PAGE\_SIZE.        [mmap\_size](http://androidxref.com/7.0.0_r1/s?defs=mmap_size&project=bionic) = [BIONIC\_ALIGN](http://androidxref.com/7.0.0_r1/s?defs=BIONIC_ALIGN&project=bionic)([attr](http://androidxref.com/7.0.0_r1/s?defs=attr&project=bionic)->[stack\_size](http://androidxref.com/7.0.0_r1/s?defs=stack_size&project=bionic) + sizeof([pthread\_internal\_t](http://androidxref.com/7.0.0_r1/s?defs=pthread_internal_t&project=bionic)),                                                          [PAGE\_SIZE](http://androidxref.com/7.0.0_r1/s?defs=PAGE_SIZE&project=bionic));        [attr](http://androidxref.com/7.0.0_r1/s?defs=attr&project=bionic)->[guard\_size](http://androidxref.com/7.0.0_r1/s?defs=guard_size&project=bionic) = [BIONIC\_ALIGN](http://androidxref.com/7.0.0_r1/s?defs=BIONIC_ALIGN&project=bionic)([attr](http://androidxref.com/7.0.0_r1/s?defs=attr&project=bionic)->[guard\_size](http://androidxref.com/7.0.0_r1/s?defs=guard_size&project=bionic), [PAGE\_SIZE](http://androidxref.com/7.0.0_r1/s?defs=PAGE_SIZE&project=bionic));         //Calls mmap to create the mapped space, and mprotect to create a guard page        [attr](http://androidxref.com/7.0.0_r1/s?defs=attr&project=bionic)->[stack\_base](http://androidxref.com/7.0.0_r1/xref/bionic/libc/bionic/pthread_create.cpp#stack_base) = [\_\_create\_thread\_mapped\_space](http://androidxref.com/7.0.0_r1/xref/bionic/libc/bionic/pthread_create.cpp#__create_thread_mapped_space)([mmap\_size](http://androidxref.com/7.0.0_r1/s?defs=mmap_size&project=bionic), [attr](http://androidxref.com/7.0.0_r1/s?defs=attr&project=bionic)->[guard\_size](http://androidxref.com/7.0.0_r1/s?defs=guard_size&project=bionic));        …         [stack\_top](http://androidxref.com/7.0.0_r1/xref/bionic/libc/bionic/pthread_create.cpp#stack_top) = reinterpret\_cast<[uint8\_t](http://androidxref.com/7.0.0_r1/s?defs=uint8_t&project=bionic)\*>([attr](http://androidxref.com/7.0.0_r1/s?defs=attr&project=bionic)->[stack\_base](http://androidxref.com/7.0.0_r1/xref/bionic/libc/bionic/pthread_create.cpp#stack_base)) + [mmap\_size](http://androidxref.com/7.0.0_r1/s?defs=mmap_size&project=bionic);        …     }     ...     [pthread\_internal\_t](http://androidxref.com/7.0.0_r1/s?defs=pthread_internal_t&project=bionic)\* [thread](http://androidxref.com/7.0.0_r1/s?refs=thread&project=bionic) = reinterpret\_cast<[pthread\_internal\_t](http://androidxref.com/7.0.0_r1/s?defs=pthread_internal_t&project=bionic)\*>([stack\_top](http://androidxref.com/7.0.0_r1/xref/bionic/libc/bionic/pthread_create.cpp#stack_top));    ... }  So, if we are able to deallocate a thread’s stack and immediately reclaim it as our own, we should be able to directly achieve code execution simply by virtue of already having prepared a stack which performs whichever operation we’d like to execute within system\_server.  Regardless, before we can start scheming about hijacking a thread, we need to think of a way to spawn a thread in system\_server on-demand.  Going through the available binder calls terminating in system\_server reveals one such comfortably accessible code-path: [AudioService::loadSoundEffects](http://androidxref.com/7.0.0_r1/xref/frameworks/base/services/core/java/com/android/server/audio/AudioService.java#2527). This binder command can be called without requiring any permissions, and causes the AudioService to load a predefined set of sound effects in its internal “sound pool”. Creating such a pool causes system\_server to spawn several threads:   In this exploit we’ll hijack the “SoundPoolThread”, for a variety of reasons:  1. It is the first thread created when creating a new sound pool. This fact will come in handy later, when we try and force it to be allocated in a controlled memory region. 2. After initializing a sound pool, the “SoundPoolThread” awaits further commands by [waiting on a condition variable](http://androidxref.com/7.0.0_r1/xref/frameworks/base/media/jni/soundpool/SoundPoolThread.cpp#38). Until the condition variable is signaled, the “futex” system-call will not return. As the thread will not access its stack while it is waiting for the system-call to return, this allows us to replace the thread’s stack with our own, leaving the thread none the wiser. Once we’ve performed our switch, we can trigger a chain of events (such as closing the sound pool by calling unloadSoundEffects) which will signal the condition variable and cause the system-call to return. 3. Once the sound pool is closed, the SoundPoolThread is no longer needed and simply terminates anyway. This means we can safely hijack it without causing any adverse effects in system\_server. |
| --- |

### A Short ROP Chain

Once we hijack the SoundPoolThread’s stack, we’ll need to replace it with our own ROP stack. So, what should we run there? Well, for versions of Android prior to 7.0, we could simply write a short ROP chain which mmap-s one of our ashmem file descriptors with executable access-permissions, and then jumps directly to it. Indeed, this would allow us to simply place executable code at the base of an ashmem descriptor and send it along to system\_server.

However, as of Android 7.0, this solution would no longer work. This is because starting from Android 7.0, a new set of mitigations have begun to roll out which aim to prevent unauthorised code execution within system\_server (and other privileged processes). A small subset of these rules can be [seen here](http://androidxref.com/7.0.0_r1/xref/system/sepolicy/system_server.te):

# system\_server should never use JIT functionality
neverallow system\_server self:process execmem;
neverallow system\_server ashmem\_device:chr\_file execute;
neverallow system\_server system\_server\_tmpfs:file execute;

Specifically, the second rule prevents ashmem file descriptors from being mapped as executable within system\_server. Moreover, the use of execmem (in the first rule) prevents system\_server from mapping “new” executable memory regions within the process.

So… we could still write a large ROP chain to perform whichever set of commands we’d like within system\_server. Due to the breadth of system\_server, the ROP gadgets could conceivably even be turing-complete. However, this seems incredibly complex to do manually, and quite time consuming to automate.

Instead, we could look for a way to directly bypass the mitigation mentioned above. We’ll do so by looking for SELinux contexts which can be executed within system\_server. After a short search, we stumble upon the following SELinux rule:

# system\_server should never execute anything from /data except for /[data](http://androidxref.com/7.0.0_r1/s?path=/data/)/[dalvik-cache](http://androidxref.com/7.0.0_r1/s?path=/data/dalvik-cache) files.
neverallow system\_server {
    data\_file\_type
    -dalvikcache\_data\_file #mapping with PROT\_EXEC
}:file no\_x\_file\_perms;

Okay, so files with the SELinux context dalvikcache\_data\_file may be freely mapped as executable. This makes sense as when Android applications are installed they go through an “optimization” process, resulting in new files which may be executed more quickly. As system\_server loads many of these optimized files, it needs to be able to map them in as executable to use them.

While system\_server may use these files, it cannot directly create them. In fact, the only process which is allowed to create files with these contexts is installd - the installer daemon.

The distinction, however, is purely semantic. This is due to the fact that system\_server can directly issue commands to installd using a special socket. One such command can be issued to cause installd to start such an optimization process (resulting in a file with the dalvikcache\_data\_file context) from any chosen file and to any chosen destination. Thus, all our ROP chain would need to do is to open the installd socket, issue this command to create our wanted executable chunk, and finally map that new file as executable.

We could even go one step further - since we are launching our attack from an Android application, we could simply embed the executable shellcode within the source code of our application (for example, within a static byte array). Once our application is installed, it will be optimized, resulting in a new file of type dalvikcache\_data\_file). As luck would have it, this optimization process does not garble static byte arrays, meaning our shellcode will now reside in this new executable file. Finally, all we need to do is to simply locate this optimised file on the disk and map it in as executable.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcYXeXKAR8NdGQzxkjo5JI0nPhM3Gs_vi2Fi3T7PGMKYupgZU9ngh4p2t7Jegr3Qf0QDFqJm4YD1CU3eTqAa_5f0v24RzwtdjkPEdHqXFB4_OXz_GOqLd5-VZDja7-p9JB1cu5YIQe8BtGd7XKyBrSJQ_DTQM5xKU6jK_LsOC-hutc1jspoXQ2Hcn4/s600/NVZ_VquunisjC8uMikvgBfTK7Qef70cklFD6H7TCFSFx_7Ox8pRH4IXf9_jSBlU0y13-H0aAL5tZy44vWXCdLyJayjwbnol122s5Qesw8su9iDyyRRlBcUSi7xzzT5_yfBAdzF9k.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgcYXeXKAR8NdGQzxkjo5JI0nPhM3Gs_vi2Fi3T7PGMKYupgZU9ngh4p2t7Jegr3Qf0QDFqJm4YD1CU3eTqAa_5f0v24RzwtdjkPEdHqXFB4_OXz_GOqLd5-VZDja7-p9JB1cu5YIQe8BtGd7XKyBrSJQ_DTQM5xKU6jK_LsOC-hutc1jspoXQ2Hcn4/s1295/NVZ_VquunisjC8uMikvgBfTK7Qef70cklFD6H7TCFSFx_7Ox8pRH4IXf9_jSBlU0y13-H0aAL5tZy44vWXCdLyJayjwbnol122s5Qesw8su9iDyyRRlBcUSi7xzzT5_yfBAdzF9k.png)
Lastly, when crafting our ROP stack we’ll need to know where to start writing the gadgets relative to the stack’s base address. That is, we need to know the accurate position in the stack at which the stack pointer will be placed when the SoundPoolThread enters the command loop.

Luckily, we can avoid the need to “guess” the top of the stack (and place a ROP-slide) by using additional trick; we can simply start up such a thread in our own process (by creating a sound pool object), and wait for it to enter the command loop. Once the thread settles, we can read the /proc/$pid/stat for that task and measure the value of the “SP” token against the base address of the stack for that thread.

### Bypassing the need to Bypass ASLR

Up to now we’ve been avoiding the question of ASLR. This has been no mistake, but rather a happy accident. In order to allow for fast application startup times, Android applications are forked from a single process, appropriately named zygote. This process preloads many commonly used shared libraries and resources, thus saving applications the need to do so on their own when they are launched.

Among the processes forked from zygote is our target for exploitation - system\_server.

This essentially means that the portion of our address space which are inherited from zygote are shared with system\_server, including a multitude of shared libraries which are available at our disposal.

As such, once we manage to hijack a running thread, we can create an entire valid ROP stack using gadget addresses located in our own address space (so long as we stick only to zygote-loaded shared libraries). Doing so allows us to ignore ASLR for the purpose of this exploit, as all the other stages of the exploit are address-independent anyway.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgsQj8MQVF17Jr0_hpP7D38mZ-20XcuAt1tRJJInVWvmERn7Z4L9mBIUX1vxsMESpA1tIlhmXx5I3KEJPqXVLylFML6gPojAZuRdhcYm7JJz73nMdIDyCSIM84F66zQo0MvC1f4Icvlt9VfENzEPMUw2nKHJvpqP0-jj2jUaSq4A2OtyzD5dOr5NMJl/s600/mBwqES47SsGlHCPIZ57G8ujedymo4Ma-TdYI4ZYyIo7yWeqg1dllamE6cuVR-qoLh_LN9OfRsl6C0BCecIZM_5v2zIn2dx0hM9nQXzHUjYVYkemeSRvIA1saMCZDGerYX9kRViW3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgsQj8MQVF17Jr0_hpP7D38mZ-20XcuAt1tRJJInVWvmERn7Z4L9mBIUX1vxsMESpA1tIlhmXx5I3KEJPqXVLylFML6gPojAZuRdhcYm7JJz73nMdIDyCSIM84F66zQo0MvC1f4Icvlt9VfENzEPMUw2nKHJvpqP0-jj2jUaSq4A2OtyzD5dOr5NMJl/s1061/mBwqES47SsGlHCPIZ57G8ujedymo4Ma-TdYI4ZYyIo7yWeqg1dllamE6cuVR-qoLh_LN9OfRsl6C0BCecIZM_5v2zIn2dx0hM9nQXzHUjYVYkemeSRvIA1saMCZDGerYX9kRViW3.png)
### Shaping the Address Space

Lastly, before we can put together a complete exploit, we still lack the ability to shape the remote address space. Specifically, we need to reach a state that will cause the targeted objects that we would like to delete to be placed in controlled memory regions, which could then be freed and subsequently reclaimed.

Recall that the behaviour of mmap dictates that for every allocation, the chosen memory address will always be the highest address in the range of mm->mmap\_base to TASK\_SIZE which contains a sufficiently large contiguous unmapped region.

This makes mmap an optimal allocator to use when attempting to shape the address space - most other allocators require special conditions in order to revert to contiguous allocations.

In our case, we already know that we would like to replace the memory region reserved for a thread’s stack. We’ll denote the size of this region by “thread\_size”.

First, we’ll send over a large amount of notification objects to the remote service, each of which containing a bitmap of size thread\_size. This will allow us to fill in any “holes” in the remote address space which may have been opened up during the lifetime of system\_server. After doing so, we are guaranteed that any subsequent allocation of size thread\_size will be contiguous and placed at the top of the current mmap-ed region.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxrezdPdZAckYwBFe-NlM06wtWOa-kxzWwt5rP1JlBsgA0IRDaCYv0UyQlbcg8jLzx3SquKj1GkJ7q2RBohUzEUViEujkCXsDgb22asHJ5RWp-lM-g9q1iIsWyVFIyblG_4fRAJ5iUQgZCSMrr8LfORHPSH2vNV_4tfoyvMuLKH6IJvO95ieHUIsXS/s600/D2YqrzV18pTkVlWPoU8Y8hBNaKO5O-wsPpNfH2yrSHdc7IdXRGneqsmRPf2TpKla4fSQ-ZhSXx2adAzkxrYTawn6i9Jdb57zIxz0iB_9zmcLOEeAcDg203ZPMptdxZ47xwJCJJnD.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjxrezdPdZAckYwBFe-NlM06wtWOa-kxzWwt5rP1JlBsgA0IRDaCYv0UyQlbcg8jLzx3SquKj1GkJ7q2RBohUzEUViEujkCXsDgb22asHJ5RWp-lM-g9q1iIsWyVFIyblG_4fRAJ5iUQgZCSMrr8LfORHPSH2vNV_4tfoyvMuLKH6IJvO95ieHUIsXS/s1600/D2YqrzV18pTkVlWPoU8Y8hBNaKO5O-wsPpNfH2yrSHdc7IdXRGneqsmRPf2TpKla4fSQ-ZhSXx2adAzkxrYTawn6i9Jdb57zIxz0iB_9zmcLOEeAcDg203ZPMptdxZ47xwJCJJnD.png)
Next, we allocate many consecutive bitmap objects of size thread\_size, each of which referenced by a single Notification object. After doing so, we intentionally remove a single notification from the consecutively allocated set. Then, we proceed bombard the system\_server process with many small binder transactions triggering a remote garbage collection to occur. This, in turn, frees up the space previously held by the bitmap object in the removed notification, creating a thread\_size sized hole, like so:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjbjIWLeM7KBN3nDBnGlS0Xmf-qJLEL7ztHteyllOdnBiwvUJsNhWvIsHForZXjDoaL8ReuI9DIdJt6QT7Wxp-xNWEYAifiFO12SHQ6OFzIiwWUDAdoBN-Khw7IAS6GB0UMaF6bEWtdo5hx0r0sE_-GF_cr62qthoNHSrLPK14ymMts7mK9GwIjGxUs/s600/Zs0GSQ4sQ19IyFuWuXmP_W-QBSiXowXRGOxsbkAWkyYcZDtQz6GCsBMrou9zbzzdS2_wUjFbOvH1kc_-ouaGc9JiNjlJj8oKTzXQtg2OPqRMBD4DzgNYsOLof68ay2JXgP5rzRpM.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjbjIWLeM7KBN3nDBnGlS0Xmf-qJLEL7ztHteyllOdnBiwvUJsNhWvIsHForZXjDoaL8ReuI9DIdJt6QT7Wxp-xNWEYAifiFO12SHQ6OFzIiwWUDAdoBN-Khw7IAS6GB0UMaF6bEWtdo5hx0r0sE_-GF_cr62qthoNHSrLPK14ymMts7mK9GwIjGxUs/s893/Zs0GSQ4sQ19IyFuWuXmP_W-QBSiXowXRGOxsbkAWkyYcZDtQz6GCsBMrou9zbzzdS2_wUjFbOvH1kc_-ouaGc9JiNjlJj8oKTzXQtg2OPqRMBD4DzgNYsOLof68ay2JXgP5rzRpM.png)
Now, we can re-load the audio effects, causing the SoundPoolThread to be spawned in system\_server. As this is a thread\_size-d allocation and all previous holes of that size have already been filled (by our bitmap objects), it will have to populate the vacant hole that we just created amidst our chunk of contiguous bitmaps.

Now, we can remove the notification directly in front of the SoundPoolThread’s stack and once again trigger a remote garbage collection. This will cause another hole to open up, bringing us to the following state:
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2D_T1ymUEk4emQy2djJ96srrMlWE2kE8QwXdnoCe4OHx2ch-JmDx5ajkmdYyc_fyYoeLT9KV0C8CV-05UY1HpDmPMLU2bYSlP-b6lTugVrNqDPbLWGSOXmnfqP6PqNNufUYdDrMsKp2UThYpBwoemfpWLYjjo32QiwrJItRjPXs3hsKtNBzf7-o22/s600/1ZSRULocX0EgcK6SgE28vCY5X42WEn6WzBqdpiFj-G2lIrmpCyInE9BmWgZKxjdSQ83xFu08myM--FyCRdc8T35obXk7ViqKtyu-NDwBHBotx2k_ejJ1q_VmCBVcBqb-ncq313AC.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi2D_T1ymUEk4emQy2djJ96srrMlWE2kE8QwXdnoCe4OHx2ch-JmDx5ajkmdYyc_fyYoeLT9KV0C8CV-05UY1HpDmPMLU2bYSlP-b6lTugVrNqDPbLWGSOXmnfqP6PqNNufUYdDrMsKp2UThYpBwoemfpWLYjjo32QiwrJItRjPXs3hsKtNBzf7-o22/s1229/1ZSRULocX0EgcK6SgE28vCY5X42WEn6WzBqdpiFj-G2lIrmpCyInE9BmWgZKxjdSQ83xFu08myM--FyCRdc8T35obXk7ViqKtyu-NDwBHBotx2k_ejJ1q_VmCBVcBqb-ncq313AC.png)
Once we’ve strategically opened up a hole in front of the SoundPoolThread, we can send our crafted BitUnmap object. We’ll create it so that its metadata size (i.e., the size used in the mmap) will be equal to thread\_size. However, the size of the ashmem descriptor will actually be twice that size! This means the once our BitUnmap is freed in the remote process, it will unmap itself, along with the SoundPoolThread.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiORxkMJt5lSx9GcawEZv8LP3lg77GmQueVo1ECf_ykb2nhzMp-RMTqn12Fh-LqLKvZJfvebDujFdFS8_GHhkd5sb2eFxP1hGm3mXfcDC-izTRtnEcvqAMcklGVabgpQp5efuGul1EZpVqigijEYDFlt0JkM7xW9sD3sFTinfUWVQ69TGlev0YiPfKG/s600/e4KDu5YsCi87TcVqesHS6EWw9YrJ3QkNZvoqG5ytC3cM_JY7Ce4Q0gtoavS7yQhaBaAajN5uZwU4HJPQMs5TSp4dhInqvz2-4wTuosK_-2e-ynDo6XctzkPZOSKrrHpLATT5Qt0Z.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiORxkMJt5lSx9GcawEZv8LP3lg77GmQueVo1ECf_ykb2nhzMp-RMTqn12Fh-LqLKvZJfvebDujFdFS8_GHhkd5sb2eFxP1hGm3mXfcDC-izTRtnEcvqAMcklGVabgpQp5efuGul1EZpVqigijEYDFlt0JkM7xW9sD3sFTinfUWVQ69TGlev0YiPfKG/s1229/e4KDu5YsCi87TcVqesHS6EWw9YrJ3QkNZvoqG5ytC3cM_JY7Ce4Q0gtoavS7yQhaBaAajN5uZwU4HJPQMs5TSp4dhInqvz2-4wTuosK_-2e-ynDo6XctzkPZOSKrrHpLATT5Qt0Z.png)
Finally, now that we’ve freed up the SoundPoolThread’s stack, we can send one more notification - this time of size 2\*thread\_size, which will fill in the last created hole, effectively replacing both the region held by the BitUnmap, and the region containing the SoundPoolThread’s stack.
[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhI12YkQHGVRYfqbnoqWEoVEu7eY_6rEH8Ctz_iuWrn8hwCZgcitm32zPw41lGajyeZCXVrLgFC7r0L8ZdCR5o9BM_iPDrx_6dl6SvbUCAdJZQaSc7jmD3xJ_FZp5a1Wis1Uow4n79L-ramMl2cqfeg9gLST4rdf87-1Q5mGPum9FYDh7psX5sWwdTn/s600/A6cLuLe72ZxI4XJh3Yh3BGg1_ryIeHjGts25B4F9aaCYSFnbEl-RTkZGVXHtAKRR4rVRV6iwknmhlSKgKZYTKaMKb6ubOfC6pF2kX862zipSzzPJS6NmifMIMxxl_RFC1qkg_4IF.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhI12YkQHGVRYfqbnoqWEoVEu7eY_6rEH8Ctz_iuWrn8hwCZgcitm32zPw41lGajyeZCXVrLgFC7r0L8ZdCR5o9BM_iPDrx_6dl6SvbUCAdJZQaSc7jmD3xJ_FZp5a1Wis1Uow4n79L-ramMl2cqfeg9gLST4rdf87-1Q5mGPum9FYDh7psX5sWwdTn/s1229/A6cLuLe72ZxI4XJh3Yh3BGg1_ryIeHjGts25B4F9aaCYSFnbEl-RTkZGVXHtAKRR4rVRV6iwknmhlSKgKZYTKaMKb6ubOfC6pF2kX862zipSzzPJS6NmifMIMxxl_RFC1qkg_4IF.png)
## Putting it All Together

At long last, we have all the steps needed to create a complete working exploit. Here’s a short run-down of all the steps we discussed, which allow us to hijack a thread within the system\_server process using our own crafted ROP stack:

1. Build a ROP stack using gadgets in zygote-originating shared libraries
2. Unload all sound effects (closing the current SoundPoolThread, if present)
3. Allocate many bitmaps of size thread\_size to force consecutive allocations
4. Open up a hole in the middle of the consecutively allocated bitmaps
5. Reload the sound effects to create a new SoundPoolThread within the created hole
6. Open up a new hole directly in front of the previous hole
7. Send a BitUnmap object to fit in the newly created hole
8. Force a remote GC to cause the BitUnmap to free itself and the SoundPoolThread
9. Allocate a new bitmap to occupy the space previously held by the SoundPoolThread
10. Unload all sound effects - causing the condition variable to be signalled, thereby triggering the SoundPoolThread to start executing using our own crafted stack!

## Afterword

Although this blog post is quite lengthy, there are many smaller details that I neglected to mention here (in favour of some brevity). I’d encourage anyone who’s interested to dig into the full source code of the [exploit](https://bugs.chromium.org/p/project-zero/issues/detail?id=928#c4) to discover any such “missing” pieces.

Along with the source code for the exploit itself, I’m also releasing a project which can be used to easily create shellcode for use in the exploit itself. Specifically, this project contains a small assembly stub which fixed up the freed pthread\_internal\_t structure at the top of the stack and corrects the thread-local storage AARCH64 registers to point to their new location. After performing the needed fixups, it simply jumps to the shellcode’s main function.

In order to allow for easy shellcode creation in a high-level language (such as C) rather than hand-coding it all in assembly, the shellcode wrapper uses a custom linker script to prepend the small fixup stub to the shellcode, and compiles the shellcode itself as position independent.

You can find the source code for the shellcoder [here](https://bugs.chromium.org/p/project-zero/issues/detail?id=928#c5).
## Timeline

* 07.09.2016 - Vulnerability reported
* 07.09.2016 - Initial response from Android security, assigned Android-ID
* 23.09.2016 - Exploit submitted to Android security
* 26.09.2016 - Android notify that the fix will be present in the next partner bulletin
* 27.09.2016 - CVE-2016-6707 assigned
* 01.11.2016 - Vulnerability fixed and released in the November bulletin

Posted by
Anonymous

at

[8:58 AM](https://googleprojectzero.blogspot.com/2016/12/bitunmap-attacking-android-ashmem.html "permanent link")

[![](https://resources.blogblog.com/img/icon18_edit_allbkg.gif)](https://www.blogger.com/post-edit.g?blogID=4838136820032157985&postID=2168097581366031798&from=pencil "Edit Post")

[Email This](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=2168097581366031798&target=email "Email This")[BlogThis!](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=2168097581366031798&target=blog "BlogThis!")[Share to X](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=2168097581366031798&target=twitter "Share to X")[Share to Facebook](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=2168097581366031798&target=facebook "Share to Facebook")[Share to Pinterest](https://www.blogger.com/share-post.g?blogID=4838136820032157985&postID=2168097581366031798&target=pinterest "Share to Pinterest")

#### 2 comments:

1. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Guest](https://www.blogger.com/profile/02316552064537967273)[January 26, 2017 at 12:17 PM](https://googleprojectzero.blogspot.com/2016/12/bitunmap-attacking-android-ashmem.html?showComment=1485461869217#c7250791510344592689)

   Note to blog editor: the posts here have a strange bloated markup with things like "font-size: 14.666666666666666px" adding up to megabytes, which leads to some RSS readers declining to process the monstrosity of a feed.

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&postID=7250791510344592689)Replies
   Reply
2. ![](//www.blogger.com/img/blogger_logo_round_35.png)[Unknown](https://www.blogger.com/profile/17218864926780415849)[February 16, 2017 at 2:14 AM](https://googleprojectzero.blogspot.com/2016/12/bitunmap-attacking-android-ashmem.html?showComment=1487240060164#c5660306383005209781)

   In the code segment of the "Hanging by a Thread" section, one line of code should be added:

   stack\_top = reinterpret\_cast(
    (reinterpret\_cast(stack\_top) - sizeof(pthread\_internal\_t)) & ~0xf);

   It can make the following explaination more clear.

   Thank you for your post!

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=4838136820032157985&postID=5660306383005209781)Replies
   Reply

Add commentLoad more...

[Newer Post](https://googleprojectzero.blogspot.com/2016/12/chrome-os-exploit-one-byte-overflow-and.html "Newer Post")

[Older Post](https://googleprojectzero.blogspot.com/2016/11/breaking-chain.html "Older Post")

[Home](https://googleprojectzero.blogspot.com/)

Subscribe to:
[Post Comments (Atom)](https://googleprojectzero.blogspot.com/feeds/2168097581366031798/comments/default)

## Search This Blog

|  |  |
| --- | --- |

## Pages

* [About Project Zero](https://googleprojectzero.blogspot.com/p/about-project-zero.html)
* [Working at Project Zero](https://googleprojectzero.blogspot.com/p/working-at-project-zero.html)
* [0day "In the Wild"](https://googleprojectzero.blogspot.com/p/0day.html)
* [0day Exploit Root Cause Analyses](https://googleprojectzero.github.io/0days-in-the-wild/rca.html)
* [Vulnerability Disclosure FAQ](https://googleprojectzero.blogspot.com/p/vulnerability-disclosure-faq.html)

## Archives

* ►
  [2024](https://googleprojectzero.blogspot.com/2024/)
  (12)
  + ►
    [December](https://googleprojectzero.blogspot.com/2024/12/)
    (3)
  + ►
    [November](https://googleprojectzero.blogspot.com/2024/11/)
    (2)
  + ►
    [October](https://googleprojectzero.blogspot.com/2024/10/)
    (2)
  + ►
    [June](https://googleprojectzero.blogspot.com/2024/06/)
    (3)
  + ►
    [April](https://googleprojectzero.blogspot.com/2024/04/)
    (2)

* ►
  [2023](https://googleprojectzero.blogspot.com/2023/)
  (11)
  + ►
    [November](https://googleprojectzero.blogspot.com/2023/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2023/10/)
    (1)
  + ►
    [September](https://googleprojectzero.blogspot.com/2023/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2023/08/)
    (4)
  + ►
    [April](https://googleprojectzero.blogspot.com/2023/04/)
    (1)
  + ►
    [March](https://googleprojectzero.blogspot.com/2023/03/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2023/01/)
    (2)

* ►
  [2022](https://googleprojectzero.blogspot.com/2022/)
  (17)
  + ►
    [December](https://googleprojectzero.blogspot.com/2022/12/)
    (1)
  + ►
    [November](https://googleprojectzero.blogspot.com/2022/11/)
    (3)
  + ►
    [October](https://googleprojectzero.blogspot.com/2022/10/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2022/08/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2022/06/)
    (3)
  + ►
    [May](https://googleprojectzero.blogspot.com/2022/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2022/04/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2022/03/)
    (2)
  + ►
    [February](https://googleprojectzero.blogspot.com/2022/02/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2022/01/)
    (1)

* ►
  [2021](https://googleprojectzero.blogspot.com/2021/)
  (24)
  + ►
    [December](https://googleprojectzero.blogspot.com/2021/12/)
    (2)
  + ►
    [October](https://googleprojectzero.blogspot.com/2021/10/)
    (3)
  + ►
    [September](https://googleprojectzero.blogspot.com/2021/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2021/08/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2021/06/)
    (1)
  + ►
    [May](https://googleprojectzero.blogspot.com/2021/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2021/04/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2021/03/)
    (1)
  + ►
    [February](https://googleprojectzero.blogspot.com/2021/02/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2021/01/)
    (10)

* ►
  [2020](https://googleprojectzero.blogspot.com/2020/)
  (36)
  + ►
    [December](https://googleprojectzero.blogspot.com/2020/12/)
    (2)
  + ►
    [November](https://googleprojectzero.blogspot.com/2020/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2020/10/)
    (2)
  + ►
    [September](https://googleprojectzero.blogspot.com/2020/09/)
    (4)
  + ►
    [August](https://googleprojectzero.blogspot.com/2020/08/)
    (5)
  + ►
    [July](https://googleprojectzero.blogspot.com/2020/07/)
    (8)
  + ►
    [June](https://googleprojectzero.blogspot.com/2020/06/)
    (2)
  + ►
    [April](https://googleprojectzero.blogspot.com/2020/04/)
    (3)
  + ►
    [February](https://googleprojectzero.blogspot.com/2020/02/)
    (4)
  + ►
    [January](https://googleprojectzero.blogspot.com/2020/01/)
    (5)

* ►
  [2019](https://googleprojectzero.blogspot.com/2019/)
  (27)
  + ►
    [December](https://googleprojectzero.blogspot.com/2019/12/)
    (2)
  + ►
    [November](https://googleprojectzero.blogspot.com/2019/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2019/10/)
    (2)
  + ►
    [September](https://googleprojectzero.blogspot.com/2019/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2019/08/)
    (11)
  + ►
    [May](https://googleprojectzero.blogspot.com/2019/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2019/04/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2019/03/)
    (2)
  + ►
    [February](https://googleprojectzero.blogspot.com/2019/02/)
    (2)
  + ►
    [January](https://googleprojectzero.blogspot.com/2019/01/)
    (2)

* ►
  [2018](https://googleprojectzero.blogspot.com/2018/)
  (22)
  + ►
    [December](https://googleprojectzero.blogspot.com/2018/12/)
    (7)
  + ►
    [November](https://googleprojectzero.blogspot.com/2018/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2018/10/)
    (4)
  + ►
    [September](https://googleprojectzero.blogspot.com/2018/09/)
    (2)
  + ►
    [August](https://googleprojectzero.blogspot.com/2018/08/)
    (3)
  + ►
    [July](https://googleprojectzero.blogspot.com/2018/07/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2018/06/)
    (1)
  + ►
    [May](https://googleprojectzero.blogspot.com/2018/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2018/04/)
    (1)
  + ►
    [January](https://googleprojectzero.blogspot.com/2018/01/)
    (1)

* ►
  [2017](https://googleprojectzero.blogspot.com/2017/)
  (19)
  + ►
    [December](https://googleprojectzero.blogspot.com/2017/12/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2017/10/)
    (3)
  + ►
    [September](https://googleprojectzero.blogspot.com/2017/09/)
    (2)
  + ►
    [August](https://googleprojectzero.blogspot.com/2017/08/)
    (2)
  + ►
    [July](https://googleprojectzero.blogspot.com/2017/07/)
    (1)
  + ►
    [May](https://googleprojectzero.blogspot.com/2017/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2017/04/)
    (6)
  + ►
    [March](https://googleprojectzero.blogspot.com/2017/03/)
    (1)
  + ►
    [February](https://googleprojectzero.blogspot.com/2017/02/)
    (2)

* ▼
  [2016](https://googleprojectzero.blogspot.com/2016/)
  (17)
  + ▼
    [December](https://googleprojectzero.blogspot.com/2016/12/)
    (2)
    - [Chrome OS exploit: one byte overflow and symlinks](https://googleprojectzero.blogspot.com/2016/12/chrome-os-exploit-one-byte-overflow-and.html)
    - [BitUnmap: Attacking Android Ashmem](https://googleprojectzero.blogspot.com/2016/12/bitunmap-attacking-android-ashmem.html)
  + ►
    [November](https://googleprojectzero.blogspot.com/2016/11/)
    (1)
  + ►
    [October](https://googleprojectzero.blogspot.com/2016/10/)
    (1)
  + ►
    [September](https://googleprojectzero.blogspot.com/2016/09/)
    (2)
  + ►
    [August](https://googleprojectzero.blogspot.com/2016/08/)
    (1)
  + ►
    [July](https://googleprojectzero.blogspot.com/2016/07/)
    (1)
  + ►
    [June](https://googleprojectzero.blogspot.com/2016/06/)
    (3)
  + ►
    [March](https://googleprojectzero.blogspot.com/2016/03/)
    (3)
  + ►
    [February](https://googleprojectzero.blogspot.com/2016/02/)
    (2)
  + ►
    [January](https://googleprojectzero.blogspot.com/2016/01/)
    (1)

* ►
  [2015](https://googleprojectzero.blogspot.com/2015/)
  (33)
  + ►
    [December](https://googleprojectzero.blogspot.com/2015/12/)
    (2)
  + ►
    [November](https://googleprojectzero.blogspot.com/2015/11/)
    (2)
  + ►
    [October](https://googleprojectzero.blogspot.com/2015/10/)
    (1)
  + ►
    [September](https://googleprojectzero.blogspot.com/2015/09/)
    (4)
  + ►
    [August](https://googleprojectzero.blogspot.com/2015/08/)
    (6)
  + ►
    [July](https://googleprojectzero.blogspot.com/2015/07/)
    (5)
  + ►
    [June](https://googleprojectzero.blogspot.com/2015/06/)
    (4)
  + ►
    [May](https://googleprojectzero.blogspot.com/2015/05/)
    (1)
  + ►
    [April](https://googleprojectzero.blogspot.com/2015/04/)
    (1)
  + ►
    [March](https://googleprojectzero.blogspot.com/2015/03/)
    (2)
  + ►
    [February](https://googleprojectzero.blogspot.com/2015/02/)
    (3)
  + ►
    [January](https://googleprojectzero.blogspot.com/2015/01/)
    (2)

* ►
  [2014](https://googleprojectzero.blogspot.com/2014/)
  (11)
  + ►
    [December](https://googleprojectzero.blogspot.com/2014/12/)
    (1)
  + ►
    [November](https://googleprojectzero.blogspot.com/2014/11/)
    (2)
  + ►
    [October](https://googleprojectzero.blogspot.com/2014/10/)
    (2)
  + ►
    [September](https://googleprojectzero.blogspot.com/2014/09/)
    (1)
  + ►
    [August](https://googleprojectzero.blogspot.com/2014/08/)
    (2)
  + ►
    [July](https://googleprojectzero.blogspot.com/2014/07/)
    (3)

|  |  |
| --- | --- |

|  |  |
| --- | --- |

Powered by [Blogger](https://www.blogger.com).



=== Content from www.exploit-db.com_d0e05921_20250125_211558.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Google Android - Inter-Process munmap with User-Controlled Size in android.graphics.Bitmap

#### EDB-ID:

###### 40874

#### CVE:

###### [2016-6707](https://nvd.nist.gov/vuln/detail/CVE-2016-6707)

---

**EDB Verified:**

#### Author:

###### [Google Security Research](/?author=7725)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Android](/?platform=android)

#### Date:

###### 2016-12-06

---

**Vulnerable App:**

```
Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=928

Bitmap objects can be passed between processes by flattening them to a Parcel in one process and un-flattening them in another. In order to conserve memory, there exists a code path which allows Bitmaps to be shared between processes by providing an ashmem-mapped file descriptor containing the Bitmap's raw pixel data.

The android.graphics.Bitmap class illegally assumes that the size of the ashmem region provided by the user matches the actual underlying size of the Bitmap.

When un-flattening a Bitmap from a Parcel, the class first calculates the assumed size of the Bitmap from the user-provided dimensions. Then, it calls Parcel::readBlob in order to map the given ashmem file descriptor to the process's VAS. This mapping is done using the size calculated from the Bitmap's dimensions (and not the size of the underlying ashmem descriptor).

Later, the Bitmap constructor internally stores the ashmem file descriptor and mapped memory address, along with the size of the mapping. However, instead of using the same calculated size which was used when mapping the shared memory region, it accidentally queries the ashmem region for its real size, like so:

 mPixelStorage.ashmem.size = ashmem_get_size_region(fd);

This size can be completely controlled by an attacker (simply by calling ASHMEM_SET_SIZE), and may be arbitrary large.

Later, when the Bitmap is GC-ed, the destructor triggers a call to Bitmap::doFreePixels which unmaps the Bitmap's data, by calling:

 munmap(mPixelStorage.ashmem.address, mPixelStorage.ashmem.size);

This means that an attacker can cause the size of the unmapped region to be arbitrarily large, thus unmapping crucial regions in the remote process's VAS.

One example of how this can be exploited is by unmapping the remote process's heap (which is directly after the mmap-ed ranges on the device I was working on). Then, the attacker can resend a large Bitmap which will be mapped over the (previously unmapped) heap, thus allowing the attacker to effectively replace the remote process's heap with controlled data.

I've attached a short PoC which crashes system_server by repeatedly unmaps large memory regions.

Suggested Fix:

Store the calculated size in mPixelStorage.ashmem.size instead of calling ashmem_get_size_region.

Here's a brief run-down of the exploit:

1. The exploit begins by calling AudioService.unloadSoundEffects in order to close the SoundPool instance in system_server. This also closes any auxiliary threads (SoundPool, SoundPoolThread, etc.) that are associated with this pool.

2. Now, we start "massaging" system_server's VAS. This is done by creating multiple "Notification" objects which contain Bitmaps that are of exactly the same size at a thread's stack, when created by the ART runtime. As the bitmaps are allocated by using "mmap", they will simply inhabit the highest memory address between mm->mmap_base and TASK_SIZE which contains a sufficiently large contiguous hole. Causing many allocations of the aforementioned size will ensure that any "holes" of this size in higher addresses are filled, and the remaining "mmap"-s of this size will be contiguous.

3. Now that we are certain allocations of size THREAD_SIZE are contiguous, we replace one of notifications created in the previous stage with a notification containing a small (or empty) bitmap, and immediately send multiple dummy transactions to system_server in order to force garbage collection of the freed bitmap object. This will enable us to open up a "hole" in the contiguous allocations, like so:

<--low                                                    high-->
 ----------------------------------------------------------------
| Bitmap | Bitmap | Bitmap | Bitmap | Bitmap | Bitmap | Bitmap   |
 ----------------------------------------------------------------
                            ||
                            \/
<--low                                                    high-->
 ----------------------------------------------------------------
| Bitmap | Bitmap ||||hole|||| Bitmap | Bitmap | Bitmap | Bitmap |
 ----------------------------------------------------------------

4. Now that there's a THREAD_SIZE-sized hole opened up, we can call AudioSystem.loadSoundEffects() in order to re-create the SoundPool object within system_server. This will allocate a new "SoundPoolThread" thread in system_server, which (after brief initialization) enters a polling loop on a condition variable (or rather, a futex), waiting for messages to be enqueued. However, this thread's stack will be directly mmap-ed in our previously created hole, like so:

<--low                                                                high-->
 ---------------------------------------------------------------------------
| Bitmap | Bitmap |SoundPoolThread stack| Bitmap | Bitmap | Bitmap | Bitmap |
 ---------------------------------------------------------------------------

6. Now, similarly to step 3., we can free the chunk directly before the previously unmapped chunk, creating the  following state:

<--low                                                                  high-->
 -----------------------------------------------------------------------------
| Bitmap ||||hole||||SoundPoolThread stack| Bitmap | Bitmap | Bitmap | Bitmap |
 -----------------------------------------------------------------------------

6. Finally, we send our "poisoned" bitmap object, which should get allocated directly in front of the SoundPoolThread's stack. Then, we force garbage collection once more, resulting in both the bitmap and the SoundPoolThread's stack being unmapped. However, since the SoundPoolThread is still waiting on a futex, this is fine. Here's what this stage looks like:

<--low                                                                    high-->
 --------------------------------------------------------------------------------
| Bitmap |Poison Bitmap|SoundPoolThread stack| Bitmap | Bitmap | Bitmap | Bitmap |
 --------------------------------------------------------------------------------
                                   ||
                                   \/
<--low                                                                    high-->
 --------------------------------------------------------------------------------
| Bitmap ||||||||||||||||hole||||||||||||||||| Bitmap | Bitmap | Bitmap | Bitmap |
 --------------------------------------------------------------------------------

7. At this point we can enqueue another notification, this time backed by a specially crafted ashmem file, containing two separate pieces of information:
    a. A chunk of position independent ARM/ARM64 code, followed by
    b. A ROP stack
This notification will be of size THREAD_SIZE*2, and will therefore fill up the hole we just set up, resulting in the following state:

<--low                                                        high-->
 -------------------------------------------------------------------
| Bitmap | PIC code | ROP Stack | Bitmap | Bitmap | Bitmap | Bitmap |
 -------------------------------------------------------------------

8. Now, we can safely call AudioService.unloadSoundEffects() once more. This will signal the condition variable that SoundPoolThread was waiting on, but now when it returns it will be executing our own ROP stack. The ROP stack simply mmap-s the ashmem file descriptor with PROT_EXEC and jumps into it (essentially executing the PIC code we supplied).

Proofs of Concept:
https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/40874.zip

```

**Tags:**

**Advisory/Source:**
[Link](https://bugs.chromium.org/p/project-zero/issues/detail?id=928)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from bugs.chromium.org_682b99d6_20250125_211551.html ===



=== Content from android.googlesource.com_ce5546ee_20250126_120029.html ===
dHJlZSA2OWYyZGVjMjA2NDYzYWU4Yjg1YjY1ZjJjNTg1OGIxMzIzY2E2OGYxCnBhcmVudCBiMWRjMTc1NzA3MWJhNDZlZTY1M2Q2OGYzMzE0ODZlODY3NzhiOGU0CmF1dGhvciBKb2huIFJlY2sgPGpyZWNrQGdvb2dsZS5jb20+IDE0NzM3MDIyMTUgLTA3MDAKY29tbWl0dGVyIFRoZSBBbmRyb2lkIEF1dG9tZXJnZXIgPGFuZHJvaWQtYnVpbGRAYW5kcm9pZC5jb20+IDE0NzQ5NjA1MzkgLTA3MDAKCkVuc3VyZSBtdW5tYXAgbWF0Y2hlcyBtbWFwCgpCdWc6IDMxMzUwNjIyCkNoYW5nZS1JZDogSTZkM2Y5ZmFlYzMyZDU0MzYwY2FhNjcwNmQxNzQwNWUyMGI1MDk2NmMKKGNoZXJyeSBwaWNrZWQgZnJvbSBjb21taXQgYWEzOTRkZDQyYzA0OTQ3OWJmYWNlMTk5MWYxMWI4NjNkYzFhMDkyMikK

=== Content from source.android.com_5f9dbd78_20250125_211556.html ===


[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/v2c0608cfe9941cacf4435921a2ece588be3719df069d9fba67130a84e4743128/androidsource/images/lockup.svg)](/)

`/`

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어

[Android Code Search](https://cs.android.com/android/platform/superproject/main)
Sign in

* [Documentation](https://source.android.com/docs)

[What's New?](https://source.android.com/docs/whatsnew)

[Getting Started](https://source.android.com/docs/setup)

[Security](https://source.android.com/docs/security)

[Core Topics](https://source.android.com/docs/core)

[Compatibility](https://source.android.com/docs/compatibility)

[Android Devices](https://source.android.com/docs/devices)

[Automotive](https://source.android.com/docs/automotive)

[Reference](https://source.android.com/reference)

[![Android Open Source Project](https://www.gstatic.com/devrel-devsite/prod/v2c0608cfe9941cacf4435921a2ece588be3719df069d9fba67130a84e4743128/androidsource/images/lockup.svg)](/)

* [Docs](/docs)
  + More
  + [What's New?](/docs/whatsnew)
  + [Getting Started](/docs/setup)
  + [Security](/docs/security)
  + [Core Topics](/docs/core)
  + [Compatibility](/docs/compatibility)
  + [Android Devices](/docs/devices)
  + [Automotive](/docs/automotive)
  + [Reference](/reference)
* [Android Code Search](https://cs.android.com/android/platform/superproject/main)

* [Overview](/docs/security)
* Security overview
  + [Secure an Android device](/docs/security/overview)
  + [Kernel security](/docs/security/overview/kernel-security)
  + [App security](/docs/security/overview/app-security)
  + [Implement security](/docs/security/overview/implement)
  + [Updates and resources](/docs/security/overview/updates-resources)
  + [ASPIRE](/docs/security/overview/aspire)
  + [Reports](/docs/security/overview/reports)
  + [Enhancements](/docs/security/enhancements)
  + [Acknowledgements](/docs/security/overview/acknowledgements)
* Android Security Bulletins
  + [Bulletins home](/docs/security/bulletin)
  + [Overview](/docs/security/bulletin/asb-overview)
  + 2025 bulletins
    - [January](/docs/security/bulletin/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/2024-12-01)
    - [November](/docs/security/bulletin/2024-11-01)
    - [October](/docs/security/bulletin/2024-10-01)
    - [September](/docs/security/bulletin/2024-09-01)
    - [August](/docs/security/bulletin/2024-08-01)
    - [July](/docs/security/bulletin/2024-07-01)
    - [June](/docs/security/bulletin/2024-06-01)
    - [May](/docs/security/bulletin/2024-05-01)
    - [April](/docs/security/bulletin/2024-04-01)
    - [March](/docs/security/bulletin/2024-03-01)
    - [February](/docs/security/bulletin/2024-02-01)
    - [January](/docs/security/bulletin/2024-01-01)
    - [Android 15](/docs/security/bulletin/android-15)
  + 2023 bulletins
    - [December](/docs/security/bulletin/2023-12-01)
    - [November](/docs/security/bulletin/2023-11-01)
    - [October](/docs/security/bulletin/2023-10-01)
    - [September](/docs/security/bulletin/2023-09-01)
    - [August](/docs/security/bulletin/2023-08-01)
    - [July](/docs/security/bulletin/2023-07-01)
    - [June](/docs/security/bulletin/2023-06-01)
    - [May](/docs/security/bulletin/2023-05-01)
    - [April](/docs/security/bulletin/2023-04-01)
    - [March](/docs/security/bulletin/2023-03-01)
    - [February](/docs/security/bulletin/2023-02-01)
    - [January](/docs/security/bulletin/2023-01-01)
    - [Android 14](/docs/security/bulletin/android-14)
  + 2022 bulletins
    - [December](/docs/security/bulletin/2022-12-01)
    - [November](/docs/security/bulletin/2022-11-01)
    - [October](/docs/security/bulletin/2022-10-01)
    - [September](/docs/security/bulletin/2022-09-01)
    - [August](/docs/security/bulletin/2022-08-01)
    - [July](/docs/security/bulletin/2022-07-01)
    - [June](/docs/security/bulletin/2022-06-01)
    - [May](/docs/security/bulletin/2022-05-01)
    - [April](/docs/security/bulletin/2022-04-01)
    - [March](/docs/security/bulletin/2022-03-01)
    - [Android 12L](/docs/security/bulletin/android-12l)
    - [February](/docs/security/bulletin/2022-02-01)
    - [January](/docs/security/bulletin/2022-01-01)
    - [Android 13](/docs/security/bulletin/android-13)
    - [Index](/docs/security/bulletin/2022)
  + 2021 bulletins
    - [December](/docs/security/bulletin/2021-12-01)
    - [November](/docs/security/bulletin/2021-11-01)
    - [October](/docs/security/bulletin/2021-10-01)
    - [September](/docs/security/bulletin/2021-09-01)
    - [August](/docs/security/bulletin/2021-08-01)
    - [July](/docs/security/bulletin/2021-07-01)
    - [June](/docs/security/bulletin/2021-06-01)
    - [May](/docs/security/bulletin/2021-05-01)
    - [April](/docs/security/bulletin/2021-04-01)
    - [March](/docs/security/bulletin/2021-03-01)
    - [February](/docs/security/bulletin/2021-02-01)
    - [January](/docs/security/bulletin/2021-01-01)
    - [Android 12](/docs/security/bulletin/android-12)
    - [Index](/docs/security/bulletin/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/2020-12-01)
    - [November](/docs/security/bulletin/2020-11-01)
    - [October](/docs/security/bulletin/2020-10-01)
    - [September](/docs/security/bulletin/2020-09-01)
    - [August](/docs/security/bulletin/2020-08-01)
    - [July](/docs/security/bulletin/2020-07-01)
    - [June](/docs/security/bulletin/2020-06-01)
    - [May](/docs/security/bulletin/2020-05-01)
    - [April](/docs/security/bulletin/2020-04-01)
    - [March](/docs/security/bulletin/2020-03-01)
    - [February](/docs/security/bulletin/2020-02-01)
    - [January](/docs/security/bulletin/2020-01-01)
    - [Android 11](/docs/security/bulletin/android-11)
    - [Index](/docs/security/bulletin/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/2019-12-01)
    - [November](/docs/security/bulletin/2019-11-01)
    - [October](/docs/security/bulletin/2019-10-01)
    - [September](/docs/security/bulletin/2019-09-01)
    - [August](/docs/security/bulletin/2019-08-01)
    - [July](/docs/security/bulletin/2019-07-01)
    - [June](/docs/security/bulletin/2019-06-01)
    - [May](/docs/security/bulletin/2019-05-01)
    - [April](/docs/security/bulletin/2019-04-01)
    - [March](/docs/security/bulletin/2019-03-01)
    - [February](/docs/security/bulletin/2019-02-01)
    - [January](/docs/security/bulletin/2019-01-01)
    - [Android 10](/docs/security/bulletin/android-10)
    - [Index](/docs/security/bulletin/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/2018-12-01)
    - [November](/docs/security/bulletin/2018-11-01)
    - [October](/docs/security/bulletin/2018-10-01)
    - [September](/docs/security/bulletin/2018-09-01)
    - [August](/docs/security/bulletin/2018-08-01)
    - [July](/docs/security/bulletin/2018-07-01)
    - [June](/docs/security/bulletin/2018-06-01)
    - [May](/docs/security/bulletin/2018-05-01)
    - [April](/docs/security/bulletin/2018-04-01)
    - [March](/docs/security/bulletin/2018-03-01)
    - [February](/docs/security/bulletin/2018-02-01)
    - [January](/docs/security/bulletin/2018-01-01)
    - [Index](/docs/security/bulletin/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/2017-12-01)
    - [November](/docs/security/bulletin/2017-11-01)
    - [October](/docs/security/bulletin/2017-10-01)
    - [September](/docs/security/bulletin/2017-09-01)
    - [August](/docs/security/bulletin/2017-08-01)
    - [July](/docs/security/bulletin/2017-07-01)
    - [June](/docs/security/bulletin/2017-06-01)
    - [May](/docs/security/bulletin/2017-05-01)
    - [April](/docs/security/bulletin/2017-04-01)
    - [March](/docs/security/bulletin/2017-03-01)
    - [February](/docs/security/bulletin/2017-02-01)
    - [January](/docs/security/bulletin/2017-01-01)
    - [Index](/docs/security/bulletin/2017)
  + 2016 bulletins
    - [December](/docs/security/bulletin/2016-12-01)
    - [November](/docs/security/bulletin/2016-11-01)
    - [October](/docs/security/bulletin/2016-10-01)
    - [September](/docs/security/bulletin/2016-09-01)
    - [August](/docs/security/bulletin/2016-08-01)
    - [July](/docs/security/bulletin/2016-07-01)
    - [June](/docs/security/bulletin/2016-06-01)
    - [May](/docs/security/bulletin/2016-05-01)
    - [April](/docs/security/bulletin/2016-04-02)
    - [March](/docs/security/bulletin/2016-03-01)
    - [February](/docs/security/bulletin/2016-02-01)
    - [January](/docs/security/bulletin/2016-01-01)
    - [Index](/docs/security/bulletin/2016)
  + 2015 bulletins
    - [December](/docs/security/bulletin/2015-12-01)
    - [November](/docs/security/bulletin/2015-11-01)
    - [October](/docs/security/bulletin/2015-10-01)
    - [September](/docs/security/bulletin/2015-09-01)
    - [August](/docs/security/bulletin/2015-08-01)
    - [Index](/docs/security/bulletin/2015)
  + Pixel/Nexus bulletins
  + [Overview](/docs/security/bulletin/pixel)
  + 2025 bulletins
    - [January](/docs/security/bulletin/pixel/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel/2024-12-01)
    - [November](/docs/security/bulletin/pixel/2024-11-01)
    - [October](/docs/security/bulletin/pixel/2024-10-01)
    - [September](/docs/security/bulletin/pixel/2024-09-01)
    - [August](/docs/security/bulletin/pixel/2024-08-01)
    - [July](/docs/security/bulletin/pixel/2024-07-01)
    - [June](/docs/security/bulletin/pixel/2024-06-01)
    - [May](/docs/security/bulletin/pixel/2024-05-01)
    - [April](/docs/security/bulletin/pixel/2024-04-01)
    - [March](/docs/security/bulletin/pixel/2024-03-01)
    - [February](/docs/security/bulletin/pixel/2024-02-01)
    - [January](/docs/security/bulletin/pixel/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel/2023-12-01)
    - [November](/docs/security/bulletin/pixel/2023-11-01)
    - [October](/docs/security/bulletin/pixel/2023-10-01)
    - [September](/docs/security/bulletin/pixel/2023-09-01)
    - [August](/docs/security/bulletin/pixel/2023-08-01)
    - [July](/docs/security/bulletin/pixel/2023-07-01)
    - [June](/docs/security/bulletin/pixel/2023-06-01)
    - [May](/docs/security/bulletin/pixel/2023-05-01)
    - [April](/docs/security/bulletin/pixel/2023-04-01)
    - [March](/docs/security/bulletin/pixel/2023-03-01)
    - [February](/docs/security/bulletin/pixel/2023-02-01)
    - [January](/docs/security/bulletin/pixel/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/pixel/2022-12-01)
    - [November](/docs/security/bulletin/pixel/2022-11-01)
    - [October](/docs/security/bulletin/pixel/2022-10-01)
    - [September](/docs/security/bulletin/pixel/2022-09-01)
    - [August](/docs/security/bulletin/pixel/2022-08-01)
    - [July](/docs/security/bulletin/pixel/2022-07-01)
    - [June](/docs/security/bulletin/pixel/2022-06-01)
    - [May](/docs/security/bulletin/pixel/2022-05-01)
    - [April](/docs/security/bulletin/pixel/2022-04-01)
    - [March](/docs/security/bulletin/pixel/2022-03-01)
    - [February](/docs/security/bulletin/pixel/2022-02-01)
    - [January](/docs/security/bulletin/pixel/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/pixel/2021-12-01)
    - [November](/docs/security/bulletin/pixel/2021-11-01)
    - [October](/docs/security/bulletin/pixel/2021-10-01)
    - [September](/docs/security/bulletin/pixel/2021-09-01)
    - [August](/docs/security/bulletin/pixel/2021-08-01)
    - [July](/docs/security/bulletin/pixel/2021-07-01)
    - [June](/docs/security/bulletin/pixel/2021-06-01)
    - [May](/docs/security/bulletin/pixel/2021-05-01)
    - [April](/docs/security/bulletin/pixel/2021-04-01)
    - [March](/docs/security/bulletin/pixel/2021-03-01)
    - [February](/docs/security/bulletin/pixel/2021-02-01)
    - [January](/docs/security/bulletin/pixel/2021-01-01)
    - [Index](/docs/security/bulletin/pixel/2021)
  + 2020 bulletins
    - [December](/docs/security/bulletin/pixel/2020-12-01)
    - [November](/docs/security/bulletin/pixel/2020-11-01)
    - [October](/docs/security/bulletin/pixel/2020-10-01)
    - [September](/docs/security/bulletin/pixel/2020-09-01)
    - [August](/docs/security/bulletin/pixel/2020-08-01)
    - [July](/docs/security/bulletin/pixel/2020-07-01)
    - [June](/docs/security/bulletin/pixel/2020-06-01)
    - [May](/docs/security/bulletin/pixel/2020-05-01)
    - [April](/docs/security/bulletin/pixel/2020-04-01)
    - [March](/docs/security/bulletin/pixel/2020-03-01)
    - [February](/docs/security/bulletin/pixel/2020-02-01)
    - [January](/docs/security/bulletin/pixel/2020-01-01)
    - [Index](/docs/security/bulletin/pixel/2020)
  + 2019 bulletins
    - [December](/docs/security/bulletin/pixel/2019-12-01)
    - [November](/docs/security/bulletin/pixel/2019-11-01)
    - [October](/docs/security/bulletin/pixel/2019-10-01)
    - [September](/docs/security/bulletin/pixel/2019-09-01)
    - [August](/docs/security/bulletin/pixel/2019-08-01)
    - [July](/docs/security/bulletin/pixel/2019-07-01)
    - [June](/docs/security/bulletin/pixel/2019-06-01)
    - [May](/docs/security/bulletin/pixel/2019-05-01)
    - [April](/docs/security/bulletin/pixel/2019-04-01)
    - [March](/docs/security/bulletin/pixel/2019-03-01)
    - [February](/docs/security/bulletin/pixel/2019-02-01)
    - [January](/docs/security/bulletin/pixel/2019-01-01)
    - [Index](/docs/security/bulletin/pixel/2019)
  + 2018 bulletins
    - [December](/docs/security/bulletin/pixel/2018-12-01)
    - [November](/docs/security/bulletin/pixel/2018-11-01)
    - [October](/docs/security/bulletin/pixel/2018-10-01)
    - [September](/docs/security/bulletin/pixel/2018-09-01)
    - [August](/docs/security/bulletin/pixel/2018-08-01)
    - [July](/docs/security/bulletin/pixel/2018-07-01)
    - [June](/docs/security/bulletin/pixel/2018-06-01)
    - [May](/docs/security/bulletin/pixel/2018-05-01)
    - [April](/docs/security/bulletin/pixel/2018-04-01)
    - [March](/docs/security/bulletin/pixel/2018-03-01)
    - [February](/docs/security/bulletin/pixel/2018-02-01)
    - [January](/docs/security/bulletin/pixel/2018-01-01)
    - [Index](/docs/security/bulletin/pixel/2018)
  + 2017 bulletins
    - [December](/docs/security/bulletin/pixel/2017-12-01)
    - [November](/docs/security/bulletin/pixel/2017-11-01)
    - [October](/docs/security/bulletin/pixel/2017-10-01)
    - [Index](/docs/security/bulletin/pixel/2017)
  + Android Automotive
  + [Overview](/docs/security/bulletin/aaos)
  + 2025 bulletins
    - [January](/docs/security/bulletin/aaos/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/aaos/2024-12-01)
    - [November](/docs/security/bulletin/aaos/2024-11-01)
    - [October](/docs/security/bulletin/aaos/2024-10-01)
    - [September](/docs/security/bulletin/aaos/2024-09-01)
    - [August](/docs/security/bulletin/aaos/2024-08-01)
    - [July](/docs/security/bulletin/aaos/2024-07-01)
    - [June](/docs/security/bulletin/aaos/2024-06-01)
    - [May](/docs/security/bulletin/aaos/2024-05-01)
    - [April](/docs/security/bulletin/aaos/2024-04-01)
    - [March](/docs/security/bulletin/aaos/2024-03-01)
    - [February](/docs/security/bulletin/aaos/2024-02-01)
    - [January](/docs/security/bulletin/aaos/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/aaos/2023-12-01)
    - [November](/docs/security/bulletin/aaos/2023-11-01)
    - [October](/docs/security/bulletin/aaos/2023-10-01)
    - [September](/docs/security/bulletin/aaos/2023-09-01)
    - [August](/docs/security/bulletin/aaos/2023-08-01)
    - [July](/docs/security/bulletin/aaos/2023-07-01)
    - [June](/docs/security/bulletin/aaos/2023-06-01)
    - [May](/docs/security/bulletin/aaos/2023-05-01)
    - [April](/docs/security/bulletin/aaos/2023-04-01)
    - [March](/docs/security/bulletin/aaos/2023-03-01)
    - [February](/docs/security/bulletin/aaos/2023-02-01)
    - [January](/docs/security/bulletin/aaos/2023-01-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/aaos/2022-12-01)
    - [November](/docs/security/bulletin/aaos/2022-11-01)
    - [October](/docs/security/bulletin/aaos/2022-10-01)
    - [September](/docs/security/bulletin/aaos/2022-09-01)
    - [August](/docs/security/bulletin/aaos/2022-08-01)
    - [July](/docs/security/bulletin/aaos/2022-07-01)
    - [June](/docs/security/bulletin/aaos/2022-06-01)
    - [May](/docs/security/bulletin/aaos/2022-05-01)
    - [April](/docs/security/bulletin/aaos/2022-04-01)
    - [March](/docs/security/bulletin/aaos/2022-03-01)
    - [February](/docs/security/bulletin/aaos/2022-02-01)
    - [January](/docs/security/bulletin/aaos/2022-01-01)
  + 2021 bulletins
    - [December](/docs/security/bulletin/aaos/2021-12-01)
    - [November](/docs/security/bulletin/aaos/2021-11-01)
    - [October](/docs/security/bulletin/aaos/2021-10-01)
    - [September](/docs/security/bulletin/aaos/2021-09-01)
    - [August](/docs/security/bulletin/aaos/2021-08-01)
    - [July](/docs/security/bulletin/aaos/2021-07-01)
    - [June](/docs/security/bulletin/aaos/2021-06-01)
    - [May](/docs/security/bulletin/aaos/2021-05-01)
    - [April](/docs/security/bulletin/aaos/2021-04-01)
    - [March](/docs/security/bulletin/aaos/2021-03-01)
    - [February](/docs/security/bulletin/aaos/2021-02-01)
    - [January](/docs/security/bulletin/aaos/2021-01-01)
  + Chromecast
  + [Overview](/docs/security/bulletin/chromecast)
  + 2024 bulletins
    - [December](/docs/security/bulletin/chromecast/2024-12-01)
    - [September](/docs/security/bulletin/chromecast/2024-09-01)
    - [July](/docs/security/bulletin/chromecast/2024-07-01)
    - [March](/docs/security/bulletin/chromecast/2024-03-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/chromecast/2023-12-01)
    - [September](/docs/security/bulletin/chromecast/2023-07-01)
    - [June](/docs/security/bulletin/chromecast/2023-06-01)
    - [April](/docs/security/bulletin/chromecast/2023-04-01)
  + 2022 bulletins
    - [December](/docs/security/bulletin/chromecast/2022-12-01)
    - [October](/docs/security/bulletin/chromecast/2022-10-01)
    - [July](/docs/security/bulletin/chromecast/2022-07-01)
  + Wear
  + [Overview](/docs/security/bulletin/wear)
  + 2025 bulletins
    - [January](/docs/security/bulletin/wear/2025/2025-01-01)
  + 2024 bulletins
    - [December](/docs/security/bulletin/wear/2024/2024-12-01)
    - [November](/docs/security/bulletin/wear/2024/2024-11-01)
    - [October](/docs/security/bulletin/wear/2024/2024-10-01)
    - [September](/docs/security/bulletin/wear/2024/2024-09-01)
    - [August](/docs/security/bulletin/wear/2024/2024-08-01)
    - [July](/docs/security/bulletin/wear/2024/2024-07-01)
    - [June](/docs/security/bulletin/wear/2024/2024-06-01)
    - [May](/docs/security/bulletin/wear/2024/2024-05-01)
    - [April](/docs/security/bulletin/wear/2024/2024-04-01)
    - [March](/docs/security/bulletin/wear/2024/2024-03-01)
    - [February](/docs/security/bulletin/wear/2024/2024-02-01)
    - [January](/docs/security/bulletin/wear/2024/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/wear/2023/2023-12-01)
    - [November](/docs/security/bulletin/wear/2023/2023-11-01)
    - [October](/docs/security/bulletin/wear/2023/2023-10-01)
    - [September](/docs/security/bulletin/wear/2023/2023-09-01)
    - [August](/docs/security/bulletin/wear/2023/2023-08-01)
  + Pixel Watch
  + [Overview](/docs/security/bulletin/pixel-watch)
  + 2024 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2024-12-01)
    - [August](/docs/security/bulletin/pixel-watch/2024-08-01)
    - [July](/docs/security/bulletin/pixel-watch/2024-07-01)
    - [June](/docs/security/bulletin/pixel-watch/2024-06-01)
    - [May](/docs/security/bulletin/pixel-watch/2024-05-01)
    - [April](/docs/security/bulletin/pixel-watch/2024-04-01)
    - [March](/docs/security/bulletin/pixel-watch/2024-03-01)
    - [February](/docs/security/bulletin/pixel-watch/2024-02-01)
    - [January](/docs/security/bulletin/pixel-watch/2024-01-01)
  + 2023 bulletins
    - [December](/docs/security/bulletin/pixel-watch/2023/2023-12-01)
    - [September](/docs/security/bulletin/pixel-watch/2023/2023-09-01)
    - [June](/docs/security/bulletin/pixel-watch/2023/2023-06-01)
  + Advisories
  + [Overview](/docs/security/bulletin/advisory)
  + [March 2016](/docs/security/bulletin/advisory/2016-03-18)
* Features
  + [Overview](/docs/security/features)
  + [Application Sandbox](/docs/security/app-sandbox)
  + [OMAPI vendor stable interface](/docs/security/features/open-mobile-api)
  + App signing
    - [Overview](/docs/security/features/apksigning)
    - [APK signature scheme v2](/docs/security/features/apksigning/v2)
    - [APK signature scheme v3](/docs/security/features/apksigning/v3)
    - [APK signature scheme v3.1](/docs/security/features/apksigning/v3-1)
    - [APK signature scheme v4](/docs/security/features/apksigning/v4)
  + Authentication
    - [Overview](/docs/security/features/authentication)
    - [Gatekeeper](/docs/security/features/authentication/gatekeeper)
    - Biometrics
      * [Overview](/docs/security/features/biometric)
      * [Measure biometric security](/docs/security/features/biometric/measure)
      * [Fingerprint HIDL](/docs/security/features/authentication/fingerprint-hal)
      * [Face authentication HIDL](/docs/security/features/biometric/face-authentication)
    - Protected confirmation
      * [Overview](/docs/security/features/protected-confirmation)
      * [Implementation](/docs/security/features/protected-confirmation/implementation)
      * [Design guidelines](/docs/security/features/protected-confirmation/design)
      * [Accessibility](/docs/security/features/protected-confirmation/accessibility)
  + DICE
    - [Overview](/docs/security/features/dice)
    - [Applications of DICE](/docs/security/features/dice/applications-of-dice)
  + Encryption
    - [Overview](/docs/security/features/encryption)
    - [File-based encryption](/docs/security/features/encryption/file-based)
    - [Full-disk encryption](/docs/security/features/encryption/full-disk)
    - [Metadata encryption](/docs/security/features/encryption/metadata)
    - [Enable Adiantum](/docs/security/features/encryption/adiantum)
    - [Hardware-wrapped keys](/docs/security/features/encryption/hw-wrapped-keys)
  + Keystore
    - [Overview](/docs/security/features/keystore)
    - [Features](/docs/security/features/keystore/features)
    - [Key and ID attestation](/docs/security/features/keystore/attestation)
    - [Version binding](/docs/security/features/keystore/version-binding)
    - [Authorization tags](/docs/security/features/keystore/tags)
    - [Functions](/docs/security/features/keystore/implementer-ref)
  + Identity credential
    - [Overview](/docs/security/features/identity-credentials)
  + SELinux
    - [Overview](/docs/security/features/selinux)
    - [Concepts](/docs/security/features/selinux/concepts)
    - [Implementation](/docs/security/features/selinux/implement)
    - [Customization](/docs/security/features/selinux/customize)
    - [Build sepolicy](/docs/security/features/selinux/build)
    - [Compatibility](/docs/security/features/selinux/compatibility)
    - [Validation](/docs/security/features/selinux/validate)
    - [Write policy](/docs/security/features/selinux/device-policy)
    - [Vendor init](/docs/security/features/selinux/vendor-init)
  + Trusty TEE
    - [Overview](/docs/security/features/trusty)
    - [Download and build](/docs/security/features/trusty/download-and-build)
    - [Trusty API reference](/docs/security/features/trusty/trusty-ref)
  + Verified Boot
    - [Overview](/docs/security/features/verifiedboot)
    - [Device state](/docs/security/features/verifiedboot/device-state)
    - [Verify Boot](/docs/security/features/verifiedboot/verified-boot)
    - [Boot flow](/docs/security/features/verifiedboot/boot-flow)
    - [Implement dm-verity](/docs/security/features/verifiedboot/dm-verity)
    - [Verify system\_other partition](/docs/security/features/verifiedboot/verify-system-other-partition)
    - [Reference implementation](/docs/security/features/verifiedboot/avb)
  + Safety Center
    - [Overview](/docs/security/safety-center/overview)
    - [Customize Safety Center](/docs/security/safety-center/customize)
    - [Customize Safety Center UI](/docs/security/safety-center/customize-ui)
    - [Interact with Safety Center](/docs/security/safety-center/interact)
    - [Testing and validation](/docs/security/safety-center/test-requirements)
  + Cellular security
    - [Overview](/docs/security/features/cellular-security/overview)
    - [Disable 2G](/docs/security/features/cellular-security/disable-2g)
  + [Private space](/docs/security/features/private-space)
* Testing
  + [Overview](/docs/security/test/fuzz-sanitize)
  + [Memory safety](/docs/security/test/memory-safety)
  + Arm Memory Tagging Extension
  + [Overview](/docs/security/test/memory-safety/arm-mte)
  + [Bootloader support](/docs/security/test/memory-safety/bootloader-support)
  + [Understand MTE reports](/docs/security/test/memory-safety/mte-reports)
  + [MTE configuration](/docs/security/test/memory-safety/mte-configuration)
  + Sanitizers
  + [Overview](/docs/security/test/sanitizers)
  + [AddressSanitizer](/docs/security/test/asan)
  + [Kernel AddressSanitizer](/docs/security/test/kasan)
  + [Hardware-assisted AddressSanitizer](/docs/security/test/hwasan)
  + [Understand HWASan reports](/docs/security/test/memory-safety/hwasan-reports)
  + [UndefinedBehaviorSanitizer](/docs/security/test/ubsan)
  + Other topics
  + [Control flow integrity](/docs/security/test/cfi)
  + [Kernel control flow integrity](/docs/security/test/kcfi)
  + [Execute-only memory](/docs/security/test/execute-only-memory)
  + [Fuzz with libFuzzer](/docs/security/test/libfuzzer)
  + [GWP-ASan and KFENCE](/docs/security/test/memory-safety/gwp-asan-kfence)
  + [Security Test Suite development kit](/docs/security/test/sts-sdk)
  + [Scudo](/docs/security/test/scudo)
  + [ShadowCallStack](/docs/security/test/shadow-call-stack)
  + [Tagged pointers](/docs/security/test/tagged-pointers)
  + [Zero initialized memory](/docs/security/test/memory-safety/zero-initialized-memory)
* Best practices
  + [Overview](/docs/security/best-practices)
  + [Operational security](/docs/security/best-practices/ops)
  + [System security](/docs/security/best-practices/system)
  + [App security](/docs/security/best-practices/app)
  + [Network security](/docs/security/best-practices/network)
  + [Hardware security](/docs/security/best-practices/hardware)
  + [Privacy security](/docs/security/best-practices/privacy)

* What's new?
* [Release notes](/docs/whatsnew/release-notes)
* [Latest security bulletins](/docs/whatsnew/latest-security-bulletins)
* [Latest Compatibility Definition Document (CDD)](/docs/whatsnew/latest-cdd)
* [Site updates](/docs/whatsnew/site-updates)
* Getting Started
* [About](/docs/setup/about)
* [Start](/docs/setup/start)
* [Download](/docs/setup/download)
* [Build](/docs/setup/build)
* [Test](/docs/setup/test)
* [Create](/docs/setup/create/coding-tasks)
* [Contribute](/docs/setup/contribute)
* [Community](/docs/setup/community/cofc)
* [Tools, build, and related reference](/docs/setup/reference)
* Security
* [Overview](/docs/security/overview)
* [Bulletins](/docs/security/bulletin)
* [Features](/docs/security/features)
* [Testing](/docs/security/test/fuzz-sanitize)
* [Best Practices](/docs/security/best-practices)
* Core Topics
* [Architecture](/docs/core/architecture)
* [Audio](/docs/core/audio)
* [Camera](/docs/core/camera)
* [Connectivity](/docs/core/connect)
* [Data](/docs/core/data)
* [Display](/docs/core/display)
* [Fonts](/docs/core/fonts/custom-font-fallback)
* [Graphics](/docs/core/graphics)
* [Interaction](/docs/core/interaction)
* [Media](/docs/core/media)
* [Performance](/docs/core/perf)
* [Permissions](/docs/core/permissions)
* [Power](/docs/core/power)
* [Runtime](/docs/core/runtime)
* [Settings](/docs/core/settings)
* [Storage](/docs/core/storage)
* [Tests](/docs/core/tests)
* [Updates](/docs/core/ota)
* [Virtualization](/docs/core/virtualization)
* Compatibility
* [Compatibility Definition Document (CDD)](/docs/compatibility/cdd)
* [Compatibility Test Suite (CTS)](/docs/compatibility/cts)
* Android Devices
* [Cuttlefish](/docs/devices/cuttlefish)
* [Enterprise](/docs/devices/admin)
* [TV](/docs/devices/tv)
* Automotive
* [Get Started](/docs/automotive/start/what_automotive)
* [Guidelines for Development](/docs/automotive/guidelines)
* [Development Tools](/docs/automotive/dev-tools)
* [Testing Tools and Infrastructure](/docs/automotive/tools)
* [Release Details](/docs/automotive/start/releases)
* Reference
* [HIDL](/reference/hidl)
* [HAL](/reference/hal)
* [Trade Federation](/reference/tradefed/classes)
* [Security Test Suite](/reference/sts/classes)

* [AOSP](https://source.android.com/)
* [Security](https://source.android.com/docs/security)

# Android Security Bulletin—November 2016

Stay organized with collections

Save and categorize content based on your preferences.

*Published November 07, 2016 | Updated December 21, 2016*

The Android Security Bulletin contains details of security vulnerabilities
affecting Android devices. Alongside the bulletin, we have released a security
update to Google devices through an over-the-air (OTA) update. The Google device
firmware images have also been released to the
[Google Developer
site](https://developers.google.com/android/nexus/images). Security patch levels of November 06, 2016 or later address all of
these issues. Refer to the
[Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices) to learn how to check a device's security patch level.

Partners were notified of the issues described in the bulletin on October 20,
2016 or earlier. Where applicable, source code patches for these issues have
been released to the Android Open Source Project (AOSP) repository. This
bulletin also includes links to patches outside of AOSP.

The most severe of these issues is a Critical security vulnerability that could
enable remote code execution on an affected device through multiple methods such
as email, web browsing, and MMS when processing media files. The
[severity
assessment](/docs/security/overview/updates-resources#severity) is based on the effect that exploiting the vulnerability would
possibly have on an affected device, assuming the platform and service
mitigations are disabled for development purposes or if successfully bypassed.

We have had no reports of active customer exploitation or abuse of these newly
reported issues. Refer to the
[Android and Google service
mitigations](#mitigations) section for details on the
[Android
security platform protections](/docs/security/enhancements) and service protections such as
[SafetyNet](https://developer.android.com/training/safetynet/index.html),
which improve the security of the Android platform.

We encourage all customers to accept these updates to their devices.

## Announcements

* With the introduction of the Pixel and Pixel XL devices, the term for
  [all devices supported by Google](#google-devices) is
  "Google devices" instead of "Nexus devices."
* This bulletin has three security patch levels to provide Android partners
  with the flexibility to more quickly fix a subset of vulnerabilities that are
  similar across all Android devices. See
  [Common questions and answers](#common-questions-and-answers) for
  additional information:
  + **2016-11-01**: Partial security patch level. This security
    patch level indicates that all issues associated with 2016-11-01 (and all
    previous security patch level) are addressed.
  + **2016-11-05**: Complete security patch level. This security
    patch level indicates that all issues associated with 2016-11-01 and 2016-11-05
    (and all previous security patch levels) are addressed.
  + **Supplemental security patch levels**

    Supplemental security patch levels are provided to identify devices
    that contain fixes for issues that were publicly disclosed after the
    patch level was defined. Addressing these recently disclosed
    vulnerabilities is not required until the 2016-12-01 security patch level.

    - **2016-11-06**: This security patch level indicates that the
      device has addressed all issues associated with 2016-11-05 and CVE-2016-5195,
      which was publicly disclosed on October 19, 2016.
* Supported Google devices will receive a single OTA update with the November
  05, 2016 security patch level.

## Android and Google service mitigations

This is a summary of the mitigations provided by the
[Android
security platform](/docs/security/enhancements) and service protections, such as SafetyNet. These
capabilities reduce the likelihood that security vulnerabilities could be
successfully exploited on Android.

* Exploitation for many issues on Android is made more difficult by
  enhancements in newer versions of the Android platform. We encourage all users
  to update to the latest version of Android where possible.
* The Android Security team actively monitors for abuse with
  [Verify
  Apps and SafetyNet](/static/docs/security/overview/reports/Google_Android_Security_2015_Report_Final.pdf), which are designed to warn users about
  [Potentially
  Harmful Applications](http://static.googleusercontent.com/media/source.android.com/en//security/reports/Google_Android_Security_PHA_classifications.pdf). Verify Apps is enabled by default on devices with
  [Google Mobile Services](http://www.android.com/gms) and is especially
  important for users who install applications from outside of Google Play. Device
  rooting tools are prohibited within Google Play, but Verify Apps warns users
  when they attempt to install a detected rooting application—no matter where it
  comes from. Additionally, Verify Apps attempts to identify and block
  installation of known malicious applications that exploit a privilege escalation
  vulnerability. If such an application has already been installed, Verify Apps
  will notify the user and attempt to remove the detected application.
* As appropriate, Google Hangouts and Messenger applications do not
  automatically pass media to processes such as Mediaserver.

## Acknowledgements

We would like to thank these researchers for their contributions:

* Abhishek Arya, Oliver Chang, and Martin Barbella of Google Chrome Security
  Team: CVE-2016-6722
* Andrei Kapishnikov and Miriam Gershenson of Google: CVE-2016-6703
* Ao Wang ([@ArayzSegment](https://twitter.com/ArayzSegment)) and
  [Zinuo Han](http://weibo.com/ele7enxxh) of
  [PKAV](http://www.pkav.net), Silence Information Technology:
  CVE-2016-6700, CVE-2016-6702
* Askyshang of Security Platform Department, Tencent: CVE-2016-6713
* Billy Lau of Android Security: CVE-2016-6737
* Constantinos Patsakis and
  Efthimios Alepis of University of Piraeus:
  CVE-2016-6715
* dragonltx of Alibaba mobile security team: CVE-2016-6714
* Gal Beniamini of Project Zero: CVE-2016-6707, CVE-2016-6717
* Gengjia Chen ([@chengjia4574](http://twitter.com/chengjia4574))
  and [pjf](http://weibo.com/jfpan) of IceSword Lab,
  [Qihoo 360 Technology Co. Ltd](http://www.360.com).: CVE-2016-6725,
  CVE-2016-6738, CVE-2016-6740, CVE-2016-6741, CVE-2016-6742, CVE-2016-6744,
  CVE-2016-6745, CVE-2016-3906
* Guang Gong (龚广) ([@oldfresher](http://twitter.com/oldfresher)) of
  Alpha Team, [Qihoo 360 Technology Co. Ltd](http://www.360.com).:
  CVE-2016-6754
* Jianqiang Zhao ([@jianqiangzhao](http://twitter.com/jianqiangzhao)) and
  [pjf](http://weibo.com/jfpan) of IceSword Lab,
  [Qihoo 360 Technology Co. Ltd](http://www.360.com).: CVE-2016-6739,
  CVE-2016-3904, CVE-2016-3907, CVE-2016-6698
* Marco Grassi ([@marcograss](http://twitter.com/marcograss)) of
  Keen Lab of Tencent ([@keen\_lab](http://twitter.com/keen_lab)):
  CVE-2016-6828
* Mark Brand of Project Zero: CVE-2016-6706
* Mark Renouf of Google: CVE-2016-6724
* Michał Bednarski ([github.com/michalbednarski](https://github.com/michalbednarski)):
  CVE-2016-6710
* Min Chong of Android Security: CVE-2016-6743
* Peter Pi ([@heisecode](http://twitter.com/heisecode)) of Trend
  Micro: CVE-2016-6721
* Qidan He (何淇丹) ([@flanker\_hqd](http://twitter.com/flanker_hqd))
  and Gengming Liu (刘耕铭) ([@dmxcsnsbh](http://twitter.com/dmxcsnsbh))
  of KeenLab, Tencent: CVE-2016-6705
* Robin Lee of Google: CVE-2016-6708
* Scott Bauer ([@ScottyBauer1](http://twitter.com/ScottyBauer1)): CVE-2016-6751
* Sergey Bobrov ([@Black2Fan](http://twitter.com/Black2Fan)) of
  Kaspersky Lab: CVE-2016-6716
* Seven Shen ([@lingtongshen](http://twitter.com/lingtongshen)) of
  Trend Micro Mobile Threat Research Team: CVE-2016-6748, CVE-2016-6749,
  CVE-2016-6750, CVE-2016-6753
* Victor van der Veen, Herbert Bos, Kaveh Razavi, and Cristiano Giuffrida of
  Vrije Universiteit Amsterdam and Yanick Fratantonio, Martina Lindorfer, and
  Giovanni Vigna of University of California, Santa Barbara: CVE-2016-6728
* Weichao Sun ([@sunblate](https://twitter.com/sunblate)) of
  Alibaba Inc: CVE-2016-6712, CVE-2016-6699, CVE-2016-6711
* Wenke Dou (vancouverdou@gmail.com), Chiachih Wu
  ([@chiachih\_wu](https://twitter.com/chiachih_wu)), and Xuxian Jiang
  of [C0RE Team](http://c0reteam.org): CVE-2016-6720
* Wish Wu (吴潍浠) ([@wish\_wu](http://twitter.com/wish_wu)) of Trend
  Micro Inc.: CVE-2016-6704
* Yakov Shafranovich of
  [Nightwatch Cybersecurity](https://wwws.nightwatchcybersecurity.com):
  CVE-2016-6723
* Yuan-Tsung Lo,
  Yao Jun,
  Tong Lin, Chiachih Wu ([@chiachih\_wu](https://twitter.com/chiachih_wu)), and Xuxian Jiang of
  [C0RE Team](http://c0reteam.org): CVE-2016-6730, CVE-2016-6732,
  CVE-2016-6734, CVE-2016-6736
* Yuan-Tsung Lo,
  Yao Jun,
  Xiaodong Wang, Chiachih Wu ([@chiachih\_wu](https://twitter.com/chiachih_wu)), and Xuxian Jiang of
  [C0RE Team](http://c0reteam.org): CVE-2016-6731, CVE-2016-6733,
  CVE-2016-6735, CVE-2016-6746

Additional thanks to Zach Riggle of Android Security for his contributions
to several issues in this bulletin.

## 2016-11-01 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2016-11-01 patch level. There is a description of
the issue, a severity rationale, and a table with the CVE, associated
references, severity, updated Google devices, updated AOSP versions (where
applicable), and date reported. When available, we will link the public change
that addressed the issue to the bug ID, like the AOSP change list. When multiple
changes relate to a single bug, additional references are linked to numbers
following the bug ID.

### Remote code execution vulnerability in Mediaserver

A remote code execution vulnerability in Mediaserver could enable an attacker
using a specially crafted file to cause memory corruption during media file and
data processing. This issue is rated as Critical due to the possibility of
remote code execution within the context of the Mediaserver process.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6699 | [A-31373622](https://android.googlesource.com/platform/frameworks/av/%2B/3b1c9f692c4d4b7a683c2b358fc89e831a641b88) | Critical | All | 7.0 | Jul 27, 2016 |

### Elevation of privilege vulnerability in libzipfile

An elevation of privilege vulnerability in libzipfile could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as Critical due to the possibility of a
local permanent device compromise, which may require reflashing the operating
system to repair the device.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6700 | A-30916186 | Critical | None\* | 4.4.4, 5.0.2, 5.1.1 | Aug 17, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Skia

A remote code execution vulnerability in libskia could enable an attacker using
a specially crafted file to cause memory corruption during media file and data
processing. This issue is rated as High due to the possibility of remote code
execution within the context of the gallery process.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6701 | [A-30190637](https://android.googlesource.com/platform/external/skia/%2B/aca73722873e908633ff27375f6f93a08cbb7dd3) | High | All | 7.0 | Google internal |

### Remote code execution vulnerability in libjpeg

A remote code execution vulnerability in libjpeg could enable an attacker using
a specially crafted file to execute arbitrary code in the context of an
unprivileged process. This issue is rated as High due to the possibility of
remote code execution in an application that uses libjpeg.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6702 | A-30259087 | High | None\* | 4.4.4, 5.0.2, 5.1.1 | Jul 19, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Android runtime

A remote code execution vulnerability in an Android runtime library could enable
an attacker using a specially crafted payload to execute arbitrary code in the
context of an unprivileged process. This issue is rated as High due to the
possibility of remote code execution in an application that uses the Android
runtime.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6703 | A-30765246 | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Google internal |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Elevation of privilege vulnerability in Mediaserver

An elevation of privilege vulnerability in Mediaserver could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as High because it could be used to gain
local access to elevated capabilities, which are not normally accessible to a
third-party application.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6704 | [A-30229821](https://android.googlesource.com/platform/frameworks/av/%2B/c6c446f9e022adf20064e65a17574804f8af8e7d) [[2](https://android.googlesource.com/platform/hardware/qcom/audio/%2B/9cb9810ecb63c8ff55ecf4bc77431dc5b0688b5f)] [[3](https://android.googlesource.com/platform/system/media/%2B/a6274f03b4dfe1c3a22af51e3a17ea56a314e747)] | High | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jul 19, 2016 |
| CVE-2016-6705 | [A-30907212](https://android.googlesource.com/platform/frameworks/av/%2B/3a03fa24d21f97e84e796ac5ef14b3f434c0e8f1) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/bd04b47d38a89f1dada1c6da2ef4a3d235c166b8)] | High | All | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Aug 16, 2016 |
| CVE-2016-6706 | [A-31385713](https://android.googlesource.com/platform/frameworks/av/%2B/1d4feebdb85db46e138530f360d9ff2490e14353) | High | All | 7.0 | Sep 8, 2016 |

### Elevation of privilege vulnerability in System Server

An elevation of privilege vulnerability in System Server could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as High because it could be used to gain
local access to elevated capabilities, which are not normally accessible to a
third-party application.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6707 | [A-31350622](https://android.googlesource.com/platform/frameworks/base/%2B/16024ea7c4bae08c972cf6b3734029aad33e8870) | High | All | 6.0, 6.0.1, 7.0 | Sep 7, 2016 |

### Elevation of privilege vulnerability in System UI

An elevation of privilege in the System UI could enable a local malicious user
to bypass the security prompt of a work profile in Multi-Window mode. This
issue is rated as High because it is a local bypass of user interaction
requirements for any developer or security setting modifications.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6708 | [A-30693465](https://android.googlesource.com/platform/frameworks/base/%2B/c9c73fde339b4db496f2c1ff8c18df1e9db5a7c1) | High | All | 7.0 | Google internal |

### Information disclosure vulnerability in Conscrypt

An information disclosure vulnerability in Conscrypt could enable
an attacker to gain access to sensitive information if a
legacy encryption API is used by an application. This issue is rated as High
because it could be used to access data without permission.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6709 | [A-31081987](https://android.googlesource.com/platform/external/conscrypt/%2B/44ef9535b9afb123d150d8e0362e4bb50794dd41) | High | All | 6.0, 6.0.1, 7.0 | Oct 9, 2015 |

### Information disclosure vulnerability in download manager

An information disclosure vulnerability in the download manager could enable a
local malicious application to bypass operating system protections that isolate
application data from other applications. This issue is rated as High because it
could be used to gain access to data that the application does not have access
to.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6710 | [A-30537115](https://android.googlesource.com/platform/frameworks/base/%2B/9fab683c9598d234dd8461335c276ed3e37c91e8) [[2](https://android.googlesource.com/platform/packages/providers/DownloadProvider/%2B/243e62949f7208d3b82eda3ee4ec22d3dbc1fb19)] | High | All | 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jul 30, 2016 |

### Denial of service vulnerability in Bluetooth

A denial of service vulnerability in Bluetooth could enable a proximate attacker
to block Bluetooth access to an affected device. This issue is rated as High due
to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2014-9908 | A-28672558 | High | None\* | 4.4.4, 5.0.2, 5.1.1 | May 5, 2014 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Denial of service vulnerability in OpenJDK

A remote denial of service vulnerability in OpenJDK could enable an attacker to
use a specially crafted file to cause a device hang or reboot. This issue is
rated as High due to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2015-0410 | [A-30703445](https://android.googlesource.com/platform/libcore/%2B/21098574528bdf99dd50a74a60e161573e999108) | High | All | 7.0 | Jan 16, 2015 |

### Denial of service vulnerability in Mediaserver

A remote denial of service vulnerability in Mediaserver could enable an attacker
to use a specially crafted file to cause a device hang or reboot. This issue is
rated as High due to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6711 | [A-30593765](https://android.googlesource.com/platform/external/libvpx/%2B/063be1485e0099bc81ace3a08b0ec9186dcad693) | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Aug 1, 2016 |
| CVE-2016-6712 | [A-30593752](https://android.googlesource.com/platform/external/libvpx/%2B/fdb1b40e7bb147c07bda988c9501ad223795d12d) | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Aug 1, 2016 |
| CVE-2016-6713 | [A-30822755](https://android.googlesource.com/platform/external/libavc/%2B/8cafca0e8b1ed8125918e203118c5a4e612fd56c) | High | All | 6.0, 6.0.1, 7.0 | Aug 11, 2016 |
| CVE-2016-6714 | [A-31092462](https://android.googlesource.com/platform/external/libavc/%2B/5bdb0a6b72782e505671a387bb5f83222d891d6a) | High | All | 6.0, 6.0.1, 7.0 | Aug 22, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Elevation of privilege vulnerability in Framework APIs

An elevation of privilege vulnerability in the Framework APIs could allow a
local malicious application to record audio without the user's permission. This
issue is rated as Moderate because it is a local bypass of user interaction
requirements (access to functionality that would normally require either user
initiation or user permission).

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6715 | [A-29833954](https://android.googlesource.com/platform/frameworks/base/%2B/3de09838fb0996bb4b420630800ad34e828fd1b6) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jun 28, 2016 |

### Elevation of privilege vulnerability in AOSP Launcher

An elevation of privilege vulnerability in the AOSP Launcher could allow a local
malicious application to create shortcuts that have elevated privileges without
the user's consent. This issue is rated as Moderate because it is a local bypass
of user interaction requirements (access to functionality that would normally
require either user initiation or user permission).

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6716 | [A-30778130](https://android.googlesource.com/platform/packages/apps/Launcher3/%2B/e83fc11c982e67dd0181966f5f3a239ea6b14924) | Moderate | All | 7.0 | Aug 5, 2016 |

### Elevation of privilege vulnerability in Mediaserver

An elevation of privilege vulnerability in Mediaserver could enable a local
malicious application to execute arbitrary code within the context of a
privileged process. This issue is rated as Moderate because it first requires
exploitation of a separate vulnerability.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6717 | [A-31350239](https://android.googlesource.com/platform/frameworks/av/%2B/45d9bbabbe7920bf4e0a68074b97d8260aef2e07) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Sep 7, 2016 |

### Elevation of privilege vulnerability in Account Manager Service

An elevation of privilege vulnerability in the Account Manager Service could
enable a local malicious application to retrieve sensitive information without
user interaction. This issue is rated as Moderate because it is a local bypass
of user interaction requirements (access to functionality that would normally
require either user initiation or user permission.)

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6718 | [A-30455516](https://android.googlesource.com/platform/frameworks/base/%2B/fecfd550edeca422c0d9f32a9c0abe73398a1ff1) | Moderate | All | 7.0 | Google internal |

### Elevation of privilege vulnerability in Bluetooth

An elevation of privilege vulnerability in the Bluetooth component could enable
a local malicious application to pair with any Bluetooth device without user
consent. This issue is rated as Moderate because it is a local bypass of user
interaction requirements (access to functionality that would normally require
either user initiation or user permission).

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6719 | [A-29043989](https://android.googlesource.com/platform/packages/apps/Bluetooth/%2B/e1b6db10e913c09d0b695368336137f6aabee462) [[2](https://android.googlesource.com/platform/frameworks/base/%2B/b1dc1757071ba46ee653d68f331486e86778b8e4)] | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Google internal |

### Information disclosure vulnerability in Mediaserver

An information disclosure vulnerability in Mediaserver could enable a local
malicious application to access data outside of its permission levels. This
issue is rated as Moderate because it could be used to access sensitive data
without permission.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6720 | [A-29422020](https://android.googlesource.com/platform/frameworks/av/%2B/0f177948ae2640bfe4d70f8e4248e106406b3b0a) [[2](https://android.googlesource.com/platform/frameworks/av/%2B/2c75e1c3b98e4e94f50c63e2b7694be5f948477c)] [[3](https://android.googlesource.com/platform/frameworks/av/%2B/7c88b498fda1c2b608a9dd73960a2fd4d7b7e3f7)] [[4](https://android.googlesource.com/platform/frameworks/av/%2B/640b04121d7cd2cac90e2f7c82b97fce05f074a5)] | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jun 15, 2016 |
| CVE-2016-6721 | [A-30875060](https://android.googlesource.com/platform/frameworks/av/%2B/f6bf0102bdc1adff973e08d8ce9c869c4e2efade) | Moderate | All | 6.0, 6.0.1, 7.0 | Aug 13, 2016 |
| CVE-2016-6722 | [A-31091777](https://android.googlesource.com/platform/frameworks/av/%2B/89c03b3b9ff74a507a8b8334c50b08b334483556) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Aug 23, 2016 |

### Denial of service vulnerability in Proxy Auto Config

A denial of service vulnerability in Proxy Auto Config could enable a remote
attacker to use a specially crafted file to cause a device hang or reboot. This
issue is rated as Moderate because it requires an uncommon device configuration.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6723 | [A-30100884](https://android.googlesource.com/platform/frameworks/base/%2B/d5b0d0b1df2e1a7943a4bb2034fd21487edd0264) [[2](https://android.googlesource.com/platform/frameworks/base/%2B/31f351160cdfd9dbe9919682ebe41bde3bcf91c6)] | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Jul 11, 2016 |

### Denial of service vulnerability in Input Manager Service

A denial of service vulnerability in the Input Manager Service could enable a
local malicious application to cause the device to continually reboot. This
issue is rated as Moderate because it is a temporary denial of service that
requires a factory reset to fix.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6724 | [A-30568284](https://android.googlesource.com/platform/frameworks/base/%2B/7625010a2d22f8c3f1aeae2ef88dde37cbebd0bf) | Moderate | All | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1, 7.0 | Google internal |

## 2016-11-05 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities that apply to the 2016-11-05 patch level. There is a description of
the issue, a severity rationale, and a table with the CVE, associated
references, severity, updated Google devices, updated AOSP versions (where
applicable), and date reported. When available, we will link the public change
that addressed the issue to the bug ID, like the AOSP change list. When multiple
changes relate to a single bug, additional references are linked to numbers
following the bug ID.

### Remote code execution vulnerability in Qualcomm crypto driver

A remote code execution vulnerability in the Qualcomm crypto driver could enable
a remote attacker to execute arbitrary code within the context of the kernel.
This issue is rated as Critical due to the possibility of remote code execution
in the context of the kernel.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6725 | A-30515053 [QC-CR#1050970](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=cc95d644ee8a043f2883d65dda20e16f95041de3) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 25, 2016 |

### Elevation of privilege vulnerability in kernel file system

An elevation of privilege vulnerability in the kernel file system could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8961 | A-30952474  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=6934da9238da947628be83635e365df41064b09b) | Critical | Pixel, Pixel XL | Oct 18, 2015 |
| CVE-2016-7911 | A-30946378  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=8ba8682107ee2ca3347354e018865d8e1967c5f4) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Jul 01, 2016 |
| CVE-2016-7910 | A-30942273  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=77da160530dd1dc94f6ae15a981f24e5f0021e84) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Jul 29, 2016 |

### Elevation of privilege vulnerability in kernel SCSI driver

An elevation of privilege vulnerability in the kernel SCSI driver could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8962 | A-30951599  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=f3951a3709ff50990bf3e188c27d346792103432) | Critical | Pixel, Pixel XL | Oct 30, 2015 |

### Elevation of privilege vulnerability in kernel media driver

An elevation of privilege vulnerability in the kernel media driver could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-7913 | A-30946097  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=8dfbcc4351a0b6d2f2d77f367552f48ffefafe18) | Critical | Nexus 6P, Android One, Nexus Player, Pixel, Pixel XL | Jan 28, 2016 |

### Elevation of privilege vulnerability in kernel USB driver

An elevation of privilege vulnerability in the kernel USB driver could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-7912 | A-30950866  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=38740a5b87d53ceb89eb2c970150f6e94e00373a) | Critical | Pixel C, Pixel, Pixel XL | Apr 14, 2016 |

### Elevation of privilege vulnerability in kernel ION subsystem

An elevation of privilege vulnerability in the kernel ION subsystem could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6728 | A-30400942\* | Critical | Nexus 5, Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Nexus Player, Pixel C, Android One | Jul 25, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in Qualcomm bootloader

An elevation of privilege vulnerability in the Qualcomm bootloader could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6729 | A-30977990\*  QC-CR#977684 | Critical | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 25, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in NVIDIA GPU driver

An elevation of privilege vulnerability in the NVIDIA GPU driver could enable a
local malicious application to execute arbitrary code within the context of the
kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6730 | A-30904789\* N-CVE-2016-6730 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6731 | A-30906023\* N-CVE-2016-6731 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6732 | A-30906599\* N-CVE-2016-6732 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6733 | A-30906694\* N-CVE-2016-6733 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6734 | A-30907120\* N-CVE-2016-6734 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6735 | A-30907701\* N-CVE-2016-6735 | Critical | Pixel C | Aug 16, 2016 |
| CVE-2016-6736 | A-30953284\* N-CVE-2016-6736 | Critical | Pixel C | Aug 18, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in kernel networking subsystem

An elevation of privilege vulnerability in the kernel networking subsystem could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as Critical due to the possibility of
a local permanent device compromise, which may require reflashing the operating
system to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6828 | A-31183296  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/include/net/tcp.h?id=bb1fceca22492109be12640d49f5ea5a544c6bb4) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Aug 18, 2016 |

### Elevation of privilege vulnerability in kernel sound subsystem

An elevation of privilege vulnerability in the kernel sound subsystem could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as Critical due to the possibility of
a local permanent device compromise, which may require reflashing the operating
system to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-2184 | A-30952477  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=836b34a935abc91e13e63053d0a83b24dfb5ea78) | Critical | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Mar 31, 2016 |

### Elevation of privilege vulnerability in kernel ION subsystem

An elevation of privilege vulnerability in the kernel ION subsystem could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as Critical due to the possibility of a local
permanent device compromise, which may require reflashing the operating system
to repair the device.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6737 | A-30928456\* | Critical | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Vulnerabilities in Qualcomm components

The table below contains security vulnerabilities affecting Qualcomm components
and are described in further detail in Qualcomm AMSS June 2016 security
bulletin and Security Alert 80-NV606-17.

| CVE | References | Severity\* | Updated Google devices | Date reported |
| CVE-2016-6727 | A-31092400\*\* | Critical | Android One | Qualcomm internal |
| CVE-2016-6726 | A-30775830\*\* | High | Nexus 6, Android One | Qualcomm internal |

\* The severity rating for these vulnerabilities was determined by the vendor.

\*\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Remote code execution vulnerability in Expat

The table below contains security vulnerabilities affecting the Expat library.
The most severe of these issues is an elevation of privilege vulnerability in
the Expat XML parser, which could enable an attacker using a specially crafted
file to execute arbitrary code in an unprivileged process. This issue is rated
as High due to the possibility of arbitrary code execution in an application
that uses Expat.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-0718 | [A-28698301](https://android.googlesource.com/platform/external/expat/%2B/52ac633b73856ded34b33bd4adb4ab793bbbe963) | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | May 10, 2016 |
| CVE-2012-6702 | [A-29149404](https://android.googlesource.com/platform/external/expat/%2B/a11ff32280a863bff93df13ad643912ad9bf1302) | Moderate | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Mar 06, 2016 |
| CVE-2016-5300 | [A-29149404](https://android.googlesource.com/platform/external/expat/%2B/a11ff32280a863bff93df13ad643912ad9bf1302) | Moderate | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Jun 04, 2016 |
| CVE-2015-1283 | [A-27818751](https://android.googlesource.com/platform/external/expat/%2B/13b40c2040a17038b63a61e2b112c634da203d3b) | Low | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Jul 24, 2015 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Webview

A remote code execution vulnerability in Webview could enable a remote attacker
to execute arbitrary code when the user is navigating to a website. This issue
is rated as High due to the possibility of remote code execution in an
unprivileged process.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2016-6754 | A-31217937 | High | None\* | 5.0.2, 5.1.1, 6.0, 6.0.1 | Aug 23, 2016 |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Remote code execution vulnerability in Freetype

A remote code execution vulnerability in Freetype could enable a local malicious
application to load a specially crafted font to cause memory corruption in an
unprivileged process. This issue is rated as High due to the possibility of
remote code execution in applications that use Freetype.

| CVE | References | Severity | Updated Google devices | Updated AOSP versions | Date reported |
| CVE-2014-9675 | [A-24296662](https://android.googlesource.com/platform/external/freetype/%2B/f720f0dbcf012d6c984dbbefa0875ef9840458c6) [[2](https://android.googlesource.com/platform/external/pdfium/%2B/96f965ff7411f1edba72140fd70740e63cabec71)] | High | None\* | 4.4.4, 5.0.2, 5.1.1, 6.0, 6.0.1 | Google internal |

\* Supported Google devices on Android 7.0 or later that have installed all
available updates are not affected by this vulnerability.

### Elevation of privilege vulnerability in kernel performance subsystem

An elevation of privilege vulnerability in the kernel performance subsystem
could enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8963 | A-30952077  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=12ca6ad2e3a896256f086497a7c7406a547ee373) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Dec 15, 2015 |

### Elevation of privilege vulnerability in kernel system-call auditing subsystem

An elevation of privilege vulnerability in the kernel system-call auditing
subsystem could enable a local malicious application to disrupt system-call
auditing in the kernel. This issue is rated as High because it is a general
bypass for a kernel-level defense in depth or exploit mitigation technology.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6136 | A-30956807  [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=43761473c254b45883a64441dd0bc85a42f3645c) | High | Android One, Pixel C, Nexus Player | Jul 1, 2016 |

### Elevation of privilege vulnerability in Qualcomm crypto engine driver

An elevation of privilege vulnerability in the Qualcomm crypto engine driver
could enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6738 | A-30034511  [QC-CR#1050538](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=a829c54236b455885c3e9c7c77ac528b62045e79) | High | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 7, 2016 |

### Elevation of privilege vulnerability in Qualcomm camera driver

An elevation of privilege vulnerability in the Qualcomm camera driver could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6739 | A-30074605\* QC-CR#1049826 | High | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Jul 11, 2016 |
| CVE-2016-6740 | A-30143904  [QC-CR#1056307](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=ef78bd62f0c064ae4c827e158d828b2c110ebcdc) | High | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 12, 2016 |
| CVE-2016-6741 | A-30559423  [QC-CR#1060554](https://source.codeaurora.org/quic/la//kernel/msm-3.18/commit/?id=d291eebd8e43bba3229ae7ef9146a132894dc293) | High | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 28, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Elevation of privilege vulnerability in Qualcomm bus driver

An elevation of privilege vulnerability in the Qualcomm bus driver could enable
a local malicious application to execute arbitrary code within the context of
the kernel. This issue is rated as High because it first requires compromising a
privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-3904 | A-30311977  [QC-CR#1050455](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=069683407ca9a820d05c914b57c587bcd3f16a3a) | High | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Jul 22, 2016 |

### Elevation of privilege vulnerability in Synaptics touchscreen driver

An elevation of privilege vulnerability in the Synaptics touchscreen driver
could enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as High because it first requires
compromising a privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6742 | A-30799828\* | High | Nexus 5X, Android One | Aug 9, 2016 |
| CVE-2016-6744 | A-30970485\* | High | Nexus 5X | Aug 19, 2016 |
| CVE-2016-6745 | A-31252388\* | High | Nexus 5X, Nexus 6P, Nexus 9, Android One, Pixel, Pixel XL | Sep 1, 2016 |
| CVE-2016-6743 | A-30937462\* | High | Nexus 9, Android One | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Information disclosure vulnerability in kernel components

An information disclosure vulnerability in kernel components, including the
human interface device driver, file system, and Teletype driver, could enable a
local malicious application to access data outside of its permission levels.
This issue is rated as High because it could be used to access sensitive data
without explicit user permission.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2015-8964 | A-30951112  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=dd42bf1197144ede075a9d4793123f7689e164bc) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Nov 27, 2015 |
| CVE-2016-7915 | A-30951261  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=50220dead1650609206efe91f0cc116132d59b3f) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | Jan 19, 2016 |
| CVE-2016-7914 | A-30513364  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=8d4a2ec1e0b41b0cf9a0c5cd4511da7f8e4f3de2) | High | Pixel C, Pixel, Pixel XL | Apr 06, 2016 |
| CVE-2016-7916 | A-30951939  [Upstream kernel](http://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=8148a73c9901a8794a50f950083c00ccf97d43b3) | High | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Android One, Pixel C, Nexus Player, Pixel, Pixel XL | May 05, 2016 |

### Information disclosure vulnerability in NVIDIA GPU driver

An information disclosure vulnerability in the NVIDIA GPU driver could enable a
local malicious application to access data outside of its permission levels.
This issue is rated as High because it could be used to access sensitive data
without explicit user permission.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6746 | A-30955105\* N-CVE-2016-6746 | High | Pixel C | Aug 18, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Denial of service vulnerability in Mediaserver

A denial of service vulnerability in Mediaserver could enable an attacker to use
a specially crafted file to cause a device hang or reboot. This issue is rated
as High due to the possibility of remote denial of service.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6747 | A-31244612\* N-CVE-2016-6747 | High | Nexus 9 | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Information disclosure vulnerability in kernel components

An information disclosure vulnerability in kernel components, including the
process-grouping subsystem and the networking subsystem, could enable a local
malicious application to access data outside of its permission levels. This
issue is rated as Moderate because it first requires compromising a privileged
process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-7917 | A-30947055  [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=c58d6c93680f28ac58984af61d0a7ebf4319c241) | Moderate | Pixel C, Pixel, Pixel XL | Feb 02, 2016 |
| CVE-2016-6753 | A-30149174\* | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Nexus 9, Pixel C, Nexus Player, Pixel, Pixel XL | Jul 13, 2016 |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

### Information disclosure vulnerability in Qualcomm components

An information disclosure vulnerability in Qualcomm components including the GPU
driver, power driver, SMSM Point-to-Point driver, and sound driver, could enable
a local malicious application to access data outside of its permission levels.
This issue is rated as Moderate because it first requires compromising a
privileged process.

| CVE | References | Severity | Updated Google devices | Date reported |
| CVE-2016-6748 | A-30076504  [QC-CR#987018](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=be651d020b122a1ba9410d23ca4ebbe9f5598df6) | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 12, 2016 |
| CVE-2016-6749 | A-30228438  [QC-CR#1052818](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=f9185dc83b92e7d1ee341e32e8cf5ed00a7253a7) | Moderate | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Jul 12, 2016 |
| CVE-2016-6750 | A-30312054  [QC-CR#1052825](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=34bda711a1c7bc7f9fd7bea3a5be439ed00577e5) | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Jul 21, 2016 |
| CVE-2016-3906 | A-30445973  [QC-CR#1054344](https://source.codeaurora.org/quic/la/kernel/msm-3.18/commit/?id=b333d32745fec4fb1098ee1a03d4425f3c1b4c2e) | Moderate | Nexus 5X, Nexus 6P | Jul 27, 2016 |
| CVE-2016-3907 | A-30593266  [QC-CR#1054352](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=744330f4e5d70dce71c4c9e03c5b6a8b59bb0cda) | Moderate | Nexus 5X, Nexus 6P, Pixel, Pixel XL | Aug 2, 2016 |
| CVE-2016-6698 | A-30741851  [QC-CR#1058826](https://source.codeaurora.org/quic/la//kernel/msm-3.10/commit/?id=de90beb76ad0b80da821c3b857dd30cd36319e61) | Moderate | Nexus 5X, Nexus 6P, Android One, Pixel, Pixel XL | Aug 2, 2016 |
| CVE-2016-6751 | A-30902162\* QC-CR#1062271 | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Aug 15, 2016 |
| CVE-2016-6752 | A-31498159  [QC-CR#987051](https://source.codeaurora.org/quic/la//kernel/msm-3.18/commit/?h=0de2c7600c8f1f0152a2f421c6593f931186400a) | Moderate | Nexus 5X, Nexus 6, Nexus 6P, Android One, Pixel, Pixel XL | Google internal |

\* The patch for this issue is not publicly available. The update is contained in
the latest binary drivers for Google devices available from the [Google Developer
site](https://developers.google.com/android/nexus/drivers).

## 2016-11-06 security patch level—Vulnerability details

In the sections below, we provide details for each of the security
vulnerabilities listed in the
[2016-11-06 security patch level—Vulnerability
summary](#2016-11-06-summary) above. There is a description of
the issue, a severity rationale, and a table with the CVE, associated
references, severity, updated Google devices, updated AOSP versions (where
applicable), and date reported. When available, we will link the public change
that addressed the issue to the bug ID, like the AOSP change list. When multiple
changes relate to a single bug, additional references are linked to numbers
following the bug ID.

### Elevation of privilege vulnerability in kernel memory subsystem

An elevation of privilege vulnerability in the kernel memory subsystem could
enable a local malicious application to execute arbitrary code within the
context of the kernel. This issue is rated as Critical due to the possibility of
a local permanent device compromise, which may require reflashing the operating
system to repair the device.

**Note:** A security patch level of 2016-11-06 indicates that this
issue, as well as all issues associated with 2016-11-01 and 2016-11-05 are
addressed.

| CVE | References | Severity | Updated kernel versions | Date reported |
| --- | --- | --- | --- | --- |
| CVE-2016-5195 | A-32141528 [Upstream kernel](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=9691eac5593ff1e2f82391ad327f21d90322aec1) [[2](https://git.kernel.org/cgit/linux/kernel/git/stable/linux-stable.git/commit/?id=e45a502bdeae5a075257c4f061d1ff4ff0821354)] | Critical | 3.10, 3.18 | Oct 12, 2016 |

## Common Questions and Answers

This section answers common questions that may occur after reading this
bulletin.

**1. How do I determine if my device is updated to address these issues?**

To learn how to check a device’s security patch level, read the instructions on the
[Pixel
and Nexus update schedule](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices).

* Security patch levels of 2016-11-01 or later address all issues associated
  with the 2016-11-01 security patch level.
* Security patch levels of 2016-11-05 or later address all issues associated
  with the 2016-11-05 security patch level and all previous patch levels.
* Security patch levels of 2016-11-06 or later address all issues associated
  with the 2016-11-06 security patch level and all previous patch
  levels.

Device manufacturers that include these updates should set the patch level
string to:

* [ro.build.version.security\_patch]:[2016-11-01]
* [ro.build.version.security\_patch]:[2016-11-05]
* [ro.build.version.security\_patch]:[2016-11-06].

**2. Why does this bulletin have three security patch levels?**

This bulletin has three security patch levels so that Android partners have the
flexibility to fix a subset of vulnerabilities that are similar across all
Android devices more quickly. Android partners are encouraged to fix all issues
in this bulletin and use the latest security patch level.

* Devices that use the November 1, 2016 security patch level must include all
  issues associated with that security patch level, as well as fixes for all
  issues reported in previous security bulletins.
* Devices that use the security patch level of November 5, 2016 or newer must
  include all applicable patches in this (and previous) security bulletins.
* Devices that use the security patch level of November 6, 2016 or newer must
  include all applicable patches in this (and previous) security
  bulletins.

Partners are encouraged to bundle the fixes for all issues they are addressing
in a single update.

**3. How do I determine which Google devices are affected by each
issue?**

In the
[2016-11-01](#2016-11-01-details),
[2016-11-05](#2016-11-05-details),
and
[2016-11-06](#2016-11-06-details)
security vulnerability details sections, each table has an *Updated Google
devices* column that covers the range of affected Google devices updated for
each issue. This column has a few options:

* **All Google devices**: If an issue affects all Nexus and Pixel
  devices, the table will have "All" in the *Updated Google devices*
  column. "All" encapsulates the following
  [supported
  devices](https://support.google.com/pixelphone/answer/4457705#pixel_phones&nexus_devices): Nexus 5, Nexus 5X, Nexus 6, Nexus 6P, Nexus 9,
  Android One, Nexus Player, Pixel C, Pixel, and Pixel XL.
* **Some Google devices**: If an issue doesn't affect all Google
  devices, the affected Google devices are listed in the *Updated Google
  devices* column.
* **No Google devices**: If no Google devices running Android 7.0
  are affected by the issue, the table will have "None" in the *Updated Google
  devices* column.

**4. What do the entries in the references column map to?**

Entries under the *References* column of the vulnerability details table
may contain a prefix identifying the organization to which the reference value
belongs. These prefixes map as follows:

| Prefix | Reference |
| --- | --- |
| A- | Android bug ID |
| QC- | Qualcomm reference number |
| M- | MediaTek reference number |
| N- | NVIDIA reference number |
| B- | Broadcom reference number |

## Revisions

* November 07, 2016: Bulletin published.
* November 08: Bulletin revised to include AOSP links and updated
  description for CVE-2016-6709.
* November 17: Bulletin revised to include attribution for CVE-2016-6828.
* December 21: Updated researcher credit.

Content and code samples on this page are subject to the licenses described in the [Content License](/license). Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.

Last updated 2024-08-26 UTC.

[[["Easy to understand","easyToUnderstand","thumb-up"],["Solved my problem","solvedMyProblem","thumb-up"],["Other","otherUp","thumb-up"]],[["Missing the information I need","missingTheInformationINeed","thumb-down"],["Too complicated / too many steps","tooComplicatedTooManySteps","thumb-down"],["Out of date","outOfDate","thumb-down"],["Samples / code issue","samplesCodeIssue","thumb-down"],["Other","otherDown","thumb-down"]],["Last updated 2024-08-26 UTC."],[],[]]

* ### Build

  + [Android repository](//android.googlesource.com)
  + [Requirements](/source/requirements)
  + [Downloading](/source/downloading)
  + [Preview binaries](//developers.google.com/android/blobs-preview/)
  + [Factory images](//developers.google.com/android/images/)
  + [Driver binaries](//developers.google.com/android/drivers/)
* ### Connect

  + [@Android on Twitter](//twitter.com/Android/)
  + [@AndroidDev on Twitter](//twitter.com/AndroidDev/)
  + [Android Blog](//blog.google/products/android/)
  + [Google Security Blog](//security.googleblog.com)
  + [Platform on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-platform/)
  + [Building on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-building/)
  + [Porting on Google Groups](//groups.google.com/forum/?fromgroups#!forum/android-porting/)
* ### Get help

  + [Android Help Center](//support.google.com/android/)
  + [Pixel Help Center](//support.google.com/pixelphone/)
  + [www.android.com](//www.android.com)
  + [Google Mobile Services](//www.android.com/gms/)
  + [Stack Overflow](//stackoverflow.com/questions/tagged/android-source/)
  + [Issue Tracker](//issuetracker.google.com/issues?q=status:open%20componentid:190923)

* [About Android](/source/)
* [Community](/source/community)
* [Legal](/legal)
* [License](/license)
* [Privacy](//policies.google.com/privacy)
* [Site feedback](//issuetracker.google.com/issues/new?component=191476)
* Manage cookies

* English
* Deutsch
* Español
* Español – América Latina
* Français
* Indonesia
* Italiano
* Polski
* Português
* Português – Brasil
* Tiếng Việt
* Türkçe
* Русский
* עברית
* العربيّة
* فارسی
* हिंदी
* বাংলা
* ภาษาไทย
* 中文 – 简体
* 中文 – 繁體
* 日本語
* 한국어


