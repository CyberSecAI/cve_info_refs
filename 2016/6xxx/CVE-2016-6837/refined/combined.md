=== Content from mantisbt.org_4f29cb1c_20250124_141453.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview.php%3Fid%3D21611)
[Signup for a new account](/bugs/signup_page.php)

#### View Issue Details

[Wiki](wiki.php?id=21611)[Related Changesets](#changesets)[Jump to Notes](#bugnotes)

|  | | | | | |
| --- | --- | --- | --- | --- | --- |
| ID | Project | Category | View Status | Date Submitted | Last Update |
| --- | --- | --- | --- | --- | --- |
| 0021611 | mantisbt | security | public | 2016-08-15 04:57 | 2016-08-28 01:12 |
|  | | | | | |
|
| Reporter | [wdollman](https://mantisbt.org/bugs/view_user_page.php?id=41203) | Assigned To | [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) |  | |
| Priority | normal | Severity | major | Reproducibility | always |
| Status | closed | Resolution | fixed |  | |
| Product Version | 1.2.0 |  | | | |
| Target Version | 1.3.1 | Fixed in Version | 1.3.1 |  | |
|  | | | | | |
|
| Summary | 0021611: CVE-2016-6837: XSS vulnerability in view\_all\_bug\_page.php | | | | |
| Description | The value of the view\_type parameter on the view\_all\_bug\_page.php page is not encoded before being displayed on the page.  For example, browsing to /view\_all\_bug\_page.php?view\_type=">injected-html results in the following HTML:  <input type="hidden" name="view\_type" value="">injected-html" />  This allows arbitrary JavaScript to be injected into the page, and affects the latest stable release (1.3.0). | | | | |
| Steps To Reproduce | This installation of Mantis is vulnerable to the issue, and runs with a Content-Security-Policy that allows inline JavaScript. Visiting the following URL in a browser with no cross-site scripting filter (e.g. Mozilla Firefox), or a browser with the cross-site scripting filter disabled, will trigger a JavaScript popup:  <http://mantisbt.org/bugs/view_all_bug_page.php?view_type>="><script>alert(1);</script>  A general example is /view\_all\_bug\_page.php?view\_type="><script>alert(1);</script> This proof-of-concept is blocked by the default Content-Security-Policy set by Mantis 1.3.0, though as shown above, some sites may have disabled or relaxed the default CSP. | | | | |
| Additional Information | If you request a CVE for this issue, please credit Will Dollman of Netcraft Ltd. | | | | |
| Tags | No tags attached. | | | | |
| Attached Files | [0001-Fix-XSS-in-view\_all\_bug\_page.php.patch](file_download.php?file_id=6836&type=bug) (1,293 bytes)    ``` From 421af1ed47a2b9a72c999876e6e17c7f621acb5f Mon Sep 17 00:00:00 2001 From: Damien Regad <dregad@mantisbt.org> Date: Tue, 16 Aug 2016 23:22:40 +0200 Subject: [PATCH] Fix XSS in view_all_bug_page.php  The value of the view_type parameter on the view_all_bug_page.php page was not encoded before being displayed.  This vulnerability was discovered by Will Dollman of Netcraft Ltd.  Fixes #21611 ---  core/filter_api.php | 6 ++++++  1 file changed, 6 insertions(+)  diff --git a/core/filter_api.php b/core/filter_api.php index c8e8eae..9294f64 100644 --- a/core/filter_api.php +++ b/core/filter_api.php @@ -489,9 +489,15 @@ function filter_ensure_valid_filter( array $p_filter_arr ) {  		# if the version is old, update it  		$p_filter_arr['_version'] = FILTER_VERSION;  	} + +	# Filter type - ensure it's either 'simple' or 'advanced' (prevent XSS)  	if( !isset( $p_filter_arr['_view_type'] ) ) {  		$p_filter_arr['_view_type'] = gpc_get_string( 'view_type', 'simple' );  	} +	if( $p_filter_arr['_view_type'] != 'advanced' ) { +		$p_filter_arr['_view_type'] = 'simple'; +	} +  	if( !isset( $p_filter_arr[FILTER_PROPERTY_ISSUES_PER_PAGE] ) ) {  		$p_filter_arr[FILTER_PROPERTY_ISSUES_PER_PAGE] = gpc_get_int( FILTER_PROPERTY_ISSUES_PER_PAGE, config_get( 'default_limit_view' ) );  	} --  2.7.4   ```   [0001-Fix-XSS-in-view\_all\_bug\_page.php.patch](file_download.php?file_id=6836&type=bug) (1,293 bytes)     [0001-Fix-XSS-in-view\_all\_bug\_page.php-safecmp.patch](file_download.php?file_id=6839&type=bug) (1,294 bytes)    ``` From 421af1ed47a2b9a72c999876e6e17c7f621acb5f Mon Sep 17 00:00:00 2001 From: Damien Regad <dregad@mantisbt.org> Date: Tue, 16 Aug 2016 23:22:40 +0200 Subject: [PATCH] Fix XSS in view_all_bug_page.php  The value of the view_type parameter on the view_all_bug_page.php page was not encoded before being displayed.  This vulnerability was discovered by Will Dollman of Netcraft Ltd.  Fixes #21611 ---  core/filter_api.php | 6 ++++++  1 file changed, 6 insertions(+)  diff --git a/core/filter_api.php b/core/filter_api.php index c8e8eae..9294f64 100644 --- a/core/filter_api.php +++ b/core/filter_api.php @@ -489,9 +489,15 @@ function filter_ensure_valid_filter( array $p_filter_arr ) {  		# if the version is old, update it  		$p_filter_arr['_version'] = FILTER_VERSION;  	} + +	# Filter type - ensure it's either 'simple' or 'advanced' (prevent XSS)  	if( !isset( $p_filter_arr['_view_type'] ) ) {  		$p_filter_arr['_view_type'] = gpc_get_string( 'view_type', 'simple' );  	} +	if( $p_filter_arr['_view_type'] !== 'advanced' ) { +		$p_filter_arr['_view_type'] = 'simple'; +	} +  	if( !isset( $p_filter_arr[FILTER_PROPERTY_ISSUES_PER_PAGE] ) ) {  		$p_filter_arr[FILTER_PROPERTY_ISSUES_PER_PAGE] = gpc_get_int( FILTER_PROPERTY_ISSUES_PER_PAGE, config_get( 'default_limit_view' ) );  	} --  2.7.4   ```   [0001-Fix-XSS-in-view\_all\_bug\_page.php-safecmp.patch](file_download.php?file_id=6839&type=bug) (1,294 bytes) | | | | |
|  | | | | | |
|

#### Relationships

[Relationship Graph](bug_relationship_graph.php?bug_id=21611&graph=relation)[Dependency Graph](bug_relationship_graph.php?bug_id=21611&graph=dependency)

| related to | [0021263](view.php?id=21263) | closed | [vboctor](https://mantisbt.org/bugs/view_user_page.php?id=3081) | CVE-2016-7111: Content Security Policy is weakened by Gravatar plugin |
| --- | --- | --- | --- | --- |

#### Activities

| [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)   [atrol](https://mantisbt.org/bugs/view_user_page.php?id=11111)  2016-08-15 06:03  developer    [~0053808](view.php?id=21611#c53808 "Direct link to note") | Changing line 2258 in file core/filter\_api.php should fix the issue   * <input type="hidden" name="view\_type" value="<?php echo $t\_view\_type?>" /> * <input type="hidden" name="view\_type" value="<?php echo 'advanced' == $t\_view\_type ? 'advanced' : 'simple'?>" /> |
| --- | --- |
|  | |
| [wdollman](https://mantisbt.org/bugs/view_user_page.php?id=41203)   [wdollman](https://mantisbt.org/bugs/view_user_page.php?id=41203)  2016-08-15 06:40  reporter    [~0053809](view.php?id=21611#c53809 "Direct link to note") | I've included our patch for the issue below. It sanitizes the variable in filter\_ensure\_valid\_filter(), so it's safe for display even if it's echoed elsewhere in a future change:  ```  core/filter_api.php | 5 +++++ ```  @@ -492,6 +492,11 @@ function filter\_ensure\_valid\_filter( array $p\_filter\_arr ) { if( !isset( $p\_filter\_arr['\_view\_type'] ) ) { $p\_filter\_arr['\_view\_type'] = gpc\_get\_string( 'view\_type', 'simple' ); } +   * if (!in\_array($p\_filter\_arr['\_view\_type'], array("simple", "advanced")) ) { * $p\_filter\_arr['\_view\_type'] = "simple"; * } * if( !isset( $p\_filter\_arr[FILTER\_PROPERTY\_ISSUES\_PER\_PAGE] ) ) {   $p\_filter\_arr[FILTER\_PROPERTY\_ISSUES\_PER\_PAGE] = gpc\_get\_int( FILTER\_PROPERTY\_ISSUES\_PER\_PAGE, config\_get( 'default\_limit\_view' ) );   } |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-15 09:22  developer    [~0053810](view.php?id=21611#c53810 "Direct link to note") | The issue actually exists (at least) since 1.2.0. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-16 17:54  developer    [~0053821](view.php?id=21611#c53821 "Direct link to note") | I believe the better solution is indeed to ensure that whatever value we store in the filter array is properly sanitized, to guarantee that any future use is safe.  Please see proposed patch attached. [@wdollman](https://mantisbt.org/bugs/view_user_page.php?id=41203) kindly confirm that this indeed fixes the issue; upon receiving your confirmation, I'll request a CVE.  Note: my fix improves the performance of the code proposed in [0021611:0053809](/bugs/view.php?id=21611#c53809 "0021611: [2016-08-15 06:40] wdollman"), as it does not rely on calling the in\_array() function. |
|  | |
| [wdollman](https://mantisbt.org/bugs/view_user_page.php?id=41203)   [wdollman](https://mantisbt.org/bugs/view_user_page.php?id=41203)  2016-08-17 05:03  reporter    [~0053832](view.php?id=21611#c53832 "Direct link to note") | I've attached an updated patch with a minor change which swaps the != comparison for a !==  If $p\_filter\_arr['\_view\_type'] were set to 0 (integer), PHP will cast "advanced" to an integer, bypassing the != check and we'd end up with a sanitized $p\_filter\_arr['\_view\_type'] value of 0. I don't see any way of triggering this - gpc\_get\_string() returns a string rather than an integer, and also don't see any way it could be exploited - but I don't like the check returning an unexpected value.  If you're ok with this updated patch, I'm happy that it resolves the issue and for you to request a CVE. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-17 09:13  developer    [~0053833](view.php?id=21611#c53833 "Direct link to note")  Last edited: 2016-08-17 09:16 | Thanks for the feedback Will.  I have no objections with your proposed use of the strict comparison operator, even though as you pointed out I don't think it's possible for gpc\_string() to return anything other than a string in this context, but it doesn't hurt. Belt and braces ;-)  I'll push the modified patch to Github now, and request the CVE later; I will update this issue when I receive the ID.  Note: the issue is now public |
|  | |
| [cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303)   [cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303)  2016-08-17 17:33  developer    [~0053835](view.php?id=21611#c53835 "Direct link to note") | I believe the better solution is indeed to ensure that whatever value we store in the filter array is properly sanitized, to guarantee that any future use is safe.  That is fine, but note that a filter array may not come only from previously stored filter. IIRC, a filter array may be provided as url parameters in some places, so validating again in "filter\_ensure\_valid\_filter" is still needed. |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-17 18:50  developer    [~0053836](view.php?id=21611#c53836 "Direct link to note") | validating again in "filter\_ensure\_valid\_filter" is still needed  You're confusing me. This is actually exactly where I've applied the patch... Did I miss something ? |
|  | |
| [cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303)   [cproensa](https://mantisbt.org/bugs/view_user_page.php?id=18303)  2016-08-17 19:01  developer    [~0053837](view.php?id=21611#c53837 "Direct link to note") | Did I miss something ?  Maybe i didn't explain right. As you said, the validation must to be done in "filter\_ensure\_valid\_filter".  As i read "I believe the better solution is indeed to ensure that whatever value we store in the filter array is properly sanitized": this is good, but not a replacement for said "filter\_ensure..." check |
|  | |
| [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)   [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784)  2016-08-18 02:44  developer    [~0053844](view.php?id=21611#c53844 "Direct link to note") | CVE-2016-6837 assigned. <http://www.openwall.com/lists/oss-security/2016/08/18/8> |
|  | |

#### Related Changesets

| MantisBT: master-1.3.x 7086c2d8  2016-08-16 13:22  [dregad](https://mantisbt.org/bugs/view_user_page.php?id=17784) [Details](/bugs/plugin.php?page=Source/view&id=22299) [Diff](https://github.com/mantisbt/mantisbt/commit/7086c2d8b4b20ac14013b36761ac04f0abf21a4e) | Fix XSS in view\_all\_bug\_page.php | | Affected Issues[0021611](/bugs/view.php?id=21611 "[closed] CVE-2016-6837: XSS vulnerability in view_all_bug_page.php") |
| --- | --- | --- | --- |
| mod - core/filter\_api.php | | [Diff](https://github.com/mantisbt/mantisbt/commit/7086c2d8b4b20ac14013b36761ac04f0abf21a4e) [File](https://github.com/mantisbt/mantisbt/blob/7086c2d8b4b20ac14013b36761ac04f0abf21a4e/core/filter_api.php) |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1677 seconds



=== Content from mantisbt.org_7b46b536_20250126_013007.html ===

Toggle sidebar [MantisBT](/bugs//) Toggle user menu

* mantisbt

  + - [All Projects](/bugs/set_project.php?project_id=0)
    - [mantisbt](/bugs/set_project.php?project_id=1)
    - [Mylyn Connector](/bugs/set_project.php?project_id=20)
    - [Plugin - agileMantis](/bugs/set_project.php?project_id=25)
    - [Plugin - CsvImport](/bugs/set_project.php?project_id=11)
    - [Plugin - CustomerManagement](/bugs/set_project.php?project_id=21)
    - [Plugin - EmailReporting](/bugs/set_project.php?project_id=10)
    - [Plugin - FilterPageEdit](/bugs/set_project.php?project_id=15)
    - [Plugin - InlineColumnConfiguration](/bugs/set_project.php?project_id=14)
    - [Plugin - LinkedCustomFields](/bugs/set_project.php?project_id=16)
    - [Plugin - MantisTouchRedirect](/bugs/set_project.php?project_id=22)
    - [Plugin - RecurrCall](/bugs/set_project.php?project_id=6)
    - [Plugin - RelatedIssuesExport](/bugs/set_project.php?project_id=13)
    - [Plugin - Reminder](/bugs/set_project.php?project_id=7)
    - [Plugin - Tasks](/bugs/set_project.php?project_id=8)
    - [Plugin - Time Tracking](/bugs/set_project.php?project_id=18)
* anonymous
  + [RSS](https://mantisbt.org/bugs/issues_rss.php)
  + [Logout](/bugs/logout_page.php)

* [My View](/bugs/my_view_page.php)
* [View Issues](/bugs/view_all_bug_page.php)
* [Change Log](/bugs/changelog_page.php)
* [Roadmap](/bugs/roadmap_page.php)
* [Wiki](/bugs/wiki.php?type=project&id=1)
* [Repositories](/bugs/plugin.php?page=Source/index)

* Anonymous
[Login](/bugs/login_page.php?return=%2Fbugs%2Fview_user_page.php%3Fid%3D17784)
[Signup for a new account](/bugs/signup_page.php)

#### User Information

| Username | dregad |
| --- | --- |

**Powered by [MantisBT 2.28.0-dev-master-f0c253853](https://www.mantisbt.org "bug tracking software")**

Copyright © 2000 - 2025 MantisBT Team
Contact administrator for assistance

[![Powered by Mantis Bug Tracker: a free and open source web based bug tracking system.](/bugs/images/mantis_logo.png)](https://www.mantisbt.org "Mantis Bug Tracker: a free and open source web based bug tracking system.")

 Page execution time: 0.1649 seconds



=== Content from github.com_0f17ca8f_20250126_013006.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F7086c2d8b4b20ac14013b36761ac04f0abf21a4e)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F7086c2d8b4b20ac14013b36761ac04f0abf21a4e)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=mantisbt%2Fmantisbt)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[mantisbt](/mantisbt)
/
**[mantisbt](/mantisbt/mantisbt)**
Public

* [Notifications](/login?return_to=%2Fmantisbt%2Fmantisbt) You must be signed in to change notification settings
* [Fork
  728](/login?return_to=%2Fmantisbt%2Fmantisbt)
* [Star
   1.7k](/login?return_to=%2Fmantisbt%2Fmantisbt)

* [Code](/mantisbt/mantisbt)
* [Pull requests
  80](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

Additional navigation options

* [Code](/mantisbt/mantisbt)
* [Pull requests](/mantisbt/mantisbt/pulls)
* [Actions](/mantisbt/mantisbt/actions)
* [Security](/mantisbt/mantisbt/security)
* [Insights](/mantisbt/mantisbt/pulse)

## Commit

[Permalink](/mantisbt/mantisbt/commit/7086c2d8b4b20ac14013b36761ac04f0abf21a4e)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix XSS in view\_all\_bug\_page.php

[Browse files](/mantisbt/mantisbt/tree/7086c2d8b4b20ac14013b36761ac04f0abf21a4e)
Browse the repository at this point in the history

```
The value of the view_type parameter on the view_all_bug_page.php page
was not encoded before being displayed.

This vulnerability was discovered by Will Dollman of Netcraft Ltd.

Initial patch modified to use strict comparison per Will's suggestion.

Fixes #21611
```

* Loading branch information

[![@dregad](https://avatars.githubusercontent.com/u/449891?s=40&v=4)](/dregad)

[dregad](/mantisbt/mantisbt/commits?author=dregad "View all commits by dregad")
committed
Aug 17, 2016

1 parent
[b66af6d](/mantisbt/mantisbt/commit/b66af6d2ed9883c04e71ef132a3b36837f91fc62)

commit 7086c2d

Showing
**1 changed file**
with
**6 additions**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[core/filter\_api.php](#diff-184c543668cedb4bce5a49727bb356c783df1b51e6bb8a7c2e55047650fbdb21 "core/filter_api.php")

Show comments

[View file](/mantisbt/mantisbt/blob/7086c2d8b4b20ac14013b36761ac04f0abf21a4e/core/filter_api.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -489,9 +489,15 @@ function filter\_ensure\_valid\_filter( array $p\_filter\_arr ) { |
|  |  | # if the version is old, update it |
|  |  | $p\_filter\_arr['\_version'] = FILTER\_VERSION; |
|  |  | } |
|  |  |  |
|  |  | # Filter view type - ensure it's either 'simple' or 'advanced' (prevent XSS) |
|  |  | if( !isset( $p\_filter\_arr['\_view\_type'] ) ) { |
|  |  | $p\_filter\_arr['\_view\_type'] = gpc\_get\_string( 'view\_type', 'simple' ); |
|  |  | } |
|  |  | if( $p\_filter\_arr['\_view\_type'] !== 'advanced' ) { |
|  |  | $p\_filter\_arr['\_view\_type'] = 'simple'; |
|  |  | } |
|  |  |  |
|  |  | if( !isset( $p\_filter\_arr[FILTER\_PROPERTY\_ISSUES\_PER\_PAGE] ) ) { |
|  |  | $p\_filter\_arr[FILTER\_PROPERTY\_ISSUES\_PER\_PAGE] = gpc\_get\_int( FILTER\_PROPERTY\_ISSUES\_PER\_PAGE, config\_get( 'default\_limit\_view' ) ); |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `7086c2d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmantisbt%2Fmantisbt%2Fcommit%2F7086c2d8b4b20ac14013b36761ac04f0abf21a4e) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


