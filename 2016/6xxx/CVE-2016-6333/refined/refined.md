```
{
  "related": true,
  "summary": "The vulnerability is caused by the lack of proper escaping of \"</style>\" within inline <style> tags when previewing user CSS pages, leading to a cross-site scripting (XSS) vulnerability. The preview mechanism was available to anonymous users, who have predictable CSRF tokens, making it exploitable via CSRF attacks as well. ",
  "details": {
    "root_cause": "The root cause of the vulnerability is the improper handling of the `</style>` sequence within inline CSS blocks. When previewing a user's CSS file (e.g., `Special:Mypage/common.css`), the content is included in an inline `<style>` tag without proper escaping, which allows an attacker to inject arbitrary HTML and JavaScript.",
    "vulnerabilities": [
      "Cross-site scripting (XSS): The primary vulnerability is the ability to inject arbitrary HTML and JavaScript via the user CSS preview feature.",
      "CSRF bypass: The preview mechanism was initially protected by a CSRF token, but this protection was insufficient for anonymous users due to their predictable tokens, allowing an attacker to perform actions on a user's behalf.",
       "The vulnerability could be exploited even when the user was logged into a different wiki instance via central auth, potentially allowing for a user's session to be compromised across multiple wiki instances."
    ],
    "impact": "An attacker can execute arbitrary JavaScript code in the context of the victim's browser when previewing a CSS page, potentially leading to session hijacking, data theft, or other malicious actions. The vulnerability could further be abused using central auth, allowing for cross-site scripting of any user.",
    "attack_vectors": [
      "Crafting malicious CSS content: An attacker injects malicious HTML and JavaScript within a CSS file using the sequence `/* ]]></style><script>(window.RLQ=window.RLQ||[]).push(function() {alert( \"Hello\" );</script><style>/*<![CDATA[*/`",
      "Cross-Site Request Forgery (CSRF): An attacker creates a form on a separate website that does a POST request to the target wiki to trigger the vulnerability by including the malicious CSS content. Because the edit token for anonymous users is predictable, it can be used in a CSRF attack.",
    ],
    "attacker_capabilities": "The attacker requires the ability to inject malicious CSS content and knowledge of the predictable token used by anonymous users.  The attacker needs to be able to make a POST request to the affected wiki using a crafted form.",
    "required_position": "The attacker can be external to the system and does not require any specific privileges or access besides the ability to submit malicious content to the wiki and to host an external website to trigger a CSRF attack.  The vulnerability was present when previewing the CSS page without being logged in, thus requiring no authentication or any elevated access."
  }
}
```