```
{
  "cveId": "CVE-2016-6772",
  "date": "2016-12-20",
  "description": "An elevation of privilege vulnerability in Wi-Fi could enable a local malicious application to execute arbitrary code within the context of a privileged process.",
  "vulnerabilityDetails": {
    "rootCause": "The `android_net_wifi_setHotlist` function in `com_android_server_wifi_WifiNative.cpp` does not validate the `params.num_bssid` parameter before copying that number of elements into a stack-allocated `wifi_bssid_hotlist_params` structure. If `num_bssid` is greater than the size of the allocated structure, a stack buffer overflow can occur.",
    "weaknesses": [
      "Stack buffer overflow due to lack of input validation"
    ],
    "impact": "Arbitrary code execution within the context of a privileged process",
    "attackVectors": [
      "A local malicious application with `system_api_service` access or a compromised platform app can trigger the vulnerability by sending a large `num_bssid` value via JNI calls"
    ],
    "requiredCapabilities": [
      "Compromised platform app with `system_api_service` access, or lower privileged system services such as bluetooth or NFC"
    ]
  },
  "additionalInformation": {
    "fix": "Fixed in Android Security Bulletinâ€”December 2016, with the patch level of 2016-12-01. The fix validates the `params.num_bssid` against the `MAX_HOTLIST_APS` before copying into the stack buffer.",
      "poc": "A proof of concept (POC) exists which shows the crash before function return due to stack corruption."
  }
}
```