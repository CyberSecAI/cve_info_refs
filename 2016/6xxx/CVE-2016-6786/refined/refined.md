```json
{
  "CVE-2016-6786": {
    "related": true,
    "summary": "The Linux kernel's perf subsystem lacks proper locking around changes to `perf_event::ctx`, potentially leading to privilege escalation.",
    "details": [
      {
        "type": "Root cause",
        "text": "Lack of mutex locking around the `perf_event::ctx` variable when it is being changed."
      },
      {
         "type": "Weaknesses",
        "text": "Race condition due to concurrent modification of `perf_event::ctx` without proper synchronization mechanisms."
      },
      {
        "type": "Impact",
        "text": "Potential privilege escalation. A local attacker may be able to execute arbitrary code within the context of the kernel."
      },
      {
        "type": "Attack vector",
        "text": "Local exploitation by a malicious user or application using the perf subsystem."
      },
      {
        "type": "Required capabilities",
          "text": "Ability to create and manage performance events through the perf subsystem."
      },
      {
        "type": "Additional details",
        "text": "The vulnerability arises due to the lack of locking when migrating performance events between contexts. The fix involves using `perf_event_ctx_lock()` and `perf_event_ctx_unlock()` to safely acquire and release locks when accessing the `event->ctx`."
      },
       {
        "type": "Additional details",
        "text": "The fix includes a new `perf_event_ctx_lock` function, which uses `rcu_read_lock` and `atomic_inc_not_zero` to increment the reference counter of the `perf_event_context` and a mutex lock. This ensures that when `event->ctx` changes, the necessary locks are acquired before accessing the context. Correspondingly, there's a `perf_event_ctx_unlock` to release the lock and decrement the reference count."
      }
    ]
  }
}
```