```
{
  "CVE-2016-3120": {
    "description": "The validate_as_request function in kdc_util.c in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) before 1.13.6 and 1.4.x before 1.14.3, when restrict_anonymous_to_tgt is enabled, uses an incorrect client data structure, which allows remote authenticated users to cause a denial of service (NULL pointer dereference and daemon crash) via an S4U2Self request.",
    "vulnerability_details": {
      "root_cause": "The `validate_as_request` function in `kdc_util.c` uses `request->client` instead of `client.princ` when checking for anonymous access restrictions during an S4U2Self request. The `request->client` is NULL in this scenario, leading to a NULL pointer dereference.",
      "weaknesses": [
        "NULL pointer dereference"
      ],
      "impact": "Denial of service (daemon crash)",
      "attack_vectors": [
        "Network"
      ],
      "attacker_capabilities": "Authenticated attacker capable of making an S4U2Self request. Attacker must be able to send network requests to the KDC and have a valid kerberos account with the `requires_preauth` flag disabled."
    },
    "affected_versions": [
      "krb5 before 1.13.6",
      "krb5 1.4.x before 1.14.3"
    ],
      "patch_information": {
      "commits":[
        "https://github.com/krb5/krb5/commit/93b4a6306a0026cf1cc31ac4bd8a49ba5d034ba7",
          ],
      "fixes":[
         "The fix involves using `client.princ` instead of `request->client` in the `validate_as_request` function when checking anonymous access restrictions."
        ]
     }
  }
}
```