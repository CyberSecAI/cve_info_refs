=== Content from security.gentoo.org_536109de_20250125_204755.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# libTIFF: Multiple vulnerabilities — GLSA **201701-16**

Multiple vulnerabilities have been found in libTIFF, the worst of
which may allow execution of arbitrary code.

### Affected packages

| Package | **media-libs/tiff** on all architectures |
| --- | --- |
| Affected versions | < **4.0.7** |
| Unaffected versions | >= **4.0.7** |

### Background

The TIFF library contains encoding and decoding routines for the Tag
Image File Format. It is called by numerous programs, including GNOME and
KDE applications, to interpret TIFF images.

### Description

Multiple vulnerabilities have been discovered in libTIFF. Please review
the CVE identifier and bug reports referenced for details.

### Impact

A remote attacker could entice a user to process a specially crafted
image file, possibly resulting in execution of arbitrary code with the
privileges of the process or a Denial of Service condition.

### Workaround

There is no known workaround at this time.

### Resolution

All libTIFF users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=media-libs/tiff-4.0.7"

```
### References

* [CVE-2013-4243](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2013-4243)
* [CVE-2014-8127](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8127)
* [CVE-2014-8128](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8128)
* [CVE-2014-8129](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8129)
* [CVE-2014-8130](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-8130)
* [CVE-2014-9330](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-9330)
* [CVE-2014-9655](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2014-9655)
* [CVE-2015-1547](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-1547)
* [CVE-2015-7313](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7313)
* [CVE-2015-7554](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-7554)
* [CVE-2015-8665](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8665)
* [CVE-2015-8668](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8668)
* [CVE-2015-8683](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8683)
* [CVE-2015-8781](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8781)
* [CVE-2015-8782](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8782)
* [CVE-2015-8783](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8783)
* [CVE-2015-8784](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2015-8784)
* [CVE-2016-3186](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3186)
* [CVE-2016-3619](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3619)
* [CVE-2016-3620](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3620)
* [CVE-2016-3621](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3621)
* [CVE-2016-3622](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3622)
* [CVE-2016-3623](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3623)
* [CVE-2016-3624](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3624)
* [CVE-2016-3625](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3625)
* [CVE-2016-3631](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3631)
* [CVE-2016-3632](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3632)
* [CVE-2016-3633](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3633)
* [CVE-2016-3634](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3634)
* [CVE-2016-3658](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3658)
* [CVE-2016-3945](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3945)
* [CVE-2016-3990](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3990)
* [CVE-2016-3991](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-3991)
* [CVE-2016-5102](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5102)
* [CVE-2016-5314](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5314)
* [CVE-2016-5315](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5315)
* [CVE-2016-5316](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5316)
* [CVE-2016-5317](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5317)
* [CVE-2016-5318](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5318)
* [CVE-2016-5319](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5319)
* [CVE-2016-5320](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5320)
* [CVE-2016-5321](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5321)
* [CVE-2016-5322](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5322)
* [CVE-2016-5323](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5323)
* [CVE-2016-5652](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5652)
* [CVE-2016-5875](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-5875)
* [CVE-2016-6223](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-6223)
* [CVE-2016-8331](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-8331)
* [CVE-2016-9273](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9273)
* [CVE-2016-9297](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9297)
* [CVE-2016-9448](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9448)
* [CVE-2016-9453](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9453)
* [CVE-2016-9532](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9532)

**Release date**

January 09, 2017

**Latest revision**

January 09, 2017: 2

**Severity**

normal

**Exploitable**

remote

**Bugzilla entries**

* [484542](https://bugs.gentoo.org/show_bug.cgi?id=484542)
* [534108](https://bugs.gentoo.org/show_bug.cgi?id=534108)
* [538318](https://bugs.gentoo.org/show_bug.cgi?id=538318)
* [561880](https://bugs.gentoo.org/show_bug.cgi?id=561880)
* [572876](https://bugs.gentoo.org/show_bug.cgi?id=572876)
* [585274](https://bugs.gentoo.org/show_bug.cgi?id=585274)
* [585508](https://bugs.gentoo.org/show_bug.cgi?id=585508)
* [599746](https://bugs.gentoo.org/show_bug.cgi?id=599746)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.maptools.org_9ddad34d_20250125_204754.html ===


|  |
| --- |

* [Home](./)
* | [New](enter_bug.cgi)
* | [Search](query.cgi)
* |
* | [Reports](report.cgi)
* | [New Account](createaccount.cgi)
* |
  [Help](docs/en/html/bug_page.html)
* | [Log In](http://bugzilla.maptools.org/show_bug.cgi?id=2565&GoAheadAndLogIn=1)

*First*
*Last*
*Prev*
*Next*

*No search results available*

[**Bug 2565**](show_bug.cgi?id=2565) -
CVE-2016-3621: libtiff: Out-of-bounds Read in the bmp2tiff tool

| Summary: | CVE-2016-3621: libtiff: Out-of-bounds Read in the bmp2tiff tool |
| --- | --- |

| | **[Status](page.cgi?id=fields.html#status)**: | RESOLVED WONTFIX | | --- | --- | |  | | | **Product**: | libtiff | | **[Component](describecomponents.cgi?product=libtiff):** | default | | **Version**: | unspecified | | **Platform**: | PC Linux | |  | | | **[Importance](page.cgi?id=fields.html#importance)**: | P1 critical | | **Target Milestone**: | --- | | **[Assigned To](page.cgi?id=fields.html#assigned_to)**: | Frank Warmerdam | |  | | | **[URL](http://www.openwall.com/lists/oss-security/2016/04/07/3)**: | [http://www.openwall.com/lists/oss-sec...](http://www.openwall.com/lists/oss-security/2016/04/07/3) | | **Whiteboard**: |  | | | **[Keywords](describekeywords.cgi)**: |  | | |  | | | Depends on: |  | | Blocks: |  ||  | Show dependency [tree](showdependencytree.cgi?id=2565&hide_resolved=1) / [graph](showdependencygraph.cgi?id=2565) | | |  | | **Reported**: | 2016-06-27 02:25 by Henri Salo | | --- | --- | | **Modified**: | 2016-08-15 16:11 ([History](show_activity.cgi?id=2565)) | |  | | |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| Attachments | |
| --- | --- |
| [Add an attachment](attachment.cgi?bugid=2565&action=enter) (proposed patch, testcase, etc.) | |

| Note You need to [log in](show_bug.cgi?id=2565&GoAheadAndLogIn=1) before you can comment on or make changes to this bug.   ---   *[Description](show_bug.cgi?id=2565#c0) From Henri Salo  2016-06-27 02:25:35* ``` Original advisory below:  Affected Versions: <= 4.0.6 Vulnerability Type: Out-of-bounds Read CVE ID: CVE-2016-3621 Credit: Mei Wang of the Cloud Security Team, Qihoo 360  Introduction ============  LZWEncode function in tif_lzw.c in bmp2tiff allows attackers to cause a denial of service (Out-of-bounds Read) via a crafted bmp image with param -c lzw.   libtiff-master/libtiff/tif_lzw.c:915  910  */ 911 PutNextCode(op, CODE_CLEAR); 912 ent = *bp++; cc--; incount++; 913 } 914 while (cc > 0) { 915 c = *bp++; cc--; incount++; 916 fcode = ((long)c << BITS_MAX) + ent; 917 h = (c << HSHIFT) ^ ent; /* xor hashing */   ./bmp2tiff  -c lzw  ./sample/bmp2tiff_lzw.bmp 1.tif  ================================================================= ==10455== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fbcd06d1c00 at pc 0x4827aa bp 0x7ffef81741d0 sp 0x7ffef81741c0 READ of size 1 at 0x7fbcd06d1c00 thread T0     #0 0x4827a9 in LZWEncode /home/dazhuang/asan/libtiff-master/libtiff/tif_lzw.c:915     #1 0x45665e in TIFFWriteScanline /home/dazhuang/asan/libtiff-master/libtiff/tif_write.c:173     #2 0x40450f in main /home/dazhuang/asan/libtiff-master/tools/bmp2tiff.c:775     #3 0x7fbcccc92af4 in __libc_start_main (/lib64/libc.so.6+0x21af4)     #4 0x4019a8 in _start (/home/dazhuang/asan/libtiff-master/tools/bmp2tiff+0x4019a8) 0x7fbcd06d1c00 is located 0 bytes to the right of 1573888-byte region [0x7fbcd0551800,0x7fbcd06d1c00) allocated by thread T0 here:     #0 0x7fbccd563129 (/lib64/libasan.so.0+0x16129)     #1 0x45b761 in _TIFFmalloc /home/dazhuang/asan/libtiff-master/libtiff/tif_unix.c:316     #2 0x4037c3 in main /home/dazhuang/asan/libtiff-master/tools/bmp2tiff.c:678     #3 0x7fbcccc92af4 in __libc_start_main (/lib64/libc.so.6+0x21af4) SUMMARY: AddressSanitizer: heap-buffer-overflow /home/dazhuang/asan/libtiff-master/libtiff/tif_lzw.c:915 LZWEncode Shadow bytes around the buggy address:   0x0ff81a0d2330: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0ff81a0d2340: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0ff81a0d2350: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0ff81a0d2360: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   0x0ff81a0d2370: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 =>0x0ff81a0d2380:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0ff81a0d2390: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0ff81a0d23a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0ff81a0d23b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0ff81a0d23c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa   0x0ff81a0d23d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa Shadow byte legend (one shadow byte represents 8 application bytes):   Addressable:           00   Partially addressable: 01 02 03 04 05 06 07   Heap left redzone:     fa   Heap righ redzone:     fb   Freed Heap region:     fd   Stack left redzone:    f1   Stack mid redzone:     f2   Stack right redzone:   f3   Stack partial redzone: f4   Stack after return:    f5   Stack use after scope: f8   Global redzone:        f9   Global init order:     f6   Poisoned by user:      f7   ASan internal:         fe ==10455== ABORTING ```  ------- *Comment [#1](show_bug.cgi?id=2565#c1) From Even Rouault  2016-08-15 16:11:48* ------- ``` Closing as wontfix since bmp2tiff has been removed from libtiff ``` |
| --- |

---

* [Format For Printing](show_bug.cgi?format=multiple&id=2565)
* - [XML](show_bug.cgi?ctype=xml&id=2565)
* - [Clone This Bug](enter_bug.cgi?cloned_bug_id=2565)
* - Top of page

*First*
*Last*
*Prev*
*Next*

*No search results available*

* Actions:
  + [Home](./)
  + | [New](enter_bug.cgi)
  + | [Search](query.cgi)
  + |
  + | [Reports](report.cgi)
  + | [New Account](createaccount.cgi)
  + |
    [Help](docs/en/html/bug_page.html)
  + | [Log In](http://bugzilla.maptools.org/show_bug.cgi?id=2565&GoAheadAndLogIn=1)



=== Content from www.openwall.com_a8b9c5a5_20250125_204754.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <BD973AA6-4933-4527-951F-0AEE2273D2C3@360.cn>
Date: Thu, 7 Apr 2016 07:39:43 +0000
From: 王梅 <wangmei@....cn>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: CVE-2016-3621 libtiff: Out-of-bounds Read in the bmp2tiff tool

Details
=======

Product: libtiff
Affected Versions: <= 4.0.6
Vulnerability Type: Out-of-bounds Read
Vendor URL: <http://www.libtiff.org/>
CVE ID: CVE-2016-3621
Credit: Mei Wang of the Cloud Security Team, Qihoo 360

Introduction
============

LZWEncode function in tif_lzw.c in bmp2tiff allows attackers to cause a denial of service (Out-of-bounds Read) via a crafted bmp image with param -c lzw.

libtiff-master/libtiff/tif_lzw.c:915

910  */
911 PutNextCode(op, CODE_CLEAR);
912 ent = *bp++; cc--; incount++;
913 }
914 while (cc > 0) {
915 c = *bp++; cc--; incount++;
916 fcode = ((long)c << BITS_MAX) + ent;
917 h = (c << HSHIFT) ^ ent; /* xor hashing */

./bmp2tiff  -c lzw  ./sample/bmp2tiff_lzw.bmp 1.tif

=================================================================
==10455== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x7fbcd06d1c00 at pc 0x4827aa bp 0x7ffef81741d0 sp 0x7ffef81741c0
READ of size 1 at 0x7fbcd06d1c00 thread T0
    #0 0x4827a9 in LZWEncode /home/dazhuang/asan/libtiff-master/libtiff/tif_lzw.c:915
    #1 0x45665e in TIFFWriteScanline /home/dazhuang/asan/libtiff-master/libtiff/tif_write.c:173
    #2 0x40450f in main /home/dazhuang/asan/libtiff-master/tools/bmp2tiff.c:775
    #3 0x7fbcccc92af4 in __libc_start_main (/lib64/libc.so.6+0x21af4)
    #4 0x4019a8 in _start (/home/dazhuang/asan/libtiff-master/tools/bmp2tiff+0x4019a8)
0x7fbcd06d1c00 is located 0 bytes to the right of 1573888-byte region [0x7fbcd0551800,0x7fbcd06d1c00)
allocated by thread T0 here:
    #0 0x7fbccd563129 (/lib64/libasan.so.0+0x16129)
    #1 0x45b761 in _TIFFmalloc /home/dazhuang/asan/libtiff-master/libtiff/tif_unix.c:316
    #2 0x4037c3 in main /home/dazhuang/asan/libtiff-master/tools/bmp2tiff.c:678
    #3 0x7fbcccc92af4 in __libc_start_main (/lib64/libc.so.6+0x21af4)
SUMMARY: AddressSanitizer: heap-buffer-overflow /home/dazhuang/asan/libtiff-master/libtiff/tif_lzw.c:915 LZWEncode
Shadow bytes around the buggy address:
  0x0ff81a0d2330: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff81a0d2340: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff81a0d2350: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff81a0d2360: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
  0x0ff81a0d2370: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
=>0x0ff81a0d2380:[fa]fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff81a0d2390: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff81a0d23a0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff81a0d23b0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff81a0d23c0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
  0x0ff81a0d23d0: fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa fa
Shadow byte legend (one shadow byte represents 8 application bytes):
  Addressable:           00
  Partially addressable: 01 02 03 04 05 06 07
  Heap left redzone:     fa
  Heap righ redzone:     fb
  Freed Heap region:     fd
  Stack left redzone:    f1
  Stack mid redzone:     f2
  Stack right redzone:   f3
  Stack partial redzone: f4
  Stack after return:    f5
  Stack use after scope: f8
  Global redzone:        f9
  Global init order:     f6
  Poisoned by user:      f7
  ASan internal:         fe
==10455== ABORTING

References:
[1] <http://www.remotesensing.org/libtiff/>
[2] <http://bugzilla.maptools.org/buglist.cgi?product=libtiff>

Thank you!
Best Regards,

Mei

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


