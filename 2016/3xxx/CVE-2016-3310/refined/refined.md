Based on the provided content, here's a breakdown of CVE-2016-3310:

**Root Cause of Vulnerability:**
The vulnerability stems from the Windows kernel-mode driver's improper handling of objects in memory, specifically surface (bitmap) objects within the Graphics Device Interface (GDI). The root cause is a use-after-free condition related to the freeing of surface objects by user-mode callbacks.

**Weaknesses/Vulnerabilities Present:**
- **Use-After-Free (UAF):** The core issue is that a surface object is freed, and then later accessed. This occurs because of an invalid GDI object passed to a GDI printing function triggering an exception and a series of callbacks.
- **Inadequate Object Handling:** The Windows kernel-mode driver does not correctly manage the lifecycle of GDI objects in memory. Specifically, it fails to prevent the freeing of a surface object while it might still be referenced.
- **Exploitable User-Mode Callbacks:** The vulnerability exploits how user-mode callbacks are used within the GDI subsystem. By manipulating the state of a printer DC and surface object, the attacker can trigger a sequence of operations to free a surface object at an arbitrary time of their choice, and later dereference it.
- **Weak security fix:** The initial fix in CVE-2015-6100 for a similar vulnerability was to validate GDI object handles for printing functions to prevent the user-mode exception that led to the UAF. However, this validation was bypassed by another user-mode callback leading to the described use-after-free.

**Impact of Exploitation:**
- **Elevation of Privilege:** Successful exploitation allows an attacker to run arbitrary code in kernel mode, effectively gaining complete control of the affected system.
- **System Compromise:** An attacker with kernel-mode access can install programs, view/change/delete data, and create new accounts with full user rights, which can lead to a complete takeover of the machine.

**Attack Vectors:**
1.  **Initial Access:** The attacker must first log on to the system.
2.  **Crafted Application:** The attacker runs a specially crafted application that interacts with the GDI subsystem.
3.  **Triggering UAF:** The crafted application manipulates the GDI functions by:
    *   Creating a printer device context (DC).
    *   Starting a print job.
    *   Using `win32k!NtGdiMakeInfoDC` to store a surface object pointer in memory.
    *   Hooking `user32!__ClientPrinterThunk`. The hook handler calls `win32k!NtGdiMakeInfoDC` to restore the surface object pointer.
    *   Calling `win32k!NtGdiEndDoc`, which triggers the user mode callbacks that ultimately lead to disabling the surface object.
    *   Using the `gdi32!DeleteObject` API function to free the disabled surface object.
4.  **Dereferencing the Freed Object:** The attacker then makes a GDI printing function call that dereferences the freed surface object, triggering the use-after-free condition.

**Required Attacker Capabilities/Position:**
- **Local Access:** The attacker must have the ability to log on to the system.
- **Ability to Run Programs:** The attacker needs to be able to execute a custom application on the targeted machine.
- **Knowledge of GDI Internals:** A relatively deep understanding of the Windows GDI subsystem and its user-mode callback mechanisms is needed to create the exploit application.