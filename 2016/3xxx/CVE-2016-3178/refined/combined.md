=== Content from bugs.debian.org_4d77b7a9_20250125_181144.html ===

# Debian Bug report logs - #816759 minissdpd: CVE-2016-3178 CVE-2016-3179

[![version graph](version.cgi?fixed=1.1.20120121-1%2Bdeb7u1;fixed=minissdpd%2F1.2.20130907-3.2;fixed=minissdpd%2F1.2.20130907-3%2Bdeb8u1;package=minissdpd;absolute=0;height=2;collapse=1;found=minissdpd%2F1.1.20120121-1;found=minissdpd%2F1.2.20130907-3;width=2)](version.cgi?info=1;fixed=1.1.20120121-1%2Bdeb7u1;fixed=minissdpd%2F1.2.20130907-3.2;fixed=minissdpd%2F1.2.20130907-3%2Bdeb8u1;absolute=0;package=minissdpd;found=minissdpd%2F1.1.20120121-1;found=minissdpd%2F1.2.20130907-3;collapse=1)

Package:
[minissdpd](pkgreport.cgi?package=minissdpd);
Maintainer for [minissdpd](pkgreport.cgi?package=minissdpd) is [Thomas Goirand <zigo@debian.org>](pkgreport.cgi?maint=zigo%40debian.org); Source for [minissdpd](pkgreport.cgi?package=minissdpd) is [src:minissdpd](pkgreport.cgi?src=minissdpd) ([PTS](https://tracker.debian.org/pkg/minissdpd), [buildd](https://buildd.debian.org/minissdpd), [popcon](https://qa.debian.org/popcon.php?package=minissdpd)).

Reported by: [Salva Peiró <speirofr@gmail.com>](pkgreport.cgi?submitter=speirofr%40gmail.com)

Date: Fri, 4 Mar 2016 22:24:01 UTC

Severity: *grave*

Tags: patch, security

Found in versions minissdpd/1.1.20120121-1, minissdpd/1.2.20130907-3

Fixed in versions 1.1.20120121-1+deb7u1, minissdpd/1.2.20130907-3.2, minissdpd/1.2.20130907-3+deb8u1

**Done:** James Cowgill <jcowgill@debian.org>

Bug is archived. No further changes may be made.

Display info messages

View this report as an [mbox folder](bugreport.cgi?bug=816759;mbox=yes), [status mbox](bugreport.cgi?bug=816759;mbox=yes;mboxstatus=yes), [maintainer mbox](bugreport.cgi?bug=816759;mbox=yes;mboxmaint=yes)

---

**Report forwarded**
to `debian-bugs-dist@lists.debian.org, Thomas Goirand <zigo@debian.org>`:

`Bug#816759`; Package `minissdpd`.
(Fri, 04 Mar 2016 22:24:05 GMT) ([full text](bugreport.cgi?bug=816759;msg=2), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=2), [link](#1)).

---

**Acknowledgement sent**
to `Salva Peiró <speirofr@gmail.com>`:

New Bug report received and forwarded. Copy sent to `Thomas Goirand <zigo@debian.org>`.
(Fri, 04 Mar 2016 22:24:05 GMT) ([full text](bugreport.cgi?bug=816759;msg=4), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=4), [link](#3)).

---

[Message #5](#5) received at submit@bugs.debian.org ([full text](bugreport.cgi?bug=816759;msg=5), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=5), reply):

![](/cgi-bin/libravatar.cgi?email=speirofr%40gmail.com)
From: Salva Peiró <speirofr@gmail.com>
To: submit@bugs.debian.org
Subject: minissdpd: The minissdpd daemon is affected by an improper validation
of array index vulnerability
Date: Fri, 4 Mar 2016 23:21:21 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=816759;msg=5) (text/plain, inline)]
```
```
Package: minissdpd
Version: 1.2.20130907-3
Justification: renders package unusable
Severity: grave
Tags: security patch

Dear Maintainer,

The following bug report provides the technical description and bug fixes
and has been extracted from the detailed security advisory
at <http://speirofr.appspot.com/files/advisory/SPADV-2016-02.md>

Best,

Vulnerability details
=====================

The minissdpd daemon (version: 1.2.20130907-3) contains a
improper validation of array index vulnerability (CWE-129)
when processing requests sent to the Unix socket at /var/run/minissdpd.sock
the Unix socket can be accessed by an unprivileged user to send invalid
request causes an out-of-bounds memory access that crashes the minissdpd
daemon.

Technical Details
=================

The vulnerability can be triggered by a local unprivileged user performs
the following request:

$ echo -en '\x04\x01\x60\x8f\xff\xff\xff\x7f\x0a' | nc.openbsd -U
/var/run/minissdpd.sock

The request is processed by the processRequest() function at minissdpd.c
which identifies the request of type=4, and performs the parsing of the
"new service" request, the decoding of the length of the usn field
performed at
line 663, sets l = 0xffffffff, with p = buf+4, and n = 9, the negative
length
l=-1 passes the check at line 664 with (buf+4-1) < (buf + 9), continuing
with
the allocation of the usn field at line 673, that initialises newserv->usn =
malloc(0), where in the case of Linux malloc(3) the allocator returns a
pointer
that can be later passed to free().  The line 668 attempts to copy
0xffffffff
bytes from the message pointer p to newserv->usn, that causes the daemon to
perform an out-of-bound memory access writing outside the allocated buffer.

~~~
663         DECODELENGTH_CHECKLIMIT(l, p, buf + n);
664         if(p+l > buf+n) {
665             syslog(LOG_WARNING, "bad request (length encoding)");
666             goto error;
667         }
...
673         newserv->usn = malloc(l + 1);
674         if(!newserv->usn) {
675             syslog(LOG_ERR, "cannot allocate memory");
676             goto error;
677         }
668         memcpy(newserv->usn, p, l);
~~~

The problem is the incorrect validation on the length returned by the
DECODELENGTH_CHECKLIMIT macro at line 664, that does not consider negative
length values. The fix of the length has already been applied to the
upstream
minissdpd repository see [2], the bug happens at multiple locations after
the
DECODELENGTH_CHECKLIMIT macro that also need to be fixed:

~~~
          DECODELENGTH_CHECKLIMIT(l, p, buf + n);
-         if(p+l > buf+n) {
+         if(l > (unsigned)(buf+n-p)) {
             syslog(LOG_ERR, "cannot allocate memory");
             goto error;
          }
~~~

After performing the corrections of the length check the minissdpd daemon
properly detects the invalid negative values and performs error handling.
However, the error handling code at line 753 attempts to free the undefined
memory contents that newserv = malloc() allocated at line 642.

~~~
753     if(newserv) {
754         free(newserv->st);
755         free(newserv->usn);
756         free(newserv->server);
757         free(newserv->location);
758         free(newserv);
759         newserv = NULL;
760     }
~~~

The issue is corrected by applying initialising the contents of the newserv
to zero [3].
That causes free() to correctly operate when freeing the uninitialised
struct fields.

~~~
642         newserv = malloc(sizeof(struct service));
643         if(!newserv) {
644             syslog(LOG_ERR, "cannot allocate memory");
645             goto error;
646         }
+               memset(newserv, 0, sizeof(struct service));
~~~

Solution
========

Apply the proposed fixes, contained in the patch below.

~~~
From 2f6746a0c00872b977cc81452d77463aa39609e7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Salva=20Peir=C3=B3?= <speirofr@gmail.com>
Date: Fri, 4 Mar 2016 12:38:18 +0100
Subject: [PATCH] Fix minissdpd.c handling of request with negative length

---
 minissdpd.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/minissdpd.c b/minissdpd.c
index 520a6c5..1cd079e 100644
--- a/minissdpd.c
+++ b/minissdpd.c
@@ -555,7 +555,7 @@ void processRequest(struct reqelem * req)
    type = buf[0];
    p = buf + 1;
    DECODELENGTH_CHECKLIMIT(l, p, buf + n);
-       if(p+l > buf+n) {
+       if(l > (unsigned)(buf+n-p)) {
        syslog(LOG_WARNING, "bad request (length encoding)");
        goto error;
    }
@@ -644,6 +644,7 @@ void processRequest(struct reqelem * req)
            syslog(LOG_ERR, "cannot allocate memory");
            goto error;
        }
+               memset(newserv, 0, sizeof(struct service));
        if(containsForbiddenChars(p, l)) {
            syslog(LOG_ERR, "bad request (st contains forbidden chars)");
            goto error;
@@ -661,7 +662,7 @@ void processRequest(struct reqelem * req)
            goto error;
        }
        DECODELENGTH_CHECKLIMIT(l, p, buf + n);
-               if(p+l > buf+n) {
+               if(l > (unsigned)(buf+n-p)) {
            syslog(LOG_WARNING, "bad request (length encoding)");
            goto error;
        }
@@ -679,7 +680,7 @@ void processRequest(struct reqelem * req)
        newserv->usn[l] = '\0';
        p += l;
        DECODELENGTH_CHECKLIMIT(l, p, buf + n);
-               if(p+l > buf+n) {
+               if(l > (unsigned)(buf+n-p)) {
            syslog(LOG_WARNING, "bad request (length encoding)");
            goto error;
        }
@@ -697,7 +698,7 @@ void processRequest(struct reqelem * req)
        newserv->server[l] = '\0';
        p += l;
        DECODELENGTH_CHECKLIMIT(l, p, buf + n);
-               if(p+l > buf+n) {
+               if(l > (unsigned)(buf+n-p)) {
            syslog(LOG_WARNING, "bad request (length encoding)");
            goto error;
        }
--
2.1.4
~~~

Affected versions
=================

Debian: <https://packages.debian.org/jessie/minissdpd>
minissdpd version 1.2.20130907-3

Ubuntu: [https://launchpad.net/ubuntu/+source/minissdpd](https://launchpad.net/ubuntu/%2Bsource/minissdpd)
minissdpd version 1.2.20130907-3

History
=======

  2016/03/04 - Vendor notified

Credits
=======

  Vulnerability found and advisory written by Salva Peiró.

References
==========

 [1] <https://speirofr.appspot.com/files/advisory/SPADV-2016-02.md>
 [2]
<https://github.com/miniupnp/miniupnp/commit/b238cade9a173c6f751a34acf8ccff838a62aa47>
 [3]
<https://github.com/miniupnp/miniupnp/commit/140ee8d2204b383279f854802b27bdb41c1d5d1a>

-- System Information:
Debian Release: 8.2
  APT prefers stable
  APT policy: (500, 'stable')
Architecture: i386 (i686)

Kernel: Linux 3.16.0-4-686-pae (SMP w/1 CPU core)
Locale: LANG=en_US.UTF-8, LC_CTYPE=en_US.UTF-8 (charmap=UTF-8)
Shell: /bin/sh linked to /bin/dash
Init: systemd (via /run/systemd/system)

Versions of packages minissdpd depends on:
ii  libc6  2.19-18+deb8u1

minissdpd recommends no packages.

minissdpd suggests no packages.

-- no debconf information

```
```
[[Message part 2](bugreport.cgi?att=1;bug=816759;msg=5) (text/html, inline)]
```

---

**Changed Bug title to 'minissdpd: CVE-2016-3178 CVE-2016-3179' from 'minissdpd: The minissdpd daemon is affected by an improper validation of array index vulnerability'**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Thu, 17 Mar 2016 06:18:03 GMT) ([full text](bugreport.cgi?bug=816759;msg=7), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=7), [link](#6)).

---

**Marked as fixed in versions 1.1.20120121-1+deb7u1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 04 May 2016 09:45:16 GMT) ([full text](bugreport.cgi?bug=816759;msg=9), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=9), [link](#8)).

---

**Marked as found in versions minissdpd/1.1.20120121-1.**
Request was from `Salvatore Bonaccorso <carnil@debian.org>`
to `control@bugs.debian.org`.
(Wed, 04 May 2016 09:45:17 GMT) ([full text](bugreport.cgi?bug=816759;msg=11), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=11), [link](#10)).

---

**Information forwarded**
to `debian-bugs-dist@lists.debian.org, Thomas Goirand <zigo@debian.org>`:

`Bug#816759`; Package `minissdpd`.
(Mon, 24 Oct 2016 21:45:07 GMT) ([full text](bugreport.cgi?bug=816759;msg=13), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=13), [link](#12)).

---

**Acknowledgement sent**
to `James Cowgill <jcowgill@debian.org>`:

Extra info received and forwarded to list. Copy sent to `Thomas Goirand <zigo@debian.org>`.
(Mon, 24 Oct 2016 21:45:07 GMT) ([full text](bugreport.cgi?bug=816759;msg=15), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=15), [link](#14)).

---

[Message #16](#16) received at 816759@bugs.debian.org ([full text](bugreport.cgi?bug=816759;msg=16), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=16), reply):

![](/cgi-bin/libravatar.cgi?email=jcowgill%40debian.org)
From: James Cowgill <jcowgill@debian.org>
To: 816759@bugs.debian.org
Subject: Bug#816759: minissdpd: CVE-2016-3178 CVE-2016-3179
Date: Mon, 24 Oct 2016 22:42:33 +0100
```
[[Message part 1](bugreport.cgi?att=0;bug=816759;msg=16) (text/plain, inline)]
```
```
Control: tags -1 pending

Hi,

I have uploaded the attached NMU to fix this bug. It was mostly based on
the fix already present in wheezy-lts (the CVE patches are identical).
I've done some basic testing of the patches and it fixes the buffer
overflow which can be triggered as described earlier in the bugreport.

I'll see what I can do about fixing this in jessie as well.

Thanks,
James

```
```
[[minissdpd-1.2.20130907-3.2-nmu.debdiff](bugreport.cgi?att=1;bug=816759;filename=minissdpd-1.2.20130907-3.2-nmu.debdiff;msg=16) (text/plain, attachment)]
```
```
[[signature.asc](bugreport.cgi?att=2;bug=816759;filename=signature.asc;msg=16) (application/pgp-signature, attachment)]
```

---

**Added tag(s) pending.**
Request was from `James Cowgill <jcowgill@debian.org>`
to `816759-submit@bugs.debian.org`.
(Mon, 24 Oct 2016 21:45:07 GMT) ([full text](bugreport.cgi?bug=816759;msg=18), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=18), [link](#17)).

---

**Reply sent**
to `James Cowgill <jcowgill@debian.org>`:

You have taken responsibility.
(Mon, 24 Oct 2016 23:03:09 GMT) ([full text](bugreport.cgi?bug=816759;msg=20), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=20), [link](#19)).

---

**Notification sent**
to `Salva Peiró <speirofr@gmail.com>`:

Bug acknowledged by developer.
(Mon, 24 Oct 2016 23:03:09 GMT) ([full text](bugreport.cgi?bug=816759;msg=22), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=22), [link](#21)).

---

[Message #23](#23) received at 816759-close@bugs.debian.org ([full text](bugreport.cgi?bug=816759;msg=23), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=23), reply):

![](/cgi-bin/libravatar.cgi?email=jcowgill%40debian.org)
From: James Cowgill <jcowgill@debian.org>
To: 816759-close@bugs.debian.org
Subject: Bug#816759: fixed in minissdpd 1.2.20130907-3.2
Date: Mon, 24 Oct 2016 23:01:32 +0000
```
Source: minissdpd
Source-Version: 1.2.20130907-3.2

We believe that the bug you reported is fixed in the latest version of
minissdpd, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 816759@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James Cowgill <jcowgill@debian.org> (supplier of updated minissdpd package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Mon, 24 Oct 2016 08:54:59 +0100
Source: minissdpd
Binary: minissdpd
Architecture: source
Version: 1.2.20130907-3.2
Distribution: unstable
Urgency: high
Maintainer: Thomas Goirand <zigo@debian.org>
Changed-By: James Cowgill <jcowgill@debian.org>
Description:
 minissdpd  - keep memory of all UPnP devices that announced themselves
Closes: [816759](bugreport.cgi?bug=816759)
Changes:
 minissdpd (1.2.20130907-3.2) unstable; urgency=high
 .
   * Non-maintainer upload.
   * Fix [CVE-2016-3178](https://security-tracker.debian.org/tracker/CVE-2016-3178) and [CVE-2016-3179](https://security-tracker.debian.org/tracker/CVE-2016-3179). (Closes: #[816759](bugreport.cgi?bug=816759))
     The minissdpd daemon contains a improper validation of array index
     vulnerability (CWE-129) when processing requests sent to the Unix
     socket at /var/run/minissdpd.sock the Unix socket can be accessed
     by an unprivileged user to send invalid request causes an
     out-of-bounds memory access that crashes the minissdpd daemon.
Checksums-Sha1:
 9faacd5cfd6b605f095608acdf190ae5aaff15cd 1901 minissdpd_1.2.20130907-3.2.dsc
 238e91135a0b6902087220567550aaf5ee1b3538 6612 minissdpd_1.2.20130907-3.2.debian.tar.xz
Checksums-Sha256:
 38985689119f7463b9f0715efc14e2a04752be7c34ecf0af0974f7b172cbc619 1901 minissdpd_1.2.20130907-3.2.dsc
 95a6d6c9265d0b67acd5dc97d4512195a846ec93da58de2ad66f0bb429bf3ab9 6612 minissdpd_1.2.20130907-3.2.debian.tar.xz
Files:
 fdba319ce4396886e263c5523a24c239 1901 net optional minissdpd_1.2.20130907-3.2.dsc
 4b3a6c7ee7ce6b9f740de05014cdc642 6612 net optional minissdpd_1.2.20130907-3.2.debian.tar.xz

-----BEGIN PGP SIGNATURE-----

iQIcBAEBCgAGBQJYDn7lAAoJEMfxZ23qLQHvX/wQAKpXbyzD2ywgl5ZeAarEwJYx
y2WHvChFhdAypNqQ11o4FS3WsIyxAYTg0fVKoAcQ44JEbBDSpAPitUIWf7u9nyow
X6KhKF4/msdD/RiwpLePAxmOFL+spsy7nBdFwbXUe2fjCv56hsZcK+dD+pbUtzmj
vXeAtYc3JZ711li6HRno2lZcA/fZkOg9jDIJ60ncz87LlR0TeQpOwmKhbsHa0egf
21uHZoBZvTxIFGe3CVIC74r3eKW1vbAznF7uvQyy3QjXK1HM/yqverE+F35HYywi
ii4rSE2FbTTSJYkFoZI1N3u1x4fVFB3Qpkp8Ti//YoARUZsCOBORHdyiW7VFIyRV
AIrGVUTU3bCGm66bYMYXa/4lsBNmkv7zp05S8kpRgDs/BkoXmehNUwuueDhFCNR7
LVHAIcF8mai3N3sg/2i7vVBDsl+GczvA+sCR2f3YkF53gcFQDC0mLsxO86K74DmV
qeZ/LXJFIWhHqFab+5vvYRE9kwdMtQmMUfxEn5SKX4uvjFnDGtBODgeM5gFL89pm
p2n7JfpAgRFgb3JoZqhBXCn4DC+/aOF1tW27whzqPdjjX836BMcL01IqTNRTgfzU
yaKSMPHy9zPzzh2JN6hhXwURouk5HRLNlMujTwu0Dww3P79NcPH4pgwo5HADT4/c
Bi3tCA9555QTKtm092Js
=pda3
-----END PGP SIGNATURE-----

```

---

**Reply sent**
to `James Cowgill <jcowgill@debian.org>`:

You have taken responsibility.
(Sat, 05 Nov 2016 18:21:03 GMT) ([full text](bugreport.cgi?bug=816759;msg=25), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=25), [link](#24)).

---

**Notification sent**
to `Salva Peiró <speirofr@gmail.com>`:

Bug acknowledged by developer.
(Sat, 05 Nov 2016 18:21:03 GMT) ([full text](bugreport.cgi?bug=816759;msg=27), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=27), [link](#26)).

---

[Message #28](#28) received at 816759-close@bugs.debian.org ([full text](bugreport.cgi?bug=816759;msg=28), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=28), reply):

![](/cgi-bin/libravatar.cgi?email=jcowgill%40debian.org)
From: James Cowgill <jcowgill@debian.org>
To: 816759-close@bugs.debian.org
Subject: Bug#816759: fixed in minissdpd 1.2.20130907-3+deb8u1
Date: Sat, 05 Nov 2016 18:17:09 +0000
```
Source: minissdpd
Source-Version: 1.2.20130907-3+deb8u1

We believe that the bug you reported is fixed in the latest version of
minissdpd, which is due to be installed in the Debian FTP archive.

A summary of the changes between this version and the previous one is
attached.

Thank you for reporting the bug, which will now be closed.  If you
have further comments please address them to 816759@bugs.debian.org,
and the maintainer will reopen the bug report if appropriate.

Debian distribution maintenance software
pp.
James Cowgill <jcowgill@debian.org> (supplier of updated minissdpd package)

(This message was generated automatically at their request; if you
believe that there is a problem with it please contact the archive
administrators by mailing ftpmaster@ftp-master.debian.org)

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Format: 1.8
Date: Mon, 24 Oct 2016 22:46:46 +0100
Source: minissdpd
Binary: minissdpd
Architecture: source
Version: 1.2.20130907-3+deb8u1
Distribution: jessie
Urgency: high
Maintainer: Thomas Goirand <zigo@debian.org>
Changed-By: James Cowgill <jcowgill@debian.org>
Description:
 minissdpd  - keep memory of all UPnP devices that announced themselves
Closes: [816759](bugreport.cgi?bug=816759)
Changes:
 minissdpd (1.2.20130907-3+deb8u1) jessie; urgency=high
 .
   * Non-maintainer upload.
   * Fix [CVE-2016-3178](https://security-tracker.debian.org/tracker/CVE-2016-3178) and [CVE-2016-3179](https://security-tracker.debian.org/tracker/CVE-2016-3179). (Closes: #[816759](bugreport.cgi?bug=816759))
     The minissdpd daemon contains a improper validation of array index
     vulnerability (CWE-129) when processing requests sent to the Unix
     socket at /var/run/minissdpd.sock the Unix socket can be accessed
     by an unprivileged user to send invalid request causes an
     out-of-bounds memory access that crashes the minissdpd daemon.
Checksums-Sha1:
 1d4e123c34c7e3d23a1d61ead86f4be2dcfd4ecd 1912 minissdpd_1.2.20130907-3+deb8u1.dsc
 515c45758c0e8220012c8687a60fefd1526ae7eb 6440 minissdpd_1.2.20130907-3+deb8u1.debian.tar.xz
Checksums-Sha256:
 2104bb177beee002212ea9fac5eafb848b666bdcda10b1cf6833e30dba395b41 1912 minissdpd_1.2.20130907-3+deb8u1.dsc
 7fb1982fcb81b2d4eb62b1fff2ad43bdc24e52a59a5e8d743d966630d00e61db 6440 minissdpd_1.2.20130907-3+deb8u1.debian.tar.xz
Files:
 bafcb48b4c6d0f6bc69716a2aabc7ee0 1912 net optional minissdpd_1.2.20130907-3+deb8u1.dsc
 134860e3a3a12933aa9f2198ab666098 6440 net optional minissdpd_1.2.20130907-3+deb8u1.debian.tar.xz

-----BEGIN PGP SIGNATURE-----

iQIcBAEBCgAGBQJYGK9vAAoJEMfxZ23qLQHvw50QAIJOvs9LdZJnXS4scrWyxQft
Lc8EO1M6OszA6GVB1GuQdZb0YQNFBIB5Pi2Lnqw6TI3Rv40SFrSfRy876fPGk+TS
5aR1ChzksDcDWsuFje2QYVdxhkZ4w5j6v9iIYrUpmXwuY7oa5+5f6VF1O4gxGVVT
oWwJGw0HRAKyY2M8qwa0tZIcE7JeNBrv7/qjM+2IJDdwclMPGGjy/RE8yKGz7DyK
YfQ11Z0uIELwT7tnHZq9LF61w1BpUIV3Iibs3TgLdmtJTJdjoxqcBf2yAO6T8aCa
yA/P8uPNNmgFvxaC2tn3cfwzmmnep+15Gl6aBcDAdEw/R0kZ4CAAyfxl9ScLuVg6
fhsVGcH48AcdLQDod0XRQKFMKQMj1mnSe2b2P3eqIZHWw9r4cpe3MmMc0RGACSVF
oGfvX5ANF6xylg+23mnvF6PhOkjEkQ6NVTS39j7ycBajwTnXyUA0AYtAq2vBfHJH
hsRiC7ZiEmmlvKDKexySUlPu9YmfwGeewDBNCJXTnDDMlUOqtiPPEClvtQYaSDCk
s/csE+7ceIXIH0lAb9yh8usA/d3XX4NzFamw4TSeyPXXctFYgDz+HhvjM4HF9Tak
OT131qfyKIaLPwFMkDk6c7T0GwxIduLd/RKRPwt3oQXBqaKEmKDBagEjVRkO78OO
T4ZVSaD34S+C9Tlfedch
=nQVr
-----END PGP SIGNATURE-----

```

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Mon, 05 Dec 2016 10:02:19 GMT) ([full text](bugreport.cgi?bug=816759;msg=30), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=30), [link](#29)).

---

**Bug unarchived.**
Request was from `Don Armstrong <don@debian.org>`
to `control@bugs.debian.org`.
(Wed, 07 Dec 2016 01:46:36 GMT) ([full text](bugreport.cgi?bug=816759;msg=32), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=32), [link](#31)).

---

**Bug archived.**
Request was from `Debbugs Internal Request <owner@bugs.debian.org>`
to `internal_control@bugs.debian.org`.
(Sat, 28 Jan 2017 07:36:03 GMT) ([full text](bugreport.cgi?bug=816759;msg=34), [mbox](bugreport.cgi?bug=816759;mbox=yes;msg=34), [link](#33)).

---

Send a report that [this bug log contains spam](https://bugs.debian.org/cgi-bin/bugspam.cgi?bug=816759).

---

Debian bug tracking system administrator <owner@bugs.debian.org>.
Last modified:
Sat Jan 25 18:11:44 2025;
Machine Name:
buxtehude

[Debian Bug tracking system](https://www.debian.org/Bugs/)

Debbugs is free software and licensed under the terms of the GNU General
Public License version 2. The current version can be obtained
from <https://bugs.debian.org/debbugs-source/>.

Copyright © 1999 Darren O. Benham,
1997,2003 nCipher Corporation Ltd,
1994-97 Ian Jackson,
2005-2017 Don Armstrong, and many other contributors.



=== Content from github.com_9b25a96a_20250126_105554.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmi)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmi)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E&source=header)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

![@mi](https://avatars.githubusercontent.com/u/20288?s=64&v=4)

**mi**
[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fmi)

[Overview](/mi)
[Repositories
0](/mi?tab=repositories)
[Projects
0](/mi?tab=projects)
[Packages
0](/mi?tab=packages)
[Stars
0](/mi?tab=stars)

More

* [Overview](/mi)
* [Repositories](/mi?tab=repositories)
* [Projects](/mi?tab=projects)
* [Packages](/mi?tab=packages)
* [Stars](/mi?tab=stars)

![@mi](https://avatars.githubusercontent.com/u/20288?s=64&v=4)

**mi**

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fmi)

[![View mi's full-sized avatar](https://avatars.githubusercontent.com/u/20288?v=4)](https://avatars.githubusercontent.com/u/20288?v=4)

# mi

[Follow](/login?return_to=https%3A%2F%2Fgithub.com%2Fmi)

[10
followers](https://github.com/mi?tab=followers) · [0
following](https://github.com/mi?tab=following)

Block or Report

# Block or report mi

**Block user**

Prevent this user from interacting with your repositories and sending you notifications.
Learn more about [blocking users](https://docs.github.com/articles/blocking-a-user-from-your-personal-account).

You must be logged in to block users.

Add an optional note:

Please don't include any personal information such as legal names or email addresses. Maximum 100 characters, markdown supported. This note will be visible to only you.

Block user

**Report abuse**

Contact GitHub support about this user’s behavior.
Learn more about [reporting abuse](https://docs.github.com/articles/reporting-abuse-or-spam).

[Report abuse](/contact/report-abuse?report=mi+%28user%29)

[Overview](/mi)
[Repositories
0](/mi?tab=repositories)
[Projects
0](/mi?tab=projects)
[Packages
0](/mi?tab=packages)
[Stars
0](/mi?tab=stars)

More

* [Overview](/mi)
* [Repositories](/mi?tab=repositories)
* [Projects](/mi?tab=projects)
* [Packages](/mi?tab=packages)
* [Stars](/mi?tab=stars)

## Popular repositories Loading

## mi doesn't have any public repositories yet.

Something went wrong, please refresh the page to try again.

If the problem persists, check the [GitHub status page](https://www.githubstatus.com/)
or [contact support](/contact).

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_faff0849_20250126_105555.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminiupnp%2Fminiupnp%2Fcommit%2F140ee8d2204b383279f854802b27bdb41c1d5d1a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminiupnp%2Fminiupnp%2Fcommit%2F140ee8d2204b383279f854802b27bdb41c1d5d1a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miniupnp%2Fminiupnp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miniupnp](/miniupnp)
/
**[miniupnp](/miniupnp/miniupnp)**
Public

* [Notifications](/login?return_to=%2Fminiupnp%2Fminiupnp) You must be signed in to change notification settings
* [Fork
  460](/login?return_to=%2Fminiupnp%2Fminiupnp)
* [Star
   1.5k](/login?return_to=%2Fminiupnp%2Fminiupnp)

* [Code](/miniupnp/miniupnp)
* [Issues
  27](/miniupnp/miniupnp/issues)
* [Pull requests
  13](/miniupnp/miniupnp/pulls)
* [Actions](/miniupnp/miniupnp/actions)
* [Projects
  0](/miniupnp/miniupnp/projects)
* [Wiki](/miniupnp/miniupnp/wiki)
* [Security](/miniupnp/miniupnp/security)
* [Insights](/miniupnp/miniupnp/pulse)

Additional navigation options

* [Code](/miniupnp/miniupnp)
* [Issues](/miniupnp/miniupnp/issues)
* [Pull requests](/miniupnp/miniupnp/pulls)
* [Actions](/miniupnp/miniupnp/actions)
* [Projects](/miniupnp/miniupnp/projects)
* [Wiki](/miniupnp/miniupnp/wiki)
* [Security](/miniupnp/miniupnp/security)
* [Insights](/miniupnp/miniupnp/pulse)

## Commit

[Permalink](/miniupnp/miniupnp/commit/140ee8d2204b383279f854802b27bdb41c1d5d1a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

minissdpd.c: Initialize pointers to NULL (fix)

[Browse files](/miniupnp/miniupnp/tree/140ee8d2204b383279f854802b27bdb41c1d5d1a)
Browse the repository at this point in the history

* Loading branch information

[![@miniupnp](https://avatars.githubusercontent.com/u/1070377?s=40&v=4)](/miniupnp)

[miniupnp](/miniupnp/miniupnp/commits?author=miniupnp "View all commits by miniupnp")
committed
Apr 12, 2014

1 parent
[4f230c8](/miniupnp/miniupnp/commit/4f230c809b3b66fafa34d387eead32fe242c49ee)

commit 140ee8d

Showing
**1 changed file**
with
**1 addition**
and
**0 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

## There are no files selected for viewing

1 change: 1 addition & 0 deletions

1
[minissdpd/minissdpd.c](#diff-e6df2bd39d4ca82cf0dcb947f05944ca2f6a7b9513e33efe9b54a167bdd1ae9d "minissdpd/minissdpd.c")

Show comments

[View file](/miniupnp/miniupnp/blob/140ee8d2204b383279f854802b27bdb41c1d5d1a/minissdpd/minissdpd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -658,6 +658,7 @@ void processRequest(struct reqelem \* req) |
|  |  | syslog(LOG\_ERR, "cannot allocate memory"); |
|  |  | goto error; |
|  |  | } |
|  |  | memset(newserv, 0, sizeof(struct service)); /\* set pointers to NULL \*/ |
|  |  | if(containsForbiddenChars(p, l)) { |
|  |  | syslog(LOG\_ERR, "bad request (st contains forbidden chars)"); |
|  |  | goto error; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `140ee8d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminiupnp%2Fminiupnp%2Fcommit%2F140ee8d2204b383279f854802b27bdb41c1d5d1a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security-tracker.debian.org_7dd086fb_20250126_105551.html ===

# CVE-2016-3179

| **Name** | CVE-2016-3179 |
| --- | --- |
| **Description** | The processRequest function in minissdpd.c in MiniSSDPd 1.2.20130907-3 allows local users to cause a denial of service (invalid free and daemon crash) via vectors related to error handling. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2016-3179) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2016-3179); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2016-3179), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2016-3179), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2016-3179), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2016-3179), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-3179), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2016-3179), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2016-3179), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2016-3179)/[CVE](https://www.suse.com/security/cve/CVE-2016-3179/), GitHub [advisories](https://github.com/advisories?query=CVE-2016-3179)/[code](https://github.com/search?type=Code&q=%22CVE-2016-3179%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2016-3179%22), [web search](https://duckduckgo.com/html?q=%22CVE-2016-3179%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DLA-454-1](/tracker/DLA-454-1) |
| **Debian Bugs** | [816759](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=816759) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [minissdpd](/tracker/source-package/minissdpd) ([PTS](https://tracker.debian.org/pkg/minissdpd)) | bullseye | 1.5.20190824-1 | fixed |
|  | bookworm | 1.6.0-1 | fixed |
|  | sid, trixie | 1.6.0-2.2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [minissdpd](/tracker/source-package/minissdpd) | source | wheezy | 1.1.20120121-1+deb7u1 |  | [DLA-454-1](/tracker/DLA-454-1) |  |
| [minissdpd](/tracker/source-package/minissdpd) | source | jessie | 1.2.20130907-3+deb8u1 |  |  |  |
| [minissdpd](/tracker/source-package/minissdpd) | source | (unstable) | 1.2.20130907-3.2 |  |  | [816759](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=816759) |

## Notes

```
<https://speirofr.appspot.com/files/advisory/SPADV-2016-02.md>
<https://github.com/miniupnp/miniupnp/commit/140ee8d2204b383279f854802b27bdb41c1d5d1a>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from speirofr.appspot.com_045ea5ca_20250126_105554.html ===
Advisory: The minissdpd daemon (1.2.20130907-3) is affected by an improper validation of array index weakness (CWE-129)
Advisory ID: SPADV2016-02
Revision: 0.3
Release Date: 2016/03/04
Last Modified: 2016/03/21
Date Reported: 2016/03/04
Author: Salva Peiró (speirofr at gmail.com)
Affected Software: minissdpd version 1.2.20130907-3
Remotely Exploitable: No
Locally Exploitable: Yes
Vendor URL: http://miniupnp.tuxfamily.org/minissdpd.html
Vendor Status: Vendor has been notified
CVE-ID: CVE-2016-3178 CVE-2016-3179
Vulnerability details
=====================
The minissdpd daemon (version: 1.2.20130907-3) contains a
improper validation of array index vulnerability (CWE-129)
when processing requests sent to the Unix socket at /var/run/minissdpd.sock.
The Unix socket can be accessed by an unprivileged user to send invalid
request causes an out-of-bounds memory access that crashes the minissdpd
daemon.
Technical Details
=================
The vulnerability can be triggered by a local unprivileged user that performs the following request:
$ echo -en '\x04\x01\x60\x8f\xff\xff\xff\x7f\x0a' | nc.openbsd -U /var/run/minissdpd.sock
The request is processed by the processRequest() function at minissdpd.c
which identifies the request of type=4, and performs the parsing of the
"new service" request, the decoding of the length of the usn field performed at
line 663, sets l = 0xffffffff, with p = buf+4, and n = 9, the negative length
l=-1 passes the check at line 664 with (buf+4-1) < (buf + 9), continuing with
the allocation of the usn field at line 673, that initialises newserv->usn =
malloc(0), where in the case of Linux malloc(3) the allocator returns a pointer
that can be later passed to free(). The line 668 attempts to copy 0xffffffff
bytes from the message pointer p to newserv->usn, that causes the daemon to
perform an out-of-bound memory access writing outside the allocated buffer.
~~~
663 DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
664 if(p+l > buf+n) {
665 syslog(LOG\_WARNING, "bad request (length encoding)");
666 goto error;
667 }
...
673 newserv->usn = malloc(l + 1);
674 if(!newserv->usn) {
675 syslog(LOG\_ERR, "cannot allocate memory");
676 goto error;
677 }
668 memcpy(newserv->usn, p, l);
~~~
The problem is the incorrect validation on the length returned by the
DECODELENGTH\_CHECKLIMIT macro at line 664, that does not consider negative
length values. The fix of the check has already been applied to the upstream
minissdpd repository see [2], the check happens at multiple locations after the
DECODELENGTH\_CHECKLIMIT macro that also need to be fixed:
~~~
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_ERR, "cannot allocate memory");
goto error;
}
~~~
After performing the corrections of the length check the minissdpd daemon
properly detects the invalid negative values and performs error handling.
However, the error handling code at line 753 attempts to free the undefined
memory contents that newserv = malloc() allocated at line 642.
~~~
753 if(newserv) {
754 free(newserv->st);
755 free(newserv->usn);
756 free(newserv->server);
757 free(newserv->location);
758 free(newserv);
759 newserv = NULL;
760 }
~~~
The issue is corrected by applying initialising the contents of the newserv
to zero [3]. That causes free() to correctly operate when freeing the
uninitialised struct fields.
~~~
642 newserv = malloc(sizeof(struct service));
643 if(!newserv) {
644 syslog(LOG\_ERR, "cannot allocate memory");
645 goto error;
646 }
+ memset(newserv, 0, sizeof(struct service));
~~~
Solution
========
Apply the proposed fixes, contained in the patch below.
~~~
From 2f6746a0c00872b977cc81452d77463aa39609e7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Salva=20Peir=C3=B3?=
Date: Fri, 4 Mar 2016 12:38:18 +0100
Subject: [PATCH] Fix minissdpd.c handling of request with negative length
---
minissdpd.c | 9 +++++----
1 file changed, 5 insertions(+), 4 deletions(-)
diff --git a/minissdpd.c b/minissdpd.c
index 520a6c5..1cd079e 100644
--- a/minissdpd.c
+++ b/minissdpd.c
@@ -555,7 +555,7 @@ void processRequest(struct reqelem \* req)
type = buf[0];
p = buf + 1;
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
@@ -644,6 +644,7 @@ void processRequest(struct reqelem \* req)
syslog(LOG\_ERR, "cannot allocate memory");
goto error;
}
+ memset(newserv, 0, sizeof(struct service));
if(containsForbiddenChars(p, l)) {
syslog(LOG\_ERR, "bad request (st contains forbidden chars)");
goto error;
@@ -661,7 +662,7 @@ void processRequest(struct reqelem \* req)
goto error;
}
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
@@ -679,7 +680,7 @@ void processRequest(struct reqelem \* req)
newserv->usn[l] = '\0';
p += l;
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
@@ -697,7 +698,7 @@ void processRequest(struct reqelem \* req)
newserv->server[l] = '\0';
p += l;
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
--
2.1.4
~~~
Affected versions
=================
Debian: https://packages.debian.org/jessie/minissdpd
minissdpd version 1.2.20130907-3
Ubuntu: https://launchpad.net/ubuntu/+source/minissdpd
minissdpd version 1.2.20130907-3
History
=======
2016/03/01 - Author notified of the security issue
2016/03/01 - Author fixed the security issue (see [2])
2016/03/04 - Vendor notified
2016/03/07 - Advisory notified to oss-security
2016/03/16 - CVEs assigned CVE-2016-3178 CVE-2016-3179
Credits
=======
Vulnerability found and advisory written by Salva Peiró.
References
==========
[1] https://speirofr.appspot.com/files/advisory/SPADV-2016-02.md
[2] https://github.com/miniupnp/miniupnp/commit/b238cade9a173c6f751a34acf8ccff838a62aa47
[3] https://github.com/miniupnp/miniupnp/commit/140ee8d2204b383279f854802b27bdb41c1d5d1a
Changes
=======
Revision 0.1 - Initial draft release to the vendor
https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=minissdpd;dist=unstable
Revision 0.2 - Security advisory notified to oss-security
http://seclists.org/oss-sec/2016/q1/551
Revision 0.3 - Update security advisory CVE: CVE-2016-3178 CVE-2016-3179
http://www.openwall.com/lists/oss-security/2016/03/16/13
Disclaimer
==========
The information within this advisory may change without notice. Use
of this information constitutes acceptance for use in an AS IS
condition. There are no warranties, implied or express, with regard
to this information. In no event shall the author be liable for any
direct or indirect damages whatsoever arising out of or in connection
with the use or spread of this information. Any use of this
information is at the user's own risk.
Copyright 2016 Salva Peiró. All rights reserved.


=== Content from security-tracker.debian.org_034abeaf_20250126_105553.html ===

# CVE-2016-3178

| **Name** | CVE-2016-3178 |
| --- | --- |
| **Description** | The processRequest function in minissdpd.c in MiniSSDPd 1.2.20130907-3 allows local users to cause a denial of service (out-of-bounds memory access and daemon crash) via vectors involving a negative length value. |
| **Source** | [CVE](https://www.cve.org/CVERecord?id=CVE-2016-3178) (at [NVD](https://nvd.nist.gov/vuln/detail/CVE-2016-3178); [CERT](https://www.kb.cert.org/vuls/byid?searchview=&query=CVE-2016-3178), [LWN](https://lwn.net/Search/DoSearch?words=CVE-2016-3178), [oss-sec](https://marc.info/?l=oss-security&s=CVE-2016-3178), [fulldisc](https://marc.info/?l=full-disclosure&s=CVE-2016-3178), [Red Hat](https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-3178), [Ubuntu](https://people.canonical.com/~ubuntu-security/cve/CVE-2016-3178), [Gentoo](https://bugs.gentoo.org/show_bug.cgi?id=CVE-2016-3178), SUSE [bugzilla](https://bugzilla.suse.com/show_bug.cgi?id=CVE-2016-3178)/[CVE](https://www.suse.com/security/cve/CVE-2016-3178/), GitHub [advisories](https://github.com/advisories?query=CVE-2016-3178)/[code](https://github.com/search?type=Code&q=%22CVE-2016-3178%22)/[issues](https://github.com/search?type=Issues&q=%22CVE-2016-3178%22), [web search](https://duckduckgo.com/html?q=%22CVE-2016-3178%22), [more](https://oss-security.openwall.org/wiki/vendors)) |
| **References** | [DLA-454-1](/tracker/DLA-454-1) |
| **Debian Bugs** | [816759](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=816759) |

## Vulnerable and fixed packages

The table below lists information on source packages.

| Source Package | Release | Version | Status |
| --- | --- | --- | --- |
| [minissdpd](/tracker/source-package/minissdpd) ([PTS](https://tracker.debian.org/pkg/minissdpd)) | bullseye | 1.5.20190824-1 | fixed |
|  | bookworm | 1.6.0-1 | fixed |
|  | sid, trixie | 1.6.0-2.2 | fixed |

The information below is based on the following data on fixed versions.

| Package | Type | Release | Fixed Version | Urgency | Origin | Debian Bugs |
| --- | --- | --- | --- | --- | --- | --- |
| [minissdpd](/tracker/source-package/minissdpd) | source | wheezy | 1.1.20120121-1+deb7u1 |  | [DLA-454-1](/tracker/DLA-454-1) |  |
| [minissdpd](/tracker/source-package/minissdpd) | source | jessie | 1.2.20130907-3+deb8u1 |  |  |  |
| [minissdpd](/tracker/source-package/minissdpd) | source | (unstable) | 1.2.20130907-3.2 |  |  | [816759](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=816759) |

## Notes

```
<https://speirofr.appspot.com/files/advisory/SPADV-2016-02.md>
<https://github.com/miniupnp/miniupnp/commit/b238cade9a173c6f751a34acf8ccff838a62aa47>

```

---

Search for package or bug name:  [Reporting problems](/tracker/data/report)

[Home](/tracker/) - [Debian Security](https://www.debian.org/security/) - [Source](https://salsa.debian.org/security-tracker-team/security-tracker/blob/master/bin/tracker_service.py) [(Git)](https://salsa.debian.org/security-tracker-team/security-tracker)



=== Content from speirofr.appspot.com_701729af_20250125_181141.html ===
Advisory: The minissdpd daemon (1.2.20130907-3) is affected by an improper validation of array index weakness (CWE-129)
Advisory ID: SPADV2016-02
Revision: 0.3
Release Date: 2016/03/04
Last Modified: 2016/03/21
Date Reported: 2016/03/04
Author: Salva Peiró (speirofr at gmail.com)
Affected Software: minissdpd version 1.2.20130907-3
Remotely Exploitable: No
Locally Exploitable: Yes
Vendor URL: http://miniupnp.tuxfamily.org/minissdpd.html
Vendor Status: Vendor has been notified
CVE-ID: CVE-2016-3178 CVE-2016-3179
Vulnerability details
=====================
The minissdpd daemon (version: 1.2.20130907-3) contains a
improper validation of array index vulnerability (CWE-129)
when processing requests sent to the Unix socket at /var/run/minissdpd.sock.
The Unix socket can be accessed by an unprivileged user to send invalid
request causes an out-of-bounds memory access that crashes the minissdpd
daemon.
Technical Details
=================
The vulnerability can be triggered by a local unprivileged user that performs the following request:
$ echo -en '\x04\x01\x60\x8f\xff\xff\xff\x7f\x0a' | nc.openbsd -U /var/run/minissdpd.sock
The request is processed by the processRequest() function at minissdpd.c
which identifies the request of type=4, and performs the parsing of the
"new service" request, the decoding of the length of the usn field performed at
line 663, sets l = 0xffffffff, with p = buf+4, and n = 9, the negative length
l=-1 passes the check at line 664 with (buf+4-1) < (buf + 9), continuing with
the allocation of the usn field at line 673, that initialises newserv->usn =
malloc(0), where in the case of Linux malloc(3) the allocator returns a pointer
that can be later passed to free(). The line 668 attempts to copy 0xffffffff
bytes from the message pointer p to newserv->usn, that causes the daemon to
perform an out-of-bound memory access writing outside the allocated buffer.
~~~
663 DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
664 if(p+l > buf+n) {
665 syslog(LOG\_WARNING, "bad request (length encoding)");
666 goto error;
667 }
...
673 newserv->usn = malloc(l + 1);
674 if(!newserv->usn) {
675 syslog(LOG\_ERR, "cannot allocate memory");
676 goto error;
677 }
668 memcpy(newserv->usn, p, l);
~~~
The problem is the incorrect validation on the length returned by the
DECODELENGTH\_CHECKLIMIT macro at line 664, that does not consider negative
length values. The fix of the check has already been applied to the upstream
minissdpd repository see [2], the check happens at multiple locations after the
DECODELENGTH\_CHECKLIMIT macro that also need to be fixed:
~~~
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_ERR, "cannot allocate memory");
goto error;
}
~~~
After performing the corrections of the length check the minissdpd daemon
properly detects the invalid negative values and performs error handling.
However, the error handling code at line 753 attempts to free the undefined
memory contents that newserv = malloc() allocated at line 642.
~~~
753 if(newserv) {
754 free(newserv->st);
755 free(newserv->usn);
756 free(newserv->server);
757 free(newserv->location);
758 free(newserv);
759 newserv = NULL;
760 }
~~~
The issue is corrected by applying initialising the contents of the newserv
to zero [3]. That causes free() to correctly operate when freeing the
uninitialised struct fields.
~~~
642 newserv = malloc(sizeof(struct service));
643 if(!newserv) {
644 syslog(LOG\_ERR, "cannot allocate memory");
645 goto error;
646 }
+ memset(newserv, 0, sizeof(struct service));
~~~
Solution
========
Apply the proposed fixes, contained in the patch below.
~~~
From 2f6746a0c00872b977cc81452d77463aa39609e7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Salva=20Peir=C3=B3?=
Date: Fri, 4 Mar 2016 12:38:18 +0100
Subject: [PATCH] Fix minissdpd.c handling of request with negative length
---
minissdpd.c | 9 +++++----
1 file changed, 5 insertions(+), 4 deletions(-)
diff --git a/minissdpd.c b/minissdpd.c
index 520a6c5..1cd079e 100644
--- a/minissdpd.c
+++ b/minissdpd.c
@@ -555,7 +555,7 @@ void processRequest(struct reqelem \* req)
type = buf[0];
p = buf + 1;
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
@@ -644,6 +644,7 @@ void processRequest(struct reqelem \* req)
syslog(LOG\_ERR, "cannot allocate memory");
goto error;
}
+ memset(newserv, 0, sizeof(struct service));
if(containsForbiddenChars(p, l)) {
syslog(LOG\_ERR, "bad request (st contains forbidden chars)");
goto error;
@@ -661,7 +662,7 @@ void processRequest(struct reqelem \* req)
goto error;
}
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
@@ -679,7 +680,7 @@ void processRequest(struct reqelem \* req)
newserv->usn[l] = '\0';
p += l;
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
@@ -697,7 +698,7 @@ void processRequest(struct reqelem \* req)
newserv->server[l] = '\0';
p += l;
DECODELENGTH\_CHECKLIMIT(l, p, buf + n);
- if(p+l > buf+n) {
+ if(l > (unsigned)(buf+n-p)) {
syslog(LOG\_WARNING, "bad request (length encoding)");
goto error;
}
--
2.1.4
~~~
Affected versions
=================
Debian: https://packages.debian.org/jessie/minissdpd
minissdpd version 1.2.20130907-3
Ubuntu: https://launchpad.net/ubuntu/+source/minissdpd
minissdpd version 1.2.20130907-3
History
=======
2016/03/01 - Author notified of the security issue
2016/03/01 - Author fixed the security issue (see [2])
2016/03/04 - Vendor notified
2016/03/07 - Advisory notified to oss-security
2016/03/16 - CVEs assigned CVE-2016-3178 CVE-2016-3179
Credits
=======
Vulnerability found and advisory written by Salva Peiró.
References
==========
[1] https://speirofr.appspot.com/files/advisory/SPADV-2016-02.md
[2] https://github.com/miniupnp/miniupnp/commit/b238cade9a173c6f751a34acf8ccff838a62aa47
[3] https://github.com/miniupnp/miniupnp/commit/140ee8d2204b383279f854802b27bdb41c1d5d1a
Changes
=======
Revision 0.1 - Initial draft release to the vendor
https://bugs.debian.org/cgi-bin/pkgreport.cgi?pkg=minissdpd;dist=unstable
Revision 0.2 - Security advisory notified to oss-security
http://seclists.org/oss-sec/2016/q1/551
Revision 0.3 - Update security advisory CVE: CVE-2016-3178 CVE-2016-3179
http://www.openwall.com/lists/oss-security/2016/03/16/13
Disclaimer
==========
The information within this advisory may change without notice. Use
of this information constitutes acceptance for use in an AS IS
condition. There are no warranties, implied or express, with regard
to this information. In no event shall the author be liable for any
direct or indirect damages whatsoever arising out of or in connection
with the use or spread of this information. Any use of this
information is at the user's own risk.
Copyright 2016 Salva Peiró. All rights reserved.


=== Content from github.com_6b2bae47_20250125_181145.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminiupnp%2Fminiupnp%2Fcommit%2Fb238cade9a173c6f751a34acf8ccff838a62aa47)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminiupnp%2Fminiupnp%2Fcommit%2Fb238cade9a173c6f751a34acf8ccff838a62aa47)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=miniupnp%2Fminiupnp)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[miniupnp](/miniupnp)
/
**[miniupnp](/miniupnp/miniupnp)**
Public

* [Notifications](/login?return_to=%2Fminiupnp%2Fminiupnp) You must be signed in to change notification settings
* [Fork
  460](/login?return_to=%2Fminiupnp%2Fminiupnp)
* [Star
   1.5k](/login?return_to=%2Fminiupnp%2Fminiupnp)

* [Code](/miniupnp/miniupnp)
* [Issues
  27](/miniupnp/miniupnp/issues)
* [Pull requests
  13](/miniupnp/miniupnp/pulls)
* [Actions](/miniupnp/miniupnp/actions)
* [Projects
  0](/miniupnp/miniupnp/projects)
* [Wiki](/miniupnp/miniupnp/wiki)
* [Security](/miniupnp/miniupnp/security)
* [Insights](/miniupnp/miniupnp/pulse)

Additional navigation options

* [Code](/miniupnp/miniupnp)
* [Issues](/miniupnp/miniupnp/issues)
* [Pull requests](/miniupnp/miniupnp/pulls)
* [Actions](/miniupnp/miniupnp/actions)
* [Projects](/miniupnp/miniupnp/projects)
* [Wiki](/miniupnp/miniupnp/wiki)
* [Security](/miniupnp/miniupnp/security)
* [Insights](/miniupnp/miniupnp/pulse)

## Commit

[Permalink](/miniupnp/miniupnp/commit/b238cade9a173c6f751a34acf8ccff838a62aa47)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

minissdpd: Fix broken overflow test (p+l > buf+n) thanks to Salva Piero

[Browse files](/miniupnp/miniupnp/tree/b238cade9a173c6f751a34acf8ccff838a62aa47)
Browse the repository at this point in the history

* Loading branch information

[![@miniupnp](https://avatars.githubusercontent.com/u/1070377?s=40&v=4)](/miniupnp)

[miniupnp](/miniupnp/miniupnp/commits?author=miniupnp "View all commits by miniupnp")
committed
Mar 1, 2016

1 parent
[ee22350](/miniupnp/miniupnp/commit/ee22350d5fbfd62040745a650a8cbe6cb364848c)

commit b238cad

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**20 additions**
and
**7 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* minissdpd

  + minissdpd/Changelog.txt
    [Changelog.txt](#diff-448bfa034dd4bb77cc4256f4e6569d98f79a285096c0dc74b44aa065054921a8)
  + minissdpd/minissdpd.c
    [minissdpd.c](#diff-e6df2bd39d4ca82cf0dcb947f05944ca2f6a7b9513e33efe9b54a167bdd1ae9d)
  + minissdpd/testminissdpd.c
    [testminissdpd.c](#diff-1644c6b55e4a68f358d4989d830cdce7a973db82e71a8dc7671cecc9779b8b16)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[minissdpd/Changelog.txt](#diff-448bfa034dd4bb77cc4256f4e6569d98f79a285096c0dc74b44aa065054921a8 "minissdpd/Changelog.txt")

Show comments

[View file](/miniupnp/miniupnp/blob/b238cade9a173c6f751a34acf8ccff838a62aa47/minissdpd/Changelog.txt)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,4 +1,7 @@ |
|  |  | $Id: Changelog.txt,v 1.43 2015/08/06 14:05:49 nanard Exp $ |
|  |  | $Id: Changelog.txt,v 1.45 2016/03/01 18:06:46 nanard Exp $ |
|  |  |  |
|  |  | 2016/03/01: |
|  |  | Fix broken overflow test (p+l > buf+n) thanks to Salva Piero |
|  |  |  |
|  |  | VERSION 1.5: |
|  |  |  |
| Expand Down | |  |

10 changes: 5 additions & 5 deletions

10
[minissdpd/minissdpd.c](#diff-e6df2bd39d4ca82cf0dcb947f05944ca2f6a7b9513e33efe9b54a167bdd1ae9d "minissdpd/minissdpd.c")

Show comments

[View file](/miniupnp/miniupnp/blob/b238cade9a173c6f751a34acf8ccff838a62aa47/minissdpd/minissdpd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | /\* $Id: minissdpd.c,v 1.50 2015/08/06 14:05:49 nanard Exp $ \*/ |
|  |  | /\* $Id: minissdpd.c,v 1.53 2016/03/01 18:06:46 nanard Exp $ \*/ |
|  |  | /\* vim: tabstop=4 shiftwidth=4 noexpandtab |
|  |  | \* MiniUPnP project |
|  |  | \* (c) 2007-2016 Thomas Bernard |
| Expand Down  Expand Up | | @@ -847,7 +847,7 @@ void processRequest(struct reqelem \* req) |
|  |  | type = buf[0]; |
|  |  | p = buf + 1; |
|  |  | DECODELENGTH\_CHECKLIMIT(l, p, buf + n); |
|  |  | if(p+l > buf+n) { |
|  |  | if(l > (unsigned)(buf+n-p)) { |
|  |  | syslog(LOG\_WARNING, "bad request (length encoding l=%u n=%u)", |
|  |  | l, (unsigned)n); |
|  |  | goto error; |
| Expand Down  Expand Up | | @@ -969,7 +969,7 @@ void processRequest(struct reqelem \* req) |
|  |  | goto error; |
|  |  | } |
|  |  | DECODELENGTH\_CHECKLIMIT(l, p, buf + n); |
|  |  | if(p+l > buf+n) { |
|  |  | if(l > (unsigned)(buf+n-p)) { |
|  |  | syslog(LOG\_WARNING, "bad request (length encoding)"); |
|  |  | goto error; |
|  |  | } |
| Expand All | | @@ -987,7 +987,7 @@ void processRequest(struct reqelem \* req) |
|  |  | newserv->usn[l] = '\0'; |
|  |  | p += l; |
|  |  | DECODELENGTH\_CHECKLIMIT(l, p, buf + n); |
|  |  | if(p+l > buf+n) { |
|  |  | if(l > (unsigned)(buf+n-p)) { |
|  |  | syslog(LOG\_WARNING, "bad request (length encoding)"); |
|  |  | goto error; |
|  |  | } |
| Expand All | | @@ -1005,7 +1005,7 @@ void processRequest(struct reqelem \* req) |
|  |  | newserv->server[l] = '\0'; |
|  |  | p += l; |
|  |  | DECODELENGTH\_CHECKLIMIT(l, p, buf + n); |
|  |  | if(p+l > buf+n) { |
|  |  | if(l > (unsigned)(buf+n-p)) { |
|  |  | syslog(LOG\_WARNING, "bad request (length encoding)"); |
|  |  | goto error; |
|  |  | } |
| Expand Down | |  |

12 changes: 11 additions & 1 deletion

12
[minissdpd/testminissdpd.c](#diff-1644c6b55e4a68f358d4989d830cdce7a973db82e71a8dc7671cecc9779b8b16 "minissdpd/testminissdpd.c")

Show comments

[View file](/miniupnp/miniupnp/blob/b238cade9a173c6f751a34acf8ccff838a62aa47/minissdpd/testminissdpd.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | /\* $Id: testminissdpd.c,v 1.12 2015/08/06 13:16:59 nanard Exp $ \*/ |
|  |  | /\* $Id: testminissdpd.c,v 1.14 2016/03/01 17:49:51 nanard Exp $ \*/ |
|  |  | /\* Project : miniupnp |
|  |  | \* website : http://miniupnp.free.fr/ or http://miniupnp.tuxfamily.org/ |
|  |  | \* Author : Thomas BERNARD |
| Expand Down  Expand Up | | @@ -65,6 +65,7 @@ main(int argc, char \* \* argv) |
|  |  | const char bad\_command[] = { 0xff, 0xff }; |
|  |  | const char overflow[] = { 0x01, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff, 0xff }; |
|  |  | const char command5[] = { 0x05, 0x00 }; |
|  |  | const char bad\_command4[] = { 0x04, 0x01, 0x60, 0x8f, 0xff, 0xff, 0xff, 0x7f}; |
|  |  | int s; |
|  |  | int i; |
|  |  | void \* tmp; |
| Expand Down  Expand Up | | @@ -180,6 +181,15 @@ main(int argc, char \* \* argv) |
|  |  | n = read(s, buf, sizeof(buf)); |
|  |  | printf("Response received %d bytes\n", (int)n); |
|  |  | printresponse(buf, n); |
|  |  | if(n == 0) { |
|  |  | close(s); |
|  |  | s = connect\_unix\_socket(sockpath); |
|  |  | } |
|  |  |  |
|  |  | n = SENDCOMMAND(bad\_command4, sizeof(bad\_command4)); |
|  |  | n = read(s, buf, sizeof(buf)); |
|  |  | printf("Response received %d bytes\n", (int)n); |
|  |  | printresponse(buf, n); |
|  |  |  |
|  |  | close(s); |
|  |  | return 0; |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `b238cad`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fminiupnp%2Fminiupnp%2Fcommit%2Fb238cade9a173c6f751a34acf8ccff838a62aa47) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.openwall.com_910c5443_20250125_181142.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](12) [[next>]](14) [[<thread-prev]](../../../2016/03/15/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <20160316174622.56D53132E53B@smtpvbsrv1.mitre.org>
Date: Wed, 16 Mar 2016 13:46:22 -0400 (EDT)
From: cve-assign@...re.org
To: speirofr@...il.com
Cc: cve-assign@...re.org, oss-security@...ts.openwall.com
Subject: Re: CVE Request: The minissdpd (v 1.2.20130907-3) is affected by an improper validation of array index weakness

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <http://speirofr.appspot.com/files/advisory/SPADV-2016-02.md>
>
> <https://bugs.debian.org/816759>

> <https://github.com/miniupnp/miniupnp/commit/b238cade9a173c6f751a34acf8ccff838a62aa47>

>> The problem is the incorrect validation ... that does not consider
>> negative length values

> - if(p+l > buf+n) {
> + if(l > (unsigned)(buf+n-p)) {

Use CVE-2016-3178.

> <https://github.com/miniupnp/miniupnp/commit/140ee8d2204b383279f854802b27bdb41c1d5d1a>

>> the error handling code ... attempts to free the undefined memory
>> contents

> + memset(newserv, 0, sizeof(struct service)); /* set pointers to NULL */

Use CVE-2016-3179.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJW6ZuJAAoJEL54rhJi8gl5+zcP/1oXalzOckVO1akQQK2c/xSP
FyC7bnNx0JYfA85zkZoy5PLOypFlLtLoOUOsCgjeVCjQ6KVBQGMustr/qkMH9ooW
AHuOHRyvwIUtMP5PO3ffgetNqoQeLr0kEwyDH7dXtF35VOVhtrylzxVq9MlySboe
Y64R5ZMN5EhbU9cE/uwyTpMnAfbgyKPClgf4N1vxgiAB9pzQm+6wTpVKr1O3+j3g
PFPymfnjZzpbSVzLskj4I6hoywoG1x0Mvd0QfDLgSX+xZ3Z1AGw+efSZrqovlNoP
ybM9nkhagW878NK4xiD4Wv0I5gRrhW+UElxNvvRKYgSL9qL2gmj1E6hVdhWULy9p
d9U/zpVcdjLKxNgnyJmQFzc3cEtgWhQfENEKqEq8G4Vdm5d4yrNlaaAiPUkvBzRu
su4XE8z/EcUfaN3iHNvBiu3PX2Oo1l9GhxE1f1DfjbhDqxN86tAOlzmjK5AS0uY8
2NQ2zxDPffqwVvgUThmnA+0Jre9i//uiGiIqi1O5Pj6UkRzmObPwY39YmVJ/pssS
BepEvpJbrgLxyhWdhqfEYSyNKcnJzkq/Kr+YPJER1zjy9BLpdDA/jmXclN15gWpj
j+Wxap24GneDKxpNZXuaYqOKcMdoAEca55k2BDjZbKRCxImTugByf1yGwz89cRDV
Wvd/xLNzXI4eTnWsa4d1
=RWDk
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


