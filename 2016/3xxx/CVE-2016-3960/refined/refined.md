Based on the provided documents, here's a breakdown of the vulnerability described by CVE-2016-3960:

**Root Cause:**

*   The vulnerability stems from an integer overflow within the x86 shadow pagetable code of the Xen hypervisor. Specifically, the guest frame number of a superpage mapping is stored in a 32-bit field. If a shadowed guest can cause a superpage mapping of a guest-physical address at or above 2^44 to be shadowed, the top bits of the address will be lost. This loss leads to an assertion failure or a NULL pointer dereference later on in the code that removes the shadow.

**Weaknesses/Vulnerabilities:**

*   **Integer Overflow:** The core issue is the inadequate size of the 32-bit field to store the guest frame number for large memory addresses, leading to a loss of higher-order bits.
*   **Shadow Pagetable Vulnerability:** The vulnerability is present specifically in the shadow pagetable implementation for x86 Xen hypervisor.

**Impact of Exploitation:**

*   **Host Crash:** An HVM (Hardware Virtual Machine) guest using shadow pagetables can cause the host to crash.
*   **Host Crash or Memory Corruption:** A PV (ParaVirtual) guest using shadow pagetables (during migration with PV superpages enabled, which is not the default setting) can crash the host or corrupt hypervisor memory, potentially leading to privilege escalation.

**Attack Vectors:**

*   **HVM Guest:** A malicious HVM guest using shadow pagetables can trigger the vulnerability.
*   **PV Guest (Specific Configuration):** A malicious PV guest using shadow pagetables during live migration and having PV superpages enabled can trigger the vulnerability.

**Required Attacker Capabilities/Position:**

*   **Guest Access:** The attacker needs to have control over a guest virtual machine (either HVM or PV) that is running on a vulnerable Xen hypervisor.
*   **HVM Guest:**  For HVM guests, the guest must be configured to use shadow pagetables instead of Hardware Assisted Paging (HAP).
*  **PV Guest:**  For PV guests, the guest must be undergoing live migration with PV superpages enabled.

**Additional Notes:**
*   The vulnerability affects Xen versions from 3.4 onwards.
*   Only x86 variants of Xen are susceptible. ARM variants are not affected.
*   HVM guests using Hardware Assisted Paging (HAP) are not vulnerable.
*   PV superpages are disabled by default.
*   Patches were made available for different Xen versions (4.3, 4.4, 4.5, 4.6, and unstable) to address this vulnerability.