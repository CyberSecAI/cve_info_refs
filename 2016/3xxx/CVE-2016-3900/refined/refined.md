Based on the provided information, here's an analysis of CVE-2016-3900:

**Root Cause of Vulnerability:**

The vulnerability lies in the `ServiceManager` component of Android. When a system service is registered by a secondary user, a process running in the background may incorrectly look up the service registered by the active user instead of the service registered by the user the process belongs to. This occurs when a process looks up a service while running in the background.

**Weaknesses/Vulnerabilities Present:**

- **Incorrect Service Lookup:**  The core weakness is that background processes might be directed to services registered by the active user rather than services registered by the user associated with the background process. This is particularly problematic when a service is registered on every user switch.
- **Service Impersonation:** This incorrect lookup behavior allows a malicious app to register a service that normally should be provided by a privileged process (like system_server). By registering an imposter service, they could potentially intercept communications or modify the system.

**Impact of Exploitation:**

- **Elevation of Privilege:** A local malicious application can exploit this vulnerability to register arbitrary services. By doing so, it could intercept sensitive operations or interfere with system behavior.
- **Service Impersonation:** A malicious application can impersonate privileged system services potentially leading to unexpected behaviour of system services or other applications.

**Attack Vectors:**

- **Local Malicious Application:** The attack vector is a local malicious application running on the Android device.
- **Service Registration:** A malicious application exploits this vulnerability by registering a service with the same name as an existing privileged service.

**Required Attacker Capabilities/Position:**

- **Ability to Install an Application:** An attacker must be able to install a malicious application on the targeted device.
- **Local Access:** The attacker needs local access to the device to run the malicious application.

**Additional Notes:**

- The provided commit messages describe the code changes to address this vulnerability.
- The fix involves ensuring that when a background process looks up a service, it looks at the service registered by the user the process belongs to, rather than the active user.
- The vulnerability is rated as High severity due to the possibility of service impersonation.