```
{
  "vulnerability_details": {
    "root_cause": "The Microsoft GDI+ implementation of the EMF format has a vulnerability in the handling of the \"offDx\" record field in the EMR_EXTTEXTOUTA and EMR_POLYTEXTOUTA records. The offset is meant to point to an array of intercharacter spacing values, but the code incorrectly validates the size of this array leading to out-of-bounds reads.",
    "weaknesses": [
      "Heap buffer overflow due to insufficient bounds checking when processing EMF records.",
      "Incorrect size validation of the \"offDx\" field which leads to an out-of-bounds read.",
      "Use of MultiByteToWideChar and a non-standard encoding with double-byte character sets (DBCS) to trigger the array rewriting behavior."
    ],
    "impact": "Remote code execution. An attacker who successfully exploits the vulnerability could take control of the affected system, allowing them to install programs; view, change, or delete data; or create new accounts with full user rights.",
    "attack_vectors": [
      "Web-based attacks: Attacker hosts a specially crafted website.",
      "File sharing attacks: Attacker provides a specially crafted document file.",
       "Preview Pane in Microsoft Office is an attack vector."
    ],
    "required_attacker_capabilities": "The attacker needs to craft a malicious EMF file with a specific 'offDx' value and DBCS characters that can trigger the heap overflow.  The attacker also needs to convince the victim to open the malicious file or visit a website hosting the malicious file.  They would either need to trick the user to click a link/open an attachment, or host it on a website the user visits."
  },
  "additional_details": {
     "vulnerable_functions": [
       "CEmfPlusEnumState::ExtTextOutA",
       "CEmfPlusEnumState::PolyTextOutA",
     ],
     "vulnerable_field": "offDx record field within EMR_EXTTEXTOUTA and EMR_POLYTEXTOUTA records",
     "trigger": "Non-standard encoding (DBCS) to cause MultiByteToWideChar() to return fewer characters than bytes in the input buffer. The 'offDx' field value is not correctly checked based on 'Chars' count which specifies number of chars in text.",
     "heap_massage": "The heap could be massaged by other records in the picture file such that the record copy is overflown with fully controlled data.",
     "affected_products": "Microsoft Windows, Microsoft Office, Skype for Business, and Microsoft Lync are affected. Specifically, this includes products like Microsoft Office 2007, 2010, Skype for Business 2016, Microsoft Lync 2013, and 2010.",
     "proof_of_concept": "A proof of concept (poc.emf file) was made available.",
     "notes": "The vulnerability can be triggered within Gdiplus.dll. An example crash log from PowerPoint 2013 was included in the provided information showing the heap corruption. This vulnerability is part of a group of similar vulnerabilities covered by MS16-097.",
  }
}
```