=== Content from security.gentoo.org_1305b977_20250125_083716.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201612-56**

Multiple vulnerabilities have been found in Xen, the worst of which
could lead to the execution of arbitrary code on the host system.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r4** |
| Unaffected versions | >= **4.7.1-r4** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r4** |
| Unaffected versions | >= **4.7.1-r4** |

| Package | **app-emulation/xen-pvgrub** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r1** |
| Unaffected versions | >= **4.7.1-r1** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
CVE identifiers referenced below for details.

### Impact

A local attacker could possibly execute arbitrary code with the
privileges of the process, could gain privileges on the host system,
cause a Denial of Service condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.7.1-r4"

```

All Xen Tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-tools-4.7.1-r4"

```

All Xen PvGrub users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-pvgrub-4.7.1-r1"

```
### References

* [CVE-2016-10024](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10024)
* [CVE-2016-9377](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9377)
* [CVE-2016-9378](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9378)
* [CVE-2016-9379](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9379)
* [CVE-2016-9380](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9380)
* [CVE-2016-9381](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9381)
* [CVE-2016-9382](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9382)
* [CVE-2016-9383](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9383)
* [CVE-2016-9384](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9384)
* [CVE-2016-9385](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9385)
* [CVE-2016-9386](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9386)
* [CVE-2016-9637](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9637)
* [CVE-2016-9815](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9815)
* [CVE-2016-9816](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9816)
* [CVE-2016-9817](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9817)
* [CVE-2016-9818](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9818)
* [CVE-2016-9932](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9932)

**Release date**

December 31, 2016

**Latest revision**

January 03, 2017: 2

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [600382](https://bugs.gentoo.org/show_bug.cgi?id=600382)
* [600662](https://bugs.gentoo.org/show_bug.cgi?id=600662)
* [601248](https://bugs.gentoo.org/show_bug.cgi?id=601248)
* [601250](https://bugs.gentoo.org/show_bug.cgi?id=601250)
* [601986](https://bugs.gentoo.org/show_bug.cgi?id=601986)
* [603420](https://bugs.gentoo.org/show_bug.cgi?id=603420)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from xenbits.xen.org_eefa6aa3_20250125_083716.html ===

# Information

| Advisory | [XSA-193](advisory-193.html) |
| --- | --- |
| Public release | 2016-11-22 12:00 |
| Updated | 2016-11-22 12:00 |
| Version | 3 |
| CVE(s) | [CVE-2016-9385](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9385) |
| Title | x86 segment base write emulation lacking canonical address checks |

# Files

<advisory-193.txt> (signed advisory file)

<xsa193.patch>

<xsa193-4.5.patch>

<xsa193-4.7.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

            Xen Security Advisory CVE-2016-9385 / XSA-193
                              version 3

   x86 segment base write emulation lacking canonical address checks

UPDATES IN VERSION 3
====================

Public release.

ISSUE DESCRIPTION
=================

Both writes to the FS and GS register base MSRs as well as the
WRFSBASE and WRGSBASE instructions require their input values to be
canonical, or a #GP fault will be raised.  When the use of those
instructions by the hypervisor was enabled, the previous guard against
#GP faults (having recovery code attached) was accidentally removed.

IMPACT
======

A malicious guest administrator can crash the host, leading to a DoS.

VULNERABLE SYSTEMS
==================

Xen versions 4.4 and onwards are affected.  Xen versions 4.3 and
earlier are not affected.

The vulnerability is only exposed to x86 PV guests.

The vulnerability is NOT exposed to x86 HVM guests.

ARM systems are NOT vulnerable.

MITIGATION
==========

Running only HVM guests will avoid this vulnerability.

For PV guests the vulnerability can be avoided if the guest kernel is
controlled by the host rather than guest administrator, provided that
further steps are taken to prevent the guest administrator from loading
code into the kernel (e.g. by disabling loadable modules etc) or from
using other mechanisms which allow them to run code at kernel privilege.

CREDITS
=======

This issue was discovered by Andrew Cooper of Citrix.

RESOLUTION
==========

Applying the appropriate attached patch resolves this issue.

xsa193.patch           xen-unstable
xsa193-4.7.patch       Xen 4.7.x, Xen 4.6.x
xsa193-4.5.patch       Xen 4.5.x, Xen 4.4.x

$ sha256sum xsa193*
[401df29b462a3430403a4f5bb36fd7824e692c9b5bac650e1a9d70bd440a55a1  xsa193.patch](xsa193.patch)
[b3494b1fe5fefc0d032bd603340e364c880ec0d3ae3fb8aa3a773038e956f955  xsa193-4.5.patch](xsa193-4.5.patch)
[f1b0092c585ebffe83d6ed7df94885ec5dfcb4227bdb33f421bad9febb8135a1  xsa193-4.7.patch](xsa193-4.7.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBAgAGBQJYNDK2AAoJEIP+FMlX6CvZswsIAI17sWqaGeP8GvtddxR08G2J
3Nb7Lnb/4cq8Hdc5XmUnX/zuDqobT5AGJEgKAuhRc9zs2TOv8FwcABc+/odKG6ak
tcMAaLThMcKbB0b0ZYEkcrU+jaCDDVE3rYVGjKv0hHKZNRY/SmWOdl180xcHksXG
pj5OQn6/+db6nqMlhyOcOyjM3w1/1AUe/O0EDsdUSNrY1mZi4/MjUXlDaJTZbDCc
KW9XUeRSq66iZELawBaosViTenOm/R+8DJGiR8fmJlXx+gzpEywtsEUCrxeKlTDo
tT68gwy0aHdlqKbIthkKr5qaT5FtKPyX0UpIXu7qtldbdEZG61iIlNOEG8tyPhU=
=fjbt
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team

