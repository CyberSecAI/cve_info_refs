=== Content from www.revive-adserver.com_117e0fb8_20250125_021204.html ===


* [Facebook](https://www.facebook.com/WeAreReviveAdserver/)
* [RSS](https://www.revive-adserver.com/feed/)

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sec_menu "Hosted edition of Revive Adserver – sign up and get started in no time!")
* [Community Forum](https://forum.revive-adserver.com/)
* [Documentation](https://documentation.revive-adserver.com/)
* [Github](https://github.com/revive-adserver/revive-adserver/)
* [Patreon](https://patreon.com/revive_adserver "Sponsor us on Patreon")

[![Revive Adserver](https://www.revive-adserver.com/media/Revive-Adserver-logo.png)
# Download edition](https://www.revive-adserver.com/)

* [Download](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Features](https://www.revive-adserver.com/features/ "Features of Revive Adserver")
  + [Inventory](https://www.revive-adserver.com/features/#inventory "Managing inventory")
  + [Statistics](https://www.revive-adserver.com/features/#statistics "Review your Statistics")
  + [Open Source](https://www.revive-adserver.com/features/#open_source "Free, Open Source, Privacy Proof")
* [How to](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver")
  + [Get Started](https://www.revive-adserver.com/how-to/get-started/ "How to Get started with Revive Adserver")
  + [Manage Advertisers](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manage Advertisers in Revive Adserver")
    - [Create an Advertiser](https://www.revive-adserver.com/how-to/create-an-advertiser/ "How to Create an Advertiser in Revive Adserver")
    - [More about Advertisers…](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manager Advertisers in Revive Adserver")
  + [Manage Campaigns](https://www.revive-adserver.com/how-to/manage-campaigns/ "How to create and manage campaigns in Revive Adserver")
    - [Create a Campaign](https://www.revive-adserver.com/how-to/create-a-campaign/ "How to create a Campaign in Revive Adserver")
    - [Link a campaign to zones](https://www.revive-adserver.com/how-to/link-a-campaign-to-zones/ "How to link a campaign to zones in Revive Adserver")
    - [More about Campaigns…](https://www.revive-adserver.com/how-to/manage-campaigns/)
  + [Manage Banners](https://www.revive-adserver.com/how-to/manage-banners/ "How to manage banners in Revive Adserver")
    - [Create a Banner](https://www.revive-adserver.com/how-to/create-a-banner/ "How to create a banner in Revive Adserver")
    - [Define Delivery Rules](https://www.revive-adserver.com/how-to/define-delivery-rules-for-a-banner/ "How to define Delivery Rules for a Banner in Revive Adserver")
    - [More about Banners…](https://www.revive-adserver.com/how-to/manage-banners/ "More articles about managing banners in Revive Adserver")
  + [Manage Websites](https://www.revive-adserver.com/how-to/manage-websites/ "How to manage websites in Revive Adserver")
    - [Create a Website](https://www.revive-adserver.com/how-to/create-a-website/ "How to Create a Website in Revive Adserver")
  + [Manage Zones](https://www.revive-adserver.com/how-to/manage-zones/ "How to manage Zones in Revive Adserver")
    - [Create a Zone](https://www.revive-adserver.com/how-to/create-a-zone/ "How to create a Zone in Revive Adserver")
    - [Create Zone Invocation Code](https://www.revive-adserver.com/how-to/create-zone-invocation-code/ "How to Create Zone Invocation Code in Revive Adserver")
    - [More about Zones…](https://www.revive-adserver.com/how-to/manage-zones/)
  + [Manage Preferences](https://www.revive-adserver.com/how-to/manage-preferences/ "Manage Preferences in Revive Adserver")
    - [Create Delivery Rule Sets](https://www.revive-adserver.com/how-to/create-delivery-rule-sets/ "Create Delivery Rule Sets in Revive Adserver")
  + [Install and Update](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating Revive Adserver")
    - [Install Revive Adserver](https://www.revive-adserver.com/how-to/install/ "How to Install Revive Adserver on your server")
    - [Update Revive Adserver](https://www.revive-adserver.com/how-to/update/ "How to Update Revive Adserver to a new version")
    - [More about Installation and Updating…](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating the Revive Adserver software")
  + [Manage Configuration](https://www.revive-adserver.com/how-to/manage-configuration/ "Articles about How to Configure Revive Adserver")
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions about Revive Adserver")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
  + [Can I sponsor Revive Adserver?](https://www.revive-adserver.com/about/our-sponsors/)
  + [Using Google AdSense with Revive Adserver](https://www.revive-adserver.com/faq/using-google-adsense-with-revive-adserver/)
  + [Geotargeting with Revive Adserver](https://www.revive-adserver.com/faq/geotargeting-with-revive-adserver/)
  + [Troubleshooting banner delivery](https://www.revive-adserver.com/faq/troubleshooting-banner-delivery/)
* [Support](https://www.revive-adserver.com/support/ "Support for Revive Adserver")
  + [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
  + [Documentation](https://documentation.revive-adserver.com/)
  + [Forums](https://forum.revive-adserver.com/ "Revive Adserver Community Forums")
  + [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
  + [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
* [About](https://www.revive-adserver.com/about/ "About Revive Adserver")
  + [Our sponsors](https://www.revive-adserver.com/about/our-sponsors/)
  + [Active Revive Adserver instances](https://www.revive-adserver.com/about/active-revive-adserver-instances/)
  + [User Reviews](https://www.revive-adserver.com/about/user-reviews-about-revive-adserver/ "User Reviews about Revive Adserver")
* [Blog](https://www.revive-adserver.com/blog/ "Revive Adserver blog")

Select Page

# Revive Adserver Security Advisory REVIVE-SA-2016-001

## Revive Adserver Security Advisory REVIVE-SA-2016-001

* Advisory ID: [REVIVE-SA-2016-001](https://www.revive-adserver.com/security/revive-sa-2016-001/)
* CVE-IDs: See below
* Date: 2016-03-02
* Risk Level: Medium
* Applications affected: Revive Adserver
* Versions affected: <= 3.2.2
* Versions not affected: >= 3.2.3
* Website: <https://www.revive-adserver.com/>

## Vulnerability 1 – Improper Restriction of Excessive Authentication Attempts

* CVE-ID: [CVE-2016-9124](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9124)
* CWE-ID: CWE-307
* CVSSv2: 8.5 (AV:N/AC:L/Au:N/C:C/I:P/A:N)

### Description

Karan M. Tank and Smit B. Shah have reported via HackerOne that the login page of Revive Adserver was vulnerable to password-guessing attacks. An account lockdown feature was considered, but rejected to avoid introducing service disruptions to regular users during such attacks. A random delay has instead been introduced as a counter-measure in case of password failures, along with a system to discourage parallel brute forcing. These systems will effectively allow the valid users to log in to the adserver, even while an attack is in progress.

### References

* <https://cwe.mitre.org/data/definitions/307.html>
* <https://github.com/revive-adserver/revive-adserver/commit/847941390f5b3310d51b07c92ec91cc1f4cc82c9>

## Vulnerability 2 – Session Fixation

* CVE-ID: [CVE-2016-9125](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9125)
* CWE-ID: CWE-384
* CVSSv2: 7.8 (AV:N/AC:M/Au:N/C:C/I:P/A:N)

### Description

The HackerOne users kaviya and Kamini Singh have independently reported that Revive Adserver was vulnerable to session fixation, by allowing arbitrary session identifiers to be forced and, at the same time, by not invalidating the existing session upon a successful authentication. Under some circumstances, that could have been an opportunity for an attacker to steal an authenticated sessions.

### References

* <https://cwe.mitre.org/data/definitions/384.html>
* <https://github.com/revive-adserver/revive-adserver/commit/4910365631eabbb208961c36149f41cc8159fb39>

## Vulnerability 3 – Persistent XSS

* CVE-ID: [CVE-2016-9126](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9126)
* CWE-ID: CWE-79
* CVSSv2: 5.6 (AV:N/AC:H/Au:S/C:C/I:P/A:N)

### Description

Tengku Zahasman has reported via HackerOne that usernames were not properly escaped when displayed in the audit trail widget of the dashboard upon login, allowing persistent XSS attacks. An authenticated user with enough privileges to create other users could exploit the vulnerability to access the administrator account.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/8d8c6df309ff5fde9dd4770abcd4ec5d2449b3ec>

## Vulnerability 4 – Cross-Site Request Forgery (CSRF)

* CVE-ID: [CVE-2016-9127](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9127)
* CWE-ID: CWE-352
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

An undisclosed user has reported via HackerOne that the password recovery form in Revive Adserver was vulnerable to CSRF attacks. This vulnerability could be exploited to send a large number of password recovery emails to the registered users, especially in conjunction with a bug that caused recovery emails to be sent to all the users at once. Both issues have been fixed.

### References

* <https://cwe.mitre.org/data/definitions/352.html>
* <https://github.com/revive-adserver/revive-adserver/commit/3aaebcc765797d2c684e031f2836e0a69d6b7bc2>

## Vulnerability 5 – Reflected XSS

* CVE-ID: [CVE-2016-9128](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9128)
* CWE-ID: CWE-79
* CVSSv2: 3.5 (AV:N/AC:M/Au:S/C:N/I:P/A:N)

### Description

The HackerOne user @decidedlygray has reported that the affiliate-preview.php script in www/admin is vulnerable to a reflected XSS attack. This vulnerability could be used by an attacker to steal the session ID of an authenticated user, by tricking them into visiting a specifically crafted URL.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/a323fd626627e8d42819fd5b7e2829196b5c54a3>
* <https://github.com/revive-adserver/revive-adserver/commit/e17a7ec3412ded751cda50b82338de471d656d74>

## Vulnerability 6 – Information Exposure Through Discrepancy

* CVE-ID: [CVE-2016-9129](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9129)
* CWE-ID: CWE-203
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:P/I:N/A:N)

### Description

Karan M. Tank and Smit B. Shah have reported via HackerOne that it was possible to check whether or not an email address was associated to one or more user accounts on a target Revive Adserver instance by examining the message printed by the password recovery system. Such information cannot however be used directly to log in to the system, which requires a username.

### References

* <https://cwe.mitre.org/data/definitions/203.html>
* <https://github.com/revive-adserver/revive-adserver/commit/38223a841190bebd7a137c7bed84fbbcb2b0c2a5>

## Vulnerability 7 – Persistent XSS

* CVE-IDs: [CVE-2016-9130](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9130), [CVE-2016-9454](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9454)
* CWE-ID: CWE-79
* CVSSv2: 3.5 (AV:N/AC:M/Au:S/C:N/I:P/A:N)

### Description

Johan Caluwe has reported via HackerOne two vectors for persistent XSS attacks via the Revive Adserver user interface, both requiring a trusted (non-admin) account:

1. the website name wasn’t properly escaped when displayed in the campaign-zone.php script; and
2. the banner image URL for external banners wasn’t properly escaped when displayed in most of the banner related pages.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/f6880330a8e11e804663f132867e9eb9b1f94e83>

## Vulnerability 8 – Cross-Site Request Forgery (CSRF)

* CVE-ID: [CVE-2016-9455](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9455)
* CWE-ID: CWE-352
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

The HackerOne user @decidedlygray has reported a number of scripts in Revive Adserver’s user interface that were vulnerable to CSRF attacks:

* www/admin/banner-acl.php
* www/admin/banner-activate.php
* www/admin/banner-advanced.php
* www/admin/banner-modify.php
* www/admin/banner-swf.php
* www/admin/banner-zone.php
* www/admin/tracker-modify.php

### References

* <https://cwe.mitre.org/data/definitions/352.html>
* <https://github.com/revive-adserver/revive-adserver/commit/65a9c8119b4bc7493fd957e1a8d6f6f731298b45>

## Vulnerability 9 – Cross-Site Request Forgery (CSRF)

* CVE-ID: [CVE-2016-9456](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9456)
* CWE-ID: CWE-352
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

Following a number of CSRF reports, the Revive Adserver team have conducted a security audit of the admin interface scripts in order to identify and fix other potential CSRF vulnerabilities.

The effort led to fixing 20+ such issues: please see the commit for the full list of files affected.

### References

* <https://cwe.mitre.org/data/definitions/352.html>
* <https://github.com/revive-adserver/revive-adserver/commit/e563ca61e4f3b7210cb61f53284adaa8aef4a49a>

## Vulnerability 10 – Reflected XSS

* CVE-ID: [CVE-2016-9457](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9457)
* CWE-ID: CWE-79
* CVSSv2: 5.6 (AV:N/AC:H/Au:S/C:C/I:P/A:N)

### Description

Johan Caluwe has reported via HackerOne that www/admin/stats.php was vulnerable to reflected XSS attacks via multiple parameters that were not properly sanitised or escaped when displayed, such as “setPerPage”, “pageId”, “bannerid”, “pereiod\_start”, “period\_end” and possibly others.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/ecbe822b48ef4ff61c2c6357c0c94199a81946f4>

## Solution

We strongly advise people to upgrade to the most recent 3.2.3 release of Revive Adserver, including those running OpenX Source or older versions of the application.

## Contact Information

The security contact for Revive Adserver can be reached at: <security AT revive-adserver DOT com>

Please review [https://www.revive-adserver.com/security/](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team") before doing so.

#### Current Stable Release

* [Version 5.5.2](https://www.revive-adserver.com/download/ "Download the latest stable version of Revive Adserver")
#### How can we help?

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sidebar "Hosted edition of Revive Adserver – Subscribe to get started in no time!")
* [Download edition](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
* [Documentation](https://documentation.revive-adserver.com/)
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions")
* [Forums](https://forum.revive-adserver.com/)
* [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
#### How can you help?

* [Sponsor Us](https://www.revive-adserver.com/about/our-sponsors/)
* [Translate to your language](https://translations.revive-adserver.com/ "Help us by translating the Revive Adserver software to your language")
#### Other information

* [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
* [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and privacy")

#### Current Stable Release

**v5.5.2** · [Download now](https://www.revive-adserver.com/download/)
released April 17, 2024
Read our [Release notes](https://www.revive-adserver.com/categories/release-notes/) blog posts.

#### How to use Revive Adserver

We have a collection of [articles explaining how to use the Revive Adserver software](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver"), with tips and best practices.

#### Hosted edition

Revive Adserver is also available as a [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=page_footer "Revive Adserver Hosted edition"), with costs as low as $10 per month.

#### Project Information

Revive Adserver is a project by

**[Aqua Platform](http://www.aquaplatform.com/ "Aqua Platform")**.

* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")
#### Become a sponsor

You can be a sponsor of the Revive Adserver open source project, by [contributing to our project on Patreon](https://www.patreon.com/revive_adserver). Even just $10 per month will help.

[![](https://www.revive-adserver.com/media/become_a_patron_button.png)](https://www.patreon.com/revive_adserver)

We also have other [sponsors](https://www.revive-adserver.com/about/our-sponsors/ "A list of companies and individuals who have sponsored our project").

#### Website hosting

This website is hosted by [Aqua Platform](https://www.aquaplatform.com/), specialists in next generation cloud based [Revive Adserver Hosting](https://www.aquaplatform.com/revive-adserver-hosting/), systems and technology.

* [Home](https://www.revive-adserver.com/)
* [Privacy](https://www.revive-adserver.com/privacy/ "Privacy and Revive Adserver")
* [Security](https://www.revive-adserver.com/security/)

[Revive Adserver Download edition](https://www.revive-adserver.com/) is © 2013-2025 by [Aqua Platform](https://www.aquaplatform.com/) · All Rights Reserved.

* [Follow](https://github.com/revive-adserver/revive-adserver/ "Follow on GitHub")
* [Follow](https://www.patreon.com/revive_adserver "Follow on Patreon")
* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")



=== Content from github.com_b0a52abe_20250126_051544.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F65a9c8119b4bc7493fd957e1a8d6f6f731298b45)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F65a9c8119b4bc7493fd957e1a8d6f6f731298b45)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=revive-adserver%2Frevive-adserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[revive-adserver](/revive-adserver)
/
**[revive-adserver](/revive-adserver/revive-adserver)**
Public

* [Notifications](/login?return_to=%2Frevive-adserver%2Frevive-adserver) You must be signed in to change notification settings
* [Fork
  568](/login?return_to=%2Frevive-adserver%2Frevive-adserver)
* [Star
   1.3k](/login?return_to=%2Frevive-adserver%2Frevive-adserver)

* [Code](/revive-adserver/revive-adserver)
* [Issues
  153](/revive-adserver/revive-adserver/issues)
* [Pull requests
  23](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

Additional navigation options

* [Code](/revive-adserver/revive-adserver)
* [Issues](/revive-adserver/revive-adserver/issues)
* [Pull requests](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

## Commit

[Permalink](/revive-adserver/revive-adserver/commit/65a9c8119b4bc7493fd957e1a8d6f6f731298b45)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix h1 report 97123

[Browse files](/revive-adserver/revive-adserver/tree/65a9c8119b4bc7493fd957e1a8d6f6f731298b45)
Browse the repository at this point in the history

```
Cross-Site Request Forgery (CSRF)
---------------------------------

The HackerOne user [@decidedlygray](https://github.com/decidedlygray) has reported a number of scripts in Revive
Adserver's user interface that were vulnerable to CSRF attacks:

- www/admin/banner-acl.php
- www/admin/banner-activate.php
- www/admin/banner-advanced.php
- www/admin/banner-modify.php
- www/admin/banner-swf.php
- www/admin/banner-zone.php
- www/admin/tracker-modify.php

A CVE-ID has been requested, but not assigned yet.

CWE: CWE-352
CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)
```

* Loading branch information

[![@mbeccati](https://avatars.githubusercontent.com/u/282388?s=40&v=4)](/mbeccati)

[mbeccati](/revive-adserver/revive-adserver/commits?author=mbeccati "View all commits by mbeccati")
committed
Mar 1, 2016

1 parent
[f688033](/revive-adserver/revive-adserver/commit/f6880330a8e11e804663f132867e9eb9b1f94e83)

commit 65a9c81

 Show file tree

 Hide file tree

Showing
**7 changed files**
with
**30 additions**
and
**16 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* www/admin

  + www/admin/banner-acl.php
    [banner-acl.php](#diff-8f25aff6fe74a44bc8fddea40551aa6cbb4a9b6cd10190606c527bef9272e0df)
  + www/admin/banner-activate.php
    [banner-activate.php](#diff-7319ec07fda95cba69cfeeee5ab9110cc57ac72dc6cb45913d92daed20934df4)
  + www/admin/banner-advanced.php
    [banner-advanced.php](#diff-62b9008b782f037c0f319f99c578d566d58d6bf7dc7853583736ed813dd96167)
  + www/admin/banner-modify.php
    [banner-modify.php](#diff-41e9dd3b81ae182c45af1a99d52074bc484b1e7cbde4ab70ad8ea8c9b3a71227)
  + www/admin/banner-swf.php
    [banner-swf.php](#diff-e87fe95bc6b7e29d81635e8e1ceabbfc2482f13243b7cb76fa5fa178af1bd082)
  + www/admin/banner-zone.php
    [banner-zone.php](#diff-9819bcdfe926ded0431b74ab06f67a89b9b92833c8c87e63aa81db2a42c73039)
  + www/admin/tracker-modify.php
    [tracker-modify.php](#diff-799bd7532112c0b51388f56a6f7055668275fc9f28ac8ec57174c6044c4927d6)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[www/admin/banner-acl.php](#diff-8f25aff6fe74a44bc8fddea40551aa6cbb4a9b6cd10190606c527bef9272e0df "www/admin/banner-acl.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/65a9c8119b4bc7493fd957e1a8d6f6f731298b45/www/admin/banner-acl.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -48,6 +48,8 @@ |
|  |  | if (!empty($action)) { |
|  |  | $acl = MAX\_AclAdjust($acl, $action); |
|  |  | } elseif (!empty($submit)) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $acl = (isset($acl)) ? $acl : array(); |
|  |  |  |
|  |  | // Only save when inputs are valid |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/banner-activate.php](#diff-7319ec07fda95cba69cfeeee5ab9110cc57ac72dc6cb45913d92daed20934df4 "www/admin/banner-activate.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/65a9c8119b4bc7493fd957e1a8d6f6f731298b45/www/admin/banner-activate.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -36,6 +36,8 @@ |
|  |  | OA\_Permission::enforceAccessToObject('campaigns', $campaignid); |
|  |  | OA\_Permission::enforceAccessToObject('banners', $bannerid, true); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (OA\_Permission::isAccount(OA\_ACCOUNT\_ADVERTISER)) { |
|  |  | if ($value == OA\_ENTITY\_STATUS\_RUNNING) { |
|  |  | OA\_Permission::enforceAllowed(OA\_PERM\_BANNER\_ACTIVATE); |
| Expand Down | |  |

35 changes: 19 additions & 16 deletions

35
[www/admin/banner-advanced.php](#diff-62b9008b782f037c0f319f99c578d566d58d6bf7dc7853583736ed813dd96167 "www/admin/banner-advanced.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/65a9c8119b4bc7493fd957e1a8d6f6f731298b45/www/admin/banner-advanced.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -39,23 +39,26 @@ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | if (isset($submitbutton)) { |
|  |  | if (isset($bannerid) && $bannerid != '') { |
|  |  | // Update banner |
|  |  | $doBanners = OA\_Dal::factoryDO('banners'); |
|  |  | $doBanners->get($bannerid); |
|  |  | $doBanners->prepend = $prepend; |
|  |  | $doBanners->append = $append; |
|  |  | $doBanners->update(); |
|  |  |  |
|  |  | // Queue confirmation message |
|  |  | $translation = new OX\_Translation(); |
|  |  | $translated\_message = $translation->translate($GLOBALS['strBannerAdvancedHasBeenUpdated'], array( |
|  |  | MAX::constructURL(MAX\_URL\_ADMIN, 'banner-edit.php?clientid=' . $clientid . '&campaignid=' . $campaignid . '&bannerid=' . $bannerid), |
|  |  | htmlspecialchars($doBanners->description) |
|  |  | )); |
|  |  | OA\_Admin\_UI::queueMessage($translated\_message, 'local', 'confirm', 0); |
|  |  | } |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | // Update banner |
|  |  | $doBanners = OA\_Dal::factoryDO('banners'); |
|  |  | $doBanners->get($bannerid); |
|  |  | $doBanners->prepend = $prepend; |
|  |  | $doBanners->append = $append; |
|  |  | $doBanners->update(); |
|  |  |  |
|  |  | // Queue confirmation message |
|  |  | $translation = new OX\_Translation(); |
|  |  | $translated\_message = $translation->translate($GLOBALS['strBannerAdvancedHasBeenUpdated'], array( |
|  |  | MAX::constructURL(MAX\_URL\_ADMIN, 'banner-edit.php?clientid=' . $clientid . '&campaignid=' . $campaignid . '&bannerid=' . $bannerid), |
|  |  | htmlspecialchars($doBanners->description) |
|  |  | )); |
|  |  |  |
|  |  | OA\_Admin\_UI::queueMessage($translated\_message, 'local', 'confirm', 0); |
|  |  |  |
|  |  | header ("Location: banner-advanced.php?clientid=".$clientid."&campaignid=".$campaignid."&bannerid=".$bannerid); |
|  |  | exit; |
|  |  | } |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[www/admin/banner-modify.php](#diff-41e9dd3b81ae182c45af1a99d52074bc484b1e7cbde4ab70ad8ea8c9b3a71227 "www/admin/banner-modify.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/65a9c8119b4bc7493fd957e1a8d6f6f731298b45/www/admin/banner-modify.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,6 +31,7 @@ |
|  |  | // Security check |
|  |  | OA\_Permission::enforceAccount(OA\_ACCOUNT\_MANAGER); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Main code \*/ |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/banner-swf.php](#diff-e87fe95bc6b7e29d81635e8e1ceabbfc2482f13243b7cb76fa5fa178af1bd082 "www/admin/banner-swf.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/65a9c8119b4bc7493fd957e1a8d6f6f731298b45/www/admin/banner-swf.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -35,6 +35,8 @@ |
|  |  | OA\_Permission::enforceAccessToObject('campaigns', $campaignid); |
|  |  | OA\_Permission::enforceAccessToObject('banners', $bannerid); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (OA\_Permission::isAccount(OA\_ACCOUNT\_ADVERTISER)) { |
|  |  | OA\_Permission::enforceAllowed(OA\_PERM\_BANNER\_EDIT); |
|  |  | } |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/banner-zone.php](#diff-9819bcdfe926ded0431b74ab06f67a89b9b92833c8c87e63aa81db2a42c73039 "www/admin/banner-zone.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/65a9c8119b4bc7493fd957e1a8d6f6f731298b45/www/admin/banner-zone.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,6 +31,8 @@ |
|  |  | OA\_Permission::enforceAccessToObject('campaigns', $campaignid); |
|  |  | OA\_Permission::enforceAccessToObject('banners', $bannerid); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Store preferences \*/ |
|  |  | /\*-------------------------------------------------------\*/ |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/tracker-modify.php](#diff-799bd7532112c0b51388f56a6f7055668275fc9f28ac8ec57174c6044c4927d6 "www/admin/tracker-modify.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/65a9c8119b4bc7493fd957e1a8d6f6f731298b45/www/admin/tracker-modify.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -38,6 +38,8 @@ |
|  |  |  |
|  |  | if (!empty($trackerid)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (!empty($moveto)) |
|  |  | { |
|  |  | // Delete any campaign-tracker links |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `65a9c81`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F65a9c8119b4bc7493fd957e1a8d6f6f731298b45) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_fbb0dabd_20250125_021201.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2Fe563ca61e4f3b7210cb61f53284adaa8aef4a49a)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2Fe563ca61e4f3b7210cb61f53284adaa8aef4a49a)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=revive-adserver%2Frevive-adserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[revive-adserver](/revive-adserver)
/
**[revive-adserver](/revive-adserver/revive-adserver)**
Public

* [Notifications](/login?return_to=%2Frevive-adserver%2Frevive-adserver) You must be signed in to change notification settings
* [Fork
  568](/login?return_to=%2Frevive-adserver%2Frevive-adserver)
* [Star
   1.3k](/login?return_to=%2Frevive-adserver%2Frevive-adserver)

* [Code](/revive-adserver/revive-adserver)
* [Issues
  153](/revive-adserver/revive-adserver/issues)
* [Pull requests
  23](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

Additional navigation options

* [Code](/revive-adserver/revive-adserver)
* [Issues](/revive-adserver/revive-adserver/issues)
* [Pull requests](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

## Commit

[Permalink](/revive-adserver/revive-adserver/commit/e563ca61e4f3b7210cb61f53284adaa8aef4a49a)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix other CSRF issues

[Browse files](/revive-adserver/revive-adserver/tree/e563ca61e4f3b7210cb61f53284adaa8aef4a49a)
Browse the repository at this point in the history

```
Cross-Site Request Forgery (CSRF)
---------------------------------

Following a number of CSRF reports, the Revive Team has conducted a security
audit of the admin interface scripts in order to identify and fix other
potential CSRF vulnerabilities.

The effort led to fixing 20+ such issues: please see the commit for the full
list of files affected.

A CVE-ID has been requested, but not assigned yet.

CWE: CWE-352
CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)
```

* Loading branch information

[![@mbeccati](https://avatars.githubusercontent.com/u/282388?s=40&v=4)](/mbeccati)

[mbeccati](/revive-adserver/revive-adserver/commits?author=mbeccati "View all commits by mbeccati")
committed
Mar 1, 2016

1 parent
[65a9c81](/revive-adserver/revive-adserver/commit/65a9c8119b4bc7493fd957e1a8d6f6f731298b45)

commit e563ca6

 Show file tree

 Hide file tree

Showing
**26 changed files**
with
**92 additions**
and
**25 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + OA/Admin

    - lib/OA/Admin/Template.php
      [Template.php](#diff-7a57dab71d03947df99313bfb7c893054f68f90efa6443a6ba84ca0e45b68e6e)
  + max

    - Admin/Inventory

      * lib/max/Admin/Inventory/TrackerAppend.php
        [TrackerAppend.php](#diff-3e24ed19065e1a7dcb39917f19c3391aece1cb878952de499f5d446bf87dac23)
      * themes

        + lib/max/Admin/Inventory/themes/TrackerAppend.html
          [TrackerAppend.html](#diff-0fd9f1e7682e01d3c49267c181823bc4fefdcfcdc7ce4ff11f99f2540b95e1f2)
    - other

      * lib/max/other/html.php
        [html.php](#diff-e6c67e96e3e35a30749406e22a885a7fef562eda4da930b7770748ee53694f00)
  + templates/admin

    - lib/templates/admin/campaign-zone.html
      [campaign-zone.html](#diff-7ae2421c46bd37ae37ac50b979227334509e1f7faeea11ae6d60ebf79780e85d)
* www/admin

  + www/admin/banner-modify.php
    [banner-modify.php](#diff-41e9dd3b81ae182c45af1a99d52074bc484b1e7cbde4ab70ad8ea8c9b3a71227)
  + www/admin/campaign-modify.php
    [campaign-modify.php](#diff-984712b654c62af8d37eaca64083cbd157fb1e91cdca4d8e5794ad63e1014274)
  + www/admin/campaign-zone-link.php
    [campaign-zone-link.php](#diff-011c666312bb43a49b4011c3ac20851eaab827d540930102f8cd0226f50b9c03)
  + www/admin/channel-acl.php
    [channel-acl.php](#diff-ca5553ec80788fcfde228dcfdce26cbd29eed223a04574688c492b0535b223e6)
  + www/admin/channel-modify.php
    [channel-modify.php](#diff-bacef05d7005921606c825078ee400656c3725600410f4627839d987c09c9c9a)
  + www/admin/lib-maintenance-priority.inc.php
    [lib-maintenance-priority.inc.php](#diff-fad0c90d0895b41f291d8d80269462362e1243f9fd0a80da250290c8bd216dfe)
  + www/admin/maintenance-acl-check.php
    [maintenance-acl-check.php](#diff-e2f57eb1e0973b3d8ae1536d33bbe71c9378d8edb8f1d90e051b0d7fdf01f672)
  + www/admin/maintenance-appendcode-check.php
    [maintenance-appendcode-check.php](#diff-1e7e18d07184e3f23ee51d477e88a7556b543fc02b90d37847ce24ecc96c44fc)
  + www/admin/maintenance-banners-check.php
    [maintenance-banners-check.php](#diff-b689e417ce44d2a67d31d911ad99dd76fc4b7a34d66d3f20f2f649ef9252ed59)
  + www/admin/maintenance-encoding.php
    [maintenance-encoding.php](#diff-f600c64e523681fc7c9d221cc0d7635ed343a3238b9cc12f1dadfc64fb2abae6)
  + www/admin/maintenance-menus.php
    [maintenance-menus.php](#diff-10675c64cc77b78ea3e2aa6573a203a9eb64c5b4591c9874b4d462aa87dd4d53)
  + www/admin/maintenance-plugins.php
    [maintenance-plugins.php](#diff-95b0c7beff554b4a6e1026394f7a45a27d5b704c2f568b1a9a2cf95672397c25)
  + www/admin/maintenance-priority-calculate.php
    [maintenance-priority-calculate.php](#diff-096ea664c141542f1ade623059dff5a1ea2ced2f08984114fd979349f4b8ca2a)
  + www/admin/maintenance-priority.php
    [maintenance-priority.php](#diff-3d7e178969984026a4cf2bc64256bd59be53113008ba339c7afa500d44695997)
  + www/admin/maintenance-storage-move.php
    [maintenance-storage-move.php](#diff-8a1536899d868791ea6435bccbd7ba896ac62d56a222c4e180dbcea98fca65c2)
  + www/admin/maintenance-storage.php
    [maintenance-storage.php](#diff-911067c179fb12301c85eb21d8605b41eb296358cfe17d4dd7c8b88fd5ec8cdb)
  + www/admin/run-mpe.php
    [run-mpe.php](#diff-951800459b1808f21e0865a0a9cea447bacbfc1ae2ef63e86a1591315ce163fa)
  + www/admin/tracker-append.php
    [tracker-append.php](#diff-84b6dc712ef4809c5d162e7606c138969d2b5a302f2e08d1a810a3e00554a32d)
  + www/admin/tracker-variables.php
    [tracker-variables.php](#diff-3e8808af1dd3e2f237d3d5b7e25e6acc60a665d450fa496bd33b0c343efa9113)
  + www/admin/updates-history.php
    [updates-history.php](#diff-3df13a9ecec9325ee568bb908a30e55d237fa71ecf75dc1b6943ab3db36a1e2d)
  + www/admin/zone-modify.php
    [zone-modify.php](#diff-1700739795d6e5f79bb3949effed5183ee34826a6c2ef4d5cdbe5773f319b078)

## There are no files selected for viewing

2 changes: 2 additions & 0 deletions

2
[lib/OA/Admin/Template.php](#diff-7a57dab71d03947df99313bfb7c893054f68f90efa6443a6ba84ca0e45b68e6e "lib/OA/Admin/Template.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/lib/OA/Admin/Template.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -119,6 +119,8 @@ function init($templateName) |
|  |  | \*/ |
|  |  | $this->register\_function('rv\_add\_session\_token', array('OA\_Admin\_Template', '\_add\_session\_token')); |
|  |  |  |
|  |  | // Also assign a template variable for other usages |
|  |  | $this->assign("csrfToken", phpAds\_SessionGetToken()); |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[lib/max/Admin/Inventory/TrackerAppend.php](#diff-3e24ed19065e1a7dcb39917f19c3391aece1cb878952de499f5d446bf87dac23 "lib/max/Admin/Inventory/TrackerAppend.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/lib/max/Admin/Inventory/TrackerAppend.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -46,6 +46,7 @@ function \_\_construct() |
|  |  | { |
|  |  | $this->\_useDefaultDal(); |
|  |  |  |
|  |  | $this->csrf\_token = phpAds\_SessionGetToken(); |
|  |  | $this->advertiser\_id = MAX\_getValue('clientid', 0); |
|  |  | $this->tracker\_id = MAX\_getValue('trackerid', 0); |
|  |  | $this->assetPath = OX::assetPath(); |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[lib/max/Admin/Inventory/themes/TrackerAppend.html](#diff-0fd9f1e7682e01d3c49267c181823bc4fefdcfcdc7ce4ff11f99f2540b95e1f2 "lib/max/Admin/Inventory/themes/TrackerAppend.html")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/lib/max/Admin/Inventory/themes/TrackerAppend.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,7 +13,7 @@ |
|  |  | function MMM\_trackerAction(action, id) |
|  |  | { |
|  |  | var f = document.getElementById('trackerAppendForm'); |
|  |  |  |
|  |  |  |
|  |  | f.t\_action.value = action; |
|  |  | f.t\_id.value = id; |
|  |  | f.submit(); |
| Expand All | | @@ -26,6 +26,7 @@ |
|  |  | <span class='tab-s'>You have unsaved changes on this page, make sure you press &quot;Save Changes&quot; when finished</span><br> |
|  |  | </div> |
|  |  | <form id="trackerAppendForm" class="section" method="post"> |
|  |  | <input type="hidden" name="token" value="{csrf\_token}" /> |
|  |  | <input type="hidden" name="clientid" value="{advertiser\_id}" /> |
|  |  | <input type="hidden" name="trackerid" value="{tracker\_id}" /> |
|  |  | <input type="hidden" name="t\_action" /> |
| Expand Down | |  |

41 changes: 30 additions & 11 deletions

41
[lib/max/other/html.php](#diff-e6c67e96e3e35a30749406e22a885a7fef562eda4da930b7770748ee53694f00 "lib/max/other/html.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/lib/max/other/html.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -1147,6 +1147,7 @@ function MAX\_displayAcls($acls, $aParams) |
|  |  | $conf = $GLOBALS['\_MAX']['CONF']; |
|  |  |  |
|  |  | echo "<form action='{$page}' method='post'>"; |
|  |  | echo "<input type='hidden' name='token' value='".urlencode(phpAds\_SessionGetToken())."' />"; |
|  |  |  |
|  |  | echo "<label><img src='" . OX::assetPath() . "/images/icon-acl-add.gif' align='absmiddle'>&nbsp;". $GLOBALS['strACLAdd'] .": &nbsp;"; |
|  |  | echo "<select name='type' accesskey='{$GLOBALS['keyAddNew']}' tabindex='".($tabindex++)."'>"; |
| Expand Down  Expand Up | | @@ -1689,11 +1690,14 @@ function addAdvertiserPageToolsAndShortcuts($advertiserId) |
|  |  | function addTrackerPageTools($advertiserId, $trackerId, $aOtherAdvertisers) |
|  |  | { |
|  |  | if (OA\_Permission::isAccount(OA\_ACCOUNT\_ADMIN) || OA\_Permission::isAccount(OA\_ACCOUNT\_MANAGER)) { |
|  |  | $token = phpAds\_SessionGetToken(); |
|  |  |  |
|  |  | //duplicate |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "tracker-modify.php?clientid=".$advertiserId."&trackerid=".$trackerId."&duplicate=true&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconTrackerDuplicate"); |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "tracker-modify.php?token=".urlencode($token)."&clientid=".$advertiserId."&trackerid=".$trackerId."&duplicate=true&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconTrackerDuplicate"); |
|  |  |  |
|  |  | //move to |
|  |  | $form = "<form action='" . MAX::constructUrl(MAX\_URL\_ADMIN, 'tracker-modify.php') . "'> |
|  |  | <input type='hidden' name='token' value='".htmlspecialchars($token, ENT\_QUOTES)."'> |
|  |  | <input type='hidden' name='trackerid' value='$trackerId' |
|  |  | <input type='hidden' name='clientid' value='$advertiserId' |
|  |  | <input type='hidden' name='returnurl' value='tracker-edit.php'> |
| Expand All | | @@ -1706,7 +1710,7 @@ function addTrackerPageTools($advertiserId, $trackerId, $aOtherAdvertisers) |
|  |  |  |
|  |  | //delete |
|  |  | $deleteConfirm = phpAds\_DelConfirm($GLOBALS['strConfirmDeleteTracker']); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "tracker-delete.php?token=" . urlencode(phpAds\_SessionGetToken()) . "&clientid=".$advertiserId."&trackerid=".$trackerId."&returnurl=advertiser-trackers.php"), "iconDelete", null, $deleteConfirm); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "tracker-delete.php?token=".urlencode($token)."&clientid=".$advertiserId."&trackerid=".$trackerId."&returnurl=advertiser-trackers.php"), "iconDelete", null, $deleteConfirm); |
|  |  | addPageShortcut($GLOBALS['strBackToTrackers'], MAX::constructUrl(MAX\_URL\_ADMIN, "advertiser-trackers.php?clientid=$advertiserId"), "iconBack"); |
|  |  | } |
|  |  | } |
| Expand All | | @@ -1717,13 +1721,17 @@ function addCampaignPageTools($clientid, $campaignid, $aOtherAdvertisers, $aEnti |
|  |  | global $phpAds\_TextDirection; |
|  |  |  |
|  |  | if (!OA\_Permission::isAccount(OA\_ACCOUNT\_ADVERTISER)) { |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "campaign-modify.php?duplicate=1&clientid=$clientid&campaignid=$campaignid&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconCampaignDuplicate"); |
|  |  |  |
|  |  | $token = phpAds\_SessionGetToken(); |
|  |  |  |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "campaign-modify.php?token=".urlencode($token)."&duplicate=1&clientid=$clientid&campaignid=$campaignid&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconCampaignDuplicate"); |
|  |  |  |
|  |  | if (OA\_Permission::hasAccessToObject('campaigns', $campaignid, OA\_Permission::OPERATION\_MOVE)) { |
|  |  | $form = "<form action='" . MAX::constructUrl(MAX\_URL\_ADMIN, 'campaign-modify.php') . "'> |
|  |  | <input type='hidden' name='token' value='".htmlspecialchars($token, ENT\_QUOTES)."'> |
|  |  | <input type='hidden' name='clientid' value='$clientid'> |
|  |  | <input type='hidden' name='campaignid' value='$campaignid'> |
|  |  | <input type='hidden' name='returnurl' value='".htmlspecialchars(basename($\_SERVER['SCRIPT\_NAME']))."'> |
|  |  | <input type='hidden' name='returnurl' value='".htmlspecialchars(basename($\_SERVER['SCRIPT\_NAME'], ENT\_QUOTES))."'> |
|  |  | <select name='newclientid'>"; |
|  |  | $aOtherAdvertisers = \_multiSort($aOtherAdvertisers,'name','advertiser\_id'); |
|  |  | foreach ($aOtherAdvertisers as $aOtherAdvertiser) { |
| Expand All | | @@ -1740,7 +1748,7 @@ function addCampaignPageTools($clientid, $campaignid, $aOtherAdvertisers, $aEnti |
|  |  | } |
|  |  |  |
|  |  | $deleteConfirm = phpAds\_DelConfirm($GLOBALS['strConfirmDeleteCampaign']); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "campaign-delete.php?token=" . urlencode(phpAds\_SessionGetToken()) . "&clientid=$clientid&campaignid=$campaignid&returnurl=advertiser-campaigns.php"), "iconDelete", null, $deleteConfirm); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "campaign-delete.php?token=".urlencode($token)."&clientid=$clientid&campaignid=$campaignid&returnurl=advertiser-campaigns.php"), "iconDelete", null, $deleteConfirm); |
|  |  | } |
|  |  |  |
|  |  | //shortcuts |
| Expand All | | @@ -1761,16 +1769,20 @@ function addCampaignPageTools($clientid, $campaignid, $aOtherAdvertisers, $aEnti |
|  |  |  |
|  |  | function addBannerPageTools($advertiserId, $campaignId, $bannerId, $aOtherCampaigns, $aOtherBanners, $aEntities) |
|  |  | { |
|  |  | global $phpAds\_TextDirection; |
|  |  |  |
|  |  | if (empty($bannerId)) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | global $phpAds\_TextDirection; |
|  |  | $token = phpAds\_SessionGetToken(); |
|  |  |  |
|  |  | //duplicate |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "banner-modify.php?duplicate=true&clientid=$advertiserId&campaignid=$campaignId&bannerid=$bannerId&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconBannerDuplicate"); |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "banner-modify.php?token=".urlencode($token)."&duplicate=true&clientid=$advertiserId&campaignid=$campaignId&bannerid=$bannerId&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconBannerDuplicate"); |
|  |  |  |
|  |  | //move to |
|  |  | $form = "<form action='" . MAX::constructUrl(MAX\_URL\_ADMIN, 'banner-modify.php') . "'> |
|  |  | <input type='hidden' name='token' value='".htmlspecialchars($token, ENT\_QUOTES)."'> |
|  |  | <input type='hidden' name='clientid' value='$advertiserId'> |
|  |  | <input type='hidden' name='campaignid' value='$campaignId'> |
|  |  | <input type='hidden' name='bannerid' value='$bannerId'> |
| Expand All | | @@ -1795,6 +1807,7 @@ function addBannerPageTools($advertiserId, $campaignId, $bannerId, $aOtherCampai |
|  |  | //apply to |
|  |  | if (basename($\_SERVER['SCRIPT\_NAME']) == 'banner-acl.php') { |
|  |  | $form = "<form action='" . MAX::constructUrl(MAX\_URL\_ADMIN, 'banner-modify.php') . "'> |
|  |  | <input type='hidden' name='token' value='".htmlspecialchars($token, ENT\_QUOTES)."'> |
|  |  | <input type='hidden' name='clientid' value='$advertiserId'> |
|  |  | <input type='hidden' name='campaignid' value='$campaignId'> |
|  |  | <input type='hidden' name='bannerid' value='$bannerId'> |
| Expand All | | @@ -1815,7 +1828,7 @@ function addBannerPageTools($advertiserId, $campaignId, $bannerId, $aOtherCampai |
|  |  | //delete |
|  |  | if (!OA\_Permission::isAccount(OA\_ACCOUNT\_ADVERTISER)) { |
|  |  | $deleteConfirm = phpAds\_DelConfirm($GLOBALS['strConfirmDeleteBanner']); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "banner-delete.php?token=" . urlencode(phpAds\_SessionGetToken()) . "&clientid=$advertiserId&campaignid=$campaignId&bannerid=$bannerId&returnurl=campaign-banners.php"), "iconDelete", null, $deleteConfirm); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "banner-delete.php?token=".urlencode($token)."&clientid=$advertiserId&campaignid=$campaignId&bannerid=$bannerId&returnurl=campaign-banners.php"), "iconDelete", null, $deleteConfirm); |
|  |  | } |
|  |  |  |
|  |  | /\* Shortcuts \*/ |
| Expand All | | @@ -1840,6 +1853,9 @@ function addWebsitePageTools($websiteId) |
|  |  | function addZonePageTools($affiliateid, $zoneid, $aOtherPublishers, $aEntities) |
|  |  | { |
|  |  | global $phpAds\_TextDirection; |
|  |  |  |
|  |  | $token = phpAds\_SessionGetToken(); |
|  |  |  |
|  |  | //duplicate |
|  |  | if (OA\_Permission::isAccount(OA\_ACCOUNT\_ADMIN) |
|  |  | || OA\_Permission::isAccount(OA\_ACCOUNT\_MANAGER) |
| Expand All | | @@ -1851,6 +1867,7 @@ function addZonePageTools($affiliateid, $zoneid, $aOtherPublishers, $aEntities) |
|  |  | if (OA\_Permission::isAccount(OA\_ACCOUNT\_ADMIN) |
|  |  | || OA\_Permission::isAccount(OA\_ACCOUNT\_MANAGER)) { |
|  |  | $form = "<form action='" . MAX::constructUrl(MAX\_URL\_ADMIN, 'zone-modify.php') . "'> |
|  |  | <input type='hidden' name='token' value='".htmlspecialchars($token, ENT\_QUOTES)."'> |
|  |  | <input type='hidden' name='affiliateid' value='$affiliateid'> |
|  |  | <input type='hidden' name='zoneid' value='$zoneid'> |
|  |  | <input type='hidden' name='returnurl' value='".htmlspecialchars(basename($\_SERVER['SCRIPT\_NAME']))."'> |
| Expand All | | @@ -1872,7 +1889,7 @@ function addZonePageTools($affiliateid, $zoneid, $aOtherPublishers, $aEntities) |
|  |  | || OA\_Permission::isAccount(OA\_ACCOUNT\_MANAGER) |
|  |  | || OA\_Permission::hasPermission(OA\_PERM\_ZONE\_DELETE)) { |
|  |  | $deleteConfirm = phpAds\_DelConfirm($GLOBALS['strConfirmDeleteZone']); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "zone-delete.php?token=" . urlencode(phpAds\_SessionGetToken()) . "&affiliateid=$affiliateid&zoneid=$zoneid&returnurl=affiliate-zones.php"), "iconDelete", null, $deleteConfirm); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "zone-delete.php?token=".urlencode($token)."&affiliateid=$affiliateid&zoneid=$zoneid&returnurl=affiliate-zones.php"), "iconDelete", null, $deleteConfirm); |
|  |  | } |
|  |  |  |
|  |  | //shortcut |
| Expand All | | @@ -1890,12 +1907,14 @@ function addChannelPageTools($agencyid, $websiteId, $channelid, $channelType) |
|  |  | $deleteReturlUrl = MAX::constructUrl(MAX\_URL\_ADMIN, 'channel-index.php'); |
|  |  | } |
|  |  |  |
|  |  | $token = phpAds\_SessionGetToken(); |
|  |  |  |
|  |  | //duplicate |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "channel-modify.php?duplicate=true&agencyid=$agencyid&affiliateid=$websiteId&channelid=$channelid&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconTargetingChannelDuplicate"); |
|  |  | addPageLinkTool($GLOBALS["strDuplicate"], MAX::constructUrl(MAX\_URL\_ADMIN, "channel-modify.php?token=".urlencode($token)."&duplicate=true&agencyid=$agencyid&affiliateid=$websiteId&channelid=$channelid&returnurl=".urlencode(basename($\_SERVER['SCRIPT\_NAME']))), "iconTargetingChannelDuplicate"); |
|  |  |  |
|  |  | //delete |
|  |  | $deleteConfirm = phpAds\_DelConfirm($GLOBALS['strConfirmDeleteChannel']); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "channel-delete.php?token=" . urlencode(phpAds\_SessionGetToken()) . "&agencyid=$agencyid&affiliateid=$websiteId&channelid=$channelid&returnurl=$deleteReturlUrl"), "iconDelete", null, $deleteConfirm); |
|  |  | addPageLinkTool($GLOBALS["strDelete"], MAX::constructUrl(MAX\_URL\_ADMIN, "channel-delete.php?token=".urlencode($token)."&agencyid=$agencyid&affiliateid=$websiteId&channelid=$channelid&returnurl=$deleteReturlUrl"), "iconDelete", null, $deleteConfirm); |
|  |  | } |
|  |  |  |
|  |  |  |
| Expand Down | |  |

5 changes: 5 additions & 0 deletions

5
[lib/templates/admin/campaign-zone.html](#diff-7ae2421c46bd37ae37ac50b979227334509e1f7faeea11ae6d60ebf79780e85d "lib/templates/admin/campaign-zone.html")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/lib/templates/admin/campaign-zone.html)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,6 +13,7 @@ |
|  |  |  |
|  |  | <form id="zoneLinkingForm"> |
|  |  | <div id="campaign-zone" class="new-form"> |
|  |  | <input id="csrf-token" type="hidden" value="{$csrfToken|escape}" /> |
|  |  | <input id="advertiser-id" type="hidden" value="{$advertiserId}" /> |
|  |  | <input id="campaign-id" type="hidden" value="{$campaignId}" /> |
|  |  |  |
| Expand Down  Expand Up | | @@ -213,6 +214,7 @@ <h3 class="filter-panel-title">{t str=LinkedZones}</h3> |
|  |  | } |
|  |  |  |
|  |  | var postData = { |
|  |  | "token": $("#csrf-token").val(), |
|  |  | "clientid": $("#advertiser-id").val(), |
|  |  | "campaignid": $("#campaign-id").val(), |
|  |  | "text-linked": quickSearchLinked, |
| Expand All | | @@ -238,6 +240,9 @@ <h3 class="filter-panel-title">{t str=LinkedZones}</h3> |
|  |  | updatePanel(data, "available"); |
|  |  | updatePanel(data, "linked"); |
|  |  |  |
|  |  | // Refresh token |
|  |  | $("#csrf-token").val(extractPart(data, "value", "token")); |
|  |  |  |
|  |  | $("#linking-status").html(extractPart(data, "info", "result")).stop().show().css("opacity", "1"); |
|  |  | if (window.linkingTimout) { |
|  |  | window.linkingTimout.clearTimeout(); |
| Expand Down | |  |

4 changes: 2 additions & 2 deletions

4
[www/admin/banner-modify.php](#diff-41e9dd3b81ae182c45af1a99d52074bc484b1e7cbde4ab70ad8ea8c9b3a71227 "www/admin/banner-modify.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/banner-modify.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -31,13 +31,13 @@ |
|  |  | // Security check |
|  |  | OA\_Permission::enforceAccount(OA\_ACCOUNT\_MANAGER); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Main code \*/ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | if (!empty($bannerid)) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | OA\_Permission::enforceAccessToObject('banners', $bannerid); |
|  |  |  |
|  |  | if (!empty($moveto) && isset($moveto\_x)) { |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/campaign-modify.php](#diff-984712b654c62af8d37eaca64083cbd157fb1e91cdca4d8e5794ad63e1014274 "www/admin/campaign-modify.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/campaign-modify.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -43,6 +43,8 @@ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | if (!empty($campaignid)) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (!empty($duplicate)) { |
|  |  | // Duplicate the campaign |
|  |  | $doCampaigns = OA\_Dal::factoryDO('campaigns'); |
| Expand Down | |  |

5 changes: 4 additions & 1 deletion

5
[www/admin/campaign-zone-link.php](#diff-011c666312bb43a49b4011c3ac20851eaab827d540930102f8cd0226f50b9c03 "www/admin/campaign-zone-link.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/campaign-zone-link.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -38,6 +38,8 @@ |
|  |  | OA\_Permission::enforceAccount ( OA\_ACCOUNT\_MANAGER ); |
|  |  | OA\_Permission::enforceAccessToObject ( 'campaigns', $campaignid ); |
|  |  |  |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $aZonesIds = array(); |
|  |  | $aZonesIdsHash = array(); |
|  |  | foreach ($\_REQUEST['ids'] as $zone) { |
| Expand Down  Expand Up | | @@ -103,4 +105,5 @@ |
|  |  | }; |
|  |  | echo "<!--result-info-end-->"; |
|  |  |  |
|  |  | ?> |
|  |  | // CSRF Token |
|  |  | echo "<!--token-value-start-->".phpAds\_SessionGetToken()."<!--token-value-end-->"; |

2 changes: 2 additions & 0 deletions

2
[www/admin/channel-acl.php](#diff-ca5553ec80788fcfde228dcfdce26cbd29eed223a04574688c492b0535b223e6 "www/admin/channel-acl.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/channel-acl.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -59,6 +59,8 @@ |
|  |  | $acl = MAX\_AclAdjust($acl, $action); |
|  |  | } |
|  |  | elseif (!empty($submit)) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $acl = (isset($acl)) ? $acl : array(); |
|  |  | // Only save when inputs are valid |
|  |  | if (OX\_AclCheckInputsFields($acl, $pageName) === true) { |
| Expand Down | |  |

2 changes: 2 additions & 0 deletions

2
[www/admin/channel-modify.php](#diff-bacef05d7005921606c825078ee400656c3725600410f4627839d987c09c9c9a "www/admin/channel-modify.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/channel-modify.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -34,6 +34,8 @@ |
|  |  |  |
|  |  | // Security check |
|  |  | if (isset($channelid) && $channelid != '') { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | if (isset($duplicate) && $duplicate == 'true') { |
|  |  |  |
|  |  | //get channel old channel name |
| Expand Down | |  |

2 changes: 1 addition & 1 deletion

2
[www/admin/lib-maintenance-priority.inc.php](#diff-fad0c90d0895b41f291d8d80269462362e1243f9fd0a80da250290c8bd216dfe "www/admin/lib-maintenance-priority.inc.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/lib-maintenance-priority.inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -13,7 +13,7 @@ |
|  |  | function OA\_runMPE() |
|  |  | { |
|  |  | $objResponse = new xajaxResponse(); |
|  |  | $objResponse->addAssign("run-mpe", "innerHTML", "<img src='run-mpe.php' />"); |
|  |  | $objResponse->addAssign("run-mpe", "innerHTML", "<img src='run-mpe.ph?token=".urlencode(phpAds\_SessionGetToken())."' />"); |
|  |  | return $objResponse; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[www/admin/maintenance-acl-check.php](#diff-e2f57eb1e0973b3d8ae1536d33bbe71c9378d8edb8f1d90e051b0d7fdf01f672 "www/admin/maintenance-acl-check.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/maintenance-acl-check.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -38,6 +38,8 @@ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | if (!empty($action) && ($action == 'Recompile')) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | MAX\_AclReCompileAll(); |
|  |  | echo "<strong>$strAllBannerChannelCompiled</strong><br />"; |
|  |  | } |
| Expand Down  Expand Up | | @@ -94,6 +96,7 @@ |
|  |  | echo "<br /><strong>". $strErrorsFound ."</strong><br /><br />"; |
|  |  | echo $strRepairCompiledLimitations; |
|  |  | echo "<form action='' METHOD='GET'>"; |
|  |  | echo "<input type='hidden' name='token' value='".htmlspecialchars(phpAds\_SessionGetToken(), ENT\_QUOTES)."' />"; |
|  |  | echo "<input type='submit' name='action' value='$strRecompile' />"; |
|  |  | echo "</form>"; |
|  |  | } |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[www/admin/maintenance-appendcode-check.php](#diff-1e7e18d07184e3f23ee51d477e88a7556b543fc02b90d37847ce24ecc96c44fc "www/admin/maintenance-appendcode-check.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/maintenance-appendcode-check.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -40,6 +40,8 @@ |
|  |  | $tr = new MAX\_Dal\_Inventory\_Trackers(); |
|  |  |  |
|  |  | if (!empty($action) && ($action == 'Recompile')) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $tr->recompileAppendCodes(); |
|  |  | echo "<strong>$strAppendCodesRecompiled<br />"; |
|  |  | } |
| Expand Down  Expand Up | | @@ -68,6 +70,7 @@ |
|  |  | echo "<br /><strong>$strErrorsFound</strong><br /><br />"; |
|  |  | echo "$strRepairAppenedCodes<br />"; |
|  |  | echo "<form action='' METHOD='GET'>"; |
|  |  | echo "<input type='hidden' name='token' value='".htmlspecialchars(phpAds\_SessionGetToken(), ENT\_QUOTES)."' />"; |
|  |  | echo "<input type='submit' name='action' value='$strRecompile' />"; |
|  |  | echo "</form>"; |
|  |  | } |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[www/admin/maintenance-banners-check.php](#diff-b689e417ce44d2a67d31d911ad99dd76fc4b7a34d66d3f20f2f649ef9252ed59 "www/admin/maintenance-banners-check.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/maintenance-banners-check.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -32,6 +32,8 @@ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | if (!empty($action) && ($action == 'Rebuild')) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | $result = processBanners(true); |
|  |  | if (empty($result['errors'])) { |
|  |  | if (empty($returnurl)) { $returnurl = 'maintenance-banners-check.php'; } |
| Expand All | | @@ -57,6 +59,7 @@ |
|  |  | \_showPageHeader(); |
|  |  | echo $GLOBALS['strBannerCacheDifferencesFound']; |
|  |  | echo "<form action='' METHOD='GET'>"; |
|  |  | echo "<input type='hidden' name='token' value='".htmlspecialchars(phpAds\_SessionGetToken(), ENT\_QUOTES)."' />"; |
|  |  | echo "<input type='submit' name='action' value='{$GLOBALS['strBannerCacheRebuildButton']}' />"; |
|  |  | echo "</form>"; |
|  |  | } else { |
| Expand Down | |  |

3 changes: 3 additions & 0 deletions

3
[www/admin/maintenance-encoding.php](#diff-f600c64e523681fc7c9d221cc0d7635ed343a3238b9cc12f1dadfc64fb2abae6 "www/admin/maintenance-encoding.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/maintenance-encoding.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -105,6 +105,8 @@ |
|  |  | ); |
|  |  |  |
|  |  | if (!empty($\_POST['encConfirm'])) { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | \_iterateTableFields($aTableFields, true); |
|  |  | Header("Location: maintenance-maintenance.php"); |
|  |  | } |
| Expand Down  Expand Up | | @@ -201,6 +203,7 @@ function \_iterateTableFields($aTableFields, $execute = false) |
|  |  | } |
|  |  | } |
|  |  | echo "</table><br />"; |
|  |  | echo "<input type='hidden' name='token' value='".htmlspecialchars(phpAds\_SessionGetToken(), ENT\_QUOTES)."' />"; |
|  |  | echo "<input type='submit' name='encConfirm' value='{$GLOBALS['strConvert']}' /> <input type='button' name='encCancel' value='{$GLOBALS['strCancel']}' onclick='javascript:document.location = \"" . $\_SERVER['SCRIPT\_NAME'] . "\";' />"; |
|  |  | } |
|  |  |  |
| Expand Down | |  |

4 changes: 3 additions & 1 deletion

4
[www/admin/maintenance-menus.php](#diff-10675c64cc77b78ea3e2aa6573a203a9eb64c5b4591c9874b4d462aa87dd4d53 "www/admin/maintenance-menus.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/e563ca61e4f3b7210cb61f53284adaa8aef4a49a/www/admin/maintenance-menus.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -40,6 +40,8 @@ |
|  |  |  |
|  |  | if (!empty($action)) |
|  |  | { |
|  |  | OA\_Permission::checkSessionToken(); |
|  |  |  |
|  |  | switch ($action) |
|  |  | { |
|  |  | case 'build': |
| Expand All | | @@ -53,7 +55,7 @@ |
|  |  | } |
|  |  |  |
|  |  | phpAds\_ShowBreak(); |
|  |  | echo "<img src='" . OX::assetPath() . "/images/".$phpAds\_TextDirection."/icon-undo.gif' border='0' align='absmiddle'>&nbsp;<a href='maintenance-menus.php?action=build'>Rebuild Menu Cache</a>&nbsp;&nbsp;"; |
|  |  | echo "<img src='" . OX::assetPath() . "/images/".$phpAds\_TextDirection."/icon-undo.gif' border='0' align='absmiddle'>&nbsp;<a href='maintenance-menus.php?action=build&amp;token=".urlencode(phpAds\_SessionGetToken())."'>Rebuild Menu Cache</a>&nbsp;&nbsp;"; |
|  |  | phpAds\_ShowBreak(); |
|  |  |  |
|  |  |  |
| Expand Down | |  |

 Loading

Oops, something went wrong.
 Retry

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `e563ca6`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2Fe563ca61e4f3b7210cb61f53284adaa8aef4a49a) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


