Based on the provided information, here's an analysis of the vulnerability addressed by the commits:

**Root Cause of Vulnerability:**

The vulnerability stems from insufficient filtering of MIME types when exporting images from CardDAV entries. The `ImageExportPlugin` was not properly restricting the allowed MIME types for images, potentially allowing arbitrary file types to be served as images.

**Weaknesses/Vulnerabilities Present:**

-   **MIME Type Bypass:** The application was not correctly validating the `Content-Type` of exported images from CardDAV. This could allow an attacker to embed malicious content disguised as an image by manipulating the `Content-Type` parameter within the vCard data.

**Impact of Exploitation:**

-   **Cross-Site Scripting (XSS):** If an attacker could include HTML or JavaScript in a file with an incorrect image MIME type, they could potentially execute arbitrary code in the context of another user's session when that user views the contact's information.
-   **Information Disclosure:** By serving malicious content, an attacker might be able to perform actions such as session hijacking, or access sensitive data within the userâ€™s context.
-  **Malware delivery**: Serving executable file types as images could result in malware delivery to users if the user attempts to open the image using a vulnerable software

**Attack Vectors:**

-   **Manipulated vCard Data:** An attacker could create or modify a vCard entry (contact card) to include a `PHOTO` property with a malicious payload and an incorrect image MIME type that is not properly validated.
-   **CardDAV Endpoint:** The attacker interacts with the CardDAV endpoint to retrieve the vCard data with the manipulated image property.
-   **Retrieval via Image Export Plugin:** When a user requests to view the contact's image, the `ImageExportPlugin` would serve the malicious payload without proper validation of the mime-type.

**Required Attacker Capabilities/Position:**

-   **Ability to create/modify CardDAV entries:** The attacker needs the ability to create or modify contacts to include manipulated image data.
-   **User interaction:** The user needs to request to view the contact's image (either directly through the UI or indirectly through another process) to trigger the vulnerability.

**Technical Details:**

The provided code diffs highlight the following key changes:

*   **`ImageExportPlugin.php`:**
    *   The code now explicitly defines an array `$allowedContentTypes` containing the allowed MIME types: `image/png`, `image/jpeg`, and `image/gif`.
    *   It now checks if the extracted `$type` is present in the `$allowedContentTypes` array. If the `$type` is not in the allowed list, the content type is forced to `application/octet-stream`.

*   **`ImageExportPluginTest.php`:**
    *   The tests were modified to correctly check the content type when an image is served.
    *   New test cases were added to verify that invalid MIME types are properly handled, and the `Content-Type` is set to `application/octet-stream`.

**Additional Notes:**

*   The commit messages indicate this issue is related to limiting the mime types for images exported from carddav.
*   The vulnerability exists because the server doesn't restrict the content types and returns what is provided in the vCard.
*   The fix ensures that only a limited number of MIME types are allowed, and falls back to `application/octet-stream` for any other type. This mitigates the risk of malicious content being served as images.

This analysis is based solely on the provided commit diffs.