=== Content from access.redhat.com_8698f5d5_20250126_034332.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Français](https://access.redhat.com/changeLanguage?language=fr)
* [한국어](https://access.redhat.com/changeLanguage?language=ko)
* [日本語](https://access.redhat.com/changeLanguage?language=ja)
* [中文 (中国)](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

 © 2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from bugzilla.redhat.com_5e4df6b4_20250124_214230.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3DCVE-2016-9574)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3DCVE-2016-9574)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3DCVE-2016-9574)+ Login using a Red Hat Bugzilla account
  + Forgot Password
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla – Bug 1404568

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug 1404568**](show_bug.cgi?id=1404568)
(CVE-2016-9574)
- [CVE-2016-9574](https://access.redhat.com/security/cve/CVE-2016-9574) nss: Remote DoS during session handshake when using SessionTicket extention and ECDHE-ECDSA

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-9574 nss: Remote DoS during session handshake when using SessionTick...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-9574 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") |  | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1404570](show_bug.cgi?id=1404570) | | TreeView+ | [depends on](buglist.cgi?bug_id=1404568&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1404568&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-12-14 06:52 UTC by Huzaifa S. Sidhpurwala | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2019-09-29 14:02 UTC ([History](show_activity.cgi?id=1404568)) | | [CC List:](page.cgi?id=fields.html#cclist) | 8 users (show)  carnil dueno emaldona kdudka kengert rrelyea sardella slawomir | | Fixed In Version: | nss 3.30 | | | Doc Type: | If docs needed, set a value | | | Doc Text: |  | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2017-01-06 08:41:33 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | | |  |
| --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1404568#c0)  Huzaifa S. Sidhpurwala    2016-12-14 06:52:07 UTC  ``` A denial of service flaw was found in the way NSS handled handshake packets when SessionTicket extension was enabled on the TLS server side and ECDSA certificates were used. A remote attacker could use this flaw to crash TLS servers compiled against NSS.  More details and reproducer available at:  <https://bugzilla.mozilla.org/show_bug.cgi?id=1320695>   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1404568&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from bugzilla.mozilla.org_75a1c856_20250124_214229.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1320695)
* [XML](/show_bug.cgi?ctype=xml&id=1320695)

Closed
[Bug 1320695](/show_bug.cgi?id=1320695)

Opened 8 years ago
Closed 8 years ago

# Enable use of session ticket keys if server has no RSA key pair

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

Enable use of session ticket keys if server has no RSA key pair

## Categories

### (NSS :: Libraries, defect)

[Product:](/describecomponents.cgi?product=NSS)

NSS
▾

NSS
Network Security Services - a cross-platform
security library ([more info](http://www.mozilla.org/projects/security/pki/nss/))
[See Open Bugs in This Product](/buglist.cgi?product=NSS&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=NSS)
Watch This Product

[Component:](/describecomponents.cgi?product=NSS&component=Libraries#Libraries)

Libraries
▾

NSS :: Libraries
Libraries for client support of SSL v2 and v3, TLS, PKCS #5,
PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 certificates,
and other security standards
[See Open Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=NSS&component=Libraries&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=NSS&component=Libraries)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

3.27

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

*Not set*

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

## Tracking

### (Not tracked)

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

RESOLVED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

3.30

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Accessibility Severity | --- |
| --- | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| relnote-firefox |  | --- |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: frantisek, Assigned: mt)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/46e6b92a08f8b5ece24df3416e36f4cc?d=mm&size=40)  [mt](/user_profile?user_id=438654)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/0146abf36c6d386d10c1e1c8c125042f?d=mm&size=40)  [frantisek](/user_profile?user_id=584214)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/38f561698d679a724938d4600c0f8b52?d=mm&size=40)  [beurdouche](/user_profile?user_id=622637)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

6 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

---

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

---

[Keywords:](/describekeywords.cgi)

---

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

|  | behind-pref |  |
| --- | --- | --- |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |
|  | in-testsuite |  |
|  | qe-verify |  |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [proposed patch](/attachment.cgi?id=8817168)  [8 years ago](#c1)  [Daiki Ueno [:ueno]](/user_profile?user_id=565522)   2.58 KB, patch |  | [Details](/attachment.cgi?id=8817168&action=edit) | [Diff](/attachment.cgi?id=8817168&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1320695&attachment=8817168) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Frantisek Sumsal](/user_profile?user_id=584214)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1320695#c0)• 8 years ago |
|  | |

User Agent: Mozilla/5.0 (X11; Fedora; Linux x86\_64; rv:48.0) Gecko/20100101 Firefox/48.0
Build ID: 20160729111717
Steps to reproduce:
# NSS\_CIPHER="C00A"
# OPENSSL\_CIPHER="ECDHE-ECDSA-AES256-SHA"
# ulimit -c unlimited
# openssl ecparam -genkey -name prime256v1 -out ec.key
# openssl req -new -x509 -key ec.key -out ec-cert.pem -days 3650 -subj "/CN=localhost" -nodes
# openssl pkcs12 -name ec -export -inkey ec.key -out ec.p12 -in ec-cert.pem -passout "pass:"
# mkdir nssdb
# certutil -N --empty-password -d sql:./nssdb
# certutil -A -d sql:./nssdb/ -n ec -t ',,' -a -i ec-cert.pem
# pk12util -i ec.p12 -d sql:./nssdb -W ''
# /usr/lib64/nss/unsupported-tools/selfserv -d sql:./nssdb/ -p 4433 -V tls1.0: -H 1 -e ec -c :$NSS\_CIPHER -u &>server.log &
# sleep 3
# openssl s\_client -connect localhost:4433 -CAfile ec-cert.pem -cipher $OPENSSL\_CIPHER -sess\_out sess.pem 2>>client\_err.log >>client\_out.log < /dev/null
# openssl s\_client -connect localhost:4433 -CAfile ec-cert.pem -cipher $OPENSSL\_CIPHER -sess\_out sess.pem 2>>client\_err.log >>client\_out.log < /dev/null
Actual results:
# cat client\_err.log
depth=0 CN = localhost
verify return:1
139942008751992:error:140790E5:SSL routines:ssl23\_write:ssl handshake failure:s23\_lib.c:177:
depth=0 CN = localhost
verify return:1
139640958179192:error:140790E5:SSL routines:ssl23\_write:ssl handshake failure:s23\_lib.c:177:
# cat server.log
selfserv: HDX PR\_Read returned error 0:
Success
selfserv: HDX PR\_Read returned error -5925:
The one-time function was previously called and failed. Its error code is no longer available
Expected results:
Handshake should not fail and selfserv should be able to handle following connections.
Example using SessionID:
# NSS\_CIPHER="C00A"
# OPENSSL\_CIPHER="ECDHE-ECDSA-AES256-SHA"
# ulimit -c unlimited
# openssl ecparam -genkey -name prime256v1 -out ec.key
# openssl req -new -x509 -key ec.key -out ec-cert.pem -days 3650 -subj "/CN=localhost" -nodes
# openssl pkcs12 -name ec -export -inkey ec.key -out ec.p12 -in ec-cert.pem -passout "pass:"
# mkdir nssdb
# certutil -N --empty-password -d sql:./nssdb
# certutil -A -d sql:./nssdb/ -n ec -t ',,' -a -i ec-cert.pem
# pk12util -i ec.p12 -d sql:./nssdb -W ''
# /usr/lib64/nss/unsupported-tools/selfserv -d sql:./nssdb/ -p 4433 -V tls1.0: -H 1 -e ec -c :$NSS\_CIPHER &>server.log &
# sleep 3
# openssl s\_client -connect localhost:4433 -CAfile ec-cert.pem -cipher $OPENSSL\_CIPHER -sess\_out sess.pem -no\_ticket 2>>client\_err.log >>client\_out.log < /dev/null
# openssl s\_client -connect localhost:4433 -CAfile ec-cert.pem -cipher $OPENSSL\_CIPHER -sess\_out sess.pem -no\_ticket 2>>client\_err.log >>client\_out.log < /dev/null
## RESULTS:
# cat server.log
# cat client\_err.log
depth=0 CN = localhost
verify return:1
DONE
depth=0 CN = localhost
verify return:1
DONE

|  | [Daiki Ueno [:ueno]](/user_profile?user_id=565522) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1320695#c1)• 8 years ago |
|  | |

Attached patch

[proposed patch](attachment.cgi?id=8817168&action=diff)
— [Details](attachment.cgi?id=8817168&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1320695&attachment=8817168)

This happens because of missing RSA keypair on the server side, which is used to wrap and cache the generated session ticket keys. IMO, in that case NSS could disable caching and continue the handshake with the generated keys.
[Attachment #8817168](/attachment.cgi?id=8817168&action=edit "proposed patch") -
Flags: review?(kaie)

|  | [Huzaifa Sidhpurwala](/user_profile?user_id=331752) |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1320695#c2)• 8 years ago |
|  | |

Note: This is a remote DoS flaw. we have assigned [CVE-2016-9574](https://www.cve.org/CVERecord?id=CVE-2016-9574) to this issue.

|  | [Daiki Ueno [:ueno]](/user_profile?user_id=565522) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1320695#c3)• 8 years ago |
|  | |

(In reply to Huzaifa Sidhpurwala from [comment #2](/show_bug.cgi?id=1320695#c2 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair"))
> Note: This is a remote DoS flaw. we have assigned [CVE-2016-9574](https://www.cve.org/CVERecord?id=CVE-2016-9574) to this
> issue.
I'm not sure if this is really a remote DoS flaw. Even though selfserv prints a misleading message ("The one-time function was previously called and failed."), the behavior that the client can observe is identical between the first and second calls: the connection is terminated because the session ticket extension doesn't work with the given server setting.
I thought that the CVE was for the downstream bug for NSS 3.21 series, which leads to a crash with the same reproducing steps:
<https://bugzilla.redhat.com/show_bug.cgi?id=1397482>

|  | [Huzaifa Sidhpurwala](/user_profile?user_id=331752) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1320695#c4)• 8 years ago |
|  | |

(In reply to Daiki Ueno [:ueno] from [comment #3](/show_bug.cgi?id=1320695#c3 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair"))
> (In reply to Huzaifa Sidhpurwala from [comment #2](/show_bug.cgi?id=1320695#c2 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair"))
> > Note: This is a remote DoS flaw. we have assigned [CVE-2016-9574](https://www.cve.org/CVERecord?id=CVE-2016-9574) to this
> > issue.
>
> I'm not sure if this is really a remote DoS flaw. Even though selfserv
> prints a misleading message ("The one-time function was previously called
> and failed."), the behavior that the client can observe is identical between
> the first and second calls: the connection is terminated because the session
> ticket extension doesn't work with the given server setting.
>
> I thought that the CVE was for the downstream bug for NSS 3.21 series, which
> leads to a crash with the same reproducing steps:
> <https://bugzilla.redhat.com/show_bug.cgi?id=1397482>
You are right, please scratch this comment. The CVE is for our downstream nss version :)

|  | [Alicja Kario](/user_profile?user_id=487652) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1320695#c5)• 8 years ago |
|  | |

(In reply to Daiki Ueno [:ueno] from [comment #3](/show_bug.cgi?id=1320695#c3 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair"))
> (In reply to Huzaifa Sidhpurwala from [comment #2](/show_bug.cgi?id=1320695#c2 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair"))
> > Note: This is a remote DoS flaw. we have assigned [CVE-2016-9574](https://www.cve.org/CVERecord?id=CVE-2016-9574) to this
> > issue.
>
> I'm not sure if this is really a remote DoS flaw. Even though selfserv
> prints a misleading message ("The one-time function was previously called
> and failed."), the behavior that the client can observe is identical between
> the first and second calls: the connection is terminated because the session
> ticket extension doesn't work with the given server setting.
My understanding of Frantisek is that if on the second connection client does not advertise session ticket extension, the connection will still fail.
Frantisek, can you confirm?
> I thought that the CVE was for the downstream bug for NSS 3.21 series, which
> leads to a crash with the same reproducing steps:
> <https://bugzilla.redhat.com/show_bug.cgi?id=1397482>
But yes, that does make it a different issue.

|  | [Daiki Ueno [:ueno]](/user_profile?user_id=565522) |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1320695#c6)• 8 years ago |
|  | |

(In reply to Hubert Kario from [comment #5](/show_bug.cgi?id=1320695#c5 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair"))
> My understanding of Frantisek is that if on the second connection client
> does not advertise session ticket extension, the connection will still fail.
It is not the case. From the implementation, it is unlikely that the first connection causes such side effect, because a different code path is taken depending on whether session ticket extension is advertised.
I have confirmed that, if I run s\_client with -no\_ticket option for the second time, the connection succeeds:
# First time
$ openssl s\_client -connect localhost:4433 -CAfile ec-cert.pem -cipher ECDHE-ECDSA-AES256-SHA -sess\_out sess.pem >/dev/null </dev/null
depth=0 CN = localhost
verify return:1
140625545222008:error:140790E5:SSL routines:ssl23\_write:ssl handshake failure:s23\_lib.c:177:
zsh: exit 1
# Second time
$ openssl s\_client -connect localhost:4433 -CAfile ec-cert.pem -cipher ECDHE-ECDSA-AES256-SHA -sess\_out sess.pem -no\_ticket >/dev/null </dev/null
depth=0 CN = localhost
verify return:1
DONE

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1320695#a4474078_36541)• 8 years ago |

Status: UNCONFIRMED → NEWEver confirmed: true

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1320695#c7)• 8 years ago |
|  | |

Changing the bug summary, based on [comment 1](/show_bug.cgi?id=1320695#c1 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair").Summary: Using SessionTicket extension along with any ECDHE-ECDSA ciphersuite renders selfserv unusable → Disable caching of session ticket keys, if server runs with EC key pair, but without RSA key pair

|  | [Kai Engert [:KaiE:]](/user_profile?user_id=36541) |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1320695#c8)• 8 years ago |
|  | |

Comment on [attachment 8817168](/attachment.cgi?id=8817168 "proposed patch") [[details]](/attachment.cgi?id=8817168&action=edit "proposed patch") [[diff]](/attachment.cgi?id=8817168&action=diff "proposed patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1320695&attachment=8817168)
proposed patch
I think Daiki's suggestion is to always disable caching of session tickets, if no RSA server key pair is available.
I don't know well enough how session tickets work, so I'm adding Martin and Tim to CC, wo I noticed are currently working on other changes related to that code.
I've submitted a try build with the suggested patch:
<https://treeherder.mozilla.org/#/jobs?repo=nss-try&revision=c38cc8f6243979eceb80715652187284c1b13cb3>
[Attachment #8817168](/attachment.cgi?id=8817168&action=edit "proposed patch") -
Flags: review?(kaie) → review?(ttaubert)

|  | [Tim Taubert [:ttaubert] (inactive)](/user_profile?user_id=402526) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1320695#c9)• 8 years ago |
|  | |

Comment on [attachment 8817168](/attachment.cgi?id=8817168 "proposed patch") [[details]](/attachment.cgi?id=8817168&action=edit "proposed patch") [[diff]](/attachment.cgi?id=8817168&action=diff "proposed patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1320695&attachment=8817168)
proposed patch
Review of [attachment 8817168](/attachment.cgi?id=8817168 "proposed patch") [[details]](/attachment.cgi?id=8817168&action=edit "proposed patch") [[diff]](/attachment.cgi?id=8817168&action=diff "proposed patch") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1320695&attachment=8817168):
-----------------------------------------------------------------
Configuring only an EC cert should not break session tickets, it should simply use the EC key pair to wrap the symkey, no? Maybe this was a bug, maybe it's fixed by Martin's patch.
[Attachment #8817168](/attachment.cgi?id=8817168&action=edit "proposed patch") -
Flags: review?(ttaubert)

|  | [Tim Taubert [:ttaubert] (inactive)](/user_profile?user_id=402526) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1320695#c10)• 8 years ago |
|  | |

(In reply to Tim Taubert [:ttaubert] from [comment #9](/show_bug.cgi?id=1320695#c9 "RESOLVED FIXED - Enable use of session ticket keys if server has no RSA key pair"))
> Configuring only an EC cert should not break session tickets, it should
> simply use the EC key pair to wrap the symkey, no? Maybe this was a bug,
> maybe it's fixed by Martin's patch.
Ni'ing Marting for his opinion.Flags: needinfo?(martin.thomson)

|  | [Martin Thomson [:mt:]](/user_profile?user_id=438654)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1320695#c11)• 8 years ago |
|  | |

Yes, the patch for [Bug 1325035](/show_bug.cgi?id=1325035 "RESOLVED FIXED - Store server certificates more efficiently") will make it possible to operate with only an ECDSA certificate. It will not actively block use of tickets; which we should probably also do.Flags: needinfo?(martin.thomson)

|  | [Martin Thomson [:mt:]](/user_profile?user_id=438654)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1320695#c12)• 8 years ago |
|  | |

To iterate on this: we don't have the means to use an EC key for wrapping keys. We might want to add that, but we shouldn't block on that. Requiring RSA for key wrapping isn't terrible.
I would approve the patch here, it's fine, but it will need rebasing on top of the changes for [bug 1325035](/show_bug.cgi?id=1325035 "RESOLVED FIXED - Store server certificates more efficiently").

|  | [Martin Thomson [:mt:]](/user_profile?user_id=438654)  Assignee |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1320695#c13)• 8 years ago |
|  | |

I've rebased the patch, and I can take this on: See <https://nss-review.dev.mozaws.net/D176>Assignee: nobody → martin.thomson

|  | [Martin Thomson [:mt:]](/user_profile?user_id=438654)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1320695#a5037253_438654)• 8 years ago |

Summary: Disable caching of session ticket keys, if server runs with EC key pair, but without RSA key pair → Enable use of session ticket keys if server has no RSA key pair

|  | [Martin Thomson [:mt:]](/user_profile?user_id=438654)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1320695#c14)• 8 years ago |
|  | |

<https://hg.mozilla.org/projects/nss/rev/81305956dc4a715c38b759b5eaeae52d4506a121>Status: NEW → RESOLVEDClosed: 8 years agoResolution: --- → FIXEDTarget Milestone: --- → 3.30
You need to [log in](/show_bug.cgi?id=1320695&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Daiki Ueno [:ueno]](/user_profile?user_id=565522)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review


