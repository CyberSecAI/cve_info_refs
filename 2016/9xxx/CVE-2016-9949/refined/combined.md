=== Content from www.exploit-db.com_c8e702da_20250125_111523.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Apport 2.x (Ubuntu Desktop 12.10 < 16.04) - Local Code Execution

#### EDB-ID:

###### 40937

#### CVE:

###### [2016-9951](https://nvd.nist.gov/vuln/detail/CVE-2016-9951) [2016-9950](https://nvd.nist.gov/vuln/detail/CVE-2016-9950) [2016-9949](https://nvd.nist.gov/vuln/detail/CVE-2016-9949)

---

**EDB Verified:**

#### Author:

###### [Donncha OCearbhaill](/?author=8831)

#### Type:

###### [local](/?type=local)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2016-12-14

---

**Vulnerable App:**

```
Both of these issues were reported to the Apport maintainers and a fix was released on 2016-12-14. The CrashDB code injection issue can be tracked with CVE-2016-9949 and the path traversal bug with CVE-2016-9950. An additional problem where arbitrary commands can be called with the “Relaunch” action is tracked by CVE-2016-9951. I’d like to thank Martin Pitt and the Ubuntu security team for getting a fix (https://bugs.launchpad.net/apport/+bug/1648806) released so quickly. They have been a pleasure to work with.

I would encourage all security researchers to audit free and open source software if they have time on their hands. Projects such as Tor, Tails, Debian and Ubuntu all need more eyes for audits which can improve the safety of the internet for everyone. There are lots of bugs out there which don’t need hardcore memory corruption exploitation skills. Logic bugs can be much more reliable than any ROP chain.

The computer security industry has a serious conflict of interest right now. There is major financial motivation for researchers to find and disclose vulnerability to exploit brokers. Many of the brokers are in the business of keeping problems unfixed. Code execution bugs are valuable. As a data point, I received an offer of more than 10,000 USD from an exploit vendor for these Apport bugs. These financial motivators are only increasing as software gets more secure and bugs become more difficult to find.

To improve security for everyone we need to find sustainable ways to incentivize researchers to find and disclose issues and to get bugs fixed. We can’t and we shouldn’t rely on researchers giving away their work for free to for-profit vendors. We will not get security like that.

Microsoft and Google have shown a good example with their vulnerability reward programs. The Internet Bug Bounty (https://internetbugbounty.org/) is also doing great work and helping to support research on critical internet software. I hope that they can continue the program and expand their scope in the future. I hope we can cooperatively build a shared and secure internet together.

Source: https://donncha.is/2016/12/compromising-ubuntu-desktop/

Download: https://github.com/DonnchaC/ubuntu-apport-exploitation/archive/6ecfdf798f39fdd49b5929240d90a876c1e97ebb.zip
Mirror: https://gitlab.com/exploit-database/exploitdb-bin-sploits/-/raw/main/bin-sploits/40937.zip

```

**Tags:**

**Advisory/Source:**
[Link](https://donncha.is/2016/12/compromising-ubuntu-desktop/)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from bazaar.launchpad.net_44b5e642_20250126_081021.html ===


[← Back to branch summary](https://code.launchpad.net/~apport-hackers/apport/trunk)
# ~apport-hackers/apport/trunk

* [Changes](/~apport-hackers/apport/trunk/changes "Changes")
* [Files](/~apport-hackers/apport/trunk/files "Files")

[~apport-hackers/apport/trunk](https://code.launchpad.net/~apport-hackers/apport/trunk)
» Revision
3112

# Viewing all changes in revision 3112.

* [browse files at revision 3112](/~apport-hackers/apport/trunk/files/3112 "browse files at revision 3112")
* [compare with another revision](/~apport-hackers/apport/trunk/revision/3112?remember=3112 "compare with another revision")
* [download diff](/~apport-hackers/apport/trunk/diff/3112)
* [download tarball](/~apport-hackers/apport/trunk/tarball/3112)
* [view history from revision 3112](/~apport-hackers/apport/trunk/changes/3112 "view history from revision 3112")

* **Committer:**
  Martin Pitt
* **Date:**
  2016-12-18 12:49:43 UTC
* **Revision ID:**
  martin.pitt@canonical.com-20161218124943-rn79hmqwgz0uetkv

<https://launchpad.net/bugs/1648806>

RestrictÂ aÂ report'sÂ CrashDBÂ fieldÂ toÂ literals

UseÂ ast.literal\_eval()Â insteadÂ ofÂ theÂ genericÂ eval(),Â toÂ preventÂ arbitraryÂ code
executionÂ fromÂ maliciousÂ .crashÂ files.Â AÂ userÂ couldÂ beÂ trickedÂ intoÂ openingÂ a
crashÂ fileÂ whoseÂ CrashDBÂ fieldÂ containsÂ anÂ exec(),Â open(),Â orÂ similarÂ commands;
thisÂ isÂ fairlyÂ easyÂ asÂ weÂ installÂ aÂ MIMEÂ handlerÂ forÂ these.

ThanksÂ toÂ DonnchaÂ O'CearbhaillÂ forÂ discoveringÂ this!

CVE-2016-9949
LP:Â #1648806

+ files modified:
+ [NEWS](/~apport-hackers/apport/trunk/revision/3112/NEWS#NEWS "View changes to NEWS in revision 3112")

+ [apport/ui.py](/~apport-hackers/apport/trunk/revision/3112/apport/ui.py#apport/ui.py "View changes to apport/ui.py in revision 3112")

+ [test/test\_ui.py](/~apport-hackers/apport/trunk/revision/3112/test/test_ui.py#test/test_ui.py "View changes to test/test_ui.py in revision 3112")

![expand all](/static/images/treeCollapsed.png) expand all

![collapse all](/static/images/treeExpanded.png) collapse all

Show diffs side-by-side

![added](/static/images/newCode.gif) added

![removed](/static/images/deleteCode.gif) removed

Lines of Context:

[![](/static/images/treeCollapsed.png)
NEWS](/~apport-hackers/apport/trunk/revision/3112/NEWS "View changes to NEWS only")

![](/static/images/spinner.gif)

[![](/static/images/treeCollapsed.png)
apport/ui.py](/~apport-hackers/apport/trunk/revision/3112/apport/ui.py "View changes to apport/ui.py only")

![](/static/images/spinner.gif)

[![](/static/images/treeCollapsed.png)
test/test\_ui.py](/~apport-hackers/apport/trunk/revision/3112/test/test_ui.py "View changes to test/test_ui.py only")

![](/static/images/spinner.gif)

* [Older »](/~apport-hackers/apport/trunk/revision/3309?start_revid=3310)

Loggerhead is a web-based interface for [Breezy](https://www.breezy-vcs.org/)

Version: 2.0.1



=== Content from launchpad.net_61ebf903_20250126_081015.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/apport/2.0.1-0ubuntu17.15/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[apport package](https://launchpad.net/ubuntu/%2Bsource/apport)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/apport)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/apport)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/apport)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/apport)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/apport)

# apport 2.0.1-0ubuntu17.15 source package in Ubuntu

## Changelog

```
apport (2.0.1-0ubuntu17.15) precise-security; urgency=medium

  [ Marc Deslauriers ]
  * SECURITY UPDATE: path traversal vulnerability with hooks execution
    - Clean path in apport/report.py, added test to test/test_ui.py.
    - No CVE number
    - LP: [#1648806](/bugs/1648806)

  [ Steve Beattie ]
  * SECURITY UPDATE: code execution via malicious crash files
    - Only offer restarting the application when processing a
      crash file in /var/crash in apport/ui.py, gtk/apport-gtk,
      and kde/apport-kde. Add testcases to test/test_ui.py,
      test/test_ui_gtk.py, and test_ui_kde.py.
    - No CVE number
    - LP: [#1648806](/bugs/1648806)

 -- Marc Deslauriers <email address hidden>  Mon, 12 Dec 2016 07:34:52 -0500
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2016-12-13

Sponsored by:
[Steve Beattie](/~sbeattie)

Uploaded to:
[Precise](/ubuntu/precise)

Original maintainer:
[Martin Pitt](/~pitti)

Architectures:
all

Section:
utils

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Precise](/ubuntu/precise):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security/%2Barchive/ubuntu/ppa/%2Bbuild/11561249)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [apport\_2.0.1.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/apport/2.0.1-0ubuntu17.15/apport_2.0.1.orig.tar.gz) | 650.8 KiB | 2020aea997fa35fd72a99d55e228cbd5c0686a7904b61b492d44452f3679ff52 |
| [apport\_2.0.1-0ubuntu17.15.diff.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/apport/2.0.1-0ubuntu17.15/apport_2.0.1-0ubuntu17.15.diff.gz) | 142.0 KiB | d49ceded4fc473fecbf53733ea629f5470602602beec0ca9385dedca463c7c6c |
| [apport\_2.0.1-0ubuntu17.15.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/apport/2.0.1-0ubuntu17.15/apport_2.0.1-0ubuntu17.15.dsc) | 2.3 KiB | 67d2a032ee06abb4fb46e8ca09a8afea37c2543d3ebd0f5228f327102b696df5 |

### Available diffs

* [diff from 2.0.1-0ubuntu17.13 to 2.0.1-0ubuntu17.15](http://launchpadlibrarian.net/298260123/apport_2.0.1-0ubuntu17.13_2.0.1-0ubuntu17.15.diff.gz) (2.9 KiB)
* [diff from 2.0.1-0ubuntu17.14 to 2.0.1-0ubuntu17.15](http://launchpadlibrarian.net/298099251/apport_2.0.1-0ubuntu17.14_2.0.1-0ubuntu17.15.diff.gz) (2.4 KiB)

[View changes file](http://launchpadlibrarian.net/298098138/apport_2.0.1-0ubuntu17.15_source.changes)

## Binary packages built by this source

[apport](/ubuntu/precise/%2Bpackage/apport):
automatically generate crash reports for debugging

apport automatically collects data from crashed processes and

 compiles a problem report in /var/crash/. This utilizes the crashdump

 helper hook provided by the Ubuntu kernel.

 .

 This package also provides a command line frontend for browsing and

 handling the crash reports. For desktops, you should consider

 installing the GTK+ or Qt user interface (apport-gtk or apport-kde).

[apport-gtk](/ubuntu/precise/%2Bpackage/apport-gtk):
GTK+ frontend for the apport crash report system

apport automatically collects data from crashed processes and

 compiles a problem report in /var/crash/. This utilizes the crashdump

 helper hook provided by the Ubuntu kernel.

 .

 This package provides a GTK+ frontend for browsing and handling the

 crash reports.

[apport-kde](/ubuntu/precise/%2Bpackage/apport-kde):
KDE frontend for the apport crash report system

apport automatically collects data from crashed processes and

 compiles a problem report in /var/crash/. This utilizes the crashdump

 helper hook provided by the Ubuntu kernel.

 .

 This package provides a KDE frontend for browsing and handling the

 crash reports.

[apport-retrace](/ubuntu/precise/%2Bpackage/apport-retrace):
tools for reprocessing Apport crash reports

apport-retrace recombines an Apport crash report (either a file or a

 Launchpad bug) and debug symbol packages (.ddebs) into fully symbolic

 stack traces. This can optionally use a sandbox for installing debug symbol

 packages and doing the processing, so that entire process of retracing crashes

 can happen with normal user privileges without changing the system.

[dh-apport](/ubuntu/precise/%2Bpackage/dh-apport):
debhelper extension for the apport crash report system

apport automatically collects data from crashed processes and

 compiles a problem report in /var/crash/. This utilizes the crashdump

 helper hook provided by the Ubuntu kernel.

 .

 This package provides a debhelper extension to make it easier for other

 packages to include apport hooks.

[python-apport](/ubuntu/precise/%2Bpackage/python-apport):
apport crash report handling library

This Python package provides high-level functions for creating and

 handling apport crash reports:

 .

  \* Query available and new reports.

  \* Add OS, packaging, and process runtime information to a report.

  \* Various frontend utility functions.

  \* Python hook to generate crash reports when Python scripts fail.

[python-problem-report](/ubuntu/precise/%2Bpackage/python-problem-report):
Python library to handle problem reports

This Python library provides an interface for creating, modifying,

 and accessing standardized problem reports for program and kernel

 crashes and packaging bugs.

 .

 These problem reports use standard Debian control format syntax

 (RFC822).

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from launchpad.net_d8b1ffbb_20250126_081018.html ===

[Log in / Register](https://launchpad.net/~donnchac/%2Blogin)

[![](/@@/person-logo)](https://launchpad.net/~donnchac)

## [Donncha O Cearbhaill](https://launchpad.net/~donnchac)

* Overview
* [Code](https://code.launchpad.net/~donnchac)
* [Bugs](https://bugs.launchpad.net/~donnchac)
* [Blueprints](https://blueprints.launchpad.net/~donnchac)
* [Translations](https://translations.launchpad.net/~donnchac)
* [Answers](https://answers.launchpad.net/~donnchac)

* [Related packages](https://launchpad.net/~donnchac/%2Brelated-packages)
* [Related projects](https://launchpad.net/~donnchac/%2Brelated-projects)

## User information

Launchpad Id:
donnchac

Email:
[Log in](%2Blogin) for email information.

Member since:
2015-12-15

Languages:

English

Time zone:

UTC
(UTC+0000)

Karma:
[0](https://launchpad.net/~donnchac/%2Bkarma)
[Karma help](/%2Bhelp-registry/karma.html)

Social accounts:
![IRC](/@@/social-irc "IRC")
**DonnchaC**
 on
**chat.freenode.net**

![Jabber](/@@/social-jabber "Jabber")
<email address hidden>

## Latest memberships

Donncha O Cearbhaill is not an
active member of any Launchpad teams.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from www.ubuntu.com_d3ddf20a_20250125_111519.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3157-1: Apport vulnerabilities

14 December 2016

Apport could be made to run programs as your login if it opened a
specially crafted file.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 16.10](/security/notices?release=yakkety)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)
* [Ubuntu 12.04](/security/notices?release=precise)

## Packages

* [apport](/security/cves?package=apport) - automatically generate crash reports for debugging

## Details

Donncha O Cearbhaill discovered that the crash file parser in Apport

improperly treated the CrashDB field as python code. An attacker could

use this to convince a user to open a maliciously crafted crash file

and execute arbitrary code with the privileges of that user. This issue

only affected Ubuntu 14.04 LTS and Ubuntu 16.04 LTS. ([CVE-2016-9949](/security/CVE-2016-9949))

Donncha O Cearbhaill discovered that Apport did not properly sanitize the

Package and SourcePackage fields in crash files before processing package

specific hooks. An attacker could use this to convince a user to open a

maliciously crafted crash file and execute arbitrary code with the

privileges of that user. ([CVE-2016-9950](/security/CVE-2016-9950))

Donncha O Cearbhaill discovered that Apport would offer to restart an

application based on the contents of the RespawnCommand or ProcCmdline

fields in a crash file. An attacker could use this to convince a user to

open a maliciously crafted crash file and execute arbitrary code with the

privileges of that user. ([CVE-2016-9951](/security/CVE-2016-9951))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 16.10

* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.3-0ubuntu8.2](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.3-0ubuntu8.2)
* [apport-gtk](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.3-0ubuntu8.2](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.3-0ubuntu8.2)
* [apport-kde](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.3-0ubuntu8.2](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.3-0ubuntu8.2)
* [python-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.3-0ubuntu8.2](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.3-0ubuntu8.2)
* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.3-0ubuntu8.2](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.3-0ubuntu8.2)

##### Ubuntu 16.04

* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.1-0ubuntu2.4](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.1-0ubuntu2.4)
* [apport-gtk](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.1-0ubuntu2.4](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.1-0ubuntu2.4)
* [apport-kde](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.1-0ubuntu2.4](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.1-0ubuntu2.4)
* [python-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.1-0ubuntu2.4](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.1-0ubuntu2.4)
* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.20.1-0ubuntu2.4](https://launchpad.net/ubuntu/%2Bsource/apport/2.20.1-0ubuntu2.4)

##### Ubuntu 14.04

* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.14.1-0ubuntu3.23](https://launchpad.net/ubuntu/%2Bsource/apport/2.14.1-0ubuntu3.23)
* [apport-gtk](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.14.1-0ubuntu3.23](https://launchpad.net/ubuntu/%2Bsource/apport/2.14.1-0ubuntu3.23)
* [apport-kde](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.14.1-0ubuntu3.23](https://launchpad.net/ubuntu/%2Bsource/apport/2.14.1-0ubuntu3.23)
* [python-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.14.1-0ubuntu3.23](https://launchpad.net/ubuntu/%2Bsource/apport/2.14.1-0ubuntu3.23)
* [python3-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.14.1-0ubuntu3.23](https://launchpad.net/ubuntu/%2Bsource/apport/2.14.1-0ubuntu3.23)

##### Ubuntu 12.04

* [apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.0.1-0ubuntu17.15](https://launchpad.net/ubuntu/%2Bsource/apport/2.0.1-0ubuntu17.15)
* [apport-gtk](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.0.1-0ubuntu17.15](https://launchpad.net/ubuntu/%2Bsource/apport/2.0.1-0ubuntu17.15)
* [apport-kde](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.0.1-0ubuntu17.15](https://launchpad.net/ubuntu/%2Bsource/apport/2.0.1-0ubuntu17.15)
* [python-apport](https://launchpad.net/ubuntu/%2Bsource/apport)
  -
  [2.0.1-0ubuntu17.15](https://launchpad.net/ubuntu/%2Bsource/apport/2.0.1-0ubuntu17.15)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2016-9949](/security/CVE-2016-9949)
* [CVE-2016-9950](/security/CVE-2016-9950)
* [CVE-2016-9951](/security/CVE-2016-9951)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

© 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from donncha.is_45a31c78_20250126_081021.html ===


* [Home](/)
* [About](/about/)
* [Research](/research/)
* [Tools](/tools/)
* [Media / Talks](/speaking/)
* [Posts](/posts/)
* [Contact](/contact/)

# Reliably compromising Ubuntu desktops by attacking the crash reporter

Dec 14 2016

In this post I’ll describe how I found a remote code execution bug in Ubuntu Desktop which affects all default installations `>= 12.10` (Quantal). The bug allows for reliable code injection when a user simply opens a malicious file. The following video demonstrates the exploit opening the Gnome calculator. The executed payload also replaces the exploit file with a decoy zip file to cover its tracks.

The full source code for this exploit is available on [Github](https://github.com/DonnchaC/ubuntu-apport-exploitation).

This research was inspired by Chris Evan’s great work on [exploiting client-side file format parsing bugs in the gstreamer media library](https://scarybeastsecurity.blogspot.com/2016/11/0day-exploit-compromising-linux-desktop.html) on Ubuntu. We will look for other default file handlers on Ubuntu which may be vulnerable to exploitation. I’m not a binary exploitation guru like Chris so instead we’ll try find bugs which are exploitable without memory corruption.

## File and URL handler configuration on Linux desktops[#](#file-and-url-handler-configuration-on-linux-desktops)

Desktop environments such as GNOME or KDE ship with a list of known file types and default applications. When a user opens a file, the desktop environment first determines the file format and then launches the corresponding application. Ubuntu stores a set of .desktop files for its default applications in the\_ `/usr/share/applications/`\_ directory. We want to see which default applications are responsible for a particular file type (MimeType) and run with the filename passed as an argument.

Many of the listed applications are frequently audited software such as image viewers, media players, LibreOffice and Firefox. Instead we are going to look for less commonly researched software which can also be spawned by a default file handler. Apport, Ubuntu’s default crash handler and crash reporting software is first on our list. Let’s see what file types it will handle:

Great, GNOME should open all files matching the mime-type `text/x-apport` with the `apport-gtk` tool. Ubuntu determines mime-types based on Mime descriptions in the `/usr/share/mime/` directory. Typically the file extension will be used to determine the file type, however the desktop environment can fallback to matching a pattern (a set of magic bytes) in the file if the file extension is unrecognized.

In the case of Apport both a file extension `.crash` and a magic byte sequence are specified. The desktop environment will try to match the file extension first before comparing magic byte. As the Apport crash file descriptor has a byte pattern we can potentially create an exploit file without a strange .crash extension.

A quick test shows that Ubuntu will open any unknown file with *apport-gtk* if it begins with “`ProblemType:` “:

[![Crash file opened automatically by apport-gtk](https://donncha.is/wp-content/uploads/2016/12/apport-file-handler-1024x555.png)](https://donncha.is/wp-content/uploads/2016/12/apport-file-handler.png)

Apport looks like a good candidate! It’s installed by default and it’s registered as a default file handler. Let’s try and understand what Apport is meant to do.

## Auditing Apport[#](#auditing-apport)

Ubuntu has shipped the Apport crash handling software with all of its recent Desktop releases. It contains a handful of different components which work together to capture crash reports, display them to user, and upload those reports to the Ubuntu issue tracker. An overview of these components is provided on the [Ubuntu wiki](https://wiki.ubuntu.com/Apport#How_does_it_work_internally).

`/usr/share/apport/apport` is called when the system detects an application crash. To keep the performance impact to a minimum Apport records a minimal set of information at crash time such as the executable path and a core dump. This minimal crash report is written to `/var/crash/[executable_path].[uid].crash`.

The `update-notifier` daemon in Gnome keeps an `inotify` watch on the `/var/crash` directory. Whenever there is something new, it calls `/usr/share/apport/apport-checkreports`. If new reports are found `apport-checkreports` calls `/usr/share/apport/apport-gtk` to the display the crash report GUI to the user. `apport-gtk` is also the application called when `.crash` files are opened on the desktop environment.

Apport-GTK parses the crash files and displays a minimal crash report prompt to the user. The Apport prompt will be familiar sight to anyone who has used Ubuntu desktop.

[![Typical Apport prompt](https://donncha.is/wp-content/uploads/2016/12/basic-apport-prompt.png)](https://donncha.is/wp-content/uploads/2016/12/basic-apport-prompt.png)

## Apport crash report format[#](#apport-crash-report-format)

The Apport software reads and writes crash reports in its custom crash report format. This plaintext format is partially [described on the Apport wiki page](https://wiki.ubuntu.com/Apport?action=AttachFile&do=view&target=data-format.pdf).

There are many potential fields which can be used to store information about the crash and about the current system state. The minimal file created at crash time just contains essential entries such as the `ProblemType`, `ExecutablePath` and the `CoreDump`.

When opened `apport-gtk` collects some more basic information to display a helpful interface to the user. Package information is retrieved based on the executable path and this is used to provide a more friendly application name and icon in the prompt.

## Python code injection in the crash file[#](#python-code-injection-in-the-crash-file)

Apport can submit crash reports to different Ubuntu Launchpad projects depending on which software crashed. Package specific hook scripts (loaded from `/usr/share/apport/package-hooks/`) can customize the contents and destination of the crash report. The destination project can also be specified with a `CrashDB` field in the crash report file.

The CrashDB configurations are stored in the `/etc/apport/crashdb.conf.d` directory. A `CrashDB` field can be used to load a specific config file from this directory.

Problematically there is also code which loads the CrashDB configuration directly from the `CrashDB` field and not from a local file. The code first checks if the CrashDB field starts with `{` indicating the start of a Python dictionary. If found, Apport will call Python’s builtin `eval()` method with the value of the `CrashDB` field. `eval()` executes the passed data as a Python expression which leads to straight forward and reliable Python code execution.

The vulnerable code was introduce on 2012-08-22 in Apport [revision 2464](http://bazaar.launchpad.net/~apport-hackers/apport/trunk/files/2464). This code was first included in release `2.6.1`. All Ubuntu Desktop versions *12.10 (Quantal)* and later include this vulnerable code by default.

## Exploiting the code injection bug[#](#exploiting-the-code-injection-bug)

The following is a minimal crash report file which exploits the CrashDB vulnerability in order to gain arbitrary code execution and open the Gnome calculator:

This code can be saved with the .crash extension, or with any extension that is not registered on Ubuntu.

Apport typically reads a subset of the fields in the crash file in order to prepare the GUI which prompts the user to submit a bug report. The CrashDB field is not parsed and executed until after the user agrees to submit the bug report. However when `ProblemType: Bug` is set in the crash file, Apport-GTK will switch to the streamlined `Bug` GUI which causes the `CrashDB` field to be parsed and executed without any further user interaction.

Apport will spend some time trying to gather information about the crash process if the report does not already contain a `Stracktrace` field. This delays the execution of the `CrashDB` field. An empty `Stracktrace` field in exploit file causes Apport to skip this slow code path.

Apport ships with a number of CrashDB implementations. I have selected the `memory` implementation as it does not upload crash reports to public bug tracking service.

## Path traversal when loading hook scripts[#](#path-traversal-when-loading-hook-scripts)

Packages on Ubuntu can install Apport hook scripts to the `/usr/share/apport/package-hooks` directory. These Python hook scripts are loaded based on the distribution package name. They allow package maintainers to collect useful package specific crash information from users’ computers. However the `Package` field from the crash report file is used without sanitization when building a path to the package hook files.

This code allows for a path traversal attack and the execution of arbitrary Python scripts outside the system `hook_dirs` (`/usr/share/apport/general-hooks/` or `/usr/share/apport/package-hooks/`). The `_run_hook` function simply executes the contents of a provided hook file as Python code. An attacker could serve plant a malicious `.py` file and a crash file in the users Download directory to get code execution. This scenario is made much easier by Chromium which automatically downloads files without prompting.

The path traversal vulnerability was introduced on 2007-01-24 in Apport 0.44. This version was first released with Ubuntu 7.04 (Feisty).

## Using the CrashDB or hook injection bugs for privilege escalation (with user interaction)[#](#using-the-crashdb-or-hook-injection-bugs-for-privilege-escalation-with-user-interaction)

All crash files owned by a uid < 500 are considered system crash files. When opening system crash files `apport-crashreports` will use PolicyKit to prompt the desktop user for root privileges. The prompt is a generic “System program problem detected” message which does not provide any information to the user about the crash.

If a crash file exploiting either of these bugs is placed in `/var/crash` by a user with uid < 500, and the user accepts the prompt, then code execution can be gained as root. While user interaction is required, people who have used Ubuntu for any period of time will be used to seeing these privilege prompts after random crashes.

[![Apport system application crash prompt](https://donncha.is/wp-content/uploads/2016/12/apport-privilaged-prompt.png)](https://donncha.is/wp-content/uploads/2016/12/apport-privilaged-prompt.png)

A bug like this allows a low-privileged application to cross privilege boundaries. For example an SQL injection bug could be used to write a crash file to the world-writable */var/crash* directory by using the `"INTO OUTFILE"` clause. This crash file would then be automatically executed when a desktop user logs in.

## Conclusion[#](#conclusion)

Both of these issues were reported to the Apport maintainers and a fix was released on 2016-12-14. The CrashDB code injection issue can be tracked with CVE-2016-9949 and the path traversal bug with CVE-2016-9950. An additional problem where arbitrary commands can be called with the “Relaunch” action is tracked by CVE-2016-9951. I’d like to thank Martin Pitt and the Ubuntu security team for getting [a fix](https://bugs.launchpad.net/apport/%2Bbug/1648806) released so quickly. They have been a pleasure to work with.

I would encourage all security researchers to audit free and open source software if they have time on their hands. Projects such as Tor, Tails, Debian and Ubuntu all need more eyes for audits which can improve the safety of the internet for everyone. There are lots of bugs out there which don’t need hardcore memory corruption exploitation skills. Logic bugs can be much more reliable than any ROP chain.

The computer security industry has a serious conflict of interest right now. There is major financial motivation for researchers to find and disclose vulnerability to exploit brokers. Many of the brokers are in the business of keeping problems unfixed. Code execution bugs are valuable. As a data point, I received an offer of more than 10,000 USD from an exploit vendor for these Apport bugs. These financial motivators are only increasing as software gets more secure and bugs become more difficult to find.

To improve security for everyone we need to find sustainable ways to incentivize researchers to find and disclose issues and to get bugs fixed. We can’t and we shouldn’t rely on researchers giving away their work for free to for-profit vendors. We will not get security like that.

Microsoft and Google have shown a good example with their vulnerability reward programs. The [Internet Bug Bounty](https://internetbugbounty.org/) is also doing great work and helping to support research on critical internet software. I hope that they can continue the program and expand their scope in the future. I hope we can cooperatively build a shared and secure internet together.

## Timeline[#](#timeline)

2016-12-09: Apport maintainer contacted
2016-12-10: Response and private bug ticket opened
2016-12-14: Fixed Apport packages released.

[Previous Post
Problems using an OpenPGP smartcard for SSH with gpg-agent](https://donncha.is/2014/07/problems-using-an-openpgp-smartcard-for-ssh-with-gpg-agent/)



=== Content from bugs.launchpad.net_1cbe5e90_20250125_111520.html ===

[Log in / Register](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Blogin)

[![](https://launchpadlibrarian.net/25785805/apport-64x64.png)](https://launchpad.net/apport)

## [Apport](https://launchpad.net/apport)

* [Overview](https://launchpad.net/apport)
* [Code](https://code.launchpad.net/apport)
* [Bugs](https://bugs.launchpad.net/apport)
* [Blueprints](https://blueprints.launchpad.net/apport)
* [Translations](https://translations.launchpad.net/apport)
* [Answers](https://answers.launchpad.net/apport)

# Arbitrary code execution through crafted CrashDB or Package/Source fields in .crash files

Bug #1648806 reported by
[Martin Pitt](https://launchpad.net/~pitti)
on 2016-12-09

[268](/%2Bhelp-bugs/bug-heat.html)

This bug affects 2 people

| Affects | | Status | Importance | Assigned to | Milestone |
| --- | --- | --- | --- | --- | --- |
|  | [Apport](https://bugs.launchpad.net/apport) | Fix Released | Undecided | [Martin Pitt](https://launchpad.net/~pitti) |  |
|  | [apport (Ubuntu)](https://bugs.launchpad.net/ubuntu/%2Bsource/apport "Latest release: 2.31.0-0ubuntu3, uploaded to main on 2025-01-17 22:47:11.031736+00:00 by Benjamin Drung (bdrung), maintained by Ubuntu Developers (ubuntu-devel-discuss-lists)") | Fix Released | Undecided | [Martin Pitt](https://launchpad.net/~pitti) |  |
|  | [Precise](https://bugs.launchpad.net/ubuntu/precise/%2Bsource/apport) | Fix Released | Undecided | Unassigned |  |
|  | [Trusty](https://bugs.launchpad.net/ubuntu/trusty/%2Bsource/apport) | Fix Released | Undecided | Unassigned |  |
|  | [Xenial](https://bugs.launchpad.net/ubuntu/xenial/%2Bsource/apport) | Fix Released | Undecided | Unassigned |  |
|  | [Yakkety](https://bugs.launchpad.net/ubuntu/yakkety/%2Bsource/apport) | Fix Released | Undecided | Unassigned |  |
|  | [Zesty](https://bugs.launchpad.net/ubuntu/zesty/%2Bsource/apport) | Fix Released | Undecided | [Martin Pitt](https://launchpad.net/~pitti) |  |

### Bug Description

Forwarding private (encrypted) mail from Donncha O'Cearbhaill <email address hidden>:

===================== 8< ==========================

Hi Martin,

I have been auditing the Apport software in my free time and

unfortunately I have found some serious security issues.

Untrusted files can be passed to apport-gtk as it is registered as the

default file handler for "text/x-apport" files. The mime-type includes

.crash files but also any unknown file type which begins with

"ProblemType: ". An attacker could social engineer a victim into opening

a malicious Apport crash file simply by clicking on it.

In apport/ui.py, Apport is reading the CrashDB field and then it then

evaluates the field as Python code if it begins with a "{". This is very

dangerous as it can allow remote attackers to execute arbitrary Python code.

The vulnerable code was introduce on 2012-08-22 in Apport revision

2464

(<http://bazaar.launchpad.net/~apport-hackers/apport/trunk/files/2464>).

This code was first included in release 2.6.1. All Ubuntu Desktop

versions after 12.05 (Precise) include this vulnerable code by default.

An easy fix would be to parse the value as JSON instead of eval()'ing it.

There is also a path traversal issue where the Package or SourcePackage

fields are not sanitized before being used to build a path to the

package specific hook files in the /usr/share/apport/package-hooks/

directory.

By setting "Package: ../../../../proc/self/cwd/Downloads/rce-hook.py" a

remote attacker could exploit this bug to execute Python scripts that

have be placed in the user's Downloads directory.

Would you like to apply for a CVE for this issues or should I? I'd like

to see these issue fixed soon so that Ubuntu users can be kept safe. I'm

planning to publish a blog post about these issues but I'll wait until

patched version of Apport are available in the repositories.

Please let me know if you have any questions.

Kind Regards,

Donncha

===================== 8< ==========================

I just talked to Donna on Jabber, and he plans to disclose that in around a week.

Tags:

[patch](/apport/%2Bbugs?field.tag=patch)

## Related branches

[lp:~apport-hackers/apport/trunk](https://code.launchpad.net/~apport-hackers/apport/trunk)

## CVE References

* [2016-9949](/bugs/cve/2016-9949 "An issue was discovered in Apport bef...")
* [2016-9950](/bugs/cve/2016-9950 "An issue was discovered in Apport bef...")
* [2016-9951](/bugs/cve/2016-9951 "An issue was discovered in Apport bef...")

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-09: |  |  | [#1](/apport/%2Bbug/1648806/comments/1) |
| --- | --- | --- | --- |

@security team: Can you please assign a CVE?

I'm on the core sprint this week, and next week I have two work days left. I'll look into this on Monday and attach patches here for review, but I most probably won't be able to do all the backports to stable releases, so I'll need some help with that.

@security team: Can you please assign a CVE?
I'm on the core sprint this week, and next week I have two work days left. I'll look into this on Monday and attach patches here for review, but I most probably won't be able to do all the backports to stable releases, so I'll need some help with that.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-09: |  |  | [#2](/apport/%2Bbug/1648806/comments/2) |
| --- | --- | --- | --- |

* [POC exploit](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4789559/%2Bfiles/minimal-rce.crash)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4789559)
  (250 bytes,
  text/plain)

I have attached a minimal Apport crash file which results in code execution when opened.

I've also uploaded a private video demonstrating this bug at <https://vimeo.com/194867494> (password: apportbugpoc)

I have attached a minimal Apport crash file which results in code execution when opened.
I've also uploaded a private video demonstrating this bug at https://vimeo.com/194867494 (password: apportbugpoc)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-10: |  |  | [#3](/apport/%2Bbug/1648806/comments/3) |
| --- | --- | --- | --- |

Proposed patch (including tests) for the code execution via crafted CrashDB: fields, against current trunk.

I will now look into the other aspect (arbitrary hook execution via crafted Package:/Source: fields). I think this deserves a separate CVE number.

Proposed patch (including tests) for the code execution via crafted CrashDB: fields, against current trunk.
I will now look into the other aspect (arbitrary hook execution via crafted Package:/Source: fields). I think this deserves a separate CVE number.

| Changed in apport: | |
| --- | --- |
| **status**: | New → In Progress |
| **assignee**: | nobody → Martin Pitt (pitti) |
| **summary**: | - Arbitrary code execution through crafted CrashDB in .crash files+ Arbitrary code execution through crafted CrashDB or Package/Source+ fields in .crash files |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-10: |  |  | [#4](/apport/%2Bbug/1648806/comments/4) |
| --- | --- | --- | --- |

Subscribing Brian, who is taking over Apport maintenance, just in case this takes longer. Brian, this issue has not been disclosed yet.

Subscribing Brian, who is taking over Apport maintenance, just in case this takes longer. Brian, this issue has not been disclosed yet.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-10: |  |  | [#5](/apport/%2Bbug/1648806/comments/5) |
| --- | --- | --- | --- |

* [proposed fix for CrashDB code execution](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4789981/%2Bfiles/apport.crashdb-exec.patch)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4789981)
  (3.4 KiB,
  text/plain)

The previous patch contained an additional check for the data type which is unnecessary, I just forgot to remove it again (thinko, problem\_report.py already enforces this).

The previous patch contained an additional check for the data type which is unnecessary, I just forgot to remove it again (thinko, problem\_report.py already enforces this).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-10: |  |  | [#6](/apport/%2Bbug/1648806/comments/6) |
| --- | --- | --- | --- |

The patch for the CrashDB bug looks good to me

The patch for the CrashDB bug looks good to me

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-10: |  |  | [#7](/apport/%2Bbug/1648806/comments/7) |
| --- | --- | --- | --- |

* [hook.py](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4790031/%2Bfiles/hook.py)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4790031)
  (174 bytes,
  text/x-python)

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-10: |  |  | [#8](/apport/%2Bbug/1648806/comments/8) |
| --- | --- | --- | --- |

* [hook.crash](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4790032/%2Bfiles/hook.crash)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4790032)
  (143 bytes,
  text/plain)

This Apport crash file exploits the Package name path traversal bug to load a Python hook file from the users Downloads directory (~/Downloads/hook.py). It would be straight forward to trick a user on Chromium as it automatically downloads files with prompt to the user's Downloads directory.

This Apport crash file exploits the Package name path traversal bug to load a Python hook file from the users Downloads directory (~/Downloads/hook.py). It would be straight forward to trick a user on Chromium as it automatically downloads files with prompt to the user's Downloads directory.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-11: |  |  | [#9](/apport/%2Bbug/1648806/comments/9) |
| --- | --- | --- | --- |

* [proposed patch for Package: path traversal](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4790242/%2Bfiles/apport.package-path-traversal.patch)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4790242)
  (2.8 KiB,
  text/plain)

Proposed patch for the path traversal issue, including tests. This affects all apport versions back to precise. (The CrashDB: one only affects trusty and later, not precise).

Proposed patch for the path traversal issue, including tests. This affects all apport versions back to precise. (The CrashDB: one only affects trusty and later, not precise).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2016-12-12: |  |  | [#10](/apport/%2Bbug/1648806/comments/10) |
| --- | --- | --- | --- |

Hi Martin, thank you very much for preparing patches, we'll take it from here!

The security team can't currently assign CVE numbers, so we can't assign numbers to this issue.

Hi Martin, thank you very much for preparing patches, we'll take it from here!
The security team can't currently assign CVE numbers, so we can't assign numbers to this issue.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-12: |  |  | [#11](/apport/%2Bbug/1648806/comments/11) |
| --- | --- | --- | --- |

Should I apply for CVE numbers directly from MITRE or will the security team request them?

Should I apply for CVE numbers directly from MITRE or will the security team request them?

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Marc Deslauriers (mdeslaur)](https://launchpad.net/~mdeslaur) wrote on 2016-12-12: |  |  | [#12](/apport/%2Bbug/1648806/comments/12) |
| --- | --- | --- | --- |

Please apply directly, sorry for the inconvenience.

Please apply directly, sorry for the inconvenience.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-12: |  |  | [#13](/apport/%2Bbug/1648806/comments/13) |
| --- | --- | --- | --- |

There is a another risk where the `RespawnCommand` or `ProcCmdline` fields in a crash file are executed when a user clicks "Restart" from the apport-gtk prompt. This is not a vulnerability as it is the intended behaviour

However it may be safer to hide the restart option when opening a non-local crash file (when a .crash is opened directly from the Desktop). Instead the "Restart" button would only be shown when a generated crash file is opened by the `update-notifier` inotify watcher.

There is a another risk where the `RespawnCommand` or `ProcCmdline` fields in a crash file are executed when a user clicks "Restart" from the apport-gtk prompt. This is not a vulnerability as it is the intended behaviour
However it may be safer to hide the restart option when opening a non-local crash file (when a .crash is opened directly from the Desktop). Instead the "Restart" button would only be shown when a generated crash file is opened by the `update-notifier` inotify watcher.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-12: |  |  | [#14](/apport/%2Bbug/1648806/comments/14) |
| --- | --- | --- | --- |

I've requested two CVE's from MITRE. I'll add the to the ticket when I receive a response.

I've requested two CVE's from MITRE. I'll add the to the ticket when I receive a response.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-13: |  |  | [#15](/apport/%2Bbug/1648806/comments/15) |
| --- | --- | --- | --- |

> However it may be safer to hide the restart option when opening a non-local crash file

Agreed. update-notifier calls apport-\* without any arguments, so it will iterate over /var/crash/. Clicking on a .crash file (in any directory) will call apport-\* with that file name. So we'll only show "Restart" in the former.

> However it may be safer to hide the restart option when opening a non-local crash file
Agreed. update-notifier calls apport-\* without any arguments, so it will iterate over /var/crash/. Clicking on a .crash file (in any directory) will call apport-\* with that file name. So we'll only show "Restart" in the former.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-13: |  |  | [#16](/apport/%2Bbug/1648806/comments/16) |
| --- | --- | --- | --- |

* [proposed fix for relaunch code execution](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4791203/%2Bfiles/apport.restrict-relaunch.patch)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4791203)
  (11.0 KiB,
  text/plain)

This fixes the third aspect (arbitrary code execution on malicious .crash files through "Relaunch"). I think if the other two issues warrant a CVE, then this one does too.

This also affects all versions back to precise.

This fixes the third aspect (arbitrary code execution on malicious .crash files through "Relaunch"). I think if the other two issues warrant a CVE, then this one does too.
This also affects all versions back to precise.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-13: |  |  | [#17](/apport/%2Bbug/1648806/comments/17) |
| --- | --- | --- | --- |

Martin: Thanks for the third patch. That looks like the right approach.

I have not yet received a response for my CVE requests to MITRE. Alternatively we can request CVE IDs from the oss-security mailing list. I don't think we need to wait for MITRE before releasing the updates.

Martin: Thanks for the third patch. That looks like the right approach.
I have not yet received a response for my CVE requests to MITRE. Alternatively we can request CVE IDs from the oss-security mailing list. I don't think we need to wait for MITRE before releasing the updates.

[Martin Pitt (pitti)](https://launchpad.net/~pitti)
on 2016-12-13

| Changed in apport (Ubuntu Zesty): | |
| --- | --- |
| **assignee**: | nobody → Martin Pitt (pitti) |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-13: |  |  | [#18](/apport/%2Bbug/1648806/comments/18) |
| --- | --- | --- | --- |

I'll still be able to do computer stuff until next Tuesday (for landing in trunk and doing a new upstream release and zesty upload), if we want to publish by then. Otherwise, if it gets any later I really suggest to postpone this until start of January.

I'll still be able to do computer stuff until next Tuesday (for landing in trunk and doing a new upstream release and zesty upload), if we want to publish by then. Otherwise, if it gets any later I really suggest to postpone this until start of January.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-13: |  |  | [#19](/apport/%2Bbug/1648806/comments/19) |
| --- | --- | --- | --- |

I'd like to see the the patches and and blog post released this week if possible. Please let me know if there is anything I can do to help.

I'd like to see the the patches and and blog post released this week if possible. Please let me know if there is anything I can do to help.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Tyler Hicks (tyhicks)](https://launchpad.net/~tyhicks) wrote on 2016-12-13: |  |  | [#20](/apport/%2Bbug/1648806/comments/20) |
| --- | --- | --- | --- |

I spoke with Debian earlier today and we do not need to coordinate with them for this issue as apport is only in experimental and they can update it after this issue is made public.

We (Ubuntu Security) are internally investigating if we could do a coordinated release date (CRD) of this week (taking security update prep and QA into account). We'll report back in a little while.

I spoke with Debian earlier today and we do not need to coordinate with them for this issue as apport is only in experimental and they can update it after this issue is made public.
We (Ubuntu Security) are internally investigating if we could do a coordinated release date (CRD) of this week (taking security update prep and QA into account). We'll report back in a little while.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie) wrote on 2016-12-14: |  |  | [#21](/apport/%2Bbug/1648806/comments/21) |
| --- | --- | --- | --- |

* [apport\_2.0.1-0ubuntu17.15.debdiff](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4791373/%2Bfiles/apport_2.0.1-0ubuntu17.15.debdiff)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4791373)
  (12.9 KiB,
  text/plain)

Martin, thanks for the third patch; I've updated the packages that Marc had worked on to incorporate them. The patch applied with little difficulty on all releases except for precise; I'm attaching the debdiff for that release for review.

Donncha: would a CRD of 22:00UTC December 14th (i.e. tomorrow) work for you?

Thanks.

Martin, thanks for the third patch; I've updated the packages that Marc had worked on to incorporate them. The patch applied with little difficulty on all releases except for precise; I'm attaching the debdiff for that release for review.
Donncha: would a CRD of 22:00UTC December 14th (i.e. tomorrow) work for you?
Thanks.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-14: |  |  | [#22](/apport/%2Bbug/1648806/comments/22) |
| --- | --- | --- | --- |

Steve: Yes a CRD of 22:00 UTC today December 14th works for me.

Can you link to <https://donncha.is/2016/12/compromising-ubuntu-desktop/> in the notification as it provides more information. That post will be published at 22:00 UTC. Thanks for you speed in getting this released.

Steve: Yes a CRD of 22:00 UTC today December 14th works for me.
Can you link to https://donncha.is/2016/12/compromising-ubuntu-desktop/ in the notification as it provides more information. That post will be published at 22:00 UTC. Thanks for you speed in getting this released.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-14: |  |  | [#23](/apport/%2Bbug/1648806/comments/23) |
| --- | --- | --- | --- |

OK, I'll prepare a new upstream release locally then and push bzr/publish it on 22:00 UTC today. Thanks!

OK, I'll prepare a new upstream release locally then and push bzr/publish it on 22:00 UTC today. Thanks!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-14: |  |  | [#25](/apport/%2Bbug/1648806/comments/25) |
| --- | --- | --- | --- |

MITRE has assigned CVE-2016-9949 for the CrashDB bug, and CVE-2016-9950 for the hook path traversal bug.

I haven't yet to receive a response to my follow up request for a CVE-ID for the "Relaunch" issue.

MITRE has assigned CVE-2016-9949 for the CrashDB bug, and CVE-2016-9950 for the hook path traversal bug.
I haven't yet to receive a response to my follow up request for a CVE-ID for the "Relaunch" issue.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Donncha O Cearbhaill (donnchac)](https://launchpad.net/~donnchac) wrote on 2016-12-14: |  |  | [#26](/apport/%2Bbug/1648806/comments/26) |
| --- | --- | --- | --- |

MITRE have issued CVE-2016-9951 for the "Relaunch" issue.

MITRE have issued CVE-2016-9951 for the "Relaunch" issue.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-14: |  |  | [#27](/apport/%2Bbug/1648806/comments/27) |
| --- | --- | --- | --- |

I already prepared the upstream and zesty release this afternoon, but I guess I'll re-do that now to add the CVE numbers. Thanks for requesting them!

I already prepared the upstream and zesty release this afternoon, but I guess I'll re-do that now to add the CVE numbers. Thanks for requesting them!

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-14: |  |  | [#28](/apport/%2Bbug/1648806/comments/28) |
| --- | --- | --- | --- |

FTR, everything is good to go on my side for new upstream release and tested zesty package (including CVEs), will unleash in 1.5 hours.

FTR, everything is good to go on my side for new upstream release and tested zesty package (including CVEs), will unleash in 1.5 hours.

| Changed in apport (Ubuntu Zesty): | |
| --- | --- |
| **status**: | New → Fix Committed |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie) wrote on 2016-12-14: |  |  | [#29](/apport/%2Bbug/1648806/comments/29) |
| --- | --- | --- | --- |

On Wed, Dec 14, 2016 at 07:17:15AM -0000, Donncha O Cearbhaill wrote:

> Steve: Yes a CRD of 22:00 UTC today December 14th works for me.

>

> Can you link to <https://donncha.is/2016/12/compromising-ubuntu-desktop/>

> in the notification as it provides more information. That post will be

> published at 22:00 UTC. Thanks for you speed in getting this released.

We don't include external references in the announcements themselves;

however, I'll ensure a reference to your blog post is included with

each of the CVE entries in the Ubuntu Security Team's CVE tracker,

now that Mitre has assigned CVEs. The CVE entries are linked from

the USN, so it'll still be findable for anyone who researches the

specific issues.

Thanks!

--

Steve Beattie

<email address hidden>

<http://NxNW.org/~steve/>

On Wed, Dec 14, 2016 at 07:17:15AM -0000, Donncha O Cearbhaill wrote:
> Steve: Yes a CRD of 22:00 UTC today December 14th works for me.
>
> Can you link to https://donncha.is/2016/12/compromising-ubuntu-desktop/
> in the notification as it provides more information. That post will be
> published at 22:00 UTC. Thanks for you speed in getting this released.
We don't include external references in the announcements themselves;
however, I'll ensure a reference to your blog post is included with
each of the CVE entries in the Ubuntu Security Team's CVE tracker,
now that Mitre has assigned CVEs. The CVE entries are linked from
the USN, so it'll still be findable for anyone who researches the
specific issues.
Thanks!
--
Steve Beattie
<sbeattie@ubuntu.com>
http://NxNW.org/~steve/

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-12-14: |  |  | [#30](/apport/%2Bbug/1648806/comments/30) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.0.1-0ubuntu17.15

---------------

apport (2.0.1-0ubuntu17.15) precise-security; urgency=medium

[ Marc Deslauriers ]

  \* SECURITY UPDATE: path traversal vulnerability with hooks execution

    - Clean path in apport/report.py, added test to test/test\_ui.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

[ Steve Beattie ]

  \* SECURITY UPDATE: code execution via malicious crash files

    - Only offer restarting the application when processing a

      crash file in /var/crash in apport/ui.py, gtk/apport-gtk,

      and kde/apport-kde. Add testcases to test/test\_ui.py,

      test/test\_ui\_gtk.py, and test\_ui\_kde.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

-- Marc Deslauriers <email address hidden> Mon, 12 Dec 2016 07:34:52 -0500

This bug was fixed in the package apport - 2.0.1-0ubuntu17.15
---------------
apport (2.0.1-0ubuntu17.15) precise-security; urgency=medium
[ Marc Deslauriers ]
\* SECURITY UPDATE: path traversal vulnerability with hooks execution
- Clean path in apport/report.py, added test to test/test\_ui.py.
- No CVE number
- LP: #1648806
[ Steve Beattie ]
\* SECURITY UPDATE: code execution via malicious crash files
- Only offer restarting the application when processing a
crash file in /var/crash in apport/ui.py, gtk/apport-gtk,
and kde/apport-kde. Add testcases to test/test\_ui.py,
test/test\_ui\_gtk.py, and test\_ui\_kde.py.
- No CVE number
- LP: #1648806
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Mon, 12 Dec 2016 07:34:52 -0500

| Changed in apport (Ubuntu Precise): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-12-14: |  |  | [#31](/apport/%2Bbug/1648806/comments/31) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.20.1-0ubuntu2.4

---------------

apport (2.20.1-0ubuntu2.4) xenial-security; urgency=medium

[ Marc Deslauriers ]

  \* SECURITY UPDATE: code execution via malicious crash files

    - Use ast.literal\_eval in apport/ui.py, added test to test/test\_ui.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

  \* SECURITY UPDATE: path traversal vulnerability with hooks execution

    - Clean path in apport/report.py, added test to test/test\_ui.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

[ Steve Beattie ]

  \* SECURITY UPDATE: code execution via malicious crash files

    - Only offer restarting the application when processing a

      crash file in /var/crash in apport/ui.py, gtk/apport-gtk,

      and kde/apport-kde. Add testcases to test/test\_ui.py,

      test/test\_ui\_gtk.py, and test\_ui\_kde.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

-- Marc Deslauriers <email address hidden> Mon, 12 Dec 2016 07:26:36 -0500

This bug was fixed in the package apport - 2.20.1-0ubuntu2.4
---------------
apport (2.20.1-0ubuntu2.4) xenial-security; urgency=medium
[ Marc Deslauriers ]
\* SECURITY UPDATE: code execution via malicious crash files
- Use ast.literal\_eval in apport/ui.py, added test to test/test\_ui.py.
- No CVE number
- LP: #1648806
\* SECURITY UPDATE: path traversal vulnerability with hooks execution
- Clean path in apport/report.py, added test to test/test\_ui.py.
- No CVE number
- LP: #1648806
[ Steve Beattie ]
\* SECURITY UPDATE: code execution via malicious crash files
- Only offer restarting the application when processing a
crash file in /var/crash in apport/ui.py, gtk/apport-gtk,
and kde/apport-kde. Add testcases to test/test\_ui.py,
test/test\_ui\_gtk.py, and test\_ui\_kde.py.
- No CVE number
- LP: #1648806
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Mon, 12 Dec 2016 07:26:36 -0500

| Changed in apport (Ubuntu Xenial): | |
| --- | --- |
| **status**: | New → Fix Released |

[Steve Beattie (sbeattie)](https://launchpad.net/~sbeattie)
on 2016-12-14

| **information type**: | Private Security → Public Security |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-14: |  |  | [#32](/apport/%2Bbug/1648806/comments/32) |
| --- | --- | --- | --- |

New upstream release with the fixes: <https://launchpad.net/apport/trunk/2.20.4>

Note that Brian committed some changes to trunk in the last 1.5 hours, so we had some mid-air collection. I force-pushed trunk and will put back his commits on top.

New upstream release with the fixes: https://launchpad.net/apport/trunk/2.20.4
Note that Brian committed some changes to trunk in the last 1.5 hours, so we had some mid-air collection. I force-pushed trunk and will put back his commits on top.

| Changed in apport: | |
| --- | --- |
| **status**: | In Progress → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-12-14: |  |  | [#33](/apport/%2Bbug/1648806/comments/33) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.14.1-0ubuntu3.23

---------------

apport (2.14.1-0ubuntu3.23) trusty-security; urgency=medium

[ Marc Deslauriers ]

  \* SECURITY UPDATE: code execution via malicious crash files

    - Use ast.literal\_eval in apport/ui.py, added test to test/test\_ui.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

  \* SECURITY UPDATE: path traversal vulnerability with hooks execution

    - Clean path in apport/report.py, added test to test/test\_ui.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

[ Steve Beattie ]

  \* SECURITY UPDATE: code execution via malicious crash files

    - Only offer restarting the application when processing a

      crash file in /var/crash in apport/ui.py, gtk/apport-gtk,

      and kde/apport-kde. Add testcases to test/test\_ui.py,

      test/test\_ui\_gtk.py, and test\_ui\_kde.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

-- Marc Deslauriers <email address hidden> Mon, 12 Dec 2016 07:27:21 -0500

This bug was fixed in the package apport - 2.14.1-0ubuntu3.23
---------------
apport (2.14.1-0ubuntu3.23) trusty-security; urgency=medium
[ Marc Deslauriers ]
\* SECURITY UPDATE: code execution via malicious crash files
- Use ast.literal\_eval in apport/ui.py, added test to test/test\_ui.py.
- No CVE number
- LP: #1648806
\* SECURITY UPDATE: path traversal vulnerability with hooks execution
- Clean path in apport/report.py, added test to test/test\_ui.py.
- No CVE number
- LP: #1648806
[ Steve Beattie ]
\* SECURITY UPDATE: code execution via malicious crash files
- Only offer restarting the application when processing a
crash file in /var/crash in apport/ui.py, gtk/apport-gtk,
and kde/apport-kde. Add testcases to test/test\_ui.py,
test/test\_ui\_gtk.py, and test\_ui\_kde.py.
- No CVE number
- LP: #1648806
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Mon, 12 Dec 2016 07:27:21 -0500

| Changed in apport (Ubuntu Trusty): | |
| --- | --- |
| **status**: | New → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-12-14: |  |  | [#34](/apport/%2Bbug/1648806/comments/34) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.20.3-0ubuntu8.2

---------------

apport (2.20.3-0ubuntu8.2) yakkety-security; urgency=medium

[ Marc Deslauriers ]

  \* SECURITY UPDATE: code execution via malicious crash files

    - Use ast.literal\_eval in apport/ui.py, added test to test/test\_ui.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

  \* SECURITY UPDATE: path traversal vulnerability with hooks execution

    - Clean path in apport/report.py, added test to test/test\_ui.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

[ Steve Beattie ]

  \* SECURITY UPDATE: code execution via malicious crash files

    - Only offer restarting the application when processing a

      crash file in /var/crash in apport/ui.py, gtk/apport-gtk,

      and kde/apport-kde. Add testcases to test/test\_ui.py,

      test/test\_ui\_gtk.py, and test\_ui\_kde.py.

    - No CVE number

    - LP: [#1648806](/bugs/1648806)

-- Marc Deslauriers <email address hidden> Tue, 13 Dec 2016 10:55:09 -0800

This bug was fixed in the package apport - 2.20.3-0ubuntu8.2
---------------
apport (2.20.3-0ubuntu8.2) yakkety-security; urgency=medium
[ Marc Deslauriers ]
\* SECURITY UPDATE: code execution via malicious crash files
- Use ast.literal\_eval in apport/ui.py, added test to test/test\_ui.py.
- No CVE number
- LP: #1648806
\* SECURITY UPDATE: path traversal vulnerability with hooks execution
- Clean path in apport/report.py, added test to test/test\_ui.py.
- No CVE number
- LP: #1648806
[ Steve Beattie ]
\* SECURITY UPDATE: code execution via malicious crash files
- Only offer restarting the application when processing a
crash file in /var/crash in apport/ui.py, gtk/apport-gtk,
and kde/apport-kde. Add testcases to test/test\_ui.py,
test/test\_ui\_gtk.py, and test\_ui\_kde.py.
- No CVE number
- LP: #1648806
-- Marc Deslauriers <marc.deslauriers@ubuntu.com> Tue, 13 Dec 2016 10:55:09 -0800

| Changed in apport (Ubuntu Yakkety): | |
| --- | --- |
| **status**: | New → Fix Released |

[Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton)
on 2016-12-15

| **tags**: | added: patch |
| --- | --- |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Ubuntu Foundations Team Bug Bot (crichton)](https://launchpad.net/~crichton) wrote on 2016-12-15: |  |  | [#35](/apport/%2Bbug/1648806/comments/35) |
| --- | --- | --- | --- |

The attachment "proposed fix for CrashDB code execution" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.

[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

The attachment "proposed fix for CrashDB code execution" seems to be a patch. If it isn't, please remove the "patch" flag from the attachment, remove the "patch" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.
[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Launchpad Janitor (janitor)](https://launchpad.net/~janitor) wrote on 2016-12-15: |  |  | [#36](/apport/%2Bbug/1648806/comments/36) |
| --- | --- | --- | --- |

This bug was fixed in the package apport - 2.20.4-0ubuntu1

---------------

apport (2.20.4-0ubuntu1) zesty; urgency=medium

\* New upstream release:

    - SECURITY FIX: Restrict a report's CrashDB field to literals.

      Use ast.literal\_eval() instead of the generic eval(), to prevent

      arbitrary code execution from malicious .crash files. A user could be

      tricked into opening a crash file whose CrashDB field contains an

      exec(), open(), or similar commands; this is fairly easy as we install a

      MIME handler for these. Thanks to Donncha O'Cearbhaill for discovering

      this! (CVE-2016-9949, LP: [#1648806](/bugs/1648806))

    - SECURITY FIX: Fix path traversal vulnerability with hooks execution.

      Ensure that Package: and SourcePackage: fields loaded from reports do

      not contain directories. Until now, an attacker could trick a user into

      opening a malicious .crash file containing "Package:

      ../../../../some/dir/foo" which would execute /some/dir/foo.py with

      arbitrary code. Thanks to Donncha O'Cearbhaill for discovering this!

      (CVE-2016-9950, LP: [#1648806](/bugs/1648806))

    - SECURITY FIX: apport-{gtk,kde}: Only offer "Relaunch" for recent

      /var/crash crashes.

      It only makes sense to offer relaunching for crashes that just happened

      and the apport UI got triggered on those. When opening a .crash file

      copied from somewhere else or after the crash happened, this is even

      actively dangerous as a malicious crash file can specify any arbitrary

      command to run. Thanks to Donncha O'Cearbhaill for discovering this!

      (CVE-2016-9951, LP: [#1648806](/bugs/1648806))

    - backends/packaging-apt-dpkg.py: provide a fallback method if using zgrep

      to search for a file in Contents.gz fails due to a lack of memory.

      Thanks Brian Murray.

    - bin/apport-retrace: When --core-file is used instead of loading the core

      file and adding it to the apport report just pass the file reference to

      gdb.

  \* debian/control: Adjust Vcs-Bzr: for zesty branch.

-- Martin Pitt <email address hidden> Wed, 14 Dec 2016 21:28:57 +0100

This bug was fixed in the package apport - 2.20.4-0ubuntu1
---------------
apport (2.20.4-0ubuntu1) zesty; urgency=medium
\* New upstream release:
- SECURITY FIX: Restrict a report's CrashDB field to literals.
Use ast.literal\_eval() instead of the generic eval(), to prevent
arbitrary code execution from malicious .crash files. A user could be
tricked into opening a crash file whose CrashDB field contains an
exec(), open(), or similar commands; this is fairly easy as we install a
MIME handler for these. Thanks to Donncha O'Cearbhaill for discovering
this! (CVE-2016-9949, LP: #1648806)
- SECURITY FIX: Fix path traversal vulnerability with hooks execution.
Ensure that Package: and SourcePackage: fields loaded from reports do
not contain directories. Until now, an attacker could trick a user into
opening a malicious .crash file containing "Package:
../../../../some/dir/foo" which would execute /some/dir/foo.py with
arbitrary code. Thanks to Donncha O'Cearbhaill for discovering this!
(CVE-2016-9950, LP: #1648806)
- SECURITY FIX: apport-{gtk,kde}: Only offer "Relaunch" for recent
/var/crash crashes.
It only makes sense to offer relaunching for crashes that just happened
and the apport UI got triggered on those. When opening a .crash file
copied from somewhere else or after the crash happened, this is even
actively dangerous as a malicious crash file can specify any arbitrary
command to run. Thanks to Donncha O'Cearbhaill for discovering this!
(CVE-2016-9951, LP: #1648806)
- backends/packaging-apt-dpkg.py: provide a fallback method if using zgrep
to search for a file in Contents.gz fails due to a lack of memory.
Thanks Brian Murray.
- bin/apport-retrace: When --core-file is used instead of loading the core
file and adding it to the apport report just pass the file reference to
gdb.
\* debian/control: Adjust Vcs-Bzr: for zesty branch.
-- Martin Pitt <martin.pitt@ubuntu.com> Wed, 14 Dec 2016 21:28:57 +0100

| Changed in apport (Ubuntu Zesty): | |
| --- | --- |
| **status**: | Fix Committed → Fix Released |

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Benjamin Bach (benjaoming)](https://launchpad.net/~benjaoming) wrote on 2016-12-16: |  |  | [#37](/apport/%2Bbug/1648806/comments/37) |
| --- | --- | --- | --- |

Question:

The release notes state: "Use ast.literal\_eval() instead of the generic eval(), to prevent arbitrary code execution from malicious .crash files"

The change should be in ui.py in this revision:

<http://bazaar.launchpad.net/~apport-hackers/apport/trunk/revision/3114>

Just to be clear: How does "self.offer\_restart = True" avoid generic "eval()" and use "ast.literal\_eval()" instead?

Does this also mean that there are still situations where "eval()" is called? And why? This always leads to security issues, it's just a matter of time.

Thanks for fixing it quickly.

Question:
The release notes state: "Use ast.literal\_eval() instead of the generic eval(), to prevent arbitrary code execution from malicious .crash files"
The change should be in ui.py in this revision:
http://bazaar.launchpad.net/~apport-hackers/apport/trunk/revision/3114
Just to be clear: How does "self.offer\_restart = True" avoid generic "eval()" and use "ast.literal\_eval()" instead?
Does this also mean that there are still situations where "eval()" is called? And why? This always leads to security issues, it's just a matter of time.
Thanks for fixing it quickly.

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Patrick Kilgore (patrick-kilgore)](https://launchpad.net/~patrick-kilgore) wrote on 2016-12-16: |  |  | [#38](/apport/%2Bbug/1648806/comments/38) |
| --- | --- | --- | --- |

@benjaoming Looks like commit notes mixed up between 3114 and 3112.

The eval fix (CVE-2016-9949) is in 3112:

<https://bazaar.launchpad.net/~apport-hackers/apport/trunk/revision/3112/>

The patch in 3114 fixes CVE-2016-9951 (Relaunch code execution).

@benjaoming Looks like commit notes mixed up between 3114 and 3112.
The eval fix (CVE-2016-9949) is in 3112:
https://bazaar.launchpad.net/~apport-hackers/apport/trunk/revision/3112/
The patch in 3114 fixes CVE-2016-9951 (Relaunch code execution).

Revision history for this message
![](/+icing/build/overlay/assets/skins/sam/images/close.gif)

| [Martin Pitt (pitti)](https://launchpad.net/~pitti) wrote on 2016-12-18: |  |  | [#39](/apport/%2Bbug/1648806/comments/39) |
| --- | --- | --- | --- |

@Benjamin: Argh, I had to uncommit/recommit these three as the CVE numbers came in at the last minute, and apparently got the commit messages the wrong way around (meh @ not having rebase in bzr..) I did some surgery on the branch and the commit messages are correct now.

When I created the fixes I also verified that this was the only eval() in the entire source, there is none left now.

@Benjamin: Argh, I had to uncommit/recommit these three as the CVE numbers came in at the last minute, and apparently got the commit messages the wrong way around (meh @ not having rebase in bzr..) I did some surgery on the branch and the commit messages are correct now.
When I created the fixes I also verified that this was the only eval() in the entire source, there is none left now.

[See full activity log](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Bactivity)

To post a comment you must [log in](%2Blogin?comments=all).

* [Report a bug](/apport/%2Bfilebug)

This report contains
**Public Security**
information

Everyone can see this security related information.

You are
[not directly subscribed to this bug's notifications.](/apport/%2Bbug/1648806/%2Bsubscribe)

Subscribing...

* [Edit bug mail](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Bsubscriptions "View and change your subscriptions to this bug")

## Other bug subscribers

[Subscribe someone else](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Baddsubscriber "Launchpad will email that person whenever this bugs changes")

## Patches

* [proposed fix for CrashDB code execution](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4789981/%2Bfiles/apport.crashdb-exec.patch)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4789981 "Change patch details")
* [proposed patch for Package: path traversal](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4790242/%2Bfiles/apport.package-path-traversal.patch)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4790242 "Change patch details")
* [proposed fix for relaunch code execution](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4791203/%2Bfiles/apport.restrict-relaunch.patch)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4791203 "Change patch details")
* [apport\_2.0.1-0ubuntu17.15.debdiff](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4791373/%2Bfiles/apport_2.0.1-0ubuntu17.15.debdiff)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4791373 "Change patch details")

* [Add patch](/apport/%2Bbug/1648806/%2Baddcomment?field.patch=on)

## Bug attachments

* [POC exploit](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4789559/%2Bfiles/minimal-rce.crash)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4789559 "Change attachment details")
* [hook.py](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4790031/%2Bfiles/hook.py)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4790031 "Change attachment details")
* [hook.crash](https://bugs.launchpad.net/apport/%2Bbug/1648806/%2Battachment/4790032/%2Bfiles/hook.crash)
  [Edit](/apport/%2Bbug/1648806/%2Battachment/4790032 "Change attachment details")

* [Add attachment](/apport/%2Bbug/1648806/%2Baddcomment)

## Remote bug watches

Bug watches keep track of this bug in other bug trackers.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)
 •
[Take the tour](https://launchpad.net/%2Btour)
 •
[Read the guide](https://help.launchpad.net/)

© 2004
[Canonical Ltd.](http://canonical.com/)
 •
[Terms of use](https://launchpad.net/legal)
 •
[Data privacy](https://www.ubuntu.com/legal/dataprivacy)
 •
[Contact Launchpad Support](/feedback)
 •
[Blog](http://blog.launchpad.net/)
 •
[Careers](https://canonical.com/careers)
 •
[System status](https://ubuntu.social/%40launchpadstatus)
 •
4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from github.com_86a12bd6_20250125_111522.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDonnchaC%2Fubuntu-apport-exploitation)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FDonnchaC%2Fubuntu-apport-exploitation)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=DonnchaC%2Fubuntu-apport-exploitation)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[DonnchaC](/DonnchaC)
/
**[ubuntu-apport-exploitation](/DonnchaC/ubuntu-apport-exploitation)**
Public

* [Notifications](/login?return_to=%2FDonnchaC%2Fubuntu-apport-exploitation) You must be signed in to change notification settings
* [Fork
  20](/login?return_to=%2FDonnchaC%2Fubuntu-apport-exploitation)
* [Star
   97](/login?return_to=%2FDonnchaC%2Fubuntu-apport-exploitation)

This project contains a PoC and exploit generator for a code execution bug in Ubuntu's Apport crash reporter

[donncha.is/2016/12/compromising-ubuntu-desktop/](https://donncha.is/2016/12/compromising-ubuntu-desktop/ "https://donncha.is/2016/12/compromising-ubuntu-desktop/")

[97
stars](/DonnchaC/ubuntu-apport-exploitation/stargazers) [20
forks](/DonnchaC/ubuntu-apport-exploitation/forks) [Branches](/DonnchaC/ubuntu-apport-exploitation/branches) [Tags](/DonnchaC/ubuntu-apport-exploitation/tags) [Activity](/DonnchaC/ubuntu-apport-exploitation/activity)
 [Star](/login?return_to=%2FDonnchaC%2Fubuntu-apport-exploitation)

 [Notifications](/login?return_to=%2FDonnchaC%2Fubuntu-apport-exploitation) You must be signed in to change notification settings

* [Code](/DonnchaC/ubuntu-apport-exploitation)
* [Issues
  0](/DonnchaC/ubuntu-apport-exploitation/issues)
* [Pull requests
  0](/DonnchaC/ubuntu-apport-exploitation/pulls)
* [Actions](/DonnchaC/ubuntu-apport-exploitation/actions)
* [Projects
  0](/DonnchaC/ubuntu-apport-exploitation/projects)
* [Security](/DonnchaC/ubuntu-apport-exploitation/security)
* [Insights](/DonnchaC/ubuntu-apport-exploitation/pulse)

Additional navigation options

* [Code](/DonnchaC/ubuntu-apport-exploitation)
* [Issues](/DonnchaC/ubuntu-apport-exploitation/issues)
* [Pull requests](/DonnchaC/ubuntu-apport-exploitation/pulls)
* [Actions](/DonnchaC/ubuntu-apport-exploitation/actions)
* [Projects](/DonnchaC/ubuntu-apport-exploitation/projects)
* [Security](/DonnchaC/ubuntu-apport-exploitation/security)
* [Insights](/DonnchaC/ubuntu-apport-exploitation/pulse)

# DonnchaC/ubuntu-apport-exploitation

    master[Branches](/DonnchaC/ubuntu-apport-exploitation/branches)[Tags](/DonnchaC/ubuntu-apport-exploitation/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[13 Commits](/DonnchaC/ubuntu-apport-exploitation/commits/master/) | | |
| [exploit-builder](/DonnchaC/ubuntu-apport-exploitation/tree/master/exploit-builder "exploit-builder") | | [exploit-builder](/DonnchaC/ubuntu-apport-exploitation/tree/master/exploit-builder "exploit-builder") |  |  |
| [README.md](/DonnchaC/ubuntu-apport-exploitation/blob/master/README.md "README.md") | | [README.md](/DonnchaC/ubuntu-apport-exploitation/blob/master/README.md "README.md") |  |  |
| [minimal-rce.crash](/DonnchaC/ubuntu-apport-exploitation/blob/master/minimal-rce.crash "minimal-rce.crash") | | [minimal-rce.crash](/DonnchaC/ubuntu-apport-exploitation/blob/master/minimal-rce.crash "minimal-rce.crash") |  |  |
| View all files | | |

## Repository files navigation

* README
# Code Execution on Ubuntu Desktop >= 12.10 (Quantal)

Ubuntu ships the Apport crash handling software with all of its recent Desktop releases. This repo contains an exploit for a bug in the Apport crash report parser which can provide reliable code execution upon opening an Apport crash file. The parsing bug results in Python code injection in the Apport process. Exploiting this issue does not involve any memory corruption and it is extremely reliable.

For more information please check out my [blog post](https://donncha.is/2016/12/compromising-ubuntu-desktop/). This bug and other security issues were fixed in Apport on 2016-12-14 (CVE-2016-9949, CVE-2016-9950, and CVE-2016-9951).

## About

This project contains a PoC and exploit generator for a code execution bug in Ubuntu's Apport crash reporter

[donncha.is/2016/12/compromising-ubuntu-desktop/](https://donncha.is/2016/12/compromising-ubuntu-desktop/ "https://donncha.is/2016/12/compromising-ubuntu-desktop/")

### Resources

[Readme](#readme-ov-file)

[Activity](/DonnchaC/ubuntu-apport-exploitation/activity)
### Stars

[**97**
stars](/DonnchaC/ubuntu-apport-exploitation/stargazers)
### Watchers

[**8**
watching](/DonnchaC/ubuntu-apport-exploitation/watchers)
### Forks

[**20**
forks](/DonnchaC/ubuntu-apport-exploitation/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FDonnchaC%2Fubuntu-apport-exploitation&report=DonnchaC+%28user%29)

## [Releases](/DonnchaC/ubuntu-apport-exploitation/releases)

No releases published

## [Packages 0](/users/DonnchaC/packages?repo_name=ubuntu-apport-exploitation)

No packages published

## Languages

* [Python
  100.0%](/DonnchaC/ubuntu-apport-exploitation/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.


