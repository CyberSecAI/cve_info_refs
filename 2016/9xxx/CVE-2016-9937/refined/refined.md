Based on the provided information, here's an analysis of CVE-2016-9937:

**Root Cause:**

- The vulnerability lies in the `sdp_fmtp_get` function within the `res_format_attr_opus.c` module of Asterisk.
- This function is responsible for parsing the `fmtp` (format parameters) line in Session Description Protocol (SDP) messages when the Opus codec is used.
- The issue arises when the `fmtp` line contains spaces between the attributes (e.g., `a=fmtp:107 useinbandfec=0; cbr=1; minptime=10; maxptime=40`).
- The original implementation used recursion and did not properly handle these spaces.

**Weaknesses/Vulnerabilities:**

- **Recursive Function Call:** The `sdp_fmtp_get` function recursively called itself if the attribute being searched was not found immediately. This was done to handle scenarios with embedded attribute names (e.g., `ptime` in `maxptime`).
- **Incorrect Space Handling:** The code incorrectly handled spaces within the `fmtp` line. It treated spaces as delimiters between attributes, and if the attribute being searched for was preceded by a space, recursion was triggered.
- **Stack Overflow:** Due to the recursive nature of the function and incorrect handling of spaces in `fmtp` lines, a crafted SDP message could lead to a stack overflow.

**Impact of Exploitation:**

- **Remote Crash:** A specially crafted SDP offer or answer containing the Opus codec with spaces in the `fmtp` line could cause the Asterisk server to crash. This can lead to a denial of service.
- **Denial of Service (DoS):** The crash effectively prevents the Asterisk server from processing calls, disrupting service for users.
- **No Authentication Required:** The vulnerability could be triggered remotely by any unauthenticated user if guest is enabled for `chan_sip` or anonymous for `chan_pjsip`, as SDP processing occurs even without authentication.

**Attack Vectors:**

- **SDP Message:** The attack vector is an SDP message, either an offer or answer, that includes the Opus codec and contains spaces between attributes in the `fmtp` line.
- **Network:** The attacker can send such a message to an Asterisk server via SIP or PJSIP protocol, as part of the call initiation process.

**Required Attacker Capabilities/Position:**

- **Network Access:** The attacker needs network access to the Asterisk server to send SIP or PJSIP messages.
- **No Authentication:** The attacker does not need to be an authenticated user to trigger the vulnerability.

**Additional Details:**

- The fix involves modifying the `sdp_fmtp_get` function to iteratively parse the `fmtp` line, skipping spaces and using `strncmp` for attribute matching, removing the recursive call.
- The vulnerability affects all versions of Asterisk 14.x and versions of Asterisk 13.x prior to 13.13.1.
- The fix has been incorporated in Asterisk versions 13.13.1 and 14.2.1.