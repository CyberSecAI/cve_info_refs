Based on the provided information, here's a breakdown of CVE-2016-9387:

**1. Verification:**

The provided content directly relates to CVE-2016-9387. The Red Hat Bugzilla entry specifically mentions "CVE-2016-9387 jasper: integer overflow in jpc\_dec\_process\_siz()", and the Red Hat Security Advisory (RHSA-2017:1208) lists CVE-2016-9387 as one of the addressed vulnerabilities in the Jasper library.

**2. Vulnerability Details:**

*   **Root Cause:** An integer overflow vulnerability exists within the `jpc_dec_process_siz` function of the Jasper library. This overflow occurs during the calculation of the number of tiles (`dec->numtiles`) when processing a crafted image file.
*   **Weaknesses/Vulnerabilities:**
    *   Integer Overflow: The multiplication of `dec->numhtiles` and `dec->numvtiles` is performed to compute `dec->numtiles`. If these values are sufficiently large, the result might exceed the maximum value of the `size_t` data type which is then cast into an integer which could result in an integer overflow which leads to an incorrect tile count.
    *   Incomplete Fix: The initial fix using `jas_safe_size_mul()` only checked if the multiplication result could fit in a `size_t` but then cast the result to an `int` type `dec->numtiles`, this could still lead to overflow if the `size_t` was larger than an `int`.
*   **Impact of Exploitation:**
    *   Application Crash: Although the specific integer overflow in this function did not directly lead to a heap-based buffer overflow, it was initially identified due to an assertion failure which led to application termination..
    *   Potential for Further Exploitation: Although not directly exploitable in this instance the potential of memory corruption is possible.
*   **Attack Vectors:**
    *   Malicious Image File: The vulnerability is triggered when a specially crafted JPEG 2000 image file is processed using the Jasper library.

*  **Required Attacker Capabilities/Position**
    *   The attacker needs to be able to supply a crafted image file for processing by a vulnerable application that uses the jasper library.
**3. Additional Details from Content:**

*   **Upstream Commit:** The specific commit that fixes the primary overflow issue is: [https://github.com/mdadams/jasper/commit/d91198abd00fc435a397fe6bad906a4c1748e9cf](https://github.com/mdadams/jasper/commit/d91198abd00fc435a397fe6bad906a4c1748e9cf)
*   **Gentoo Advisory:** A Gentoo blog post details the original discovery and the assertion failure, also including a link to a testcase: [https://blogs.gentoo.org/ago/2016/11/16/jasper-multiple-assertion-failure/](https://blogs.gentoo.org/ago/2016/11/16/jasper-multiple-assertion-failure/)
*   **Red Hat Fix:** Red Hat addressed this vulnerability in RHSA-2017:1208: [https://access.redhat.com/errata/RHSA-2017:1208](https://access.redhat.com/errata/RHSA-2017:1208)
*   **Original Report:**  The vulnerability was initially reported due to an assertion failure: `/tmp/portage/media-libs/jasper-1.900.12/work/jasper-1.900.12/src/libjasper/base/jas_seq.c:90: jas_matrix<= yend' failed.`

**4. Summary**
CVE-2016-9387 is an integer overflow vulnerability present in the Jasper library. The overflow is located in the jpc\_dec\_process\_siz() which can lead to application crashes when processing a malicious image file. Although the allocated memory is not accessed beyond the miscalculated limit, this type of vulnerability can often lead to exploitation. The fix is included in the upstream commit and also patched by Red Hat in RHSA-2017:1208.