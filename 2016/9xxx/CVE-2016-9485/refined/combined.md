=== Content from www.kb.cert.org_543c3904_20250124_124348.html ===


search

menu

icon-carat-right

cmu-wordmark

* ×
* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

[[Carnegie Mellon University](https://www.cmu.edu)](https://www.cmu.edu/)

# [Software Engineering Institute](https://www.sei.cmu.edu/)

## CERT Coordination Center

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* [Search](/vuls/search/)
* [Report a Vulnerability](/vuls/report/)
* [Disclosure Guidance](/vuls/guidance/)
* [VINCE](/vince/)

* [Home](/vuls/)
* [Notes](/vuls/bypublished/desc/)
* Current:  VU#768331

## ForeScout CounterACT SecureConnector agent is vulnerable to privilege escalation

#### Vulnerability Note VU#768331

Original Release Date: 2016-12-07 | Last Revised: 2016-12-07

---

### Overview

On Windows endpoints, the SecureConnector agent is vulnerable to privilege escalation whereby an authenticated unprivileged user can obtain administrator privileges on the endpoint by causing the SecureConnector agent to execute arbitrary code.

### Description

| On Windows endpoints, the SecureConnector agent must run under the local SYSTEM account or another administrator account in order to enable full functionality of the agent. The typical configuration is for the agent to run as a Windows service under the local SYSTEM account. The SecureConnector agent runs various plugin scripts and executables on the endpoint in order to gather and report information about the host to the CounterACT management appliance. The SecureConnector agent downloads these scripts and executables as needed from the CounterACT management appliance and runs them on the endpoint.  [**CWE-378**](https://cwe.mitre.org/data/definitions/378.html)**: Creation of Temporary File with Insecure Permissions** - CVE-2016-9485 The SecureConnector agent fails to set any permissions on downloaded file objects. This allows a malicious user to take ownership of any of these files and make modifications to it, regardless of where the files are saved. These files are then executed under SYSTEM privileges. A malicious unprivileged user can overwrite these executable files with malicious code before the SecureConnector agent executes them, causing the malicious code to be run under the SYSTEM account.[**CWE-379**](https://cwe.mitre.org/data/definitions/379.html)**: Creation of Temporary File in Directory with Incorrect Permission****s** - CVE-2016-9486 By default, these executable files are downloaded to and run from the %TEMP% directory of the currently logged on user, despite the fact that the SecureConnector agent is running as SYSTEM. Aside from the downloaded scripts, the SecureConnector agent runs a batch file with SYSTEM privileges from the temp directory of the currently logged on user. If the naming convention of this script can be derived, which is made possible by placing it in a directory to which the user has read access, it may be possible overwrite the legitimate batch file with a malicious one before SecureConnector executes it.It is possible to change this directory by setting the the configuration property config.script\_run\_folder.value in the local.properties configuration file on the CounterACT management appliance, however the batch file which is run does not follow this property.The CVSS score below represents CVE-2016-9485. |
| --- |

### Impact

| A local unprivileged attacker may gain SYSTEM privileges on an affected machine. |
| --- |

### Solution

| **Apply an update**The vendor has released the HPS Inspection Engine Plugin, version 10.4.1.1 to address the vulnerability. |
| --- |

### Vendor Information

768331
Filter by status:
All
Affected
Not Affected
Unknown

Filter by content:
 Additional information available

 Sort by:
Status
Alphabetical

Expand all

**Javascript is disabled. Click [here](/vuls/vendor/VU%23768331/) to view vendors.**
### [ForeScout](#TNOY-AGESPV) Affected

Updated:  December 07, 2016

### Status

Affected

### Vendor Statement

We have not received a statement from the vendor.

### Vendor Information

We are not aware of further vendor information regarding this vulnerability.

### CVSS Metrics

| Group | Score | Vector |
| --- | --- | --- |
| Base | 6.6 | AV:L/AC:M/Au:S/C:C/I:C/A:C |
| Temporal | 5.9 | E:POC/RL:ND/RC:C |
| Environmental | 4.4 | CDP:N/TD:M/CR:ND/IR:ND/AR:ND |

### References

* <https://www.forescout.com/products/counteract/>
* <https://cwe.mitre.org/data/definitions/378.html>
* <https://cwe.mitre.org/data/definitions/379.html>
### Acknowledgements

Thanks to Brendan Saulsbury, Ariel Montano Cardenas, and Matthew Hyde for reporting this vulnerability.

This document was written by Trent Novelly.

### Other Information

| **CVE IDs:** | [CVE-2016-9485](http://web.nvd.nist.gov/vuln/detail/CVE-2016-9485), [CVE-2016-9486](http://web.nvd.nist.gov/vuln/detail/CVE-2016-9486) |
| --- | --- |
| **Date Public:** | 2016-12-07 |
| **Date First Published:** | 2016-12-07 |
| **Date Last Updated:** | 2016-12-07 22:17 UTC |
| **Document Revision:** | 9 |

* [About vulnerability notes](https://vuls.cert.org/confluence/display/VIN/Vulnerability%2BNote%2BHelp)
* Contact us about this vulnerability
* [Provide a vendor statement](https://vuls.cert.org/confluence/display/VIN/Case%2BHandling#CaseHandling-Givingavendorstatusandstatement)

Sponsored by [CISA.](https://www.cisa.gov/cybersecurity)

 [Download PGP Key](https://vuls.cert.org/confluence/pages/viewpage.action?pageId=25985026)

[Read CERT/CC Blog](https://insights.sei.cmu.edu/cert/)

[Learn about Vulnerability Analysis](https://www.sei.cmu.edu/research-capabilities/all-work/display.cfm?customel_datapageid_4050=21304)

Carnegie Mellon University

Software Engineering Institute

4500 Fifth Avenue

Pittsburgh, PA 15213-2612

412-268-5800

[Office Locations](http://www.sei.cmu.edu/locations/index.cfm) | [Additional Sites Directory](http://www.sei.cmu.edu/additional-sites-directory/index.cfm) | [Legal](https://vuls.cert.org/confluence/display/VIN/VINCE%2BCode%2Bof%2BConduct#VINCECodeofConduct-TermsofUse) | [Privacy Notice](https://www.sei.cmu.edu/legal/privacy-notice/index.cfm) | [CMU Ethics Hotline](https://www.cmu.edu/hr/ethics-hotline/) | [www.sei.cmu.edu](http://www.sei.cmu.edu)

Â©2022 Carnegie Mellon University

[Contact SEI](https://www.sei.cmu.edu/contact-us/)
#### Contact CERT/CC

 412-268-5800


