- **Root cause of vulnerability**: The vulnerability lies in the `as_msg_peek` function where it reads the `AS_MSG_FIELD_TYPE_DIGEST_RIPE` field from a packet without validating its size. The calling function `thr_tsvc_enqueue` then uses this data to access an array, leading to an out-of-bounds read.
- **Weaknesses/vulnerabilities present**: Improper validation of array index (CWE-129), leading to an out-of-bounds read.
- **Impact of exploitation**:
    - Memory disclosure: An attacker can read arbitrary memory locations within the server process.
    - Denial of service: The vulnerability can be used to trigger a crash of the server.
- **Attack vectors**: A specially crafted network packet sent to the Aerospike server can trigger the vulnerability.
- **Required attacker capabilities/position**: The attacker needs to be able to establish a network connection to the Aerospike server and send malicious packets. No prior authentication is needed.