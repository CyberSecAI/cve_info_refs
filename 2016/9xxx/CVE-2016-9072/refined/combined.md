=== Content from bugzilla.mozilla.org_d9d1233b_20250125_194151.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1300083)
* [XML](/show_bug.cgi?ctype=xml&id=1300083)

Closed
[Bug 1300083](/show_bug.cgi?id=1300083)
(CVE-2016-9072)

Opened 8 years ago
Closed 8 years ago

# 64-bit NPAPI sandbox isn't enabled on fresh profile

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

64-bit NPAPI sandbox isn't enabled on fresh profile

## Categories

### (Core :: Security: Process Sandboxing, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=Security%3A%20Process%20Sandboxing#Security%3A%20Process%20Sandboxing)

Security: Process Sandboxing
▾

Core :: Security: Process Sandboxing
For process sandboxing bugs. Generally this covers code under the security/sandbox/ source directory, but there is code elsewhere to hook the different platform process sandboxes into Gecko etc.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=Security%3A%20Process%20Sandboxing&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=Security%3A%20Process%20Sandboxing)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

47 Branch

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

x86\_64

Windows

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla52

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| Webcompat Priority | --- |
| --- | --- |
| Performance Impact | --- |
| a11y-review | --- |
| Webcompat Score | --- |
| Accessibility Severity | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix) |
| firefox49 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=wontfix) |
| firefox-esr45 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified) |
| firefox51 | --- | [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified) |
| firefox52 | --- | [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox48 |  | wontfix |
| firefox49 |  | wontfix |
| firefox-esr45 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | verified |
| firefox51 |  | verified |
| firefox52 |  | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: bobowen, Assigned: bobowen)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/8877ff082c9a902bbf383dc11c1aeffc?d=mm&size=40)  [bobowen](/user_profile?user_id=458623)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

![](https://secure.gravatar.com/avatar/7bb698c4991c5af83adabe3c3b8ee8aa?d=mm&size=40)  [mwobensmith](/user_profile?user_id=452604)

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/8877ff082c9a902bbf383dc11c1aeffc?d=mm&size=40)  [bobowen](/user_profile?user_id=458623)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/6ad7e6f8a605ca81446ea4c83d819fb2?d=mm&size=40)  [gcp](/user_profile?user_id=151147)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

14 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1246574](/show_bug.cgi?id=1246574 "RESOLVED FIXED - Force windowless mode even if e10s is turned on"), [1342092](/show_bug.cgi?id=1342092 "RESOLVED DUPLICATE - Wheel input issues with Farmville 2")

[support-win64](/show_bug.cgi?id=558448 "RESOLVED FIXED - [Tracking bug] officially support Windows 64-bit builds")

Dependency [tree](/showdependencytree.cgi?id=1300083&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1300083)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (Keywords: csectype-priv-escalation, regression, sec-high, Whiteboard: [post-critsmash-triage][adv-main50+] sbwn1)

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2016-9072

[Keywords:](/describekeywords.cgi)

[csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[post-critsmash-triage][adv-main50+] sbwn1

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [RyanVM](/user_profile?user_id=75935) | [in-testsuite](#c14 "8 years ago") | - |
| --- | --- | --- |
| [RyanVM](/user_profile?user_id=75935) | in-testsuite | - |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | [qe-verify](#a5463262_452604 "8 years ago") | + |
| --- | --- | --- |
| [mwobensmith](/user_profile?user_id=452604) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty | ? |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (1 file)

| [Initialize Plugin Tags correctly](/attachment.cgi?id=8787605)  [8 years ago](#c1)  [Bob Owen (:bobowen)](/user_profile?user_id=458623)   1.06 KB, patch | jimm : [review+](#a7061_279663 "8 years ago")  ritu : [approval-mozilla-aurora+](#c13 "8 years ago")  ritu : [approval-mozilla-beta+](#c13 "8 years ago")  abillings : [sec-approval+](#a41493_280903 "8 years ago") | [Details](/attachment.cgi?id=8787605&action=edit) | [Diff](/attachment.cgi?id=8787605&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1300083&attachment=8787605) |
| --- | --- | --- |

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1300083#c0)• 8 years ago |
|  | |

There may be other things apart from a new profile that cause this.
I noticed this by chance and it possibly explains why people trying to reproduce [bug 1241250](/show_bug.cgi?id=1241250 "RESOLVED WORKSFORME - Prezi frozen at loading on fresh profile with latest Nightly 64 bits") were having problems, if they were using fresh installs and profiles.
It was introduced by [bug 1246574](/show_bug.cgi?id=1246574 "RESOLVED FIXED - Force windowless mode even if e10s is turned on").
[Tracking Requested - why for this release]
Very simple fix to ensure sandbox is always in place by default.

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1300083#c1)• 8 years ago |
|  | |

Attached patch

[Initialize Plugin Tags correctly](attachment.cgi?id=8787605&action=diff)
— [Details](attachment.cgi?id=8787605&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1300083&attachment=8787605)

The other constructor seems to be used for copying.
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: review?(jmathies)

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a7061_279663)• 8 years ago |

[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: review?(jmathies) → review+

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1300083#c2)• 8 years ago |
|  | |

Comment on [attachment 8787605](/attachment.cgi?id=8787605 "Initialize Plugin Tags correctly") [[details]](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") [[diff]](/attachment.cgi?id=8787605&action=diff "Initialize Plugin Tags correctly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1300083&attachment=8787605)
Initialize Plugin Tags correctly
[Security approval request comment]
How easily could an exploit be constructed based on the patch?
This isn't an exploit as such, but it does mean that any protection that the sandbox gives from exploits is not there in certain circumstances.
From the patch, it is fairly obvious that this is to do sandboxing, but it is probably not too clear in what circumstances the initialisation doesn't take place.
Do comments in the patch, the check-in comment, or tests included in the patch paint a bulls-eye on the security problem?
Check-in comment is deliberately vague, but given the previous answer that probably doesn't matter much.
Which older supported branches are affected by this flaw?
Windows 64-bit Fx47+
If not all supported branches, which bug introduced the flaw?
[Bug 1246574](/show_bug.cgi?id=1246574 "RESOLVED FIXED - Force windowless mode even if e10s is turned on").
Do you have backports for the affected branches? If not, how different, hard to create, and risky will they be?
Same patch applies cleanly up to release.
How likely is this patch to cause regressions; how much testing does it need?
The resulting setting of the sandbox level is the same as before [bug 1246574](/show_bug.cgi?id=1246574 "RESOLVED FIXED - Force windowless mode even if e10s is turned on") and the same as when an existing profile is used now, so regressions seem unlikely.
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: sec-approval?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a39261_1689)• 8 years ago |

[status-firefox48](/buglist.cgi?f1=cf_status_firefox48&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox48&o1=equals&v1=wontfix)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a39795_1689)• 8 years ago |

Blocks: [1246574](/show_bug.cgi?id=1246574 "RESOLVED FIXED - Force windowless mode even if e10s is turned on")Group: core-security → dom-core-securityKeywords: [csectype-priv-escalation](/buglist.cgi?keywords=csectype-priv-escalation&resolution=---),
[sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---)

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1300083#c3)• 8 years ago |
|  | |

You could argue this should be "sec-high" because we assume plugins have known exploitable bugs in them, especially flash because we know there's a market for them.Keywords: [sec-moderate](/buglist.cgi?keywords=sec-moderate&resolution=---) → [sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1300083#c4)• 8 years ago |
|  | |

This can land on September 20, two weeks into the new cycle. It is too late for the 49 cycle.
sec-approval+ for then.
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=wontfix)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected)
[tracking-firefox49](/buglist.cgi?f1=cf_tracking_firefox49&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox49&o1=equals&v1=%3F) → ---Whiteboard: [checkin on 9/20]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a41493_280903)• 8 years ago |

[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: sec-approval? → sec-approval+

|  | [Jim Mathies [:jimm]](/user_profile?user_id=279663) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a530653_279663)• 8 years ago |

Whiteboard: [checkin on 9/20] → [checkin on 9/20] sbwc1

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a530828_458623)• 8 years ago |

Whiteboard: [checkin on 9/20] sbwc1 → [checkin on 9/20] sbwn1

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a1234130_430528)• 8 years ago |

Blocks: [support-win64](/show_bug.cgi?id=558448 "RESOLVED FIXED - [Tracking bug] officially support Windows 64-bit builds")Priority: -- → P1

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1300083#c5)• 8 years ago |
|  | |

Is there any way to test this in automation?Flags: needinfo?(bobowen.code)Flags: in-testsuite?

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1300083#c6)• 8 years ago |
|  | |

(In reply to Ryan VanderMeulen [:RyanVM] from [comment #5](/show_bug.cgi?id=1300083#c5 "VERIFIED FIXED - 64-bit NPAPI sandbox isn't enabled on fresh profile"))
> Is there any way to test this in automation?
I'm not sure if we test with real plugins, so I guess we'd have to sandbox the test one and get it to attempt to write somewhere.
We'd also have to make sure that when the test ran it was the first time it had been started with the profile.Flags: needinfo?(bobowen.code)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1300083#c7)• 8 years ago |
|  | |

(In reply to Al Billings [:abillings] from [comment #4](/show_bug.cgi?id=1300083#c4 "VERIFIED FIXED - 64-bit NPAPI sandbox isn't enabled on fresh profile"))
> This can land on September 20, two weeks into the new cycle. It is too late
> for the 49 cycle.
>
> sec-approval+ for then.
Given that this cycle got pushed back, I just wanted to check whether you wanted to move the check-in of this back a bit?Flags: needinfo?(abillings)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1300083#c8)• 8 years ago |
|  | |

(In reply to Bob Owen (:bobowen) from [comment #7](/show_bug.cgi?id=1300083#c7 "VERIFIED FIXED - 64-bit NPAPI sandbox isn't enabled on fresh profile"))
> (In reply to Al Billings [:abillings] from [comment #4](/show_bug.cgi?id=1300083#c4 "VERIFIED FIXED - 64-bit NPAPI sandbox isn't enabled on fresh profile"))
> > This can land on September 20, two weeks into the new cycle. It is too late
> > for the 49 cycle.
> >
> > sec-approval+ for then.
>
> Given that this cycle got pushed back, I just wanted to check whether you
> wanted to move the check-in of this back a bit?
Redirecting this question to rforbes, as I saw in an email that Al is out.
I should point out that this issue is causing a problem with the website owners testing [bug 1241250](/show_bug.cgi?id=1241250 "RESOLVED WORKSFORME - Prezi frozen at loading on fresh profile with latest Nightly 64 bits").
They keep thinking they've fixed it, because I think they are using new profiles each time.
The extra noise there might mean someone else spots the problem.Flags: needinfo?(abillings) → needinfo?(rforbes)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1300083#c9)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/41972bd40b59>
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected)Whiteboard: [checkin on 9/20] sbwn1 → sbwn1

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1300083#c10)• 8 years ago |
|  | |

[Tracking Requested - why for this release]:
We should uplift this one-line fix to Beta 50 because it is a sec-high regression. Fortunately, it only affects 64-bit Firefox users.
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F)

|  | [Bob Owen (:bobowen)](/user_profile?user_id=458623)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1300083#c11)• 8 years ago |
|  | |

Comment on [attachment 8787605](/attachment.cgi?id=8787605 "Initialize Plugin Tags correctly") [[details]](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") [[diff]](/attachment.cgi?id=8787605&action=diff "Initialize Plugin Tags correctly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1300083&attachment=8787605)
Initialize Plugin Tags correctly
Looks like a decision was made on landing this, so rforbes -= ni;
Approval Request Comment
[Feature/regressing bug #]:
[Bug 1246574](/show_bug.cgi?id=1246574 "RESOLVED FIXED - Force windowless mode even if e10s is turned on").
[User impact if declined]:
The first time they use a new profile the 64-bit flash NPAPI process will not be sandboxed.
[Describe test coverage new/current, TreeHerder]:
Manually tested, good candidate for separate QE verify.
STR:
\* Install 64-bit Firefox before fix.
\* Create new profile and start Firefox.
\* Browse to a site that uses flash.
\* Use Microsoft Sysinternals Process Explorer to check integrity level of flash NPAPI plugin-container process - it will be medium and should be low. (I think you have to add the column to the main table, right click on column headings ... it's under the Process Image tab.)
[Risks and why]:
Low - simple one line fix.
[String/UUID change made/needed]:
NoneFlags: needinfo?(rforbes)
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: approval-mozilla-beta?
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: approval-mozilla-aurora?

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1300083#c12)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/41972bd40b59>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla52

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1300083#c13)• 8 years ago |
|  | |

Comment on [attachment 8787605](/attachment.cgi?id=8787605 "Initialize Plugin Tags correctly") [[details]](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") [[diff]](/attachment.cgi?id=8787605&action=diff "Initialize Plugin Tags correctly") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1300083&attachment=8787605)
Initialize Plugin Tags correctly
Sec-high, Aurora51+, Beta50+
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: approval-mozilla-beta?
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: approval-mozilla-beta+
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: approval-mozilla-aurora?
[Attachment #8787605](/attachment.cgi?id=8787605&action=edit "Initialize Plugin Tags correctly") -
Flags: approval-mozilla-aurora+

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a1837553_538805)• 8 years ago |

[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
[?](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%3F) → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)

|  | [Ryan VanderMeulen [:RyanVM]](/user_profile?user_id=75935) |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1300083#c14)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/9d6a1ee63674>
<https://hg.mozilla.org/releases/mozilla-beta/rev/93dcc6faa48f>
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)Flags: in-testsuite? → in-testsuite-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a2187863_1689)• 8 years ago |

Group: dom-core-security → core-security-release

|  | [Matt Wobensmith [:mwobensmith][:matt:]](/user_profile?user_id=452604) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a5463262_452604)• 8 years ago |

Flags: qe-verify+QA Contact: mwobensmithWhiteboard: sbwn1 → [post-critsmash-triage] sbwn1

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a5732204_280903)• 8 years ago |

Whiteboard: [post-critsmash-triage] sbwn1 → [post-critsmash-triage][adv-main50+] sbwn1

|  | [Mihai Boldan, Desktop QA [:mboldan]](/user_profile?user_id=551058) |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1300083#c15)• 8 years ago |
|  | |

I managed to reproduce this issue on Firefox 49.0, using the STR from [Comment 11](/show_bug.cgi?id=1300083#c11 "VERIFIED FIXED - 64-bit NPAPI sandbox isn't enabled on fresh profile").
The issue is no longer reproducible (the integrity of the plugin-container is low) on Firefox 50.0, Firefox 51.0a2 (2016-11-07) (64-bit), Firefox 52.0a1 (2016-11-08) (64-bit).
The tests were performed under Windows 10x64.Status: RESOLVED → VERIFIED
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified)
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a5987154_280903)• 8 years ago |

Alias: CVE-2016-9072

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a13837272_1689)• 8 years ago |

Group: core-security-release

|  | [Chris Peterson [:cpeterson]](/user_profile?user_id=430528) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1300083#a15148210_430528)• 8 years ago |

Blocks: [1342092](/show_bug.cgi?id=1342092 "RESOLVED DUPLICATE - Wheel input issues with Farmville 2")
You need to [log in](/show_bug.cgi?id=1300083&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Bob Owen (:bobowen)](/user_profile?user_id=458623)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from www.mozilla.org_ce132be8_20250125_194152.html ===


## Help us improve your Mozilla experience

In addition to Cookies necessary for this site to function, we’d like your permission to set some additional Cookies to better understand your browsing needs and improve your experience. Rest assured — we value your privacy.

Accept All Additional Cookies

Reject All Additional Cookies

[Cookie settings](/en-US/privacy/websites/cookie-settings/)

Menu
[![Mozilla](https://www.mozilla.org/media/img/logos/m24/lockup-black.f2ddba3f0724.svg)](/en-US/)

* [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
  Firefox browsers](/en-US/firefox/)
  Close Firefox browsers menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Desktop](/en-US/firefox/new/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for iOS](/en-US/firefox/browsers/mobile/ios/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/logo.eb1324e44442.svg)
    ## Firefox for Android](/en-US/firefox/browsers/mobile/android/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/browser/focus/logo.aac3e33175cb.svg)
    ## Firefox Focus](/en-US/firefox/browsers/mobile/focus/)
  + [## Firefox blog](https://blog.mozilla.org/firefox/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=firefox)
* [Products](/en-US/products/)
  Close Products menu
  + [![](https://www.mozilla.org/media/protocol/img/logos/mozilla/vpn/logo.c648f487bfb8.svg)
    ## Mozilla VPN](/en-US/products/vpn/)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/monitor/logo.d97e5516f9e6.svg)
    ## Mozilla Monitor](https://monitor.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/firefox/relay/logo-white.d42a8b52e44c.svg)
    ## Firefox Relay](https://relay.firefox.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/protocol/img/logos/pocket/logo.17446bc33a5d.svg)
    ## Pocket](https://getpocket.com/firefox_learnmore/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/nav/icons/icon-mdn-plus.f54475f980ab.svg)
    ## MDN Plus](https://developer.mozilla.org/plus?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/fakespot/logo-blue.3973b8fe9631.svg)
    ## Fakespot](https://fakespot.com/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=products)
  + [![](https://www.mozilla.org/media/img/logos/thunderbird/logo-thunderbird.121e9c0fed45.svg)
    ## Thunderbird](https://www.thunderbird.net/)

  [All products](/en-US/products/)
* [About us](/en-US/about/)
  Close About us menu

  Our Mission

  + [## About Mozilla](/en-US/about/)
  + [## The Mozilla Manifesto](/en-US/about/manifesto/)
  + [## Get Involved](/en-US/contribute/)
  + [## Innovation Projects](https://future.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Blog](https://blog.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)

  Our Work

  + [## Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla.ai](https://www.mozilla.ai/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Ventures](https://mozilla.vc/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=nav&utm_content=about-us)
  + [## Mozilla Advertising](/en-US/advertising/)

## Menu

* Mozilla Security

## [Mozilla Security](/en-US/security/)

* [Advisories](/en-US/security/advisories/)
* [Known Vulnerabilities](/en-US/security/known-vulnerabilities/)
* [Mozilla Security Blog](https://blog.mozilla.com/security/)
* [Security Bug Bounty](/en-US/security/bug-bounty/)
* [Third-party Injection Policy](/en-US/security/third-party-software-injection/)

## [Client Bug Bounty](/en-US/security/client-bug-bounty/)

* [Frequently Asked Questions](/en-US/security/bug-bounty/faq/)
* [Hall of Fame](/en-US/security/bug-bounty/hall-of-fame/)

## [Web Bug Bounty](/en-US/security/web-bug-bounty/)

* [Eligible Websites](/en-US/security/bug-bounty/web-eligible-sites/)
* [Frequently Asked Questions](/en-US/security/bug-bounty/faq-webapp/)
* [Hall of Fame](/en-US/security/bug-bounty/web-hall-of-fame/)

# Mozilla Foundation Security Advisory 2016-89

## Security vulnerabilities fixed in Firefox 50

Announced
November 15, 2016
Impact
critical
Products
Firefox
Fixed in

* Firefox 50

#### [#CVE-2016-5296: Heap-buffer-overflow WRITE in rasterize\_edges\_1](#CVE-2016-5296)

Reporter
Abhishek Arya
Impact
critical
##### Description

A heap-buffer-overflow in Cairo when processing SVG content caused by compiler optimization, resulting in a potentially exploitable crash.

##### References

* [Bug 1292443](https://bugzilla.mozilla.org/show_bug.cgi?id=1292443)

#### [#CVE-2016-5292: URL parsing causes crash](#CVE-2016-5292)

Reporter
Daniel Browning
Impact
high
##### Description

During URL parsing, a maliciously crafted URL can cause a potentially exploitable crash.

##### References

* [Bug 1288482](https://bugzilla.mozilla.org/show_bug.cgi?id=1288482)

#### [#CVE-2016-5293: Write to arbitrary file with Mozilla Updater and Maintenance Service using updater.log hardlink](#CVE-2016-5293)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

When the Mozilla Updater is run, if the Updater's log file in the working directory points to a hardlink, data can be appended to an arbitrary local file. This vulnerability requires local system access.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1246945](https://bugzilla.mozilla.org/show_bug.cgi?id=1246945)

#### [#CVE-2016-5294: Arbitrary target directory for result files of update process](#CVE-2016-5294)

Reporter
Holger Fuhrmannek
Impact
high
##### Description

The Mozilla Updater can be made to choose an arbitrary target working directory for output files resulting from the update process. This vulnerability requires local system access.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1246972](https://bugzilla.mozilla.org/show_bug.cgi?id=1246972)

#### [#CVE-2016-5297: Incorrect argument length checking in JavaScript](#CVE-2016-5297)

Reporter
André Bargull
Impact
high
##### Description

An error in argument length checking in JavaScript, leading to potential integer overflows or other bounds checking issues.

##### References

* [Bug 1303678](https://bugzilla.mozilla.org/show_bug.cgi?id=1303678)

#### [#CVE-2016-9064: Add-ons update must verify IDs match between current and new versions](#CVE-2016-9064)

Reporter
Multiple people
Impact
high
##### Description

Add-on updates failed to verify that the add-on ID inside the signed package matched the ID of the add-on being updated. An attacker who could perform a man-in-the-middle attack on the user's connection to the update server and defeat the certificate pinning protection could provide a malicious signed add-on instead of a valid update.

##### References

* [Bug 1303418](https://bugzilla.mozilla.org/show_bug.cgi?id=1303418)

#### [#CVE-2016-9065: Firefox for Android location bar spoofing using fullscreen](#CVE-2016-9065)

Reporter
Raphael
Impact
high
##### Description

The location bar in Firefox for Android can be spoofed by forcing a user into fullscreen mode, blocking its exiting, and creating of a fake location bar without any user notification.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1306696](https://bugzilla.mozilla.org/show_bug.cgi?id=1306696)

#### [#CVE-2016-9066: Integer overflow leading to a buffer overflow in nsScriptLoadHandler](#CVE-2016-9066)

Reporter
Samuel Groß
Impact
high
##### Description

A buffer overflow resulting in a potentially exploitable crash due to memory allocation issues when handling large amounts of incoming data.

##### References

* [Bug 1299686](https://bugzilla.mozilla.org/show_bug.cgi?id=1299686)

#### [#CVE-2016-9067: heap-use-after-free in nsINode::ReplaceOrInsertBefore](#CVE-2016-9067)

Reporter
Nils
Impact
high
##### Description

Two use-after-free errors during DOM operations resulting in potentially exploitable crashes.

##### References

* [Bug 1301777 (CVE-2016-9067)](https://bugzilla.mozilla.org/show_bug.cgi?id=1301777)
* [Bug 1308922 (CVE-2016-9069)](https://bugzilla.mozilla.org/show_bug.cgi?id=1308922)

#### [#CVE-2016-9068: heap-use-after-free in nsRefreshDriver](#CVE-2016-9068)

Reporter
Nils
Impact
high
##### Description

A use-after-free during web animations when working with timelines resulting in a potentially exploitable crash.

##### References

* [Bug 1302973](https://bugzilla.mozilla.org/show_bug.cgi?id=1302973)

#### [#CVE-2016-9072: 64-bit NPAPI sandbox isn't enabled on fresh profile](#CVE-2016-9072)

Reporter
Bob Owen
Impact
high
##### Description

When a new Firefox profile is created on 64-bit Windows installations, the sandbox for 64-bit NPAPI plugins is not enabled by default.
*Note: This issue only affects 64-bit Windows. 32-bit Windows and other operating systems are unaffected.*

##### References

* [Bug 1300083](https://bugzilla.mozilla.org/show_bug.cgi?id=1300083)

#### [#CVE-2016-9075: WebExtensions can access the mozAddonManager API and use it to gain elevated privileges](#CVE-2016-9075)

Reporter
Kris Maglione
Impact
high
##### Description

An issue where WebExtensions can use the mozAddonManager API to elevate privilege due to privileged pages being allowed in the permissions list. This allows a malicious extension to then install additional extensions without explicit user permission.

##### References

* [Bug 1295324](https://bugzilla.mozilla.org/show_bug.cgi?id=1295324)

#### [#CVE-2016-9077: Canvas filters allow feDisplacementMaps to be applied to cross-origin images, allowing timing attacks on them](#CVE-2016-9077)

Reporter
Markus Stange
Impact
high
##### Description

Canvas allows the use of the `feDisplacementMap` filter on images loaded cross-origin. The rendering by the filter is variable depending on the input pixel, allowing for timing attacks when the images are loaded from third party locations.

##### References

* [Bug 1298552](https://bugzilla.mozilla.org/show_bug.cgi?id=1298552)

#### [#CVE-2016-5291: Same-origin policy violation using local HTML file and saved shortcut file](#CVE-2016-5291)

Reporter
Yuyang Zhou
Impact
moderate
##### Description

A same-origin policy bypass with local shortcut files to load arbitrary local content from disk.

##### References

* [Bug 1292159](https://bugzilla.mozilla.org/show_bug.cgi?id=1292159)

#### [#CVE-2016-5295: Mozilla Maintenance Service: Ability to read arbitrary files as SYSTEM](#CVE-2016-5295)

Reporter
Holger Fuhrmannek
Impact
moderate
##### Description

This vulnerability allows an attacker to use the Mozilla Maintenance Service to escalate privilege by having the Maintenance Service invoke the Mozilla Updater to run malicious local files. This vulnerability requires local system access and is a variant of MFSA2013-44.
*Note: this issue only affects Windows operating systems.*

##### References

* [Bug 1247239](https://bugzilla.mozilla.org/show_bug.cgi?id=1247239)
* [MFSA2013-44 - Local privilege escalation through Mozilla Maintenance Service](https://www.mozilla.org/en-US/security/advisories/mfsa2013-44/)

#### [#CVE-2016-5298: SSL indicator can mislead the user about the real URL visited](#CVE-2016-5298)

Reporter
Jordi Chancel
Impact
moderate
##### Description

A mechanism where disruption of the loading of a new web page can cause the previous page's favicon and SSL indicator to not be reset when the new page is loaded.
*Note: this issue only affects Firefox for Android. Desktop Firefox is unaffected.*

##### References

* [Bug 1227538](https://bugzilla.mozilla.org/show_bug.cgi?id=1227538)

#### [#CVE-2016-5299: Firefox AuthToken in broadcast protected with signature-level permission can be accessed by an application installed beforehand that defines the same permissions](#CVE-2016-5299)

Reporter
Ken Okuyama
Impact
moderate
##### Description

A previously installed malicious Android application with same signature-level permissions as Firefox can intercept AuthTokens meant for Firefox only.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1245791](https://bugzilla.mozilla.org/show_bug.cgi?id=1245791)

#### [#CVE-2016-9061: API key (glocation) in broadcast protected with signature-level permission can be accessed by an application installed beforehand that defines the same permissions](#CVE-2016-9061)

Reporter
Ken Okuyama
Impact
moderate
##### Description

A previously installed malicious Android application which defines a specific signature-level permissions used by Firefox can access API keys meant for Firefox only.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1245795](https://bugzilla.mozilla.org/show_bug.cgi?id=1245795)

#### [#CVE-2016-9062: Private browsing browser traces (Android) in browser.db and wal file](#CVE-2016-9062)

Reporter
Daniel D.
Impact
moderate
##### Description

Private browsing mode leaves metadata information, such as URLs, for sites visited in `browser.db` and `browser.db-wal` files within the Firefox profile after the mode is exited.
*Note: This issue only affects Firefox for Android. Other versions and operating systems are unaffected.*

##### References

* [Bug 1294438](https://bugzilla.mozilla.org/show_bug.cgi?id=1294438)

#### [#CVE-2016-9070: Sidebar bookmark can have reference to chrome window](#CVE-2016-9070)

Reporter
Abdulrahman Alqabandi
Impact
moderate
##### Description

A maliciously crafted page loaded to the sidebar through a bookmark can reference a privileged chrome window and engage in limited JavaScript operations violating cross-origin protections.

##### References

* [Bug 1281071](https://bugzilla.mozilla.org/show_bug.cgi?id=1281071)

#### [#CVE-2016-9073: windows.create schema doesn't specify "format": "relativeUrl"](#CVE-2016-9073)

Reporter
Will Bamberg
Impact
moderate
##### Description

WebExtensions can bypass security checks to load privileged URLs and potentially escape the WebExtension sandbox.

##### References

* [Bug 1289273](https://bugzilla.mozilla.org/show_bug.cgi?id=1289273)

#### [#CVE-2016-9074: Insufficient timing side-channel resistance in divSpoiler](#CVE-2016-9074)

Reporter
Franziskus Kiefer
Impact
moderate
##### Description

An existing mitigation of timing side-channel attacks is insufficient in some circumstances. This issue is addressed in Network Security Services (NSS) 3.26.1.

##### References

* [Bug 1293334](https://bugzilla.mozilla.org/show_bug.cgi?id=1293334)

#### [#CVE-2016-9076: select dropdown menu can be used for URL bar spoofing on e10s](#CVE-2016-9076)

Reporter
Mats Palmgren
Impact
moderate
##### Description

An issue where a `<select>` dropdown menu can be used to cover location bar content, resulting in potential spoofing attacks. This attack requires e10s to be enabled in order to function.

##### References

* [Bug 1276976](https://bugzilla.mozilla.org/show_bug.cgi?id=1276976)

#### [#CVE-2016-9063: Possible integer overflow to fix inside XML\_Parse in Expat](#CVE-2016-9063)

Reporter
Gustavo Grieco
Impact
low
##### Description

An integer overflow during the parsing of XML using the Expat library.

##### References

* [Bug 1274777](https://bugzilla.mozilla.org/show_bug.cgi?id=1274777)

#### [#CVE-2016-9071: Probe browser history via HSTS/301 redirect + CSP](#CVE-2016-9071)

Reporter
Xiaoyin Liu
Impact
low
##### Description

Content Security Policy combined with HTTP to HTTPS redirection can be used by malicious server to verify whether a known site is within a user's browser history.

##### References

* [Bug 1285003](https://bugzilla.mozilla.org/show_bug.cgi?id=1285003)

#### [#CVE-2016-5289: Memory safety bugs fixed in Firefox 50](#CVE-2016-5289)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Christian Holler, Andrew McCreight, Dan Minor, Tyson Smith, Jon Coppeard, Jan-Ivar Bruaroey, Jesse Ruderman, and Markus Stange reported memory safety bugs present in Firefox 49. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 50](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1296649%2C1298107%2C1300129%2C1305876%2C1314667%2C1301252%2C1277866%2C1307254%2C1252511%2C1264053)

#### [#CVE-2016-5290: Memory safety bugs fixed in Firefox 50 and Firefox ESR 45.5](#CVE-2016-5290)

Reporter
Mozilla developers
Impact
critical
##### Description

Mozilla developers and community members Olli Pettay, Christian Holler, Ehsan Akhgari, Jon Coppeard, Gary Kwong, Tooru Fujisawa, Philipp, and Randell Jesup reported memory safety bugs present in Firefox 49 and Firefox ESR 45.4. Some of these bugs showed evidence of memory corruption and we presume that with enough effort that some of these could be exploited to run arbitrary code.

##### References

* [Memory safety bugs fixed in Firefox 50 and Firefox ESR 45.5](https://bugzilla.mozilla.org/buglist.cgi?bug_id=1309720%2C1297062%2C1303710%2C1018486%2C1292590%2C1301343%2C1301496%2C1308048%2C1308346%2C1299519%2C1286911%2C1298169)

## Company

* [Leadership](/about/leadership/)
* [Press Center](https://blog.mozilla.org/category/mozilla/news/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=company)
* [Careers](/en-US/careers/)
* [Contact](/en-US/contact/)

## Support

* [Product Help](https://support.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [File a Bug](https://bugzilla.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)
* [Localize Mozilla](https://pontoon.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=support)

## Resources

* [Advertise with Mozilla](/en-US/advertising/)
* [Firefox Release Notes](/firefox/134.0.2/releasenotes/)

## Developers

* [Developer Edition](/en-US/firefox/developer/)
* [Enterprise](/en-US/firefox/enterprise/)
* [Tools](https://firefox-source-docs.mozilla.org/devtools-user/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer&utm_content=developers)
* [MDN](https://developer.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer)

## Follow @Mozilla

* [X (formerly Twitter) (@mozilla)](https://twitter.com/mozilla)
* [Instagram (@mozilla)](https://www.instagram.com/mozilla/)
* [LinkedIn (@mozilla)](https://www.linkedin.com/company/mozilla-corporation/)
* [TikTok (@mozilla)](https://www.tiktok.com/%40mozilla)
* [Spotify (@mozilla)](https://open.spotify.com/show/0vT7LJMeVDxyQ2ZamHKu08?si=_uDRD6bRR_6M5YZyISGXgA)

## Follow @Firefox

* [X (formerly Twitter) (@firefox)](https://twitter.com/firefox)
* [Instagram (@firefox)](https://www.instagram.com/firefox/)
* [YouTube (@firefoxchannel)](https://www.youtube.com/user/firefoxchannel)
* [TikTok (@firefox)](https://www.tiktok.com/%40firefox)

[Donate](https://foundation.mozilla.org/?form=moco-donate-footer)

Visit [Mozilla Corporation’s](/en-US/) not-for-profit parent, the [Mozilla Foundation](https://foundation.mozilla.org/?utm_source=www.mozilla.org&utm_medium=referral&utm_campaign=footer).

Portions of this content are ©1998–2025 by individual mozilla.org contributors. Content available under a [Creative Commons license](/en-US/foundation/licensing/website-content/).

* [Website Privacy Notice](/en-US/privacy/websites/)
* [Cookies](/en-US/privacy/websites/cookie-settings/)
* [Legal](/en-US/about/legal/)
* [Community Participation Guidelines](/en-US/about/governance/policies/participation/)
* [About this site](/en-US/about/this-site/)

![](https://www.mozilla.org/media/img/logos/m24/wordmark-white.2d673bb5b33a.svg)



=== Content from wiki.mozilla.org_3659d679_20250126_112647.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from bugzilla.mozilla.org_f1733404_20250126_112650.html ===


![](/static/v20250114.1/extensions/BMO/web/images/moz-fav-one-color-white-rgb.svg)

* [Mozilla Home](https://www.mozilla.org/)
* [Privacy](https://www.mozilla.org/privacy/websites/)
* [Cookies](https://www.mozilla.org/privacy/websites/#cookies)
* [Legal](https://www.mozilla.org/about/legal/)
# [Bugzilla](https://bugzilla.mozilla.org/home "Go to home page")

[Quick Search Tips](/page.cgi?id=quicksearch.html)
[Advanced Search](/query.cgi?format=advanced)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")

* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

* [Log In](/index.cgi?GoAheadAndLogIn=1)

   Log In with GitHub

  or

  Remember me

  [Create an Account](/createaccount.cgi)
  ·
  [Forgot Password](/index.cgi?GoAheadAndLogIn=1#forgot)

* [Browse](/describecomponents.cgi "Browse bugs by component")
* [Advanced Search](/query.cgi?format=advanced "Search bugs using various criteria")
* [New Bug](/enter_bug.cgi "File a new bug")
* [Reports](/report.cgi)
* [Documentation](https://bmo.readthedocs.io/en/latest/)

Please enable JavaScript in your browser to use all the features on this site.

Copy Summary▾

* Markdown
* Markdown (bug number)
* Plain Text
* HTML

View ▾

* Reset Sections
* Expand All Sections
* Collapse All Sections
* History
* [JSON](/rest/bug/1302973)
* [XML](/show_bug.cgi?ctype=xml&id=1302973)

Closed
[Bug 1302973](/show_bug.cgi?id=1302973)
(CVE-2016-9068)

Opened 8 years ago
Closed 8 years ago

# heap-use-after-free in nsRefreshDriver::Tick

\*
[Summary:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#short_desc)

heap-use-after-free in nsRefreshDriver::Tick

## Categories

### (Core :: DOM: Animation, defect, P1)

[Product:](/describecomponents.cgi?product=Core)

Core
▾

Core
Shared components used by Firefox and other Mozilla software, including handling of Web content; Gecko, HTML, CSS, layout, DOM, scripts, images, networking, etc. Issues with web page layout probably go here, while Firefox user interface issues belong in the [Firefox](https://bugzilla.mozilla.org/describecomponents.cgi?product=Firefox) product. ([More info](https://wiki.mozilla.org/Modules/All#Core))
[See Open Bugs in This Product](/buglist.cgi?product=Core&bug_status=__open__)
[File New Bug in This Product](/enter_bug.cgi?product=Core)
Watch This Product

[Component:](/describecomponents.cgi?product=Core&component=DOM%3A%20Animation#DOM%3A%20Animation)

DOM: Animation
▾

Core :: DOM: Animation
This component covers the [Web Animations](https://w3c.github.io/web-animations/) implementation in Gecko.
[See Open Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Animation&bug_status=__open__)
[Recently Fixed Bugs in This Component](/buglist.cgi?product=Core&component=DOM%3A%20Animation&chfield=resolution&chfieldfrom=-6m&chfieldvalue=FIXED&bug_status=__closed__)
[File New Bug in This Component](/enter_bug.cgi?product=Core&component=DOM%3A%20Animation)
Watch This Component

[Version:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#version)

Trunk

[Platform:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#rep_platform)

Unspecified

Unspecified

[Type:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_type)

defect

[Priority:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#priority)

P1

[Severity:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_severity)

normal

Points:

---

## Tracking

### ()

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED
FIXED

[Status:](https://wiki.mozilla.org/BMO/UserGuide/BugStatuses)

VERIFIED

FIXED

Mark as Assigned

[Milestone:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#target_milestone)

mozilla52

Iteration:

---

[Project Flags:](https://wiki.mozilla.org/BMO/UserGuide#Project_Flags)

| a11y-review | --- |
| --- | --- |
| Accessibility Severity | --- |
| Webcompat Priority | --- |
| Webcompat Score | --- |
| Performance Impact | --- |

[Tracking Flags:](https://wiki.mozilla.org/BMO/UserGuide#Tracking_Flags)

|  | Tracking | Status |
| --- | --- | --- |
| firefox49 | --- | [wontfix](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=wontfix) |
| firefox-esr45 | --- | [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected) |
| firefox50 | [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified) |
| firefox51 | [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified) |
| firefox52 | [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B) | [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified) |

|  | Tracking | Status |
| --- | --- | --- |
| firefox49 |  | wontfix |
| firefox-esr45 |  | unaffected |
| relnote-firefox |  | --- |
| thunderbird\_esr115 | --- | --- |
| thunderbird\_esr128 | --- | --- |
| firefox50 | + | verified |
| firefox51 | + | verified |
| firefox52 | + | verified |
| firefox-esr115 | --- | --- |
| firefox-esr128 | --- | --- |
| firefox134 | --- | --- |
| firefox135 | --- | --- |
| firefox136 | --- | --- |

## People

### (Reporter: nils, Assigned: birtles)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

![](https://secure.gravatar.com/avatar/b21107bc66be7d2aefff1fb59d5d8bae?d=mm&size=40)  [birtles](/user_profile?user_id=165012)

[Assignee:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#assigned_to)

Reset Assignee to default

[Mentors:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_mentor)

---

[QA Contact:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#qa_contact)

Reset QA Contact to default

[Reporter:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#reporter)

![](https://secure.gravatar.com/avatar/1ac8e01cc88bca015e51fbd49a0b2df5?d=mm&size=40)  [nils](/user_profile?user_id=344130)

[Triage Owner:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#triage_owner)

![](https://secure.gravatar.com/avatar/8a1a07330c4b233b669577673bc47748?d=mm&size=40)  [boris](/user_profile?user_id=500786)

[CC:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#cc)

17 people

## References

[Depends on:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#dependson)

---

[Blocks:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#blocks)

[1195180](/show_bug.cgi?id=1195180 "RESOLVED FIXED - Tick animations from their timeline"), [1245000](/show_bug.cgi?id=1245000 "RESOLVED FIXED - Ship Element.animate")

Dependency [tree](/showdependencytree.cgi?id=1302973&hide_resolved=1)
/ [graph](/showdependencygraph.cgi?id=1302973)

[Regressions:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regresses)

---

[Regressed by:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#regressed_by)

---

[URL:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#bug_file_loc)

[See Also:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#see_also)

---

## Details

### (4 keywords, Whiteboard: [adv-main50+])

[Alias:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#alias)

CVE-2016-9068

[Keywords:](/describekeywords.cgi)

[csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[regression](/buglist.cgi?keywords=regression&resolution=---),
[reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

[Whiteboard:](https://wiki.mozilla.org/BMO/UserGuide/Whiteboard)

[adv-main50+]

QA Whiteboard:

---

Has STR:

---

Change Request:

---

[Votes:](https://wiki.mozilla.org/BMO/UserGuide/BugFields#votes)

0

Bug Flags:

| [dveditz](/user_profile?user_id=1689) | [sec-bounty](#a4611785_1689 "8 years ago") | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | sec-bounty | + |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | [in-testsuite](#a4611785_1689 "8 years ago") | ? |
| --- | --- | --- |
| [dveditz](/user_profile?user_id=1689) | in-testsuite | ? |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | [qe-verify](#a2347729_488993 "8 years ago") | + |
| --- | --- | --- |
| [avaida](/user_profile?user_id=488993) | qe-verify | + |
| --- | --- | --- |
|  | behind-pref |  |
| --- | --- | --- |
|  | firefox-backlog |  |
|  | sec-bounty-hof |  |
|  | in-qa-testsuite |  | | |

## Crash Data

Signature:

*None*

## Security

### (public)

This bug is publicly visible.

## User Story

## Attachments

### (5 files, 8 obsolete files)

| [crash.html (testcase, crashes firefox)](/attachment.cgi?id=8791529)  [8 years ago](#c0)  [Nils](/user_profile?user_id=344130)   671 bytes, text/html |  | [Details](/attachment.cgi?id=8791529&action=edit) |
| --- | --- | --- |
| [Possible fix for trunk](/attachment.cgi?id=8796036)  [8 years ago](#c5)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   14.29 KB, patch |  | [Details](/attachment.cgi?id=8796036&action=edit) | [Diff](/attachment.cgi?id=8796036&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8796036) |
| [Crash test](/attachment.cgi?id=8796038)  [8 years ago](#c6)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   1.53 KB, patch |  | [Details](/attachment.cgi?id=8796038&action=edit) | [Diff](/attachment.cgi?id=8796038&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8796038) |
| [Approach A (part 1): Store timelines on pres context](/attachment.cgi?id=8796040)  [8 years ago](#c7)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   13.88 KB, patch |  | [Details](/attachment.cgi?id=8796040&action=edit) | [Diff](/attachment.cgi?id=8796040&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8796040) |
| [Approach A (part 2): Unregister in document reset](/attachment.cgi?id=8797852)  [8 years ago](#c9)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   8.54 KB, patch |  | [Details](/attachment.cgi?id=8797852&action=edit) | [Diff](/attachment.cgi?id=8797852&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797852) |
| [Approach B: Store timelines on the document](/attachment.cgi?id=8797854)  [8 years ago](#c10)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   15.05 KB, patch |  | [Details](/attachment.cgi?id=8797854&action=edit) | [Diff](/attachment.cgi?id=8797854&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797854) |
| [Fix for release channels; r=hiro](/attachment.cgi?id=8797855)  [8 years ago](#c11)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   3.21 KB, patch | birtles : [review+](#c11 "8 years ago") | [Details](/attachment.cgi?id=8797855&action=edit) | [Diff](/attachment.cgi?id=8797855&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797855) |
| [Approach B: Store timelines on the document](/attachment.cgi?id=8797889)  [8 years ago](#c12)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   9.46 KB, patch |  | [Details](/attachment.cgi?id=8797889&action=edit) | [Diff](/attachment.cgi?id=8797889&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797889) |
| [Approach B: Store timelines on the document](/attachment.cgi?id=8798326)  [8 years ago](#c15)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   9.80 KB, patch | smaug : [review+](#c16 "8 years ago") | [Details](/attachment.cgi?id=8798326&action=edit) | [Diff](/attachment.cgi?id=8798326&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798326) |
| [Fix for trunk: Store timelines on document; r=smaug](/attachment.cgi?id=8798682)  [8 years ago](#c17)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   10.30 KB, patch | birtles : [review+](#c17 "8 years ago")  abillings : [sec-approval+](#a1928125_280903 "8 years ago") | [Details](/attachment.cgi?id=8798682&action=edit) | [Diff](/attachment.cgi?id=8798682&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798682) |
| [Fix rebased for aurora/beta](/attachment.cgi?id=8798683)  [8 years ago](#c18)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   10.30 KB, patch | ritu : [approval-mozilla-aurora+](#c27 "8 years ago")  ritu : [approval-mozilla-beta+](#c27 "8 years ago") | [Details](/attachment.cgi?id=8798683&action=edit) | [Diff](/attachment.cgi?id=8798683&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798683) |
| [Fix rebased for release](/attachment.cgi?id=8798684)  [8 years ago](#c19)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   10.17 KB, patch |  | [Details](/attachment.cgi?id=8798684&action=edit) | [Diff](/attachment.cgi?id=8798684&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798684) |
| [Fix rebased for release](/attachment.cgi?id=8799608)  [8 years ago](#c25)  [Brian Birtles (:birtles)](/user_profile?user_id=165012)   10.25 KB, patch | lizzard : [approval-mozilla-release-](#c28 "8 years ago") | [Details](/attachment.cgi?id=8799608&action=edit) | [Diff](/attachment.cgi?id=8799608&action=diff) | [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8799608) |

Show Obsolete

Bottom ↓
Tags ▾

* Reset

Timeline ▾

* Reset
* Collapse All
* Expand All
* Comments Only

|  | [Nils](/user_profile?user_id=344130)  Reporter |  |
| --- | --- | --- |
| [Description](/show_bug.cgi?id=1302973#c0)• 8 years ago |
|  | |

Attached file
[crash.html (testcase, crashes firefox)](attachment.cgi?id=8791529)
— [Details](attachment.cgi?id=8791529&action=edit)

The following testcase crashes the latest ASAN build of Firefox (BuildID=20160914134208) as follows. The testcase requires the fuzzPriv extension.
crash.html:
<script>
function start() {
o0=window.document;
o1128=document.createElement('iframe');
try{while(document.removeChild(document.firstChild));}catch(e){}
o1479=document.implementation.createHTMLDocument();
o1479.body.appendChild(o1128);
document.appendChild(o1479.documentElement);
o1638=frames[0];
o1639=o1638.document;
o1773=o1639.createElement('meta');
o1925=o1773.animate([{listStyleType: 'upper-alpha'},{listStyleType: 'decimal'}],136);
o1639.write('');
o1925.play();
o0.write('');
o1925=null; o1639=null; o1773=null; o1638=null; o1479=null;
fuzzPriv.forceGC();fuzzPriv.CC();fuzzPriv.forceGC();fuzzPriv.CC();
}
</script>
<body onload="start()"></body>
ASAN output:
=================================================================
==16324==ERROR: AddressSanitizer: heap-use-after-free on address 0x60e000053ef8 at pc 0x7fb55609e7ce bp 0x7ffef123ed90 sp 0x7ffef123ed88
READ of size 8 at 0x60e000053ef8 thread T0 (Web Content)
#0 0x7fb55609e7cd in AddRef /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:37:5
#1 0x7fb55609e7cd in AddRef /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:384
#2 0x7fb55609e7cd in RefPtr /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:111
#3 0x7fb55609e7cd in nsRefreshDriver::Tick(long, mozilla::TimeStamp) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:1700
#4 0x7fb5560a820c in mozilla::RefreshDriverTimer::TickRefreshDrivers(long, mozilla::TimeStamp, nsTArray<RefPtr<nsRefreshDriver> >&) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:247:7
#5 0x7fb5560a7ed9 in mozilla::RefreshDriverTimer::Tick(long, mozilla::TimeStamp) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:266:5
#6 0x7fb5560a99c4 in mozilla::VsyncRefreshDriverTimer::RefreshDriverVsyncObserver::NotifyVsync(mozilla::TimeStamp) /home/worker/workspace/build/src/layout/base/nsRefreshDriver.cpp:426:9
#7 0x7fb556a07684 in mozilla::layout::VsyncChild::RecvNotify(mozilla::TimeStamp const&) /home/worker/workspace/build/src/layout/ipc/VsyncChild.cpp:64:5
#8 0x7fb5505a3b8a in mozilla::layout::PVsyncChild::OnMessageReceived(IPC::Message const&) /home/worker/workspace/build/src/obj-firefox/ipc/ipdl/PVsyncChild.cpp:234:20
#9 0x7fb55008e63f in mozilla::ipc::PBackgroundChild::OnMessageReceived(IPC::Message const&) /home/worker/workspace/build/src/obj-firefox/ipc/ipdl/PBackgroundChild.cpp:1551:16
#10 0x7fb54ffcded9 in mozilla::ipc::MessageChannel::DispatchAsyncMessage(IPC::Message const&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1662:14
#11 0x7fb54ffcada6 in mozilla::ipc::MessageChannel::DispatchMessage(IPC::Message&&) /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1600:17
#12 0x7fb54ffb8d67 in mozilla::ipc::MessageChannel::OnMaybeDequeueOne() /home/worker/workspace/build/src/ipc/glue/MessageChannel.cpp:1567:5
#13 0x7fb54ffe71a2 in applyImpl<mozilla::ipc::MessageChannel, bool (mozilla::ipc::MessageChannel::\*)()> /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:729:12
#14 0x7fb54ffe71a2 in apply<mozilla::ipc::MessageChannel, bool (mozilla::ipc::MessageChannel::\*)()> /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:735
#15 0x7fb54ffe71a2 in mozilla::detail::RunnableMethodImpl<bool (mozilla::ipc::MessageChannel::\*)(), false, true>::Run() /home/worker/workspace/build/src/obj-firefox/dist/include/nsThreadUtils.h:764
#16 0x7fb54ffe6a2f in Run /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/ipc/MessageChannel.h:545:22
#17 0x7fb54ffe6a2f in mozilla::ipc::MessageChannel::DequeueTask::Run() /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/ipc/MessageChannel.h:564
#18 0x7fb54f21272d in nsThread::ProcessNextEvent(bool, bool\*) /home/worker/workspace/build/src/xpcom/threads/nsThread.cpp:1059:7
#19 0x7fb54f290fac in NS\_ProcessNextEvent(nsIThread\*, bool) /home/worker/workspace/build/src/xpcom/glue/nsThreadUtils.cpp:290:10
#20 0x7fb54ffd511f in mozilla::ipc::MessagePump::Run(base::MessagePump::Delegate\*) /home/worker/workspace/build/src/ipc/glue/MessagePump.cpp:96:21
#21 0x7fb54ff48398 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:232:3
#22 0x7fb54ff48398 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:225
#23 0x7fb54ff48398 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:205
#24 0x7fb5559f7e0f in nsBaseAppShell::Run() /home/worker/workspace/build/src/widget/nsBaseAppShell.cpp:156:3
#25 0x7fb557b3ae97 in XRE\_RunAppShell /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:875:12
#26 0x7fb54ff48398 in RunInternal /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:232:3
#27 0x7fb54ff48398 in RunHandler /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:225
#28 0x7fb54ff48398 in MessageLoop::Run() /home/worker/workspace/build/src/ipc/chromium/src/base/message\_loop.cc:205
#29 0x7fb557b3a3bd in XRE\_InitChildProcess /home/worker/workspace/build/src/toolkit/xre/nsEmbedFunctions.cpp:705:7
#30 0x4dfb2b in content\_process\_main /home/worker/workspace/build/src/browser/app/../../ipc/contentproc/plugin-container.cpp:197:19
#31 0x4dfb2b in main /home/worker/workspace/build/src/browser/app/nsBrowserApp.cpp:367
#32 0x7fb56a76e82f in \_\_libc\_start\_main /build/glibc-GKVZIf/glibc-2.23/csu/../csu/libc-start.c:291
#33 0x41ba08 in \_start (/home/nils/fuzzer3/firefox/firefox+0x41ba08)
0x60e000053ef8 is located 120 bytes inside of 160-byte region [0x60e000053e80,0x60e000053f20)
freed by thread T0 (Web Content) here:
#0 0x4b215b in \_\_interceptor\_free /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_malloc\_linux.cc:38:3
#1 0x7fb54f0ee084 in SnowWhiteKiller::~SnowWhiteKiller() /home/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:2681:9
#2 0x7fb54f0edc76 in nsCycleCollector::FreeSnowWhite(bool) /home/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:2855:3
#3 0x7fb54f0f449c in nsCycleCollector::BeginCollection(ccType, nsICycleCollectorListener\*) /home/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:3832:3
#4 0x7fb54f0f3c7c in nsCycleCollector::Collect(ccType, js::SliceBudget&, nsICycleCollectorListener\*, bool) /home/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:3657:9
#5 0x7fb54f0f6e56 in nsCycleCollector\_collect(nsICycleCollectorListener\*) /home/worker/workspace/build/src/xpcom/base/nsCycleCollector.cpp:4148:3
#6 0x7fb551f96ed9 in nsJSContext::CycleCollectNow(nsICycleCollectorListener\*, int) /home/worker/workspace/build/src/dom/base/nsJSEnvironment.cpp:1440:3
#7 0x7fb551b1581d in nsDOMWindowUtils::CycleCollect(nsICycleCollectorListener\*, int) /home/worker/workspace/build/src/dom/base/nsDOMWindowUtils.cpp:1338:3
#8 0x7fb54f238486 in NS\_InvokeByIndex /home/worker/workspace/build/src/xpcom/reflect/xptcall/md/unix/xptcinvoke\_x86\_64\_unix.cpp:180:23
#9 0x7fb550b603ae in Invoke /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNative.cpp:2065:12
#10 0x7fb550b603ae in Call /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNative.cpp:1384
#11 0x7fb550b603ae in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNative.cpp:1351
#12 0x7fb550b67acb in XPC\_WN\_CallMethod(JSContext\*, unsigned int, JS::Value\*) /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1143:12
#13 0x7fb559d9761c in CallJSNative /home/worker/workspace/build/src/js/src/jscntxtinlines.h:235:15
#14 0x7fb559d9761c in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:442
#15 0x7fb559d773a0 in CallFromStack /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:505:12
#16 0x7fb559d773a0 in Interpret(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:2918
#17 0x7fb559d5c93b in js::RunScript(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:400:12
#18 0x7fb559d97e34 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:472:15
#19 0x7fb559d988a1 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:518:10
#20 0x7fb5598944da in JS\_CallFunctionValue(JSContext\*, JS::Handle<JSObject\*>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/jsapi.cpp:2776:12
#21 0x7fb550a9b1af in xpc::FunctionForwarder(JSContext\*, unsigned int, JS::Value\*) /home/worker/workspace/build/src/js/xpconnect/src/ExportHelpers.cpp:353:18
#22 0x7fb559d9761c in CallJSNative /home/worker/workspace/build/src/js/src/jscntxtinlines.h:235:15
#23 0x7fb559d9761c in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:442
#24 0x7fb559d773a0 in CallFromStack /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:505:12
#25 0x7fb559d773a0 in Interpret(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:2918
#26 0x7fb559d5c93b in js::RunScript(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:400:12
#27 0x7fb559d97e34 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:472:15
#28 0x7fb559d988a1 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:518:10
#29 0x7fb559896a38 in JS::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/jsapi.cpp:2835:12
#30 0x7fb5537bf878 in mozilla::dom::EventHandlerNonNull::Call(JSContext\*, JS::Handle<JS::Value>, mozilla::dom::Event&, JS::MutableHandle<JS::Value>, mozilla::ErrorResult&) /home/worker/workspace/build/src/obj-firefox/dom/bindings/EventHandlerBinding.cpp:259:37
#31 0x7fb5540db041 in Call<nsISupports \*> /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/dom/EventHandlerBinding.h:361:12
#32 0x7fb5540db041 in mozilla::JSEventHandler::HandleEvent(nsIDOMEvent\*) /home/worker/workspace/build/src/dom/events/JSEventHandler.cpp:214
#33 0x7fb5540a7994 in mozilla::EventListenerManager::HandleEventSubType(mozilla::EventListenerManager::Listener\*, nsIDOMEvent\*, mozilla::dom::EventTarget\*) /home/worker/workspace/build/src/dom/events/EventListenerManager.cpp:1133:16
#34 0x7fb5540a94c1 in mozilla::EventListenerManager::HandleEventInternal(nsPresContext\*, mozilla::WidgetEvent\*, nsIDOMEvent\*\*, mozilla::dom::EventTarget\*, nsEventStatus\*) /home/worker/workspace/build/src/dom/events/EventListenerManager.cpp:1286:17
#35 0x7fb5540927b2 in mozilla::EventTargetChainItem::HandleEventTargetChain(nsTArray<mozilla::EventTargetChainItem>&, mozilla::EventChainPostVisitor&, mozilla::EventDispatchingCallback\*, mozilla::ELMCreationDetector&) /home/worker/workspace/build/src/dom/events/EventDispatcher.cpp:380:5
#36 0x7fb554096c9d in mozilla::EventDispatcher::Dispatch(nsISupports\*, nsPresContext\*, mozilla::WidgetEvent\*, nsIDOMEvent\*, nsEventStatus\*, mozilla::EventDispatchingCallback\*, nsTArray<mozilla::dom::EventTarget\*>\*) /home/worker/workspace/build/src/dom/events/EventDispatcher.cpp:711:9
previously allocated by thread T0 (Web Content) here:
#0 0x4b247b in malloc /builds/slave/moz-toolchain/src/llvm/projects/compiler-rt/lib/asan/asan\_malloc\_linux.cc:52:3
#1 0x4e0bcd in moz\_xmalloc /home/worker/workspace/build/src/memory/mozalloc/mozalloc.cpp:83:17
#2 0x7fb551e8afc4 in operator new /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/mozalloc.h:194:12
#3 0x7fb551e8afc4 in nsDocument::Timeline() /home/worker/workspace/build/src/dom/base/nsDocument.cpp:3023
#4 0x7fb556360547 in PresShell::Init(nsIDocument\*, nsPresContext\*, nsViewManager\*, mozilla::StyleSetHandle) /home/worker/workspace/build/src/layout/base/nsPresShell.cpp:972:3
#5 0x7fb551e9229e in nsDocument::doCreateShell(nsPresContext\*, nsViewManager\*, mozilla::StyleSetHandle) /home/worker/workspace/build/src/dom/base/nsDocument.cpp:3630:3
#6 0x7fb5544896e7 in nsHTMLDocument::CreateShell(nsPresContext\*, nsViewManager\*, mozilla::StyleSetHandle) /home/worker/workspace/build/src/dom/html/nsHTMLDocument.cpp:274:10
#7 0x7fb5562cdff1 in nsDocumentViewer::InitPresentationStuff(bool) /home/worker/workspace/build/src/layout/base/nsDocumentViewer.cpp:634:16
#8 0x7fb5562cd915 in nsDocumentViewer::InitInternal(nsIWidget\*, nsISupports\*, mozilla::gfx::IntRectTyped<mozilla::gfx::UnknownUnits> const&, bool, bool, bool) /home/worker/workspace/build/src/layout/base/nsDocumentViewer.cpp:889:10
#9 0x7fb5562ccad7 in nsDocumentViewer::Init(nsIWidget\*, mozilla::gfx::IntRectTyped<mozilla::gfx::UnknownUnits> const&) /home/worker/workspace/build/src/layout/base/nsDocumentViewer.cpp:618:10
#10 0x7fb55704d1c7 in nsDocShell::SetupNewViewer(nsIContentViewer\*) /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:9374:7
#11 0x7fb55704b969 in nsDocShell::Embed(nsIContentViewer\*, char const\*, nsISupports\*) /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:7227:17
#12 0x7fb557059d4d in nsDocShell::CreateAboutBlankContentViewer(nsIPrincipal\*, nsIURI\*, bool) /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:8087:14
#13 0x7fb556ff9b03 in nsDocShell::EnsureContentViewer() /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:7956:17
#14 0x7fb55702bf87 in GetDocument /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:4504:3
#15 0x7fb55702bf87 in non-virtual thunk to nsDocShell::GetDocument() /home/worker/workspace/build/src/docshell/base/nsDocShell.cpp:4502
#16 0x7fb551bfbcb7 in MaybeCreateDoc /home/worker/workspace/build/src/dom/base/nsGlobalWindow.cpp:3613:38
#17 0x7fb551bfbcb7 in GetDoc /home/worker/workspace/build/src/obj-firefox/dist/include/nsPIDOMWindow.h:174
#18 0x7fb551bfbcb7 in EnsureInnerWindow /home/worker/workspace/build/src/obj-firefox/dist/include/nsPIDOMWindow.h:840
#19 0x7fb551bfbcb7 in nsGlobalWindow::WrapObject(JSContext\*, JS::Handle<JSObject\*>) /home/worker/workspace/build/src/dom/base/nsGlobalWindow.h:354
#20 0x7fb550ab4a3c in XPCConvert::NativeInterface2JSObject(JS::MutableHandle<JS::Value>, nsIXPConnectJSObjectHolder\*\*, xpcObjectHelper&, nsID const\*, bool, nsresult\*) /home/worker/workspace/build/src/js/xpconnect/src/XPCConvert.cpp:785:16
#21 0x7fb550ab29e3 in XPCConvert::NativeData2JS(JS::MutableHandle<JS::Value>, void const\*, nsXPTType const&, nsID const\*, nsresult\*) /home/worker/workspace/build/src/js/xpconnect/src/XPCConvert.cpp:344:16
#22 0x7fb550b61312 in GatherAndConvertResults /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNative.cpp:1601:18
#23 0x7fb550b61312 in Call /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNative.cpp:1395
#24 0x7fb550b61312 in XPCWrappedNative::CallMethod(XPCCallContext&, XPCWrappedNative::CallMode) /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNative.cpp:1351
#25 0x7fb550b6840f in GetAttribute /home/worker/workspace/build/src/js/xpconnect/src/xpcprivate.h:1929:17
#26 0x7fb550b6840f in XPC\_WN\_GetterSetter(JSContext\*, unsigned int, JS::Value\*) /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedNativeJSOps.cpp:1179
#27 0x7fb559d9761c in CallJSNative /home/worker/workspace/build/src/js/src/jscntxtinlines.h:235:15
#28 0x7fb559d9761c in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:442
#29 0x7fb559e337c0 in Call /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:518:10
#30 0x7fb559e337c0 in CallGetter /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:632
#31 0x7fb559e337c0 in CallGetter(JSContext\*, JS::Handle<JSObject\*>, JS::Handle<JS::Value>, JS::Handle<js::Shape\*>, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/NativeObject.cpp:1757
#32 0x7fb559da5e05 in GetExistingProperty<js::AllowGC::CanGC> /home/worker/workspace/build/src/js/src/vm/NativeObject.cpp:1805:10
#33 0x7fb559da5e05 in NativeGetPropertyInline<js::AllowGC::CanGC> /home/worker/workspace/build/src/js/src/vm/NativeObject.cpp:2032
#34 0x7fb559da5e05 in NativeGetProperty /home/worker/workspace/build/src/js/src/vm/NativeObject.cpp:2066
#35 0x7fb559da5e05 in GetProperty /home/worker/workspace/build/src/js/src/vm/NativeObject.h:1491
#36 0x7fb559da5e05 in GetProperty /home/worker/workspace/build/src/js/src/jsobj.h:846
#37 0x7fb559da5e05 in js::GetProperty(JSContext\*, JS::Handle<JS::Value>, JS::Handle<js::PropertyName\*>, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:4247
#38 0x7fb559d7bb6b in GetPropertyOperation /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:190:12
#39 0x7fb559d7bb6b in Interpret(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:2635
#40 0x7fb559d5c93b in js::RunScript(JSContext\*, js::RunState&) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:400:12
#41 0x7fb559d97e34 in js::InternalCallOrConstruct(JSContext\*, JS::CallArgs const&, js::MaybeConstruct) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:472:15
#42 0x7fb559d988a1 in js::Call(JSContext\*, JS::Handle<JS::Value>, JS::Handle<JS::Value>, js::AnyInvokeArgs const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/vm/Interpreter.cpp:518:10
#43 0x7fb5598944da in JS\_CallFunctionValue(JSContext\*, JS::Handle<JSObject\*>, JS::Handle<JS::Value>, JS::HandleValueArray const&, JS::MutableHandle<JS::Value>) /home/worker/workspace/build/src/js/src/jsapi.cpp:2776:12
#44 0x7fb550b447f1 in nsXPCWrappedJSClass::CallMethod(nsXPCWrappedJS\*, unsigned short, XPTMethodDescriptor const\*, nsXPTCMiniVariant\*) /home/worker/workspace/build/src/js/xpconnect/src/XPCWrappedJSClass.cpp:1211:23
#45 0x7fb54f239d06 in PrepareAndDispatch /home/worker/workspace/build/src/xpcom/reflect/xptcall/md/unix/xptcstubs\_x86\_64\_linux.cpp:122:14
#46 0x7fb54f238cd6 in SharedStub (/home/nils/fuzzer3/firefox/libxul.so+0x1faacd6)
SUMMARY: AddressSanitizer: heap-use-after-free /home/worker/workspace/build/src/obj-firefox/dist/include/mozilla/RefPtr.h:37:5 in AddRef
Shadow bytes around the buggy address:
0x0c1c80002780: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
0x0c1c80002790: fa fa fa fa fa fa fa fa fd fd fd fd fd fd fd fd
0x0c1c800027a0: fd fd fd fd fd fd fd fd fd fd fd fa fa fa fa fa
0x0c1c800027b0: fa fa fa fa fd fd fd fd fd fd fd fd fd fd fd fd
0x0c1c800027c0: fd fd fd fd fd fd fd fd fa fa fa fa fa fa fa fa
=>0x0c1c800027d0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd[fd]
0x0c1c800027e0: fd fd fd fd fa fa fa fa fa fa fa fa fd fd fd fd
0x0c1c800027f0: fd fd fd fd fd fd fd fd fd fd fd fd fd fd fd fa
0x0c1c80002800: fa fa fa fa fa fa fa fa 00 00 00 00 00 00 00 00
0x0c1c80002810: 00 00 00 00 00 00 00 00 00 00 00 fa fa fa fa fa
0x0c1c80002820: fa fa fa fa 00 00 00 00 00 00 00 00 00 00 00 00
Shadow byte legend (one shadow byte represents 8 application bytes):
Addressable: 00
Partially addressable: 01 02 03 04 05 06 07
Heap left redzone: fa
Heap right redzone: fb
Freed heap region: fd
Stack left redzone: f1
Stack mid redzone: f2
Stack right redzone: f3
Stack partial redzone: f4
Stack after return: f5
Stack use after scope: f8
Global redzone: f9
Global init order: f6
Poisoned by user: f7
Container overflow: fc
Array cookie: ac
Intra object redzone: bb
ASan internal: fe
Left alloca redzone: ca
Right alloca redzone: cb
==16324==ABORTING

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a523965_1689)• 8 years ago |

Group: core-security → layout-core-security

|  | [Andrew McCreight [:mccr8]](/user_profile?user_id=406194) |  |
| --- | --- | --- |
| [Comment 1](/show_bug.cgi?id=1302973#c1)• 8 years ago |
|  | |

Brian, do you know who might look at this? Animation seems to be involved. Thanks.Flags: needinfo?(bbirtles)Keywords: [csectype-uaf](/buglist.cgi?keywords=csectype-uaf&resolution=---),
[sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---)

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 2](/show_bug.cgi?id=1302973#c2)• 8 years ago |
|  | |

This seems very similar to [bug 1291665](/show_bug.cgi?id=1291665 "VERIFIED FIXED - heap-use-after-free in nsRefreshDriver::Tick"). I wonder why the fix from that bug didn't fix this one. [Attachment 8781395](/attachment.cgi?id=8781395 "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[details]](/attachment.cgi?id=8781395&action=edit "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[diff]](/attachment.cgi?id=8781395&action=diff "Ignore a refresh driver marked as destroyed in DocumentTimeline") might help but I need to check that we don't have a similar problem for independently constructed timelines (since [attachment 8781395](/attachment.cgi?id=8781395 "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[details]](/attachment.cgi?id=8781395&action=edit "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[diff]](/attachment.cgi?id=8781395&action=diff "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1291665&attachment=8781395) won't help with that).
The next step is probably adding some diagnostics like [bug 1291665 comment 10](/show_bug.cgi?id=1291665#c10 "VERIFIED FIXED - heap-use-after-free in nsRefreshDriver::Tick") to see if we can work out what is happening here.

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 3](/show_bug.cgi?id=1302973#c3)• 8 years ago |
|  | |

After a bit of debugging I am seeing this pattern:
C++: >> DocumentTimeline(0x60e0003c55c0)::NotifyRefreshDriverCreated
(refresh driver: 0x616000431180)
(observing: 0)
C++: << DocumentTimeline(0x60e0003c55c0)::NotifyRefreshDriverCreated
(observing: 0)
C++: >> DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: Adding 0x60e0003c55c0 to refresh driver 0x616000431180
C++: << DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: >> DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: << DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: Created animation 0x6120002ad9c0
C++: >> DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: << DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: >> DocumentTimeline(0x60e0003c55c0)::NotifyRefreshDriverDestroying
(refresh driver: 0x616000431180)
(observing: 1)
C++: << DocumentTimeline(0x60e0003c55c0)::NotifyRefreshDriverDestroying
(observing: 0)
C++: >> DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: Adding 0x60e0003c55c0 to refresh driver 0x616000431180
C++: << DocumentTimeline(0x60e0003c55c0)::NotifyAnimationUpdated 0x6120002ad9c0
C++: >> DocumentTimeline(0x60e0003c55c0)::WillRefresh
(driver: (nil))
(observing: 1)
In other words, we notify that the refresh driver is destroying and successfully disassociate from it, but then a subsequent change makes us re-register. What's more, this happens during some interim period where we can still successfully go from document->pres shell->pres context->refresh driver.
If that's the case, I should be able to continue debugging this on windows (and in a debug build assertions in DocumentTimeline::WillRefresh should be failing)Assignee: nobody → bbirtlesStatus: NEW → ASSIGNEDFlags: needinfo?(bbirtles)

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 4](/show_bug.cgi?id=1302973#c4)• 8 years ago |
|  | |

A few more details. There are two places where we disassociate the timeline from its refresh driver:
A) nsDocument::Reset
In this case we do:
\* mDocumentTimeline->NotifyRefreshDriverDestroying(rd);
\* mDocumentTimeline = nullptr;
B) PresShell::Destroy()
In this case we do:
\* mDocument->DeleteShell();
\* mDocument->Timeline()->NotifyRefreshDriverDestroying(rd);
Now, in DocumentTimeline, we get the refresh driver by going:
mDocument->GetShell()->GetPresContext()->RefreshDriver() (with suitable null checks along the way)
For (B), we call DeleteShell() before calling NotifyRefreshDriverDestroying, and that breaks the link between the document and the presshell so any further attempts to get the refresh driver will fail (as expected).
It looks like in this bug we hit (A) where we disassociate from the refresh driver but don't immediately break the link(s) from document to refresh driver. As a result, we end up in a state where we can still get to the refresh driver (and any change to the animation will cause us to re-associate with it, despite the fact that it will probably disappear soon).
Stepping back, there seems to be an even bigger problem in that script-created timelines never get the NotifyRefreshDriverDestroying message. So how do they make sure they are disconnected from their refresh driver when it is going away?
Looking into how things normally get destroyed we have:
PresShell::Destroy()
If mDocument is set:
- mDocument->DeleteShell();
Sets mPresShell = nullptr;
- Calls mDocument->Timeline()->NotifyRefreshDriverDestroying(rd);
If mPresContext is set:
- Calls nsPresContext::DetachShell()
- Calls Disconnect on its refresh driver (after nulling out mShell)
nsPresContext::~nsPresContext()
- Calls DetachShell()
- Calls Disconnect it its refresh driver (after nulling out mShell)
- Calls Destroy()
- Sets mRefreshDriver = null
For nsDocument::Reset, I think the idea here was basically that we should make sure that the object identity of document.timeline changes when we call reset. As a result, I think it's probably fine if the timeline from the old document can somehow be resurrected. Rather than try to fix that, we need to fix the general case of timelines that are not the document timeline, yet which might be watching the refresh driver associated with a pres shell that has been destroyed.
Basically, I think we need to store a hash of timelines on the pres shell so we can clear them out in PresShell::Destroy (at the point where we currently call mDocument->Timeline()->NotifyRefreshDriverDestroying). Alternatively, I guess we could stick that map on the document and iterate over it in nsDocument::DeleteShell()?

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a1027859_165012)• 8 years ago |

Priority: -- → P1

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 5](/show_bug.cgi?id=1302973#c5)• 8 years ago |
|  | |

Attached patch

[Possible fix for trunk](attachment.cgi?id=8796036&action=diff) (obsolete)
— [Details](attachment.cgi?id=8796036&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8796036)

This patch thoroughly reworks how we track timelines so we can safely unregister them from the refresh driver when it disappears.
It's a fairly large patch so I think we might try something simpler for aurora. Fortunately, the ability to create extra timelines is not enabled on aurora so we could probably just include something like [attachment 8781395](/attachment.cgi?id=8781395 "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[details]](/attachment.cgi?id=8781395&action=edit "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[diff]](/attachment.cgi?id=8781395&action=diff "Ignore a refresh driver marked as destroyed in DocumentTimeline") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1291665&attachment=8781395). Or, even simpler still, we could possibly just null out mDocument when the refresh driver dies (and sprinkle a few null checks about).

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 6](/show_bug.cgi?id=1302973#c6)• 8 years ago |
|  | |

Attached patch

[Crash test](attachment.cgi?id=8796038&action=diff)
— [Details](attachment.cgi?id=8796038&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8796038)

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 7](/show_bug.cgi?id=1302973#c7)• 8 years ago |
|  | |

Attached patch

[Approach A (part 1): Store timelines on pres context](attachment.cgi?id=8796040&action=diff) (obsolete)
— [Details](attachment.cgi?id=8796040&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8796040)

Slight simplification
[Attachment #8796036](/attachment.cgi?id=8796036&action=edit "Possible fix for trunk") -
Attachment is obsolete: true

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 8](/show_bug.cgi?id=1302973#c8)• 8 years ago |
|  | |

One part of this patch I'm not sure about is the change where we stop unregistering the default document timeline from the refresh driver when we reset the document.
I made this change as a simplification since we originally only added that code because, once clearing the default document timeline we would no longer be able to reach it to tell it to disassociate itself when the pres shell is being destroyed. This bug reveals that even if we do that, however, the document it able to re-add itself. As a result this patch holds a separate list of timelines that it uses specifically for disassociating them from the refresh driver when it is about to be destroyed. That should make the handling of all timelines consistent and simple.
However, it may be better to more aggressively disassociate timelines when a document is reset. For example, clearing refresh driver observers sooner may improve performance / battery usage---but I think that would only matter when resetting documents and I'm not sure how common that is? Also, if we clear the connection between a timeline and a document we might free it up for GC sooner?
If we decide to go that route I think we could:
\* Iterate over all the timelines when we reset the document (just like we do when we destroy the pres shell)
\* Null out DocumentTimeline::mDocument (the wrapper cache parent object is AnimationTimeline::mWindow so we don't need to keep this reference) -- this is to ensure we do re-register with the refresh driver
\* Add necessary null checks for mDocument within DocumentTimeline

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a1697951_165012)• 8 years ago |

[Attachment #8796040](/attachment.cgi?id=8796040&action=edit "Approach A (part 1): Store timelines on pres context") -
Attachment description: Possible fix for trunk v2 → Approach A (part 1): Store timelines on pres context

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 9](/show_bug.cgi?id=1302973#c9)• 8 years ago |
|  | |

Attached patch

[Approach A (part 2): Unregister in document reset](attachment.cgi?id=8797852&action=diff) (obsolete)
— [Details](attachment.cgi?id=8797852&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797852)

This addresses some of the concerns I raised in [comment 8](/show_bug.cgi?id=1302973#c8 "VERIFIED FIXED - heap-use-after-free in nsRefreshDriver::Tick").

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 10](/show_bug.cgi?id=1302973#c10)• 8 years ago |
|  | |

Attached patch

[Approach B: Store timelines on the document](attachment.cgi?id=8797854&action=diff) (obsolete)
— [Details](attachment.cgi?id=8797854&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797854)

This is an alternative approach that I suspect is better (and more consistent with the patch I intend to land on aurora).
In this patch we record all documents created with the document they use to look up the refresh driver. Then, when either the document is reset or the refresh driver is destroyed, we go through the list of documents, disassociate them from the refresh driver, and break the link with the document so they can no longer re-register with the refresh driver.
I'm not entirely clear if it's a good idea to neuter all timelines when we call document.reset() but maybe it's ok?

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 11](/show_bug.cgi?id=1302973#c11)• 8 years ago |
|  | |

Attached patch

[Fix for release channels; r=hiro](attachment.cgi?id=8797855&action=diff) (obsolete)
— [Details](attachment.cgi?id=8797855&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797855)

As reviewed in [bug 1291665 comment 15](/show_bug.cgi?id=1291665#c15 "VERIFIED FIXED - heap-use-after-free in nsRefreshDriver::Tick").
For release channels we don't need to worry about independently-created DocumentTimeline objects since we don't ship the DocumentTimeline constructor on release channels yet.
[Attachment #8797855](/attachment.cgi?id=8797855&action=edit "Fix for release channels; r=hiro") -
Flags: review+

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 12](/show_bug.cgi?id=1302973#c12)• 8 years ago |
|  | |

Attached patch

[Approach B: Store timelines on the document](attachment.cgi?id=8797889&action=diff) (obsolete)
— [Details](attachment.cgi?id=8797889&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8797889)

Rebased
[Attachment #8797854](/attachment.cgi?id=8797854&action=edit "Approach B: Store timelines on the document") -
Attachment is obsolete: true

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a1755242_451704)• 8 years ago |

[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected)

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 13](/show_bug.cgi?id=1302973#c13)• 8 years ago |
|  | |

Brian, how far back does this affect Firefox?Flags: needinfo?(bbirtles)

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 14](/show_bug.cgi?id=1302973#c14)• 8 years ago |
|  | |

So this test fails when we reset the document, but then trigger a change on an animation connected to that document's timeline. I \*think\* it's only possible to trigger a change on an animation after the document is reset using the animation API. If that's the case, this goes back to Firefox 48 which is the first release where we shipped Element.animate ([bug 1245000](/show_bug.cgi?id=1245000 "RESOLVED FIXED - Ship Element.animate")).Flags: needinfo?(bbirtles)

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 15](/show_bug.cgi?id=1302973#c15)• 8 years ago |
|  | |

Attached patch

[Approach B: Store timelines on the document](attachment.cgi?id=8798326&action=diff) (obsolete)
— [Details](attachment.cgi?id=8798326&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798326)

Approach B was failing in dom/animation/test/document-timeline/test\_document-timeline.html because we'd disconnect from the document meaning that document.timeline.currentTime would return null after we destroyed the pres shell. I don't think it should do that.
After looking into it, it looks like I was complicating this bug more that necessary. The fundamental cause is that in [bug 1232829](/show_bug.cgi?id=1232829 "RESOLVED FIXED - Crash [@ nsRefreshDriver::RemoveRefreshObserver] with CSS transition, navigation") we came across a case where the pres shell was destroyed but we failed to unregister from the refresh driver because the call to nsDocument::Reset broke the connection from document to timeline (so we couldn't reach the timeline to tell it to unregister). To fix that we make the timeline unregister from the refresh driver in nsDocument::Reset.
\*However\* if after doing that we modify an animation attached to the timeline, it can cause the timeline to re-register with the refresh driver and then we have the same problem, i.e. we can't reach the timeline to tell it to unregister from the refresh driver when the pres shell disappears.
Furthermore, while investigating I notice that we never take care to unregister script-generated timelines when the presshell is destroyed. Fortunately, that feature is only enabled on non-release builds so the damage is limited but we should fix that while we're at it.
This updated patch should fix both problems by:
\* Recording all timelines against the document they use to fetch their refresh driver
\* \*Not\* clearing this reference when a document is reset (so we can always reach these timelines, even if they get re-added somehow)
\* Notifying all timelines when the presshell is being destroyed
I'm still not sure if we should forcefully disconnect all timelines from their document when it is reset. Originally I tried doing this but was a bit too eager and also did this when the presshell was destroyed which caused dom/animation/test/document-timeline/test\_document-timeline.html to fail. Perhaps we can try doing that in a separate bug (but only for resetting the document). For now, this should be enough to fix the crash.
[Attachment #8797889](/attachment.cgi?id=8797889&action=edit "Approach B: Store timelines on the document") -
Attachment is obsolete: true

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a1805735_165012)• 8 years ago |

[Attachment #8798326](/attachment.cgi?id=8798326&action=edit "Approach B: Store timelines on the document") -
Flags: review?(bugs)

|  | [Olli Pettay [:smaug][bugs@pettay.fi]](/user_profile?user_id=39966) |  |
| --- | --- | --- |
| [Comment 16](/show_bug.cgi?id=1302973#c16)• 8 years ago |
|  | |

Comment on [attachment 8798326](/attachment.cgi?id=8798326 "Approach B: Store timelines on the document") [[details]](/attachment.cgi?id=8798326&action=edit "Approach B: Store timelines on the document") [[diff]](/attachment.cgi?id=8798326&action=diff "Approach B: Store timelines on the document") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798326)
Approach B: Store timelines on the document
>+ mozilla::LinkedList<mozilla::dom::DocumentTimeline>& Timelines() override
>+ { return mTimelines; }
Nit, I'd write this
mozilla::LinkedList<mozilla::dom::DocumentTimeline>& Timelines() override
{
return mTimelines;
}
[Attachment #8798326](/attachment.cgi?id=8798326&action=edit "Approach B: Store timelines on the document") -
Flags: review?(bugs) → review+

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 17](/show_bug.cgi?id=1302973#c17)• 8 years ago |
|  | |

Attached patch

[Fix for trunk: Store timelines on document; r=smaug](attachment.cgi?id=8798682&action=diff)
— [Details](attachment.cgi?id=8798682&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798682)

Addressed review feedback, updated patch title, added an assert to nsDocument::~nsDocument.
[Attachment #8796040](/attachment.cgi?id=8796040&action=edit "Approach A (part 1): Store timelines on pres context") -
Attachment is obsolete: true
[Attachment #8797852](/attachment.cgi?id=8797852&action=edit "Approach A (part 2): Unregister in document reset") -
Attachment is obsolete: true
[Attachment #8797855](/attachment.cgi?id=8797855&action=edit "Fix for release channels; r=hiro") -
Attachment is obsolete: true
[Attachment #8798326](/attachment.cgi?id=8798326&action=edit "Approach B: Store timelines on the document") -
Attachment is obsolete: true
[Attachment #8798682](/attachment.cgi?id=8798682&action=edit "Fix for trunk: Store timelines on document; r=smaug") -
Flags: review+

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 18](/show_bug.cgi?id=1302973#c18)• 8 years ago |
|  | |

Attached patch

[Fix rebased for aurora/beta](attachment.cgi?id=8798683&action=diff)
— [Details](attachment.cgi?id=8798683&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798683)

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 19](/show_bug.cgi?id=1302973#c19)• 8 years ago |
|  | |

Attached patch

[Fix rebased for release](attachment.cgi?id=8798684&action=diff) (obsolete)
— [Details](attachment.cgi?id=8798684&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798684)

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 20](/show_bug.cgi?id=1302973#c20)• 8 years ago |
|  | |

Comment on [attachment 8798682](/attachment.cgi?id=8798682 "Fix for trunk: Store timelines on document; r=smaug") [[details]](/attachment.cgi?id=8798682&action=edit "Fix for trunk: Store timelines on document; r=smaug") [[diff]](/attachment.cgi?id=8798682&action=diff "Fix for trunk: Store timelines on document; r=smaug") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798682)
Fix for trunk: Store timelines on document; r=smaug
[Security approval request comment]
> How easily could an exploit be constructed based on the patch?
Somewhat easily. Once you recognize that this is a security-related patch you could infer that it has something to do with the interaction between timelines, the refresh driver and documents being reset. Of course you'd still need to be able to trigger GC to expose the bug.
> Do comments in the patch, the check-in comment, or tests included in
> the patch paint a bulls-eye on the security problem?
No.
> Which older supported branches are affected by this flaw?
Release, Aurora, Beta (Firefox 48 onwards)
> If not all supported branches, which bug introduced the flaw?
Ultimately it was introduced by [bug 1195180](/show_bug.cgi?id=1195180 "RESOLVED FIXED - Tick animations from their timeline") but only shipped to release channels by [bug 1245000](/show_bug.cgi?id=1245000 "RESOLVED FIXED - Ship Element.animate").
> Do you have backports for the affected branches? If not, how different,
> hard to create, and risky will they be?
Yes ([attachment 8798683](/attachment.cgi?id=8798683 "Fix rebased for aurora/beta") [[details]](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") [[diff]](/attachment.cgi?id=8798683&action=diff "Fix rebased for aurora/beta") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798683) and [attachment 8798684](/attachment.cgi?id=8798684 "Fix rebased for release") [[details]](/attachment.cgi?id=8798684&action=edit "Fix rebased for release") [[diff]](/attachment.cgi?id=8798684&action=diff "Fix rebased for release") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798684)) although I have yet to test these, only that they apply cleanly.
> How likely is this patch to cause regressions; how much testing does it need?
Not likely. I am currently running it through try (<https://treeherder.mozilla.org/#/jobs?repo=try&revision=3afb34a77846>) with a patch title that does not clearly suggest a security bug.
[Attachment #8798682](/attachment.cgi?id=8798682&action=edit "Fix for trunk: Store timelines on document; r=smaug") -
Flags: sec-approval?

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a1872266_165012)• 8 years ago |

[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected)
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
--- → [affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected)
[status-firefox-esr45](/buglist.cgi?f1=cf_status_firefox_esr45&o1=isnotempty):
--- → [unaffected](/buglist.cgi?f1=cf_status_firefox_esr45&o1=equals&v1=unaffected)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Comment 21](/show_bug.cgi?id=1302973#c21)• 8 years ago |
|  | |

sec-approval+ for trunk. Please nominate Aurora and Beta patches for approval once trunk goes in.
[status-firefox49](/buglist.cgi?f1=cf_status_firefox49&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=affected) → [wontfix](/buglist.cgi?f1=cf_status_firefox49&o1=equals&v1=wontfix)
[tracking-firefox50](/buglist.cgi?f1=cf_tracking_firefox50&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox50&o1=equals&v1=%2B)
[tracking-firefox51](/buglist.cgi?f1=cf_tracking_firefox51&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox51&o1=equals&v1=%2B)
[tracking-firefox52](/buglist.cgi?f1=cf_tracking_firefox52&o1=isnotempty):
--- → [+](/buglist.cgi?f1=cf_tracking_firefox52&o1=equals&v1=%2B)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a1928125_280903)• 8 years ago |

[Attachment #8798682](/attachment.cgi?id=8798682&action=edit "Fix for trunk: Store timelines on document; r=smaug") -
Flags: sec-approval? → sec-approval+

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 22](/show_bug.cgi?id=1302973#c22)• 8 years ago |
|  | |

<https://hg.mozilla.org/integration/mozilla-inbound/rev/bfe9d976f7509cf82989edbac61d56eb3fa4f2c5>

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 23](/show_bug.cgi?id=1302973#c23)• 8 years ago |
|  | |

<https://hg.mozilla.org/mozilla-central/rev/bfe9d976f750>Status: ASSIGNED → RESOLVEDClosed: 8 years ago
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed)Resolution: --- → FIXEDTarget Milestone: --- → mozilla52

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 24](/show_bug.cgi?id=1302973#c24)• 8 years ago |
|  | |

Comment on [attachment 8798683](/attachment.cgi?id=8798683 "Fix rebased for aurora/beta") [[details]](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") [[diff]](/attachment.cgi?id=8798683&action=diff "Fix rebased for aurora/beta") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798683)
Fix rebased for aurora/beta
Approval Request Comment
[Feature/regressing bug #]: Ultimately it was introduced by [bug 1195180](/show_bug.cgi?id=1195180 "RESOLVED FIXED - Tick animations from their timeline") but only shipped to release channels by [bug 1245000](/show_bug.cgi?id=1245000 "RESOLVED FIXED - Ship Element.animate").
[User impact if declined]: Security vulnerability, unpatched use after free.
[Describe test coverage new/current, TreeHerder]: Landed on m-c about 15 hours ago and seems to be ok. I've pushed to try just now for aurora[1]/beta[2] and it seems to be ok.
[Risks and why]: No known obvious risks.
[String/UUID change made/needed]: none
[1] <https://treeherder.mozilla.org/#/jobs?repo=try&revision=eab6fb813091>
[2] <https://treeherder.mozilla.org/#/jobs?repo=try&revision=3a4e9fa5f6d2>
[Attachment #8798683](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") -
Flags: approval-mozilla-beta?
[Attachment #8798683](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") -
Flags: approval-mozilla-aurora?

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 25](/show_bug.cgi?id=1302973#c25)• 8 years ago |
|  | |

Attached patch

[Fix rebased for release](attachment.cgi?id=8799608&action=diff)
— [Details](attachment.cgi?id=8799608&action=edit)
— [Splinter Review](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8799608)

Looks like I missed a few lines when I rebased this last time.
[Attachment #8798684](/attachment.cgi?id=8798684&action=edit "Fix rebased for release") -
Attachment is obsolete: true

|  | [Brian Birtles (:birtles)](/user_profile?user_id=165012)  Assignee |  |
| --- | --- | --- |
| [Comment 26](/show_bug.cgi?id=1302973#c26)• 8 years ago |
|  | |

Comment on [attachment 8799608](/attachment.cgi?id=8799608 "Fix rebased for release") [[details]](/attachment.cgi?id=8799608&action=edit "Fix rebased for release") [[diff]](/attachment.cgi?id=8799608&action=diff "Fix rebased for release") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8799608)
Fix rebased for release
Approval Request Comment
[Feature/regressing bug #]: Ultimately it was introduced by [bug 1195180](/show_bug.cgi?id=1195180 "RESOLVED FIXED - Tick animations from their timeline") but only shipped to release channels by [bug 1245000](/show_bug.cgi?id=1245000 "RESOLVED FIXED - Ship Element.animate")
[User impact if declined]: Security vulnerability, unpatched use after free.
[Describe test coverage new/current, TreeHerder]: Landed on m-c about 15 hours ago and seems to be ok. I've just pushed to try now.[1]
[Risks and why]: No known obvious risks.
[String/UUID change made/needed]: None.
[1] <https://treeherder.mozilla.org/#/jobs?repo=try&revision=0479fb308eba>
[Attachment #8799608](/attachment.cgi?id=8799608&action=edit "Fix rebased for release") -
Flags: approval-mozilla-release?

|  | [Ritu Kothari (:ritu) (Inactive, please n-i to RyanVM, jcristau, or pascal)](/user_profile?user_id=538805) |  |
| --- | --- | --- |
| [Comment 27](/show_bug.cgi?id=1302973#c27)• 8 years ago |
|  | |

Comment on [attachment 8798683](/attachment.cgi?id=8798683 "Fix rebased for aurora/beta") [[details]](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") [[diff]](/attachment.cgi?id=8798683&action=diff "Fix rebased for aurora/beta") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8798683)
Fix rebased for aurora/beta
Sec-crit, Aurora51+, Beta50+
[Attachment #8798683](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") -
Flags: approval-mozilla-beta?
[Attachment #8798683](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") -
Flags: approval-mozilla-beta+
[Attachment #8798683](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") -
Flags: approval-mozilla-aurora?
[Attachment #8798683](/attachment.cgi?id=8798683&action=edit "Fix rebased for aurora/beta") -
Flags: approval-mozilla-aurora+

|  | [Liz Henry (:lizzard) (relman/hg->git project)](/user_profile?user_id=451704) |  |
| --- | --- | --- |
| [Comment 28](/show_bug.cgi?id=1302973#c28)• 8 years ago |
|  | |

Comment on [attachment 8799608](/attachment.cgi?id=8799608 "Fix rebased for release") [[details]](/attachment.cgi?id=8799608&action=edit "Fix rebased for release") [[diff]](/attachment.cgi?id=8799608&action=diff "Fix rebased for release") [[review]](/page.cgi?id=splinter.html&ignore=&bug=1302973&attachment=8799608)
Fix rebased for release
This got wontfixed for 49 already in security triage.
[Attachment #8799608](/attachment.cgi?id=8799608&action=edit "Fix rebased for release") -
Flags: approval-mozilla-release? → approval-mozilla-release-

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a2302550_1689)• 8 years ago |

Group: layout-core-security → core-security-release

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 29](/show_bug.cgi?id=1302973#c29)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-aurora/rev/2da62d29c6a4>
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed)

|  | [Carsten Book [:Tomcat]](/user_profile?user_id=277293) |  |
| --- | --- | --- |
| [Comment 30](/show_bug.cgi?id=1302973#c30)• 8 years ago |
|  | |

<https://hg.mozilla.org/releases/mozilla-beta/rev/a7e12adf2ee01578ba31c928a2e0084c4286bc45>
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[affected](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=affected) → [fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed)

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a2347729_488993)• 8 years ago |

Flags: qe-verify+

|  | [Andrei Vaida [:avaida]](/user_profile?user_id=488993) |  |
| --- | --- | --- |
| [Comment 31](/show_bug.cgi?id=1302973#c31)• 8 years ago |
|  | |

I've managed to reproduce this bug on an affected build (49.0.1-build3, 20160922113459), using the testcase provided in [Comment 0](/show_bug.cgi?id=1302973#c0 "VERIFIED FIXED - heap-use-after-free in nsRefreshDriver::Tick") and the fuzzPriv extension installed.
This is verified fixed on:
- 50.0b8-build1 (20161017130949)
- 51.0a2 (2016-10-18)
- 52.0a1 (2016-10-18)
using Windows 10 x64, Ubuntu 14.04 x86 and Mac OS X 10.11.6. A crash is no longer triggered by this scenario.Status: RESOLVED → VERIFIED
[status-firefox50](/buglist.cgi?f1=cf_status_firefox50&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox50&o1=equals&v1=verified)
[status-firefox51](/buglist.cgi?f1=cf_status_firefox51&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox51&o1=equals&v1=verified)
[status-firefox52](/buglist.cgi?f1=cf_status_firefox52&o1=isnotempty):
[fixed](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=fixed) → [verified](/buglist.cgi?f1=cf_status_firefox52&o1=equals&v1=verified)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a4106971_280903)• 8 years ago |

Flags: sec-bounty?

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a4611785_1689)• 8 years ago |

Blocks: [1195180](/show_bug.cgi?id=1195180 "RESOLVED FIXED - Tick animations from their timeline"), [1245000](/show_bug.cgi?id=1245000 "RESOLVED FIXED - Ship Element.animate")Flags: sec-bounty?Flags: sec-bounty+Flags: in-testsuite?Keywords: [sec-critical](/buglist.cgi?keywords=sec-critical&resolution=---) → [regression](/buglist.cgi?keywords=regression&resolution=---),
[sec-high](/buglist.cgi?keywords=sec-high&resolution=---)

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a4791139_280903)• 8 years ago |

Whiteboard: [adv-main50+]

|  | [Al Billings [:abillings - ex-MoCo]](/user_profile?user_id=280903) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a4873122_280903)• 8 years ago |

Alias: CVE-2016-9068

|  | [Daniel Veditz [:dveditz]](/user_profile?user_id=1689) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a12723389_1689)• 8 years ago |

Group: core-security-release

|  | [David Lawrence [:dkl]](/user_profile?user_id=5898) |  |
| --- | --- | --- |
| [Updated](/show_bug.cgi?id=1302973#a243153303_5898)• 8 months ago |

Keywords: [reporter-external](/buglist.cgi?keywords=reporter-external&resolution=---)
You need to [log in](/show_bug.cgi?id=1302973&GoAheadAndLogIn=1)
before you can comment on or make changes to this bug.

Top ↑

## Attachment

Hide Details

### General

Creator:  [Nils](/user_profile?user_id=344130)

Created:
Updated:
Size:

### Description

### File Name

### Content Type

Raw
Diff
Splinter Review



=== Content from wiki.mozilla.org_73f8d6fa_20250126_112648.html ===


# BMO/UserGuide/BugFields

From MozillaWiki
< [BMO](/BMO "BMO")‎ | [UserGuide](/BMO/UserGuide "BMO/UserGuide")

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)
## Bugzilla Field Descriptions

Alias
A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.Assignee
This is the person in charge of resolving the bug. Every time this field changes, the status changes to NEW to make it easy to see which new bugs have appeared on a person's list.Blocks
This bug must be resolved before the bugs listed in this field can be resolved.Bug ID
The numeric id of a bug, unique within this entire installation of Bugzilla.CC
Users who may not have a direct role to play on this bug, but who are interested in its progress.Changed
When this bug was last updated.Classification
Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorization.Comment
Bugs have comments added to them by Bugzilla users. You can search for some text in those comments.Comment Tag
Comments can have arbitrary tags added to them to help with filtering as well as mark comments as spam or abusive.Component
Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.Creation date
When the bug was filed.Depends on
The bugs listed here must be resolved before this bug can be resolved.Duplicates
List of bugs that have been marked a duplicate of the bug currently being viewed.Keywords
Keywords are a controlled vocabulary for characterizing bugs across Products and Components. Examples of this field are `regression`, `sec-high`, and `topcrash`. Bugzilla administrators manage [the list of keywords](https://bugzilla.mozilla.org/describekeywords.cgi). If you believe you need a new keyword, [please contact the administrators to discuss](https://bugzilla.mozilla.org/enter_bug.cgi?product=bugzilla.mozilla.org&component=Administration).Mentors
Mentors are users who have offered to help the bug owner with such tasks as setting up a development environment, finding relevant information to fixing the bug, how to submit a patch for review, and finally how to get the fix committed.Needinfo
More information has been requested from specific individuals, or anyone, to move the bug forward to completion.OS
This is the operating system against which the bug was reported.Platform
This is the hardware platform against which the bug was reported (ARM, ARM64, x86, x86\_64, etc).Priority

| Priority | Description |
| --- | --- |
| **--** | No decision |
| **P1** | Fix in the current release cycle |
| **P2** | Fix in the next release cycle or the following (nightly + 1 or nightly + 2) |
| **P3** | Backlog |
| **P4** | Do not use. This priority is for the Web Platform Test bot. |
| **P5** | Will not fix, but will accept a patch |

This field describes the importance and order in which a bug should be fixed compared to other bugs. This field is utilized by the programmers/engineers/release managers/managers to prioritize the work to be done. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [priority definitions](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/priority.html), or for the main Bugzilla project, [Bugzilla:Priority\_System](/Bugzilla%3APriority_System "Bugzilla:Priority System").Product
Bugs are categorised into Products and Components. Select a Classification to narrow down this list.QA Contact
The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.Rank
Used by some groups to provide finer-grained ordering for working on bugs than afforded by the Priority field. Use of this field is restricted to the `rank-setters` group.Regressed by
This bug has been introduced by the bugs listed here.Regressions
This bug has introduced the bugs listed here.Reporter
The person who filed this bug.See Also
This allows you to refer to bugs in other bug tracker installations. You can enter a URL to a bug in the 'Add Bug URLs' field to note that that bug is related to this one. You can enter multiple URLs at once by separating them with a comma. You should normally use this field to refer to bugs in other bug tracker installations, or bugs which are related to, but not known to be duplicates of the bug. Bugs which are regressions should be listed in the Regressed by field (above)Severity
This field describes the impact of a bug. This field is utilized by the programmers/engineers/release managers/managers to determine the severity of issues and used as input for the priority of the bug. It should not be set by people filing bugs. See the Firefox [triage documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html) and [severity documentation](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/severity.html).

| Severity | Description |
| --- | --- |
| **--** | Default value for new bugs; bug triagers for components (ie engineers and other core project folks) are expected to update the bug's severity from this value. To avoid them missing new bugs for triage, do not alter this default when filing bugs. |
| **S1** | (Catastrophic) Blocks development/testing, may impact more than 25% of users, causes data loss, likely dot release driver, and no workaround available |
| **S2** | (Serious) Major functionality/product severely impaired or a high impact issue and a satisfactory workaround does not exist |
| **S3** | (Normal) Blocks non-critical functionality or a work around exists |
| **S4** | (Small/Trivial) minor significance, cosmetic issues, low or no impact to users |
| **N/A** | (Not Applicable) The above definitions do not apply to this bug; this value is reserved for bugs of type Task or Enhancement |

Summary
The bug summary is a short sentence which succinctly describes what the bug is about.Target Milestone
For Firefox-related bugs, when a change set (patch) lands in Mozilla-Central, the [sheriffs](/Sheriffing "Sheriffing") will set this field to the corresponding release value for the current Nightly.
Release status and tracking flags are used to mark intentions for when a fix or other patch should land.
If you need to track a bug against a set of milestones other than upcoming versions of Firefox, please tell the Bugzilla team, you may want a custom status flag.Triage Owner
User that is responsible [for triaging bugs in a specific component](https://firefox-source-docs.mozilla.org/bug-mgmt/policies/triage-bugzilla.html).Type
This field describes the [type of a bug](https://firefox-source-docs.mozilla.org/bug-mgmt/guides/bug-types.html).

| Type | Description |
| --- | --- |
| **defect** | regression, crash, hang, security vulnerability and any other general issue. |
| **enhancement** | new feature, improvement in UI, performance, etc. and any other request for user-facing changes and enhancements in the product; not engineering changes |
| **task** | refactoring, removal, replacement, enabling or disabling of functionality and any other engineering task |

URL
Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.Version
The version field defines the version of the software the bug was found in.Votes
Some bugs can be voted for, and you can limit your search to bugs with more than a certain number of votes. Votes are not used by Mozilla developers to set priorities.Whiteboard
Each bug has a free-form single line text entry box for adding tags and status information

Retrieved from "<https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&oldid=1250790>"

## Navigation menu

### Personal tools

* [Log in](/index.php?title=Special:UserLogin&returnto=BMO%2FUserGuide%2FBugFields "You are encouraged to log in; however, it is not mandatory [o]")
* [Request account](/Special%3ARequestAccount "You are encouraged to create an account and log in; however, it is not mandatory")

### Namespaces

* [Page](/BMO/UserGuide/BugFields "View the content page [c]")
* [Discussion](/index.php?title=Talk:BMO/UserGuide/BugFields&action=edit&redlink=1 "Discussion about the content page (page does not exist) [t]")

English

### Views

* [Read](/BMO/UserGuide/BugFields)
* [View source](/index.php?title=BMO/UserGuide/BugFields&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/index.php?title=BMO/UserGuide/BugFields&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/Main_Page "Visit the main page [z]")
* [Product releases](/Releases)
* [New pages](/Special%3ANewPages)
* [Recent changes](/Special%3ARecentChanges "A list of recent changes in the wiki [r]")
* [Recent uploads](/Special%3ANewFiles)
* [Random page](/Special%3ARandom "Load a random page [x]")
* [Help](/MozillaWiki%3AHelp "The place to find out")

### How to Contribute

* [All-hands meeting](/WeeklyUpdates)
* [Other meetings](/Community_Calendar)
* [Contribute to Mozilla](/Contribute)
* [Community Portal](//community.mozilla.org)
* [Community Participation Guidelines](//www.mozilla.org/en-US/about/governance/policies/participation/)

### MozillaWiki

* [About](/MozillaWiki%3AAbout)
* [Team](/MozillaWiki%3ATeam)
* [Policies](/MozillaWiki%3APolicies)
* [Report a wiki bug](//bugzilla.mozilla.org/enter_bug.cgi?product=Websites&component=wiki.mozilla.org)

### Around Mozilla

* [Mozilla Support](//support.mozilla.org/)
* [Mozilla Developer Network](//developer.mozilla.org/)
* [Planet Mozilla](//planet.mozilla.org/)
* [Mozilla Blog](//blog.mozilla.org/)
* [Research](//www.mozilla.org/research/)

### Tools

* [What links here](/Special%3AWhatLinksHere/BMO/UserGuide/BugFields "A list of all wiki pages that link here [j]")
* [Related changes](/Special%3ARecentChangesLinked/BMO/UserGuide/BugFields "Recent changes in pages linked from this page [k]")
* [Special pages](/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/index.php?title=BMO/UserGuide/BugFields&oldid=1250790 "Permanent link to this revision of this page")
* [Page information](/index.php?title=BMO/UserGuide/BugFields&action=info "More information about this page")

* This page was last edited on 14 May 2024, at 14:22.

* [Privacy policy](/MozillaWiki%3APrivacy_policy)
* [About MozillaWiki](/MozillaWiki%3AAbout)
* [Mobile view](https://wiki.mozilla.org/index.php?title=BMO/UserGuide/BugFields&mobileaction=toggle_view_mobile)

* [![Powered by MediaWiki](/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)


