```
{
  "vulnerability": {
    "root_cause": "The OwnCloud application had a flaw in its external SMB authentication mechanism. It used the command `smbclient -L //host/dummy -Uusername%password` to authenticate users against an external SMB server. The vulnerability stems from the fact that default SMB server configurations with 'map to guest' enabled will return a share listing even with invalid credentials. The OwnCloud application was interpreting any successful response (including those from invalid user/pass) as valid authentication.",
    "weaknesses": [
      "Improper authentication",
      "Cleartext storage of credentials",
      "Insecure data directory location",
      "Insufficient .htaccess configuration"
    ],
    "impact": "An attacker can bypass SMB authentication and gain access to the OwnCloud web application. Additionally, the webserver's data directory was accessible, allowing for arbitrary PHP code execution and a persistent backdoor through modifying the SMB host parameter in the configuration to execute a reverse shell.",
    "attack_vectors": [
      "Web application login form",
       "Direct access to the webserver's data directory",
      "Configuration file modification"
    ],
     "required_capabilities": [
      "Network access to the OwnCloud web application",
        "Ability to upload files",
      "Ability to modify application configuration"
    ],
    "details": "The vulnerability allowed an attacker to log in to the OwnCloud web application with any username and password if the SMB server had 'map to guest' enabled, creating a new user if one did not exist. Additionally, the external SMB storage passwords were stored in cleartext within the administrative console. The application stored the data directory under the webroot, not updating `.htaccess` which allowed direct browsing to the data directory. After gaining access, an attacker could upload a PHP shell and execute commands on the server. Further exploitation involved modifying the configuration file to change the SMB host to an attacker-controlled server, creating a persistent backdoor which runs a reverse shell each time any user logs in."
  }
}
```