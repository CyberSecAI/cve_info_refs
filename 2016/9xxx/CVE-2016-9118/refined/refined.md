Based on the provided information, here's an analysis of CVE-2016-9118:

**Root Cause of Vulnerability:**

*   Integer overflow when calculating the size of the buffer needed for image data in the `pnmtoimage` function within `convert.c`. The function reads the width and height from the input PGM file, and these are used to calculate the allocation size. If large, attacker-controlled values are provided for these, the multiplication `comp->w * comp->h` will wrap around to a very small value (specifically, 1). Subsequently, the code will write image data beyond the bounds of the allocated memory (heap buffer overflow).

**Weaknesses/Vulnerabilities Present:**

*   **Heap Buffer Overflow:** The core vulnerability is a heap buffer overflow in the `pnmtoimage` function at `convert.c:1719` due to insufficient memory allocation.
*   **Integer Overflow:** The integer overflow vulnerability in the calculation of the buffer size is what causes the heap buffer overflow. The product of `w` and `h` exceeds the maximum value for an integer, resulting in a small allocated size and subsequent out-of-bounds write.
*   **Lack of Input Validation:**  The function does not validate the width and height values read from the input file, allowing an attacker to provide very large numbers.

**Impact of Exploitation:**

*   **Arbitrary Code Execution:** The most severe consequence is the possibility of arbitrary code execution. By overflowing the buffer, an attacker can overwrite adjacent memory regions to control program execution flow.
*   **Denial of Service (DoS):** A less severe outcome is a denial of service. The memory corruption could cause the application to crash.
*   **Unspecified Impacts:** The Gentoo advisory mentions "other unspecified impacts", indicating that exploitation may have unpredictable consequences beyond code execution and DoS.

**Attack Vectors:**

*   **Crafted PGM File:** The vulnerability is triggered by processing a maliciously crafted PGM (Portable Graymap) image file. Specifically the header includes values for width and height that will cause the integer overflow.
*   **File Processing:** The application is vulnerable when processing an image file (PGM) through the `pnmtoimage` function in `convert.c`, which is used to convert a PGM file to other formats.

**Required Attacker Capabilities/Position:**

*   **Remote or Local File Delivery:** An attacker must deliver the crafted PGM file to a system running the vulnerable OpenJPEG library. This could be done locally or remotely if the vulnerable application processes images obtained from untrusted sources (e.g., via a web application, email attachment, etc).
*   **Ability to Trigger Processing:**  The attacker needs to be able to induce the vulnerable application to process the malicious image file.

**Additional details from the github issue #861:**

*   The vulnerability was found using AddressSanitizer.
*   The issue was reported on OpenJPEG version 2.1.2.
*   The vulnerable code is located in `src/bin/jp2/convert.c`.

**Summary:**

CVE-2016-9118 is a heap buffer overflow vulnerability in the `pnmtoimage` function of OpenJPEG, triggered by an integer overflow when calculating the size of the image data buffer, leading to the ability to cause a crash, or potentially execute arbitrary code if specific conditions are met.