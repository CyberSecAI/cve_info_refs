```
Message-ID: <ad660c2632fa4e6790fb12dc654b6769@imshyb02.MITRE.ORG>
Date: Wed, 23 Nov 2016 20:29:24 -0500
From: <cve-assign@...re.org>
To: <kcwu@...e.org>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>
Subject: Re: CVE request: w3m - multiple vulnerabilities

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

>  <https://github.com/tats/w3m/issues/38> heap overflow read + deref

This is a single issue described as "Prevent array index out of bounds for symbol"
in <https://github.com/tats/w3m/commit/0c3f5d0e0d9269ad47b8f4b061d7818993913189>

Use CVE-2016-9627.
-----BEGIN PGP SIGNATURE-----
```

- **Root cause of vulnerability:** An array index out-of-bounds issue exists in the `conv_symbol()` function. The `symbol` array, which is allocated in `update_utf8_symbol()`, has a fixed size of 46. However, the code uses an arbitrary character value as an index into this array `symbol[(int)c]`, leading to an out-of-bounds read.

- **Weaknesses/vulnerabilities:**
    - **Heap buffer overflow read:** The code reads beyond the allocated boundary of the `symbol` array when an out-of-range character value is used as an index.
    - **Bad pointer dereference:** In the `Strcat_charp` function, a bad memory address is dereferenced, leading to a crash. This happens because the out-of-bounds read from the `symbol` array returns an invalid address, which is then used as a pointer.

- **Impact of exploitation:**
    - **Segmentation fault/Crash:** The out-of-bounds read and subsequent bad pointer dereference cause a segmentation fault, leading to the termination of the program.
    - **Potential arbitrary code execution (more detail than CVE):** While the provided information only shows a crash, a heap overflow read like this could potentially be exploited to overwrite adjacent heap data, which might eventually be used for arbitrary code execution under a more sophisticated exploit strategy.

- **Attack vectors:**
    - By crafting a specific HTML input that includes special characters (like character 'Q' in the provided example) causing an index out of range, which triggers the vulnerable code path in the `conv_symbol()` function.

- **Required attacker capabilities/position:**
    - The attacker needs to be able to supply a crafted HTML document to the w3m browser.
    - No special privileges are needed, just the ability to get w3m to process the malicious HTML.