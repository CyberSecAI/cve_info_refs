- **Root cause of vulnerability**: An out-of-bounds indexing vulnerability exists in the `as_particle_size_from_pickled` function within the Aerospike Database Server when processing RW fabric messages. Specifically, the server doesn't validate the `type` field of a bin structure before using it as an index into the `particle_vtable` array. An attacker can specify an out-of-bounds index in the `type` field causing a crash due to dereferencing an invalid memory address.
- **Weaknesses/vulnerabilities present**: Improper validation of array index (CWE-129). The server fails to validate the `type` field read from the network packet before using it to index into the `particle_vtable`.
- **Impact of exploitation**: Remote code execution. By carefully crafting the out-of-bounds index, an attacker could potentially overwrite memory and achieve remote code execution on the server. The vulnerability leads to a crash due to a segmentation fault but can be weaponized to RCE.
- **Attack vectors**: The vulnerability is triggered by sending a specially crafted network packet to the Aerospike server's fabric port. The attacker must first establish a connection to the port, and then send a two-message sequence that includes a specific AS_RW message with a crafted RECORD field.
- **Required attacker capabilities/position**: The attacker needs to be able to establish a network connection to the Aerospike server's fabric port and send arbitrary packets to it. No prior authentication is required. The attacker does not need any prior knowledge of the system besides the required network services.