Based on the provided information, here's a breakdown of the vulnerability described in CVE-2016-9903:

**Root Cause of Vulnerability:**

- The add-ons SDK included a publicly accessible HTML file (`view.html`) that intentionally injected HTML code from the URL's hash fragment into the document's content. This was done using `document.documentElement.innerHTML = atob(location.hash.substr(1));`.

**Weaknesses/Vulnerabilities Present:**

- **XSS (Cross-Site Scripting):** The core vulnerability is an HTML injection, which, if triggered, can be exploited to perform XSS attacks by injecting arbitrary HTML and JavaScript.
- **World-Accessible Resource:** The vulnerable `view.html` file was accessible to any website loaded in the browser, as it resided at `resource://gre/modules/commonjs/sdk/ui/frame/view.html`.
- **Potential for Privilege Escalation:** While not directly exploitable from web content, the vulnerability could allow an attacker to inject content and scripts into an add-on's context, potentially accessing the add-on's storage, manipulating content scripts, or performing actions within the add-on's security context if combined with another vulnerability that can load this as document.

**Impact of Exploitation:**

- An attacker could potentially use this vulnerability, potentially combined with another exploit, to inject arbitrary HTML and JavaScript into an add-on's context. This could lead to:
    - Access to add-on's localStorage, enabling data theft or manipulation.
    - Manipulation of content scripts, leading to unexpected or malicious behavior in webpages that the add-on interacts with.
    - Other malicious actions that an add-on is capable of performing.

**Attack Vectors:**

- The primary attack vector is through loading the vulnerable `resource://gre/modules/commonjs/sdk/ui/frame/view.html` resource (or a bundled copy within an add-on) as a document, using some other exploit, and then manipulating the URL hash.
- A malicious website could craft a URL with a malicious payload in its hash fragment, and attempt to get a vulnerable add-on to load this.
- It's important to note that a separate vulnerability is needed to actually load the resource as a document since a regular webpage cannot load resource:// URLs as documents.

**Required Attacker Capabilities/Position:**

- The attacker needs the ability to either:
    - Manipulate an add-on into loading the vulnerable resource as a document with a malicious payload.
    - Exploit another vulnerability that could load the resource as a document with a malicious payload.

The vulnerability was rated as **moderate** severity because it required an additional vulnerability to load the resource as a document.

The bug report also mentions that the vulnerable file is included in the add-on SDK, so many add-ons would be vulnerable if they bundle a copy of the SDK. The developers of these affected add-ons were contacted and were encouraged to remove the bundled copies of the SDK. Add-ons that did not do so were blocked.