=== Content from security.gentoo.org_1305b977_20250125_212913.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201612-56**

Multiple vulnerabilities have been found in Xen, the worst of which
could lead to the execution of arbitrary code on the host system.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r4** |
| Unaffected versions | >= **4.7.1-r4** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r4** |
| Unaffected versions | >= **4.7.1-r4** |

| Package | **app-emulation/xen-pvgrub** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r1** |
| Unaffected versions | >= **4.7.1-r1** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
CVE identifiers referenced below for details.

### Impact

A local attacker could possibly execute arbitrary code with the
privileges of the process, could gain privileges on the host system,
cause a Denial of Service condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.7.1-r4"

```

All Xen Tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-tools-4.7.1-r4"

```

All Xen PvGrub users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-pvgrub-4.7.1-r1"

```
### References

* [CVE-2016-10024](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10024)
* [CVE-2016-9377](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9377)
* [CVE-2016-9378](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9378)
* [CVE-2016-9379](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9379)
* [CVE-2016-9380](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9380)
* [CVE-2016-9381](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9381)
* [CVE-2016-9382](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9382)
* [CVE-2016-9383](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9383)
* [CVE-2016-9384](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9384)
* [CVE-2016-9385](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9385)
* [CVE-2016-9386](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9386)
* [CVE-2016-9637](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9637)
* [CVE-2016-9815](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9815)
* [CVE-2016-9816](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9816)
* [CVE-2016-9817](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9817)
* [CVE-2016-9818](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9818)
* [CVE-2016-9932](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9932)

**Release date**

December 31, 2016

**Latest revision**

January 03, 2017: 2

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [600382](https://bugs.gentoo.org/show_bug.cgi?id=600382)
* [600662](https://bugs.gentoo.org/show_bug.cgi?id=600662)
* [601248](https://bugs.gentoo.org/show_bug.cgi?id=601248)
* [601250](https://bugs.gentoo.org/show_bug.cgi?id=601250)
* [601986](https://bugs.gentoo.org/show_bug.cgi?id=601986)
* [603420](https://bugs.gentoo.org/show_bug.cgi?id=603420)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from xenbits.xen.org_609846e5_20250125_212913.html ===

# Information

| Advisory | [XSA-195](advisory-195.html) |
| --- | --- |
| Public release | 2016-11-22 12:00 |
| Updated | 2016-11-22 12:00 |
| Version | 3 |
| CVE(s) | [CVE-2016-9383](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9383) |
| Title | x86 64-bit bit test instruction emulation broken |

# Files

<advisory-195.txt> (signed advisory file)

<xsa195.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

            Xen Security Advisory CVE-2016-9383 / XSA-195
                              version 3

           x86 64-bit bit test instruction emulation broken

UPDATES IN VERSION 3
====================

Public release.

ISSUE DESCRIPTION
=================

The x86 instructions BT, BTC, BTR, and BTS, when used with a
destination memory operand and a source register rather than an
immediate operand, access a memory location offset from that specified
by the memory operand as specified by the high bits of the register
source.

When Xen needs to emulate such an instruction, to efficiently handle
the emulation, the memory address and register operand are
recalculated internally to Xen.  In this process, the high bits of an
intermediate expression were discarded, leading to both the memory
location and the register operand being wrong.

The wrong memory location would have only a guest local effect (either
access to an unintended location, or a fault delivered to the guest),
whereas the wrong register value could lead to either a host crash or
an unintended host memory access.

IMPACT
======

A malicious guest can modify arbitrary memory, allowing for arbitrary
code execution (and therefore privilege escalation affecting the whole
host), a crash of the host (leading to a DoS), or information leaks.

The vulnerability is sometimes exploitable by unprivileged guest user
processes.

VULNERABLE SYSTEMS
==================

All Xen versions are affected.

The vulnerability is only exposed to x86 guests running in 64-bit mode.

On Xen 4.6 and earlier the vulnerability is exposed to all guest user
processes, including unprivileged processes, in such guests.

On Xen 4.7 and later, the vulnerability is exposed only to guest user
processes granted a degree of privilege (such as direct hardware
access) by the guest administrator; or, to all user processes when the
when the VM has been explicitly configured with a non-default cpu
vendor string (in xm/xl, this would be done with a `cpuid=' domain
config option).

The vulnerability is not exposed to 32-bit PV guests.

ARM systems are not vulnerable.

MITIGATION
==========

There is no known mitigation.

CREDITS
=======

This issue was discovered by George Dunlap of Citrix, using American
Fuzzy Lop v2.35b.

RESOLUTION
==========

Applying the attached patch resolves this issue.

xsa195.patch       xen-unstable, Xen 4.7.x, Xen 4.6.x, Xen 4.5.x, Xen 4.4.x

$ sha256sum xsa195*
[6ab5f13b81e3bbf6096020f4c3beeffaff67a075cab67e033ba27d199b41cec1  xsa195.patch](xsa195.patch)
$

DEPLOYMENT DURING EMBARGO
=========================

Deployment of the patches and/or mitigations described above (or
others which are substantially similar) is permitted during the
embargo, even on public-facing systems with untrusted guest users and
administrators.

But: Distribution of updated software is prohibited (except to other
members of the predisclosure list).

Predisclosure list members who wish to deploy significantly different
patches and/or mitigations, please contact the Xen Project Security
Team.

(Note: this during-embargo deployment notice is retained in
post-embargo publicly released Xen Project advisories, even though it
is then no longer applicable.  This is to enable the community to have
oversight of the Xen Project Security Team's decisionmaking.)

For more information about permissible uses of embargoed information,
consult the Xen Project community's agreed Security Policy:
  <http://www.xenproject.org/security-policy.html>
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBAgAGBQJYNDL4AAoJEIP+FMlX6CvZnzYH/RtmqS8kpqLKShvrQx5Ueh+M
LaHBWJiU0z1m9FaF9RvEgfvWpUCcD/qyC4rLHmkwhkyS6aIToh2XVXzQyebIqw/7
CCDXaY8TkYlLPYRdNseX5X5blpu1EnqW5yQMJz6QkgDK+Qu4F1jDimSd5JffrFkJ
WkpWwsoppNHwYyaENq59lg7R1WxNq0uSLxMPTnk/RpMmizKyU8gK7RrQWHJNoy6n
l3vSTKx9sCDo+AgMQgbDMdpvv1l1It+QcRXXBrBp7qAdz+0H7VRkUFOnBUFMQQo3
OjmjStKxnE9E7Uh6+373xj2Z6Nts+wkD72vRHHg/1KTZ5FN5XnS2CvPDNuGZD50=
=AtOu
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team

