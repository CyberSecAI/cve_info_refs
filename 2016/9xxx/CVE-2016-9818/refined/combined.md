=== Content from xenbits.xen.org_06184aaa_20250125_055349.html ===
From: Wei Chen
Subject: arm32: handle async aborts delivered while at HYP
If guest generates an asynchronous abort and then traps into HYP
(by HVC or IRQ) before the abort has been delivered, the hypervisor
could not catch it, because the PSTATE.A bit is masked all the time
in hypervisor. So this asynchronous abort may be slipped to next
running guest with PSTATE.A bit unmasked.
In order to avoid this, it is necessary to take the abort at HYP, by
clearing the PSTATE.A bit. In this patch, we unmask the PSTATE.A bit
to open a window to catch guest-generated asynchronous abort in all
Guest -> HYP switch paths. If we caught such asynchronous abort in
checking window, the HYP data abort exception will be triggered and
the abort source guest will be crashed.
This is CVE-2016-9818, part of XSA-201.
Signed-off-by: Wei Chen
Reviewed-by: Julien Grall
--- a/xen/arch/arm/arm32/entry.S
+++ b/xen/arch/arm/arm32/entry.S
@@ -42,6 +42,61 @@ save\_guest\_regs:
SAVE\_BANKED(fiq)
SAVE\_ONE\_BANKED(R8\_fiq); SAVE\_ONE\_BANKED(R9\_fiq); SAVE\_ONE\_BANKED(R10\_fiq)
SAVE\_ONE\_BANKED(R11\_fiq); SAVE\_ONE\_BANKED(R12\_fiq);
+ /\*
+ \* Start to check pending virtual abort in the gap of Guest -> HYP
+ \* world switch.
+ \*
+ \* Save ELR\_hyp to check whether the pending virtual abort exception
+ \* takes place while we are doing this trap exception.
+ \*/
+ mrs r1, ELR\_hyp
+
+ /\*
+ \* Force loads and stores to complete before unmasking asynchronous
+ \* aborts and forcing the delivery of the exception.
+ \*/
+ dsb sy
+
+ /\*
+ \* Unmask asynchronous abort bit. If there is a pending asynchronous
+ \* abort, the data\_abort exception will happen after A bit is cleared.
+ \*/
+ cpsie a
+
+ /\*
+ \* This is our single instruction exception window. A pending
+ \* asynchronous abort is guaranteed to occur at the earliest when we
+ \* unmask it, and at the latest just after the ISB.
+ \*
+ \* If a pending abort occurs, the program will jump to data\_abort
+ \* exception handler, and the ELR\_hyp will be set to
+ \* abort\_guest\_exit\_start or abort\_guest\_exit\_end.
+ \*/
+ .global abort\_guest\_exit\_start
+abort\_guest\_exit\_start:
+
+ isb
+
+ .global abort\_guest\_exit\_end
+abort\_guest\_exit\_end:
+ /\* Mask CPSR asynchronous abort bit, close the checking window. \*/
+ cpsid a
+
+ /\*
+ \* Compare ELR\_hyp and the saved value to check whether we are
+ \* returning from a valid exception caused by pending virtual
+ \* abort.
+ \*/
+ mrs r2, ELR\_hyp
+ cmp r1, r2
+
+ /\*
+ \* Not equal, the pending virtual abort exception took place, the
+ \* initial exception does not have any significance to be handled.
+ \* Exit ASAP.
+ \*/
+ bne return\_from\_trap
+
mov pc, lr
#define DEFINE\_TRAP\_ENTRY(trap) \
--- a/xen/arch/arm/arm32/traps.c
+++ b/xen/arch/arm/arm32/traps.c
@@ -63,7 +63,10 @@ asmlinkage void do\_trap\_prefetch\_abort(struct cpu\_user\_regs \*regs)
asmlinkage void do\_trap\_data\_abort(struct cpu\_user\_regs \*regs)
{
- do\_unexpected\_trap("Data Abort", regs);
+ if ( VABORT\_GEN\_BY\_GUEST(regs) )
+ do\_trap\_guest\_error(regs);
+ else
+ do\_unexpected\_trap("Data Abort", regs);
}
/\*
--- a/xen/include/asm-arm/arm32/processor.h
+++ b/xen/include/asm-arm/arm32/processor.h
@@ -55,6 +55,17 @@ struct cpu\_user\_regs
uint32\_t pad1; /\* Doubleword-align the user half of the frame \*/
};
+
+/\* Functions for pending virtual abort checking window. \*/
+void abort\_guest\_exit\_start(void);
+void abort\_guest\_exit\_end(void);
+
+#define VABORT\_GEN\_BY\_GUEST(r) \
+( \
+ ( (unsigned long)abort\_guest\_exit\_start == (r)->pc ) || \
+ ( (unsigned long)abort\_guest\_exit\_end == (r)->pc ) \
+)
+
#endif
/\* Layout as used in assembly, with src/dest registers mixed in \*/
--- a/xen/include/asm-arm/processor.h
+++ b/xen/include/asm-arm/processor.h
@@ -690,6 +690,8 @@ void vcpu\_regs\_user\_to\_hyp(struct vcpu \*vcpu,
int call\_smc(register\_t function\_id, register\_t arg0, register\_t arg1,
register\_t arg2);
+void do\_trap\_guest\_error(struct cpu\_user\_regs \*regs);
+
#endif /\* \_\_ASSEMBLY\_\_ \*/
#endif /\* \_\_ASM\_ARM\_PROCESSOR\_H \*/
/\*


=== Content from www.openwall.com_370e9ae2_20250125_055348.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](2) [[next>]](4) [[thread-next>]](../../../2016/12/05/7) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <E1cBjhk-0000Fg-Ct@xenbits.xenproject.org>
Date: Tue, 29 Nov 2016 14:48:20 +0000
From: Xen.org security team <security@....org>
To: xen-announce@...ts.xen.org, xen-devel@...ts.xen.org,
 xen-users@...ts.xen.org, oss-security@...ts.openwall.com
CC: Xen.org security team <security@....org>
Subject: Xen Security Advisory 201 - ARM guests may induce host
 asynchronous abort

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA1

                    Xen Security Advisory XSA-201

             ARM guests may induce host asynchronous abort

ISSUE DESCRIPTION
=================

Depending on how the hardware and firmware have been integrated,
guest-triggered asynchronous aborts (SError on ARMv8) may be received
by the hypervisor.  The current action is to crash the host.

A guest might trigger an asynchronous abort when accessing memory
mapped hardware in a non-conventional way.  Even if device
pass-through has not been configured, the hypervisor may give the
guest access to memory mapped hardware in order to take advantage of
hardware virtualization.

IMPACT
======

A malicious guest may be able to crash the host.

VULNERABLE SYSTEMS
==================

All Xen versions which support ARM are potentially affected.

Whether a particular ARM systems is affected depends on technical
details of the hardware and/or firmware.

x86 systems are not affected.

MITIGATION
==========

On systems where the guest kernel is controlled by the host rather than
guest administrator, running only kernels which do not expose MMIO to
userspace will prevent untrusted guest users from exploiting this issue.
However untrusted guest administrators can still trigger it unless
further steps are taken to prevent them from loading code into the
kernel (e.g by disabling loadable modules etc) or from using other
mechanisms which allow them to run code at kernel privilege.

NOTE REGARDING LACK OF EMBARGO
==============================

The issue was discussed publicly (and has been fixed already in KVM in
public trees).

CREDITS
=======

This issue was discovered by ARM engineering personnel.

RESOLUTION
==========

Applying the appropriate set of attached patched resolves this issue.

xsa201-[1234].patch       Xen-unstable

xsa201-[12].patch         }
xsa201-3-4.7.patch        } Xen 4.7.x, Xen 4.6.x
xsa201-4.patch            }

$ sha256sum xsa201*
ffdefdaa67748df7fccbc82011202724c622ca432cd121853ecab45ff4657406  xsa201-1.patch
0665eb575b056f98d5330ef23f497b2b3de1a15319e2012005890a17df32a7ed  xsa201-2.patch
4486d5efb59c1f1fff04a3cb697f948d5bf680e2a1c0d76cd44382ad8fa9095e  xsa201-3.patch
ca82c82acd51bf3cb8114d1843519c28e3df26243bd45eb712ff10ba11061b93  xsa201-3-4.7.patch
1de6ddb4b5b46ae390ec4587e588c00a706f4a68365d379db7ad54234f770d48  xsa201-4.patch
$
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQEcBAEBAgAGBQJYPZSoAAoJEIP+FMlX6CvZ2zoH/ivzE70xsLHYJUxveoBiFuiU
KHFzF0X63G681FjLyU4SY2GkH5K9YutJ1uaakp+peD96fQqCXBHxWUMPAfblnd7t
YueMYuFqcz3mE2ypJjBh/fdI8a4UrKHHg3z6Hw6X91p+SRmPsnt9v7OzytoYOiE4
fDeaATwl1LxB+Z/yJETlo/JMgwrtuYZ9EZM9gIzxdOVw+QbQyEYHmuIyni8BNRvZ
+biRRQo37K5+jLY3f/RoXKcpqnHqjKOOmfjkxJJAsxqpdTSw5fRJqSZE4G5oUVs2
AAvSKhLObFahMlPqtoNXSC6lG5Gbd3e/h+6N2N/96TXs6Wr+d0VuC+lkYUjwcJk=
=KEYF
-----END PGP SIGNATURE-----

Download attachment "[xsa201-1.patch](3/1)" of type "application/octet-stream" (3078 bytes)

Download attachment "[xsa201-2.patch](3/2)" of type "application/octet-stream" (6453 bytes)

Download attachment "[xsa201-3.patch](3/3)" of type "application/octet-stream" (1658 bytes)

Download attachment "[xsa201-3-4.7.patch](3/4)" of type "application/octet-stream" (1635 bytes)

Download attachment "[xsa201-4.patch](3/5)" of type "application/octet-stream" (4469 bytes)

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from security.gentoo.org_1305b977_20250125_055349.html ===

[![Gentoo](https://assets.gentoo.org/tyrian/v2/site-logo.png)](/ "Back to the homepage")
Security

[**Get Gentoo!**](https://get.gentoo.org/)
gentoo.org sites
[gentoo.org](https://www.gentoo.org/ "Main Gentoo website")
[Wiki](https://wiki.gentoo.org/ "Find and contribute documentation")
[Bugs](https://bugs.gentoo.org/ "Report issues and find common issues")
[Forums](https://forums.gentoo.org/ "Discuss with the community")
[Packages](https://packages.gentoo.org/ "Find software for your Gentoo")

[Planet](https://planet.gentoo.org/ "Find out what's going on in the developer community")
[Archives](https://archives.gentoo.org/ "Read up on past discussions")
[Sources](https://sources.gentoo.org/ "Browse our source code")

[Infra Status](https://infra-status.gentoo.org/ "Get updates on the services provided by Gentoo")

* [Home](/)
* [Stay informed](/subscribe)
* [Advisories](/glsa)

# Xen: Multiple vulnerabilities — GLSA **201612-56**

Multiple vulnerabilities have been found in Xen, the worst of which
could lead to the execution of arbitrary code on the host system.

### Affected packages

| Package | **app-emulation/xen** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r4** |
| Unaffected versions | >= **4.7.1-r4** |

| Package | **app-emulation/xen-tools** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r4** |
| Unaffected versions | >= **4.7.1-r4** |

| Package | **app-emulation/xen-pvgrub** on all architectures |
| --- | --- |
| Affected versions | < **4.7.1-r1** |
| Unaffected versions | >= **4.7.1-r1** |

### Background

Xen is a bare-metal hypervisor.

### Description

Multiple vulnerabilities have been discovered in Xen. Please review the
CVE identifiers referenced below for details.

### Impact

A local attacker could possibly execute arbitrary code with the
privileges of the process, could gain privileges on the host system,
cause a Denial of Service condition, or obtain sensitive information.

### Workaround

There is no known workaround at this time.

### Resolution

All Xen users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose ">=app-emulation/xen-4.7.1-r4"

```

All Xen Tools users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-tools-4.7.1-r4"

```

All Xen PvGrub users should upgrade to the latest version:

```
 # emerge --sync
 # emerge --ask --oneshot --verbose
 ">=app-emulation/xen-pvgrub-4.7.1-r1"

```
### References

* [CVE-2016-10024](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-10024)
* [CVE-2016-9377](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9377)
* [CVE-2016-9378](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9378)
* [CVE-2016-9379](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9379)
* [CVE-2016-9380](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9380)
* [CVE-2016-9381](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9381)
* [CVE-2016-9382](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9382)
* [CVE-2016-9383](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9383)
* [CVE-2016-9384](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9384)
* [CVE-2016-9385](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9385)
* [CVE-2016-9386](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9386)
* [CVE-2016-9637](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9637)
* [CVE-2016-9815](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9815)
* [CVE-2016-9816](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9816)
* [CVE-2016-9817](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9817)
* [CVE-2016-9818](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9818)
* [CVE-2016-9932](https://nvd.nist.gov/nvd.cfm?cvename=CVE-2016-9932)

**Release date**

December 31, 2016

**Latest revision**

January 03, 2017: 2

**Severity**

normal

**Exploitable**

local

**Bugzilla entries**

* [600382](https://bugs.gentoo.org/show_bug.cgi?id=600382)
* [600662](https://bugs.gentoo.org/show_bug.cgi?id=600662)
* [601248](https://bugs.gentoo.org/show_bug.cgi?id=601248)
* [601250](https://bugs.gentoo.org/show_bug.cgi?id=601250)
* [601986](https://bugs.gentoo.org/show_bug.cgi?id=601986)
* [603420](https://bugs.gentoo.org/show_bug.cgi?id=603420)

### Questions or comments?

Please feel free to contact us.

**© 2001–2020 Gentoo Foundation, Inc.**



=== Content from www.openwall.com_dbd5d7d2_20250125_055348.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Follow @Openwall on Twitter for new release announcements and other news](https://twitter.com/openwall) | | --- | |
| --- | --- |

[[<prev]](6) [[next>]](8) [[<thread-prev]](../../../2016/11/29/3) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <e510445958b0452499da785a4d64ab4b@imshyb02.MITRE.ORG>
Date: Sun, 4 Dec 2016 22:21:05 -0500
From: <cve-assign@...re.org>
To: <security@....org>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>
Subject: Re: Xen Security Advisory 201 - ARM guests may induce host asynchronous abort

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> A malicious guest may be able to crash the host.

> x86 systems are not affected.

> ffdefdaa67748df7fccbc82011202724c622ca432cd121853ecab45ff4657406  xsa201-1.patch

Use CVE-2016-9815.

> 0665eb575b056f98d5330ef23f497b2b3de1a15319e2012005890a17df32a7ed  xsa201-2.patch

Use CVE-2016-9816.

> 4486d5efb59c1f1fff04a3cb697f948d5bf680e2a1c0d76cd44382ad8fa9095e  xsa201-3.patch
> ca82c82acd51bf3cb8114d1843519c28e3df26243bd45eb712ff10ba11061b93  xsa201-3-4.7.patch

Use CVE-2016-9817.

> 1de6ddb4b5b46ae390ec4587e588c00a706f4a68365d379db7ad54234f770d48  xsa201-4.patch

Use CVE-2016-9818.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYRNkEAAoJEHb/MwWLVhi2qkoP+gPLRp8bs5dFIQelz0NUnFgh
TVuE883HifFhNiWgAk+L7D7+COlgqJcK+SChwjdCtfMTMfLUv6KRUJGExd3lXmqF
AZ9cJr1Qfp0xGStwdyeOTXi6mHnQAdr4zw8em2rQQE72quJSesxhm9I2LOLGnWAr
2zq5TZeAPmu27wdzkT+nakz7XWyD8ecxlypRhCn+Y1aCWi/KMME4blEsjGGW7+vU
RoXbPyB1eF5bVhq6PQA2mnyZw8X2r02xUux0TACbNvG3SCa2DvlVVMOTitBbmmUv
rL4ptE71hKfhV5uds7Ptf+hJNJLLBwRemjQ1cd+j7iTRC2Mb4TUOr5kKYAHaZRxi
C25wKWjpM8957eeS7+EnY3o7XYfI0fVRLgyZNKDinuJUUAqEgtLVMyMu7coUsWCr
Yl68yJ6je392WmQmW3fffHk4d3Rl/GnVVOQy3qnVTcLZp2McM67IwCnHDFqBMRwb
6mGN6nc2MPSDPhZgOb5nmR44ho/JjSJoHYktudamJIEhr4WTpZuoKnUIOadQyc91
x/WFi/IVarv06SN4OEfT/grE0ujZmBnlefdLmee5R247V5E52unS4g/z1CNqTgNm
X+u7bfvxbxIzZf8GdtJrf98apo9mDcdwfmdRuuPSUOG13ySlKxj8SY/3NSE6o30j
4XyiforlM4vWauldBk3V
=OdPm
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from xenbits.xen.org_9fdf5bcd_20250125_055348.html ===

# Information

| Advisory | [XSA-201](advisory-201.html) |
| --- | --- |
| Public release | 2016-11-29 14:48 |
| Updated | 2023-12-15 15:35 |
| Version | 3 |
| CVE(s) | [CVE-2016-9815](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9815) [CVE-2016-9816](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9816) [CVE-2016-9817](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9817) [CVE-2016-9818](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9818) |
| Title | ARM guests may induce host asynchronous abort |

# Files

<advisory-201.txt> (signed advisory file)

<xsa201-1.patch>

<xsa201-2.patch>

<xsa201-3.patch>

<xsa201-3-4.7.patch>

<xsa201-4.patch>
# Advisory

---

```

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

 Xen Security Advisory CVE-2016-9815,CVE-2016-9816,CVE-2016-9817,CVE-2016-9818 / XSA-201
                                        version 3

             ARM guests may induce host asynchronous abort

UPDATES IN VERSION 3
====================

Normalize version tags.

ISSUE DESCRIPTION
=================

Depending on how the hardware and firmware have been integrated,
guest-triggered asynchronous aborts (SError on ARMv8) may be received
by the hypervisor.  The current action is to crash the host.

A guest might trigger an asynchronous abort when accessing memory
mapped hardware in a non-conventional way.  Even if device
pass-through has not been configured, the hypervisor may give the
guest access to memory mapped hardware in order to take advantage of
hardware virtualization.

The CVEs are as follows:
 xsa201-1.patch     CVE-2016-9815
 xsa201-2.patch     CVE-2016-9816
 xsa201-3-*.patch   CVE-2016-9817
 xsa201-4.patch     CVE-2016-9818

IMPACT
======

A malicious guest may be able to crash the host.

VULNERABLE SYSTEMS
==================

All Xen versions which support ARM are potentially affected.

Whether a particular ARM systems is affected depends on technical
details of the hardware and/or firmware.

x86 systems are not affected.

MITIGATION
==========

On systems where the guest kernel is controlled by the host rather than
guest administrator, running only kernels which do not expose MMIO to
userspace will prevent untrusted guest users from exploiting this issue.
However untrusted guest administrators can still trigger it unless
further steps are taken to prevent them from loading code into the
kernel (e.g by disabling loadable modules etc) or from using other
mechanisms which allow them to run code at kernel privilege.

NOTE REGARDING LACK OF EMBARGO
==============================

The issue was discussed publicly (and has been fixed already in KVM in
public trees).

CREDITS
=======

This issue was discovered by ARM engineering personnel.

RESOLUTION
==========

Applying the appropriate set of attached patched resolves this issue.

xsa201-[1234].patch                                    xen-unstable
xsa201-[12].patch, xsa201-3-4.7.patch, xsa201-4.patch  Xen 4.7.x, Xen 4.6.x

$ sha256sum xsa201*
[163aeb9ae3ffce28e0bc95bdfff490d2df6f6f0b85ac1d4f447bea921f0a0dda  xsa201-1.patch](xsa201-1.patch)
[0ba570ed7df172475bc745e02b89670608251634895e5279edcf534619d6d81b  xsa201-2.patch](xsa201-2.patch)
[4045e046473f069c51e5fd579f63563862aa497d945b183c768481ef11885744  xsa201-3.patch](xsa201-3.patch)
[a9cf56564d020675c0f2f1ea15009a712f172be3d53ea8ddf2f48adaac392e76  xsa201-3-4.7.patch](xsa201-3-4.7.patch)
[388d548cd4e30883ae100863d33e792869e7dbd86054299a91b64db6d6599919  xsa201-4.patch](xsa201-4.patch)
$
-----BEGIN PGP SIGNATURE-----

iQFABAEBCAAqFiEEI+MiLBRfRHX6gGCng/4UyVfoK9kFAmV8b/UMHHBncEB4ZW4u
b3JnAAoJEIP+FMlX6CvZ1ssIAMiGSDkQVOSFkY6ru8yrTvxD0OwispGpkmU4exzk
fD2vzZ4pvhFlIffOA/D7uLlQ6StS7IwCBXdCrT3t3Ivqxksl/0f5cTESAkrx9zMK
X7RHYYwFl5P0gIvnCfhi194UNSRlJZKzxkNej6/3tXfFpdnhDdO8MFTFpR9l2A0O
fhbzNBjVjZEQFsvNGXyy1sQql3S85wJaTObJqDAnOm/wg2uvllYKIEEzXSszMTvc
B7Qnnrjp30ewBf++42VhAB70j0GN8G0WD1X2hoEjCd+fyvsefjH6SMmyz/pW8VTG
fOfJRbdJhitvDltxA40n3ZXAskWGXdcrv8hFpKJ7g0EshpY=
=JhUi
-----END PGP SIGNATURE-----

```

---

Xenproject.org Security Team

