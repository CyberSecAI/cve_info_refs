=== Content from github.com_30272c7f_20250126_074453.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F847941390f5b3310d51b07c92ec91cc1f4cc82c9)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F847941390f5b3310d51b07c92ec91cc1f4cc82c9)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=revive-adserver%2Frevive-adserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[revive-adserver](/revive-adserver)
/
**[revive-adserver](/revive-adserver/revive-adserver)**
Public

* [Notifications](/login?return_to=%2Frevive-adserver%2Frevive-adserver) You must be signed in to change notification settings
* [Fork
  568](/login?return_to=%2Frevive-adserver%2Frevive-adserver)
* [Star
   1.3k](/login?return_to=%2Frevive-adserver%2Frevive-adserver)

* [Code](/revive-adserver/revive-adserver)
* [Issues
  153](/revive-adserver/revive-adserver/issues)
* [Pull requests
  23](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

Additional navigation options

* [Code](/revive-adserver/revive-adserver)
* [Issues](/revive-adserver/revive-adserver/issues)
* [Pull requests](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

## Commit

[Permalink](/revive-adserver/revive-adserver/commit/847941390f5b3310d51b07c92ec91cc1f4cc82c9)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Mitigate h1 report 96115

[Browse files](/revive-adserver/revive-adserver/tree/847941390f5b3310d51b07c92ec91cc1f4cc82c9)
Browse the repository at this point in the history

```
Improper Restriction of Excessive Authentication Attempts
---------------------------------------------------------

Karan M. Tank and Smit B. Shah have reported via HackerOne that the login
page of Revive Adserver was vulnerable to password-guessing attacks. An
account lockdown feature was taken into account, but rejected to avoid
introducing service disruptions to regular users during such attacks.
A random delay has been introduced as a counter-measure in case of password
failures, along with a system to discourage parallel brute forcing. Such
system will effectively allow the actual user to log in to the adserver even
while an attack is in progress.

A CVE-ID has been requested, but not assigned yet.

CWE: CWE-307
CVSSv2: 8.5 (AV:N/AC:L/Au:N/C:C/I:P/A:N)
```

* Loading branch information

[![@mbeccati](https://avatars.githubusercontent.com/u/282388?s=40&v=4)](/mbeccati)

[mbeccati](/revive-adserver/revive-adserver/commits?author=mbeccati "View all commits by mbeccati")
committed
Feb 10, 2016

1 parent
[0e79cd6](/revive-adserver/revive-adserver/commit/0e79cd6a05b4c48c461dee3f6ae2bfce3a75913b)

commit 8479413

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**47 additions**
and
**5 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + OA

    - lib/OA/Auth.php
      [Auth.php](#diff-45c9c0ee92d5a4f6317c448982a58ac85c06298c9e26e275e49d6f71d204d747)
  + OX/Extension/authentication

    - lib/OX/Extension/authentication/authentication.php
      [authentication.php](#diff-6c577c42448aaf0fc93f96f8e9e106bbeef66130eb478e5c1ab2e2ada9707b4a)

## There are no files selected for viewing

1 change: 0 additions & 1 deletion

1
[lib/OA/Auth.php](#diff-45c9c0ee92d5a4f6317c448982a58ac85c06298c9e26e275e49d6f71d204d747 "lib/OA/Auth.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/847941390f5b3310d51b07c92ec91cc1f4cc82c9/lib/OA/Auth.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -83,7 +83,6 @@ function login($redirectCallback = null) |
|  |  | $doUser = OA\_Auth::authenticateUser(); |
|  |  |  |
|  |  | if (!$doUser) { |
|  |  | sleep(3); |
|  |  | OA\_Auth::restart($GLOBALS['strUsernameOrPasswordWrong']); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

51 changes: 47 additions & 4 deletions

51
[lib/OX/Extension/authentication/authentication.php](#diff-6c577c42448aaf0fc93f96f8e9e106bbeef66130eb478e5c1ab2e2ada9707b4a "lib/OX/Extension/authentication/authentication.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/847941390f5b3310d51b07c92ec91cc1f4cc82c9/lib/OX/Extension/authentication/authentication.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -15,6 +15,7 @@ |
|  |  | require\_once 'Date.php'; |
|  |  | require\_once MAX\_PATH . '/lib/max/language/Loader.php'; |
|  |  | require\_once MAX\_PATH . '/lib/pear/HTML/QuickForm/Rule/Email.php'; |
|  |  | require\_once MAX\_PATH . '/lib/OA/DB/AdvisoryLock.php'; |
|  |  |  |
|  |  | Language\_Loader::load('settings'); |
|  |  |  |
| Expand Down  Expand Up | | @@ -98,16 +99,55 @@ function \_getCredentials($performCookieCheck = true) |
|  |  | \*/ |
|  |  | function checkPassword($username, $password) |
|  |  | { |
|  |  | // Introduce a random delay in case of failures, as recommended by: |
|  |  | // https://www.owasp.org/index.php/Blocking\_Brute\_Force\_Attacks |
|  |  | // |
|  |  | // The base delay is 1-5 seconds. |
|  |  | $waitMs = mt\_rand(1000, 5000); |
|  |  |  |
|  |  | $oLock = OA\_DB\_AdvisoryLock::factory(); |
|  |  |  |
|  |  | // Username check is case insensitive |
|  |  | $username = strtolower($username); |
|  |  |  |
|  |  | // Try to acquire an excusive advisory lock for the username |
|  |  | $lock = $oLock->get('auth.'.md5($username)); |
|  |  |  |
|  |  | if (!$lock) { |
|  |  | // We couldn't acquire the lock immediately, which means that |
|  |  | // another authentication process for the same username is underway. |
|  |  | // |
|  |  | // This might mean that the account is being targeted by a |
|  |  | // multi-threaded brute force attack, so we try to discourage such |
|  |  | // behaviour by increasing the delay time by 4x. |
|  |  | // |
|  |  | // However, if the actual user tries to log in while their account |
|  |  | // is being attacked, we will allow them in, they'd just have to |
|  |  | // be patient (max 20 seconds). |
|  |  | usleep($waitMs \* 4000); |
|  |  | } |
|  |  |  |
|  |  | $doUser = OA\_Dal::factoryDO('users'); |
|  |  | $doUser->username = strtolower($username); |
|  |  | $doUser->username = $username; |
|  |  | $doUser->password = md5($password); |
|  |  |  |
|  |  | $doUser->find(); |
|  |  |  |
|  |  | if ($doUser->fetch()) { |
|  |  | $oLock->release(); |
|  |  |  |
|  |  | return $doUser; |
|  |  | } else { |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | if ($lock) { |
|  |  | // The password was wrong, but no other login attempt was in place |
|  |  | // so we apply just the base delay time. |
|  |  | usleep($waitMs \* 1000); |
|  |  | } |
|  |  |  |
|  |  | $oLock->release(); |
|  |  |  |
|  |  | return false; |
|  |  | } |
|  |  |  |
|  |  | /\*\* |
| Expand Down  Expand Up | | @@ -517,4 +557,7 @@ function validateUsersData($data) |
|  |  | } |
|  |  | } |
|  |  |  |
|  |  | ?> |
|  |  |  |
|  |  | class Plugins\_Authentication\_Exception extends Exception |
|  |  | { |
|  |  | } |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `8479413`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F847941390f5b3310d51b07c92ec91cc1f4cc82c9) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from github.com_cb89ab2f_20250125_091836.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F4910365631eabbb208961c36149f41cc8159fb39)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F4910365631eabbb208961c36149f41cc8159fb39)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=revive-adserver%2Frevive-adserver)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[revive-adserver](/revive-adserver)
/
**[revive-adserver](/revive-adserver/revive-adserver)**
Public

* [Notifications](/login?return_to=%2Frevive-adserver%2Frevive-adserver) You must be signed in to change notification settings
* [Fork
  568](/login?return_to=%2Frevive-adserver%2Frevive-adserver)
* [Star
   1.3k](/login?return_to=%2Frevive-adserver%2Frevive-adserver)

* [Code](/revive-adserver/revive-adserver)
* [Issues
  153](/revive-adserver/revive-adserver/issues)
* [Pull requests
  23](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

Additional navigation options

* [Code](/revive-adserver/revive-adserver)
* [Issues](/revive-adserver/revive-adserver/issues)
* [Pull requests](/revive-adserver/revive-adserver/pulls)
* [Actions](/revive-adserver/revive-adserver/actions)
* [Security](/revive-adserver/revive-adserver/security)
* [Insights](/revive-adserver/revive-adserver/pulse)

## Commit

[Permalink](/revive-adserver/revive-adserver/commit/4910365631eabbb208961c36149f41cc8159fb39)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

Fix h1 reports 93809 and 93813

[Browse files](/revive-adserver/revive-adserver/tree/4910365631eabbb208961c36149f41cc8159fb39)
Browse the repository at this point in the history

```
Session Fixation
----------------

The HackerOne users kaviya and Kamini Singh have independendltly reported
that Revive Adserver was vulnerable to session fixation, by allowing arbitrary
session identifiers to be forced and at the same time by not invalidating the
existing session upon a successful authentication. Under some circumstances,
that could have been an opportunity for an attacker to steal an authenticated
sessions.

A CVE-ID has been requested, but not assigned yet.

CWE: CWE-384
CVSSv2: 7.8 (AV:N/AC:M/Au:N/C:C/I:P/A:N)
```

* Loading branch information

[![@mbeccati](https://avatars.githubusercontent.com/u/282388?s=40&v=4)](/mbeccati)

[mbeccati](/revive-adserver/revive-adserver/commits?author=mbeccati "View all commits by mbeccati")
committed
Mar 1, 2016

1 parent
[8479413](/revive-adserver/revive-adserver/commit/847941390f5b3310d51b07c92ec91cc1f4cc82c9)

commit 4910365

 Show file tree

 Hide file tree

Showing
**6 changed files**
with
**85 additions**
and
**20 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* lib

  + OA

    - lib/OA/Auth.php
      [Auth.php](#diff-45c9c0ee92d5a4f6317c448982a58ac85c06298c9e26e275e49d6f71d204d747)
    - Upgrade

      * lib/OA/Upgrade/Login.php
        [Login.php](#diff-bdcae1e16d59513f62d89f0b641f9c4e51952a74eb5587cbef184dc0deb72440)
  + max/Dal/Admin

    - lib/max/Dal/Admin/Session.php
      [Session.php](#diff-abf098d006baa937a7bce5f927db0bf4d7e507cbcee317660b9138bb9ef2ec6e)
* www

  + admin

    - www/admin/lib-sessions.inc.php
      [lib-sessions.inc.php](#diff-72b8c1863b49e63e073d913ff56f38d52de3622c153173b149b5ddb49b1a1336)
  + api

    - v1/xmlrpc

      * www/api/v1/xmlrpc/LogonServiceImpl.php
        [LogonServiceImpl.php](#diff-6a54610969fa7a4537d4a41c8562b2e9ac6f84afc7dce05da2ca11c4070a4108)
    - v2/xmlrpc

      * www/api/v2/xmlrpc/LogonServiceImpl.php
        [LogonServiceImpl.php](#diff-9d2794de288b720bf5c71249d71b25f18592d67ca98c7889e000faf299abd6ef)

## There are no files selected for viewing

5 changes: 4 additions & 1 deletion

5
[lib/OA/Auth.php](#diff-45c9c0ee92d5a4f6317c448982a58ac85c06298c9e26e275e49d6f71d204d747 "lib/OA/Auth.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/4910365631eabbb208961c36149f41cc8159fb39/lib/OA/Auth.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -86,6 +86,9 @@ function login($redirectCallback = null) |
|  |  | OA\_Auth::restart($GLOBALS['strUsernameOrPasswordWrong']); |
|  |  | } |
|  |  |  |
|  |  | // Regenerate session ID now |
|  |  | phpAds\_SessionRegenerateId(); |
|  |  |  |
|  |  | return OA\_Auth::getSessionData($doUser); |
|  |  | } |
|  |  |  |
| Expand Down  Expand Up | | @@ -190,7 +193,7 @@ function getFakeSessionData() |
|  |  | \*/ |
|  |  | function restart($sMessage = '') |
|  |  | { |
|  |  | $\_COOKIE['sessionID'] = phpAds\_SessionStart(); |
|  |  | $\_COOKIE['sessionID'] = phpAds\_SessionRegenerateId(); |
|  |  | OA\_Auth::displayLogin($sMessage, $\_COOKIE['sessionID']); |
|  |  | } |
|  |  |  |
| Expand Down | |  |

7 changes: 6 additions & 1 deletion

7
[lib/OA/Upgrade/Login.php](#diff-bdcae1e16d59513f62d89f0b641f9c4e51952a74eb5587cbef184dc0deb72440 "lib/OA/Upgrade/Login.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/4910365631eabbb208961c36149f41cc8159fb39/lib/OA/Upgrade/Login.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -25,7 +25,7 @@ class OA\_Upgrade\_Login |
|  |  | function checkLogin() |
|  |  | { |
|  |  | // Clean up session |
|  |  | $GLOBALS['session'] = array(); |
|  |  | phpAds\_clearSession(); |
|  |  |  |
|  |  | // Detection needs to happen every time to make sure that database parameters are |
|  |  | $oUpgrader = new OA\_Upgrade(); |
| Expand Down  Expand Up | | @@ -93,6 +93,7 @@ function autoLogin() |
|  |  | $doUser->joinAdd($doAUA); |
|  |  | $doUser->find(); |
|  |  | if ($doUser->fetch()) { |
|  |  | phpAds\_SessionRegenerateId(); |
|  |  | phpAds\_SessionDataRegister(OA\_Auth::getSessionData($doUser)); |
|  |  | phpAds\_SessionDataStore(); |
|  |  | } |
| Expand All | | @@ -106,6 +107,8 @@ function \_checkLoginNew() |
|  |  | $aCredentials = $oPlugin->\_getCredentials(false); |
|  |  |  |
|  |  | if (!PEAR::isError($aCredentials)) { |
|  |  | phpAds\_SessionRegenerateId(); |
|  |  |  |
|  |  | $doUser = $oPlugin->checkPassword($aCredentials['username'], $aCredentials['password']); |
|  |  |  |
|  |  | if ($doUser) { |
| Expand Down  Expand Up | | @@ -140,6 +143,8 @@ function \_checkLoginOld($tableName, $agencySupport) |
|  |  | $aCredentials = $oPlugin->\_getCredentials(false); |
|  |  |  |
|  |  | if (!PEAR::isError($aCredentials)) { |
|  |  | phpAds\_SessionRegenerateId(); |
|  |  |  |
|  |  | if (strtolower($aPref['admin']) == strtolower($aCredentials['username']) && |
|  |  | $aPref['admin\_pw'] == md5($aCredentials['password'])) |
|  |  | { |
| Expand Down | |  |

6 changes: 3 additions & 3 deletions

6
[lib/max/Dal/Admin/Session.php](#diff-abf098d006baa937a7bce5f927db0bf4d7e507cbcee317660b9138bb9ef2ec6e "lib/max/Dal/Admin/Session.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/4910365631eabbb208961c36149f41cc8159fb39/lib/max/Dal/Admin/Session.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -76,10 +76,10 @@ function storeSerializedSession($serialized\_session\_data, $session\_id) |
|  |  | if ($doSession) { |
|  |  | $doSession->sessiondata = $serialized\_session\_data; |
|  |  | $doSession->update(); |
|  |  | } |
|  |  | else { |
|  |  | } else { |
|  |  | $doSession = OA\_Dal::factoryDO('session'); |
|  |  | $doSession->sessionid = $session\_id; |
|  |  | // It's an md5, so 32 chars max |
|  |  | $doSession->sessionid = substr($session\_id, 0, 32); |
|  |  | $doSession->sessiondata = $serialized\_session\_data; |
|  |  | $doSession->insert(); |
|  |  | } |
| Expand Down | |  |

81 changes: 68 additions & 13 deletions

81
[www/admin/lib-sessions.inc.php](#diff-72b8c1863b49e63e073d913ff56f38d52de3622c153173b149b5ddb49b1a1336 "www/admin/lib-sessions.inc.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/4910365631eabbb208961c36149f41cc8159fb39/www/admin/lib-sessions.inc.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -30,28 +30,29 @@ |
|  |  | function phpAds\_SessionDataFetch() |
|  |  | { |
|  |  | global $session; |
|  |  | $dal = new MAX\_Dal\_Admin\_Session(); |
|  |  |  |
|  |  | // Guard clause: Can't fetch a session without an ID |
|  |  | if (empty($\_COOKIE['sessionID'])) { |
|  |  | if (empty($\_COOKIE['sessionID']) || !preg\_match('#^[0-9a-f]{32}$#D', $\_COOKIE['sessionID'])) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | $dal = new MAX\_Dal\_Admin\_Session(); |
|  |  | $serialized\_session = $dal->getSerializedSession($\_COOKIE['sessionID']); |
|  |  |  |
|  |  | // This is required because 'sessionID' cookie is set to new during logout. |
|  |  | // According to comments in the file it is because some servers do not |
|  |  | // support setting cookies during redirect. |
|  |  | if (empty($serialized\_session)) { |
|  |  | // Return if the session was not found (expired or forged) |
|  |  | if (!$serialized\_session) { |
|  |  | return; |
|  |  | } |
|  |  |  |
|  |  | $loaded\_session = unserialize($serialized\_session); |
|  |  | if (!$loaded\_session) { |
|  |  | // XXX: Consider raising an error |
|  |  |  |
|  |  | // Or if it can't be unserialized and/or is not a session we started |
|  |  | if (empty($loaded\_session['\_\_authentic\_\_'])) { |
|  |  | return; |
|  |  | } |
|  |  | $session = $loaded\_session; |
|  |  |  |
|  |  | $session = $loaded\_session; |
|  |  |  |
|  |  | $dal->refreshSession($\_COOKIE['sessionID']); |
|  |  | } |
|  |  |  |
| Expand All | | @@ -75,21 +76,75 @@ function phpAds\_SessionSetAdminCookie($name, $value) |
|  |  | } |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Create a new sessionid \*/ |
|  |  | /\* Start a new session  \*/ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | function phpAds\_SessionStart() |
|  |  | { |
|  |  | global $session; |
|  |  |  |
|  |  | if (empty($\_COOKIE['sessionID'])) { |
|  |  | $session = array(); |
|  |  | $\_COOKIE['sessionID'] = md5(uniqid('phpads', 1)); |
|  |  | phpAds\_clearSession(); |
|  |  |  |
|  |  | $sessionId = phpAds\_SessionGenerateId(); |
|  |  |  |
|  |  | phpAds\_SessionSetAdminCookie('sessionID', $\_COOKIE['sessionID']); |
|  |  | $dal = new MAX\_Dal\_Admin\_Session(); |
|  |  | $dal->storeSerializedSession(serialize($session), $sessionId); |
|  |  | } |
|  |  |  |
|  |  | return $\_COOKIE['sessionID']; |
|  |  | } |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Generate a sessionid \*/ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | function phpAds\_SessionGenerateId() |
|  |  | { |
|  |  | $\_COOKIE['sessionID'] = md5(uniqid('phpads', 1)); |
|  |  |  |
|  |  | phpAds\_SessionSetAdminCookie('sessionID', $\_COOKIE['sessionID']); |
|  |  |  |
|  |  | return $\_COOKIE['sessionID']; |
|  |  | } |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Re-generate the sessionid \*/ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | function phpAds\_SessionRegenerateId() |
|  |  | { |
|  |  | global $session; |
|  |  |  |
|  |  | $dal = new MAX\_Dal\_Admin\_Session(); |
|  |  |  |
|  |  | if (!empty($\_COOKIE['sessionID'])) { |
|  |  | $dal->deleteSession($\_COOKIE['sessionID']); |
|  |  | } |
|  |  |  |
|  |  | if (!empty($session['\_\_authentic\_\_'])) { |
|  |  | $sessionId = phpAds\_SessionGenerateId(); |
|  |  | $dal->storeSerializedSession(serialize($session), $sessionId); |
|  |  |  |
|  |  | return $sessionId; |
|  |  | } |
|  |  |  |
|  |  | unset($\_COOKIE['sessionID']); |
|  |  |  |
|  |  | return phpAds\_SessionStart(); |
|  |  | } |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Clear the session and mark it as authentic \*/ |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  |  |
|  |  | function phpAds\_clearSession() |
|  |  | { |
|  |  | $GLOBALS['session'] = array( |
|  |  | '\_\_authentic\_\_' => true, |
|  |  | ); |
|  |  | } |
|  |  |  |
|  |  | /\*-------------------------------------------------------\*/ |
|  |  | /\* Register the data in the session array \*/ |
|  |  | /\*-------------------------------------------------------\*/ |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[www/api/v1/xmlrpc/LogonServiceImpl.php](#diff-6a54610969fa7a4537d4a41c8562b2e9ac6f84afc7dce05da2ca11c4070a4108 "www/api/v1/xmlrpc/LogonServiceImpl.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/4910365631eabbb208961c36149f41cc8159fb39/www/api/v1/xmlrpc/LogonServiceImpl.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -93,7 +93,8 @@ function logon($username, $password, &$sessionId) |
|  |  |  |
|  |  | $\_POST['login'] = 'Login'; |
|  |  |  |
|  |  | $\_COOKIE['sessionID'] = uniqid('phpads', 1); |
|  |  | unset($\_COOKIE['sessionID']); |
|  |  | phpAds\_SessionStart(); |
|  |  | $\_POST['phpAds\_cookiecheck'] = $\_COOKIE['sessionID']; |
|  |  |  |
|  |  | $this->preInitSession(); |
| Expand Down | |  |

3 changes: 2 additions & 1 deletion

3
[www/api/v2/xmlrpc/LogonServiceImpl.php](#diff-9d2794de288b720bf5c71249d71b25f18592d67ca98c7889e000faf299abd6ef "www/api/v2/xmlrpc/LogonServiceImpl.php")

Show comments

[View file](/revive-adserver/revive-adserver/blob/4910365631eabbb208961c36149f41cc8159fb39/www/api/v2/xmlrpc/LogonServiceImpl.php)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
| Expand Up | | @@ -93,7 +93,8 @@ function logon($username, $password, &$sessionId) |
|  |  |  |
|  |  | $\_POST['login'] = 'Login'; |
|  |  |  |
|  |  | $\_COOKIE['sessionID'] = uniqid('phpads', 1); |
|  |  | unset($\_COOKIE['sessionID']); |
|  |  | phpAds\_SessionStart(); |
|  |  | $\_POST['phpAds\_cookiecheck'] = $\_COOKIE['sessionID']; |
|  |  |  |
|  |  | $this->preInitSession(); |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `4910365`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Frevive-adserver%2Frevive-adserver%2Fcommit%2F4910365631eabbb208961c36149f41cc8159fb39) to comment.

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from www.revive-adserver.com_117e0fb8_20250125_091837.html ===


* [Facebook](https://www.facebook.com/WeAreReviveAdserver/)
* [RSS](https://www.revive-adserver.com/feed/)

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sec_menu "Hosted edition of Revive Adserver – sign up and get started in no time!")
* [Community Forum](https://forum.revive-adserver.com/)
* [Documentation](https://documentation.revive-adserver.com/)
* [Github](https://github.com/revive-adserver/revive-adserver/)
* [Patreon](https://patreon.com/revive_adserver "Sponsor us on Patreon")

[![Revive Adserver](https://www.revive-adserver.com/media/Revive-Adserver-logo.png)
# Download edition](https://www.revive-adserver.com/)

* [Download](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Features](https://www.revive-adserver.com/features/ "Features of Revive Adserver")
  + [Inventory](https://www.revive-adserver.com/features/#inventory "Managing inventory")
  + [Statistics](https://www.revive-adserver.com/features/#statistics "Review your Statistics")
  + [Open Source](https://www.revive-adserver.com/features/#open_source "Free, Open Source, Privacy Proof")
* [How to](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver")
  + [Get Started](https://www.revive-adserver.com/how-to/get-started/ "How to Get started with Revive Adserver")
  + [Manage Advertisers](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manage Advertisers in Revive Adserver")
    - [Create an Advertiser](https://www.revive-adserver.com/how-to/create-an-advertiser/ "How to Create an Advertiser in Revive Adserver")
    - [More about Advertisers…](https://www.revive-adserver.com/how-to/manage-advertisers/ "How to Manager Advertisers in Revive Adserver")
  + [Manage Campaigns](https://www.revive-adserver.com/how-to/manage-campaigns/ "How to create and manage campaigns in Revive Adserver")
    - [Create a Campaign](https://www.revive-adserver.com/how-to/create-a-campaign/ "How to create a Campaign in Revive Adserver")
    - [Link a campaign to zones](https://www.revive-adserver.com/how-to/link-a-campaign-to-zones/ "How to link a campaign to zones in Revive Adserver")
    - [More about Campaigns…](https://www.revive-adserver.com/how-to/manage-campaigns/)
  + [Manage Banners](https://www.revive-adserver.com/how-to/manage-banners/ "How to manage banners in Revive Adserver")
    - [Create a Banner](https://www.revive-adserver.com/how-to/create-a-banner/ "How to create a banner in Revive Adserver")
    - [Define Delivery Rules](https://www.revive-adserver.com/how-to/define-delivery-rules-for-a-banner/ "How to define Delivery Rules for a Banner in Revive Adserver")
    - [More about Banners…](https://www.revive-adserver.com/how-to/manage-banners/ "More articles about managing banners in Revive Adserver")
  + [Manage Websites](https://www.revive-adserver.com/how-to/manage-websites/ "How to manage websites in Revive Adserver")
    - [Create a Website](https://www.revive-adserver.com/how-to/create-a-website/ "How to Create a Website in Revive Adserver")
  + [Manage Zones](https://www.revive-adserver.com/how-to/manage-zones/ "How to manage Zones in Revive Adserver")
    - [Create a Zone](https://www.revive-adserver.com/how-to/create-a-zone/ "How to create a Zone in Revive Adserver")
    - [Create Zone Invocation Code](https://www.revive-adserver.com/how-to/create-zone-invocation-code/ "How to Create Zone Invocation Code in Revive Adserver")
    - [More about Zones…](https://www.revive-adserver.com/how-to/manage-zones/)
  + [Manage Preferences](https://www.revive-adserver.com/how-to/manage-preferences/ "Manage Preferences in Revive Adserver")
    - [Create Delivery Rule Sets](https://www.revive-adserver.com/how-to/create-delivery-rule-sets/ "Create Delivery Rule Sets in Revive Adserver")
  + [Install and Update](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating Revive Adserver")
    - [Install Revive Adserver](https://www.revive-adserver.com/how-to/install/ "How to Install Revive Adserver on your server")
    - [Update Revive Adserver](https://www.revive-adserver.com/how-to/update/ "How to Update Revive Adserver to a new version")
    - [More about Installation and Updating…](https://www.revive-adserver.com/how-to/install-update/ "Articles about Installing and Updating the Revive Adserver software")
  + [Manage Configuration](https://www.revive-adserver.com/how-to/manage-configuration/ "Articles about How to Configure Revive Adserver")
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions about Revive Adserver")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
  + [Can I sponsor Revive Adserver?](https://www.revive-adserver.com/about/our-sponsors/)
  + [Using Google AdSense with Revive Adserver](https://www.revive-adserver.com/faq/using-google-adsense-with-revive-adserver/)
  + [Geotargeting with Revive Adserver](https://www.revive-adserver.com/faq/geotargeting-with-revive-adserver/)
  + [Troubleshooting banner delivery](https://www.revive-adserver.com/faq/troubleshooting-banner-delivery/)
* [Support](https://www.revive-adserver.com/support/ "Support for Revive Adserver")
  + [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
  + [Documentation](https://documentation.revive-adserver.com/)
  + [Forums](https://forum.revive-adserver.com/ "Revive Adserver Community Forums")
  + [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
  + [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
  + [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and Privacy")
* [About](https://www.revive-adserver.com/about/ "About Revive Adserver")
  + [Our sponsors](https://www.revive-adserver.com/about/our-sponsors/)
  + [Active Revive Adserver instances](https://www.revive-adserver.com/about/active-revive-adserver-instances/)
  + [User Reviews](https://www.revive-adserver.com/about/user-reviews-about-revive-adserver/ "User Reviews about Revive Adserver")
* [Blog](https://www.revive-adserver.com/blog/ "Revive Adserver blog")

Select Page

# Revive Adserver Security Advisory REVIVE-SA-2016-001

## Revive Adserver Security Advisory REVIVE-SA-2016-001

* Advisory ID: [REVIVE-SA-2016-001](https://www.revive-adserver.com/security/revive-sa-2016-001/)
* CVE-IDs: See below
* Date: 2016-03-02
* Risk Level: Medium
* Applications affected: Revive Adserver
* Versions affected: <= 3.2.2
* Versions not affected: >= 3.2.3
* Website: <https://www.revive-adserver.com/>

## Vulnerability 1 – Improper Restriction of Excessive Authentication Attempts

* CVE-ID: [CVE-2016-9124](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9124)
* CWE-ID: CWE-307
* CVSSv2: 8.5 (AV:N/AC:L/Au:N/C:C/I:P/A:N)

### Description

Karan M. Tank and Smit B. Shah have reported via HackerOne that the login page of Revive Adserver was vulnerable to password-guessing attacks. An account lockdown feature was considered, but rejected to avoid introducing service disruptions to regular users during such attacks. A random delay has instead been introduced as a counter-measure in case of password failures, along with a system to discourage parallel brute forcing. These systems will effectively allow the valid users to log in to the adserver, even while an attack is in progress.

### References

* <https://cwe.mitre.org/data/definitions/307.html>
* <https://github.com/revive-adserver/revive-adserver/commit/847941390f5b3310d51b07c92ec91cc1f4cc82c9>

## Vulnerability 2 – Session Fixation

* CVE-ID: [CVE-2016-9125](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9125)
* CWE-ID: CWE-384
* CVSSv2: 7.8 (AV:N/AC:M/Au:N/C:C/I:P/A:N)

### Description

The HackerOne users kaviya and Kamini Singh have independently reported that Revive Adserver was vulnerable to session fixation, by allowing arbitrary session identifiers to be forced and, at the same time, by not invalidating the existing session upon a successful authentication. Under some circumstances, that could have been an opportunity for an attacker to steal an authenticated sessions.

### References

* <https://cwe.mitre.org/data/definitions/384.html>
* <https://github.com/revive-adserver/revive-adserver/commit/4910365631eabbb208961c36149f41cc8159fb39>

## Vulnerability 3 – Persistent XSS

* CVE-ID: [CVE-2016-9126](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9126)
* CWE-ID: CWE-79
* CVSSv2: 5.6 (AV:N/AC:H/Au:S/C:C/I:P/A:N)

### Description

Tengku Zahasman has reported via HackerOne that usernames were not properly escaped when displayed in the audit trail widget of the dashboard upon login, allowing persistent XSS attacks. An authenticated user with enough privileges to create other users could exploit the vulnerability to access the administrator account.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/8d8c6df309ff5fde9dd4770abcd4ec5d2449b3ec>

## Vulnerability 4 – Cross-Site Request Forgery (CSRF)

* CVE-ID: [CVE-2016-9127](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9127)
* CWE-ID: CWE-352
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

An undisclosed user has reported via HackerOne that the password recovery form in Revive Adserver was vulnerable to CSRF attacks. This vulnerability could be exploited to send a large number of password recovery emails to the registered users, especially in conjunction with a bug that caused recovery emails to be sent to all the users at once. Both issues have been fixed.

### References

* <https://cwe.mitre.org/data/definitions/352.html>
* <https://github.com/revive-adserver/revive-adserver/commit/3aaebcc765797d2c684e031f2836e0a69d6b7bc2>

## Vulnerability 5 – Reflected XSS

* CVE-ID: [CVE-2016-9128](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9128)
* CWE-ID: CWE-79
* CVSSv2: 3.5 (AV:N/AC:M/Au:S/C:N/I:P/A:N)

### Description

The HackerOne user @decidedlygray has reported that the affiliate-preview.php script in www/admin is vulnerable to a reflected XSS attack. This vulnerability could be used by an attacker to steal the session ID of an authenticated user, by tricking them into visiting a specifically crafted URL.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/a323fd626627e8d42819fd5b7e2829196b5c54a3>
* <https://github.com/revive-adserver/revive-adserver/commit/e17a7ec3412ded751cda50b82338de471d656d74>

## Vulnerability 6 – Information Exposure Through Discrepancy

* CVE-ID: [CVE-2016-9129](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9129)
* CWE-ID: CWE-203
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:P/I:N/A:N)

### Description

Karan M. Tank and Smit B. Shah have reported via HackerOne that it was possible to check whether or not an email address was associated to one or more user accounts on a target Revive Adserver instance by examining the message printed by the password recovery system. Such information cannot however be used directly to log in to the system, which requires a username.

### References

* <https://cwe.mitre.org/data/definitions/203.html>
* <https://github.com/revive-adserver/revive-adserver/commit/38223a841190bebd7a137c7bed84fbbcb2b0c2a5>

## Vulnerability 7 – Persistent XSS

* CVE-IDs: [CVE-2016-9130](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9130), [CVE-2016-9454](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9454)
* CWE-ID: CWE-79
* CVSSv2: 3.5 (AV:N/AC:M/Au:S/C:N/I:P/A:N)

### Description

Johan Caluwe has reported via HackerOne two vectors for persistent XSS attacks via the Revive Adserver user interface, both requiring a trusted (non-admin) account:

1. the website name wasn’t properly escaped when displayed in the campaign-zone.php script; and
2. the banner image URL for external banners wasn’t properly escaped when displayed in most of the banner related pages.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/f6880330a8e11e804663f132867e9eb9b1f94e83>

## Vulnerability 8 – Cross-Site Request Forgery (CSRF)

* CVE-ID: [CVE-2016-9455](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9455)
* CWE-ID: CWE-352
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

The HackerOne user @decidedlygray has reported a number of scripts in Revive Adserver’s user interface that were vulnerable to CSRF attacks:

* www/admin/banner-acl.php
* www/admin/banner-activate.php
* www/admin/banner-advanced.php
* www/admin/banner-modify.php
* www/admin/banner-swf.php
* www/admin/banner-zone.php
* www/admin/tracker-modify.php

### References

* <https://cwe.mitre.org/data/definitions/352.html>
* <https://github.com/revive-adserver/revive-adserver/commit/65a9c8119b4bc7493fd957e1a8d6f6f731298b45>

## Vulnerability 9 – Cross-Site Request Forgery (CSRF)

* CVE-ID: [CVE-2016-9456](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9456)
* CWE-ID: CWE-352
* CVSSv2: 5 (AV:N/AC:L/Au:N/C:N/I:N/A:P)

### Description

Following a number of CSRF reports, the Revive Adserver team have conducted a security audit of the admin interface scripts in order to identify and fix other potential CSRF vulnerabilities.

The effort led to fixing 20+ such issues: please see the commit for the full list of files affected.

### References

* <https://cwe.mitre.org/data/definitions/352.html>
* <https://github.com/revive-adserver/revive-adserver/commit/e563ca61e4f3b7210cb61f53284adaa8aef4a49a>

## Vulnerability 10 – Reflected XSS

* CVE-ID: [CVE-2016-9457](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9457)
* CWE-ID: CWE-79
* CVSSv2: 5.6 (AV:N/AC:H/Au:S/C:C/I:P/A:N)

### Description

Johan Caluwe has reported via HackerOne that www/admin/stats.php was vulnerable to reflected XSS attacks via multiple parameters that were not properly sanitised or escaped when displayed, such as “setPerPage”, “pageId”, “bannerid”, “pereiod\_start”, “period\_end” and possibly others.

### References

* <https://cwe.mitre.org/data/definitions/79.html>
* <https://github.com/revive-adserver/revive-adserver/commit/ecbe822b48ef4ff61c2c6357c0c94199a81946f4>

## Solution

We strongly advise people to upgrade to the most recent 3.2.3 release of Revive Adserver, including those running OpenX Source or older versions of the application.

## Contact Information

The security contact for Revive Adserver can be reached at: <security AT revive-adserver DOT com>

Please review [https://www.revive-adserver.com/security/](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team") before doing so.

#### Current Stable Release

* [Version 5.5.2](https://www.revive-adserver.com/download/ "Download the latest stable version of Revive Adserver")
#### How can we help?

* [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=sidebar "Hosted edition of Revive Adserver – Subscribe to get started in no time!")
* [Download edition](https://www.revive-adserver.com/download/ "Download Revive Adserver")
* [Requirements](https://www.revive-adserver.com/support/requirements/ "Technical requirements for Revive Adserver")
* [Documentation](https://documentation.revive-adserver.com/)
* [FAQ](https://www.revive-adserver.com/faq/ "Frequently asked questions")
* [Forums](https://forum.revive-adserver.com/)
* [Bugs](https://www.revive-adserver.com/support/bugs/ "Reporting bugs and resolving issues")
#### How can you help?

* [Sponsor Us](https://www.revive-adserver.com/about/our-sponsors/)
* [Translate to your language](https://translations.revive-adserver.com/ "Help us by translating the Revive Adserver software to your language")
#### Other information

* [Security](https://www.revive-adserver.com/security/ "Security Advisories by the Revive Adserver Project Team")
* [Privacy](https://www.revive-adserver.com/privacy/ "Revive Adserver software and privacy")

#### Current Stable Release

**v5.5.2** · [Download now](https://www.revive-adserver.com/download/)
released April 17, 2024
Read our [Release notes](https://www.revive-adserver.com/categories/release-notes/) blog posts.

#### How to use Revive Adserver

We have a collection of [articles explaining how to use the Revive Adserver software](https://www.revive-adserver.com/how-to/ "How to use Revive Adserver"), with tips and best practices.

#### Hosted edition

Revive Adserver is also available as a [Hosted edition](https://www.revive-adserver.net/?utm_source=download_edition&utm_medium=link&utm_campaign=page_footer "Revive Adserver Hosted edition"), with costs as low as $10 per month.

#### Project Information

Revive Adserver is a project by

**[Aqua Platform](http://www.aquaplatform.com/ "Aqua Platform")**.

* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")
#### Become a sponsor

You can be a sponsor of the Revive Adserver open source project, by [contributing to our project on Patreon](https://www.patreon.com/revive_adserver). Even just $10 per month will help.

[![](https://www.revive-adserver.com/media/become_a_patron_button.png)](https://www.patreon.com/revive_adserver)

We also have other [sponsors](https://www.revive-adserver.com/about/our-sponsors/ "A list of companies and individuals who have sponsored our project").

#### Website hosting

This website is hosted by [Aqua Platform](https://www.aquaplatform.com/), specialists in next generation cloud based [Revive Adserver Hosting](https://www.aquaplatform.com/revive-adserver-hosting/), systems and technology.

* [Home](https://www.revive-adserver.com/)
* [Privacy](https://www.revive-adserver.com/privacy/ "Privacy and Revive Adserver")
* [Security](https://www.revive-adserver.com/security/)

[Revive Adserver Download edition](https://www.revive-adserver.com/) is © 2013-2025 by [Aqua Platform](https://www.aquaplatform.com/) · All Rights Reserved.

* [Follow](https://github.com/revive-adserver/revive-adserver/ "Follow on GitHub")
* [Follow](https://www.patreon.com/revive_adserver "Follow on Patreon")
* [Follow](https://www.linkedin.com/company/reviveadserver/ "Follow on LinkedIn")
* [Follow](https://www.facebook.com/WeAreReviveAdserver/ "Follow on Facebook")
* [Follow](https://www.revive-adserver.com/feed/ "Follow on RSS")


