=== Content from wordpress.org_e81d0261_20250126_004109.html ===


[WordPress.org](https://wordpress.org/)

* [News](https://wordpress.org/news/)
* [Showcase](https://wordpress.org/showcase/)
* [Hosting](https://wordpress.org/hosting/)
* Extend
  + [Themes](https://wordpress.org/themes/)
  + [Plugins](https://wordpress.org/plugins/)
  + [Patterns](https://wordpress.org/patterns/)
  + [Blocks](https://wordpress.org/blocks/)
  + [Openverse ↗︎](https://openverse.org/)
* Learn
  + [Learn WordPress](https://learn.wordpress.org/)
  + [Documentation](https://wordpress.org/documentation/)
  + [Forums](https://wordpress.org/support/forums/)
  + [Developers](https://developer.wordpress.org/)
  + [WordPress.tv ↗︎](https://wordpress.tv/)
* Community
  + [Make WordPress](https://make.wordpress.org/)
  + [Photo Directory](https://wordpress.org/photos/)
  + [Five for the Future](https://wordpress.org/five-for-the-future/)
  + [Events](https://events.wordpress.org/)
  + [Job Board ↗︎](https://jobs.wordpress.net/)
* About
  + [About WordPress](https://wordpress.org/about/)
  + [Enterprise](https://wordpress.org/enterprise/)
  + [Gutenberg ↗︎](https://wordpress.org/gutenberg/)
* [Get WordPress](https://wordpress.org/download/)

Search in WordPress.org

[Get WordPress](https://wordpress.org/download/)

[WordPress.org](https://wordpress.org/)

[Plugin Directory](https://wordpress.org/plugins/)

dwnldr

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdwnldr&locale=en_US)

* [Submit a plugin](https://wordpress.org/plugins/developers/)
* [My favorites](https://wordpress.org/plugins/browse/favorites/)
* [Log in](https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fplugins%2Fdwnldr&locale=en_US)

Search plugins

![](https://ps.w.org/dwnldr/assets/banner-772x250.png?rev=1453926)

This plugin **hasn’t been tested with the latest 3 major releases of WordPress**. It may no longer be maintained or supported and may have compatibility issues when used with more recent versions of WordPress.

![](https://ps.w.org/dwnldr/assets/icon-256x256.png?rev=1453926)
# dwnldr

By [Ian Young](http://findshorty.com/)

[Download](https://downloads.wordpress.org/plugin/dwnldr.zip)

* [Details](https://wordpress.org/plugins/dwnldr/#description)
* [Reviews](https://wordpress.org/plugins/dwnldr/#reviews)
* [Installation](https://wordpress.org/plugins/dwnldr/#installation)
* [Development](https://wordpress.org/plugins/dwnldr/#developers)

[Support](https://wordpress.org/support/plugin/dwnldr/)

## Description

Sometimes there is no need for a huge, complex download manager, and let’s face it there’s rarely a need for an attachment page (who uses them right?).

Simply add a link in your post, shortcode, widget or page to the attachment page of the file you want your users to download, and that’s it.

dwnldr will log who’s downloaded it and when, and force the download without exposing your download’s URL.

And don’t forget – if you like the plugin, please [remember to review](https://wordpress.org/support/view/plugin-reviews/dwnldr)! Thanks!

And if you’re having any issues, or you’d like to suggest a feature – [please write a support post](https://wordpress.org/support/plugin/dwnldr)!

## Installation

1. Upload the plugin files to the `/wp-content/plugins/dwnldr` directory, or install the plugin through the WordPress plugins screen directly, using

   the full unzipped plugin file.
2. Activate the plugin through the ‘Plugins’ screen in WordPress
3. To add a download link, simply select your attachment using the Add Media button and select Link To -> Attachment Page.
4. The attachment page is *usually* ?attachment\_id=[your file id] (it doesn’t matter what path you use, as long as the link ends in the attachment id).

## FAQ

Where are the logs?

You can find your logs on the “edit post” page in the dashboard.

If you’re viewing your media library as a grid, make sure you click the “Edit more details” link from within the dialog.

If your media library is in list format, you’ll see a Downloads column showing you the total downloads for that item.

Clicking the download count, or the edit link, will take you to the edit post page, and the logs are towards the bottom.

Can I change the file extensions people can download?

Yes – to change the file extensions that you want to allow people to download (instead of serving up the attachment page for that file), add the following to your theme’s functions.php file.

```
add_filter('dwnldr_extensions', 'my_dwnldr_extensions');
function my_dwnldr_extensions( $extensions ) {
    return array('.pdf','.jpg','.jpeg', etc...);
}

```

Can I add to the log?

You can also change, or add to, the data you want to log when a person downloads a file with the following.

```
add_filter('dwnldr_log', 'my_dwnldr_log');
function my_dwnldr_log( $data ) {
    $mydata = array(
        'anything_you_like' => 'some data about the download'
    );
    return array_merge($data, $mydata);
}

```

## Reviews

There are no reviews for this plugin.

## Contributors & Developers

“dwnldr” is open source software. The following people have contributed to this plugin.

Contributors

* ![](https://secure.gravatar.com/avatar/75f4d599f35587034c0b57b97f5236277a6b89b3efc3ddf6c8d44c912f57802b?s=32&d=mm&r=g)

[Translate “dwnldr” into your language.](https://translate.wordpress.org/projects/wp-plugins/dwnldr)

### Interested in development?

[Browse the code](https://plugins.trac.wordpress.org/browser/dwnldr/), check out the [SVN repository](https://plugins.svn.wordpress.org/dwnldr/), or subscribe to the [development log](https://plugins.trac.wordpress.org/log/dwnldr/) by [RSS](https://plugins.trac.wordpress.org/log/dwnldr/?limit=100&mode=stop_on_copy&format=rss).

## Changelog

#### 1.031

Fixed php warning in logs

#### 1.03

Added custom logs to download log table

Added “Downloads” count column to media library table

#### 1.02

Additional header in forced download to prevent OSX Safari users getting nonsense

Readme update

#### 1.01

User agent string output wrapped in htmlentities

#### 1.0

* Initial version

## Meta

* Version **1.031**
* Last updated **8 years ago**
* Active installations **10+**
* WordPress version **4.0 or higher**
* Tested up to **4.5.32**
* Tags [attachment](https://wordpress.org/plugins/tags/attachment/)[downloads](https://wordpress.org/plugins/tags/downloads/)[pdf](https://wordpress.org/plugins/tags/pdf/)
* [Advanced View](https://wordpress.org/plugins/dwnldr/advanced/)

## Ratings

No reviews have been submitted yet.

[Add my review](https://wordpress.org/support/plugin/dwnldr/reviews/#new-post)

[See all reviews](https://wordpress.org/support/plugin/dwnldr/reviews/)

## Contributors

* ![](https://secure.gravatar.com/avatar/75f4d599f35587034c0b57b97f5236277a6b89b3efc3ddf6c8d44c912f57802b?s=32&d=mm&r=g)
## Support

Got something to say? Need help?

[View support forum](https://wordpress.org/support/plugin/dwnldr/)

* [About](https://wordpress.org/about/)
* [News](https://wordpress.org/news/)
* [Hosting](https://wordpress.org/hosting/)
* [Privacy](https://wordpress.org/about/privacy/)

* [Showcase](https://wordpress.org/showcase/)
* [Themes](https://wordpress.org/themes/)
* [Plugins](https://wordpress.org/plugins/)
* [Patterns](https://wordpress.org/patterns/)

* [Learn](https://learn.wordpress.org/)
* [Documentation](https://wordpress.org/documentation/)
* [Developers](https://developer.wordpress.org/)
* [WordPress.tv ↗](https://wordpress.tv/)

* [Get Involved](https://make.wordpress.org/)
* [Events](https://events.wordpress.org/)
* [Donate ↗](https://wordpressfoundation.org/donate/)
* [Five for the Future](https://wordpress.org/five-for-the-future/)

* [WordPress.com ↗](https://wordpress.com/?ref=wporg-footer)
* [Matt ↗](https://ma.tt/)
* [bbPress ↗](https://bbpress.org/)
* [BuddyPress ↗](https://buddypress.org/)

[WordPress.org](https://wordpress.org/)

[WordPress.org](https://wordpress.org/)

* [Visit our Facebook page](https://www.facebook.com/WordPress/)
* [Visit our X (formerly Twitter) account](https://www.x.com/WordPress)
* [Visit our Instagram account](https://www.instagram.com/wordpress/)
* [Visit our LinkedIn account](https://www.linkedin.com/company/wordpress)
* [Visit our YouTube channel](https://www.youtube.com/wordpress)

![Code is Poetry](https://s.w.org/style/images/code-is-poetry-for-dark-bg.svg)



=== Content from rastating.github.io_449edbe1_20250126_004108.html ===

[![](/assets/images/avatar.jpg)](/)
# [rastating.github.io](/)

# Dwnldr 1.0 Stored XSS Disclosure

July 18, 2016

## Homepage

<https://wordpress.org/plugins/dwnldr/>

## Overview

Due to a lack of input sanitization in the `dwnldr.php` file, it is possible for unauthenticated users to utilise an XSS vector to store and run a script in the target user’s browser and potentially compromise the WordPress installation.

The vulnerable code can be found on lines 92 and 66 of `dwnldr.php`.

On line 92, when logging the download request, the content of `HTTP_USER_AGENT` is stored in the database in its raw form:

```
$log = array(
    'user' => get_current_user_id(),
    'time' => date('Y-m-d H:i:s'),
    'ip' => $_SERVER['REMOTE_ADDR'],
    'browser_info' => $_SERVER['HTTP_USER_AGENT'],
);
$meta = apply_filters('dwnldr_logs', $log);
add_post_meta($post->ID, '_download_log', $meta);
$this->force_download( $post, $ext );

```

When an admin user views the download logs, on line 66, it will echo the user agent string to the user with no encoding:

```
<td><span title="<?php echo $log['browser_info']; ?>"><?php echo substr($log['browser_info'], 0, 64).'&hellip;'; ?></span></td>

```
## CVSS Score

5.3

## CVSS Vector

[(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:F/RL:OF/RC:C)](https://nvd.nist.gov/cvss.cfm?calculator&version=2&vector=(AV:N/AC:L/Au:N/C:P/I:P/A:N/E:F/RL:OF/RC:C))

## Versions Affected

1.0

## Solution

Upgrade to version 1.01

## Proof of Concept

```
curl -A "User-Agent: <script>alert(document.cookie);</script>" -O http://<target>/?attachment_id=<attachment id>

```
## WordPress Exploit Framework Module

[exploit/xss/stored/dwnldr\_xss\_shell\_upload](https://github.com/rastating/wordpress-exploit-framework/blob/development/lib/wpxf/modules/exploit/xss/stored/dwnldr_xss_shell_upload.rb)

## WPVDB-ID

8556

## Disclosure Timeline

* **2016-07-17**: Identified vulnerability, contacted vendor with POC and a solution.
* **2016-07-18**: Vendor responded and released patch.
* **2016-07-18**: Disclosure made public

[#wordpress](/tags#wordpress)
[#dwnldr](/tags#dwnldr)
[#stored xss](/tags#stored+xss)

---


