The provided content describes two SQL injection vulnerabilities in dotCMS, identified as CVE-2016-10007 and CVE-2016-10008.

**CVE-2016-10007:**

*   **Root cause:** Insufficient sanitization of the `_EXT_FORM_HANDLER_orderBy` parameter in the "Marketing > Forms" screen.
*   **Weaknesses/vulnerabilities present:** SQL injection due to the lack of proper input validation and sanitization of the `orderBy` parameter. The application uses a whitelist approach which was found to be insufficient and case-sensitive.
*   **Impact of exploitation:**  Remote authenticated attackers with administrative privileges can execute arbitrary SQL commands on the database server. This can lead to complete database compromise including data exfiltration, data modification or denial of service.
*   **Attack vectors:**  By crafting malicious SQL queries in the `_EXT_FORM_HANDLER_orderBy` parameter in the URL.
*   **Required attacker capabilities/position:** The attacker must be authenticated and authorized as an administrator.

**CVE-2016-10008:**

*   **Root cause:** Insufficient sanitization of the `_EXT_STRUCTURE_direction` parameter in the "Content Types > Content Types" screen.
*   **Weaknesses/vulnerabilities present:** SQL injection due to the lack of proper input validation and sanitization of the `direction` parameter. The application uses a blacklist approach which was found to be insufficient.
*   **Impact of exploitation:** Remote authenticated attackers with administrative privileges can execute arbitrary SQL commands on the database server, potentially leading to data breaches or system compromise.
*   **Attack vectors:**  By crafting malicious SQL queries in the `_EXT_STRUCTURE_direction` parameter in the URL.
*   **Required attacker capabilities/position:**  The attacker must be authenticated and authorized as an administrator.

**Additional details:**

*   The blog post details the flawed sanitization mechanisms (both whitelist and blacklist) used by dotCMS, including bypass methods such as using different whitespace characters or comments in SQL queries, case sensitivity issues in the whitelist, and problems with escaping single quotes.
*   The `sanitizeParameter` function, intended to prevent SQL injection through a blacklist, was found to be ineffective due to its limitations in handling different database engines, escaping characters, and locations in SQL queries where the parameters are used.
*   The blog post also mentions the use of `StringEscapeUtils.escapeSql`, which only escapes single quotes and does not handle percent (%) or underscore (_) characters used in LIKE clauses, further demonstrating incomplete sanitization.
*   The author provides proof-of-concept URLs for both vulnerabilities, demonstrating how to inject SQL commands via the vulnerable parameters.
*   The blog post also details the disclosure timeline and the lack of a timely fix from dotCMS.