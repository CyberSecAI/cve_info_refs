Based on the provided content, here's a breakdown of the vulnerability:

**Root Cause:**

- The Estatik plugin had an arbitrary file upload vulnerability which was partially fixed by removing access to the `es_prop_media_images()` function for unauthenticated users. However, the function remained accessible via AJAX to logged-in users without sufficient permission checks, leading to an authenticated arbitrary file upload vulnerability.
- The plugin also lacked CSRF protection (nonce) when handling file uploads, making it vulnerable to cross-site request forgery attacks.

**Weaknesses/Vulnerabilities:**

- **Authenticated Arbitrary File Upload:** The `es_prop_media_images()` function could be accessed by any logged-in user, regardless of their role, allowing them to upload arbitrary files.
- **CSRF:** The file upload functionality was vulnerable to cross-site request forgery due to the absence of a nonce.

**Impact of Exploitation:**

- Attackers, with a valid WordPress login, could upload arbitrary files (e.g., PHP scripts) to the `/wp-content/uploads/` directory.
- This could lead to complete compromise of the website, allowing attackers to execute arbitrary code on the server, deface the website, steal sensitive data, or perform other malicious activities.

**Attack Vectors:**

- The primary attack vector is through the WordPress AJAX interface by sending a POST request to `wp-admin/admin-ajax.php` with the `action` parameter set to `es_prop_media_images`, and a file in the `es_media_images[]` parameter.
- CSRF attacks could be conducted by tricking a logged-in user into submitting a crafted request, leading to arbitrary file uploads without their knowledge.

**Required Attacker Capabilities/Position:**

- **Authenticated File Upload:** The attacker needs a valid account on the WordPress site, even with a lower-level role (not just administrator).
- **CSRF:** The attacker needs to be able to trick a logged-in user into visiting a malicious webpage or clicking a malicious link. The logged in user must also have a role that is able to access the vulnerable functionality.

**Additional Details:**
- The vulnerability was present in the Estatik plugin before version 2.3.1
- The vulnerability was initially present due to a missing nonce check and not limiting access to a function to administrator users.

This content provides more detail than a standard CVE description by including the specific vulnerable function, the fix that caused a regression, and a proof-of-concept exploit code.