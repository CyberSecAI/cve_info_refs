=== Content from www.squid-cache.org_6ccd9221_20250125_063513.html ===
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Squid Proxy Cache Security Update Advisory SQUID-2016:10
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Advisory ID: SQUID-2016:10
Date: Dec 16, 2016
Summary: Information disclosure
in Collapsed Forwarding.
Affected versions: Squid 3.5 -> 3.5.22
Squid 4.0 -> 4.0.16
Fixed in version: Squid 4.0.17, 3.5.23
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
http://www.squid-cache.org/Advisories/SQUID-2016\_10.txt
http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-10003
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Problem Description:
Due to incorrect comparsion of request headers Squid can deliver
responses containing private data to clients it should not have
reached.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Severity:
This problem allows a remote attacker to discover private and
sensitive information about another clients browsing session.
Potentially including credentials which allow access to further
sensitive resources.
This problem only affects Squid configured to use the Collapsed
Forwarding feature.
It is of particular importance for HTTPS reverse-proxy sites
with Collapsed Forwarding.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Updated Packages:
This bug is fixed by Squid version 3.5.23 and 4.0.17.
In addition, patches addressing this problem can be found in our
patch archives:
Squid 3.5 (excluding 3.5.22):
Squid 3.5.22:
Squid 4.0:
If you are using a prepackaged version of Squid then please refer
to the package vendor for availability information on updated
packages.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Determining if your version is vulnerable:
Squid-2.x have not been tested.
The following command can be used to determine if Squid-3 or
later have collapsed\_forwarding in squid.conf:
(squid -k parse 2>&1) | grep collapsed\_forwarding
All Squid-3.x versions without collapsed\_forwarding configured
are not vulnerable.
All Squid-3.5 versions with 'collapsed\_forwarding off'
configured are not vulnerable.
All Squid-3.5 versions up to and including Squid-3.5.22 with
'collapsed\_forwarding on' configured are vulnerable.
All Squid-4.0 versions without collapsed\_forwarding configured
are not vulnerable.
All Squid-4.0 versions with 'collapsed\_forwarding off'
configured are not vulnerable.
All Squid-4.0 versions up to and including Squid-4.0.16 with
'collapsed\_forwarding on' configured are vulnerable.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Workaround:
Remove all uses of 'collapsed\_forwarding' from squid.conf and
included sub-files.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Contact details for the Squid project:
For installation / upgrade support on binary packaged versions
of Squid: Your first point of contact should be your binary
package vendor.
If your install and build Squid from the original Squid sources
then the squid-users@lists.squid-cache.org mailing list is your
primary support point. For subscription details see
.
For reporting of non-security bugs in the latest STABLE release
the squid bugzilla database should be used
.
For reporting of security sensitive bugs send an email to the
squid-bugs@lists.squid-cache.org mailing list. It's a closed
list (though anyone can post) and security related bug reports
are treated in confidence until the impact has been established.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Credits:
This issue was reported by Felix Hassert from Sevenval
Technologies GmbH.
Fixed by Eduard Bagdasaryan from Measurement Factory.
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
Revision history:
2016-11-28 17:28:43 UTC Initial Report
2016-12-16 18:37:00 UTC Packages Released
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
END


=== Content from www.openwall.com_ad20617f_20250125_063513.html ===


| [Openwall](/) * [Products](/)   + [Openwall GNU/\*/Linux   *server OS*](/Owl/)+ [Linux Kernel Runtime Guard](/lkrg/)+ [John the Ripper   *password cracker*](/john/)         - [Free & Open Source for any platform](/john/)- [in the cloud](/john/cloud/)- [Pro for Linux](/john/pro/linux/)- [Pro for macOS](/john/pro/macosx/)+ [Wordlists   *for password cracking*](/wordlists/)+ [passwdqc   *policy enforcement*](/passwdqc/)             - [Free & Open Source for Unix](/passwdqc/)- [Pro for Windows (Active Directory)](/passwdqc/windows/)+ [yescrypt   *KDF & password hashing*](/yescrypt/)+ [yespower   *Proof-of-Work (PoW)*](/yespower/)+ [crypt\_blowfish   *password hashing*](/crypt/)+ [phpass   *ditto in PHP*](/phpass/)+ [tcb   *better password shadowing*](/tcb/)+ [Pluggable Authentication Modules](/pam/)+ [scanlogd   *port scan detector*](/scanlogd/)+ [popa3d   *tiny POP3 daemon*](/popa3d/)+ [blists   *web interface to mailing lists*](/blists/)+ [msulogin   *single user mode login*](/msulogin/)+ [php\_mt\_seed   *mt\_rand() cracker*](/php_mt_seed/)* [Services](/services/)* Publications       + [Articles](/articles/)+ [Presentations](/presentations/)* Resources         + [Mailing lists](/lists/)+ [Community wiki](https://openwall.info/wiki/)+ [Source code repositories (GitHub)](https://github.com/openwall)+ [Source code repositories (CVSweb)](https://cvsweb.openwall.com)+ [File archive & mirrors](/mirrors/)+ [How to verify digital signatures](/signatures/)+ [OVE IDs](/ove/)* [What's new](/news) | |
| --- | --- |

| | [Hash Suite - Windows password security audit tool. GUI, reports in PDF.](https://hashsuite.openwall.net) | | --- | |
| --- | --- |

[[<prev]](../../../2016/12/17/2) [[next>]](2) [[<thread-prev]](../../../2016/12/17/1) [[day]](.) [[month]](..) [[year]](../..) [[list]](../../..)
```

Message-ID: <a8863765bf6848cba87939df890af51d@imshyb02.MITRE.ORG>
Date: Sat, 17 Dec 2016 20:06:22 -0500
From: <cve-assign@...re.org>
To: <squid3@...enet.co.nz>
CC: <cve-assign@...re.org>, <oss-security@...ts.openwall.com>
Subject: Re: CVE Request - squid HTTP proxy multiple Information Disclosure issues

-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

> <http://www.squid-cache.org/Advisories/SQUID-2016_11.txt>

> Incorrect processing of responses to If-None-Modified HTTP conditional
> requests leads to client-specific Cookie data being leaked to other
> clients. Attack requests can easily be crafted by a client to probe a
> cache for this information.

> the CVE critical leak was due to these lines in
> src/client_side_reply.cc:
>
>      bool matchedIfNoneMatch = false;
>      if (r.header.has(HDR_IF_NONE_MATCH)) {
>         if (!e->hasIfNoneMatchEtag(r)) {
> ...
> -            http->logType = LOG_TCP_MISS;
> -            sendMoreData(result);
>
> This last line should have called "  processMiss(result); "

Use CVE-2016-10002.

> <http://www.squid-cache.org/Advisories/SQUID-2016_10.txt>

> Incorrect HTTP Request header comparison results in Collapsed
> Forwarding feature mistakenly identifying some private responses as
> being suitable for delivery to multiple clients.

Use CVE-2016-10003.

> The current fix is not quite complete. However we believe the remaining
> headers leaked are not a serious security issue.

If anyone needs a CVE ID for this issue (involving other headers) that
was not fixed in 3.5.23 and 4.0.17, please let us know.

- --
CVE Assignment Team
M/S M300, 202 Burlington Road, Bedford, MA 01730 USA
[ A PGP key is available for encrypted communications at
  <http://cve.mitre.org/cve/request_id.html> ]
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v1

iQIcBAEBCAAGBQJYVdwRAAoJEHb/MwWLVhi2sBwP/33e42WWt+2xK8LMWIt2opxE
F8YSXBoIMKVh8V9i9dYeFrTcXPNMSOsNLawZgUaPIIdIzMy3ipKxfJ0dHlWjIUrk
3QIPAlri8tEOJiy0gR3x1xzdYaZUq5hLpBxWvUJz/GS4OPpvlMPO8VvSYzfKVYUi
Mxw9izK9E41WCUYFTCpzWhI+M248W4CCKYul8gHbDIaV1ED+3pRLkmfgaozP1TxW
ozAB8REzpOyG+Erl5rxZ3e8Zgpf3ox6Rmv260Ue4mhZLCsK2AWR72PJs9zXRK+LQ
1cwTROdWg78iMuoB4E77L77L98OEj5sSLlo6fc5mew8lyteq7QwbfaWjuCk3ga79
BVisJvqXW7dyzLxyZ5yiMGLmHJQd4C6FaKBM6D9xSlaUaicEPvLUU+zwNHtWi0dT
3KKI4GzvBk3x62c4bjjjGpNWoK0sNiDFK465MfA343XfeEjnA+URgrzNJO8ocvMI
booClyeDs7VKwv+yGVMI+3v+YQ/kUKjERdRr4StzSEWF45GPtXnWj7F7bj/JCR4m
/mwZ9237ED5Yhq81e5/OPfJ/dnduJYoI5vjcZmVekTxh3+3AUcLXH1JxfV7Rk6z4
+Tk+X443j3cuB//zMDR8oN7RCl64R2Cx29HwCFukU6nA+wL2hVLHBrVsR+mw6fQX
7LGySLYqm7FhLtuSKhQa
=GwOM
-----END PGP SIGNATURE-----

```

[Powered by blists](https://www.openwall.com/blists/) - [more mailing lists](https://lists.openwall.net)

Please check out the
[Open Source Software Security Wiki](https://oss-security.openwall.org/wiki/), which is counterpart to this
[mailing list](https://oss-security.openwall.org/wiki/mailing-lists/oss-security).

Confused about [mailing lists](/lists/) and their use?
[Read about mailing lists on Wikipedia](https://en.wikipedia.org/wiki/Electronic_mailing_list)
and check out these
[guidelines on proper formatting of your messages](https://www.complang.tuwien.ac.at/anton/mail-news-errors.html).


