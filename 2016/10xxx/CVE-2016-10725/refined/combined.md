=== Content from z.cash_f6cdc496_20250126_032237.html ===

[Skip to content](#content)

* [Home](/)
* [Zashi  wallet](/zashi/)
* [ECC roadmap](/roadmap/)
* [Blog](/blog/)
* [Zcash](https://z.cash)

Blog post

## [Electric Coin Company](https://electriccoin.co)

[ECC Blog](/blog/)

* [Technical](https://electriccoin.co/blog/category/technical/ "Technical")
* /
* Zcash Counterfeiting Vulnerability Successfully Remediated

# Zcash Counterfeiting Vulnerability Successfully Remediated

* Josh Swihart
* February 5, 2019

## Document Outline:

* [Summary](#summary)
* [Background](#background)
* [Counterfeiting Vulnerability Details](#counterfeiting-vulnerability-details)
* [Third Party Disclosure](#third-party-disclosure)
* [Timeline of Events](#timeline-of-events)
* [List of References](#list-of-references)
* [Technical Details of CVE-2019-7167](#technical-details)
* [Correspondence to Horizen and Komodo](#correspondence-horizen-komodo)

## Summary

Eleven months ago we discovered a counterfeiting vulnerability in the cryptography underlying some kinds of zero-knowledge proofs. This post provides details on the vulnerability, how we fixed it and the steps taken to protect Zcash users.

The counterfeiting vulnerability was fixed by the Sapling network upgrade that activated on October 28th, 2018. The vulnerability was specific to counterfeiting and did not affect user privacy in any way. Prior to its remediation, an attacker could have created fake Zcash without being detected. **The counterfeiting vulnerability has been fully remediated in Zcash and no action is required by Zcash users**.

The counterfeiting vulnerability was discovered by a cryptographer employed by the Zerocoin Electric Coin Company (aka The Zcash Company) on March 1st, 2018. It was not reported publicly at the time in order to protect against it being exploited prior to its remediation, and to provide information and remediated code to other projects that were also vulnerable. We employed stringent operational security measures to keep its existence a secret, even from our own engineers.

We believe that no one else was aware of the vulnerability and that no counterfeiting occurred in Zcash for the following reasons:

* Discovery of the vulnerability would have required a high level of technical and cryptographic sophistication that very few people possess.
* The vulnerability had existed for years but was undiscovered by numerous expert cryptographers, scientists, third-party auditors, and third-party engineering teams who initiated new projects based upon the Zcash code.
* The Zcash Company has seen no evidence that counterfeiting has occurred as might be discovered by monitoring the the total amount of Zcash held in Sprout addresses (i.e., the Sprout shielded pool). As long as the value in the shielded pools are greater than zero, no counterfeiting has been detected. Bitfly’s [Zcha.in displays these values on the network statistics page](https://zcha.in/statistics/network), and Zcash nodes report them in the output of the [getblockchaininfo command](https://zcash.readthedocs.io/en/latest/rtd_pages/sapling_turnstile.html).
* Upon discovering the vulnerability, the Zcash Company took extraordinary measures to minimize the possibility of exploitation. The specifics of our steps taken are documented in the detail below.
* The Zcash Company studied the blockchain for evidence of exploitation: An attack might leave a specific kind of footprint. We found no such footprint.

Although we believe that no counterfeiting occurred, we are monitoring pool totals and will act in accordance with our [published defense against counterfeiting](https://z.cash/blog/defense-against-counterfeiting-in-shielded-pools/) in an effort to preserve the monetary supply.

Zcash makes use of the most sophisticated and novel cryptography available on a public blockchain. Pushing cryptographic boundaries is inherently risky and user safety is of highest importance for the Zcash Company. We believe that the steps we have taken to mitigate the issue while working to ensure the safety of Zcash users has been successful. More information on the specific events that transpired from the initial discovery of the counterfeiting vulnerability through this disclosure will be covered in a future post.

### Key Points:

* A counterfeiting vulnerability was discovered in Zcash by a Zcash Company cryptographer.
* The counterfeiting vulnerability has been fully remediated in Zcash and no action is required by Zcash users.
* The successful remediation for Sprout addresses was introduced by the Zcash Company in the Zcash Sapling upgrade that occurred on the 28th of October, 2018.
* The vulnerability was specific to counterfeiting and its exploitation would not have impacted privacy.
* Zcash has not been susceptible to this attack since the Sapling activation.
* We have found no evidence that the vulnerability was discovered by anyone else or that counterfeiting occurred.
* The Zcash Company used best practices in operational security to keep this information private, and responsible disclosure to share it with two affected projects.

## Background

On March 1, 2018, Ariel Gabizon, a cryptographer employed by the Zcash Company at the time, discovered a subtle cryptographic flaw in the [[BCTV14](https://eprint.iacr.org/2013/879)] paper that describes the zk-SNARK construction used in the original launch of Zcash. The flaw allows an attacker to create counterfeit shielded value in any system that depends on parameters which are generated as described by the paper.

This vulnerability is so subtle that it evaded years of analysis by expert cryptographers focused on zero-knowledge proving systems and zk-SNARKs. In an analysis [[Parno15](https://eprint.iacr.org/2015/437)] in 2015, Bryan Parno from Microsoft Research discovered a different mistake in the paper. However, the vulnerability we discovered appears to have evaded his analysis. The vulnerability also appears in the subversion zero-knowledge SNARK scheme of [[Fuchsbauer17](https://eprint.iacr.org/2017/587)], where an adaptation of [[BCTV14](https://eprint.iacr.org/2013/879)] inherits the flaw. The vulnerability also appears in the ADSNARK construction described in [[BBFR14](https://eprint.iacr.org/2014/617)]. Finally, the vulnerability evaded the Zcash Company’s own cryptography team, which includes experts in the field that had [identified several flaws in other parts of the system](https://z.cash/blog/fixing-zcash-vulns/).

Importantly, the [[BCTV14](https://eprint.iacr.org/2013/879)] construction did not have a dedicated security proof, as noted in [[Parno15](https://eprint.iacr.org/2015/437)], and relied mainly on the [[PGHR13](https://eprint.iacr.org/2013/279)] security proof and the similarity between the two schemes. The Zcash Company team did attempt to write a security proof in [[BGG17](https://eprint.iacr.org/2017/602)], but it did not uncover this vulnerability. Zcash has since upgraded to a new proving system [[Groth16](https://eprint.iacr.org/2016/260)] which has multiple independent proofs and significantly better analysis.

After finding the vulnerability, Ariel immediately contacted another cryptographer at the Zcash Company, Sean Bowe. After Sean confirmed the existence of the vulnerability, Zooko Wilcox (CEO of the Zcash Company) and Nathan Wilcox (CTO of the Zcash Company) were briefed. Through careful coordination, the counterfeiting vulnerability was mitigated in the Zcash network without any known further disclosure outside this group of four people.

With the activation of Sapling, Sprout transactions were moved onto the new [[Groth16](https://eprint.iacr.org/2016/260)] proving system, fixing the issue on the Zcash network as described below.

To exploit the counterfeiting vulnerability, an attacker would have needed to possess information found in the large MPC protocol transcript that was made available shortly after the launch of Zcash. This transcript had not been widely downloaded and was removed from public availability immediately upon discovery of the vulnerability to make it more difficult to exploit. The Zcash Company adopted and maintained a cover story that the transcript was missing due to accidental deletion. The transcript was later reconstructed from DVDs collected from the participants of the original ceremony and posted following the Sapling activation.

We have been monitoring the total of funds in the Sprout pool against time and have not found any indication that any counterfeiting activity has taken place.

## Counterfeiting Vulnerability Details

The [[BCTV14](https://eprint.iacr.org/2013/879)] parameter setup algorithm, as described by the paper, mistakenly produces extra elements that violate the soundness of the proving system. The construction described by [[BCTV14](https://eprint.iacr.org/2013/879)] Appendix B is a variant of the [[PGHR13](https://eprint.iacr.org/2013/279)] zk-SNARK scheme with modifications to improve performance and adapt the scheme for the asymmetric pairing setting. This scheme was used in the original launch of Zcash and has been independently implemented by several other projects.

Ariel Gabizon, a cryptographer employed by the Zcash Company at the time of discovery, uncovered a soundness vulnerability. The key generation procedure of [[BCTV14](https://eprint.iacr.org/2013/879)], in step 3, produces various elements that are the result of evaluating polynomials related to the statement being proven. Some of these elements are unused by the prover and were included by mistake; but their presence allows a cheating prover to circumvent a consistency check, and thereby transform the proof of one statement into a valid-looking proof of a different statement. This breaks the soundness of the proving system.

The [[BGG17](https://eprint.iacr.org/2017/602)] multi-party computation (MPC) protocol that produced Sprout parameters for the [[BCTV14](https://eprint.iacr.org/2013/879)] construction follows the paper’s setup procedure, including the computation of the extra elements. These are not included in the actual parameters distributed to Zcash nodes since they are omitted from the parameter file format used by the proving routine implementation of [[BCTV14](https://eprint.iacr.org/2013/879)] in the libsnark library (used by Sprout). However, these elements do appear in the MPC ceremony transcript. Consequently, anyone with access to the ceremony transcript would have been able to create false proofs.

### What is affected?

While Zcash is no longer affected, any project that depends on the MPC ceremony used by the original Sprout system that was distributed in the initial launch of Zcash is vulnerable. This original Sprout system for shielded funds is comprised of the original Sprout circuit, the [[BCTV14](https://eprint.iacr.org/2013/879)] proving system using libsnark, and the parameters generated by an MPC ceremony [[BGG17](https://eprint.iacr.org/2017/602)]. It was used by the 1.x series of Zcash software (which also carried the “Sprout” name).

The algorithm described in [[BCTV14](https://eprint.iacr.org/2013/879)], before the update corresponding to this disclosure, is vulnerable (though its [libsnark](https://github.com/scipr-lab/libsnark) implementation, when used with its built-in parameter generation is not). The vulnerability was included in some independent implementations of [[BCTV14](https://eprint.iacr.org/2013/879)], such as [[snarkjs](https://github.com/iden3/snarkjs)], even though they do not require an MPC. Similar flaws can be found in the [[BBFR14](https://eprint.iacr.org/2014/617)] and [[Fuchsbauer17](https://eprint.iacr.org/2017/587)] zk-SNARK schemes.

We do not have an exhaustive list of all systems affected by this vulnerability, and we encourage all users, developers and maintainers of systems using [[BCTV14](https://eprint.iacr.org/2013/879)] to take the time to triage this issue and check if they are affected.

#### Resources:

[Original Sprout circuit implementation](https://github.com/zcash/zcash/tree/master/src/zcash/circuit)

Original Sprout zk-SNARK parameters: [proving key](https://z.cash/downloads/sprout-proving.key) and [verifying key](https://z.cash/downloads/sprout-verifying.key).

[Sprout proving and verifying routines](https://github.com/zcash/zcash/blob/master/src/zcash/JoinSplit.cpp)

[[BCTV14](https://eprint.iacr.org/2013/879)]

[libsnark proving system](https://github.com/scipr-lab/libsnark/tree/master/libsnark/zk_proof_systems/ppzksnark) and its [Zcash fork](https://github.com/zcash/zcash/tree/master/src/snark/libsnark/zk_proof_systems/ppzksnark/r1cs_ppzksnark)

### What is not affected?

The newer Sprout-on-Groth16 system used by Zcash mainnet for Sprout addresses ever since the Sapling activation (block 419200 at 28 Oct 2018) is not affected by the counterfeiting vulnerability. It uses a new Sprout circuit, that runs on the Groth16 proving system, with new parameters, and operates on the BLS12-381 curve implemented in the Bellman library. The newer Sapling system for shielded funds, activated at the same time and using a new address format, is not vulnerable either.

The vulnerability is not present in the algorithms of [[PGHR13](https://eprint.iacr.org/2013/279)] (which underlies [[BCTV14](https://eprint.iacr.org/2013/879)]), nor in [[BCGTV13](https://eprint.iacr.org/2013/507)], which used similar techniques. It is also not present in other zk-SNARKs constructions, such as [[GM17](https://eprint.iacr.org/2017/540.pdf)] or [[BG18](https://eprint.iacr.org/2018/187)], or in zero-knowledge proof systems that do not rely on a structured reference string. It is not present in libsnark when used with its built-in parameter generator.

#### Resources:

[New Sprout-on-Groth16 circuit implementation](https://github.com/zcash-hackworks/sapling-crypto/tree/master/src/circuit)

[New Sprout-on-Groth16 zk-SNARK parameters](https://z.cash/downloads/sprout-groth16.params)

[New Sprout-on-Groth16 proving and verifying routines](https://github.com/zcash/librustzcash)

[Groth16 proving system](https://github.com/zkcrypto/bellman)

## Third Party Disclosure

An analysis of the market cap of affected projects revealed that we could reach more than a two thirds majority of affected capital with only two disclosures: Horizen, with whom we already had a reciprocal vulnerability disclosure agreement, and Komodo who we worked with to form a disclosure agreement in order to disclose this issue to them privately.

We established a ninety-day maximum public disclosure timeline with both parties, and provided the conditions required for a workable solution.

Further disclosure would have significantly increased the risk of exploitation of the majority of capital for much smaller gains in terms of coverage of users and capital. To protect the shielded pools of these and other projects, exact details of the cause of the vulnerability were redacted from the private disclosures. It appears that both Horizen and Komodo have taken appropriate actions per our recommendation. We recommend that third parties including affected projects, wallets, and exchanges, carefully consider how best to work through the upgrades needed to fix this issue.

## Timeline of Events

### 01 March 2018

Ariel Gabizon, a cryptographer working for the Zcash Company, discovered the flaw while attending the Financial Cryptography 2018 conference, where he had been invited to present [[BGG17](https://eprint.iacr.org/2017/602)] to the Bitcoin’18 workshop. Sean Bowe, a cryptographer at the Zcash Company, and Zooko Wilcox, the CEO of the Zcash Company, were also attending the conference.

The issue was discovered by Ariel the night before his presentation, and he contacted Sean to confirm. Sean met Ariel in person and the two contacted Zooko immediately. Zooko then met Sean and Ariel in person to determine a response strategy. It was quickly determined that the transcript (which would allow an adversary to create false proofs) should be deleted from where it had been publicly made available by the company, since it appeared unlikely that many had downloaded it until that point. Zooko contacted Nathan Wilcox, the CTO of the Zcash Company, to ask him to delete the transcript.

### 02 March 2018 – 27 October 2018

Nathan deleted the transcript under a coinciding operational security cover story.

Sean had an additional backup of the transcript, which was later transferred into the dual possession of Sean and Zooko (Sean kept an encryption key, while Zooko deposited the USB in a safe deposit box) until it was later decided to destroy the backup entirely.

Two mitigation strategies were proposed. Ariel proposed a mitigation which involved an emergency hardfork that required users to switch to new zk-SNARK parameters that did not suffer from the vulnerability, by re-randomizing or replacing the existing parameters in a subsequent ceremony. Sean proposed that the mitigation be covertly included in the Sapling network upgrade by switching to the Groth16 proving system and parameters constructed in the upcoming Sapling ceremony. The team agreed to adopt Sean’s recommendation.

Covert mitigations were developed and deployed without further known disclosures beyond these four individuals.

### 28 October 2018

The Sapling network upgrade activated successfully on the Zcash mainnet, removing the counterfeiting vulnerability.

### 01 November 2018

The director of product security at the Zcash Company, Benjamin Winston, was briefed on the vulnerability and worked with the existing team to prepare disclosure packages for other affected projects.

### 09 November 2018

Josh Swihart, vice president of marketing and business development at the Zcash Company was briefed on the vulnerability in order to coordinate and prepare communications for two possible scenarios: full disclosure (this and related communications), or a leak by the parties to which information was initially released prior to the full disclosure date.

### 13 November 2018

The Zcash Company disclosed the impact and fix path of this issue to Horizen’s (previously known as ZenCash) security team ([[email protected]](/cdn-cgi/l/email-protection)) and Komodo ([[email protected]](/cdn-cgi/l/email-protection)) using PGP encrypted email.

The Zcash Company did not disclose the specifics of the vulnerability, only its existence and our recommendation to upgrade their proving system to Groth16. We also did not tell them who else was notified. The [complete message and disclosure sent to both Horizen and Komodo](#correspondence-horizen-komodo) is copied below.

Three hours later, Zencash responded to say that they had decrypted our message and that they were looking into the issue.

### 16 November 2018

Komodo responded to say that they’d received the notification. Later communication made it clear that they were working on a fix.

### 18 November 2018

Sean reconstructed the transcript from the DVDs collected from the participants of the original ceremony. Sean posted the reconstituted [transcript](https://s3.amazonaws.com/zcashfinalmpc/transcript).

### 10 December 2018

Zcash Company team members (Benjamin, Josh, Zooko) met with the Horizen team by video conference. The Horizen team members present were Alberto Garofollo, Dean Steinbeck, Maurizio Binello, Rob Viglione, Rosario Pabst. In the meeting we discussed the timeline for full disclosure. The Horizen team asked to be given the details of the full disclosure prior to posting. We did not agree to provide them these details.

### 20 December 2018

Zooko notified and briefed David Campbell, COO of the Zcash Company.

### 05 January 2019

Zooko notified and briefed Zcash founding scientists Eli-Ben Sasson, Eran Tromer, Madars Virza and Matthew Green. These founding scientists, along with Alessandro Chiesa, were the original authors of [[BCTV14](https://eprint.iacr.org/2013/879)] and [[BGG17](https://eprint.iacr.org/2017/602)].

### 08 January 2019

Zooko notified and briefed Zcash founding scientist Alessandro Chiesa.

### 25 January 2019

Benjamin and Josh briefed John O’Brien, partner at Strange Brew Strategies, who serves as the Zcash Company PR firm, in preparation for supporting press inquiries.

### 29 January 2019

Sean and Ariel briefed Zcash company cryptographers Daira Hopwood and Jack Grigg.

Benjamin filed for a CVE number for this issue, and received CVE-2019-7167 from mitre.org.

### 31 January 2019

Benjamin and Josh met with Steve Lee from Komodo to coordinate the public release of information.

### 01 February 2019

Benjamin and Josh briefed Zcash team members Brad Miller, Elise Hamdon and Paige Peterson for readiness and assistance in preparation for public disclosure. Andy Murray, Zcash Company CFO, was briefed by David Campbell.

### 04 February 2019

Jack Gavigan, head of product and regulatory relations was briefed.

The Zcash Foundation and its board members were briefed.

All employees and contractors working full time at the Zcash Company were briefed on a joint conference call.

Community member and forum moderator mineZcash (pseudonym) was briefed.

Sprout ceremony participants Derek Hinch of the NCC Group and John Dobbertin (pseudonym) were briefed.

CVE-2019-7167 details were updated.

### 05 February 2019

The Zcash Company public disclosure through the blog post, social media channels and direct contacts with other 3rd parties.

CVE-2019-7167 released with the text as shown in this post.

## List of References

[BCTV14] <https://eprint.iacr.org/2013/879>

[PGHR13] [https://eprint.iacr.org/2013/279](https://eprint.iacr.org/2013/279.pdf)

[BGG17] <https://eprint.iacr.org/2017/602>

[Parno15] <https://eprint.iacr.org/2015/437>

[snarkjs] <https://github.com/iden3/snarkjs>

[[Groth16](https://eprint.iacr.org/2016/260)] <https://eprint.iacr.org/2016/260>

### Papers inheriting the soundness vulnerability from [BCTV14]:

[BBFR14] [https://eprint.iacr.org/2014/617](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2014/617)

[Fuchsbauer17] [https://eprint.iacr.org/2017/587](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2017/587)

## Technical Details of CVE-2019-7167

Title
\*\*\*\*\*

BCTV14 setup produces elements that violate soundness leading to Counterfeiting Vulnerability in Zcash and others

Description
\*\*\*\*\*\*\*\*\*\*

The construction described by [BCTV14] in Appendix B, is a variant of the [PGHR13] zk-SNARK scheme with modifications to improve performance. This scheme was used in the original 2016 launch of Zcash and has been independently implemented by several other projects.

Ariel Gabizon, while working for the Zcash company, discovered a soundness bug in [BCTV14] that is described in this security notice:

The key generation procedure of [BCTV14], in step 3, produces various elements that are the result of evaluating polynomials related to the statement being proven. Some of these elements are unused by the prover and were included by mistake; but their presence allows a cheating prover to circumvent a consistency check, and thereby transform the proof of one statement into a valid-looking proof of a different statement. This breaks the soundness of the proof system. We refer to these elements as “bypass elements.”

The [BGG17] multi-party computation (MPC) protocol that produces parameters for the [BCTV14] construction follows the setup procedure closely, and so the bypass elements are produced. They are not included in the actual proving key distributed to Zcash nodes since they are explicitly excluded from the parameter file format used by the proving routine implementation of [BCTV14] in the “libsnark” library (used by Sprout). However, these elements do appear in the MPC ceremony transcript. Consequently, anyone with access to the ceremony transcript would have been able to create false proofs.

The vulnerability also affects an older MPC scheme [BCGTV15]. This vulnerability was also included in some independent implementations of [BCTV14], such as [snarkjs], even though they do not require an MPC. Similar flaws can be found in the [BBFR14] and [Fuchsbauer17] zk-SNARK schemes, which are adaptations of [BCTV14].

Impact
\*\*\*\*\*

The ability to break soundness in the proving system permits the creation of false proofs. Zero-knowledge proofs are used in a system like Zcash to ensure that transactions are valid, so this implies the ability to create an unlimited amount of shielded coins where the verifier is affected by this bug.

Credit
\*\*\*\*\*\*

This vulnerability was discovered by Ariel Gabizon while he was working for the Zerocoin Electric Coin Company.

What is affected?
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

Any project that implements [BCTV14] and does not completely dispose of the bypass elements as part of the setup process.

That includes but is not limited to any project that depends on the trusted setup used by the original Sprout system that was distributed in the initial 2016 launch of Zcash. This original Sprout system for shielded funds is comprised of the original Sprout circuit, the [BCTV14] proving system using libsnark, and the parameters generated by an MPC ceremony [BGG17]. It was used by the 1.x series of Zcash software (which also carried the “Sprout” name).

[BCTV14] is available at [https://eprint.iacr.org/2013/879](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2013/879)

The original Sprout circuit implementation is here: [https://github.com/zcash/zcash/tree/32d3a3352e45457f689585cc49d554599583bbd0/src/zcash/circuit](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/zcash/tree/32d3a3352e45457f689585cc49d554599583bbd0/src/zcash/circuit)

The original Sprout zk-SNARK parameters are here: [https://z.cash/downloads/sprout-proving.key](https://web.archive.org/web/20231206230039/https%3A//z.cash/downloads/sprout-proving.key) (sha256sum: 8bc20a7f013b2b58970cddd2e7ea028975c88ae7ceb9259a5344a16bc2c0eef7) and [https://z.cash/downloads/sprout-verifying.key](https://web.archive.org/web/20231206230039/https%3A//z.cash/downloads/sprout-verifying.key) (sha256sum: 4bd498dae0aacfd8e98dc306338d017d9c08dd0918ead18172bd0aec2fc5df82)

The Sprout proving and verifying routines are here: [https://github.com/zcash/zcash/blob/685c0ab07fd90b244dac5e2cb1f069ac6151ec5c/src/zcash/JoinSplit.cpp](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/zcash/blob/685c0ab07fd90b244dac5e2cb1f069ac6151ec5c/src/zcash/JoinSplit.cpp)

The BCTV14 proving system implementation (in libsnark) is here: [https://github.com/zcash/zcash/tree/c938fb1f179d9bdefc5bc7e55fc6330a8b8d3713/src/snark/libsnark/zk\_proof\_systems/ppzksnark/r1cs\_ppzksnark](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/zcash/tree/c938fb1f179d9bdefc5bc7e55fc6330a8b8d3713/src/snark/libsnark/zk_proof_systems/ppzksnark/r1cs_ppzksnark)

What is not affected?
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

The newer Sprout-on-Groth16 system used by Zcash mainnet for Sprout addresses ever since the Sapling activation (block 419200 at 28 Oct 2018) is not affected by the counterfeiting vulnerability. It uses a new Sprout circuit, that runs on the Groth16 proving system, with new parameters, and operates on the BLS12-381 curve implemented in the Bellman library. The newer Sapling system for shielded funds, activated at the same time and using a new address format, is not vulnerable either.

The vulnerability is not present in the algorithms of [PGHR13] (which underlies [BCTV14]), nor in [BCGTV13], which used similar techniques. It is also not present in other zk-SNARKs constructions, such as [GM17] or [BG18], or in zero-knowledge proof systems that do not rely on a structured reference string. It is not present in libsnark when used with its built-in parameter generator.

The new Sprout-on-Groth16 circuit implementation is located here at time of publishing this information: [https://github.com/zcash-hackworks/sapling-crypto/tree/master/src/circuit](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash-hackworks/sapling-crypto/tree/master/src/circuit)

The new Sprout-on-Groth16 zk-SNARK parameters are located here at time of publishing this information: [https://z.cash/downloads/sprout-groth16.params](https://web.archive.org/web/20231206230039/https%3A//z.cash/downloads/sprout-groth16.params)

The new Sprout-on-Groth16 proving and verifying routines are located in the librustzcash library (at time of publishing): [https://github.com/zcash/librustzcash](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/librustzcash)

The Groth16 proving system is implemented in the Bellman Rust library: [https://github.com/zkcrypto/bellman](https://web.archive.org/web/20231206230039/https%3A//github.com/zkcrypto/bellman)

Mitigation
\*\*\*\*\*\*\*\*\*

Users of projects still affected by this issue should change the zk-SNARK parameters to some that are not affected by this bug. Zcash switched to new parameters using a new “Sprout-on-Groth16” proving system as of the Sapling network upgrade on October 28th 2018, and so is not affected by the bug.

Therefore, users of Zcash do not need to take any action.

Projects still affected by this vulnerability that do not wish to switch proving systems might instead wish to perform their own parameter setup to produce replacement parameters. Projects following this path are strongly encouraged to use a large, public MPC with thorough security analysis. In the interim, they are advised to disable functionality (e.g., shielded transactions) that relies on the affected proof system.

References
\*\*\*\*\*\*\*\*\*\*

[BCTV14] [https://eprint.iacr.org/2013/879](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2013/879)

[PGHR13] [https://eprint.iacr.org/2013/279](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2013/279.pdf)

[BGG17] [https://eprint.iacr.org/2017/602](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2017/602)

[Parno15] [https://eprint.iacr.org/2015/437](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2015/437)

[BCGTV15] [https://www.ieee-security.org/TC/SP2015/papers-archived/6949a287.pdf](https://web.archive.org/web/20231206230039/https%3A//www.ieee-security.org/TC/SP2015/papers-archived/6949a287.pdf)

[snarkjs] [https://github.com/iden3/snarkjs](https://web.archive.org/web/20231206230039/https%3A//github.com/iden3/snarkjs)

Papers inheriting this issue from [BCTV14]:

[BBFR14] [https://eprint.iacr.org/2014/617](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2014/617)

[Fuchsbauer17] [https://eprint.iacr.org/2017/587](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2017/587)

## Correspondence to Horizen and Komodo

Hello,

There is a serious vulnerability in your software. Enclosed is a private advisory with more detail about the vulnerability. We strongly recommend keeping the impact of this issue secret until your project is able to deploy mitigations, because of the associated risks to projects that are still affected and people who know the details.

The issue was discovered internally at Zcash and extreme caution has been exercised to protect its existence from premature disclosure, to avoid exploitation anywhere and to assure the availability of our network and the safety of our people. With the activation of Sapling, our network is no longer vulnerable to this bug, but we’d like to take the right steps to provide you a similar opportunity without putting any of our people at risk.

The vulnerability allows an attacker to create very large, virtually unlimited amounts of counterfeit shielded tokens without detection.

In order to mitigate this bug, we recommend a hardfork that adopts the newer Groth16 implementation of Sprout shielded transactions, which uses a more secure circuit implementation and parameters and is not affected by this bug.

This mitigation was successfully deployed in Zcash as part of the Sapling network upgrade. This mitigation has several advantages, but among them is that it does not require alerting anyone to the existence of a security bug in order to deploy, because the upgrade has legitimate performance and security benefits beyond fixing this bug.

Other possible mitigations for this bug have been analyzed and determined to be too expensive and risky to undertake. Further, revealing those considerations would make it harder for you to protect your users, given that other projects are also affected. Our best effort has been put into developing a strong mitigation to this bug in our own software, which we believe now presents you with a far simpler upgrade path than you might otherwise face.

We have disclosed this to the largest projects who use this code by market cap in order to protect the largest possible amount of capital, however we have decided not to alert all other affected projects yet.

I would like to assign a CVE to this issue, then publish the full details of this vulnerability publicly and notify all remaining affected projects no later than ninety days from today’s date: Today is Tuesday November 13th 2018, meaning I’d like to publicly disclose full details of this issue before Monday February 11th 2019 at the latest.

I will do my best to assist you in understanding the software upgrade path.

Benjamin Winston [[email protected]](/cdn-cgi/l/email-protection)
Director of Product Security, z.cash

Title
\*\*\*\*\*

Sprout shielded transaction bug allows for unlimited counterfeiting.

Description
\*\*\*\*\*\*\*\*\*\*\*

A fundamental cryptographic flaw exists that allows an attacker to create proofs that falsely convince the original Sprout zk-SNARK verifier of the correctness of a transaction.

Impact
\*\*\*\*\*\*

By exploiting this bug, an attacker could create fake Sprout shielded notes containing large amounts of counterfeit funds without being detected.

Credit
\*\*\*\*\*\*

We would like to include credit for this discovery in a coordinated public release after your software is fixed and your users are safe.

What is affected?
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

Any project that depends on the original Sprout system that was distributed in the initial launch of Zcash.

The original Sprout zk-SNARK system is comprised of the original Sprout circuit and parameters on the [BCTV14] proving system using libsnark and was used by the 1.x series of Zcash software (which also carried the “Sprout” name).

The original Sprout circuit implementation is here:
[https://github.com/zcash/zcash/tree/master/src/zcash/circuit](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/zcash/tree/master/src/zcash/circuit)

The original Sprout zk-SNARK parameters are here:
[https://z.cash/downloads/sprout-proving.key](https://web.archive.org/web/20231206230039/https%3A//z.cash/downloads/sprout-proving.key)
[https://z.cash/downloads/sprout-verifying.key](https://web.archive.org/web/20231206230039/https%3A//z.cash/downloads/sprout-verifying.key)

The Sprout proving and verifying routines are here:
[https://github.com/zcash/zcash/blob/master/src/zcash/JoinSplit.cpp](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/zcash/blob/master/src/zcash/JoinSplit.cpp)

The BCTV14 proving system implementation (in libsnark) is here:
[https://github.com/zcash/zcash/tree/master/src/snark/libsnark/zk\_proof\_systems/ppzksnark/r1cs\_ppzksnark](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/zcash/tree/master/src/snark/libsnark/zk_proof_systems/ppzksnark/r1cs_ppzksnark)

What is not affected?
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

The newer Sprout-on-Groth16 system used by Zcash mainnet for Sprout transactions on and after block 419200 is not affected by this bug. It uses a new Sprout circuit, that runs on the Groth16 proving system, new parameters and operates on the BLS12-381 curve implemented in the Bellman library.

The new Sprout-on-Groth16 circuit implementation is located here:
[https://github.com/zcash-hackworks/sapling-crypto/tree/master/src/circuit](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash-hackworks/sapling-crypto/tree/master/src/circuit)

The new Sprout-on-Groth16 zk-SNARK parameters are located here:
[https://z.cash/downloads/sprout-groth16.params](https://web.archive.org/web/20231206230039/https%3A//z.cash/downloads/sprout-groth16.params)

The new Sprout-on-Groth16 proving and verifying routines are located in the librustzcash library:
[https://github.com/zcash/librustzcash](https://web.archive.org/web/20231206230039/https%3A//github.com/zcash/librustzcash)

The Groth16 proving system is implemented in the Bellman Rust library:
[https://github.com/zkcrypto/bellman](https://web.archive.org/web/20231206230039/https%3A//github.com/zkcrypto/bellman)

Mitigation
\*\*\*\*\*\*\*\*\*\*

We strongly recommend that you switch to the newer Sprout-on-Groth16 zk-SNARK system, as it is not vulnerable to this bug.

Publication Timeline
\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*

We would like to publish this vulnerability publicly and notify all other affected projects who are not in our initial distribution list using Github’s security response system, and on our social media channels and website no later than 90 days from today’s date. Today is Tuesday November 13th 2018, meaning I’d like to publicly disclose full details of this issue before Monday February 11th 2019 at the latest.

References
\*\*\*\*\*\*\*\*\*\*

[BCTV14] [https://eprint.iacr.org/2013/879](https://web.archive.org/web/20231206230039/https%3A//eprint.iacr.org/2013/879)

* [Technical](https://electriccoin.co/blog/category/technical/)
* [Security Announcement](https://electriccoin.co/blog/tag/security-announcement/)

[Zcash Shielded Addresses are GDPR Compliant by Default](https://electriccoin.co/blog/zcash-shielded-addresses-are-gdpr-compliant-by-default/)

[People Behind Zcash Technology: Marshall Gaucher, Engineer](https://electriccoin.co/blog/people-behind-zcash-technology-marshall-gaucher-engineer/)

![](https://electriccoin.co/wp-content/uploads/2024/03/ec-co.svg)

## Recent blog posts:

* ### [ECC Transparency Report for Q2 2024](https://electriccoin.co/blog/ecc-transparency-report-for-q2-2024/)
* ### [Drumroll Please: Introducing Zashi-Keystone Hardware Wallet Integration for Shielded ZEC](https://electriccoin.co/blog/drumroll-please-introducing-zashi-keystone-hardware-wallet-integration-for-shielded-zec/)
* ### [Zashi-Flexa Integration is Here: Spend ZEC at Thousands of Retailers!](https://electriccoin.co/blog/zashi-flexa-integration-is-here-spend-zec-at-thousands-of-retailers/)
* ### [Zcash Halvening & NU6: Embracing the New Dev Fund](https://electriccoin.co/blog/zcash-halvening-nu6-embracing-the-new-dev-fund/)

* [See all](/blog/)

## Newsletter signup:

Email

Submit

[![ECC Logo](https://electriccoin.co/wp-content/uploads/2024/03/logo-ecc.svg)](/)

* [Zashi wallet](/zashi/)
* [ECC roadmap](/roadmap/)
* [Blog](/blog/)
* [Careers](/jobs/)
* [Zcash website](https://z.cash)
* [Copyright policy](/copyright-policy/)
* [Manage cookies](/manage-cookies/)

[X-twitter](https://twitter.com/electriccoinco)

[Linkedin](https://www.linkedin.com/company/electriccoinco)

[Youtube](https://www.youtube.com/zcashco)

##### Can we store cookies?

We sometimes use cookies to improve the performance of our website. Choose what you allow.

CustomizeNoYesConsent Preferences

Close

#### Our Features

We sometimes use cookies to improve the performance of our website. Choose what you allow.

Essential
 Essential

Always Enabled

This includes key features like page navigation and logging you in. The website cannot function without this.
**Who do we share data with?**

| Description |
| --- |
| [Google Analytics](https://www.google.com/intl/en/policies/privacy/) |
| [Google Optimize](https://policies.google.com/privacy?hl=en) |
| [Google Tag Manager](https://www.google.com/intl/en/policies/privacy/) |
| [New Relic](https://newrelic.com/privacy) |
| [Sendgrid](https://www.twilio.com/legal/privacy) |

**Does this policy need cookies to work?**
Yes.

Marketing

marketing

This tells us it's okay for us to use your information for marketing specifically.
**Who do we share data with?**

| Description |
| --- |
| [Hotjar](https://www.hotjar.com/legal/policies/privacy/) |

**Does this policy need cookies to work?**
Yes.

No Save My Preferences Yes



=== Content from lists.linuxfoundation.org_f8a8dee2_20250126_032236.html ===

```
[public inbox for bitcoindev@googlegroups.com](../?t=20180702230317)
 [help](../_/text/help/) / [color](../_/text/color/) / [mirror](../_/text/mirror/) / [Atom feed](../new.atom)
```
```
From: Bryan Bishop <kanzure@gmail•com>
To: Bitcoin Dev <bitcoin-dev@lists•linuxfoundation.org>,
	Bryan Bishop <kanzure@gmail•com>
Subject: [[bitcoin-dev] Alert key disclosure](#r)
Date: Mon, 2 Jul 2018 18:03:13 -0500	[[thread overview]](#r)
Message-ID: <CABaSBay8r4JkXkgUZJm30tZKHk-55ho6-C5Hf15ovuNk_VZWEg@mail.gmail.com> (<raw>)

The bitcoin alert keys are disclosed in this email, followed by a
disclosure of various known vulnerabilities in what was once the alert
system. The bitcoin alert system has been completely retired. The
network is not at risk and this warning may be safely ignored if you
do not have an ancient node (running v0.12.x or older) using the
deprecated bitcoin alert system or its public keys.

mainnet public key:
04fc9702847840aaf195de8442ebecedf5b095cdbb9bc716bda9110971b28a49e0ead8564ff0db22209e0374782c093bb899692d524e9d6a6956e7c5ecbcd68284

mainnet private key:
30820113020101042053cdc1e0cfac07f7e1c312768886f4635f6bceebec0887f63a9d37a26a92e6b6a081a53081a2020101302c06072a8648ce3d0101022100fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f300604010004010704410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8022100fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141020101a14403420004fc9702847840aaf195de8442ebecedf5b095cdbb9bc716bda9110971b28a49e0ead8564ff0db22209e0374782c093bb899692d524e9d6a6956e7c5ecbcd68284

testnet public key:
04302390343f91cc401d56d68b123028bf52e5fca1939df127f63c6467cdf9c8e2c14b61104cf817d0b780da337893ecc4aaff1309e536162dabbdb45200ca2b0a

testnet private key:
308201130201010420474d447aa6f46b4f45f67f21180a5de2722fc807401c4c4d95fdae64b3d6c294a081a53081a2020101302c06072a8648ce3d0101022100fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f300604010004010704410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8022100fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141020101a14403420004302390343f91cc401d56d68b123028bf52e5fca1939df127f63c6467cdf9c8e2c14b61104cf817d0b780da337893ecc4aaff1309e536162dabbdb45200ca2b0a

These are openssl-serialized private keys.

In 2016, a plan was proposed[1] for the completion of the retirement
of the bitcoin alert system which included the idea of revealing the
alert system private keys. The proposal still contains good
information regarding the purpose and intention of alert system
retirement and motivation for the disclosure of the private keys.
Additionally, an overview of the alert system retirement and its
timeline is available on the web at [2]. This disclosure was recently
discussed in an IRC meeting logs at [3]. A media site also recently
discussed this topic[4].

One of the reasons for disclosure of the keys is to mitigate the
effects of unknown dissemination and proliferation of the keys. By
broadcasting the values to make them available to everyone, the value
of the keys is intended to be to be eliminated, since now everyone
could feasibly sign messages, the value of the signed messages becomes
zero.

[1] <https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-September/013104.html>
[2] <https://bitcoin.org/en/alert/2016-11-01-alert-retirement>
[3] <http://www.erisian.com.au/meetbot/bitcoin-core-dev/2018/bitcoin-core-dev.2018-06-21-19.00.log.html#l-30>
[4] <https://www.coindesk.com/long-secret-bitcoin-key-finally-revealed/>

# Vulnerabilities in the bitcoin alert system

The following text[5] discloses a number of known vulnerabilities in
the alert system. Writeup contributed by achow101.

[5] <https://gist.github.com/achow101/18a2dfc371c421419d494a3ae0447f66>

The Alert System previously utilized by Bitcoin has several issues
(some of which may be classified as vulnerabilities). These issues no
longer exist in Bitcoin as of network protocol version 700013 which
was released with Bitcoin Core 0.13.0. Many altcoins and Bitcoin
client implementations were notified of the Alert System's removal and
have since removed the alert system themselves or transitioned to
using an Alert system that does not share an Alert Key with Bitcoin.

All of the issues described below allow an attacker in possession of
the Alert Key to perform a Denial of Service attack on nodes that
still support the Alert system. These issues involve the exhaustion of
memory which causes node software to crash or be killed due to
excessive memory usage.

Many of these issues were not known until the Alert System was removed
as developers inspected the code for vulnerabilities prior to
releasing the Alert Key. Due to these issues, the publication of the
Alert Key was delayed and affected altcoins and software were
notified.

As of this writing, less than 4% of Bitcoin nodes are vulnerable.
Furthermore, the Bitcoin Core developers have created a "final alert"
which is a maximum ID number alert which overrides all previous alerts
and displays a fixed "URGENT: Alert key compromised, upgrade required"
message on all vulnerable software. The Bitcoin Core developers
believe that so few vulnerable nodes are present on the network, and
risks to those nodes so minor, that it is safe to publish the Alert
Key.

An Alert contains these fields:

    int32_t nVersion;
    int64_t nRelayUntil;      // when newer nodes stop relaying to newer nodes
    int64_t nExpiration;
    int32_t nID;
    int32_t nCancel;
    std::set<int32_t> setCancel;
    int32_t nMinVer;            // lowest version inclusive
    int32_t nMaxVer;            // highest version inclusive
    std::set<std::string> setSubVer;  // empty matches all
    int32_t nPriority;

Alerts are also identified by their SHA256 hash. The above fields can
be freely modified to generate alerts with differing hashes.

# Infinitely sized map (CVE-2016-10724)

The Alert System was designed to support multiple Alerts
simultaneously. As such, Alerts were stored in memory in a map.
However, there is no limit on how large this map can be, thus an
attacker with the Alert Key can send a large number of Alerts to a
node. Eventually, the map containing all of the Alerts will be so
large that the node runs out of memory and crashes, thus causing a
Denial of Service attack.

The infinitely sized map is the basis for which the Alert system can
be used to cause Denial of Service attacks.

# Infinitely sized alerts

Although the infinitely sized map is what causes the crash itself, an
attacker can also send very large Alerts. Alerts themselves are not
limited in size explicitly, they are only limited by the maximum
network message size. This maximum network message size has varied
between versions. At times in the past, it has been 32 MB. For Bitcoin
Core 0.12.0 (the most recent version of Bitcoin Core with the alert
system enabled by default), the maximum message size is 2 MB.

Although large Alerts do not directly cause a Denial of Service by
themselves, combined with the infinitely sized map, large Alerts can
more quickly cause a node to run out of memory.

* The setCancel field has no length limit (besides the maximum message
size) and is a std::set of 32-bit integers. Given that it has no size
constraints, an attacker can use this field to create a very large
Alert by filling the set with many integers.

* The setSubVer field, like setCancel, has no length limit and is a
std::set. However instead of integers it has std::strings. These
strings do not have a length limit themselves and can thus be
arbitrarily long to produce an Alert that is arbitrarily large.

* Bitcoin Core versions prior to 0.10.0 did not have a limit on the
length of the strComment, strStatusBar, and strReserved fields. These
strings can have an arbitrary length.

# The final alert

To protect against attackers abusing the Alert key following its
publication, the Bitcoin Core developers constructed a "final alert".
This final alert is a maximum ID alert which overrides all previous
alerts. All Bitcoin Core versions since and including Bitcoin Core
0.14.0 contain the final alert and will send it to any node which is
vulnerable to issues including the following disclosures. However this
protection is not enough to protect those nodes as a few issues were
found with the final alert implementation itself.

Final alerts are those which meet the following conditions:

    nExpiration == maxInt &&
    nCancel == (maxInt-1) &&
    nMinVer == 0 &&
    nMaxVer == maxInt &&
    setSubVer.empty() &&
    nPriority == maxInt &&
    strStatusBar == "URGENT: Alert key compromised, upgrade required"

maxInt is the maximum signed integer as defined by
std::numeric_limits<int>::max().

# Multiple final alerts

The definition for a final alert does not include a few fields.
Because alerts are identified by their hashes, changing the omitted
fields allows an Alert to be classified as a final alert but still be
an alert that is added to the infinitely sized map. The nCancel field
omits the maxInt ID number used by the final alert so all of the final
alerts share the same ID.

* Since setCancel is not required to be empty for an alert to be a
final alert, the setCancel field can contain different integers to
produce alerts that have different hashes and are thus different
alerts. Combined with the infinitely sized map and the infinitely
sized setCancel issues, many final alerts can be created which are
large, fill the map, and cause a node to run out of memory.

* The strComment field, while having a maximum length of 65536 bytes
(and no maximum length prior to Bitcoin Core version 0.10.0), is not
required to be a particular string in order for an alert to be a final
alert. Thus multiple final alerts can be crafted which have different
hashes by using different values for strComment

* The strReserved field, while having a maximum length of 256 bytes,
is not required to be a particular string in order for an alert to be
a final alert. Thus multiple final alerts can be crafted which have
different hashes by using different values for strReserved.

* The nVersion field is also not required to be a particular value.
Thus this can be used to construct final alerts with different hashes
by having different values for nVersion.

* nRelayUntil field is also not required to be a particular value.
Thus this can be used to construct final alerts with different hashes
by having different values for nRelayUntil.

# Final Alert Cancellation (CVE-2016-10725)

Although the final alert is supposed to be uncancellable, it
unfortunately is cancellable due to the order of actions when
processing an alert. Alerts are first processed by checking whether
they cancel any existing alert. Then they are checked whether any of
the remaining alerts cancels it. Because of this order, it is possible
to create an alert which cancels a final alert before the node checks
whether that alert is canceled by the final alert. Thus an attacker
can cancel a final alert with another alert allowing a node to be
vulnerable to all of the aforementioned attacks.

# Protecting against DoS attacks from the alert system

Fixing these issues is relatively easy. The first and most obvious
solution is to simply remove the Alert system entirely. As nodes
upgrade to versions without the Alert system, fewer nodes will be
vulnerable to attack should the Alert keys become public. This is the
option that Bitcoin has taken. However, because Bitcoin has retired
the Alert system entirely, the Alert key will also be published to
reduce the risk that the Alert Key is mistakenly depended upon in the
future.
Should altcoins wish to continue using the Alert system but with a
different Alert Key, a few very simple fixes will safeguard nodes from
the aforementioned issues. Limiting the number of alerts, the size of
setCancel and setSubVer, and only allowing one final alert altogether
fix the above issues. This patch[6], on top of Bitcoin Core 0.11 (a
vulnerable version), fixes the aforementioned issues. Altcoins that
still use the Alert system are recommended to port this patch to their
software. Outdated node software is still vulnerable.

[6] <https://gist.github.com/achow101/02d03238090691558a68010a9ccbbf9d>

This disclosure was authored primarily by Bryan Bishop (kanzure) and
Andrew Chow (achow101). Special thanks to reviewers. Also, an
interesting proposal was floated to not disclose the private keys in
WIF format-- one is that this is not how the original values were
received, and second (more importantly) to prevent users from
importing the key into their wallet and reusing it in their wallet key
circulation.

- Bryan
<http://heybryan.org/>
1 512 203 0507

```

---

```
                 [reply](#R)	other threads:[[~2018-07-02 23:03 UTC](../?t=20180702230317)|[newest](../)]

Thread overview: [no followups] expand[[flat](T/#u)|[nested](t/#u)]  [mbox.gz](t.mbox.gz)  [Atom feed](t.atom)

```

---

```
Reply instructions:

You may reply publicly to [this message](#t) via plain-text email
using any one of the following methods:

* Save the following mbox file, import it into your mail client,
  and reply-to-all from there: [mbox](raw)

  Avoid top-posting and favor interleaved quoting:
  <https://en.wikipedia.org/wiki/Posting_style#Interleaved_style>

* Reply using the --to, --cc, and --in-reply-to
  switches of git-send-email(1):

  git send-email \
    --in-reply-to=CABaSBay8r4JkXkgUZJm30tZKHk-55ho6-C5Hf15ovuNk_VZWEg@mail.gmail.com \
    --to=kanzure@gmail$(echo .)com \
    --cc=bitcoin-dev@lists$(echo .)linuxfoundation.org \
    /path/to/YOUR_REPLY

  <https://kernel.org/pub/software/scm/git/docs/git-send-email.html>

```
Be sure your reply has a **Subject:** header at the top and a blank line
before the message body.

---

```
This is a public inbox, see [mirroring instructions](../_/text/mirror/)
for how to clone and mirror all data and code used for this inbox
```


=== Content from en.bitcoin.it_d953b06a_20250124_203623.html ===


# Common Vulnerabilities and Exposures

From Bitcoin Wiki

[Jump to navigation](#mw-head)
[Jump to search](#searchInput)

| CVE | Announced | Affects | Severity | Attack is... | Flaw | Net |
| --- | --- | --- | --- | --- | --- | --- |
| Pre-BIP protocol changes | n/a | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | [Various hardforks and softforks](/wiki/Consensus_versions "Consensus versions") | 100% |
| [CVE-2010-5137](#CVE-2010-5137) | 2010-07-28 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | OP\_LSHIFT crash | 100% |
| [CVE-2010-5141](#CVE-2010-5141) | 2010-07-28 | wxBitcoin and bitcoind | Theft[[4]](#cite_note-Theft-4) | Easy | OP\_RETURN could be used to spend any output. | 100% |
| [CVE-2010-5138](#CVE-2010-5138) | 2010-07-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Unlimited SigOp DoS | 100% |
| **[CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")** | 2010-08-15 | wxBitcoin and bitcoind | Inflation[[5]](#cite_note-inflation-5) | Easy | Combined output overflow | 100% |
| [CVE-2010-5140](#CVE-2010-5140) | 2010-09-29 | wxBitcoin and bitcoind | DoS[[3]](#cite_note-DoS-3) | Easy | Never confirming transactions | 100% |
| [CVE-2011-4447](#CVE-2011-4447) | 2011-11-11 | wxBitcoin and bitcoind | Exposure[[6]](#cite_note-Exposure-6) | Hard | Wallet non-encryption | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2011-4447.html) |
| [CVE-2012-1909](#CVE-2012-1909) | 2012-03-07 | Bitcoin protocol and all clients | Netsplit[[1]](#cite_note-Netsplit-1) | Very hard | Transaction overwriting | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1909.html) |
| [CVE-2012-1910](#CVE-2012-1910) | 2012-03-17 | bitcoind & Bitcoin-Qt for Windows | Unknown[[7]](#cite_note-Unknown-7) | Hard | Non-thread safe MingW exceptions | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-1910.html) |
| [BIP 0016](#BIP-0016) | 2012-04-01 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: P2SH | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0016.html) |
| [CVE-2012-2459](#CVE-2012-2459) | 2012-05-14 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Easy | Block hash collision (via merkle root) | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-2459.html) |
| **[CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")** | 2012-06-20 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | (Lack of) orphan txn resource limits | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20123789) |
| [CVE-2012-4682](#CVE-2012-4682) |  | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) |  |  | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4682.html) |
| **[CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")** | 2012-08-23 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Targeted DoS by CPU exhaustion using alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/CVE-2012-4683.html) |
| **[CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")** | 2012-08-24 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Network-wide DoS using malleable signatures in alerts | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20124684) |
| [CVE-2013-2272](#CVE-2013-2272) | 2013-01-11 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Remote discovery of node's wallet addresses | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132272) |
| [CVE-2013-2273](#CVE-2013-2273) | 2013-01-30 | bitcoind and Bitcoin-Qt | Exposure[[6]](#cite_note-Exposure-6) | Easy | Predictable change output | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132273) |
| [CVE-2013-2292](#CVE-2013-2292) | 2013-01-30 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Hard | A transaction that takes at least 3 minutes to verify | [0%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132292) |
| **[CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")** | 2013-02-14 | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Continuous hard disk seek | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20132293) |
| [CVE-2013-3219](#CVE-2013-3219) | 2013-03-11 | bitcoind and Bitcoin-Qt 0.8.0 | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Unenforced block protocol rule | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133219) |
| [CVE-2013-3220](#CVE-2013-3220) | 2013-03-11 | bitcoind and Bitcoin-Qt | Netsplit[[1]](#cite_note-Netsplit-1) | Hard | Inconsistent BDB lock limit interactions | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20133220) |
| [BIP 0034](#BIP-0034) | 2013-03-25 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Height in coinbase | [100%](http://luke.dashjr.org/programs/bitcoin/files/charts/BIP-0034.html) |
| [BIP 0050](#BIP-0050) | 2013-05-15 | All Bitcoin clients | Netsplit[[1]](#cite_note-Netsplit-1) | Implicit[[2]](#cite_note-hardfork-2) | Hard fork to remove txid limit protocol rule | [99.99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?50) |
| [CVE-2013-4627](#CVE-2013-4627) | 2013-06-?? | bitcoind and Bitcoin-Qt | DoS[[3]](#cite_note-DoS-3) | Easy | Memory exhaustion with excess tx message data | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134627) |
| [CVE-2013-4165](#CVE-2013-4165) | 2013-07-20 | bitcoind and Bitcoin-Qt | Theft[[10]](#cite_note-theft-local-timing-10) | Local | Timing leak in RPC authentication | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20134165) |
| [CVE-2013-5700](#CVE-2013-5700) | 2013-09-04 | bitcoind and Bitcoin-Qt 0.8.x | DoS[[3]](#cite_note-DoS-3) | Easy | Remote p2p crash via bloom filters | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| [CVE-2014-0160](#CVE-2014-0160) | 2014-04-07 | Anything using OpenSSL for TLS | Unknown[[7]](#cite_note-Unknown-7) | Easy | Remote memory leak via payment protocol | Unknown |
| [CVE-2015-3641](https://bitcoincore.org/en/2024/07/03/disclose_receive_buffer_oom/) | 2014-07-07 | bitcoind and Bitcoin-Qt prior to 0.10.2 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via p2p | [99.9%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20135700) |
| BIP 66 | 2015-02-13 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Strict DER signatures | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?66) |
| BIP 65 | 2015-11-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: OP\_CHECKLOCKTIMEVERIFY | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?65) |
| BIPs 68, 112 & 113 | 2016-04-11 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softforks: Rel locktime, CSV & MTP locktime | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?68) |
| CVE-2015-6031 | 2015-09-15 | MiniUPnPcBitcoin Core/Knots prior to 0.11.2 | Anything | LAN | Buffer overflow |
| BIPs 141, 143 & 147 | 2016-10-27 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?141) |
| [CVE-2016-8889](#CVE-2016-8889) | 2016-10-27 | Bitcoin Knots GUI 0.11.0 - 0.13.0 | Exposure | Hard | Debug console history storing sensitive info | 100% |
| CVE-2017-9230 | ? | Bitcoin | ? | ? | ASICBoost | 0% |
| BIP 148 | 2017-03-12 | All Bitcoin clients | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Segwit UASF | ? |
| [CVE-2017-12842](#CVE-2017-12842) | 2018-06-09 |  |  |  | No commitment to block merkle tree depth |  |
| [CVE-2016-10724](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Alert memory exhaustion | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-header-spam/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.15.0 | DoS[[3]](#cite_note-DoS-3) | Easy | OOM via fake block headers |
| [CVE-2016-10725](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html) | 2018-07-02 | bitcoind and Bitcoin-Qt prior to 0.13.0 | DoS[[3]](#cite_note-DoS-3) | Keyholders[[11]](#cite_note-KeyholderEasy-11) | Final alert cancellation | [99%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201610724) |
| [CVE-2018-17144](#CVE-2018-17144) | 2018-09-17 | bitcoind and Bitcoin-Qt prior to 0.16.3 | Inflation[[5]](#cite_note-inflation-5) | Miners[[9]](#cite_note-MinerEasy-9) | Missing check for duplicate inputs | [80%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817144) |
| [CVE-2018-20587](https://medium.com/%40lukedashjr/cve-2018-20587-advisory-and-full-disclosure-a3105551e78b) | 2019-02-08 | Bitcoin Knots prior to 0.17.1, and all current Bitcoin Core releases | Theft[[10]](#cite_note-theft-local-timing-10) | Local | No alert for RPC service binding failure | [<1%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820587) |
| [CVE-2017-18350](#CVE-2017-18350) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.15.1 | Unknown | Varies[[12]](#cite_note-12) | Buffer overflow from SOCKS proxy | [94%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201718350) |
| [CVE-2018-20586](#CVE-2018-20586) | 2019-06-22 | bitcoind and Bitcoin-Qt prior to 0.17.1 | Deception | RPC access | Debug log injection via unauthenticated RPC | [77%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201820586) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-orphan-dos/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.18.0 | DoS | Easy | Orphan transaction CPU tieup |
| [CVE-2019-12998](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | c-lightning prior to 0.7.1 | Theft | Easy | Missing check of channel funding UTXO |
| [CVE-2019-12999](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | lnd prior to 0.7 | Theft | Easy | Missing check of channel funding UTXO amount |
| [CVE-2019-13000](https://lists.linuxfoundation.org/pipermail/lightning-dev/2019-September/002174.html) | 2019-08-30 | eclair prior to 0.3 | Theft | Easy | Missing check of channel funding UTXO |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-inv-buffer-blowup/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Easy | Network buffer OOM |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-getdata-cpu/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | CPU usage | Easy | Infinite loop via p2p |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-bip70-crash/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.0 | DoS | Recipient[[13]](#cite_note-Recipient-13) | OOM via malicious BIP72 URI |
| [CVE-2020-14199](#CVE-2020-14199) | 2020-06-03 | Trezor and others | Theft | Social[[14]](#cite_note-14) | Double-signing can enable unintended fees |
| [CVE-2018-17145](https://invdos.net/) | 2020-09-09 | Bitcoin Core prior to 0.16.2Bitcoin Knots prior to 0.16.1Bcoin prior to 1.0.2Btcd prior to 0.21.0 | DoS[[3]](#cite_note-DoS-3) | Easy | p2p memory blow-up | [87%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?201817145) |
| [CVE-2020-26895](#CVE-2020-26895) | 2020-10-08 | lnd prior to 0.10 | Theft | Easy | Missing low-S normalization for HTLC signatures |
| [CVE-2020-26896](#CVE-2020-26896) | 2020-10-08 | lnd prior to 0.11 | Theft | Varies[[15]](#cite_note-15) | Invoice preimage extraction via forwarded HTLC |
| [CVE-2020-14198](https://bitcoincore.org/en/2024/07/03/disclose-unbounded-banlist/) |  | Bitcoin Core 0.20.1 | DoS[[3]](#cite_note-DoS-3) | Easy | Remote DoS | [93%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?202014198) |
| [TBD](https://bitcoincore.org/en/2024/07/03/disclose-timestamp-overflow/) | 2024-07-03 | Bitcoin Core/Knots prior to 0.20.2 | Netsplit[[1]](#cite_note-Netsplit-1) | Varies | Adjusted time manipulation |
| [CVE-2021-3401](#CVE-2021-3401) | 2021-02-01 | Bitcoin Core GUI prior to 0.19.0Bitcoin Knots GUI prior to 0.18.1 | Theft | Hard | Qt5 remote execution | [64%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?20213401) |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-upnp-oom/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 with UPnP enabled | DoS | Local | OOM via LAN spam |
| [TBD](https://bitcoincore.org/en/2024/07/31/disclose-addrman-int-overflow/) | 2024-07-31 | Bitcoin Core/Knots prior to 22.0 | DoS | Easy | OOM via p2p spam |
| [CVE-2021-31876](#CVE-2021-31876) | 2021-05-06 | Various wallets |  |  |  |
| CVE-2021-41591 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41592 | 2021-10-04 | Lightning software |  |  |  |
| CVE-2021-41593 | 2021-10-04 | Lightning software |  |  |  |
| BIPs 341-343 | 2021-11-13 | All Bitcoin nodes | Fake Conf[[8]](#cite_note-FakeConf-8) | Miners[[9]](#cite_note-MinerEasy-9) | Softfork: Taproot | [57%](http://luke.dashjr.org/programs/bitcoin/files/charts/security.html?343) |
| [CVE-2022-31246](https://github.com/spesmilo/electrum/security/advisories/GHSA-4fh4-hx35-r355) | 2022-06-07 | Electrum 2.1 until before 4.2.2 | Theft | Social |  |
| [CVE-2023-50428](#CVE-2023-50428) | 2023 | All Bitcoin nodes | DoS[[3]](#cite_note-DoS-3) | Easy | Bypass of datacarriersize limit using OP\_FALSE,OP\_IF |  |
| [CVE-2024-34149](#CVE-2024-34149) | 2024-03-30 | Bitcoin Core 0.21.1 and newer (not fixed)Bitcoin Knots 0.21.1 - 0.23.0 | DoS[[3]](#cite_note-DoS-3) | Easy | Script size limit not enforced for Tapscript |  |

1. ↑ [1.0](#cite_ref-Netsplit_1-0) [1.1](#cite_ref-Netsplit_1-1) [1.2](#cite_ref-Netsplit_1-2) [1.3](#cite_ref-Netsplit_1-3) [1.4](#cite_ref-Netsplit_1-4) [1.5](#cite_ref-Netsplit_1-5) Attacker can create multiple views of the network, enabling [double-spending](/wiki/Double-spending "Double-spending") with over 1 confirmation
2. ↑ [2.0](#cite_ref-hardfork_2-0) [2.1](#cite_ref-hardfork_2-1) This is a protocol "hard-fork" that old clients will reject as invalid and must therefore not be used.
3. ↑ [3.00](#cite_ref-DoS_3-0) [3.01](#cite_ref-DoS_3-1) [3.02](#cite_ref-DoS_3-2) [3.03](#cite_ref-DoS_3-3) [3.04](#cite_ref-DoS_3-4) [3.05](#cite_ref-DoS_3-5) [3.06](#cite_ref-DoS_3-6) [3.07](#cite_ref-DoS_3-7) [3.08](#cite_ref-DoS_3-8) [3.09](#cite_ref-DoS_3-9) [3.10](#cite_ref-DoS_3-10) [3.11](#cite_ref-DoS_3-11) [3.12](#cite_ref-DoS_3-12) [3.13](#cite_ref-DoS_3-13) [3.14](#cite_ref-DoS_3-14) [3.15](#cite_ref-DoS_3-15) [3.16](#cite_ref-DoS_3-16) [3.17](#cite_ref-DoS_3-17) [3.18](#cite_ref-DoS_3-18) Attacker can disable some functionality, for example by crashing clients
4. [↑](#cite_ref-Theft_4-0) Attacker can take coins outside known network rules
5. ↑ [5.0](#cite_ref-inflation_5-0) [5.1](#cite_ref-inflation_5-1) Attacker can create coins outside known network rules
6. ↑ [6.0](#cite_ref-Exposure_6-0) [6.1](#cite_ref-Exposure_6-1) [6.2](#cite_ref-Exposure_6-2) Attacker can access user data outside known acceptable methods
7. ↑ [7.0](#cite_ref-Unknown_7-0) [7.1](#cite_ref-Unknown_7-1) Extent of possible abuse is unknown
8. ↑ [8.0](#cite_ref-FakeConf_8-0) [8.1](#cite_ref-FakeConf_8-1) [8.2](#cite_ref-FakeConf_8-2) [8.3](#cite_ref-FakeConf_8-3) [8.4](#cite_ref-FakeConf_8-4) [8.5](#cite_ref-FakeConf_8-5) [8.6](#cite_ref-FakeConf_8-6) [8.7](#cite_ref-FakeConf_8-7) [8.8](#cite_ref-FakeConf_8-8) Attacker can double-spend with 1 confirmation
9. ↑ [9.00](#cite_ref-MinerEasy_9-0) [9.01](#cite_ref-MinerEasy_9-1) [9.02](#cite_ref-MinerEasy_9-2) [9.03](#cite_ref-MinerEasy_9-3) [9.04](#cite_ref-MinerEasy_9-4) [9.05](#cite_ref-MinerEasy_9-5) [9.06](#cite_ref-MinerEasy_9-6) [9.07](#cite_ref-MinerEasy_9-7) [9.08](#cite_ref-MinerEasy_9-8) [9.09](#cite_ref-MinerEasy_9-9) Attacking requires mining block(s)
10. ↑ [10.0](#cite_ref-theft-local-timing_10-0) [10.1](#cite_ref-theft-local-timing_10-1) Local attacker could potentially determine the RPC passphrase via a timing sidechannel.
11. ↑ [11.0](#cite_ref-KeyholderEasy_11-0) [11.1](#cite_ref-KeyholderEasy_11-1) Attacking requires signing with the publicly-disclosed alert key
12. [↑](#cite_ref-12) Depends on software configuration
13. [↑](#cite_ref-Recipient_13-0) Can only be exploited by the recipient the victim intends to pay
14. [↑](#cite_ref-14) User must be tricked into cooperating (social engineering)
15. [↑](#cite_ref-15) Depends on node configuration, only affects routable merchants, requires external knowledge of receiver's invoices and/or luck to identify receiver, only works against single-shot HTLCs (legacy or MPP)

## CVE-2010-5137

```
Date: 2010-07-28
Summary: OP_LSHIFT crash
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One caused bitcoin to crash on some machines when processing a transaction containing an OP\_LSHIFT. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5137)

## CVE-2010-5141

```
Date: 2010-07-28
Summary: ?
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.4 | 0.3.5 |

On July 28 2010, two bugs were discovered and demonstrated on the test network. One exploited a bug in the transaction handling code and allowed an attacker to spend coins that they did not own. This was never exploited on the main network, and was fixed by Bitcoin version 0.3.5.

After these bugs were discovered, many currently-unused script words were disabled for safety.

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5141)

## CVE-2010-5138

```
Date: 2010-07-29
Summary: Unlimited SigOp DoS
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.? | 0.3.? |

On July 29 2010, it was discovered that block [71036](http://blockexplorer.com/block/00000000000997f9fd2fe1ee376293ef8c42ad09193a5d2086dddf8e5c426b56) contained several transactions with a ton of OP\_CHECKSIG commands. There should only ever be one such command. This caused every node to do extra unnecessary work, and it could have been used as a denial-of-service attack. A new version of Bitcoin was quickly released. The new version did not cause a fork on the main network, though it did cause one on the test network (where someone had played around with the attack more).

### References

* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5138)

## CVE-2010-5139

*Main article: [CVE-2010-5139](/wiki/CVE-2010-5139 "CVE-2010-5139")*
```
Date: 2010-08-15
Summary: Combined output overflow
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.10 | 0.3.11 |

On August 15 2010, it was [discovered](http://bitcointalk.org/index.php?topic=822.0) that block 74638 contained a transaction that created over 184 billion bitcoins for two different addresses. This was possible because the code used for checking transactions before including them in a block didn't account for the case of outputs so large that they overflowed when summed. A new version was published within a few hours of the discovery. The block chain had to be forked. Although many unpatched nodes continued to build on the "bad" block chain, the "good" block chain overtook it at a block height of 74691. The bad transaction no longer exists for people using the longest chain.

The block and transaction:

```
CBlock(hash=0000000000790ab3, ver=1, hashPrevBlock=0000000000606865, hashMerkleRoot=618eba,
nTime=1281891957, nBits=1c00800e, nNonce=28192719, vtx=2)
  CTransaction(hash=012cd8, ver=1, vin.size=1, vout.size=1, nLockTime=0)
    CTxIn(COutPoint(000000, -1), coinbase 040e80001c028f00)
    CTxOut(nValue=50.51000000, scriptPubKey=0x4F4BA55D1580F8C3A8A2C7)
  CTransaction(hash=1d5e51, ver=1, vin.size=1, vout.size=2, nLockTime=0)
    CTxIn(COutPoint(237fe8, 0), scriptSig=0xA87C02384E1F184B79C6AC)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0xB7A7)
    CTxOut(nValue=92233720368.54275808, scriptPubKey=OP_DUP OP_HASH160 0x1512)
  vMerkleTree: 012cd8 1d5e51 618eba

Block hash: 0000000000790ab3f22ec756ad43b6ab569abf0bddeb97c67a6f7b1470a7ec1c
Transaction hash: 1d5e512a9723cbef373b970eb52f1e9598ad67e7408077a82fdac194b65333c9
```
### References

* [Discovery](https://bitcointalk.org/index.php?topic=822.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5139)

## CVE-2010-5140

```
Date: 2010-09-29
Summary: Never confirming transactions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | \* - 0.3.12 | 0.3.13 |

Around September 29, 2010, people started [reporting](https://bitcointalk.org/index.php?topic=1306.0) that their sent transactions would not confirm. This happened because people modified Bitcoin to send sub-0.01 transactions without any fees. A 0.01 fee was at that time required by the network for such transactions (essentially prohibiting them), so the transactions remained at 0 confirmations forever. This became a more serious issue because Bitcoin would send transactions using bitcoins gotten from transactions with 0 confirmations, and these resulting transactions would also never confirm. Because Bitcoin tends to prefer sending smaller coins, these invalid transactions quickly multiplied, contaminating the wallets of everyone who received them.

Bitcoin was changed to only select coins with at least 1 confirmation. The remaining sub-0.01 transactions were cleared by generators who modified their version of Bitcoin to not require the micropayment fee. It took a while for everything to get cleared, though, because many of the intermediate transactions had been forgotten by the network by this point and had to be rebroadcast by the original senders.

### References

* [Initial reports](https://bitcointalk.org/index.php?topic=1306.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2010-5140)

## CVE-2011-4447

```
Date: 2011-11-11
Summary: Wallet non-encryption
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoindwxBitcoin | 0.4.0 - 0.4.1rc6 | 0.4.10.5.0 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=51604.0)
* [Finding](https://bitcointalk.org/index.php?topic=51474.0)
* [0.5.0](http://bitcoin.org/releases/2011/11/21/v0.5.0.html)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2011-4447)

## CVE-2012-1909

```
Date: 2012-03-07
Summary: Transaction overwriting
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin protocol | Before March 15th, 2012 | BIP 30 |
| Bitcoin-Qtbitcoind | \* - 0.4.4rc20.5.0rc1 - 0.5.0.4rc20.5.1rc1 - 0.5.3rc20.6.0rc1 - 0.6.0rc2 | 0.4.40.5.0.40.5.30.6.0rc3 |
| wxBitcoin | ALL | NONE |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=67738.0)
* [Fix](https://en.bitcoin.it/wiki/BIP_0030)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=407793)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1909)

## CVE-2012-1910

```
Date: 2012-03-17
Summary: Non-thread safe MingW exceptions
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| bitcoind for WindowsBitcoin-Qt for Windows | 0.5.0rc1 - 0.5.0.40.5.1rc1 - 0.5.3.00.6.0rc1 - 0.6.0rc3 | 0.5.0.50.5.3.10.5.40.6.0rc4 |

### References

* [Announcement](https://bitcointalk.org/index.php?topic=69120.0)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-1910)
* [Full disclosure](http://gavintech.blogspot.com/2012/03/full-disclosure-bitcoin-qt-on-windows.html)

## BIP-0016

```
Date: 2012-04-01
Summary: Mandatory P2SH protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.40.5.0rc1 - 0.5.0.50.5.1rc1 - 0.5.30.6.0rc1 | 0.4.50.5.0.60.5.4rc10.6.0rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0016](/wiki/BIP_0016 "BIP 0016")

## CVE-2012-2459

```
Date: 2012-05-14
Summary: Block hash collision (via merkle tree)
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.6rc10.5.0rc1 - 0.5.5rc10.6.0rc1 - 0.6.0.7rc10.6.1rc1 - 0.6.1rc1 | 0.4.60.5.50.6.0.70.6.1rc2 |

Block hash collisions can easily be made by duplicating transactions in the merkle tree.
Such a collision is invalid, but if recorded (as Bitcoin-Qt and bitcoind prior to 0.6.1 did) would prevent acceptance of the legitimate block with the same hash.
This could be used to fork the blockchain, including deep double-spend attacks.

### References

* [Announcement](https://bitcointalk.org/?topic=81749)
* [Gentoo bug tracker](https://bugs.gentoo.org/show_bug.cgi?id=415973)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-2459)
* [Full Disclosure](https://bitcointalk.org/?topic=102395)

## CVE-2012-3789

*Main article: [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")*
```
Date: 2012-06-20
Summary: (Lack of) orphan txn resource limits
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-3789](/wiki/CVE-2012-3789 "CVE-2012-3789")
* [0.6.3rc1 Announcement](https://bitcointalk.org/?topic=88734)
* [US-CERT/NIST](http://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-3789)

## CVE-2012-4682

```
Date:
Summary:
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.4.7rc30.5.6rc30.6.0.9rc10.6.3rc1 |

### References

* [CVE-2012-4682](/w/index.php?title=CVE-2012-4682&action=edit&redlink=1 "CVE-2012-4682 (page does not exist)")
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4683

*Main article: [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")*
```
Date: 2012-08-23
Summary: Targeted DoS by CPU exhaustion using alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 | 0.7.0 |

### References

* [CVE-2012-4683](/wiki/CVE-2012-4683 "CVE-2012-4683")
* [Announcement](https://bitcointalk.org/index.php?topic=148038.0)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=435216)

## CVE-2012-4684

*Main article: [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")*
```
Date: 2012-08-24
Summary: Network-wide DoS using malleable signatures in alerts
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.7rc20.5.0rc1 - 0.5.6rc20.6.0rc1 - 0.6.0.8rc20.6.1rc1 - 0.6.2.2 - 0.6.3rc1 | 0.7.0 |

### References

* [CVE-2012-4684](/wiki/CVE-2012-4684 "CVE-2012-4684")
* [Announcement](https://bitcointalk.org/index.php?topic=148109.0)

## CVE-2013-2272

```
Date: 2013-01-11
Summary: Remote discovery of node's wallet addresses
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Announcement](https://bitcointalk.org/?topic=135856)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2273

```
Date: 2013-01-30
Summary: Predictable change output
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.8rc40.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.10rc40.6.1rc1 - 0.6.4rc40.7.0rc1 - 0.7.2 | 0.4.9rc10.5.8rc10.6.0.11rc10.6.5rc10.7.3rc1 |

### References

* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2292

```
Date: 2013-01-30
Summary: A transaction that takes at least 3 minutes to verify
Fix Deployment: 0%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | All versions | No fix yet |

### References

* [CVE-2013-2292](/w/index.php?title=CVE-2013-2292&action=edit&redlink=1 "CVE-2013-2292 (page does not exist)")
* [Announcement](https://bitcointalk.org/?topic=140078)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-2293

*Main article: [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")*
```
Date: 2013-02-14
Summary: Continuous hard disk seek
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.7.3rc1 | No fix yet (0.8.0 unaffected) |

### References

* [CVE-2013-2293](/wiki/CVE-2013-2293 "CVE-2013-2293")
* [Announcement](https://bitcointalk.org/?topic=144122)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=462046)

## CVE-2013-3219

```
Date: 2013-03-11
Summary: Unenforced block protocol rule
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.0 | 0.8.1 |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-3220

```
Date: 2013-03-11
Summary: Inconsistent BDB lock limit interactions
Fix Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 50](/wiki/BIP_0050 "BIP 0050")

## BIP-0034

```
Date: 2013-03-25
Summary: Mandatory block protocol update
Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.70.5.0rc1 - 0.5.70.6.0rc1 - 0.6.0.90.6.1rc1 - 0.6.3 | 0.4.8rc10.5.7rc10.6.0.10rc10.6.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0034](/wiki/BIP_0034 "BIP 0034")

## BIP-0050

```
Date: 2013-05-15
Summary: Hard fork to remove txid limit protocol rule
Deployment: 99.99%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc10.5.0rc1 - 0.5.8rc10.6.0rc1 - 0.6.5rc10.7.0rc1 - 0.7.3rc1 | 0.4.9rc20.5.8rc20.6.5rc20.7.3rc2 |
| wxBitcoin | ALL | NONE |

### References

* [BIP 0050](/wiki/BIP_0050 "BIP 0050")

## CVE-2013-4627

```
Date: 2013-06-??
Summary: Memory exhaustion with excess tx message data
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4 |
| wxBitcoin | ALL | NONE |

### References

## CVE-2013-4165

```
Date: 2013-07-20
Summary: Timing leak in RPC authentication
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | \* - 0.4.9rc30.5.0rc1 - 0.5.8rc30.6.0rc1 - 0.6.5rc30.7.0rc1 - 0.7.3rc30.8.0rc1 - 0.8.3 | 0.4.9rc40.5.8rc40.6.5rc40.7.3rc40.8.4rc1 |
| wxBitcoin | ALL | NONE |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The initial bug report](https://github.com/bitcoin/bitcoin/issues/2838)

## CVE-2013-5700

```
Date: 2013-09-04
Summary: Remote p2p crash via bloom filters
Fix Deployment: 99.9%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.8.0rc1 - 0.8.3 | 0.8.4rc1 |

### References

* [Bitcoin-Qt 0.8.4 release notes](https://bitcointalk.org/index.php?topic=287351)
* [The fix](https://github.com/bitcoin/bitcoin/commit/37c6389c5a0ca63ae3573440ecdfe95d28ad8f07)
* [An added test](https://github.com/bitcoin/bitcoin/pull/18515)

## CVE-2016-8889

```
Date: 2016-10-27
Summary: Debug console history storing sensitive info
Fix Deployment: 100%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Knots GUI | 0.11.0 - 0.13.0 | 0.13.1 |

### References

* [Bitcoin Knots 0.16.1.knots20161027 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.13.1.knots20161027/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2016-8889)

## CVE-2017-12842

```
Date: 2018-06-09
Summary: No commitment to block merkle tree depth

```
### References

* [Explanation by Sergio Demian Lerner](https://bitslog.wordpress.com/2018/06/09/leaf-node-weakness-in-bitcoin-merkle-tree-design/)
* [Further elaboration by Suhas Daftuar](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2019-February/016697.html)

## CVE-2017-18350

```
Date: 2019-06-22
Summary: Buffer overflow from SOCKS proxy

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.7.0rc1 - 0.15.0 | 0.15.1rc1 |

### References

* [Disclosure of details](https://medium.com/%40lukedashjr/cve-2017-18350-disclosure-fe6d695f45d5)

## CVE-2018-17144

```
Date: 2018-09-17
Summary: Missing check for duplicate inputs
Fix Deployment: 31%

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.14.0rc1 - 0.14.20.15.0rc1 - 0.15.10.16.0rc1 - 0.16.2 | 0.14.30.15.20.16.3 |

### References

* [Full disclosure by Bitcoin Core](https://bitcoincore.org/en/2018/09/20/notice/)
* [Bitcoin Core 0.16.3 release notes](https://bitcoincore.org/en/2018/09/18/release-0.16.3/)
* [Bitcoin Knots 0.16.3.knots20180918 release notes](https://github.com/bitcoinknots/bitcoin/blob/v0.16.3.knots20180918/doc/release-notes.md)
* [US-CERT/NIST](https://nvd.nist.gov/vuln/detail/CVE-2018-17144)
* [Gentoo bug](https://bugs.gentoo.org/show_bug.cgi?id=666669)

## CVE-2018-20586

```
Date: 2019-06-22
Summary: Debug log injection via unauthenticated RPC

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin-Qtbitcoind | 0.12.0rc1 - 0.17.0 | 0.17.1rc1 |

## CVE-2020-14199

```
Date: 2020-06-03
Summary: Double-signing can enable unintended fees

```

| Affected | | Fix |
| --- | --- | --- |
| Trezor One |  | 1.9.1 |
| Trezor Model T |  | 2.3.1 |
| ??? |

### References

* [Disclosure of details by Trezor team](https://blog.trezor.io/details-of-firmware-updates-for-trezor-one-version-1-9-1-and-trezor-model-t-version-2-3-1-1eba8f60f2dd)

## CVE-2020-26895

```
Date: 2020-10-08
Summary: Missing low-S normalization for HTLC signatures.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.10.0 |

### References

* [CVE-2020-26895: LND Low-S Tx-Relay Standardness](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002858.html)
* [Full Disclosure: Full Disclosure: CVE-2020-26895 LND "Hodl my Shitsig"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002856.html)

## CVE-2020-26896

```
Date: 2020-10-08
Summary: Invoice preimage extraction via forwarded HTLC.

```

| Affected | | Fix |
| --- | --- | --- |
| lnd |  | 0.11.0 |

### References

* [CVE-2020-26896: LND Invoice Preimage Extraction](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002857.html)
* [Full Disclosure: CVE-2020-26896 LND "The (un)covert channel"](https://lists.linuxfoundation.org/pipermail/lightning-dev/2020-October/002855.html)

## CVE-2021-3401

```
Date: 2021-02-01
Summary: Qt5 remote execution

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core GUI |  | 0.19.0 |
| Bitcoin Knots GUI |  | 0.18.1 |

## CVE-2021-31876

```
Date: 2021-05-06

```
### References

* [Full Disclosure: CVE-2021-31876 Defect in Bitcoin Core's bip125 logic](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2021-May/018893.html)

### References

* [URI Argument Injection Vulnerability in Bitcoin Core 0.18 and Earlier](https://achow101.com/2021/02/0.18-uri-vuln)

## CVE-2023-50428

```
Date: 2023
Summary: Bypass of datacarriersize limit using OP_FALSE,OP_IF

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.9 and later | NOT FIXED |
| Bitcoin Knots | 0.9 - 23.0 | 25.1.knots20231115 |
| btcd | ? | NOT FIXED |
| libbitcoin | ? | NOT FIXED |

## CVE-2024-34149

```
Date: 2024-03-30
Summary: Script size limit not enforced for Tapscript

```

| Affected | | Fix |
| --- | --- | --- |
| Bitcoin Core | 0.21.1 and later | NOT FIXED |
| Bitcoin Knots | 0.21.1 - 23.0 | 25.1.knots20231115 |
| btcd | ? | ? |
| libbitcoin | ? | ? |

## Definitions

A critical vulnerability is one that will have disastrous consequences if it is exploited. A serious vulnerability is one that will have serious consequences if it is exploited[[1]](#cite_note-16).

## See Also

* [Changelog](/wiki/Changelog "Changelog")
* <https://blog.bitmex.com/bitcoins-consensus-forks/>

## References

1. [↑](#cite_ref-16) <http://bitcointalk.org/index.php?topic=88892.0>

| | [Bitcoin Core](/wiki/Bitcoin_Core "Bitcoin Core") documentation | | | --- | --- | |  | | User documentation | [Alert system](/wiki/Alert_system "Alert system") • [Bitcoin Core compatible devices](/wiki/Bitcoin_Core_compatible_devices "Bitcoin Core compatible devices") • [Data directory](/wiki/Data_directory "Data directory") • [Fallback Nodes](/wiki/Fallback_Nodes "Fallback Nodes") • [How to import private keys in Bitcoin Core 0.7+](/wiki/Help%3AHow_to_import_private_keys_in_Bitcoin_Core_0.7%2B "Help:How to import private keys in Bitcoin Core 0.7+") • [Installing Bitcoin Core](/wiki/Help%3AInstalling_Bitcoin_Core "Help:Installing Bitcoin Core") • [Running Bitcoin](/wiki/Running_Bitcoin "Running Bitcoin") • [Transaction fees](/wiki/Transaction_fees "Transaction fees") • [Vocabulary](/wiki/Vocabulary "Vocabulary") | |  | | Developer documentation | [Accounts explained](/wiki/Help%3AAccounts_explained "Help:Accounts explained") • [API calls list](/wiki/Original_Bitcoin_client/API_calls_list "Original Bitcoin client/API calls list") • [API reference (JSON-RPC)](/wiki/API_reference_%28JSON-RPC%29 "API reference (JSON-RPC)") • [Block chain download](/wiki/Block_chain_download "Block chain download") • [Dump format](/wiki/Dump_format "Dump format") • [getblocktemplate](/wiki/Getblocktemplate "Getblocktemplate") • [List of address prefixes](/wiki/List_of_address_prefixes "List of address prefixes") • [Protocol documentation](/wiki/Protocol_documentation "Protocol documentation") • [Script](/wiki/Script "Script") • [Technical background of version 1 Bitcoin addresses](/wiki/Technical_background_of_version_1_Bitcoin_addresses "Technical background of version 1 Bitcoin addresses") • [Testnet](/wiki/Testnet "Testnet") • [Transaction Malleability](/wiki/Transaction_Malleability "Transaction Malleability") • [Wallet import format](/wiki/Wallet_import_format "Wallet import format") | |  | | History & theory | Common Vulnerabilities and Exposures • [DOS/STONED incident](/wiki/DOS/STONED_incident "DOS/STONED incident") • [Economic majority](/wiki/Economic_majority "Economic majority") • [Full node](/wiki/Full_node "Full node") • [Original Bitcoin client](/wiki/Original_Bitcoin_client "Original Bitcoin client") • [Value overflow incident](/wiki/Value_overflow_incident "Value overflow incident") | |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |

Retrieved from "<https://en.bitcoin.it/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310>"
[Categories](/wiki/Special%3ACategories "Special:Categories"):

* [Security](/wiki/Category%3ASecurity "Category:Security")
* [Bitcoin Core documentation](/wiki/Category%3ABitcoin_Core_documentation "Category:Bitcoin Core documentation")

## Navigation menu

### Personal tools

* [Create account](/w/index.php?title=Special:CreateAccount&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to create an account and log in; however, it is not mandatory")
* [Log in](/w/index.php?title=Special:UserLogin&returnto=Common+Vulnerabilities+and+Exposures "You are encouraged to log in; however, it is not mandatory [o]")

### Namespaces

* [Page](/wiki/Common_Vulnerabilities_and_Exposures "View the content page [c]")
* [Discussion](/wiki/Talk%3ACommon_Vulnerabilities_and_Exposures "Discussion about the content page [t]")

English

### Views

* [Read](/wiki/Common_Vulnerabilities_and_Exposures)
* [View source](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=edit "This page is protected.
  You can view its source [e]")
* [View history](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=history "Past revisions of this page [h]")

More

### Search

### Navigation

* [Main page](/wiki/Main_Page "Visit the main page [z]")
* [Bitcoin FAQ](/wiki/Help%3AFAQ)
* [Editing help](/wiki/Bitcoin_Wiki%3AHelp)
* [Forums](/wiki/Forums)
* [Chatrooms](/wiki/IRC_channels)
* [Recent changes](/wiki/Special%3ARecentChanges)
* [Page index](/wiki/Special%3AAllPages)

### Tools

* [What links here](/wiki/Special%3AWhatLinksHere/Common_Vulnerabilities_and_Exposures "A list of all wiki pages that link here [j]")
* [Related changes](/wiki/Special%3ARecentChangesLinked/Common_Vulnerabilities_and_Exposures "Recent changes in pages linked from this page [k]")
* [Special pages](/wiki/Special%3ASpecialPages "A list of all special pages [q]")
* Printable version
* [Permanent link](/w/index.php?title=Common_Vulnerabilities_and_Exposures&oldid=70310 "Permanent link to this revision of this page")
* [Page information](/w/index.php?title=Common_Vulnerabilities_and_Exposures&action=info "More information about this page")

### Sister projects

* [Essays](/wiki/Bitcoin_Wiki%3AEssay_main_page)
* [Source](/wiki/Bitcoin_Wiki%3ASource_main_page)

* This page was last edited on 31 July 2024, at 17:40.
* Content is available under [Creative Commons Attribution 3.0](http://creativecommons.org/licenses/by/3.0/) unless otherwise noted.

* [Privacy policy](/wiki/Bitcoin_Wiki%3APrivacy_policy)
* [About Bitcoin Wiki](/wiki/Bitcoin_Wiki%3AAbout)
* [Disclaimers](/wiki/Bitcoin_Wiki%3AGeneral_disclaimer)

* [![Powered by MediaWiki](/w/resources/assets/poweredby_mediawiki_88x31.png)](https://www.mediawiki.org/)



=== Content from github.com_e0296fff_20250124_203625.html ===

[Skip to content](#start-of-content)

## Navigation Menu

Toggle navigation

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJinBean%2FCVE-Extension)

* Product

  + [GitHub Copilot
    Write better code with AI](https://github.com/features/copilot)
  + [Security
    Find and fix vulnerabilities](https://github.com/features/security)
  + [Actions
    Automate any workflow](https://github.com/features/actions)
  + [Codespaces
    Instant dev environments](https://github.com/features/codespaces)
  + [Issues
    Plan and track work](https://github.com/features/issues)
  + [Code Review
    Manage code changes](https://github.com/features/code-review)
  + [Discussions
    Collaborate outside of code](https://github.com/features/discussions)
  + [Code Search
    Find more, search less](https://github.com/features/code-search)

  Explore
  + [All features](https://github.com/features)
  + [Documentation](https://docs.github.com)
  + [GitHub Skills](https://skills.github.com)
  + [Blog](https://github.blog)
* Solutions

  By company size
  + [Enterprises](https://github.com/enterprise)
  + [Small and medium teams](https://github.com/team)
  + [Startups](https://github.com/enterprise/startups)
  + [Nonprofits](/solutions/industry/nonprofits)
  By use case
  + [DevSecOps](/solutions/use-case/devsecops)
  + [DevOps](/solutions/use-case/devops)
  + [CI/CD](/solutions/use-case/ci-cd)
  + [View all use cases](/solutions/use-case)

  By industry
  + [Healthcare](/solutions/industry/healthcare)
  + [Financial services](/solutions/industry/financial-services)
  + [Manufacturing](/solutions/industry/manufacturing)
  + [Government](/solutions/industry/government)
  + [View all industries](/solutions/industry)

  [View all solutions](/solutions)
* Resources

  Topics
  + [AI](/resources/articles/ai)
  + [DevOps](/resources/articles/devops)
  + [Security](/resources/articles/security)
  + [Software Development](/resources/articles/software-development)
  + [View all](/resources/articles)

  Explore
  + [Learning Pathways](https://resources.github.com/learn/pathways)
  + [White papers, Ebooks, Webinars](https://resources.github.com)
  + [Customer Stories](https://github.com/customer-stories)
  + [Partners](https://partner.github.com)
  + [Executive Insights](https://github.com/solutions/executive-insights)
* Open Source

  + [GitHub Sponsors
    Fund open source developers](/sponsors)
  + [The ReadME Project
    GitHub community articles](https://github.com/readme)
  Repositories
  + [Topics](https://github.com/topics)
  + [Trending](https://github.com/trending)
  + [Collections](https://github.com/collections)
* Enterprise

  + [Enterprise platform
    AI-powered developer platform](/enterprise)
  Available add-ons
  + [Advanced Security
    Enterprise-grade security features](https://github.com/enterprise/advanced-security)
  + [GitHub Copilot
    Enterprise-grade AI features](/features/copilot#enterprise)
  + [Premium Support
    Enterprise-grade 24/7 support](/premium-support)
* [Pricing](https://github.com/pricing)

Search or jump to...

# Search code, repositories, users, issues, pull requests...

Search

Clear

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

# Provide feedback

We read every piece of feedback, and take your input very seriously.

Include my email address so I can be contacted

  Cancel

 Submit feedback

# Saved searches

## Use saved searches to filter your results more quickly

Name

Query

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

  Cancel

 Create saved search

[Sign in](/login?return_to=https%3A%2F%2Fgithub.com%2FJinBean%2FCVE-Extension)

[Sign up](/signup?ref_cta=Sign+up&ref_loc=header+logged+out&ref_page=%2F%3Cuser-name%3E%2F%3Crepo-name%3E&source=header-repo&source_repo=JinBean%2FCVE-Extension)
Reseting focus

You signed in with another tab or window. Reload to refresh your session.
You signed out in another tab or window. Reload to refresh your session.
You switched accounts on another tab or window. Reload to refresh your session.

Dismiss alert

{{ message }}

[JinBean](/JinBean)
/
**[CVE-Extension](/JinBean/CVE-Extension)**
Public

* [Notifications](/login?return_to=%2FJinBean%2FCVE-Extension) You must be signed in to change notification settings
* [Fork
  4](/login?return_to=%2FJinBean%2FCVE-Extension)
* [Star
   3](/login?return_to=%2FJinBean%2FCVE-Extension)

This repository is an extension of our research on cryptocurrency clones and documents existing vulnerabilities discovered in those clones

[3
stars](/JinBean/CVE-Extension/stargazers) [4
forks](/JinBean/CVE-Extension/forks) [Branches](/JinBean/CVE-Extension/branches) [Tags](/JinBean/CVE-Extension/tags) [Activity](/JinBean/CVE-Extension/activity)
 [Star](/login?return_to=%2FJinBean%2FCVE-Extension)

 [Notifications](/login?return_to=%2FJinBean%2FCVE-Extension) You must be signed in to change notification settings

* [Code](/JinBean/CVE-Extension)
* [Issues
  0](/JinBean/CVE-Extension/issues)
* [Pull requests
  0](/JinBean/CVE-Extension/pulls)
* [Actions](/JinBean/CVE-Extension/actions)
* [Projects
  0](/JinBean/CVE-Extension/projects)
* [Security](/JinBean/CVE-Extension/security)
* [Insights](/JinBean/CVE-Extension/pulse)

Additional navigation options

* [Code](/JinBean/CVE-Extension)
* [Issues](/JinBean/CVE-Extension/issues)
* [Pull requests](/JinBean/CVE-Extension/pulls)
* [Actions](/JinBean/CVE-Extension/actions)
* [Projects](/JinBean/CVE-Extension/projects)
* [Security](/JinBean/CVE-Extension/security)
* [Insights](/JinBean/CVE-Extension/pulse)

# JinBean/CVE-Extension

    master[Branches](/JinBean/CVE-Extension/branches)[Tags](/JinBean/CVE-Extension/tags)Go to fileCode
## Folders and files

| Name | | Name | Last commit message | Last commit date |
| --- | --- | --- | --- | --- |
| Latest commit History[23 Commits](/JinBean/CVE-Extension/commits/master/) | | |
| [CVE-2016-10724](/JinBean/CVE-Extension/tree/master/CVE-2016-10724 "CVE-2016-10724") | | [CVE-2016-10724](/JinBean/CVE-Extension/tree/master/CVE-2016-10724 "CVE-2016-10724") |  |  |
| [CVE-2018-17144](/JinBean/CVE-Extension/tree/master/CVE-2018-17144 "CVE-2018-17144") | | [CVE-2018-17144](/JinBean/CVE-Extension/tree/master/CVE-2018-17144 "CVE-2018-17144") |  |  |
| [CVE-2019-7167](/JinBean/CVE-Extension/tree/master/CVE-2019-7167 "CVE-2019-7167") | | [CVE-2019-7167](/JinBean/CVE-Extension/tree/master/CVE-2019-7167 "CVE-2019-7167") |  |  |
| [README.md](/JinBean/CVE-Extension/blob/master/README.md "README.md") | | [README.md](/JinBean/CVE-Extension/blob/master/README.md "README.md") |  |  |
| View all files | | |

## Repository files navigation

* README
# CVE Extensions

This repository is an extension of our research on cryptocurrency clones and vulnerabilities that takes existing vulnerabilities in major coins and uses clone detection tools as a method of identifying propagation of these vulnerabilities in other coins.

List of documented CVEs

1. [CVE-2018-17144](#cve-2018-17144)
2. [CVE-2019-7167](#cve-2019-7167)
3. [CVE-2016-10724](#cve-2016-10724)
4. [CVE-2016-10725](#cve-2016-10725)

---

## CVE-2018-17144

[National Vulnerability Database (NVD) Report](https://nvd.nist.gov/vuln/detail/CVE-2018-17144)

A reachable assert statement in Bitcoin Core allows a remote denial of service (application crash) exploitable by miners via attempting to double-spend a transaction insinde a mined block. This CVE also later leads to an inflation bug, which we do not focus on here.

The code relevant to this vulnerability can be found in the file `validation.cpp` of Bitcoin Core 0.14.X.
This specific file can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2018-17144/Bitcoin-0.14.X).

When a block containing a double spent transaction is validated, it skips the duplicate input check because of the false parameter [here](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L2883). The double spend will reach the function [UpdateCoins()](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L1323), and the inputs to the transaction are being marked as spent in the Unspent Transaction Output(UTXO) database. The first time the transaction is seen, the coins involved are marked as spent. Since the coins involved in the transaction are already marked as spent, the second time the transaction is seen, `coins->vout[nPos].IsNull()` will be true. It will then enter this [if statement](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2018-17144/Bitcoin-0.14.X/validation.cpp#L1332) and subsequently execute the assert statement that follows. The assert then causes the node to crash, resulting in the denial of service vulnerability. (Paraphrased from Source 2)

The coin(s) that we found to still contain this vulnerability as of 26/3/2019 include:

* [Irlecoin](https://github.com/irlecoin/irlecoin)
* [MinexCoin](https://github.com/minexcoin/minexcoin) (Fixed)
* [MktCoin](https://github.com/mktcoin/mktcoin)
* [PlatinCoin](https://github.com/platincoin-project/platincoin)
* [QuasarCoin](https://github.com/quasarcoin/quasar)
* [TCOIN](https://github.com/koba24/tcoin)

**Total Coins: 6**

These coin(s) still contain unpatched instances of the vulnerability in their code base which can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2018-17144)

### Sources:

1. [CVE-2018-17144 Full Disclosure](https://bitcoincore.org/en/2018/09/20/notice/)
2. [Andrew Chow, Bitcoin StackExchange](https://bitcoin.stackexchange.com/questions/79481/how-does-the-most-recently-found-critical-vulnerability-cve-2018-17144-work/79484#79484)

---

## CVE-2019-7167

[National Vulnerability Database (NVD) Report](https://nvd.nist.gov/vuln/detail/CVE-2019-7167)

BCTV14 setup produces elements that violate soundness, misleading the original Sprout zk-SNARK verifier into accepting the correctness of a transaction. This allows an attacker to create very large, virtually unlimited amounts of counterfeit shielded tokens without detection. Zcash has switched to different parameters using a new “Sprout-on-Groth16” proving system as of the Sapling network upgrade on October 28th 2018, and so is not affected by the bug.

The code relevant to this vulnerability can be found in the file `JoinSplit.cpp` of Zcash 1.X.
This specific file can be found [here](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2019-7167/Zcash-1.X/JoinSplit.cpp).

The coin(s) that we found to still contain this vulnerability as of 27/5/2019 include:

* [Hush](https://github.com/MyHush/hush)

**Total Coins: 1**

These coin(s) still contain unpatched instances of the vulnerability in their code base which can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2019-7167)

### Sources:

1. [Zcash blog disclosure])(<https://z.cash/blog/zcash-counterfeiting-vulnerability-successfully-remediated/>)

---

## CVE-2016-10724 / CVE-2016-10725

These two vulnerabilites are closely related and hence are grouped in the same section. All coins presented in this section are vulnerable to both vulnerabilities.

### CVE-2016-10724

[National Vulnerability Database (NVD) Report](https://nvd.nist.gov/vuln/detail/CVE-2016-10724)

A remote network alert system originating from Bitcoin allows the denial of service (memory exhaustion) if an attacker can sign a message with a certain private key that had been known by unintended actors. Due to an infinitely sized map, an attacker can send a large number of alerts (or very large alerts, or both) to a node, causing the node to run out of memory and crash.

### CVE-2016-10725

[National Vulnerability Database (NVD) Report](https://nvd.nist.gov/vuln/detail/CVE-2016-10725)

A 'final alert' was developed to prevent attackers from abusing CVE-2016-10724, which comprises a maximum ID alert that overrides all previous alerts. A final alert is an alert that meets the following conditions [here](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2016-10724/Bitcoin-0.12.X/alert.cpp#L190-L196). However, due to alerts being classified by their hashes, any alert can be classified as a final alert, which can also cause the the node to run out of memory.
Final alerts are also supposed to be uncancellable, but can inadvertently be cancelled. Alerts first check they cancel any existing alert. Then they are checked for whether any of the remaining alerts cancel it. Because of this order, it is possible to create an alert which cancels a final alert before the node checks whether that alert is cancelled by the final alert. Thus an attacker can cancel a final alert with another alert allowing a node to also be vulnerable to CVE-2016-10724.

The alert system in itself also creates a centralized source in the cryptocurrency. Bitcoin has since deprecated the alert system entirely.
Bitcoin has also released a patch for the alert vulnerability which can be found [here](https://gist.github.com/achow101/02d03238090691558a68010a9ccbbf9d)

The code relevant to these vulnerabilities can be found in the file `alert.cpp` of Bitcoin 0.12.X.
This specific file can be found [here](https://github.com/JinBean/CVE-Extension/blob/master/CVE-2016-10724/Bitcoin-0.12.X/alert.cpp).

The coin(s) that we found to still contain both CVE-2016-10724 and CVE-2016-10745 as of 14/6/2019 include:

* [Absolute](https://github.com/absolute-community/absolute)
* [Adirondack](https://github.com/adirondackcoin/Adirondack)
* [AdultChain](https://github.com/AdultChain/AdultChain)
* [Advance](https://github.com/AdvanceProtocol/advance)
* [Aegeus](https://github.com/AegeusCoin/aegeus)
* [Afro](https://github.com/afro/afro)
* [AGNI coin](https://github.com/agnicoin/agni)
* [Airin](https://github.com/airincoin/airin)
* [Alpha](https://github.com/alp-project/AlphaCoin)
* [ALQO](https://github.com/alqocrypto/alqo)
* [Amero](https://github.com/bitcosur/Amero)
* [Amnesia](https://github.com/amnesiacoin/amnesia)
* [ANODOS](https://github.com/anodoscoin/anodoscoin)
* [ANON](https://github.com/anonymousbitcoin/anon)
* [APEIRON](https://github.com/apeironcoin/apeiron)
* [Apollon](https://github.com/apollondeveloper/ApollonCoin)
* [AquariusCoin](https://github.com/AquariusNetwork/ARCO)
* [Aquila](https://github.com/aquilacoin/AquilaX)
* [ArcticCoin](https://github.com/ArcticCore/arcticcoin)
* [ARGO](https://github.com/argocoins/argo)
* [Aricoin](https://github.com/aricoin/aricoin)
* [Arion](https://github.com/arioncoin/arioncoin)
* [ARTAX](https://github.com/artaxcommittee/Artax)
* [Artiqox](https://github.com/artiqox/artiqox)
* [AudioCoin](https://github.com/aurovine/audiocoin)
* [Auroracoin](https://github.com/aurarad/auroracoin)
* [B3Coin](https://github.com/B3-Coin/B3-CoinV2)
* [BANQ](https://github.com/banq-platform/banq)
* [Baxur](https://github.com/baxurdev/baxur)
* [Bettex coin](https://github.com/bettexproject/bettexcoin)
* [BiblePay](https://github.com/biblepay/biblepay)
* [Bifrost](https://github.com/bifrost-actual/bifrost-coin)
* [Birake](https://github.com/birake/birakecoin)
* [BitBay](https://github.com/dzimbeck/BitBay)
* [Bitcloud](https://github.com/LIMXTEC/Bitcloud)
* [Bitcoin 2](https://github.com/BITC2/bitcoin2)
* [Bitcoin Adult](https://github.com/BitcoinAdult/BitcoinAdult-Source-Code)
* [Bitcoin Final](https://github.com/bitcoinfinal/BitcoinFinal)
* [Bitcoin Lightning](https://github.com/Bitcoinlightning/Bitcoin-Lightning)
* [Bitcoin Private](https://github.com/BTCPrivate/BitcoinPrivate)
* [Bitcoin W Spectrum](https://github.com/raymaker/bitcoinwspectrum)
* [BitcoinZ](https://github.com/bitcoinz-pod/bitcoinz)
* [Bitcurrency](https://github.com/tokyoghetto/BitCurrencyPro)
* [BitF](https://github.com/BitFdev/BitF-source-code)
* [Bithold](https://github.com/Bitholddev/Bithold)
* [BitNodes Pro](https://github.com/bitnodes/bitnodespro)
* [Bitradio](https://github.com/thebitradio/Bitradio)
* [BitRewards](https://github.com/BitRewardsCoin/BitRewards)
* [BlackCoin](https://github.com/CoinBlack/blackcoin)
* [Blocknet](https://github.com/BlocknetDX/BlockDX)
* [Blocknode](https://github.com/blocknodetech/blocknode)
* [Braincoin](https://github.com/axelxod/braincoin)
* [BUCK](https://github.com/BuckCoin/buck)
* [Bullion](https://github.com/elambert2014/bullion)
* [Bulwark](https://github.com/bulwark-crypto/Bulwark)
* [BuzzCoin](https://github.com/buzzcoin-project/BUZZ)
* [Capital Coin](https://github.com/Cap-Project/CapitalCoin)
* [Capra Coin](https://github.com/zero24x/capracoin)
* [Carboncoin](https://github.com/carboncointrust/CarboncoinCore)
* [CardBuyers](https://github.com/CARDbuyers/BCARD)
* [Carebit](https://github.com/carebitcoin/carebitcoin)
* [CatoCoin](https://github.com/CatoCoin/CatoCoin)
* [Cazcoin](https://github.com/copicogithub1/cazcoin)
* [Cerberus](https://github.com/cerberus-ng/cerberus)
* [CHEESE](https://github.com/CheeseCoin/CheeseMasternode)
* [Clams](https://github.com/nochowderforyou/clams)
* [Coin2Play](https://github.com/Coin2Play/c2pcore)
* [CoinonatX](https://github.com/xcxt-community/CoinonatX)
* [ColossusXT](https://github.com/ColossusCoinXT/ColossusCoinXT)
* [Community coin](https://github.com/cmccommunity/communitycoin)
* [Concierge coin](https://github.com/ConciergeCoin/Concierge)
* [Condominium Coin](https://github.com/condominium/CondominiumCore)
* [Copico](https://github.com/copicogithub1/copico)
* [COREZ](https://github.com/corezcrypto/corez)
* [Cosmos Coin](https://github.com/CMOS-Project/Cosmos)
* [Crave](https://github.com/Crave-Project/Crave-NG)
* [Cropcoin](https://github.com/Cropdev/CropDev)
* [CrowdCoin](https://github.com/crowdcoinChain/Crowdcoin)
* [Crown](https://github.com/Crowndev/crown-core)
* [Cryply](https://github.com/cryply/cryply-wallet)
* [Cryptoflow](https://github.com/CryptoFlowCoin/CryptoFlowCoin)
* [Cryptonite](https://github.com/MiniblockchainProject/Cryptonite)
* [Cryptonodes](https://github.com/cryptonodes-core/cryptonodes-core)
* [CUBEX](https://github.com/cubex-network/cubex)
* [Curium](https://github.com/curiumofficial/curium)
* [CurveCoin](https://github.com/curvecoin/curve)
* [DEMOS PAY](https://github.com/DemosPay/DemosPay)
* [Desire](https://github.com/lazyboozer/Desire)
* [Deuscoin](https://github.com/deuscoin-org/deuscoin-core)
* [Deutsche eMark](https://github.com/emarkproject/eMark)
* [Deviant Coin](https://github.com/Deviantcoin/Source)
* [Dextro](https://github.com/dextrocoin/dextro)
* [Diamond](https://github.com/DMDcoin/Diamond)
* [DigiMoney](https://github.com/digimoneydgm/digimoney)
* [Digitalcoin](https://github.com/DGCDev/digitalcoin)
* [DigitalPrice](https://github.com/DigitalPrice/DigitalPrice)
* [Digiwage](https://github.com/digiwage/digiwage)
* [Dividend Cash](https://github.com/dividendcash/dividendcash)
* [DIXIcoin](https://github.com/Dixicoin-DXC/Dixicoin)
* [Dogecoin](https://github.com/dogecoin/dogecoin)
* [Dravite](https://github.com/dravitecoin/dravite)
* [Dynamic](https://github.com/duality-solutions/Dynamic)
* [Dystem](https://github.com/Dystem/dystem-core)
* [EA Coin](https://github.com/eacoin-project/eacore)
* [EarnzCoin](https://github.com/Frenzel1337/EarnzCoin)
* [Elbrus](https://github.com/Elbruscurrency/EBSCoin)
* [Ellerium Project](https://github.com/ElleriumProject/Elleriumv2)
* [Elliot Coin](https://github.com/elliotproject/elli)
* [Elliotcoin](https://github.com/elliotproject/elli)
* [EmerCoin](https://github.com/EvgenijM86/emercoin)
* [Emrals](https://github.com/Emrals/emrals)
* [Epic](https://github.com/EpicCoinDev/Epic)
* [Eternity](https://github.com/eternity-group/eternity)
* [Ethereum Cash](https://github.com/ethereumcashdev/ethereumcash)
* [ExclusiveCoin](https://github.com/exclfork/ExclusiveCoin)
* [Exsolution](https://github.com/exsolution/ext-wallet)
* [EXUS Coin](https://github.com/exuscoin/exus)
* [Fantasy Cash](https://github.com/FootyCash/FootyCashV2)
* [Fantasy Gold](https://github.com/FantasyGold/FantasyGold-Core)
* [FEIRM](https://github.com/feirm/feirm)
* [FLCoin](https://github.com/cryptofreelance/FLCoin)
* [Folm](https://github.com/folm/folm)
* [Force Network](https://github.com/forceunited/force)
* [Francs](https://github.com/FRN-Crypto/FRN)
* [Freicoin](https://github.com/freicoin/freicoin)
* [FriendshipCoin](https://github.com/friendshipCoin/friendshipcoin-core)
* [Frozen](https://github.com/frznice/frozen)
* [FuturoCoin](https://github.com/futuro-coin/Futuro)
* [Gainer](https://github.com/gainercoin/gainercoin)
* [GambleCoin](https://github.com/GambleCoin-Project/GambleCoin)
* [GameCredits](https://github.com/gamers-coin/GameCredits)
* [GenesisX](https://github.com/genesis-x/genesis-x)
* [Gentarium](https://github.com/genterium-project/gentarium)
* [GeyserCoin](https://github.com/geysercoin/geysercoin)
* [Giant](https://github.com/GiantPay/GiantCore)
* [Globycoin](https://github.com/Globycoin/glbcore)
* [GoaCoin](https://github.com/goacoincore/goacoin)
* [GoByte](https://github.com/gobytecoin/gobyte)
* [Gold Poker](https://github.com/GoldPoker/GoldPoker-coin)
* [GoldBlocks](https://github.com/goldblockscoin/goldblocks)
* [Graphcoin](https://github.com/Graphcoin/source)
* [Gravium](https://github.com/Gravium/gravium)
* [Growers International](https://github.com/growersintl/growers)
* [Guardian Coin](https://github.com/guardiancoin/GDNC)
* [Harvest Masternode Coin](https://github.com/HarvestMasternodecoin/Harvestcoin)
* [HeldCoin](https://github.com/heldcoindev/HeldCoin)
* [Helium Chain](https://github.com/heliumchain/helium)
* [Help The Homeless Coin](https://github.com/HTHcoin/HTH)
* [Helpico](https://github.com/AnonymousDo/Helpico)
* [Hera Coin](https://github.com/Heraproject/HeraCoin)
* [HERB](https://github.com/herbcoin/herb)
* [HiddenTalk](https://github.com/htkcoin/htk)
* [High Temperature Coin](https://github.com/htrcoin/htrcoin)
* [HIGHLAND](https://github.com/highlandpay/highlandcoin)
* [Hilux](https://github.com/swatchie-1/hilux)
* [Hobonickels](https://github.com/Crypto-Expert/HoboNickels)
* [Horizen](https://github.com/ZencashOfficial/zen)
* [Hush](https://github.com/J-Stuhlman/zdash)
* [I0Coin](https://github.com/domob1812/i0coin)
* [Ignition](https://github.com/ignitioncoin/ignitioncoin)
* [ImageCash](https://github.com/mceme/ImageCash)
* [INDINODE](https://github.com/coinwebfactory/indinode)
* [Infinex](https://github.com/InfinexOfficial/Infinex)
* [Infinipay](https://github.com/infinipay/infinipay)
* [Innoket](https://github.com/innoket-dev/innoket-master)
* [Innova](https://github.com/innovacoin/innova)
* [INSaNe](https://github.com/CryptoCoderz/INSN)
* [InstaDEX](https://github.com/InstaDex-Coin/InstaDEX)
* [Interstellar Holdings](https://github.com/InterstellarHoldings/InterstellarHoldings)
* [Interzone](https://github.com/projectinterzone/ITZ)
* [ION](https://github.com/ionomy/ion)
* [IPSUM](https://github.com/ipsum-network/ips)
* [Jiyo](https://github.com/jiyocoin/jiyo-core)
* [Joulecoin](https://github.com/joulecoin/joulecoin)
* [Kaicoin](https://github.com/kaicoin-io/kaicoin-full-node)
* [Kalkulus](https://github.com/kalkulusteam/klks)
* [Keyco](https://github.com/keycoteam/keyco)
* [KRAIT](https://github.com/KRAITcoin/Krait)
* [Kraken Coin](https://github.com/KrakenCoins/Kraken)
* [Kzcash](https://github.com/kzcashteam/kzcash)
* [LanaCoin](https://github.com/LanaCoin/lanacoin)
* [Landcoin](https://github.com/landcoin-ldc/landcoin)
* [LasVegasCoin](https://github.com/Vegas-Guy/LasVegasCoin2)
* [League Coin](https://github.com/LGACoin/League)
* [Legion Coin](https://github.com/Legioncrypto/Legion)
* [LemonCoin](https://github.com/lemoncoin-project/lemoncoin)
* [LetItRide](https://github.com/shogdite/letitride)
* [Liberty](https://github.com/project-liberty/libertycoin)
* [LightPayCoin](https://github.com/lpcproject/LightPayCoin)
* [Linda](https://github.com/Lindacoin/Linda)
* [LINUX PAY](https://github.com/linuxpaycoin/linuxpay)
* [Lizus Payments](https://github.com/lizuspayments/lizus-core)
* [LOBSTEX Coin](https://github.com/avymantech/lobstex)
* [LogisCoin](https://github.com/lgsproject/LogisCoin)
* [LUNIQUE](https://github.com/RottenCoin/LuniqueCoin)
* [Macro](https://github.com/doomdorf/Macro)
* [MagnaCoin](https://github.com/MagnaCoinProject/MagnaCoin)
* [MAKETRIP](https://github.com/maketripcoin/maketrip-MTRIP)
* [Mambo Coin](https://github.com/MMBcoin/MamboCoin)
* [MarteXcoin](https://github.com/martexcoin/martexcoin)
* [MasterBit](https://github.com/MasterBit-Coin/masterbit)
* [Masternode Community Coin](https://github.com/mcc-project/mccproject)
* [Masternodecoin](https://github.com/masternodecoin/masternodecoin)
* [Medic Coin](https://github.com/MEDICCOIN/MedicCoin)
* [Memetic](https://github.com/pepeteam/pepecoin)
* [Mero](https://github.com/merocoin/mero)
* [Mirai](https://github.com/bumbacoin/Mirai-Master)
* [MNPCoin](https://github.com/MasterNodesPro/MNPCoin)
* [MonetaryUnit](https://github.com/MonetaryUnit/MUE-Src)
* [MoneyBag](https://github.com/MoneyBagCoin/MoneyBagCoin)
* [Monkey Project](https://github.com/MONKEYPROJECT/Monkey)
* [MontBlanc 3000](https://github.com/MontBlancCoin/MontBlanc)
* [MotileCoin](https://github.com/MotileCoin/MotileCoin)
* [Motion](https://github.com/motioncrypto/motion)
* [MOUSE](https://github.com/m1ckeym0us3/Mouse)
* [MTI Coin](https://github.com/mticryptocoins/MTI-Coin)
* [MUNcoin](https://github.com/muncrypto/muncoin)
* [MYCE](https://github.com/mycelliumcoin/MycelliumMN)
* [Nanucoin](https://github.com/rodrigodepeder/nanucoin)
* [NewYorkCoin](https://github.com/NewYorkCoin-NYC/nycoin)
* [NextON](https://github.com/Next-ON/NextON)
* [Nitrous](https://github.com/Nitrous-Core/nitrous)
* [Nodium](https://github.com/nodiumproject/zNodium)
* [Northern](https://github.com/zabtc/Northern)
* [NulleX](https://github.com/white92d15b7/NLX)
* [Nyerium](https://github.com/nyerium-core/nyerium)
* [NYXCoin](https://github.com/nyxpay/nyx)
* [OASIS](https://github.com/OasisCoinTeam/Oasis)
* [Obsidian](https://github.com/obsidianproject/Obsidian-Qt)
* [Ondori](https://github.com/ondori-project/rstr)
* [Over Powered Coin](https://github.com/opcoinx/OPCoinX)
* [Oyster Platform](https://github.com/oysterplatform/oyster)
* [PACcoin](https://github.com/PACCommunity/PAC)
* [Pandacoin](https://github.com/pandacoin-official/pandacoin)
* [PapelCoin](https://github.com/papelcoin/papelcoin)
* [Parlay](https://github.com/parlaychain/parlay)
* [PAXEX](https://github.com/paxex/paxchange)
* [PayDay Coin](https://github.com/PayDayCoinIo/PayDayCoin)
* [Peony Coin](https://github.com/peonyCoin/Peony)
* [PepeCoin](https://github.com/pepeteam/pepecoin)
* [Pesetacoin](https://github.com/FundacionPesetacoin/Pesetacoin-0.9.1-Oficial)
* [PHOBOS](https://github.com/Phoboscurrency/PBSCoin)
* [Phonecoin](https://github.com/phonecoin-PHON/PhoneCoinCore)
* [Phore](https://github.com/phoreproject/Phore)
* [PICPOTO](https://github.com/picpoto/picpotocoin)
* [PIVX](https://github.com/PIVX-Project/PIVX)
* [PlatinumBAR](https://github.com/xptx/PlatinumBar)
* [Plexus](https://github.com/PlexusCoin/Plexus)
* [Printex](https://github.com/Printex-official/printex-core)
* [ProCurrency](https://github.com/procurrency/procurrency)
* [Profit Hunters Coin](https://github.com/ProfitHuntersCoin/phc)
* [Project Coin](https://github.com/projectcoincore/ProjectCoin)
* [Prototanium](https://github.com/Prototanium/Pr)
* [Pura](https://github.com/PURAcore/PURA)
* [Purealt](https://github.com/puredev321/pure)
* [PZDC Project](https://github.com/pzdc-project/pzdc)
* [Qbic](https://github.com/qbic-platform/qbic)
* [Quantis](https://github.com/QuantisNetwork/Quantis-public)
* [Quark](https://github.com/MaxGuevara/quark)
* [Qubitcoin](https://github.com/willowrose/QubitCoin)
* [Quix](https://github.com/quixcoin/quix)
* [QYNO](https://github.com/qyno/qynocoin)
* [Rabbit](https://github.com/RabbitcoreDEV/RabbitCore)
* [Race](https://github.com/racecrypto/racecoin)
* [Radium](https://github.com/RadiumCore/radium-0.11)
* [Ragnarok](https://github.com/ragnaproject/Ragnarok)
* [Rampant Coin](https://github.com/rampantco/Rampant)
* [Rapture](https://github.com/RaptureCore/Rapture)
* [Reddcoin](https://github.com/reddcoin-project/reddcoin)
* [Reliance](https://github.com/relianceproject/Rel)
* [Renos](https://github.com/RenosCoin/RenosCoin)
* [Revolvercoin](https://github.com/RevolverCoin/revolvercoin)
* [Rhenium](https://github.com/Rheniumnetwork/Rhenium)
* [Ride My Car](https://github.com/RideMyCar/RideMyCar-Coin)
* [Riecoin](https://github.com/riecoin/riecoin)
* [Roi Coin](https://github.com/ROIcoin/ROIcoin)
* [Rover Coin](https://github.com/RoverCoin/Rovercoin)
* [RPICoin](https://github.com/rpicoin/rpicore)
* [Rubycoin](https://github.com/rubycoinorg/rubycoin)
* [Safe](https://github.com/bankledger/safe)
* [SafeCoin](https://github.com/Fair-Exchange/safecoin)
* [SafeInsure](https://github.com/safeinsure/sins-coin)
* [SagaCoin](https://github.com/sagacrypto/SagaCoin)
* [SaluS](https://github.com/saluscoin/salus)
* [Sanchezium](https://github.com/sanchezium/sanchezium)
* [SAROS](https://github.com/sarospay/saros)
* [Satoshicoin](https://github.com/SatoshiCoin-Crypto/SatoshiCoin)
* [savenode](https://github.com/savenode/SaveNodeCore)
* [Scorecoin](https://github.com/marksteven2017/Scorecoin)
* [SCRIV](https://github.com/ScrivNetwork/scriv)
* [SecureCloudCoin](https://github.com/SecureCloudCoin/securecloudcoin)
* [SecureTag](https://github.com/securetag/securetag)
* [Seedcoin](https://github.com/seedcoinfoundation/Seedcoin)
* [Shard Coin](https://github.com/ShardcoinRepo/shard)
* [Sharingmarketcoin](https://github.com/sharingmarketcoin/sharingmarketcoin)
* [SIBCoin](https://github.com/ivansib/sibcoin)
* [SimpleBank](https://github.com/Simplebankdev/Simple.)
* [SJWCoin](https://github.com/sjwcoin/sjwcoin-core)
* [Smart Quorum](https://github.com/smartquorum/sqrcoin)
* [SmartFox](https://github.com/smartfoxteam/smartfox)
* [SnowGem](https://github.com/Snowgem/Snowgem)
* [Social Send](https://github.com/SocialSend/SocialSend)
* [Solaris](https://github.com/Solaris-Project/Solaris)
* [Solarium](https://github.com/solariumcoin/solarium-XLRC)
* [Somnio](https://github.com/SMNcoin/SMNCoin)
* [SoomCoin](https://github.com/soom-4th-blockchain/soom-core)
* [Sovereign Coin](https://github.com/SovCoinX/SovCoin)
* [SPEDO](https://github.com/spedo-tech/spedo)
* [Sphere](https://github.com/SphereDevs/sphere)
* [Stakecube](https://github.com/stakecube/stakecube)
* [StarCash Network](https://github.com/cybernetik7/StarCash-Network-2.0)
* [Stipend](https://github.com/Stipend-Developer/stipend)
* [StoneCoin](https://github.com/stonecoinproject/Stonecoin)
* [StrongHands Masternode](https://github.com/bitcoinbabys/StrongHandsMasterNode)
* [SUB1X](https://github.com/SuB1X-Coin/zSub1x)
* [Sucre](https://github.com/sucremoneda/SucreCore)
* [SunCoin](https://github.com/suncoin-network/suncoin-core)
* [SuppoCoin](https://github.com/codeclock/sc)
* [Supro](https://github.com/suprodev/supro)
* [SwagBucks](https://github.com/pinkmagicdev/SwagBucks)
* [SwapCash](https://github.com/SwapCash/swapcash)
* [Swipp](https://github.com/teamswipp/swippcore)
* [SwisscoinCash](https://github.com/SwisscoinTM/SwisscoinNode)
* [Syndicate](https://github.com/SyndicateLabs/SyndicateQT)
* [TajCoin](https://github.com/Taj-Coin/tajcoin)
* [Talium](https://github.com/taliumtech/talium)
* [Talus](https://github.com/talusdev/TAL)
* [Tao](https://github.com/taoblockchain/tao-core)
* [Teloscoin](https://github.com/phoenixkonsole/transcendence)
* [Terracoin](https://github.com/terracoin/terracoin)
* [The Freedom Coin](https://github.com/TheFreedomCoin/Freedom-Coin)
* [TIMEISMONEY](https://github.com/rmcpartner/timeismoneycrypto)
* [Timicoin](https://github.com/timihealth/timicoin)
* [Tincoin](https://github.com/tincoinpay/tincoin)
* [Tokugawa](https://github.com/tokugawacoin/tokugawa)
* [Traid](https://github.com/TraidPlatform/traidcoin)
* [Transfercoin](https://github.com/transferdev/Transfercoin)
* [TravelPay](https://github.com/TravelPay/TravelPay)
* [Tribe](https://github.com/TribeCrypto/tribe)
* [Trittium](https://github.com/Trittium/trittium)
* [Trollcoin](https://github.com/TrollCoin2/TrollCoin-2.0)
* [Ultranatum](https://github.com/ultranatum/ultranatum)
* [United Crypto Community](https://github.com/unitedcryptocommunity/ucom)
* [Unobtanium](https://github.com/unobtanium-official/Unobtanium)
* [UservCoin](https://github.com/uservapp/uservcoin)
* [Vantaur](https://github.com/vantaur/vantaur)
* [VapersCoin](https://github.com/vaperscoin/vaperscoin)
* [VectorAI](https://github.com/vectorcoindev/Vector)
* [Velum](https://github.com/VelumPlatform/VelumPlatform)
* [VIOG](https://github.com/ViogCommunity/VIOG)
* [Vitae](https://github.com/VitaeTeam/Vitae)
* [Vivid Coin](https://github.com/vividplatform/vividcoin)
* [VIVO](https://github.com/vivocoin/vivo)
* [VIZZOTOP](https://github.com/VizzoTopCore/vizzotop)
* [VoteCoin](https://github.com/Tomas-M/VoteCoin)
* [Vsync](https://github.com/VsyncCrypto/VSX)
* [Wavi](https://github.com/wavidev-the-man/wavi)
* [Worx](https://github.com/worxcoin/worx)
* [XANO](https://github.com/XanoCoin/Xano-Coin)
* [Xchange](https://github.com/Xcgtech/Wallet)
* [Xdna](https://github.com/XDNA-Core/XDNA)
* [xGalaxy](https://github.com/officialXGalaxy/XGalaxy)
* [XORN](https://github.com/XORNcore/XORN)
* [XUEZ](https://github.com/XUEZ/XUEZ)
* [Xuma](https://github.com/xumacoin/xuma-core)
* [YICOIN](https://github.com/YiDeveloper/Yi)
* [Zcash](https://github.com/zcash/zcash)
* [ZCore](https://github.com/zcore-coin/zcore-source)
* [Zealium](https://github.com/zealiumcoin/Zealium)
* [ZelCash](https://github.com/zelcash/zelcash)
* [Zennies](https://github.com/zennies/zennies)
* [Zero](https://github.com/zerocurrency/zero)
* [Zest](https://github.com/ZestFoundation/ZestCoin)
* [Zixx](https://github.com/zixxcrypto/zixxcore)
* [Zoomba](https://github.com/zoombacoin/zoomba)
* [ZoZoCoin](https://github.com/ZoZoCoin/ZoZo-blockchain)
* [zXFLEA](https://github.com/zxfleacoin/xflea)

**Total Coins: 377**

These coin(s) still contain unpatched instances of the vulnerability in their code base which can be found [here](https://github.com/JinBean/CVE-Extension/tree/master/CVE-2016-10724)

### Sources:

1. [Bitcoin disclosure](https://bitcoin.org/en/posts/alert-key-and-vulnerabilities-disclosure)
2. [Linux Foundation](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2018-July/016189.html)

---

## Contributors

* [Hum Qing Ze](https://github.com/Fishbiscuit)
* [Latasha Lenus](https://github.com/latashalenus)
* [Tan Wei Jin](https://github.com/JinBean)
* [Tey Shi Ying](https://github.com/shiyingt)

---

\*All files uploaded have been cloned from their respective coin repositories.

## About

This repository is an extension of our research on cryptocurrency clones and documents existing vulnerabilities discovered in those clones

### Topics

[cve-2018-17144](/topics/cve-2018-17144 "Topic: cve-2018-17144")
[cve-2019-7176](/topics/cve-2019-7176 "Topic: cve-2019-7176")
[cve-2016-10724](/topics/cve-2016-10724 "Topic: cve-2016-10724")
[cve-2016-10725](/topics/cve-2016-10725 "Topic: cve-2016-10725")

### Resources

[Readme](#readme-ov-file)

[Activity](/JinBean/CVE-Extension/activity)
### Stars

[**3**
stars](/JinBean/CVE-Extension/stargazers)
### Watchers

[**1**
watching](/JinBean/CVE-Extension/watchers)
### Forks

[**4**
forks](/JinBean/CVE-Extension/forks)
[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FJinBean%2FCVE-Extension&report=JinBean+%28user%29)

## [Releases](/JinBean/CVE-Extension/releases)

No releases published

## [Packages 0](/users/JinBean/packages?repo_name=CVE-Extension)

No packages published

## Languages

* [C++
  100.0%](/JinBean/CVE-Extension/search?l=c%2B%2B)

## Footer

© 2025 GitHub, Inc.

### Footer navigation

* [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
* [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
* [Security](https://github.com/security)
* [Status](https://www.githubstatus.com/)
* [Docs](https://docs.github.com/)
* [Contact](https://support.github.com?tags=dotcom-footer)
* Manage cookies
* Do not share my personal information

You can’t perform that action at this time.



=== Content from bitcoincore.org_00a29bcc_20250126_032234.html ===


[![bitcoin core logo](/assets/images/bitcoin_core_logo_colored_reversed.png)](/)

* [About](/en/about/)
* [Download](/en/download)
* [blog](/en/blog/)
* [releases](/en/releases/)
* Development
  + [contribute](/en/contribute/)
  + [contributing code](/en/faq/contributing-code/)
  + [meetings](/en/meetings/)
  + [Lifecycle](/en/lifecycle)
  + [Security Advisories](/en/security-advisories/)
  + [RPC Docs](/en/doc/)
    - [28.0.0](/en/doc/28.0.0/)
    - [27.0.0](/en/doc/27.0.0/)
    - [26.0.0](/en/doc/26.0.0/)
    - [25.0.0](/en/doc/25.0.0/)
    - [24.0.0](/en/doc/24.0.0/)
    - [23.0.0](/en/doc/23.0.0/)
    - [22.0.0](/en/doc/22.0.0/)
    - [0.21.0](/en/doc/0.21.0/)
    - [0.20.0](/en/doc/0.20.0/)
    - [0.19.0](/en/doc/0.19.0/)
    - [0.18.0](/en/doc/0.18.0/)
    - [0.17.0](/en/doc/0.17.0/)
    - [0.16.3](/en/doc/0.16.3/)
    - [0.16.2](/en/doc/0.16.2/)
    - [0.16.1](/en/doc/0.16.1/)
    - [0.16.0](/en/doc/0.16.0/)
* Contact
  + [Contact Us](/en/contact/)
  + [Announcements](/en/list/announcements/join/)
  + [Twitter impersonation](/en/twitter-impersonation)
* English
  æ¥æ¬èª

# [Disclosure of memory DoS using low-difficulty headers](/en/2024/07/03/disclose-header-spam/ "Disclosure of memory DoS using low-difficulty headers")

by .

After Bitcoin Core 0.12.0 and before Bitcoin Core 0.15.0 a node could be spammed with minimum
difficulty headers, which could possibly be leveraged to crash it by OOM.

This issue is considered **Medium** severity.

## Details

Before the introduction of [headers
pre-synchronisation](https://github.com/bitcoin/bitcoin/pull/25717), nodes relied exclusively on
checkpoints to avoid getting spammed by low-difficulty headers.

In Bitcoin Core 0.12.0 a check for headers forking before the last checkpointâs height was moved to
after storing the header in `mapBlockIndex`. This allowed an attacker to grow the map unboundedly by
spamming headers whose parent is the genesis block (which only need difficulty 1 to create), as such
blocks bypassed the checkpoint logic.

## Attribution

Credits to Cory Fields for finding and responsibly disclosing the bug.

## Timeline

* 2017-08-08 Cory Fields privately reports the bug
* 2017-08-11 Pieter Wuille opens [PR #11028](https://github.com/bitcoin/bitcoin/pull/11028) to fix it
* 2017-08-14 PR #11028 is merged
* 2017-09-14 Bitcoin Core version 0.15.0 is released with a fix
* 2018-10-03 The last vulnerable version of Bitcoin Core (0.14.3) goes end of life
* 2024-07-03 Public disclosure.

---

**Disclosure of memory DoS using low-difficulty headers**
was published on
July 03, 2024

.

#### Recommended ([View all posts](/en/blog/))

* [Bitcoin Core 28.1 released](/en/2025/01/09/release-28.1/ "Bitcoin Core 28.1 released")
* [Bitcoin Core 27.2 released](/en/2024/11/04/release-27.2/ "Bitcoin Core 27.2 released")

---

[Twitter](https://twitter.com/bitcoincoreorg)

[Legal](/en/legal/) | [Privacy Policy](/en/legal/privacy) | [RSS ![rss feeds](/assets/images/rss-24x24.png)](/en/rss/)

![bitcoin core logo](/assets/images/bitcoin_core_logo.png)

© 2025 Bitcoin Core



=== Content from bitcoin.org_74452b79_20250124_203621.html ===

![Close](/img/icons/ico_close.svg?1736694469)

Bitcoin.org is a community funded project, donations are appreciated and used to improve the website.

Make a donation

Bitcoin.org needs your support!

Ã

Donate to Bitcoin.org

Use this QR code or address below

bc1qx3u4njquj0ux63030r4nat8awqrlm0x2zlt96h

$50.00
(... BTC)

$100.00
(... BTC)

$200.00
(... BTC)

[![Bitcoin](/img/icons/logotop.svg?1736694469)](/en/)

* Introduction
  + [Individuals](/en/bitcoin-for-individuals)
  + [Businesses](/en/bitcoin-for-businesses)
  + [Developers](https://developer.bitcoin.org/)
  + [Getting started](/en/getting-started)
  + [How it works](/en/how-it-works)
  + [White paper](/en/bitcoin-paper)
* Resources
  + [Resources](/en/resources)+ [Exchanges](/en/exchanges)
    + [Community](/en/community)
    + [Documentation](https://developer.bitcoin.org/)
    + [Vocabulary](/en/vocabulary)
    + [Events](/en/events)
    + [Bitcoin Core](/en/bitcoin-core/)
* [Innovation](/en/innovation)
* Participate
  + [Support Bitcoin](/en/support-bitcoin)+ [Buy Bitcoin](/en/buy)
    + [Running a full node](/en/full-node)
    + [Development](/en/development)
* [FAQ](/en/faq)

* English
  + - [Bahasa Indonesia](/id/)
    - [CatalÃ](/ca/)
    - [Dansk](/da/)
    - [Deutsch](/de/)
    - [English](/en/)
    - [EspaÃ±ol](/es/)
    - [FranÃ§ais](/fr/)
    - [Italiano](/it/)
    - [Magyar](/hu/)
    - [Nederlands](/nl/)
    - [Polski](/pl/)
    - [PortuguÃªs Brasil](/pt_BR/)
    - [RomÃ¢nÄ](/ro/)
    - [SlovenÅ¡Äina](/sl/)
    - [Srpski](/sr/)
    - [Svenska](/sv/)
  + - [TÃ¼rkÃ§e](/tr/)
    - [ÎÎ»Î»Î·Î½Î¹ÎºÎ¬](/el/)
    - [Ð±ÑÐ»Ð³Ð°ÑÑÐºÐ¸](/bg/)
    - [Ð ÑÑÑÐºÐ¸Ð¹](/ru/)
    - [Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°](/uk/)
    - [ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶](/hy/)
    - [Ø§ÙØ¹Ø±Ø¨ÙØ©](/ar/)
    - [ÙØ§Ø±Ø³Û](/fa/)
    - [×¢××¨××ª](/he/)
    - [à¤¹à¤¿à¤¨à¥à¤¦à¥](/hi/)
    - [íêµ­ì´](/ko/)
    - [ááááá](/km/)
    - [æ¥æ¬èª](/ja/)
    - [ç®ä½ä¸­æ](/zh_CN/)
    - [ç¹é«ä¸­æ](/zh_TW/)

Bahasa Indonesia
CatalÃ
Dansk
Deutsch
English
EspaÃ±ol
FranÃ§ais
Italiano
Magyar
Nederlands
Polski
PortuguÃªs Brasil
RomÃ¢nÄ
SlovenÅ¡Äina
Srpski
Svenska
TÃ¼rkÃ§e
ÎÎ»Î»Î·Î½Î¹ÎºÎ¬
Ð±ÑÐ»Ð³Ð°ÑÑÐºÐ¸
Ð ÑÑÑÐºÐ¸Ð¹
Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°
ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶
Ø§ÙØ¹Ø±Ø¨ÙØ©
ÙØ§Ø±Ø³Û
×¢××¨××ª
à¤¹à¤¿à¤¨à¥à¤¦à¥
íêµ­ì´
ááááá
æ¥æ¬èª
ç®ä½ä¸­æ
ç¹é«ä¸­æ

Language: en

[Blog home](/en/blog)
|
[Subscribe to RSS feed](/en/rss/blog.xml)
|
[Post history](https://github.com/bitcoin-dot-org/bitcoin.org/commits/master/_posts/2018-07-03-alert-key-and-vulnerabilities-disclosure.md)
|
[Report issue](https://github.com/bitcoin-dot-org/bitcoin.org/issues/new?body=Source%20File%3A%20_posts/2018-07-03-alert-key-and-vulnerabilities-disclosure.md%0A%0A)

# Alert Key and Alert System Vulnerabilities Disclosure

The bitcoin alert keys are disclosed in this blog post, followed by a description of the purpose of this information and its history. The bitcoin alert system has been completely retired. The network is not at risk and this warning may be safely ignored if you do not have an ancient node (running v0.12.x or older) using the deprecated bitcoin alert system or its public keys.

mainnet public key:

```
04fc9702847840aaf195de8442ebecedf5b095cdbb9bc716bda9110971b28a49e0ead8564ff0db22209e0374782c093bb899692d524e9d6a6956e7c5ecbcd68284

```

mainnet private key:

```
30820113020101042053cdc1e0cfac07f7e1c312768886f4635f6bceebec0887f63a9d37a26a92e6b6a081a53081a2020101302c06072a8648ce3d0101022100fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f300604010004010704410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8022100fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141020101a14403420004fc9702847840aaf195de8442ebecedf5b095cdbb9bc716bda9110971b28a49e0ead8564ff0db22209e0374782c093bb899692d524e9d6a6956e7c5ecbcd68284

```

testnet public key:

```
04302390343f91cc401d56d68b123028bf52e5fca1939df127f63c6467cdf9c8e2c14b61104cf817d0b780da337893ecc4aaff1309e536162dabbdb45200ca2b0a

```

testnet private key:

```
308201130201010420474d447aa6f46b4f45f67f21180a5de2722fc807401c4c4d95fdae64b3d6c294a081a53081a2020101302c06072a8648ce3d0101022100fffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f300604010004010704410479be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8022100fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141020101a14403420004302390343f91cc401d56d68b123028bf52e5fca1939df127f63c6467cdf9c8e2c14b61104cf817d0b780da337893ecc4aaff1309e536162dabbdb45200ca2b0a

```

These are openssl-serialized private keys.

In 2016, a plan was [proposed](https://lists.linuxfoundation.org/pipermail/bitcoin-dev/2016-September/013104.html) for the completion of the retirement of the bitcoin alert system which included the idea of revealing the alert system private keys. The proposal still contains good information regarding the purpose and intention of alert system retirement and motivation for the disclosure of the private keys. Additionally, an overview of the alert system retirement and its timeline is available [on the web](https://bitcoin.org/en/alert/2016-11-01-alert-retirement). This disclosure was recently discussed in an [IRC meeting logs](http://www.erisian.com.au/meetbot/bitcoin-core-dev/2018/bitcoin-core-dev.2018-06-21-19.00.log.html#l-30). A media site also recently discussed this [topic](https://www.coindesk.com/long-secret-bitcoin-key-finally-revealed/).

One of the reasons for disclosure of the keys is to mitigate the effects of unknown dissemination and proliferation of the keys. By broadcasting the values to make them available to everyone, the value of the keys is intended to be to be eliminated, since now everyone could feasibly sign messages, the value of the signed messages becomes zero.

## Vulnerabilities in the Bitcoin Alert system

The following text discloses a number of known vulnerabilities in the alert system.

The Alert System previously utilized by Bitcoin has several issues (some of which may be classified as vulnerabilities). These issues no longer exist in Bitcoin as of network protocol version 700013 which was released with Bitcoin Core 0.13.0. Many altcoins and Bitcoin client implementations were notified of the Alert Systemâs removal and have since removed the alert system themselves or transitioned to using an Alert system that does not share an Alert Key with Bitcoin.

All of the issues described below allow an attacker in possession of the Alert Key to perform a Denial of Service attack on nodes that still support the Alert system. These issues involve the exhaustion of memory which causes node software to crash or be killed due to excessive memory usage.

Many of these issues were not known until the Alert System was removed as developers inspected the code for vulnerabilities prior to releasing the Alert Key. Due to these issues, the publication of the Alert Key was delayed and affected altcoins and software were notified.

As of this writing, less than 4% of Bitcoin nodes are vulnerable. Furthermore, the Bitcoin Core developers have created a âfinal alertâ which is a maximum ID number alert which overrides all previous alerts and displays a fixed âURGENT: Alert key compromised, upgrade requiredâ message on all vulnerable software. The Bitcoin Core developers believe that so few vulnerable nodes are present on the network, and risks to those nodes so minor, that it is safe to publish the Alert Key.

An Alert contains these fields:

```
int32_t nVersion;
int64_t nRelayUntil;      // when newer nodes stop relaying to newer nodes
int64_t nExpiration;
int32_t nID;
int32_t nCancel;
std::set<int32_t> setCancel;
int32_t nMinVer;            // lowest version inclusive
int32_t nMaxVer;            // highest version inclusive
std::set<std::string> setSubVer;  // empty matches all
int32_t nPriority;

```

Alerts are also identified by their SHA256 hash. The above fields can be freely modified to generate alerts with differing hashes.

### Infinitely Sized Map (CVE-2016-10724)

The Alert System was designed to support multiple Alerts simultaneously. As such, Alerts were stored in memory in a map. However, there is no limit on how large this map can be, thus an attacker with the Alert Key can send a large number of Alerts to a node. Eventually, the map containing all of the Alerts will be so large that the node runs out of memory and crashes, thus causing a Denial of Service attack.

The infinitely sized map is the basis for which the Alert system can be used to cause Denial of Service attacks.

### Infinitely Sized Alerts

Although the infinitely sized map is what causes the crash itself, an attacker can also send very large Alerts. Alerts themselves are not limited in size explicitly, they are only limited by the maximum network message size. This maximum network message size has varied between versions. At times in the past, it has been 32 MB. For Bitcoin Core 0.12.0 (the most recent version of Bitcoin Core with the alert system enabled by default), the maximum message size is 2 MB.

Although large Alerts do not directly cause a Denial of Service by themselves, combined with the infinitely sized map, large Alerts can more quickly cause a node to run out of memory.

* The `setCancel` field has no length limit (besides the maximum message size) and is a std::set of 32-bit integers. Given that it has no size constraints, an attacker can use this field to create a very large Alert by filling the set with many integers.
* The `setSubVer` field, like `setCancel`, has no length limit and is a std::set. However instead of integers it has std::strings. These strings do not have a length limit themselves and can thus be arbitrarily long to produce an Alert that is arbitrarily large.
* Bitcoin Core versions prior to 0.10.0 did not have a limit on the length of the `strComment`, `strStatusBar`, and `strReserved` fields. These strings can have an arbitrary length.

### The Final Alert

To protect against attackers abusing the Alert key following its publication, the Bitcoin Core developers constructed a âfinal alertâ. This final alert is a maximum ID alert which overrides all previous alerts. All Bitcoin Core versions since and including Bitcoin Core 0.14.0 contain the final alert and will send it to any node which is vulnerable to issues including the following disclosures. However this protection is not enough to protect those nodes as a few issues were found with the final alert implementation itself.

Final alerts are those which meet the following conditions:

```
nExpiration == maxInt &&
nCancel == (maxInt-1) &&
nMinVer == 0 &&
nMaxVer == maxInt &&
setSubVer.empty() &&
nPriority == maxInt &&
strStatusBar == "URGENT: Alert key compromised, upgrade required"

```

`maxInt` is the maximum signed integer as defined by `std::numeric_limits<int>::max()`.

### Multiple Final Alerts

The definition for a final alert does not include a few fields. Because alerts are identified by their hashes, changing the ommitted fields allows an Alert to be classified as a final alert but still be an alert that is added to the infinitely sized map.

* Since `setCancel` is not required to be empty for an alert to be a final alert, the `setCancel` field can contain different integers to produce alerts that have different hashes and are thus different alerts. Combined with the infinitely sized map and the infinitely sized `setCancel` issues, many final alerts can be created which are large, fill the map, and cause a node to run out of memory.
* The `strComment` field, while having a maximum length of 65536 bytes, is not required to be a particular string in order for an alert to be a final alert. Thus multiple final alerts can be crafted which have different hashes by using different values for `strComment`
* The`strReserved` field, while having a maximum length of 256 bytes, is not required to be a particular string in order for an alert to be a final alert. Thus multiple final alerts can be crafted which have different hashes by using different values for `strReserved`.
* The `nVersion` field is also not required to be a particular value. Thus this can be used to construct final alerts with different hashes by having different values for `nVersion`.
* `nRelayUntil` field is also not required to be a particular value. Thus this can be used to construct final alerts with different hashes by having different values for `nRelayUntil`.

### Final Alert Cancellation (CVE-2016-10725)

Although the final alert is supposed to be uncancellable, it unfortunately is cancellable due to the order of actions when processing an alert. Alerts are first processed by checking whether they cancel any existing alert. Then they are checked whether any of the remaining alerts cancels it. Because of this order, it is possible to create an alert which cancels a final alert before the node checks whether that alert is canceled by the final alert. Thus an attacker can cancel a final alert with another alert allowing a node to be vulnerable to all of the aforementioned attacks.

## Protecting Against DoS Attacks from the Alert System

Fixing these issues is relatively easy. The first and most obvious solution is to simply remove the Alert system entirely. As nodes upgrade to versions without the Alert system, fewer nodes will be vulnerable to attack should the Alert keys become public. This is the option that Bitcoin has taken. However, because Bitcoin has retired the Alert system entirely, the Alert key will also be published to reduce the risk that the Alert Key is mistakenly depended upon in the future.

Should altcoins wish to continue using the Alert system but with a different Alert Key, a few very simple fixes will safeguard nodes from the aforementioned issues. Limiting the number of alerts, the size of `setCancel` and `setSubVer`, and only allowing one final alert altogether fix the above issues. [This patch](https://gist.github.com/achow101/02d03238090691558a68010a9ccbbf9d), on top of Bitcoin Core 0.11 (a vulnerable version), fixes the aforementioned issues. Altcoins that still use the Alert system are recommended to port this patch to their software. Outdated node software is still vulnerable.

Posted to the
[Bitcoin.org Site Blog](/en/blog) on 03 July 2018 by [Bryan Bishop](https://github.com/kanzure) and [Andrew Chow](https://github.com/achow101)

[![Bitcoin](/img/icons/logo-footer.svg?1736694469)](/en/)
Support Bitcoin.org:
Donate

bc1qx3u4njquj0ux63030r4nat8awqrlm0x2zlt96h

Introduction:

* [Individuals](/en/bitcoin-for-individuals)
* [Businesses](/en/bitcoin-for-businesses)
* [Developers](https://developer.bitcoin.org/)
* [Getting started](/en/getting-started)
* [How it works](/en/how-it-works)
* [You need to know](/en/you-need-to-know)
* [White paper](/en/bitcoin-paper)

Resources:

* [Resources](/en/resources)* [Exchanges](/en/exchanges)
  * [Community](/en/community)
  * [Vocabulary](/en/vocabulary)
  * [Events](/en/events)
  * [Bitcoin Core](/en/bitcoin-core/)

Participate:

* [Support Bitcoin](/en/support-bitcoin)* [Buy Bitcoin](/en/buy)
  * [Running a full node](/en/full-node)
  * [Development](/en/development)

Other:

[Avoid Scams](/en/scams)
[Legal](/en/legal)
[Privacy Policy](/en/privacy)
[Press](/en/press)
[About bitcoin.org](/en/about-us)
[Blog](/en/blog)

Â© Bitcoin Project 2009-2025 Released under the [MIT license](http://opensource.org/licenses/mit-license.php)
[Network Status](/en/alerts)

* English
  + - [Bahasa Indonesia](/id/)
    - [CatalÃ](/ca/)
    - [Dansk](/da/)
    - [Deutsch](/de/)
    - [English](/en/)
    - [EspaÃ±ol](/es/)
    - [FranÃ§ais](/fr/)
    - [Italiano](/it/)
    - [Magyar](/hu/)
    - [Nederlands](/nl/)
    - [Polski](/pl/)
    - [PortuguÃªs Brasil](/pt_BR/)
    - [RomÃ¢nÄ](/ro/)
    - [SlovenÅ¡Äina](/sl/)
    - [Srpski](/sr/)
    - [Svenska](/sv/)
  + - [TÃ¼rkÃ§e](/tr/)
    - [ÎÎ»Î»Î·Î½Î¹ÎºÎ¬](/el/)
    - [Ð±ÑÐ»Ð³Ð°ÑÑÐºÐ¸](/bg/)
    - [Ð ÑÑÑÐºÐ¸Ð¹](/ru/)
    - [Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°](/uk/)
    - [ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶](/hy/)
    - [Ø§ÙØ¹Ø±Ø¨ÙØ©](/ar/)
    - [ÙØ§Ø±Ø³Û](/fa/)
    - [×¢××¨××ª](/he/)
    - [à¤¹à¤¿à¤¨à¥à¤¦à¥](/hi/)
    - [íêµ­ì´](/ko/)
    - [ááááá](/km/)
    - [æ¥æ¬èª](/ja/)
    - [ç®ä½ä¸­æ](/zh_CN/)
    - [ç¹é«ä¸­æ](/zh_TW/)

Bahasa Indonesia
CatalÃ
Dansk
Deutsch
English
EspaÃ±ol
FranÃ§ais
Italiano
Magyar
Nederlands
Polski
PortuguÃªs Brasil
RomÃ¢nÄ
SlovenÅ¡Äina
Srpski
Svenska
TÃ¼rkÃ§e
ÎÎ»Î»Î·Î½Î¹ÎºÎ¬
Ð±ÑÐ»Ð³Ð°ÑÑÐºÐ¸
Ð ÑÑÑÐºÐ¸Ð¹
Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°
ÕÕ¡ÕµÕ¥ÖÕ¥Õ¶
Ø§ÙØ¹Ø±Ø¨ÙØ©
ÙØ§Ø±Ø³Û
×¢××¨××ª
à¤¹à¤¿à¤¨à¥à¤¦à¥
íêµ­ì´
ááááá
æ¥æ¬èª
ç®ä½ä¸­æ
ç¹é«ä¸­æ

en


