```
{
  "vulnerability_details": {
    "root_cause": "The vulnerability is a buffer over-read in the `queue_push` function within the yodl pre-document language processor. Specifically, when a queue needs to be expanded, the code calculates the new buffer size, allocates memory, and copies existing data. However, when copying the existing data, it uses the newly computed `memory_length` instead of the original `original_length` potentially reading past the allocated buffer if `memory_length` is larger than `original_length`.",
    "weaknesses": [
      "Buffer over-read"
    ],
    "impact": "An attacker could cause a crash by triggering an invalid memory read during the parsing process. The program aborts when the address sanitizer detects the issue.",
    "attack_vectors": "The vulnerability is triggered during the parsing process, specifically when expanding macros.",
    "required_capabilities": "An attacker needs to provide an input to yodl that causes the internal queue to be expanded. This can be achieved by using macros."
  },
  "additional_info": {
    "fixes": "The issue was resolved by ensuring that only the original data is copied to the new buffer before expansion occurs by using `original_length` instead of `memory_length` during the copy operation. The fix was introduced in version 3.07.00.",
    "affected_versions": "The issue was present in versions of yodl prior to 3.07.00, specifically version 3.05.01 was confirmed to be vulnerable. The fix was included in the Debian package version 3.04.00-1+deb8u1 for Debian 8 \"Jessie\".",
    "vulnerability_discovery": "The vulnerability was discovered by Hanno Bock using the address sanitizer tool."
  }
}
```